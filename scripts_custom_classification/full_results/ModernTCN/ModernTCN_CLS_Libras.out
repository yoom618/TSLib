Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.307581663131714
Epoch: 1, Steps: 12 | Train Loss: 2.736 Vali Loss: 2.694 Vali Acc: 0.022 Test Loss: 2.694 Test Acc: 0.022
Validation loss decreased (inf --> -0.022195).  Saving model ...
Epoch: 2 cost time: 1.1995854377746582
Epoch: 2, Steps: 12 | Train Loss: 2.610 Vali Loss: 2.590 Vali Acc: 0.200 Test Loss: 2.590 Test Acc: 0.200
Validation loss decreased (-0.022195 --> -0.199974).  Saving model ...
Epoch: 3 cost time: 1.1790857315063477
Epoch: 3, Steps: 12 | Train Loss: 2.379 Vali Loss: 2.377 Vali Acc: 0.461 Test Loss: 2.377 Test Acc: 0.461
Validation loss decreased (-0.199974 --> -0.461087).  Saving model ...
Epoch: 4 cost time: 1.02815580368042
Epoch: 4, Steps: 12 | Train Loss: 2.088 Vali Loss: 2.055 Vali Acc: 0.550 Test Loss: 2.055 Test Acc: 0.550
Validation loss decreased (-0.461087 --> -0.549979).  Saving model ...
Epoch: 5 cost time: 1.1670167446136475
Epoch: 5, Steps: 12 | Train Loss: 1.717 Vali Loss: 1.697 Vali Acc: 0.589 Test Loss: 1.697 Test Acc: 0.589
Validation loss decreased (-0.549979 --> -0.588872).  Saving model ...
Epoch: 6 cost time: 1.1846036911010742
Epoch: 6, Steps: 12 | Train Loss: 1.362 Vali Loss: 1.393 Vali Acc: 0.650 Test Loss: 1.393 Test Acc: 0.650
Validation loss decreased (-0.588872 --> -0.649986).  Saving model ...
Epoch: 7 cost time: 1.1792287826538086
Epoch: 7, Steps: 12 | Train Loss: 1.066 Vali Loss: 1.188 Vali Acc: 0.667 Test Loss: 1.188 Test Acc: 0.667
Validation loss decreased (-0.649986 --> -0.666655).  Saving model ...
Epoch: 8 cost time: 1.1512162685394287
Epoch: 8, Steps: 12 | Train Loss: 0.944 Vali Loss: 1.038 Vali Acc: 0.672 Test Loss: 1.038 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672212).  Saving model ...
Epoch: 9 cost time: 1.169584035873413
Epoch: 9, Steps: 12 | Train Loss: 0.693 Vali Loss: 0.915 Vali Acc: 0.761 Test Loss: 0.915 Test Acc: 0.761
Validation loss decreased (-0.672212 --> -0.761102).  Saving model ...
Epoch: 10 cost time: 1.2830753326416016
Epoch: 10, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.832 Vali Acc: 0.772 Test Loss: 0.832 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772214).  Saving model ...
Epoch: 11 cost time: 1.3023004531860352
Epoch: 11, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.760 Vali Acc: 0.794 Test Loss: 0.760 Test Acc: 0.794
Validation loss decreased (-0.772214 --> -0.794437).  Saving model ...
Epoch: 12 cost time: 1.2614915370941162
Epoch: 12, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.716 Vali Acc: 0.822 Test Loss: 0.716 Test Acc: 0.822
Validation loss decreased (-0.794437 --> -0.822215).  Saving model ...
Epoch: 13 cost time: 1.2520313262939453
Epoch: 13, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.651 Vali Acc: 0.822 Test Loss: 0.651 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822216).  Saving model ...
Epoch: 14 cost time: 1.2071418762207031
Epoch: 14, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
Validation loss decreased (-0.822216 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 1.1301591396331787
Epoch: 15, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.588 Vali Acc: 0.839 Test Loss: 0.588 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1517174243927002
Epoch: 16, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1204113960266113
Epoch: 17, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.550 Vali Acc: 0.861 Test Loss: 0.550 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861106).  Saving model ...
Epoch: 18 cost time: 1.121001958847046
Epoch: 18, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.525 Vali Acc: 0.872 Test Loss: 0.525 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 19 cost time: 1.146486520767212
Epoch: 19, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.509 Vali Acc: 0.872 Test Loss: 0.509 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 20 cost time: 1.0961329936981201
Epoch: 20, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.531 Vali Acc: 0.861 Test Loss: 0.531 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1299102306365967
Epoch: 21, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.555 Vali Acc: 0.878 Test Loss: 0.555 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 22 cost time: 1.178398847579956
Epoch: 22, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.541 Vali Acc: 0.872 Test Loss: 0.541 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.223757028579712
Epoch: 23, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.562 Vali Acc: 0.872 Test Loss: 0.562 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.244985580444336
Epoch: 24, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.600 Vali Acc: 0.861 Test Loss: 0.600 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3026738166809082
Epoch: 25, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.579 Vali Acc: 0.867 Test Loss: 0.579 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2562017440795898
Epoch: 26, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.592 Vali Acc: 0.872 Test Loss: 0.592 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2436802387237549
Epoch: 27, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.596 Vali Acc: 0.867 Test Loss: 0.596 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2679483890533447
Epoch: 28, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.577 Vali Acc: 0.889 Test Loss: 0.577 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888883).  Saving model ...
Epoch: 29 cost time: 1.1503002643585205
Epoch: 29, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.598 Vali Acc: 0.878 Test Loss: 0.598 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.180966854095459
Epoch: 30, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.597 Vali Acc: 0.878 Test Loss: 0.597 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2569243907928467
Epoch: 31, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.624 Vali Acc: 0.867 Test Loss: 0.624 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2200593948364258
Epoch: 32, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.625 Vali Acc: 0.878 Test Loss: 0.625 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1881065368652344
Epoch: 33, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.623 Vali Acc: 0.889 Test Loss: 0.623 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.1722428798675537
Epoch: 34, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.617 Vali Acc: 0.878 Test Loss: 0.617 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2662699222564697
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.649 Vali Acc: 0.867 Test Loss: 0.649 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.2884502410888672
Epoch: 36, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.679 Vali Acc: 0.872 Test Loss: 0.679 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.1861777305603027
Epoch: 37, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.686 Vali Acc: 0.878 Test Loss: 0.686 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.1132864952087402
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.706 Vali Acc: 0.872 Test Loss: 0.706 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 433135
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.420985460281372
Epoch: 1, Steps: 12 | Train Loss: 2.704 Vali Loss: 2.695 Vali Acc: 0.144 Test Loss: 2.695 Test Acc: 0.144
Validation loss decreased (inf --> -0.144417).  Saving model ...
Epoch: 2 cost time: 1.2483060359954834
Epoch: 2, Steps: 12 | Train Loss: 2.635 Vali Loss: 2.622 Vali Acc: 0.183 Test Loss: 2.622 Test Acc: 0.183
Validation loss decreased (-0.144417 --> -0.183307).  Saving model ...
Epoch: 3 cost time: 1.3534080982208252
Epoch: 3, Steps: 12 | Train Loss: 2.473 Vali Loss: 2.486 Vali Acc: 0.311 Test Loss: 2.486 Test Acc: 0.311
Validation loss decreased (-0.183307 --> -0.311086).  Saving model ...
Epoch: 4 cost time: 1.3133888244628906
Epoch: 4, Steps: 12 | Train Loss: 2.255 Vali Loss: 2.267 Vali Acc: 0.500 Test Loss: 2.267 Test Acc: 0.500
Validation loss decreased (-0.311086 --> -0.499977).  Saving model ...
Epoch: 5 cost time: 1.3371303081512451
Epoch: 5, Steps: 12 | Train Loss: 2.041 Vali Loss: 2.012 Vali Acc: 0.589 Test Loss: 2.012 Test Acc: 0.589
Validation loss decreased (-0.499977 --> -0.588869).  Saving model ...
Epoch: 6 cost time: 1.3172590732574463
Epoch: 6, Steps: 12 | Train Loss: 1.789 Vali Loss: 1.751 Vali Acc: 0.644 Test Loss: 1.751 Test Acc: 0.644
Validation loss decreased (-0.588869 --> -0.644427).  Saving model ...
Epoch: 7 cost time: 1.310204267501831
Epoch: 7, Steps: 12 | Train Loss: 1.535 Vali Loss: 1.516 Vali Acc: 0.667 Test Loss: 1.516 Test Acc: 0.667
Validation loss decreased (-0.644427 --> -0.666652).  Saving model ...
Epoch: 8 cost time: 1.2598161697387695
Epoch: 8, Steps: 12 | Train Loss: 1.289 Vali Loss: 1.309 Vali Acc: 0.683 Test Loss: 1.309 Test Acc: 0.683
Validation loss decreased (-0.666652 --> -0.683320).  Saving model ...
Epoch: 9 cost time: 1.280742883682251
Epoch: 9, Steps: 12 | Train Loss: 1.051 Vali Loss: 1.167 Vali Acc: 0.706 Test Loss: 1.167 Test Acc: 0.706
Validation loss decreased (-0.683320 --> -0.705544).  Saving model ...
Epoch: 10 cost time: 1.3030118942260742
Epoch: 10, Steps: 12 | Train Loss: 0.860 Vali Loss: 1.053 Vali Acc: 0.711 Test Loss: 1.053 Test Acc: 0.711
Validation loss decreased (-0.705544 --> -0.711101).  Saving model ...
Epoch: 11 cost time: 1.3212671279907227
Epoch: 11, Steps: 12 | Train Loss: 0.778 Vali Loss: 0.956 Vali Acc: 0.739 Test Loss: 0.956 Test Acc: 0.739
Validation loss decreased (-0.711101 --> -0.738879).  Saving model ...
Epoch: 12 cost time: 1.2005555629730225
Epoch: 12, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.880 Vali Acc: 0.756 Test Loss: 0.880 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755547).  Saving model ...
Epoch: 13 cost time: 1.2814974784851074
Epoch: 13, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.822 Vali Acc: 0.761 Test Loss: 0.822 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 14 cost time: 1.279761791229248
Epoch: 14, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.753 Vali Acc: 0.772 Test Loss: 0.753 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772215).  Saving model ...
Epoch: 15 cost time: 1.2356760501861572
Epoch: 15, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.702 Vali Acc: 0.800 Test Loss: 0.702 Test Acc: 0.800
Validation loss decreased (-0.772215 --> -0.799993).  Saving model ...
Epoch: 16 cost time: 1.2379190921783447
Epoch: 16, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.654 Vali Acc: 0.822 Test Loss: 0.654 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 17 cost time: 1.140061855316162
Epoch: 17, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.633 Vali Acc: 0.850 Test Loss: 0.633 Test Acc: 0.850
Validation loss decreased (-0.822216 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 1.1993379592895508
Epoch: 18, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 1.1232507228851318
Epoch: 19, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.571 Vali Acc: 0.856 Test Loss: 0.571 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 20 cost time: 1.178464651107788
Epoch: 20, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.571 Vali Acc: 0.867 Test Loss: 0.571 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 21 cost time: 1.1855342388153076
Epoch: 21, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.527 Vali Acc: 0.861 Test Loss: 0.527 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.242244005203247
Epoch: 22, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.533 Vali Acc: 0.861 Test Loss: 0.533 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2860665321350098
Epoch: 23, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.524 Vali Acc: 0.867 Test Loss: 0.524 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 24 cost time: 1.3703150749206543
Epoch: 24, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.503 Vali Acc: 0.872 Test Loss: 0.503 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 25 cost time: 1.3576991558074951
Epoch: 25, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.519 Vali Acc: 0.878 Test Loss: 0.519 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 26 cost time: 1.36263108253479
Epoch: 26, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.507 Vali Acc: 0.872 Test Loss: 0.507 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2955725193023682
Epoch: 27, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.529 Vali Acc: 0.872 Test Loss: 0.529 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3355803489685059
Epoch: 28, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.519 Vali Acc: 0.872 Test Loss: 0.519 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2638752460479736
Epoch: 29, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.498 Vali Acc: 0.861 Test Loss: 0.498 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2675492763519287
Epoch: 30, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.516 Vali Acc: 0.878 Test Loss: 0.516 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 31 cost time: 1.2608277797698975
Epoch: 31, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.524 Vali Acc: 0.889 Test Loss: 0.524 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 32 cost time: 1.24936842918396
Epoch: 32, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.536 Vali Acc: 0.867 Test Loss: 0.536 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3485848903656006
Epoch: 33, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.550 Vali Acc: 0.867 Test Loss: 0.550 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3128321170806885
Epoch: 34, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.557 Vali Acc: 0.867 Test Loss: 0.557 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.3316609859466553
Epoch: 35, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.537 Vali Acc: 0.861 Test Loss: 0.537 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3294436931610107
Epoch: 36, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.564 Vali Acc: 0.878 Test Loss: 0.564 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1962449550628662
Epoch: 37, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.578 Vali Acc: 0.883 Test Loss: 0.578 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.220515251159668
Epoch: 38, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.551 Vali Acc: 0.867 Test Loss: 0.551 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.107600450515747
Epoch: 39, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.0740060806274414
Epoch: 40, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.561 Vali Acc: 0.878 Test Loss: 0.561 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.1244022846221924
Epoch: 41, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.576 Vali Acc: 0.878 Test Loss: 0.576 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 410127
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5076088905334473
Epoch: 1, Steps: 12 | Train Loss: 2.747 Vali Loss: 2.666 Vali Acc: 0.100 Test Loss: 2.666 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 1.198354959487915
Epoch: 2, Steps: 12 | Train Loss: 2.679 Vali Loss: 2.590 Vali Acc: 0.272 Test Loss: 2.590 Test Acc: 0.272
Validation loss decreased (-0.099973 --> -0.272196).  Saving model ...
Epoch: 3 cost time: 1.2497413158416748
Epoch: 3, Steps: 12 | Train Loss: 2.502 Vali Loss: 2.449 Vali Acc: 0.439 Test Loss: 2.449 Test Acc: 0.439
Validation loss decreased (-0.272196 --> -0.438864).  Saving model ...
Epoch: 4 cost time: 1.1243627071380615
Epoch: 4, Steps: 12 | Train Loss: 2.327 Vali Loss: 2.243 Vali Acc: 0.511 Test Loss: 2.243 Test Acc: 0.511
Validation loss decreased (-0.438864 --> -0.511089).  Saving model ...
Epoch: 5 cost time: 1.2209851741790771
Epoch: 5, Steps: 12 | Train Loss: 2.072 Vali Loss: 2.012 Vali Acc: 0.567 Test Loss: 2.012 Test Acc: 0.567
Validation loss decreased (-0.511089 --> -0.566647).  Saving model ...
Epoch: 6 cost time: 1.2247600555419922
Epoch: 6, Steps: 12 | Train Loss: 1.826 Vali Loss: 1.758 Vali Acc: 0.594 Test Loss: 1.758 Test Acc: 0.594
Validation loss decreased (-0.566647 --> -0.594427).  Saving model ...
Epoch: 7 cost time: 1.187201976776123
Epoch: 7, Steps: 12 | Train Loss: 1.606 Vali Loss: 1.534 Vali Acc: 0.650 Test Loss: 1.534 Test Acc: 0.650
Validation loss decreased (-0.594427 --> -0.649985).  Saving model ...
Epoch: 8 cost time: 1.2376418113708496
Epoch: 8, Steps: 12 | Train Loss: 1.302 Vali Loss: 1.342 Vali Acc: 0.661 Test Loss: 1.342 Test Acc: 0.661
Validation loss decreased (-0.649985 --> -0.661098).  Saving model ...
Epoch: 9 cost time: 1.235642433166504
Epoch: 9, Steps: 12 | Train Loss: 1.081 Vali Loss: 1.203 Vali Acc: 0.678 Test Loss: 1.203 Test Acc: 0.678
Validation loss decreased (-0.661098 --> -0.677766).  Saving model ...
Epoch: 10 cost time: 1.2415213584899902
Epoch: 10, Steps: 12 | Train Loss: 0.969 Vali Loss: 1.089 Vali Acc: 0.667 Test Loss: 1.089 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2330706119537354
Epoch: 11, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.981 Vali Acc: 0.722 Test Loss: 0.981 Test Acc: 0.722
Validation loss decreased (-0.677766 --> -0.722212).  Saving model ...
Epoch: 12 cost time: 1.1598765850067139
Epoch: 12, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.898 Vali Acc: 0.728 Test Loss: 0.898 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727769).  Saving model ...
Epoch: 13 cost time: 1.1570711135864258
Epoch: 13, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.830 Vali Acc: 0.750 Test Loss: 0.830 Test Acc: 0.750
Validation loss decreased (-0.727769 --> -0.749992).  Saving model ...
Epoch: 14 cost time: 1.2336866855621338
Epoch: 14, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.768 Vali Acc: 0.772 Test Loss: 0.768 Test Acc: 0.772
Validation loss decreased (-0.749992 --> -0.772215).  Saving model ...
Epoch: 15 cost time: 1.2090816497802734
Epoch: 15, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.701 Vali Acc: 0.794 Test Loss: 0.701 Test Acc: 0.794
Validation loss decreased (-0.772215 --> -0.794437).  Saving model ...
Epoch: 16 cost time: 1.140655517578125
Epoch: 16, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.670 Vali Acc: 0.844 Test Loss: 0.670 Test Acc: 0.844
Validation loss decreased (-0.794437 --> -0.844438).  Saving model ...
Epoch: 17 cost time: 1.1711921691894531
Epoch: 17, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.630 Vali Acc: 0.828 Test Loss: 0.630 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0970582962036133
Epoch: 18, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.597 Vali Acc: 0.839 Test Loss: 0.597 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1236999034881592
Epoch: 19, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.576 Vali Acc: 0.856 Test Loss: 0.576 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855550).  Saving model ...
Epoch: 20 cost time: 1.113490104675293
Epoch: 20, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 21 cost time: 1.1522483825683594
Epoch: 21, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.547 Vali Acc: 0.872 Test Loss: 0.547 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872217).  Saving model ...
Epoch: 22 cost time: 1.0917325019836426
Epoch: 22, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.108912706375122
Epoch: 23, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1810400485992432
Epoch: 24, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.550 Vali Acc: 0.872 Test Loss: 0.550 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1987757682800293
Epoch: 25, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.541 Vali Acc: 0.867 Test Loss: 0.541 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.166191577911377
Epoch: 26, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.543 Vali Acc: 0.872 Test Loss: 0.543 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 27 cost time: 1.2107410430908203
Epoch: 27, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.504 Vali Acc: 0.867 Test Loss: 0.504 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2665395736694336
Epoch: 28, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.531 Vali Acc: 0.889 Test Loss: 0.531 Test Acc: 0.889
Validation loss decreased (-0.872217 --> -0.888884).  Saving model ...
Epoch: 29 cost time: 1.280468225479126
Epoch: 29, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.565 Vali Acc: 0.883 Test Loss: 0.565 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2078285217285156
Epoch: 30, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.547 Vali Acc: 0.889 Test Loss: 0.547 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2781662940979004
Epoch: 31, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.537 Vali Acc: 0.867 Test Loss: 0.537 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2022342681884766
Epoch: 32, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.591 Vali Acc: 0.878 Test Loss: 0.591 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2314529418945312
Epoch: 33, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.578 Vali Acc: 0.872 Test Loss: 0.578 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2365036010742188
Epoch: 34, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.535 Vali Acc: 0.883 Test Loss: 0.535 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2369635105133057
Epoch: 35, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.548 Vali Acc: 0.872 Test Loss: 0.548 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.207794189453125
Epoch: 36, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.565 Vali Acc: 0.878 Test Loss: 0.565 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.2640721797943115
Epoch: 37, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.606 Vali Acc: 0.878 Test Loss: 0.606 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.2254018783569336
Epoch: 38, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.611 Vali Acc: 0.872 Test Loss: 0.611 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 410159
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4611849784851074
Epoch: 1, Steps: 12 | Train Loss: 2.737 Vali Loss: 2.721 Vali Acc: 0.050 Test Loss: 2.721 Test Acc: 0.050
Validation loss decreased (inf --> -0.049973).  Saving model ...
Epoch: 2 cost time: 1.1142361164093018
Epoch: 2, Steps: 12 | Train Loss: 2.662 Vali Loss: 2.666 Vali Acc: 0.100 Test Loss: 2.666 Test Acc: 0.100
Validation loss decreased (-0.049973 --> -0.099973).  Saving model ...
Epoch: 3 cost time: 1.2068605422973633
Epoch: 3, Steps: 12 | Train Loss: 2.537 Vali Loss: 2.550 Vali Acc: 0.294 Test Loss: 2.550 Test Acc: 0.294
Validation loss decreased (-0.099973 --> -0.294419).  Saving model ...
Epoch: 4 cost time: 1.225790023803711
Epoch: 4, Steps: 12 | Train Loss: 2.368 Vali Loss: 2.399 Vali Acc: 0.417 Test Loss: 2.399 Test Acc: 0.417
Validation loss decreased (-0.294419 --> -0.416643).  Saving model ...
Epoch: 5 cost time: 1.2929978370666504
Epoch: 5, Steps: 12 | Train Loss: 2.193 Vali Loss: 2.209 Vali Acc: 0.533 Test Loss: 2.209 Test Acc: 0.533
Validation loss decreased (-0.416643 --> -0.533311).  Saving model ...
Epoch: 6 cost time: 1.2311720848083496
Epoch: 6, Steps: 12 | Train Loss: 1.970 Vali Loss: 1.992 Vali Acc: 0.550 Test Loss: 1.992 Test Acc: 0.550
Validation loss decreased (-0.533311 --> -0.549980).  Saving model ...
Epoch: 7 cost time: 1.2631206512451172
Epoch: 7, Steps: 12 | Train Loss: 1.749 Vali Loss: 1.768 Vali Acc: 0.572 Test Loss: 1.768 Test Acc: 0.572
Validation loss decreased (-0.549980 --> -0.572205).  Saving model ...
Epoch: 8 cost time: 1.2461497783660889
Epoch: 8, Steps: 12 | Train Loss: 1.484 Vali Loss: 1.572 Vali Acc: 0.617 Test Loss: 1.572 Test Acc: 0.617
Validation loss decreased (-0.572205 --> -0.616651).  Saving model ...
Epoch: 9 cost time: 1.2045598030090332
Epoch: 9, Steps: 12 | Train Loss: 1.296 Vali Loss: 1.384 Vali Acc: 0.644 Test Loss: 1.384 Test Acc: 0.644
Validation loss decreased (-0.616651 --> -0.644431).  Saving model ...
Epoch: 10 cost time: 1.0870842933654785
Epoch: 10, Steps: 12 | Train Loss: 1.113 Vali Loss: 1.232 Vali Acc: 0.656 Test Loss: 1.232 Test Acc: 0.656
Validation loss decreased (-0.644431 --> -0.655543).  Saving model ...
Epoch: 11 cost time: 1.0944275856018066
Epoch: 11, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.119 Vali Acc: 0.700 Test Loss: 1.119 Test Acc: 0.700
Validation loss decreased (-0.655543 --> -0.699989).  Saving model ...
Epoch: 12 cost time: 1.1313543319702148
Epoch: 12, Steps: 12 | Train Loss: 0.800 Vali Loss: 1.003 Vali Acc: 0.700 Test Loss: 1.003 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 13 cost time: 1.0729491710662842
Epoch: 13, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.899 Vali Acc: 0.761 Test Loss: 0.899 Test Acc: 0.761
Validation loss decreased (-0.699990 --> -0.761102).  Saving model ...
Epoch: 14 cost time: 1.2438640594482422
Epoch: 14, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.851 Vali Acc: 0.767 Test Loss: 0.851 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766658).  Saving model ...
Epoch: 15 cost time: 1.3056859970092773
Epoch: 15, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.780 Vali Acc: 0.783 Test Loss: 0.780 Test Acc: 0.783
Validation loss decreased (-0.766658 --> -0.783326).  Saving model ...
Epoch: 16 cost time: 1.3348312377929688
Epoch: 16, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.735 Vali Acc: 0.778 Test Loss: 0.735 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.20271897315979
Epoch: 17, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.685 Vali Acc: 0.800 Test Loss: 0.685 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799993).  Saving model ...
Epoch: 18 cost time: 1.1681029796600342
Epoch: 18, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.648 Vali Acc: 0.822 Test Loss: 0.648 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 19 cost time: 1.1693694591522217
Epoch: 19, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.614 Vali Acc: 0.839 Test Loss: 0.614 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 20 cost time: 1.2111527919769287
Epoch: 20, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.603 Vali Acc: 0.828 Test Loss: 0.603 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.177396297454834
Epoch: 21, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.571 Vali Acc: 0.844 Test Loss: 0.571 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 22 cost time: 1.1591660976409912
Epoch: 22, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 23 cost time: 1.1806776523590088
Epoch: 23, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.555 Vali Acc: 0.861 Test Loss: 0.555 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861106).  Saving model ...
Epoch: 24 cost time: 1.1300015449523926
Epoch: 24, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.279637336730957
Epoch: 25, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.552 Vali Acc: 0.861 Test Loss: 0.552 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 26 cost time: 1.3462045192718506
Epoch: 26, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.518 Vali Acc: 0.867 Test Loss: 0.518 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 27 cost time: 1.2959024906158447
Epoch: 27, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.520 Vali Acc: 0.856 Test Loss: 0.520 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3237292766571045
Epoch: 28, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.520 Vali Acc: 0.878 Test Loss: 0.520 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877773).  Saving model ...
Epoch: 29 cost time: 1.2980732917785645
Epoch: 29, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2688953876495361
Epoch: 30, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.517 Vali Acc: 0.878 Test Loss: 0.517 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 31 cost time: 1.2324504852294922
Epoch: 31, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.522 Vali Acc: 0.867 Test Loss: 0.522 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1983606815338135
Epoch: 32, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.552 Vali Acc: 0.867 Test Loss: 0.552 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1818187236785889
Epoch: 33, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.544 Vali Acc: 0.867 Test Loss: 0.544 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2753164768218994
Epoch: 34, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.519 Vali Acc: 0.872 Test Loss: 0.519 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.2700140476226807
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.2601110935211182
Epoch: 36, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.2938385009765625
Epoch: 37, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.555 Vali Acc: 0.878 Test Loss: 0.555 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.3403725624084473
Epoch: 38, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.541 Vali Acc: 0.872 Test Loss: 0.541 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.2645084857940674
Epoch: 39, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.539 Vali Acc: 0.872 Test Loss: 0.539 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.155386209487915
Epoch: 40, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.531 Vali Acc: 0.900 Test Loss: 0.531 Test Acc: 0.900
Validation loss decreased (-0.877773 --> -0.899995).  Saving model ...
Epoch: 41 cost time: 1.1871623992919922
Epoch: 41, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.521 Vali Acc: 0.894 Test Loss: 0.521 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1684048175811768
Epoch: 42, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.513 Vali Acc: 0.894 Test Loss: 0.513 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.158008098602295
Epoch: 43, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.540 Vali Acc: 0.883 Test Loss: 0.540 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1698806285858154
Epoch: 44, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.535 Vali Acc: 0.894 Test Loss: 0.535 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.2301666736602783
Epoch: 45, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.525 Vali Acc: 0.883 Test Loss: 0.525 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.2051382064819336
Epoch: 46, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.586 Vali Acc: 0.872 Test Loss: 0.586 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.3235504627227783
Epoch: 47, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.559 Vali Acc: 0.894 Test Loss: 0.559 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.3069381713867188
Epoch: 48, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.519 Vali Acc: 0.894 Test Loss: 0.519 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.2133815288543701
Epoch: 49, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.536 Vali Acc: 0.883 Test Loss: 0.536 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.299973726272583
Epoch: 50, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.582 Vali Acc: 0.894 Test Loss: 0.582 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 402511
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4559998512268066
Epoch: 1, Steps: 12 | Train Loss: 2.726 Vali Loss: 2.696 Vali Acc: 0.083 Test Loss: 2.696 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 1.215235710144043
Epoch: 2, Steps: 12 | Train Loss: 2.677 Vali Loss: 2.654 Vali Acc: 0.122 Test Loss: 2.654 Test Acc: 0.122
Validation loss decreased (-0.083306 --> -0.122196).  Saving model ...
Epoch: 3 cost time: 1.201805830001831
Epoch: 3, Steps: 12 | Train Loss: 2.537 Vali Loss: 2.555 Vali Acc: 0.267 Test Loss: 2.555 Test Acc: 0.267
Validation loss decreased (-0.122196 --> -0.266641).  Saving model ...
Epoch: 4 cost time: 1.2280199527740479
Epoch: 4, Steps: 12 | Train Loss: 2.427 Vali Loss: 2.412 Vali Acc: 0.389 Test Loss: 2.412 Test Acc: 0.389
Validation loss decreased (-0.266641 --> -0.388865).  Saving model ...
Epoch: 5 cost time: 1.1707420349121094
Epoch: 5, Steps: 12 | Train Loss: 2.275 Vali Loss: 2.248 Vali Acc: 0.489 Test Loss: 2.248 Test Acc: 0.489
Validation loss decreased (-0.388865 --> -0.488866).  Saving model ...
Epoch: 6 cost time: 1.2252326011657715
Epoch: 6, Steps: 12 | Train Loss: 2.116 Vali Loss: 2.058 Vali Acc: 0.561 Test Loss: 2.058 Test Acc: 0.561
Validation loss decreased (-0.488866 --> -0.561091).  Saving model ...
Epoch: 7 cost time: 1.2349040508270264
Epoch: 7, Steps: 12 | Train Loss: 1.876 Vali Loss: 1.874 Vali Acc: 0.600 Test Loss: 1.874 Test Acc: 0.600
Validation loss decreased (-0.561091 --> -0.599981).  Saving model ...
Epoch: 8 cost time: 1.1589629650115967
Epoch: 8, Steps: 12 | Train Loss: 1.631 Vali Loss: 1.673 Vali Acc: 0.633 Test Loss: 1.673 Test Acc: 0.633
Validation loss decreased (-0.599981 --> -0.633317).  Saving model ...
Epoch: 9 cost time: 1.1383440494537354
Epoch: 9, Steps: 12 | Train Loss: 1.427 Vali Loss: 1.499 Vali Acc: 0.633 Test Loss: 1.499 Test Acc: 0.633
Validation loss decreased (-0.633317 --> -0.633318).  Saving model ...
Epoch: 10 cost time: 1.143986463546753
Epoch: 10, Steps: 12 | Train Loss: 1.223 Vali Loss: 1.328 Vali Acc: 0.644 Test Loss: 1.328 Test Acc: 0.644
Validation loss decreased (-0.633318 --> -0.644431).  Saving model ...
Epoch: 11 cost time: 1.1574876308441162
Epoch: 11, Steps: 12 | Train Loss: 1.073 Vali Loss: 1.182 Vali Acc: 0.706 Test Loss: 1.182 Test Acc: 0.706
Validation loss decreased (-0.644431 --> -0.705544).  Saving model ...
Epoch: 12 cost time: 1.2017390727996826
Epoch: 12, Steps: 12 | Train Loss: 0.897 Vali Loss: 1.071 Vali Acc: 0.711 Test Loss: 1.071 Test Acc: 0.711
Validation loss decreased (-0.705544 --> -0.711100).  Saving model ...
Epoch: 13 cost time: 1.1952028274536133
Epoch: 13, Steps: 12 | Train Loss: 0.755 Vali Loss: 0.988 Vali Acc: 0.728 Test Loss: 0.988 Test Acc: 0.728
Validation loss decreased (-0.711100 --> -0.727768).  Saving model ...
Epoch: 14 cost time: 1.165424108505249
Epoch: 14, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.899 Vali Acc: 0.756 Test Loss: 0.899 Test Acc: 0.756
Validation loss decreased (-0.727768 --> -0.755547).  Saving model ...
Epoch: 15 cost time: 1.254530906677246
Epoch: 15, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.823 Vali Acc: 0.783 Test Loss: 0.823 Test Acc: 0.783
Validation loss decreased (-0.755547 --> -0.783325).  Saving model ...
Epoch: 16 cost time: 1.2292232513427734
Epoch: 16, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.765 Vali Acc: 0.783 Test Loss: 0.765 Test Acc: 0.783
Validation loss decreased (-0.783325 --> -0.783326).  Saving model ...
Epoch: 17 cost time: 1.2500197887420654
Epoch: 17, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.709 Vali Acc: 0.789 Test Loss: 0.709 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 18 cost time: 1.2291240692138672
Epoch: 18, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.664 Vali Acc: 0.800 Test Loss: 0.664 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 1.2655446529388428
Epoch: 19, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.637 Vali Acc: 0.822 Test Loss: 0.637 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 20 cost time: 1.2140491008758545
Epoch: 20, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.606 Vali Acc: 0.833 Test Loss: 0.606 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 21 cost time: 1.2827069759368896
Epoch: 21, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.572 Vali Acc: 0.861 Test Loss: 0.572 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861105).  Saving model ...
Epoch: 22 cost time: 1.2873690128326416
Epoch: 22, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.550 Vali Acc: 0.839 Test Loss: 0.550 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2280824184417725
Epoch: 23, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.225663423538208
Epoch: 24, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.512 Vali Acc: 0.856 Test Loss: 0.512 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2074642181396484
Epoch: 25, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.496 Vali Acc: 0.861 Test Loss: 0.496 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 26 cost time: 1.1963531970977783
Epoch: 26, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.497 Vali Acc: 0.867 Test Loss: 0.497 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 27 cost time: 1.1519596576690674
Epoch: 27, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2356646060943604
Epoch: 28, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.477 Vali Acc: 0.861 Test Loss: 0.477 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1415739059448242
Epoch: 29, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.466 Vali Acc: 0.856 Test Loss: 0.466 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.190197467803955
Epoch: 30, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.478 Vali Acc: 0.867 Test Loss: 0.478 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 31 cost time: 1.2168776988983154
Epoch: 31, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.462 Vali Acc: 0.883 Test Loss: 0.462 Test Acc: 0.883
Validation loss decreased (-0.866662 --> -0.883329).  Saving model ...
Epoch: 32 cost time: 1.2376399040222168
Epoch: 32, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.481 Vali Acc: 0.872 Test Loss: 0.481 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2472164630889893
Epoch: 33, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.474 Vali Acc: 0.867 Test Loss: 0.474 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.257427453994751
Epoch: 34, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.489 Vali Acc: 0.861 Test Loss: 0.489 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1752943992614746
Epoch: 35, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.487 Vali Acc: 0.883 Test Loss: 0.487 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.188096046447754
Epoch: 36, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.488 Vali Acc: 0.872 Test Loss: 0.488 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2323167324066162
Epoch: 37, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.490 Vali Acc: 0.878 Test Loss: 0.490 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2632558345794678
Epoch: 38, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.465 Vali Acc: 0.878 Test Loss: 0.465 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.261411428451538
Epoch: 39, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.523 Vali Acc: 0.867 Test Loss: 0.523 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.2627274990081787
Epoch: 40, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.494 Vali Acc: 0.889 Test Loss: 0.494 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 41 cost time: 1.3082101345062256
Epoch: 41, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.467 Vali Acc: 0.878 Test Loss: 0.467 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2859039306640625
Epoch: 42, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.485 Vali Acc: 0.889 Test Loss: 0.485 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 43 cost time: 1.2861371040344238
Epoch: 43, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.503 Vali Acc: 0.889 Test Loss: 0.503 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.307300329208374
Epoch: 44, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.496 Vali Acc: 0.894 Test Loss: 0.496 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894439).  Saving model ...
Epoch: 45 cost time: 1.2500858306884766
Epoch: 45, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.483 Vali Acc: 0.894 Test Loss: 0.483 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894440).  Saving model ...
Epoch: 46 cost time: 1.1609983444213867
Epoch: 46, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.510 Vali Acc: 0.900 Test Loss: 0.510 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899995).  Saving model ...
Epoch: 47 cost time: 1.2042279243469238
Epoch: 47, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.525 Vali Acc: 0.878 Test Loss: 0.525 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1742138862609863
Epoch: 48, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.516 Vali Acc: 0.872 Test Loss: 0.516 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.2191414833068848
Epoch: 49, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.514 Vali Acc: 0.894 Test Loss: 0.514 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.1854536533355713
Epoch: 50, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.535 Vali Acc: 0.894 Test Loss: 0.535 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 398735
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4433295726776123
Epoch: 1, Steps: 12 | Train Loss: 2.727 Vali Loss: 2.683 Vali Acc: 0.139 Test Loss: 2.683 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 1.181934118270874
Epoch: 2, Steps: 12 | Train Loss: 2.646 Vali Loss: 2.618 Vali Acc: 0.183 Test Loss: 2.618 Test Acc: 0.183
Validation loss decreased (-0.138862 --> -0.183307).  Saving model ...
Epoch: 3 cost time: 1.219616413116455
Epoch: 3, Steps: 12 | Train Loss: 2.536 Vali Loss: 2.504 Vali Acc: 0.300 Test Loss: 2.504 Test Acc: 0.300
Validation loss decreased (-0.183307 --> -0.299975).  Saving model ...
Epoch: 4 cost time: 1.18259596824646
Epoch: 4, Steps: 12 | Train Loss: 2.405 Vali Loss: 2.360 Vali Acc: 0.356 Test Loss: 2.360 Test Acc: 0.356
Validation loss decreased (-0.299975 --> -0.355532).  Saving model ...
Epoch: 5 cost time: 1.2317087650299072
Epoch: 5, Steps: 12 | Train Loss: 2.248 Vali Loss: 2.205 Vali Acc: 0.467 Test Loss: 2.205 Test Acc: 0.467
Validation loss decreased (-0.355532 --> -0.466645).  Saving model ...
Epoch: 6 cost time: 1.2816357612609863
Epoch: 6, Steps: 12 | Train Loss: 2.067 Vali Loss: 2.036 Vali Acc: 0.489 Test Loss: 2.036 Test Acc: 0.489
Validation loss decreased (-0.466645 --> -0.488869).  Saving model ...
Epoch: 7 cost time: 1.300607681274414
Epoch: 7, Steps: 12 | Train Loss: 1.857 Vali Loss: 1.857 Vali Acc: 0.550 Test Loss: 1.857 Test Acc: 0.550
Validation loss decreased (-0.488869 --> -0.549981).  Saving model ...
Epoch: 8 cost time: 1.2634103298187256
Epoch: 8, Steps: 12 | Train Loss: 1.661 Vali Loss: 1.677 Vali Acc: 0.583 Test Loss: 1.677 Test Acc: 0.583
Validation loss decreased (-0.549981 --> -0.583317).  Saving model ...
Epoch: 9 cost time: 1.2810914516448975
Epoch: 9, Steps: 12 | Train Loss: 1.500 Vali Loss: 1.514 Vali Acc: 0.667 Test Loss: 1.514 Test Acc: 0.667
Validation loss decreased (-0.583317 --> -0.666652).  Saving model ...
Epoch: 10 cost time: 1.2527878284454346
Epoch: 10, Steps: 12 | Train Loss: 1.269 Vali Loss: 1.364 Vali Acc: 0.672 Test Loss: 1.364 Test Acc: 0.672
Validation loss decreased (-0.666652 --> -0.672209).  Saving model ...
Epoch: 11 cost time: 1.2493438720703125
Epoch: 11, Steps: 12 | Train Loss: 1.163 Vali Loss: 1.229 Vali Acc: 0.700 Test Loss: 1.229 Test Acc: 0.700
Validation loss decreased (-0.672209 --> -0.699988).  Saving model ...
Epoch: 12 cost time: 1.2764239311218262
Epoch: 12, Steps: 12 | Train Loss: 1.015 Vali Loss: 1.121 Vali Acc: 0.711 Test Loss: 1.121 Test Acc: 0.711
Validation loss decreased (-0.699988 --> -0.711100).  Saving model ...
Epoch: 13 cost time: 1.2297265529632568
Epoch: 13, Steps: 12 | Train Loss: 0.845 Vali Loss: 1.030 Vali Acc: 0.722 Test Loss: 1.030 Test Acc: 0.722
Validation loss decreased (-0.711100 --> -0.722212).  Saving model ...
Epoch: 14 cost time: 1.2626068592071533
Epoch: 14, Steps: 12 | Train Loss: 0.727 Vali Loss: 0.945 Vali Acc: 0.756 Test Loss: 0.945 Test Acc: 0.756
Validation loss decreased (-0.722212 --> -0.755546).  Saving model ...
Epoch: 15 cost time: 1.1974992752075195
Epoch: 15, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.872 Vali Acc: 0.772 Test Loss: 0.872 Test Acc: 0.772
Validation loss decreased (-0.755546 --> -0.772214).  Saving model ...
Epoch: 16 cost time: 1.2205424308776855
Epoch: 16, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.812 Vali Acc: 0.772 Test Loss: 0.812 Test Acc: 0.772
Validation loss decreased (-0.772214 --> -0.772214).  Saving model ...
Epoch: 17 cost time: 1.2823817729949951
Epoch: 17, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.771 Vali Acc: 0.794 Test Loss: 0.771 Test Acc: 0.794
Validation loss decreased (-0.772214 --> -0.794437).  Saving model ...
Epoch: 18 cost time: 1.2726128101348877
Epoch: 18, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.721 Vali Acc: 0.794 Test Loss: 0.721 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794437).  Saving model ...
Epoch: 19 cost time: 1.2246875762939453
Epoch: 19, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.691 Vali Acc: 0.811 Test Loss: 0.691 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811104).  Saving model ...
Epoch: 20 cost time: 1.13065505027771
Epoch: 20, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.649 Vali Acc: 0.839 Test Loss: 0.649 Test Acc: 0.839
Validation loss decreased (-0.811104 --> -0.838882).  Saving model ...
Epoch: 21 cost time: 1.0950562953948975
Epoch: 21, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.622 Vali Acc: 0.844 Test Loss: 0.622 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 22 cost time: 1.0877830982208252
Epoch: 22, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.595 Vali Acc: 0.867 Test Loss: 0.595 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866661).  Saving model ...
Epoch: 23 cost time: 1.1287038326263428
Epoch: 23, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.547 Vali Acc: 0.872 Test Loss: 0.547 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 24 cost time: 1.202826976776123
Epoch: 24, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.563 Vali Acc: 0.867 Test Loss: 0.563 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.166532039642334
Epoch: 25, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.523 Vali Acc: 0.872 Test Loss: 0.523 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 26 cost time: 1.1588184833526611
Epoch: 26, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.540 Vali Acc: 0.867 Test Loss: 0.540 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3777976036071777
Epoch: 27, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.501 Vali Acc: 0.878 Test Loss: 0.501 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 28 cost time: 1.2860040664672852
Epoch: 28, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.501 Vali Acc: 0.872 Test Loss: 0.501 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.335829257965088
Epoch: 29, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.518 Vali Acc: 0.878 Test Loss: 0.518 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.31583833694458
Epoch: 30, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.500 Vali Acc: 0.872 Test Loss: 0.500 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2841451168060303
Epoch: 31, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.526 Vali Acc: 0.889 Test Loss: 0.526 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 32 cost time: 1.2452664375305176
Epoch: 32, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.511 Vali Acc: 0.894 Test Loss: 0.511 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894439).  Saving model ...
Epoch: 33 cost time: 1.2904973030090332
Epoch: 33, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.521 Vali Acc: 0.894 Test Loss: 0.521 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2110474109649658
Epoch: 34, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.530 Vali Acc: 0.878 Test Loss: 0.530 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2087957859039307
Epoch: 35, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.552 Vali Acc: 0.889 Test Loss: 0.552 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2757351398468018
Epoch: 36, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.555 Vali Acc: 0.872 Test Loss: 0.555 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.3257083892822266
Epoch: 37, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.575 Vali Acc: 0.867 Test Loss: 0.575 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2281033992767334
Epoch: 38, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.576 Vali Acc: 0.878 Test Loss: 0.576 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.3424246311187744
Epoch: 39, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.554 Vali Acc: 0.894 Test Loss: 0.554 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.13785719871521
Epoch: 40, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.575 Vali Acc: 0.878 Test Loss: 0.575 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.0911369323730469
Epoch: 41, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.583 Vali Acc: 0.889 Test Loss: 0.583 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.0497934818267822
Epoch: 42, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.583 Vali Acc: 0.889 Test Loss: 0.583 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 398799
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.485495090484619
Epoch: 1, Steps: 12 | Train Loss: 2.714 Vali Loss: 2.693 Vali Acc: 0.078 Test Loss: 2.693 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 1.256152629852295
Epoch: 2, Steps: 12 | Train Loss: 2.659 Vali Loss: 2.650 Vali Acc: 0.100 Test Loss: 2.650 Test Acc: 0.100
Validation loss decreased (-0.077751 --> -0.099974).  Saving model ...
Epoch: 3 cost time: 1.1920528411865234
Epoch: 3, Steps: 12 | Train Loss: 2.584 Vali Loss: 2.558 Vali Acc: 0.194 Test Loss: 2.558 Test Acc: 0.194
Validation loss decreased (-0.099974 --> -0.194419).  Saving model ...
Epoch: 4 cost time: 1.2426996231079102
Epoch: 4, Steps: 12 | Train Loss: 2.441 Vali Loss: 2.435 Vali Acc: 0.322 Test Loss: 2.435 Test Acc: 0.322
Validation loss decreased (-0.194419 --> -0.322198).  Saving model ...
Epoch: 5 cost time: 1.2447421550750732
Epoch: 5, Steps: 12 | Train Loss: 2.333 Vali Loss: 2.298 Vali Acc: 0.461 Test Loss: 2.298 Test Acc: 0.461
Validation loss decreased (-0.322198 --> -0.461088).  Saving model ...
Epoch: 6 cost time: 1.260713815689087
Epoch: 6, Steps: 12 | Train Loss: 2.153 Vali Loss: 2.161 Vali Acc: 0.567 Test Loss: 2.161 Test Acc: 0.567
Validation loss decreased (-0.461088 --> -0.566645).  Saving model ...
Epoch: 7 cost time: 1.2930059432983398
Epoch: 7, Steps: 12 | Train Loss: 2.001 Vali Loss: 2.008 Vali Acc: 0.606 Test Loss: 2.008 Test Acc: 0.606
Validation loss decreased (-0.566645 --> -0.605535).  Saving model ...
Epoch: 8 cost time: 1.2520513534545898
Epoch: 8, Steps: 12 | Train Loss: 1.806 Vali Loss: 1.831 Vali Acc: 0.622 Test Loss: 1.831 Test Acc: 0.622
Validation loss decreased (-0.605535 --> -0.622204).  Saving model ...
Epoch: 9 cost time: 1.2573869228363037
Epoch: 9, Steps: 12 | Train Loss: 1.643 Vali Loss: 1.643 Vali Acc: 0.667 Test Loss: 1.643 Test Acc: 0.667
Validation loss decreased (-0.622204 --> -0.666650).  Saving model ...
Epoch: 10 cost time: 1.2226858139038086
Epoch: 10, Steps: 12 | Train Loss: 1.428 Vali Loss: 1.491 Vali Acc: 0.683 Test Loss: 1.491 Test Acc: 0.683
Validation loss decreased (-0.666650 --> -0.683318).  Saving model ...
Epoch: 11 cost time: 1.1899347305297852
Epoch: 11, Steps: 12 | Train Loss: 1.272 Vali Loss: 1.320 Vali Acc: 0.672 Test Loss: 1.320 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2348911762237549
Epoch: 12, Steps: 12 | Train Loss: 1.081 Vali Loss: 1.206 Vali Acc: 0.706 Test Loss: 1.206 Test Acc: 0.706
Validation loss decreased (-0.683318 --> -0.705543).  Saving model ...
Epoch: 13 cost time: 1.1247804164886475
Epoch: 13, Steps: 12 | Train Loss: 0.950 Vali Loss: 1.082 Vali Acc: 0.739 Test Loss: 1.082 Test Acc: 0.739
Validation loss decreased (-0.705543 --> -0.738878).  Saving model ...
Epoch: 14 cost time: 1.242927074432373
Epoch: 14, Steps: 12 | Train Loss: 0.818 Vali Loss: 0.995 Vali Acc: 0.744 Test Loss: 0.995 Test Acc: 0.744
Validation loss decreased (-0.738878 --> -0.744434).  Saving model ...
Epoch: 15 cost time: 1.1258409023284912
Epoch: 15, Steps: 12 | Train Loss: 0.727 Vali Loss: 0.924 Vali Acc: 0.750 Test Loss: 0.924 Test Acc: 0.750
Validation loss decreased (-0.744434 --> -0.749991).  Saving model ...
Epoch: 16 cost time: 1.1324124336242676
Epoch: 16, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.842 Vali Acc: 0.783 Test Loss: 0.842 Test Acc: 0.783
Validation loss decreased (-0.749991 --> -0.783325).  Saving model ...
Epoch: 17 cost time: 1.084407091140747
Epoch: 17, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.763 Vali Acc: 0.811 Test Loss: 0.763 Test Acc: 0.811
Validation loss decreased (-0.783325 --> -0.811103).  Saving model ...
Epoch: 18 cost time: 1.113609790802002
Epoch: 18, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.728 Vali Acc: 0.783 Test Loss: 0.728 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1660282611846924
Epoch: 19, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.685 Vali Acc: 0.811 Test Loss: 0.685 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811104).  Saving model ...
Epoch: 20 cost time: 1.1406526565551758
Epoch: 20, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.639 Vali Acc: 0.828 Test Loss: 0.639 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 21 cost time: 1.128758192062378
Epoch: 21, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.611 Vali Acc: 0.839 Test Loss: 0.611 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838883).  Saving model ...
Epoch: 22 cost time: 1.11271333694458
Epoch: 22, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.601 Vali Acc: 0.844 Test Loss: 0.601 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 23 cost time: 1.1417896747589111
Epoch: 23, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.565 Vali Acc: 0.839 Test Loss: 0.565 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.257350206375122
Epoch: 24, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.544 Vali Acc: 0.856 Test Loss: 0.544 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855550).  Saving model ...
Epoch: 25 cost time: 1.2075307369232178
Epoch: 25, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.502 Vali Acc: 0.867 Test Loss: 0.502 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866662).  Saving model ...
Epoch: 26 cost time: 1.2225189208984375
Epoch: 26, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.499 Vali Acc: 0.867 Test Loss: 0.499 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 27 cost time: 1.2454822063446045
Epoch: 27, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.23834228515625
Epoch: 28, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.474 Vali Acc: 0.867 Test Loss: 0.474 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 29 cost time: 1.1945295333862305
Epoch: 29, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.484 Vali Acc: 0.861 Test Loss: 0.484 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2793831825256348
Epoch: 30, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.444 Vali Acc: 0.861 Test Loss: 0.444 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2902390956878662
Epoch: 31, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.458 Vali Acc: 0.872 Test Loss: 0.458 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872218).  Saving model ...
Epoch: 32 cost time: 1.2121682167053223
Epoch: 32, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.453 Vali Acc: 0.867 Test Loss: 0.453 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2358803749084473
Epoch: 33, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.465 Vali Acc: 0.878 Test Loss: 0.465 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877773).  Saving model ...
Epoch: 34 cost time: 1.2469122409820557
Epoch: 34, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.463 Vali Acc: 0.872 Test Loss: 0.463 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1994900703430176
Epoch: 35, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.472 Vali Acc: 0.878 Test Loss: 0.472 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2427735328674316
Epoch: 36, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.486 Vali Acc: 0.878 Test Loss: 0.486 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1694910526275635
Epoch: 37, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1517624855041504
Epoch: 38, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.506 Vali Acc: 0.861 Test Loss: 0.506 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.174731969833374
Epoch: 39, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.511 Vali Acc: 0.872 Test Loss: 0.511 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1342120170593262
Epoch: 40, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.466 Vali Acc: 0.883 Test Loss: 0.466 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 41 cost time: 1.147705316543579
Epoch: 41, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.470 Vali Acc: 0.878 Test Loss: 0.470 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1296272277832031
Epoch: 42, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.502 Vali Acc: 0.883 Test Loss: 0.502 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1506953239440918
Epoch: 43, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.496 Vali Acc: 0.889 Test Loss: 0.496 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 44 cost time: 1.1407794952392578
Epoch: 44, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.533 Vali Acc: 0.867 Test Loss: 0.533 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.225496530532837
Epoch: 45, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.544 Vali Acc: 0.878 Test Loss: 0.544 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.3300764560699463
Epoch: 46, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.517 Vali Acc: 0.889 Test Loss: 0.517 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.2694189548492432
Epoch: 47, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.509 Vali Acc: 0.883 Test Loss: 0.509 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.290170431137085
Epoch: 48, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.515 Vali Acc: 0.878 Test Loss: 0.515 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.2623202800750732
Epoch: 49, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.516 Vali Acc: 0.883 Test Loss: 0.516 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.1723062992095947
Epoch: 50, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.527 Vali Acc: 0.878 Test Loss: 0.527 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 395055
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5248353481292725
Epoch: 1, Steps: 12 | Train Loss: 2.681 Vali Loss: 2.692 Vali Acc: 0.111 Test Loss: 2.692 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 1.3914258480072021
Epoch: 2, Steps: 12 | Train Loss: 2.585 Vali Loss: 2.578 Vali Acc: 0.244 Test Loss: 2.578 Test Acc: 0.244
Validation loss decreased (-0.111084 --> -0.244419).  Saving model ...
Epoch: 3 cost time: 1.3889756202697754
Epoch: 3, Steps: 12 | Train Loss: 2.344 Vali Loss: 2.353 Vali Acc: 0.517 Test Loss: 2.353 Test Acc: 0.517
Validation loss decreased (-0.244419 --> -0.516643).  Saving model ...
Epoch: 4 cost time: 1.2761459350585938
Epoch: 4, Steps: 12 | Train Loss: 2.080 Vali Loss: 2.025 Vali Acc: 0.611 Test Loss: 2.025 Test Acc: 0.611
Validation loss decreased (-0.516643 --> -0.611091).  Saving model ...
Epoch: 5 cost time: 1.1750514507293701
Epoch: 5, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.677 Vali Acc: 0.644 Test Loss: 1.677 Test Acc: 0.644
Validation loss decreased (-0.611091 --> -0.644428).  Saving model ...
Epoch: 6 cost time: 1.1190111637115479
Epoch: 6, Steps: 12 | Train Loss: 1.392 Vali Loss: 1.390 Vali Acc: 0.667 Test Loss: 1.390 Test Acc: 0.667
Validation loss decreased (-0.644428 --> -0.666653).  Saving model ...
Epoch: 7 cost time: 1.1898376941680908
Epoch: 7, Steps: 12 | Train Loss: 1.105 Vali Loss: 1.174 Vali Acc: 0.717 Test Loss: 1.174 Test Acc: 0.717
Validation loss decreased (-0.666653 --> -0.716655).  Saving model ...
Epoch: 8 cost time: 1.172567367553711
Epoch: 8, Steps: 12 | Train Loss: 0.876 Vali Loss: 1.028 Vali Acc: 0.722 Test Loss: 1.028 Test Acc: 0.722
Validation loss decreased (-0.716655 --> -0.722212).  Saving model ...
Epoch: 9 cost time: 1.203390121459961
Epoch: 9, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.927 Vali Acc: 0.756 Test Loss: 0.927 Test Acc: 0.756
Validation loss decreased (-0.722212 --> -0.755546).  Saving model ...
Epoch: 10 cost time: 1.1881256103515625
Epoch: 10, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.832 Vali Acc: 0.767 Test Loss: 0.832 Test Acc: 0.767
Validation loss decreased (-0.755546 --> -0.766658).  Saving model ...
Epoch: 11 cost time: 1.2384989261627197
Epoch: 11, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.778 Vali Acc: 0.772 Test Loss: 0.778 Test Acc: 0.772
Validation loss decreased (-0.766658 --> -0.772214).  Saving model ...
Epoch: 12 cost time: 1.2474923133850098
Epoch: 12, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.708 Vali Acc: 0.828 Test Loss: 0.708 Test Acc: 0.828
Validation loss decreased (-0.772214 --> -0.827771).  Saving model ...
Epoch: 13 cost time: 1.3361332416534424
Epoch: 13, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.643 Vali Acc: 0.833 Test Loss: 0.643 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 14 cost time: 1.3409409523010254
Epoch: 14, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.631 Vali Acc: 0.839 Test Loss: 0.631 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 15 cost time: 1.3579514026641846
Epoch: 15, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.623 Vali Acc: 0.839 Test Loss: 0.623 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 16 cost time: 1.2950549125671387
Epoch: 16, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.600 Vali Acc: 0.872 Test Loss: 0.600 Test Acc: 0.872
Validation loss decreased (-0.838883 --> -0.872216).  Saving model ...
Epoch: 17 cost time: 1.3379263877868652
Epoch: 17, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.579 Vali Acc: 0.878 Test Loss: 0.579 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 18 cost time: 1.3090288639068604
Epoch: 18, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.570 Vali Acc: 0.878 Test Loss: 0.570 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 19 cost time: 1.4160511493682861
Epoch: 19, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.559 Vali Acc: 0.878 Test Loss: 0.559 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 20 cost time: 1.299797534942627
Epoch: 20, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.578 Vali Acc: 0.872 Test Loss: 0.578 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2696704864501953
Epoch: 21, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3613710403442383
Epoch: 22, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.616 Vali Acc: 0.878 Test Loss: 0.616 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3430290222167969
Epoch: 23, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.615 Vali Acc: 0.872 Test Loss: 0.615 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3660600185394287
Epoch: 24, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.635 Vali Acc: 0.883 Test Loss: 0.635 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 25 cost time: 1.355229377746582
Epoch: 25, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.633 Vali Acc: 0.878 Test Loss: 0.633 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3668022155761719
Epoch: 26, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.668 Vali Acc: 0.883 Test Loss: 0.668 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.119955062866211
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.640 Vali Acc: 0.878 Test Loss: 0.640 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1328082084655762
Epoch: 28, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.629 Vali Acc: 0.878 Test Loss: 0.629 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1309964656829834
Epoch: 29, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.669 Vali Acc: 0.883 Test Loss: 0.669 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1169605255126953
Epoch: 30, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.669 Vali Acc: 0.878 Test Loss: 0.669 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.125683069229126
Epoch: 31, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.659 Vali Acc: 0.883 Test Loss: 0.659 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1960535049438477
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.687 Vali Acc: 0.883 Test Loss: 0.687 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.253462314605713
Epoch: 33, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.754 Vali Acc: 0.861 Test Loss: 0.754 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.374612808227539
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.696 Vali Acc: 0.867 Test Loss: 0.696 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 431343
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4561767578125
Epoch: 1, Steps: 12 | Train Loss: 2.681 Vali Loss: 2.687 Vali Acc: 0.111 Test Loss: 2.687 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 1.21964430809021
Epoch: 2, Steps: 12 | Train Loss: 2.624 Vali Loss: 2.617 Vali Acc: 0.222 Test Loss: 2.617 Test Acc: 0.222
Validation loss decreased (-0.111084 --> -0.222196).  Saving model ...
Epoch: 3 cost time: 1.265324592590332
Epoch: 3, Steps: 12 | Train Loss: 2.466 Vali Loss: 2.489 Vali Acc: 0.356 Test Loss: 2.489 Test Acc: 0.356
Validation loss decreased (-0.222196 --> -0.355531).  Saving model ...
Epoch: 4 cost time: 1.2770812511444092
Epoch: 4, Steps: 12 | Train Loss: 2.304 Vali Loss: 2.310 Vali Acc: 0.478 Test Loss: 2.310 Test Acc: 0.478
Validation loss decreased (-0.355531 --> -0.477755).  Saving model ...
Epoch: 5 cost time: 1.2686305046081543
Epoch: 5, Steps: 12 | Train Loss: 2.067 Vali Loss: 2.083 Vali Acc: 0.556 Test Loss: 2.083 Test Acc: 0.556
Validation loss decreased (-0.477755 --> -0.555535).  Saving model ...
Epoch: 6 cost time: 1.2447247505187988
Epoch: 6, Steps: 12 | Train Loss: 1.804 Vali Loss: 1.842 Vali Acc: 0.572 Test Loss: 1.842 Test Acc: 0.572
Validation loss decreased (-0.555535 --> -0.572204).  Saving model ...
Epoch: 7 cost time: 1.2813458442687988
Epoch: 7, Steps: 12 | Train Loss: 1.592 Vali Loss: 1.617 Vali Acc: 0.594 Test Loss: 1.617 Test Acc: 0.594
Validation loss decreased (-0.572204 --> -0.594428).  Saving model ...
Epoch: 8 cost time: 1.1973121166229248
Epoch: 8, Steps: 12 | Train Loss: 1.318 Vali Loss: 1.438 Vali Acc: 0.606 Test Loss: 1.438 Test Acc: 0.606
Validation loss decreased (-0.594428 --> -0.605541).  Saving model ...
Epoch: 9 cost time: 1.178389549255371
Epoch: 9, Steps: 12 | Train Loss: 1.099 Vali Loss: 1.248 Vali Acc: 0.650 Test Loss: 1.248 Test Acc: 0.650
Validation loss decreased (-0.605541 --> -0.649988).  Saving model ...
Epoch: 10 cost time: 1.1972768306732178
Epoch: 10, Steps: 12 | Train Loss: 0.993 Vali Loss: 1.115 Vali Acc: 0.656 Test Loss: 1.115 Test Acc: 0.656
Validation loss decreased (-0.649988 --> -0.655544).  Saving model ...
Epoch: 11 cost time: 1.069920301437378
Epoch: 11, Steps: 12 | Train Loss: 0.782 Vali Loss: 1.030 Vali Acc: 0.683 Test Loss: 1.030 Test Acc: 0.683
Validation loss decreased (-0.655544 --> -0.683323).  Saving model ...
Epoch: 12 cost time: 1.0920758247375488
Epoch: 12, Steps: 12 | Train Loss: 0.705 Vali Loss: 0.923 Vali Acc: 0.728 Test Loss: 0.923 Test Acc: 0.728
Validation loss decreased (-0.683323 --> -0.727769).  Saving model ...
Epoch: 13 cost time: 1.0787322521209717
Epoch: 13, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.838 Vali Acc: 0.750 Test Loss: 0.838 Test Acc: 0.750
Validation loss decreased (-0.727769 --> -0.749992).  Saving model ...
Epoch: 14 cost time: 1.2044260501861572
Epoch: 14, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.784 Vali Acc: 0.750 Test Loss: 0.784 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 15 cost time: 1.1377966403961182
Epoch: 15, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.733 Vali Acc: 0.783 Test Loss: 0.733 Test Acc: 0.783
Validation loss decreased (-0.749992 --> -0.783326).  Saving model ...
Epoch: 16 cost time: 1.2197973728179932
Epoch: 16, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.678 Vali Acc: 0.822 Test Loss: 0.678 Test Acc: 0.822
Validation loss decreased (-0.783326 --> -0.822215).  Saving model ...
Epoch: 17 cost time: 1.188936710357666
Epoch: 17, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.631 Vali Acc: 0.828 Test Loss: 0.631 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 18 cost time: 1.2174859046936035
Epoch: 18, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.617 Vali Acc: 0.833 Test Loss: 0.617 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 19 cost time: 1.208615779876709
Epoch: 19, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.581 Vali Acc: 0.844 Test Loss: 0.581 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844439).  Saving model ...
Epoch: 20 cost time: 1.208313226699829
Epoch: 20, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.561 Vali Acc: 0.861 Test Loss: 0.561 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861106).  Saving model ...
Epoch: 21 cost time: 1.2385690212249756
Epoch: 21, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.544 Vali Acc: 0.856 Test Loss: 0.544 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2552447319030762
Epoch: 22, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.220541000366211
Epoch: 23, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.529 Vali Acc: 0.861 Test Loss: 0.529 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 24 cost time: 1.3101260662078857
Epoch: 24, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.537 Vali Acc: 0.861 Test Loss: 0.537 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3365061283111572
Epoch: 25, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.553 Vali Acc: 0.856 Test Loss: 0.553 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2520818710327148
Epoch: 26, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.549 Vali Acc: 0.872 Test Loss: 0.549 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 27 cost time: 1.2155323028564453
Epoch: 27, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.529 Vali Acc: 0.856 Test Loss: 0.529 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2012522220611572
Epoch: 28, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.555 Vali Acc: 0.856 Test Loss: 0.555 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.263249158859253
Epoch: 29, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.558 Vali Acc: 0.867 Test Loss: 0.558 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1990556716918945
Epoch: 30, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.547 Vali Acc: 0.872 Test Loss: 0.547 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 31 cost time: 1.2336394786834717
Epoch: 31, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.565 Vali Acc: 0.872 Test Loss: 0.565 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.142261266708374
Epoch: 32, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.564 Vali Acc: 0.867 Test Loss: 0.564 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1239733695983887
Epoch: 33, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.580 Vali Acc: 0.878 Test Loss: 0.580 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 34 cost time: 1.170635461807251
Epoch: 34, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.612 Vali Acc: 0.850 Test Loss: 0.612 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1264493465423584
Epoch: 35, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.618 Vali Acc: 0.878 Test Loss: 0.618 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1956722736358643
Epoch: 36, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.617 Vali Acc: 0.878 Test Loss: 0.617 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0173113346099854
Epoch: 37, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.627 Vali Acc: 0.872 Test Loss: 0.627 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.186431884765625
Epoch: 38, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.707 Vali Acc: 0.856 Test Loss: 0.707 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.163952350616455
Epoch: 39, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.619 Vali Acc: 0.878 Test Loss: 0.619 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.2468655109405518
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.647 Vali Acc: 0.872 Test Loss: 0.647 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.2464501857757568
Epoch: 41, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.634 Vali Acc: 0.872 Test Loss: 0.634 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.2381250858306885
Epoch: 42, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.589 Vali Acc: 0.867 Test Loss: 0.589 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.216890811920166
Epoch: 43, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.584 Vali Acc: 0.889 Test Loss: 0.584 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888883).  Saving model ...
Epoch: 44 cost time: 1.27573561668396
Epoch: 44, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.615 Vali Acc: 0.889 Test Loss: 0.615 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.3506529331207275
Epoch: 45, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.607 Vali Acc: 0.872 Test Loss: 0.607 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.3026294708251953
Epoch: 46, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.619 Vali Acc: 0.894 Test Loss: 0.619 Test Acc: 0.894
Validation loss decreased (-0.888883 --> -0.894438).  Saving model ...
Epoch: 47 cost time: 1.3291292190551758
Epoch: 47, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.673 Vali Acc: 0.883 Test Loss: 0.673 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.231562614440918
Epoch: 48, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.669 Vali Acc: 0.878 Test Loss: 0.669 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.2893791198730469
Epoch: 49, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.654 Vali Acc: 0.878 Test Loss: 0.654 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.2621493339538574
Epoch: 50, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.648 Vali Acc: 0.889 Test Loss: 0.648 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 408335
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.390676975250244
Epoch: 1, Steps: 12 | Train Loss: 2.727 Vali Loss: 2.715 Vali Acc: 0.028 Test Loss: 2.715 Test Acc: 0.028
Validation loss decreased (inf --> -0.027751).  Saving model ...
Epoch: 2 cost time: 1.161146879196167
Epoch: 2, Steps: 12 | Train Loss: 2.641 Vali Loss: 2.654 Vali Acc: 0.183 Test Loss: 2.654 Test Acc: 0.183
Validation loss decreased (-0.027751 --> -0.183307).  Saving model ...
Epoch: 3 cost time: 1.1357955932617188
Epoch: 3, Steps: 12 | Train Loss: 2.509 Vali Loss: 2.516 Vali Acc: 0.333 Test Loss: 2.516 Test Acc: 0.333
Validation loss decreased (-0.183307 --> -0.333308).  Saving model ...
Epoch: 4 cost time: 1.0921134948730469
Epoch: 4, Steps: 12 | Train Loss: 2.299 Vali Loss: 2.314 Vali Acc: 0.428 Test Loss: 2.314 Test Acc: 0.428
Validation loss decreased (-0.333308 --> -0.427755).  Saving model ...
Epoch: 5 cost time: 1.1233398914337158
Epoch: 5, Steps: 12 | Train Loss: 2.068 Vali Loss: 2.061 Vali Acc: 0.494 Test Loss: 2.061 Test Acc: 0.494
Validation loss decreased (-0.427755 --> -0.494424).  Saving model ...
Epoch: 6 cost time: 1.1116950511932373
Epoch: 6, Steps: 12 | Train Loss: 1.864 Vali Loss: 1.801 Vali Acc: 0.544 Test Loss: 1.801 Test Acc: 0.544
Validation loss decreased (-0.494424 --> -0.544426).  Saving model ...
Epoch: 7 cost time: 1.2455267906188965
Epoch: 7, Steps: 12 | Train Loss: 1.567 Vali Loss: 1.586 Vali Acc: 0.578 Test Loss: 1.586 Test Acc: 0.578
Validation loss decreased (-0.544426 --> -0.577762).  Saving model ...
Epoch: 8 cost time: 1.2134339809417725
Epoch: 8, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.372 Vali Acc: 0.622 Test Loss: 1.372 Test Acc: 0.622
Validation loss decreased (-0.577762 --> -0.622209).  Saving model ...
Epoch: 9 cost time: 1.3213555812835693
Epoch: 9, Steps: 12 | Train Loss: 1.100 Vali Loss: 1.195 Vali Acc: 0.678 Test Loss: 1.195 Test Acc: 0.678
Validation loss decreased (-0.622209 --> -0.677766).  Saving model ...
Epoch: 10 cost time: 1.2956726551055908
Epoch: 10, Steps: 12 | Train Loss: 0.895 Vali Loss: 1.068 Vali Acc: 0.683 Test Loss: 1.068 Test Acc: 0.683
Validation loss decreased (-0.677766 --> -0.683323).  Saving model ...
Epoch: 11 cost time: 1.3252689838409424
Epoch: 11, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.957 Vali Acc: 0.717 Test Loss: 0.957 Test Acc: 0.717
Validation loss decreased (-0.683323 --> -0.716657).  Saving model ...
Epoch: 12 cost time: 1.3028345108032227
Epoch: 12, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.870 Vali Acc: 0.733 Test Loss: 0.870 Test Acc: 0.733
Validation loss decreased (-0.716657 --> -0.733325).  Saving model ...
Epoch: 13 cost time: 1.322066068649292
Epoch: 13, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.780 Vali Acc: 0.750 Test Loss: 0.780 Test Acc: 0.750
Validation loss decreased (-0.733325 --> -0.749992).  Saving model ...
Epoch: 14 cost time: 1.2592523097991943
Epoch: 14, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.730 Vali Acc: 0.778 Test Loss: 0.730 Test Acc: 0.778
Validation loss decreased (-0.749992 --> -0.777770).  Saving model ...
Epoch: 15 cost time: 1.2309105396270752
Epoch: 15, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.686 Vali Acc: 0.794 Test Loss: 0.686 Test Acc: 0.794
Validation loss decreased (-0.777770 --> -0.794438).  Saving model ...
Epoch: 16 cost time: 1.2597358226776123
Epoch: 16, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.641 Vali Acc: 0.811 Test Loss: 0.641 Test Acc: 0.811
Validation loss decreased (-0.794438 --> -0.811105).  Saving model ...
Epoch: 17 cost time: 1.2429757118225098
Epoch: 17, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.591 Vali Acc: 0.839 Test Loss: 0.591 Test Acc: 0.839
Validation loss decreased (-0.811105 --> -0.838883).  Saving model ...
Epoch: 18 cost time: 1.222973346710205
Epoch: 18, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.593 Vali Acc: 0.828 Test Loss: 0.593 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2530348300933838
Epoch: 19, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.545 Vali Acc: 0.856 Test Loss: 0.545 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 20 cost time: 1.2790336608886719
Epoch: 20, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.537 Vali Acc: 0.856 Test Loss: 0.537 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 21 cost time: 1.2881474494934082
Epoch: 21, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.524 Vali Acc: 0.856 Test Loss: 0.524 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 22 cost time: 1.204949140548706
Epoch: 22, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.159989833831787
Epoch: 23, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0842986106872559
Epoch: 24, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0677764415740967
Epoch: 25, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.514 Vali Acc: 0.861 Test Loss: 0.514 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 26 cost time: 1.1181769371032715
Epoch: 26, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.508 Vali Acc: 0.861 Test Loss: 0.508 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 27 cost time: 1.127100944519043
Epoch: 27, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.514 Vali Acc: 0.878 Test Loss: 0.514 Test Acc: 0.878
Validation loss decreased (-0.861106 --> -0.877773).  Saving model ...
Epoch: 28 cost time: 1.088120937347412
Epoch: 28, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.522 Vali Acc: 0.861 Test Loss: 0.522 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2174532413482666
Epoch: 29, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.524 Vali Acc: 0.867 Test Loss: 0.524 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2878937721252441
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.546 Vali Acc: 0.878 Test Loss: 0.546 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3109979629516602
Epoch: 31, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.547 Vali Acc: 0.878 Test Loss: 0.547 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.3080286979675293
Epoch: 32, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.539 Vali Acc: 0.889 Test Loss: 0.539 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 33 cost time: 1.2650785446166992
Epoch: 33, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.537 Vali Acc: 0.872 Test Loss: 0.537 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2668943405151367
Epoch: 34, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.549 Vali Acc: 0.883 Test Loss: 0.549 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2022895812988281
Epoch: 35, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.567 Vali Acc: 0.883 Test Loss: 0.567 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2494328022003174
Epoch: 36, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.563 Vali Acc: 0.883 Test Loss: 0.563 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.2156555652618408
Epoch: 37, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.572 Vali Acc: 0.861 Test Loss: 0.572 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2036347389221191
Epoch: 38, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.552 Vali Acc: 0.867 Test Loss: 0.552 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.2398016452789307
Epoch: 39, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.555 Vali Acc: 0.878 Test Loss: 0.555 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.3391871452331543
Epoch: 40, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.584 Vali Acc: 0.878 Test Loss: 0.584 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.2535624504089355
Epoch: 41, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.563 Vali Acc: 0.883 Test Loss: 0.563 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.2947711944580078
Epoch: 42, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.573 Vali Acc: 0.894 Test Loss: 0.573 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894439).  Saving model ...
Epoch: 43 cost time: 1.34730863571167
Epoch: 43, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.603 Vali Acc: 0.883 Test Loss: 0.603 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1485471725463867
Epoch: 44, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.589 Vali Acc: 0.878 Test Loss: 0.589 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.1694905757904053
Epoch: 45, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.594 Vali Acc: 0.883 Test Loss: 0.594 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.1559491157531738
Epoch: 46, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.621 Vali Acc: 0.872 Test Loss: 0.621 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.1043550968170166
Epoch: 47, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.616 Vali Acc: 0.883 Test Loss: 0.616 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.0863640308380127
Epoch: 48, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.607 Vali Acc: 0.883 Test Loss: 0.607 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.083916425704956
Epoch: 49, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.598 Vali Acc: 0.883 Test Loss: 0.598 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.118356466293335
Epoch: 50, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.648 Vali Acc: 0.889 Test Loss: 0.648 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 408367
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4237804412841797
Epoch: 1, Steps: 12 | Train Loss: 2.683 Vali Loss: 2.697 Vali Acc: 0.128 Test Loss: 2.697 Test Acc: 0.128
Validation loss decreased (inf --> -0.127751).  Saving model ...
Epoch: 2 cost time: 1.1506578922271729
Epoch: 2, Steps: 12 | Train Loss: 2.604 Vali Loss: 2.633 Vali Acc: 0.228 Test Loss: 2.633 Test Acc: 0.228
Validation loss decreased (-0.127751 --> -0.227751).  Saving model ...
Epoch: 3 cost time: 1.1636230945587158
Epoch: 3, Steps: 12 | Train Loss: 2.467 Vali Loss: 2.507 Vali Acc: 0.383 Test Loss: 2.507 Test Acc: 0.383
Validation loss decreased (-0.227751 --> -0.383308).  Saving model ...
Epoch: 4 cost time: 1.1801729202270508
Epoch: 4, Steps: 12 | Train Loss: 2.335 Vali Loss: 2.331 Vali Acc: 0.472 Test Loss: 2.331 Test Acc: 0.472
Validation loss decreased (-0.383308 --> -0.472199).  Saving model ...
Epoch: 5 cost time: 1.2042605876922607
Epoch: 5, Steps: 12 | Train Loss: 2.123 Vali Loss: 2.122 Vali Acc: 0.561 Test Loss: 2.122 Test Acc: 0.561
Validation loss decreased (-0.472199 --> -0.561090).  Saving model ...
Epoch: 6 cost time: 1.2439992427825928
Epoch: 6, Steps: 12 | Train Loss: 1.895 Vali Loss: 1.898 Vali Acc: 0.556 Test Loss: 1.898 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1997504234313965
Epoch: 7, Steps: 12 | Train Loss: 1.655 Vali Loss: 1.670 Vali Acc: 0.600 Test Loss: 1.670 Test Acc: 0.600
Validation loss decreased (-0.561090 --> -0.599983).  Saving model ...
Epoch: 8 cost time: 1.218313217163086
Epoch: 8, Steps: 12 | Train Loss: 1.470 Vali Loss: 1.470 Vali Acc: 0.600 Test Loss: 1.470 Test Acc: 0.600
Validation loss decreased (-0.599983 --> -0.599985).  Saving model ...
Epoch: 9 cost time: 1.222357988357544
Epoch: 9, Steps: 12 | Train Loss: 1.261 Vali Loss: 1.294 Vali Acc: 0.644 Test Loss: 1.294 Test Acc: 0.644
Validation loss decreased (-0.599985 --> -0.644432).  Saving model ...
Epoch: 10 cost time: 1.245140790939331
Epoch: 10, Steps: 12 | Train Loss: 1.062 Vali Loss: 1.159 Vali Acc: 0.711 Test Loss: 1.159 Test Acc: 0.711
Validation loss decreased (-0.644432 --> -0.711100).  Saving model ...
Epoch: 11 cost time: 1.1225769519805908
Epoch: 11, Steps: 12 | Train Loss: 0.888 Vali Loss: 1.051 Vali Acc: 0.733 Test Loss: 1.051 Test Acc: 0.733
Validation loss decreased (-0.711100 --> -0.733323).  Saving model ...
Epoch: 12 cost time: 1.0606119632720947
Epoch: 12, Steps: 12 | Train Loss: 0.826 Vali Loss: 0.938 Vali Acc: 0.728 Test Loss: 0.938 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0401082038879395
Epoch: 13, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.871 Vali Acc: 0.733 Test Loss: 0.871 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733325).  Saving model ...
Epoch: 14 cost time: 1.174001932144165
Epoch: 14, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.807 Vali Acc: 0.744 Test Loss: 0.807 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744436).  Saving model ...
Epoch: 15 cost time: 0.9883899688720703
Epoch: 15, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.750 Vali Acc: 0.772 Test Loss: 0.750 Test Acc: 0.772
Validation loss decreased (-0.744436 --> -0.772215).  Saving model ...
Epoch: 16 cost time: 0.9673299789428711
Epoch: 16, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.711 Vali Acc: 0.794 Test Loss: 0.711 Test Acc: 0.794
Validation loss decreased (-0.772215 --> -0.794437).  Saving model ...
Epoch: 17 cost time: 1.113945484161377
Epoch: 17, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.669 Vali Acc: 0.828 Test Loss: 0.669 Test Acc: 0.828
Validation loss decreased (-0.794437 --> -0.827771).  Saving model ...
Epoch: 18 cost time: 1.1161324977874756
Epoch: 18, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.619 Vali Acc: 0.833 Test Loss: 0.619 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 19 cost time: 1.2720396518707275
Epoch: 19, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.602 Vali Acc: 0.839 Test Loss: 0.602 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 20 cost time: 1.1944310665130615
Epoch: 20, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.570 Vali Acc: 0.861 Test Loss: 0.570 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861105).  Saving model ...
Epoch: 21 cost time: 1.1638405323028564
Epoch: 21, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 22 cost time: 1.240675687789917
Epoch: 22, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.544 Vali Acc: 0.867 Test Loss: 0.544 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 23 cost time: 1.2084710597991943
Epoch: 23, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.502 Vali Acc: 0.867 Test Loss: 0.502 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 24 cost time: 1.1620066165924072
Epoch: 24, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.506 Vali Acc: 0.856 Test Loss: 0.506 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2154898643493652
Epoch: 25, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.523 Vali Acc: 0.878 Test Loss: 0.523 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 26 cost time: 1.1822707653045654
Epoch: 26, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2397751808166504
Epoch: 27, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.498 Vali Acc: 0.867 Test Loss: 0.498 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.308276653289795
Epoch: 28, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.513 Vali Acc: 0.878 Test Loss: 0.513 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 29 cost time: 1.3077161312103271
Epoch: 29, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.510 Vali Acc: 0.889 Test Loss: 0.510 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 30 cost time: 1.2956655025482178
Epoch: 30, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.507 Vali Acc: 0.889 Test Loss: 0.507 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 31 cost time: 1.2206382751464844
Epoch: 31, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.491 Vali Acc: 0.883 Test Loss: 0.491 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2232913970947266
Epoch: 32, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.494 Vali Acc: 0.883 Test Loss: 0.494 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2330799102783203
Epoch: 33, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.496 Vali Acc: 0.894 Test Loss: 0.496 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894439).  Saving model ...
Epoch: 34 cost time: 1.1278109550476074
Epoch: 34, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.500 Vali Acc: 0.894 Test Loss: 0.500 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.066699504852295
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.517 Vali Acc: 0.889 Test Loss: 0.517 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1178326606750488
Epoch: 36, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.513 Vali Acc: 0.878 Test Loss: 0.513 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1554672718048096
Epoch: 37, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.512 Vali Acc: 0.872 Test Loss: 0.512 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.126969814300537
Epoch: 38, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.503 Vali Acc: 0.878 Test Loss: 0.503 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0438556671142578
Epoch: 39, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.527 Vali Acc: 0.900 Test Loss: 0.527 Test Acc: 0.900
Validation loss decreased (-0.894439 --> -0.899995).  Saving model ...
Epoch: 40 cost time: 1.0617647171020508
Epoch: 40, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.530 Vali Acc: 0.883 Test Loss: 0.530 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9763002395629883
Epoch: 41, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.535 Vali Acc: 0.889 Test Loss: 0.535 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0912747383117676
Epoch: 42, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.528 Vali Acc: 0.889 Test Loss: 0.528 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0894978046417236
Epoch: 43, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.567 Vali Acc: 0.878 Test Loss: 0.567 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.1445941925048828
Epoch: 44, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.560 Vali Acc: 0.883 Test Loss: 0.560 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.159616470336914
Epoch: 45, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.591 Vali Acc: 0.883 Test Loss: 0.591 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.2358412742614746
Epoch: 46, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.561 Vali Acc: 0.878 Test Loss: 0.561 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.2459297180175781
Epoch: 47, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.541 Vali Acc: 0.889 Test Loss: 0.541 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.2784092426300049
Epoch: 48, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.549 Vali Acc: 0.889 Test Loss: 0.549 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.2896416187286377
Epoch: 49, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.600 Vali Acc: 0.872 Test Loss: 0.600 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 400719
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4382355213165283
Epoch: 1, Steps: 12 | Train Loss: 2.727 Vali Loss: 2.709 Vali Acc: 0.017 Test Loss: 2.709 Test Acc: 0.017
Validation loss decreased (inf --> -0.016640).  Saving model ...
Epoch: 2 cost time: 1.2356531620025635
Epoch: 2, Steps: 12 | Train Loss: 2.654 Vali Loss: 2.655 Vali Acc: 0.117 Test Loss: 2.655 Test Acc: 0.117
Validation loss decreased (-0.016640 --> -0.116640).  Saving model ...
Epoch: 3 cost time: 1.1794507503509521
Epoch: 3, Steps: 12 | Train Loss: 2.575 Vali Loss: 2.547 Vali Acc: 0.344 Test Loss: 2.547 Test Acc: 0.344
Validation loss decreased (-0.116640 --> -0.344419).  Saving model ...
Epoch: 4 cost time: 1.187530517578125
Epoch: 4, Steps: 12 | Train Loss: 2.440 Vali Loss: 2.413 Vali Acc: 0.500 Test Loss: 2.413 Test Acc: 0.500
Validation loss decreased (-0.344419 --> -0.499976).  Saving model ...
Epoch: 5 cost time: 1.2117962837219238
Epoch: 5, Steps: 12 | Train Loss: 2.300 Vali Loss: 2.245 Vali Acc: 0.522 Test Loss: 2.245 Test Acc: 0.522
Validation loss decreased (-0.499976 --> -0.522200).  Saving model ...
Epoch: 6 cost time: 1.1653268337249756
Epoch: 6, Steps: 12 | Train Loss: 2.098 Vali Loss: 2.092 Vali Acc: 0.567 Test Loss: 2.092 Test Acc: 0.567
Validation loss decreased (-0.522200 --> -0.566646).  Saving model ...
Epoch: 7 cost time: 1.1426575183868408
Epoch: 7, Steps: 12 | Train Loss: 1.914 Vali Loss: 1.875 Vali Acc: 0.594 Test Loss: 1.875 Test Acc: 0.594
Validation loss decreased (-0.566646 --> -0.594426).  Saving model ...
Epoch: 8 cost time: 1.1875207424163818
Epoch: 8, Steps: 12 | Train Loss: 1.686 Vali Loss: 1.696 Vali Acc: 0.611 Test Loss: 1.696 Test Acc: 0.611
Validation loss decreased (-0.594426 --> -0.611094).  Saving model ...
Epoch: 9 cost time: 1.0333642959594727
Epoch: 9, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.501 Vali Acc: 0.644 Test Loss: 1.501 Test Acc: 0.644
Validation loss decreased (-0.611094 --> -0.644429).  Saving model ...
Epoch: 10 cost time: 1.039501667022705
Epoch: 10, Steps: 12 | Train Loss: 1.229 Vali Loss: 1.332 Vali Acc: 0.661 Test Loss: 1.332 Test Acc: 0.661
Validation loss decreased (-0.644429 --> -0.661098).  Saving model ...
Epoch: 11 cost time: 1.2042014598846436
Epoch: 11, Steps: 12 | Train Loss: 1.059 Vali Loss: 1.191 Vali Acc: 0.678 Test Loss: 1.191 Test Acc: 0.678
Validation loss decreased (-0.661098 --> -0.677766).  Saving model ...
Epoch: 12 cost time: 1.1661465167999268
Epoch: 12, Steps: 12 | Train Loss: 0.884 Vali Loss: 1.083 Vali Acc: 0.683 Test Loss: 1.083 Test Acc: 0.683
Validation loss decreased (-0.677766 --> -0.683323).  Saving model ...
Epoch: 13 cost time: 1.2171502113342285
Epoch: 13, Steps: 12 | Train Loss: 0.787 Vali Loss: 0.969 Vali Acc: 0.717 Test Loss: 0.969 Test Acc: 0.717
Validation loss decreased (-0.683323 --> -0.716657).  Saving model ...
Epoch: 14 cost time: 1.128469467163086
Epoch: 14, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.891 Vali Acc: 0.744 Test Loss: 0.891 Test Acc: 0.744
Validation loss decreased (-0.716657 --> -0.744436).  Saving model ...
Epoch: 15 cost time: 1.2885582447052002
Epoch: 15, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.846 Vali Acc: 0.761 Test Loss: 0.846 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761103).  Saving model ...
Epoch: 16 cost time: 1.304408073425293
Epoch: 16, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.762 Vali Acc: 0.761 Test Loss: 0.762 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761103).  Saving model ...
Epoch: 17 cost time: 1.3405518531799316
Epoch: 17, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.728 Vali Acc: 0.767 Test Loss: 0.728 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766659).  Saving model ...
Epoch: 18 cost time: 1.285290002822876
Epoch: 18, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.677 Vali Acc: 0.811 Test Loss: 0.677 Test Acc: 0.811
Validation loss decreased (-0.766659 --> -0.811104).  Saving model ...
Epoch: 19 cost time: 1.291978359222412
Epoch: 19, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.651 Vali Acc: 0.811 Test Loss: 0.651 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811105).  Saving model ...
Epoch: 20 cost time: 1.2219302654266357
Epoch: 20, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.604 Vali Acc: 0.833 Test Loss: 0.604 Test Acc: 0.833
Validation loss decreased (-0.811105 --> -0.833327).  Saving model ...
Epoch: 21 cost time: 1.197216510772705
Epoch: 21, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.590 Vali Acc: 0.822 Test Loss: 0.590 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.21763277053833
Epoch: 22, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 1.212268352508545
Epoch: 23, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 24 cost time: 1.2373754978179932
Epoch: 24, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 25 cost time: 1.3190264701843262
Epoch: 25, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.510 Vali Acc: 0.861 Test Loss: 0.510 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861106).  Saving model ...
Epoch: 26 cost time: 1.2065949440002441
Epoch: 26, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1803882122039795
Epoch: 27, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.484 Vali Acc: 0.878 Test Loss: 0.484 Test Acc: 0.878
Validation loss decreased (-0.861106 --> -0.877773).  Saving model ...
Epoch: 28 cost time: 1.210141658782959
Epoch: 28, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.475 Vali Acc: 0.861 Test Loss: 0.475 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.199573040008545
Epoch: 29, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1341521739959717
Epoch: 30, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.479 Vali Acc: 0.861 Test Loss: 0.479 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1713223457336426
Epoch: 31, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.477 Vali Acc: 0.878 Test Loss: 0.477 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 32 cost time: 1.1496827602386475
Epoch: 32, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.474 Vali Acc: 0.872 Test Loss: 0.474 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1888020038604736
Epoch: 33, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.512 Vali Acc: 0.856 Test Loss: 0.512 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.129577398300171
Epoch: 34, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.499 Vali Acc: 0.878 Test Loss: 0.499 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1779568195343018
Epoch: 35, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.518 Vali Acc: 0.856 Test Loss: 0.518 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1989338397979736
Epoch: 36, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.485 Vali Acc: 0.878 Test Loss: 0.485 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2340872287750244
Epoch: 37, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.506 Vali Acc: 0.878 Test Loss: 0.506 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2767729759216309
Epoch: 38, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.475 Vali Acc: 0.883 Test Loss: 0.475 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 39 cost time: 1.327225685119629
Epoch: 39, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.462 Vali Acc: 0.883 Test Loss: 0.462 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883329).  Saving model ...
Epoch: 40 cost time: 1.246778964996338
Epoch: 40, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.485 Vali Acc: 0.889 Test Loss: 0.485 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 41 cost time: 1.1712629795074463
Epoch: 41, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.481 Vali Acc: 0.883 Test Loss: 0.481 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2097434997558594
Epoch: 42, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.500 Vali Acc: 0.883 Test Loss: 0.500 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2312359809875488
Epoch: 43, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.492 Vali Acc: 0.889 Test Loss: 0.492 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.2231724262237549
Epoch: 44, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.503 Vali Acc: 0.878 Test Loss: 0.503 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.194265604019165
Epoch: 45, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.503 Vali Acc: 0.883 Test Loss: 0.503 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.2658593654632568
Epoch: 46, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.570 Vali Acc: 0.861 Test Loss: 0.570 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.262617826461792
Epoch: 47, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.536 Vali Acc: 0.867 Test Loss: 0.536 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.1554639339447021
Epoch: 48, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.553 Vali Acc: 0.861 Test Loss: 0.553 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.1876649856567383
Epoch: 49, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.524 Vali Acc: 0.867 Test Loss: 0.524 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.1581223011016846
Epoch: 50, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.537 Vali Acc: 0.878 Test Loss: 0.537 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 396943
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5321435928344727
Epoch: 1, Steps: 12 | Train Loss: 2.773 Vali Loss: 2.716 Vali Acc: 0.011 Test Loss: 2.716 Test Acc: 0.011
Validation loss decreased (inf --> -0.011084).  Saving model ...
Epoch: 2 cost time: 1.2252881526947021
Epoch: 2, Steps: 12 | Train Loss: 2.672 Vali Loss: 2.656 Vali Acc: 0.089 Test Loss: 2.656 Test Acc: 0.089
Validation loss decreased (-0.011084 --> -0.088862).  Saving model ...
Epoch: 3 cost time: 1.2326877117156982
Epoch: 3, Steps: 12 | Train Loss: 2.566 Vali Loss: 2.544 Vali Acc: 0.222 Test Loss: 2.544 Test Acc: 0.222
Validation loss decreased (-0.088862 --> -0.222197).  Saving model ...
Epoch: 4 cost time: 1.2796151638031006
Epoch: 4, Steps: 12 | Train Loss: 2.441 Vali Loss: 2.401 Vali Acc: 0.322 Test Loss: 2.401 Test Acc: 0.322
Validation loss decreased (-0.222197 --> -0.322198).  Saving model ...
Epoch: 5 cost time: 1.1774640083312988
Epoch: 5, Steps: 12 | Train Loss: 2.263 Vali Loss: 2.233 Vali Acc: 0.411 Test Loss: 2.233 Test Acc: 0.411
Validation loss decreased (-0.322198 --> -0.411089).  Saving model ...
Epoch: 6 cost time: 1.1911580562591553
Epoch: 6, Steps: 12 | Train Loss: 2.101 Vali Loss: 2.050 Vali Acc: 0.494 Test Loss: 2.050 Test Acc: 0.494
Validation loss decreased (-0.411089 --> -0.494424).  Saving model ...
Epoch: 7 cost time: 1.230769157409668
Epoch: 7, Steps: 12 | Train Loss: 1.898 Vali Loss: 1.887 Vali Acc: 0.533 Test Loss: 1.887 Test Acc: 0.533
Validation loss decreased (-0.494424 --> -0.533314).  Saving model ...
Epoch: 8 cost time: 1.2857270240783691
Epoch: 8, Steps: 12 | Train Loss: 1.745 Vali Loss: 1.692 Vali Acc: 0.550 Test Loss: 1.692 Test Acc: 0.550
Validation loss decreased (-0.533314 --> -0.549983).  Saving model ...
Epoch: 9 cost time: 1.2420339584350586
Epoch: 9, Steps: 12 | Train Loss: 1.516 Vali Loss: 1.532 Vali Acc: 0.600 Test Loss: 1.532 Test Acc: 0.600
Validation loss decreased (-0.549983 --> -0.599985).  Saving model ...
Epoch: 10 cost time: 1.2491028308868408
Epoch: 10, Steps: 12 | Train Loss: 1.314 Vali Loss: 1.392 Vali Acc: 0.611 Test Loss: 1.392 Test Acc: 0.611
Validation loss decreased (-0.599985 --> -0.611097).  Saving model ...
Epoch: 11 cost time: 1.2786569595336914
Epoch: 11, Steps: 12 | Train Loss: 1.155 Vali Loss: 1.262 Vali Acc: 0.633 Test Loss: 1.262 Test Acc: 0.633
Validation loss decreased (-0.611097 --> -0.633321).  Saving model ...
Epoch: 12 cost time: 1.2870917320251465
Epoch: 12, Steps: 12 | Train Loss: 0.976 Vali Loss: 1.132 Vali Acc: 0.689 Test Loss: 1.132 Test Acc: 0.689
Validation loss decreased (-0.633321 --> -0.688878).  Saving model ...
Epoch: 13 cost time: 1.3333244323730469
Epoch: 13, Steps: 12 | Train Loss: 0.872 Vali Loss: 1.027 Vali Acc: 0.700 Test Loss: 1.027 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699990).  Saving model ...
Epoch: 14 cost time: 1.305711269378662
Epoch: 14, Steps: 12 | Train Loss: 0.751 Vali Loss: 0.955 Vali Acc: 0.739 Test Loss: 0.955 Test Acc: 0.739
Validation loss decreased (-0.699990 --> -0.738879).  Saving model ...
Epoch: 15 cost time: 1.2233142852783203
Epoch: 15, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.874 Vali Acc: 0.756 Test Loss: 0.874 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755547).  Saving model ...
Epoch: 16 cost time: 1.188673734664917
Epoch: 16, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.814 Vali Acc: 0.767 Test Loss: 0.814 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766659).  Saving model ...
Epoch: 17 cost time: 1.1550066471099854
Epoch: 17, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.762 Vali Acc: 0.783 Test Loss: 0.762 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783326).  Saving model ...
Epoch: 18 cost time: 1.032710313796997
Epoch: 18, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.714 Vali Acc: 0.811 Test Loss: 0.714 Test Acc: 0.811
Validation loss decreased (-0.783326 --> -0.811104).  Saving model ...
Epoch: 19 cost time: 1.0839128494262695
Epoch: 19, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.663 Vali Acc: 0.844 Test Loss: 0.663 Test Acc: 0.844
Validation loss decreased (-0.811104 --> -0.844438).  Saving model ...
Epoch: 20 cost time: 1.0662238597869873
Epoch: 20, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.630 Vali Acc: 0.856 Test Loss: 0.630 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 21 cost time: 1.1300938129425049
Epoch: 21, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.625 Vali Acc: 0.833 Test Loss: 0.625 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1416611671447754
Epoch: 22, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.582 Vali Acc: 0.861 Test Loss: 0.582 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 23 cost time: 1.2690904140472412
Epoch: 23, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.556 Vali Acc: 0.878 Test Loss: 0.556 Test Acc: 0.878
Validation loss decreased (-0.861105 --> -0.877772).  Saving model ...
Epoch: 24 cost time: 1.2159380912780762
Epoch: 24, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.541 Vali Acc: 0.878 Test Loss: 0.541 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 25 cost time: 1.2108817100524902
Epoch: 25, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.547 Vali Acc: 0.867 Test Loss: 0.547 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.113377571105957
Epoch: 26, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.530 Vali Acc: 0.878 Test Loss: 0.530 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 27 cost time: 1.1461677551269531
Epoch: 27, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.543 Vali Acc: 0.883 Test Loss: 0.543 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 28 cost time: 1.145185947418213
Epoch: 28, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.522 Vali Acc: 0.878 Test Loss: 0.522 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2189242839813232
Epoch: 29, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.509 Vali Acc: 0.883 Test Loss: 0.509 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 30 cost time: 1.256115198135376
Epoch: 30, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.505 Vali Acc: 0.883 Test Loss: 0.505 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 31 cost time: 1.3168950080871582
Epoch: 31, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.502 Vali Acc: 0.867 Test Loss: 0.502 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2779598236083984
Epoch: 32, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.521 Vali Acc: 0.883 Test Loss: 0.521 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2750446796417236
Epoch: 33, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.505 Vali Acc: 0.872 Test Loss: 0.505 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2807211875915527
Epoch: 34, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.522 Vali Acc: 0.883 Test Loss: 0.522 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.244504690170288
Epoch: 35, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.527 Vali Acc: 0.883 Test Loss: 0.527 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.2143700122833252
Epoch: 36, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.574 Vali Acc: 0.878 Test Loss: 0.574 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.1012988090515137
Epoch: 37, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.561 Vali Acc: 0.872 Test Loss: 0.561 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.137509822845459
Epoch: 38, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.598 Vali Acc: 0.878 Test Loss: 0.598 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.1583869457244873
Epoch: 39, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.557 Vali Acc: 0.861 Test Loss: 0.557 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.1354906558990479
Epoch: 40, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.578 Vali Acc: 0.872 Test Loss: 0.578 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 397007
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.408419132232666
Epoch: 1, Steps: 12 | Train Loss: 2.750 Vali Loss: 2.712 Vali Acc: 0.089 Test Loss: 2.712 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 1.0925366878509521
Epoch: 2, Steps: 12 | Train Loss: 2.665 Vali Loss: 2.669 Vali Acc: 0.139 Test Loss: 2.669 Test Acc: 0.139
Validation loss decreased (-0.088862 --> -0.138862).  Saving model ...
Epoch: 3 cost time: 1.154468059539795
Epoch: 3, Steps: 12 | Train Loss: 2.586 Vali Loss: 2.580 Vali Acc: 0.239 Test Loss: 2.580 Test Acc: 0.239
Validation loss decreased (-0.138862 --> -0.238863).  Saving model ...
Epoch: 4 cost time: 1.1443500518798828
Epoch: 4, Steps: 12 | Train Loss: 2.467 Vali Loss: 2.455 Vali Acc: 0.344 Test Loss: 2.455 Test Acc: 0.344
Validation loss decreased (-0.238863 --> -0.344420).  Saving model ...
Epoch: 5 cost time: 1.15437912940979
Epoch: 5, Steps: 12 | Train Loss: 2.334 Vali Loss: 2.333 Vali Acc: 0.444 Test Loss: 2.333 Test Acc: 0.444
Validation loss decreased (-0.344420 --> -0.444421).  Saving model ...
Epoch: 6 cost time: 1.2208752632141113
Epoch: 6, Steps: 12 | Train Loss: 2.203 Vali Loss: 2.186 Vali Acc: 0.472 Test Loss: 2.186 Test Acc: 0.472
Validation loss decreased (-0.444421 --> -0.472200).  Saving model ...
Epoch: 7 cost time: 1.1482563018798828
Epoch: 7, Steps: 12 | Train Loss: 2.058 Vali Loss: 2.023 Vali Acc: 0.500 Test Loss: 2.023 Test Acc: 0.500
Validation loss decreased (-0.472200 --> -0.499980).  Saving model ...
Epoch: 8 cost time: 1.1853876113891602
Epoch: 8, Steps: 12 | Train Loss: 1.872 Vali Loss: 1.884 Vali Acc: 0.578 Test Loss: 1.884 Test Acc: 0.578
Validation loss decreased (-0.499980 --> -0.577759).  Saving model ...
Epoch: 9 cost time: 1.1693215370178223
Epoch: 9, Steps: 12 | Train Loss: 1.706 Vali Loss: 1.695 Vali Acc: 0.628 Test Loss: 1.695 Test Acc: 0.628
Validation loss decreased (-0.577759 --> -0.627761).  Saving model ...
Epoch: 10 cost time: 1.2213711738586426
Epoch: 10, Steps: 12 | Train Loss: 1.486 Vali Loss: 1.540 Vali Acc: 0.667 Test Loss: 1.540 Test Acc: 0.667
Validation loss decreased (-0.627761 --> -0.666651).  Saving model ...
Epoch: 11 cost time: 1.2164137363433838
Epoch: 11, Steps: 12 | Train Loss: 1.361 Vali Loss: 1.398 Vali Acc: 0.700 Test Loss: 1.398 Test Acc: 0.700
Validation loss decreased (-0.666651 --> -0.699986).  Saving model ...
Epoch: 12 cost time: 1.2355525493621826
Epoch: 12, Steps: 12 | Train Loss: 1.177 Vali Loss: 1.262 Vali Acc: 0.700 Test Loss: 1.262 Test Acc: 0.700
Validation loss decreased (-0.699986 --> -0.699987).  Saving model ...
Epoch: 13 cost time: 1.2964587211608887
Epoch: 13, Steps: 12 | Train Loss: 1.048 Vali Loss: 1.137 Vali Acc: 0.739 Test Loss: 1.137 Test Acc: 0.739
Validation loss decreased (-0.699987 --> -0.738878).  Saving model ...
Epoch: 14 cost time: 1.197122573852539
Epoch: 14, Steps: 12 | Train Loss: 0.911 Vali Loss: 1.052 Vali Acc: 0.739 Test Loss: 1.052 Test Acc: 0.739
Validation loss decreased (-0.738878 --> -0.738878).  Saving model ...
Epoch: 15 cost time: 1.1614470481872559
Epoch: 15, Steps: 12 | Train Loss: 0.761 Vali Loss: 0.963 Vali Acc: 0.756 Test Loss: 0.963 Test Acc: 0.756
Validation loss decreased (-0.738878 --> -0.755546).  Saving model ...
Epoch: 16 cost time: 1.1661009788513184
Epoch: 16, Steps: 12 | Train Loss: 0.709 Vali Loss: 0.901 Vali Acc: 0.756 Test Loss: 0.901 Test Acc: 0.756
Validation loss decreased (-0.755546 --> -0.755547).  Saving model ...
Epoch: 17 cost time: 1.1441292762756348
Epoch: 17, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.850 Vali Acc: 0.778 Test Loss: 0.850 Test Acc: 0.778
Validation loss decreased (-0.755547 --> -0.777769).  Saving model ...
Epoch: 18 cost time: 1.069666862487793
Epoch: 18, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.790 Vali Acc: 0.794 Test Loss: 0.790 Test Acc: 0.794
Validation loss decreased (-0.777769 --> -0.794437).  Saving model ...
Epoch: 19 cost time: 1.1755707263946533
Epoch: 19, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.727 Vali Acc: 0.800 Test Loss: 0.727 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 20 cost time: 1.1135635375976562
Epoch: 20, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.705 Vali Acc: 0.800 Test Loss: 0.705 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 21 cost time: 1.1417031288146973
Epoch: 21, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.675 Vali Acc: 0.817 Test Loss: 0.675 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816660).  Saving model ...
Epoch: 22 cost time: 1.2125060558319092
Epoch: 22, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.622 Vali Acc: 0.822 Test Loss: 0.622 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 23 cost time: 1.2680554389953613
Epoch: 23, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.586 Vali Acc: 0.844 Test Loss: 0.586 Test Acc: 0.844
Validation loss decreased (-0.822216 --> -0.844439).  Saving model ...
Epoch: 24 cost time: 1.2427833080291748
Epoch: 24, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.560 Vali Acc: 0.839 Test Loss: 0.560 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2228913307189941
Epoch: 25, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.548 Vali Acc: 0.861 Test Loss: 0.548 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861106).  Saving model ...
Epoch: 26 cost time: 1.2100708484649658
Epoch: 26, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.529 Vali Acc: 0.861 Test Loss: 0.529 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 27 cost time: 1.1410350799560547
Epoch: 27, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.516 Vali Acc: 0.856 Test Loss: 0.516 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1303257942199707
Epoch: 28, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.503 Vali Acc: 0.872 Test Loss: 0.503 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 29 cost time: 1.120811939239502
Epoch: 29, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.498 Vali Acc: 0.867 Test Loss: 0.498 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2394804954528809
Epoch: 30, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1983909606933594
Epoch: 31, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.487 Vali Acc: 0.856 Test Loss: 0.487 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2069828510284424
Epoch: 32, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.478 Vali Acc: 0.856 Test Loss: 0.478 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.18943452835083
Epoch: 33, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.465 Vali Acc: 0.872 Test Loss: 0.465 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872218).  Saving model ...
Epoch: 34 cost time: 1.256558895111084
Epoch: 34, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.485 Vali Acc: 0.883 Test Loss: 0.485 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883328).  Saving model ...
Epoch: 35 cost time: 1.2480168342590332
Epoch: 35, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.495 Vali Acc: 0.889 Test Loss: 0.495 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888884).  Saving model ...
Epoch: 36 cost time: 1.109619140625
Epoch: 36, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.484 Vali Acc: 0.883 Test Loss: 0.484 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.133535385131836
Epoch: 37, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.483 Vali Acc: 0.894 Test Loss: 0.483 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 38 cost time: 1.078758955001831
Epoch: 38, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.473 Vali Acc: 0.883 Test Loss: 0.473 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0925383567810059
Epoch: 39, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.488 Vali Acc: 0.872 Test Loss: 0.488 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1578965187072754
Epoch: 40, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.505 Vali Acc: 0.867 Test Loss: 0.505 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.150270700454712
Epoch: 41, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.488 Vali Acc: 0.867 Test Loss: 0.488 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.136622428894043
Epoch: 42, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.477 Vali Acc: 0.867 Test Loss: 0.477 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.2231032848358154
Epoch: 43, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.493 Vali Acc: 0.878 Test Loss: 0.493 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.236051082611084
Epoch: 44, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.508 Vali Acc: 0.867 Test Loss: 0.508 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.1985597610473633
Epoch: 45, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.514 Vali Acc: 0.889 Test Loss: 0.514 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.1877827644348145
Epoch: 46, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.544 Vali Acc: 0.878 Test Loss: 0.544 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.1700093746185303
Epoch: 47, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.526 Vali Acc: 0.867 Test Loss: 0.526 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 393263
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.890213966369629
Epoch: 1, Steps: 12 | Train Loss: 2.634 Vali Loss: 2.511 Vali Acc: 0.350 Test Loss: 2.511 Test Acc: 0.350
Validation loss decreased (inf --> -0.349975).  Saving model ...
Epoch: 2 cost time: 1.6683447360992432
Epoch: 2, Steps: 12 | Train Loss: 2.116 Vali Loss: 1.994 Vali Acc: 0.556 Test Loss: 1.994 Test Acc: 0.556
Validation loss decreased (-0.349975 --> -0.555536).  Saving model ...
Epoch: 3 cost time: 1.6307244300842285
Epoch: 3, Steps: 12 | Train Loss: 1.456 Vali Loss: 1.433 Vali Acc: 0.628 Test Loss: 1.433 Test Acc: 0.628
Validation loss decreased (-0.555536 --> -0.627763).  Saving model ...
Epoch: 4 cost time: 1.5846011638641357
Epoch: 4, Steps: 12 | Train Loss: 1.023 Vali Loss: 1.133 Vali Acc: 0.650 Test Loss: 1.133 Test Acc: 0.650
Validation loss decreased (-0.627763 --> -0.649989).  Saving model ...
Epoch: 5 cost time: 1.45066499710083
Epoch: 5, Steps: 12 | Train Loss: 0.717 Vali Loss: 0.961 Vali Acc: 0.689 Test Loss: 0.961 Test Acc: 0.689
Validation loss decreased (-0.649989 --> -0.688879).  Saving model ...
Epoch: 6 cost time: 1.496628999710083
Epoch: 6, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.881 Vali Acc: 0.722 Test Loss: 0.881 Test Acc: 0.722
Validation loss decreased (-0.688879 --> -0.722213).  Saving model ...
Epoch: 7 cost time: 1.5314998626708984
Epoch: 7, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.879 Vali Acc: 0.744 Test Loss: 0.879 Test Acc: 0.744
Validation loss decreased (-0.722213 --> -0.744436).  Saving model ...
Epoch: 8 cost time: 1.5570166110992432
Epoch: 8, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.794 Vali Acc: 0.783 Test Loss: 0.794 Test Acc: 0.783
Validation loss decreased (-0.744436 --> -0.783325).  Saving model ...
Epoch: 9 cost time: 1.607365369796753
Epoch: 9, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.794 Vali Acc: 0.772 Test Loss: 0.794 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5926017761230469
Epoch: 10, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.874 Vali Acc: 0.767 Test Loss: 0.874 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4785246849060059
Epoch: 11, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.812 Vali Acc: 0.817 Test Loss: 0.812 Test Acc: 0.817
Validation loss decreased (-0.783325 --> -0.816659).  Saving model ...
Epoch: 12 cost time: 1.516148328781128
Epoch: 12, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.914 Vali Acc: 0.822 Test Loss: 0.914 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822213).  Saving model ...
Epoch: 13 cost time: 1.476315975189209
Epoch: 13, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.961 Vali Acc: 0.783 Test Loss: 0.961 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.391266107559204
Epoch: 14, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.962 Vali Acc: 0.822 Test Loss: 0.962 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2987542152404785
Epoch: 15, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.852 Vali Acc: 0.839 Test Loss: 0.852 Test Acc: 0.839
Validation loss decreased (-0.822213 --> -0.838880).  Saving model ...
Epoch: 16 cost time: 1.3779287338256836
Epoch: 16, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.961 Vali Acc: 0.833 Test Loss: 0.961 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6331429481506348
Epoch: 17, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.877 Vali Acc: 0.833 Test Loss: 0.877 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.601548194885254
Epoch: 18, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.004 Vali Acc: 0.856 Test Loss: 1.004 Test Acc: 0.856
Validation loss decreased (-0.838880 --> -0.855546).  Saving model ...
Epoch: 19 cost time: 1.600968837738037
Epoch: 19, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.989 Vali Acc: 0.844 Test Loss: 0.989 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6201069355010986
Epoch: 20, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.067 Vali Acc: 0.850 Test Loss: 1.067 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5960993766784668
Epoch: 21, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.260 Vali Acc: 0.844 Test Loss: 1.260 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.585763931274414
Epoch: 22, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.160 Vali Acc: 0.850 Test Loss: 1.160 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5641121864318848
Epoch: 23, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.131 Vali Acc: 0.872 Test Loss: 1.131 Test Acc: 0.872
Validation loss decreased (-0.855546 --> -0.872211).  Saving model ...
Epoch: 24 cost time: 1.6260216236114502
Epoch: 24, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.112 Vali Acc: 0.872 Test Loss: 1.112 Test Acc: 0.872
Validation loss decreased (-0.872211 --> -0.872211).  Saving model ...
Epoch: 25 cost time: 1.6429734230041504
Epoch: 25, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.149 Vali Acc: 0.856 Test Loss: 1.149 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4867393970489502
Epoch: 26, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.130 Vali Acc: 0.861 Test Loss: 1.130 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4860990047454834
Epoch: 27, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.122 Vali Acc: 0.856 Test Loss: 1.122 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6124053001403809
Epoch: 28, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.240 Vali Acc: 0.850 Test Loss: 1.240 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.6428086757659912
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.086 Vali Acc: 0.850 Test Loss: 1.086 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.5962319374084473
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.021 Vali Acc: 0.878 Test Loss: 1.021 Test Acc: 0.878
Validation loss decreased (-0.872211 --> -0.877768).  Saving model ...
Epoch: 31 cost time: 1.7132470607757568
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.061 Vali Acc: 0.878 Test Loss: 1.061 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7188587188720703
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.993 Vali Acc: 0.878 Test Loss: 0.993 Test Acc: 0.878
Validation loss decreased (-0.877768 --> -0.877768).  Saving model ...
Epoch: 33 cost time: 1.4959321022033691
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.009 Vali Acc: 0.878 Test Loss: 1.009 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.453765630722046
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.016 Vali Acc: 0.883 Test Loss: 1.016 Test Acc: 0.883
Validation loss decreased (-0.877768 --> -0.883323).  Saving model ...
Epoch: 35 cost time: 1.3768818378448486
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.047 Vali Acc: 0.878 Test Loss: 1.047 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3851850032806396
Epoch: 36, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.106 Vali Acc: 0.872 Test Loss: 1.106 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.522216796875
Epoch: 37, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.223 Vali Acc: 0.861 Test Loss: 1.223 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.5757091045379639
Epoch: 38, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.195 Vali Acc: 0.850 Test Loss: 1.195 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.6556899547576904
Epoch: 39, Steps: 12 | Train Loss: 0.169 Vali Loss: 1.340 Vali Acc: 0.833 Test Loss: 1.340 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.70420241355896
Epoch: 40, Steps: 12 | Train Loss: 0.129 Vali Loss: 1.282 Vali Acc: 0.861 Test Loss: 1.282 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.6543571949005127
Epoch: 41, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.425 Vali Acc: 0.839 Test Loss: 1.425 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.6081678867340088
Epoch: 42, Steps: 12 | Train Loss: 0.045 Vali Loss: 2.161 Vali Acc: 0.817 Test Loss: 2.161 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.5341076850891113
Epoch: 43, Steps: 12 | Train Loss: 0.153 Vali Loss: 1.358 Vali Acc: 0.856 Test Loss: 1.358 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.530728816986084
Epoch: 44, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.460 Vali Acc: 0.828 Test Loss: 1.460 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 1591695
model size : 6.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.836027145385742
Epoch: 1, Steps: 12 | Train Loss: 2.704 Vali Loss: 2.636 Vali Acc: 0.172 Test Loss: 2.636 Test Acc: 0.172
Validation loss decreased (inf --> -0.172196).  Saving model ...
Epoch: 2 cost time: 1.490544319152832
Epoch: 2, Steps: 12 | Train Loss: 2.370 Vali Loss: 2.346 Vali Acc: 0.389 Test Loss: 2.346 Test Acc: 0.389
Validation loss decreased (-0.172196 --> -0.388865).  Saving model ...
Epoch: 3 cost time: 1.368340253829956
Epoch: 3, Steps: 12 | Train Loss: 1.934 Vali Loss: 1.890 Vali Acc: 0.533 Test Loss: 1.890 Test Acc: 0.533
Validation loss decreased (-0.388865 --> -0.533314).  Saving model ...
Epoch: 4 cost time: 1.4535644054412842
Epoch: 4, Steps: 12 | Train Loss: 1.412 Vali Loss: 1.477 Vali Acc: 0.628 Test Loss: 1.477 Test Acc: 0.628
Validation loss decreased (-0.533314 --> -0.627763).  Saving model ...
Epoch: 5 cost time: 1.392371416091919
Epoch: 5, Steps: 12 | Train Loss: 1.071 Vali Loss: 1.166 Vali Acc: 0.672 Test Loss: 1.166 Test Acc: 0.672
Validation loss decreased (-0.627763 --> -0.672211).  Saving model ...
Epoch: 6 cost time: 1.43672513961792
Epoch: 6, Steps: 12 | Train Loss: 0.781 Vali Loss: 1.047 Vali Acc: 0.694 Test Loss: 1.047 Test Acc: 0.694
Validation loss decreased (-0.672211 --> -0.694434).  Saving model ...
Epoch: 7 cost time: 1.3352627754211426
Epoch: 7, Steps: 12 | Train Loss: 0.639 Vali Loss: 0.944 Vali Acc: 0.700 Test Loss: 0.944 Test Acc: 0.700
Validation loss decreased (-0.694434 --> -0.699991).  Saving model ...
Epoch: 8 cost time: 1.4478657245635986
Epoch: 8, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.864 Vali Acc: 0.722 Test Loss: 0.864 Test Acc: 0.722
Validation loss decreased (-0.699991 --> -0.722214).  Saving model ...
Epoch: 9 cost time: 1.4498682022094727
Epoch: 9, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.749 Vali Acc: 0.761 Test Loss: 0.749 Test Acc: 0.761
Validation loss decreased (-0.722214 --> -0.761104).  Saving model ...
Epoch: 10 cost time: 1.3959364891052246
Epoch: 10, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.710 Vali Acc: 0.789 Test Loss: 0.710 Test Acc: 0.789
Validation loss decreased (-0.761104 --> -0.788882).  Saving model ...
Epoch: 11 cost time: 1.3729228973388672
Epoch: 11, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.757 Vali Acc: 0.772 Test Loss: 0.757 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4384057521820068
Epoch: 12, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.654 Vali Acc: 0.844 Test Loss: 0.654 Test Acc: 0.844
Validation loss decreased (-0.788882 --> -0.844438).  Saving model ...
Epoch: 13 cost time: 1.4804084300994873
Epoch: 13, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.668 Vali Acc: 0.833 Test Loss: 0.668 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4815757274627686
Epoch: 14, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.700 Vali Acc: 0.839 Test Loss: 0.700 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4577405452728271
Epoch: 15, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.751 Vali Acc: 0.828 Test Loss: 0.751 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5279486179351807
Epoch: 16, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.637 Vali Acc: 0.856 Test Loss: 0.637 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 17 cost time: 1.4934287071228027
Epoch: 17, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.664 Vali Acc: 0.839 Test Loss: 0.664 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3894011974334717
Epoch: 18, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.690 Vali Acc: 0.844 Test Loss: 0.690 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3195726871490479
Epoch: 19, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.755 Vali Acc: 0.822 Test Loss: 0.755 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.348581314086914
Epoch: 20, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.795 Vali Acc: 0.833 Test Loss: 0.795 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3161187171936035
Epoch: 21, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.784 Vali Acc: 0.850 Test Loss: 0.784 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.328075647354126
Epoch: 22, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.753 Vali Acc: 0.833 Test Loss: 0.753 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2709224224090576
Epoch: 23, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.775 Vali Acc: 0.839 Test Loss: 0.775 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4175724983215332
Epoch: 24, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.773 Vali Acc: 0.856 Test Loss: 0.773 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3657605648040771
Epoch: 25, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.782 Vali Acc: 0.833 Test Loss: 0.782 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4679148197174072
Epoch: 26, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.786 Vali Acc: 0.844 Test Loss: 0.786 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 1499663
model size : 5.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6020920276641846
Epoch: 1, Steps: 12 | Train Loss: 2.647 Vali Loss: 2.574 Vali Acc: 0.217 Test Loss: 2.574 Test Acc: 0.217
Validation loss decreased (inf --> -0.216641).  Saving model ...
Epoch: 2 cost time: 1.3570401668548584
Epoch: 2, Steps: 12 | Train Loss: 2.296 Vali Loss: 2.241 Vali Acc: 0.500 Test Loss: 2.241 Test Acc: 0.500
Validation loss decreased (-0.216641 --> -0.499978).  Saving model ...
Epoch: 3 cost time: 1.3881111145019531
Epoch: 3, Steps: 12 | Train Loss: 1.834 Vali Loss: 1.777 Vali Acc: 0.583 Test Loss: 1.777 Test Acc: 0.583
Validation loss decreased (-0.499978 --> -0.583316).  Saving model ...
Epoch: 4 cost time: 1.3932359218597412
Epoch: 4, Steps: 12 | Train Loss: 1.365 Vali Loss: 1.381 Vali Acc: 0.611 Test Loss: 1.381 Test Acc: 0.611
Validation loss decreased (-0.583316 --> -0.611097).  Saving model ...
Epoch: 5 cost time: 1.5285072326660156
Epoch: 5, Steps: 12 | Train Loss: 0.989 Vali Loss: 1.144 Vali Acc: 0.644 Test Loss: 1.144 Test Acc: 0.644
Validation loss decreased (-0.611097 --> -0.644433).  Saving model ...
Epoch: 6 cost time: 1.4912583827972412
Epoch: 6, Steps: 12 | Train Loss: 0.853 Vali Loss: 0.989 Vali Acc: 0.683 Test Loss: 0.989 Test Acc: 0.683
Validation loss decreased (-0.644433 --> -0.683323).  Saving model ...
Epoch: 7 cost time: 1.4837920665740967
Epoch: 7, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.899 Vali Acc: 0.711 Test Loss: 0.899 Test Acc: 0.711
Validation loss decreased (-0.683323 --> -0.711102).  Saving model ...
Epoch: 8 cost time: 1.4540963172912598
Epoch: 8, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.845 Vali Acc: 0.761 Test Loss: 0.845 Test Acc: 0.761
Validation loss decreased (-0.711102 --> -0.761103).  Saving model ...
Epoch: 9 cost time: 1.491969108581543
Epoch: 9, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.719 Vali Acc: 0.783 Test Loss: 0.719 Test Acc: 0.783
Validation loss decreased (-0.761103 --> -0.783326).  Saving model ...
Epoch: 10 cost time: 1.4566469192504883
Epoch: 10, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.701 Vali Acc: 0.794 Test Loss: 0.701 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794437).  Saving model ...
Epoch: 11 cost time: 1.479651927947998
Epoch: 11, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.736 Vali Acc: 0.789 Test Loss: 0.736 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4096903800964355
Epoch: 12, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.688 Vali Acc: 0.828 Test Loss: 0.688 Test Acc: 0.828
Validation loss decreased (-0.794437 --> -0.827771).  Saving model ...
Epoch: 13 cost time: 1.4208359718322754
Epoch: 13, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.696 Vali Acc: 0.817 Test Loss: 0.696 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2742235660552979
Epoch: 14, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.684 Vali Acc: 0.806 Test Loss: 0.684 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3158752918243408
Epoch: 15, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.613 Vali Acc: 0.833 Test Loss: 0.613 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 1.2363276481628418
Epoch: 16, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.679 Vali Acc: 0.850 Test Loss: 0.679 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849993).  Saving model ...
Epoch: 17 cost time: 1.486417293548584
Epoch: 17, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.799 Vali Acc: 0.817 Test Loss: 0.799 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4757428169250488
Epoch: 18, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.789 Vali Acc: 0.833 Test Loss: 0.789 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.580085039138794
Epoch: 19, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.777 Vali Acc: 0.833 Test Loss: 0.777 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5294623374938965
Epoch: 20, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.761 Vali Acc: 0.822 Test Loss: 0.761 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.551445484161377
Epoch: 21, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.827 Vali Acc: 0.844 Test Loss: 0.827 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.507361650466919
Epoch: 22, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.822 Vali Acc: 0.861 Test Loss: 0.822 Test Acc: 0.861
Validation loss decreased (-0.849993 --> -0.861103).  Saving model ...
Epoch: 23 cost time: 1.433492660522461
Epoch: 23, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.823 Vali Acc: 0.833 Test Loss: 0.823 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.405346393585205
Epoch: 24, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.798 Vali Acc: 0.861 Test Loss: 0.798 Test Acc: 0.861
Validation loss decreased (-0.861103 --> -0.861103).  Saving model ...
Epoch: 25 cost time: 1.38771390914917
Epoch: 25, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.888 Vali Acc: 0.839 Test Loss: 0.888 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4195976257324219
Epoch: 26, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.887 Vali Acc: 0.828 Test Loss: 0.887 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.357304334640503
Epoch: 27, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.941 Vali Acc: 0.856 Test Loss: 0.941 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5392494201660156
Epoch: 28, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.916 Vali Acc: 0.844 Test Loss: 0.916 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.5175681114196777
Epoch: 29, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.879 Vali Acc: 0.856 Test Loss: 0.879 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.500105857849121
Epoch: 30, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.837 Vali Acc: 0.861 Test Loss: 0.837 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.4868052005767822
Epoch: 31, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.845 Vali Acc: 0.861 Test Loss: 0.845 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.4574487209320068
Epoch: 32, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.850 Vali Acc: 0.861 Test Loss: 0.850 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.3928906917572021
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.949 Vali Acc: 0.861 Test Loss: 0.949 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.3037686347961426
Epoch: 34, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.848 Vali Acc: 0.878 Test Loss: 0.848 Test Acc: 0.878
Validation loss decreased (-0.861103 --> -0.877769).  Saving model ...
Epoch: 35 cost time: 1.4266676902770996
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.875 Vali Acc: 0.889 Test Loss: 0.875 Test Acc: 0.889
Validation loss decreased (-0.877769 --> -0.888880).  Saving model ...
Epoch: 36 cost time: 1.3916423320770264
Epoch: 36, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.875 Vali Acc: 0.872 Test Loss: 0.875 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.4100596904754639
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.933 Vali Acc: 0.872 Test Loss: 0.933 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2900943756103516
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.928 Vali Acc: 0.867 Test Loss: 0.928 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.277618408203125
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.914 Vali Acc: 0.878 Test Loss: 0.914 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.3182408809661865
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.921 Vali Acc: 0.867 Test Loss: 0.921 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.3169023990631104
Epoch: 41, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.960 Vali Acc: 0.856 Test Loss: 0.960 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.4642982482910156
Epoch: 42, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.013 Vali Acc: 0.856 Test Loss: 1.013 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.443239450454712
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.959 Vali Acc: 0.844 Test Loss: 0.959 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.495729684829712
Epoch: 44, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.027 Vali Acc: 0.867 Test Loss: 1.027 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.4742004871368408
Epoch: 45, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.955 Vali Acc: 0.861 Test Loss: 0.955 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 1499791
model size : 5.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.596198558807373
Epoch: 1, Steps: 12 | Train Loss: 2.696 Vali Loss: 2.635 Vali Acc: 0.161 Test Loss: 2.635 Test Acc: 0.161
Validation loss decreased (inf --> -0.161085).  Saving model ...
Epoch: 2 cost time: 1.4350919723510742
Epoch: 2, Steps: 12 | Train Loss: 2.442 Vali Loss: 2.387 Vali Acc: 0.350 Test Loss: 2.387 Test Acc: 0.350
Validation loss decreased (-0.161085 --> -0.349976).  Saving model ...
Epoch: 3 cost time: 1.3456480503082275
Epoch: 3, Steps: 12 | Train Loss: 2.042 Vali Loss: 1.992 Vali Acc: 0.561 Test Loss: 1.992 Test Acc: 0.561
Validation loss decreased (-0.349976 --> -0.561091).  Saving model ...
Epoch: 4 cost time: 1.4787752628326416
Epoch: 4, Steps: 12 | Train Loss: 1.595 Vali Loss: 1.580 Vali Acc: 0.622 Test Loss: 1.580 Test Acc: 0.622
Validation loss decreased (-0.561091 --> -0.622206).  Saving model ...
Epoch: 5 cost time: 1.4114134311676025
Epoch: 5, Steps: 12 | Train Loss: 1.195 Vali Loss: 1.271 Vali Acc: 0.683 Test Loss: 1.271 Test Acc: 0.683
Validation loss decreased (-0.622206 --> -0.683321).  Saving model ...
Epoch: 6 cost time: 1.454310655593872
Epoch: 6, Steps: 12 | Train Loss: 0.944 Vali Loss: 1.101 Vali Acc: 0.678 Test Loss: 1.101 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4069421291351318
Epoch: 7, Steps: 12 | Train Loss: 0.742 Vali Loss: 0.979 Vali Acc: 0.694 Test Loss: 0.979 Test Acc: 0.694
Validation loss decreased (-0.683321 --> -0.694435).  Saving model ...
Epoch: 8 cost time: 1.2694547176361084
Epoch: 8, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.882 Vali Acc: 0.689 Test Loss: 0.882 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2426769733428955
Epoch: 9, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.843 Vali Acc: 0.761 Test Loss: 0.843 Test Acc: 0.761
Validation loss decreased (-0.694435 --> -0.761103).  Saving model ...
Epoch: 10 cost time: 1.217271089553833
Epoch: 10, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.740 Vali Acc: 0.778 Test Loss: 0.740 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777770).  Saving model ...
Epoch: 11 cost time: 1.2077875137329102
Epoch: 11, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.683 Vali Acc: 0.806 Test Loss: 0.683 Test Acc: 0.806
Validation loss decreased (-0.777770 --> -0.805549).  Saving model ...
Epoch: 12 cost time: 1.2237164974212646
Epoch: 12, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.674 Vali Acc: 0.817 Test Loss: 0.674 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816660).  Saving model ...
Epoch: 13 cost time: 1.2088851928710938
Epoch: 13, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.657 Vali Acc: 0.822 Test Loss: 0.657 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 14 cost time: 1.423173427581787
Epoch: 14, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.650 Vali Acc: 0.833 Test Loss: 0.650 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 15 cost time: 1.4855074882507324
Epoch: 15, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.632 Vali Acc: 0.856 Test Loss: 0.632 Test Acc: 0.856
Validation loss decreased (-0.833327 --> -0.855549).  Saving model ...
Epoch: 16 cost time: 1.3710052967071533
Epoch: 16, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.647 Vali Acc: 0.839 Test Loss: 0.647 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2607345581054688
Epoch: 17, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.653 Vali Acc: 0.844 Test Loss: 0.653 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3363356590270996
Epoch: 18, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.639 Vali Acc: 0.856 Test Loss: 0.639 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2642040252685547
Epoch: 19, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.707 Vali Acc: 0.856 Test Loss: 0.707 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2448341846466064
Epoch: 20, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.653 Vali Acc: 0.867 Test Loss: 0.653 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866660).  Saving model ...
Epoch: 21 cost time: 1.326401948928833
Epoch: 21, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.735 Vali Acc: 0.861 Test Loss: 0.735 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.296393632888794
Epoch: 22, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.692 Vali Acc: 0.839 Test Loss: 0.692 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2689666748046875
Epoch: 23, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.741 Vali Acc: 0.850 Test Loss: 0.741 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2610204219818115
Epoch: 24, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.736 Vali Acc: 0.878 Test Loss: 0.736 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877770).  Saving model ...
Epoch: 25 cost time: 1.3006632328033447
Epoch: 25, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.720 Vali Acc: 0.867 Test Loss: 0.720 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2983665466308594
Epoch: 26, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.687 Vali Acc: 0.878 Test Loss: 0.687 Test Acc: 0.878
Validation loss decreased (-0.877770 --> -0.877771).  Saving model ...
Epoch: 27 cost time: 1.3237392902374268
Epoch: 27, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.769 Vali Acc: 0.878 Test Loss: 0.769 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3195171356201172
Epoch: 28, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.797 Vali Acc: 0.878 Test Loss: 0.797 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1767394542694092
Epoch: 29, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.805 Vali Acc: 0.872 Test Loss: 0.805 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4025349617004395
Epoch: 30, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.828 Vali Acc: 0.861 Test Loss: 0.828 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.192885160446167
Epoch: 31, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.821 Vali Acc: 0.861 Test Loss: 0.821 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.2445859909057617
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.818 Vali Acc: 0.883 Test Loss: 0.818 Test Acc: 0.883
Validation loss decreased (-0.877771 --> -0.883325).  Saving model ...
Epoch: 33 cost time: 1.2107114791870117
Epoch: 33, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.842 Vali Acc: 0.867 Test Loss: 0.842 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1695046424865723
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.843 Vali Acc: 0.878 Test Loss: 0.843 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1520555019378662
Epoch: 35, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.858 Vali Acc: 0.878 Test Loss: 0.858 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.264988660812378
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.904 Vali Acc: 0.872 Test Loss: 0.904 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.3230953216552734
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.894 Vali Acc: 0.878 Test Loss: 0.894 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.375319004058838
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.888 Vali Acc: 0.883 Test Loss: 0.888 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.3862881660461426
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.881 Vali Acc: 0.872 Test Loss: 0.881 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.3876736164093018
Epoch: 40, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.893 Vali Acc: 0.867 Test Loss: 0.893 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.2966396808624268
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.955 Vali Acc: 0.872 Test Loss: 0.955 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.3319287300109863
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.954 Vali Acc: 0.878 Test Loss: 0.954 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 1476879
model size : 5.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.635610818862915
Epoch: 1, Steps: 12 | Train Loss: 2.755 Vali Loss: 2.640 Vali Acc: 0.128 Test Loss: 2.640 Test Acc: 0.128
Validation loss decreased (inf --> -0.127751).  Saving model ...
Epoch: 2 cost time: 1.2930083274841309
Epoch: 2, Steps: 12 | Train Loss: 2.521 Vali Loss: 2.418 Vali Acc: 0.361 Test Loss: 2.418 Test Acc: 0.361
Validation loss decreased (-0.127751 --> -0.361087).  Saving model ...
Epoch: 3 cost time: 1.4135560989379883
Epoch: 3, Steps: 12 | Train Loss: 2.140 Vali Loss: 2.063 Vali Acc: 0.533 Test Loss: 2.063 Test Acc: 0.533
Validation loss decreased (-0.361087 --> -0.533313).  Saving model ...
Epoch: 4 cost time: 1.4331822395324707
Epoch: 4, Steps: 12 | Train Loss: 1.749 Vali Loss: 1.672 Vali Acc: 0.594 Test Loss: 1.672 Test Acc: 0.594
Validation loss decreased (-0.533313 --> -0.594428).  Saving model ...
Epoch: 5 cost time: 1.3827011585235596
Epoch: 5, Steps: 12 | Train Loss: 1.365 Vali Loss: 1.351 Vali Acc: 0.672 Test Loss: 1.351 Test Acc: 0.672
Validation loss decreased (-0.594428 --> -0.672209).  Saving model ...
Epoch: 6 cost time: 1.3214354515075684
Epoch: 6, Steps: 12 | Train Loss: 1.099 Vali Loss: 1.137 Vali Acc: 0.667 Test Loss: 1.137 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3030996322631836
Epoch: 7, Steps: 12 | Train Loss: 0.878 Vali Loss: 1.018 Vali Acc: 0.711 Test Loss: 1.018 Test Acc: 0.711
Validation loss decreased (-0.672209 --> -0.711101).  Saving model ...
Epoch: 8 cost time: 1.2597324848175049
Epoch: 8, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.891 Vali Acc: 0.689 Test Loss: 0.891 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2189550399780273
Epoch: 9, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.818 Vali Acc: 0.739 Test Loss: 0.818 Test Acc: 0.739
Validation loss decreased (-0.711101 --> -0.738881).  Saving model ...
Epoch: 10 cost time: 1.2279696464538574
Epoch: 10, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.749 Vali Acc: 0.794 Test Loss: 0.749 Test Acc: 0.794
Validation loss decreased (-0.738881 --> -0.794437).  Saving model ...
Epoch: 11 cost time: 1.233489990234375
Epoch: 11, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.698 Vali Acc: 0.789 Test Loss: 0.698 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3860735893249512
Epoch: 12, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.659 Vali Acc: 0.839 Test Loss: 0.659 Test Acc: 0.839
Validation loss decreased (-0.794437 --> -0.838882).  Saving model ...
Epoch: 13 cost time: 1.2732901573181152
Epoch: 13, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.635 Vali Acc: 0.822 Test Loss: 0.635 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2581794261932373
Epoch: 14, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.600 Vali Acc: 0.839 Test Loss: 0.600 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 15 cost time: 1.3711357116699219
Epoch: 15, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.609 Vali Acc: 0.850 Test Loss: 0.609 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 16 cost time: 1.3548502922058105
Epoch: 16, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.592 Vali Acc: 0.861 Test Loss: 0.592 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 17 cost time: 1.356013536453247
Epoch: 17, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.617 Vali Acc: 0.856 Test Loss: 0.617 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3600854873657227
Epoch: 18, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.637 Vali Acc: 0.856 Test Loss: 0.637 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4392378330230713
Epoch: 19, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.594 Vali Acc: 0.867 Test Loss: 0.594 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 20 cost time: 1.317674160003662
Epoch: 20, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.648 Vali Acc: 0.878 Test Loss: 0.648 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877771).  Saving model ...
Epoch: 21 cost time: 1.2713463306427002
Epoch: 21, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.625 Vali Acc: 0.883 Test Loss: 0.625 Test Acc: 0.883
Validation loss decreased (-0.877771 --> -0.883327).  Saving model ...
Epoch: 22 cost time: 1.2099871635437012
Epoch: 22, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.615 Vali Acc: 0.889 Test Loss: 0.615 Test Acc: 0.889
Validation loss decreased (-0.883327 --> -0.888883).  Saving model ...
Epoch: 23 cost time: 1.126206874847412
Epoch: 23, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.679 Vali Acc: 0.872 Test Loss: 0.679 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3178706169128418
Epoch: 24, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.671 Vali Acc: 0.872 Test Loss: 0.671 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3355114459991455
Epoch: 25, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.725 Vali Acc: 0.878 Test Loss: 0.725 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3483080863952637
Epoch: 26, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.683 Vali Acc: 0.856 Test Loss: 0.683 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4166371822357178
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.709 Vali Acc: 0.889 Test Loss: 0.709 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2962288856506348
Epoch: 28, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.724 Vali Acc: 0.889 Test Loss: 0.724 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.341986894607544
Epoch: 29, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.676 Vali Acc: 0.872 Test Loss: 0.676 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3005986213684082
Epoch: 30, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.714 Vali Acc: 0.894 Test Loss: 0.714 Test Acc: 0.894
Validation loss decreased (-0.888883 --> -0.894437).  Saving model ...
Epoch: 31 cost time: 1.333942174911499
Epoch: 31, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.725 Vali Acc: 0.878 Test Loss: 0.725 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2292354106903076
Epoch: 32, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.737 Vali Acc: 0.894 Test Loss: 0.737 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.3145229816436768
Epoch: 33, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.805 Vali Acc: 0.883 Test Loss: 0.805 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2979130744934082
Epoch: 34, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.793 Vali Acc: 0.872 Test Loss: 0.793 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.385286569595337
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.912 Vali Acc: 0.878 Test Loss: 0.912 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.2362408638000488
Epoch: 36, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.790 Vali Acc: 0.883 Test Loss: 0.790 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.2751672267913818
Epoch: 37, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.803 Vali Acc: 0.883 Test Loss: 0.803 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.3619050979614258
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.815 Vali Acc: 0.900 Test Loss: 0.815 Test Acc: 0.900
Validation loss decreased (-0.894437 --> -0.899992).  Saving model ...
Epoch: 39 cost time: 1.3515424728393555
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.942 Vali Acc: 0.872 Test Loss: 0.942 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.3477356433868408
Epoch: 40, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.936 Vali Acc: 0.883 Test Loss: 0.936 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.4178988933563232
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.926 Vali Acc: 0.878 Test Loss: 0.926 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.417182207107544
Epoch: 42, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.853 Vali Acc: 0.900 Test Loss: 0.853 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.4617691040039062
Epoch: 43, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.861 Vali Acc: 0.900 Test Loss: 0.861 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.3102836608886719
Epoch: 44, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.879 Vali Acc: 0.867 Test Loss: 0.879 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.2818410396575928
Epoch: 45, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.853 Vali Acc: 0.883 Test Loss: 0.853 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.2434165477752686
Epoch: 46, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.858 Vali Acc: 0.872 Test Loss: 0.858 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.2531936168670654
Epoch: 47, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.752 Vali Acc: 0.883 Test Loss: 0.752 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.266500473022461
Epoch: 48, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.921 Vali Acc: 0.883 Test Loss: 0.921 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 1461775
model size : 5.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7798707485198975
Epoch: 1, Steps: 12 | Train Loss: 2.692 Vali Loss: 2.664 Vali Acc: 0.178 Test Loss: 2.664 Test Acc: 0.178
Validation loss decreased (inf --> -0.177751).  Saving model ...
Epoch: 2 cost time: 1.3845632076263428
Epoch: 2, Steps: 12 | Train Loss: 2.497 Vali Loss: 2.475 Vali Acc: 0.383 Test Loss: 2.475 Test Acc: 0.383
Validation loss decreased (-0.177751 --> -0.383309).  Saving model ...
Epoch: 3 cost time: 1.4732515811920166
Epoch: 3, Steps: 12 | Train Loss: 2.195 Vali Loss: 2.162 Vali Acc: 0.444 Test Loss: 2.162 Test Acc: 0.444
Validation loss decreased (-0.383309 --> -0.444423).  Saving model ...
Epoch: 4 cost time: 1.3713047504425049
Epoch: 4, Steps: 12 | Train Loss: 1.826 Vali Loss: 1.809 Vali Acc: 0.556 Test Loss: 1.809 Test Acc: 0.556
Validation loss decreased (-0.444423 --> -0.555537).  Saving model ...
Epoch: 5 cost time: 1.3309836387634277
Epoch: 5, Steps: 12 | Train Loss: 1.468 Vali Loss: 1.492 Vali Acc: 0.661 Test Loss: 1.492 Test Acc: 0.661
Validation loss decreased (-0.555537 --> -0.661096).  Saving model ...
Epoch: 6 cost time: 1.3438708782196045
Epoch: 6, Steps: 12 | Train Loss: 1.133 Vali Loss: 1.250 Vali Acc: 0.683 Test Loss: 1.250 Test Acc: 0.683
Validation loss decreased (-0.661096 --> -0.683321).  Saving model ...
Epoch: 7 cost time: 1.4125499725341797
Epoch: 7, Steps: 12 | Train Loss: 0.972 Vali Loss: 1.039 Vali Acc: 0.694 Test Loss: 1.039 Test Acc: 0.694
Validation loss decreased (-0.683321 --> -0.694434).  Saving model ...
Epoch: 8 cost time: 1.4040157794952393
Epoch: 8, Steps: 12 | Train Loss: 0.742 Vali Loss: 0.927 Vali Acc: 0.722 Test Loss: 0.927 Test Acc: 0.722
Validation loss decreased (-0.694434 --> -0.722213).  Saving model ...
Epoch: 9 cost time: 1.3822588920593262
Epoch: 9, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.827 Vali Acc: 0.744 Test Loss: 0.827 Test Acc: 0.744
Validation loss decreased (-0.722213 --> -0.744436).  Saving model ...
Epoch: 10 cost time: 1.3998961448669434
Epoch: 10, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.746 Vali Acc: 0.789 Test Loss: 0.746 Test Acc: 0.789
Validation loss decreased (-0.744436 --> -0.788881).  Saving model ...
Epoch: 11 cost time: 1.4166345596313477
Epoch: 11, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.710 Vali Acc: 0.806 Test Loss: 0.710 Test Acc: 0.806
Validation loss decreased (-0.788881 --> -0.805548).  Saving model ...
Epoch: 12 cost time: 1.3940753936767578
Epoch: 12, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.652 Vali Acc: 0.828 Test Loss: 0.652 Test Acc: 0.828
Validation loss decreased (-0.805548 --> -0.827771).  Saving model ...
Epoch: 13 cost time: 1.4275531768798828
Epoch: 13, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.637 Vali Acc: 0.822 Test Loss: 0.637 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.410019874572754
Epoch: 14, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
Validation loss decreased (-0.827771 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 1.3553671836853027
Epoch: 15, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.570 Vali Acc: 0.839 Test Loss: 0.570 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3699393272399902
Epoch: 16, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.569 Vali Acc: 0.839 Test Loss: 0.569 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3659172058105469
Epoch: 17, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 1.3462555408477783
Epoch: 18, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.588 Vali Acc: 0.856 Test Loss: 0.588 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 19 cost time: 1.2922368049621582
Epoch: 19, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.580 Vali Acc: 0.872 Test Loss: 0.580 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872216).  Saving model ...
Epoch: 20 cost time: 1.286872386932373
Epoch: 20, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.617 Vali Acc: 0.850 Test Loss: 0.617 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3545453548431396
Epoch: 21, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.606 Vali Acc: 0.861 Test Loss: 0.606 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3498520851135254
Epoch: 22, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.613 Vali Acc: 0.861 Test Loss: 0.613 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.398578405380249
Epoch: 23, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.620 Vali Acc: 0.872 Test Loss: 0.620 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5027306079864502
Epoch: 24, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.624 Vali Acc: 0.872 Test Loss: 0.624 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4738867282867432
Epoch: 25, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.630 Vali Acc: 0.844 Test Loss: 0.630 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.442723035812378
Epoch: 26, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.682 Vali Acc: 0.861 Test Loss: 0.682 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3381690979003906
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.678 Vali Acc: 0.883 Test Loss: 0.678 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883327).  Saving model ...
Epoch: 28 cost time: 1.374577283859253
Epoch: 28, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.686 Vali Acc: 0.861 Test Loss: 0.686 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3444640636444092
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.664 Vali Acc: 0.861 Test Loss: 0.664 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3942854404449463
Epoch: 30, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.713 Vali Acc: 0.861 Test Loss: 0.713 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3656277656555176
Epoch: 31, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.661 Vali Acc: 0.856 Test Loss: 0.661 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.4297053813934326
Epoch: 32, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.734 Vali Acc: 0.883 Test Loss: 0.734 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.4365248680114746
Epoch: 33, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.708 Vali Acc: 0.878 Test Loss: 0.708 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.3455805778503418
Epoch: 34, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.681 Vali Acc: 0.867 Test Loss: 0.681 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.2988121509552002
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.833 Vali Acc: 0.861 Test Loss: 0.833 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.266045093536377
Epoch: 36, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.739 Vali Acc: 0.867 Test Loss: 0.739 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.2897274494171143
Epoch: 37, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.717 Vali Acc: 0.872 Test Loss: 0.717 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 1454351
model size : 5.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7015810012817383
Epoch: 1, Steps: 12 | Train Loss: 2.699 Vali Loss: 2.675 Vali Acc: 0.106 Test Loss: 2.675 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 1.2239959239959717
Epoch: 2, Steps: 12 | Train Loss: 2.529 Vali Loss: 2.504 Vali Acc: 0.378 Test Loss: 2.504 Test Acc: 0.378
Validation loss decreased (-0.105529 --> -0.377753).  Saving model ...
Epoch: 3 cost time: 1.3495182991027832
Epoch: 3, Steps: 12 | Train Loss: 2.241 Vali Loss: 2.214 Vali Acc: 0.556 Test Loss: 2.214 Test Acc: 0.556
Validation loss decreased (-0.377753 --> -0.555533).  Saving model ...
Epoch: 4 cost time: 1.3597135543823242
Epoch: 4, Steps: 12 | Train Loss: 1.940 Vali Loss: 1.884 Vali Acc: 0.628 Test Loss: 1.884 Test Acc: 0.628
Validation loss decreased (-0.555533 --> -0.627759).  Saving model ...
Epoch: 5 cost time: 1.34674072265625
Epoch: 5, Steps: 12 | Train Loss: 1.557 Vali Loss: 1.532 Vali Acc: 0.639 Test Loss: 1.532 Test Acc: 0.639
Validation loss decreased (-0.627759 --> -0.638874).  Saving model ...
Epoch: 6 cost time: 1.314028263092041
Epoch: 6, Steps: 12 | Train Loss: 1.187 Vali Loss: 1.263 Vali Acc: 0.672 Test Loss: 1.263 Test Acc: 0.672
Validation loss decreased (-0.638874 --> -0.672210).  Saving model ...
Epoch: 7 cost time: 1.3818271160125732
Epoch: 7, Steps: 12 | Train Loss: 0.931 Vali Loss: 1.059 Vali Acc: 0.694 Test Loss: 1.059 Test Acc: 0.694
Validation loss decreased (-0.672210 --> -0.694434).  Saving model ...
Epoch: 8 cost time: 1.4920973777770996
Epoch: 8, Steps: 12 | Train Loss: 0.761 Vali Loss: 0.908 Vali Acc: 0.722 Test Loss: 0.908 Test Acc: 0.722
Validation loss decreased (-0.694434 --> -0.722213).  Saving model ...
Epoch: 9 cost time: 1.4455962181091309
Epoch: 9, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.850 Vali Acc: 0.761 Test Loss: 0.850 Test Acc: 0.761
Validation loss decreased (-0.722213 --> -0.761103).  Saving model ...
Epoch: 10 cost time: 1.4405372142791748
Epoch: 10, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.745 Vali Acc: 0.756 Test Loss: 0.745 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3856511116027832
Epoch: 11, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.676 Vali Acc: 0.817 Test Loss: 0.676 Test Acc: 0.817
Validation loss decreased (-0.761103 --> -0.816660).  Saving model ...
Epoch: 12 cost time: 1.4078798294067383
Epoch: 12, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.618 Vali Acc: 0.828 Test Loss: 0.618 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827772).  Saving model ...
Epoch: 13 cost time: 1.2875981330871582
Epoch: 13, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.584 Vali Acc: 0.839 Test Loss: 0.584 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 14 cost time: 1.318540334701538
Epoch: 14, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.556 Vali Acc: 0.839 Test Loss: 0.556 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 15 cost time: 1.2862298488616943
Epoch: 15, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3722639083862305
Epoch: 16, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.544 Vali Acc: 0.839 Test Loss: 0.544 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 17 cost time: 1.3713562488555908
Epoch: 17, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.491 Vali Acc: 0.861 Test Loss: 0.491 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861106).  Saving model ...
Epoch: 18 cost time: 1.4404313564300537
Epoch: 18, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.503 Vali Acc: 0.883 Test Loss: 0.503 Test Acc: 0.883
Validation loss decreased (-0.861106 --> -0.883328).  Saving model ...
Epoch: 19 cost time: 1.3841474056243896
Epoch: 19, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.461 Vali Acc: 0.878 Test Loss: 0.461 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.331085443496704
Epoch: 20, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.487 Vali Acc: 0.867 Test Loss: 0.487 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2759456634521484
Epoch: 21, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.529 Vali Acc: 0.856 Test Loss: 0.529 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.359320878982544
Epoch: 22, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.508 Vali Acc: 0.856 Test Loss: 0.508 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.347015619277954
Epoch: 23, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.487 Vali Acc: 0.867 Test Loss: 0.487 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3690054416656494
Epoch: 24, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.518 Vali Acc: 0.872 Test Loss: 0.518 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3619420528411865
Epoch: 25, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.554 Vali Acc: 0.872 Test Loss: 0.554 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3780171871185303
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.520 Vali Acc: 0.872 Test Loss: 0.520 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2786455154418945
Epoch: 27, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.525 Vali Acc: 0.867 Test Loss: 0.525 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2853717803955078
Epoch: 28, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.585 Vali Acc: 0.878 Test Loss: 0.585 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 1447055
model size : 5.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4485485553741455
Epoch: 1, Steps: 12 | Train Loss: 2.722 Vali Loss: 2.622 Vali Acc: 0.139 Test Loss: 2.622 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 1.178772211074829
Epoch: 2, Steps: 12 | Train Loss: 2.432 Vali Loss: 2.336 Vali Acc: 0.311 Test Loss: 2.336 Test Acc: 0.311
Validation loss decreased (-0.138863 --> -0.311088).  Saving model ...
Epoch: 3 cost time: 1.2001519203186035
Epoch: 3, Steps: 12 | Train Loss: 1.978 Vali Loss: 1.945 Vali Acc: 0.544 Test Loss: 1.945 Test Acc: 0.544
Validation loss decreased (-0.311088 --> -0.544425).  Saving model ...
Epoch: 4 cost time: 1.1254596710205078
Epoch: 4, Steps: 12 | Train Loss: 1.543 Vali Loss: 1.547 Vali Acc: 0.644 Test Loss: 1.547 Test Acc: 0.644
Validation loss decreased (-0.544425 --> -0.644429).  Saving model ...
Epoch: 5 cost time: 1.037029504776001
Epoch: 5, Steps: 12 | Train Loss: 1.198 Vali Loss: 1.243 Vali Acc: 0.650 Test Loss: 1.243 Test Acc: 0.650
Validation loss decreased (-0.644429 --> -0.649988).  Saving model ...
Epoch: 6 cost time: 1.0962591171264648
Epoch: 6, Steps: 12 | Train Loss: 0.857 Vali Loss: 1.085 Vali Acc: 0.683 Test Loss: 1.085 Test Acc: 0.683
Validation loss decreased (-0.649988 --> -0.683322).  Saving model ...
Epoch: 7 cost time: 1.070296049118042
Epoch: 7, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.959 Vali Acc: 0.678 Test Loss: 0.959 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0497331619262695
Epoch: 8, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.926 Vali Acc: 0.678 Test Loss: 0.926 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0055391788482666
Epoch: 9, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.848 Vali Acc: 0.750 Test Loss: 0.848 Test Acc: 0.750
Validation loss decreased (-0.683322 --> -0.749992).  Saving model ...
Epoch: 10 cost time: 1.1188063621520996
Epoch: 10, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.802 Vali Acc: 0.756 Test Loss: 0.802 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755548).  Saving model ...
Epoch: 11 cost time: 1.146580457687378
Epoch: 11, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.777 Vali Acc: 0.767 Test Loss: 0.777 Test Acc: 0.767
Validation loss decreased (-0.755548 --> -0.766659).  Saving model ...
Epoch: 12 cost time: 1.103710651397705
Epoch: 12, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.741 Vali Acc: 0.800 Test Loss: 0.741 Test Acc: 0.800
Validation loss decreased (-0.766659 --> -0.799993).  Saving model ...
Epoch: 13 cost time: 1.1203513145446777
Epoch: 13, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.714 Vali Acc: 0.833 Test Loss: 0.714 Test Acc: 0.833
Validation loss decreased (-0.799993 --> -0.833326).  Saving model ...
Epoch: 14 cost time: 1.0890536308288574
Epoch: 14, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.730 Vali Acc: 0.806 Test Loss: 0.730 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0793874263763428
Epoch: 15, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.825 Vali Acc: 0.844 Test Loss: 0.825 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844436).  Saving model ...
Epoch: 16 cost time: 1.0942158699035645
Epoch: 16, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.811 Vali Acc: 0.783 Test Loss: 0.811 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.055983304977417
Epoch: 17, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.798 Vali Acc: 0.839 Test Loss: 0.798 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0855252742767334
Epoch: 18, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.853 Vali Acc: 0.800 Test Loss: 0.853 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0669333934783936
Epoch: 19, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.894 Vali Acc: 0.822 Test Loss: 0.894 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0861186981201172
Epoch: 20, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.833 Vali Acc: 0.844 Test Loss: 0.833 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.10487699508667
Epoch: 21, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.890 Vali Acc: 0.839 Test Loss: 0.890 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.140939712524414
Epoch: 22, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.849 Vali Acc: 0.839 Test Loss: 0.849 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1675677299499512
Epoch: 23, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.868 Vali Acc: 0.839 Test Loss: 0.868 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1138935089111328
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.900 Vali Acc: 0.856 Test Loss: 0.900 Test Acc: 0.856
Validation loss decreased (-0.844436 --> -0.855547).  Saving model ...
Epoch: 25 cost time: 1.139037847518921
Epoch: 25, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.974 Vali Acc: 0.839 Test Loss: 0.974 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1185119152069092
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.921 Vali Acc: 0.844 Test Loss: 0.921 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.118295431137085
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.960 Vali Acc: 0.833 Test Loss: 0.960 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9567716121673584
Epoch: 28, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.030 Vali Acc: 0.850 Test Loss: 1.030 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.128279685974121
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.005 Vali Acc: 0.856 Test Loss: 1.005 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0978364944458008
Epoch: 30, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.968 Vali Acc: 0.839 Test Loss: 0.968 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1627490520477295
Epoch: 31, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.201 Vali Acc: 0.844 Test Loss: 1.201 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1306722164154053
Epoch: 32, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.022 Vali Acc: 0.861 Test Loss: 1.022 Test Acc: 0.861
Validation loss decreased (-0.855547 --> -0.861101).  Saving model ...
Epoch: 33 cost time: 1.0543386936187744
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.084 Vali Acc: 0.867 Test Loss: 1.084 Test Acc: 0.867
Validation loss decreased (-0.861101 --> -0.866656).  Saving model ...
Epoch: 34 cost time: 1.015876054763794
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.060 Vali Acc: 0.883 Test Loss: 1.060 Test Acc: 0.883
Validation loss decreased (-0.866656 --> -0.883323).  Saving model ...
Epoch: 35 cost time: 1.047539472579956
Epoch: 35, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.028 Vali Acc: 0.861 Test Loss: 1.028 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0870277881622314
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.091 Vali Acc: 0.861 Test Loss: 1.091 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1557796001434326
Epoch: 37, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.107 Vali Acc: 0.844 Test Loss: 1.107 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0415260791778564
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.082 Vali Acc: 0.850 Test Loss: 1.082 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.1737244129180908
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.088 Vali Acc: 0.867 Test Loss: 1.088 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.1503102779388428
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.074 Vali Acc: 0.856 Test Loss: 1.074 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.078721523284912
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.111 Vali Acc: 0.856 Test Loss: 1.111 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.1101737022399902
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.129 Vali Acc: 0.861 Test Loss: 1.129 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.0783727169036865
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.146 Vali Acc: 0.850 Test Loss: 1.146 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.0975620746612549
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.153 Vali Acc: 0.861 Test Loss: 1.153 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 451791
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3832316398620605
Epoch: 1, Steps: 12 | Train Loss: 2.686 Vali Loss: 2.676 Vali Acc: 0.139 Test Loss: 2.676 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 1.0622584819793701
Epoch: 2, Steps: 12 | Train Loss: 2.491 Vali Loss: 2.530 Vali Acc: 0.283 Test Loss: 2.530 Test Acc: 0.283
Validation loss decreased (-0.138862 --> -0.283308).  Saving model ...
Epoch: 3 cost time: 1.0750048160552979
Epoch: 3, Steps: 12 | Train Loss: 2.272 Vali Loss: 2.296 Vali Acc: 0.433 Test Loss: 2.296 Test Acc: 0.433
Validation loss decreased (-0.283308 --> -0.433310).  Saving model ...
Epoch: 4 cost time: 0.9598946571350098
Epoch: 4, Steps: 12 | Train Loss: 2.019 Vali Loss: 1.987 Vali Acc: 0.522 Test Loss: 1.987 Test Acc: 0.522
Validation loss decreased (-0.433310 --> -0.522202).  Saving model ...
Epoch: 5 cost time: 0.9753546714782715
Epoch: 5, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.691 Vali Acc: 0.567 Test Loss: 1.691 Test Acc: 0.567
Validation loss decreased (-0.522202 --> -0.566650).  Saving model ...
Epoch: 6 cost time: 1.0537350177764893
Epoch: 6, Steps: 12 | Train Loss: 1.397 Vali Loss: 1.484 Vali Acc: 0.572 Test Loss: 1.484 Test Acc: 0.572
Validation loss decreased (-0.566650 --> -0.572207).  Saving model ...
Epoch: 7 cost time: 0.9758212566375732
Epoch: 7, Steps: 12 | Train Loss: 1.114 Vali Loss: 1.280 Vali Acc: 0.650 Test Loss: 1.280 Test Acc: 0.650
Validation loss decreased (-0.572207 --> -0.649987).  Saving model ...
Epoch: 8 cost time: 1.0338835716247559
Epoch: 8, Steps: 12 | Train Loss: 0.882 Vali Loss: 1.149 Vali Acc: 0.678 Test Loss: 1.149 Test Acc: 0.678
Validation loss decreased (-0.649987 --> -0.677766).  Saving model ...
Epoch: 9 cost time: 0.937084436416626
Epoch: 9, Steps: 12 | Train Loss: 0.722 Vali Loss: 1.035 Vali Acc: 0.689 Test Loss: 1.035 Test Acc: 0.689
Validation loss decreased (-0.677766 --> -0.688879).  Saving model ...
Epoch: 10 cost time: 0.9641315937042236
Epoch: 10, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.930 Vali Acc: 0.689 Test Loss: 0.930 Test Acc: 0.689
Validation loss decreased (-0.688879 --> -0.688880).  Saving model ...
Epoch: 11 cost time: 1.017615795135498
Epoch: 11, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.908 Vali Acc: 0.689 Test Loss: 0.908 Test Acc: 0.689
Validation loss decreased (-0.688880 --> -0.688880).  Saving model ...
Epoch: 12 cost time: 1.0312044620513916
Epoch: 12, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.874 Vali Acc: 0.722 Test Loss: 0.874 Test Acc: 0.722
Validation loss decreased (-0.688880 --> -0.722213).  Saving model ...
Epoch: 13 cost time: 1.1114883422851562
Epoch: 13, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.788 Vali Acc: 0.733 Test Loss: 0.788 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733325).  Saving model ...
Epoch: 14 cost time: 1.0961639881134033
Epoch: 14, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.759 Vali Acc: 0.761 Test Loss: 0.759 Test Acc: 0.761
Validation loss decreased (-0.733325 --> -0.761104).  Saving model ...
Epoch: 15 cost time: 1.154794692993164
Epoch: 15, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.733 Vali Acc: 0.756 Test Loss: 0.733 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1571686267852783
Epoch: 16, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.694 Vali Acc: 0.811 Test Loss: 0.694 Test Acc: 0.811
Validation loss decreased (-0.761104 --> -0.811104).  Saving model ...
Epoch: 17 cost time: 1.070669174194336
Epoch: 17, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.714 Vali Acc: 0.778 Test Loss: 0.714 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.052070140838623
Epoch: 18, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.642 Vali Acc: 0.806 Test Loss: 0.642 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0860705375671387
Epoch: 19, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.633 Vali Acc: 0.822 Test Loss: 0.633 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822216).  Saving model ...
Epoch: 20 cost time: 1.0558624267578125
Epoch: 20, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.673 Vali Acc: 0.833 Test Loss: 0.673 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 21 cost time: 0.9759693145751953
Epoch: 21, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.675 Vali Acc: 0.833 Test Loss: 0.675 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0660240650177002
Epoch: 22, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.606 Vali Acc: 0.844 Test Loss: 0.606 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 23 cost time: 1.0766890048980713
Epoch: 23, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.632 Vali Acc: 0.856 Test Loss: 0.632 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 24 cost time: 1.1776158809661865
Epoch: 24, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.642 Vali Acc: 0.839 Test Loss: 0.642 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1137361526489258
Epoch: 25, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.654 Vali Acc: 0.856 Test Loss: 0.654 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0943183898925781
Epoch: 26, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.672 Vali Acc: 0.828 Test Loss: 0.672 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1043648719787598
Epoch: 27, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.708 Vali Acc: 0.856 Test Loss: 0.708 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0614714622497559
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.706 Vali Acc: 0.839 Test Loss: 0.706 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0059609413146973
Epoch: 29, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.693 Vali Acc: 0.861 Test Loss: 0.693 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861104).  Saving model ...
Epoch: 30 cost time: 1.0473887920379639
Epoch: 30, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.725 Vali Acc: 0.850 Test Loss: 0.725 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9942114353179932
Epoch: 31, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.742 Vali Acc: 0.850 Test Loss: 0.742 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9679105281829834
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.717 Vali Acc: 0.861 Test Loss: 0.717 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9310672283172607
Epoch: 33, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.723 Vali Acc: 0.828 Test Loss: 0.723 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9746723175048828
Epoch: 34, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.761 Vali Acc: 0.844 Test Loss: 0.761 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9516251087188721
Epoch: 35, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.755 Vali Acc: 0.850 Test Loss: 0.755 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0598196983337402
Epoch: 36, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.787 Vali Acc: 0.844 Test Loss: 0.787 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1113708019256592
Epoch: 37, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.796 Vali Acc: 0.844 Test Loss: 0.796 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0455269813537598
Epoch: 38, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.740 Vali Acc: 0.844 Test Loss: 0.740 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.1334772109985352
Epoch: 39, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.809 Vali Acc: 0.856 Test Loss: 0.809 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 405775
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2985239028930664
Epoch: 1, Steps: 12 | Train Loss: 2.700 Vali Loss: 2.677 Vali Acc: 0.167 Test Loss: 2.677 Test Acc: 0.167
Validation loss decreased (inf --> -0.166640).  Saving model ...
Epoch: 2 cost time: 1.0562491416931152
Epoch: 2, Steps: 12 | Train Loss: 2.547 Vali Loss: 2.528 Vali Acc: 0.317 Test Loss: 2.528 Test Acc: 0.317
Validation loss decreased (-0.166640 --> -0.316641).  Saving model ...
Epoch: 3 cost time: 1.0639979839324951
Epoch: 3, Steps: 12 | Train Loss: 2.341 Vali Loss: 2.292 Vali Acc: 0.444 Test Loss: 2.292 Test Acc: 0.444
Validation loss decreased (-0.316641 --> -0.444422).  Saving model ...
Epoch: 4 cost time: 1.0136213302612305
Epoch: 4, Steps: 12 | Train Loss: 2.053 Vali Loss: 1.995 Vali Acc: 0.544 Test Loss: 1.995 Test Acc: 0.544
Validation loss decreased (-0.444422 --> -0.544424).  Saving model ...
Epoch: 5 cost time: 1.110382318496704
Epoch: 5, Steps: 12 | Train Loss: 1.681 Vali Loss: 1.679 Vali Acc: 0.622 Test Loss: 1.679 Test Acc: 0.622
Validation loss decreased (-0.544424 --> -0.622205).  Saving model ...
Epoch: 6 cost time: 1.0445044040679932
Epoch: 6, Steps: 12 | Train Loss: 1.342 Vali Loss: 1.388 Vali Acc: 0.644 Test Loss: 1.388 Test Acc: 0.644
Validation loss decreased (-0.622205 --> -0.644431).  Saving model ...
Epoch: 7 cost time: 1.0829353332519531
Epoch: 7, Steps: 12 | Train Loss: 1.060 Vali Loss: 1.219 Vali Acc: 0.650 Test Loss: 1.219 Test Acc: 0.650
Validation loss decreased (-0.644431 --> -0.649988).  Saving model ...
Epoch: 8 cost time: 1.0599029064178467
Epoch: 8, Steps: 12 | Train Loss: 0.869 Vali Loss: 1.078 Vali Acc: 0.678 Test Loss: 1.078 Test Acc: 0.678
Validation loss decreased (-0.649988 --> -0.677767).  Saving model ...
Epoch: 9 cost time: 1.0335311889648438
Epoch: 9, Steps: 12 | Train Loss: 0.691 Vali Loss: 1.001 Vali Acc: 0.700 Test Loss: 1.001 Test Acc: 0.700
Validation loss decreased (-0.677767 --> -0.699990).  Saving model ...
Epoch: 10 cost time: 1.152294635772705
Epoch: 10, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.923 Vali Acc: 0.733 Test Loss: 0.923 Test Acc: 0.733
Validation loss decreased (-0.699990 --> -0.733324).  Saving model ...
Epoch: 11 cost time: 1.0727648735046387
Epoch: 11, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.822 Vali Acc: 0.711 Test Loss: 0.822 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9838724136352539
Epoch: 12, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.781 Vali Acc: 0.767 Test Loss: 0.781 Test Acc: 0.767
Validation loss decreased (-0.733324 --> -0.766659).  Saving model ...
Epoch: 13 cost time: 0.9825241565704346
Epoch: 13, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.777 Vali Acc: 0.778 Test Loss: 0.777 Test Acc: 0.778
Validation loss decreased (-0.766659 --> -0.777770).  Saving model ...
Epoch: 14 cost time: 0.9617078304290771
Epoch: 14, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.688 Vali Acc: 0.800 Test Loss: 0.688 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799993).  Saving model ...
Epoch: 15 cost time: 0.9711313247680664
Epoch: 15, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.649 Vali Acc: 0.822 Test Loss: 0.649 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 16 cost time: 0.9236443042755127
Epoch: 16, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.645 Vali Acc: 0.822 Test Loss: 0.645 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 17 cost time: 0.9574646949768066
Epoch: 17, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.653 Vali Acc: 0.828 Test Loss: 0.653 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827771).  Saving model ...
Epoch: 18 cost time: 1.037989616394043
Epoch: 18, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.652 Vali Acc: 0.822 Test Loss: 0.652 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0733113288879395
Epoch: 19, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.634 Vali Acc: 0.844 Test Loss: 0.634 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 20 cost time: 1.0861084461212158
Epoch: 20, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.636 Vali Acc: 0.833 Test Loss: 0.636 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0818603038787842
Epoch: 21, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.626 Vali Acc: 0.822 Test Loss: 0.626 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0841758251190186
Epoch: 22, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.649 Vali Acc: 0.833 Test Loss: 0.649 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0290141105651855
Epoch: 23, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.655 Vali Acc: 0.833 Test Loss: 0.655 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0131092071533203
Epoch: 24, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.660 Vali Acc: 0.850 Test Loss: 0.660 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849993).  Saving model ...
Epoch: 25 cost time: 1.033174753189087
Epoch: 25, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.667 Vali Acc: 0.844 Test Loss: 0.667 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0463581085205078
Epoch: 26, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.701 Vali Acc: 0.839 Test Loss: 0.701 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.015981912612915
Epoch: 27, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.669 Vali Acc: 0.867 Test Loss: 0.669 Test Acc: 0.867
Validation loss decreased (-0.849993 --> -0.866660).  Saving model ...
Epoch: 28 cost time: 0.9682350158691406
Epoch: 28, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.665 Vali Acc: 0.861 Test Loss: 0.665 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9334921836853027
Epoch: 29, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.711 Vali Acc: 0.861 Test Loss: 0.711 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.136324405670166
Epoch: 30, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.680 Vali Acc: 0.856 Test Loss: 0.680 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1088764667510986
Epoch: 31, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.709 Vali Acc: 0.856 Test Loss: 0.709 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0995864868164062
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.726 Vali Acc: 0.850 Test Loss: 0.726 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0705435276031494
Epoch: 33, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.725 Vali Acc: 0.856 Test Loss: 0.725 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.059912919998169
Epoch: 34, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.749 Vali Acc: 0.850 Test Loss: 0.749 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9758925437927246
Epoch: 35, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.771 Vali Acc: 0.833 Test Loss: 0.771 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9546494483947754
Epoch: 36, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.789 Vali Acc: 0.833 Test Loss: 0.789 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.9681768417358398
Epoch: 37, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.775 Vali Acc: 0.844 Test Loss: 0.775 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 405839
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.362048864364624
Epoch: 1, Steps: 12 | Train Loss: 2.672 Vali Loss: 2.610 Vali Acc: 0.167 Test Loss: 2.610 Test Acc: 0.167
Validation loss decreased (inf --> -0.166641).  Saving model ...
Epoch: 2 cost time: 1.068598985671997
Epoch: 2, Steps: 12 | Train Loss: 2.530 Vali Loss: 2.484 Vali Acc: 0.272 Test Loss: 2.484 Test Acc: 0.272
Validation loss decreased (-0.166641 --> -0.272197).  Saving model ...
Epoch: 3 cost time: 1.0859394073486328
Epoch: 3, Steps: 12 | Train Loss: 2.346 Vali Loss: 2.276 Vali Acc: 0.489 Test Loss: 2.276 Test Acc: 0.489
Validation loss decreased (-0.272197 --> -0.488866).  Saving model ...
Epoch: 4 cost time: 1.0709986686706543
Epoch: 4, Steps: 12 | Train Loss: 2.097 Vali Loss: 2.020 Vali Acc: 0.567 Test Loss: 2.020 Test Acc: 0.567
Validation loss decreased (-0.488866 --> -0.566646).  Saving model ...
Epoch: 5 cost time: 1.0602052211761475
Epoch: 5, Steps: 12 | Train Loss: 1.787 Vali Loss: 1.744 Vali Acc: 0.589 Test Loss: 1.744 Test Acc: 0.589
Validation loss decreased (-0.566646 --> -0.588871).  Saving model ...
Epoch: 6 cost time: 1.074540376663208
Epoch: 6, Steps: 12 | Train Loss: 1.505 Vali Loss: 1.505 Vali Acc: 0.611 Test Loss: 1.505 Test Acc: 0.611
Validation loss decreased (-0.588871 --> -0.611096).  Saving model ...
Epoch: 7 cost time: 1.1003656387329102
Epoch: 7, Steps: 12 | Train Loss: 1.269 Vali Loss: 1.326 Vali Acc: 0.644 Test Loss: 1.326 Test Acc: 0.644
Validation loss decreased (-0.611096 --> -0.644431).  Saving model ...
Epoch: 8 cost time: 1.0598094463348389
Epoch: 8, Steps: 12 | Train Loss: 1.066 Vali Loss: 1.165 Vali Acc: 0.661 Test Loss: 1.165 Test Acc: 0.661
Validation loss decreased (-0.644431 --> -0.661099).  Saving model ...
Epoch: 9 cost time: 0.9825253486633301
Epoch: 9, Steps: 12 | Train Loss: 0.912 Vali Loss: 1.048 Vali Acc: 0.694 Test Loss: 1.048 Test Acc: 0.694
Validation loss decreased (-0.661099 --> -0.694434).  Saving model ...
Epoch: 10 cost time: 1.0188169479370117
Epoch: 10, Steps: 12 | Train Loss: 0.760 Vali Loss: 0.954 Vali Acc: 0.678 Test Loss: 0.954 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0268580913543701
Epoch: 11, Steps: 12 | Train Loss: 0.673 Vali Loss: 0.882 Vali Acc: 0.711 Test Loss: 0.882 Test Acc: 0.711
Validation loss decreased (-0.694434 --> -0.711102).  Saving model ...
Epoch: 12 cost time: 1.0461156368255615
Epoch: 12, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.805 Vali Acc: 0.744 Test Loss: 0.805 Test Acc: 0.744
Validation loss decreased (-0.711102 --> -0.744436).  Saving model ...
Epoch: 13 cost time: 1.1351399421691895
Epoch: 13, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.768 Vali Acc: 0.739 Test Loss: 0.768 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.06964111328125
Epoch: 14, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.745 Vali Acc: 0.772 Test Loss: 0.745 Test Acc: 0.772
Validation loss decreased (-0.744436 --> -0.772215).  Saving model ...
Epoch: 15 cost time: 1.0986416339874268
Epoch: 15, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.693 Vali Acc: 0.800 Test Loss: 0.693 Test Acc: 0.800
Validation loss decreased (-0.772215 --> -0.799993).  Saving model ...
Epoch: 16 cost time: 1.1169307231903076
Epoch: 16, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.656 Vali Acc: 0.806 Test Loss: 0.656 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 17 cost time: 1.0354382991790771
Epoch: 17, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.624 Vali Acc: 0.833 Test Loss: 0.624 Test Acc: 0.833
Validation loss decreased (-0.805549 --> -0.833327).  Saving model ...
Epoch: 18 cost time: 1.0974531173706055
Epoch: 18, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.615 Vali Acc: 0.828 Test Loss: 0.615 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9872846603393555
Epoch: 19, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.591 Vali Acc: 0.844 Test Loss: 0.591 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844439).  Saving model ...
Epoch: 20 cost time: 0.9980120658874512
Epoch: 20, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 21 cost time: 1.0379161834716797
Epoch: 21, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.595 Vali Acc: 0.844 Test Loss: 0.595 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0060360431671143
Epoch: 22, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.619 Vali Acc: 0.844 Test Loss: 0.619 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0267236232757568
Epoch: 23, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.593 Vali Acc: 0.861 Test Loss: 0.593 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 24 cost time: 1.0397658348083496
Epoch: 24, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.600 Vali Acc: 0.861 Test Loss: 0.600 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.133049726486206
Epoch: 25, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.629 Vali Acc: 0.856 Test Loss: 0.629 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1085448265075684
Epoch: 26, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.658 Vali Acc: 0.856 Test Loss: 0.658 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1293659210205078
Epoch: 27, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.624 Vali Acc: 0.872 Test Loss: 0.624 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 28 cost time: 1.0693705081939697
Epoch: 28, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.599 Vali Acc: 0.872 Test Loss: 0.599 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 29 cost time: 1.0584287643432617
Epoch: 29, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.647 Vali Acc: 0.867 Test Loss: 0.647 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0529041290283203
Epoch: 30, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.656 Vali Acc: 0.867 Test Loss: 0.656 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0099196434020996
Epoch: 31, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.638 Vali Acc: 0.861 Test Loss: 0.638 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0384695529937744
Epoch: 32, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.683 Vali Acc: 0.883 Test Loss: 0.683 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883327).  Saving model ...
Epoch: 33 cost time: 1.0321943759918213
Epoch: 33, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.696 Vali Acc: 0.867 Test Loss: 0.696 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0556104183197021
Epoch: 34, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.720 Vali Acc: 0.883 Test Loss: 0.720 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0524017810821533
Epoch: 35, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.692 Vali Acc: 0.889 Test Loss: 0.692 Test Acc: 0.889
Validation loss decreased (-0.883327 --> -0.888882).  Saving model ...
Epoch: 36 cost time: 1.0462582111358643
Epoch: 36, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.712 Vali Acc: 0.878 Test Loss: 0.712 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0326964855194092
Epoch: 37, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.736 Vali Acc: 0.878 Test Loss: 0.736 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.095874547958374
Epoch: 38, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.733 Vali Acc: 0.878 Test Loss: 0.733 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0760936737060547
Epoch: 39, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.761 Vali Acc: 0.883 Test Loss: 0.761 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0704312324523926
Epoch: 40, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.761 Vali Acc: 0.883 Test Loss: 0.761 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9841194152832031
Epoch: 41, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.799 Vali Acc: 0.883 Test Loss: 0.799 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.0225813388824463
Epoch: 42, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.797 Vali Acc: 0.861 Test Loss: 0.797 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.0275683403015137
Epoch: 43, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.752 Vali Acc: 0.861 Test Loss: 0.752 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.9952969551086426
Epoch: 44, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.840 Vali Acc: 0.872 Test Loss: 0.840 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.0240085124969482
Epoch: 45, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.794 Vali Acc: 0.889 Test Loss: 0.794 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 394383
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3671040534973145
Epoch: 1, Steps: 12 | Train Loss: 2.734 Vali Loss: 2.683 Vali Acc: 0.072 Test Loss: 2.683 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 1.0539207458496094
Epoch: 2, Steps: 12 | Train Loss: 2.629 Vali Loss: 2.589 Vali Acc: 0.222 Test Loss: 2.589 Test Acc: 0.222
Validation loss decreased (-0.072195 --> -0.222196).  Saving model ...
Epoch: 3 cost time: 1.0504026412963867
Epoch: 3, Steps: 12 | Train Loss: 2.459 Vali Loss: 2.429 Vali Acc: 0.483 Test Loss: 2.429 Test Acc: 0.483
Validation loss decreased (-0.222196 --> -0.483309).  Saving model ...
Epoch: 4 cost time: 1.0881431102752686
Epoch: 4, Steps: 12 | Train Loss: 2.240 Vali Loss: 2.208 Vali Acc: 0.528 Test Loss: 2.208 Test Acc: 0.528
Validation loss decreased (-0.483309 --> -0.527756).  Saving model ...
Epoch: 5 cost time: 1.0704150199890137
Epoch: 5, Steps: 12 | Train Loss: 1.971 Vali Loss: 1.968 Vali Acc: 0.583 Test Loss: 1.968 Test Acc: 0.583
Validation loss decreased (-0.527756 --> -0.583314).  Saving model ...
Epoch: 6 cost time: 1.1081459522247314
Epoch: 6, Steps: 12 | Train Loss: 1.710 Vali Loss: 1.733 Vali Acc: 0.578 Test Loss: 1.733 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.032658338546753
Epoch: 7, Steps: 12 | Train Loss: 1.414 Vali Loss: 1.504 Vali Acc: 0.622 Test Loss: 1.504 Test Acc: 0.622
Validation loss decreased (-0.583314 --> -0.622207).  Saving model ...
Epoch: 8 cost time: 1.0178773403167725
Epoch: 8, Steps: 12 | Train Loss: 1.197 Vali Loss: 1.319 Vali Acc: 0.661 Test Loss: 1.319 Test Acc: 0.661
Validation loss decreased (-0.622207 --> -0.661098).  Saving model ...
Epoch: 9 cost time: 1.0182075500488281
Epoch: 9, Steps: 12 | Train Loss: 0.988 Vali Loss: 1.172 Vali Acc: 0.672 Test Loss: 1.172 Test Acc: 0.672
Validation loss decreased (-0.661098 --> -0.672210).  Saving model ...
Epoch: 10 cost time: 0.9436240196228027
Epoch: 10, Steps: 12 | Train Loss: 0.827 Vali Loss: 1.077 Vali Acc: 0.700 Test Loss: 1.077 Test Acc: 0.700
Validation loss decreased (-0.672210 --> -0.699989).  Saving model ...
Epoch: 11 cost time: 1.024984359741211
Epoch: 11, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.983 Vali Acc: 0.706 Test Loss: 0.983 Test Acc: 0.706
Validation loss decreased (-0.699989 --> -0.705546).  Saving model ...
Epoch: 12 cost time: 0.9810094833374023
Epoch: 12, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.913 Vali Acc: 0.722 Test Loss: 0.913 Test Acc: 0.722
Validation loss decreased (-0.705546 --> -0.722213).  Saving model ...
Epoch: 13 cost time: 1.0074920654296875
Epoch: 13, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.859 Vali Acc: 0.739 Test Loss: 0.859 Test Acc: 0.739
Validation loss decreased (-0.722213 --> -0.738880).  Saving model ...
Epoch: 14 cost time: 1.0537350177764893
Epoch: 14, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.801 Vali Acc: 0.739 Test Loss: 0.801 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738881).  Saving model ...
Epoch: 15 cost time: 1.088979959487915
Epoch: 15, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.756 Vali Acc: 0.778 Test Loss: 0.756 Test Acc: 0.778
Validation loss decreased (-0.738881 --> -0.777770).  Saving model ...
Epoch: 16 cost time: 0.9324905872344971
Epoch: 16, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.711 Vali Acc: 0.806 Test Loss: 0.711 Test Acc: 0.806
Validation loss decreased (-0.777770 --> -0.805548).  Saving model ...
Epoch: 17 cost time: 0.8784782886505127
Epoch: 17, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.687 Vali Acc: 0.817 Test Loss: 0.687 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816660).  Saving model ...
Epoch: 18 cost time: 0.8708336353302002
Epoch: 18, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.654 Vali Acc: 0.828 Test Loss: 0.654 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 19 cost time: 0.8527469635009766
Epoch: 19, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.639 Vali Acc: 0.828 Test Loss: 0.639 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 20 cost time: 0.8607211112976074
Epoch: 20, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.639 Vali Acc: 0.828 Test Loss: 0.639 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8646953105926514
Epoch: 21, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.623 Vali Acc: 0.828 Test Loss: 0.623 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827772).  Saving model ...
Epoch: 22 cost time: 1.012511968612671
Epoch: 22, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
Validation loss decreased (-0.827772 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 1.0693962574005127
Epoch: 23, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.649 Vali Acc: 0.861 Test Loss: 0.649 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 24 cost time: 1.0484557151794434
Epoch: 24, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.618 Vali Acc: 0.856 Test Loss: 0.618 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0393106937408447
Epoch: 25, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.602 Vali Acc: 0.844 Test Loss: 0.602 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.072122573852539
Epoch: 26, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.598 Vali Acc: 0.861 Test Loss: 0.598 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 27 cost time: 0.9846489429473877
Epoch: 27, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.649 Vali Acc: 0.867 Test Loss: 0.649 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 28 cost time: 0.9689881801605225
Epoch: 28, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.641 Vali Acc: 0.861 Test Loss: 0.641 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9460787773132324
Epoch: 29, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.608 Vali Acc: 0.867 Test Loss: 0.608 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866661).  Saving model ...
Epoch: 30 cost time: 0.969916820526123
Epoch: 30, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.608 Vali Acc: 0.861 Test Loss: 0.608 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.993706226348877
Epoch: 31, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.653 Vali Acc: 0.872 Test Loss: 0.653 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 32 cost time: 1.0158195495605469
Epoch: 32, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.658 Vali Acc: 0.872 Test Loss: 0.658 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0464551448822021
Epoch: 33, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.676 Vali Acc: 0.850 Test Loss: 0.676 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9185359477996826
Epoch: 34, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.678 Vali Acc: 0.861 Test Loss: 0.678 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0566010475158691
Epoch: 35, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.677 Vali Acc: 0.856 Test Loss: 0.677 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.0043818950653076
Epoch: 36, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.677 Vali Acc: 0.872 Test Loss: 0.677 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.0039184093475342
Epoch: 37, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.701 Vali Acc: 0.856 Test Loss: 0.701 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.0286498069763184
Epoch: 38, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.706 Vali Acc: 0.878 Test Loss: 0.706 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877771).  Saving model ...
Epoch: 39 cost time: 0.9991264343261719
Epoch: 39, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.716 Vali Acc: 0.867 Test Loss: 0.716 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9594740867614746
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.730 Vali Acc: 0.889 Test Loss: 0.730 Test Acc: 0.889
Validation loss decreased (-0.877771 --> -0.888882).  Saving model ...
Epoch: 41 cost time: 0.9603734016418457
Epoch: 41, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.748 Vali Acc: 0.883 Test Loss: 0.748 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.983313798904419
Epoch: 42, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.768 Vali Acc: 0.867 Test Loss: 0.768 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0099165439605713
Epoch: 43, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.778 Vali Acc: 0.872 Test Loss: 0.778 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8992867469787598
Epoch: 44, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.762 Vali Acc: 0.878 Test Loss: 0.762 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.0554594993591309
Epoch: 45, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.784 Vali Acc: 0.861 Test Loss: 0.784 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.0651838779449463
Epoch: 46, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.808 Vali Acc: 0.878 Test Loss: 0.808 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.1015739440917969
Epoch: 47, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.800 Vali Acc: 0.872 Test Loss: 0.800 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.0446100234985352
Epoch: 48, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.799 Vali Acc: 0.883 Test Loss: 0.799 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.084012746810913
Epoch: 49, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.798 Vali Acc: 0.878 Test Loss: 0.798 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.1005580425262451
Epoch: 50, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.810 Vali Acc: 0.872 Test Loss: 0.810 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 386831
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3452370166778564
Epoch: 1, Steps: 12 | Train Loss: 2.726 Vali Loss: 2.690 Vali Acc: 0.117 Test Loss: 2.690 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 0.9893720149993896
Epoch: 2, Steps: 12 | Train Loss: 2.612 Vali Loss: 2.600 Vali Acc: 0.172 Test Loss: 2.600 Test Acc: 0.172
Validation loss decreased (-0.116640 --> -0.172196).  Saving model ...
Epoch: 3 cost time: 0.8501579761505127
Epoch: 3, Steps: 12 | Train Loss: 2.481 Vali Loss: 2.450 Vali Acc: 0.372 Test Loss: 2.450 Test Acc: 0.372
Validation loss decreased (-0.172196 --> -0.372198).  Saving model ...
Epoch: 4 cost time: 0.904616117477417
Epoch: 4, Steps: 12 | Train Loss: 2.285 Vali Loss: 2.249 Vali Acc: 0.489 Test Loss: 2.249 Test Acc: 0.489
Validation loss decreased (-0.372198 --> -0.488866).  Saving model ...
Epoch: 5 cost time: 0.8881471157073975
Epoch: 5, Steps: 12 | Train Loss: 2.077 Vali Loss: 2.025 Vali Acc: 0.528 Test Loss: 2.025 Test Acc: 0.528
Validation loss decreased (-0.488866 --> -0.527758).  Saving model ...
Epoch: 6 cost time: 0.8845391273498535
Epoch: 6, Steps: 12 | Train Loss: 1.822 Vali Loss: 1.773 Vali Acc: 0.611 Test Loss: 1.773 Test Acc: 0.611
Validation loss decreased (-0.527758 --> -0.611093).  Saving model ...
Epoch: 7 cost time: 0.9220075607299805
Epoch: 7, Steps: 12 | Train Loss: 1.523 Vali Loss: 1.544 Vali Acc: 0.617 Test Loss: 1.544 Test Acc: 0.617
Validation loss decreased (-0.611093 --> -0.616651).  Saving model ...
Epoch: 8 cost time: 0.8772900104522705
Epoch: 8, Steps: 12 | Train Loss: 1.286 Vali Loss: 1.344 Vali Acc: 0.633 Test Loss: 1.344 Test Acc: 0.633
Validation loss decreased (-0.616651 --> -0.633320).  Saving model ...
Epoch: 9 cost time: 0.8460843563079834
Epoch: 9, Steps: 12 | Train Loss: 1.077 Vali Loss: 1.189 Vali Acc: 0.661 Test Loss: 1.189 Test Acc: 0.661
Validation loss decreased (-0.633320 --> -0.661099).  Saving model ...
Epoch: 10 cost time: 0.8706629276275635
Epoch: 10, Steps: 12 | Train Loss: 0.920 Vali Loss: 1.064 Vali Acc: 0.678 Test Loss: 1.064 Test Acc: 0.678
Validation loss decreased (-0.661099 --> -0.677767).  Saving model ...
Epoch: 11 cost time: 0.8808670043945312
Epoch: 11, Steps: 12 | Train Loss: 0.735 Vali Loss: 0.964 Vali Acc: 0.728 Test Loss: 0.964 Test Acc: 0.728
Validation loss decreased (-0.677767 --> -0.727768).  Saving model ...
Epoch: 12 cost time: 0.9906136989593506
Epoch: 12, Steps: 12 | Train Loss: 0.691 Vali Loss: 0.879 Vali Acc: 0.728 Test Loss: 0.879 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727769).  Saving model ...
Epoch: 13 cost time: 0.9797255992889404
Epoch: 13, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.810 Vali Acc: 0.756 Test Loss: 0.810 Test Acc: 0.756
Validation loss decreased (-0.727769 --> -0.755547).  Saving model ...
Epoch: 14 cost time: 1.0328307151794434
Epoch: 14, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.751 Vali Acc: 0.783 Test Loss: 0.751 Test Acc: 0.783
Validation loss decreased (-0.755547 --> -0.783326).  Saving model ...
Epoch: 15 cost time: 1.0385708808898926
Epoch: 15, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.727 Vali Acc: 0.817 Test Loss: 0.727 Test Acc: 0.817
Validation loss decreased (-0.783326 --> -0.816659).  Saving model ...
Epoch: 16 cost time: 1.1049473285675049
Epoch: 16, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.692 Vali Acc: 0.811 Test Loss: 0.692 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1115717887878418
Epoch: 17, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.652 Vali Acc: 0.817 Test Loss: 0.652 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816660).  Saving model ...
Epoch: 18 cost time: 1.119659662246704
Epoch: 18, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.630 Vali Acc: 0.839 Test Loss: 0.630 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838883).  Saving model ...
Epoch: 19 cost time: 1.0381760597229004
Epoch: 19, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.614 Vali Acc: 0.833 Test Loss: 0.614 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9890635013580322
Epoch: 20, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.600 Vali Acc: 0.856 Test Loss: 0.600 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 21 cost time: 1.0366489887237549
Epoch: 21, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.567 Vali Acc: 0.856 Test Loss: 0.567 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 22 cost time: 1.0140819549560547
Epoch: 22, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0410728454589844
Epoch: 23, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0295734405517578
Epoch: 24, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.529 Vali Acc: 0.861 Test Loss: 0.529 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 25 cost time: 1.0032663345336914
Epoch: 25, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.099318027496338
Epoch: 26, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.577 Vali Acc: 0.856 Test Loss: 0.577 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1100132465362549
Epoch: 27, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.545 Vali Acc: 0.861 Test Loss: 0.545 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1191377639770508
Epoch: 28, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.576 Vali Acc: 0.872 Test Loss: 0.576 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872216).  Saving model ...
Epoch: 29 cost time: 1.0956850051879883
Epoch: 29, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.578 Vali Acc: 0.878 Test Loss: 0.578 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 30 cost time: 1.0542235374450684
Epoch: 30, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.597 Vali Acc: 0.861 Test Loss: 0.597 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0484094619750977
Epoch: 31, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.578 Vali Acc: 0.867 Test Loss: 0.578 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9907381534576416
Epoch: 32, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.592 Vali Acc: 0.883 Test Loss: 0.592 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 33 cost time: 0.9693319797515869
Epoch: 33, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.593 Vali Acc: 0.878 Test Loss: 0.593 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9557359218597412
Epoch: 34, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.603 Vali Acc: 0.872 Test Loss: 0.603 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.011620044708252
Epoch: 35, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.616 Vali Acc: 0.872 Test Loss: 0.616 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0078208446502686
Epoch: 36, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.602 Vali Acc: 0.872 Test Loss: 0.602 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0335633754730225
Epoch: 37, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.606 Vali Acc: 0.883 Test Loss: 0.606 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0753684043884277
Epoch: 38, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.617 Vali Acc: 0.889 Test Loss: 0.617 Test Acc: 0.889
Validation loss decreased (-0.883327 --> -0.888883).  Saving model ...
Epoch: 39 cost time: 1.0809955596923828
Epoch: 39, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.605 Vali Acc: 0.872 Test Loss: 0.605 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0682413578033447
Epoch: 40, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.611 Vali Acc: 0.883 Test Loss: 0.611 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0783705711364746
Epoch: 41, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.645 Vali Acc: 0.894 Test Loss: 0.645 Test Acc: 0.894
Validation loss decreased (-0.888883 --> -0.894438).  Saving model ...
Epoch: 42 cost time: 1.0732147693634033
Epoch: 42, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.640 Vali Acc: 0.878 Test Loss: 0.640 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.065666675567627
Epoch: 43, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.666 Vali Acc: 0.889 Test Loss: 0.666 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0212888717651367
Epoch: 44, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.664 Vali Acc: 0.889 Test Loss: 0.664 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0656051635742188
Epoch: 45, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.678 Vali Acc: 0.889 Test Loss: 0.678 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0305359363555908
Epoch: 46, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.693 Vali Acc: 0.889 Test Loss: 0.693 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.069873332977295
Epoch: 47, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.684 Vali Acc: 0.883 Test Loss: 0.684 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.0755088329315186
Epoch: 48, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.686 Vali Acc: 0.889 Test Loss: 0.686 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.035407304763794
Epoch: 49, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.676 Vali Acc: 0.894 Test Loss: 0.676 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.0707676410675049
Epoch: 50, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.670 Vali Acc: 0.894 Test Loss: 0.670 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 383119
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.336139678955078
Epoch: 1, Steps: 12 | Train Loss: 2.749 Vali Loss: 2.711 Vali Acc: 0.089 Test Loss: 2.711 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 1.0888078212738037
Epoch: 2, Steps: 12 | Train Loss: 2.673 Vali Loss: 2.637 Vali Acc: 0.128 Test Loss: 2.637 Test Acc: 0.128
Validation loss decreased (-0.088862 --> -0.127751).  Saving model ...
Epoch: 3 cost time: 1.0396690368652344
Epoch: 3, Steps: 12 | Train Loss: 2.544 Vali Loss: 2.505 Vali Acc: 0.261 Test Loss: 2.505 Test Acc: 0.261
Validation loss decreased (-0.127751 --> -0.261086).  Saving model ...
Epoch: 4 cost time: 0.9613773822784424
Epoch: 4, Steps: 12 | Train Loss: 2.363 Vali Loss: 2.340 Vali Acc: 0.411 Test Loss: 2.340 Test Acc: 0.411
Validation loss decreased (-0.261086 --> -0.411088).  Saving model ...
Epoch: 5 cost time: 1.0128870010375977
Epoch: 5, Steps: 12 | Train Loss: 2.183 Vali Loss: 2.144 Vali Acc: 0.506 Test Loss: 2.144 Test Acc: 0.506
Validation loss decreased (-0.411088 --> -0.505534).  Saving model ...
Epoch: 6 cost time: 0.9364676475524902
Epoch: 6, Steps: 12 | Train Loss: 1.960 Vali Loss: 1.927 Vali Acc: 0.561 Test Loss: 1.927 Test Acc: 0.561
Validation loss decreased (-0.505534 --> -0.561092).  Saving model ...
Epoch: 7 cost time: 0.9567186832427979
Epoch: 7, Steps: 12 | Train Loss: 1.736 Vali Loss: 1.700 Vali Acc: 0.606 Test Loss: 1.700 Test Acc: 0.606
Validation loss decreased (-0.561092 --> -0.605539).  Saving model ...
Epoch: 8 cost time: 1.0182280540466309
Epoch: 8, Steps: 12 | Train Loss: 1.439 Vali Loss: 1.485 Vali Acc: 0.639 Test Loss: 1.485 Test Acc: 0.639
Validation loss decreased (-0.605539 --> -0.638874).  Saving model ...
Epoch: 9 cost time: 0.9430387020111084
Epoch: 9, Steps: 12 | Train Loss: 1.249 Vali Loss: 1.305 Vali Acc: 0.667 Test Loss: 1.305 Test Acc: 0.667
Validation loss decreased (-0.638874 --> -0.666654).  Saving model ...
Epoch: 10 cost time: 1.1135485172271729
Epoch: 10, Steps: 12 | Train Loss: 1.033 Vali Loss: 1.148 Vali Acc: 0.711 Test Loss: 1.148 Test Acc: 0.711
Validation loss decreased (-0.666654 --> -0.711100).  Saving model ...
Epoch: 11 cost time: 1.0818641185760498
Epoch: 11, Steps: 12 | Train Loss: 0.874 Vali Loss: 1.025 Vali Acc: 0.711 Test Loss: 1.025 Test Acc: 0.711
Validation loss decreased (-0.711100 --> -0.711101).  Saving model ...
Epoch: 12 cost time: 1.117842435836792
Epoch: 12, Steps: 12 | Train Loss: 0.795 Vali Loss: 0.935 Vali Acc: 0.744 Test Loss: 0.935 Test Acc: 0.744
Validation loss decreased (-0.711101 --> -0.744435).  Saving model ...
Epoch: 13 cost time: 1.052393913269043
Epoch: 13, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.860 Vali Acc: 0.756 Test Loss: 0.860 Test Acc: 0.756
Validation loss decreased (-0.744435 --> -0.755547).  Saving model ...
Epoch: 14 cost time: 0.9901959896087646
Epoch: 14, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.799 Vali Acc: 0.778 Test Loss: 0.799 Test Acc: 0.778
Validation loss decreased (-0.755547 --> -0.777770).  Saving model ...
Epoch: 15 cost time: 1.0167279243469238
Epoch: 15, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.755 Vali Acc: 0.783 Test Loss: 0.755 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783326).  Saving model ...
Epoch: 16 cost time: 1.010519027709961
Epoch: 16, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.706 Vali Acc: 0.811 Test Loss: 0.706 Test Acc: 0.811
Validation loss decreased (-0.783326 --> -0.811104).  Saving model ...
Epoch: 17 cost time: 1.0296270847320557
Epoch: 17, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.655 Vali Acc: 0.806 Test Loss: 0.655 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0461015701293945
Epoch: 18, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.635 Vali Acc: 0.844 Test Loss: 0.635 Test Acc: 0.844
Validation loss decreased (-0.811104 --> -0.844438).  Saving model ...
Epoch: 19 cost time: 1.0105922222137451
Epoch: 19, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.603 Vali Acc: 0.839 Test Loss: 0.603 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.119896411895752
Epoch: 20, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.600 Vali Acc: 0.833 Test Loss: 0.600 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1292250156402588
Epoch: 21, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.578 Vali Acc: 0.844 Test Loss: 0.578 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844439).  Saving model ...
Epoch: 22 cost time: 1.1063628196716309
Epoch: 22, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.545 Vali Acc: 0.856 Test Loss: 0.545 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 23 cost time: 1.0940985679626465
Epoch: 23, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.539 Vali Acc: 0.867 Test Loss: 0.539 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 24 cost time: 1.0721409320831299
Epoch: 24, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0216386318206787
Epoch: 25, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.536 Vali Acc: 0.856 Test Loss: 0.536 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9889094829559326
Epoch: 26, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.526 Vali Acc: 0.861 Test Loss: 0.526 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0178725719451904
Epoch: 27, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.518 Vali Acc: 0.856 Test Loss: 0.518 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9263260364532471
Epoch: 28, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.504 Vali Acc: 0.883 Test Loss: 0.504 Test Acc: 0.883
Validation loss decreased (-0.866661 --> -0.883328).  Saving model ...
Epoch: 29 cost time: 0.9287893772125244
Epoch: 29, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.493 Vali Acc: 0.878 Test Loss: 0.493 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9829118251800537
Epoch: 30, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.527 Vali Acc: 0.878 Test Loss: 0.527 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0159106254577637
Epoch: 31, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.511 Vali Acc: 0.872 Test Loss: 0.511 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0071368217468262
Epoch: 32, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.538 Vali Acc: 0.872 Test Loss: 0.538 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0905656814575195
Epoch: 33, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.521 Vali Acc: 0.883 Test Loss: 0.521 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0453622341156006
Epoch: 34, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.536 Vali Acc: 0.861 Test Loss: 0.536 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0211167335510254
Epoch: 35, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.540 Vali Acc: 0.883 Test Loss: 0.540 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0254185199737549
Epoch: 36, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.576 Vali Acc: 0.878 Test Loss: 0.576 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0257606506347656
Epoch: 37, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.565 Vali Acc: 0.867 Test Loss: 0.565 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9959464073181152
Epoch: 38, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.546 Vali Acc: 0.878 Test Loss: 0.546 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 379471
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1591145992279053
Epoch: 1, Steps: 12 | Train Loss: 2.704 Vali Loss: 2.640 Vali Acc: 0.078 Test Loss: 2.640 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 0.9551718235015869
Epoch: 2, Steps: 12 | Train Loss: 2.552 Vali Loss: 2.515 Vali Acc: 0.272 Test Loss: 2.515 Test Acc: 0.272
Validation loss decreased (-0.077751 --> -0.272197).  Saving model ...
Epoch: 3 cost time: 0.8920378684997559
Epoch: 3, Steps: 12 | Train Loss: 2.341 Vali Loss: 2.319 Vali Acc: 0.456 Test Loss: 2.319 Test Acc: 0.456
Validation loss decreased (-0.272197 --> -0.455532).  Saving model ...
Epoch: 4 cost time: 0.9500894546508789
Epoch: 4, Steps: 12 | Train Loss: 2.083 Vali Loss: 2.054 Vali Acc: 0.489 Test Loss: 2.054 Test Acc: 0.489
Validation loss decreased (-0.455532 --> -0.488868).  Saving model ...
Epoch: 5 cost time: 0.9709486961364746
Epoch: 5, Steps: 12 | Train Loss: 1.815 Vali Loss: 1.770 Vali Acc: 0.578 Test Loss: 1.770 Test Acc: 0.578
Validation loss decreased (-0.488868 --> -0.577760).  Saving model ...
Epoch: 6 cost time: 0.9036729335784912
Epoch: 6, Steps: 12 | Train Loss: 1.462 Vali Loss: 1.525 Vali Acc: 0.617 Test Loss: 1.525 Test Acc: 0.617
Validation loss decreased (-0.577760 --> -0.616651).  Saving model ...
Epoch: 7 cost time: 1.001197099685669
Epoch: 7, Steps: 12 | Train Loss: 1.238 Vali Loss: 1.322 Vali Acc: 0.644 Test Loss: 1.322 Test Acc: 0.644
Validation loss decreased (-0.616651 --> -0.644431).  Saving model ...
Epoch: 8 cost time: 0.9572644233703613
Epoch: 8, Steps: 12 | Train Loss: 1.003 Vali Loss: 1.195 Vali Acc: 0.667 Test Loss: 1.195 Test Acc: 0.667
Validation loss decreased (-0.644431 --> -0.666655).  Saving model ...
Epoch: 9 cost time: 0.9209485054016113
Epoch: 9, Steps: 12 | Train Loss: 0.846 Vali Loss: 1.076 Vali Acc: 0.683 Test Loss: 1.076 Test Acc: 0.683
Validation loss decreased (-0.666655 --> -0.683323).  Saving model ...
Epoch: 10 cost time: 0.9288496971130371
Epoch: 10, Steps: 12 | Train Loss: 0.700 Vali Loss: 1.013 Vali Acc: 0.678 Test Loss: 1.013 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9045252799987793
Epoch: 11, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.957 Vali Acc: 0.694 Test Loss: 0.957 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694435).  Saving model ...
Epoch: 12 cost time: 0.8770549297332764
Epoch: 12, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.920 Vali Acc: 0.706 Test Loss: 0.920 Test Acc: 0.706
Validation loss decreased (-0.694435 --> -0.705546).  Saving model ...
Epoch: 13 cost time: 0.8816239833831787
Epoch: 13, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.869 Vali Acc: 0.717 Test Loss: 0.869 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716658).  Saving model ...
Epoch: 14 cost time: 0.821117639541626
Epoch: 14, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.841 Vali Acc: 0.750 Test Loss: 0.841 Test Acc: 0.750
Validation loss decreased (-0.716658 --> -0.749992).  Saving model ...
Epoch: 15 cost time: 0.948601484298706
Epoch: 15, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.820 Vali Acc: 0.756 Test Loss: 0.820 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755547).  Saving model ...
Epoch: 16 cost time: 0.9197642803192139
Epoch: 16, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.828 Vali Acc: 0.761 Test Loss: 0.828 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 17 cost time: 0.9709353446960449
Epoch: 17, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.763 Vali Acc: 0.811 Test Loss: 0.763 Test Acc: 0.811
Validation loss decreased (-0.761103 --> -0.811103).  Saving model ...
Epoch: 18 cost time: 0.9455592632293701
Epoch: 18, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.719 Vali Acc: 0.817 Test Loss: 0.719 Test Acc: 0.817
Validation loss decreased (-0.811103 --> -0.816659).  Saving model ...
Epoch: 19 cost time: 1.017594337463379
Epoch: 19, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.761 Vali Acc: 0.806 Test Loss: 0.761 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0105602741241455
Epoch: 20, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.709 Vali Acc: 0.833 Test Loss: 0.709 Test Acc: 0.833
Validation loss decreased (-0.816659 --> -0.833326).  Saving model ...
Epoch: 21 cost time: 0.9064373970031738
Epoch: 21, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.720 Vali Acc: 0.800 Test Loss: 0.720 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9567744731903076
Epoch: 22, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.713 Vali Acc: 0.856 Test Loss: 0.713 Test Acc: 0.856
Validation loss decreased (-0.833326 --> -0.855548).  Saving model ...
Epoch: 23 cost time: 0.940004825592041
Epoch: 23, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.719 Vali Acc: 0.850 Test Loss: 0.719 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9240469932556152
Epoch: 24, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.756 Vali Acc: 0.828 Test Loss: 0.756 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9185118675231934
Epoch: 25, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.792 Vali Acc: 0.817 Test Loss: 0.792 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9333670139312744
Epoch: 26, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.810 Vali Acc: 0.822 Test Loss: 0.810 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9380753040313721
Epoch: 27, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.836 Vali Acc: 0.833 Test Loss: 0.836 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9951310157775879
Epoch: 28, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.830 Vali Acc: 0.828 Test Loss: 0.830 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0081584453582764
Epoch: 29, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.867 Vali Acc: 0.833 Test Loss: 0.867 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0142967700958252
Epoch: 30, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.943 Vali Acc: 0.828 Test Loss: 0.943 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.0656664371490479
Epoch: 31, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.923 Vali Acc: 0.833 Test Loss: 0.923 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0031554698944092
Epoch: 32, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.907 Vali Acc: 0.833 Test Loss: 0.907 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 139887
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.174921751022339
Epoch: 1, Steps: 12 | Train Loss: 2.699 Vali Loss: 2.684 Vali Acc: 0.128 Test Loss: 2.684 Test Acc: 0.128
Validation loss decreased (inf --> -0.127751).  Saving model ...
Epoch: 2 cost time: 0.8829023838043213
Epoch: 2, Steps: 12 | Train Loss: 2.632 Vali Loss: 2.607 Vali Acc: 0.144 Test Loss: 2.607 Test Acc: 0.144
Validation loss decreased (-0.127751 --> -0.144418).  Saving model ...
Epoch: 3 cost time: 0.9097311496734619
Epoch: 3, Steps: 12 | Train Loss: 2.515 Vali Loss: 2.489 Vali Acc: 0.317 Test Loss: 2.489 Test Acc: 0.317
Validation loss decreased (-0.144418 --> -0.316642).  Saving model ...
Epoch: 4 cost time: 0.9092652797698975
Epoch: 4, Steps: 12 | Train Loss: 2.335 Vali Loss: 2.327 Vali Acc: 0.439 Test Loss: 2.327 Test Acc: 0.439
Validation loss decreased (-0.316642 --> -0.438866).  Saving model ...
Epoch: 5 cost time: 0.8818213939666748
Epoch: 5, Steps: 12 | Train Loss: 2.128 Vali Loss: 2.126 Vali Acc: 0.533 Test Loss: 2.126 Test Acc: 0.533
Validation loss decreased (-0.438866 --> -0.533312).  Saving model ...
Epoch: 6 cost time: 0.8159070014953613
Epoch: 6, Steps: 12 | Train Loss: 1.927 Vali Loss: 1.922 Vali Acc: 0.583 Test Loss: 1.922 Test Acc: 0.583
Validation loss decreased (-0.533312 --> -0.583314).  Saving model ...
Epoch: 7 cost time: 0.893488883972168
Epoch: 7, Steps: 12 | Train Loss: 1.715 Vali Loss: 1.704 Vali Acc: 0.600 Test Loss: 1.704 Test Acc: 0.600
Validation loss decreased (-0.583314 --> -0.599983).  Saving model ...
Epoch: 8 cost time: 0.860337495803833
Epoch: 8, Steps: 12 | Train Loss: 1.476 Vali Loss: 1.508 Vali Acc: 0.644 Test Loss: 1.508 Test Acc: 0.644
Validation loss decreased (-0.599983 --> -0.644429).  Saving model ...
Epoch: 9 cost time: 0.8688457012176514
Epoch: 9, Steps: 12 | Train Loss: 1.221 Vali Loss: 1.373 Vali Acc: 0.672 Test Loss: 1.373 Test Acc: 0.672
Validation loss decreased (-0.644429 --> -0.672208).  Saving model ...
Epoch: 10 cost time: 0.8229494094848633
Epoch: 10, Steps: 12 | Train Loss: 1.102 Vali Loss: 1.262 Vali Acc: 0.672 Test Loss: 1.262 Test Acc: 0.672
Validation loss decreased (-0.672208 --> -0.672210).  Saving model ...
Epoch: 11 cost time: 0.8689591884613037
Epoch: 11, Steps: 12 | Train Loss: 0.936 Vali Loss: 1.163 Vali Acc: 0.700 Test Loss: 1.163 Test Acc: 0.700
Validation loss decreased (-0.672210 --> -0.699988).  Saving model ...
Epoch: 12 cost time: 0.9375050067901611
Epoch: 12, Steps: 12 | Train Loss: 0.844 Vali Loss: 1.089 Vali Acc: 0.700 Test Loss: 1.089 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699989).  Saving model ...
Epoch: 13 cost time: 0.8991382122039795
Epoch: 13, Steps: 12 | Train Loss: 0.747 Vali Loss: 1.032 Vali Acc: 0.672 Test Loss: 1.032 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8853213787078857
Epoch: 14, Steps: 12 | Train Loss: 0.677 Vali Loss: 0.980 Vali Acc: 0.694 Test Loss: 0.980 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9499161243438721
Epoch: 15, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.932 Vali Acc: 0.689 Test Loss: 0.932 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.880396842956543
Epoch: 16, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.907 Vali Acc: 0.689 Test Loss: 0.907 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8879461288452148
Epoch: 17, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.866 Vali Acc: 0.700 Test Loss: 0.866 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699991).  Saving model ...
Epoch: 18 cost time: 0.8919365406036377
Epoch: 18, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.830 Vali Acc: 0.750 Test Loss: 0.830 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749992).  Saving model ...
Epoch: 19 cost time: 0.9439404010772705
Epoch: 19, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.776 Vali Acc: 0.767 Test Loss: 0.776 Test Acc: 0.767
Validation loss decreased (-0.749992 --> -0.766659).  Saving model ...
Epoch: 20 cost time: 0.9496307373046875
Epoch: 20, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.763 Vali Acc: 0.778 Test Loss: 0.763 Test Acc: 0.778
Validation loss decreased (-0.766659 --> -0.777770).  Saving model ...
Epoch: 21 cost time: 0.9694206714630127
Epoch: 21, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.737 Vali Acc: 0.800 Test Loss: 0.737 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799993).  Saving model ...
Epoch: 22 cost time: 0.9501841068267822
Epoch: 22, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.735 Vali Acc: 0.789 Test Loss: 0.735 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9183516502380371
Epoch: 23, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.704 Vali Acc: 0.833 Test Loss: 0.704 Test Acc: 0.833
Validation loss decreased (-0.799993 --> -0.833326).  Saving model ...
Epoch: 24 cost time: 0.9153702259063721
Epoch: 24, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.687 Vali Acc: 0.833 Test Loss: 0.687 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833326).  Saving model ...
Epoch: 25 cost time: 0.9288387298583984
Epoch: 25, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.671 Vali Acc: 0.856 Test Loss: 0.671 Test Acc: 0.856
Validation loss decreased (-0.833326 --> -0.855549).  Saving model ...
Epoch: 26 cost time: 0.9101805686950684
Epoch: 26, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.649 Vali Acc: 0.850 Test Loss: 0.649 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8749816417694092
Epoch: 27, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.667 Vali Acc: 0.839 Test Loss: 0.667 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.976963996887207
Epoch: 28, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.668 Vali Acc: 0.850 Test Loss: 0.668 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.042633056640625
Epoch: 29, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.634 Vali Acc: 0.828 Test Loss: 0.634 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9497027397155762
Epoch: 30, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.655 Vali Acc: 0.839 Test Loss: 0.655 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0031797885894775
Epoch: 31, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.660 Vali Acc: 0.844 Test Loss: 0.660 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9525578022003174
Epoch: 32, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9304277896881104
Epoch: 33, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.637 Vali Acc: 0.822 Test Loss: 0.637 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9545168876647949
Epoch: 34, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.683 Vali Acc: 0.856 Test Loss: 0.683 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.0473077297210693
Epoch: 35, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.692 Vali Acc: 0.861 Test Loss: 0.692 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861104).  Saving model ...
Epoch: 36 cost time: 0.8487527370452881
Epoch: 36, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.669 Vali Acc: 0.856 Test Loss: 0.669 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8573508262634277
Epoch: 37, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.685 Vali Acc: 0.850 Test Loss: 0.685 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8501100540161133
Epoch: 38, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.695 Vali Acc: 0.872 Test Loss: 0.695 Test Acc: 0.872
Validation loss decreased (-0.861104 --> -0.872215).  Saving model ...
Epoch: 39 cost time: 0.786283016204834
Epoch: 39, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.700 Vali Acc: 0.861 Test Loss: 0.700 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8242983818054199
Epoch: 40, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.725 Vali Acc: 0.844 Test Loss: 0.725 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7939701080322266
Epoch: 41, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.734 Vali Acc: 0.844 Test Loss: 0.734 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8519420623779297
Epoch: 42, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.721 Vali Acc: 0.850 Test Loss: 0.721 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.9285831451416016
Epoch: 43, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.725 Vali Acc: 0.856 Test Loss: 0.725 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0438120365142822
Epoch: 44, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.786 Vali Acc: 0.878 Test Loss: 0.786 Test Acc: 0.878
Validation loss decreased (-0.872215 --> -0.877770).  Saving model ...
Epoch: 45 cost time: 0.9131002426147461
Epoch: 45, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.748 Vali Acc: 0.850 Test Loss: 0.748 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9616706371307373
Epoch: 46, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.764 Vali Acc: 0.828 Test Loss: 0.764 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.986555814743042
Epoch: 47, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.806 Vali Acc: 0.833 Test Loss: 0.806 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9030756950378418
Epoch: 48, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.760 Vali Acc: 0.839 Test Loss: 0.760 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8616073131561279
Epoch: 49, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.754 Vali Acc: 0.850 Test Loss: 0.754 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.8987905979156494
Epoch: 50, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.773 Vali Acc: 0.861 Test Loss: 0.773 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 116879
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2104055881500244
Epoch: 1, Steps: 12 | Train Loss: 2.738 Vali Loss: 2.683 Vali Acc: 0.056 Test Loss: 2.683 Test Acc: 0.056
Validation loss decreased (inf --> -0.055529).  Saving model ...
Epoch: 2 cost time: 0.971677303314209
Epoch: 2, Steps: 12 | Train Loss: 2.643 Vali Loss: 2.607 Vali Acc: 0.167 Test Loss: 2.607 Test Acc: 0.167
Validation loss decreased (-0.055529 --> -0.166641).  Saving model ...
Epoch: 3 cost time: 0.8480463027954102
Epoch: 3, Steps: 12 | Train Loss: 2.528 Vali Loss: 2.476 Vali Acc: 0.311 Test Loss: 2.476 Test Acc: 0.311
Validation loss decreased (-0.166641 --> -0.311086).  Saving model ...
Epoch: 4 cost time: 0.8091132640838623
Epoch: 4, Steps: 12 | Train Loss: 2.353 Vali Loss: 2.302 Vali Acc: 0.433 Test Loss: 2.302 Test Acc: 0.433
Validation loss decreased (-0.311086 --> -0.433310).  Saving model ...
Epoch: 5 cost time: 0.7654457092285156
Epoch: 5, Steps: 12 | Train Loss: 2.157 Vali Loss: 2.112 Vali Acc: 0.517 Test Loss: 2.112 Test Acc: 0.517
Validation loss decreased (-0.433310 --> -0.516646).  Saving model ...
Epoch: 6 cost time: 0.8030376434326172
Epoch: 6, Steps: 12 | Train Loss: 1.936 Vali Loss: 1.912 Vali Acc: 0.578 Test Loss: 1.912 Test Acc: 0.578
Validation loss decreased (-0.516646 --> -0.577759).  Saving model ...
Epoch: 7 cost time: 0.811225175857544
Epoch: 7, Steps: 12 | Train Loss: 1.672 Vali Loss: 1.701 Vali Acc: 0.606 Test Loss: 1.701 Test Acc: 0.606
Validation loss decreased (-0.577759 --> -0.605539).  Saving model ...
Epoch: 8 cost time: 0.8552956581115723
Epoch: 8, Steps: 12 | Train Loss: 1.487 Vali Loss: 1.518 Vali Acc: 0.611 Test Loss: 1.518 Test Acc: 0.611
Validation loss decreased (-0.605539 --> -0.611096).  Saving model ...
Epoch: 9 cost time: 0.8026349544525146
Epoch: 9, Steps: 12 | Train Loss: 1.282 Vali Loss: 1.379 Vali Acc: 0.639 Test Loss: 1.379 Test Acc: 0.639
Validation loss decreased (-0.611096 --> -0.638875).  Saving model ...
Epoch: 10 cost time: 0.8217871189117432
Epoch: 10, Steps: 12 | Train Loss: 1.154 Vali Loss: 1.248 Vali Acc: 0.644 Test Loss: 1.248 Test Acc: 0.644
Validation loss decreased (-0.638875 --> -0.644432).  Saving model ...
Epoch: 11 cost time: 0.9195523262023926
Epoch: 11, Steps: 12 | Train Loss: 0.991 Vali Loss: 1.148 Vali Acc: 0.644 Test Loss: 1.148 Test Acc: 0.644
Validation loss decreased (-0.644432 --> -0.644433).  Saving model ...
Epoch: 12 cost time: 0.9073295593261719
Epoch: 12, Steps: 12 | Train Loss: 0.830 Vali Loss: 1.082 Vali Acc: 0.656 Test Loss: 1.082 Test Acc: 0.656
Validation loss decreased (-0.644433 --> -0.655545).  Saving model ...
Epoch: 13 cost time: 0.9848363399505615
Epoch: 13, Steps: 12 | Train Loss: 0.755 Vali Loss: 1.019 Vali Acc: 0.656 Test Loss: 1.019 Test Acc: 0.656
Validation loss decreased (-0.655545 --> -0.655545).  Saving model ...
Epoch: 14 cost time: 1.2046582698822021
Epoch: 14, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.957 Vali Acc: 0.672 Test Loss: 0.957 Test Acc: 0.672
Validation loss decreased (-0.655545 --> -0.672213).  Saving model ...
Epoch: 15 cost time: 0.9127240180969238
Epoch: 15, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.882 Vali Acc: 0.689 Test Loss: 0.882 Test Acc: 0.689
Validation loss decreased (-0.672213 --> -0.688880).  Saving model ...
Epoch: 16 cost time: 0.9233324527740479
Epoch: 16, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.857 Vali Acc: 0.717 Test Loss: 0.857 Test Acc: 0.717
Validation loss decreased (-0.688880 --> -0.716658).  Saving model ...
Epoch: 17 cost time: 0.9263176918029785
Epoch: 17, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.816 Vali Acc: 0.756 Test Loss: 0.816 Test Acc: 0.756
Validation loss decreased (-0.716658 --> -0.755547).  Saving model ...
Epoch: 18 cost time: 0.7892532348632812
Epoch: 18, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.782 Vali Acc: 0.756 Test Loss: 0.782 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755548).  Saving model ...
Epoch: 19 cost time: 0.9053046703338623
Epoch: 19, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.758 Vali Acc: 0.794 Test Loss: 0.758 Test Acc: 0.794
Validation loss decreased (-0.755548 --> -0.794437).  Saving model ...
Epoch: 20 cost time: 0.934368371963501
Epoch: 20, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.723 Vali Acc: 0.800 Test Loss: 0.723 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 21 cost time: 0.9858436584472656
Epoch: 21, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.707 Vali Acc: 0.800 Test Loss: 0.707 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 22 cost time: 0.9833142757415771
Epoch: 22, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.668 Vali Acc: 0.817 Test Loss: 0.668 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816660).  Saving model ...
Epoch: 23 cost time: 0.8476803302764893
Epoch: 23, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.681 Vali Acc: 0.811 Test Loss: 0.681 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8276550769805908
Epoch: 24, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.661 Vali Acc: 0.839 Test Loss: 0.661 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838882).  Saving model ...
Epoch: 25 cost time: 0.8945720195770264
Epoch: 25, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.615 Vali Acc: 0.850 Test Loss: 0.615 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 26 cost time: 0.8749551773071289
Epoch: 26, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.636 Vali Acc: 0.844 Test Loss: 0.636 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9161045551300049
Epoch: 27, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.628 Vali Acc: 0.856 Test Loss: 0.628 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 28 cost time: 0.8474545478820801
Epoch: 28, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.632 Vali Acc: 0.833 Test Loss: 0.632 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8103411197662354
Epoch: 29, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.632 Vali Acc: 0.844 Test Loss: 0.632 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8626852035522461
Epoch: 30, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.629 Vali Acc: 0.850 Test Loss: 0.629 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8228154182434082
Epoch: 31, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.644 Vali Acc: 0.850 Test Loss: 0.644 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8291079998016357
Epoch: 32, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.642 Vali Acc: 0.833 Test Loss: 0.642 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.776667594909668
Epoch: 33, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.650 Vali Acc: 0.844 Test Loss: 0.650 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8666365146636963
Epoch: 34, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.650 Vali Acc: 0.867 Test Loss: 0.650 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866660).  Saving model ...
Epoch: 35 cost time: 0.8188157081604004
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.645 Vali Acc: 0.872 Test Loss: 0.645 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872216).  Saving model ...
Epoch: 36 cost time: 0.8007528781890869
Epoch: 36, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.629 Vali Acc: 0.850 Test Loss: 0.629 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8367185592651367
Epoch: 37, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.658 Vali Acc: 0.872 Test Loss: 0.658 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8838748931884766
Epoch: 38, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.651 Vali Acc: 0.872 Test Loss: 0.651 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9619784355163574
Epoch: 39, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.640 Vali Acc: 0.850 Test Loss: 0.640 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.006565809249878
Epoch: 40, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.682 Vali Acc: 0.883 Test Loss: 0.682 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883327).  Saving model ...
Epoch: 41 cost time: 0.9395854473114014
Epoch: 41, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.664 Vali Acc: 0.856 Test Loss: 0.664 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0071384906768799
Epoch: 42, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.716 Vali Acc: 0.850 Test Loss: 0.716 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9539439678192139
Epoch: 43, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.784 Vali Acc: 0.833 Test Loss: 0.784 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9023318290710449
Epoch: 44, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.711 Vali Acc: 0.856 Test Loss: 0.711 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8738915920257568
Epoch: 45, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.710 Vali Acc: 0.878 Test Loss: 0.710 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.870715856552124
Epoch: 46, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.696 Vali Acc: 0.867 Test Loss: 0.696 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.8642022609710693
Epoch: 47, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.716 Vali Acc: 0.872 Test Loss: 0.716 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.7941617965698242
Epoch: 48, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.729 Vali Acc: 0.872 Test Loss: 0.729 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.935718297958374
Epoch: 49, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.727 Vali Acc: 0.872 Test Loss: 0.727 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.8939530849456787
Epoch: 50, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.777 Vali Acc: 0.850 Test Loss: 0.777 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 116911
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1149559020996094
Epoch: 1, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.671 Vali Acc: 0.122 Test Loss: 2.671 Test Acc: 0.122
Validation loss decreased (inf --> -0.122196).  Saving model ...
Epoch: 2 cost time: 0.855224609375
Epoch: 2, Steps: 12 | Train Loss: 2.678 Vali Loss: 2.617 Vali Acc: 0.139 Test Loss: 2.617 Test Acc: 0.139
Validation loss decreased (-0.122196 --> -0.138863).  Saving model ...
Epoch: 3 cost time: 0.8022618293762207
Epoch: 3, Steps: 12 | Train Loss: 2.576 Vali Loss: 2.528 Vali Acc: 0.200 Test Loss: 2.528 Test Acc: 0.200
Validation loss decreased (-0.138863 --> -0.199975).  Saving model ...
Epoch: 4 cost time: 0.8486061096191406
Epoch: 4, Steps: 12 | Train Loss: 2.435 Vali Loss: 2.412 Vali Acc: 0.311 Test Loss: 2.412 Test Acc: 0.311
Validation loss decreased (-0.199975 --> -0.311087).  Saving model ...
Epoch: 5 cost time: 0.8153777122497559
Epoch: 5, Steps: 12 | Train Loss: 2.293 Vali Loss: 2.274 Vali Acc: 0.394 Test Loss: 2.274 Test Acc: 0.394
Validation loss decreased (-0.311087 --> -0.394422).  Saving model ...
Epoch: 6 cost time: 0.9114847183227539
Epoch: 6, Steps: 12 | Train Loss: 2.137 Vali Loss: 2.110 Vali Acc: 0.467 Test Loss: 2.110 Test Acc: 0.467
Validation loss decreased (-0.394422 --> -0.466646).  Saving model ...
Epoch: 7 cost time: 0.8456411361694336
Epoch: 7, Steps: 12 | Train Loss: 1.919 Vali Loss: 1.953 Vali Acc: 0.528 Test Loss: 1.953 Test Acc: 0.528
Validation loss decreased (-0.466646 --> -0.527758).  Saving model ...
Epoch: 8 cost time: 0.8335051536560059
Epoch: 8, Steps: 12 | Train Loss: 1.764 Vali Loss: 1.768 Vali Acc: 0.567 Test Loss: 1.768 Test Acc: 0.567
Validation loss decreased (-0.527758 --> -0.566649).  Saving model ...
Epoch: 9 cost time: 0.9137279987335205
Epoch: 9, Steps: 12 | Train Loss: 1.542 Vali Loss: 1.607 Vali Acc: 0.594 Test Loss: 1.607 Test Acc: 0.594
Validation loss decreased (-0.566649 --> -0.594428).  Saving model ...
Epoch: 10 cost time: 0.824582576751709
Epoch: 10, Steps: 12 | Train Loss: 1.350 Vali Loss: 1.467 Vali Acc: 0.606 Test Loss: 1.467 Test Acc: 0.606
Validation loss decreased (-0.594428 --> -0.605541).  Saving model ...
Epoch: 11 cost time: 0.8535099029541016
Epoch: 11, Steps: 12 | Train Loss: 1.231 Vali Loss: 1.338 Vali Acc: 0.633 Test Loss: 1.338 Test Acc: 0.633
Validation loss decreased (-0.605541 --> -0.633320).  Saving model ...
Epoch: 12 cost time: 0.8707852363586426
Epoch: 12, Steps: 12 | Train Loss: 1.018 Vali Loss: 1.226 Vali Acc: 0.661 Test Loss: 1.226 Test Acc: 0.661
Validation loss decreased (-0.633320 --> -0.661099).  Saving model ...
Epoch: 13 cost time: 0.8321828842163086
Epoch: 13, Steps: 12 | Train Loss: 0.878 Vali Loss: 1.142 Vali Acc: 0.689 Test Loss: 1.142 Test Acc: 0.689
Validation loss decreased (-0.661099 --> -0.688877).  Saving model ...
Epoch: 14 cost time: 0.8840134143829346
Epoch: 14, Steps: 12 | Train Loss: 0.789 Vali Loss: 1.069 Vali Acc: 0.711 Test Loss: 1.069 Test Acc: 0.711
Validation loss decreased (-0.688877 --> -0.711100).  Saving model ...
Epoch: 15 cost time: 0.8902313709259033
Epoch: 15, Steps: 12 | Train Loss: 0.811 Vali Loss: 1.008 Vali Acc: 0.717 Test Loss: 1.008 Test Acc: 0.717
Validation loss decreased (-0.711100 --> -0.716657).  Saving model ...
Epoch: 16 cost time: 0.8429596424102783
Epoch: 16, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.949 Vali Acc: 0.717 Test Loss: 0.949 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716657).  Saving model ...
Epoch: 17 cost time: 0.861243724822998
Epoch: 17, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.913 Vali Acc: 0.717 Test Loss: 0.913 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716658).  Saving model ...
Epoch: 18 cost time: 0.8253936767578125
Epoch: 18, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.859 Vali Acc: 0.739 Test Loss: 0.859 Test Acc: 0.739
Validation loss decreased (-0.716658 --> -0.738880).  Saving model ...
Epoch: 19 cost time: 0.8065094947814941
Epoch: 19, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.828 Vali Acc: 0.744 Test Loss: 0.828 Test Acc: 0.744
Validation loss decreased (-0.738880 --> -0.744436).  Saving model ...
Epoch: 20 cost time: 0.8980207443237305
Epoch: 20, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.826 Vali Acc: 0.772 Test Loss: 0.826 Test Acc: 0.772
Validation loss decreased (-0.744436 --> -0.772214).  Saving model ...
Epoch: 21 cost time: 0.8188977241516113
Epoch: 21, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.779 Vali Acc: 0.778 Test Loss: 0.779 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777770).  Saving model ...
Epoch: 22 cost time: 0.8748276233673096
Epoch: 22, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.762 Vali Acc: 0.789 Test Loss: 0.762 Test Acc: 0.789
Validation loss decreased (-0.777770 --> -0.788881).  Saving model ...
Epoch: 23 cost time: 0.8944895267486572
Epoch: 23, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.726 Vali Acc: 0.822 Test Loss: 0.726 Test Acc: 0.822
Validation loss decreased (-0.788881 --> -0.822215).  Saving model ...
Epoch: 24 cost time: 0.7895650863647461
Epoch: 24, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.699 Vali Acc: 0.828 Test Loss: 0.699 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 25 cost time: 0.86234450340271
Epoch: 25, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.703 Vali Acc: 0.828 Test Loss: 0.703 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.929262638092041
Epoch: 26, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.680 Vali Acc: 0.822 Test Loss: 0.680 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9073448181152344
Epoch: 27, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.668 Vali Acc: 0.839 Test Loss: 0.668 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 28 cost time: 1.0008389949798584
Epoch: 28, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.641 Vali Acc: 0.850 Test Loss: 0.641 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 29 cost time: 0.8494734764099121
Epoch: 29, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.657 Vali Acc: 0.856 Test Loss: 0.657 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 30 cost time: 0.8713843822479248
Epoch: 30, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.666 Vali Acc: 0.856 Test Loss: 0.666 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8772499561309814
Epoch: 31, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.672 Vali Acc: 0.856 Test Loss: 0.672 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8195805549621582
Epoch: 32, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.676 Vali Acc: 0.856 Test Loss: 0.676 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8583688735961914
Epoch: 33, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.677 Vali Acc: 0.867 Test Loss: 0.677 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866660).  Saving model ...
Epoch: 34 cost time: 0.8254008293151855
Epoch: 34, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.663 Vali Acc: 0.867 Test Loss: 0.663 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866660).  Saving model ...
Epoch: 35 cost time: 0.864619255065918
Epoch: 35, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.662 Vali Acc: 0.856 Test Loss: 0.662 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.942619800567627
Epoch: 36, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.669 Vali Acc: 0.861 Test Loss: 0.669 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9040400981903076
Epoch: 37, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.679 Vali Acc: 0.856 Test Loss: 0.679 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.829409122467041
Epoch: 38, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.685 Vali Acc: 0.856 Test Loss: 0.685 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.842803955078125
Epoch: 39, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.694 Vali Acc: 0.850 Test Loss: 0.694 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.766993522644043
Epoch: 40, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.691 Vali Acc: 0.867 Test Loss: 0.691 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.810321569442749
Epoch: 41, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.690 Vali Acc: 0.861 Test Loss: 0.690 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.9135844707489014
Epoch: 42, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.697 Vali Acc: 0.872 Test Loss: 0.697 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872215).  Saving model ...
Epoch: 43 cost time: 0.8042294979095459
Epoch: 43, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.701 Vali Acc: 0.883 Test Loss: 0.701 Test Acc: 0.883
Validation loss decreased (-0.872215 --> -0.883326).  Saving model ...
Epoch: 44 cost time: 0.8119349479675293
Epoch: 44, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.715 Vali Acc: 0.850 Test Loss: 0.715 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.867825984954834
Epoch: 45, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.748 Vali Acc: 0.861 Test Loss: 0.748 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8662419319152832
Epoch: 46, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.739 Vali Acc: 0.872 Test Loss: 0.739 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.8971195220947266
Epoch: 47, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.738 Vali Acc: 0.867 Test Loss: 0.738 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.873410701751709
Epoch: 48, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.719 Vali Acc: 0.872 Test Loss: 0.719 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.9151413440704346
Epoch: 49, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.707 Vali Acc: 0.867 Test Loss: 0.707 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.8841814994812012
Epoch: 50, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.725 Vali Acc: 0.878 Test Loss: 0.725 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 111183
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3009135723114014
Epoch: 1, Steps: 12 | Train Loss: 2.728 Vali Loss: 2.704 Vali Acc: 0.117 Test Loss: 2.704 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 0.810837984085083
Epoch: 2, Steps: 12 | Train Loss: 2.698 Vali Loss: 2.669 Vali Acc: 0.172 Test Loss: 2.669 Test Acc: 0.172
Validation loss decreased (-0.116640 --> -0.172196).  Saving model ...
Epoch: 3 cost time: 0.8490567207336426
Epoch: 3, Steps: 12 | Train Loss: 2.617 Vali Loss: 2.604 Vali Acc: 0.222 Test Loss: 2.604 Test Acc: 0.222
Validation loss decreased (-0.172196 --> -0.222196).  Saving model ...
Epoch: 4 cost time: 0.882197380065918
Epoch: 4, Steps: 12 | Train Loss: 2.515 Vali Loss: 2.514 Vali Acc: 0.300 Test Loss: 2.514 Test Acc: 0.300
Validation loss decreased (-0.222196 --> -0.299975).  Saving model ...
Epoch: 5 cost time: 0.833587646484375
Epoch: 5, Steps: 12 | Train Loss: 2.408 Vali Loss: 2.400 Vali Acc: 0.333 Test Loss: 2.400 Test Acc: 0.333
Validation loss decreased (-0.299975 --> -0.333309).  Saving model ...
Epoch: 6 cost time: 0.8072247505187988
Epoch: 6, Steps: 12 | Train Loss: 2.263 Vali Loss: 2.271 Vali Acc: 0.450 Test Loss: 2.271 Test Acc: 0.450
Validation loss decreased (-0.333309 --> -0.449977).  Saving model ...
Epoch: 7 cost time: 0.8293421268463135
Epoch: 7, Steps: 12 | Train Loss: 2.088 Vali Loss: 2.122 Vali Acc: 0.494 Test Loss: 2.122 Test Acc: 0.494
Validation loss decreased (-0.449977 --> -0.494423).  Saving model ...
Epoch: 8 cost time: 0.8358983993530273
Epoch: 8, Steps: 12 | Train Loss: 1.887 Vali Loss: 1.951 Vali Acc: 0.544 Test Loss: 1.951 Test Acc: 0.544
Validation loss decreased (-0.494423 --> -0.544425).  Saving model ...
Epoch: 9 cost time: 0.8381049633026123
Epoch: 9, Steps: 12 | Train Loss: 1.703 Vali Loss: 1.782 Vali Acc: 0.589 Test Loss: 1.782 Test Acc: 0.589
Validation loss decreased (-0.544425 --> -0.588871).  Saving model ...
Epoch: 10 cost time: 0.8257074356079102
Epoch: 10, Steps: 12 | Train Loss: 1.510 Vali Loss: 1.613 Vali Acc: 0.594 Test Loss: 1.613 Test Acc: 0.594
Validation loss decreased (-0.588871 --> -0.594428).  Saving model ...
Epoch: 11 cost time: 0.8425579071044922
Epoch: 11, Steps: 12 | Train Loss: 1.355 Vali Loss: 1.470 Vali Acc: 0.639 Test Loss: 1.470 Test Acc: 0.639
Validation loss decreased (-0.594428 --> -0.638874).  Saving model ...
Epoch: 12 cost time: 0.7671620845794678
Epoch: 12, Steps: 12 | Train Loss: 1.143 Vali Loss: 1.339 Vali Acc: 0.628 Test Loss: 1.339 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7231013774871826
Epoch: 13, Steps: 12 | Train Loss: 1.045 Vali Loss: 1.232 Vali Acc: 0.639 Test Loss: 1.232 Test Acc: 0.639
Validation loss decreased (-0.638874 --> -0.638877).  Saving model ...
Epoch: 14 cost time: 0.8239202499389648
Epoch: 14, Steps: 12 | Train Loss: 0.959 Vali Loss: 1.136 Vali Acc: 0.667 Test Loss: 1.136 Test Acc: 0.667
Validation loss decreased (-0.638877 --> -0.666655).  Saving model ...
Epoch: 15 cost time: 0.7937109470367432
Epoch: 15, Steps: 12 | Train Loss: 0.816 Vali Loss: 1.054 Vali Acc: 0.667 Test Loss: 1.054 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666656).  Saving model ...
Epoch: 16 cost time: 0.8287394046783447
Epoch: 16, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.992 Vali Acc: 0.689 Test Loss: 0.992 Test Acc: 0.689
Validation loss decreased (-0.666656 --> -0.688879).  Saving model ...
Epoch: 17 cost time: 0.8468952178955078
Epoch: 17, Steps: 12 | Train Loss: 0.734 Vali Loss: 0.938 Vali Acc: 0.722 Test Loss: 0.938 Test Acc: 0.722
Validation loss decreased (-0.688879 --> -0.722213).  Saving model ...
Epoch: 18 cost time: 0.8449561595916748
Epoch: 18, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.889 Vali Acc: 0.733 Test Loss: 0.889 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 19 cost time: 0.8187532424926758
Epoch: 19, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.850 Vali Acc: 0.739 Test Loss: 0.850 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738880).  Saving model ...
Epoch: 20 cost time: 0.7890636920928955
Epoch: 20, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.809 Vali Acc: 0.744 Test Loss: 0.809 Test Acc: 0.744
Validation loss decreased (-0.738880 --> -0.744436).  Saving model ...
Epoch: 21 cost time: 0.8166666030883789
Epoch: 21, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.759 Vali Acc: 0.778 Test Loss: 0.759 Test Acc: 0.778
Validation loss decreased (-0.744436 --> -0.777770).  Saving model ...
Epoch: 22 cost time: 0.8498594760894775
Epoch: 22, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.722 Vali Acc: 0.789 Test Loss: 0.722 Test Acc: 0.789
Validation loss decreased (-0.777770 --> -0.788882).  Saving model ...
Epoch: 23 cost time: 0.9037034511566162
Epoch: 23, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.686 Vali Acc: 0.800 Test Loss: 0.686 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 24 cost time: 0.9291086196899414
Epoch: 24, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.684 Vali Acc: 0.811 Test Loss: 0.684 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 25 cost time: 0.8489348888397217
Epoch: 25, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.660 Vali Acc: 0.811 Test Loss: 0.660 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811105).  Saving model ...
Epoch: 26 cost time: 0.806429386138916
Epoch: 26, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.642 Vali Acc: 0.828 Test Loss: 0.642 Test Acc: 0.828
Validation loss decreased (-0.811105 --> -0.827771).  Saving model ...
Epoch: 27 cost time: 0.8550601005554199
Epoch: 27, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.631 Vali Acc: 0.839 Test Loss: 0.631 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838883).  Saving model ...
Epoch: 28 cost time: 0.8336770534515381
Epoch: 28, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.603 Vali Acc: 0.839 Test Loss: 0.603 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 29 cost time: 0.9689369201660156
Epoch: 29, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 30 cost time: 0.8613028526306152
Epoch: 30, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.580 Vali Acc: 0.839 Test Loss: 0.580 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.882249116897583
Epoch: 31, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.591 Vali Acc: 0.828 Test Loss: 0.591 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9145619869232178
Epoch: 32, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.606 Vali Acc: 0.850 Test Loss: 0.606 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.861722469329834
Epoch: 33, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.586 Vali Acc: 0.839 Test Loss: 0.586 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.866196870803833
Epoch: 34, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.581 Vali Acc: 0.856 Test Loss: 0.581 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 35 cost time: 0.8097455501556396
Epoch: 35, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.573 Vali Acc: 0.872 Test Loss: 0.573 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872216).  Saving model ...
Epoch: 36 cost time: 0.8049590587615967
Epoch: 36, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.587 Vali Acc: 0.861 Test Loss: 0.587 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.920590877532959
Epoch: 37, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9577474594116211
Epoch: 38, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.587 Vali Acc: 0.861 Test Loss: 0.587 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.842458963394165
Epoch: 39, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.619 Vali Acc: 0.867 Test Loss: 0.619 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9098649024963379
Epoch: 40, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9002223014831543
Epoch: 41, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.588 Vali Acc: 0.872 Test Loss: 0.588 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.864814281463623
Epoch: 42, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.570 Vali Acc: 0.883 Test Loss: 0.570 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883328).  Saving model ...
Epoch: 43 cost time: 0.962101936340332
Epoch: 43, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.598 Vali Acc: 0.889 Test Loss: 0.598 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 44 cost time: 0.8684632778167725
Epoch: 44, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.615 Vali Acc: 0.856 Test Loss: 0.615 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9146173000335693
Epoch: 45, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.588 Vali Acc: 0.867 Test Loss: 0.588 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8457913398742676
Epoch: 46, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.615 Vali Acc: 0.883 Test Loss: 0.615 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.8187224864959717
Epoch: 47, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.609 Vali Acc: 0.867 Test Loss: 0.609 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.834313154220581
Epoch: 48, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.587 Vali Acc: 0.872 Test Loss: 0.587 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.828521728515625
Epoch: 49, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.605 Vali Acc: 0.878 Test Loss: 0.605 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.8032827377319336
Epoch: 50, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.638 Vali Acc: 0.878 Test Loss: 0.638 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 107407
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2538373470306396
Epoch: 1, Steps: 12 | Train Loss: 2.746 Vali Loss: 2.722 Vali Acc: 0.128 Test Loss: 2.722 Test Acc: 0.128
Validation loss decreased (inf --> -0.127751).  Saving model ...
Epoch: 2 cost time: 0.944084882736206
Epoch: 2, Steps: 12 | Train Loss: 2.702 Vali Loss: 2.683 Vali Acc: 0.122 Test Loss: 2.683 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8437974452972412
Epoch: 3, Steps: 12 | Train Loss: 2.657 Vali Loss: 2.616 Vali Acc: 0.167 Test Loss: 2.616 Test Acc: 0.167
Validation loss decreased (-0.127751 --> -0.166641).  Saving model ...
Epoch: 4 cost time: 0.792107105255127
Epoch: 4, Steps: 12 | Train Loss: 2.574 Vali Loss: 2.531 Vali Acc: 0.206 Test Loss: 2.531 Test Acc: 0.206
Validation loss decreased (-0.166641 --> -0.205530).  Saving model ...
Epoch: 5 cost time: 0.8082091808319092
Epoch: 5, Steps: 12 | Train Loss: 2.440 Vali Loss: 2.436 Vali Acc: 0.361 Test Loss: 2.436 Test Acc: 0.361
Validation loss decreased (-0.205530 --> -0.361087).  Saving model ...
Epoch: 6 cost time: 0.7973670959472656
Epoch: 6, Steps: 12 | Train Loss: 2.344 Vali Loss: 2.325 Vali Acc: 0.394 Test Loss: 2.325 Test Acc: 0.394
Validation loss decreased (-0.361087 --> -0.394421).  Saving model ...
Epoch: 7 cost time: 0.7987544536590576
Epoch: 7, Steps: 12 | Train Loss: 2.187 Vali Loss: 2.195 Vali Acc: 0.444 Test Loss: 2.195 Test Acc: 0.444
Validation loss decreased (-0.394421 --> -0.444422).  Saving model ...
Epoch: 8 cost time: 0.8267831802368164
Epoch: 8, Steps: 12 | Train Loss: 2.012 Vali Loss: 2.045 Vali Acc: 0.506 Test Loss: 2.045 Test Acc: 0.506
Validation loss decreased (-0.444422 --> -0.505535).  Saving model ...
Epoch: 9 cost time: 0.855069637298584
Epoch: 9, Steps: 12 | Train Loss: 1.859 Vali Loss: 1.871 Vali Acc: 0.544 Test Loss: 1.871 Test Acc: 0.544
Validation loss decreased (-0.505535 --> -0.544426).  Saving model ...
Epoch: 10 cost time: 0.8152565956115723
Epoch: 10, Steps: 12 | Train Loss: 1.702 Vali Loss: 1.707 Vali Acc: 0.589 Test Loss: 1.707 Test Acc: 0.589
Validation loss decreased (-0.544426 --> -0.588872).  Saving model ...
Epoch: 11 cost time: 1.0892858505249023
Epoch: 11, Steps: 12 | Train Loss: 1.440 Vali Loss: 1.565 Vali Acc: 0.633 Test Loss: 1.565 Test Acc: 0.633
Validation loss decreased (-0.588872 --> -0.633318).  Saving model ...
Epoch: 12 cost time: 0.9915785789489746
Epoch: 12, Steps: 12 | Train Loss: 1.302 Vali Loss: 1.407 Vali Acc: 0.650 Test Loss: 1.407 Test Acc: 0.650
Validation loss decreased (-0.633318 --> -0.649986).  Saving model ...
Epoch: 13 cost time: 0.8846971988677979
Epoch: 13, Steps: 12 | Train Loss: 1.171 Vali Loss: 1.281 Vali Acc: 0.711 Test Loss: 1.281 Test Acc: 0.711
Validation loss decreased (-0.649986 --> -0.711098).  Saving model ...
Epoch: 14 cost time: 0.845034122467041
Epoch: 14, Steps: 12 | Train Loss: 1.015 Vali Loss: 1.187 Vali Acc: 0.694 Test Loss: 1.187 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8533127307891846
Epoch: 15, Steps: 12 | Train Loss: 0.897 Vali Loss: 1.121 Vali Acc: 0.694 Test Loss: 1.121 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8142964839935303
Epoch: 16, Steps: 12 | Train Loss: 0.786 Vali Loss: 1.031 Vali Acc: 0.722 Test Loss: 1.031 Test Acc: 0.722
Validation loss decreased (-0.711098 --> -0.722212).  Saving model ...
Epoch: 17 cost time: 0.8954882621765137
Epoch: 17, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.954 Vali Acc: 0.744 Test Loss: 0.954 Test Acc: 0.744
Validation loss decreased (-0.722212 --> -0.744435).  Saving model ...
Epoch: 18 cost time: 0.8591337203979492
Epoch: 18, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.917 Vali Acc: 0.744 Test Loss: 0.917 Test Acc: 0.744
Validation loss decreased (-0.744435 --> -0.744435).  Saving model ...
Epoch: 19 cost time: 0.8130636215209961
Epoch: 19, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.877 Vali Acc: 0.750 Test Loss: 0.877 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749991).  Saving model ...
Epoch: 20 cost time: 0.7890582084655762
Epoch: 20, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.827 Vali Acc: 0.772 Test Loss: 0.827 Test Acc: 0.772
Validation loss decreased (-0.749991 --> -0.772214).  Saving model ...
Epoch: 21 cost time: 0.891685962677002
Epoch: 21, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.788 Vali Acc: 0.761 Test Loss: 0.788 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9087367057800293
Epoch: 22, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.764 Vali Acc: 0.778 Test Loss: 0.764 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777770).  Saving model ...
Epoch: 23 cost time: 0.8992259502410889
Epoch: 23, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.725 Vali Acc: 0.789 Test Loss: 0.725 Test Acc: 0.789
Validation loss decreased (-0.777770 --> -0.788882).  Saving model ...
Epoch: 24 cost time: 0.8803491592407227
Epoch: 24, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.696 Vali Acc: 0.789 Test Loss: 0.696 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 25 cost time: 0.8864891529083252
Epoch: 25, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.689 Vali Acc: 0.806 Test Loss: 0.689 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805549).  Saving model ...
Epoch: 26 cost time: 0.8488898277282715
Epoch: 26, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.674 Vali Acc: 0.828 Test Loss: 0.674 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827771).  Saving model ...
Epoch: 27 cost time: 0.8414490222930908
Epoch: 27, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.652 Vali Acc: 0.839 Test Loss: 0.652 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 28 cost time: 0.8569703102111816
Epoch: 28, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.651 Vali Acc: 0.833 Test Loss: 0.651 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8047542572021484
Epoch: 29, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.632 Vali Acc: 0.839 Test Loss: 0.632 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 30 cost time: 0.8812742233276367
Epoch: 30, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.634 Vali Acc: 0.828 Test Loss: 0.634 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8713130950927734
Epoch: 31, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.619 Vali Acc: 0.822 Test Loss: 0.619 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8477365970611572
Epoch: 32, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.600 Vali Acc: 0.850 Test Loss: 0.600 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 33 cost time: 0.8630497455596924
Epoch: 33, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.596 Vali Acc: 0.856 Test Loss: 0.596 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 34 cost time: 0.8667161464691162
Epoch: 34, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.597 Vali Acc: 0.872 Test Loss: 0.597 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872216).  Saving model ...
Epoch: 35 cost time: 0.7854070663452148
Epoch: 35, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8289539813995361
Epoch: 36, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9743497371673584
Epoch: 37, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.603 Vali Acc: 0.872 Test Loss: 0.603 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7994050979614258
Epoch: 38, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.610 Vali Acc: 0.861 Test Loss: 0.610 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9226312637329102
Epoch: 39, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.611 Vali Acc: 0.856 Test Loss: 0.611 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8723223209381104
Epoch: 40, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.624 Vali Acc: 0.844 Test Loss: 0.624 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8527956008911133
Epoch: 41, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.637 Vali Acc: 0.850 Test Loss: 0.637 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8342030048370361
Epoch: 42, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.635 Vali Acc: 0.867 Test Loss: 0.635 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.9606976509094238
Epoch: 43, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.626 Vali Acc: 0.867 Test Loss: 0.626 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.8517696857452393
Epoch: 44, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.634 Vali Acc: 0.872 Test Loss: 0.634 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 105551
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1006219387054443
Epoch: 1, Steps: 12 | Train Loss: 2.736 Vali Loss: 2.710 Vali Acc: 0.056 Test Loss: 2.710 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 0.902677059173584
Epoch: 2, Steps: 12 | Train Loss: 2.699 Vali Loss: 2.676 Vali Acc: 0.111 Test Loss: 2.676 Test Acc: 0.111
Validation loss decreased (-0.055528 --> -0.111084).  Saving model ...
Epoch: 3 cost time: 0.9139440059661865
Epoch: 3, Steps: 12 | Train Loss: 2.647 Vali Loss: 2.616 Vali Acc: 0.178 Test Loss: 2.616 Test Acc: 0.178
Validation loss decreased (-0.111084 --> -0.177752).  Saving model ...
Epoch: 4 cost time: 0.819359302520752
Epoch: 4, Steps: 12 | Train Loss: 2.558 Vali Loss: 2.536 Vali Acc: 0.261 Test Loss: 2.536 Test Acc: 0.261
Validation loss decreased (-0.177752 --> -0.261086).  Saving model ...
Epoch: 5 cost time: 0.8090965747833252
Epoch: 5, Steps: 12 | Train Loss: 2.461 Vali Loss: 2.448 Vali Acc: 0.361 Test Loss: 2.448 Test Acc: 0.361
Validation loss decreased (-0.261086 --> -0.361087).  Saving model ...
Epoch: 6 cost time: 0.7613937854766846
Epoch: 6, Steps: 12 | Train Loss: 2.363 Vali Loss: 2.347 Vali Acc: 0.450 Test Loss: 2.347 Test Acc: 0.450
Validation loss decreased (-0.361087 --> -0.449977).  Saving model ...
Epoch: 7 cost time: 0.7819194793701172
Epoch: 7, Steps: 12 | Train Loss: 2.262 Vali Loss: 2.234 Vali Acc: 0.467 Test Loss: 2.234 Test Acc: 0.467
Validation loss decreased (-0.449977 --> -0.466644).  Saving model ...
Epoch: 8 cost time: 0.8074836730957031
Epoch: 8, Steps: 12 | Train Loss: 2.096 Vali Loss: 2.099 Vali Acc: 0.494 Test Loss: 2.099 Test Acc: 0.494
Validation loss decreased (-0.466644 --> -0.494423).  Saving model ...
Epoch: 9 cost time: 0.7845418453216553
Epoch: 9, Steps: 12 | Train Loss: 1.937 Vali Loss: 1.963 Vali Acc: 0.522 Test Loss: 1.963 Test Acc: 0.522
Validation loss decreased (-0.494423 --> -0.522203).  Saving model ...
Epoch: 10 cost time: 0.7947080135345459
Epoch: 10, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.798 Vali Acc: 0.567 Test Loss: 1.798 Test Acc: 0.567
Validation loss decreased (-0.522203 --> -0.566649).  Saving model ...
Epoch: 11 cost time: 0.681342601776123
Epoch: 11, Steps: 12 | Train Loss: 1.602 Vali Loss: 1.649 Vali Acc: 0.600 Test Loss: 1.649 Test Acc: 0.600
Validation loss decreased (-0.566649 --> -0.599984).  Saving model ...
Epoch: 12 cost time: 0.8025918006896973
Epoch: 12, Steps: 12 | Train Loss: 1.418 Vali Loss: 1.486 Vali Acc: 0.633 Test Loss: 1.486 Test Acc: 0.633
Validation loss decreased (-0.599984 --> -0.633318).  Saving model ...
Epoch: 13 cost time: 0.8618409633636475
Epoch: 13, Steps: 12 | Train Loss: 1.252 Vali Loss: 1.369 Vali Acc: 0.656 Test Loss: 1.369 Test Acc: 0.656
Validation loss decreased (-0.633318 --> -0.655542).  Saving model ...
Epoch: 14 cost time: 0.8893473148345947
Epoch: 14, Steps: 12 | Train Loss: 1.091 Vali Loss: 1.252 Vali Acc: 0.678 Test Loss: 1.252 Test Acc: 0.678
Validation loss decreased (-0.655542 --> -0.677765).  Saving model ...
Epoch: 15 cost time: 0.907785177230835
Epoch: 15, Steps: 12 | Train Loss: 1.020 Vali Loss: 1.126 Vali Acc: 0.689 Test Loss: 1.126 Test Acc: 0.689
Validation loss decreased (-0.677765 --> -0.688878).  Saving model ...
Epoch: 16 cost time: 0.8721954822540283
Epoch: 16, Steps: 12 | Train Loss: 0.919 Vali Loss: 1.048 Vali Acc: 0.706 Test Loss: 1.048 Test Acc: 0.706
Validation loss decreased (-0.688878 --> -0.705545).  Saving model ...
Epoch: 17 cost time: 0.7929031848907471
Epoch: 17, Steps: 12 | Train Loss: 0.779 Vali Loss: 0.979 Vali Acc: 0.717 Test Loss: 0.979 Test Acc: 0.717
Validation loss decreased (-0.705545 --> -0.716657).  Saving model ...
Epoch: 18 cost time: 0.8386189937591553
Epoch: 18, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.919 Vali Acc: 0.733 Test Loss: 0.919 Test Acc: 0.733
Validation loss decreased (-0.716657 --> -0.733324).  Saving model ...
Epoch: 19 cost time: 0.8361661434173584
Epoch: 19, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.869 Vali Acc: 0.756 Test Loss: 0.869 Test Acc: 0.756
Validation loss decreased (-0.733324 --> -0.755547).  Saving model ...
Epoch: 20 cost time: 0.812664270401001
Epoch: 20, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.827 Vali Acc: 0.750 Test Loss: 0.827 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8855745792388916
Epoch: 21, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.775 Vali Acc: 0.750 Test Loss: 0.775 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8233344554901123
Epoch: 22, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.745 Vali Acc: 0.778 Test Loss: 0.745 Test Acc: 0.778
Validation loss decreased (-0.755547 --> -0.777770).  Saving model ...
Epoch: 23 cost time: 0.7850253582000732
Epoch: 23, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.722 Vali Acc: 0.789 Test Loss: 0.722 Test Acc: 0.789
Validation loss decreased (-0.777770 --> -0.788882).  Saving model ...
Epoch: 24 cost time: 0.8731586933135986
Epoch: 24, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.679 Vali Acc: 0.800 Test Loss: 0.679 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 25 cost time: 0.882570743560791
Epoch: 25, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.655 Vali Acc: 0.800 Test Loss: 0.655 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 26 cost time: 0.8801066875457764
Epoch: 26, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.632 Vali Acc: 0.817 Test Loss: 0.632 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816660).  Saving model ...
Epoch: 27 cost time: 0.9228363037109375
Epoch: 27, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.610 Vali Acc: 0.822 Test Loss: 0.610 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 28 cost time: 0.9391086101531982
Epoch: 28, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.597 Vali Acc: 0.833 Test Loss: 0.597 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 29 cost time: 0.860126256942749
Epoch: 29, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.586 Vali Acc: 0.839 Test Loss: 0.586 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 30 cost time: 0.8455736637115479
Epoch: 30, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.572 Vali Acc: 0.850 Test Loss: 0.572 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 31 cost time: 0.8352065086364746
Epoch: 31, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.565 Vali Acc: 0.839 Test Loss: 0.565 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.781696081161499
Epoch: 32, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 33 cost time: 0.8140685558319092
Epoch: 33, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.541 Vali Acc: 0.856 Test Loss: 0.541 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 34 cost time: 0.8122072219848633
Epoch: 34, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.542 Vali Acc: 0.839 Test Loss: 0.542 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7779839038848877
Epoch: 35, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8100707530975342
Epoch: 36, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.503 Vali Acc: 0.867 Test Loss: 0.503 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866662).  Saving model ...
Epoch: 37 cost time: 0.7727537155151367
Epoch: 37, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.515 Vali Acc: 0.867 Test Loss: 0.515 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8495292663574219
Epoch: 38, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.509 Vali Acc: 0.861 Test Loss: 0.509 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8765275478363037
Epoch: 39, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8644182682037354
Epoch: 40, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.540 Vali Acc: 0.861 Test Loss: 0.540 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8625509738922119
Epoch: 41, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.521 Vali Acc: 0.872 Test Loss: 0.521 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 42 cost time: 0.874967098236084
Epoch: 42, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.514 Vali Acc: 0.861 Test Loss: 0.514 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8444247245788574
Epoch: 43, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.515 Vali Acc: 0.878 Test Loss: 0.515 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 44 cost time: 0.8404226303100586
Epoch: 44, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.515 Vali Acc: 0.883 Test Loss: 0.515 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 45 cost time: 0.9114174842834473
Epoch: 45, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.577 Vali Acc: 0.867 Test Loss: 0.577 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8655040264129639
Epoch: 46, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.568 Vali Acc: 0.856 Test Loss: 0.568 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.857067346572876
Epoch: 47, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8753552436828613
Epoch: 48, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8000972270965576
Epoch: 49, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.568 Vali Acc: 0.872 Test Loss: 0.568 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.8597269058227539
Epoch: 50, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.578 Vali Acc: 0.878 Test Loss: 0.578 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 103727
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4732236862182617
Epoch: 1, Steps: 12 | Train Loss: 2.703 Vali Loss: 2.573 Vali Acc: 0.300 Test Loss: 2.573 Test Acc: 0.300
Validation loss decreased (inf --> -0.299974).  Saving model ...
Epoch: 2 cost time: 1.3547742366790771
Epoch: 2, Steps: 12 | Train Loss: 2.186 Vali Loss: 2.081 Vali Acc: 0.494 Test Loss: 2.081 Test Acc: 0.494
Validation loss decreased (-0.299974 --> -0.494424).  Saving model ...
Epoch: 3 cost time: 1.2421178817749023
Epoch: 3, Steps: 12 | Train Loss: 1.507 Vali Loss: 1.465 Vali Acc: 0.633 Test Loss: 1.465 Test Acc: 0.633
Validation loss decreased (-0.494424 --> -0.633319).  Saving model ...
Epoch: 4 cost time: 1.2529070377349854
Epoch: 4, Steps: 12 | Train Loss: 1.066 Vali Loss: 1.159 Vali Acc: 0.639 Test Loss: 1.159 Test Acc: 0.639
Validation loss decreased (-0.633319 --> -0.638877).  Saving model ...
Epoch: 5 cost time: 1.3422174453735352
Epoch: 5, Steps: 12 | Train Loss: 0.754 Vali Loss: 0.979 Vali Acc: 0.694 Test Loss: 0.979 Test Acc: 0.694
Validation loss decreased (-0.638877 --> -0.694435).  Saving model ...
Epoch: 6 cost time: 1.3428504467010498
Epoch: 6, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.879 Vali Acc: 0.722 Test Loss: 0.879 Test Acc: 0.722
Validation loss decreased (-0.694435 --> -0.722213).  Saving model ...
Epoch: 7 cost time: 1.3379309177398682
Epoch: 7, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.848 Vali Acc: 0.772 Test Loss: 0.848 Test Acc: 0.772
Validation loss decreased (-0.722213 --> -0.772214).  Saving model ...
Epoch: 8 cost time: 1.3783657550811768
Epoch: 8, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.861 Vali Acc: 0.761 Test Loss: 0.861 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3976702690124512
Epoch: 9, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.792 Vali Acc: 0.800 Test Loss: 0.792 Test Acc: 0.800
Validation loss decreased (-0.772214 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 1.3167612552642822
Epoch: 10, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.820 Vali Acc: 0.789 Test Loss: 0.820 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3105549812316895
Epoch: 11, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.900 Vali Acc: 0.778 Test Loss: 0.900 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2811815738677979
Epoch: 12, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.771 Vali Acc: 0.828 Test Loss: 0.771 Test Acc: 0.828
Validation loss decreased (-0.799992 --> -0.827770).  Saving model ...
Epoch: 13 cost time: 1.249016284942627
Epoch: 13, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.824 Vali Acc: 0.817 Test Loss: 0.824 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3058526515960693
Epoch: 14, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.775 Vali Acc: 0.839 Test Loss: 0.775 Test Acc: 0.839
Validation loss decreased (-0.827770 --> -0.838881).  Saving model ...
Epoch: 15 cost time: 1.3110201358795166
Epoch: 15, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.844 Vali Acc: 0.856 Test Loss: 0.844 Test Acc: 0.856
Validation loss decreased (-0.838881 --> -0.855547).  Saving model ...
Epoch: 16 cost time: 1.3371520042419434
Epoch: 16, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.835 Vali Acc: 0.822 Test Loss: 0.835 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3956027030944824
Epoch: 17, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.868 Vali Acc: 0.861 Test Loss: 0.868 Test Acc: 0.861
Validation loss decreased (-0.855547 --> -0.861102).  Saving model ...
Epoch: 18 cost time: 1.3516945838928223
Epoch: 18, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.858 Vali Acc: 0.828 Test Loss: 0.858 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3478682041168213
Epoch: 19, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.993 Vali Acc: 0.817 Test Loss: 0.993 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1627402305603027
Epoch: 20, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.086 Vali Acc: 0.833 Test Loss: 1.086 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2493021488189697
Epoch: 21, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.178 Vali Acc: 0.850 Test Loss: 1.178 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9878625869750977
Epoch: 22, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.138 Vali Acc: 0.844 Test Loss: 1.138 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.227102518081665
Epoch: 23, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.204 Vali Acc: 0.850 Test Loss: 1.204 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2247610092163086
Epoch: 24, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.126 Vali Acc: 0.867 Test Loss: 1.126 Test Acc: 0.867
Validation loss decreased (-0.861102 --> -0.866655).  Saving model ...
Epoch: 25 cost time: 1.4369587898254395
Epoch: 25, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.050 Vali Acc: 0.878 Test Loss: 1.050 Test Acc: 0.878
Validation loss decreased (-0.866655 --> -0.877767).  Saving model ...
Epoch: 26 cost time: 1.4974391460418701
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.004 Vali Acc: 0.878 Test Loss: 1.004 Test Acc: 0.878
Validation loss decreased (-0.877767 --> -0.877768).  Saving model ...
Epoch: 27 cost time: 1.3595514297485352
Epoch: 27, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.028 Vali Acc: 0.872 Test Loss: 1.028 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.310182809829712
Epoch: 28, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.052 Vali Acc: 0.878 Test Loss: 1.052 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2263717651367188
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.979 Vali Acc: 0.878 Test Loss: 0.979 Test Acc: 0.878
Validation loss decreased (-0.877768 --> -0.877768).  Saving model ...
Epoch: 30 cost time: 1.1831061840057373
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.970 Vali Acc: 0.872 Test Loss: 0.970 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.272566318511963
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.075 Vali Acc: 0.861 Test Loss: 1.075 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.280888319015503
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.030 Vali Acc: 0.861 Test Loss: 1.030 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2185089588165283
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.056 Vali Acc: 0.867 Test Loss: 1.056 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2123475074768066
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.087 Vali Acc: 0.867 Test Loss: 1.087 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.3242607116699219
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.126 Vali Acc: 0.872 Test Loss: 1.126 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2848308086395264
Epoch: 36, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.095 Vali Acc: 0.867 Test Loss: 1.095 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.3643527030944824
Epoch: 37, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.079 Vali Acc: 0.872 Test Loss: 1.079 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.327256441116333
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.132 Vali Acc: 0.861 Test Loss: 1.132 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.2123501300811768
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.209 Vali Acc: 0.878 Test Loss: 1.209 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 1588623
model size : 6.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.627244710922241
Epoch: 1, Steps: 12 | Train Loss: 2.737 Vali Loss: 2.656 Vali Acc: 0.111 Test Loss: 2.656 Test Acc: 0.111
Validation loss decreased (inf --> -0.111085).  Saving model ...
Epoch: 2 cost time: 1.262129783630371
Epoch: 2, Steps: 12 | Train Loss: 2.403 Vali Loss: 2.364 Vali Acc: 0.444 Test Loss: 2.364 Test Acc: 0.444
Validation loss decreased (-0.111085 --> -0.444421).  Saving model ...
Epoch: 3 cost time: 1.2815215587615967
Epoch: 3, Steps: 12 | Train Loss: 1.943 Vali Loss: 1.926 Vali Acc: 0.550 Test Loss: 1.926 Test Acc: 0.550
Validation loss decreased (-0.444421 --> -0.549981).  Saving model ...
Epoch: 4 cost time: 1.274155616760254
Epoch: 4, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.471 Vali Acc: 0.611 Test Loss: 1.471 Test Acc: 0.611
Validation loss decreased (-0.549981 --> -0.611096).  Saving model ...
Epoch: 5 cost time: 1.203056812286377
Epoch: 5, Steps: 12 | Train Loss: 1.048 Vali Loss: 1.181 Vali Acc: 0.678 Test Loss: 1.181 Test Acc: 0.678
Validation loss decreased (-0.611096 --> -0.677766).  Saving model ...
Epoch: 6 cost time: 1.2213780879974365
Epoch: 6, Steps: 12 | Train Loss: 0.790 Vali Loss: 1.034 Vali Acc: 0.672 Test Loss: 1.034 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2205164432525635
Epoch: 7, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.919 Vali Acc: 0.694 Test Loss: 0.919 Test Acc: 0.694
Validation loss decreased (-0.677766 --> -0.694435).  Saving model ...
Epoch: 8 cost time: 1.2056491374969482
Epoch: 8, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.857 Vali Acc: 0.717 Test Loss: 0.857 Test Acc: 0.717
Validation loss decreased (-0.694435 --> -0.716658).  Saving model ...
Epoch: 9 cost time: 1.1475441455841064
Epoch: 9, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.752 Vali Acc: 0.778 Test Loss: 0.752 Test Acc: 0.778
Validation loss decreased (-0.716658 --> -0.777770).  Saving model ...
Epoch: 10 cost time: 1.1587765216827393
Epoch: 10, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.689 Vali Acc: 0.817 Test Loss: 0.689 Test Acc: 0.817
Validation loss decreased (-0.777770 --> -0.816660).  Saving model ...
Epoch: 11 cost time: 1.1592533588409424
Epoch: 11, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.667 Vali Acc: 0.811 Test Loss: 0.667 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.217162847518921
Epoch: 12, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.623 Vali Acc: 0.856 Test Loss: 0.623 Test Acc: 0.856
Validation loss decreased (-0.816660 --> -0.855549).  Saving model ...
Epoch: 13 cost time: 1.1053993701934814
Epoch: 13, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.698 Vali Acc: 0.811 Test Loss: 0.698 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2699458599090576
Epoch: 14, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.629 Vali Acc: 0.850 Test Loss: 0.629 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1946396827697754
Epoch: 15, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.601 Vali Acc: 0.822 Test Loss: 0.601 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2020387649536133
Epoch: 16, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.731 Vali Acc: 0.861 Test Loss: 0.731 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861104).  Saving model ...
Epoch: 17 cost time: 1.3263585567474365
Epoch: 17, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.736 Vali Acc: 0.850 Test Loss: 0.736 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2444989681243896
Epoch: 18, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.676 Vali Acc: 0.861 Test Loss: 0.676 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861104).  Saving model ...
Epoch: 19 cost time: 1.232703447341919
Epoch: 19, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.730 Vali Acc: 0.856 Test Loss: 0.730 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2904715538024902
Epoch: 20, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.719 Vali Acc: 0.867 Test Loss: 0.719 Test Acc: 0.867
Validation loss decreased (-0.861104 --> -0.866659).  Saving model ...
Epoch: 21 cost time: 1.1652295589447021
Epoch: 21, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.733 Vali Acc: 0.850 Test Loss: 0.733 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2381541728973389
Epoch: 22, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.809 Vali Acc: 0.839 Test Loss: 0.809 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1634464263916016
Epoch: 23, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.761 Vali Acc: 0.867 Test Loss: 0.761 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2477843761444092
Epoch: 24, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.869 Vali Acc: 0.850 Test Loss: 0.869 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1167514324188232
Epoch: 25, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.828 Vali Acc: 0.872 Test Loss: 0.828 Test Acc: 0.872
Validation loss decreased (-0.866659 --> -0.872214).  Saving model ...
Epoch: 26 cost time: 1.1717205047607422
Epoch: 26, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.836 Vali Acc: 0.833 Test Loss: 0.836 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.167149305343628
Epoch: 27, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.907 Vali Acc: 0.856 Test Loss: 0.907 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2565927505493164
Epoch: 28, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.837 Vali Acc: 0.833 Test Loss: 0.837 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2409629821777344
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.933 Vali Acc: 0.867 Test Loss: 0.933 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3424501419067383
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.936 Vali Acc: 0.839 Test Loss: 0.936 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2370901107788086
Epoch: 31, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.927 Vali Acc: 0.839 Test Loss: 0.927 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2478976249694824
Epoch: 32, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.994 Vali Acc: 0.844 Test Loss: 0.994 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1844828128814697
Epoch: 33, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.870 Vali Acc: 0.850 Test Loss: 0.870 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.1866323947906494
Epoch: 34, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.918 Vali Acc: 0.850 Test Loss: 0.918 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.2289988994598389
Epoch: 35, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.021 Vali Acc: 0.806 Test Loss: 1.021 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 1496591
model size : 5.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7912094593048096
Epoch: 1, Steps: 12 | Train Loss: 2.679 Vali Loss: 2.577 Vali Acc: 0.283 Test Loss: 2.577 Test Acc: 0.283
Validation loss decreased (inf --> -0.283308).  Saving model ...
Epoch: 2 cost time: 1.302319049835205
Epoch: 2, Steps: 12 | Train Loss: 2.365 Vali Loss: 2.262 Vali Acc: 0.494 Test Loss: 2.262 Test Acc: 0.494
Validation loss decreased (-0.283308 --> -0.494422).  Saving model ...
Epoch: 3 cost time: 1.2591378688812256
Epoch: 3, Steps: 12 | Train Loss: 1.849 Vali Loss: 1.801 Vali Acc: 0.622 Test Loss: 1.801 Test Acc: 0.622
Validation loss decreased (-0.494422 --> -0.622204).  Saving model ...
Epoch: 4 cost time: 1.2487177848815918
Epoch: 4, Steps: 12 | Train Loss: 1.404 Vali Loss: 1.405 Vali Acc: 0.628 Test Loss: 1.405 Test Acc: 0.628
Validation loss decreased (-0.622204 --> -0.627764).  Saving model ...
Epoch: 5 cost time: 1.2056584358215332
Epoch: 5, Steps: 12 | Train Loss: 1.011 Vali Loss: 1.112 Vali Acc: 0.672 Test Loss: 1.112 Test Acc: 0.672
Validation loss decreased (-0.627764 --> -0.672211).  Saving model ...
Epoch: 6 cost time: 1.2893145084381104
Epoch: 6, Steps: 12 | Train Loss: 0.819 Vali Loss: 0.967 Vali Acc: 0.683 Test Loss: 0.967 Test Acc: 0.683
Validation loss decreased (-0.672211 --> -0.683324).  Saving model ...
Epoch: 7 cost time: 1.3535773754119873
Epoch: 7, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.873 Vali Acc: 0.744 Test Loss: 0.873 Test Acc: 0.744
Validation loss decreased (-0.683324 --> -0.744436).  Saving model ...
Epoch: 8 cost time: 1.4065186977386475
Epoch: 8, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.848 Vali Acc: 0.744 Test Loss: 0.848 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 9 cost time: 1.429399013519287
Epoch: 9, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.702 Vali Acc: 0.806 Test Loss: 0.702 Test Acc: 0.806
Validation loss decreased (-0.744436 --> -0.805549).  Saving model ...
Epoch: 10 cost time: 1.360297679901123
Epoch: 10, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.709 Vali Acc: 0.800 Test Loss: 0.709 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2657060623168945
Epoch: 11, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.680 Vali Acc: 0.811 Test Loss: 0.680 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811104).  Saving model ...
Epoch: 12 cost time: 1.2598967552185059
Epoch: 12, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.634 Vali Acc: 0.817 Test Loss: 0.634 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 13 cost time: 1.281520128250122
Epoch: 13, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.675 Vali Acc: 0.822 Test Loss: 0.675 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822215).  Saving model ...
Epoch: 14 cost time: 1.2560193538665771
Epoch: 14, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.651 Vali Acc: 0.856 Test Loss: 0.651 Test Acc: 0.856
Validation loss decreased (-0.822215 --> -0.855549).  Saving model ...
Epoch: 15 cost time: 1.3002619743347168
Epoch: 15, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.676 Vali Acc: 0.833 Test Loss: 0.676 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3289868831634521
Epoch: 16, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.688 Vali Acc: 0.856 Test Loss: 0.688 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.37831711769104
Epoch: 17, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.669 Vali Acc: 0.867 Test Loss: 0.669 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866660).  Saving model ...
Epoch: 18 cost time: 1.3082706928253174
Epoch: 18, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.709 Vali Acc: 0.850 Test Loss: 0.709 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.270944595336914
Epoch: 19, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.832 Vali Acc: 0.861 Test Loss: 0.832 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2665035724639893
Epoch: 20, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.862 Vali Acc: 0.867 Test Loss: 0.862 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1531579494476318
Epoch: 21, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.776 Vali Acc: 0.872 Test Loss: 0.776 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872214).  Saving model ...
Epoch: 22 cost time: 1.1973705291748047
Epoch: 22, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.857 Vali Acc: 0.867 Test Loss: 0.857 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2316999435424805
Epoch: 23, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.857 Vali Acc: 0.867 Test Loss: 0.857 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3125722408294678
Epoch: 24, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.826 Vali Acc: 0.867 Test Loss: 0.826 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2876291275024414
Epoch: 25, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.807 Vali Acc: 0.883 Test Loss: 0.807 Test Acc: 0.883
Validation loss decreased (-0.872214 --> -0.883325).  Saving model ...
Epoch: 26 cost time: 1.3633005619049072
Epoch: 26, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.822 Vali Acc: 0.861 Test Loss: 0.822 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3551020622253418
Epoch: 27, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.913 Vali Acc: 0.872 Test Loss: 0.913 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2713637351989746
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.891 Vali Acc: 0.867 Test Loss: 0.891 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2431142330169678
Epoch: 29, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.840 Vali Acc: 0.872 Test Loss: 0.840 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2573606967926025
Epoch: 30, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.819 Vali Acc: 0.883 Test Loss: 0.819 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2178623676300049
Epoch: 31, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.817 Vali Acc: 0.883 Test Loss: 0.817 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2347278594970703
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.860 Vali Acc: 0.872 Test Loss: 0.860 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1540164947509766
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.884 Vali Acc: 0.861 Test Loss: 0.884 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.1585626602172852
Epoch: 34, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.846 Vali Acc: 0.872 Test Loss: 0.846 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.1233577728271484
Epoch: 35, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.864 Vali Acc: 0.867 Test Loss: 0.864 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 1496719
model size : 5.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5416014194488525
Epoch: 1, Steps: 12 | Train Loss: 2.699 Vali Loss: 2.632 Vali Acc: 0.089 Test Loss: 2.632 Test Acc: 0.089
Validation loss decreased (inf --> -0.088863).  Saving model ...
Epoch: 2 cost time: 1.256829023361206
Epoch: 2, Steps: 12 | Train Loss: 2.439 Vali Loss: 2.385 Vali Acc: 0.433 Test Loss: 2.385 Test Acc: 0.433
Validation loss decreased (-0.088863 --> -0.433309).  Saving model ...
Epoch: 3 cost time: 1.2840101718902588
Epoch: 3, Steps: 12 | Train Loss: 2.038 Vali Loss: 1.996 Vali Acc: 0.567 Test Loss: 1.996 Test Acc: 0.567
Validation loss decreased (-0.433309 --> -0.566647).  Saving model ...
Epoch: 4 cost time: 1.2327122688293457
Epoch: 4, Steps: 12 | Train Loss: 1.573 Vali Loss: 1.596 Vali Acc: 0.617 Test Loss: 1.596 Test Acc: 0.617
Validation loss decreased (-0.566647 --> -0.616651).  Saving model ...
Epoch: 5 cost time: 1.33919095993042
Epoch: 5, Steps: 12 | Train Loss: 1.167 Vali Loss: 1.297 Vali Acc: 0.633 Test Loss: 1.297 Test Acc: 0.633
Validation loss decreased (-0.616651 --> -0.633320).  Saving model ...
Epoch: 6 cost time: 1.3514289855957031
Epoch: 6, Steps: 12 | Train Loss: 0.937 Vali Loss: 1.098 Vali Acc: 0.678 Test Loss: 1.098 Test Acc: 0.678
Validation loss decreased (-0.633320 --> -0.677767).  Saving model ...
Epoch: 7 cost time: 1.3851454257965088
Epoch: 7, Steps: 12 | Train Loss: 0.727 Vali Loss: 0.968 Vali Acc: 0.717 Test Loss: 0.968 Test Acc: 0.717
Validation loss decreased (-0.677767 --> -0.716657).  Saving model ...
Epoch: 8 cost time: 1.353769302368164
Epoch: 8, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.869 Vali Acc: 0.733 Test Loss: 0.869 Test Acc: 0.733
Validation loss decreased (-0.716657 --> -0.733325).  Saving model ...
Epoch: 9 cost time: 1.3668653964996338
Epoch: 9, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.834 Vali Acc: 0.756 Test Loss: 0.834 Test Acc: 0.756
Validation loss decreased (-0.733325 --> -0.755547).  Saving model ...
Epoch: 10 cost time: 1.2369537353515625
Epoch: 10, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.810 Vali Acc: 0.772 Test Loss: 0.810 Test Acc: 0.772
Validation loss decreased (-0.755547 --> -0.772214).  Saving model ...
Epoch: 11 cost time: 1.2452216148376465
Epoch: 11, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.666 Vali Acc: 0.811 Test Loss: 0.666 Test Acc: 0.811
Validation loss decreased (-0.772214 --> -0.811104).  Saving model ...
Epoch: 12 cost time: 1.2660343647003174
Epoch: 12, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.664 Vali Acc: 0.828 Test Loss: 0.664 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 13 cost time: 1.1980931758880615
Epoch: 13, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.661 Vali Acc: 0.844 Test Loss: 0.661 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 14 cost time: 1.2262990474700928
Epoch: 14, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.650 Vali Acc: 0.861 Test Loss: 0.650 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861105).  Saving model ...
Epoch: 15 cost time: 1.2715964317321777
Epoch: 15, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.618 Vali Acc: 0.872 Test Loss: 0.618 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 16 cost time: 1.3261768817901611
Epoch: 16, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.651 Vali Acc: 0.856 Test Loss: 0.651 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3395144939422607
Epoch: 17, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.655 Vali Acc: 0.872 Test Loss: 0.655 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3195345401763916
Epoch: 18, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.673 Vali Acc: 0.878 Test Loss: 0.673 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877771).  Saving model ...
Epoch: 19 cost time: 1.3273427486419678
Epoch: 19, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.674 Vali Acc: 0.839 Test Loss: 0.674 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2444050312042236
Epoch: 20, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.684 Vali Acc: 0.867 Test Loss: 0.684 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2795779705047607
Epoch: 21, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.741 Vali Acc: 0.872 Test Loss: 0.741 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3696589469909668
Epoch: 22, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.734 Vali Acc: 0.867 Test Loss: 0.734 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.347322702407837
Epoch: 23, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.781 Vali Acc: 0.861 Test Loss: 0.781 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3549129962921143
Epoch: 24, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.763 Vali Acc: 0.861 Test Loss: 0.763 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4003572463989258
Epoch: 25, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.768 Vali Acc: 0.878 Test Loss: 0.768 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3796789646148682
Epoch: 26, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.763 Vali Acc: 0.883 Test Loss: 0.763 Test Acc: 0.883
Validation loss decreased (-0.877771 --> -0.883326).  Saving model ...
Epoch: 27 cost time: 1.4091901779174805
Epoch: 27, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.772 Vali Acc: 0.878 Test Loss: 0.772 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.382124900817871
Epoch: 28, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.774 Vali Acc: 0.867 Test Loss: 0.774 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.36836838722229
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.818 Vali Acc: 0.878 Test Loss: 0.818 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3543572425842285
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.853 Vali Acc: 0.878 Test Loss: 0.853 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.3300621509552002
Epoch: 31, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.842 Vali Acc: 0.872 Test Loss: 0.842 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.3429210186004639
Epoch: 32, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.878 Vali Acc: 0.867 Test Loss: 0.878 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.2451941967010498
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.914 Vali Acc: 0.883 Test Loss: 0.914 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.3620128631591797
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.894 Vali Acc: 0.872 Test Loss: 0.894 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.4303004741668701
Epoch: 35, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.940 Vali Acc: 0.844 Test Loss: 0.940 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.3312582969665527
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.882 Vali Acc: 0.861 Test Loss: 0.882 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 1473807
model size : 5.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4254863262176514
Epoch: 1, Steps: 12 | Train Loss: 2.730 Vali Loss: 2.666 Vali Acc: 0.133 Test Loss: 2.666 Test Acc: 0.133
Validation loss decreased (inf --> -0.133307).  Saving model ...
Epoch: 2 cost time: 1.2311084270477295
Epoch: 2, Steps: 12 | Train Loss: 2.505 Vali Loss: 2.455 Vali Acc: 0.456 Test Loss: 2.455 Test Acc: 0.456
Validation loss decreased (-0.133307 --> -0.455531).  Saving model ...
Epoch: 3 cost time: 1.2694756984710693
Epoch: 3, Steps: 12 | Train Loss: 2.160 Vali Loss: 2.101 Vali Acc: 0.594 Test Loss: 2.101 Test Acc: 0.594
Validation loss decreased (-0.455531 --> -0.594423).  Saving model ...
Epoch: 4 cost time: 1.283811092376709
Epoch: 4, Steps: 12 | Train Loss: 1.725 Vali Loss: 1.693 Vali Acc: 0.644 Test Loss: 1.693 Test Acc: 0.644
Validation loss decreased (-0.594423 --> -0.644428).  Saving model ...
Epoch: 5 cost time: 1.3124301433563232
Epoch: 5, Steps: 12 | Train Loss: 1.365 Vali Loss: 1.348 Vali Acc: 0.678 Test Loss: 1.348 Test Acc: 0.678
Validation loss decreased (-0.644428 --> -0.677764).  Saving model ...
Epoch: 6 cost time: 1.385680913925171
Epoch: 6, Steps: 12 | Train Loss: 1.028 Vali Loss: 1.154 Vali Acc: 0.683 Test Loss: 1.154 Test Acc: 0.683
Validation loss decreased (-0.677764 --> -0.683322).  Saving model ...
Epoch: 7 cost time: 1.340562105178833
Epoch: 7, Steps: 12 | Train Loss: 0.828 Vali Loss: 1.003 Vali Acc: 0.694 Test Loss: 1.003 Test Acc: 0.694
Validation loss decreased (-0.683322 --> -0.694434).  Saving model ...
Epoch: 8 cost time: 1.2918241024017334
Epoch: 8, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.906 Vali Acc: 0.728 Test Loss: 0.906 Test Acc: 0.728
Validation loss decreased (-0.694434 --> -0.727769).  Saving model ...
Epoch: 9 cost time: 1.3135807514190674
Epoch: 9, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.823 Vali Acc: 0.728 Test Loss: 0.823 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727770).  Saving model ...
Epoch: 10 cost time: 1.2432911396026611
Epoch: 10, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.764 Vali Acc: 0.783 Test Loss: 0.764 Test Acc: 0.783
Validation loss decreased (-0.727770 --> -0.783326).  Saving model ...
Epoch: 11 cost time: 1.2741649150848389
Epoch: 11, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.734 Vali Acc: 0.800 Test Loss: 0.734 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 1.3167102336883545
Epoch: 12, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.647 Vali Acc: 0.828 Test Loss: 0.647 Test Acc: 0.828
Validation loss decreased (-0.799993 --> -0.827771).  Saving model ...
Epoch: 13 cost time: 1.4007704257965088
Epoch: 13, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.635 Vali Acc: 0.822 Test Loss: 0.635 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3804600238800049
Epoch: 14, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.640 Vali Acc: 0.839 Test Loss: 0.640 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 15 cost time: 1.3985247611999512
Epoch: 15, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.602 Vali Acc: 0.839 Test Loss: 0.602 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 16 cost time: 1.28597092628479
Epoch: 16, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.641 Vali Acc: 0.861 Test Loss: 0.641 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861105).  Saving model ...
Epoch: 17 cost time: 1.3088390827178955
Epoch: 17, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.638 Vali Acc: 0.861 Test Loss: 0.638 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 18 cost time: 1.2236328125
Epoch: 18, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.628 Vali Acc: 0.861 Test Loss: 0.628 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 19 cost time: 1.2979652881622314
Epoch: 19, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.631 Vali Acc: 0.861 Test Loss: 0.631 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.264432668685913
Epoch: 20, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.610 Vali Acc: 0.878 Test Loss: 0.610 Test Acc: 0.878
Validation loss decreased (-0.861105 --> -0.877772).  Saving model ...
Epoch: 21 cost time: 1.3115222454071045
Epoch: 21, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.627 Vali Acc: 0.878 Test Loss: 0.627 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2952957153320312
Epoch: 22, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.647 Vali Acc: 0.883 Test Loss: 0.647 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 23 cost time: 1.280677318572998
Epoch: 23, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.677 Vali Acc: 0.872 Test Loss: 0.677 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2550559043884277
Epoch: 24, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.678 Vali Acc: 0.861 Test Loss: 0.678 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2207038402557373
Epoch: 25, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.695 Vali Acc: 0.872 Test Loss: 0.695 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2596921920776367
Epoch: 26, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.688 Vali Acc: 0.883 Test Loss: 0.688 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1660218238830566
Epoch: 27, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.751 Vali Acc: 0.878 Test Loss: 0.751 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3111350536346436
Epoch: 28, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.793 Vali Acc: 0.861 Test Loss: 0.793 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.293290615081787
Epoch: 29, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.762 Vali Acc: 0.878 Test Loss: 0.762 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.31614351272583
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.777 Vali Acc: 0.878 Test Loss: 0.777 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.3356268405914307
Epoch: 31, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.767 Vali Acc: 0.872 Test Loss: 0.767 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.3486485481262207
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.792 Vali Acc: 0.872 Test Loss: 0.792 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 1458703
model size : 5.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5098233222961426
Epoch: 1, Steps: 12 | Train Loss: 2.725 Vali Loss: 2.651 Vali Acc: 0.094 Test Loss: 2.651 Test Acc: 0.094
Validation loss decreased (inf --> -0.094418).  Saving model ...
Epoch: 2 cost time: 1.2549304962158203
Epoch: 2, Steps: 12 | Train Loss: 2.535 Vali Loss: 2.472 Vali Acc: 0.356 Test Loss: 2.472 Test Acc: 0.356
Validation loss decreased (-0.094418 --> -0.355531).  Saving model ...
Epoch: 3 cost time: 1.2850830554962158
Epoch: 3, Steps: 12 | Train Loss: 2.244 Vali Loss: 2.173 Vali Acc: 0.489 Test Loss: 2.173 Test Acc: 0.489
Validation loss decreased (-0.355531 --> -0.488867).  Saving model ...
Epoch: 4 cost time: 1.195997714996338
Epoch: 4, Steps: 12 | Train Loss: 1.846 Vali Loss: 1.815 Vali Acc: 0.544 Test Loss: 1.815 Test Acc: 0.544
Validation loss decreased (-0.488867 --> -0.544426).  Saving model ...
Epoch: 5 cost time: 1.1817359924316406
Epoch: 5, Steps: 12 | Train Loss: 1.548 Vali Loss: 1.506 Vali Acc: 0.628 Test Loss: 1.506 Test Acc: 0.628
Validation loss decreased (-0.544426 --> -0.627763).  Saving model ...
Epoch: 6 cost time: 1.2462546825408936
Epoch: 6, Steps: 12 | Train Loss: 1.152 Vali Loss: 1.295 Vali Acc: 0.639 Test Loss: 1.295 Test Acc: 0.639
Validation loss decreased (-0.627763 --> -0.638876).  Saving model ...
Epoch: 7 cost time: 1.273472547531128
Epoch: 7, Steps: 12 | Train Loss: 0.919 Vali Loss: 1.118 Vali Acc: 0.667 Test Loss: 1.118 Test Acc: 0.667
Validation loss decreased (-0.638876 --> -0.666655).  Saving model ...
Epoch: 8 cost time: 1.275209903717041
Epoch: 8, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.954 Vali Acc: 0.722 Test Loss: 0.954 Test Acc: 0.722
Validation loss decreased (-0.666655 --> -0.722213).  Saving model ...
Epoch: 9 cost time: 1.3368780612945557
Epoch: 9, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.852 Vali Acc: 0.750 Test Loss: 0.852 Test Acc: 0.750
Validation loss decreased (-0.722213 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 1.2466754913330078
Epoch: 10, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.780 Vali Acc: 0.778 Test Loss: 0.780 Test Acc: 0.778
Validation loss decreased (-0.749991 --> -0.777770).  Saving model ...
Epoch: 11 cost time: 1.2708172798156738
Epoch: 11, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.705 Vali Acc: 0.811 Test Loss: 0.705 Test Acc: 0.811
Validation loss decreased (-0.777770 --> -0.811104).  Saving model ...
Epoch: 12 cost time: 1.2627458572387695
Epoch: 12, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.682 Vali Acc: 0.822 Test Loss: 0.682 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822215).  Saving model ...
Epoch: 13 cost time: 1.287881851196289
Epoch: 13, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.656 Vali Acc: 0.839 Test Loss: 0.656 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838882).  Saving model ...
Epoch: 14 cost time: 1.2254745960235596
Epoch: 14, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.591 Vali Acc: 0.856 Test Loss: 0.591 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855550).  Saving model ...
Epoch: 15 cost time: 1.2338917255401611
Epoch: 15, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.601 Vali Acc: 0.844 Test Loss: 0.601 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.286905288696289
Epoch: 16, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.584 Vali Acc: 0.844 Test Loss: 0.584 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3505611419677734
Epoch: 17, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.637 Vali Acc: 0.856 Test Loss: 0.637 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3430113792419434
Epoch: 18, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.567 Vali Acc: 0.883 Test Loss: 0.567 Test Acc: 0.883
Validation loss decreased (-0.855550 --> -0.883328).  Saving model ...
Epoch: 19 cost time: 1.3909780979156494
Epoch: 19, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.566 Vali Acc: 0.883 Test Loss: 0.566 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 20 cost time: 1.188387155532837
Epoch: 20, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.592 Vali Acc: 0.878 Test Loss: 0.592 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.140690565109253
Epoch: 21, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.597 Vali Acc: 0.894 Test Loss: 0.597 Test Acc: 0.894
Validation loss decreased (-0.883328 --> -0.894438).  Saving model ...
Epoch: 22 cost time: 1.1999261379241943
Epoch: 22, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.593 Vali Acc: 0.883 Test Loss: 0.593 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.122551441192627
Epoch: 23, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.612 Vali Acc: 0.867 Test Loss: 0.612 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1163315773010254
Epoch: 24, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.637 Vali Acc: 0.878 Test Loss: 0.637 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.171379804611206
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.704 Vali Acc: 0.894 Test Loss: 0.704 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.386948585510254
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.662 Vali Acc: 0.861 Test Loss: 0.662 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3324832916259766
Epoch: 27, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.702 Vali Acc: 0.894 Test Loss: 0.702 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3058488368988037
Epoch: 28, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.710 Vali Acc: 0.867 Test Loss: 0.710 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.3087775707244873
Epoch: 29, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.664 Vali Acc: 0.889 Test Loss: 0.664 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1807022094726562
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.681 Vali Acc: 0.894 Test Loss: 0.681 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2084298133850098
Epoch: 31, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.700 Vali Acc: 0.900 Test Loss: 0.700 Test Acc: 0.900
Validation loss decreased (-0.894438 --> -0.899993).  Saving model ...
Epoch: 32 cost time: 1.2167766094207764
Epoch: 32, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.686 Vali Acc: 0.900 Test Loss: 0.686 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 33 cost time: 1.2779150009155273
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.688 Vali Acc: 0.894 Test Loss: 0.688 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.261765480041504
Epoch: 34, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.726 Vali Acc: 0.900 Test Loss: 0.726 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2831578254699707
Epoch: 35, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.758 Vali Acc: 0.894 Test Loss: 0.758 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.283693790435791
Epoch: 36, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.774 Vali Acc: 0.867 Test Loss: 0.774 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.2873923778533936
Epoch: 37, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.744 Vali Acc: 0.883 Test Loss: 0.744 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.3222057819366455
Epoch: 38, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.751 Vali Acc: 0.894 Test Loss: 0.751 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.252786636352539
Epoch: 39, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.769 Vali Acc: 0.878 Test Loss: 0.769 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.2046380043029785
Epoch: 40, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.807 Vali Acc: 0.894 Test Loss: 0.807 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.2949073314666748
Epoch: 41, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.791 Vali Acc: 0.878 Test Loss: 0.791 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.2604267597198486
Epoch: 42, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.798 Vali Acc: 0.883 Test Loss: 0.798 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 1451279
model size : 5.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.714900255203247
Epoch: 1, Steps: 12 | Train Loss: 2.660 Vali Loss: 2.630 Vali Acc: 0.117 Test Loss: 2.630 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 1.4406793117523193
Epoch: 2, Steps: 12 | Train Loss: 2.480 Vali Loss: 2.443 Vali Acc: 0.406 Test Loss: 2.443 Test Acc: 0.406
Validation loss decreased (-0.116640 --> -0.405531).  Saving model ...
Epoch: 3 cost time: 1.371629238128662
Epoch: 3, Steps: 12 | Train Loss: 2.193 Vali Loss: 2.156 Vali Acc: 0.572 Test Loss: 2.156 Test Acc: 0.572
Validation loss decreased (-0.405531 --> -0.572201).  Saving model ...
Epoch: 4 cost time: 1.3618905544281006
Epoch: 4, Steps: 12 | Train Loss: 1.839 Vali Loss: 1.807 Vali Acc: 0.628 Test Loss: 1.807 Test Acc: 0.628
Validation loss decreased (-0.572201 --> -0.627760).  Saving model ...
Epoch: 5 cost time: 1.3450336456298828
Epoch: 5, Steps: 12 | Train Loss: 1.475 Vali Loss: 1.500 Vali Acc: 0.672 Test Loss: 1.500 Test Acc: 0.672
Validation loss decreased (-0.627760 --> -0.672207).  Saving model ...
Epoch: 6 cost time: 1.2762267589569092
Epoch: 6, Steps: 12 | Train Loss: 1.184 Vali Loss: 1.259 Vali Acc: 0.683 Test Loss: 1.259 Test Acc: 0.683
Validation loss decreased (-0.672207 --> -0.683321).  Saving model ...
Epoch: 7 cost time: 1.3033130168914795
Epoch: 7, Steps: 12 | Train Loss: 0.941 Vali Loss: 1.063 Vali Acc: 0.739 Test Loss: 1.063 Test Acc: 0.739
Validation loss decreased (-0.683321 --> -0.738878).  Saving model ...
Epoch: 8 cost time: 1.2904338836669922
Epoch: 8, Steps: 12 | Train Loss: 0.744 Vali Loss: 0.934 Vali Acc: 0.756 Test Loss: 0.934 Test Acc: 0.756
Validation loss decreased (-0.738878 --> -0.755546).  Saving model ...
Epoch: 9 cost time: 1.2938809394836426
Epoch: 9, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.831 Vali Acc: 0.772 Test Loss: 0.831 Test Acc: 0.772
Validation loss decreased (-0.755546 --> -0.772214).  Saving model ...
Epoch: 10 cost time: 1.3578300476074219
Epoch: 10, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.737 Vali Acc: 0.783 Test Loss: 0.737 Test Acc: 0.783
Validation loss decreased (-0.772214 --> -0.783326).  Saving model ...
Epoch: 11 cost time: 1.3276455402374268
Epoch: 11, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.688 Vali Acc: 0.800 Test Loss: 0.688 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 1.3680684566497803
Epoch: 12, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.626 Vali Acc: 0.833 Test Loss: 0.626 Test Acc: 0.833
Validation loss decreased (-0.799993 --> -0.833327).  Saving model ...
Epoch: 13 cost time: 1.2241721153259277
Epoch: 13, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.598 Vali Acc: 0.839 Test Loss: 0.598 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 14 cost time: 1.2531921863555908
Epoch: 14, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.564 Vali Acc: 0.861 Test Loss: 0.564 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861105).  Saving model ...
Epoch: 15 cost time: 1.2580366134643555
Epoch: 15, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.546 Vali Acc: 0.856 Test Loss: 0.546 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2681171894073486
Epoch: 16, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.536 Vali Acc: 0.867 Test Loss: 0.536 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 17 cost time: 1.2482364177703857
Epoch: 17, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3760457038879395
Epoch: 18, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.527 Vali Acc: 0.844 Test Loss: 0.527 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3605823516845703
Epoch: 19, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.519 Vali Acc: 0.861 Test Loss: 0.519 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.380411148071289
Epoch: 20, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.524 Vali Acc: 0.856 Test Loss: 0.524 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.330092430114746
Epoch: 21, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.528 Vali Acc: 0.861 Test Loss: 0.528 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2569043636322021
Epoch: 22, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.534 Vali Acc: 0.856 Test Loss: 0.534 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.271291732788086
Epoch: 23, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.562 Vali Acc: 0.878 Test Loss: 0.562 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 24 cost time: 1.1649556159973145
Epoch: 24, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.590 Vali Acc: 0.872 Test Loss: 0.590 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2881109714508057
Epoch: 25, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.578 Vali Acc: 0.878 Test Loss: 0.578 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.285888671875
Epoch: 26, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.591 Vali Acc: 0.867 Test Loss: 0.591 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2648873329162598
Epoch: 27, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.611 Vali Acc: 0.867 Test Loss: 0.611 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.386000394821167
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.631 Vali Acc: 0.867 Test Loss: 0.631 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2885100841522217
Epoch: 29, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.595 Vali Acc: 0.872 Test Loss: 0.595 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2959263324737549
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.596 Vali Acc: 0.878 Test Loss: 0.596 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.2773466110229492
Epoch: 31, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.616 Vali Acc: 0.872 Test Loss: 0.616 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.2697505950927734
Epoch: 32, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.626 Vali Acc: 0.867 Test Loss: 0.626 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.2402865886688232
Epoch: 33, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.643 Vali Acc: 0.861 Test Loss: 0.643 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 1443983
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.28220272064209
Epoch: 1, Steps: 12 | Train Loss: 2.617 Vali Loss: 2.562 Vali Acc: 0.217 Test Loss: 2.562 Test Acc: 0.217
Validation loss decreased (inf --> -0.216641).  Saving model ...
Epoch: 2 cost time: 1.0580761432647705
Epoch: 2, Steps: 12 | Train Loss: 2.336 Vali Loss: 2.280 Vali Acc: 0.489 Test Loss: 2.280 Test Acc: 0.489
Validation loss decreased (-0.216641 --> -0.488866).  Saving model ...
Epoch: 3 cost time: 1.0395312309265137
Epoch: 3, Steps: 12 | Train Loss: 1.963 Vali Loss: 1.844 Vali Acc: 0.600 Test Loss: 1.844 Test Acc: 0.600
Validation loss decreased (-0.488866 --> -0.599982).  Saving model ...
Epoch: 4 cost time: 1.0843877792358398
Epoch: 4, Steps: 12 | Train Loss: 1.470 Vali Loss: 1.448 Vali Acc: 0.656 Test Loss: 1.448 Test Acc: 0.656
Validation loss decreased (-0.599982 --> -0.655541).  Saving model ...
Epoch: 5 cost time: 0.9822976589202881
Epoch: 5, Steps: 12 | Train Loss: 1.096 Vali Loss: 1.190 Vali Acc: 0.656 Test Loss: 1.190 Test Acc: 0.656
Validation loss decreased (-0.655541 --> -0.655544).  Saving model ...
Epoch: 6 cost time: 1.1656396389007568
Epoch: 6, Steps: 12 | Train Loss: 0.850 Vali Loss: 1.042 Vali Acc: 0.672 Test Loss: 1.042 Test Acc: 0.672
Validation loss decreased (-0.655544 --> -0.672212).  Saving model ...
Epoch: 7 cost time: 1.0752129554748535
Epoch: 7, Steps: 12 | Train Loss: 0.672 Vali Loss: 0.968 Vali Acc: 0.678 Test Loss: 0.968 Test Acc: 0.678
Validation loss decreased (-0.672212 --> -0.677768).  Saving model ...
Epoch: 8 cost time: 0.9911079406738281
Epoch: 8, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.866 Vali Acc: 0.733 Test Loss: 0.866 Test Acc: 0.733
Validation loss decreased (-0.677768 --> -0.733325).  Saving model ...
Epoch: 9 cost time: 1.0495579242706299
Epoch: 9, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.811 Vali Acc: 0.750 Test Loss: 0.811 Test Acc: 0.750
Validation loss decreased (-0.733325 --> -0.749992).  Saving model ...
Epoch: 10 cost time: 0.9700472354888916
Epoch: 10, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.783 Vali Acc: 0.772 Test Loss: 0.783 Test Acc: 0.772
Validation loss decreased (-0.749992 --> -0.772214).  Saving model ...
Epoch: 11 cost time: 0.972191333770752
Epoch: 11, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.828 Vali Acc: 0.772 Test Loss: 0.828 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.989180326461792
Epoch: 12, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.821 Vali Acc: 0.772 Test Loss: 0.821 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0728731155395508
Epoch: 13, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.787 Vali Acc: 0.789 Test Loss: 0.787 Test Acc: 0.789
Validation loss decreased (-0.772214 --> -0.788881).  Saving model ...
Epoch: 14 cost time: 1.0556964874267578
Epoch: 14, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.749 Vali Acc: 0.800 Test Loss: 0.749 Test Acc: 0.800
Validation loss decreased (-0.788881 --> -0.799993).  Saving model ...
Epoch: 15 cost time: 1.2162132263183594
Epoch: 15, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.753 Vali Acc: 0.800 Test Loss: 0.753 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1036534309387207
Epoch: 16, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.811 Vali Acc: 0.817 Test Loss: 0.811 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816659).  Saving model ...
Epoch: 17 cost time: 1.0733189582824707
Epoch: 17, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.768 Vali Acc: 0.811 Test Loss: 0.768 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0590972900390625
Epoch: 18, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.809 Vali Acc: 0.828 Test Loss: 0.809 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827770).  Saving model ...
Epoch: 19 cost time: 1.0038251876831055
Epoch: 19, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.852 Vali Acc: 0.839 Test Loss: 0.852 Test Acc: 0.839
Validation loss decreased (-0.827770 --> -0.838880).  Saving model ...
Epoch: 20 cost time: 0.967353343963623
Epoch: 20, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.878 Vali Acc: 0.833 Test Loss: 0.878 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.981931209564209
Epoch: 21, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.820 Vali Acc: 0.817 Test Loss: 0.820 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9752538204193115
Epoch: 22, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.843 Vali Acc: 0.844 Test Loss: 0.843 Test Acc: 0.844
Validation loss decreased (-0.838880 --> -0.844436).  Saving model ...
Epoch: 23 cost time: 1.0433533191680908
Epoch: 23, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.939 Vali Acc: 0.817 Test Loss: 0.939 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1279163360595703
Epoch: 24, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.031 Vali Acc: 0.839 Test Loss: 1.031 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1266131401062012
Epoch: 25, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.968 Vali Acc: 0.844 Test Loss: 0.968 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1114273071289062
Epoch: 26, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.042 Vali Acc: 0.872 Test Loss: 1.042 Test Acc: 0.872
Validation loss decreased (-0.844436 --> -0.872212).  Saving model ...
Epoch: 27 cost time: 1.1457858085632324
Epoch: 27, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.019 Vali Acc: 0.861 Test Loss: 1.019 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9751217365264893
Epoch: 28, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.044 Vali Acc: 0.839 Test Loss: 1.044 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9494235515594482
Epoch: 29, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.129 Vali Acc: 0.839 Test Loss: 1.129 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9276611804962158
Epoch: 30, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.109 Vali Acc: 0.828 Test Loss: 1.109 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9352831840515137
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.074 Vali Acc: 0.844 Test Loss: 1.074 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.97430419921875
Epoch: 32, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.186 Vali Acc: 0.850 Test Loss: 1.186 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.015061855316162
Epoch: 33, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.001 Vali Acc: 0.856 Test Loss: 1.001 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1876437664031982
Epoch: 34, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.994 Vali Acc: 0.867 Test Loss: 0.994 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.1618285179138184
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.080 Vali Acc: 0.856 Test Loss: 1.080 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.1047048568725586
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.119 Vali Acc: 0.839 Test Loss: 1.119 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 450255
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1985647678375244
Epoch: 1, Steps: 12 | Train Loss: 2.695 Vali Loss: 2.654 Vali Acc: 0.172 Test Loss: 2.654 Test Acc: 0.172
Validation loss decreased (inf --> -0.172196).  Saving model ...
Epoch: 2 cost time: 1.0527634620666504
Epoch: 2, Steps: 12 | Train Loss: 2.541 Vali Loss: 2.500 Vali Acc: 0.300 Test Loss: 2.500 Test Acc: 0.300
Validation loss decreased (-0.172196 --> -0.299975).  Saving model ...
Epoch: 3 cost time: 1.0312743186950684
Epoch: 3, Steps: 12 | Train Loss: 2.293 Vali Loss: 2.254 Vali Acc: 0.417 Test Loss: 2.254 Test Acc: 0.417
Validation loss decreased (-0.299975 --> -0.416644).  Saving model ...
Epoch: 4 cost time: 1.0659763813018799
Epoch: 4, Steps: 12 | Train Loss: 2.013 Vali Loss: 1.932 Vali Acc: 0.489 Test Loss: 1.932 Test Acc: 0.489
Validation loss decreased (-0.416644 --> -0.488870).  Saving model ...
Epoch: 5 cost time: 1.0703225135803223
Epoch: 5, Steps: 12 | Train Loss: 1.648 Vali Loss: 1.640 Vali Acc: 0.583 Test Loss: 1.640 Test Acc: 0.583
Validation loss decreased (-0.488870 --> -0.583317).  Saving model ...
Epoch: 6 cost time: 1.0372135639190674
Epoch: 6, Steps: 12 | Train Loss: 1.366 Vali Loss: 1.387 Vali Acc: 0.650 Test Loss: 1.387 Test Acc: 0.650
Validation loss decreased (-0.583317 --> -0.649986).  Saving model ...
Epoch: 7 cost time: 1.0140140056610107
Epoch: 7, Steps: 12 | Train Loss: 1.074 Vali Loss: 1.210 Vali Acc: 0.656 Test Loss: 1.210 Test Acc: 0.656
Validation loss decreased (-0.649986 --> -0.655543).  Saving model ...
Epoch: 8 cost time: 0.96451735496521
Epoch: 8, Steps: 12 | Train Loss: 0.878 Vali Loss: 1.085 Vali Acc: 0.656 Test Loss: 1.085 Test Acc: 0.656
Validation loss decreased (-0.655543 --> -0.655545).  Saving model ...
Epoch: 9 cost time: 1.0163164138793945
Epoch: 9, Steps: 12 | Train Loss: 0.718 Vali Loss: 1.005 Vali Acc: 0.667 Test Loss: 1.005 Test Acc: 0.667
Validation loss decreased (-0.655545 --> -0.666657).  Saving model ...
Epoch: 10 cost time: 0.9389941692352295
Epoch: 10, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.945 Vali Acc: 0.667 Test Loss: 0.945 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 11 cost time: 0.9591631889343262
Epoch: 11, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.901 Vali Acc: 0.689 Test Loss: 0.901 Test Acc: 0.689
Validation loss decreased (-0.666657 --> -0.688880).  Saving model ...
Epoch: 12 cost time: 0.9727799892425537
Epoch: 12, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.848 Vali Acc: 0.706 Test Loss: 0.848 Test Acc: 0.706
Validation loss decreased (-0.688880 --> -0.705547).  Saving model ...
Epoch: 13 cost time: 1.0467159748077393
Epoch: 13, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.808 Vali Acc: 0.728 Test Loss: 0.808 Test Acc: 0.728
Validation loss decreased (-0.705547 --> -0.727770).  Saving model ...
Epoch: 14 cost time: 1.0440783500671387
Epoch: 14, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.787 Vali Acc: 0.767 Test Loss: 0.787 Test Acc: 0.767
Validation loss decreased (-0.727770 --> -0.766659).  Saving model ...
Epoch: 15 cost time: 0.9638144969940186
Epoch: 15, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.718 Vali Acc: 0.783 Test Loss: 0.718 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783326).  Saving model ...
Epoch: 16 cost time: 0.9679529666900635
Epoch: 16, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.750 Vali Acc: 0.794 Test Loss: 0.750 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794437).  Saving model ...
Epoch: 17 cost time: 1.0754084587097168
Epoch: 17, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.686 Vali Acc: 0.822 Test Loss: 0.686 Test Acc: 0.822
Validation loss decreased (-0.794437 --> -0.822215).  Saving model ...
Epoch: 18 cost time: 1.0675594806671143
Epoch: 18, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.726 Vali Acc: 0.806 Test Loss: 0.726 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0617313385009766
Epoch: 19, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.724 Vali Acc: 0.817 Test Loss: 0.724 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0400826930999756
Epoch: 20, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.717 Vali Acc: 0.839 Test Loss: 0.717 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838882).  Saving model ...
Epoch: 21 cost time: 1.1032333374023438
Epoch: 21, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.745 Vali Acc: 0.806 Test Loss: 0.745 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0497994422912598
Epoch: 22, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.708 Vali Acc: 0.833 Test Loss: 0.708 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0487596988677979
Epoch: 23, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.721 Vali Acc: 0.817 Test Loss: 0.721 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0207490921020508
Epoch: 24, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.785 Vali Acc: 0.828 Test Loss: 0.785 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9763576984405518
Epoch: 25, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.743 Vali Acc: 0.833 Test Loss: 0.743 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9814126491546631
Epoch: 26, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.721 Vali Acc: 0.844 Test Loss: 0.721 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844437).  Saving model ...
Epoch: 27 cost time: 0.953895092010498
Epoch: 27, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.770 Vali Acc: 0.844 Test Loss: 0.770 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9931683540344238
Epoch: 28, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.802 Vali Acc: 0.839 Test Loss: 0.802 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9557316303253174
Epoch: 29, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.822 Vali Acc: 0.844 Test Loss: 0.822 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.978663444519043
Epoch: 30, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.781 Vali Acc: 0.839 Test Loss: 0.781 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0666449069976807
Epoch: 31, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.788 Vali Acc: 0.850 Test Loss: 0.788 Test Acc: 0.850
Validation loss decreased (-0.844437 --> -0.849992).  Saving model ...
Epoch: 32 cost time: 0.9914448261260986
Epoch: 32, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.794 Vali Acc: 0.856 Test Loss: 0.794 Test Acc: 0.856
Validation loss decreased (-0.849992 --> -0.855548).  Saving model ...
Epoch: 33 cost time: 1.0540940761566162
Epoch: 33, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.794 Vali Acc: 0.856 Test Loss: 0.794 Test Acc: 0.856
Validation loss decreased (-0.855548 --> -0.855548).  Saving model ...
Epoch: 34 cost time: 0.9459526538848877
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.811 Vali Acc: 0.850 Test Loss: 0.811 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9545462131500244
Epoch: 35, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.786 Vali Acc: 0.856 Test Loss: 0.786 Test Acc: 0.856
Validation loss decreased (-0.855548 --> -0.855548).  Saving model ...
Epoch: 36 cost time: 0.9768249988555908
Epoch: 36, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.788 Vali Acc: 0.856 Test Loss: 0.788 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9854393005371094
Epoch: 37, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.806 Vali Acc: 0.856 Test Loss: 0.806 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9521420001983643
Epoch: 38, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.824 Vali Acc: 0.856 Test Loss: 0.824 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.008166790008545
Epoch: 39, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.828 Vali Acc: 0.861 Test Loss: 0.828 Test Acc: 0.861
Validation loss decreased (-0.855548 --> -0.861103).  Saving model ...
Epoch: 40 cost time: 1.1214256286621094
Epoch: 40, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.851 Vali Acc: 0.867 Test Loss: 0.851 Test Acc: 0.867
Validation loss decreased (-0.861103 --> -0.866658).  Saving model ...
Epoch: 41 cost time: 1.0574111938476562
Epoch: 41, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.860 Vali Acc: 0.861 Test Loss: 0.860 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.129042148590088
Epoch: 42, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.839 Vali Acc: 0.856 Test Loss: 0.839 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0864791870117188
Epoch: 43, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.883 Vali Acc: 0.856 Test Loss: 0.883 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9637320041656494
Epoch: 44, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.894 Vali Acc: 0.861 Test Loss: 0.894 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9714193344116211
Epoch: 45, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.876 Vali Acc: 0.867 Test Loss: 0.876 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9666986465454102
Epoch: 46, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.900 Vali Acc: 0.856 Test Loss: 0.900 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.9517388343811035
Epoch: 47, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.875 Vali Acc: 0.861 Test Loss: 0.875 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.9232263565063477
Epoch: 48, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.879 Vali Acc: 0.856 Test Loss: 0.879 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.962956428527832
Epoch: 49, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.962 Vali Acc: 0.856 Test Loss: 0.962 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.9777629375457764
Epoch: 50, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.926 Vali Acc: 0.833 Test Loss: 0.926 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 404239
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.992276668548584
Epoch: 1, Steps: 12 | Train Loss: 2.740 Vali Loss: 2.702 Vali Acc: 0.078 Test Loss: 2.702 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 0.8658602237701416
Epoch: 2, Steps: 12 | Train Loss: 2.598 Vali Loss: 2.562 Vali Acc: 0.233 Test Loss: 2.562 Test Acc: 0.233
Validation loss decreased (-0.077751 --> -0.233308).  Saving model ...
Epoch: 3 cost time: 0.9456875324249268
Epoch: 3, Steps: 12 | Train Loss: 2.369 Vali Loss: 2.328 Vali Acc: 0.439 Test Loss: 2.328 Test Acc: 0.439
Validation loss decreased (-0.233308 --> -0.438866).  Saving model ...
Epoch: 4 cost time: 1.0707499980926514
Epoch: 4, Steps: 12 | Train Loss: 2.060 Vali Loss: 2.021 Vali Acc: 0.556 Test Loss: 2.021 Test Acc: 0.556
Validation loss decreased (-0.438866 --> -0.555535).  Saving model ...
Epoch: 5 cost time: 1.0620508193969727
Epoch: 5, Steps: 12 | Train Loss: 1.667 Vali Loss: 1.698 Vali Acc: 0.606 Test Loss: 1.698 Test Acc: 0.606
Validation loss decreased (-0.555535 --> -0.605539).  Saving model ...
Epoch: 6 cost time: 1.033942461013794
Epoch: 6, Steps: 12 | Train Loss: 1.419 Vali Loss: 1.421 Vali Acc: 0.639 Test Loss: 1.421 Test Acc: 0.639
Validation loss decreased (-0.605539 --> -0.638875).  Saving model ...
Epoch: 7 cost time: 1.011162281036377
Epoch: 7, Steps: 12 | Train Loss: 1.071 Vali Loss: 1.221 Vali Acc: 0.656 Test Loss: 1.221 Test Acc: 0.656
Validation loss decreased (-0.638875 --> -0.655543).  Saving model ...
Epoch: 8 cost time: 0.9671914577484131
Epoch: 8, Steps: 12 | Train Loss: 0.857 Vali Loss: 1.103 Vali Acc: 0.667 Test Loss: 1.103 Test Acc: 0.667
Validation loss decreased (-0.655543 --> -0.666656).  Saving model ...
Epoch: 9 cost time: 1.0188519954681396
Epoch: 9, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.997 Vali Acc: 0.672 Test Loss: 0.997 Test Acc: 0.672
Validation loss decreased (-0.666656 --> -0.672212).  Saving model ...
Epoch: 10 cost time: 0.9893579483032227
Epoch: 10, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.929 Vali Acc: 0.694 Test Loss: 0.929 Test Acc: 0.694
Validation loss decreased (-0.672212 --> -0.694435).  Saving model ...
Epoch: 11 cost time: 0.9774215221405029
Epoch: 11, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.859 Vali Acc: 0.733 Test Loss: 0.859 Test Acc: 0.733
Validation loss decreased (-0.694435 --> -0.733325).  Saving model ...
Epoch: 12 cost time: 1.0800225734710693
Epoch: 12, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.778 Vali Acc: 0.783 Test Loss: 0.778 Test Acc: 0.783
Validation loss decreased (-0.733325 --> -0.783326).  Saving model ...
Epoch: 13 cost time: 1.069274663925171
Epoch: 13, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.750 Vali Acc: 0.772 Test Loss: 0.750 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1152300834655762
Epoch: 14, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.697 Vali Acc: 0.794 Test Loss: 0.697 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794437).  Saving model ...
Epoch: 15 cost time: 1.0745673179626465
Epoch: 15, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.676 Vali Acc: 0.806 Test Loss: 0.676 Test Acc: 0.806
Validation loss decreased (-0.794437 --> -0.805549).  Saving model ...
Epoch: 16 cost time: 1.0123541355133057
Epoch: 16, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.638 Vali Acc: 0.822 Test Loss: 0.638 Test Acc: 0.822
Validation loss decreased (-0.805549 --> -0.822216).  Saving model ...
Epoch: 17 cost time: 1.027897834777832
Epoch: 17, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.640 Vali Acc: 0.817 Test Loss: 0.640 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9954812526702881
Epoch: 18, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.611 Vali Acc: 0.833 Test Loss: 0.611 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 19 cost time: 0.9708085060119629
Epoch: 19, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.661 Vali Acc: 0.833 Test Loss: 0.661 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9612607955932617
Epoch: 20, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.628 Vali Acc: 0.833 Test Loss: 0.628 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.994121789932251
Epoch: 21, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.631 Vali Acc: 0.839 Test Loss: 0.631 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 22 cost time: 1.0154457092285156
Epoch: 22, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.622 Vali Acc: 0.839 Test Loss: 0.622 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 23 cost time: 0.9951765537261963
Epoch: 23, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.632 Vali Acc: 0.839 Test Loss: 0.632 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0173988342285156
Epoch: 24, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.638 Vali Acc: 0.850 Test Loss: 0.638 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 1.0355403423309326
Epoch: 25, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.664 Vali Acc: 0.839 Test Loss: 0.664 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0141706466674805
Epoch: 26, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.669 Vali Acc: 0.839 Test Loss: 0.669 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0430622100830078
Epoch: 27, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.626 Vali Acc: 0.844 Test Loss: 0.626 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0017399787902832
Epoch: 28, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.643 Vali Acc: 0.844 Test Loss: 0.643 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0263614654541016
Epoch: 29, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.669 Vali Acc: 0.856 Test Loss: 0.669 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 30 cost time: 0.9859545230865479
Epoch: 30, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.678 Vali Acc: 0.856 Test Loss: 0.678 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.010587453842163
Epoch: 31, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.686 Vali Acc: 0.850 Test Loss: 0.686 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9530563354492188
Epoch: 32, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.695 Vali Acc: 0.861 Test Loss: 0.695 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861104).  Saving model ...
Epoch: 33 cost time: 0.9991917610168457
Epoch: 33, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.708 Vali Acc: 0.861 Test Loss: 0.708 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9412786960601807
Epoch: 34, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.710 Vali Acc: 0.856 Test Loss: 0.710 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.899519681930542
Epoch: 35, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.724 Vali Acc: 0.856 Test Loss: 0.724 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0199522972106934
Epoch: 36, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.722 Vali Acc: 0.844 Test Loss: 0.722 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.02205491065979
Epoch: 37, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.735 Vali Acc: 0.867 Test Loss: 0.735 Test Acc: 0.867
Validation loss decreased (-0.861104 --> -0.866659).  Saving model ...
Epoch: 38 cost time: 1.0395042896270752
Epoch: 38, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.781 Vali Acc: 0.856 Test Loss: 0.781 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0548512935638428
Epoch: 39, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.745 Vali Acc: 0.850 Test Loss: 0.745 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9703450202941895
Epoch: 40, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.746 Vali Acc: 0.861 Test Loss: 0.746 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.952622652053833
Epoch: 41, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.787 Vali Acc: 0.867 Test Loss: 0.787 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9295523166656494
Epoch: 42, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.778 Vali Acc: 0.867 Test Loss: 0.778 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0077309608459473
Epoch: 43, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.781 Vali Acc: 0.839 Test Loss: 0.781 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.0139172077178955
Epoch: 44, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.774 Vali Acc: 0.856 Test Loss: 0.774 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.0250279903411865
Epoch: 45, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.905 Vali Acc: 0.839 Test Loss: 0.905 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.1048033237457275
Epoch: 46, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.815 Vali Acc: 0.872 Test Loss: 0.815 Test Acc: 0.872
Validation loss decreased (-0.866659 --> -0.872214).  Saving model ...
Epoch: 47 cost time: 1.1393883228302002
Epoch: 47, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.824 Vali Acc: 0.867 Test Loss: 0.824 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.124194860458374
Epoch: 48, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.860 Vali Acc: 0.867 Test Loss: 0.860 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.0800323486328125
Epoch: 49, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.855 Vali Acc: 0.850 Test Loss: 0.855 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.1083080768585205
Epoch: 50, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.935 Vali Acc: 0.867 Test Loss: 0.935 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 404303
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3452627658843994
Epoch: 1, Steps: 12 | Train Loss: 2.697 Vali Loss: 2.674 Vali Acc: 0.106 Test Loss: 2.674 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 1.0861284732818604
Epoch: 2, Steps: 12 | Train Loss: 2.559 Vali Loss: 2.547 Vali Acc: 0.306 Test Loss: 2.547 Test Acc: 0.306
Validation loss decreased (-0.105529 --> -0.305530).  Saving model ...
Epoch: 3 cost time: 1.0639848709106445
Epoch: 3, Steps: 12 | Train Loss: 2.360 Vali Loss: 2.339 Vali Acc: 0.467 Test Loss: 2.339 Test Acc: 0.467
Validation loss decreased (-0.305530 --> -0.466643).  Saving model ...
Epoch: 4 cost time: 1.0329651832580566
Epoch: 4, Steps: 12 | Train Loss: 2.104 Vali Loss: 2.064 Vali Acc: 0.517 Test Loss: 2.064 Test Acc: 0.517
Validation loss decreased (-0.466643 --> -0.516646).  Saving model ...
Epoch: 5 cost time: 1.104736089706421
Epoch: 5, Steps: 12 | Train Loss: 1.790 Vali Loss: 1.773 Vali Acc: 0.567 Test Loss: 1.773 Test Acc: 0.567
Validation loss decreased (-0.516646 --> -0.566649).  Saving model ...
Epoch: 6 cost time: 1.0231842994689941
Epoch: 6, Steps: 12 | Train Loss: 1.500 Vali Loss: 1.525 Vali Acc: 0.628 Test Loss: 1.525 Test Acc: 0.628
Validation loss decreased (-0.566649 --> -0.627763).  Saving model ...
Epoch: 7 cost time: 1.045841932296753
Epoch: 7, Steps: 12 | Train Loss: 1.261 Vali Loss: 1.300 Vali Acc: 0.644 Test Loss: 1.300 Test Acc: 0.644
Validation loss decreased (-0.627763 --> -0.644431).  Saving model ...
Epoch: 8 cost time: 1.0278518199920654
Epoch: 8, Steps: 12 | Train Loss: 1.044 Vali Loss: 1.156 Vali Acc: 0.656 Test Loss: 1.156 Test Acc: 0.656
Validation loss decreased (-0.644431 --> -0.655544).  Saving model ...
Epoch: 9 cost time: 0.9891793727874756
Epoch: 9, Steps: 12 | Train Loss: 0.893 Vali Loss: 1.066 Vali Acc: 0.683 Test Loss: 1.066 Test Acc: 0.683
Validation loss decreased (-0.655544 --> -0.683323).  Saving model ...
Epoch: 10 cost time: 1.03714919090271
Epoch: 10, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.965 Vali Acc: 0.711 Test Loss: 0.965 Test Acc: 0.711
Validation loss decreased (-0.683323 --> -0.711101).  Saving model ...
Epoch: 11 cost time: 0.9864182472229004
Epoch: 11, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.889 Vali Acc: 0.700 Test Loss: 0.889 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0371699333190918
Epoch: 12, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.851 Vali Acc: 0.739 Test Loss: 0.851 Test Acc: 0.739
Validation loss decreased (-0.711101 --> -0.738880).  Saving model ...
Epoch: 13 cost time: 1.0714502334594727
Epoch: 13, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.795 Vali Acc: 0.767 Test Loss: 0.795 Test Acc: 0.767
Validation loss decreased (-0.738880 --> -0.766659).  Saving model ...
Epoch: 14 cost time: 1.1096735000610352
Epoch: 14, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.734 Vali Acc: 0.789 Test Loss: 0.734 Test Acc: 0.789
Validation loss decreased (-0.766659 --> -0.788882).  Saving model ...
Epoch: 15 cost time: 1.0553781986236572
Epoch: 15, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.716 Vali Acc: 0.772 Test Loss: 0.716 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0629944801330566
Epoch: 16, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.672 Vali Acc: 0.811 Test Loss: 0.672 Test Acc: 0.811
Validation loss decreased (-0.788882 --> -0.811104).  Saving model ...
Epoch: 17 cost time: 1.0713303089141846
Epoch: 17, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.644 Vali Acc: 0.822 Test Loss: 0.644 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822216).  Saving model ...
Epoch: 18 cost time: 1.0241508483886719
Epoch: 18, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.656 Vali Acc: 0.833 Test Loss: 0.656 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 19 cost time: 0.9839835166931152
Epoch: 19, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.606 Vali Acc: 0.833 Test Loss: 0.606 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 20 cost time: 1.0265371799468994
Epoch: 20, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.616 Vali Acc: 0.861 Test Loss: 0.616 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861105).  Saving model ...
Epoch: 21 cost time: 1.0562946796417236
Epoch: 21, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.600 Vali Acc: 0.822 Test Loss: 0.600 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0168571472167969
Epoch: 22, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0369555950164795
Epoch: 23, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.629 Vali Acc: 0.867 Test Loss: 0.629 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 24 cost time: 1.0825493335723877
Epoch: 24, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.602 Vali Acc: 0.844 Test Loss: 0.602 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.084355115890503
Epoch: 25, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.631 Vali Acc: 0.850 Test Loss: 0.631 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0611019134521484
Epoch: 26, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0315446853637695
Epoch: 27, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.649 Vali Acc: 0.872 Test Loss: 0.649 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872216).  Saving model ...
Epoch: 28 cost time: 1.014258623123169
Epoch: 28, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.627 Vali Acc: 0.844 Test Loss: 0.627 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0256352424621582
Epoch: 29, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.650 Vali Acc: 0.850 Test Loss: 0.650 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0236575603485107
Epoch: 30, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.654 Vali Acc: 0.861 Test Loss: 0.654 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0356717109680176
Epoch: 31, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.672 Vali Acc: 0.872 Test Loss: 0.672 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0651335716247559
Epoch: 32, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.664 Vali Acc: 0.861 Test Loss: 0.664 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0824103355407715
Epoch: 33, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.703 Vali Acc: 0.872 Test Loss: 0.703 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.131230354309082
Epoch: 34, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.664 Vali Acc: 0.872 Test Loss: 0.664 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.1242132186889648
Epoch: 35, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.683 Vali Acc: 0.878 Test Loss: 0.683 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877771).  Saving model ...
Epoch: 36 cost time: 1.0659754276275635
Epoch: 36, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.681 Vali Acc: 0.878 Test Loss: 0.681 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877771).  Saving model ...
Epoch: 37 cost time: 1.0766541957855225
Epoch: 37, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.692 Vali Acc: 0.867 Test Loss: 0.692 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0709259510040283
Epoch: 38, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.698 Vali Acc: 0.889 Test Loss: 0.698 Test Acc: 0.889
Validation loss decreased (-0.877771 --> -0.888882).  Saving model ...
Epoch: 39 cost time: 1.0388526916503906
Epoch: 39, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.694 Vali Acc: 0.883 Test Loss: 0.694 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0394115447998047
Epoch: 40, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.707 Vali Acc: 0.878 Test Loss: 0.707 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9950265884399414
Epoch: 41, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.715 Vali Acc: 0.894 Test Loss: 0.715 Test Acc: 0.894
Validation loss decreased (-0.888882 --> -0.894437).  Saving model ...
Epoch: 42 cost time: 1.022308349609375
Epoch: 42, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.725 Vali Acc: 0.872 Test Loss: 0.725 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0046701431274414
Epoch: 43, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.745 Vali Acc: 0.872 Test Loss: 0.745 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0549383163452148
Epoch: 44, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.780 Vali Acc: 0.878 Test Loss: 0.780 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.1053359508514404
Epoch: 45, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.777 Vali Acc: 0.878 Test Loss: 0.777 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0771899223327637
Epoch: 46, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.763 Vali Acc: 0.872 Test Loss: 0.763 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.033475399017334
Epoch: 47, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.765 Vali Acc: 0.861 Test Loss: 0.765 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.079699993133545
Epoch: 48, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.760 Vali Acc: 0.878 Test Loss: 0.760 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.0298128128051758
Epoch: 49, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.781 Vali Acc: 0.878 Test Loss: 0.781 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.062917709350586
Epoch: 50, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.804 Vali Acc: 0.872 Test Loss: 0.804 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 392847
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3185296058654785
Epoch: 1, Steps: 12 | Train Loss: 2.730 Vali Loss: 2.668 Vali Acc: 0.056 Test Loss: 2.668 Test Acc: 0.056
Validation loss decreased (inf --> -0.055529).  Saving model ...
Epoch: 2 cost time: 1.1036937236785889
Epoch: 2, Steps: 12 | Train Loss: 2.626 Vali Loss: 2.574 Vali Acc: 0.206 Test Loss: 2.574 Test Acc: 0.206
Validation loss decreased (-0.055529 --> -0.205530).  Saving model ...
Epoch: 3 cost time: 1.0934031009674072
Epoch: 3, Steps: 12 | Train Loss: 2.449 Vali Loss: 2.410 Vali Acc: 0.461 Test Loss: 2.410 Test Acc: 0.461
Validation loss decreased (-0.205530 --> -0.461087).  Saving model ...
Epoch: 4 cost time: 1.0410869121551514
Epoch: 4, Steps: 12 | Train Loss: 2.246 Vali Loss: 2.203 Vali Acc: 0.539 Test Loss: 2.203 Test Acc: 0.539
Validation loss decreased (-0.461087 --> -0.538867).  Saving model ...
Epoch: 5 cost time: 1.0668931007385254
Epoch: 5, Steps: 12 | Train Loss: 1.975 Vali Loss: 1.966 Vali Acc: 0.567 Test Loss: 1.966 Test Acc: 0.567
Validation loss decreased (-0.538867 --> -0.566647).  Saving model ...
Epoch: 6 cost time: 0.988074541091919
Epoch: 6, Steps: 12 | Train Loss: 1.741 Vali Loss: 1.712 Vali Acc: 0.589 Test Loss: 1.712 Test Acc: 0.589
Validation loss decreased (-0.566647 --> -0.588872).  Saving model ...
Epoch: 7 cost time: 1.024951696395874
Epoch: 7, Steps: 12 | Train Loss: 1.456 Vali Loss: 1.478 Vali Acc: 0.594 Test Loss: 1.478 Test Acc: 0.594
Validation loss decreased (-0.588872 --> -0.594430).  Saving model ...
Epoch: 8 cost time: 1.0324831008911133
Epoch: 8, Steps: 12 | Train Loss: 1.201 Vali Loss: 1.297 Vali Acc: 0.639 Test Loss: 1.297 Test Acc: 0.639
Validation loss decreased (-0.594430 --> -0.638876).  Saving model ...
Epoch: 9 cost time: 1.030625343322754
Epoch: 9, Steps: 12 | Train Loss: 0.999 Vali Loss: 1.148 Vali Acc: 0.667 Test Loss: 1.148 Test Acc: 0.667
Validation loss decreased (-0.638876 --> -0.666655).  Saving model ...
Epoch: 10 cost time: 1.0284936428070068
Epoch: 10, Steps: 12 | Train Loss: 0.852 Vali Loss: 1.057 Vali Acc: 0.694 Test Loss: 1.057 Test Acc: 0.694
Validation loss decreased (-0.666655 --> -0.694434).  Saving model ...
Epoch: 11 cost time: 1.0447299480438232
Epoch: 11, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.963 Vali Acc: 0.700 Test Loss: 0.963 Test Acc: 0.700
Validation loss decreased (-0.694434 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 1.0734076499938965
Epoch: 12, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.891 Vali Acc: 0.728 Test Loss: 0.891 Test Acc: 0.728
Validation loss decreased (-0.699990 --> -0.727769).  Saving model ...
Epoch: 13 cost time: 1.0463190078735352
Epoch: 13, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.825 Vali Acc: 0.744 Test Loss: 0.825 Test Acc: 0.744
Validation loss decreased (-0.727769 --> -0.744436).  Saving model ...
Epoch: 14 cost time: 1.040498971939087
Epoch: 14, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.772 Vali Acc: 0.756 Test Loss: 0.772 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755548).  Saving model ...
Epoch: 15 cost time: 1.0774154663085938
Epoch: 15, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.721 Vali Acc: 0.783 Test Loss: 0.721 Test Acc: 0.783
Validation loss decreased (-0.755548 --> -0.783326).  Saving model ...
Epoch: 16 cost time: 1.0998270511627197
Epoch: 16, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.712 Vali Acc: 0.806 Test Loss: 0.712 Test Acc: 0.806
Validation loss decreased (-0.783326 --> -0.805548).  Saving model ...
Epoch: 17 cost time: 1.0547950267791748
Epoch: 17, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.662 Vali Acc: 0.822 Test Loss: 0.662 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822216).  Saving model ...
Epoch: 18 cost time: 1.0554783344268799
Epoch: 18, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.651 Vali Acc: 0.817 Test Loss: 0.651 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0843899250030518
Epoch: 19, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.647 Vali Acc: 0.828 Test Loss: 0.647 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827771).  Saving model ...
Epoch: 20 cost time: 1.1553666591644287
Epoch: 20, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.634 Vali Acc: 0.844 Test Loss: 0.634 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 21 cost time: 1.0619611740112305
Epoch: 21, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.643 Vali Acc: 0.839 Test Loss: 0.643 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.004187822341919
Epoch: 22, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 1.0518622398376465
Epoch: 23, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.597 Vali Acc: 0.861 Test Loss: 0.597 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 24 cost time: 1.0154902935028076
Epoch: 24, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.628 Vali Acc: 0.856 Test Loss: 0.628 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0755729675292969
Epoch: 25, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.623 Vali Acc: 0.867 Test Loss: 0.623 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 26 cost time: 1.0426146984100342
Epoch: 26, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.617 Vali Acc: 0.856 Test Loss: 0.617 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.017744779586792
Epoch: 27, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.624 Vali Acc: 0.844 Test Loss: 0.624 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0657429695129395
Epoch: 28, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.653 Vali Acc: 0.867 Test Loss: 0.653 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0974130630493164
Epoch: 29, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.629 Vali Acc: 0.872 Test Loss: 0.629 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872216).  Saving model ...
Epoch: 30 cost time: 1.053208589553833
Epoch: 30, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.624 Vali Acc: 0.867 Test Loss: 0.624 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.061497449874878
Epoch: 31, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.678 Vali Acc: 0.872 Test Loss: 0.678 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0197014808654785
Epoch: 32, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.693 Vali Acc: 0.883 Test Loss: 0.693 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883326).  Saving model ...
Epoch: 33 cost time: 1.0603508949279785
Epoch: 33, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.677 Vali Acc: 0.861 Test Loss: 0.677 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0186705589294434
Epoch: 34, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.715 Vali Acc: 0.872 Test Loss: 0.715 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0643854141235352
Epoch: 35, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.743 Vali Acc: 0.861 Test Loss: 0.743 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.058220624923706
Epoch: 36, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.747 Vali Acc: 0.844 Test Loss: 0.747 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.119771957397461
Epoch: 37, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.736 Vali Acc: 0.856 Test Loss: 0.736 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.062352180480957
Epoch: 38, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.723 Vali Acc: 0.878 Test Loss: 0.723 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0179314613342285
Epoch: 39, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.749 Vali Acc: 0.872 Test Loss: 0.749 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0588483810424805
Epoch: 40, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.727 Vali Acc: 0.883 Test Loss: 0.727 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.0192477703094482
Epoch: 41, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.743 Vali Acc: 0.872 Test Loss: 0.743 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.0134150981903076
Epoch: 42, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.778 Vali Acc: 0.889 Test Loss: 0.778 Test Acc: 0.889
Validation loss decreased (-0.883326 --> -0.888881).  Saving model ...
Epoch: 43 cost time: 1.0610344409942627
Epoch: 43, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.790 Vali Acc: 0.889 Test Loss: 0.790 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.035811185836792
Epoch: 44, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.776 Vali Acc: 0.878 Test Loss: 0.776 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0212163925170898
Epoch: 45, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.748 Vali Acc: 0.867 Test Loss: 0.748 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9982147216796875
Epoch: 46, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.770 Vali Acc: 0.872 Test Loss: 0.770 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.0013878345489502
Epoch: 47, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.786 Vali Acc: 0.872 Test Loss: 0.786 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.0642688274383545
Epoch: 48, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.807 Vali Acc: 0.878 Test Loss: 0.807 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.9870376586914062
Epoch: 49, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.808 Vali Acc: 0.856 Test Loss: 0.808 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.0278525352478027
Epoch: 50, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.804 Vali Acc: 0.883 Test Loss: 0.804 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 385295
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2906150817871094
Epoch: 1, Steps: 12 | Train Loss: 2.688 Vali Loss: 2.715 Vali Acc: 0.100 Test Loss: 2.715 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 1.0209624767303467
Epoch: 2, Steps: 12 | Train Loss: 2.573 Vali Loss: 2.624 Vali Acc: 0.189 Test Loss: 2.624 Test Acc: 0.189
Validation loss decreased (-0.099973 --> -0.188863).  Saving model ...
Epoch: 3 cost time: 1.0664572715759277
Epoch: 3, Steps: 12 | Train Loss: 2.433 Vali Loss: 2.469 Vali Acc: 0.322 Test Loss: 2.469 Test Acc: 0.322
Validation loss decreased (-0.188863 --> -0.322198).  Saving model ...
Epoch: 4 cost time: 1.055213212966919
Epoch: 4, Steps: 12 | Train Loss: 2.254 Vali Loss: 2.262 Vali Acc: 0.467 Test Loss: 2.262 Test Acc: 0.467
Validation loss decreased (-0.322198 --> -0.466644).  Saving model ...
Epoch: 5 cost time: 1.0263972282409668
Epoch: 5, Steps: 12 | Train Loss: 2.032 Vali Loss: 2.037 Vali Acc: 0.528 Test Loss: 2.037 Test Acc: 0.528
Validation loss decreased (-0.466644 --> -0.527757).  Saving model ...
Epoch: 6 cost time: 1.0123960971832275
Epoch: 6, Steps: 12 | Train Loss: 1.772 Vali Loss: 1.773 Vali Acc: 0.589 Test Loss: 1.773 Test Acc: 0.589
Validation loss decreased (-0.527757 --> -0.588871).  Saving model ...
Epoch: 7 cost time: 0.9795711040496826
Epoch: 7, Steps: 12 | Train Loss: 1.478 Vali Loss: 1.547 Vali Acc: 0.628 Test Loss: 1.547 Test Acc: 0.628
Validation loss decreased (-0.588871 --> -0.627762).  Saving model ...
Epoch: 8 cost time: 1.0093591213226318
Epoch: 8, Steps: 12 | Train Loss: 1.260 Vali Loss: 1.361 Vali Acc: 0.650 Test Loss: 1.361 Test Acc: 0.650
Validation loss decreased (-0.627762 --> -0.649986).  Saving model ...
Epoch: 9 cost time: 1.0085210800170898
Epoch: 9, Steps: 12 | Train Loss: 1.070 Vali Loss: 1.222 Vali Acc: 0.678 Test Loss: 1.222 Test Acc: 0.678
Validation loss decreased (-0.649986 --> -0.677766).  Saving model ...
Epoch: 10 cost time: 0.9549217224121094
Epoch: 10, Steps: 12 | Train Loss: 0.905 Vali Loss: 1.106 Vali Acc: 0.678 Test Loss: 1.106 Test Acc: 0.678
Validation loss decreased (-0.677766 --> -0.677767).  Saving model ...
Epoch: 11 cost time: 0.9583661556243896
Epoch: 11, Steps: 12 | Train Loss: 0.834 Vali Loss: 1.013 Vali Acc: 0.700 Test Loss: 1.013 Test Acc: 0.700
Validation loss decreased (-0.677767 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 0.9975113868713379
Epoch: 12, Steps: 12 | Train Loss: 0.667 Vali Loss: 0.940 Vali Acc: 0.739 Test Loss: 0.940 Test Acc: 0.739
Validation loss decreased (-0.699990 --> -0.738879).  Saving model ...
Epoch: 13 cost time: 1.0318412780761719
Epoch: 13, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.883 Vali Acc: 0.761 Test Loss: 0.883 Test Acc: 0.761
Validation loss decreased (-0.738879 --> -0.761102).  Saving model ...
Epoch: 14 cost time: 1.0248634815216064
Epoch: 14, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.808 Vali Acc: 0.778 Test Loss: 0.808 Test Acc: 0.778
Validation loss decreased (-0.761102 --> -0.777770).  Saving model ...
Epoch: 15 cost time: 0.9698183536529541
Epoch: 15, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.768 Vali Acc: 0.800 Test Loss: 0.768 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799992).  Saving model ...
Epoch: 16 cost time: 1.0197043418884277
Epoch: 16, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.706 Vali Acc: 0.822 Test Loss: 0.706 Test Acc: 0.822
Validation loss decreased (-0.799992 --> -0.822215).  Saving model ...
Epoch: 17 cost time: 1.0142381191253662
Epoch: 17, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.682 Vali Acc: 0.856 Test Loss: 0.682 Test Acc: 0.856
Validation loss decreased (-0.822215 --> -0.855549).  Saving model ...
Epoch: 18 cost time: 0.9993219375610352
Epoch: 18, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.660 Vali Acc: 0.839 Test Loss: 0.660 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0051352977752686
Epoch: 19, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.655 Vali Acc: 0.850 Test Loss: 0.655 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9969890117645264
Epoch: 20, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.638 Vali Acc: 0.850 Test Loss: 0.638 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0196952819824219
Epoch: 21, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.614 Vali Acc: 0.833 Test Loss: 0.614 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0417485237121582
Epoch: 22, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.601 Vali Acc: 0.850 Test Loss: 0.601 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.118833303451538
Epoch: 23, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.598 Vali Acc: 0.850 Test Loss: 0.598 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0536930561065674
Epoch: 24, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.599 Vali Acc: 0.844 Test Loss: 0.599 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0339696407318115
Epoch: 25, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.070838212966919
Epoch: 26, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.584 Vali Acc: 0.856 Test Loss: 0.584 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855550).  Saving model ...
Epoch: 27 cost time: 0.9939897060394287
Epoch: 27, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.589 Vali Acc: 0.867 Test Loss: 0.589 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 28 cost time: 0.9745309352874756
Epoch: 28, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.626 Vali Acc: 0.867 Test Loss: 0.626 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9707822799682617
Epoch: 29, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.604 Vali Acc: 0.861 Test Loss: 0.604 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9904603958129883
Epoch: 30, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.597 Vali Acc: 0.872 Test Loss: 0.597 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 31 cost time: 0.9875657558441162
Epoch: 31, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.633 Vali Acc: 0.872 Test Loss: 0.633 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9465742111206055
Epoch: 32, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.632 Vali Acc: 0.850 Test Loss: 0.632 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.029977798461914
Epoch: 33, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.625 Vali Acc: 0.889 Test Loss: 0.625 Test Acc: 0.889
Validation loss decreased (-0.872216 --> -0.888883).  Saving model ...
Epoch: 34 cost time: 1.0455303192138672
Epoch: 34, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.614 Vali Acc: 0.867 Test Loss: 0.614 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.107485294342041
Epoch: 35, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.656 Vali Acc: 0.856 Test Loss: 0.656 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0681648254394531
Epoch: 36, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.634 Vali Acc: 0.861 Test Loss: 0.634 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0648396015167236
Epoch: 37, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.639 Vali Acc: 0.867 Test Loss: 0.639 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0031142234802246
Epoch: 38, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.657 Vali Acc: 0.872 Test Loss: 0.657 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.999535322189331
Epoch: 39, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.667 Vali Acc: 0.861 Test Loss: 0.667 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9865131378173828
Epoch: 40, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.697 Vali Acc: 0.867 Test Loss: 0.697 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.9625139236450195
Epoch: 41, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.694 Vali Acc: 0.867 Test Loss: 0.694 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.035618543624878
Epoch: 42, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.671 Vali Acc: 0.867 Test Loss: 0.671 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.9808945655822754
Epoch: 43, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.682 Vali Acc: 0.878 Test Loss: 0.682 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 381583
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4235265254974365
Epoch: 1, Steps: 12 | Train Loss: 2.678 Vali Loss: 2.679 Vali Acc: 0.128 Test Loss: 2.679 Test Acc: 0.128
Validation loss decreased (inf --> -0.127751).  Saving model ...
Epoch: 2 cost time: 0.9756848812103271
Epoch: 2, Steps: 12 | Train Loss: 2.602 Vali Loss: 2.592 Vali Acc: 0.256 Test Loss: 2.592 Test Acc: 0.256
Validation loss decreased (-0.127751 --> -0.255530).  Saving model ...
Epoch: 3 cost time: 0.974470853805542
Epoch: 3, Steps: 12 | Train Loss: 2.476 Vali Loss: 2.445 Vali Acc: 0.389 Test Loss: 2.445 Test Acc: 0.389
Validation loss decreased (-0.255530 --> -0.388864).  Saving model ...
Epoch: 4 cost time: 0.9309110641479492
Epoch: 4, Steps: 12 | Train Loss: 2.293 Vali Loss: 2.262 Vali Acc: 0.511 Test Loss: 2.262 Test Acc: 0.511
Validation loss decreased (-0.388864 --> -0.511088).  Saving model ...
Epoch: 5 cost time: 1.0088114738464355
Epoch: 5, Steps: 12 | Train Loss: 2.115 Vali Loss: 2.069 Vali Acc: 0.594 Test Loss: 2.069 Test Acc: 0.594
Validation loss decreased (-0.511088 --> -0.594424).  Saving model ...
Epoch: 6 cost time: 1.0256175994873047
Epoch: 6, Steps: 12 | Train Loss: 1.895 Vali Loss: 1.838 Vali Acc: 0.617 Test Loss: 1.838 Test Acc: 0.617
Validation loss decreased (-0.594424 --> -0.616648).  Saving model ...
Epoch: 7 cost time: 1.0415458679199219
Epoch: 7, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.614 Vali Acc: 0.678 Test Loss: 1.614 Test Acc: 0.678
Validation loss decreased (-0.616648 --> -0.677762).  Saving model ...
Epoch: 8 cost time: 1.0859360694885254
Epoch: 8, Steps: 12 | Train Loss: 1.380 Vali Loss: 1.409 Vali Acc: 0.694 Test Loss: 1.409 Test Acc: 0.694
Validation loss decreased (-0.677762 --> -0.694430).  Saving model ...
Epoch: 9 cost time: 1.0735652446746826
Epoch: 9, Steps: 12 | Train Loss: 1.195 Vali Loss: 1.227 Vali Acc: 0.700 Test Loss: 1.227 Test Acc: 0.700
Validation loss decreased (-0.694430 --> -0.699988).  Saving model ...
Epoch: 10 cost time: 1.0807945728302002
Epoch: 10, Steps: 12 | Train Loss: 0.987 Vali Loss: 1.092 Vali Acc: 0.728 Test Loss: 1.092 Test Acc: 0.728
Validation loss decreased (-0.699988 --> -0.727767).  Saving model ...
Epoch: 11 cost time: 1.0852394104003906
Epoch: 11, Steps: 12 | Train Loss: 0.797 Vali Loss: 0.973 Vali Acc: 0.717 Test Loss: 0.973 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.037815809249878
Epoch: 12, Steps: 12 | Train Loss: 0.733 Vali Loss: 0.900 Vali Acc: 0.733 Test Loss: 0.900 Test Acc: 0.733
Validation loss decreased (-0.727767 --> -0.733324).  Saving model ...
Epoch: 13 cost time: 0.9791555404663086
Epoch: 13, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.849 Vali Acc: 0.756 Test Loss: 0.849 Test Acc: 0.756
Validation loss decreased (-0.733324 --> -0.755547).  Saving model ...
Epoch: 14 cost time: 0.9755959510803223
Epoch: 14, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.777 Vali Acc: 0.761 Test Loss: 0.777 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 15 cost time: 1.0189497470855713
Epoch: 15, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.722 Vali Acc: 0.778 Test Loss: 0.722 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777771).  Saving model ...
Epoch: 16 cost time: 1.0364563465118408
Epoch: 16, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.678 Vali Acc: 0.800 Test Loss: 0.678 Test Acc: 0.800
Validation loss decreased (-0.777771 --> -0.799993).  Saving model ...
Epoch: 17 cost time: 1.003058910369873
Epoch: 17, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.631 Vali Acc: 0.822 Test Loss: 0.631 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 18 cost time: 1.048614740371704
Epoch: 18, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.612 Vali Acc: 0.828 Test Loss: 0.612 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 19 cost time: 1.1095833778381348
Epoch: 19, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.591 Vali Acc: 0.833 Test Loss: 0.591 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833327).  Saving model ...
Epoch: 20 cost time: 1.0527729988098145
Epoch: 20, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.566 Vali Acc: 0.828 Test Loss: 0.566 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1053664684295654
Epoch: 21, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.557 Vali Acc: 0.839 Test Loss: 0.557 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 22 cost time: 1.0210156440734863
Epoch: 22, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 23 cost time: 1.0283794403076172
Epoch: 23, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.528 Vali Acc: 0.839 Test Loss: 0.528 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9304566383361816
Epoch: 24, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.526 Vali Acc: 0.861 Test Loss: 0.526 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861106).  Saving model ...
Epoch: 25 cost time: 1.0046658515930176
Epoch: 25, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9759421348571777
Epoch: 26, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9955329895019531
Epoch: 27, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.517 Vali Acc: 0.856 Test Loss: 0.517 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.030019760131836
Epoch: 28, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.521 Vali Acc: 0.856 Test Loss: 0.521 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0292389392852783
Epoch: 29, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.527 Vali Acc: 0.867 Test Loss: 0.527 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 30 cost time: 1.0301170349121094
Epoch: 30, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.524 Vali Acc: 0.839 Test Loss: 0.524 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.016190767288208
Epoch: 31, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9624111652374268
Epoch: 32, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.526 Vali Acc: 0.861 Test Loss: 0.526 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9677371978759766
Epoch: 33, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9126284122467041
Epoch: 34, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7965593338012695
Epoch: 35, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.529 Vali Acc: 0.861 Test Loss: 0.529 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9361982345581055
Epoch: 36, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.555 Vali Acc: 0.867 Test Loss: 0.555 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9461410045623779
Epoch: 37, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0529396533966064
Epoch: 38, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.556 Vali Acc: 0.872 Test Loss: 0.556 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 39 cost time: 1.1044530868530273
Epoch: 39, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.571 Vali Acc: 0.867 Test Loss: 0.571 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1632404327392578
Epoch: 40, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.577 Vali Acc: 0.878 Test Loss: 0.577 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 41 cost time: 1.0805747509002686
Epoch: 41, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0414307117462158
Epoch: 42, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.573 Vali Acc: 0.856 Test Loss: 0.573 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.007239818572998
Epoch: 43, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.566 Vali Acc: 0.878 Test Loss: 0.566 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 44 cost time: 0.9812524318695068
Epoch: 44, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.615 Vali Acc: 0.878 Test Loss: 0.615 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0162198543548584
Epoch: 45, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.606 Vali Acc: 0.867 Test Loss: 0.606 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9130167961120605
Epoch: 46, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.598 Vali Acc: 0.867 Test Loss: 0.598 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.0720291137695312
Epoch: 47, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.599 Vali Acc: 0.878 Test Loss: 0.599 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.9160318374633789
Epoch: 48, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.604 Vali Acc: 0.883 Test Loss: 0.604 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 49 cost time: 0.9830937385559082
Epoch: 49, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.605 Vali Acc: 0.867 Test Loss: 0.605 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0009455680847168
Epoch: 50, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.614 Vali Acc: 0.861 Test Loss: 0.614 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 377935
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4102654457092285
Epoch: 1, Steps: 12 | Train Loss: 2.687 Vali Loss: 2.656 Vali Acc: 0.167 Test Loss: 2.656 Test Acc: 0.167
Validation loss decreased (inf --> -0.166640).  Saving model ...
Epoch: 2 cost time: 0.9210236072540283
Epoch: 2, Steps: 12 | Train Loss: 2.582 Vali Loss: 2.535 Vali Acc: 0.328 Test Loss: 2.535 Test Acc: 0.328
Validation loss decreased (-0.166640 --> -0.327752).  Saving model ...
Epoch: 3 cost time: 0.9001314640045166
Epoch: 3, Steps: 12 | Train Loss: 2.387 Vali Loss: 2.341 Vali Acc: 0.461 Test Loss: 2.341 Test Acc: 0.461
Validation loss decreased (-0.327752 --> -0.461088).  Saving model ...
Epoch: 4 cost time: 0.9148716926574707
Epoch: 4, Steps: 12 | Train Loss: 2.099 Vali Loss: 2.078 Vali Acc: 0.528 Test Loss: 2.078 Test Acc: 0.528
Validation loss decreased (-0.461088 --> -0.527757).  Saving model ...
Epoch: 5 cost time: 0.9617679119110107
Epoch: 5, Steps: 12 | Train Loss: 1.820 Vali Loss: 1.796 Vali Acc: 0.589 Test Loss: 1.796 Test Acc: 0.589
Validation loss decreased (-0.527757 --> -0.588871).  Saving model ...
Epoch: 6 cost time: 1.006779432296753
Epoch: 6, Steps: 12 | Train Loss: 1.489 Vali Loss: 1.538 Vali Acc: 0.606 Test Loss: 1.538 Test Acc: 0.606
Validation loss decreased (-0.588871 --> -0.605540).  Saving model ...
Epoch: 7 cost time: 0.9484293460845947
Epoch: 7, Steps: 12 | Train Loss: 1.185 Vali Loss: 1.348 Vali Acc: 0.644 Test Loss: 1.348 Test Acc: 0.644
Validation loss decreased (-0.605540 --> -0.644431).  Saving model ...
Epoch: 8 cost time: 0.8443078994750977
Epoch: 8, Steps: 12 | Train Loss: 1.023 Vali Loss: 1.187 Vali Acc: 0.661 Test Loss: 1.187 Test Acc: 0.661
Validation loss decreased (-0.644431 --> -0.661099).  Saving model ...
Epoch: 9 cost time: 0.9022698402404785
Epoch: 9, Steps: 12 | Train Loss: 0.865 Vali Loss: 1.065 Vali Acc: 0.678 Test Loss: 1.065 Test Acc: 0.678
Validation loss decreased (-0.661099 --> -0.677767).  Saving model ...
Epoch: 10 cost time: 0.8214762210845947
Epoch: 10, Steps: 12 | Train Loss: 0.744 Vali Loss: 0.991 Vali Acc: 0.689 Test Loss: 0.991 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688879).  Saving model ...
Epoch: 11 cost time: 0.8193240165710449
Epoch: 11, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.950 Vali Acc: 0.700 Test Loss: 0.950 Test Acc: 0.700
Validation loss decreased (-0.688879 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 0.8665609359741211
Epoch: 12, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.909 Vali Acc: 0.711 Test Loss: 0.909 Test Acc: 0.711
Validation loss decreased (-0.699990 --> -0.711102).  Saving model ...
Epoch: 13 cost time: 0.8611412048339844
Epoch: 13, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.841 Vali Acc: 0.728 Test Loss: 0.841 Test Acc: 0.728
Validation loss decreased (-0.711102 --> -0.727769).  Saving model ...
Epoch: 14 cost time: 0.9017229080200195
Epoch: 14, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.831 Vali Acc: 0.744 Test Loss: 0.831 Test Acc: 0.744
Validation loss decreased (-0.727769 --> -0.744436).  Saving model ...
Epoch: 15 cost time: 0.9238781929016113
Epoch: 15, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.811 Vali Acc: 0.761 Test Loss: 0.811 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761103).  Saving model ...
Epoch: 16 cost time: 1.0103223323822021
Epoch: 16, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.804 Vali Acc: 0.772 Test Loss: 0.804 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772214).  Saving model ...
Epoch: 17 cost time: 0.9979414939880371
Epoch: 17, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.764 Vali Acc: 0.794 Test Loss: 0.764 Test Acc: 0.794
Validation loss decreased (-0.772214 --> -0.794437).  Saving model ...
Epoch: 18 cost time: 0.9751694202423096
Epoch: 18, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.776 Vali Acc: 0.783 Test Loss: 0.776 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9803893566131592
Epoch: 19, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.776 Vali Acc: 0.806 Test Loss: 0.776 Test Acc: 0.806
Validation loss decreased (-0.794437 --> -0.805548).  Saving model ...
Epoch: 20 cost time: 0.9531605243682861
Epoch: 20, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.778 Vali Acc: 0.800 Test Loss: 0.778 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9594850540161133
Epoch: 21, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.710 Vali Acc: 0.811 Test Loss: 0.710 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 22 cost time: 0.9562633037567139
Epoch: 22, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.776 Vali Acc: 0.811 Test Loss: 0.776 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8952586650848389
Epoch: 23, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.755 Vali Acc: 0.811 Test Loss: 0.755 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9492435455322266
Epoch: 24, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.788 Vali Acc: 0.811 Test Loss: 0.788 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8125131130218506
Epoch: 25, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.784 Vali Acc: 0.806 Test Loss: 0.784 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.873180627822876
Epoch: 26, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.825 Vali Acc: 0.822 Test Loss: 0.825 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822214).  Saving model ...
Epoch: 27 cost time: 0.8482441902160645
Epoch: 27, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.755 Vali Acc: 0.833 Test Loss: 0.755 Test Acc: 0.833
Validation loss decreased (-0.822214 --> -0.833326).  Saving model ...
Epoch: 28 cost time: 0.9403684139251709
Epoch: 28, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.828 Vali Acc: 0.850 Test Loss: 0.828 Test Acc: 0.850
Validation loss decreased (-0.833326 --> -0.849992).  Saving model ...
Epoch: 29 cost time: 0.8772397041320801
Epoch: 29, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.793 Vali Acc: 0.833 Test Loss: 0.793 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9115095138549805
Epoch: 30, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.822 Vali Acc: 0.844 Test Loss: 0.822 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9228541851043701
Epoch: 31, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.817 Vali Acc: 0.861 Test Loss: 0.817 Test Acc: 0.861
Validation loss decreased (-0.849992 --> -0.861103).  Saving model ...
Epoch: 32 cost time: 0.9699757099151611
Epoch: 32, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.874 Vali Acc: 0.844 Test Loss: 0.874 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9194188117980957
Epoch: 33, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.874 Vali Acc: 0.867 Test Loss: 0.874 Test Acc: 0.867
Validation loss decreased (-0.861103 --> -0.866658).  Saving model ...
Epoch: 34 cost time: 0.9083564281463623
Epoch: 34, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.850 Vali Acc: 0.828 Test Loss: 0.850 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9556746482849121
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.885 Vali Acc: 0.844 Test Loss: 0.885 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8895812034606934
Epoch: 36, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.910 Vali Acc: 0.861 Test Loss: 0.910 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9242045879364014
Epoch: 37, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.869 Vali Acc: 0.872 Test Loss: 0.869 Test Acc: 0.872
Validation loss decreased (-0.866658 --> -0.872214).  Saving model ...
Epoch: 38 cost time: 0.886552095413208
Epoch: 38, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.899 Vali Acc: 0.878 Test Loss: 0.899 Test Acc: 0.878
Validation loss decreased (-0.872214 --> -0.877769).  Saving model ...
Epoch: 39 cost time: 0.9421947002410889
Epoch: 39, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.957 Vali Acc: 0.856 Test Loss: 0.957 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8932967185974121
Epoch: 40, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.915 Vali Acc: 0.861 Test Loss: 0.915 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.943805456161499
Epoch: 41, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.888 Vali Acc: 0.867 Test Loss: 0.888 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9718708992004395
Epoch: 42, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.907 Vali Acc: 0.867 Test Loss: 0.907 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.9422328472137451
Epoch: 43, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.922 Vali Acc: 0.861 Test Loss: 0.922 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.9185225963592529
Epoch: 44, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.941 Vali Acc: 0.867 Test Loss: 0.941 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.9039442539215088
Epoch: 45, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.955 Vali Acc: 0.861 Test Loss: 0.955 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.967296838760376
Epoch: 46, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.971 Vali Acc: 0.850 Test Loss: 0.971 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.9380483627319336
Epoch: 47, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.963 Vali Acc: 0.850 Test Loss: 0.963 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.8810567855834961
Epoch: 48, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.982 Vali Acc: 0.850 Test Loss: 0.982 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 139119
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2621612548828125
Epoch: 1, Steps: 12 | Train Loss: 2.727 Vali Loss: 2.689 Vali Acc: 0.072 Test Loss: 2.689 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 0.918947696685791
Epoch: 2, Steps: 12 | Train Loss: 2.668 Vali Loss: 2.621 Vali Acc: 0.172 Test Loss: 2.621 Test Acc: 0.172
Validation loss decreased (-0.072195 --> -0.172196).  Saving model ...
Epoch: 3 cost time: 0.9798805713653564
Epoch: 3, Steps: 12 | Train Loss: 2.540 Vali Loss: 2.514 Vali Acc: 0.317 Test Loss: 2.514 Test Acc: 0.317
Validation loss decreased (-0.172196 --> -0.316642).  Saving model ...
Epoch: 4 cost time: 0.9915108680725098
Epoch: 4, Steps: 12 | Train Loss: 2.417 Vali Loss: 2.361 Vali Acc: 0.422 Test Loss: 2.361 Test Acc: 0.422
Validation loss decreased (-0.316642 --> -0.422199).  Saving model ...
Epoch: 5 cost time: 0.9443600177764893
Epoch: 5, Steps: 12 | Train Loss: 2.220 Vali Loss: 2.185 Vali Acc: 0.517 Test Loss: 2.185 Test Acc: 0.517
Validation loss decreased (-0.422199 --> -0.516645).  Saving model ...
Epoch: 6 cost time: 0.8627016544342041
Epoch: 6, Steps: 12 | Train Loss: 2.015 Vali Loss: 1.977 Vali Acc: 0.528 Test Loss: 1.977 Test Acc: 0.528
Validation loss decreased (-0.516645 --> -0.527758).  Saving model ...
Epoch: 7 cost time: 0.8670380115509033
Epoch: 7, Steps: 12 | Train Loss: 1.772 Vali Loss: 1.786 Vali Acc: 0.583 Test Loss: 1.786 Test Acc: 0.583
Validation loss decreased (-0.527758 --> -0.583315).  Saving model ...
Epoch: 8 cost time: 0.8494999408721924
Epoch: 8, Steps: 12 | Train Loss: 1.564 Vali Loss: 1.597 Vali Acc: 0.600 Test Loss: 1.597 Test Acc: 0.600
Validation loss decreased (-0.583315 --> -0.599984).  Saving model ...
Epoch: 9 cost time: 0.7909731864929199
Epoch: 9, Steps: 12 | Train Loss: 1.329 Vali Loss: 1.455 Vali Acc: 0.656 Test Loss: 1.455 Test Acc: 0.656
Validation loss decreased (-0.599984 --> -0.655541).  Saving model ...
Epoch: 10 cost time: 0.839442253112793
Epoch: 10, Steps: 12 | Train Loss: 1.157 Vali Loss: 1.318 Vali Acc: 0.628 Test Loss: 1.318 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.826561689376831
Epoch: 11, Steps: 12 | Train Loss: 1.067 Vali Loss: 1.205 Vali Acc: 0.656 Test Loss: 1.205 Test Acc: 0.656
Validation loss decreased (-0.655541 --> -0.655544).  Saving model ...
Epoch: 12 cost time: 0.8767516613006592
Epoch: 12, Steps: 12 | Train Loss: 0.868 Vali Loss: 1.119 Vali Acc: 0.672 Test Loss: 1.119 Test Acc: 0.672
Validation loss decreased (-0.655544 --> -0.672211).  Saving model ...
Epoch: 13 cost time: 0.8224785327911377
Epoch: 13, Steps: 12 | Train Loss: 0.724 Vali Loss: 1.044 Vali Acc: 0.678 Test Loss: 1.044 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677767).  Saving model ...
Epoch: 14 cost time: 0.9243593215942383
Epoch: 14, Steps: 12 | Train Loss: 0.693 Vali Loss: 0.986 Vali Acc: 0.694 Test Loss: 0.986 Test Acc: 0.694
Validation loss decreased (-0.677767 --> -0.694435).  Saving model ...
Epoch: 15 cost time: 0.821465253829956
Epoch: 15, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.938 Vali Acc: 0.694 Test Loss: 0.938 Test Acc: 0.694
Validation loss decreased (-0.694435 --> -0.694435).  Saving model ...
Epoch: 16 cost time: 0.9070556163787842
Epoch: 16, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.921 Vali Acc: 0.733 Test Loss: 0.921 Test Acc: 0.733
Validation loss decreased (-0.694435 --> -0.733324).  Saving model ...
Epoch: 17 cost time: 0.8912129402160645
Epoch: 17, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.865 Vali Acc: 0.711 Test Loss: 0.865 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8873374462127686
Epoch: 18, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.820 Vali Acc: 0.744 Test Loss: 0.820 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744436).  Saving model ...
Epoch: 19 cost time: 0.9576091766357422
Epoch: 19, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.790 Vali Acc: 0.744 Test Loss: 0.790 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744437).  Saving model ...
Epoch: 20 cost time: 0.9510612487792969
Epoch: 20, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.765 Vali Acc: 0.772 Test Loss: 0.765 Test Acc: 0.772
Validation loss decreased (-0.744437 --> -0.772215).  Saving model ...
Epoch: 21 cost time: 0.902357816696167
Epoch: 21, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.755 Vali Acc: 0.783 Test Loss: 0.755 Test Acc: 0.783
Validation loss decreased (-0.772215 --> -0.783326).  Saving model ...
Epoch: 22 cost time: 0.9070699214935303
Epoch: 22, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.697 Vali Acc: 0.800 Test Loss: 0.697 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799993).  Saving model ...
Epoch: 23 cost time: 0.808840274810791
Epoch: 23, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.665 Vali Acc: 0.811 Test Loss: 0.665 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 24 cost time: 0.8426430225372314
Epoch: 24, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.682 Vali Acc: 0.828 Test Loss: 0.682 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 25 cost time: 0.8698053359985352
Epoch: 25, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.658 Vali Acc: 0.811 Test Loss: 0.658 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8678083419799805
Epoch: 26, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.653 Vali Acc: 0.844 Test Loss: 0.653 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 27 cost time: 0.8609976768493652
Epoch: 27, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.630 Vali Acc: 0.844 Test Loss: 0.630 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 28 cost time: 0.8457474708557129
Epoch: 28, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.627 Vali Acc: 0.828 Test Loss: 0.627 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8562657833099365
Epoch: 29, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.633 Vali Acc: 0.833 Test Loss: 0.633 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.858668327331543
Epoch: 30, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.631 Vali Acc: 0.833 Test Loss: 0.631 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8615567684173584
Epoch: 31, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.623 Vali Acc: 0.856 Test Loss: 0.623 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 32 cost time: 0.9547464847564697
Epoch: 32, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.618 Vali Acc: 0.839 Test Loss: 0.618 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8846724033355713
Epoch: 33, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.646 Vali Acc: 0.850 Test Loss: 0.646 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8559086322784424
Epoch: 34, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.620 Vali Acc: 0.844 Test Loss: 0.620 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9320271015167236
Epoch: 35, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.660 Vali Acc: 0.856 Test Loss: 0.660 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.945267915725708
Epoch: 36, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.637 Vali Acc: 0.850 Test Loss: 0.637 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8820888996124268
Epoch: 37, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.663 Vali Acc: 0.844 Test Loss: 0.663 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.8849101066589355
Epoch: 38, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.658 Vali Acc: 0.850 Test Loss: 0.658 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.8700623512268066
Epoch: 39, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.657 Vali Acc: 0.850 Test Loss: 0.657 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.8591513633728027
Epoch: 40, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.674 Vali Acc: 0.861 Test Loss: 0.674 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861104).  Saving model ...
Epoch: 41 cost time: 0.8909749984741211
Epoch: 41, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.709 Vali Acc: 0.850 Test Loss: 0.709 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8610579967498779
Epoch: 42, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.745 Vali Acc: 0.833 Test Loss: 0.745 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8586180210113525
Epoch: 43, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.710 Vali Acc: 0.844 Test Loss: 0.710 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.865156888961792
Epoch: 44, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.725 Vali Acc: 0.856 Test Loss: 0.725 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7749645709991455
Epoch: 45, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.717 Vali Acc: 0.867 Test Loss: 0.717 Test Acc: 0.867
Validation loss decreased (-0.861104 --> -0.866659).  Saving model ...
Epoch: 46 cost time: 0.8238053321838379
Epoch: 46, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.691 Vali Acc: 0.856 Test Loss: 0.691 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8950302600860596
Epoch: 47, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.726 Vali Acc: 0.844 Test Loss: 0.726 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8919892311096191
Epoch: 48, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.744 Vali Acc: 0.844 Test Loss: 0.744 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.8414995670318604
Epoch: 49, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.733 Vali Acc: 0.856 Test Loss: 0.733 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.874739408493042
Epoch: 50, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.709 Vali Acc: 0.844 Test Loss: 0.709 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 116111
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0339481830596924
Epoch: 1, Steps: 12 | Train Loss: 2.692 Vali Loss: 2.634 Vali Acc: 0.139 Test Loss: 2.634 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 0.8300514221191406
Epoch: 2, Steps: 12 | Train Loss: 2.613 Vali Loss: 2.545 Vali Acc: 0.217 Test Loss: 2.545 Test Acc: 0.217
Validation loss decreased (-0.138863 --> -0.216641).  Saving model ...
Epoch: 3 cost time: 0.8267397880554199
Epoch: 3, Steps: 12 | Train Loss: 2.478 Vali Loss: 2.416 Vali Acc: 0.389 Test Loss: 2.416 Test Acc: 0.389
Validation loss decreased (-0.216641 --> -0.388865).  Saving model ...
Epoch: 4 cost time: 0.8264682292938232
Epoch: 4, Steps: 12 | Train Loss: 2.313 Vali Loss: 2.243 Vali Acc: 0.450 Test Loss: 2.243 Test Acc: 0.450
Validation loss decreased (-0.388865 --> -0.449978).  Saving model ...
Epoch: 5 cost time: 0.725813627243042
Epoch: 5, Steps: 12 | Train Loss: 2.081 Vali Loss: 2.059 Vali Acc: 0.494 Test Loss: 2.059 Test Acc: 0.494
Validation loss decreased (-0.449978 --> -0.494424).  Saving model ...
Epoch: 6 cost time: 0.8487744331359863
Epoch: 6, Steps: 12 | Train Loss: 1.847 Vali Loss: 1.849 Vali Acc: 0.583 Test Loss: 1.849 Test Acc: 0.583
Validation loss decreased (-0.494424 --> -0.583315).  Saving model ...
Epoch: 7 cost time: 0.8263146877288818
Epoch: 7, Steps: 12 | Train Loss: 1.634 Vali Loss: 1.651 Vali Acc: 0.589 Test Loss: 1.651 Test Acc: 0.589
Validation loss decreased (-0.583315 --> -0.588872).  Saving model ...
Epoch: 8 cost time: 0.9095969200134277
Epoch: 8, Steps: 12 | Train Loss: 1.404 Vali Loss: 1.480 Vali Acc: 0.617 Test Loss: 1.480 Test Acc: 0.617
Validation loss decreased (-0.588872 --> -0.616652).  Saving model ...
Epoch: 9 cost time: 0.9897000789642334
Epoch: 9, Steps: 12 | Train Loss: 1.187 Vali Loss: 1.349 Vali Acc: 0.644 Test Loss: 1.349 Test Acc: 0.644
Validation loss decreased (-0.616652 --> -0.644431).  Saving model ...
Epoch: 10 cost time: 0.9426319599151611
Epoch: 10, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.246 Vali Acc: 0.656 Test Loss: 1.246 Test Acc: 0.656
Validation loss decreased (-0.644431 --> -0.655543).  Saving model ...
Epoch: 11 cost time: 0.9810678958892822
Epoch: 11, Steps: 12 | Train Loss: 0.897 Vali Loss: 1.162 Vali Acc: 0.678 Test Loss: 1.162 Test Acc: 0.678
Validation loss decreased (-0.655543 --> -0.677766).  Saving model ...
Epoch: 12 cost time: 0.8991434574127197
Epoch: 12, Steps: 12 | Train Loss: 0.823 Vali Loss: 1.112 Vali Acc: 0.678 Test Loss: 1.112 Test Acc: 0.678
Validation loss decreased (-0.677766 --> -0.677767).  Saving model ...
Epoch: 13 cost time: 0.9055576324462891
Epoch: 13, Steps: 12 | Train Loss: 0.741 Vali Loss: 1.036 Vali Acc: 0.683 Test Loss: 1.036 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683323).  Saving model ...
Epoch: 14 cost time: 0.8431909084320068
Epoch: 14, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.988 Vali Acc: 0.683 Test Loss: 0.988 Test Acc: 0.683
Validation loss decreased (-0.683323 --> -0.683323).  Saving model ...
Epoch: 15 cost time: 0.8265011310577393
Epoch: 15, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.957 Vali Acc: 0.689 Test Loss: 0.957 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688879).  Saving model ...
Epoch: 16 cost time: 0.8752093315124512
Epoch: 16, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.918 Vali Acc: 0.689 Test Loss: 0.918 Test Acc: 0.689
Validation loss decreased (-0.688879 --> -0.688880).  Saving model ...
Epoch: 17 cost time: 0.8084511756896973
Epoch: 17, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.885 Vali Acc: 0.694 Test Loss: 0.885 Test Acc: 0.694
Validation loss decreased (-0.688880 --> -0.694436).  Saving model ...
Epoch: 18 cost time: 0.9107136726379395
Epoch: 18, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.839 Vali Acc: 0.728 Test Loss: 0.839 Test Acc: 0.728
Validation loss decreased (-0.694436 --> -0.727769).  Saving model ...
Epoch: 19 cost time: 0.8208281993865967
Epoch: 19, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.814 Vali Acc: 0.717 Test Loss: 0.814 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7029359340667725
Epoch: 20, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.806 Vali Acc: 0.744 Test Loss: 0.806 Test Acc: 0.744
Validation loss decreased (-0.727769 --> -0.744436).  Saving model ...
Epoch: 21 cost time: 0.7893016338348389
Epoch: 21, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.767 Vali Acc: 0.772 Test Loss: 0.767 Test Acc: 0.772
Validation loss decreased (-0.744436 --> -0.772215).  Saving model ...
Epoch: 22 cost time: 0.8482339382171631
Epoch: 22, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.746 Vali Acc: 0.794 Test Loss: 0.746 Test Acc: 0.794
Validation loss decreased (-0.772215 --> -0.794437).  Saving model ...
Epoch: 23 cost time: 0.799999475479126
Epoch: 23, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.737 Vali Acc: 0.778 Test Loss: 0.737 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7819197177886963
Epoch: 24, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.711 Vali Acc: 0.817 Test Loss: 0.711 Test Acc: 0.817
Validation loss decreased (-0.794437 --> -0.816660).  Saving model ...
Epoch: 25 cost time: 0.8002402782440186
Epoch: 25, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.691 Vali Acc: 0.811 Test Loss: 0.691 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7741396427154541
Epoch: 26, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.681 Vali Acc: 0.833 Test Loss: 0.681 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 27 cost time: 0.7823266983032227
Epoch: 27, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.672 Vali Acc: 0.828 Test Loss: 0.672 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.963301420211792
Epoch: 28, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.675 Vali Acc: 0.822 Test Loss: 0.675 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9443895816802979
Epoch: 29, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.696 Vali Acc: 0.839 Test Loss: 0.696 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838882).  Saving model ...
Epoch: 30 cost time: 0.861234188079834
Epoch: 30, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.664 Vali Acc: 0.844 Test Loss: 0.664 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 31 cost time: 0.9642722606658936
Epoch: 31, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.686 Vali Acc: 0.822 Test Loss: 0.686 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.866499662399292
Epoch: 32, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.679 Vali Acc: 0.833 Test Loss: 0.679 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9274506568908691
Epoch: 33, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.691 Vali Acc: 0.822 Test Loss: 0.691 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9964051246643066
Epoch: 34, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.715 Vali Acc: 0.844 Test Loss: 0.715 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0432043075561523
Epoch: 35, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.684 Vali Acc: 0.828 Test Loss: 0.684 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9159111976623535
Epoch: 36, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.685 Vali Acc: 0.844 Test Loss: 0.685 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8610599040985107
Epoch: 37, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.734 Vali Acc: 0.822 Test Loss: 0.734 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8903295993804932
Epoch: 38, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.750 Vali Acc: 0.850 Test Loss: 0.750 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849993).  Saving model ...
Epoch: 39 cost time: 0.9186806678771973
Epoch: 39, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.768 Vali Acc: 0.844 Test Loss: 0.768 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.921436071395874
Epoch: 40, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.761 Vali Acc: 0.844 Test Loss: 0.761 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9197206497192383
Epoch: 41, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.756 Vali Acc: 0.839 Test Loss: 0.756 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9798498153686523
Epoch: 42, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.766 Vali Acc: 0.856 Test Loss: 0.766 Test Acc: 0.856
Validation loss decreased (-0.849993 --> -0.855548).  Saving model ...
Epoch: 43 cost time: 0.9721004962921143
Epoch: 43, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.768 Vali Acc: 0.850 Test Loss: 0.768 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9278049468994141
Epoch: 44, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.783 Vali Acc: 0.839 Test Loss: 0.783 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0252258777618408
Epoch: 45, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.786 Vali Acc: 0.850 Test Loss: 0.786 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.009429931640625
Epoch: 46, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.791 Vali Acc: 0.850 Test Loss: 0.791 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.9543440341949463
Epoch: 47, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.800 Vali Acc: 0.833 Test Loss: 0.800 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.9267985820770264
Epoch: 48, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.804 Vali Acc: 0.850 Test Loss: 0.804 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.8741257190704346
Epoch: 49, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.823 Vali Acc: 0.850 Test Loss: 0.823 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.8919737339019775
Epoch: 50, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.830 Vali Acc: 0.839 Test Loss: 0.830 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 116143
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2636466026306152
Epoch: 1, Steps: 12 | Train Loss: 2.683 Vali Loss: 2.707 Vali Acc: 0.133 Test Loss: 2.707 Test Acc: 0.133
Validation loss decreased (inf --> -0.133306).  Saving model ...
Epoch: 2 cost time: 0.867872953414917
Epoch: 2, Steps: 12 | Train Loss: 2.650 Vali Loss: 2.646 Vali Acc: 0.206 Test Loss: 2.646 Test Acc: 0.206
Validation loss decreased (-0.133306 --> -0.205529).  Saving model ...
Epoch: 3 cost time: 0.9614324569702148
Epoch: 3, Steps: 12 | Train Loss: 2.551 Vali Loss: 2.550 Vali Acc: 0.261 Test Loss: 2.550 Test Acc: 0.261
Validation loss decreased (-0.205529 --> -0.261086).  Saving model ...
Epoch: 4 cost time: 0.9335992336273193
Epoch: 4, Steps: 12 | Train Loss: 2.438 Vali Loss: 2.425 Vali Acc: 0.339 Test Loss: 2.425 Test Acc: 0.339
Validation loss decreased (-0.261086 --> -0.338865).  Saving model ...
Epoch: 5 cost time: 0.928661584854126
Epoch: 5, Steps: 12 | Train Loss: 2.301 Vali Loss: 2.285 Vali Acc: 0.411 Test Loss: 2.285 Test Acc: 0.411
Validation loss decreased (-0.338865 --> -0.411088).  Saving model ...
Epoch: 6 cost time: 0.9503495693206787
Epoch: 6, Steps: 12 | Train Loss: 2.104 Vali Loss: 2.105 Vali Acc: 0.478 Test Loss: 2.105 Test Acc: 0.478
Validation loss decreased (-0.411088 --> -0.477757).  Saving model ...
Epoch: 7 cost time: 0.9069924354553223
Epoch: 7, Steps: 12 | Train Loss: 1.912 Vali Loss: 1.924 Vali Acc: 0.539 Test Loss: 1.924 Test Acc: 0.539
Validation loss decreased (-0.477757 --> -0.538870).  Saving model ...
Epoch: 8 cost time: 0.900076150894165
Epoch: 8, Steps: 12 | Train Loss: 1.669 Vali Loss: 1.725 Vali Acc: 0.578 Test Loss: 1.725 Test Acc: 0.578
Validation loss decreased (-0.538870 --> -0.577761).  Saving model ...
Epoch: 9 cost time: 0.8863680362701416
Epoch: 9, Steps: 12 | Train Loss: 1.478 Vali Loss: 1.554 Vali Acc: 0.611 Test Loss: 1.554 Test Acc: 0.611
Validation loss decreased (-0.577761 --> -0.611096).  Saving model ...
Epoch: 10 cost time: 0.9173390865325928
Epoch: 10, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.397 Vali Acc: 0.633 Test Loss: 1.397 Test Acc: 0.633
Validation loss decreased (-0.611096 --> -0.633319).  Saving model ...
Epoch: 11 cost time: 0.9457981586456299
Epoch: 11, Steps: 12 | Train Loss: 1.152 Vali Loss: 1.279 Vali Acc: 0.650 Test Loss: 1.279 Test Acc: 0.650
Validation loss decreased (-0.633319 --> -0.649987).  Saving model ...
Epoch: 12 cost time: 0.8852560520172119
Epoch: 12, Steps: 12 | Train Loss: 1.024 Vali Loss: 1.186 Vali Acc: 0.667 Test Loss: 1.186 Test Acc: 0.667
Validation loss decreased (-0.649987 --> -0.666655).  Saving model ...
Epoch: 13 cost time: 0.9066088199615479
Epoch: 13, Steps: 12 | Train Loss: 0.883 Vali Loss: 1.098 Vali Acc: 0.683 Test Loss: 1.098 Test Acc: 0.683
Validation loss decreased (-0.666655 --> -0.683322).  Saving model ...
Epoch: 14 cost time: 0.8786251544952393
Epoch: 14, Steps: 12 | Train Loss: 0.799 Vali Loss: 1.033 Vali Acc: 0.700 Test Loss: 1.033 Test Acc: 0.700
Validation loss decreased (-0.683322 --> -0.699990).  Saving model ...
Epoch: 15 cost time: 0.8553626537322998
Epoch: 15, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.959 Vali Acc: 0.728 Test Loss: 0.959 Test Acc: 0.728
Validation loss decreased (-0.699990 --> -0.727768).  Saving model ...
Epoch: 16 cost time: 0.8293890953063965
Epoch: 16, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.900 Vali Acc: 0.733 Test Loss: 0.900 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733324).  Saving model ...
Epoch: 17 cost time: 0.8749039173126221
Epoch: 17, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.853 Vali Acc: 0.750 Test Loss: 0.853 Test Acc: 0.750
Validation loss decreased (-0.733324 --> -0.749991).  Saving model ...
Epoch: 18 cost time: 0.8399679660797119
Epoch: 18, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.830 Vali Acc: 0.750 Test Loss: 0.830 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 19 cost time: 0.8427877426147461
Epoch: 19, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.780 Vali Acc: 0.767 Test Loss: 0.780 Test Acc: 0.767
Validation loss decreased (-0.749992 --> -0.766659).  Saving model ...
Epoch: 20 cost time: 0.8959262371063232
Epoch: 20, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.767 Vali Acc: 0.800 Test Loss: 0.767 Test Acc: 0.800
Validation loss decreased (-0.766659 --> -0.799992).  Saving model ...
Epoch: 21 cost time: 0.842627763748169
Epoch: 21, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.737 Vali Acc: 0.789 Test Loss: 0.737 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9731862545013428
Epoch: 22, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.708 Vali Acc: 0.817 Test Loss: 0.708 Test Acc: 0.817
Validation loss decreased (-0.799992 --> -0.816660).  Saving model ...
Epoch: 23 cost time: 0.8519623279571533
Epoch: 23, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.678 Vali Acc: 0.822 Test Loss: 0.678 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822215).  Saving model ...
Epoch: 24 cost time: 0.9070565700531006
Epoch: 24, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.665 Vali Acc: 0.806 Test Loss: 0.665 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8988704681396484
Epoch: 25, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.650 Vali Acc: 0.828 Test Loss: 0.650 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 26 cost time: 0.9607415199279785
Epoch: 26, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.634 Vali Acc: 0.828 Test Loss: 0.634 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 27 cost time: 0.9599735736846924
Epoch: 27, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.604 Vali Acc: 0.844 Test Loss: 0.604 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 28 cost time: 0.9093587398529053
Epoch: 28, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.601 Vali Acc: 0.844 Test Loss: 0.601 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 29 cost time: 1.0441677570343018
Epoch: 29, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.607 Vali Acc: 0.844 Test Loss: 0.607 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8375937938690186
Epoch: 30, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 31 cost time: 0.8571503162384033
Epoch: 31, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.591 Vali Acc: 0.856 Test Loss: 0.591 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 32 cost time: 0.856238603591919
Epoch: 32, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.865032434463501
Epoch: 33, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.612 Vali Acc: 0.861 Test Loss: 0.612 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 34 cost time: 0.8476202487945557
Epoch: 34, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.595 Vali Acc: 0.861 Test Loss: 0.595 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 35 cost time: 0.8220703601837158
Epoch: 35, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.601 Vali Acc: 0.861 Test Loss: 0.601 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.89841628074646
Epoch: 36, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.603 Vali Acc: 0.872 Test Loss: 0.603 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 37 cost time: 0.9183452129364014
Epoch: 37, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.613 Vali Acc: 0.878 Test Loss: 0.613 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 38 cost time: 1.021115779876709
Epoch: 38, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.623 Vali Acc: 0.867 Test Loss: 0.623 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9391679763793945
Epoch: 39, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.620 Vali Acc: 0.872 Test Loss: 0.620 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8531219959259033
Epoch: 40, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.626 Vali Acc: 0.867 Test Loss: 0.626 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8825943470001221
Epoch: 41, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.627 Vali Acc: 0.867 Test Loss: 0.627 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9303948879241943
Epoch: 42, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.614 Vali Acc: 0.867 Test Loss: 0.614 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8480222225189209
Epoch: 43, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.629 Vali Acc: 0.867 Test Loss: 0.629 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8660621643066406
Epoch: 44, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.648 Vali Acc: 0.872 Test Loss: 0.648 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.8707726001739502
Epoch: 45, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.662 Vali Acc: 0.878 Test Loss: 0.662 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.880859375
Epoch: 46, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.645 Vali Acc: 0.889 Test Loss: 0.645 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888882).  Saving model ...
Epoch: 47 cost time: 0.9934494495391846
Epoch: 47, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.638 Vali Acc: 0.889 Test Loss: 0.638 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888883).  Saving model ...
Epoch: 48 cost time: 0.8771226406097412
Epoch: 48, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.638 Vali Acc: 0.872 Test Loss: 0.638 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8622400760650635
Epoch: 49, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.655 Vali Acc: 0.872 Test Loss: 0.655 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.8608636856079102
Epoch: 50, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.692 Vali Acc: 0.867 Test Loss: 0.692 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 110415
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2718749046325684
Epoch: 1, Steps: 12 | Train Loss: 2.796 Vali Loss: 2.740 Vali Acc: 0.039 Test Loss: 2.740 Test Acc: 0.039
Validation loss decreased (inf --> -0.038861).  Saving model ...
Epoch: 2 cost time: 0.8858749866485596
Epoch: 2, Steps: 12 | Train Loss: 2.744 Vali Loss: 2.700 Vali Acc: 0.056 Test Loss: 2.700 Test Acc: 0.056
Validation loss decreased (-0.038861 --> -0.055529).  Saving model ...
Epoch: 3 cost time: 0.8920028209686279
Epoch: 3, Steps: 12 | Train Loss: 2.655 Vali Loss: 2.627 Vali Acc: 0.144 Test Loss: 2.627 Test Acc: 0.144
Validation loss decreased (-0.055529 --> -0.144418).  Saving model ...
Epoch: 4 cost time: 0.9067680835723877
Epoch: 4, Steps: 12 | Train Loss: 2.560 Vali Loss: 2.522 Vali Acc: 0.322 Test Loss: 2.522 Test Acc: 0.322
Validation loss decreased (-0.144418 --> -0.322197).  Saving model ...
Epoch: 5 cost time: 1.0179228782653809
Epoch: 5, Steps: 12 | Train Loss: 2.447 Vali Loss: 2.403 Vali Acc: 0.389 Test Loss: 2.403 Test Acc: 0.389
Validation loss decreased (-0.322197 --> -0.388865).  Saving model ...
Epoch: 6 cost time: 0.9731104373931885
Epoch: 6, Steps: 12 | Train Loss: 2.308 Vali Loss: 2.260 Vali Acc: 0.456 Test Loss: 2.260 Test Acc: 0.456
Validation loss decreased (-0.388865 --> -0.455533).  Saving model ...
Epoch: 7 cost time: 0.9240083694458008
Epoch: 7, Steps: 12 | Train Loss: 2.130 Vali Loss: 2.107 Vali Acc: 0.511 Test Loss: 2.107 Test Acc: 0.511
Validation loss decreased (-0.455533 --> -0.511090).  Saving model ...
Epoch: 8 cost time: 0.9165980815887451
Epoch: 8, Steps: 12 | Train Loss: 1.957 Vali Loss: 1.925 Vali Acc: 0.556 Test Loss: 1.925 Test Acc: 0.556
Validation loss decreased (-0.511090 --> -0.555536).  Saving model ...
Epoch: 9 cost time: 0.750931978225708
Epoch: 9, Steps: 12 | Train Loss: 1.713 Vali Loss: 1.739 Vali Acc: 0.583 Test Loss: 1.739 Test Acc: 0.583
Validation loss decreased (-0.555536 --> -0.583316).  Saving model ...
Epoch: 10 cost time: 0.8478691577911377
Epoch: 10, Steps: 12 | Train Loss: 1.529 Vali Loss: 1.582 Vali Acc: 0.606 Test Loss: 1.582 Test Acc: 0.606
Validation loss decreased (-0.583316 --> -0.605540).  Saving model ...
Epoch: 11 cost time: 0.8436787128448486
Epoch: 11, Steps: 12 | Train Loss: 1.366 Vali Loss: 1.425 Vali Acc: 0.639 Test Loss: 1.425 Test Acc: 0.639
Validation loss decreased (-0.605540 --> -0.638875).  Saving model ...
Epoch: 12 cost time: 0.8296539783477783
Epoch: 12, Steps: 12 | Train Loss: 1.211 Vali Loss: 1.305 Vali Acc: 0.639 Test Loss: 1.305 Test Acc: 0.639
Validation loss decreased (-0.638875 --> -0.638876).  Saving model ...
Epoch: 13 cost time: 0.8385434150695801
Epoch: 13, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.209 Vali Acc: 0.672 Test Loss: 1.209 Test Acc: 0.672
Validation loss decreased (-0.638876 --> -0.672210).  Saving model ...
Epoch: 14 cost time: 0.8608791828155518
Epoch: 14, Steps: 12 | Train Loss: 0.963 Vali Loss: 1.124 Vali Acc: 0.678 Test Loss: 1.124 Test Acc: 0.678
Validation loss decreased (-0.672210 --> -0.677767).  Saving model ...
Epoch: 15 cost time: 0.8842418193817139
Epoch: 15, Steps: 12 | Train Loss: 0.833 Vali Loss: 1.054 Vali Acc: 0.700 Test Loss: 1.054 Test Acc: 0.700
Validation loss decreased (-0.677767 --> -0.699989).  Saving model ...
Epoch: 16 cost time: 0.8261942863464355
Epoch: 16, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.990 Vali Acc: 0.689 Test Loss: 0.990 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.936377763748169
Epoch: 17, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.942 Vali Acc: 0.700 Test Loss: 0.942 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699991).  Saving model ...
Epoch: 18 cost time: 0.9640884399414062
Epoch: 18, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.924 Vali Acc: 0.700 Test Loss: 0.924 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 19 cost time: 0.983994722366333
Epoch: 19, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.872 Vali Acc: 0.728 Test Loss: 0.872 Test Acc: 0.728
Validation loss decreased (-0.699991 --> -0.727769).  Saving model ...
Epoch: 20 cost time: 0.9056005477905273
Epoch: 20, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.829 Vali Acc: 0.744 Test Loss: 0.829 Test Acc: 0.744
Validation loss decreased (-0.727769 --> -0.744436).  Saving model ...
Epoch: 21 cost time: 0.9134650230407715
Epoch: 21, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.806 Vali Acc: 0.761 Test Loss: 0.806 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761103).  Saving model ...
Epoch: 22 cost time: 0.9134256839752197
Epoch: 22, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.778 Vali Acc: 0.778 Test Loss: 0.778 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777770).  Saving model ...
Epoch: 23 cost time: 0.9365427494049072
Epoch: 23, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.734 Vali Acc: 0.789 Test Loss: 0.734 Test Acc: 0.789
Validation loss decreased (-0.777770 --> -0.788882).  Saving model ...
Epoch: 24 cost time: 0.9459152221679688
Epoch: 24, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.723 Vali Acc: 0.806 Test Loss: 0.723 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805548).  Saving model ...
Epoch: 25 cost time: 0.9043331146240234
Epoch: 25, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.707 Vali Acc: 0.800 Test Loss: 0.707 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9415004253387451
Epoch: 26, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.698 Vali Acc: 0.789 Test Loss: 0.698 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9441118240356445
Epoch: 27, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.674 Vali Acc: 0.806 Test Loss: 0.674 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805549).  Saving model ...
Epoch: 28 cost time: 0.8679840564727783
Epoch: 28, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.669 Vali Acc: 0.817 Test Loss: 0.669 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816660).  Saving model ...
Epoch: 29 cost time: 0.9421336650848389
Epoch: 29, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.668 Vali Acc: 0.839 Test Loss: 0.668 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838882).  Saving model ...
Epoch: 30 cost time: 0.8458127975463867
Epoch: 30, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.652 Vali Acc: 0.833 Test Loss: 0.652 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8691260814666748
Epoch: 31, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.667 Vali Acc: 0.839 Test Loss: 0.667 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838882).  Saving model ...
Epoch: 32 cost time: 0.8275482654571533
Epoch: 32, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.657 Vali Acc: 0.828 Test Loss: 0.657 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8794946670532227
Epoch: 33, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.642 Vali Acc: 0.828 Test Loss: 0.642 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.956810712814331
Epoch: 34, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.623 Vali Acc: 0.828 Test Loss: 0.623 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9058177471160889
Epoch: 35, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.675 Vali Acc: 0.822 Test Loss: 0.675 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8637523651123047
Epoch: 36, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.664 Vali Acc: 0.822 Test Loss: 0.664 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9003434181213379
Epoch: 37, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.675 Vali Acc: 0.833 Test Loss: 0.675 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9630270004272461
Epoch: 38, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.684 Vali Acc: 0.833 Test Loss: 0.684 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.8659045696258545
Epoch: 39, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.664 Vali Acc: 0.850 Test Loss: 0.664 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849993).  Saving model ...
Epoch: 40 cost time: 0.9367825984954834
Epoch: 40, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.647 Vali Acc: 0.839 Test Loss: 0.647 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0900378227233887
Epoch: 41, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.675 Vali Acc: 0.839 Test Loss: 0.675 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0267531871795654
Epoch: 42, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.700 Vali Acc: 0.844 Test Loss: 0.700 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9572515487670898
Epoch: 43, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.680 Vali Acc: 0.839 Test Loss: 0.680 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8834366798400879
Epoch: 44, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.702 Vali Acc: 0.839 Test Loss: 0.702 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8317830562591553
Epoch: 45, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.697 Vali Acc: 0.856 Test Loss: 0.697 Test Acc: 0.856
Validation loss decreased (-0.849993 --> -0.855549).  Saving model ...
Epoch: 46 cost time: 0.8608558177947998
Epoch: 46, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.739 Vali Acc: 0.839 Test Loss: 0.739 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8687009811401367
Epoch: 47, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.740 Vali Acc: 0.833 Test Loss: 0.740 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8435931205749512
Epoch: 48, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.710 Vali Acc: 0.856 Test Loss: 0.710 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.8572037220001221
Epoch: 49, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.698 Vali Acc: 0.850 Test Loss: 0.698 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.8697845935821533
Epoch: 50, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.716 Vali Acc: 0.850 Test Loss: 0.716 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 106639
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2353856563568115
Epoch: 1, Steps: 12 | Train Loss: 2.768 Vali Loss: 2.740 Vali Acc: 0.033 Test Loss: 2.740 Test Acc: 0.033
Validation loss decreased (inf --> -0.033306).  Saving model ...
Epoch: 2 cost time: 1.0001544952392578
Epoch: 2, Steps: 12 | Train Loss: 2.720 Vali Loss: 2.708 Vali Acc: 0.044 Test Loss: 2.708 Test Acc: 0.044
Validation loss decreased (-0.033306 --> -0.044417).  Saving model ...
Epoch: 3 cost time: 0.9677107334136963
Epoch: 3, Steps: 12 | Train Loss: 2.629 Vali Loss: 2.642 Vali Acc: 0.089 Test Loss: 2.642 Test Acc: 0.089
Validation loss decreased (-0.044417 --> -0.088862).  Saving model ...
Epoch: 4 cost time: 0.9246079921722412
Epoch: 4, Steps: 12 | Train Loss: 2.547 Vali Loss: 2.557 Vali Acc: 0.239 Test Loss: 2.557 Test Acc: 0.239
Validation loss decreased (-0.088862 --> -0.238863).  Saving model ...
Epoch: 5 cost time: 0.9480364322662354
Epoch: 5, Steps: 12 | Train Loss: 2.448 Vali Loss: 2.452 Vali Acc: 0.350 Test Loss: 2.452 Test Acc: 0.350
Validation loss decreased (-0.238863 --> -0.349975).  Saving model ...
Epoch: 6 cost time: 0.8813130855560303
Epoch: 6, Steps: 12 | Train Loss: 2.323 Vali Loss: 2.341 Vali Acc: 0.383 Test Loss: 2.341 Test Acc: 0.383
Validation loss decreased (-0.349975 --> -0.383310).  Saving model ...
Epoch: 7 cost time: 0.8265395164489746
Epoch: 7, Steps: 12 | Train Loss: 2.167 Vali Loss: 2.205 Vali Acc: 0.422 Test Loss: 2.205 Test Acc: 0.422
Validation loss decreased (-0.383310 --> -0.422200).  Saving model ...
Epoch: 8 cost time: 0.8806736469268799
Epoch: 8, Steps: 12 | Train Loss: 2.068 Vali Loss: 2.042 Vali Acc: 0.489 Test Loss: 2.042 Test Acc: 0.489
Validation loss decreased (-0.422200 --> -0.488868).  Saving model ...
Epoch: 9 cost time: 0.8521432876586914
Epoch: 9, Steps: 12 | Train Loss: 1.835 Vali Loss: 1.887 Vali Acc: 0.528 Test Loss: 1.887 Test Acc: 0.528
Validation loss decreased (-0.488868 --> -0.527759).  Saving model ...
Epoch: 10 cost time: 0.8713092803955078
Epoch: 10, Steps: 12 | Train Loss: 1.649 Vali Loss: 1.724 Vali Acc: 0.567 Test Loss: 1.724 Test Acc: 0.567
Validation loss decreased (-0.527759 --> -0.566649).  Saving model ...
Epoch: 11 cost time: 0.9117438793182373
Epoch: 11, Steps: 12 | Train Loss: 1.480 Vali Loss: 1.563 Vali Acc: 0.600 Test Loss: 1.563 Test Acc: 0.600
Validation loss decreased (-0.566649 --> -0.599984).  Saving model ...
Epoch: 12 cost time: 0.9434614181518555
Epoch: 12, Steps: 12 | Train Loss: 1.300 Vali Loss: 1.415 Vali Acc: 0.633 Test Loss: 1.415 Test Acc: 0.633
Validation loss decreased (-0.599984 --> -0.633319).  Saving model ...
Epoch: 13 cost time: 0.8703982830047607
Epoch: 13, Steps: 12 | Train Loss: 1.123 Vali Loss: 1.297 Vali Acc: 0.661 Test Loss: 1.297 Test Acc: 0.661
Validation loss decreased (-0.633319 --> -0.661098).  Saving model ...
Epoch: 14 cost time: 1.0216946601867676
Epoch: 14, Steps: 12 | Train Loss: 0.993 Vali Loss: 1.180 Vali Acc: 0.689 Test Loss: 1.180 Test Acc: 0.689
Validation loss decreased (-0.661098 --> -0.688877).  Saving model ...
Epoch: 15 cost time: 0.9103620052337646
Epoch: 15, Steps: 12 | Train Loss: 0.930 Vali Loss: 1.083 Vali Acc: 0.683 Test Loss: 1.083 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9322319030761719
Epoch: 16, Steps: 12 | Train Loss: 0.806 Vali Loss: 1.003 Vali Acc: 0.711 Test Loss: 1.003 Test Acc: 0.711
Validation loss decreased (-0.688877 --> -0.711101).  Saving model ...
Epoch: 17 cost time: 0.9337897300720215
Epoch: 17, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.946 Vali Acc: 0.728 Test Loss: 0.946 Test Acc: 0.728
Validation loss decreased (-0.711101 --> -0.727768).  Saving model ...
Epoch: 18 cost time: 0.8930737972259521
Epoch: 18, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.889 Vali Acc: 0.733 Test Loss: 0.889 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733324).  Saving model ...
Epoch: 19 cost time: 0.8736274242401123
Epoch: 19, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.841 Vali Acc: 0.733 Test Loss: 0.841 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733325).  Saving model ...
Epoch: 20 cost time: 0.8892042636871338
Epoch: 20, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.787 Vali Acc: 0.761 Test Loss: 0.787 Test Acc: 0.761
Validation loss decreased (-0.733325 --> -0.761103).  Saving model ...
Epoch: 21 cost time: 0.8829128742218018
Epoch: 21, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.748 Vali Acc: 0.789 Test Loss: 0.748 Test Acc: 0.789
Validation loss decreased (-0.761103 --> -0.788881).  Saving model ...
Epoch: 22 cost time: 0.9277510643005371
Epoch: 22, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.727 Vali Acc: 0.806 Test Loss: 0.727 Test Acc: 0.806
Validation loss decreased (-0.788881 --> -0.805548).  Saving model ...
Epoch: 23 cost time: 0.850621223449707
Epoch: 23, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.691 Vali Acc: 0.822 Test Loss: 0.691 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822215).  Saving model ...
Epoch: 24 cost time: 0.9400253295898438
Epoch: 24, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.667 Vali Acc: 0.822 Test Loss: 0.667 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822216).  Saving model ...
Epoch: 25 cost time: 0.90181565284729
Epoch: 25, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.653 Vali Acc: 0.817 Test Loss: 0.653 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.976311206817627
Epoch: 26, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.635 Vali Acc: 0.844 Test Loss: 0.635 Test Acc: 0.844
Validation loss decreased (-0.822216 --> -0.844438).  Saving model ...
Epoch: 27 cost time: 0.8461000919342041
Epoch: 27, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.626 Vali Acc: 0.828 Test Loss: 0.626 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.923607587814331
Epoch: 28, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.601 Vali Acc: 0.839 Test Loss: 0.601 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9314429759979248
Epoch: 29, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.592 Vali Acc: 0.867 Test Loss: 0.592 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866661).  Saving model ...
Epoch: 30 cost time: 0.8942298889160156
Epoch: 30, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.597 Vali Acc: 0.856 Test Loss: 0.597 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9220402240753174
Epoch: 31, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.592 Vali Acc: 0.844 Test Loss: 0.592 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9638400077819824
Epoch: 32, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.923297643661499
Epoch: 33, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.579 Vali Acc: 0.861 Test Loss: 0.579 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9528419971466064
Epoch: 34, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.561 Vali Acc: 0.861 Test Loss: 0.561 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9046251773834229
Epoch: 35, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9424011707305908
Epoch: 36, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.0070810317993164
Epoch: 37, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.570 Vali Acc: 0.872 Test Loss: 0.570 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 38 cost time: 0.9315600395202637
Epoch: 38, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.573 Vali Acc: 0.894 Test Loss: 0.573 Test Acc: 0.894
Validation loss decreased (-0.872217 --> -0.894439).  Saving model ...
Epoch: 39 cost time: 0.9754126071929932
Epoch: 39, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9178435802459717
Epoch: 40, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.552 Vali Acc: 0.839 Test Loss: 0.552 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8613235950469971
Epoch: 41, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8562371730804443
Epoch: 42, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.584 Vali Acc: 0.861 Test Loss: 0.584 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.843271017074585
Epoch: 43, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.597 Vali Acc: 0.867 Test Loss: 0.597 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8931710720062256
Epoch: 44, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.601 Vali Acc: 0.856 Test Loss: 0.601 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.8295681476593018
Epoch: 45, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.607 Vali Acc: 0.850 Test Loss: 0.607 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.8692004680633545
Epoch: 46, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.623 Vali Acc: 0.867 Test Loss: 0.623 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.9287779331207275
Epoch: 47, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.604 Vali Acc: 0.872 Test Loss: 0.604 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.9055905342102051
Epoch: 48, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.619 Vali Acc: 0.867 Test Loss: 0.619 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 104783
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1204469203948975
Epoch: 1, Steps: 12 | Train Loss: 2.743 Vali Loss: 2.697 Vali Acc: 0.078 Test Loss: 2.697 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 0.8782706260681152
Epoch: 2, Steps: 12 | Train Loss: 2.687 Vali Loss: 2.665 Vali Acc: 0.128 Test Loss: 2.665 Test Acc: 0.128
Validation loss decreased (-0.077751 --> -0.127751).  Saving model ...
Epoch: 3 cost time: 0.9457590579986572
Epoch: 3, Steps: 12 | Train Loss: 2.619 Vali Loss: 2.606 Vali Acc: 0.167 Test Loss: 2.606 Test Acc: 0.167
Validation loss decreased (-0.127751 --> -0.166641).  Saving model ...
Epoch: 4 cost time: 0.8877854347229004
Epoch: 4, Steps: 12 | Train Loss: 2.557 Vali Loss: 2.529 Vali Acc: 0.278 Test Loss: 2.529 Test Acc: 0.278
Validation loss decreased (-0.166641 --> -0.277752).  Saving model ...
Epoch: 5 cost time: 0.9696700572967529
Epoch: 5, Steps: 12 | Train Loss: 2.459 Vali Loss: 2.444 Vali Acc: 0.389 Test Loss: 2.444 Test Acc: 0.389
Validation loss decreased (-0.277752 --> -0.388864).  Saving model ...
Epoch: 6 cost time: 0.8217122554779053
Epoch: 6, Steps: 12 | Train Loss: 2.331 Vali Loss: 2.347 Vali Acc: 0.478 Test Loss: 2.347 Test Acc: 0.478
Validation loss decreased (-0.388864 --> -0.477754).  Saving model ...
Epoch: 7 cost time: 0.8243434429168701
Epoch: 7, Steps: 12 | Train Loss: 2.248 Vali Loss: 2.235 Vali Acc: 0.533 Test Loss: 2.235 Test Acc: 0.533
Validation loss decreased (-0.477754 --> -0.533311).  Saving model ...
Epoch: 8 cost time: 0.8629074096679688
Epoch: 8, Steps: 12 | Train Loss: 2.111 Vali Loss: 2.092 Vali Acc: 0.572 Test Loss: 2.092 Test Acc: 0.572
Validation loss decreased (-0.533311 --> -0.572201).  Saving model ...
Epoch: 9 cost time: 0.8792316913604736
Epoch: 9, Steps: 12 | Train Loss: 1.932 Vali Loss: 1.960 Vali Acc: 0.589 Test Loss: 1.960 Test Acc: 0.589
Validation loss decreased (-0.572201 --> -0.588869).  Saving model ...
Epoch: 10 cost time: 0.8688273429870605
Epoch: 10, Steps: 12 | Train Loss: 1.732 Vali Loss: 1.801 Vali Acc: 0.628 Test Loss: 1.801 Test Acc: 0.628
Validation loss decreased (-0.588869 --> -0.627760).  Saving model ...
Epoch: 11 cost time: 0.8833885192871094
Epoch: 11, Steps: 12 | Train Loss: 1.558 Vali Loss: 1.650 Vali Acc: 0.644 Test Loss: 1.650 Test Acc: 0.644
Validation loss decreased (-0.627760 --> -0.644428).  Saving model ...
Epoch: 12 cost time: 0.8343393802642822
Epoch: 12, Steps: 12 | Train Loss: 1.471 Vali Loss: 1.497 Vali Acc: 0.661 Test Loss: 1.497 Test Acc: 0.661
Validation loss decreased (-0.644428 --> -0.661096).  Saving model ...
Epoch: 13 cost time: 0.8879275321960449
Epoch: 13, Steps: 12 | Train Loss: 1.237 Vali Loss: 1.371 Vali Acc: 0.667 Test Loss: 1.371 Test Acc: 0.667
Validation loss decreased (-0.661096 --> -0.666653).  Saving model ...
Epoch: 14 cost time: 0.9523673057556152
Epoch: 14, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.257 Vali Acc: 0.706 Test Loss: 1.257 Test Acc: 0.706
Validation loss decreased (-0.666653 --> -0.705543).  Saving model ...
Epoch: 15 cost time: 0.9066381454467773
Epoch: 15, Steps: 12 | Train Loss: 0.992 Vali Loss: 1.168 Vali Acc: 0.717 Test Loss: 1.168 Test Acc: 0.717
Validation loss decreased (-0.705543 --> -0.716655).  Saving model ...
Epoch: 16 cost time: 0.9064333438873291
Epoch: 16, Steps: 12 | Train Loss: 0.877 Vali Loss: 1.074 Vali Acc: 0.722 Test Loss: 1.074 Test Acc: 0.722
Validation loss decreased (-0.716655 --> -0.722211).  Saving model ...
Epoch: 17 cost time: 0.8849506378173828
Epoch: 17, Steps: 12 | Train Loss: 0.790 Vali Loss: 0.989 Vali Acc: 0.739 Test Loss: 0.989 Test Acc: 0.739
Validation loss decreased (-0.722211 --> -0.738879).  Saving model ...
Epoch: 18 cost time: 0.9172689914703369
Epoch: 18, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.936 Vali Acc: 0.744 Test Loss: 0.936 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744435).  Saving model ...
Epoch: 19 cost time: 0.8691771030426025
Epoch: 19, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.890 Vali Acc: 0.761 Test Loss: 0.890 Test Acc: 0.761
Validation loss decreased (-0.744435 --> -0.761102).  Saving model ...
Epoch: 20 cost time: 0.8823177814483643
Epoch: 20, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.838 Vali Acc: 0.783 Test Loss: 0.838 Test Acc: 0.783
Validation loss decreased (-0.761102 --> -0.783325).  Saving model ...
Epoch: 21 cost time: 0.9555459022521973
Epoch: 21, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.798 Vali Acc: 0.783 Test Loss: 0.798 Test Acc: 0.783
Validation loss decreased (-0.783325 --> -0.783325).  Saving model ...
Epoch: 22 cost time: 0.9762887954711914
Epoch: 22, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.755 Vali Acc: 0.789 Test Loss: 0.755 Test Acc: 0.789
Validation loss decreased (-0.783325 --> -0.788881).  Saving model ...
Epoch: 23 cost time: 1.0050954818725586
Epoch: 23, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.737 Vali Acc: 0.772 Test Loss: 0.737 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8703324794769287
Epoch: 24, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.693 Vali Acc: 0.794 Test Loss: 0.693 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794438).  Saving model ...
Epoch: 25 cost time: 0.8579177856445312
Epoch: 25, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.684 Vali Acc: 0.822 Test Loss: 0.684 Test Acc: 0.822
Validation loss decreased (-0.794438 --> -0.822215).  Saving model ...
Epoch: 26 cost time: 0.8253967761993408
Epoch: 26, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.649 Vali Acc: 0.844 Test Loss: 0.649 Test Acc: 0.844
Validation loss decreased (-0.822215 --> -0.844438).  Saving model ...
Epoch: 27 cost time: 0.8545949459075928
Epoch: 27, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 0.8662221431732178
Epoch: 28, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.602 Vali Acc: 0.850 Test Loss: 0.602 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 29 cost time: 0.8733339309692383
Epoch: 29, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.608 Vali Acc: 0.850 Test Loss: 0.608 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8410632610321045
Epoch: 30, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.590 Vali Acc: 0.856 Test Loss: 0.590 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 31 cost time: 0.8970386981964111
Epoch: 31, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.571 Vali Acc: 0.867 Test Loss: 0.571 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 32 cost time: 0.8639476299285889
Epoch: 32, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.553 Vali Acc: 0.833 Test Loss: 0.553 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7890176773071289
Epoch: 33, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.557 Vali Acc: 0.856 Test Loss: 0.557 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7866630554199219
Epoch: 34, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.532 Vali Acc: 0.861 Test Loss: 0.532 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9864273071289062
Epoch: 35, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.544 Vali Acc: 0.856 Test Loss: 0.544 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7711739540100098
Epoch: 36, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8304283618927002
Epoch: 37, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.519 Vali Acc: 0.867 Test Loss: 0.519 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 38 cost time: 0.8160040378570557
Epoch: 38, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.521 Vali Acc: 0.872 Test Loss: 0.521 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 39 cost time: 0.838759183883667
Epoch: 39, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.532 Vali Acc: 0.867 Test Loss: 0.532 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8131272792816162
Epoch: 40, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.512 Vali Acc: 0.878 Test Loss: 0.512 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 41 cost time: 0.8375048637390137
Epoch: 41, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.506 Vali Acc: 0.872 Test Loss: 0.506 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.92315673828125
Epoch: 42, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.522 Vali Acc: 0.867 Test Loss: 0.522 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.949786901473999
Epoch: 43, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.518 Vali Acc: 0.883 Test Loss: 0.518 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 44 cost time: 0.9289186000823975
Epoch: 44, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.531 Vali Acc: 0.872 Test Loss: 0.531 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9159321784973145
Epoch: 45, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.536 Vali Acc: 0.867 Test Loss: 0.536 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8681600093841553
Epoch: 46, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.534 Vali Acc: 0.861 Test Loss: 0.534 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.8193347454071045
Epoch: 47, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.521 Vali Acc: 0.856 Test Loss: 0.521 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.8302395343780518
Epoch: 48, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.510 Vali Acc: 0.883 Test Loss: 0.510 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 49 cost time: 0.8505029678344727
Epoch: 49, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.511 Vali Acc: 0.883 Test Loss: 0.511 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8877708911895752
Epoch: 50, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.534 Vali Acc: 0.883 Test Loss: 0.534 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 102959
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.561636447906494
Epoch: 1, Steps: 12 | Train Loss: 2.505 Vali Loss: 2.131 Vali Acc: 0.528 Test Loss: 2.131 Test Acc: 0.528
Validation loss decreased (inf --> -0.527756).  Saving model ...
Epoch: 2 cost time: 1.1201837062835693
Epoch: 2, Steps: 12 | Train Loss: 1.426 Vali Loss: 1.437 Vali Acc: 0.589 Test Loss: 1.437 Test Acc: 0.589
Validation loss decreased (-0.527756 --> -0.588875).  Saving model ...
Epoch: 3 cost time: 1.1072845458984375
Epoch: 3, Steps: 12 | Train Loss: 0.877 Vali Loss: 1.042 Vali Acc: 0.678 Test Loss: 1.042 Test Acc: 0.678
Validation loss decreased (-0.588875 --> -0.677767).  Saving model ...
Epoch: 4 cost time: 1.1191368103027344
Epoch: 4, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.986 Vali Acc: 0.678 Test Loss: 0.986 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677768).  Saving model ...
Epoch: 5 cost time: 1.0770807266235352
Epoch: 5, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.845 Vali Acc: 0.711 Test Loss: 0.845 Test Acc: 0.711
Validation loss decreased (-0.677768 --> -0.711103).  Saving model ...
Epoch: 6 cost time: 1.107191562652588
Epoch: 6, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.782 Vali Acc: 0.783 Test Loss: 0.782 Test Acc: 0.783
Validation loss decreased (-0.711103 --> -0.783326).  Saving model ...
Epoch: 7 cost time: 1.2723681926727295
Epoch: 7, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.750 Vali Acc: 0.778 Test Loss: 0.750 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.36350417137146
Epoch: 8, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.799 Vali Acc: 0.794 Test Loss: 0.799 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794436).  Saving model ...
Epoch: 9 cost time: 1.209923267364502
Epoch: 9, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.792 Vali Acc: 0.800 Test Loss: 0.792 Test Acc: 0.800
Validation loss decreased (-0.794436 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 1.1978518962860107
Epoch: 10, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.941 Vali Acc: 0.783 Test Loss: 0.941 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.137279987335205
Epoch: 11, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.853 Vali Acc: 0.800 Test Loss: 0.853 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3099021911621094
Epoch: 12, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.756 Vali Acc: 0.828 Test Loss: 0.756 Test Acc: 0.828
Validation loss decreased (-0.799992 --> -0.827770).  Saving model ...
Epoch: 13 cost time: 1.157179355621338
Epoch: 13, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.859 Vali Acc: 0.811 Test Loss: 0.859 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1299242973327637
Epoch: 14, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.907 Vali Acc: 0.811 Test Loss: 0.907 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.131537914276123
Epoch: 15, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.977 Vali Acc: 0.817 Test Loss: 0.977 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2030854225158691
Epoch: 16, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.875 Vali Acc: 0.844 Test Loss: 0.875 Test Acc: 0.844
Validation loss decreased (-0.827770 --> -0.844436).  Saving model ...
Epoch: 17 cost time: 1.1723394393920898
Epoch: 17, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.828 Vali Acc: 0.839 Test Loss: 0.828 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.09320068359375
Epoch: 18, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.135 Vali Acc: 0.817 Test Loss: 1.135 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1436488628387451
Epoch: 19, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.059 Vali Acc: 0.817 Test Loss: 1.059 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1790032386779785
Epoch: 20, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.022 Vali Acc: 0.839 Test Loss: 1.022 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.062495470046997
Epoch: 21, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.156 Vali Acc: 0.817 Test Loss: 1.156 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.218686580657959
Epoch: 22, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.272 Vali Acc: 0.822 Test Loss: 1.272 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2018163204193115
Epoch: 23, Steps: 12 | Train Loss: 0.058 Vali Loss: 1.283 Vali Acc: 0.833 Test Loss: 1.283 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1484596729278564
Epoch: 24, Steps: 12 | Train Loss: 0.121 Vali Loss: 1.028 Vali Acc: 0.878 Test Loss: 1.028 Test Acc: 0.878
Validation loss decreased (-0.844436 --> -0.877767).  Saving model ...
Epoch: 25 cost time: 1.0998797416687012
Epoch: 25, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.284 Vali Acc: 0.806 Test Loss: 1.284 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2125651836395264
Epoch: 26, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.230 Vali Acc: 0.850 Test Loss: 1.230 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.191993236541748
Epoch: 27, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.297 Vali Acc: 0.833 Test Loss: 1.297 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2159552574157715
Epoch: 28, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.267 Vali Acc: 0.828 Test Loss: 1.267 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.183936357498169
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.317 Vali Acc: 0.828 Test Loss: 1.317 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1226341724395752
Epoch: 30, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.384 Vali Acc: 0.828 Test Loss: 1.384 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1918985843658447
Epoch: 31, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.473 Vali Acc: 0.844 Test Loss: 1.473 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1911814212799072
Epoch: 32, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.544 Vali Acc: 0.844 Test Loss: 1.544 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.148139238357544
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.547 Vali Acc: 0.850 Test Loss: 1.547 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.2212142944335938
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.475 Vali Acc: 0.861 Test Loss: 1.475 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 1420559
model size : 5.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.511969804763794
Epoch: 1, Steps: 12 | Train Loss: 2.701 Vali Loss: 2.410 Vali Acc: 0.261 Test Loss: 2.410 Test Acc: 0.261
Validation loss decreased (inf --> -0.261087).  Saving model ...
Epoch: 2 cost time: 1.1773488521575928
Epoch: 2, Steps: 12 | Train Loss: 1.823 Vali Loss: 1.736 Vali Acc: 0.544 Test Loss: 1.736 Test Acc: 0.544
Validation loss decreased (-0.261087 --> -0.544427).  Saving model ...
Epoch: 3 cost time: 1.1381466388702393
Epoch: 3, Steps: 12 | Train Loss: 1.227 Vali Loss: 1.290 Vali Acc: 0.600 Test Loss: 1.290 Test Acc: 0.600
Validation loss decreased (-0.544427 --> -0.599987).  Saving model ...
Epoch: 4 cost time: 1.158820390701294
Epoch: 4, Steps: 12 | Train Loss: 0.861 Vali Loss: 1.056 Vali Acc: 0.644 Test Loss: 1.056 Test Acc: 0.644
Validation loss decreased (-0.599987 --> -0.644434).  Saving model ...
Epoch: 5 cost time: 1.219123363494873
Epoch: 5, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.944 Vali Acc: 0.711 Test Loss: 0.944 Test Acc: 0.711
Validation loss decreased (-0.644434 --> -0.711102).  Saving model ...
Epoch: 6 cost time: 1.153005838394165
Epoch: 6, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.826 Vali Acc: 0.744 Test Loss: 0.826 Test Acc: 0.744
Validation loss decreased (-0.711102 --> -0.744436).  Saving model ...
Epoch: 7 cost time: 1.0807249546051025
Epoch: 7, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.768 Vali Acc: 0.789 Test Loss: 0.768 Test Acc: 0.789
Validation loss decreased (-0.744436 --> -0.788881).  Saving model ...
Epoch: 8 cost time: 1.160827398300171
Epoch: 8, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.739 Vali Acc: 0.767 Test Loss: 0.739 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1255853176116943
Epoch: 9, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.727 Vali Acc: 0.817 Test Loss: 0.727 Test Acc: 0.817
Validation loss decreased (-0.788881 --> -0.816659).  Saving model ...
Epoch: 10 cost time: 1.1129953861236572
Epoch: 10, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.775 Vali Acc: 0.783 Test Loss: 0.775 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1278691291809082
Epoch: 11, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.657 Vali Acc: 0.811 Test Loss: 0.657 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1416254043579102
Epoch: 12, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.698 Vali Acc: 0.844 Test Loss: 0.698 Test Acc: 0.844
Validation loss decreased (-0.816659 --> -0.844437).  Saving model ...
Epoch: 13 cost time: 1.1091487407684326
Epoch: 13, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.635 Vali Acc: 0.833 Test Loss: 0.635 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2566263675689697
Epoch: 14, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.630 Vali Acc: 0.856 Test Loss: 0.630 Test Acc: 0.856
Validation loss decreased (-0.844437 --> -0.855549).  Saving model ...
Epoch: 15 cost time: 1.1182503700256348
Epoch: 15, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.605 Vali Acc: 0.828 Test Loss: 0.605 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2473886013031006
Epoch: 16, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.708 Vali Acc: 0.817 Test Loss: 0.708 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0730128288269043
Epoch: 17, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.643 Vali Acc: 0.839 Test Loss: 0.643 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.159060001373291
Epoch: 18, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.699 Vali Acc: 0.850 Test Loss: 0.699 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.13956618309021
Epoch: 19, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.732 Vali Acc: 0.844 Test Loss: 0.732 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.140404462814331
Epoch: 20, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.753 Vali Acc: 0.833 Test Loss: 0.753 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1211321353912354
Epoch: 21, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.692 Vali Acc: 0.844 Test Loss: 0.692 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2881696224212646
Epoch: 22, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.741 Vali Acc: 0.850 Test Loss: 0.741 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.209212064743042
Epoch: 23, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.791 Vali Acc: 0.844 Test Loss: 0.791 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2511985301971436
Epoch: 24, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.763 Vali Acc: 0.861 Test Loss: 0.763 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861103).  Saving model ...
Epoch: 25 cost time: 1.2458221912384033
Epoch: 25, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.791 Vali Acc: 0.861 Test Loss: 0.791 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2391071319580078
Epoch: 26, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.775 Vali Acc: 0.872 Test Loss: 0.775 Test Acc: 0.872
Validation loss decreased (-0.861103 --> -0.872214).  Saving model ...
Epoch: 27 cost time: 1.216881513595581
Epoch: 27, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.762 Vali Acc: 0.878 Test Loss: 0.762 Test Acc: 0.878
Validation loss decreased (-0.872214 --> -0.877770).  Saving model ...
Epoch: 28 cost time: 1.1055595874786377
Epoch: 28, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.841 Vali Acc: 0.867 Test Loss: 0.841 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1552958488464355
Epoch: 29, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.837 Vali Acc: 0.856 Test Loss: 0.837 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1555092334747314
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.800 Vali Acc: 0.850 Test Loss: 0.800 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1187260150909424
Epoch: 31, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.828 Vali Acc: 0.872 Test Loss: 0.828 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.2084338665008545
Epoch: 32, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.830 Vali Acc: 0.861 Test Loss: 0.830 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.2164456844329834
Epoch: 33, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.909 Vali Acc: 0.861 Test Loss: 0.909 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.1477129459381104
Epoch: 34, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.874 Vali Acc: 0.878 Test Loss: 0.874 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.1637520790100098
Epoch: 35, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.942 Vali Acc: 0.878 Test Loss: 0.942 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.2164154052734375
Epoch: 36, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.888 Vali Acc: 0.867 Test Loss: 0.888 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.0914654731750488
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.872 Vali Acc: 0.872 Test Loss: 0.872 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 1244175
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4365038871765137
Epoch: 1, Steps: 12 | Train Loss: 2.627 Vali Loss: 2.465 Vali Acc: 0.233 Test Loss: 2.465 Test Acc: 0.233
Validation loss decreased (inf --> -0.233309).  Saving model ...
Epoch: 2 cost time: 1.1752119064331055
Epoch: 2, Steps: 12 | Train Loss: 1.875 Vali Loss: 1.742 Vali Acc: 0.589 Test Loss: 1.742 Test Acc: 0.589
Validation loss decreased (-0.233309 --> -0.588871).  Saving model ...
Epoch: 3 cost time: 1.1689245700836182
Epoch: 3, Steps: 12 | Train Loss: 1.146 Vali Loss: 1.248 Vali Acc: 0.656 Test Loss: 1.248 Test Acc: 0.656
Validation loss decreased (-0.588871 --> -0.655543).  Saving model ...
Epoch: 4 cost time: 1.1747252941131592
Epoch: 4, Steps: 12 | Train Loss: 0.804 Vali Loss: 1.023 Vali Acc: 0.706 Test Loss: 1.023 Test Acc: 0.706
Validation loss decreased (-0.655543 --> -0.705545).  Saving model ...
Epoch: 5 cost time: 1.1431703567504883
Epoch: 5, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.884 Vali Acc: 0.711 Test Loss: 0.884 Test Acc: 0.711
Validation loss decreased (-0.705545 --> -0.711102).  Saving model ...
Epoch: 6 cost time: 1.115436315536499
Epoch: 6, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.771 Vali Acc: 0.772 Test Loss: 0.771 Test Acc: 0.772
Validation loss decreased (-0.711102 --> -0.772215).  Saving model ...
Epoch: 7 cost time: 1.0359203815460205
Epoch: 7, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.746 Vali Acc: 0.756 Test Loss: 0.746 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.096233606338501
Epoch: 8, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.746 Vali Acc: 0.789 Test Loss: 0.746 Test Acc: 0.789
Validation loss decreased (-0.772215 --> -0.788881).  Saving model ...
Epoch: 9 cost time: 1.0703508853912354
Epoch: 9, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.677 Vali Acc: 0.822 Test Loss: 0.677 Test Acc: 0.822
Validation loss decreased (-0.788881 --> -0.822215).  Saving model ...
Epoch: 10 cost time: 1.0113542079925537
Epoch: 10, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.658 Vali Acc: 0.828 Test Loss: 0.658 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 11 cost time: 0.9834015369415283
Epoch: 11, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.645 Vali Acc: 0.822 Test Loss: 0.645 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1531400680541992
Epoch: 12, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.620 Vali Acc: 0.822 Test Loss: 0.620 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1423261165618896
Epoch: 13, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.762 Vali Acc: 0.811 Test Loss: 0.762 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.089930772781372
Epoch: 14, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.668 Vali Acc: 0.844 Test Loss: 0.668 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 15 cost time: 1.082237720489502
Epoch: 15, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.713 Vali Acc: 0.844 Test Loss: 0.713 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.128587245941162
Epoch: 16, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.700 Vali Acc: 0.856 Test Loss: 0.700 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 17 cost time: 1.0734801292419434
Epoch: 17, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.696 Vali Acc: 0.878 Test Loss: 0.696 Test Acc: 0.878
Validation loss decreased (-0.855549 --> -0.877771).  Saving model ...
Epoch: 18 cost time: 1.0667071342468262
Epoch: 18, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.724 Vali Acc: 0.867 Test Loss: 0.724 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1289451122283936
Epoch: 19, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.710 Vali Acc: 0.856 Test Loss: 0.710 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.099332571029663
Epoch: 20, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.765 Vali Acc: 0.856 Test Loss: 0.765 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0708708763122559
Epoch: 21, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.773 Vali Acc: 0.850 Test Loss: 0.773 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0763766765594482
Epoch: 22, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.732 Vali Acc: 0.856 Test Loss: 0.732 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1740367412567139
Epoch: 23, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.833 Vali Acc: 0.861 Test Loss: 0.833 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.130798101425171
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.781 Vali Acc: 0.867 Test Loss: 0.781 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.154468297958374
Epoch: 25, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.809 Vali Acc: 0.867 Test Loss: 0.809 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.104867696762085
Epoch: 26, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.811 Vali Acc: 0.867 Test Loss: 0.811 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1303322315216064
Epoch: 27, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.803 Vali Acc: 0.867 Test Loss: 0.803 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 1244431
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3713314533233643
Epoch: 1, Steps: 12 | Train Loss: 2.631 Vali Loss: 2.503 Vali Acc: 0.278 Test Loss: 2.503 Test Acc: 0.278
Validation loss decreased (inf --> -0.277753).  Saving model ...
Epoch: 2 cost time: 1.0087976455688477
Epoch: 2, Steps: 12 | Train Loss: 2.011 Vali Loss: 1.926 Vali Acc: 0.506 Test Loss: 1.926 Test Acc: 0.506
Validation loss decreased (-0.277753 --> -0.505536).  Saving model ...
Epoch: 3 cost time: 1.1153182983398438
Epoch: 3, Steps: 12 | Train Loss: 1.361 Vali Loss: 1.446 Vali Acc: 0.578 Test Loss: 1.446 Test Acc: 0.578
Validation loss decreased (-0.505536 --> -0.577763).  Saving model ...
Epoch: 4 cost time: 1.1516034603118896
Epoch: 4, Steps: 12 | Train Loss: 0.972 Vali Loss: 1.151 Vali Acc: 0.678 Test Loss: 1.151 Test Acc: 0.678
Validation loss decreased (-0.577763 --> -0.677766).  Saving model ...
Epoch: 5 cost time: 1.0683977603912354
Epoch: 5, Steps: 12 | Train Loss: 0.745 Vali Loss: 0.960 Vali Acc: 0.728 Test Loss: 0.960 Test Acc: 0.728
Validation loss decreased (-0.677766 --> -0.727768).  Saving model ...
Epoch: 6 cost time: 1.163832664489746
Epoch: 6, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.821 Vali Acc: 0.756 Test Loss: 0.821 Test Acc: 0.756
Validation loss decreased (-0.727768 --> -0.755547).  Saving model ...
Epoch: 7 cost time: 1.0991594791412354
Epoch: 7, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.762 Vali Acc: 0.767 Test Loss: 0.762 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766659).  Saving model ...
Epoch: 8 cost time: 1.0934827327728271
Epoch: 8, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.716 Vali Acc: 0.789 Test Loss: 0.716 Test Acc: 0.789
Validation loss decreased (-0.766659 --> -0.788882).  Saving model ...
Epoch: 9 cost time: 1.0525078773498535
Epoch: 9, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.639 Vali Acc: 0.806 Test Loss: 0.639 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805549).  Saving model ...
Epoch: 10 cost time: 1.0501313209533691
Epoch: 10, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.603 Vali Acc: 0.822 Test Loss: 0.603 Test Acc: 0.822
Validation loss decreased (-0.805549 --> -0.822216).  Saving model ...
Epoch: 11 cost time: 1.0299773216247559
Epoch: 11, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.596 Vali Acc: 0.833 Test Loss: 0.596 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 12 cost time: 1.0239837169647217
Epoch: 12, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.556 Vali Acc: 0.828 Test Loss: 0.556 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0469369888305664
Epoch: 13, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.568 Vali Acc: 0.844 Test Loss: 0.568 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844439).  Saving model ...
Epoch: 14 cost time: 1.1375958919525146
Epoch: 14, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.554 Vali Acc: 0.867 Test Loss: 0.554 Test Acc: 0.867
Validation loss decreased (-0.844439 --> -0.866661).  Saving model ...
Epoch: 15 cost time: 1.0753965377807617
Epoch: 15, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.554 Vali Acc: 0.850 Test Loss: 0.554 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.074345588684082
Epoch: 16, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.611 Vali Acc: 0.867 Test Loss: 0.611 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0981996059417725
Epoch: 17, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.569 Vali Acc: 0.872 Test Loss: 0.569 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 18 cost time: 1.1043565273284912
Epoch: 18, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.633 Vali Acc: 0.861 Test Loss: 0.633 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9902863502502441
Epoch: 19, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.637 Vali Acc: 0.867 Test Loss: 0.637 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0292086601257324
Epoch: 20, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.670 Vali Acc: 0.861 Test Loss: 0.670 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0365750789642334
Epoch: 21, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.648 Vali Acc: 0.861 Test Loss: 0.648 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.063446283340454
Epoch: 22, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.708 Vali Acc: 0.856 Test Loss: 0.708 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0342223644256592
Epoch: 23, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.679 Vali Acc: 0.861 Test Loss: 0.679 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0748891830444336
Epoch: 24, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.742 Vali Acc: 0.867 Test Loss: 0.742 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0630426406860352
Epoch: 25, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.716 Vali Acc: 0.878 Test Loss: 0.716 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877771).  Saving model ...
Epoch: 26 cost time: 1.0833864212036133
Epoch: 26, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.708 Vali Acc: 0.878 Test Loss: 0.708 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877771).  Saving model ...
Epoch: 27 cost time: 1.1434588432312012
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.732 Vali Acc: 0.872 Test Loss: 0.732 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1153557300567627
Epoch: 28, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.717 Vali Acc: 0.861 Test Loss: 0.717 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.154372215270996
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.685 Vali Acc: 0.872 Test Loss: 0.685 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0673635005950928
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.720 Vali Acc: 0.867 Test Loss: 0.720 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0494060516357422
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.723 Vali Acc: 0.878 Test Loss: 0.723 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0313432216644287
Epoch: 32, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.716 Vali Acc: 0.861 Test Loss: 0.716 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.070972204208374
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.764 Vali Acc: 0.872 Test Loss: 0.764 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0117125511169434
Epoch: 34, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.741 Vali Acc: 0.878 Test Loss: 0.741 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.0744996070861816
Epoch: 35, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.868 Vali Acc: 0.867 Test Loss: 0.868 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.074122667312622
Epoch: 36, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.762 Vali Acc: 0.872 Test Loss: 0.762 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 1190927
model size : 4.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3849411010742188
Epoch: 1, Steps: 12 | Train Loss: 2.658 Vali Loss: 2.563 Vali Acc: 0.244 Test Loss: 2.563 Test Acc: 0.244
Validation loss decreased (inf --> -0.244419).  Saving model ...
Epoch: 2 cost time: 1.1105098724365234
Epoch: 2, Steps: 12 | Train Loss: 2.183 Vali Loss: 2.065 Vali Acc: 0.472 Test Loss: 2.065 Test Acc: 0.472
Validation loss decreased (-0.244419 --> -0.472202).  Saving model ...
Epoch: 3 cost time: 1.1052396297454834
Epoch: 3, Steps: 12 | Train Loss: 1.552 Vali Loss: 1.575 Vali Acc: 0.667 Test Loss: 1.575 Test Acc: 0.667
Validation loss decreased (-0.472202 --> -0.666651).  Saving model ...
Epoch: 4 cost time: 1.091564655303955
Epoch: 4, Steps: 12 | Train Loss: 1.169 Vali Loss: 1.234 Vali Acc: 0.683 Test Loss: 1.234 Test Acc: 0.683
Validation loss decreased (-0.666651 --> -0.683321).  Saving model ...
Epoch: 5 cost time: 1.094332218170166
Epoch: 5, Steps: 12 | Train Loss: 0.883 Vali Loss: 1.023 Vali Acc: 0.722 Test Loss: 1.023 Test Acc: 0.722
Validation loss decreased (-0.683321 --> -0.722212).  Saving model ...
Epoch: 6 cost time: 1.2043943405151367
Epoch: 6, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.896 Vali Acc: 0.728 Test Loss: 0.896 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727769).  Saving model ...
Epoch: 7 cost time: 1.187185525894165
Epoch: 7, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.804 Vali Acc: 0.750 Test Loss: 0.804 Test Acc: 0.750
Validation loss decreased (-0.727769 --> -0.749992).  Saving model ...
Epoch: 8 cost time: 1.1856467723846436
Epoch: 8, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.750 Vali Acc: 0.756 Test Loss: 0.750 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755548).  Saving model ...
Epoch: 9 cost time: 1.2108750343322754
Epoch: 9, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.693 Vali Acc: 0.811 Test Loss: 0.693 Test Acc: 0.811
Validation loss decreased (-0.755548 --> -0.811104).  Saving model ...
Epoch: 10 cost time: 1.1972227096557617
Epoch: 10, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.639 Vali Acc: 0.800 Test Loss: 0.639 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2033276557922363
Epoch: 11, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.583 Vali Acc: 0.828 Test Loss: 0.583 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827772).  Saving model ...
Epoch: 12 cost time: 1.1220300197601318
Epoch: 12, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.560 Vali Acc: 0.833 Test Loss: 0.560 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833328).  Saving model ...
Epoch: 13 cost time: 1.1866652965545654
Epoch: 13, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
Validation loss decreased (-0.833328 --> -0.849995).  Saving model ...
Epoch: 14 cost time: 1.1933534145355225
Epoch: 14, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.519 Vali Acc: 0.856 Test Loss: 0.519 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 15 cost time: 1.2240419387817383
Epoch: 15, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.579 Vali Acc: 0.828 Test Loss: 0.579 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1860618591308594
Epoch: 16, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.553 Vali Acc: 0.844 Test Loss: 0.553 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1695730686187744
Epoch: 17, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.540 Vali Acc: 0.861 Test Loss: 0.540 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 18 cost time: 1.2188098430633545
Epoch: 18, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.138247013092041
Epoch: 19, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.617 Vali Acc: 0.861 Test Loss: 0.617 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1778693199157715
Epoch: 20, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.636 Vali Acc: 0.850 Test Loss: 0.636 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1621789932250977
Epoch: 21, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.610 Vali Acc: 0.867 Test Loss: 0.610 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 22 cost time: 1.1585452556610107
Epoch: 22, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2205331325531006
Epoch: 23, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.683 Vali Acc: 0.861 Test Loss: 0.683 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.199535846710205
Epoch: 24, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.694 Vali Acc: 0.850 Test Loss: 0.694 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2390968799591064
Epoch: 25, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.668 Vali Acc: 0.844 Test Loss: 0.668 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2128982543945312
Epoch: 26, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.678 Vali Acc: 0.861 Test Loss: 0.678 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2911250591278076
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.666 Vali Acc: 0.844 Test Loss: 0.666 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1992356777191162
Epoch: 28, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.687 Vali Acc: 0.844 Test Loss: 0.687 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2568910121917725
Epoch: 29, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.699 Vali Acc: 0.856 Test Loss: 0.699 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.225029706954956
Epoch: 30, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.712 Vali Acc: 0.861 Test Loss: 0.712 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.188295841217041
Epoch: 31, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.676 Vali Acc: 0.856 Test Loss: 0.676 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 1160719
model size : 4.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1592936515808105
Epoch: 1, Steps: 12 | Train Loss: 2.688 Vali Loss: 2.617 Vali Acc: 0.117 Test Loss: 2.617 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 1.0564098358154297
Epoch: 2, Steps: 12 | Train Loss: 2.246 Vali Loss: 2.164 Vali Acc: 0.461 Test Loss: 2.164 Test Acc: 0.461
Validation loss decreased (-0.116640 --> -0.461089).  Saving model ...
Epoch: 3 cost time: 0.9840173721313477
Epoch: 3, Steps: 12 | Train Loss: 1.669 Vali Loss: 1.662 Vali Acc: 0.606 Test Loss: 1.662 Test Acc: 0.606
Validation loss decreased (-0.461089 --> -0.605539).  Saving model ...
Epoch: 4 cost time: 0.9466578960418701
Epoch: 4, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.341 Vali Acc: 0.672 Test Loss: 1.341 Test Acc: 0.672
Validation loss decreased (-0.605539 --> -0.672209).  Saving model ...
Epoch: 5 cost time: 0.9971568584442139
Epoch: 5, Steps: 12 | Train Loss: 0.927 Vali Loss: 1.109 Vali Acc: 0.683 Test Loss: 1.109 Test Acc: 0.683
Validation loss decreased (-0.672209 --> -0.683322).  Saving model ...
Epoch: 6 cost time: 0.9593496322631836
Epoch: 6, Steps: 12 | Train Loss: 0.756 Vali Loss: 0.951 Vali Acc: 0.750 Test Loss: 0.951 Test Acc: 0.750
Validation loss decreased (-0.683322 --> -0.749990).  Saving model ...
Epoch: 7 cost time: 0.9892630577087402
Epoch: 7, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.837 Vali Acc: 0.783 Test Loss: 0.837 Test Acc: 0.783
Validation loss decreased (-0.749990 --> -0.783325).  Saving model ...
Epoch: 8 cost time: 1.0767009258270264
Epoch: 8, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.790 Vali Acc: 0.778 Test Loss: 0.790 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0050859451293945
Epoch: 9, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.707 Vali Acc: 0.789 Test Loss: 0.707 Test Acc: 0.789
Validation loss decreased (-0.783325 --> -0.788882).  Saving model ...
Epoch: 10 cost time: 1.0131306648254395
Epoch: 10, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.653 Vali Acc: 0.817 Test Loss: 0.653 Test Acc: 0.817
Validation loss decreased (-0.788882 --> -0.816660).  Saving model ...
Epoch: 11 cost time: 1.0119566917419434
Epoch: 11, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.635 Vali Acc: 0.839 Test Loss: 0.635 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838883).  Saving model ...
Epoch: 12 cost time: 1.0434637069702148
Epoch: 12, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.602 Vali Acc: 0.844 Test Loss: 0.602 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 13 cost time: 1.0644218921661377
Epoch: 13, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.547 Vali Acc: 0.861 Test Loss: 0.547 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861106).  Saving model ...
Epoch: 14 cost time: 1.0536537170410156
Epoch: 14, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.558 Vali Acc: 0.833 Test Loss: 0.558 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0870473384857178
Epoch: 15, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.570 Vali Acc: 0.839 Test Loss: 0.570 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0995020866394043
Epoch: 16, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 17 cost time: 1.1126430034637451
Epoch: 17, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0243453979492188
Epoch: 18, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0616321563720703
Epoch: 19, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.540 Vali Acc: 0.883 Test Loss: 0.540 Test Acc: 0.883
Validation loss decreased (-0.861106 --> -0.883328).  Saving model ...
Epoch: 20 cost time: 1.013122320175171
Epoch: 20, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9414095878601074
Epoch: 21, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.555 Vali Acc: 0.878 Test Loss: 0.555 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9893972873687744
Epoch: 22, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.585 Vali Acc: 0.867 Test Loss: 0.585 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0208096504211426
Epoch: 23, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.622 Vali Acc: 0.861 Test Loss: 0.622 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.014094352722168
Epoch: 24, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.590 Vali Acc: 0.867 Test Loss: 0.590 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0389373302459717
Epoch: 25, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.578 Vali Acc: 0.878 Test Loss: 0.578 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0775809288024902
Epoch: 26, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.682 Vali Acc: 0.861 Test Loss: 0.682 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0962469577789307
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.644 Vali Acc: 0.861 Test Loss: 0.644 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0703694820404053
Epoch: 28, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.659 Vali Acc: 0.872 Test Loss: 0.659 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0305521488189697
Epoch: 29, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.687 Vali Acc: 0.878 Test Loss: 0.687 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 1145871
model size : 4.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.332470655441284
Epoch: 1, Steps: 12 | Train Loss: 2.731 Vali Loss: 2.587 Vali Acc: 0.111 Test Loss: 2.587 Test Acc: 0.111
Validation loss decreased (inf --> -0.111085).  Saving model ...
Epoch: 2 cost time: 1.1146275997161865
Epoch: 2, Steps: 12 | Train Loss: 2.330 Vali Loss: 2.238 Vali Acc: 0.500 Test Loss: 2.238 Test Acc: 0.500
Validation loss decreased (-0.111085 --> -0.499978).  Saving model ...
Epoch: 3 cost time: 1.158513069152832
Epoch: 3, Steps: 12 | Train Loss: 1.852 Vali Loss: 1.781 Vali Acc: 0.628 Test Loss: 1.781 Test Acc: 0.628
Validation loss decreased (-0.499978 --> -0.627760).  Saving model ...
Epoch: 4 cost time: 1.221677541732788
Epoch: 4, Steps: 12 | Train Loss: 1.401 Vali Loss: 1.388 Vali Acc: 0.639 Test Loss: 1.388 Test Acc: 0.639
Validation loss decreased (-0.627760 --> -0.638875).  Saving model ...
Epoch: 5 cost time: 1.1736674308776855
Epoch: 5, Steps: 12 | Train Loss: 1.075 Vali Loss: 1.191 Vali Acc: 0.678 Test Loss: 1.191 Test Acc: 0.678
Validation loss decreased (-0.638875 --> -0.677766).  Saving model ...
Epoch: 6 cost time: 1.0867316722869873
Epoch: 6, Steps: 12 | Train Loss: 0.838 Vali Loss: 1.021 Vali Acc: 0.711 Test Loss: 1.021 Test Acc: 0.711
Validation loss decreased (-0.677766 --> -0.711101).  Saving model ...
Epoch: 7 cost time: 1.1144616603851318
Epoch: 7, Steps: 12 | Train Loss: 0.691 Vali Loss: 0.884 Vali Acc: 0.733 Test Loss: 0.884 Test Acc: 0.733
Validation loss decreased (-0.711101 --> -0.733324).  Saving model ...
Epoch: 8 cost time: 1.0447635650634766
Epoch: 8, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.802 Vali Acc: 0.778 Test Loss: 0.802 Test Acc: 0.778
Validation loss decreased (-0.733324 --> -0.777770).  Saving model ...
Epoch: 9 cost time: 1.0520603656768799
Epoch: 9, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.714 Vali Acc: 0.789 Test Loss: 0.714 Test Acc: 0.789
Validation loss decreased (-0.777770 --> -0.788882).  Saving model ...
Epoch: 10 cost time: 1.1029696464538574
Epoch: 10, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.665 Vali Acc: 0.828 Test Loss: 0.665 Test Acc: 0.828
Validation loss decreased (-0.788882 --> -0.827771).  Saving model ...
Epoch: 11 cost time: 1.1643750667572021
Epoch: 11, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.620 Vali Acc: 0.811 Test Loss: 0.620 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1480844020843506
Epoch: 12, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.606 Vali Acc: 0.828 Test Loss: 0.606 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827772).  Saving model ...
Epoch: 13 cost time: 1.1534147262573242
Epoch: 13, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.568 Vali Acc: 0.839 Test Loss: 0.568 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 14 cost time: 1.156428337097168
Epoch: 14, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.527 Vali Acc: 0.861 Test Loss: 0.527 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861106).  Saving model ...
Epoch: 15 cost time: 1.1366381645202637
Epoch: 15, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.543 Vali Acc: 0.839 Test Loss: 0.543 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1641767024993896
Epoch: 16, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.512 Vali Acc: 0.856 Test Loss: 0.512 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0807251930236816
Epoch: 17, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1338739395141602
Epoch: 18, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.505 Vali Acc: 0.856 Test Loss: 0.505 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0948939323425293
Epoch: 19, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1075010299682617
Epoch: 20, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.542 Vali Acc: 0.856 Test Loss: 0.542 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1271553039550781
Epoch: 21, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.512 Vali Acc: 0.856 Test Loss: 0.512 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1441967487335205
Epoch: 22, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.546 Vali Acc: 0.872 Test Loss: 0.546 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 23 cost time: 1.1718099117279053
Epoch: 23, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.532 Vali Acc: 0.867 Test Loss: 0.532 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0495502948760986
Epoch: 24, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.535 Vali Acc: 0.883 Test Loss: 0.535 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 25 cost time: 1.0957043170928955
Epoch: 25, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.549 Vali Acc: 0.872 Test Loss: 0.549 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0215396881103516
Epoch: 26, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.556 Vali Acc: 0.872 Test Loss: 0.556 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0159938335418701
Epoch: 27, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.576 Vali Acc: 0.889 Test Loss: 0.576 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 28 cost time: 1.030031442642212
Epoch: 28, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.654 Vali Acc: 0.856 Test Loss: 0.654 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1367905139923096
Epoch: 29, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.637 Vali Acc: 0.867 Test Loss: 0.637 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1125767230987549
Epoch: 30, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.579 Vali Acc: 0.878 Test Loss: 0.579 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1868712902069092
Epoch: 31, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.572 Vali Acc: 0.889 Test Loss: 0.572 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 32 cost time: 1.1969823837280273
Epoch: 32, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.623 Vali Acc: 0.878 Test Loss: 0.623 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2225008010864258
Epoch: 33, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.643 Vali Acc: 0.861 Test Loss: 0.643 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.145611047744751
Epoch: 34, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.672 Vali Acc: 0.867 Test Loss: 0.672 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0936620235443115
Epoch: 35, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.707 Vali Acc: 0.867 Test Loss: 0.707 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.125603437423706
Epoch: 36, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.703 Vali Acc: 0.872 Test Loss: 0.703 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1648151874542236
Epoch: 37, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.715 Vali Acc: 0.867 Test Loss: 0.715 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.1523206233978271
Epoch: 38, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.709 Vali Acc: 0.861 Test Loss: 0.709 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.1643180847167969
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.718 Vali Acc: 0.861 Test Loss: 0.718 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.0917420387268066
Epoch: 40, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.740 Vali Acc: 0.878 Test Loss: 0.740 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.192336082458496
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.755 Vali Acc: 0.867 Test Loss: 0.755 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 1131279
model size : 4.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.151757001876831
Epoch: 1, Steps: 12 | Train Loss: 2.669 Vali Loss: 2.345 Vali Acc: 0.306 Test Loss: 2.345 Test Acc: 0.306
Validation loss decreased (inf --> -0.305532).  Saving model ...
Epoch: 2 cost time: 1.0079097747802734
Epoch: 2, Steps: 12 | Train Loss: 1.876 Vali Loss: 1.696 Vali Acc: 0.600 Test Loss: 1.696 Test Acc: 0.600
Validation loss decreased (-0.305532 --> -0.599983).  Saving model ...
Epoch: 3 cost time: 0.923736572265625
Epoch: 3, Steps: 12 | Train Loss: 1.316 Vali Loss: 1.297 Vali Acc: 0.633 Test Loss: 1.297 Test Acc: 0.633
Validation loss decreased (-0.599983 --> -0.633320).  Saving model ...
Epoch: 4 cost time: 1.0266854763031006
Epoch: 4, Steps: 12 | Train Loss: 0.850 Vali Loss: 1.053 Vali Acc: 0.672 Test Loss: 1.053 Test Acc: 0.672
Validation loss decreased (-0.633320 --> -0.672212).  Saving model ...
Epoch: 5 cost time: 0.9538614749908447
Epoch: 5, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.918 Vali Acc: 0.700 Test Loss: 0.918 Test Acc: 0.700
Validation loss decreased (-0.672212 --> -0.699991).  Saving model ...
Epoch: 6 cost time: 1.099776268005371
Epoch: 6, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.772 Vali Acc: 0.739 Test Loss: 0.772 Test Acc: 0.739
Validation loss decreased (-0.699991 --> -0.738881).  Saving model ...
Epoch: 7 cost time: 0.960270881652832
Epoch: 7, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.767 Vali Acc: 0.783 Test Loss: 0.767 Test Acc: 0.783
Validation loss decreased (-0.738881 --> -0.783326).  Saving model ...
Epoch: 8 cost time: 0.9672145843505859
Epoch: 8, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.789 Vali Acc: 0.767 Test Loss: 0.789 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9782059192657471
Epoch: 9, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.757 Vali Acc: 0.800 Test Loss: 0.757 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 0.8976633548736572
Epoch: 10, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.697 Vali Acc: 0.817 Test Loss: 0.697 Test Acc: 0.817
Validation loss decreased (-0.799992 --> -0.816660).  Saving model ...
Epoch: 11 cost time: 1.0212574005126953
Epoch: 11, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.709 Vali Acc: 0.772 Test Loss: 0.709 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9784533977508545
Epoch: 12, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.713 Vali Acc: 0.811 Test Loss: 0.713 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9828588962554932
Epoch: 13, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.761 Vali Acc: 0.811 Test Loss: 0.761 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9386003017425537
Epoch: 14, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.660 Vali Acc: 0.850 Test Loss: 0.660 Test Acc: 0.850
Validation loss decreased (-0.816660 --> -0.849993).  Saving model ...
Epoch: 15 cost time: 1.0193116664886475
Epoch: 15, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.708 Vali Acc: 0.844 Test Loss: 0.708 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9392893314361572
Epoch: 16, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.775 Vali Acc: 0.844 Test Loss: 0.775 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0089898109436035
Epoch: 17, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.772 Vali Acc: 0.839 Test Loss: 0.772 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9465672969818115
Epoch: 18, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.719 Vali Acc: 0.856 Test Loss: 0.719 Test Acc: 0.856
Validation loss decreased (-0.849993 --> -0.855548).  Saving model ...
Epoch: 19 cost time: 0.9039762020111084
Epoch: 19, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.890 Vali Acc: 0.839 Test Loss: 0.890 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0040218830108643
Epoch: 20, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.873 Vali Acc: 0.817 Test Loss: 0.873 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8910729885101318
Epoch: 21, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.839 Vali Acc: 0.856 Test Loss: 0.839 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9322607517242432
Epoch: 22, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.793 Vali Acc: 0.844 Test Loss: 0.793 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9918043613433838
Epoch: 23, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.845 Vali Acc: 0.850 Test Loss: 0.845 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9940526485443115
Epoch: 24, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.819 Vali Acc: 0.872 Test Loss: 0.819 Test Acc: 0.872
Validation loss decreased (-0.855548 --> -0.872214).  Saving model ...
Epoch: 25 cost time: 1.0504426956176758
Epoch: 25, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.808 Vali Acc: 0.850 Test Loss: 0.808 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9760382175445557
Epoch: 26, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.876 Vali Acc: 0.844 Test Loss: 0.876 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0339157581329346
Epoch: 27, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.908 Vali Acc: 0.856 Test Loss: 0.908 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0280725955963135
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.904 Vali Acc: 0.850 Test Loss: 0.904 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9198803901672363
Epoch: 29, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.882 Vali Acc: 0.856 Test Loss: 0.882 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9743750095367432
Epoch: 30, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.881 Vali Acc: 0.856 Test Loss: 0.881 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0319063663482666
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.878 Vali Acc: 0.856 Test Loss: 0.878 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.0134692192077637
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.892 Vali Acc: 0.856 Test Loss: 0.892 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0729053020477295
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.901 Vali Acc: 0.861 Test Loss: 0.901 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.103708028793335
Epoch: 34, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.895 Vali Acc: 0.861 Test Loss: 0.895 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 448143
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.185035467147827
Epoch: 1, Steps: 12 | Train Loss: 2.666 Vali Loss: 2.562 Vali Acc: 0.150 Test Loss: 2.562 Test Acc: 0.150
Validation loss decreased (inf --> -0.149974).  Saving model ...
Epoch: 2 cost time: 0.84295654296875
Epoch: 2, Steps: 12 | Train Loss: 2.157 Vali Loss: 2.105 Vali Acc: 0.417 Test Loss: 2.105 Test Acc: 0.417
Validation loss decreased (-0.149974 --> -0.416646).  Saving model ...
Epoch: 3 cost time: 0.8270540237426758
Epoch: 3, Steps: 12 | Train Loss: 1.641 Vali Loss: 1.641 Vali Acc: 0.567 Test Loss: 1.641 Test Acc: 0.567
Validation loss decreased (-0.416646 --> -0.566650).  Saving model ...
Epoch: 4 cost time: 0.8855047225952148
Epoch: 4, Steps: 12 | Train Loss: 1.212 Vali Loss: 1.343 Vali Acc: 0.639 Test Loss: 1.343 Test Acc: 0.639
Validation loss decreased (-0.566650 --> -0.638875).  Saving model ...
Epoch: 5 cost time: 0.9114861488342285
Epoch: 5, Steps: 12 | Train Loss: 0.947 Vali Loss: 1.135 Vali Acc: 0.656 Test Loss: 1.135 Test Acc: 0.656
Validation loss decreased (-0.638875 --> -0.655544).  Saving model ...
Epoch: 6 cost time: 0.8466110229492188
Epoch: 6, Steps: 12 | Train Loss: 0.783 Vali Loss: 1.016 Vali Acc: 0.694 Test Loss: 1.016 Test Acc: 0.694
Validation loss decreased (-0.655544 --> -0.694434).  Saving model ...
Epoch: 7 cost time: 0.8895878791809082
Epoch: 7, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.925 Vali Acc: 0.722 Test Loss: 0.925 Test Acc: 0.722
Validation loss decreased (-0.694434 --> -0.722213).  Saving model ...
Epoch: 8 cost time: 0.8048417568206787
Epoch: 8, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.841 Vali Acc: 0.744 Test Loss: 0.841 Test Acc: 0.744
Validation loss decreased (-0.722213 --> -0.744436).  Saving model ...
Epoch: 9 cost time: 0.8655626773834229
Epoch: 9, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.820 Vali Acc: 0.733 Test Loss: 0.820 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8217768669128418
Epoch: 10, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.763 Vali Acc: 0.794 Test Loss: 0.763 Test Acc: 0.794
Validation loss decreased (-0.744436 --> -0.794437).  Saving model ...
Epoch: 11 cost time: 0.7615835666656494
Epoch: 11, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.735 Vali Acc: 0.800 Test Loss: 0.735 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 0.8418734073638916
Epoch: 12, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.674 Vali Acc: 0.806 Test Loss: 0.674 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 13 cost time: 0.8838651180267334
Epoch: 13, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.677 Vali Acc: 0.806 Test Loss: 0.677 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8485620021820068
Epoch: 14, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.605 Vali Acc: 0.844 Test Loss: 0.605 Test Acc: 0.844
Validation loss decreased (-0.805549 --> -0.844438).  Saving model ...
Epoch: 15 cost time: 0.8945379257202148
Epoch: 15, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.601 Vali Acc: 0.839 Test Loss: 0.601 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8413829803466797
Epoch: 16, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.580 Vali Acc: 0.844 Test Loss: 0.580 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844439).  Saving model ...
Epoch: 17 cost time: 0.8863677978515625
Epoch: 17, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.601 Vali Acc: 0.839 Test Loss: 0.601 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8649952411651611
Epoch: 18, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.649 Vali Acc: 0.844 Test Loss: 0.649 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8000016212463379
Epoch: 19, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.611 Vali Acc: 0.833 Test Loss: 0.611 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7881016731262207
Epoch: 20, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.656 Vali Acc: 0.850 Test Loss: 0.656 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849993).  Saving model ...
Epoch: 21 cost time: 0.8054385185241699
Epoch: 21, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.658 Vali Acc: 0.856 Test Loss: 0.658 Test Acc: 0.856
Validation loss decreased (-0.849993 --> -0.855549).  Saving model ...
Epoch: 22 cost time: 0.8469381332397461
Epoch: 22, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.670 Vali Acc: 0.856 Test Loss: 0.670 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8213696479797363
Epoch: 23, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.693 Vali Acc: 0.867 Test Loss: 0.693 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866660).  Saving model ...
Epoch: 24 cost time: 0.8455002307891846
Epoch: 24, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.699 Vali Acc: 0.856 Test Loss: 0.699 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.827960729598999
Epoch: 25, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.641 Vali Acc: 0.867 Test Loss: 0.641 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866660).  Saving model ...
Epoch: 26 cost time: 0.8819327354431152
Epoch: 26, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.689 Vali Acc: 0.867 Test Loss: 0.689 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9122269153594971
Epoch: 27, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.739 Vali Acc: 0.856 Test Loss: 0.739 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8815641403198242
Epoch: 28, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.792 Vali Acc: 0.850 Test Loss: 0.792 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9023661613464355
Epoch: 29, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.784 Vali Acc: 0.856 Test Loss: 0.784 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8131673336029053
Epoch: 30, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.759 Vali Acc: 0.850 Test Loss: 0.759 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9091613292694092
Epoch: 31, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.821 Vali Acc: 0.844 Test Loss: 0.821 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.853844165802002
Epoch: 32, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.821 Vali Acc: 0.861 Test Loss: 0.821 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8360393047332764
Epoch: 33, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.857 Vali Acc: 0.839 Test Loss: 0.857 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8086464405059814
Epoch: 34, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.844 Vali Acc: 0.850 Test Loss: 0.844 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.8125007152557373
Epoch: 35, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.867 Vali Acc: 0.844 Test Loss: 0.867 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 359951
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1724817752838135
Epoch: 1, Steps: 12 | Train Loss: 2.724 Vali Loss: 2.540 Vali Acc: 0.178 Test Loss: 2.540 Test Acc: 0.178
Validation loss decreased (inf --> -0.177752).  Saving model ...
Epoch: 2 cost time: 0.8269021511077881
Epoch: 2, Steps: 12 | Train Loss: 2.224 Vali Loss: 2.074 Vali Acc: 0.506 Test Loss: 2.074 Test Acc: 0.506
Validation loss decreased (-0.177752 --> -0.505535).  Saving model ...
Epoch: 3 cost time: 0.8190581798553467
Epoch: 3, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.610 Vali Acc: 0.628 Test Loss: 1.610 Test Acc: 0.628
Validation loss decreased (-0.505535 --> -0.627762).  Saving model ...
Epoch: 4 cost time: 0.8736298084259033
Epoch: 4, Steps: 12 | Train Loss: 1.287 Vali Loss: 1.289 Vali Acc: 0.672 Test Loss: 1.289 Test Acc: 0.672
Validation loss decreased (-0.627762 --> -0.672209).  Saving model ...
Epoch: 5 cost time: 0.8573358058929443
Epoch: 5, Steps: 12 | Train Loss: 0.936 Vali Loss: 1.107 Vali Acc: 0.683 Test Loss: 1.107 Test Acc: 0.683
Validation loss decreased (-0.672209 --> -0.683322).  Saving model ...
Epoch: 6 cost time: 0.8261153697967529
Epoch: 6, Steps: 12 | Train Loss: 0.738 Vali Loss: 0.969 Vali Acc: 0.733 Test Loss: 0.969 Test Acc: 0.733
Validation loss decreased (-0.683322 --> -0.733324).  Saving model ...
Epoch: 7 cost time: 0.907900333404541
Epoch: 7, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.881 Vali Acc: 0.744 Test Loss: 0.881 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744436).  Saving model ...
Epoch: 8 cost time: 0.8919854164123535
Epoch: 8, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.824 Vali Acc: 0.761 Test Loss: 0.824 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761103).  Saving model ...
Epoch: 9 cost time: 0.8692963123321533
Epoch: 9, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.754 Vali Acc: 0.767 Test Loss: 0.754 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766659).  Saving model ...
Epoch: 10 cost time: 0.897881269454956
Epoch: 10, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.706 Vali Acc: 0.817 Test Loss: 0.706 Test Acc: 0.817
Validation loss decreased (-0.766659 --> -0.816660).  Saving model ...
Epoch: 11 cost time: 0.8198137283325195
Epoch: 11, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.683 Vali Acc: 0.811 Test Loss: 0.683 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8555328845977783
Epoch: 12, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.644 Vali Acc: 0.811 Test Loss: 0.644 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8245861530303955
Epoch: 13, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.607 Vali Acc: 0.839 Test Loss: 0.607 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838883).  Saving model ...
Epoch: 14 cost time: 0.7924802303314209
Epoch: 14, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.605 Vali Acc: 0.811 Test Loss: 0.605 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8474290370941162
Epoch: 15, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.605 Vali Acc: 0.833 Test Loss: 0.605 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8423805236816406
Epoch: 16, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.603 Vali Acc: 0.844 Test Loss: 0.603 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 17 cost time: 0.8493027687072754
Epoch: 17, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.617 Vali Acc: 0.828 Test Loss: 0.617 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.85164475440979
Epoch: 18, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.594 Vali Acc: 0.839 Test Loss: 0.594 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8677074909210205
Epoch: 19, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.580 Vali Acc: 0.844 Test Loss: 0.580 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844439).  Saving model ...
Epoch: 20 cost time: 0.8724772930145264
Epoch: 20, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.616 Vali Acc: 0.839 Test Loss: 0.616 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9483728408813477
Epoch: 21, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.611 Vali Acc: 0.844 Test Loss: 0.611 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.898432731628418
Epoch: 22, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.638 Vali Acc: 0.867 Test Loss: 0.638 Test Acc: 0.867
Validation loss decreased (-0.844439 --> -0.866660).  Saving model ...
Epoch: 23 cost time: 0.8344442844390869
Epoch: 23, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.659 Vali Acc: 0.867 Test Loss: 0.659 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8182027339935303
Epoch: 24, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.677 Vali Acc: 0.867 Test Loss: 0.677 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.795482873916626
Epoch: 25, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.698 Vali Acc: 0.833 Test Loss: 0.698 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8554608821868896
Epoch: 26, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.701 Vali Acc: 0.861 Test Loss: 0.701 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9508469104766846
Epoch: 27, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.669 Vali Acc: 0.850 Test Loss: 0.669 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8229613304138184
Epoch: 28, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.703 Vali Acc: 0.867 Test Loss: 0.703 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8506307601928711
Epoch: 29, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.741 Vali Acc: 0.856 Test Loss: 0.741 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.824941873550415
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.724 Vali Acc: 0.861 Test Loss: 0.724 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9044380187988281
Epoch: 31, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.752 Vali Acc: 0.856 Test Loss: 0.752 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8489587306976318
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.745 Vali Acc: 0.861 Test Loss: 0.745 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 360079
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1245102882385254
Epoch: 1, Steps: 12 | Train Loss: 2.734 Vali Loss: 2.601 Vali Acc: 0.133 Test Loss: 2.601 Test Acc: 0.133
Validation loss decreased (inf --> -0.133307).  Saving model ...
Epoch: 2 cost time: 0.804063081741333
Epoch: 2, Steps: 12 | Train Loss: 2.356 Vali Loss: 2.277 Vali Acc: 0.433 Test Loss: 2.277 Test Acc: 0.433
Validation loss decreased (-0.133307 --> -0.433311).  Saving model ...
Epoch: 3 cost time: 0.810884952545166
Epoch: 3, Steps: 12 | Train Loss: 1.859 Vali Loss: 1.861 Vali Acc: 0.600 Test Loss: 1.861 Test Acc: 0.600
Validation loss decreased (-0.433311 --> -0.599981).  Saving model ...
Epoch: 4 cost time: 0.793952465057373
Epoch: 4, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.503 Vali Acc: 0.650 Test Loss: 1.503 Test Acc: 0.650
Validation loss decreased (-0.599981 --> -0.649985).  Saving model ...
Epoch: 5 cost time: 0.7941555976867676
Epoch: 5, Steps: 12 | Train Loss: 1.183 Vali Loss: 1.273 Vali Acc: 0.678 Test Loss: 1.273 Test Acc: 0.678
Validation loss decreased (-0.649985 --> -0.677765).  Saving model ...
Epoch: 6 cost time: 0.8252549171447754
Epoch: 6, Steps: 12 | Train Loss: 0.925 Vali Loss: 1.111 Vali Acc: 0.689 Test Loss: 1.111 Test Acc: 0.689
Validation loss decreased (-0.677765 --> -0.688878).  Saving model ...
Epoch: 7 cost time: 0.8002936840057373
Epoch: 7, Steps: 12 | Train Loss: 0.810 Vali Loss: 1.013 Vali Acc: 0.706 Test Loss: 1.013 Test Acc: 0.706
Validation loss decreased (-0.688878 --> -0.705545).  Saving model ...
Epoch: 8 cost time: 0.797767162322998
Epoch: 8, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.921 Vali Acc: 0.744 Test Loss: 0.921 Test Acc: 0.744
Validation loss decreased (-0.705545 --> -0.744435).  Saving model ...
Epoch: 9 cost time: 0.8185939788818359
Epoch: 9, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.850 Vali Acc: 0.750 Test Loss: 0.850 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749992).  Saving model ...
Epoch: 10 cost time: 0.8066215515136719
Epoch: 10, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.813 Vali Acc: 0.761 Test Loss: 0.813 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761103).  Saving model ...
Epoch: 11 cost time: 0.8130950927734375
Epoch: 11, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.735 Vali Acc: 0.811 Test Loss: 0.735 Test Acc: 0.811
Validation loss decreased (-0.761103 --> -0.811104).  Saving model ...
Epoch: 12 cost time: 0.8759331703186035
Epoch: 12, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.715 Vali Acc: 0.794 Test Loss: 0.715 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8316690921783447
Epoch: 13, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.654 Vali Acc: 0.811 Test Loss: 0.654 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811105).  Saving model ...
Epoch: 14 cost time: 0.8057701587677002
Epoch: 14, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.630 Vali Acc: 0.833 Test Loss: 0.630 Test Acc: 0.833
Validation loss decreased (-0.811105 --> -0.833327).  Saving model ...
Epoch: 15 cost time: 0.7917089462280273
Epoch: 15, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.591 Vali Acc: 0.844 Test Loss: 0.591 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844439).  Saving model ...
Epoch: 16 cost time: 0.8896872997283936
Epoch: 16, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.572 Vali Acc: 0.850 Test Loss: 0.572 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 0.8252353668212891
Epoch: 17, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.583 Vali Acc: 0.850 Test Loss: 0.583 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8113677501678467
Epoch: 18, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.578 Vali Acc: 0.856 Test Loss: 0.578 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 19 cost time: 0.8075911998748779
Epoch: 19, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.542 Vali Acc: 0.844 Test Loss: 0.542 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8592963218688965
Epoch: 20, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.548 Vali Acc: 0.856 Test Loss: 0.548 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 21 cost time: 0.7749617099761963
Epoch: 21, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.565 Vali Acc: 0.861 Test Loss: 0.565 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 22 cost time: 0.7994740009307861
Epoch: 22, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.570 Vali Acc: 0.856 Test Loss: 0.570 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7893984317779541
Epoch: 23, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.614 Vali Acc: 0.867 Test Loss: 0.614 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 24 cost time: 0.8416991233825684
Epoch: 24, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.596 Vali Acc: 0.872 Test Loss: 0.596 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 25 cost time: 0.782569408416748
Epoch: 25, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.653 Vali Acc: 0.872 Test Loss: 0.653 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8096308708190918
Epoch: 26, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.641 Vali Acc: 0.861 Test Loss: 0.641 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8198051452636719
Epoch: 27, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.632 Vali Acc: 0.894 Test Loss: 0.632 Test Acc: 0.894
Validation loss decreased (-0.872216 --> -0.894438).  Saving model ...
Epoch: 28 cost time: 0.8235630989074707
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.620 Vali Acc: 0.878 Test Loss: 0.620 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8197813034057617
Epoch: 29, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.621 Vali Acc: 0.883 Test Loss: 0.621 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7935135364532471
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.664 Vali Acc: 0.872 Test Loss: 0.664 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.813072919845581
Epoch: 31, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.651 Vali Acc: 0.867 Test Loss: 0.651 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7778711318969727
Epoch: 32, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.726 Vali Acc: 0.861 Test Loss: 0.726 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7884666919708252
Epoch: 33, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.715 Vali Acc: 0.861 Test Loss: 0.715 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8503720760345459
Epoch: 34, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.709 Vali Acc: 0.839 Test Loss: 0.709 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8141610622406006
Epoch: 35, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.746 Vali Acc: 0.856 Test Loss: 0.746 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8061933517456055
Epoch: 36, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.748 Vali Acc: 0.850 Test Loss: 0.748 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.8205630779266357
Epoch: 37, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.780 Vali Acc: 0.867 Test Loss: 0.780 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 333327
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0879311561584473
Epoch: 1, Steps: 12 | Train Loss: 2.741 Vali Loss: 2.591 Vali Acc: 0.122 Test Loss: 2.591 Test Acc: 0.122
Validation loss decreased (inf --> -0.122196).  Saving model ...
Epoch: 2 cost time: 0.7931737899780273
Epoch: 2, Steps: 12 | Train Loss: 2.462 Vali Loss: 2.310 Vali Acc: 0.306 Test Loss: 2.310 Test Acc: 0.306
Validation loss decreased (-0.122196 --> -0.305532).  Saving model ...
Epoch: 3 cost time: 0.7919230461120605
Epoch: 3, Steps: 12 | Train Loss: 2.041 Vali Loss: 1.980 Vali Acc: 0.506 Test Loss: 1.980 Test Acc: 0.506
Validation loss decreased (-0.305532 --> -0.505536).  Saving model ...
Epoch: 4 cost time: 0.8035335540771484
Epoch: 4, Steps: 12 | Train Loss: 1.692 Vali Loss: 1.654 Vali Acc: 0.644 Test Loss: 1.654 Test Acc: 0.644
Validation loss decreased (-0.505536 --> -0.644428).  Saving model ...
Epoch: 5 cost time: 0.8809771537780762
Epoch: 5, Steps: 12 | Train Loss: 1.376 Vali Loss: 1.424 Vali Acc: 0.661 Test Loss: 1.424 Test Acc: 0.661
Validation loss decreased (-0.644428 --> -0.661097).  Saving model ...
Epoch: 6 cost time: 0.8627502918243408
Epoch: 6, Steps: 12 | Train Loss: 1.164 Vali Loss: 1.248 Vali Acc: 0.683 Test Loss: 1.248 Test Acc: 0.683
Validation loss decreased (-0.661097 --> -0.683321).  Saving model ...
Epoch: 7 cost time: 0.8057188987731934
Epoch: 7, Steps: 12 | Train Loss: 0.923 Vali Loss: 1.103 Vali Acc: 0.717 Test Loss: 1.103 Test Acc: 0.717
Validation loss decreased (-0.683321 --> -0.716656).  Saving model ...
Epoch: 8 cost time: 0.8503589630126953
Epoch: 8, Steps: 12 | Train Loss: 0.809 Vali Loss: 1.027 Vali Acc: 0.722 Test Loss: 1.027 Test Acc: 0.722
Validation loss decreased (-0.716656 --> -0.722212).  Saving model ...
Epoch: 9 cost time: 0.7669918537139893
Epoch: 9, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.936 Vali Acc: 0.733 Test Loss: 0.936 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733324).  Saving model ...
Epoch: 10 cost time: 0.7807624340057373
Epoch: 10, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.882 Vali Acc: 0.739 Test Loss: 0.882 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738880).  Saving model ...
Epoch: 11 cost time: 0.8231472969055176
Epoch: 11, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.778 Vali Acc: 0.761 Test Loss: 0.778 Test Acc: 0.761
Validation loss decreased (-0.738880 --> -0.761103).  Saving model ...
Epoch: 12 cost time: 0.7862522602081299
Epoch: 12, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.730 Vali Acc: 0.778 Test Loss: 0.730 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777770).  Saving model ...
Epoch: 13 cost time: 0.8587126731872559
Epoch: 13, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.700 Vali Acc: 0.783 Test Loss: 0.700 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783326).  Saving model ...
Epoch: 14 cost time: 0.8118240833282471
Epoch: 14, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.666 Vali Acc: 0.828 Test Loss: 0.666 Test Acc: 0.828
Validation loss decreased (-0.783326 --> -0.827771).  Saving model ...
Epoch: 15 cost time: 0.7886011600494385
Epoch: 15, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.600 Vali Acc: 0.833 Test Loss: 0.600 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 0.8557586669921875
Epoch: 16, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.600 Vali Acc: 0.828 Test Loss: 0.600 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8281259536743164
Epoch: 17, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.590 Vali Acc: 0.833 Test Loss: 0.590 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 18 cost time: 0.8396174907684326
Epoch: 18, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.582 Vali Acc: 0.867 Test Loss: 0.582 Test Acc: 0.867
Validation loss decreased (-0.833327 --> -0.866661).  Saving model ...
Epoch: 19 cost time: 0.8208930492401123
Epoch: 19, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.565 Vali Acc: 0.844 Test Loss: 0.565 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7272899150848389
Epoch: 20, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.557 Vali Acc: 0.867 Test Loss: 0.557 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 21 cost time: 0.7509596347808838
Epoch: 21, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7756576538085938
Epoch: 22, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.549 Vali Acc: 0.839 Test Loss: 0.549 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7941656112670898
Epoch: 23, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.567 Vali Acc: 0.839 Test Loss: 0.567 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7872927188873291
Epoch: 24, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.612 Vali Acc: 0.822 Test Loss: 0.612 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7478156089782715
Epoch: 25, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.583 Vali Acc: 0.850 Test Loss: 0.583 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8524351119995117
Epoch: 26, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.539 Vali Acc: 0.872 Test Loss: 0.539 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 27 cost time: 0.8484547138214111
Epoch: 27, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.570 Vali Acc: 0.867 Test Loss: 0.570 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7981922626495361
Epoch: 28, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.582 Vali Acc: 0.856 Test Loss: 0.582 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8066167831420898
Epoch: 29, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.584 Vali Acc: 0.861 Test Loss: 0.584 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7978193759918213
Epoch: 30, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.606 Vali Acc: 0.850 Test Loss: 0.606 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7476937770843506
Epoch: 31, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.648 Vali Acc: 0.850 Test Loss: 0.648 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7355248928070068
Epoch: 32, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.681 Vali Acc: 0.850 Test Loss: 0.681 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7670793533325195
Epoch: 33, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.623 Vali Acc: 0.856 Test Loss: 0.623 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8182690143585205
Epoch: 34, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.657 Vali Acc: 0.856 Test Loss: 0.657 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8111510276794434
Epoch: 35, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.672 Vali Acc: 0.844 Test Loss: 0.672 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.7974193096160889
Epoch: 36, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.637 Vali Acc: 0.850 Test Loss: 0.637 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 318223
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0346407890319824
Epoch: 1, Steps: 12 | Train Loss: 2.718 Vali Loss: 2.619 Vali Acc: 0.133 Test Loss: 2.619 Test Acc: 0.133
Validation loss decreased (inf --> -0.133307).  Saving model ...
Epoch: 2 cost time: 0.7647573947906494
Epoch: 2, Steps: 12 | Train Loss: 2.487 Vali Loss: 2.378 Vali Acc: 0.300 Test Loss: 2.378 Test Acc: 0.300
Validation loss decreased (-0.133307 --> -0.299976).  Saving model ...
Epoch: 3 cost time: 0.7817018032073975
Epoch: 3, Steps: 12 | Train Loss: 2.134 Vali Loss: 2.049 Vali Acc: 0.506 Test Loss: 2.049 Test Acc: 0.506
Validation loss decreased (-0.299976 --> -0.505535).  Saving model ...
Epoch: 4 cost time: 0.7968683242797852
Epoch: 4, Steps: 12 | Train Loss: 1.774 Vali Loss: 1.727 Vali Acc: 0.600 Test Loss: 1.727 Test Acc: 0.600
Validation loss decreased (-0.505535 --> -0.599983).  Saving model ...
Epoch: 5 cost time: 0.8169467449188232
Epoch: 5, Steps: 12 | Train Loss: 1.419 Vali Loss: 1.494 Vali Acc: 0.650 Test Loss: 1.494 Test Acc: 0.650
Validation loss decreased (-0.599983 --> -0.649985).  Saving model ...
Epoch: 6 cost time: 0.8168315887451172
Epoch: 6, Steps: 12 | Train Loss: 1.184 Vali Loss: 1.282 Vali Acc: 0.722 Test Loss: 1.282 Test Acc: 0.722
Validation loss decreased (-0.649985 --> -0.722209).  Saving model ...
Epoch: 7 cost time: 0.7200798988342285
Epoch: 7, Steps: 12 | Train Loss: 1.006 Vali Loss: 1.147 Vali Acc: 0.683 Test Loss: 1.147 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8746943473815918
Epoch: 8, Steps: 12 | Train Loss: 0.845 Vali Loss: 1.038 Vali Acc: 0.711 Test Loss: 1.038 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8214800357818604
Epoch: 9, Steps: 12 | Train Loss: 0.707 Vali Loss: 0.957 Vali Acc: 0.744 Test Loss: 0.957 Test Acc: 0.744
Validation loss decreased (-0.722209 --> -0.744435).  Saving model ...
Epoch: 10 cost time: 0.8417530059814453
Epoch: 10, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.865 Vali Acc: 0.761 Test Loss: 0.865 Test Acc: 0.761
Validation loss decreased (-0.744435 --> -0.761102).  Saving model ...
Epoch: 11 cost time: 0.887138843536377
Epoch: 11, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.782 Vali Acc: 0.783 Test Loss: 0.782 Test Acc: 0.783
Validation loss decreased (-0.761102 --> -0.783326).  Saving model ...
Epoch: 12 cost time: 0.6427216529846191
Epoch: 12, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.737 Vali Acc: 0.783 Test Loss: 0.737 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783326).  Saving model ...
Epoch: 13 cost time: 0.8201367855072021
Epoch: 13, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.692 Vali Acc: 0.822 Test Loss: 0.692 Test Acc: 0.822
Validation loss decreased (-0.783326 --> -0.822215).  Saving model ...
Epoch: 14 cost time: 0.7631540298461914
Epoch: 14, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.659 Vali Acc: 0.806 Test Loss: 0.659 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8288273811340332
Epoch: 15, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.646 Vali Acc: 0.806 Test Loss: 0.646 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.823136568069458
Epoch: 16, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.623 Vali Acc: 0.822 Test Loss: 0.623 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822216).  Saving model ...
Epoch: 17 cost time: 0.7923643589019775
Epoch: 17, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.582 Vali Acc: 0.828 Test Loss: 0.582 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 18 cost time: 0.7305042743682861
Epoch: 18, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.564 Vali Acc: 0.839 Test Loss: 0.564 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 19 cost time: 0.798119068145752
Epoch: 19, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 0.8453471660614014
Epoch: 20, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.555 Vali Acc: 0.844 Test Loss: 0.555 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.860015869140625
Epoch: 21, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8317763805389404
Epoch: 22, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 0.8084778785705566
Epoch: 23, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8006992340087891
Epoch: 24, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.559 Vali Acc: 0.850 Test Loss: 0.559 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.800032377243042
Epoch: 25, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.560 Vali Acc: 0.856 Test Loss: 0.560 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 26 cost time: 0.7742209434509277
Epoch: 26, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7850766181945801
Epoch: 27, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.555 Vali Acc: 0.844 Test Loss: 0.555 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7973535060882568
Epoch: 28, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.592 Vali Acc: 0.872 Test Loss: 0.592 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872216).  Saving model ...
Epoch: 29 cost time: 0.777289867401123
Epoch: 29, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.749575138092041
Epoch: 30, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.81671142578125
Epoch: 31, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.616 Vali Acc: 0.856 Test Loss: 0.616 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.783191442489624
Epoch: 32, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.611 Vali Acc: 0.878 Test Loss: 0.611 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 33 cost time: 0.8382513523101807
Epoch: 33, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.612 Vali Acc: 0.867 Test Loss: 0.612 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8059506416320801
Epoch: 34, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8160021305084229
Epoch: 35, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.629 Vali Acc: 0.856 Test Loss: 0.629 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8834121227264404
Epoch: 36, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.633 Vali Acc: 0.839 Test Loss: 0.633 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8365049362182617
Epoch: 37, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.656 Vali Acc: 0.856 Test Loss: 0.656 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.8065178394317627
Epoch: 38, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.657 Vali Acc: 0.850 Test Loss: 0.657 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.7923507690429688
Epoch: 39, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.629 Vali Acc: 0.867 Test Loss: 0.629 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.7871794700622559
Epoch: 40, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.657 Vali Acc: 0.861 Test Loss: 0.657 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.837228536605835
Epoch: 41, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.648 Vali Acc: 0.856 Test Loss: 0.648 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.8044300079345703
Epoch: 42, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.637 Vali Acc: 0.844 Test Loss: 0.637 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 310799
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1395421028137207
Epoch: 1, Steps: 12 | Train Loss: 2.791 Vali Loss: 2.739 Vali Acc: 0.072 Test Loss: 2.739 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 0.7777111530303955
Epoch: 2, Steps: 12 | Train Loss: 2.553 Vali Loss: 2.542 Vali Acc: 0.206 Test Loss: 2.542 Test Acc: 0.206
Validation loss decreased (-0.072195 --> -0.205530).  Saving model ...
Epoch: 3 cost time: 0.7971408367156982
Epoch: 3, Steps: 12 | Train Loss: 2.307 Vali Loss: 2.243 Vali Acc: 0.400 Test Loss: 2.243 Test Acc: 0.400
Validation loss decreased (-0.205530 --> -0.399978).  Saving model ...
Epoch: 4 cost time: 0.8308696746826172
Epoch: 4, Steps: 12 | Train Loss: 1.943 Vali Loss: 1.943 Vali Acc: 0.500 Test Loss: 1.943 Test Acc: 0.500
Validation loss decreased (-0.399978 --> -0.499981).  Saving model ...
Epoch: 5 cost time: 0.8237090110778809
Epoch: 5, Steps: 12 | Train Loss: 1.622 Vali Loss: 1.669 Vali Acc: 0.594 Test Loss: 1.669 Test Acc: 0.594
Validation loss decreased (-0.499981 --> -0.594428).  Saving model ...
Epoch: 6 cost time: 0.9909818172454834
Epoch: 6, Steps: 12 | Train Loss: 1.436 Vali Loss: 1.449 Vali Acc: 0.628 Test Loss: 1.449 Test Acc: 0.628
Validation loss decreased (-0.594428 --> -0.627763).  Saving model ...
Epoch: 7 cost time: 0.9129889011383057
Epoch: 7, Steps: 12 | Train Loss: 1.210 Vali Loss: 1.266 Vali Acc: 0.689 Test Loss: 1.266 Test Acc: 0.689
Validation loss decreased (-0.627763 --> -0.688876).  Saving model ...
Epoch: 8 cost time: 0.8902382850646973
Epoch: 8, Steps: 12 | Train Loss: 1.017 Vali Loss: 1.124 Vali Acc: 0.706 Test Loss: 1.124 Test Acc: 0.706
Validation loss decreased (-0.688876 --> -0.705544).  Saving model ...
Epoch: 9 cost time: 0.8826241493225098
Epoch: 9, Steps: 12 | Train Loss: 0.865 Vali Loss: 1.026 Vali Acc: 0.739 Test Loss: 1.026 Test Acc: 0.739
Validation loss decreased (-0.705544 --> -0.738879).  Saving model ...
Epoch: 10 cost time: 0.812279462814331
Epoch: 10, Steps: 12 | Train Loss: 0.759 Vali Loss: 0.925 Vali Acc: 0.750 Test Loss: 0.925 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749991).  Saving model ...
Epoch: 11 cost time: 0.8616232872009277
Epoch: 11, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.868 Vali Acc: 0.750 Test Loss: 0.868 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 12 cost time: 0.8200008869171143
Epoch: 12, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.800 Vali Acc: 0.756 Test Loss: 0.800 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.755548).  Saving model ...
Epoch: 13 cost time: 0.9233083724975586
Epoch: 13, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.754 Vali Acc: 0.783 Test Loss: 0.754 Test Acc: 0.783
Validation loss decreased (-0.755548 --> -0.783326).  Saving model ...
Epoch: 14 cost time: 0.8559167385101318
Epoch: 14, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.719 Vali Acc: 0.789 Test Loss: 0.719 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 15 cost time: 0.8163511753082275
Epoch: 15, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.658 Vali Acc: 0.817 Test Loss: 0.658 Test Acc: 0.817
Validation loss decreased (-0.788882 --> -0.816660).  Saving model ...
Epoch: 16 cost time: 0.8021619319915771
Epoch: 16, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.631 Vali Acc: 0.839 Test Loss: 0.631 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838883).  Saving model ...
Epoch: 17 cost time: 0.9127984046936035
Epoch: 17, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.605 Vali Acc: 0.828 Test Loss: 0.605 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8305058479309082
Epoch: 18, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.597 Vali Acc: 0.839 Test Loss: 0.597 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 19 cost time: 0.7831006050109863
Epoch: 19, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.589 Vali Acc: 0.817 Test Loss: 0.589 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8748672008514404
Epoch: 20, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.554 Vali Acc: 0.839 Test Loss: 0.554 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 21 cost time: 0.745783805847168
Epoch: 21, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.538 Vali Acc: 0.867 Test Loss: 0.538 Test Acc: 0.867
Validation loss decreased (-0.838883 --> -0.866661).  Saving model ...
Epoch: 22 cost time: 0.7758698463439941
Epoch: 22, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8074727058410645
Epoch: 23, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.530 Vali Acc: 0.856 Test Loss: 0.530 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8542845249176025
Epoch: 24, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.514 Vali Acc: 0.861 Test Loss: 0.514 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8295438289642334
Epoch: 25, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7746672630310059
Epoch: 26, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.560 Vali Acc: 0.861 Test Loss: 0.560 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8361270427703857
Epoch: 27, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.527 Vali Acc: 0.861 Test Loss: 0.527 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8929696083068848
Epoch: 28, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.546 Vali Acc: 0.861 Test Loss: 0.546 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8949594497680664
Epoch: 29, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8030622005462646
Epoch: 30, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8330469131469727
Epoch: 31, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.539 Vali Acc: 0.872 Test Loss: 0.539 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 32 cost time: 0.8563094139099121
Epoch: 32, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.554 Vali Acc: 0.850 Test Loss: 0.554 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8669862747192383
Epoch: 33, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.538 Vali Acc: 0.872 Test Loss: 0.538 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 34 cost time: 0.9149067401885986
Epoch: 34, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.561 Vali Acc: 0.856 Test Loss: 0.561 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8019583225250244
Epoch: 35, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.581 Vali Acc: 0.861 Test Loss: 0.581 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8254227638244629
Epoch: 36, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.571 Vali Acc: 0.867 Test Loss: 0.571 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8916406631469727
Epoch: 37, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.559 Vali Acc: 0.889 Test Loss: 0.559 Test Acc: 0.889
Validation loss decreased (-0.872217 --> -0.888883).  Saving model ...
Epoch: 38 cost time: 0.7954566478729248
Epoch: 38, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.555 Vali Acc: 0.867 Test Loss: 0.555 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.792639970779419
Epoch: 39, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.583 Vali Acc: 0.872 Test Loss: 0.583 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8175191879272461
Epoch: 40, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.614 Vali Acc: 0.872 Test Loss: 0.614 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7649664878845215
Epoch: 41, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.612 Vali Acc: 0.856 Test Loss: 0.612 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7587072849273682
Epoch: 42, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.626 Vali Acc: 0.867 Test Loss: 0.626 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8695933818817139
Epoch: 43, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.610 Vali Acc: 0.883 Test Loss: 0.610 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8588778972625732
Epoch: 44, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.604 Vali Acc: 0.878 Test Loss: 0.604 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.8600401878356934
Epoch: 45, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.605 Vali Acc: 0.844 Test Loss: 0.605 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.874518632888794
Epoch: 46, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.650 Vali Acc: 0.889 Test Loss: 0.650 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.921522855758667
Epoch: 47, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.703 Vali Acc: 0.878 Test Loss: 0.703 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 303503
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.085620403289795
Epoch: 1, Steps: 12 | Train Loss: 2.726 Vali Loss: 2.545 Vali Acc: 0.172 Test Loss: 2.545 Test Acc: 0.172
Validation loss decreased (inf --> -0.172197).  Saving model ...
Epoch: 2 cost time: 0.7729699611663818
Epoch: 2, Steps: 12 | Train Loss: 2.217 Vali Loss: 2.109 Vali Acc: 0.467 Test Loss: 2.109 Test Acc: 0.467
Validation loss decreased (-0.172197 --> -0.466646).  Saving model ...
Epoch: 3 cost time: 0.8009655475616455
Epoch: 3, Steps: 12 | Train Loss: 1.695 Vali Loss: 1.633 Vali Acc: 0.600 Test Loss: 1.633 Test Acc: 0.600
Validation loss decreased (-0.466646 --> -0.599984).  Saving model ...
Epoch: 4 cost time: 0.7507212162017822
Epoch: 4, Steps: 12 | Train Loss: 1.276 Vali Loss: 1.346 Vali Acc: 0.656 Test Loss: 1.346 Test Acc: 0.656
Validation loss decreased (-0.599984 --> -0.655542).  Saving model ...
Epoch: 5 cost time: 0.7921719551086426
Epoch: 5, Steps: 12 | Train Loss: 0.971 Vali Loss: 1.136 Vali Acc: 0.683 Test Loss: 1.136 Test Acc: 0.683
Validation loss decreased (-0.655542 --> -0.683322).  Saving model ...
Epoch: 6 cost time: 0.8171417713165283
Epoch: 6, Steps: 12 | Train Loss: 0.801 Vali Loss: 1.018 Vali Acc: 0.711 Test Loss: 1.018 Test Acc: 0.711
Validation loss decreased (-0.683322 --> -0.711101).  Saving model ...
Epoch: 7 cost time: 0.8054993152618408
Epoch: 7, Steps: 12 | Train Loss: 0.667 Vali Loss: 0.903 Vali Acc: 0.717 Test Loss: 0.903 Test Acc: 0.717
Validation loss decreased (-0.711101 --> -0.716658).  Saving model ...
Epoch: 8 cost time: 0.8085668087005615
Epoch: 8, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.830 Vali Acc: 0.739 Test Loss: 0.830 Test Acc: 0.739
Validation loss decreased (-0.716658 --> -0.738881).  Saving model ...
Epoch: 9 cost time: 0.780362606048584
Epoch: 9, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.788 Vali Acc: 0.750 Test Loss: 0.788 Test Acc: 0.750
Validation loss decreased (-0.738881 --> -0.749992).  Saving model ...
Epoch: 10 cost time: 0.7336785793304443
Epoch: 10, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.775 Vali Acc: 0.772 Test Loss: 0.775 Test Acc: 0.772
Validation loss decreased (-0.749992 --> -0.772214).  Saving model ...
Epoch: 11 cost time: 0.7595374584197998
Epoch: 11, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.701 Vali Acc: 0.783 Test Loss: 0.701 Test Acc: 0.783
Validation loss decreased (-0.772214 --> -0.783326).  Saving model ...
Epoch: 12 cost time: 0.7716014385223389
Epoch: 12, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.698 Vali Acc: 0.806 Test Loss: 0.698 Test Acc: 0.806
Validation loss decreased (-0.783326 --> -0.805549).  Saving model ...
Epoch: 13 cost time: 0.8128719329833984
Epoch: 13, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.734 Vali Acc: 0.806 Test Loss: 0.734 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8103899955749512
Epoch: 14, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.649 Vali Acc: 0.828 Test Loss: 0.649 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827771).  Saving model ...
Epoch: 15 cost time: 0.8114383220672607
Epoch: 15, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.631 Vali Acc: 0.856 Test Loss: 0.631 Test Acc: 0.856
Validation loss decreased (-0.827771 --> -0.855549).  Saving model ...
Epoch: 16 cost time: 0.847649097442627
Epoch: 16, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7836802005767822
Epoch: 17, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7876741886138916
Epoch: 18, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.623 Vali Acc: 0.844 Test Loss: 0.623 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7908737659454346
Epoch: 19, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.602 Vali Acc: 0.844 Test Loss: 0.602 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.757354736328125
Epoch: 20, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.617 Vali Acc: 0.856 Test Loss: 0.617 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 21 cost time: 0.810014009475708
Epoch: 21, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.658 Vali Acc: 0.828 Test Loss: 0.658 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8057765960693359
Epoch: 22, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.652 Vali Acc: 0.861 Test Loss: 0.652 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 23 cost time: 0.8187782764434814
Epoch: 23, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.635 Vali Acc: 0.844 Test Loss: 0.635 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.83748459815979
Epoch: 24, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.679 Vali Acc: 0.850 Test Loss: 0.679 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8296453952789307
Epoch: 25, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.713 Vali Acc: 0.856 Test Loss: 0.713 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7569291591644287
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.699 Vali Acc: 0.856 Test Loss: 0.699 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7464654445648193
Epoch: 27, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.715 Vali Acc: 0.856 Test Loss: 0.715 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7879452705383301
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.783 Vali Acc: 0.850 Test Loss: 0.783 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7721152305603027
Epoch: 29, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.758 Vali Acc: 0.839 Test Loss: 0.758 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7984089851379395
Epoch: 30, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.743 Vali Acc: 0.850 Test Loss: 0.743 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7481367588043213
Epoch: 31, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.766 Vali Acc: 0.839 Test Loss: 0.766 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.769402027130127
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.845 Vali Acc: 0.850 Test Loss: 0.845 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 158543
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.03604793548584
Epoch: 1, Steps: 12 | Train Loss: 2.700 Vali Loss: 2.614 Vali Acc: 0.156 Test Loss: 2.614 Test Acc: 0.156
Validation loss decreased (inf --> -0.155529).  Saving model ...
Epoch: 2 cost time: 0.7586863040924072
Epoch: 2, Steps: 12 | Train Loss: 2.411 Vali Loss: 2.351 Vali Acc: 0.372 Test Loss: 2.351 Test Acc: 0.372
Validation loss decreased (-0.155529 --> -0.372199).  Saving model ...
Epoch: 3 cost time: 0.7612810134887695
Epoch: 3, Steps: 12 | Train Loss: 2.025 Vali Loss: 2.012 Vali Acc: 0.522 Test Loss: 2.012 Test Acc: 0.522
Validation loss decreased (-0.372199 --> -0.522202).  Saving model ...
Epoch: 4 cost time: 0.7782189846038818
Epoch: 4, Steps: 12 | Train Loss: 1.698 Vali Loss: 1.706 Vali Acc: 0.594 Test Loss: 1.706 Test Acc: 0.594
Validation loss decreased (-0.522202 --> -0.594427).  Saving model ...
Epoch: 5 cost time: 0.7486076354980469
Epoch: 5, Steps: 12 | Train Loss: 1.460 Vali Loss: 1.475 Vali Acc: 0.656 Test Loss: 1.475 Test Acc: 0.656
Validation loss decreased (-0.594427 --> -0.655541).  Saving model ...
Epoch: 6 cost time: 0.7431385517120361
Epoch: 6, Steps: 12 | Train Loss: 1.173 Vali Loss: 1.319 Vali Acc: 0.661 Test Loss: 1.319 Test Acc: 0.661
Validation loss decreased (-0.655541 --> -0.661098).  Saving model ...
Epoch: 7 cost time: 0.8338003158569336
Epoch: 7, Steps: 12 | Train Loss: 1.002 Vali Loss: 1.183 Vali Acc: 0.650 Test Loss: 1.183 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7565042972564697
Epoch: 8, Steps: 12 | Train Loss: 0.855 Vali Loss: 1.088 Vali Acc: 0.683 Test Loss: 1.088 Test Acc: 0.683
Validation loss decreased (-0.661098 --> -0.683322).  Saving model ...
Epoch: 9 cost time: 0.7448904514312744
Epoch: 9, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.999 Vali Acc: 0.711 Test Loss: 0.999 Test Acc: 0.711
Validation loss decreased (-0.683322 --> -0.711101).  Saving model ...
Epoch: 10 cost time: 0.7477462291717529
Epoch: 10, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.932 Vali Acc: 0.728 Test Loss: 0.932 Test Acc: 0.728
Validation loss decreased (-0.711101 --> -0.727768).  Saving model ...
Epoch: 11 cost time: 0.7599470615386963
Epoch: 11, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.873 Vali Acc: 0.728 Test Loss: 0.873 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727769).  Saving model ...
Epoch: 12 cost time: 0.7620937824249268
Epoch: 12, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.838 Vali Acc: 0.750 Test Loss: 0.838 Test Acc: 0.750
Validation loss decreased (-0.727769 --> -0.749992).  Saving model ...
Epoch: 13 cost time: 0.7233517169952393
Epoch: 13, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.799 Vali Acc: 0.761 Test Loss: 0.799 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761103).  Saving model ...
Epoch: 14 cost time: 0.6905553340911865
Epoch: 14, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.757 Vali Acc: 0.767 Test Loss: 0.757 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766659).  Saving model ...
Epoch: 15 cost time: 0.7151737213134766
Epoch: 15, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.701 Vali Acc: 0.789 Test Loss: 0.701 Test Acc: 0.789
Validation loss decreased (-0.766659 --> -0.788882).  Saving model ...
Epoch: 16 cost time: 0.7669785022735596
Epoch: 16, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.680 Vali Acc: 0.783 Test Loss: 0.680 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7739150524139404
Epoch: 17, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.629 Vali Acc: 0.806 Test Loss: 0.629 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805549).  Saving model ...
Epoch: 18 cost time: 0.7306058406829834
Epoch: 18, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.624 Vali Acc: 0.811 Test Loss: 0.624 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 19 cost time: 0.6597356796264648
Epoch: 19, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.621 Vali Acc: 0.822 Test Loss: 0.621 Test Acc: 0.822
Validation loss decreased (-0.811105 --> -0.822216).  Saving model ...
Epoch: 20 cost time: 0.6768133640289307
Epoch: 20, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.599 Vali Acc: 0.833 Test Loss: 0.599 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 21 cost time: 0.730069637298584
Epoch: 21, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 22 cost time: 0.798792839050293
Epoch: 22, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.604 Vali Acc: 0.828 Test Loss: 0.604 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7695198059082031
Epoch: 23, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.595 Vali Acc: 0.833 Test Loss: 0.595 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.781050443649292
Epoch: 24, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.608 Vali Acc: 0.839 Test Loss: 0.608 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7742118835449219
Epoch: 25, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.625 Vali Acc: 0.844 Test Loss: 0.625 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7689998149871826
Epoch: 26, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.608 Vali Acc: 0.861 Test Loss: 0.608 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 27 cost time: 0.7353143692016602
Epoch: 27, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.609 Vali Acc: 0.850 Test Loss: 0.609 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.814734935760498
Epoch: 28, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.616 Vali Acc: 0.856 Test Loss: 0.616 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7182626724243164
Epoch: 29, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.637 Vali Acc: 0.861 Test Loss: 0.637 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7620117664337158
Epoch: 30, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.632 Vali Acc: 0.872 Test Loss: 0.632 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 31 cost time: 0.7524750232696533
Epoch: 31, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.619 Vali Acc: 0.850 Test Loss: 0.619 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7014849185943604
Epoch: 32, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.645 Vali Acc: 0.872 Test Loss: 0.645 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7619187831878662
Epoch: 33, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.699 Vali Acc: 0.861 Test Loss: 0.699 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7803137302398682
Epoch: 34, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.676 Vali Acc: 0.844 Test Loss: 0.676 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7461731433868408
Epoch: 35, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.682 Vali Acc: 0.861 Test Loss: 0.682 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7693874835968018
Epoch: 36, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.682 Vali Acc: 0.856 Test Loss: 0.682 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7951335906982422
Epoch: 37, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.717 Vali Acc: 0.867 Test Loss: 0.717 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7624120712280273
Epoch: 38, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.708 Vali Acc: 0.833 Test Loss: 0.708 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7471673488616943
Epoch: 39, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.746 Vali Acc: 0.844 Test Loss: 0.746 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.785703182220459
Epoch: 40, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.754 Vali Acc: 0.867 Test Loss: 0.754 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 114447
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0740773677825928
Epoch: 1, Steps: 12 | Train Loss: 2.590 Vali Loss: 2.521 Vali Acc: 0.306 Test Loss: 2.521 Test Acc: 0.306
Validation loss decreased (inf --> -0.305530).  Saving model ...
Epoch: 2 cost time: 0.7759866714477539
Epoch: 2, Steps: 12 | Train Loss: 2.345 Vali Loss: 2.261 Vali Acc: 0.378 Test Loss: 2.261 Test Acc: 0.378
Validation loss decreased (-0.305530 --> -0.377755).  Saving model ...
Epoch: 3 cost time: 0.7684705257415771
Epoch: 3, Steps: 12 | Train Loss: 1.981 Vali Loss: 1.925 Vali Acc: 0.567 Test Loss: 1.925 Test Acc: 0.567
Validation loss decreased (-0.377755 --> -0.566647).  Saving model ...
Epoch: 4 cost time: 0.6874356269836426
Epoch: 4, Steps: 12 | Train Loss: 1.600 Vali Loss: 1.653 Vali Acc: 0.633 Test Loss: 1.653 Test Acc: 0.633
Validation loss decreased (-0.566647 --> -0.633317).  Saving model ...
Epoch: 5 cost time: 0.7496681213378906
Epoch: 5, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.451 Vali Acc: 0.672 Test Loss: 1.451 Test Acc: 0.672
Validation loss decreased (-0.633317 --> -0.672208).  Saving model ...
Epoch: 6 cost time: 0.7882411479949951
Epoch: 6, Steps: 12 | Train Loss: 1.101 Vali Loss: 1.273 Vali Acc: 0.706 Test Loss: 1.273 Test Acc: 0.706
Validation loss decreased (-0.672208 --> -0.705543).  Saving model ...
Epoch: 7 cost time: 0.8010416030883789
Epoch: 7, Steps: 12 | Train Loss: 0.933 Vali Loss: 1.134 Vali Acc: 0.694 Test Loss: 1.134 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7770102024078369
Epoch: 8, Steps: 12 | Train Loss: 0.873 Vali Loss: 1.035 Vali Acc: 0.728 Test Loss: 1.035 Test Acc: 0.728
Validation loss decreased (-0.705543 --> -0.727767).  Saving model ...
Epoch: 9 cost time: 0.7380764484405518
Epoch: 9, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.957 Vali Acc: 0.756 Test Loss: 0.957 Test Acc: 0.756
Validation loss decreased (-0.727767 --> -0.755546).  Saving model ...
Epoch: 10 cost time: 0.7883021831512451
Epoch: 10, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.903 Vali Acc: 0.750 Test Loss: 0.903 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7734613418579102
Epoch: 11, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.838 Vali Acc: 0.761 Test Loss: 0.838 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761103).  Saving model ...
Epoch: 12 cost time: 0.7623612880706787
Epoch: 12, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.800 Vali Acc: 0.767 Test Loss: 0.800 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766659).  Saving model ...
Epoch: 13 cost time: 0.7609474658966064
Epoch: 13, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.740 Vali Acc: 0.800 Test Loss: 0.740 Test Acc: 0.800
Validation loss decreased (-0.766659 --> -0.799993).  Saving model ...
Epoch: 14 cost time: 0.7383222579956055
Epoch: 14, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.731 Vali Acc: 0.767 Test Loss: 0.731 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7737951278686523
Epoch: 15, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.687 Vali Acc: 0.806 Test Loss: 0.687 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 16 cost time: 0.7614874839782715
Epoch: 16, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.650 Vali Acc: 0.800 Test Loss: 0.650 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7835185527801514
Epoch: 17, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.633 Vali Acc: 0.817 Test Loss: 0.633 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816660).  Saving model ...
Epoch: 18 cost time: 0.8036789894104004
Epoch: 18, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.628 Vali Acc: 0.822 Test Loss: 0.628 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 19 cost time: 0.8033602237701416
Epoch: 19, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.589 Vali Acc: 0.828 Test Loss: 0.589 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 20 cost time: 0.7886192798614502
Epoch: 20, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.578 Vali Acc: 0.844 Test Loss: 0.578 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844439).  Saving model ...
Epoch: 21 cost time: 0.8024187088012695
Epoch: 21, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.571 Vali Acc: 0.856 Test Loss: 0.571 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 22 cost time: 0.8342087268829346
Epoch: 22, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.570 Vali Acc: 0.839 Test Loss: 0.570 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7678196430206299
Epoch: 23, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7778246402740479
Epoch: 24, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7693057060241699
Epoch: 25, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.591 Vali Acc: 0.839 Test Loss: 0.591 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7826666831970215
Epoch: 26, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.591 Vali Acc: 0.850 Test Loss: 0.591 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7580893039703369
Epoch: 27, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7905881404876709
Epoch: 28, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.598 Vali Acc: 0.844 Test Loss: 0.598 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7474749088287354
Epoch: 29, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.581 Vali Acc: 0.844 Test Loss: 0.581 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7843756675720215
Epoch: 30, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.608 Vali Acc: 0.861 Test Loss: 0.608 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 31 cost time: 0.8170437812805176
Epoch: 31, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.648 Vali Acc: 0.856 Test Loss: 0.648 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8761739730834961
Epoch: 32, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.647 Vali Acc: 0.856 Test Loss: 0.647 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7633590698242188
Epoch: 33, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.625 Vali Acc: 0.861 Test Loss: 0.625 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7936496734619141
Epoch: 34, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.673 Vali Acc: 0.850 Test Loss: 0.673 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8143434524536133
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8025636672973633
Epoch: 36, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.635 Vali Acc: 0.867 Test Loss: 0.635 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 37 cost time: 0.7594811916351318
Epoch: 37, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.631 Vali Acc: 0.856 Test Loss: 0.631 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8124115467071533
Epoch: 38, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.676 Vali Acc: 0.867 Test Loss: 0.676 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7915661334991455
Epoch: 39, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.683 Vali Acc: 0.844 Test Loss: 0.683 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7864532470703125
Epoch: 40, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.725 Vali Acc: 0.850 Test Loss: 0.725 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.75368332862854
Epoch: 41, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.706 Vali Acc: 0.850 Test Loss: 0.706 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7972521781921387
Epoch: 42, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.720 Vali Acc: 0.839 Test Loss: 0.720 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8089723587036133
Epoch: 43, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.723 Vali Acc: 0.844 Test Loss: 0.723 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.7946600914001465
Epoch: 44, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.764 Vali Acc: 0.856 Test Loss: 0.764 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.7595646381378174
Epoch: 45, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.745 Vali Acc: 0.850 Test Loss: 0.745 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.7592723369598389
Epoch: 46, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.731 Vali Acc: 0.856 Test Loss: 0.731 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 114511
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0006484985351562
Epoch: 1, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.639 Vali Acc: 0.072 Test Loss: 2.639 Test Acc: 0.072
Validation loss decreased (inf --> -0.072196).  Saving model ...
Epoch: 2 cost time: 0.7988100051879883
Epoch: 2, Steps: 12 | Train Loss: 2.549 Vali Loss: 2.455 Vali Acc: 0.233 Test Loss: 2.455 Test Acc: 0.233
Validation loss decreased (-0.072196 --> -0.233309).  Saving model ...
Epoch: 3 cost time: 0.8074390888214111
Epoch: 3, Steps: 12 | Train Loss: 2.304 Vali Loss: 2.213 Vali Acc: 0.406 Test Loss: 2.213 Test Acc: 0.406
Validation loss decreased (-0.233309 --> -0.405533).  Saving model ...
Epoch: 4 cost time: 0.7361209392547607
Epoch: 4, Steps: 12 | Train Loss: 1.949 Vali Loss: 1.942 Vali Acc: 0.550 Test Loss: 1.942 Test Acc: 0.550
Validation loss decreased (-0.405533 --> -0.549981).  Saving model ...
Epoch: 5 cost time: 0.7401432991027832
Epoch: 5, Steps: 12 | Train Loss: 1.664 Vali Loss: 1.711 Vali Acc: 0.617 Test Loss: 1.711 Test Acc: 0.617
Validation loss decreased (-0.549981 --> -0.616650).  Saving model ...
Epoch: 6 cost time: 0.7904255390167236
Epoch: 6, Steps: 12 | Train Loss: 1.425 Vali Loss: 1.521 Vali Acc: 0.628 Test Loss: 1.521 Test Acc: 0.628
Validation loss decreased (-0.616650 --> -0.627763).  Saving model ...
Epoch: 7 cost time: 0.7152566909790039
Epoch: 7, Steps: 12 | Train Loss: 1.236 Vali Loss: 1.376 Vali Acc: 0.683 Test Loss: 1.376 Test Acc: 0.683
Validation loss decreased (-0.627763 --> -0.683320).  Saving model ...
Epoch: 8 cost time: 0.7710282802581787
Epoch: 8, Steps: 12 | Train Loss: 1.038 Vali Loss: 1.253 Vali Acc: 0.672 Test Loss: 1.253 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7510392665863037
Epoch: 9, Steps: 12 | Train Loss: 0.911 Vali Loss: 1.161 Vali Acc: 0.683 Test Loss: 1.161 Test Acc: 0.683
Validation loss decreased (-0.683320 --> -0.683322).  Saving model ...
Epoch: 10 cost time: 0.7356011867523193
Epoch: 10, Steps: 12 | Train Loss: 0.842 Vali Loss: 1.087 Vali Acc: 0.689 Test Loss: 1.087 Test Acc: 0.689
Validation loss decreased (-0.683322 --> -0.688878).  Saving model ...
Epoch: 11 cost time: 0.7511880397796631
Epoch: 11, Steps: 12 | Train Loss: 0.713 Vali Loss: 1.011 Vali Acc: 0.722 Test Loss: 1.011 Test Acc: 0.722
Validation loss decreased (-0.688878 --> -0.722212).  Saving model ...
Epoch: 12 cost time: 0.7570788860321045
Epoch: 12, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.928 Vali Acc: 0.722 Test Loss: 0.928 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722213).  Saving model ...
Epoch: 13 cost time: 0.7283036708831787
Epoch: 13, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.900 Vali Acc: 0.728 Test Loss: 0.900 Test Acc: 0.728
Validation loss decreased (-0.722213 --> -0.727769).  Saving model ...
Epoch: 14 cost time: 0.685711145401001
Epoch: 14, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.839 Vali Acc: 0.756 Test Loss: 0.839 Test Acc: 0.756
Validation loss decreased (-0.727769 --> -0.755547).  Saving model ...
Epoch: 15 cost time: 0.7251620292663574
Epoch: 15, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.814 Vali Acc: 0.767 Test Loss: 0.814 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766659).  Saving model ...
Epoch: 16 cost time: 0.7409181594848633
Epoch: 16, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.757 Vali Acc: 0.789 Test Loss: 0.757 Test Acc: 0.789
Validation loss decreased (-0.766659 --> -0.788881).  Saving model ...
Epoch: 17 cost time: 0.7360382080078125
Epoch: 17, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.721 Vali Acc: 0.789 Test Loss: 0.721 Test Acc: 0.789
Validation loss decreased (-0.788881 --> -0.788882).  Saving model ...
Epoch: 18 cost time: 0.7179651260375977
Epoch: 18, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.695 Vali Acc: 0.800 Test Loss: 0.695 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 0.684150218963623
Epoch: 19, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.672 Vali Acc: 0.806 Test Loss: 0.672 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 20 cost time: 0.7451508045196533
Epoch: 20, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.653 Vali Acc: 0.817 Test Loss: 0.653 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816660).  Saving model ...
Epoch: 21 cost time: 0.7666919231414795
Epoch: 21, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.628 Vali Acc: 0.811 Test Loss: 0.628 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7227065563201904
Epoch: 22, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.596 Vali Acc: 0.844 Test Loss: 0.596 Test Acc: 0.844
Validation loss decreased (-0.816660 --> -0.844438).  Saving model ...
Epoch: 23 cost time: 0.7158365249633789
Epoch: 23, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.593 Vali Acc: 0.828 Test Loss: 0.593 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7401688098907471
Epoch: 24, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.599 Vali Acc: 0.822 Test Loss: 0.599 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7316372394561768
Epoch: 25, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.602 Vali Acc: 0.817 Test Loss: 0.602 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7329328060150146
Epoch: 26, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.578 Vali Acc: 0.844 Test Loss: 0.578 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844439).  Saving model ...
Epoch: 27 cost time: 0.7070522308349609
Epoch: 27, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.578 Vali Acc: 0.850 Test Loss: 0.578 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 0.7091269493103027
Epoch: 28, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.590 Vali Acc: 0.856 Test Loss: 0.590 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 29 cost time: 0.813166618347168
Epoch: 29, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.587 Vali Acc: 0.844 Test Loss: 0.587 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7375714778900146
Epoch: 30, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.590 Vali Acc: 0.844 Test Loss: 0.590 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7549197673797607
Epoch: 31, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.584 Vali Acc: 0.867 Test Loss: 0.584 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 32 cost time: 0.7575218677520752
Epoch: 32, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7782213687896729
Epoch: 33, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.626 Vali Acc: 0.844 Test Loss: 0.626 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7878994941711426
Epoch: 34, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.624 Vali Acc: 0.833 Test Loss: 0.624 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6837611198425293
Epoch: 35, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.665 Vali Acc: 0.856 Test Loss: 0.665 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.744865894317627
Epoch: 36, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.656 Vali Acc: 0.850 Test Loss: 0.656 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.7519075870513916
Epoch: 37, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.692 Vali Acc: 0.856 Test Loss: 0.692 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7293679714202881
Epoch: 38, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.684 Vali Acc: 0.839 Test Loss: 0.684 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7238335609436035
Epoch: 39, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.687 Vali Acc: 0.872 Test Loss: 0.687 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872215).  Saving model ...
Epoch: 40 cost time: 0.7152533531188965
Epoch: 40, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.708 Vali Acc: 0.867 Test Loss: 0.708 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7331147193908691
Epoch: 41, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.705 Vali Acc: 0.867 Test Loss: 0.705 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7198226451873779
Epoch: 42, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.762 Vali Acc: 0.856 Test Loss: 0.762 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7611823081970215
Epoch: 43, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.710 Vali Acc: 0.856 Test Loss: 0.710 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7788214683532715
Epoch: 44, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.822 Vali Acc: 0.833 Test Loss: 0.822 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.7760908603668213
Epoch: 45, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.742 Vali Acc: 0.844 Test Loss: 0.742 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7330172061920166
Epoch: 46, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.697 Vali Acc: 0.861 Test Loss: 0.697 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.7631525993347168
Epoch: 47, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.701 Vali Acc: 0.872 Test Loss: 0.701 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.7451887130737305
Epoch: 48, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.702 Vali Acc: 0.872 Test Loss: 0.702 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.7353224754333496
Epoch: 49, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.728 Vali Acc: 0.856 Test Loss: 0.728 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 101135
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0428266525268555
Epoch: 1, Steps: 12 | Train Loss: 2.783 Vali Loss: 2.704 Vali Acc: 0.067 Test Loss: 2.704 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 0.772862434387207
Epoch: 2, Steps: 12 | Train Loss: 2.637 Vali Loss: 2.560 Vali Acc: 0.183 Test Loss: 2.560 Test Acc: 0.183
Validation loss decreased (-0.066640 --> -0.183308).  Saving model ...
Epoch: 3 cost time: 0.7566990852355957
Epoch: 3, Steps: 12 | Train Loss: 2.416 Vali Loss: 2.338 Vali Acc: 0.367 Test Loss: 2.338 Test Acc: 0.367
Validation loss decreased (-0.183308 --> -0.366643).  Saving model ...
Epoch: 4 cost time: 0.7422964572906494
Epoch: 4, Steps: 12 | Train Loss: 2.119 Vali Loss: 2.100 Vali Acc: 0.483 Test Loss: 2.100 Test Acc: 0.483
Validation loss decreased (-0.366643 --> -0.483312).  Saving model ...
Epoch: 5 cost time: 0.7129502296447754
Epoch: 5, Steps: 12 | Train Loss: 1.899 Vali Loss: 1.893 Vali Acc: 0.550 Test Loss: 1.893 Test Acc: 0.550
Validation loss decreased (-0.483312 --> -0.549981).  Saving model ...
Epoch: 6 cost time: 0.7350254058837891
Epoch: 6, Steps: 12 | Train Loss: 1.669 Vali Loss: 1.707 Vali Acc: 0.606 Test Loss: 1.707 Test Acc: 0.606
Validation loss decreased (-0.549981 --> -0.605538).  Saving model ...
Epoch: 7 cost time: 0.7266149520874023
Epoch: 7, Steps: 12 | Train Loss: 1.463 Vali Loss: 1.549 Vali Acc: 0.639 Test Loss: 1.549 Test Acc: 0.639
Validation loss decreased (-0.605538 --> -0.638873).  Saving model ...
Epoch: 8 cost time: 0.7893924713134766
Epoch: 8, Steps: 12 | Train Loss: 1.308 Vali Loss: 1.411 Vali Acc: 0.644 Test Loss: 1.411 Test Acc: 0.644
Validation loss decreased (-0.638873 --> -0.644430).  Saving model ...
Epoch: 9 cost time: 0.8042726516723633
Epoch: 9, Steps: 12 | Train Loss: 1.207 Vali Loss: 1.300 Vali Acc: 0.667 Test Loss: 1.300 Test Acc: 0.667
Validation loss decreased (-0.644430 --> -0.666654).  Saving model ...
Epoch: 10 cost time: 0.7827019691467285
Epoch: 10, Steps: 12 | Train Loss: 0.987 Vali Loss: 1.214 Vali Acc: 0.678 Test Loss: 1.214 Test Acc: 0.678
Validation loss decreased (-0.666654 --> -0.677766).  Saving model ...
Epoch: 11 cost time: 0.7710001468658447
Epoch: 11, Steps: 12 | Train Loss: 0.901 Vali Loss: 1.120 Vali Acc: 0.689 Test Loss: 1.120 Test Acc: 0.689
Validation loss decreased (-0.677766 --> -0.688878).  Saving model ...
Epoch: 12 cost time: 0.7583835124969482
Epoch: 12, Steps: 12 | Train Loss: 0.832 Vali Loss: 1.065 Vali Acc: 0.711 Test Loss: 1.065 Test Acc: 0.711
Validation loss decreased (-0.688878 --> -0.711100).  Saving model ...
Epoch: 13 cost time: 0.7520477771759033
Epoch: 13, Steps: 12 | Train Loss: 0.689 Vali Loss: 0.999 Vali Acc: 0.722 Test Loss: 0.999 Test Acc: 0.722
Validation loss decreased (-0.711100 --> -0.722212).  Saving model ...
Epoch: 14 cost time: 0.8107154369354248
Epoch: 14, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.938 Vali Acc: 0.733 Test Loss: 0.938 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733324).  Saving model ...
Epoch: 15 cost time: 0.7482607364654541
Epoch: 15, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.897 Vali Acc: 0.728 Test Loss: 0.897 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7544734477996826
Epoch: 16, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.849 Vali Acc: 0.744 Test Loss: 0.849 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744436).  Saving model ...
Epoch: 17 cost time: 0.7212121486663818
Epoch: 17, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.823 Vali Acc: 0.744 Test Loss: 0.823 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 18 cost time: 0.7384741306304932
Epoch: 18, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.777 Vali Acc: 0.778 Test Loss: 0.777 Test Acc: 0.778
Validation loss decreased (-0.744436 --> -0.777770).  Saving model ...
Epoch: 19 cost time: 0.7988340854644775
Epoch: 19, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.732 Vali Acc: 0.800 Test Loss: 0.732 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799993).  Saving model ...
Epoch: 20 cost time: 0.7840278148651123
Epoch: 20, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.720 Vali Acc: 0.789 Test Loss: 0.720 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7540969848632812
Epoch: 21, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.704 Vali Acc: 0.806 Test Loss: 0.704 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 22 cost time: 0.7991604804992676
Epoch: 22, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.681 Vali Acc: 0.794 Test Loss: 0.681 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.785778284072876
Epoch: 23, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.662 Vali Acc: 0.800 Test Loss: 0.662 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7560498714447021
Epoch: 24, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.639 Vali Acc: 0.828 Test Loss: 0.639 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827771).  Saving model ...
Epoch: 25 cost time: 0.7547461986541748
Epoch: 25, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.631 Vali Acc: 0.817 Test Loss: 0.631 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.765784502029419
Epoch: 26, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.606 Vali Acc: 0.833 Test Loss: 0.606 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 27 cost time: 0.7406220436096191
Epoch: 27, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.612 Vali Acc: 0.822 Test Loss: 0.612 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7577822208404541
Epoch: 28, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.593 Vali Acc: 0.828 Test Loss: 0.593 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7567658424377441
Epoch: 29, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.585 Vali Acc: 0.833 Test Loss: 0.585 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 30 cost time: 0.7588412761688232
Epoch: 30, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.573 Vali Acc: 0.839 Test Loss: 0.573 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 31 cost time: 0.8202474117279053
Epoch: 31, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.574 Vali Acc: 0.850 Test Loss: 0.574 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 32 cost time: 0.7875196933746338
Epoch: 32, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.570 Vali Acc: 0.828 Test Loss: 0.570 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8195028305053711
Epoch: 33, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.575 Vali Acc: 0.839 Test Loss: 0.575 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8105239868164062
Epoch: 34, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.573 Vali Acc: 0.839 Test Loss: 0.573 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7645227909088135
Epoch: 35, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.589 Vali Acc: 0.850 Test Loss: 0.589 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7585976123809814
Epoch: 36, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.590 Vali Acc: 0.844 Test Loss: 0.590 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.7741143703460693
Epoch: 37, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.606 Vali Acc: 0.839 Test Loss: 0.606 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7439067363739014
Epoch: 38, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.620 Vali Acc: 0.833 Test Loss: 0.620 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7982444763183594
Epoch: 39, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.598 Vali Acc: 0.867 Test Loss: 0.598 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866661).  Saving model ...
Epoch: 40 cost time: 0.7900540828704834
Epoch: 40, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.603 Vali Acc: 0.861 Test Loss: 0.603 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8109040260314941
Epoch: 41, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.594 Vali Acc: 0.850 Test Loss: 0.594 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.738429069519043
Epoch: 42, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.607 Vali Acc: 0.839 Test Loss: 0.607 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.748807430267334
Epoch: 43, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.643 Vali Acc: 0.872 Test Loss: 0.643 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 44 cost time: 0.7522475719451904
Epoch: 44, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.633 Vali Acc: 0.867 Test Loss: 0.633 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7335164546966553
Epoch: 45, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.672 Vali Acc: 0.867 Test Loss: 0.672 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7352468967437744
Epoch: 46, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.720 Vali Acc: 0.850 Test Loss: 0.720 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.7848742008209229
Epoch: 47, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.713 Vali Acc: 0.850 Test Loss: 0.713 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.7317891120910645
Epoch: 48, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.734 Vali Acc: 0.844 Test Loss: 0.734 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.7562437057495117
Epoch: 49, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.659 Vali Acc: 0.861 Test Loss: 0.659 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.7465417385101318
Epoch: 50, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.651 Vali Acc: 0.844 Test Loss: 0.651 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 93583
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.944669485092163
Epoch: 1, Steps: 12 | Train Loss: 2.761 Vali Loss: 2.683 Vali Acc: 0.083 Test Loss: 2.683 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 0.722160816192627
Epoch: 2, Steps: 12 | Train Loss: 2.609 Vali Loss: 2.560 Vali Acc: 0.150 Test Loss: 2.560 Test Acc: 0.150
Validation loss decreased (-0.083307 --> -0.149974).  Saving model ...
Epoch: 3 cost time: 0.7754011154174805
Epoch: 3, Steps: 12 | Train Loss: 2.426 Vali Loss: 2.370 Vali Acc: 0.339 Test Loss: 2.370 Test Acc: 0.339
Validation loss decreased (-0.149974 --> -0.338865).  Saving model ...
Epoch: 4 cost time: 0.759364128112793
Epoch: 4, Steps: 12 | Train Loss: 2.198 Vali Loss: 2.159 Vali Acc: 0.472 Test Loss: 2.159 Test Acc: 0.472
Validation loss decreased (-0.338865 --> -0.472201).  Saving model ...
Epoch: 5 cost time: 0.7758116722106934
Epoch: 5, Steps: 12 | Train Loss: 1.964 Vali Loss: 1.947 Vali Acc: 0.544 Test Loss: 1.947 Test Acc: 0.544
Validation loss decreased (-0.472201 --> -0.544425).  Saving model ...
Epoch: 6 cost time: 0.7407140731811523
Epoch: 6, Steps: 12 | Train Loss: 1.736 Vali Loss: 1.782 Vali Acc: 0.611 Test Loss: 1.782 Test Acc: 0.611
Validation loss decreased (-0.544425 --> -0.611093).  Saving model ...
Epoch: 7 cost time: 0.7131786346435547
Epoch: 7, Steps: 12 | Train Loss: 1.543 Vali Loss: 1.623 Vali Acc: 0.628 Test Loss: 1.623 Test Acc: 0.628
Validation loss decreased (-0.611093 --> -0.627762).  Saving model ...
Epoch: 8 cost time: 0.7583940029144287
Epoch: 8, Steps: 12 | Train Loss: 1.381 Vali Loss: 1.500 Vali Acc: 0.656 Test Loss: 1.500 Test Acc: 0.656
Validation loss decreased (-0.627762 --> -0.655541).  Saving model ...
Epoch: 9 cost time: 0.7385873794555664
Epoch: 9, Steps: 12 | Train Loss: 1.190 Vali Loss: 1.372 Vali Acc: 0.683 Test Loss: 1.372 Test Acc: 0.683
Validation loss decreased (-0.655541 --> -0.683320).  Saving model ...
Epoch: 10 cost time: 0.7123692035675049
Epoch: 10, Steps: 12 | Train Loss: 1.054 Vali Loss: 1.262 Vali Acc: 0.678 Test Loss: 1.262 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.758662223815918
Epoch: 11, Steps: 12 | Train Loss: 0.974 Vali Loss: 1.179 Vali Acc: 0.689 Test Loss: 1.179 Test Acc: 0.689
Validation loss decreased (-0.683320 --> -0.688877).  Saving model ...
Epoch: 12 cost time: 0.698582649230957
Epoch: 12, Steps: 12 | Train Loss: 0.893 Vali Loss: 1.112 Vali Acc: 0.706 Test Loss: 1.112 Test Acc: 0.706
Validation loss decreased (-0.688877 --> -0.705544).  Saving model ...
Epoch: 13 cost time: 0.7449450492858887
Epoch: 13, Steps: 12 | Train Loss: 0.763 Vali Loss: 1.028 Vali Acc: 0.728 Test Loss: 1.028 Test Acc: 0.728
Validation loss decreased (-0.705544 --> -0.727767).  Saving model ...
Epoch: 14 cost time: 0.7758054733276367
Epoch: 14, Steps: 12 | Train Loss: 0.734 Vali Loss: 0.964 Vali Acc: 0.756 Test Loss: 0.964 Test Acc: 0.756
Validation loss decreased (-0.727767 --> -0.755546).  Saving model ...
Epoch: 15 cost time: 0.7183723449707031
Epoch: 15, Steps: 12 | Train Loss: 0.665 Vali Loss: 0.919 Vali Acc: 0.761 Test Loss: 0.919 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761102).  Saving model ...
Epoch: 16 cost time: 0.7284140586853027
Epoch: 16, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.877 Vali Acc: 0.772 Test Loss: 0.877 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772213).  Saving model ...
Epoch: 17 cost time: 0.7368648052215576
Epoch: 17, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.821 Vali Acc: 0.783 Test Loss: 0.821 Test Acc: 0.783
Validation loss decreased (-0.772213 --> -0.783325).  Saving model ...
Epoch: 18 cost time: 0.7152571678161621
Epoch: 18, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.783 Vali Acc: 0.778 Test Loss: 0.783 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7471723556518555
Epoch: 19, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.759 Vali Acc: 0.767 Test Loss: 0.759 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7701859474182129
Epoch: 20, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.726 Vali Acc: 0.789 Test Loss: 0.726 Test Acc: 0.789
Validation loss decreased (-0.783325 --> -0.788882).  Saving model ...
Epoch: 21 cost time: 0.7476565837860107
Epoch: 21, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.696 Vali Acc: 0.806 Test Loss: 0.696 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805549).  Saving model ...
Epoch: 22 cost time: 0.7747616767883301
Epoch: 22, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.651 Vali Acc: 0.828 Test Loss: 0.651 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827771).  Saving model ...
Epoch: 23 cost time: 0.7880916595458984
Epoch: 23, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.639 Vali Acc: 0.839 Test Loss: 0.639 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 24 cost time: 0.7640295028686523
Epoch: 24, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.632 Vali Acc: 0.822 Test Loss: 0.632 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7563474178314209
Epoch: 25, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.596 Vali Acc: 0.856 Test Loss: 0.596 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855550).  Saving model ...
Epoch: 26 cost time: 0.7472763061523438
Epoch: 26, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.583 Vali Acc: 0.844 Test Loss: 0.583 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7210080623626709
Epoch: 27, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.579 Vali Acc: 0.839 Test Loss: 0.579 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6863524913787842
Epoch: 28, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.560 Vali Acc: 0.856 Test Loss: 0.560 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 29 cost time: 0.7214488983154297
Epoch: 29, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7120039463043213
Epoch: 30, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.534 Vali Acc: 0.856 Test Loss: 0.534 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 31 cost time: 0.7428042888641357
Epoch: 31, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.551 Vali Acc: 0.867 Test Loss: 0.551 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 32 cost time: 0.7769570350646973
Epoch: 32, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.551 Vali Acc: 0.856 Test Loss: 0.551 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7648763656616211
Epoch: 33, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.531 Vali Acc: 0.867 Test Loss: 0.531 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 34 cost time: 0.7122094631195068
Epoch: 34, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.531 Vali Acc: 0.878 Test Loss: 0.531 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 35 cost time: 0.7335522174835205
Epoch: 35, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.523 Vali Acc: 0.856 Test Loss: 0.523 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7521083354949951
Epoch: 36, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.570 Vali Acc: 0.867 Test Loss: 0.570 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.732147216796875
Epoch: 37, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.587 Vali Acc: 0.850 Test Loss: 0.587 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7190868854522705
Epoch: 38, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.536 Vali Acc: 0.867 Test Loss: 0.536 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7641363143920898
Epoch: 39, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.529 Vali Acc: 0.856 Test Loss: 0.529 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7092452049255371
Epoch: 40, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7553377151489258
Epoch: 41, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.589 Vali Acc: 0.867 Test Loss: 0.589 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7621848583221436
Epoch: 42, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.560 Vali Acc: 0.872 Test Loss: 0.560 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7849562168121338
Epoch: 43, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.562 Vali Acc: 0.878 Test Loss: 0.562 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.7576196193695068
Epoch: 44, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.581 Vali Acc: 0.878 Test Loss: 0.581 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 89871
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2750492095947266
Epoch: 1, Steps: 12 | Train Loss: 2.698 Vali Loss: 2.615 Vali Acc: 0.128 Test Loss: 2.615 Test Acc: 0.128
Validation loss decreased (inf --> -0.127752).  Saving model ...
Epoch: 2 cost time: 0.7524900436401367
Epoch: 2, Steps: 12 | Train Loss: 2.578 Vali Loss: 2.516 Vali Acc: 0.189 Test Loss: 2.516 Test Acc: 0.189
Validation loss decreased (-0.127752 --> -0.188864).  Saving model ...
Epoch: 3 cost time: 0.7647264003753662
Epoch: 3, Steps: 12 | Train Loss: 2.453 Vali Loss: 2.370 Vali Acc: 0.317 Test Loss: 2.370 Test Acc: 0.317
Validation loss decreased (-0.188864 --> -0.316643).  Saving model ...
Epoch: 4 cost time: 0.7824275493621826
Epoch: 4, Steps: 12 | Train Loss: 2.259 Vali Loss: 2.200 Vali Acc: 0.417 Test Loss: 2.200 Test Acc: 0.417
Validation loss decreased (-0.316643 --> -0.416645).  Saving model ...
Epoch: 5 cost time: 0.77740478515625
Epoch: 5, Steps: 12 | Train Loss: 2.111 Vali Loss: 2.034 Vali Acc: 0.489 Test Loss: 2.034 Test Acc: 0.489
Validation loss decreased (-0.416645 --> -0.488869).  Saving model ...
Epoch: 6 cost time: 0.8023760318756104
Epoch: 6, Steps: 12 | Train Loss: 1.878 Vali Loss: 1.869 Vali Acc: 0.550 Test Loss: 1.869 Test Acc: 0.550
Validation loss decreased (-0.488869 --> -0.549981).  Saving model ...
Epoch: 7 cost time: 0.775885820388794
Epoch: 7, Steps: 12 | Train Loss: 1.687 Vali Loss: 1.719 Vali Acc: 0.589 Test Loss: 1.719 Test Acc: 0.589
Validation loss decreased (-0.549981 --> -0.588872).  Saving model ...
Epoch: 8 cost time: 0.7598485946655273
Epoch: 8, Steps: 12 | Train Loss: 1.530 Vali Loss: 1.596 Vali Acc: 0.600 Test Loss: 1.596 Test Acc: 0.600
Validation loss decreased (-0.588872 --> -0.599984).  Saving model ...
Epoch: 9 cost time: 0.7703912258148193
Epoch: 9, Steps: 12 | Train Loss: 1.368 Vali Loss: 1.484 Vali Acc: 0.611 Test Loss: 1.484 Test Acc: 0.611
Validation loss decreased (-0.599984 --> -0.611096).  Saving model ...
Epoch: 10 cost time: 0.7764673233032227
Epoch: 10, Steps: 12 | Train Loss: 1.232 Vali Loss: 1.391 Vali Acc: 0.644 Test Loss: 1.391 Test Acc: 0.644
Validation loss decreased (-0.611096 --> -0.644431).  Saving model ...
Epoch: 11 cost time: 0.7507550716400146
Epoch: 11, Steps: 12 | Train Loss: 1.147 Vali Loss: 1.286 Vali Acc: 0.656 Test Loss: 1.286 Test Acc: 0.656
Validation loss decreased (-0.644431 --> -0.655543).  Saving model ...
Epoch: 12 cost time: 0.741936445236206
Epoch: 12, Steps: 12 | Train Loss: 1.011 Vali Loss: 1.192 Vali Acc: 0.661 Test Loss: 1.192 Test Acc: 0.661
Validation loss decreased (-0.655543 --> -0.661099).  Saving model ...
Epoch: 13 cost time: 0.7239136695861816
Epoch: 13, Steps: 12 | Train Loss: 0.881 Vali Loss: 1.117 Vali Acc: 0.683 Test Loss: 1.117 Test Acc: 0.683
Validation loss decreased (-0.661099 --> -0.683322).  Saving model ...
Epoch: 14 cost time: 0.7763316631317139
Epoch: 14, Steps: 12 | Train Loss: 0.807 Vali Loss: 1.045 Vali Acc: 0.678 Test Loss: 1.045 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7785396575927734
Epoch: 15, Steps: 12 | Train Loss: 0.762 Vali Loss: 1.007 Vali Acc: 0.722 Test Loss: 1.007 Test Acc: 0.722
Validation loss decreased (-0.683322 --> -0.722212).  Saving model ...
Epoch: 16 cost time: 0.7703042030334473
Epoch: 16, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.937 Vali Acc: 0.728 Test Loss: 0.937 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727768).  Saving model ...
Epoch: 17 cost time: 0.8068950176239014
Epoch: 17, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.884 Vali Acc: 0.744 Test Loss: 0.884 Test Acc: 0.744
Validation loss decreased (-0.727768 --> -0.744436).  Saving model ...
Epoch: 18 cost time: 0.7648794651031494
Epoch: 18, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.842 Vali Acc: 0.756 Test Loss: 0.842 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755547).  Saving model ...
Epoch: 19 cost time: 0.7764015197753906
Epoch: 19, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.796 Vali Acc: 0.750 Test Loss: 0.796 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7367048263549805
Epoch: 20, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.757 Vali Acc: 0.750 Test Loss: 0.757 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.716742992401123
Epoch: 21, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.726 Vali Acc: 0.772 Test Loss: 0.726 Test Acc: 0.772
Validation loss decreased (-0.755547 --> -0.772215).  Saving model ...
Epoch: 22 cost time: 0.7101287841796875
Epoch: 22, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.689 Vali Acc: 0.789 Test Loss: 0.689 Test Acc: 0.789
Validation loss decreased (-0.772215 --> -0.788882).  Saving model ...
Epoch: 23 cost time: 0.7565391063690186
Epoch: 23, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.682 Vali Acc: 0.789 Test Loss: 0.682 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 24 cost time: 0.7376399040222168
Epoch: 24, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.658 Vali Acc: 0.789 Test Loss: 0.658 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 25 cost time: 0.7653439044952393
Epoch: 25, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.616 Vali Acc: 0.817 Test Loss: 0.616 Test Acc: 0.817
Validation loss decreased (-0.788882 --> -0.816661).  Saving model ...
Epoch: 26 cost time: 0.7059807777404785
Epoch: 26, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.615 Vali Acc: 0.811 Test Loss: 0.615 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7540428638458252
Epoch: 27, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.617 Vali Acc: 0.817 Test Loss: 0.617 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7747995853424072
Epoch: 28, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.563 Vali Acc: 0.828 Test Loss: 0.563 Test Acc: 0.828
Validation loss decreased (-0.816661 --> -0.827772).  Saving model ...
Epoch: 29 cost time: 0.7316727638244629
Epoch: 29, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.564 Vali Acc: 0.806 Test Loss: 0.564 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7198057174682617
Epoch: 30, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.558 Vali Acc: 0.839 Test Loss: 0.558 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 31 cost time: 0.7495241165161133
Epoch: 31, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.545 Vali Acc: 0.822 Test Loss: 0.545 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.798569917678833
Epoch: 32, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849995).  Saving model ...
Epoch: 33 cost time: 0.8386282920837402
Epoch: 33, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.518 Vali Acc: 0.844 Test Loss: 0.518 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8436484336853027
Epoch: 34, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.516 Vali Acc: 0.856 Test Loss: 0.516 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 35 cost time: 0.8158254623413086
Epoch: 35, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 36 cost time: 0.771949052810669
Epoch: 36, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7805335521697998
Epoch: 37, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.502 Vali Acc: 0.867 Test Loss: 0.502 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 38 cost time: 0.7717242240905762
Epoch: 38, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8381385803222656
Epoch: 39, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.493 Vali Acc: 0.861 Test Loss: 0.493 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7767441272735596
Epoch: 40, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.506 Vali Acc: 0.861 Test Loss: 0.506 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.75669264793396
Epoch: 41, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.517 Vali Acc: 0.856 Test Loss: 0.517 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7612965106964111
Epoch: 42, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.520 Vali Acc: 0.861 Test Loss: 0.520 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7968146800994873
Epoch: 43, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8154606819152832
Epoch: 44, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.553 Vali Acc: 0.856 Test Loss: 0.553 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.768366813659668
Epoch: 45, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.8177578449249268
Epoch: 46, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.553 Vali Acc: 0.844 Test Loss: 0.553 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.7732346057891846
Epoch: 47, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.593 Vali Acc: 0.844 Test Loss: 0.593 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 86223
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.283724069595337
Epoch: 1, Steps: 12 | Train Loss: 2.811 Vali Loss: 2.681 Vali Acc: 0.178 Test Loss: 2.681 Test Acc: 0.178
Validation loss decreased (inf --> -0.177751).  Saving model ...
Epoch: 2 cost time: 0.7918405532836914
Epoch: 2, Steps: 12 | Train Loss: 2.516 Vali Loss: 2.404 Vali Acc: 0.339 Test Loss: 2.404 Test Acc: 0.339
Validation loss decreased (-0.177751 --> -0.338865).  Saving model ...
Epoch: 3 cost time: 0.8192150592803955
Epoch: 3, Steps: 12 | Train Loss: 2.115 Vali Loss: 2.052 Vali Acc: 0.478 Test Loss: 2.052 Test Acc: 0.478
Validation loss decreased (-0.338865 --> -0.477757).  Saving model ...
Epoch: 4 cost time: 0.8152272701263428
Epoch: 4, Steps: 12 | Train Loss: 1.744 Vali Loss: 1.703 Vali Acc: 0.594 Test Loss: 1.703 Test Acc: 0.594
Validation loss decreased (-0.477757 --> -0.594427).  Saving model ...
Epoch: 5 cost time: 0.7846744060516357
Epoch: 5, Steps: 12 | Train Loss: 1.503 Vali Loss: 1.462 Vali Acc: 0.622 Test Loss: 1.462 Test Acc: 0.622
Validation loss decreased (-0.594427 --> -0.622208).  Saving model ...
Epoch: 6 cost time: 0.7966718673706055
Epoch: 6, Steps: 12 | Train Loss: 1.170 Vali Loss: 1.283 Vali Acc: 0.661 Test Loss: 1.283 Test Acc: 0.661
Validation loss decreased (-0.622208 --> -0.661098).  Saving model ...
Epoch: 7 cost time: 0.7690732479095459
Epoch: 7, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.178 Vali Acc: 0.678 Test Loss: 1.178 Test Acc: 0.678
Validation loss decreased (-0.661098 --> -0.677766).  Saving model ...
Epoch: 8 cost time: 0.7753658294677734
Epoch: 8, Steps: 12 | Train Loss: 0.854 Vali Loss: 1.095 Vali Acc: 0.689 Test Loss: 1.095 Test Acc: 0.689
Validation loss decreased (-0.677766 --> -0.688878).  Saving model ...
Epoch: 9 cost time: 0.7239727973937988
Epoch: 9, Steps: 12 | Train Loss: 0.760 Vali Loss: 0.999 Vali Acc: 0.689 Test Loss: 0.999 Test Acc: 0.689
Validation loss decreased (-0.688878 --> -0.688879).  Saving model ...
Epoch: 10 cost time: 0.8293890953063965
Epoch: 10, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.945 Vali Acc: 0.706 Test Loss: 0.945 Test Acc: 0.706
Validation loss decreased (-0.688879 --> -0.705546).  Saving model ...
Epoch: 11 cost time: 0.7534031867980957
Epoch: 11, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.884 Vali Acc: 0.700 Test Loss: 0.884 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8323616981506348
Epoch: 12, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.824 Vali Acc: 0.744 Test Loss: 0.824 Test Acc: 0.744
Validation loss decreased (-0.705546 --> -0.744436).  Saving model ...
Epoch: 13 cost time: 0.7987101078033447
Epoch: 13, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.810 Vali Acc: 0.750 Test Loss: 0.810 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749992).  Saving model ...
Epoch: 14 cost time: 0.7869317531585693
Epoch: 14, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.788 Vali Acc: 0.756 Test Loss: 0.788 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755548).  Saving model ...
Epoch: 15 cost time: 0.7759063243865967
Epoch: 15, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.726 Vali Acc: 0.789 Test Loss: 0.726 Test Acc: 0.789
Validation loss decreased (-0.755548 --> -0.788882).  Saving model ...
Epoch: 16 cost time: 0.8625345230102539
Epoch: 16, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.725 Vali Acc: 0.794 Test Loss: 0.725 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794437).  Saving model ...
Epoch: 17 cost time: 0.8189058303833008
Epoch: 17, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.707 Vali Acc: 0.811 Test Loss: 0.707 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811104).  Saving model ...
Epoch: 18 cost time: 0.7878766059875488
Epoch: 18, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.676 Vali Acc: 0.811 Test Loss: 0.676 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 19 cost time: 0.7993903160095215
Epoch: 19, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.664 Vali Acc: 0.806 Test Loss: 0.664 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8336777687072754
Epoch: 20, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.647 Vali Acc: 0.822 Test Loss: 0.647 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822216).  Saving model ...
Epoch: 21 cost time: 0.8163585662841797
Epoch: 21, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.624 Vali Acc: 0.833 Test Loss: 0.624 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 22 cost time: 0.8233625888824463
Epoch: 22, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.619 Vali Acc: 0.844 Test Loss: 0.619 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 23 cost time: 0.8056824207305908
Epoch: 23, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.600 Vali Acc: 0.844 Test Loss: 0.600 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 24 cost time: 0.7823224067687988
Epoch: 24, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.599 Vali Acc: 0.828 Test Loss: 0.599 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8502945899963379
Epoch: 25, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.604 Vali Acc: 0.861 Test Loss: 0.604 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861105).  Saving model ...
Epoch: 26 cost time: 0.6841392517089844
Epoch: 26, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7667741775512695
Epoch: 27, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.604 Vali Acc: 0.856 Test Loss: 0.604 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8221173286437988
Epoch: 28, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.617 Vali Acc: 0.844 Test Loss: 0.617 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7576050758361816
Epoch: 29, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.623 Vali Acc: 0.856 Test Loss: 0.623 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.749018669128418
Epoch: 30, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.615 Vali Acc: 0.844 Test Loss: 0.615 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.766796350479126
Epoch: 31, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.616 Vali Acc: 0.856 Test Loss: 0.616 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7672929763793945
Epoch: 32, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.667 Vali Acc: 0.828 Test Loss: 0.667 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8108930587768555
Epoch: 33, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.705 Vali Acc: 0.839 Test Loss: 0.705 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8064541816711426
Epoch: 34, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.668 Vali Acc: 0.850 Test Loss: 0.668 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.8360152244567871
Epoch: 35, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.661 Vali Acc: 0.850 Test Loss: 0.661 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 62895
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.007136583328247
Epoch: 1, Steps: 12 | Train Loss: 2.750 Vali Loss: 2.692 Vali Acc: 0.022 Test Loss: 2.692 Test Acc: 0.022
Validation loss decreased (inf --> -0.022195).  Saving model ...
Epoch: 2 cost time: 0.7967758178710938
Epoch: 2, Steps: 12 | Train Loss: 2.621 Vali Loss: 2.550 Vali Acc: 0.167 Test Loss: 2.550 Test Acc: 0.167
Validation loss decreased (-0.022195 --> -0.166641).  Saving model ...
Epoch: 3 cost time: 0.8129251003265381
Epoch: 3, Steps: 12 | Train Loss: 2.404 Vali Loss: 2.342 Vali Acc: 0.311 Test Loss: 2.342 Test Acc: 0.311
Validation loss decreased (-0.166641 --> -0.311088).  Saving model ...
Epoch: 4 cost time: 0.8230991363525391
Epoch: 4, Steps: 12 | Train Loss: 2.120 Vali Loss: 2.101 Vali Acc: 0.478 Test Loss: 2.101 Test Acc: 0.478
Validation loss decreased (-0.311088 --> -0.477757).  Saving model ...
Epoch: 5 cost time: 0.8121554851531982
Epoch: 5, Steps: 12 | Train Loss: 1.870 Vali Loss: 1.881 Vali Acc: 0.572 Test Loss: 1.881 Test Acc: 0.572
Validation loss decreased (-0.477757 --> -0.572203).  Saving model ...
Epoch: 6 cost time: 0.7861974239349365
Epoch: 6, Steps: 12 | Train Loss: 1.696 Vali Loss: 1.688 Vali Acc: 0.633 Test Loss: 1.688 Test Acc: 0.633
Validation loss decreased (-0.572203 --> -0.633316).  Saving model ...
Epoch: 7 cost time: 0.7682332992553711
Epoch: 7, Steps: 12 | Train Loss: 1.474 Vali Loss: 1.519 Vali Acc: 0.667 Test Loss: 1.519 Test Acc: 0.667
Validation loss decreased (-0.633316 --> -0.666651).  Saving model ...
Epoch: 8 cost time: 0.7789955139160156
Epoch: 8, Steps: 12 | Train Loss: 1.315 Vali Loss: 1.411 Vali Acc: 0.678 Test Loss: 1.411 Test Acc: 0.678
Validation loss decreased (-0.666651 --> -0.677764).  Saving model ...
Epoch: 9 cost time: 0.7686302661895752
Epoch: 9, Steps: 12 | Train Loss: 1.151 Vali Loss: 1.305 Vali Acc: 0.689 Test Loss: 1.305 Test Acc: 0.689
Validation loss decreased (-0.677764 --> -0.688876).  Saving model ...
Epoch: 10 cost time: 0.7351953983306885
Epoch: 10, Steps: 12 | Train Loss: 1.043 Vali Loss: 1.207 Vali Acc: 0.683 Test Loss: 1.207 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.788330078125
Epoch: 11, Steps: 12 | Train Loss: 0.951 Vali Loss: 1.131 Vali Acc: 0.706 Test Loss: 1.131 Test Acc: 0.706
Validation loss decreased (-0.688876 --> -0.705544).  Saving model ...
Epoch: 12 cost time: 0.7618494033813477
Epoch: 12, Steps: 12 | Train Loss: 0.867 Vali Loss: 1.075 Vali Acc: 0.700 Test Loss: 1.075 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7221951484680176
Epoch: 13, Steps: 12 | Train Loss: 0.721 Vali Loss: 1.011 Vali Acc: 0.722 Test Loss: 1.011 Test Acc: 0.722
Validation loss decreased (-0.705544 --> -0.722212).  Saving model ...
Epoch: 14 cost time: 0.8259201049804688
Epoch: 14, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.962 Vali Acc: 0.739 Test Loss: 0.962 Test Acc: 0.739
Validation loss decreased (-0.722212 --> -0.738879).  Saving model ...
Epoch: 15 cost time: 0.8116786479949951
Epoch: 15, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.919 Vali Acc: 0.728 Test Loss: 0.919 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.810258150100708
Epoch: 16, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.876 Vali Acc: 0.733 Test Loss: 0.876 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8548343181610107
Epoch: 17, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.852 Vali Acc: 0.744 Test Loss: 0.852 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744436).  Saving model ...
Epoch: 18 cost time: 0.8327901363372803
Epoch: 18, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.813 Vali Acc: 0.767 Test Loss: 0.813 Test Acc: 0.767
Validation loss decreased (-0.744436 --> -0.766659).  Saving model ...
Epoch: 19 cost time: 0.7755992412567139
Epoch: 19, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.768 Vali Acc: 0.794 Test Loss: 0.768 Test Acc: 0.794
Validation loss decreased (-0.766659 --> -0.794437).  Saving model ...
Epoch: 20 cost time: 0.7640388011932373
Epoch: 20, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.739 Vali Acc: 0.794 Test Loss: 0.739 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794437).  Saving model ...
Epoch: 21 cost time: 0.7487833499908447
Epoch: 21, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.734 Vali Acc: 0.794 Test Loss: 0.734 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794437).  Saving model ...
Epoch: 22 cost time: 0.7352149486541748
Epoch: 22, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.702 Vali Acc: 0.789 Test Loss: 0.702 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7831311225891113
Epoch: 23, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.691 Vali Acc: 0.800 Test Loss: 0.691 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 24 cost time: 0.8342890739440918
Epoch: 24, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.676 Vali Acc: 0.822 Test Loss: 0.676 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822215).  Saving model ...
Epoch: 25 cost time: 0.7911338806152344
Epoch: 25, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.649 Vali Acc: 0.822 Test Loss: 0.649 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822216).  Saving model ...
Epoch: 26 cost time: 0.7523036003112793
Epoch: 26, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.644 Vali Acc: 0.850 Test Loss: 0.644 Test Acc: 0.850
Validation loss decreased (-0.822216 --> -0.849994).  Saving model ...
Epoch: 27 cost time: 0.8107724189758301
Epoch: 27, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.641 Vali Acc: 0.817 Test Loss: 0.641 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7820539474487305
Epoch: 28, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.633 Vali Acc: 0.844 Test Loss: 0.633 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8156371116638184
Epoch: 29, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.604 Vali Acc: 0.844 Test Loss: 0.604 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7305724620819092
Epoch: 30, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 31 cost time: 0.8217458724975586
Epoch: 31, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.606 Vali Acc: 0.839 Test Loss: 0.606 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7653310298919678
Epoch: 32, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.612 Vali Acc: 0.861 Test Loss: 0.612 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 33 cost time: 0.7553753852844238
Epoch: 33, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.622 Vali Acc: 0.856 Test Loss: 0.622 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7790830135345459
Epoch: 34, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.612 Vali Acc: 0.867 Test Loss: 0.612 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 35 cost time: 0.8094146251678467
Epoch: 35, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.607 Vali Acc: 0.850 Test Loss: 0.607 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8708739280700684
Epoch: 36, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.608 Vali Acc: 0.850 Test Loss: 0.608 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7973825931549072
Epoch: 37, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.605 Vali Acc: 0.844 Test Loss: 0.605 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.797076940536499
Epoch: 38, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.625 Vali Acc: 0.844 Test Loss: 0.625 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7829146385192871
Epoch: 39, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.645 Vali Acc: 0.867 Test Loss: 0.645 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7875380516052246
Epoch: 40, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.642 Vali Acc: 0.856 Test Loss: 0.642 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7656266689300537
Epoch: 41, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.635 Vali Acc: 0.844 Test Loss: 0.635 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7423937320709229
Epoch: 42, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.644 Vali Acc: 0.861 Test Loss: 0.644 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7240786552429199
Epoch: 43, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.661 Vali Acc: 0.861 Test Loss: 0.661 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.7279796600341797
Epoch: 44, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.684 Vali Acc: 0.856 Test Loss: 0.684 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 40847
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.065176010131836
Epoch: 1, Steps: 12 | Train Loss: 2.806 Vali Loss: 2.691 Vali Acc: 0.117 Test Loss: 2.691 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 0.7765886783599854
Epoch: 2, Steps: 12 | Train Loss: 2.639 Vali Loss: 2.546 Vali Acc: 0.150 Test Loss: 2.546 Test Acc: 0.150
Validation loss decreased (-0.116640 --> -0.149975).  Saving model ...
Epoch: 3 cost time: 0.784146785736084
Epoch: 3, Steps: 12 | Train Loss: 2.422 Vali Loss: 2.326 Vali Acc: 0.300 Test Loss: 2.326 Test Acc: 0.300
Validation loss decreased (-0.149975 --> -0.299977).  Saving model ...
Epoch: 4 cost time: 0.8014788627624512
Epoch: 4, Steps: 12 | Train Loss: 2.170 Vali Loss: 2.106 Vali Acc: 0.450 Test Loss: 2.106 Test Acc: 0.450
Validation loss decreased (-0.299977 --> -0.449979).  Saving model ...
Epoch: 5 cost time: 0.7252955436706543
Epoch: 5, Steps: 12 | Train Loss: 1.888 Vali Loss: 1.895 Vali Acc: 0.539 Test Loss: 1.895 Test Acc: 0.539
Validation loss decreased (-0.449979 --> -0.538870).  Saving model ...
Epoch: 6 cost time: 0.6802432537078857
Epoch: 6, Steps: 12 | Train Loss: 1.663 Vali Loss: 1.702 Vali Acc: 0.594 Test Loss: 1.702 Test Acc: 0.594
Validation loss decreased (-0.538870 --> -0.594427).  Saving model ...
Epoch: 7 cost time: 0.7359344959259033
Epoch: 7, Steps: 12 | Train Loss: 1.460 Vali Loss: 1.541 Vali Acc: 0.633 Test Loss: 1.541 Test Acc: 0.633
Validation loss decreased (-0.594427 --> -0.633318).  Saving model ...
Epoch: 8 cost time: 0.8806271553039551
Epoch: 8, Steps: 12 | Train Loss: 1.311 Vali Loss: 1.416 Vali Acc: 0.633 Test Loss: 1.416 Test Acc: 0.633
Validation loss decreased (-0.633318 --> -0.633319).  Saving model ...
Epoch: 9 cost time: 0.8606436252593994
Epoch: 9, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.303 Vali Acc: 0.683 Test Loss: 1.303 Test Acc: 0.683
Validation loss decreased (-0.633319 --> -0.683320).  Saving model ...
Epoch: 10 cost time: 0.8829364776611328
Epoch: 10, Steps: 12 | Train Loss: 1.004 Vali Loss: 1.204 Vali Acc: 0.683 Test Loss: 1.204 Test Acc: 0.683
Validation loss decreased (-0.683320 --> -0.683321).  Saving model ...
Epoch: 11 cost time: 0.811406135559082
Epoch: 11, Steps: 12 | Train Loss: 0.938 Vali Loss: 1.130 Vali Acc: 0.683 Test Loss: 1.130 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683322).  Saving model ...
Epoch: 12 cost time: 0.8060688972473145
Epoch: 12, Steps: 12 | Train Loss: 0.814 Vali Loss: 1.074 Vali Acc: 0.706 Test Loss: 1.074 Test Acc: 0.706
Validation loss decreased (-0.683322 --> -0.705545).  Saving model ...
Epoch: 13 cost time: 0.8289518356323242
Epoch: 13, Steps: 12 | Train Loss: 0.767 Vali Loss: 1.029 Vali Acc: 0.728 Test Loss: 1.029 Test Acc: 0.728
Validation loss decreased (-0.705545 --> -0.727767).  Saving model ...
Epoch: 14 cost time: 0.7795655727386475
Epoch: 14, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.976 Vali Acc: 0.728 Test Loss: 0.976 Test Acc: 0.728
Validation loss decreased (-0.727767 --> -0.727768).  Saving model ...
Epoch: 15 cost time: 0.8345320224761963
Epoch: 15, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.922 Vali Acc: 0.733 Test Loss: 0.922 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733324).  Saving model ...
Epoch: 16 cost time: 0.7891123294830322
Epoch: 16, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.883 Vali Acc: 0.761 Test Loss: 0.883 Test Acc: 0.761
Validation loss decreased (-0.733324 --> -0.761102).  Saving model ...
Epoch: 17 cost time: 0.7966876029968262
Epoch: 17, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.862 Vali Acc: 0.761 Test Loss: 0.862 Test Acc: 0.761
Validation loss decreased (-0.761102 --> -0.761102).  Saving model ...
Epoch: 18 cost time: 0.9418606758117676
Epoch: 18, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.817 Vali Acc: 0.778 Test Loss: 0.817 Test Acc: 0.778
Validation loss decreased (-0.761102 --> -0.777770).  Saving model ...
Epoch: 19 cost time: 0.7853000164031982
Epoch: 19, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.798 Vali Acc: 0.756 Test Loss: 0.798 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8681094646453857
Epoch: 20, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.772 Vali Acc: 0.756 Test Loss: 0.772 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8899078369140625
Epoch: 21, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.745 Vali Acc: 0.772 Test Loss: 0.745 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8464806079864502
Epoch: 22, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.728 Vali Acc: 0.794 Test Loss: 0.728 Test Acc: 0.794
Validation loss decreased (-0.777770 --> -0.794437).  Saving model ...
Epoch: 23 cost time: 0.8040359020233154
Epoch: 23, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.714 Vali Acc: 0.778 Test Loss: 0.714 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7538259029388428
Epoch: 24, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.685 Vali Acc: 0.806 Test Loss: 0.685 Test Acc: 0.806
Validation loss decreased (-0.794437 --> -0.805549).  Saving model ...
Epoch: 25 cost time: 0.7241747379302979
Epoch: 25, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.658 Vali Acc: 0.794 Test Loss: 0.658 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7715439796447754
Epoch: 26, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.645 Vali Acc: 0.811 Test Loss: 0.645 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 27 cost time: 0.7397115230560303
Epoch: 27, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.626 Vali Acc: 0.806 Test Loss: 0.626 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8248155117034912
Epoch: 28, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.613 Vali Acc: 0.817 Test Loss: 0.613 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
Epoch: 29 cost time: 0.7858397960662842
Epoch: 29, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.626 Vali Acc: 0.806 Test Loss: 0.626 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8747744560241699
Epoch: 30, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.646 Vali Acc: 0.822 Test Loss: 0.646 Test Acc: 0.822
Validation loss decreased (-0.816661 --> -0.822216).  Saving model ...
Epoch: 31 cost time: 0.8870549201965332
Epoch: 31, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.615 Vali Acc: 0.833 Test Loss: 0.615 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 32 cost time: 0.8242778778076172
Epoch: 32, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.590 Vali Acc: 0.839 Test Loss: 0.590 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 33 cost time: 0.8046796321868896
Epoch: 33, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.603 Vali Acc: 0.839 Test Loss: 0.603 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8569822311401367
Epoch: 34, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.604 Vali Acc: 0.833 Test Loss: 0.604 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8280694484710693
Epoch: 35, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.594 Vali Acc: 0.850 Test Loss: 0.594 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 36 cost time: 0.7589781284332275
Epoch: 36, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.615 Vali Acc: 0.828 Test Loss: 0.615 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8082103729248047
Epoch: 37, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.615 Vali Acc: 0.811 Test Loss: 0.615 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8051323890686035
Epoch: 38, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.622 Vali Acc: 0.833 Test Loss: 0.622 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8141334056854248
Epoch: 39, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.652 Vali Acc: 0.844 Test Loss: 0.652 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8131937980651855
Epoch: 40, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.668 Vali Acc: 0.833 Test Loss: 0.668 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8808932304382324
Epoch: 41, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.667 Vali Acc: 0.828 Test Loss: 0.667 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7385249137878418
Epoch: 42, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.660 Vali Acc: 0.856 Test Loss: 0.660 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 43 cost time: 0.8199126720428467
Epoch: 43, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.663 Vali Acc: 0.850 Test Loss: 0.663 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7931778430938721
Epoch: 44, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.655 Vali Acc: 0.844 Test Loss: 0.655 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7439799308776855
Epoch: 45, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.682 Vali Acc: 0.844 Test Loss: 0.682 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.7578344345092773
Epoch: 46, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.705 Vali Acc: 0.844 Test Loss: 0.705 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.78035569190979
Epoch: 47, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.689 Vali Acc: 0.822 Test Loss: 0.689 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.7883434295654297
Epoch: 48, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.693 Vali Acc: 0.856 Test Loss: 0.693 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.7984178066253662
Epoch: 49, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.711 Vali Acc: 0.850 Test Loss: 0.711 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.9037184715270996
Epoch: 50, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.700 Vali Acc: 0.839 Test Loss: 0.700 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 40879
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0670669078826904
Epoch: 1, Steps: 12 | Train Loss: 2.825 Vali Loss: 2.763 Vali Acc: 0.067 Test Loss: 2.763 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 0.7605786323547363
Epoch: 2, Steps: 12 | Train Loss: 2.715 Vali Loss: 2.658 Vali Acc: 0.094 Test Loss: 2.658 Test Acc: 0.094
Validation loss decreased (-0.066639 --> -0.094418).  Saving model ...
Epoch: 3 cost time: 0.7419583797454834
Epoch: 3, Steps: 12 | Train Loss: 2.558 Vali Loss: 2.496 Vali Acc: 0.206 Test Loss: 2.496 Test Acc: 0.206
Validation loss decreased (-0.094418 --> -0.205531).  Saving model ...
Epoch: 4 cost time: 0.7275230884552002
Epoch: 4, Steps: 12 | Train Loss: 2.371 Vali Loss: 2.318 Vali Acc: 0.333 Test Loss: 2.318 Test Acc: 0.333
Validation loss decreased (-0.205531 --> -0.333310).  Saving model ...
Epoch: 5 cost time: 0.7433667182922363
Epoch: 5, Steps: 12 | Train Loss: 2.196 Vali Loss: 2.133 Vali Acc: 0.467 Test Loss: 2.133 Test Acc: 0.467
Validation loss decreased (-0.333310 --> -0.466645).  Saving model ...
Epoch: 6 cost time: 0.7710602283477783
Epoch: 6, Steps: 12 | Train Loss: 1.948 Vali Loss: 1.977 Vali Acc: 0.556 Test Loss: 1.977 Test Acc: 0.556
Validation loss decreased (-0.466645 --> -0.555536).  Saving model ...
Epoch: 7 cost time: 0.7772159576416016
Epoch: 7, Steps: 12 | Train Loss: 1.774 Vali Loss: 1.821 Vali Acc: 0.567 Test Loss: 1.821 Test Acc: 0.567
Validation loss decreased (-0.555536 --> -0.566648).  Saving model ...
Epoch: 8 cost time: 0.8204467296600342
Epoch: 8, Steps: 12 | Train Loss: 1.598 Vali Loss: 1.685 Vali Acc: 0.606 Test Loss: 1.685 Test Acc: 0.606
Validation loss decreased (-0.566648 --> -0.605539).  Saving model ...
Epoch: 9 cost time: 0.7226612567901611
Epoch: 9, Steps: 12 | Train Loss: 1.437 Vali Loss: 1.557 Vali Acc: 0.656 Test Loss: 1.557 Test Acc: 0.656
Validation loss decreased (-0.605539 --> -0.655540).  Saving model ...
Epoch: 10 cost time: 0.8245291709899902
Epoch: 10, Steps: 12 | Train Loss: 1.288 Vali Loss: 1.444 Vali Acc: 0.650 Test Loss: 1.444 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7128393650054932
Epoch: 11, Steps: 12 | Train Loss: 1.170 Vali Loss: 1.359 Vali Acc: 0.683 Test Loss: 1.359 Test Acc: 0.683
Validation loss decreased (-0.655540 --> -0.683320).  Saving model ...
Epoch: 12 cost time: 0.7070159912109375
Epoch: 12, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.266 Vali Acc: 0.689 Test Loss: 1.266 Test Acc: 0.689
Validation loss decreased (-0.683320 --> -0.688876).  Saving model ...
Epoch: 13 cost time: 0.7909862995147705
Epoch: 13, Steps: 12 | Train Loss: 0.976 Vali Loss: 1.198 Vali Acc: 0.700 Test Loss: 1.198 Test Acc: 0.700
Validation loss decreased (-0.688876 --> -0.699988).  Saving model ...
Epoch: 14 cost time: 0.737210750579834
Epoch: 14, Steps: 12 | Train Loss: 0.890 Vali Loss: 1.152 Vali Acc: 0.694 Test Loss: 1.152 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6687977313995361
Epoch: 15, Steps: 12 | Train Loss: 0.841 Vali Loss: 1.082 Vali Acc: 0.711 Test Loss: 1.082 Test Acc: 0.711
Validation loss decreased (-0.699988 --> -0.711100).  Saving model ...
Epoch: 16 cost time: 0.7605326175689697
Epoch: 16, Steps: 12 | Train Loss: 0.772 Vali Loss: 1.028 Vali Acc: 0.722 Test Loss: 1.028 Test Acc: 0.722
Validation loss decreased (-0.711100 --> -0.722212).  Saving model ...
Epoch: 17 cost time: 0.7920441627502441
Epoch: 17, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.984 Vali Acc: 0.750 Test Loss: 0.984 Test Acc: 0.750
Validation loss decreased (-0.722212 --> -0.749990).  Saving model ...
Epoch: 18 cost time: 0.7861599922180176
Epoch: 18, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.939 Vali Acc: 0.744 Test Loss: 0.939 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.848743200302124
Epoch: 19, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.892 Vali Acc: 0.744 Test Loss: 0.892 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7098288536071777
Epoch: 20, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.860 Vali Acc: 0.750 Test Loss: 0.860 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 21 cost time: 0.7720389366149902
Epoch: 21, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.828 Vali Acc: 0.756 Test Loss: 0.828 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.755547).  Saving model ...
Epoch: 22 cost time: 0.8403325080871582
Epoch: 22, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.803 Vali Acc: 0.756 Test Loss: 0.803 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755548).  Saving model ...
Epoch: 23 cost time: 0.7128646373748779
Epoch: 23, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.763 Vali Acc: 0.756 Test Loss: 0.763 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 24 cost time: 0.7540998458862305
Epoch: 24, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.749 Vali Acc: 0.778 Test Loss: 0.749 Test Acc: 0.778
Validation loss decreased (-0.755548 --> -0.777770).  Saving model ...
Epoch: 25 cost time: 0.8112215995788574
Epoch: 25, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.719 Vali Acc: 0.789 Test Loss: 0.719 Test Acc: 0.789
Validation loss decreased (-0.777770 --> -0.788882).  Saving model ...
Epoch: 26 cost time: 0.6763143539428711
Epoch: 26, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.720 Vali Acc: 0.794 Test Loss: 0.720 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794437).  Saving model ...
Epoch: 27 cost time: 0.8095464706420898
Epoch: 27, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.703 Vali Acc: 0.817 Test Loss: 0.703 Test Acc: 0.817
Validation loss decreased (-0.794437 --> -0.816660).  Saving model ...
Epoch: 28 cost time: 0.8196671009063721
Epoch: 28, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.684 Vali Acc: 0.800 Test Loss: 0.684 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7880079746246338
Epoch: 29, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.661 Vali Acc: 0.828 Test Loss: 0.661 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 30 cost time: 0.758552074432373
Epoch: 30, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.673 Vali Acc: 0.811 Test Loss: 0.673 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7881264686584473
Epoch: 31, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.675 Vali Acc: 0.817 Test Loss: 0.675 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.719576358795166
Epoch: 32, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.647 Vali Acc: 0.828 Test Loss: 0.647 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 33 cost time: 0.7736985683441162
Epoch: 33, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.641 Vali Acc: 0.844 Test Loss: 0.641 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 34 cost time: 0.7743117809295654
Epoch: 34, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.649 Vali Acc: 0.850 Test Loss: 0.649 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 35 cost time: 0.7472035884857178
Epoch: 35, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.643 Vali Acc: 0.828 Test Loss: 0.643 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7344863414764404
Epoch: 36, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.660 Vali Acc: 0.839 Test Loss: 0.660 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7177982330322266
Epoch: 37, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.677 Vali Acc: 0.856 Test Loss: 0.677 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 38 cost time: 0.8425638675689697
Epoch: 38, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.652 Vali Acc: 0.833 Test Loss: 0.652 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7537927627563477
Epoch: 39, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.679 Vali Acc: 0.856 Test Loss: 0.679 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8037219047546387
Epoch: 40, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.705 Vali Acc: 0.844 Test Loss: 0.705 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7683169841766357
Epoch: 41, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.694 Vali Acc: 0.844 Test Loss: 0.694 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7755560874938965
Epoch: 42, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.688 Vali Acc: 0.850 Test Loss: 0.688 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7728488445281982
Epoch: 43, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.706 Vali Acc: 0.839 Test Loss: 0.706 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.7344739437103271
Epoch: 44, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.710 Vali Acc: 0.828 Test Loss: 0.710 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.7374792098999023
Epoch: 45, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.713 Vali Acc: 0.833 Test Loss: 0.713 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.7410402297973633
Epoch: 46, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.687 Vali Acc: 0.844 Test Loss: 0.687 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.7095301151275635
Epoch: 47, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.733 Vali Acc: 0.867 Test Loss: 0.733 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866659).  Saving model ...
Epoch: 48 cost time: 0.734626054763794
Epoch: 48, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.730 Vali Acc: 0.850 Test Loss: 0.730 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8142540454864502
Epoch: 49, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.713 Vali Acc: 0.850 Test Loss: 0.713 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7736780643463135
Epoch: 50, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.713 Vali Acc: 0.856 Test Loss: 0.713 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 34191
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9915828704833984
Epoch: 1, Steps: 12 | Train Loss: 2.804 Vali Loss: 2.761 Vali Acc: 0.094 Test Loss: 2.761 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 0.765650749206543
Epoch: 2, Steps: 12 | Train Loss: 2.770 Vali Loss: 2.706 Vali Acc: 0.150 Test Loss: 2.706 Test Acc: 0.150
Validation loss decreased (-0.094417 --> -0.149973).  Saving model ...
Epoch: 3 cost time: 0.8120942115783691
Epoch: 3, Steps: 12 | Train Loss: 2.621 Vali Loss: 2.598 Vali Acc: 0.194 Test Loss: 2.598 Test Acc: 0.194
Validation loss decreased (-0.149973 --> -0.194418).  Saving model ...
Epoch: 4 cost time: 0.8191335201263428
Epoch: 4, Steps: 12 | Train Loss: 2.433 Vali Loss: 2.458 Vali Acc: 0.256 Test Loss: 2.458 Test Acc: 0.256
Validation loss decreased (-0.194418 --> -0.255531).  Saving model ...
Epoch: 5 cost time: 0.8539741039276123
Epoch: 5, Steps: 12 | Train Loss: 2.277 Vali Loss: 2.313 Vali Acc: 0.300 Test Loss: 2.313 Test Acc: 0.300
Validation loss decreased (-0.255531 --> -0.299977).  Saving model ...
Epoch: 6 cost time: 0.83184814453125
Epoch: 6, Steps: 12 | Train Loss: 2.091 Vali Loss: 2.163 Vali Acc: 0.400 Test Loss: 2.163 Test Acc: 0.400
Validation loss decreased (-0.299977 --> -0.399978).  Saving model ...
Epoch: 7 cost time: 0.836683988571167
Epoch: 7, Steps: 12 | Train Loss: 1.962 Vali Loss: 2.034 Vali Acc: 0.489 Test Loss: 2.034 Test Acc: 0.489
Validation loss decreased (-0.399978 --> -0.488869).  Saving model ...
Epoch: 8 cost time: 0.7882792949676514
Epoch: 8, Steps: 12 | Train Loss: 1.816 Vali Loss: 1.895 Vali Acc: 0.556 Test Loss: 1.895 Test Acc: 0.556
Validation loss decreased (-0.488869 --> -0.555537).  Saving model ...
Epoch: 9 cost time: 0.7972829341888428
Epoch: 9, Steps: 12 | Train Loss: 1.645 Vali Loss: 1.762 Vali Acc: 0.561 Test Loss: 1.762 Test Acc: 0.561
Validation loss decreased (-0.555537 --> -0.561093).  Saving model ...
Epoch: 10 cost time: 0.7883000373840332
Epoch: 10, Steps: 12 | Train Loss: 1.563 Vali Loss: 1.645 Vali Acc: 0.622 Test Loss: 1.645 Test Acc: 0.622
Validation loss decreased (-0.561093 --> -0.622206).  Saving model ...
Epoch: 11 cost time: 0.7595009803771973
Epoch: 11, Steps: 12 | Train Loss: 1.376 Vali Loss: 1.553 Vali Acc: 0.656 Test Loss: 1.553 Test Acc: 0.656
Validation loss decreased (-0.622206 --> -0.655540).  Saving model ...
Epoch: 12 cost time: 0.70583176612854
Epoch: 12, Steps: 12 | Train Loss: 1.283 Vali Loss: 1.458 Vali Acc: 0.650 Test Loss: 1.458 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7286398410797119
Epoch: 13, Steps: 12 | Train Loss: 1.206 Vali Loss: 1.381 Vali Acc: 0.667 Test Loss: 1.381 Test Acc: 0.667
Validation loss decreased (-0.655540 --> -0.666653).  Saving model ...
Epoch: 14 cost time: 0.7531657218933105
Epoch: 14, Steps: 12 | Train Loss: 1.132 Vali Loss: 1.313 Vali Acc: 0.672 Test Loss: 1.313 Test Acc: 0.672
Validation loss decreased (-0.666653 --> -0.672209).  Saving model ...
Epoch: 15 cost time: 0.8125710487365723
Epoch: 15, Steps: 12 | Train Loss: 1.051 Vali Loss: 1.252 Vali Acc: 0.706 Test Loss: 1.252 Test Acc: 0.706
Validation loss decreased (-0.672209 --> -0.705543).  Saving model ...
Epoch: 16 cost time: 0.8026015758514404
Epoch: 16, Steps: 12 | Train Loss: 0.941 Vali Loss: 1.215 Vali Acc: 0.700 Test Loss: 1.215 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8505518436431885
Epoch: 17, Steps: 12 | Train Loss: 0.858 Vali Loss: 1.135 Vali Acc: 0.717 Test Loss: 1.135 Test Acc: 0.717
Validation loss decreased (-0.705543 --> -0.716655).  Saving model ...
Epoch: 18 cost time: 0.8217744827270508
Epoch: 18, Steps: 12 | Train Loss: 0.804 Vali Loss: 1.067 Vali Acc: 0.722 Test Loss: 1.067 Test Acc: 0.722
Validation loss decreased (-0.716655 --> -0.722212).  Saving model ...
Epoch: 19 cost time: 0.7070016860961914
Epoch: 19, Steps: 12 | Train Loss: 0.759 Vali Loss: 1.030 Vali Acc: 0.722 Test Loss: 1.030 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722212).  Saving model ...
Epoch: 20 cost time: 0.778127908706665
Epoch: 20, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.998 Vali Acc: 0.739 Test Loss: 0.998 Test Acc: 0.739
Validation loss decreased (-0.722212 --> -0.738879).  Saving model ...
Epoch: 21 cost time: 0.7545273303985596
Epoch: 21, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.942 Vali Acc: 0.739 Test Loss: 0.942 Test Acc: 0.739
Validation loss decreased (-0.738879 --> -0.738879).  Saving model ...
Epoch: 22 cost time: 0.7079017162322998
Epoch: 22, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.900 Vali Acc: 0.739 Test Loss: 0.900 Test Acc: 0.739
Validation loss decreased (-0.738879 --> -0.738880).  Saving model ...
Epoch: 23 cost time: 0.7000267505645752
Epoch: 23, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.870 Vali Acc: 0.739 Test Loss: 0.870 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738880).  Saving model ...
Epoch: 24 cost time: 0.7889976501464844
Epoch: 24, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.837 Vali Acc: 0.750 Test Loss: 0.837 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749992).  Saving model ...
Epoch: 25 cost time: 0.8126406669616699
Epoch: 25, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.818 Vali Acc: 0.739 Test Loss: 0.818 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7995166778564453
Epoch: 26, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.785 Vali Acc: 0.761 Test Loss: 0.785 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761103).  Saving model ...
Epoch: 27 cost time: 0.7051165103912354
Epoch: 27, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.742 Vali Acc: 0.783 Test Loss: 0.742 Test Acc: 0.783
Validation loss decreased (-0.761103 --> -0.783326).  Saving model ...
Epoch: 28 cost time: 0.7113595008850098
Epoch: 28, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.728 Vali Acc: 0.794 Test Loss: 0.728 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794437).  Saving model ...
Epoch: 29 cost time: 0.7058241367340088
Epoch: 29, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.710 Vali Acc: 0.800 Test Loss: 0.710 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 30 cost time: 0.7420310974121094
Epoch: 30, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.689 Vali Acc: 0.806 Test Loss: 0.689 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 31 cost time: 0.7437045574188232
Epoch: 31, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.674 Vali Acc: 0.822 Test Loss: 0.674 Test Acc: 0.822
Validation loss decreased (-0.805549 --> -0.822215).  Saving model ...
Epoch: 32 cost time: 0.6973865032196045
Epoch: 32, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.665 Vali Acc: 0.839 Test Loss: 0.665 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838882).  Saving model ...
Epoch: 33 cost time: 0.8008160591125488
Epoch: 33, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.666 Vali Acc: 0.811 Test Loss: 0.666 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7633140087127686
Epoch: 34, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.645 Vali Acc: 0.822 Test Loss: 0.645 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8431680202484131
Epoch: 35, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.640 Vali Acc: 0.828 Test Loss: 0.640 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9124040603637695
Epoch: 36, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.631 Vali Acc: 0.833 Test Loss: 0.631 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.832409143447876
Epoch: 37, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.636 Vali Acc: 0.839 Test Loss: 0.636 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 38 cost time: 0.8058876991271973
Epoch: 38, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.620 Vali Acc: 0.822 Test Loss: 0.620 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8419790267944336
Epoch: 39, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.624 Vali Acc: 0.828 Test Loss: 0.624 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8301732540130615
Epoch: 40, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.611 Vali Acc: 0.822 Test Loss: 0.611 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8021643161773682
Epoch: 41, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.604 Vali Acc: 0.856 Test Loss: 0.604 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 42 cost time: 0.8381593227386475
Epoch: 42, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.609 Vali Acc: 0.844 Test Loss: 0.609 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8247897624969482
Epoch: 43, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.800626277923584
Epoch: 44, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.631 Vali Acc: 0.844 Test Loss: 0.631 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9148056507110596
Epoch: 45, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.630 Vali Acc: 0.844 Test Loss: 0.630 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8637561798095703
Epoch: 46, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.652 Vali Acc: 0.828 Test Loss: 0.652 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.7795896530151367
Epoch: 47, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.651 Vali Acc: 0.833 Test Loss: 0.651 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.8312633037567139
Epoch: 48, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.645 Vali Acc: 0.844 Test Loss: 0.645 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.8943734169006348
Epoch: 49, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.634 Vali Acc: 0.828 Test Loss: 0.634 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.8135437965393066
Epoch: 50, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.631 Vali Acc: 0.828 Test Loss: 0.631 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 30415
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0480029582977295
Epoch: 1, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.664 Vali Acc: 0.106 Test Loss: 2.664 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 0.7269978523254395
Epoch: 2, Steps: 12 | Train Loss: 2.653 Vali Loss: 2.596 Vali Acc: 0.167 Test Loss: 2.596 Test Acc: 0.167
Validation loss decreased (-0.105529 --> -0.166641).  Saving model ...
Epoch: 3 cost time: 0.773423433303833
Epoch: 3, Steps: 12 | Train Loss: 2.576 Vali Loss: 2.491 Vali Acc: 0.239 Test Loss: 2.491 Test Acc: 0.239
Validation loss decreased (-0.166641 --> -0.238864).  Saving model ...
Epoch: 4 cost time: 0.817072868347168
Epoch: 4, Steps: 12 | Train Loss: 2.453 Vali Loss: 2.370 Vali Acc: 0.311 Test Loss: 2.370 Test Acc: 0.311
Validation loss decreased (-0.238864 --> -0.311087).  Saving model ...
Epoch: 5 cost time: 0.7268261909484863
Epoch: 5, Steps: 12 | Train Loss: 2.301 Vali Loss: 2.254 Vali Acc: 0.378 Test Loss: 2.254 Test Acc: 0.378
Validation loss decreased (-0.311087 --> -0.377755).  Saving model ...
Epoch: 6 cost time: 0.7500948905944824
Epoch: 6, Steps: 12 | Train Loss: 2.179 Vali Loss: 2.136 Vali Acc: 0.411 Test Loss: 2.136 Test Acc: 0.411
Validation loss decreased (-0.377755 --> -0.411090).  Saving model ...
Epoch: 7 cost time: 0.7426095008850098
Epoch: 7, Steps: 12 | Train Loss: 2.039 Vali Loss: 2.007 Vali Acc: 0.450 Test Loss: 2.007 Test Acc: 0.450
Validation loss decreased (-0.411090 --> -0.449980).  Saving model ...
Epoch: 8 cost time: 0.7689216136932373
Epoch: 8, Steps: 12 | Train Loss: 1.909 Vali Loss: 1.898 Vali Acc: 0.511 Test Loss: 1.898 Test Acc: 0.511
Validation loss decreased (-0.449980 --> -0.511092).  Saving model ...
Epoch: 9 cost time: 0.7665364742279053
Epoch: 9, Steps: 12 | Train Loss: 1.751 Vali Loss: 1.791 Vali Acc: 0.561 Test Loss: 1.791 Test Acc: 0.561
Validation loss decreased (-0.511092 --> -0.561093).  Saving model ...
Epoch: 10 cost time: 0.805974006652832
Epoch: 10, Steps: 12 | Train Loss: 1.623 Vali Loss: 1.705 Vali Acc: 0.606 Test Loss: 1.705 Test Acc: 0.606
Validation loss decreased (-0.561093 --> -0.605539).  Saving model ...
Epoch: 11 cost time: 0.7900664806365967
Epoch: 11, Steps: 12 | Train Loss: 1.483 Vali Loss: 1.597 Vali Acc: 0.617 Test Loss: 1.597 Test Acc: 0.617
Validation loss decreased (-0.605539 --> -0.616651).  Saving model ...
Epoch: 12 cost time: 0.7646651268005371
Epoch: 12, Steps: 12 | Train Loss: 1.392 Vali Loss: 1.507 Vali Acc: 0.650 Test Loss: 1.507 Test Acc: 0.650
Validation loss decreased (-0.616651 --> -0.649985).  Saving model ...
Epoch: 13 cost time: 0.7272610664367676
Epoch: 13, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.428 Vali Acc: 0.661 Test Loss: 1.428 Test Acc: 0.661
Validation loss decreased (-0.649985 --> -0.661097).  Saving model ...
Epoch: 14 cost time: 0.7912495136260986
Epoch: 14, Steps: 12 | Train Loss: 1.214 Vali Loss: 1.350 Vali Acc: 0.672 Test Loss: 1.350 Test Acc: 0.672
Validation loss decreased (-0.661097 --> -0.672209).  Saving model ...
Epoch: 15 cost time: 0.758704662322998
Epoch: 15, Steps: 12 | Train Loss: 1.111 Vali Loss: 1.269 Vali Acc: 0.672 Test Loss: 1.269 Test Acc: 0.672
Validation loss decreased (-0.672209 --> -0.672210).  Saving model ...
Epoch: 16 cost time: 0.7561845779418945
Epoch: 16, Steps: 12 | Train Loss: 1.061 Vali Loss: 1.202 Vali Acc: 0.717 Test Loss: 1.202 Test Acc: 0.717
Validation loss decreased (-0.672210 --> -0.716655).  Saving model ...
Epoch: 17 cost time: 0.7441608905792236
Epoch: 17, Steps: 12 | Train Loss: 0.959 Vali Loss: 1.136 Vali Acc: 0.706 Test Loss: 1.136 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8051445484161377
Epoch: 18, Steps: 12 | Train Loss: 0.883 Vali Loss: 1.092 Vali Acc: 0.728 Test Loss: 1.092 Test Acc: 0.728
Validation loss decreased (-0.716655 --> -0.727767).  Saving model ...
Epoch: 19 cost time: 0.8349673748016357
Epoch: 19, Steps: 12 | Train Loss: 0.848 Vali Loss: 1.038 Vali Acc: 0.717 Test Loss: 1.038 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.751518964767456
Epoch: 20, Steps: 12 | Train Loss: 0.793 Vali Loss: 0.997 Vali Acc: 0.744 Test Loss: 0.997 Test Acc: 0.744
Validation loss decreased (-0.727767 --> -0.744434).  Saving model ...
Epoch: 21 cost time: 0.8243927955627441
Epoch: 21, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.947 Vali Acc: 0.750 Test Loss: 0.947 Test Acc: 0.750
Validation loss decreased (-0.744434 --> -0.749991).  Saving model ...
Epoch: 22 cost time: 0.7750368118286133
Epoch: 22, Steps: 12 | Train Loss: 0.717 Vali Loss: 0.899 Vali Acc: 0.761 Test Loss: 0.899 Test Acc: 0.761
Validation loss decreased (-0.749991 --> -0.761102).  Saving model ...
Epoch: 23 cost time: 0.7457327842712402
Epoch: 23, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.848 Vali Acc: 0.794 Test Loss: 0.848 Test Acc: 0.794
Validation loss decreased (-0.761102 --> -0.794436).  Saving model ...
Epoch: 24 cost time: 0.8091261386871338
Epoch: 24, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.818 Vali Acc: 0.767 Test Loss: 0.818 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7294058799743652
Epoch: 25, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.787 Vali Acc: 0.778 Test Loss: 0.787 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7564094066619873
Epoch: 26, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.759 Vali Acc: 0.772 Test Loss: 0.759 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7184042930603027
Epoch: 27, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.726 Vali Acc: 0.800 Test Loss: 0.726 Test Acc: 0.800
Validation loss decreased (-0.794436 --> -0.799993).  Saving model ...
Epoch: 28 cost time: 0.7347168922424316
Epoch: 28, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.725 Vali Acc: 0.783 Test Loss: 0.725 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7980830669403076
Epoch: 29, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.681 Vali Acc: 0.800 Test Loss: 0.681 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 30 cost time: 0.7246658802032471
Epoch: 30, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.670 Vali Acc: 0.806 Test Loss: 0.670 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 31 cost time: 0.7749676704406738
Epoch: 31, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.638 Vali Acc: 0.828 Test Loss: 0.638 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827771).  Saving model ...
Epoch: 32 cost time: 0.7499067783355713
Epoch: 32, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.652 Vali Acc: 0.833 Test Loss: 0.652 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 33 cost time: 0.7534985542297363
Epoch: 33, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.624 Vali Acc: 0.822 Test Loss: 0.624 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7662899494171143
Epoch: 34, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.605 Vali Acc: 0.844 Test Loss: 0.605 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 35 cost time: 0.8077635765075684
Epoch: 35, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.590 Vali Acc: 0.856 Test Loss: 0.590 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855550).  Saving model ...
Epoch: 36 cost time: 0.7484335899353027
Epoch: 36, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.581 Vali Acc: 0.861 Test Loss: 0.581 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 37 cost time: 0.7613248825073242
Epoch: 37, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.571 Vali Acc: 0.844 Test Loss: 0.571 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7839224338531494
Epoch: 38, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.560 Vali Acc: 0.856 Test Loss: 0.560 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.73518967628479
Epoch: 39, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.552 Vali Acc: 0.861 Test Loss: 0.552 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 40 cost time: 0.7745153903961182
Epoch: 40, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.551 Vali Acc: 0.861 Test Loss: 0.551 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 41 cost time: 0.7913792133331299
Epoch: 41, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.550 Vali Acc: 0.833 Test Loss: 0.550 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7651693820953369
Epoch: 42, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.557 Vali Acc: 0.833 Test Loss: 0.557 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8026466369628906
Epoch: 43, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.549 Vali Acc: 0.861 Test Loss: 0.549 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 44 cost time: 0.7951745986938477
Epoch: 44, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.533 Vali Acc: 0.839 Test Loss: 0.533 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7682406902313232
Epoch: 45, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.570 Vali Acc: 0.861 Test Loss: 0.570 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7542474269866943
Epoch: 46, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 47 cost time: 0.801703691482544
Epoch: 47, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.578 Vali Acc: 0.856 Test Loss: 0.578 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.732097864151001
Epoch: 48, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.555 Vali Acc: 0.861 Test Loss: 0.555 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7820358276367188
Epoch: 49, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.538 Vali Acc: 0.861 Test Loss: 0.538 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 50 cost time: 0.7659127712249756
Epoch: 50, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.541 Vali Acc: 0.861 Test Loss: 0.541 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 28559
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0982768535614014
Epoch: 1, Steps: 12 | Train Loss: 2.762 Vali Loss: 2.731 Vali Acc: 0.039 Test Loss: 2.731 Test Acc: 0.039
Validation loss decreased (inf --> -0.038862).  Saving model ...
Epoch: 2 cost time: 0.7625858783721924
Epoch: 2, Steps: 12 | Train Loss: 2.681 Vali Loss: 2.702 Vali Acc: 0.106 Test Loss: 2.702 Test Acc: 0.106
Validation loss decreased (-0.038862 --> -0.105529).  Saving model ...
Epoch: 3 cost time: 0.786531925201416
Epoch: 3, Steps: 12 | Train Loss: 2.593 Vali Loss: 2.626 Vali Acc: 0.144 Test Loss: 2.626 Test Acc: 0.144
Validation loss decreased (-0.105529 --> -0.144418).  Saving model ...
Epoch: 4 cost time: 0.8224992752075195
Epoch: 4, Steps: 12 | Train Loss: 2.510 Vali Loss: 2.529 Vali Acc: 0.211 Test Loss: 2.529 Test Acc: 0.211
Validation loss decreased (-0.144418 --> -0.211086).  Saving model ...
Epoch: 5 cost time: 0.8056790828704834
Epoch: 5, Steps: 12 | Train Loss: 2.417 Vali Loss: 2.419 Vali Acc: 0.250 Test Loss: 2.419 Test Acc: 0.250
Validation loss decreased (-0.211086 --> -0.249976).  Saving model ...
Epoch: 6 cost time: 0.8243842124938965
Epoch: 6, Steps: 12 | Train Loss: 2.257 Vali Loss: 2.323 Vali Acc: 0.300 Test Loss: 2.323 Test Acc: 0.300
Validation loss decreased (-0.249976 --> -0.299977).  Saving model ...
Epoch: 7 cost time: 0.8092129230499268
Epoch: 7, Steps: 12 | Train Loss: 2.143 Vali Loss: 2.215 Vali Acc: 0.333 Test Loss: 2.215 Test Acc: 0.333
Validation loss decreased (-0.299977 --> -0.333311).  Saving model ...
Epoch: 8 cost time: 0.8757243156433105
Epoch: 8, Steps: 12 | Train Loss: 2.062 Vali Loss: 2.108 Vali Acc: 0.367 Test Loss: 2.108 Test Acc: 0.367
Validation loss decreased (-0.333311 --> -0.366646).  Saving model ...
Epoch: 9 cost time: 0.7319812774658203
Epoch: 9, Steps: 12 | Train Loss: 1.912 Vali Loss: 2.011 Vali Acc: 0.433 Test Loss: 2.011 Test Acc: 0.433
Validation loss decreased (-0.366646 --> -0.433313).  Saving model ...
Epoch: 10 cost time: 0.8165574073791504
Epoch: 10, Steps: 12 | Train Loss: 1.773 Vali Loss: 1.907 Vali Acc: 0.494 Test Loss: 1.907 Test Acc: 0.494
Validation loss decreased (-0.433313 --> -0.494425).  Saving model ...
Epoch: 11 cost time: 0.7645220756530762
Epoch: 11, Steps: 12 | Train Loss: 1.679 Vali Loss: 1.811 Vali Acc: 0.550 Test Loss: 1.811 Test Acc: 0.550
Validation loss decreased (-0.494425 --> -0.549982).  Saving model ...
Epoch: 12 cost time: 0.7364609241485596
Epoch: 12, Steps: 12 | Train Loss: 1.595 Vali Loss: 1.730 Vali Acc: 0.600 Test Loss: 1.730 Test Acc: 0.600
Validation loss decreased (-0.549982 --> -0.599983).  Saving model ...
Epoch: 13 cost time: 0.7265956401824951
Epoch: 13, Steps: 12 | Train Loss: 1.468 Vali Loss: 1.632 Vali Acc: 0.617 Test Loss: 1.632 Test Acc: 0.617
Validation loss decreased (-0.599983 --> -0.616650).  Saving model ...
Epoch: 14 cost time: 0.7033994197845459
Epoch: 14, Steps: 12 | Train Loss: 1.397 Vali Loss: 1.551 Vali Acc: 0.617 Test Loss: 1.551 Test Acc: 0.617
Validation loss decreased (-0.616650 --> -0.616651).  Saving model ...
Epoch: 15 cost time: 0.774550199508667
Epoch: 15, Steps: 12 | Train Loss: 1.289 Vali Loss: 1.484 Vali Acc: 0.639 Test Loss: 1.484 Test Acc: 0.639
Validation loss decreased (-0.616651 --> -0.638874).  Saving model ...
Epoch: 16 cost time: 0.7619647979736328
Epoch: 16, Steps: 12 | Train Loss: 1.224 Vali Loss: 1.392 Vali Acc: 0.650 Test Loss: 1.392 Test Acc: 0.650
Validation loss decreased (-0.638874 --> -0.649986).  Saving model ...
Epoch: 17 cost time: 0.8018500804901123
Epoch: 17, Steps: 12 | Train Loss: 1.168 Vali Loss: 1.316 Vali Acc: 0.667 Test Loss: 1.316 Test Acc: 0.667
Validation loss decreased (-0.649986 --> -0.666654).  Saving model ...
Epoch: 18 cost time: 0.8383562564849854
Epoch: 18, Steps: 12 | Train Loss: 1.079 Vali Loss: 1.270 Vali Acc: 0.683 Test Loss: 1.270 Test Acc: 0.683
Validation loss decreased (-0.666654 --> -0.683321).  Saving model ...
Epoch: 19 cost time: 0.8659563064575195
Epoch: 19, Steps: 12 | Train Loss: 0.993 Vali Loss: 1.207 Vali Acc: 0.683 Test Loss: 1.207 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 20 cost time: 0.8223185539245605
Epoch: 20, Steps: 12 | Train Loss: 0.903 Vali Loss: 1.136 Vali Acc: 0.722 Test Loss: 1.136 Test Acc: 0.722
Validation loss decreased (-0.683321 --> -0.722211).  Saving model ...
Epoch: 21 cost time: 0.8446993827819824
Epoch: 21, Steps: 12 | Train Loss: 0.927 Vali Loss: 1.093 Vali Acc: 0.728 Test Loss: 1.093 Test Acc: 0.728
Validation loss decreased (-0.722211 --> -0.727767).  Saving model ...
Epoch: 22 cost time: 0.7792391777038574
Epoch: 22, Steps: 12 | Train Loss: 0.778 Vali Loss: 1.055 Vali Acc: 0.739 Test Loss: 1.055 Test Acc: 0.739
Validation loss decreased (-0.727767 --> -0.738878).  Saving model ...
Epoch: 23 cost time: 0.761117696762085
Epoch: 23, Steps: 12 | Train Loss: 0.747 Vali Loss: 1.005 Vali Acc: 0.744 Test Loss: 1.005 Test Acc: 0.744
Validation loss decreased (-0.738878 --> -0.744434).  Saving model ...
Epoch: 24 cost time: 0.794348955154419
Epoch: 24, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.959 Vali Acc: 0.761 Test Loss: 0.959 Test Acc: 0.761
Validation loss decreased (-0.744434 --> -0.761102).  Saving model ...
Epoch: 25 cost time: 0.8077917098999023
Epoch: 25, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.934 Vali Acc: 0.744 Test Loss: 0.934 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7525222301483154
Epoch: 26, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.886 Vali Acc: 0.750 Test Loss: 0.886 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8320209980010986
Epoch: 27, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.850 Vali Acc: 0.756 Test Loss: 0.850 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7429201602935791
Epoch: 28, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.825 Vali Acc: 0.783 Test Loss: 0.825 Test Acc: 0.783
Validation loss decreased (-0.761102 --> -0.783325).  Saving model ...
Epoch: 29 cost time: 0.818213701248169
Epoch: 29, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.798 Vali Acc: 0.783 Test Loss: 0.798 Test Acc: 0.783
Validation loss decreased (-0.783325 --> -0.783325).  Saving model ...
Epoch: 30 cost time: 0.8053619861602783
Epoch: 30, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.772 Vali Acc: 0.806 Test Loss: 0.772 Test Acc: 0.806
Validation loss decreased (-0.783325 --> -0.805548).  Saving model ...
Epoch: 31 cost time: 0.7548096179962158
Epoch: 31, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.743 Vali Acc: 0.806 Test Loss: 0.743 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805548).  Saving model ...
Epoch: 32 cost time: 0.729102611541748
Epoch: 32, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.712 Vali Acc: 0.822 Test Loss: 0.712 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822215).  Saving model ...
Epoch: 33 cost time: 0.7924807071685791
Epoch: 33, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.682 Vali Acc: 0.828 Test Loss: 0.682 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 34 cost time: 0.7980062961578369
Epoch: 34, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.666 Vali Acc: 0.839 Test Loss: 0.666 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 35 cost time: 0.6563236713409424
Epoch: 35, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.652 Vali Acc: 0.833 Test Loss: 0.652 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7947046756744385
Epoch: 36, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.652 Vali Acc: 0.828 Test Loss: 0.652 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8024539947509766
Epoch: 37, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.630 Vali Acc: 0.822 Test Loss: 0.630 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8083665370941162
Epoch: 38, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.602 Vali Acc: 0.833 Test Loss: 0.602 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8464455604553223
Epoch: 39, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.593 Vali Acc: 0.839 Test Loss: 0.593 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 40 cost time: 0.7795114517211914
Epoch: 40, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.587 Vali Acc: 0.850 Test Loss: 0.587 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 41 cost time: 0.7756102085113525
Epoch: 41, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.572 Vali Acc: 0.833 Test Loss: 0.572 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7848167419433594
Epoch: 42, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.559 Vali Acc: 0.839 Test Loss: 0.559 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.728834867477417
Epoch: 43, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.554 Vali Acc: 0.833 Test Loss: 0.554 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7926537990570068
Epoch: 44, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.555 Vali Acc: 0.844 Test Loss: 0.555 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7329602241516113
Epoch: 45, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.554 Vali Acc: 0.833 Test Loss: 0.554 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.7825329303741455
Epoch: 46, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.559 Vali Acc: 0.833 Test Loss: 0.559 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.7881531715393066
Epoch: 47, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.554 Vali Acc: 0.850 Test Loss: 0.554 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 48 cost time: 0.7930948734283447
Epoch: 48, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 49 cost time: 0.8210248947143555
Epoch: 49, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.537 Vali Acc: 0.856 Test Loss: 0.537 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 50 cost time: 0.8142788410186768
Epoch: 50, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.537 Vali Acc: 0.861 Test Loss: 0.537 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 26735
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2450191974639893
Epoch: 1, Steps: 12 | Train Loss: 2.714 Vali Loss: 2.696 Vali Acc: 0.083 Test Loss: 2.696 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 0.8506078720092773
Epoch: 2, Steps: 12 | Train Loss: 2.597 Vali Loss: 2.589 Vali Acc: 0.239 Test Loss: 2.589 Test Acc: 0.239
Validation loss decreased (-0.083306 --> -0.238863).  Saving model ...
Epoch: 3 cost time: 0.9193174839019775
Epoch: 3, Steps: 12 | Train Loss: 2.426 Vali Loss: 2.387 Vali Acc: 0.483 Test Loss: 2.387 Test Acc: 0.483
Validation loss decreased (-0.238863 --> -0.483309).  Saving model ...
Epoch: 4 cost time: 0.9826529026031494
Epoch: 4, Steps: 12 | Train Loss: 2.142 Vali Loss: 2.088 Vali Acc: 0.589 Test Loss: 2.088 Test Acc: 0.589
Validation loss decreased (-0.483309 --> -0.588868).  Saving model ...
Epoch: 5 cost time: 0.9240007400512695
Epoch: 5, Steps: 12 | Train Loss: 1.811 Vali Loss: 1.770 Vali Acc: 0.644 Test Loss: 1.770 Test Acc: 0.644
Validation loss decreased (-0.588868 --> -0.644427).  Saving model ...
Epoch: 6 cost time: 0.9330246448516846
Epoch: 6, Steps: 12 | Train Loss: 1.534 Vali Loss: 1.503 Vali Acc: 0.650 Test Loss: 1.503 Test Acc: 0.650
Validation loss decreased (-0.644427 --> -0.649985).  Saving model ...
Epoch: 7 cost time: 0.8881809711456299
Epoch: 7, Steps: 12 | Train Loss: 1.202 Vali Loss: 1.270 Vali Acc: 0.667 Test Loss: 1.270 Test Acc: 0.667
Validation loss decreased (-0.649985 --> -0.666654).  Saving model ...
Epoch: 8 cost time: 0.9400942325592041
Epoch: 8, Steps: 12 | Train Loss: 1.083 Vali Loss: 1.125 Vali Acc: 0.683 Test Loss: 1.125 Test Acc: 0.683
Validation loss decreased (-0.666654 --> -0.683322).  Saving model ...
Epoch: 9 cost time: 0.8541500568389893
Epoch: 9, Steps: 12 | Train Loss: 0.769 Vali Loss: 1.006 Vali Acc: 0.694 Test Loss: 1.006 Test Acc: 0.694
Validation loss decreased (-0.683322 --> -0.694434).  Saving model ...
Epoch: 10 cost time: 0.9015028476715088
Epoch: 10, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.914 Vali Acc: 0.733 Test Loss: 0.914 Test Acc: 0.733
Validation loss decreased (-0.694434 --> -0.733324).  Saving model ...
Epoch: 11 cost time: 0.9542138576507568
Epoch: 11, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.848 Vali Acc: 0.750 Test Loss: 0.848 Test Acc: 0.750
Validation loss decreased (-0.733324 --> -0.749992).  Saving model ...
Epoch: 12 cost time: 0.8863646984100342
Epoch: 12, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.776 Vali Acc: 0.778 Test Loss: 0.776 Test Acc: 0.778
Validation loss decreased (-0.749992 --> -0.777770).  Saving model ...
Epoch: 13 cost time: 0.955653190612793
Epoch: 13, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.741 Vali Acc: 0.789 Test Loss: 0.741 Test Acc: 0.789
Validation loss decreased (-0.777770 --> -0.788881).  Saving model ...
Epoch: 14 cost time: 0.9339525699615479
Epoch: 14, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.672 Vali Acc: 0.828 Test Loss: 0.672 Test Acc: 0.828
Validation loss decreased (-0.788881 --> -0.827771).  Saving model ...
Epoch: 15 cost time: 0.9808111190795898
Epoch: 15, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.650 Vali Acc: 0.850 Test Loss: 0.650 Test Acc: 0.850
Validation loss decreased (-0.827771 --> -0.849993).  Saving model ...
Epoch: 16 cost time: 0.9587054252624512
Epoch: 16, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.618 Vali Acc: 0.844 Test Loss: 0.618 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0244097709655762
Epoch: 17, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.592 Vali Acc: 0.872 Test Loss: 0.592 Test Acc: 0.872
Validation loss decreased (-0.849993 --> -0.872216).  Saving model ...
Epoch: 18 cost time: 0.9968366622924805
Epoch: 18, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.606 Vali Acc: 0.850 Test Loss: 0.606 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9800505638122559
Epoch: 19, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.590 Vali Acc: 0.861 Test Loss: 0.590 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9946808815002441
Epoch: 20, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.587 Vali Acc: 0.872 Test Loss: 0.587 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 21 cost time: 0.9715602397918701
Epoch: 21, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.584 Vali Acc: 0.872 Test Loss: 0.584 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 22 cost time: 0.9983420372009277
Epoch: 22, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.585 Vali Acc: 0.861 Test Loss: 0.585 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.02583646774292
Epoch: 23, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.613 Vali Acc: 0.872 Test Loss: 0.613 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.009962558746338
Epoch: 24, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.586 Vali Acc: 0.878 Test Loss: 0.586 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 25 cost time: 0.9964570999145508
Epoch: 25, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.639 Vali Acc: 0.856 Test Loss: 0.639 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9971625804901123
Epoch: 26, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.684 Vali Acc: 0.867 Test Loss: 0.684 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0004613399505615
Epoch: 27, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.634 Vali Acc: 0.878 Test Loss: 0.634 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0054435729980469
Epoch: 28, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.601 Vali Acc: 0.878 Test Loss: 0.601 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0382823944091797
Epoch: 29, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.635 Vali Acc: 0.883 Test Loss: 0.635 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 30 cost time: 0.9541323184967041
Epoch: 30, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.685 Vali Acc: 0.861 Test Loss: 0.685 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9725348949432373
Epoch: 31, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.680 Vali Acc: 0.878 Test Loss: 0.680 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9421164989471436
Epoch: 32, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.649 Vali Acc: 0.883 Test Loss: 0.649 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9775600433349609
Epoch: 33, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.679 Vali Acc: 0.878 Test Loss: 0.679 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9392118453979492
Epoch: 34, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.732 Vali Acc: 0.883 Test Loss: 0.732 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.898491382598877
Epoch: 35, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.680 Vali Acc: 0.889 Test Loss: 0.680 Test Acc: 0.889
Validation loss decreased (-0.883327 --> -0.888882).  Saving model ...
Epoch: 36 cost time: 0.8644354343414307
Epoch: 36, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.729 Vali Acc: 0.878 Test Loss: 0.729 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.97672438621521
Epoch: 37, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.732 Vali Acc: 0.878 Test Loss: 0.732 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.973792552947998
Epoch: 38, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.739 Vali Acc: 0.883 Test Loss: 0.739 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.995429515838623
Epoch: 39, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.751 Vali Acc: 0.878 Test Loss: 0.751 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.995614767074585
Epoch: 40, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.753 Vali Acc: 0.878 Test Loss: 0.753 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9279556274414062
Epoch: 41, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.752 Vali Acc: 0.867 Test Loss: 0.752 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.9357869625091553
Epoch: 42, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.779 Vali Acc: 0.861 Test Loss: 0.779 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.8446967601776123
Epoch: 43, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.746 Vali Acc: 0.878 Test Loss: 0.746 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.9317548274993896
Epoch: 44, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.739 Vali Acc: 0.878 Test Loss: 0.739 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.8739933967590332
Epoch: 45, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.742 Vali Acc: 0.883 Test Loss: 0.742 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 255727
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.413566827774048
Epoch: 1, Steps: 12 | Train Loss: 2.683 Vali Loss: 2.665 Vali Acc: 0.100 Test Loss: 2.665 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 0.9729828834533691
Epoch: 2, Steps: 12 | Train Loss: 2.620 Vali Loss: 2.589 Vali Acc: 0.144 Test Loss: 2.589 Test Acc: 0.144
Validation loss decreased (-0.099973 --> -0.144419).  Saving model ...
Epoch: 3 cost time: 0.9570043087005615
Epoch: 3, Steps: 12 | Train Loss: 2.484 Vali Loss: 2.462 Vali Acc: 0.339 Test Loss: 2.462 Test Acc: 0.339
Validation loss decreased (-0.144419 --> -0.338864).  Saving model ...
Epoch: 4 cost time: 0.9499943256378174
Epoch: 4, Steps: 12 | Train Loss: 2.357 Vali Loss: 2.289 Vali Acc: 0.456 Test Loss: 2.289 Test Acc: 0.456
Validation loss decreased (-0.338864 --> -0.455533).  Saving model ...
Epoch: 5 cost time: 0.9302244186401367
Epoch: 5, Steps: 12 | Train Loss: 2.148 Vali Loss: 2.090 Vali Acc: 0.500 Test Loss: 2.090 Test Acc: 0.500
Validation loss decreased (-0.455533 --> -0.499979).  Saving model ...
Epoch: 6 cost time: 0.961158275604248
Epoch: 6, Steps: 12 | Train Loss: 1.881 Vali Loss: 1.859 Vali Acc: 0.572 Test Loss: 1.859 Test Acc: 0.572
Validation loss decreased (-0.499979 --> -0.572204).  Saving model ...
Epoch: 7 cost time: 0.9064671993255615
Epoch: 7, Steps: 12 | Train Loss: 1.592 Vali Loss: 1.622 Vali Acc: 0.622 Test Loss: 1.622 Test Acc: 0.622
Validation loss decreased (-0.572204 --> -0.622206).  Saving model ...
Epoch: 8 cost time: 1.0804023742675781
Epoch: 8, Steps: 12 | Train Loss: 1.352 Vali Loss: 1.406 Vali Acc: 0.656 Test Loss: 1.406 Test Acc: 0.656
Validation loss decreased (-0.622206 --> -0.655541).  Saving model ...
Epoch: 9 cost time: 1.017125129699707
Epoch: 9, Steps: 12 | Train Loss: 1.146 Vali Loss: 1.238 Vali Acc: 0.667 Test Loss: 1.238 Test Acc: 0.667
Validation loss decreased (-0.655541 --> -0.666654).  Saving model ...
Epoch: 10 cost time: 1.029524803161621
Epoch: 10, Steps: 12 | Train Loss: 1.010 Vali Loss: 1.115 Vali Acc: 0.711 Test Loss: 1.115 Test Acc: 0.711
Validation loss decreased (-0.666654 --> -0.711100).  Saving model ...
Epoch: 11 cost time: 1.0064053535461426
Epoch: 11, Steps: 12 | Train Loss: 0.912 Vali Loss: 1.022 Vali Acc: 0.711 Test Loss: 1.022 Test Acc: 0.711
Validation loss decreased (-0.711100 --> -0.711101).  Saving model ...
Epoch: 12 cost time: 0.9640953540802002
Epoch: 12, Steps: 12 | Train Loss: 0.734 Vali Loss: 0.924 Vali Acc: 0.733 Test Loss: 0.924 Test Acc: 0.733
Validation loss decreased (-0.711101 --> -0.733324).  Saving model ...
Epoch: 13 cost time: 0.9917354583740234
Epoch: 13, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.853 Vali Acc: 0.761 Test Loss: 0.853 Test Acc: 0.761
Validation loss decreased (-0.733324 --> -0.761103).  Saving model ...
Epoch: 14 cost time: 1.0418391227722168
Epoch: 14, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.804 Vali Acc: 0.750 Test Loss: 0.804 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0150361061096191
Epoch: 15, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.743 Vali Acc: 0.761 Test Loss: 0.743 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761104).  Saving model ...
Epoch: 16 cost time: 1.0080971717834473
Epoch: 16, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.696 Vali Acc: 0.772 Test Loss: 0.696 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772215).  Saving model ...
Epoch: 17 cost time: 0.9228119850158691
Epoch: 17, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.661 Vali Acc: 0.817 Test Loss: 0.661 Test Acc: 0.817
Validation loss decreased (-0.772215 --> -0.816660).  Saving model ...
Epoch: 18 cost time: 0.9789214134216309
Epoch: 18, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.618 Vali Acc: 0.839 Test Loss: 0.618 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838883).  Saving model ...
Epoch: 19 cost time: 1.0443432331085205
Epoch: 19, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.593 Vali Acc: 0.839 Test Loss: 0.593 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 20 cost time: 1.044945240020752
Epoch: 20, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.581 Vali Acc: 0.844 Test Loss: 0.581 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 21 cost time: 1.0220451354980469
Epoch: 21, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.545 Vali Acc: 0.861 Test Loss: 0.545 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861106).  Saving model ...
Epoch: 22 cost time: 0.9903929233551025
Epoch: 22, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.551 Vali Acc: 0.844 Test Loss: 0.551 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0335631370544434
Epoch: 23, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.518 Vali Acc: 0.867 Test Loss: 0.518 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 24 cost time: 0.9173040390014648
Epoch: 24, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.536 Vali Acc: 0.861 Test Loss: 0.536 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9370758533477783
Epoch: 25, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8929991722106934
Epoch: 26, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9392375946044922
Epoch: 27, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.516 Vali Acc: 0.867 Test Loss: 0.516 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 28 cost time: 0.8817110061645508
Epoch: 28, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.514 Vali Acc: 0.878 Test Loss: 0.514 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 29 cost time: 0.9599270820617676
Epoch: 29, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.537 Vali Acc: 0.883 Test Loss: 0.537 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 30 cost time: 1.023543119430542
Epoch: 30, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.507 Vali Acc: 0.872 Test Loss: 0.507 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0516552925109863
Epoch: 31, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.536 Vali Acc: 0.872 Test Loss: 0.536 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0652952194213867
Epoch: 32, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.533 Vali Acc: 0.883 Test Loss: 0.533 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 33 cost time: 1.0926284790039062
Epoch: 33, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.526 Vali Acc: 0.883 Test Loss: 0.526 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 34 cost time: 1.0578670501708984
Epoch: 34, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.528 Vali Acc: 0.878 Test Loss: 0.528 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0314695835113525
Epoch: 35, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.540 Vali Acc: 0.894 Test Loss: 0.540 Test Acc: 0.894
Validation loss decreased (-0.883328 --> -0.894439).  Saving model ...
Epoch: 36 cost time: 1.0305430889129639
Epoch: 36, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.535 Vali Acc: 0.894 Test Loss: 0.535 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894439).  Saving model ...
Epoch: 37 cost time: 1.0241804122924805
Epoch: 37, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.579 Vali Acc: 0.883 Test Loss: 0.579 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9280753135681152
Epoch: 38, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.575 Vali Acc: 0.878 Test Loss: 0.575 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0174095630645752
Epoch: 39, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.586 Vali Acc: 0.883 Test Loss: 0.586 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9933292865753174
Epoch: 40, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.589 Vali Acc: 0.894 Test Loss: 0.589 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.0842700004577637
Epoch: 41, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.577 Vali Acc: 0.894 Test Loss: 0.577 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.9989700317382812
Epoch: 42, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.565 Vali Acc: 0.889 Test Loss: 0.565 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.0334889888763428
Epoch: 43, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.588 Vali Acc: 0.883 Test Loss: 0.588 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.0812489986419678
Epoch: 44, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.583 Vali Acc: 0.889 Test Loss: 0.583 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.0407795906066895
Epoch: 45, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.595 Vali Acc: 0.889 Test Loss: 0.595 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.021268606185913
Epoch: 46, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.601 Vali Acc: 0.883 Test Loss: 0.601 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 232719
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.423328161239624
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.703 Vali Acc: 0.061 Test Loss: 2.703 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 1.0176422595977783
Epoch: 2, Steps: 12 | Train Loss: 2.620 Vali Loss: 2.628 Vali Acc: 0.200 Test Loss: 2.628 Test Acc: 0.200
Validation loss decreased (-0.061084 --> -0.199974).  Saving model ...
Epoch: 3 cost time: 1.004650592803955
Epoch: 3, Steps: 12 | Train Loss: 2.480 Vali Loss: 2.490 Vali Acc: 0.344 Test Loss: 2.490 Test Acc: 0.344
Validation loss decreased (-0.199974 --> -0.344420).  Saving model ...
Epoch: 4 cost time: 0.9883971214294434
Epoch: 4, Steps: 12 | Train Loss: 2.304 Vali Loss: 2.286 Vali Acc: 0.478 Test Loss: 2.286 Test Acc: 0.478
Validation loss decreased (-0.344420 --> -0.477755).  Saving model ...
Epoch: 5 cost time: 0.9597833156585693
Epoch: 5, Steps: 12 | Train Loss: 2.079 Vali Loss: 2.041 Vali Acc: 0.561 Test Loss: 2.041 Test Acc: 0.561
Validation loss decreased (-0.477755 --> -0.561091).  Saving model ...
Epoch: 6 cost time: 0.9451355934143066
Epoch: 6, Steps: 12 | Train Loss: 1.847 Vali Loss: 1.785 Vali Acc: 0.606 Test Loss: 1.785 Test Acc: 0.606
Validation loss decreased (-0.561091 --> -0.605538).  Saving model ...
Epoch: 7 cost time: 0.9535307884216309
Epoch: 7, Steps: 12 | Train Loss: 1.621 Vali Loss: 1.560 Vali Acc: 0.628 Test Loss: 1.560 Test Acc: 0.628
Validation loss decreased (-0.605538 --> -0.627762).  Saving model ...
Epoch: 8 cost time: 0.970487117767334
Epoch: 8, Steps: 12 | Train Loss: 1.386 Vali Loss: 1.354 Vali Acc: 0.672 Test Loss: 1.354 Test Acc: 0.672
Validation loss decreased (-0.627762 --> -0.672209).  Saving model ...
Epoch: 9 cost time: 0.9413275718688965
Epoch: 9, Steps: 12 | Train Loss: 1.133 Vali Loss: 1.197 Vali Acc: 0.683 Test Loss: 1.197 Test Acc: 0.683
Validation loss decreased (-0.672209 --> -0.683321).  Saving model ...
Epoch: 10 cost time: 1.0060174465179443
Epoch: 10, Steps: 12 | Train Loss: 1.010 Vali Loss: 1.083 Vali Acc: 0.694 Test Loss: 1.083 Test Acc: 0.694
Validation loss decreased (-0.683321 --> -0.694434).  Saving model ...
Epoch: 11 cost time: 0.9957876205444336
Epoch: 11, Steps: 12 | Train Loss: 0.820 Vali Loss: 0.991 Vali Acc: 0.700 Test Loss: 0.991 Test Acc: 0.700
Validation loss decreased (-0.694434 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 0.9222674369812012
Epoch: 12, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.898 Vali Acc: 0.750 Test Loss: 0.898 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 0.922966718673706
Epoch: 13, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.829 Vali Acc: 0.750 Test Loss: 0.829 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 14 cost time: 0.8631927967071533
Epoch: 14, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.763 Vali Acc: 0.761 Test Loss: 0.763 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761103).  Saving model ...
Epoch: 15 cost time: 0.8939125537872314
Epoch: 15, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.713 Vali Acc: 0.778 Test Loss: 0.713 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777771).  Saving model ...
Epoch: 16 cost time: 1.0292012691497803
Epoch: 16, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.668 Vali Acc: 0.794 Test Loss: 0.668 Test Acc: 0.794
Validation loss decreased (-0.777771 --> -0.794438).  Saving model ...
Epoch: 17 cost time: 1.0125648975372314
Epoch: 17, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.614 Vali Acc: 0.828 Test Loss: 0.614 Test Acc: 0.828
Validation loss decreased (-0.794438 --> -0.827772).  Saving model ...
Epoch: 18 cost time: 0.9496040344238281
Epoch: 18, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.604 Vali Acc: 0.822 Test Loss: 0.604 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9880795478820801
Epoch: 19, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.554 Vali Acc: 0.856 Test Loss: 0.554 Test Acc: 0.856
Validation loss decreased (-0.827772 --> -0.855550).  Saving model ...
Epoch: 20 cost time: 1.0117065906524658
Epoch: 20, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 21 cost time: 1.0239684581756592
Epoch: 21, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.567 Vali Acc: 0.828 Test Loss: 0.567 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0394001007080078
Epoch: 22, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.539 Vali Acc: 0.833 Test Loss: 0.539 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9727334976196289
Epoch: 23, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.520 Vali Acc: 0.861 Test Loss: 0.520 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 24 cost time: 0.901465892791748
Epoch: 24, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.497 Vali Acc: 0.878 Test Loss: 0.497 Test Acc: 0.878
Validation loss decreased (-0.861106 --> -0.877773).  Saving model ...
Epoch: 25 cost time: 1.0079491138458252
Epoch: 25, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.516 Vali Acc: 0.867 Test Loss: 0.516 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9287490844726562
Epoch: 26, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.491 Vali Acc: 0.872 Test Loss: 0.491 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9810869693756104
Epoch: 27, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.534 Vali Acc: 0.872 Test Loss: 0.534 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9425837993621826
Epoch: 28, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9036641120910645
Epoch: 29, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.505 Vali Acc: 0.878 Test Loss: 0.505 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9849236011505127
Epoch: 30, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.524 Vali Acc: 0.883 Test Loss: 0.524 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 31 cost time: 1.0150752067565918
Epoch: 31, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.513 Vali Acc: 0.878 Test Loss: 0.513 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1172575950622559
Epoch: 32, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.537 Vali Acc: 0.894 Test Loss: 0.537 Test Acc: 0.894
Validation loss decreased (-0.883328 --> -0.894439).  Saving model ...
Epoch: 33 cost time: 1.0195069313049316
Epoch: 33, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.567 Vali Acc: 0.867 Test Loss: 0.567 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0565502643585205
Epoch: 34, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.556 Vali Acc: 0.878 Test Loss: 0.556 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9375855922698975
Epoch: 35, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.556 Vali Acc: 0.889 Test Loss: 0.556 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.857365608215332
Epoch: 36, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.542 Vali Acc: 0.889 Test Loss: 0.542 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9484169483184814
Epoch: 37, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.538 Vali Acc: 0.894 Test Loss: 0.538 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9554917812347412
Epoch: 38, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.535 Vali Acc: 0.878 Test Loss: 0.535 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.982323169708252
Epoch: 39, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.549 Vali Acc: 0.883 Test Loss: 0.549 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9457294940948486
Epoch: 40, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.566 Vali Acc: 0.889 Test Loss: 0.566 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.985767126083374
Epoch: 41, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.568 Vali Acc: 0.883 Test Loss: 0.568 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.9865398406982422
Epoch: 42, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.599 Vali Acc: 0.894 Test Loss: 0.599 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 232751
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.369386672973633
Epoch: 1, Steps: 12 | Train Loss: 2.690 Vali Loss: 2.673 Vali Acc: 0.122 Test Loss: 2.673 Test Acc: 0.122
Validation loss decreased (inf --> -0.122195).  Saving model ...
Epoch: 2 cost time: 0.9291574954986572
Epoch: 2, Steps: 12 | Train Loss: 2.634 Vali Loss: 2.614 Vali Acc: 0.211 Test Loss: 2.614 Test Acc: 0.211
Validation loss decreased (-0.122195 --> -0.211085).  Saving model ...
Epoch: 3 cost time: 0.9966425895690918
Epoch: 3, Steps: 12 | Train Loss: 2.519 Vali Loss: 2.513 Vali Acc: 0.333 Test Loss: 2.513 Test Acc: 0.333
Validation loss decreased (-0.211085 --> -0.333308).  Saving model ...
Epoch: 4 cost time: 0.969172477722168
Epoch: 4, Steps: 12 | Train Loss: 2.403 Vali Loss: 2.365 Vali Acc: 0.483 Test Loss: 2.365 Test Acc: 0.483
Validation loss decreased (-0.333308 --> -0.483310).  Saving model ...
Epoch: 5 cost time: 0.9433004856109619
Epoch: 5, Steps: 12 | Train Loss: 2.219 Vali Loss: 2.191 Vali Acc: 0.567 Test Loss: 2.191 Test Acc: 0.567
Validation loss decreased (-0.483310 --> -0.566645).  Saving model ...
Epoch: 6 cost time: 0.9171652793884277
Epoch: 6, Steps: 12 | Train Loss: 2.030 Vali Loss: 1.996 Vali Acc: 0.594 Test Loss: 1.996 Test Acc: 0.594
Validation loss decreased (-0.566645 --> -0.594424).  Saving model ...
Epoch: 7 cost time: 0.9679200649261475
Epoch: 7, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.790 Vali Acc: 0.589 Test Loss: 1.790 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0103952884674072
Epoch: 8, Steps: 12 | Train Loss: 1.649 Vali Loss: 1.592 Vali Acc: 0.622 Test Loss: 1.592 Test Acc: 0.622
Validation loss decreased (-0.594424 --> -0.622206).  Saving model ...
Epoch: 9 cost time: 0.9490523338317871
Epoch: 9, Steps: 12 | Train Loss: 1.349 Vali Loss: 1.433 Vali Acc: 0.683 Test Loss: 1.433 Test Acc: 0.683
Validation loss decreased (-0.622206 --> -0.683319).  Saving model ...
Epoch: 10 cost time: 0.944023609161377
Epoch: 10, Steps: 12 | Train Loss: 1.224 Vali Loss: 1.274 Vali Acc: 0.683 Test Loss: 1.274 Test Acc: 0.683
Validation loss decreased (-0.683319 --> -0.683321).  Saving model ...
Epoch: 11 cost time: 0.994351863861084
Epoch: 11, Steps: 12 | Train Loss: 1.058 Vali Loss: 1.128 Vali Acc: 0.694 Test Loss: 1.128 Test Acc: 0.694
Validation loss decreased (-0.683321 --> -0.694433).  Saving model ...
Epoch: 12 cost time: 0.9530351161956787
Epoch: 12, Steps: 12 | Train Loss: 0.906 Vali Loss: 1.013 Vali Acc: 0.717 Test Loss: 1.013 Test Acc: 0.717
Validation loss decreased (-0.694433 --> -0.716657).  Saving model ...
Epoch: 13 cost time: 1.003965139389038
Epoch: 13, Steps: 12 | Train Loss: 0.754 Vali Loss: 0.946 Vali Acc: 0.722 Test Loss: 0.946 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722213).  Saving model ...
Epoch: 14 cost time: 0.9041798114776611
Epoch: 14, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.856 Vali Acc: 0.756 Test Loss: 0.856 Test Acc: 0.756
Validation loss decreased (-0.722213 --> -0.755547).  Saving model ...
Epoch: 15 cost time: 1.025167465209961
Epoch: 15, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.802 Vali Acc: 0.778 Test Loss: 0.802 Test Acc: 0.778
Validation loss decreased (-0.755547 --> -0.777770).  Saving model ...
Epoch: 16 cost time: 0.9988057613372803
Epoch: 16, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.731 Vali Acc: 0.783 Test Loss: 0.731 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783326).  Saving model ...
Epoch: 17 cost time: 0.9570808410644531
Epoch: 17, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.680 Vali Acc: 0.806 Test Loss: 0.680 Test Acc: 0.806
Validation loss decreased (-0.783326 --> -0.805549).  Saving model ...
Epoch: 18 cost time: 0.9835455417633057
Epoch: 18, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.635 Vali Acc: 0.828 Test Loss: 0.635 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827771).  Saving model ...
Epoch: 19 cost time: 0.9368693828582764
Epoch: 19, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.618 Vali Acc: 0.839 Test Loss: 0.618 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838883).  Saving model ...
Epoch: 20 cost time: 0.827625036239624
Epoch: 20, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.589 Vali Acc: 0.833 Test Loss: 0.589 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9601485729217529
Epoch: 21, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.569 Vali Acc: 0.844 Test Loss: 0.569 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 22 cost time: 0.9595317840576172
Epoch: 22, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 0.9919800758361816
Epoch: 23, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.531 Vali Acc: 0.833 Test Loss: 0.531 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9803383350372314
Epoch: 24, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.530 Vali Acc: 0.861 Test Loss: 0.530 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861106).  Saving model ...
Epoch: 25 cost time: 0.9731390476226807
Epoch: 25, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.506 Vali Acc: 0.861 Test Loss: 0.506 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 26 cost time: 1.0240857601165771
Epoch: 26, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.503 Vali Acc: 0.867 Test Loss: 0.503 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 27 cost time: 0.9514825344085693
Epoch: 27, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.515 Vali Acc: 0.878 Test Loss: 0.515 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 28 cost time: 0.9387824535369873
Epoch: 28, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.496 Vali Acc: 0.878 Test Loss: 0.496 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 29 cost time: 0.9609365463256836
Epoch: 29, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.489 Vali Acc: 0.872 Test Loss: 0.489 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9407904148101807
Epoch: 30, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.488 Vali Acc: 0.872 Test Loss: 0.488 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9068858623504639
Epoch: 31, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.501 Vali Acc: 0.867 Test Loss: 0.501 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8942744731903076
Epoch: 32, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.494 Vali Acc: 0.872 Test Loss: 0.494 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8975429534912109
Epoch: 33, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.491 Vali Acc: 0.889 Test Loss: 0.491 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 34 cost time: 0.9912834167480469
Epoch: 34, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.490 Vali Acc: 0.878 Test Loss: 0.490 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9439334869384766
Epoch: 35, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.495 Vali Acc: 0.878 Test Loss: 0.495 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9736719131469727
Epoch: 36, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.499 Vali Acc: 0.872 Test Loss: 0.499 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9949502944946289
Epoch: 37, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.497 Vali Acc: 0.883 Test Loss: 0.497 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9610762596130371
Epoch: 38, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.505 Vali Acc: 0.872 Test Loss: 0.505 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8690590858459473
Epoch: 39, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.498 Vali Acc: 0.889 Test Loss: 0.498 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9524543285369873
Epoch: 40, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.500 Vali Acc: 0.894 Test Loss: 0.500 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894439).  Saving model ...
Epoch: 41 cost time: 0.9722809791564941
Epoch: 41, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.498 Vali Acc: 0.894 Test Loss: 0.498 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894439).  Saving model ...
Epoch: 42 cost time: 0.9784719944000244
Epoch: 42, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.520 Vali Acc: 0.878 Test Loss: 0.520 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.951622486114502
Epoch: 43, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.516 Vali Acc: 0.894 Test Loss: 0.516 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8829681873321533
Epoch: 44, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.518 Vali Acc: 0.889 Test Loss: 0.518 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9350183010101318
Epoch: 45, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.520 Vali Acc: 0.894 Test Loss: 0.520 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.9317803382873535
Epoch: 46, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.521 Vali Acc: 0.894 Test Loss: 0.521 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.9568655490875244
Epoch: 47, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.551 Vali Acc: 0.867 Test Loss: 0.551 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.9700562953948975
Epoch: 48, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.570 Vali Acc: 0.883 Test Loss: 0.570 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9693410396575928
Epoch: 49, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.581 Vali Acc: 0.883 Test Loss: 0.581 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.9939587116241455
Epoch: 50, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.558 Vali Acc: 0.894 Test Loss: 0.558 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 225103
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.537623643875122
Epoch: 1, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.720 Vali Acc: 0.067 Test Loss: 2.720 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 0.9284844398498535
Epoch: 2, Steps: 12 | Train Loss: 2.668 Vali Loss: 2.669 Vali Acc: 0.106 Test Loss: 2.669 Test Acc: 0.106
Validation loss decreased (-0.066639 --> -0.105529).  Saving model ...
Epoch: 3 cost time: 0.9674007892608643
Epoch: 3, Steps: 12 | Train Loss: 2.568 Vali Loss: 2.567 Vali Acc: 0.211 Test Loss: 2.567 Test Acc: 0.211
Validation loss decreased (-0.105529 --> -0.211085).  Saving model ...
Epoch: 4 cost time: 0.9925971031188965
Epoch: 4, Steps: 12 | Train Loss: 2.463 Vali Loss: 2.438 Vali Acc: 0.328 Test Loss: 2.438 Test Acc: 0.328
Validation loss decreased (-0.211085 --> -0.327753).  Saving model ...
Epoch: 5 cost time: 0.9512205123901367
Epoch: 5, Steps: 12 | Train Loss: 2.312 Vali Loss: 2.292 Vali Acc: 0.489 Test Loss: 2.292 Test Acc: 0.489
Validation loss decreased (-0.327753 --> -0.488866).  Saving model ...
Epoch: 6 cost time: 0.9733767509460449
Epoch: 6, Steps: 12 | Train Loss: 2.142 Vali Loss: 2.128 Vali Acc: 0.517 Test Loss: 2.128 Test Acc: 0.517
Validation loss decreased (-0.488866 --> -0.516645).  Saving model ...
Epoch: 7 cost time: 0.9540584087371826
Epoch: 7, Steps: 12 | Train Loss: 1.964 Vali Loss: 1.951 Vali Acc: 0.556 Test Loss: 1.951 Test Acc: 0.556
Validation loss decreased (-0.516645 --> -0.555536).  Saving model ...
Epoch: 8 cost time: 0.9720735549926758
Epoch: 8, Steps: 12 | Train Loss: 1.763 Vali Loss: 1.779 Vali Acc: 0.572 Test Loss: 1.779 Test Acc: 0.572
Validation loss decreased (-0.555536 --> -0.572204).  Saving model ...
Epoch: 9 cost time: 0.9618473052978516
Epoch: 9, Steps: 12 | Train Loss: 1.605 Vali Loss: 1.606 Vali Acc: 0.622 Test Loss: 1.606 Test Acc: 0.622
Validation loss decreased (-0.572204 --> -0.622206).  Saving model ...
Epoch: 10 cost time: 0.9407038688659668
Epoch: 10, Steps: 12 | Train Loss: 1.370 Vali Loss: 1.465 Vali Acc: 0.661 Test Loss: 1.465 Test Acc: 0.661
Validation loss decreased (-0.622206 --> -0.661096).  Saving model ...
Epoch: 11 cost time: 0.9465703964233398
Epoch: 11, Steps: 12 | Train Loss: 1.198 Vali Loss: 1.327 Vali Acc: 0.678 Test Loss: 1.327 Test Acc: 0.678
Validation loss decreased (-0.661096 --> -0.677765).  Saving model ...
Epoch: 12 cost time: 0.9137914180755615
Epoch: 12, Steps: 12 | Train Loss: 1.058 Vali Loss: 1.212 Vali Acc: 0.689 Test Loss: 1.212 Test Acc: 0.689
Validation loss decreased (-0.677765 --> -0.688877).  Saving model ...
Epoch: 13 cost time: 0.9359548091888428
Epoch: 13, Steps: 12 | Train Loss: 0.928 Vali Loss: 1.111 Vali Acc: 0.694 Test Loss: 1.111 Test Acc: 0.694
Validation loss decreased (-0.688877 --> -0.694433).  Saving model ...
Epoch: 14 cost time: 0.9125032424926758
Epoch: 14, Steps: 12 | Train Loss: 0.846 Vali Loss: 1.029 Vali Acc: 0.694 Test Loss: 1.029 Test Acc: 0.694
Validation loss decreased (-0.694433 --> -0.694434).  Saving model ...
Epoch: 15 cost time: 0.8902168273925781
Epoch: 15, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.950 Vali Acc: 0.717 Test Loss: 0.950 Test Acc: 0.717
Validation loss decreased (-0.694434 --> -0.716657).  Saving model ...
Epoch: 16 cost time: 0.9879581928253174
Epoch: 16, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.903 Vali Acc: 0.733 Test Loss: 0.903 Test Acc: 0.733
Validation loss decreased (-0.716657 --> -0.733324).  Saving model ...
Epoch: 17 cost time: 0.8915219306945801
Epoch: 17, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.843 Vali Acc: 0.756 Test Loss: 0.843 Test Acc: 0.756
Validation loss decreased (-0.733324 --> -0.755547).  Saving model ...
Epoch: 18 cost time: 0.9483470916748047
Epoch: 18, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.773 Vali Acc: 0.778 Test Loss: 0.773 Test Acc: 0.778
Validation loss decreased (-0.755547 --> -0.777770).  Saving model ...
Epoch: 19 cost time: 1.007408618927002
Epoch: 19, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.727 Vali Acc: 0.794 Test Loss: 0.727 Test Acc: 0.794
Validation loss decreased (-0.777770 --> -0.794437).  Saving model ...
Epoch: 20 cost time: 0.966740608215332
Epoch: 20, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.692 Vali Acc: 0.794 Test Loss: 0.692 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794438).  Saving model ...
Epoch: 21 cost time: 0.9611175060272217
Epoch: 21, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.659 Vali Acc: 0.828 Test Loss: 0.659 Test Acc: 0.828
Validation loss decreased (-0.794438 --> -0.827771).  Saving model ...
Epoch: 22 cost time: 0.9268496036529541
Epoch: 22, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.632 Vali Acc: 0.822 Test Loss: 0.632 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9627408981323242
Epoch: 23, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.599 Vali Acc: 0.844 Test Loss: 0.599 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 24 cost time: 0.9046552181243896
Epoch: 24, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.575 Vali Acc: 0.861 Test Loss: 0.575 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861105).  Saving model ...
Epoch: 25 cost time: 0.9636156558990479
Epoch: 25, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9085791110992432
Epoch: 26, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.545 Vali Acc: 0.861 Test Loss: 0.545 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 27 cost time: 0.9805092811584473
Epoch: 27, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.527 Vali Acc: 0.861 Test Loss: 0.527 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 28 cost time: 0.9348995685577393
Epoch: 28, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.522 Vali Acc: 0.867 Test Loss: 0.522 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 29 cost time: 0.8992674350738525
Epoch: 29, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8960192203521729
Epoch: 30, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.519 Vali Acc: 0.861 Test Loss: 0.519 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9539222717285156
Epoch: 31, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.512 Vali Acc: 0.878 Test Loss: 0.512 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877773).  Saving model ...
Epoch: 32 cost time: 0.957737922668457
Epoch: 32, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.488 Vali Acc: 0.867 Test Loss: 0.488 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9672777652740479
Epoch: 33, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.505 Vali Acc: 0.883 Test Loss: 0.505 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 34 cost time: 0.9280805587768555
Epoch: 34, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.485 Vali Acc: 0.867 Test Loss: 0.485 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9986231327056885
Epoch: 35, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.494 Vali Acc: 0.861 Test Loss: 0.494 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9846816062927246
Epoch: 36, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.512 Vali Acc: 0.878 Test Loss: 0.512 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9172403812408447
Epoch: 37, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.500 Vali Acc: 0.872 Test Loss: 0.500 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9545731544494629
Epoch: 38, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.486 Vali Acc: 0.878 Test Loss: 0.486 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9829201698303223
Epoch: 39, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.501 Vali Acc: 0.883 Test Loss: 0.501 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 40 cost time: 0.9453866481781006
Epoch: 40, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.519 Vali Acc: 0.883 Test Loss: 0.519 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9647667407989502
Epoch: 41, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.516 Vali Acc: 0.872 Test Loss: 0.516 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9236147403717041
Epoch: 42, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.511 Vali Acc: 0.872 Test Loss: 0.511 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9652194976806641
Epoch: 43, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.521 Vali Acc: 0.867 Test Loss: 0.521 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.9721078872680664
Epoch: 44, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.520 Vali Acc: 0.883 Test Loss: 0.520 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.9971153736114502
Epoch: 45, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.503 Vali Acc: 0.878 Test Loss: 0.503 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.9402797222137451
Epoch: 46, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.510 Vali Acc: 0.883 Test Loss: 0.510 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.954838752746582
Epoch: 47, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.528 Vali Acc: 0.889 Test Loss: 0.528 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888884).  Saving model ...
Epoch: 48 cost time: 0.9975154399871826
Epoch: 48, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.547 Vali Acc: 0.883 Test Loss: 0.547 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0578265190124512
Epoch: 49, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.563 Vali Acc: 0.883 Test Loss: 0.563 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.0087683200836182
Epoch: 50, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.579 Vali Acc: 0.878 Test Loss: 0.579 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 221327
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3584253787994385
Epoch: 1, Steps: 12 | Train Loss: 2.698 Vali Loss: 2.713 Vali Acc: 0.056 Test Loss: 2.713 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 0.962918758392334
Epoch: 2, Steps: 12 | Train Loss: 2.642 Vali Loss: 2.654 Vali Acc: 0.111 Test Loss: 2.654 Test Acc: 0.111
Validation loss decreased (-0.055528 --> -0.111085).  Saving model ...
Epoch: 3 cost time: 0.9827666282653809
Epoch: 3, Steps: 12 | Train Loss: 2.558 Vali Loss: 2.547 Vali Acc: 0.222 Test Loss: 2.547 Test Acc: 0.222
Validation loss decreased (-0.111085 --> -0.222197).  Saving model ...
Epoch: 4 cost time: 0.9563462734222412
Epoch: 4, Steps: 12 | Train Loss: 2.436 Vali Loss: 2.407 Vali Acc: 0.378 Test Loss: 2.407 Test Acc: 0.378
Validation loss decreased (-0.222197 --> -0.377754).  Saving model ...
Epoch: 5 cost time: 0.9200155735015869
Epoch: 5, Steps: 12 | Train Loss: 2.293 Vali Loss: 2.249 Vali Acc: 0.472 Test Loss: 2.249 Test Acc: 0.472
Validation loss decreased (-0.377754 --> -0.472200).  Saving model ...
Epoch: 6 cost time: 0.971768856048584
Epoch: 6, Steps: 12 | Train Loss: 2.114 Vali Loss: 2.093 Vali Acc: 0.500 Test Loss: 2.093 Test Acc: 0.500
Validation loss decreased (-0.472200 --> -0.499979).  Saving model ...
Epoch: 7 cost time: 0.9341390132904053
Epoch: 7, Steps: 12 | Train Loss: 1.915 Vali Loss: 1.931 Vali Acc: 0.522 Test Loss: 1.931 Test Acc: 0.522
Validation loss decreased (-0.499979 --> -0.522203).  Saving model ...
Epoch: 8 cost time: 0.8850138187408447
Epoch: 8, Steps: 12 | Train Loss: 1.764 Vali Loss: 1.782 Vali Acc: 0.567 Test Loss: 1.782 Test Acc: 0.567
Validation loss decreased (-0.522203 --> -0.566649).  Saving model ...
Epoch: 9 cost time: 0.8983759880065918
Epoch: 9, Steps: 12 | Train Loss: 1.533 Vali Loss: 1.617 Vali Acc: 0.578 Test Loss: 1.617 Test Acc: 0.578
Validation loss decreased (-0.566649 --> -0.577762).  Saving model ...
Epoch: 10 cost time: 0.9421923160552979
Epoch: 10, Steps: 12 | Train Loss: 1.377 Vali Loss: 1.452 Vali Acc: 0.633 Test Loss: 1.452 Test Acc: 0.633
Validation loss decreased (-0.577762 --> -0.633319).  Saving model ...
Epoch: 11 cost time: 0.925983190536499
Epoch: 11, Steps: 12 | Train Loss: 1.172 Vali Loss: 1.319 Vali Acc: 0.678 Test Loss: 1.319 Test Acc: 0.678
Validation loss decreased (-0.633319 --> -0.677765).  Saving model ...
Epoch: 12 cost time: 0.9026920795440674
Epoch: 12, Steps: 12 | Train Loss: 1.058 Vali Loss: 1.202 Vali Acc: 0.689 Test Loss: 1.202 Test Acc: 0.689
Validation loss decreased (-0.677765 --> -0.688877).  Saving model ...
Epoch: 13 cost time: 0.9467988014221191
Epoch: 13, Steps: 12 | Train Loss: 0.918 Vali Loss: 1.105 Vali Acc: 0.706 Test Loss: 1.105 Test Acc: 0.706
Validation loss decreased (-0.688877 --> -0.705545).  Saving model ...
Epoch: 14 cost time: 0.9419877529144287
Epoch: 14, Steps: 12 | Train Loss: 0.894 Vali Loss: 1.018 Vali Acc: 0.739 Test Loss: 1.018 Test Acc: 0.739
Validation loss decreased (-0.705545 --> -0.738879).  Saving model ...
Epoch: 15 cost time: 0.9429974555969238
Epoch: 15, Steps: 12 | Train Loss: 0.754 Vali Loss: 0.951 Vali Acc: 0.739 Test Loss: 0.951 Test Acc: 0.739
Validation loss decreased (-0.738879 --> -0.738879).  Saving model ...
Epoch: 16 cost time: 0.9638361930847168
Epoch: 16, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.893 Vali Acc: 0.778 Test Loss: 0.893 Test Acc: 0.778
Validation loss decreased (-0.738879 --> -0.777769).  Saving model ...
Epoch: 17 cost time: 0.9358334541320801
Epoch: 17, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.829 Vali Acc: 0.789 Test Loss: 0.829 Test Acc: 0.789
Validation loss decreased (-0.777769 --> -0.788881).  Saving model ...
Epoch: 18 cost time: 0.9247558116912842
Epoch: 18, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.785 Vali Acc: 0.789 Test Loss: 0.785 Test Acc: 0.789
Validation loss decreased (-0.788881 --> -0.788881).  Saving model ...
Epoch: 19 cost time: 0.8663501739501953
Epoch: 19, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.730 Vali Acc: 0.811 Test Loss: 0.730 Test Acc: 0.811
Validation loss decreased (-0.788881 --> -0.811104).  Saving model ...
Epoch: 20 cost time: 0.967562198638916
Epoch: 20, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.703 Vali Acc: 0.828 Test Loss: 0.703 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 21 cost time: 0.9141969680786133
Epoch: 21, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.693 Vali Acc: 0.822 Test Loss: 0.693 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8407168388366699
Epoch: 22, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.656 Vali Acc: 0.844 Test Loss: 0.656 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 23 cost time: 0.9397859573364258
Epoch: 23, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.613 Vali Acc: 0.844 Test Loss: 0.613 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 24 cost time: 0.9068360328674316
Epoch: 24, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.596 Vali Acc: 0.850 Test Loss: 0.596 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 0.9317300319671631
Epoch: 25, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.594 Vali Acc: 0.856 Test Loss: 0.594 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 26 cost time: 0.9107017517089844
Epoch: 26, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.91267991065979
Epoch: 27, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.561 Vali Acc: 0.867 Test Loss: 0.561 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 28 cost time: 0.9330964088439941
Epoch: 28, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.562 Vali Acc: 0.867 Test Loss: 0.562 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9464924335479736
Epoch: 29, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.545 Vali Acc: 0.867 Test Loss: 0.545 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 30 cost time: 0.9509210586547852
Epoch: 30, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.006645679473877
Epoch: 31, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.952789306640625
Epoch: 32, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.568 Vali Acc: 0.861 Test Loss: 0.568 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9813573360443115
Epoch: 33, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.559 Vali Acc: 0.861 Test Loss: 0.559 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.936481237411499
Epoch: 34, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.544 Vali Acc: 0.861 Test Loss: 0.544 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.911665678024292
Epoch: 35, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9068434238433838
Epoch: 36, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.584 Vali Acc: 0.861 Test Loss: 0.584 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9170470237731934
Epoch: 37, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.542 Vali Acc: 0.856 Test Loss: 0.542 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.9213941097259521
Epoch: 38, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.559 Vali Acc: 0.850 Test Loss: 0.559 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.9605576992034912
Epoch: 39, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 221391
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.410931348800659
Epoch: 1, Steps: 12 | Train Loss: 2.740 Vali Loss: 2.699 Vali Acc: 0.078 Test Loss: 2.699 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 0.9861123561859131
Epoch: 2, Steps: 12 | Train Loss: 2.661 Vali Loss: 2.661 Vali Acc: 0.089 Test Loss: 2.661 Test Acc: 0.089
Validation loss decreased (-0.077751 --> -0.088862).  Saving model ...
Epoch: 3 cost time: 0.93239426612854
Epoch: 3, Steps: 12 | Train Loss: 2.625 Vali Loss: 2.578 Vali Acc: 0.156 Test Loss: 2.578 Test Acc: 0.156
Validation loss decreased (-0.088862 --> -0.155530).  Saving model ...
Epoch: 4 cost time: 0.9340589046478271
Epoch: 4, Steps: 12 | Train Loss: 2.500 Vali Loss: 2.489 Vali Acc: 0.306 Test Loss: 2.489 Test Acc: 0.306
Validation loss decreased (-0.155530 --> -0.305531).  Saving model ...
Epoch: 5 cost time: 0.9189331531524658
Epoch: 5, Steps: 12 | Train Loss: 2.401 Vali Loss: 2.377 Vali Acc: 0.428 Test Loss: 2.377 Test Acc: 0.428
Validation loss decreased (-0.305531 --> -0.427754).  Saving model ...
Epoch: 6 cost time: 0.9402360916137695
Epoch: 6, Steps: 12 | Train Loss: 2.274 Vali Loss: 2.236 Vali Acc: 0.489 Test Loss: 2.236 Test Acc: 0.489
Validation loss decreased (-0.427754 --> -0.488867).  Saving model ...
Epoch: 7 cost time: 0.9022798538208008
Epoch: 7, Steps: 12 | Train Loss: 2.109 Vali Loss: 2.111 Vali Acc: 0.539 Test Loss: 2.111 Test Acc: 0.539
Validation loss decreased (-0.488867 --> -0.538868).  Saving model ...
Epoch: 8 cost time: 0.8518593311309814
Epoch: 8, Steps: 12 | Train Loss: 1.965 Vali Loss: 1.931 Vali Acc: 0.594 Test Loss: 1.931 Test Acc: 0.594
Validation loss decreased (-0.538868 --> -0.594425).  Saving model ...
Epoch: 9 cost time: 0.9107060432434082
Epoch: 9, Steps: 12 | Train Loss: 1.753 Vali Loss: 1.795 Vali Acc: 0.628 Test Loss: 1.795 Test Acc: 0.628
Validation loss decreased (-0.594425 --> -0.627760).  Saving model ...
Epoch: 10 cost time: 0.9762418270111084
Epoch: 10, Steps: 12 | Train Loss: 1.626 Vali Loss: 1.640 Vali Acc: 0.644 Test Loss: 1.640 Test Acc: 0.644
Validation loss decreased (-0.627760 --> -0.644428).  Saving model ...
Epoch: 11 cost time: 0.9451823234558105
Epoch: 11, Steps: 12 | Train Loss: 1.433 Vali Loss: 1.472 Vali Acc: 0.689 Test Loss: 1.472 Test Acc: 0.689
Validation loss decreased (-0.644428 --> -0.688874).  Saving model ...
Epoch: 12 cost time: 0.9713864326477051
Epoch: 12, Steps: 12 | Train Loss: 1.262 Vali Loss: 1.314 Vali Acc: 0.689 Test Loss: 1.314 Test Acc: 0.689
Validation loss decreased (-0.688874 --> -0.688876).  Saving model ...
Epoch: 13 cost time: 0.9128446578979492
Epoch: 13, Steps: 12 | Train Loss: 1.085 Vali Loss: 1.218 Vali Acc: 0.717 Test Loss: 1.218 Test Acc: 0.717
Validation loss decreased (-0.688876 --> -0.716654).  Saving model ...
Epoch: 14 cost time: 0.9654943943023682
Epoch: 14, Steps: 12 | Train Loss: 0.999 Vali Loss: 1.095 Vali Acc: 0.739 Test Loss: 1.095 Test Acc: 0.739
Validation loss decreased (-0.716654 --> -0.738878).  Saving model ...
Epoch: 15 cost time: 0.9629409313201904
Epoch: 15, Steps: 12 | Train Loss: 0.909 Vali Loss: 1.013 Vali Acc: 0.761 Test Loss: 1.013 Test Acc: 0.761
Validation loss decreased (-0.738878 --> -0.761101).  Saving model ...
Epoch: 16 cost time: 0.9643135070800781
Epoch: 16, Steps: 12 | Train Loss: 0.756 Vali Loss: 0.918 Vali Acc: 0.772 Test Loss: 0.918 Test Acc: 0.772
Validation loss decreased (-0.761101 --> -0.772213).  Saving model ...
Epoch: 17 cost time: 0.9135286808013916
Epoch: 17, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.854 Vali Acc: 0.783 Test Loss: 0.854 Test Acc: 0.783
Validation loss decreased (-0.772213 --> -0.783325).  Saving model ...
Epoch: 18 cost time: 0.8898491859436035
Epoch: 18, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.788 Vali Acc: 0.789 Test Loss: 0.788 Test Acc: 0.789
Validation loss decreased (-0.783325 --> -0.788881).  Saving model ...
Epoch: 19 cost time: 0.9274394512176514
Epoch: 19, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.742 Vali Acc: 0.794 Test Loss: 0.742 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794437).  Saving model ...
Epoch: 20 cost time: 0.9492359161376953
Epoch: 20, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.712 Vali Acc: 0.822 Test Loss: 0.712 Test Acc: 0.822
Validation loss decreased (-0.794437 --> -0.822215).  Saving model ...
Epoch: 21 cost time: 0.987929105758667
Epoch: 21, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.681 Vali Acc: 0.822 Test Loss: 0.681 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 22 cost time: 0.9253644943237305
Epoch: 22, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.639 Vali Acc: 0.844 Test Loss: 0.639 Test Acc: 0.844
Validation loss decreased (-0.822215 --> -0.844438).  Saving model ...
Epoch: 23 cost time: 0.9139060974121094
Epoch: 23, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.607 Vali Acc: 0.833 Test Loss: 0.607 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9713716506958008
Epoch: 24, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.595 Vali Acc: 0.844 Test Loss: 0.595 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 25 cost time: 1.0005335807800293
Epoch: 25, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.571 Vali Acc: 0.856 Test Loss: 0.571 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855550).  Saving model ...
Epoch: 26 cost time: 0.9155154228210449
Epoch: 26, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.545 Vali Acc: 0.856 Test Loss: 0.545 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 27 cost time: 0.8932297229766846
Epoch: 27, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.517 Vali Acc: 0.861 Test Loss: 0.517 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 28 cost time: 0.9369230270385742
Epoch: 28, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.504 Vali Acc: 0.878 Test Loss: 0.504 Test Acc: 0.878
Validation loss decreased (-0.861106 --> -0.877773).  Saving model ...
Epoch: 29 cost time: 0.9831969738006592
Epoch: 29, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.480 Vali Acc: 0.878 Test Loss: 0.480 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 30 cost time: 0.9441328048706055
Epoch: 30, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.508 Vali Acc: 0.861 Test Loss: 0.508 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9628517627716064
Epoch: 31, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.499 Vali Acc: 0.861 Test Loss: 0.499 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9402275085449219
Epoch: 32, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.478 Vali Acc: 0.883 Test Loss: 0.478 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 33 cost time: 0.8896167278289795
Epoch: 33, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.486 Vali Acc: 0.872 Test Loss: 0.486 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9391252994537354
Epoch: 34, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.470 Vali Acc: 0.883 Test Loss: 0.470 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883329).  Saving model ...
Epoch: 35 cost time: 0.9061572551727295
Epoch: 35, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.481 Vali Acc: 0.889 Test Loss: 0.481 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 36 cost time: 0.8681414127349854
Epoch: 36, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.497 Vali Acc: 0.872 Test Loss: 0.497 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9079639911651611
Epoch: 37, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.494 Vali Acc: 0.872 Test Loss: 0.494 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9433386325836182
Epoch: 38, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.480 Vali Acc: 0.883 Test Loss: 0.480 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9808750152587891
Epoch: 39, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.471 Vali Acc: 0.883 Test Loss: 0.471 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9254558086395264
Epoch: 40, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.463 Vali Acc: 0.867 Test Loss: 0.463 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9654934406280518
Epoch: 41, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.469 Vali Acc: 0.872 Test Loss: 0.469 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.9418325424194336
Epoch: 42, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.467 Vali Acc: 0.883 Test Loss: 0.467 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9358398914337158
Epoch: 43, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.505 Vali Acc: 0.867 Test Loss: 0.505 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.9132301807403564
Epoch: 44, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.509 Vali Acc: 0.883 Test Loss: 0.509 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.9066896438598633
Epoch: 45, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.502 Vali Acc: 0.872 Test Loss: 0.502 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 217647
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.403615713119507
Epoch: 1, Steps: 12 | Train Loss: 2.711 Vali Loss: 2.677 Vali Acc: 0.106 Test Loss: 2.677 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 0.9657795429229736
Epoch: 2, Steps: 12 | Train Loss: 2.627 Vali Loss: 2.570 Vali Acc: 0.289 Test Loss: 2.570 Test Acc: 0.289
Validation loss decreased (-0.105529 --> -0.288863).  Saving model ...
Epoch: 3 cost time: 1.038527250289917
Epoch: 3, Steps: 12 | Train Loss: 2.416 Vali Loss: 2.369 Vali Acc: 0.472 Test Loss: 2.369 Test Acc: 0.472
Validation loss decreased (-0.288863 --> -0.472199).  Saving model ...
Epoch: 4 cost time: 0.9619715213775635
Epoch: 4, Steps: 12 | Train Loss: 2.148 Vali Loss: 2.065 Vali Acc: 0.550 Test Loss: 2.065 Test Acc: 0.550
Validation loss decreased (-0.472199 --> -0.549979).  Saving model ...
Epoch: 5 cost time: 0.8735072612762451
Epoch: 5, Steps: 12 | Train Loss: 1.781 Vali Loss: 1.749 Vali Acc: 0.600 Test Loss: 1.749 Test Acc: 0.600
Validation loss decreased (-0.549979 --> -0.599983).  Saving model ...
Epoch: 6 cost time: 0.951514720916748
Epoch: 6, Steps: 12 | Train Loss: 1.460 Vali Loss: 1.446 Vali Acc: 0.617 Test Loss: 1.446 Test Acc: 0.617
Validation loss decreased (-0.599983 --> -0.616652).  Saving model ...
Epoch: 7 cost time: 0.9407820701599121
Epoch: 7, Steps: 12 | Train Loss: 1.178 Vali Loss: 1.208 Vali Acc: 0.672 Test Loss: 1.208 Test Acc: 0.672
Validation loss decreased (-0.616652 --> -0.672210).  Saving model ...
Epoch: 8 cost time: 0.9297311305999756
Epoch: 8, Steps: 12 | Train Loss: 0.934 Vali Loss: 1.045 Vali Acc: 0.689 Test Loss: 1.045 Test Acc: 0.689
Validation loss decreased (-0.672210 --> -0.688878).  Saving model ...
Epoch: 9 cost time: 1.0057182312011719
Epoch: 9, Steps: 12 | Train Loss: 0.793 Vali Loss: 0.937 Vali Acc: 0.739 Test Loss: 0.937 Test Acc: 0.739
Validation loss decreased (-0.688878 --> -0.738880).  Saving model ...
Epoch: 10 cost time: 0.9729049205780029
Epoch: 10, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.857 Vali Acc: 0.756 Test Loss: 0.857 Test Acc: 0.756
Validation loss decreased (-0.738880 --> -0.755547).  Saving model ...
Epoch: 11 cost time: 0.9384300708770752
Epoch: 11, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.786 Vali Acc: 0.767 Test Loss: 0.786 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766659).  Saving model ...
Epoch: 12 cost time: 1.0104970932006836
Epoch: 12, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.729 Vali Acc: 0.789 Test Loss: 0.729 Test Acc: 0.789
Validation loss decreased (-0.766659 --> -0.788882).  Saving model ...
Epoch: 13 cost time: 0.9934258460998535
Epoch: 13, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.677 Vali Acc: 0.828 Test Loss: 0.677 Test Acc: 0.828
Validation loss decreased (-0.788882 --> -0.827771).  Saving model ...
Epoch: 14 cost time: 0.9537959098815918
Epoch: 14, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.632 Vali Acc: 0.839 Test Loss: 0.632 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838883).  Saving model ...
Epoch: 15 cost time: 0.9620559215545654
Epoch: 15, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.628 Vali Acc: 0.833 Test Loss: 0.628 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.989457368850708
Epoch: 16, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.609 Vali Acc: 0.839 Test Loss: 0.609 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 17 cost time: 1.0267701148986816
Epoch: 17, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.569 Vali Acc: 0.867 Test Loss: 0.569 Test Acc: 0.867
Validation loss decreased (-0.838883 --> -0.866661).  Saving model ...
Epoch: 18 cost time: 0.9123380184173584
Epoch: 18, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.565 Vali Acc: 0.872 Test Loss: 0.565 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 19 cost time: 0.912095308303833
Epoch: 19, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.594 Vali Acc: 0.867 Test Loss: 0.594 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9075896739959717
Epoch: 20, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.587 Vali Acc: 0.867 Test Loss: 0.587 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9196555614471436
Epoch: 21, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8950135707855225
Epoch: 22, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.566 Vali Acc: 0.878 Test Loss: 0.566 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 23 cost time: 0.9087378978729248
Epoch: 23, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.581 Vali Acc: 0.883 Test Loss: 0.581 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 24 cost time: 0.980553388595581
Epoch: 24, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.614 Vali Acc: 0.872 Test Loss: 0.614 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9169368743896484
Epoch: 25, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.630 Vali Acc: 0.856 Test Loss: 0.630 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9606940746307373
Epoch: 26, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.662 Vali Acc: 0.856 Test Loss: 0.662 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9477889537811279
Epoch: 27, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.615 Vali Acc: 0.878 Test Loss: 0.615 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9541287422180176
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.614 Vali Acc: 0.872 Test Loss: 0.614 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9183104038238525
Epoch: 29, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.636 Vali Acc: 0.889 Test Loss: 0.636 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 30 cost time: 0.9812533855438232
Epoch: 30, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.652 Vali Acc: 0.878 Test Loss: 0.652 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9655799865722656
Epoch: 31, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.657 Vali Acc: 0.872 Test Loss: 0.657 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9072897434234619
Epoch: 32, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.689 Vali Acc: 0.867 Test Loss: 0.689 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.897667646408081
Epoch: 33, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.633 Vali Acc: 0.872 Test Loss: 0.633 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8946459293365479
Epoch: 34, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.678 Vali Acc: 0.872 Test Loss: 0.678 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9203813076019287
Epoch: 35, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.727 Vali Acc: 0.878 Test Loss: 0.727 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9021122455596924
Epoch: 36, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.732 Vali Acc: 0.878 Test Loss: 0.732 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9196727275848389
Epoch: 37, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.681 Vali Acc: 0.889 Test Loss: 0.681 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8884785175323486
Epoch: 38, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.682 Vali Acc: 0.883 Test Loss: 0.682 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.9588320255279541
Epoch: 39, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.697 Vali Acc: 0.889 Test Loss: 0.697 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 253935
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.253652334213257
Epoch: 1, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.741 Vali Acc: 0.133 Test Loss: 2.741 Test Acc: 0.133
Validation loss decreased (inf --> -0.133306).  Saving model ...
Epoch: 2 cost time: 0.9377169609069824
Epoch: 2, Steps: 12 | Train Loss: 2.674 Vali Loss: 2.684 Vali Acc: 0.172 Test Loss: 2.684 Test Acc: 0.172
Validation loss decreased (-0.133306 --> -0.172195).  Saving model ...
Epoch: 3 cost time: 0.8905332088470459
Epoch: 3, Steps: 12 | Train Loss: 2.524 Vali Loss: 2.567 Vali Acc: 0.228 Test Loss: 2.567 Test Acc: 0.228
Validation loss decreased (-0.172195 --> -0.227752).  Saving model ...
Epoch: 4 cost time: 0.911658763885498
Epoch: 4, Steps: 12 | Train Loss: 2.406 Vali Loss: 2.399 Vali Acc: 0.367 Test Loss: 2.399 Test Acc: 0.367
Validation loss decreased (-0.227752 --> -0.366643).  Saving model ...
Epoch: 5 cost time: 0.9384841918945312
Epoch: 5, Steps: 12 | Train Loss: 2.191 Vali Loss: 2.175 Vali Acc: 0.506 Test Loss: 2.175 Test Acc: 0.506
Validation loss decreased (-0.366643 --> -0.505534).  Saving model ...
Epoch: 6 cost time: 0.9171197414398193
Epoch: 6, Steps: 12 | Train Loss: 1.960 Vali Loss: 1.931 Vali Acc: 0.561 Test Loss: 1.931 Test Acc: 0.561
Validation loss decreased (-0.505534 --> -0.561092).  Saving model ...
Epoch: 7 cost time: 0.9416446685791016
Epoch: 7, Steps: 12 | Train Loss: 1.691 Vali Loss: 1.657 Vali Acc: 0.639 Test Loss: 1.657 Test Acc: 0.639
Validation loss decreased (-0.561092 --> -0.638872).  Saving model ...
Epoch: 8 cost time: 0.9486792087554932
Epoch: 8, Steps: 12 | Train Loss: 1.382 Vali Loss: 1.454 Vali Acc: 0.661 Test Loss: 1.454 Test Acc: 0.661
Validation loss decreased (-0.638872 --> -0.661097).  Saving model ...
Epoch: 9 cost time: 0.9167890548706055
Epoch: 9, Steps: 12 | Train Loss: 1.177 Vali Loss: 1.281 Vali Acc: 0.672 Test Loss: 1.281 Test Acc: 0.672
Validation loss decreased (-0.661097 --> -0.672209).  Saving model ...
Epoch: 10 cost time: 0.9058923721313477
Epoch: 10, Steps: 12 | Train Loss: 0.969 Vali Loss: 1.133 Vali Acc: 0.694 Test Loss: 1.133 Test Acc: 0.694
Validation loss decreased (-0.672209 --> -0.694433).  Saving model ...
Epoch: 11 cost time: 0.9069385528564453
Epoch: 11, Steps: 12 | Train Loss: 0.846 Vali Loss: 1.056 Vali Acc: 0.722 Test Loss: 1.056 Test Acc: 0.722
Validation loss decreased (-0.694433 --> -0.722212).  Saving model ...
Epoch: 12 cost time: 0.9475369453430176
Epoch: 12, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.928 Vali Acc: 0.722 Test Loss: 0.928 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722213).  Saving model ...
Epoch: 13 cost time: 0.9555015563964844
Epoch: 13, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.862 Vali Acc: 0.750 Test Loss: 0.862 Test Acc: 0.750
Validation loss decreased (-0.722213 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.9421932697296143
Epoch: 14, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.799 Vali Acc: 0.761 Test Loss: 0.799 Test Acc: 0.761
Validation loss decreased (-0.749991 --> -0.761103).  Saving model ...
Epoch: 15 cost time: 0.8959331512451172
Epoch: 15, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.758 Vali Acc: 0.783 Test Loss: 0.758 Test Acc: 0.783
Validation loss decreased (-0.761103 --> -0.783326).  Saving model ...
Epoch: 16 cost time: 0.9241290092468262
Epoch: 16, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.691 Vali Acc: 0.800 Test Loss: 0.691 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799993).  Saving model ...
Epoch: 17 cost time: 0.8940980434417725
Epoch: 17, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.671 Vali Acc: 0.811 Test Loss: 0.671 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 18 cost time: 0.8547041416168213
Epoch: 18, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.605 Vali Acc: 0.833 Test Loss: 0.605 Test Acc: 0.833
Validation loss decreased (-0.811104 --> -0.833327).  Saving model ...
Epoch: 19 cost time: 0.87270188331604
Epoch: 19, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.592 Vali Acc: 0.822 Test Loss: 0.592 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8873050212860107
Epoch: 20, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.578 Vali Acc: 0.850 Test Loss: 0.578 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 21 cost time: 0.9353816509246826
Epoch: 21, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.558 Vali Acc: 0.850 Test Loss: 0.558 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 22 cost time: 0.9052696228027344
Epoch: 22, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.557 Vali Acc: 0.844 Test Loss: 0.557 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9643435478210449
Epoch: 23, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.550 Vali Acc: 0.856 Test Loss: 0.550 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 24 cost time: 0.9261021614074707
Epoch: 24, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.536 Vali Acc: 0.867 Test Loss: 0.536 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 25 cost time: 0.9647672176361084
Epoch: 25, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.509 Vali Acc: 0.856 Test Loss: 0.509 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.91066575050354
Epoch: 26, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.515 Vali Acc: 0.856 Test Loss: 0.515 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9352943897247314
Epoch: 27, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.549 Vali Acc: 0.867 Test Loss: 0.549 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8704829216003418
Epoch: 28, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.551 Vali Acc: 0.856 Test Loss: 0.551 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8482503890991211
Epoch: 29, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.548 Vali Acc: 0.861 Test Loss: 0.548 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8514974117279053
Epoch: 30, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.538 Vali Acc: 0.861 Test Loss: 0.538 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9043691158294678
Epoch: 31, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9175760746002197
Epoch: 32, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.538 Vali Acc: 0.883 Test Loss: 0.538 Test Acc: 0.883
Validation loss decreased (-0.866661 --> -0.883328).  Saving model ...
Epoch: 33 cost time: 0.8984026908874512
Epoch: 33, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.537 Vali Acc: 0.867 Test Loss: 0.537 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9004762172698975
Epoch: 34, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.539 Vali Acc: 0.867 Test Loss: 0.539 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8844857215881348
Epoch: 35, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.562 Vali Acc: 0.883 Test Loss: 0.562 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9755303859710693
Epoch: 36, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.589 Vali Acc: 0.867 Test Loss: 0.589 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.943314790725708
Epoch: 37, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.563 Vali Acc: 0.878 Test Loss: 0.563 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9128601551055908
Epoch: 38, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.574 Vali Acc: 0.883 Test Loss: 0.574 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9246242046356201
Epoch: 39, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.568 Vali Acc: 0.883 Test Loss: 0.568 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9671223163604736
Epoch: 40, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.587 Vali Acc: 0.894 Test Loss: 0.587 Test Acc: 0.894
Validation loss decreased (-0.883328 --> -0.894439).  Saving model ...
Epoch: 41 cost time: 0.915398120880127
Epoch: 41, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.602 Vali Acc: 0.878 Test Loss: 0.602 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9028518199920654
Epoch: 42, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.593 Vali Acc: 0.878 Test Loss: 0.593 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9363908767700195
Epoch: 43, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.593 Vali Acc: 0.867 Test Loss: 0.593 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9642190933227539
Epoch: 44, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.624 Vali Acc: 0.883 Test Loss: 0.624 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9234869480133057
Epoch: 45, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.612 Vali Acc: 0.889 Test Loss: 0.612 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9454052448272705
Epoch: 46, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.598 Vali Acc: 0.878 Test Loss: 0.598 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.9537022113800049
Epoch: 47, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.629 Vali Acc: 0.878 Test Loss: 0.629 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.8890783786773682
Epoch: 48, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.644 Vali Acc: 0.883 Test Loss: 0.644 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.9939606189727783
Epoch: 49, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.651 Vali Acc: 0.878 Test Loss: 0.651 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.0095345973968506
Epoch: 50, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.654 Vali Acc: 0.878 Test Loss: 0.654 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 230927
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.430781364440918
Epoch: 1, Steps: 12 | Train Loss: 2.739 Vali Loss: 2.707 Vali Acc: 0.111 Test Loss: 2.707 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 0.9266164302825928
Epoch: 2, Steps: 12 | Train Loss: 2.662 Vali Loss: 2.641 Vali Acc: 0.194 Test Loss: 2.641 Test Acc: 0.194
Validation loss decreased (-0.111084 --> -0.194418).  Saving model ...
Epoch: 3 cost time: 0.8821322917938232
Epoch: 3, Steps: 12 | Train Loss: 2.516 Vali Loss: 2.511 Vali Acc: 0.361 Test Loss: 2.511 Test Acc: 0.361
Validation loss decreased (-0.194418 --> -0.361086).  Saving model ...
Epoch: 4 cost time: 0.9458088874816895
Epoch: 4, Steps: 12 | Train Loss: 2.366 Vali Loss: 2.350 Vali Acc: 0.450 Test Loss: 2.350 Test Acc: 0.450
Validation loss decreased (-0.361086 --> -0.449976).  Saving model ...
Epoch: 5 cost time: 0.886768102645874
Epoch: 5, Steps: 12 | Train Loss: 2.207 Vali Loss: 2.153 Vali Acc: 0.533 Test Loss: 2.153 Test Acc: 0.533
Validation loss decreased (-0.449976 --> -0.533312).  Saving model ...
Epoch: 6 cost time: 0.8364770412445068
Epoch: 6, Steps: 12 | Train Loss: 1.927 Vali Loss: 1.918 Vali Acc: 0.578 Test Loss: 1.918 Test Acc: 0.578
Validation loss decreased (-0.533312 --> -0.577759).  Saving model ...
Epoch: 7 cost time: 1.0465540885925293
Epoch: 7, Steps: 12 | Train Loss: 1.713 Vali Loss: 1.726 Vali Acc: 0.611 Test Loss: 1.726 Test Acc: 0.611
Validation loss decreased (-0.577759 --> -0.611094).  Saving model ...
Epoch: 8 cost time: 0.9430952072143555
Epoch: 8, Steps: 12 | Train Loss: 1.423 Vali Loss: 1.502 Vali Acc: 0.622 Test Loss: 1.502 Test Acc: 0.622
Validation loss decreased (-0.611094 --> -0.622207).  Saving model ...
Epoch: 9 cost time: 0.924954891204834
Epoch: 9, Steps: 12 | Train Loss: 1.215 Vali Loss: 1.328 Vali Acc: 0.650 Test Loss: 1.328 Test Acc: 0.650
Validation loss decreased (-0.622207 --> -0.649987).  Saving model ...
Epoch: 10 cost time: 0.9422140121459961
Epoch: 10, Steps: 12 | Train Loss: 1.020 Vali Loss: 1.205 Vali Acc: 0.667 Test Loss: 1.205 Test Acc: 0.667
Validation loss decreased (-0.649987 --> -0.666655).  Saving model ...
Epoch: 11 cost time: 0.9337506294250488
Epoch: 11, Steps: 12 | Train Loss: 0.860 Vali Loss: 1.104 Vali Acc: 0.678 Test Loss: 1.104 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677767).  Saving model ...
Epoch: 12 cost time: 0.8617041110992432
Epoch: 12, Steps: 12 | Train Loss: 0.755 Vali Loss: 0.988 Vali Acc: 0.717 Test Loss: 0.988 Test Acc: 0.717
Validation loss decreased (-0.677767 --> -0.716657).  Saving model ...
Epoch: 13 cost time: 0.9140808582305908
Epoch: 13, Steps: 12 | Train Loss: 0.707 Vali Loss: 0.917 Vali Acc: 0.744 Test Loss: 0.917 Test Acc: 0.744
Validation loss decreased (-0.716657 --> -0.744435).  Saving model ...
Epoch: 14 cost time: 0.92852783203125
Epoch: 14, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.821 Vali Acc: 0.739 Test Loss: 0.821 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8952131271362305
Epoch: 15, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.774 Vali Acc: 0.783 Test Loss: 0.774 Test Acc: 0.783
Validation loss decreased (-0.744435 --> -0.783326).  Saving model ...
Epoch: 16 cost time: 0.927034854888916
Epoch: 16, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.723 Vali Acc: 0.794 Test Loss: 0.723 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794437).  Saving model ...
Epoch: 17 cost time: 0.9864006042480469
Epoch: 17, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.682 Vali Acc: 0.806 Test Loss: 0.682 Test Acc: 0.806
Validation loss decreased (-0.794437 --> -0.805549).  Saving model ...
Epoch: 18 cost time: 0.9204580783843994
Epoch: 18, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.649 Vali Acc: 0.811 Test Loss: 0.649 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 19 cost time: 0.9069902896881104
Epoch: 19, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.625 Vali Acc: 0.833 Test Loss: 0.625 Test Acc: 0.833
Validation loss decreased (-0.811105 --> -0.833327).  Saving model ...
Epoch: 20 cost time: 0.9575965404510498
Epoch: 20, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.620 Vali Acc: 0.844 Test Loss: 0.620 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 21 cost time: 0.9535248279571533
Epoch: 21, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.559 Vali Acc: 0.844 Test Loss: 0.559 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844439).  Saving model ...
Epoch: 22 cost time: 0.9253652095794678
Epoch: 22, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.550 Vali Acc: 0.844 Test Loss: 0.550 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 23 cost time: 0.9464502334594727
Epoch: 23, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.561 Vali Acc: 0.878 Test Loss: 0.561 Test Acc: 0.878
Validation loss decreased (-0.844439 --> -0.877772).  Saving model ...
Epoch: 24 cost time: 0.8572611808776855
Epoch: 24, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9106824398040771
Epoch: 25, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.554 Vali Acc: 0.867 Test Loss: 0.554 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.846365213394165
Epoch: 26, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.551 Vali Acc: 0.867 Test Loss: 0.551 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8596835136413574
Epoch: 27, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9010887145996094
Epoch: 28, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.553 Vali Acc: 0.872 Test Loss: 0.553 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9026286602020264
Epoch: 29, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.528 Vali Acc: 0.872 Test Loss: 0.528 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9188766479492188
Epoch: 30, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.532 Vali Acc: 0.867 Test Loss: 0.532 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.917464017868042
Epoch: 31, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.564 Vali Acc: 0.872 Test Loss: 0.564 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9423611164093018
Epoch: 32, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.605 Vali Acc: 0.867 Test Loss: 0.605 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.917273998260498
Epoch: 33, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.572 Vali Acc: 0.861 Test Loss: 0.572 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 230959
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1281113624572754
Epoch: 1, Steps: 12 | Train Loss: 2.733 Vali Loss: 2.685 Vali Acc: 0.050 Test Loss: 2.685 Test Acc: 0.050
Validation loss decreased (inf --> -0.049973).  Saving model ...
Epoch: 2 cost time: 0.9672203063964844
Epoch: 2, Steps: 12 | Train Loss: 2.670 Vali Loss: 2.618 Vali Acc: 0.178 Test Loss: 2.618 Test Acc: 0.178
Validation loss decreased (-0.049973 --> -0.177752).  Saving model ...
Epoch: 3 cost time: 1.025327444076538
Epoch: 3, Steps: 12 | Train Loss: 2.551 Vali Loss: 2.514 Vali Acc: 0.294 Test Loss: 2.514 Test Acc: 0.294
Validation loss decreased (-0.177752 --> -0.294419).  Saving model ...
Epoch: 4 cost time: 0.9513945579528809
Epoch: 4, Steps: 12 | Train Loss: 2.409 Vali Loss: 2.385 Vali Acc: 0.444 Test Loss: 2.385 Test Acc: 0.444
Validation loss decreased (-0.294419 --> -0.444421).  Saving model ...
Epoch: 5 cost time: 0.9042196273803711
Epoch: 5, Steps: 12 | Train Loss: 2.273 Vali Loss: 2.229 Vali Acc: 0.533 Test Loss: 2.229 Test Acc: 0.533
Validation loss decreased (-0.444421 --> -0.533311).  Saving model ...
Epoch: 6 cost time: 0.9737894535064697
Epoch: 6, Steps: 12 | Train Loss: 2.052 Vali Loss: 2.035 Vali Acc: 0.567 Test Loss: 2.035 Test Acc: 0.567
Validation loss decreased (-0.533311 --> -0.566646).  Saving model ...
Epoch: 7 cost time: 0.9460222721099854
Epoch: 7, Steps: 12 | Train Loss: 1.858 Vali Loss: 1.848 Vali Acc: 0.589 Test Loss: 1.848 Test Acc: 0.589
Validation loss decreased (-0.566646 --> -0.588870).  Saving model ...
Epoch: 8 cost time: 0.9159319400787354
Epoch: 8, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.647 Vali Acc: 0.611 Test Loss: 1.647 Test Acc: 0.611
Validation loss decreased (-0.588870 --> -0.611095).  Saving model ...
Epoch: 9 cost time: 0.8880348205566406
Epoch: 9, Steps: 12 | Train Loss: 1.383 Vali Loss: 1.458 Vali Acc: 0.639 Test Loss: 1.458 Test Acc: 0.639
Validation loss decreased (-0.611095 --> -0.638874).  Saving model ...
Epoch: 10 cost time: 0.8837323188781738
Epoch: 10, Steps: 12 | Train Loss: 1.219 Vali Loss: 1.286 Vali Acc: 0.667 Test Loss: 1.286 Test Acc: 0.667
Validation loss decreased (-0.638874 --> -0.666654).  Saving model ...
Epoch: 11 cost time: 0.9217257499694824
Epoch: 11, Steps: 12 | Train Loss: 1.021 Vali Loss: 1.167 Vali Acc: 0.694 Test Loss: 1.167 Test Acc: 0.694
Validation loss decreased (-0.666654 --> -0.694433).  Saving model ...
Epoch: 12 cost time: 0.9710960388183594
Epoch: 12, Steps: 12 | Train Loss: 0.892 Vali Loss: 1.052 Vali Acc: 0.700 Test Loss: 1.052 Test Acc: 0.700
Validation loss decreased (-0.694433 --> -0.699989).  Saving model ...
Epoch: 13 cost time: 0.9217550754547119
Epoch: 13, Steps: 12 | Train Loss: 0.782 Vali Loss: 0.967 Vali Acc: 0.711 Test Loss: 0.967 Test Acc: 0.711
Validation loss decreased (-0.699989 --> -0.711101).  Saving model ...
Epoch: 14 cost time: 0.9787242412567139
Epoch: 14, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.897 Vali Acc: 0.761 Test Loss: 0.897 Test Acc: 0.761
Validation loss decreased (-0.711101 --> -0.761102).  Saving model ...
Epoch: 15 cost time: 0.8979930877685547
Epoch: 15, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.827 Vali Acc: 0.756 Test Loss: 0.827 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0433297157287598
Epoch: 16, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.777 Vali Acc: 0.772 Test Loss: 0.777 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772214).  Saving model ...
Epoch: 17 cost time: 0.9473302364349365
Epoch: 17, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.729 Vali Acc: 0.794 Test Loss: 0.729 Test Acc: 0.794
Validation loss decreased (-0.772214 --> -0.794437).  Saving model ...
Epoch: 18 cost time: 0.9572739601135254
Epoch: 18, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.677 Vali Acc: 0.800 Test Loss: 0.677 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 0.9085078239440918
Epoch: 19, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.642 Vali Acc: 0.800 Test Loss: 0.642 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 20 cost time: 0.9292232990264893
Epoch: 20, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.619 Vali Acc: 0.839 Test Loss: 0.619 Test Acc: 0.839
Validation loss decreased (-0.799994 --> -0.838883).  Saving model ...
Epoch: 21 cost time: 0.911557674407959
Epoch: 21, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.583 Vali Acc: 0.850 Test Loss: 0.583 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 22 cost time: 0.9176406860351562
Epoch: 22, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 23 cost time: 0.9177346229553223
Epoch: 23, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9248600006103516
Epoch: 24, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.546 Vali Acc: 0.867 Test Loss: 0.546 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 25 cost time: 0.9399752616882324
Epoch: 25, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.544 Vali Acc: 0.878 Test Loss: 0.544 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 26 cost time: 0.9267091751098633
Epoch: 26, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.524 Vali Acc: 0.856 Test Loss: 0.524 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9114859104156494
Epoch: 27, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.511 Vali Acc: 0.878 Test Loss: 0.511 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877773).  Saving model ...
Epoch: 28 cost time: 0.9727435111999512
Epoch: 28, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.503 Vali Acc: 0.872 Test Loss: 0.503 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9256668090820312
Epoch: 29, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.510 Vali Acc: 0.872 Test Loss: 0.510 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9908380508422852
Epoch: 30, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.493 Vali Acc: 0.883 Test Loss: 0.493 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 31 cost time: 1.0298731327056885
Epoch: 31, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.497 Vali Acc: 0.883 Test Loss: 0.497 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9734587669372559
Epoch: 32, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.514 Vali Acc: 0.878 Test Loss: 0.514 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9564337730407715
Epoch: 33, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.493 Vali Acc: 0.889 Test Loss: 0.493 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888884).  Saving model ...
Epoch: 34 cost time: 0.9256126880645752
Epoch: 34, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.521 Vali Acc: 0.872 Test Loss: 0.521 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.915930986404419
Epoch: 35, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.502 Vali Acc: 0.872 Test Loss: 0.502 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8709878921508789
Epoch: 36, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.508 Vali Acc: 0.889 Test Loss: 0.508 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9211807250976562
Epoch: 37, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.561 Vali Acc: 0.867 Test Loss: 0.561 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9337494373321533
Epoch: 38, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.538 Vali Acc: 0.878 Test Loss: 0.538 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9723119735717773
Epoch: 39, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.532 Vali Acc: 0.867 Test Loss: 0.532 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.8660058975219727
Epoch: 40, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.530 Vali Acc: 0.883 Test Loss: 0.530 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.9536612033843994
Epoch: 41, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.549 Vali Acc: 0.878 Test Loss: 0.549 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.9570732116699219
Epoch: 42, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.547 Vali Acc: 0.878 Test Loss: 0.547 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.9491312503814697
Epoch: 43, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.536 Vali Acc: 0.889 Test Loss: 0.536 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 223311
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.189866781234741
Epoch: 1, Steps: 12 | Train Loss: 2.768 Vali Loss: 2.713 Vali Acc: 0.033 Test Loss: 2.713 Test Acc: 0.033
Validation loss decreased (inf --> -0.033306).  Saving model ...
Epoch: 2 cost time: 0.9907684326171875
Epoch: 2, Steps: 12 | Train Loss: 2.737 Vali Loss: 2.671 Vali Acc: 0.106 Test Loss: 2.671 Test Acc: 0.106
Validation loss decreased (-0.033306 --> -0.105529).  Saving model ...
Epoch: 3 cost time: 0.8958849906921387
Epoch: 3, Steps: 12 | Train Loss: 2.625 Vali Loss: 2.586 Vali Acc: 0.206 Test Loss: 2.586 Test Acc: 0.206
Validation loss decreased (-0.105529 --> -0.205530).  Saving model ...
Epoch: 4 cost time: 0.9239084720611572
Epoch: 4, Steps: 12 | Train Loss: 2.517 Vali Loss: 2.467 Vali Acc: 0.361 Test Loss: 2.467 Test Acc: 0.361
Validation loss decreased (-0.205530 --> -0.361086).  Saving model ...
Epoch: 5 cost time: 0.877469539642334
Epoch: 5, Steps: 12 | Train Loss: 2.382 Vali Loss: 2.325 Vali Acc: 0.511 Test Loss: 2.325 Test Acc: 0.511
Validation loss decreased (-0.361086 --> -0.511088).  Saving model ...
Epoch: 6 cost time: 0.9759714603424072
Epoch: 6, Steps: 12 | Train Loss: 2.213 Vali Loss: 2.170 Vali Acc: 0.528 Test Loss: 2.170 Test Acc: 0.528
Validation loss decreased (-0.511088 --> -0.527756).  Saving model ...
Epoch: 7 cost time: 0.9234905242919922
Epoch: 7, Steps: 12 | Train Loss: 2.071 Vali Loss: 1.989 Vali Acc: 0.589 Test Loss: 1.989 Test Acc: 0.589
Validation loss decreased (-0.527756 --> -0.588869).  Saving model ...
Epoch: 8 cost time: 0.916762113571167
Epoch: 8, Steps: 12 | Train Loss: 1.869 Vali Loss: 1.817 Vali Acc: 0.594 Test Loss: 1.817 Test Acc: 0.594
Validation loss decreased (-0.588869 --> -0.594426).  Saving model ...
Epoch: 9 cost time: 0.9032962322235107
Epoch: 9, Steps: 12 | Train Loss: 1.660 Vali Loss: 1.631 Vali Acc: 0.600 Test Loss: 1.631 Test Acc: 0.600
Validation loss decreased (-0.594426 --> -0.599984).  Saving model ...
Epoch: 10 cost time: 0.9346325397491455
Epoch: 10, Steps: 12 | Train Loss: 1.436 Vali Loss: 1.481 Vali Acc: 0.633 Test Loss: 1.481 Test Acc: 0.633
Validation loss decreased (-0.599984 --> -0.633319).  Saving model ...
Epoch: 11 cost time: 0.9969582557678223
Epoch: 11, Steps: 12 | Train Loss: 1.287 Vali Loss: 1.326 Vali Acc: 0.650 Test Loss: 1.326 Test Acc: 0.650
Validation loss decreased (-0.633319 --> -0.649987).  Saving model ...
Epoch: 12 cost time: 0.8906033039093018
Epoch: 12, Steps: 12 | Train Loss: 1.101 Vali Loss: 1.218 Vali Acc: 0.650 Test Loss: 1.218 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649988).  Saving model ...
Epoch: 13 cost time: 0.9156835079193115
Epoch: 13, Steps: 12 | Train Loss: 0.993 Vali Loss: 1.110 Vali Acc: 0.667 Test Loss: 1.110 Test Acc: 0.667
Validation loss decreased (-0.649988 --> -0.666656).  Saving model ...
Epoch: 14 cost time: 0.871767520904541
Epoch: 14, Steps: 12 | Train Loss: 0.828 Vali Loss: 1.018 Vali Acc: 0.700 Test Loss: 1.018 Test Acc: 0.700
Validation loss decreased (-0.666656 --> -0.699990).  Saving model ...
Epoch: 15 cost time: 0.9289035797119141
Epoch: 15, Steps: 12 | Train Loss: 0.744 Vali Loss: 0.955 Vali Acc: 0.706 Test Loss: 0.955 Test Acc: 0.706
Validation loss decreased (-0.699990 --> -0.705546).  Saving model ...
Epoch: 16 cost time: 0.8857932090759277
Epoch: 16, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.883 Vali Acc: 0.706 Test Loss: 0.883 Test Acc: 0.706
Validation loss decreased (-0.705546 --> -0.705547).  Saving model ...
Epoch: 17 cost time: 0.943427562713623
Epoch: 17, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.824 Vali Acc: 0.750 Test Loss: 0.824 Test Acc: 0.750
Validation loss decreased (-0.705547 --> -0.749992).  Saving model ...
Epoch: 18 cost time: 0.9509758949279785
Epoch: 18, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.777 Vali Acc: 0.772 Test Loss: 0.777 Test Acc: 0.772
Validation loss decreased (-0.749992 --> -0.772214).  Saving model ...
Epoch: 19 cost time: 0.9164266586303711
Epoch: 19, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.742 Vali Acc: 0.772 Test Loss: 0.742 Test Acc: 0.772
Validation loss decreased (-0.772214 --> -0.772215).  Saving model ...
Epoch: 20 cost time: 0.9581215381622314
Epoch: 20, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.695 Vali Acc: 0.794 Test Loss: 0.695 Test Acc: 0.794
Validation loss decreased (-0.772215 --> -0.794437).  Saving model ...
Epoch: 21 cost time: 0.8771927356719971
Epoch: 21, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.647 Vali Acc: 0.833 Test Loss: 0.647 Test Acc: 0.833
Validation loss decreased (-0.794437 --> -0.833327).  Saving model ...
Epoch: 22 cost time: 0.952033519744873
Epoch: 22, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.613 Vali Acc: 0.822 Test Loss: 0.613 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8500545024871826
Epoch: 23, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.609 Vali Acc: 0.828 Test Loss: 0.609 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8933663368225098
Epoch: 24, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.577 Vali Acc: 0.839 Test Loss: 0.577 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 25 cost time: 0.8921124935150146
Epoch: 25, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 26 cost time: 0.9341480731964111
Epoch: 26, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.549 Vali Acc: 0.833 Test Loss: 0.549 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9185690879821777
Epoch: 27, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 28 cost time: 0.9600720405578613
Epoch: 28, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 29 cost time: 0.9145190715789795
Epoch: 29, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.516 Vali Acc: 0.856 Test Loss: 0.516 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 30 cost time: 0.9056792259216309
Epoch: 30, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.490 Vali Acc: 0.856 Test Loss: 0.490 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855551).  Saving model ...
Epoch: 31 cost time: 0.93951416015625
Epoch: 31, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.497 Vali Acc: 0.872 Test Loss: 0.497 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872217).  Saving model ...
Epoch: 32 cost time: 1.0191049575805664
Epoch: 32, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.509 Vali Acc: 0.861 Test Loss: 0.509 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9299967288970947
Epoch: 33, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.498 Vali Acc: 0.844 Test Loss: 0.498 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9690899848937988
Epoch: 34, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.493 Vali Acc: 0.850 Test Loss: 0.493 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.957721471786499
Epoch: 35, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8916268348693848
Epoch: 36, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.521 Vali Acc: 0.867 Test Loss: 0.521 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8994147777557373
Epoch: 37, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.514 Vali Acc: 0.867 Test Loss: 0.514 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9292545318603516
Epoch: 38, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.512 Vali Acc: 0.878 Test Loss: 0.512 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 39 cost time: 0.9152176380157471
Epoch: 39, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.517 Vali Acc: 0.883 Test Loss: 0.517 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 40 cost time: 0.8886778354644775
Epoch: 40, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.503 Vali Acc: 0.883 Test Loss: 0.503 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 41 cost time: 0.9577021598815918
Epoch: 41, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.519 Vali Acc: 0.878 Test Loss: 0.519 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8794040679931641
Epoch: 42, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.524 Vali Acc: 0.872 Test Loss: 0.524 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9175162315368652
Epoch: 43, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.511 Vali Acc: 0.872 Test Loss: 0.511 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9597892761230469
Epoch: 44, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.519 Vali Acc: 0.867 Test Loss: 0.519 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.939075231552124
Epoch: 45, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.513 Vali Acc: 0.872 Test Loss: 0.513 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9986679553985596
Epoch: 46, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.517 Vali Acc: 0.878 Test Loss: 0.517 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.914412260055542
Epoch: 47, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.545 Vali Acc: 0.883 Test Loss: 0.545 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.0727202892303467
Epoch: 48, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.544 Vali Acc: 0.867 Test Loss: 0.544 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.9689278602600098
Epoch: 49, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.519 Vali Acc: 0.878 Test Loss: 0.519 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.9038503170013428
Epoch: 50, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.555 Vali Acc: 0.878 Test Loss: 0.555 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 219535
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2037594318389893
Epoch: 1, Steps: 12 | Train Loss: 2.755 Vali Loss: 2.705 Vali Acc: 0.061 Test Loss: 2.705 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 0.9022061824798584
Epoch: 2, Steps: 12 | Train Loss: 2.677 Vali Loss: 2.654 Vali Acc: 0.150 Test Loss: 2.654 Test Acc: 0.150
Validation loss decreased (-0.061084 --> -0.149973).  Saving model ...
Epoch: 3 cost time: 0.8964049816131592
Epoch: 3, Steps: 12 | Train Loss: 2.571 Vali Loss: 2.548 Vali Acc: 0.311 Test Loss: 2.548 Test Acc: 0.311
Validation loss decreased (-0.149973 --> -0.311086).  Saving model ...
Epoch: 4 cost time: 0.974489688873291
Epoch: 4, Steps: 12 | Train Loss: 2.459 Vali Loss: 2.414 Vali Acc: 0.394 Test Loss: 2.414 Test Acc: 0.394
Validation loss decreased (-0.311086 --> -0.394420).  Saving model ...
Epoch: 5 cost time: 0.9310035705566406
Epoch: 5, Steps: 12 | Train Loss: 2.288 Vali Loss: 2.265 Vali Acc: 0.450 Test Loss: 2.265 Test Acc: 0.450
Validation loss decreased (-0.394420 --> -0.449977).  Saving model ...
Epoch: 6 cost time: 0.9340934753417969
Epoch: 6, Steps: 12 | Train Loss: 2.108 Vali Loss: 2.100 Vali Acc: 0.472 Test Loss: 2.100 Test Acc: 0.472
Validation loss decreased (-0.449977 --> -0.472201).  Saving model ...
Epoch: 7 cost time: 0.9013347625732422
Epoch: 7, Steps: 12 | Train Loss: 1.892 Vali Loss: 1.940 Vali Acc: 0.539 Test Loss: 1.940 Test Acc: 0.539
Validation loss decreased (-0.472201 --> -0.538869).  Saving model ...
Epoch: 8 cost time: 0.8774962425231934
Epoch: 8, Steps: 12 | Train Loss: 1.693 Vali Loss: 1.759 Vali Acc: 0.550 Test Loss: 1.759 Test Acc: 0.550
Validation loss decreased (-0.538869 --> -0.549982).  Saving model ...
Epoch: 9 cost time: 0.9166305065155029
Epoch: 9, Steps: 12 | Train Loss: 1.594 Vali Loss: 1.582 Vali Acc: 0.589 Test Loss: 1.582 Test Acc: 0.589
Validation loss decreased (-0.549982 --> -0.588873).  Saving model ...
Epoch: 10 cost time: 0.9055860042572021
Epoch: 10, Steps: 12 | Train Loss: 1.327 Vali Loss: 1.441 Vali Acc: 0.639 Test Loss: 1.441 Test Acc: 0.639
Validation loss decreased (-0.588873 --> -0.638874).  Saving model ...
Epoch: 11 cost time: 0.8802955150604248
Epoch: 11, Steps: 12 | Train Loss: 1.149 Vali Loss: 1.306 Vali Acc: 0.678 Test Loss: 1.306 Test Acc: 0.678
Validation loss decreased (-0.638874 --> -0.677765).  Saving model ...
Epoch: 12 cost time: 0.896282434463501
Epoch: 12, Steps: 12 | Train Loss: 1.035 Vali Loss: 1.171 Vali Acc: 0.700 Test Loss: 1.171 Test Acc: 0.700
Validation loss decreased (-0.677765 --> -0.699988).  Saving model ...
Epoch: 13 cost time: 0.8893766403198242
Epoch: 13, Steps: 12 | Train Loss: 0.909 Vali Loss: 1.059 Vali Acc: 0.700 Test Loss: 1.059 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699989).  Saving model ...
Epoch: 14 cost time: 0.9468903541564941
Epoch: 14, Steps: 12 | Train Loss: 0.812 Vali Loss: 0.977 Vali Acc: 0.711 Test Loss: 0.977 Test Acc: 0.711
Validation loss decreased (-0.699989 --> -0.711101).  Saving model ...
Epoch: 15 cost time: 0.946605920791626
Epoch: 15, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.932 Vali Acc: 0.739 Test Loss: 0.932 Test Acc: 0.739
Validation loss decreased (-0.711101 --> -0.738880).  Saving model ...
Epoch: 16 cost time: 0.9305617809295654
Epoch: 16, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.870 Vali Acc: 0.756 Test Loss: 0.870 Test Acc: 0.756
Validation loss decreased (-0.738880 --> -0.755547).  Saving model ...
Epoch: 17 cost time: 0.9180231094360352
Epoch: 17, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.837 Vali Acc: 0.756 Test Loss: 0.837 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755547).  Saving model ...
Epoch: 18 cost time: 0.9242968559265137
Epoch: 18, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.770 Vali Acc: 0.772 Test Loss: 0.770 Test Acc: 0.772
Validation loss decreased (-0.755547 --> -0.772215).  Saving model ...
Epoch: 19 cost time: 0.8865759372711182
Epoch: 19, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.720 Vali Acc: 0.794 Test Loss: 0.720 Test Acc: 0.794
Validation loss decreased (-0.772215 --> -0.794437).  Saving model ...
Epoch: 20 cost time: 0.9111905097961426
Epoch: 20, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.694 Vali Acc: 0.800 Test Loss: 0.694 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 21 cost time: 0.9195804595947266
Epoch: 21, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.662 Vali Acc: 0.811 Test Loss: 0.662 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 22 cost time: 0.9385256767272949
Epoch: 22, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.623 Vali Acc: 0.828 Test Loss: 0.623 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827772).  Saving model ...
Epoch: 23 cost time: 0.8924944400787354
Epoch: 23, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.602 Vali Acc: 0.844 Test Loss: 0.602 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844438).  Saving model ...
Epoch: 24 cost time: 0.9430327415466309
Epoch: 24, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.595 Vali Acc: 0.844 Test Loss: 0.595 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 25 cost time: 0.8846728801727295
Epoch: 25, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.567 Vali Acc: 0.839 Test Loss: 0.567 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9177181720733643
Epoch: 26, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844439).  Saving model ...
Epoch: 27 cost time: 0.9168028831481934
Epoch: 27, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.546 Vali Acc: 0.856 Test Loss: 0.546 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 28 cost time: 0.9924650192260742
Epoch: 28, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.544 Vali Acc: 0.861 Test Loss: 0.544 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 29 cost time: 1.014233112335205
Epoch: 29, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.549 Vali Acc: 0.872 Test Loss: 0.549 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 30 cost time: 0.9779725074768066
Epoch: 30, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.553 Vali Acc: 0.867 Test Loss: 0.553 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.963822603225708
Epoch: 31, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.554 Vali Acc: 0.867 Test Loss: 0.554 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9866974353790283
Epoch: 32, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.554 Vali Acc: 0.872 Test Loss: 0.554 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9685401916503906
Epoch: 33, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.545 Vali Acc: 0.861 Test Loss: 0.545 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9681406021118164
Epoch: 34, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.562 Vali Acc: 0.872 Test Loss: 0.562 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8904483318328857
Epoch: 35, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.561 Vali Acc: 0.872 Test Loss: 0.561 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9355478286743164
Epoch: 36, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.554 Vali Acc: 0.861 Test Loss: 0.554 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.968008279800415
Epoch: 37, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.548 Vali Acc: 0.856 Test Loss: 0.548 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0304648876190186
Epoch: 38, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.560 Vali Acc: 0.861 Test Loss: 0.560 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.8907232284545898
Epoch: 39, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.592 Vali Acc: 0.872 Test Loss: 0.592 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 219599
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2028822898864746
Epoch: 1, Steps: 12 | Train Loss: 2.726 Vali Loss: 2.701 Vali Acc: 0.050 Test Loss: 2.701 Test Acc: 0.050
Validation loss decreased (inf --> -0.049973).  Saving model ...
Epoch: 2 cost time: 0.9521603584289551
Epoch: 2, Steps: 12 | Train Loss: 2.683 Vali Loss: 2.668 Vali Acc: 0.056 Test Loss: 2.668 Test Acc: 0.056
Validation loss decreased (-0.049973 --> -0.055529).  Saving model ...
Epoch: 3 cost time: 0.9098575115203857
Epoch: 3, Steps: 12 | Train Loss: 2.599 Vali Loss: 2.596 Vali Acc: 0.144 Test Loss: 2.596 Test Acc: 0.144
Validation loss decreased (-0.055529 --> -0.144418).  Saving model ...
Epoch: 4 cost time: 0.9933209419250488
Epoch: 4, Steps: 12 | Train Loss: 2.472 Vali Loss: 2.491 Vali Acc: 0.278 Test Loss: 2.491 Test Acc: 0.278
Validation loss decreased (-0.144418 --> -0.277753).  Saving model ...
Epoch: 5 cost time: 0.9269225597381592
Epoch: 5, Steps: 12 | Train Loss: 2.364 Vali Loss: 2.370 Vali Acc: 0.422 Test Loss: 2.370 Test Acc: 0.422
Validation loss decreased (-0.277753 --> -0.422199).  Saving model ...
Epoch: 6 cost time: 0.9273331165313721
Epoch: 6, Steps: 12 | Train Loss: 2.256 Vali Loss: 2.234 Vali Acc: 0.489 Test Loss: 2.234 Test Acc: 0.489
Validation loss decreased (-0.422199 --> -0.488867).  Saving model ...
Epoch: 7 cost time: 0.9187049865722656
Epoch: 7, Steps: 12 | Train Loss: 2.075 Vali Loss: 2.087 Vali Acc: 0.517 Test Loss: 2.087 Test Acc: 0.517
Validation loss decreased (-0.488867 --> -0.516646).  Saving model ...
Epoch: 8 cost time: 0.869370698928833
Epoch: 8, Steps: 12 | Train Loss: 1.907 Vali Loss: 1.949 Vali Acc: 0.544 Test Loss: 1.949 Test Acc: 0.544
Validation loss decreased (-0.516646 --> -0.544425).  Saving model ...
Epoch: 9 cost time: 1.08186674118042
Epoch: 9, Steps: 12 | Train Loss: 1.781 Vali Loss: 1.777 Vali Acc: 0.561 Test Loss: 1.777 Test Acc: 0.561
Validation loss decreased (-0.544425 --> -0.561093).  Saving model ...
Epoch: 10 cost time: 0.9805929660797119
Epoch: 10, Steps: 12 | Train Loss: 1.529 Vali Loss: 1.619 Vali Acc: 0.622 Test Loss: 1.619 Test Acc: 0.622
Validation loss decreased (-0.561093 --> -0.622206).  Saving model ...
Epoch: 11 cost time: 0.9746255874633789
Epoch: 11, Steps: 12 | Train Loss: 1.391 Vali Loss: 1.462 Vali Acc: 0.656 Test Loss: 1.462 Test Acc: 0.656
Validation loss decreased (-0.622206 --> -0.655541).  Saving model ...
Epoch: 12 cost time: 0.9585182666778564
Epoch: 12, Steps: 12 | Train Loss: 1.220 Vali Loss: 1.305 Vali Acc: 0.672 Test Loss: 1.305 Test Acc: 0.672
Validation loss decreased (-0.655541 --> -0.672209).  Saving model ...
Epoch: 13 cost time: 0.9596261978149414
Epoch: 13, Steps: 12 | Train Loss: 1.055 Vali Loss: 1.181 Vali Acc: 0.717 Test Loss: 1.181 Test Acc: 0.717
Validation loss decreased (-0.672209 --> -0.716655).  Saving model ...
Epoch: 14 cost time: 1.0017731189727783
Epoch: 14, Steps: 12 | Train Loss: 0.927 Vali Loss: 1.095 Vali Acc: 0.739 Test Loss: 1.095 Test Acc: 0.739
Validation loss decreased (-0.716655 --> -0.738878).  Saving model ...
Epoch: 15 cost time: 0.9592115879058838
Epoch: 15, Steps: 12 | Train Loss: 0.865 Vali Loss: 1.004 Vali Acc: 0.772 Test Loss: 1.004 Test Acc: 0.772
Validation loss decreased (-0.738878 --> -0.772212).  Saving model ...
Epoch: 16 cost time: 0.967705488204956
Epoch: 16, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.919 Vali Acc: 0.783 Test Loss: 0.919 Test Acc: 0.783
Validation loss decreased (-0.772212 --> -0.783324).  Saving model ...
Epoch: 17 cost time: 0.9429416656494141
Epoch: 17, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.857 Vali Acc: 0.778 Test Loss: 0.857 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9143691062927246
Epoch: 18, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.814 Vali Acc: 0.794 Test Loss: 0.814 Test Acc: 0.794
Validation loss decreased (-0.783324 --> -0.794436).  Saving model ...
Epoch: 19 cost time: 0.9349315166473389
Epoch: 19, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.763 Vali Acc: 0.806 Test Loss: 0.763 Test Acc: 0.806
Validation loss decreased (-0.794436 --> -0.805548).  Saving model ...
Epoch: 20 cost time: 0.921281099319458
Epoch: 20, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.729 Vali Acc: 0.822 Test Loss: 0.729 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822215).  Saving model ...
Epoch: 21 cost time: 0.9852550029754639
Epoch: 21, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.680 Vali Acc: 0.822 Test Loss: 0.680 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 22 cost time: 0.9601678848266602
Epoch: 22, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.647 Vali Acc: 0.844 Test Loss: 0.647 Test Acc: 0.844
Validation loss decreased (-0.822215 --> -0.844438).  Saving model ...
Epoch: 23 cost time: 0.982170581817627
Epoch: 23, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.622 Vali Acc: 0.839 Test Loss: 0.622 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9566364288330078
Epoch: 24, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.610 Vali Acc: 0.850 Test Loss: 0.610 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 1.0064187049865723
Epoch: 25, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.579 Vali Acc: 0.878 Test Loss: 0.579 Test Acc: 0.878
Validation loss decreased (-0.849994 --> -0.877772).  Saving model ...
Epoch: 26 cost time: 0.929288387298584
Epoch: 26, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.546 Vali Acc: 0.861 Test Loss: 0.546 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9453525543212891
Epoch: 27, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.547 Vali Acc: 0.872 Test Loss: 0.547 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9405317306518555
Epoch: 28, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.521 Vali Acc: 0.872 Test Loss: 0.521 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9269587993621826
Epoch: 29, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.520 Vali Acc: 0.872 Test Loss: 0.520 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9271154403686523
Epoch: 30, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.510 Vali Acc: 0.878 Test Loss: 0.510 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877773).  Saving model ...
Epoch: 31 cost time: 1.0530421733856201
Epoch: 31, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.483 Vali Acc: 0.878 Test Loss: 0.483 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 32 cost time: 1.039119005203247
Epoch: 32, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.483 Vali Acc: 0.878 Test Loss: 0.483 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 33 cost time: 0.9419028759002686
Epoch: 33, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.488 Vali Acc: 0.867 Test Loss: 0.488 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.966559886932373
Epoch: 34, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.459 Vali Acc: 0.883 Test Loss: 0.459 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 35 cost time: 1.0173075199127197
Epoch: 35, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.474 Vali Acc: 0.867 Test Loss: 0.474 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.933208703994751
Epoch: 36, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.459 Vali Acc: 0.878 Test Loss: 0.459 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9569230079650879
Epoch: 37, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.460 Vali Acc: 0.878 Test Loss: 0.460 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9738187789916992
Epoch: 38, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.501 Vali Acc: 0.883 Test Loss: 0.501 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.915621280670166
Epoch: 39, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.496 Vali Acc: 0.878 Test Loss: 0.496 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9146959781646729
Epoch: 40, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.491 Vali Acc: 0.883 Test Loss: 0.491 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.9505259990692139
Epoch: 41, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.509 Vali Acc: 0.878 Test Loss: 0.509 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.9085144996643066
Epoch: 42, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.520 Vali Acc: 0.867 Test Loss: 0.520 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.9120135307312012
Epoch: 43, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.511 Vali Acc: 0.878 Test Loss: 0.511 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.9512810707092285
Epoch: 44, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.489 Vali Acc: 0.872 Test Loss: 0.489 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 215855
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.376861572265625
Epoch: 1, Steps: 12 | Train Loss: 2.664 Vali Loss: 2.557 Vali Acc: 0.261 Test Loss: 2.557 Test Acc: 0.261
Validation loss decreased (inf --> -0.261086).  Saving model ...
Epoch: 2 cost time: 1.0693953037261963
Epoch: 2, Steps: 12 | Train Loss: 2.181 Vali Loss: 2.100 Vali Acc: 0.500 Test Loss: 2.100 Test Acc: 0.500
Validation loss decreased (-0.261086 --> -0.499979).  Saving model ...
Epoch: 3 cost time: 1.0515103340148926
Epoch: 3, Steps: 12 | Train Loss: 1.643 Vali Loss: 1.586 Vali Acc: 0.589 Test Loss: 1.586 Test Acc: 0.589
Validation loss decreased (-0.499979 --> -0.588873).  Saving model ...
Epoch: 4 cost time: 1.0656473636627197
Epoch: 4, Steps: 12 | Train Loss: 1.134 Vali Loss: 1.165 Vali Acc: 0.656 Test Loss: 1.165 Test Acc: 0.656
Validation loss decreased (-0.588873 --> -0.655544).  Saving model ...
Epoch: 5 cost time: 1.0461225509643555
Epoch: 5, Steps: 12 | Train Loss: 0.791 Vali Loss: 0.981 Vali Acc: 0.700 Test Loss: 0.981 Test Acc: 0.700
Validation loss decreased (-0.655544 --> -0.699990).  Saving model ...
Epoch: 6 cost time: 1.0244321823120117
Epoch: 6, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.853 Vali Acc: 0.700 Test Loss: 0.853 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 7 cost time: 1.0033824443817139
Epoch: 7, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.843 Vali Acc: 0.744 Test Loss: 0.843 Test Acc: 0.744
Validation loss decreased (-0.699991 --> -0.744436).  Saving model ...
Epoch: 8 cost time: 1.0695314407348633
Epoch: 8, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.871 Vali Acc: 0.761 Test Loss: 0.871 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761102).  Saving model ...
Epoch: 9 cost time: 1.1254000663757324
Epoch: 9, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.927 Vali Acc: 0.739 Test Loss: 0.927 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1329760551452637
Epoch: 10, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.797 Vali Acc: 0.767 Test Loss: 0.797 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766659).  Saving model ...
Epoch: 11 cost time: 1.1101255416870117
Epoch: 11, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.912 Vali Acc: 0.794 Test Loss: 0.912 Test Acc: 0.794
Validation loss decreased (-0.766659 --> -0.794435).  Saving model ...
Epoch: 12 cost time: 1.0884549617767334
Epoch: 12, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.778 Vali Acc: 0.811 Test Loss: 0.778 Test Acc: 0.811
Validation loss decreased (-0.794435 --> -0.811103).  Saving model ...
Epoch: 13 cost time: 1.019864797592163
Epoch: 13, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.702 Vali Acc: 0.833 Test Loss: 0.702 Test Acc: 0.833
Validation loss decreased (-0.811103 --> -0.833326).  Saving model ...
Epoch: 14 cost time: 1.0721325874328613
Epoch: 14, Steps: 12 | Train Loss: 0.111 Vali Loss: 1.019 Vali Acc: 0.767 Test Loss: 1.019 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1219046115875244
Epoch: 15, Steps: 12 | Train Loss: 0.083 Vali Loss: 1.020 Vali Acc: 0.817 Test Loss: 1.020 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.958704948425293
Epoch: 16, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.904 Vali Acc: 0.822 Test Loss: 0.904 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.085817813873291
Epoch: 17, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.891 Vali Acc: 0.844 Test Loss: 0.891 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844436).  Saving model ...
Epoch: 18 cost time: 1.0537540912628174
Epoch: 18, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.995 Vali Acc: 0.856 Test Loss: 0.995 Test Acc: 0.856
Validation loss decreased (-0.844436 --> -0.855546).  Saving model ...
Epoch: 19 cost time: 1.0662720203399658
Epoch: 19, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.152 Vali Acc: 0.844 Test Loss: 1.152 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0829229354858398
Epoch: 20, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.126 Vali Acc: 0.839 Test Loss: 1.126 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1078498363494873
Epoch: 21, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.144 Vali Acc: 0.833 Test Loss: 1.144 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1515109539031982
Epoch: 22, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.064 Vali Acc: 0.833 Test Loss: 1.064 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.231853723526001
Epoch: 23, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.984 Vali Acc: 0.856 Test Loss: 0.984 Test Acc: 0.856
Validation loss decreased (-0.855546 --> -0.855546).  Saving model ...
Epoch: 24 cost time: 1.020777940750122
Epoch: 24, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.918 Vali Acc: 0.867 Test Loss: 0.918 Test Acc: 0.867
Validation loss decreased (-0.855546 --> -0.866657).  Saving model ...
Epoch: 25 cost time: 1.1443347930908203
Epoch: 25, Steps: 12 | Train Loss: 0.134 Vali Loss: 1.035 Vali Acc: 0.839 Test Loss: 1.035 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0811269283294678
Epoch: 26, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.107 Vali Acc: 0.844 Test Loss: 1.107 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.155998945236206
Epoch: 27, Steps: 12 | Train Loss: 0.093 Vali Loss: 1.387 Vali Acc: 0.811 Test Loss: 1.387 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0842289924621582
Epoch: 28, Steps: 12 | Train Loss: 0.152 Vali Loss: 1.199 Vali Acc: 0.822 Test Loss: 1.199 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1276962757110596
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.253 Vali Acc: 0.817 Test Loss: 1.253 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1661920547485352
Epoch: 30, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.199 Vali Acc: 0.844 Test Loss: 1.199 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1137800216674805
Epoch: 31, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.295 Vali Acc: 0.839 Test Loss: 1.295 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1793055534362793
Epoch: 32, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.182 Vali Acc: 0.867 Test Loss: 1.182 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.2172610759735107
Epoch: 33, Steps: 12 | Train Loss: 0.312 Vali Loss: 1.303 Vali Acc: 0.861 Test Loss: 1.303 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.1175684928894043
Epoch: 34, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.493 Vali Acc: 0.833 Test Loss: 1.493 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 927119
model size : 3.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4696295261383057
Epoch: 1, Steps: 12 | Train Loss: 2.700 Vali Loss: 2.626 Vali Acc: 0.189 Test Loss: 2.626 Test Acc: 0.189
Validation loss decreased (inf --> -0.188863).  Saving model ...
Epoch: 2 cost time: 0.886157751083374
Epoch: 2, Steps: 12 | Train Loss: 2.418 Vali Loss: 2.352 Vali Acc: 0.367 Test Loss: 2.352 Test Acc: 0.367
Validation loss decreased (-0.188863 --> -0.366643).  Saving model ...
Epoch: 3 cost time: 0.9713389873504639
Epoch: 3, Steps: 12 | Train Loss: 1.957 Vali Loss: 1.906 Vali Acc: 0.583 Test Loss: 1.906 Test Acc: 0.583
Validation loss decreased (-0.366643 --> -0.583314).  Saving model ...
Epoch: 4 cost time: 0.9769415855407715
Epoch: 4, Steps: 12 | Train Loss: 1.490 Vali Loss: 1.473 Vali Acc: 0.644 Test Loss: 1.473 Test Acc: 0.644
Validation loss decreased (-0.583314 --> -0.644430).  Saving model ...
Epoch: 5 cost time: 0.8726749420166016
Epoch: 5, Steps: 12 | Train Loss: 1.102 Vali Loss: 1.188 Vali Acc: 0.667 Test Loss: 1.188 Test Acc: 0.667
Validation loss decreased (-0.644430 --> -0.666655).  Saving model ...
Epoch: 6 cost time: 0.9144926071166992
Epoch: 6, Steps: 12 | Train Loss: 0.846 Vali Loss: 1.052 Vali Acc: 0.667 Test Loss: 1.052 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666656).  Saving model ...
Epoch: 7 cost time: 0.9189229011535645
Epoch: 7, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.936 Vali Acc: 0.678 Test Loss: 0.936 Test Acc: 0.678
Validation loss decreased (-0.666656 --> -0.677768).  Saving model ...
Epoch: 8 cost time: 0.8950562477111816
Epoch: 8, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.854 Vali Acc: 0.744 Test Loss: 0.854 Test Acc: 0.744
Validation loss decreased (-0.677768 --> -0.744436).  Saving model ...
Epoch: 9 cost time: 1.0219719409942627
Epoch: 9, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.783 Vali Acc: 0.756 Test Loss: 0.783 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755548).  Saving model ...
Epoch: 10 cost time: 1.0145971775054932
Epoch: 10, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.810 Vali Acc: 0.761 Test Loss: 0.810 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761103).  Saving model ...
Epoch: 11 cost time: 0.9611988067626953
Epoch: 11, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.753 Vali Acc: 0.789 Test Loss: 0.753 Test Acc: 0.789
Validation loss decreased (-0.761103 --> -0.788881).  Saving model ...
Epoch: 12 cost time: 1.008117437362671
Epoch: 12, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.758 Vali Acc: 0.794 Test Loss: 0.758 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794437).  Saving model ...
Epoch: 13 cost time: 1.0109903812408447
Epoch: 13, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.795 Vali Acc: 0.783 Test Loss: 0.795 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9691081047058105
Epoch: 14, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.665 Vali Acc: 0.828 Test Loss: 0.665 Test Acc: 0.828
Validation loss decreased (-0.794437 --> -0.827771).  Saving model ...
Epoch: 15 cost time: 1.0038628578186035
Epoch: 15, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.707 Vali Acc: 0.806 Test Loss: 0.707 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9563584327697754
Epoch: 16, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.685 Vali Acc: 0.844 Test Loss: 0.685 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 17 cost time: 0.9701244831085205
Epoch: 17, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.727 Vali Acc: 0.817 Test Loss: 0.727 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9097151756286621
Epoch: 18, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.693 Vali Acc: 0.828 Test Loss: 0.693 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9337656497955322
Epoch: 19, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.728 Vali Acc: 0.833 Test Loss: 0.728 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9514098167419434
Epoch: 20, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.721 Vali Acc: 0.844 Test Loss: 0.721 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9190869331359863
Epoch: 21, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.742 Vali Acc: 0.844 Test Loss: 0.742 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0358846187591553
Epoch: 22, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.766 Vali Acc: 0.828 Test Loss: 0.766 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0534489154815674
Epoch: 23, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.809 Vali Acc: 0.828 Test Loss: 0.809 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0152325630187988
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.822 Vali Acc: 0.856 Test Loss: 0.822 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855547).  Saving model ...
Epoch: 25 cost time: 1.036139965057373
Epoch: 25, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.853 Vali Acc: 0.839 Test Loss: 0.853 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9967749118804932
Epoch: 26, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.826 Vali Acc: 0.833 Test Loss: 0.826 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9191813468933105
Epoch: 27, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.869 Vali Acc: 0.861 Test Loss: 0.869 Test Acc: 0.861
Validation loss decreased (-0.855547 --> -0.861102).  Saving model ...
Epoch: 28 cost time: 0.9503951072692871
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.889 Vali Acc: 0.850 Test Loss: 0.889 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9319689273834229
Epoch: 29, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.877 Vali Acc: 0.856 Test Loss: 0.877 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9799642562866211
Epoch: 30, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.884 Vali Acc: 0.850 Test Loss: 0.884 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9542958736419678
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.891 Vali Acc: 0.856 Test Loss: 0.891 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0595042705535889
Epoch: 32, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.916 Vali Acc: 0.861 Test Loss: 0.916 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0175578594207764
Epoch: 33, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.972 Vali Acc: 0.850 Test Loss: 0.972 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0390076637268066
Epoch: 34, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.892 Vali Acc: 0.844 Test Loss: 0.892 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9925355911254883
Epoch: 35, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.004 Vali Acc: 0.861 Test Loss: 1.004 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9904460906982422
Epoch: 36, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.077 Vali Acc: 0.828 Test Loss: 1.077 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.9964087009429932
Epoch: 37, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.101 Vali Acc: 0.850 Test Loss: 1.101 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 835087
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.650923013687134
Epoch: 1, Steps: 12 | Train Loss: 2.654 Vali Loss: 2.601 Vali Acc: 0.167 Test Loss: 2.601 Test Acc: 0.167
Validation loss decreased (inf --> -0.166641).  Saving model ...
Epoch: 2 cost time: 0.9634952545166016
Epoch: 2, Steps: 12 | Train Loss: 2.368 Vali Loss: 2.282 Vali Acc: 0.428 Test Loss: 2.282 Test Acc: 0.428
Validation loss decreased (-0.166641 --> -0.427755).  Saving model ...
Epoch: 3 cost time: 1.1055281162261963
Epoch: 3, Steps: 12 | Train Loss: 1.921 Vali Loss: 1.867 Vali Acc: 0.561 Test Loss: 1.867 Test Acc: 0.561
Validation loss decreased (-0.427755 --> -0.561092).  Saving model ...
Epoch: 4 cost time: 1.0457193851470947
Epoch: 4, Steps: 12 | Train Loss: 1.409 Vali Loss: 1.450 Vali Acc: 0.628 Test Loss: 1.450 Test Acc: 0.628
Validation loss decreased (-0.561092 --> -0.627763).  Saving model ...
Epoch: 5 cost time: 1.1596722602844238
Epoch: 5, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.151 Vali Acc: 0.650 Test Loss: 1.151 Test Acc: 0.650
Validation loss decreased (-0.627763 --> -0.649988).  Saving model ...
Epoch: 6 cost time: 1.063450574874878
Epoch: 6, Steps: 12 | Train Loss: 0.796 Vali Loss: 1.022 Vali Acc: 0.644 Test Loss: 1.022 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0655171871185303
Epoch: 7, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.911 Vali Acc: 0.689 Test Loss: 0.911 Test Acc: 0.689
Validation loss decreased (-0.649988 --> -0.688880).  Saving model ...
Epoch: 8 cost time: 1.0513839721679688
Epoch: 8, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.845 Vali Acc: 0.706 Test Loss: 0.845 Test Acc: 0.706
Validation loss decreased (-0.688880 --> -0.705547).  Saving model ...
Epoch: 9 cost time: 1.0233721733093262
Epoch: 9, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.815 Vali Acc: 0.744 Test Loss: 0.815 Test Acc: 0.744
Validation loss decreased (-0.705547 --> -0.744436).  Saving model ...
Epoch: 10 cost time: 1.0860300064086914
Epoch: 10, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.747 Vali Acc: 0.817 Test Loss: 0.747 Test Acc: 0.817
Validation loss decreased (-0.744436 --> -0.816659).  Saving model ...
Epoch: 11 cost time: 1.114689588546753
Epoch: 11, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.727 Vali Acc: 0.806 Test Loss: 0.727 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1944973468780518
Epoch: 12, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.705 Vali Acc: 0.806 Test Loss: 0.705 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0179362297058105
Epoch: 13, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.652 Vali Acc: 0.822 Test Loss: 0.652 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822216).  Saving model ...
Epoch: 14 cost time: 1.1100029945373535
Epoch: 14, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.665 Vali Acc: 0.839 Test Loss: 0.665 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838882).  Saving model ...
Epoch: 15 cost time: 1.0329816341400146
Epoch: 15, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.673 Vali Acc: 0.794 Test Loss: 0.673 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.067375659942627
Epoch: 16, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.738 Vali Acc: 0.828 Test Loss: 0.738 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1038188934326172
Epoch: 17, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.739 Vali Acc: 0.800 Test Loss: 0.739 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.058556079864502
Epoch: 18, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.691 Vali Acc: 0.867 Test Loss: 0.691 Test Acc: 0.867
Validation loss decreased (-0.838882 --> -0.866660).  Saving model ...
Epoch: 19 cost time: 0.9838764667510986
Epoch: 19, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.741 Vali Acc: 0.844 Test Loss: 0.741 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9664170742034912
Epoch: 20, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.832 Vali Acc: 0.839 Test Loss: 0.832 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.138456106185913
Epoch: 21, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.797 Vali Acc: 0.861 Test Loss: 0.797 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9758002758026123
Epoch: 22, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.794 Vali Acc: 0.833 Test Loss: 0.794 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.118910312652588
Epoch: 23, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.885 Vali Acc: 0.844 Test Loss: 0.885 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0106728076934814
Epoch: 24, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.838 Vali Acc: 0.867 Test Loss: 0.838 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0031495094299316
Epoch: 25, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.825 Vali Acc: 0.833 Test Loss: 0.825 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0147309303283691
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.866 Vali Acc: 0.861 Test Loss: 0.866 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0503768920898438
Epoch: 27, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.907 Vali Acc: 0.861 Test Loss: 0.907 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.071756362915039
Epoch: 28, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.879 Vali Acc: 0.861 Test Loss: 0.879 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 835215
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.284332275390625
Epoch: 1, Steps: 12 | Train Loss: 2.720 Vali Loss: 2.670 Vali Acc: 0.122 Test Loss: 2.670 Test Acc: 0.122
Validation loss decreased (inf --> -0.122196).  Saving model ...
Epoch: 2 cost time: 1.0194346904754639
Epoch: 2, Steps: 12 | Train Loss: 2.491 Vali Loss: 2.409 Vali Acc: 0.450 Test Loss: 2.409 Test Acc: 0.450
Validation loss decreased (-0.122196 --> -0.449976).  Saving model ...
Epoch: 3 cost time: 1.018587589263916
Epoch: 3, Steps: 12 | Train Loss: 2.090 Vali Loss: 2.024 Vali Acc: 0.583 Test Loss: 2.024 Test Acc: 0.583
Validation loss decreased (-0.449976 --> -0.583313).  Saving model ...
Epoch: 4 cost time: 1.0077271461486816
Epoch: 4, Steps: 12 | Train Loss: 1.698 Vali Loss: 1.616 Vali Acc: 0.606 Test Loss: 1.616 Test Acc: 0.606
Validation loss decreased (-0.583313 --> -0.605539).  Saving model ...
Epoch: 5 cost time: 1.1245336532592773
Epoch: 5, Steps: 12 | Train Loss: 1.280 Vali Loss: 1.313 Vali Acc: 0.633 Test Loss: 1.313 Test Acc: 0.633
Validation loss decreased (-0.605539 --> -0.633320).  Saving model ...
Epoch: 6 cost time: 1.1236422061920166
Epoch: 6, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.104 Vali Acc: 0.661 Test Loss: 1.104 Test Acc: 0.661
Validation loss decreased (-0.633320 --> -0.661100).  Saving model ...
Epoch: 7 cost time: 1.1601884365081787
Epoch: 7, Steps: 12 | Train Loss: 0.749 Vali Loss: 1.003 Vali Acc: 0.683 Test Loss: 1.003 Test Acc: 0.683
Validation loss decreased (-0.661100 --> -0.683323).  Saving model ...
Epoch: 8 cost time: 1.0758705139160156
Epoch: 8, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.905 Vali Acc: 0.694 Test Loss: 0.905 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694435).  Saving model ...
Epoch: 9 cost time: 1.0876960754394531
Epoch: 9, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.831 Vali Acc: 0.756 Test Loss: 0.831 Test Acc: 0.756
Validation loss decreased (-0.694435 --> -0.755547).  Saving model ...
Epoch: 10 cost time: 1.0379736423492432
Epoch: 10, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.748 Vali Acc: 0.767 Test Loss: 0.748 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766659).  Saving model ...
Epoch: 11 cost time: 1.0025606155395508
Epoch: 11, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.711 Vali Acc: 0.811 Test Loss: 0.711 Test Acc: 0.811
Validation loss decreased (-0.766659 --> -0.811104).  Saving model ...
Epoch: 12 cost time: 1.102865219116211
Epoch: 12, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.703 Vali Acc: 0.806 Test Loss: 0.703 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0149929523468018
Epoch: 13, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.630 Vali Acc: 0.811 Test Loss: 0.630 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811105).  Saving model ...
Epoch: 14 cost time: 1.087263822555542
Epoch: 14, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.644 Vali Acc: 0.833 Test Loss: 0.644 Test Acc: 0.833
Validation loss decreased (-0.811105 --> -0.833327).  Saving model ...
Epoch: 15 cost time: 1.003673791885376
Epoch: 15, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.629 Vali Acc: 0.833 Test Loss: 0.629 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 1.1729118824005127
Epoch: 16, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 1.0554087162017822
Epoch: 17, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.623 Vali Acc: 0.856 Test Loss: 0.623 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 18 cost time: 1.0845904350280762
Epoch: 18, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.669 Vali Acc: 0.856 Test Loss: 0.669 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0956676006317139
Epoch: 19, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.647 Vali Acc: 0.872 Test Loss: 0.647 Test Acc: 0.872
Validation loss decreased (-0.855549 --> -0.872216).  Saving model ...
Epoch: 20 cost time: 1.1131579875946045
Epoch: 20, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.690 Vali Acc: 0.867 Test Loss: 0.690 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0482256412506104
Epoch: 21, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.673 Vali Acc: 0.867 Test Loss: 0.673 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.984290361404419
Epoch: 22, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.698 Vali Acc: 0.878 Test Loss: 0.698 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877771).  Saving model ...
Epoch: 23 cost time: 1.0053858757019043
Epoch: 23, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.689 Vali Acc: 0.878 Test Loss: 0.689 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877771).  Saving model ...
Epoch: 24 cost time: 1.089909315109253
Epoch: 24, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.711 Vali Acc: 0.878 Test Loss: 0.711 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.00722074508667
Epoch: 25, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.735 Vali Acc: 0.883 Test Loss: 0.735 Test Acc: 0.883
Validation loss decreased (-0.877771 --> -0.883326).  Saving model ...
Epoch: 26 cost time: 1.04071044921875
Epoch: 26, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.702 Vali Acc: 0.889 Test Loss: 0.702 Test Acc: 0.889
Validation loss decreased (-0.883326 --> -0.888882).  Saving model ...
Epoch: 27 cost time: 1.0124197006225586
Epoch: 27, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.743 Vali Acc: 0.867 Test Loss: 0.743 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0287375450134277
Epoch: 28, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.791 Vali Acc: 0.867 Test Loss: 0.791 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1361405849456787
Epoch: 29, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.762 Vali Acc: 0.878 Test Loss: 0.762 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0304274559020996
Epoch: 30, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.770 Vali Acc: 0.878 Test Loss: 0.770 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.052614450454712
Epoch: 31, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.788 Vali Acc: 0.861 Test Loss: 0.788 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9963045120239258
Epoch: 32, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.805 Vali Acc: 0.861 Test Loss: 0.805 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0239577293395996
Epoch: 33, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.808 Vali Acc: 0.861 Test Loss: 0.808 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1003074645996094
Epoch: 34, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.811 Vali Acc: 0.867 Test Loss: 0.811 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.0374822616577148
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.824 Vali Acc: 0.861 Test Loss: 0.824 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.0792720317840576
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.846 Vali Acc: 0.878 Test Loss: 0.846 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 812303
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.548572063446045
Epoch: 1, Steps: 12 | Train Loss: 2.741 Vali Loss: 2.609 Vali Acc: 0.228 Test Loss: 2.609 Test Acc: 0.228
Validation loss decreased (inf --> -0.227752).  Saving model ...
Epoch: 2 cost time: 1.0652813911437988
Epoch: 2, Steps: 12 | Train Loss: 2.524 Vali Loss: 2.398 Vali Acc: 0.444 Test Loss: 2.398 Test Acc: 0.444
Validation loss decreased (-0.227752 --> -0.444420).  Saving model ...
Epoch: 3 cost time: 1.0528602600097656
Epoch: 3, Steps: 12 | Train Loss: 2.159 Vali Loss: 2.078 Vali Acc: 0.544 Test Loss: 2.078 Test Acc: 0.544
Validation loss decreased (-0.444420 --> -0.544424).  Saving model ...
Epoch: 4 cost time: 1.035581350326538
Epoch: 4, Steps: 12 | Train Loss: 1.806 Vali Loss: 1.701 Vali Acc: 0.600 Test Loss: 1.701 Test Acc: 0.600
Validation loss decreased (-0.544424 --> -0.599983).  Saving model ...
Epoch: 5 cost time: 1.0481903553009033
Epoch: 5, Steps: 12 | Train Loss: 1.456 Vali Loss: 1.368 Vali Acc: 0.633 Test Loss: 1.368 Test Acc: 0.633
Validation loss decreased (-0.599983 --> -0.633320).  Saving model ...
Epoch: 6 cost time: 1.0315182209014893
Epoch: 6, Steps: 12 | Train Loss: 1.099 Vali Loss: 1.174 Vali Acc: 0.661 Test Loss: 1.174 Test Acc: 0.661
Validation loss decreased (-0.633320 --> -0.661099).  Saving model ...
Epoch: 7 cost time: 0.9568610191345215
Epoch: 7, Steps: 12 | Train Loss: 0.859 Vali Loss: 1.019 Vali Acc: 0.683 Test Loss: 1.019 Test Acc: 0.683
Validation loss decreased (-0.661099 --> -0.683323).  Saving model ...
Epoch: 8 cost time: 1.0768203735351562
Epoch: 8, Steps: 12 | Train Loss: 0.764 Vali Loss: 0.937 Vali Acc: 0.706 Test Loss: 0.937 Test Acc: 0.706
Validation loss decreased (-0.683323 --> -0.705546).  Saving model ...
Epoch: 9 cost time: 1.0338397026062012
Epoch: 9, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.851 Vali Acc: 0.744 Test Loss: 0.851 Test Acc: 0.744
Validation loss decreased (-0.705546 --> -0.744436).  Saving model ...
Epoch: 10 cost time: 1.0376546382904053
Epoch: 10, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.765 Vali Acc: 0.772 Test Loss: 0.765 Test Acc: 0.772
Validation loss decreased (-0.744436 --> -0.772215).  Saving model ...
Epoch: 11 cost time: 1.0932095050811768
Epoch: 11, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.691 Vali Acc: 0.794 Test Loss: 0.691 Test Acc: 0.794
Validation loss decreased (-0.772215 --> -0.794438).  Saving model ...
Epoch: 12 cost time: 1.08314847946167
Epoch: 12, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.682 Vali Acc: 0.800 Test Loss: 0.682 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799993).  Saving model ...
Epoch: 13 cost time: 1.115607500076294
Epoch: 13, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.650 Vali Acc: 0.822 Test Loss: 0.650 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 14 cost time: 1.0315628051757812
Epoch: 14, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.616 Vali Acc: 0.833 Test Loss: 0.616 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 15 cost time: 1.00547194480896
Epoch: 15, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.593 Vali Acc: 0.839 Test Loss: 0.593 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 16 cost time: 1.0331299304962158
Epoch: 16, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.606 Vali Acc: 0.844 Test Loss: 0.606 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 17 cost time: 1.0639665126800537
Epoch: 17, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.611 Vali Acc: 0.856 Test Loss: 0.611 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 18 cost time: 0.9962503910064697
Epoch: 18, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.609 Vali Acc: 0.839 Test Loss: 0.609 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9227797985076904
Epoch: 19, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.631 Vali Acc: 0.850 Test Loss: 0.631 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9884121417999268
Epoch: 20, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.620 Vali Acc: 0.856 Test Loss: 0.620 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9699726104736328
Epoch: 21, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.631 Vali Acc: 0.867 Test Loss: 0.631 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866660).  Saving model ...
Epoch: 22 cost time: 1.0247530937194824
Epoch: 22, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.636 Vali Acc: 0.850 Test Loss: 0.636 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1040146350860596
Epoch: 23, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.646 Vali Acc: 0.856 Test Loss: 0.646 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0578646659851074
Epoch: 24, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.702 Vali Acc: 0.878 Test Loss: 0.702 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877771).  Saving model ...
Epoch: 25 cost time: 1.042163372039795
Epoch: 25, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.673 Vali Acc: 0.878 Test Loss: 0.673 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877771).  Saving model ...
Epoch: 26 cost time: 1.0375328063964844
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.678 Vali Acc: 0.878 Test Loss: 0.678 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0183420181274414
Epoch: 27, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.735 Vali Acc: 0.883 Test Loss: 0.735 Test Acc: 0.883
Validation loss decreased (-0.877771 --> -0.883326).  Saving model ...
Epoch: 28 cost time: 1.012049913406372
Epoch: 28, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.728 Vali Acc: 0.844 Test Loss: 0.728 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0221550464630127
Epoch: 29, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.774 Vali Acc: 0.867 Test Loss: 0.774 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1144447326660156
Epoch: 30, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.749 Vali Acc: 0.867 Test Loss: 0.749 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0454397201538086
Epoch: 31, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.720 Vali Acc: 0.867 Test Loss: 0.720 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9889953136444092
Epoch: 32, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.772 Vali Acc: 0.883 Test Loss: 0.772 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.024789571762085
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.764 Vali Acc: 0.889 Test Loss: 0.764 Test Acc: 0.889
Validation loss decreased (-0.883326 --> -0.888881).  Saving model ...
Epoch: 34 cost time: 1.0600183010101318
Epoch: 34, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.770 Vali Acc: 0.872 Test Loss: 0.770 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.070277214050293
Epoch: 35, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.774 Vali Acc: 0.878 Test Loss: 0.774 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0332880020141602
Epoch: 36, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.803 Vali Acc: 0.872 Test Loss: 0.803 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0120289325714111
Epoch: 37, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.784 Vali Acc: 0.889 Test Loss: 0.784 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0560839176177979
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.788 Vali Acc: 0.878 Test Loss: 0.788 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0265138149261475
Epoch: 39, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.807 Vali Acc: 0.878 Test Loss: 0.807 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0447704792022705
Epoch: 40, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.817 Vali Acc: 0.883 Test Loss: 0.817 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0634455680847168
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.815 Vali Acc: 0.889 Test Loss: 0.815 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0059661865234375
Epoch: 42, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.821 Vali Acc: 0.889 Test Loss: 0.821 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.053835153579712
Epoch: 43, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.822 Vali Acc: 0.883 Test Loss: 0.822 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 797199
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.444399118423462
Epoch: 1, Steps: 12 | Train Loss: 2.720 Vali Loss: 2.711 Vali Acc: 0.139 Test Loss: 2.711 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 1.070852518081665
Epoch: 2, Steps: 12 | Train Loss: 2.521 Vali Loss: 2.531 Vali Acc: 0.344 Test Loss: 2.531 Test Acc: 0.344
Validation loss decreased (-0.138862 --> -0.344419).  Saving model ...
Epoch: 3 cost time: 0.9663569927215576
Epoch: 3, Steps: 12 | Train Loss: 2.247 Vali Loss: 2.236 Vali Acc: 0.528 Test Loss: 2.236 Test Acc: 0.528
Validation loss decreased (-0.344419 --> -0.527755).  Saving model ...
Epoch: 4 cost time: 1.0554625988006592
Epoch: 4, Steps: 12 | Train Loss: 1.871 Vali Loss: 1.883 Vali Acc: 0.572 Test Loss: 1.883 Test Acc: 0.572
Validation loss decreased (-0.527755 --> -0.572203).  Saving model ...
Epoch: 5 cost time: 0.9591350555419922
Epoch: 5, Steps: 12 | Train Loss: 1.483 Vali Loss: 1.576 Vali Acc: 0.633 Test Loss: 1.576 Test Acc: 0.633
Validation loss decreased (-0.572203 --> -0.633318).  Saving model ...
Epoch: 6 cost time: 0.9607813358306885
Epoch: 6, Steps: 12 | Train Loss: 1.183 Vali Loss: 1.292 Vali Acc: 0.678 Test Loss: 1.292 Test Acc: 0.678
Validation loss decreased (-0.633318 --> -0.677765).  Saving model ...
Epoch: 7 cost time: 1.0353572368621826
Epoch: 7, Steps: 12 | Train Loss: 0.953 Vali Loss: 1.085 Vali Acc: 0.689 Test Loss: 1.085 Test Acc: 0.689
Validation loss decreased (-0.677765 --> -0.688878).  Saving model ...
Epoch: 8 cost time: 1.015932321548462
Epoch: 8, Steps: 12 | Train Loss: 0.812 Vali Loss: 0.957 Vali Acc: 0.739 Test Loss: 0.957 Test Acc: 0.739
Validation loss decreased (-0.688878 --> -0.738879).  Saving model ...
Epoch: 9 cost time: 1.0099945068359375
Epoch: 9, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.870 Vali Acc: 0.756 Test Loss: 0.870 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755547).  Saving model ...
Epoch: 10 cost time: 1.0383038520812988
Epoch: 10, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.781 Vali Acc: 0.750 Test Loss: 0.781 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.016740322113037
Epoch: 11, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.713 Vali Acc: 0.806 Test Loss: 0.713 Test Acc: 0.806
Validation loss decreased (-0.755547 --> -0.805548).  Saving model ...
Epoch: 12 cost time: 1.0198826789855957
Epoch: 12, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.671 Vali Acc: 0.794 Test Loss: 0.671 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0724549293518066
Epoch: 13, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.638 Vali Acc: 0.833 Test Loss: 0.638 Test Acc: 0.833
Validation loss decreased (-0.805548 --> -0.833327).  Saving model ...
Epoch: 14 cost time: 0.9690155982971191
Epoch: 14, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 0.9926066398620605
Epoch: 15, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.570 Vali Acc: 0.844 Test Loss: 0.570 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0449514389038086
Epoch: 16, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.576 Vali Acc: 0.844 Test Loss: 0.576 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9823970794677734
Epoch: 17, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.020381212234497
Epoch: 18, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.558 Vali Acc: 0.883 Test Loss: 0.558 Test Acc: 0.883
Validation loss decreased (-0.849994 --> -0.883328).  Saving model ...
Epoch: 19 cost time: 1.046964168548584
Epoch: 19, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.584 Vali Acc: 0.861 Test Loss: 0.584 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0008196830749512
Epoch: 20, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.558 Vali Acc: 0.878 Test Loss: 0.558 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.028169870376587
Epoch: 21, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.586 Vali Acc: 0.878 Test Loss: 0.586 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0757055282592773
Epoch: 22, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.600 Vali Acc: 0.872 Test Loss: 0.600 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.011767864227295
Epoch: 23, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.593 Vali Acc: 0.872 Test Loss: 0.593 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0601189136505127
Epoch: 24, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.584 Vali Acc: 0.867 Test Loss: 0.584 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.050520658493042
Epoch: 25, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.656 Vali Acc: 0.872 Test Loss: 0.656 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9785923957824707
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.630 Vali Acc: 0.878 Test Loss: 0.630 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0346975326538086
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.620 Vali Acc: 0.883 Test Loss: 0.620 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9804036617279053
Epoch: 28, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.644 Vali Acc: 0.878 Test Loss: 0.644 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 789775
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4685215950012207
Epoch: 1, Steps: 12 | Train Loss: 2.726 Vali Loss: 2.680 Vali Acc: 0.100 Test Loss: 2.680 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 1.0454275608062744
Epoch: 2, Steps: 12 | Train Loss: 2.570 Vali Loss: 2.524 Vali Acc: 0.289 Test Loss: 2.524 Test Acc: 0.289
Validation loss decreased (-0.099973 --> -0.288864).  Saving model ...
Epoch: 3 cost time: 1.046463966369629
Epoch: 3, Steps: 12 | Train Loss: 2.282 Vali Loss: 2.259 Vali Acc: 0.489 Test Loss: 2.259 Test Acc: 0.489
Validation loss decreased (-0.288864 --> -0.488866).  Saving model ...
Epoch: 4 cost time: 1.0348865985870361
Epoch: 4, Steps: 12 | Train Loss: 2.009 Vali Loss: 1.937 Vali Acc: 0.561 Test Loss: 1.937 Test Acc: 0.561
Validation loss decreased (-0.488866 --> -0.561092).  Saving model ...
Epoch: 5 cost time: 1.0468032360076904
Epoch: 5, Steps: 12 | Train Loss: 1.686 Vali Loss: 1.639 Vali Acc: 0.633 Test Loss: 1.639 Test Acc: 0.633
Validation loss decreased (-0.561092 --> -0.633317).  Saving model ...
Epoch: 6 cost time: 1.0231726169586182
Epoch: 6, Steps: 12 | Train Loss: 1.343 Vali Loss: 1.373 Vali Acc: 0.672 Test Loss: 1.373 Test Acc: 0.672
Validation loss decreased (-0.633317 --> -0.672208).  Saving model ...
Epoch: 7 cost time: 1.059187650680542
Epoch: 7, Steps: 12 | Train Loss: 1.167 Vali Loss: 1.179 Vali Acc: 0.706 Test Loss: 1.179 Test Acc: 0.706
Validation loss decreased (-0.672208 --> -0.705544).  Saving model ...
Epoch: 8 cost time: 0.9703764915466309
Epoch: 8, Steps: 12 | Train Loss: 0.857 Vali Loss: 1.040 Vali Acc: 0.711 Test Loss: 1.040 Test Acc: 0.711
Validation loss decreased (-0.705544 --> -0.711101).  Saving model ...
Epoch: 9 cost time: 0.979144811630249
Epoch: 9, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.908 Vali Acc: 0.750 Test Loss: 0.908 Test Acc: 0.750
Validation loss decreased (-0.711101 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 1.053361177444458
Epoch: 10, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.809 Vali Acc: 0.778 Test Loss: 0.809 Test Acc: 0.778
Validation loss decreased (-0.749991 --> -0.777770).  Saving model ...
Epoch: 11 cost time: 0.9631247520446777
Epoch: 11, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.739 Vali Acc: 0.811 Test Loss: 0.739 Test Acc: 0.811
Validation loss decreased (-0.777770 --> -0.811104).  Saving model ...
Epoch: 12 cost time: 1.045564889907837
Epoch: 12, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.685 Vali Acc: 0.806 Test Loss: 0.685 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.070439338684082
Epoch: 13, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.610 Vali Acc: 0.839 Test Loss: 0.610 Test Acc: 0.839
Validation loss decreased (-0.811104 --> -0.838883).  Saving model ...
Epoch: 14 cost time: 1.0600929260253906
Epoch: 14, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.571 Vali Acc: 0.839 Test Loss: 0.571 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 15 cost time: 1.0626451969146729
Epoch: 15, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.568 Vali Acc: 0.839 Test Loss: 0.568 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 16 cost time: 1.028839349746704
Epoch: 16, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849995).  Saving model ...
Epoch: 17 cost time: 1.021252155303955
Epoch: 17, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.553 Vali Acc: 0.844 Test Loss: 0.553 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0187902450561523
Epoch: 18, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.501 Vali Acc: 0.839 Test Loss: 0.501 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0127782821655273
Epoch: 19, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.520 Vali Acc: 0.867 Test Loss: 0.520 Test Acc: 0.867
Validation loss decreased (-0.849995 --> -0.866661).  Saving model ...
Epoch: 20 cost time: 1.0254063606262207
Epoch: 20, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.953624963760376
Epoch: 21, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.524 Vali Acc: 0.839 Test Loss: 0.524 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.935917854309082
Epoch: 22, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.523 Vali Acc: 0.867 Test Loss: 0.523 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.053328514099121
Epoch: 23, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.526 Vali Acc: 0.861 Test Loss: 0.526 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9919006824493408
Epoch: 24, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.551 Vali Acc: 0.844 Test Loss: 0.551 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9951171875
Epoch: 25, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.556 Vali Acc: 0.878 Test Loss: 0.556 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 26 cost time: 1.0720503330230713
Epoch: 26, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.573 Vali Acc: 0.861 Test Loss: 0.573 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0077621936798096
Epoch: 27, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.578 Vali Acc: 0.867 Test Loss: 0.578 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.006404161453247
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.589 Vali Acc: 0.861 Test Loss: 0.589 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9530384540557861
Epoch: 29, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.027193546295166
Epoch: 30, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.576 Vali Acc: 0.861 Test Loss: 0.576 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0393552780151367
Epoch: 31, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.564 Vali Acc: 0.872 Test Loss: 0.564 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.010650396347046
Epoch: 32, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.588 Vali Acc: 0.867 Test Loss: 0.588 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0908150672912598
Epoch: 33, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.596 Vali Acc: 0.878 Test Loss: 0.596 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9980616569519043
Epoch: 34, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.577 Vali Acc: 0.872 Test Loss: 0.577 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9781720638275146
Epoch: 35, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.653 Vali Acc: 0.867 Test Loss: 0.653 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 782479
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.122041940689087
Epoch: 1, Steps: 12 | Train Loss: 2.695 Vali Loss: 2.627 Vali Acc: 0.283 Test Loss: 2.627 Test Acc: 0.283
Validation loss decreased (inf --> -0.283307).  Saving model ...
Epoch: 2 cost time: 0.8362128734588623
Epoch: 2, Steps: 12 | Train Loss: 2.454 Vali Loss: 2.371 Vali Acc: 0.372 Test Loss: 2.371 Test Acc: 0.372
Validation loss decreased (-0.283307 --> -0.372199).  Saving model ...
Epoch: 3 cost time: 0.8329200744628906
Epoch: 3, Steps: 12 | Train Loss: 2.062 Vali Loss: 1.996 Vali Acc: 0.533 Test Loss: 1.996 Test Acc: 0.533
Validation loss decreased (-0.372199 --> -0.533313).  Saving model ...
Epoch: 4 cost time: 0.8609464168548584
Epoch: 4, Steps: 12 | Train Loss: 1.628 Vali Loss: 1.610 Vali Acc: 0.606 Test Loss: 1.610 Test Acc: 0.606
Validation loss decreased (-0.533313 --> -0.605539).  Saving model ...
Epoch: 5 cost time: 0.8411397933959961
Epoch: 5, Steps: 12 | Train Loss: 1.207 Vali Loss: 1.299 Vali Acc: 0.667 Test Loss: 1.299 Test Acc: 0.667
Validation loss decreased (-0.605539 --> -0.666654).  Saving model ...
Epoch: 6 cost time: 0.8380613327026367
Epoch: 6, Steps: 12 | Train Loss: 0.992 Vali Loss: 1.104 Vali Acc: 0.667 Test Loss: 1.104 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666656).  Saving model ...
Epoch: 7 cost time: 0.8837487697601318
Epoch: 7, Steps: 12 | Train Loss: 0.794 Vali Loss: 0.996 Vali Acc: 0.667 Test Loss: 0.996 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666657).  Saving model ...
Epoch: 8 cost time: 0.8704438209533691
Epoch: 8, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.921 Vali Acc: 0.717 Test Loss: 0.921 Test Acc: 0.717
Validation loss decreased (-0.666657 --> -0.716657).  Saving model ...
Epoch: 9 cost time: 0.8787140846252441
Epoch: 9, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.859 Vali Acc: 0.722 Test Loss: 0.859 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722214).  Saving model ...
Epoch: 10 cost time: 0.8619935512542725
Epoch: 10, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.816 Vali Acc: 0.744 Test Loss: 0.816 Test Acc: 0.744
Validation loss decreased (-0.722214 --> -0.744436).  Saving model ...
Epoch: 11 cost time: 0.9150383472442627
Epoch: 11, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.813 Vali Acc: 0.750 Test Loss: 0.813 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749992).  Saving model ...
Epoch: 12 cost time: 0.9700477123260498
Epoch: 12, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.755 Vali Acc: 0.794 Test Loss: 0.755 Test Acc: 0.794
Validation loss decreased (-0.749992 --> -0.794437).  Saving model ...
Epoch: 13 cost time: 0.8597621917724609
Epoch: 13, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.785 Vali Acc: 0.767 Test Loss: 0.785 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8420121669769287
Epoch: 14, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.806 Vali Acc: 0.778 Test Loss: 0.806 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8264636993408203
Epoch: 15, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.823 Vali Acc: 0.772 Test Loss: 0.823 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.788384199142456
Epoch: 16, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.751 Vali Acc: 0.828 Test Loss: 0.751 Test Acc: 0.828
Validation loss decreased (-0.794437 --> -0.827770).  Saving model ...
Epoch: 17 cost time: 0.821826696395874
Epoch: 17, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.819 Vali Acc: 0.789 Test Loss: 0.819 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8847064971923828
Epoch: 18, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.837 Vali Acc: 0.778 Test Loss: 0.837 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7900328636169434
Epoch: 19, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.859 Vali Acc: 0.828 Test Loss: 0.859 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9339075088500977
Epoch: 20, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.790 Vali Acc: 0.817 Test Loss: 0.790 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8879797458648682
Epoch: 21, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.814 Vali Acc: 0.828 Test Loss: 0.814 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9142100811004639
Epoch: 22, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.798 Vali Acc: 0.850 Test Loss: 0.798 Test Acc: 0.850
Validation loss decreased (-0.827770 --> -0.849992).  Saving model ...
Epoch: 23 cost time: 0.8950469493865967
Epoch: 23, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.843 Vali Acc: 0.833 Test Loss: 0.843 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.908646821975708
Epoch: 24, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.853 Vali Acc: 0.822 Test Loss: 0.853 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.883852481842041
Epoch: 25, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.907 Vali Acc: 0.828 Test Loss: 0.907 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8466033935546875
Epoch: 26, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.919 Vali Acc: 0.833 Test Loss: 0.919 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8315591812133789
Epoch: 27, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.936 Vali Acc: 0.839 Test Loss: 0.936 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8781595230102539
Epoch: 28, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.927 Vali Acc: 0.839 Test Loss: 0.927 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9287354946136475
Epoch: 29, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.924 Vali Acc: 0.844 Test Loss: 0.924 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8043632507324219
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.918 Vali Acc: 0.850 Test Loss: 0.918 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8565185070037842
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.940 Vali Acc: 0.856 Test Loss: 0.940 Test Acc: 0.856
Validation loss decreased (-0.849992 --> -0.855546).  Saving model ...
Epoch: 32 cost time: 0.8851397037506104
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.949 Vali Acc: 0.856 Test Loss: 0.949 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.875281572341919
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.956 Vali Acc: 0.861 Test Loss: 0.956 Test Acc: 0.861
Validation loss decreased (-0.855546 --> -0.861102).  Saving model ...
Epoch: 34 cost time: 0.9156515598297119
Epoch: 34, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.974 Vali Acc: 0.861 Test Loss: 0.974 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9180047512054443
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.953 Vali Acc: 0.872 Test Loss: 0.953 Test Acc: 0.872
Validation loss decreased (-0.861102 --> -0.872213).  Saving model ...
Epoch: 36 cost time: 0.9441418647766113
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.968 Vali Acc: 0.861 Test Loss: 0.968 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9319560527801514
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.957 Vali Acc: 0.856 Test Loss: 0.957 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9017438888549805
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.007 Vali Acc: 0.850 Test Loss: 1.007 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8745191097259521
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.979 Vali Acc: 0.861 Test Loss: 0.979 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.865898609161377
Epoch: 40, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.000 Vali Acc: 0.861 Test Loss: 1.000 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8594229221343994
Epoch: 41, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.005 Vali Acc: 0.861 Test Loss: 1.005 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.8678233623504639
Epoch: 42, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.058 Vali Acc: 0.844 Test Loss: 1.058 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.8851556777954102
Epoch: 43, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.020 Vali Acc: 0.867 Test Loss: 1.020 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.8661799430847168
Epoch: 44, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.080 Vali Acc: 0.856 Test Loss: 1.080 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.8869106769561768
Epoch: 45, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.099 Vali Acc: 0.850 Test Loss: 1.099 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 283343
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.134958028793335
Epoch: 1, Steps: 12 | Train Loss: 2.669 Vali Loss: 2.656 Vali Acc: 0.061 Test Loss: 2.656 Test Acc: 0.061
Validation loss decreased (inf --> -0.061085).  Saving model ...
Epoch: 2 cost time: 0.8827757835388184
Epoch: 2, Steps: 12 | Train Loss: 2.519 Vali Loss: 2.499 Vali Acc: 0.328 Test Loss: 2.499 Test Acc: 0.328
Validation loss decreased (-0.061085 --> -0.327753).  Saving model ...
Epoch: 3 cost time: 0.8253331184387207
Epoch: 3, Steps: 12 | Train Loss: 2.291 Vali Loss: 2.246 Vali Acc: 0.439 Test Loss: 2.246 Test Acc: 0.439
Validation loss decreased (-0.327753 --> -0.438866).  Saving model ...
Epoch: 4 cost time: 0.9471008777618408
Epoch: 4, Steps: 12 | Train Loss: 1.973 Vali Loss: 1.949 Vali Acc: 0.544 Test Loss: 1.949 Test Acc: 0.544
Validation loss decreased (-0.438866 --> -0.544425).  Saving model ...
Epoch: 5 cost time: 0.852806806564331
Epoch: 5, Steps: 12 | Train Loss: 1.688 Vali Loss: 1.644 Vali Acc: 0.583 Test Loss: 1.644 Test Acc: 0.583
Validation loss decreased (-0.544425 --> -0.583317).  Saving model ...
Epoch: 6 cost time: 0.8971281051635742
Epoch: 6, Steps: 12 | Train Loss: 1.382 Vali Loss: 1.405 Vali Acc: 0.633 Test Loss: 1.405 Test Acc: 0.633
Validation loss decreased (-0.583317 --> -0.633319).  Saving model ...
Epoch: 7 cost time: 0.8823859691619873
Epoch: 7, Steps: 12 | Train Loss: 1.066 Vali Loss: 1.230 Vali Acc: 0.656 Test Loss: 1.230 Test Acc: 0.656
Validation loss decreased (-0.633319 --> -0.655543).  Saving model ...
Epoch: 8 cost time: 0.8877654075622559
Epoch: 8, Steps: 12 | Train Loss: 0.883 Vali Loss: 1.081 Vali Acc: 0.672 Test Loss: 1.081 Test Acc: 0.672
Validation loss decreased (-0.655543 --> -0.672211).  Saving model ...
Epoch: 9 cost time: 0.8981626033782959
Epoch: 9, Steps: 12 | Train Loss: 0.735 Vali Loss: 1.004 Vali Acc: 0.683 Test Loss: 1.004 Test Acc: 0.683
Validation loss decreased (-0.672211 --> -0.683323).  Saving model ...
Epoch: 10 cost time: 0.870703935623169
Epoch: 10, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.929 Vali Acc: 0.683 Test Loss: 0.929 Test Acc: 0.683
Validation loss decreased (-0.683323 --> -0.683324).  Saving model ...
Epoch: 11 cost time: 0.8799517154693604
Epoch: 11, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.872 Vali Acc: 0.706 Test Loss: 0.872 Test Acc: 0.706
Validation loss decreased (-0.683324 --> -0.705547).  Saving model ...
Epoch: 12 cost time: 0.9220185279846191
Epoch: 12, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.827 Vali Acc: 0.700 Test Loss: 0.827 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8664891719818115
Epoch: 13, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.781 Vali Acc: 0.750 Test Loss: 0.781 Test Acc: 0.750
Validation loss decreased (-0.705547 --> -0.749992).  Saving model ...
Epoch: 14 cost time: 0.8384115695953369
Epoch: 14, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.750 Vali Acc: 0.767 Test Loss: 0.750 Test Acc: 0.767
Validation loss decreased (-0.749992 --> -0.766659).  Saving model ...
Epoch: 15 cost time: 0.8872227668762207
Epoch: 15, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.723 Vali Acc: 0.800 Test Loss: 0.723 Test Acc: 0.800
Validation loss decreased (-0.766659 --> -0.799993).  Saving model ...
Epoch: 16 cost time: 0.831735372543335
Epoch: 16, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.682 Vali Acc: 0.794 Test Loss: 0.682 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8753108978271484
Epoch: 17, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.692 Vali Acc: 0.783 Test Loss: 0.692 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.836585521697998
Epoch: 18, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.675 Vali Acc: 0.822 Test Loss: 0.675 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822215).  Saving model ...
Epoch: 19 cost time: 0.8446614742279053
Epoch: 19, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.663 Vali Acc: 0.806 Test Loss: 0.663 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9027431011199951
Epoch: 20, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.689 Vali Acc: 0.811 Test Loss: 0.689 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8949587345123291
Epoch: 21, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.693 Vali Acc: 0.800 Test Loss: 0.693 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9294753074645996
Epoch: 22, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.693 Vali Acc: 0.839 Test Loss: 0.693 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838882).  Saving model ...
Epoch: 23 cost time: 0.9262146949768066
Epoch: 23, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.642 Vali Acc: 0.828 Test Loss: 0.642 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8570778369903564
Epoch: 24, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.648 Vali Acc: 0.856 Test Loss: 0.648 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855549).  Saving model ...
Epoch: 25 cost time: 0.8317897319793701
Epoch: 25, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.672 Vali Acc: 0.850 Test Loss: 0.672 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9118120670318604
Epoch: 26, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.734 Vali Acc: 0.850 Test Loss: 0.734 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8171572685241699
Epoch: 27, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.685 Vali Acc: 0.833 Test Loss: 0.685 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8444671630859375
Epoch: 28, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.683 Vali Acc: 0.856 Test Loss: 0.683 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8882901668548584
Epoch: 29, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.747 Vali Acc: 0.828 Test Loss: 0.747 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8917596340179443
Epoch: 30, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.731 Vali Acc: 0.828 Test Loss: 0.731 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8749082088470459
Epoch: 31, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.768 Vali Acc: 0.828 Test Loss: 0.768 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7904982566833496
Epoch: 32, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.790 Vali Acc: 0.844 Test Loss: 0.790 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9405636787414551
Epoch: 33, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.811 Vali Acc: 0.844 Test Loss: 0.811 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8832294940948486
Epoch: 34, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.818 Vali Acc: 0.844 Test Loss: 0.818 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 237327
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1499342918395996
Epoch: 1, Steps: 12 | Train Loss: 2.764 Vali Loss: 2.702 Vali Acc: 0.039 Test Loss: 2.702 Test Acc: 0.039
Validation loss decreased (inf --> -0.038862).  Saving model ...
Epoch: 2 cost time: 0.8280067443847656
Epoch: 2, Steps: 12 | Train Loss: 2.618 Vali Loss: 2.565 Vali Acc: 0.206 Test Loss: 2.565 Test Acc: 0.206
Validation loss decreased (-0.038862 --> -0.205530).  Saving model ...
Epoch: 3 cost time: 0.8679311275482178
Epoch: 3, Steps: 12 | Train Loss: 2.389 Vali Loss: 2.348 Vali Acc: 0.439 Test Loss: 2.348 Test Acc: 0.439
Validation loss decreased (-0.205530 --> -0.438865).  Saving model ...
Epoch: 4 cost time: 0.9098236560821533
Epoch: 4, Steps: 12 | Train Loss: 2.125 Vali Loss: 2.062 Vali Acc: 0.517 Test Loss: 2.062 Test Acc: 0.517
Validation loss decreased (-0.438865 --> -0.516646).  Saving model ...
Epoch: 5 cost time: 0.833204984664917
Epoch: 5, Steps: 12 | Train Loss: 1.768 Vali Loss: 1.737 Vali Acc: 0.561 Test Loss: 1.737 Test Acc: 0.561
Validation loss decreased (-0.516646 --> -0.561094).  Saving model ...
Epoch: 6 cost time: 0.8221423625946045
Epoch: 6, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.488 Vali Acc: 0.606 Test Loss: 1.488 Test Acc: 0.606
Validation loss decreased (-0.561094 --> -0.605541).  Saving model ...
Epoch: 7 cost time: 0.8655445575714111
Epoch: 7, Steps: 12 | Train Loss: 1.227 Vali Loss: 1.304 Vali Acc: 0.633 Test Loss: 1.304 Test Acc: 0.633
Validation loss decreased (-0.605541 --> -0.633320).  Saving model ...
Epoch: 8 cost time: 0.8372435569763184
Epoch: 8, Steps: 12 | Train Loss: 0.954 Vali Loss: 1.150 Vali Acc: 0.667 Test Loss: 1.150 Test Acc: 0.667
Validation loss decreased (-0.633320 --> -0.666655).  Saving model ...
Epoch: 9 cost time: 0.9097309112548828
Epoch: 9, Steps: 12 | Train Loss: 0.807 Vali Loss: 1.060 Vali Acc: 0.672 Test Loss: 1.060 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672212).  Saving model ...
Epoch: 10 cost time: 0.8131089210510254
Epoch: 10, Steps: 12 | Train Loss: 0.692 Vali Loss: 0.968 Vali Acc: 0.678 Test Loss: 0.968 Test Acc: 0.678
Validation loss decreased (-0.672212 --> -0.677768).  Saving model ...
Epoch: 11 cost time: 0.896672248840332
Epoch: 11, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.900 Vali Acc: 0.728 Test Loss: 0.900 Test Acc: 0.728
Validation loss decreased (-0.677768 --> -0.727769).  Saving model ...
Epoch: 12 cost time: 0.8248662948608398
Epoch: 12, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.865 Vali Acc: 0.739 Test Loss: 0.865 Test Acc: 0.739
Validation loss decreased (-0.727769 --> -0.738880).  Saving model ...
Epoch: 13 cost time: 0.8317358493804932
Epoch: 13, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.809 Vali Acc: 0.767 Test Loss: 0.809 Test Acc: 0.767
Validation loss decreased (-0.738880 --> -0.766659).  Saving model ...
Epoch: 14 cost time: 0.8296327590942383
Epoch: 14, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.772 Vali Acc: 0.783 Test Loss: 0.772 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783326).  Saving model ...
Epoch: 15 cost time: 0.8234255313873291
Epoch: 15, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.725 Vali Acc: 0.778 Test Loss: 0.725 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8431241512298584
Epoch: 16, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.659 Vali Acc: 0.811 Test Loss: 0.659 Test Acc: 0.811
Validation loss decreased (-0.783326 --> -0.811105).  Saving model ...
Epoch: 17 cost time: 0.8195481300354004
Epoch: 17, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.632 Vali Acc: 0.833 Test Loss: 0.632 Test Acc: 0.833
Validation loss decreased (-0.811105 --> -0.833327).  Saving model ...
Epoch: 18 cost time: 0.8235349655151367
Epoch: 18, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.673 Vali Acc: 0.822 Test Loss: 0.673 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8455245494842529
Epoch: 19, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.642 Vali Acc: 0.828 Test Loss: 0.642 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8973820209503174
Epoch: 20, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.637 Vali Acc: 0.844 Test Loss: 0.637 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 21 cost time: 0.8588111400604248
Epoch: 21, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.664 Vali Acc: 0.817 Test Loss: 0.664 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9143369197845459
Epoch: 22, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.636 Vali Acc: 0.850 Test Loss: 0.636 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 0.8767132759094238
Epoch: 23, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.644 Vali Acc: 0.839 Test Loss: 0.644 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.873236894607544
Epoch: 24, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.644 Vali Acc: 0.833 Test Loss: 0.644 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9700851440429688
Epoch: 25, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.673 Vali Acc: 0.839 Test Loss: 0.673 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8300244808197021
Epoch: 26, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.676 Vali Acc: 0.856 Test Loss: 0.676 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 27 cost time: 0.8934276103973389
Epoch: 27, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.682 Vali Acc: 0.850 Test Loss: 0.682 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8551721572875977
Epoch: 28, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.697 Vali Acc: 0.850 Test Loss: 0.697 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8257076740264893
Epoch: 29, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.721 Vali Acc: 0.861 Test Loss: 0.721 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861104).  Saving model ...
Epoch: 30 cost time: 0.8548457622528076
Epoch: 30, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.746 Vali Acc: 0.850 Test Loss: 0.746 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.883610725402832
Epoch: 31, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.714 Vali Acc: 0.844 Test Loss: 0.714 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9079651832580566
Epoch: 32, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.708 Vali Acc: 0.861 Test Loss: 0.708 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861104).  Saving model ...
Epoch: 33 cost time: 0.8831007480621338
Epoch: 33, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.767 Vali Acc: 0.861 Test Loss: 0.767 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9339499473571777
Epoch: 34, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.756 Vali Acc: 0.867 Test Loss: 0.756 Test Acc: 0.867
Validation loss decreased (-0.861104 --> -0.866659).  Saving model ...
Epoch: 35 cost time: 0.8790502548217773
Epoch: 35, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.731 Vali Acc: 0.861 Test Loss: 0.731 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8804059028625488
Epoch: 36, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.718 Vali Acc: 0.867 Test Loss: 0.718 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866659).  Saving model ...
Epoch: 37 cost time: 0.8659250736236572
Epoch: 37, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.723 Vali Acc: 0.878 Test Loss: 0.723 Test Acc: 0.878
Validation loss decreased (-0.866659 --> -0.877771).  Saving model ...
Epoch: 38 cost time: 0.8302536010742188
Epoch: 38, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.740 Vali Acc: 0.867 Test Loss: 0.740 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.878896951675415
Epoch: 39, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.763 Vali Acc: 0.867 Test Loss: 0.763 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8532121181488037
Epoch: 40, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.819 Vali Acc: 0.850 Test Loss: 0.819 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7790734767913818
Epoch: 41, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.843 Vali Acc: 0.856 Test Loss: 0.843 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.845142126083374
Epoch: 42, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.786 Vali Acc: 0.844 Test Loss: 0.786 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8445823192596436
Epoch: 43, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.779 Vali Acc: 0.872 Test Loss: 0.779 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8443870544433594
Epoch: 44, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.804 Vali Acc: 0.856 Test Loss: 0.804 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.8831162452697754
Epoch: 45, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.819 Vali Acc: 0.867 Test Loss: 0.819 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.8837409019470215
Epoch: 46, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.801 Vali Acc: 0.867 Test Loss: 0.801 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.9067525863647461
Epoch: 47, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.801 Vali Acc: 0.856 Test Loss: 0.801 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 237391
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.165128707885742
Epoch: 1, Steps: 12 | Train Loss: 2.706 Vali Loss: 2.673 Vali Acc: 0.106 Test Loss: 2.673 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 0.8667314052581787
Epoch: 2, Steps: 12 | Train Loss: 2.593 Vali Loss: 2.556 Vali Acc: 0.189 Test Loss: 2.556 Test Acc: 0.189
Validation loss decreased (-0.105529 --> -0.188863).  Saving model ...
Epoch: 3 cost time: 0.8743953704833984
Epoch: 3, Steps: 12 | Train Loss: 2.422 Vali Loss: 2.381 Vali Acc: 0.411 Test Loss: 2.381 Test Acc: 0.411
Validation loss decreased (-0.188863 --> -0.411087).  Saving model ...
Epoch: 4 cost time: 0.8859565258026123
Epoch: 4, Steps: 12 | Train Loss: 2.200 Vali Loss: 2.128 Vali Acc: 0.528 Test Loss: 2.128 Test Acc: 0.528
Validation loss decreased (-0.411087 --> -0.527756).  Saving model ...
Epoch: 5 cost time: 0.7751221656799316
Epoch: 5, Steps: 12 | Train Loss: 1.944 Vali Loss: 1.869 Vali Acc: 0.572 Test Loss: 1.869 Test Acc: 0.572
Validation loss decreased (-0.527756 --> -0.572204).  Saving model ...
Epoch: 6 cost time: 0.869053840637207
Epoch: 6, Steps: 12 | Train Loss: 1.622 Vali Loss: 1.615 Vali Acc: 0.594 Test Loss: 1.615 Test Acc: 0.594
Validation loss decreased (-0.572204 --> -0.594428).  Saving model ...
Epoch: 7 cost time: 0.8297350406646729
Epoch: 7, Steps: 12 | Train Loss: 1.348 Vali Loss: 1.392 Vali Acc: 0.650 Test Loss: 1.392 Test Acc: 0.650
Validation loss decreased (-0.594428 --> -0.649986).  Saving model ...
Epoch: 8 cost time: 0.7627847194671631
Epoch: 8, Steps: 12 | Train Loss: 1.169 Vali Loss: 1.202 Vali Acc: 0.672 Test Loss: 1.202 Test Acc: 0.672
Validation loss decreased (-0.649986 --> -0.672210).  Saving model ...
Epoch: 9 cost time: 0.8632607460021973
Epoch: 9, Steps: 12 | Train Loss: 0.974 Vali Loss: 1.089 Vali Acc: 0.711 Test Loss: 1.089 Test Acc: 0.711
Validation loss decreased (-0.672210 --> -0.711100).  Saving model ...
Epoch: 10 cost time: 0.8161015510559082
Epoch: 10, Steps: 12 | Train Loss: 0.758 Vali Loss: 0.996 Vali Acc: 0.700 Test Loss: 0.996 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7834584712982178
Epoch: 11, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.931 Vali Acc: 0.722 Test Loss: 0.931 Test Acc: 0.722
Validation loss decreased (-0.711100 --> -0.722213).  Saving model ...
Epoch: 12 cost time: 0.801558256149292
Epoch: 12, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.841 Vali Acc: 0.728 Test Loss: 0.841 Test Acc: 0.728
Validation loss decreased (-0.722213 --> -0.727769).  Saving model ...
Epoch: 13 cost time: 0.895698070526123
Epoch: 13, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.820 Vali Acc: 0.750 Test Loss: 0.820 Test Acc: 0.750
Validation loss decreased (-0.727769 --> -0.749992).  Saving model ...
Epoch: 14 cost time: 0.9242205619812012
Epoch: 14, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.778 Vali Acc: 0.756 Test Loss: 0.778 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755548).  Saving model ...
Epoch: 15 cost time: 0.8686568737030029
Epoch: 15, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.705 Vali Acc: 0.789 Test Loss: 0.705 Test Acc: 0.789
Validation loss decreased (-0.755548 --> -0.788882).  Saving model ...
Epoch: 16 cost time: 0.9144387245178223
Epoch: 16, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.679 Vali Acc: 0.817 Test Loss: 0.679 Test Acc: 0.817
Validation loss decreased (-0.788882 --> -0.816660).  Saving model ...
Epoch: 17 cost time: 0.8654086589813232
Epoch: 17, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.643 Vali Acc: 0.822 Test Loss: 0.643 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 18 cost time: 0.9535024166107178
Epoch: 18, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.622 Vali Acc: 0.833 Test Loss: 0.622 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 19 cost time: 0.8735783100128174
Epoch: 19, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.618 Vali Acc: 0.856 Test Loss: 0.618 Test Acc: 0.856
Validation loss decreased (-0.833327 --> -0.855549).  Saving model ...
Epoch: 20 cost time: 0.9004545211791992
Epoch: 20, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.598 Vali Acc: 0.856 Test Loss: 0.598 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855550).  Saving model ...
Epoch: 21 cost time: 0.8614315986633301
Epoch: 21, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.634 Vali Acc: 0.850 Test Loss: 0.634 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7809717655181885
Epoch: 22, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8478970527648926
Epoch: 23, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.607 Vali Acc: 0.844 Test Loss: 0.607 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8253343105316162
Epoch: 24, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.638 Vali Acc: 0.872 Test Loss: 0.638 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872216).  Saving model ...
Epoch: 25 cost time: 0.9144241809844971
Epoch: 25, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.642 Vali Acc: 0.856 Test Loss: 0.642 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8696689605712891
Epoch: 26, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.641 Vali Acc: 0.872 Test Loss: 0.641 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9079911708831787
Epoch: 27, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.646 Vali Acc: 0.861 Test Loss: 0.646 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8821032047271729
Epoch: 28, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.653 Vali Acc: 0.867 Test Loss: 0.653 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.88602614402771
Epoch: 29, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.651 Vali Acc: 0.872 Test Loss: 0.651 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9097092151641846
Epoch: 30, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.672 Vali Acc: 0.856 Test Loss: 0.672 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.89308762550354
Epoch: 31, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.713 Vali Acc: 0.856 Test Loss: 0.713 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8538811206817627
Epoch: 32, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.705 Vali Acc: 0.867 Test Loss: 0.705 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.852266788482666
Epoch: 33, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.717 Vali Acc: 0.872 Test Loss: 0.717 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8701281547546387
Epoch: 34, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.730 Vali Acc: 0.867 Test Loss: 0.730 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 225935
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.382216453552246
Epoch: 1, Steps: 12 | Train Loss: 2.727 Vali Loss: 2.720 Vali Acc: 0.172 Test Loss: 2.720 Test Acc: 0.172
Validation loss decreased (inf --> -0.172195).  Saving model ...
Epoch: 2 cost time: 0.896125078201294
Epoch: 2, Steps: 12 | Train Loss: 2.608 Vali Loss: 2.627 Vali Acc: 0.278 Test Loss: 2.627 Test Acc: 0.278
Validation loss decreased (-0.172195 --> -0.277752).  Saving model ...
Epoch: 3 cost time: 0.9188666343688965
Epoch: 3, Steps: 12 | Train Loss: 2.457 Vali Loss: 2.473 Vali Acc: 0.439 Test Loss: 2.473 Test Acc: 0.439
Validation loss decreased (-0.277752 --> -0.438864).  Saving model ...
Epoch: 4 cost time: 0.8804349899291992
Epoch: 4, Steps: 12 | Train Loss: 2.245 Vali Loss: 2.262 Vali Acc: 0.461 Test Loss: 2.262 Test Acc: 0.461
Validation loss decreased (-0.438864 --> -0.461088).  Saving model ...
Epoch: 5 cost time: 0.8521890640258789
Epoch: 5, Steps: 12 | Train Loss: 2.038 Vali Loss: 2.028 Vali Acc: 0.528 Test Loss: 2.028 Test Acc: 0.528
Validation loss decreased (-0.461088 --> -0.527757).  Saving model ...
Epoch: 6 cost time: 0.8357987403869629
Epoch: 6, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.798 Vali Acc: 0.567 Test Loss: 1.798 Test Acc: 0.567
Validation loss decreased (-0.527757 --> -0.566649).  Saving model ...
Epoch: 7 cost time: 0.8671538829803467
Epoch: 7, Steps: 12 | Train Loss: 1.472 Vali Loss: 1.569 Vali Acc: 0.628 Test Loss: 1.569 Test Acc: 0.628
Validation loss decreased (-0.566649 --> -0.627762).  Saving model ...
Epoch: 8 cost time: 0.877295732498169
Epoch: 8, Steps: 12 | Train Loss: 1.245 Vali Loss: 1.387 Vali Acc: 0.656 Test Loss: 1.387 Test Acc: 0.656
Validation loss decreased (-0.627762 --> -0.655542).  Saving model ...
Epoch: 9 cost time: 0.8559224605560303
Epoch: 9, Steps: 12 | Train Loss: 1.063 Vali Loss: 1.224 Vali Acc: 0.700 Test Loss: 1.224 Test Acc: 0.700
Validation loss decreased (-0.655542 --> -0.699988).  Saving model ...
Epoch: 10 cost time: 0.8333165645599365
Epoch: 10, Steps: 12 | Train Loss: 0.883 Vali Loss: 1.096 Vali Acc: 0.700 Test Loss: 1.096 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699989).  Saving model ...
Epoch: 11 cost time: 0.8579645156860352
Epoch: 11, Steps: 12 | Train Loss: 0.807 Vali Loss: 0.991 Vali Acc: 0.722 Test Loss: 0.991 Test Acc: 0.722
Validation loss decreased (-0.699989 --> -0.722212).  Saving model ...
Epoch: 12 cost time: 0.8760395050048828
Epoch: 12, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.919 Vali Acc: 0.739 Test Loss: 0.919 Test Acc: 0.739
Validation loss decreased (-0.722212 --> -0.738880).  Saving model ...
Epoch: 13 cost time: 0.8831431865692139
Epoch: 13, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.849 Vali Acc: 0.756 Test Loss: 0.849 Test Acc: 0.756
Validation loss decreased (-0.738880 --> -0.755547).  Saving model ...
Epoch: 14 cost time: 0.8682410717010498
Epoch: 14, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.794 Vali Acc: 0.778 Test Loss: 0.794 Test Acc: 0.778
Validation loss decreased (-0.755547 --> -0.777770).  Saving model ...
Epoch: 15 cost time: 0.9433839321136475
Epoch: 15, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.771 Vali Acc: 0.789 Test Loss: 0.771 Test Acc: 0.789
Validation loss decreased (-0.777770 --> -0.788881).  Saving model ...
Epoch: 16 cost time: 0.823798418045044
Epoch: 16, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.694 Vali Acc: 0.811 Test Loss: 0.694 Test Acc: 0.811
Validation loss decreased (-0.788881 --> -0.811104).  Saving model ...
Epoch: 17 cost time: 0.962653398513794
Epoch: 17, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.666 Vali Acc: 0.811 Test Loss: 0.666 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 18 cost time: 0.84212327003479
Epoch: 18, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.631 Vali Acc: 0.822 Test Loss: 0.631 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822216).  Saving model ...
Epoch: 19 cost time: 0.876657247543335
Epoch: 19, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
Validation loss decreased (-0.822216 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 0.876476526260376
Epoch: 20, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.630 Vali Acc: 0.828 Test Loss: 0.630 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8935554027557373
Epoch: 21, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9139087200164795
Epoch: 22, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.579 Vali Acc: 0.867 Test Loss: 0.579 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866661).  Saving model ...
Epoch: 23 cost time: 0.884537935256958
Epoch: 23, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.557 Vali Acc: 0.872 Test Loss: 0.557 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 24 cost time: 0.8584330081939697
Epoch: 24, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.580 Vali Acc: 0.828 Test Loss: 0.580 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9263451099395752
Epoch: 25, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.606 Vali Acc: 0.844 Test Loss: 0.606 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8862934112548828
Epoch: 26, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.593 Vali Acc: 0.867 Test Loss: 0.593 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8923211097717285
Epoch: 27, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.600 Vali Acc: 0.856 Test Loss: 0.600 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.854877233505249
Epoch: 28, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.93839430809021
Epoch: 29, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.612 Vali Acc: 0.867 Test Loss: 0.612 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8125190734863281
Epoch: 30, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.605 Vali Acc: 0.878 Test Loss: 0.605 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 31 cost time: 0.8990333080291748
Epoch: 31, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.616 Vali Acc: 0.861 Test Loss: 0.616 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9425997734069824
Epoch: 32, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.620 Vali Acc: 0.878 Test Loss: 0.620 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8596251010894775
Epoch: 33, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.615 Vali Acc: 0.889 Test Loss: 0.615 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888883).  Saving model ...
Epoch: 34 cost time: 0.8375401496887207
Epoch: 34, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.639 Vali Acc: 0.872 Test Loss: 0.639 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9050452709197998
Epoch: 35, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.649 Vali Acc: 0.878 Test Loss: 0.649 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8801336288452148
Epoch: 36, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.656 Vali Acc: 0.883 Test Loss: 0.656 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8836870193481445
Epoch: 37, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.679 Vali Acc: 0.883 Test Loss: 0.679 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8896324634552002
Epoch: 38, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.651 Vali Acc: 0.872 Test Loss: 0.651 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.899395227432251
Epoch: 39, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.664 Vali Acc: 0.872 Test Loss: 0.664 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.8736486434936523
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.713 Vali Acc: 0.883 Test Loss: 0.713 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.9306061267852783
Epoch: 41, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.729 Vali Acc: 0.878 Test Loss: 0.729 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.9370856285095215
Epoch: 42, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.687 Vali Acc: 0.867 Test Loss: 0.687 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.9283483028411865
Epoch: 43, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.684 Vali Acc: 0.878 Test Loss: 0.684 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 218383
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.164825916290283
Epoch: 1, Steps: 12 | Train Loss: 2.702 Vali Loss: 2.669 Vali Acc: 0.061 Test Loss: 2.669 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 0.8725175857543945
Epoch: 2, Steps: 12 | Train Loss: 2.616 Vali Loss: 2.585 Vali Acc: 0.206 Test Loss: 2.585 Test Acc: 0.206
Validation loss decreased (-0.061084 --> -0.205530).  Saving model ...
Epoch: 3 cost time: 0.8334226608276367
Epoch: 3, Steps: 12 | Train Loss: 2.485 Vali Loss: 2.450 Vali Acc: 0.383 Test Loss: 2.450 Test Acc: 0.383
Validation loss decreased (-0.205530 --> -0.383309).  Saving model ...
Epoch: 4 cost time: 0.8881196975708008
Epoch: 4, Steps: 12 | Train Loss: 2.300 Vali Loss: 2.268 Vali Acc: 0.478 Test Loss: 2.268 Test Acc: 0.478
Validation loss decreased (-0.383309 --> -0.477755).  Saving model ...
Epoch: 5 cost time: 0.9332191944122314
Epoch: 5, Steps: 12 | Train Loss: 2.091 Vali Loss: 2.055 Vali Acc: 0.550 Test Loss: 2.055 Test Acc: 0.550
Validation loss decreased (-0.477755 --> -0.549979).  Saving model ...
Epoch: 6 cost time: 0.8036520481109619
Epoch: 6, Steps: 12 | Train Loss: 1.843 Vali Loss: 1.843 Vali Acc: 0.572 Test Loss: 1.843 Test Acc: 0.572
Validation loss decreased (-0.549979 --> -0.572204).  Saving model ...
Epoch: 7 cost time: 0.8515193462371826
Epoch: 7, Steps: 12 | Train Loss: 1.578 Vali Loss: 1.615 Vali Acc: 0.600 Test Loss: 1.615 Test Acc: 0.600
Validation loss decreased (-0.572204 --> -0.599984).  Saving model ...
Epoch: 8 cost time: 0.8088521957397461
Epoch: 8, Steps: 12 | Train Loss: 1.368 Vali Loss: 1.431 Vali Acc: 0.628 Test Loss: 1.431 Test Acc: 0.628
Validation loss decreased (-0.599984 --> -0.627763).  Saving model ...
Epoch: 9 cost time: 0.8655316829681396
Epoch: 9, Steps: 12 | Train Loss: 1.152 Vali Loss: 1.254 Vali Acc: 0.661 Test Loss: 1.254 Test Acc: 0.661
Validation loss decreased (-0.627763 --> -0.661099).  Saving model ...
Epoch: 10 cost time: 0.9642069339752197
Epoch: 10, Steps: 12 | Train Loss: 0.952 Vali Loss: 1.140 Vali Acc: 0.683 Test Loss: 1.140 Test Acc: 0.683
Validation loss decreased (-0.661099 --> -0.683322).  Saving model ...
Epoch: 11 cost time: 0.8395226001739502
Epoch: 11, Steps: 12 | Train Loss: 0.936 Vali Loss: 1.038 Vali Acc: 0.678 Test Loss: 1.038 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8503062725067139
Epoch: 12, Steps: 12 | Train Loss: 0.718 Vali Loss: 0.957 Vali Acc: 0.711 Test Loss: 0.957 Test Acc: 0.711
Validation loss decreased (-0.683322 --> -0.711102).  Saving model ...
Epoch: 13 cost time: 0.8882720470428467
Epoch: 13, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.904 Vali Acc: 0.733 Test Loss: 0.904 Test Acc: 0.733
Validation loss decreased (-0.711102 --> -0.733324).  Saving model ...
Epoch: 14 cost time: 0.9161925315856934
Epoch: 14, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.852 Vali Acc: 0.733 Test Loss: 0.852 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733325).  Saving model ...
Epoch: 15 cost time: 0.9204516410827637
Epoch: 15, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.801 Vali Acc: 0.761 Test Loss: 0.801 Test Acc: 0.761
Validation loss decreased (-0.733325 --> -0.761103).  Saving model ...
Epoch: 16 cost time: 0.8448853492736816
Epoch: 16, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.754 Vali Acc: 0.772 Test Loss: 0.754 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772215).  Saving model ...
Epoch: 17 cost time: 0.9053454399108887
Epoch: 17, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.722 Vali Acc: 0.794 Test Loss: 0.722 Test Acc: 0.794
Validation loss decreased (-0.772215 --> -0.794437).  Saving model ...
Epoch: 18 cost time: 0.9160060882568359
Epoch: 18, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.687 Vali Acc: 0.800 Test Loss: 0.687 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 0.8502147197723389
Epoch: 19, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.640 Vali Acc: 0.839 Test Loss: 0.640 Test Acc: 0.839
Validation loss decreased (-0.799993 --> -0.838882).  Saving model ...
Epoch: 20 cost time: 0.8310315608978271
Epoch: 20, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.619 Vali Acc: 0.833 Test Loss: 0.619 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8887600898742676
Epoch: 21, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.598 Vali Acc: 0.828 Test Loss: 0.598 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8662307262420654
Epoch: 22, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 0.8123507499694824
Epoch: 23, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.580 Vali Acc: 0.844 Test Loss: 0.580 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8886616230010986
Epoch: 24, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.561 Vali Acc: 0.861 Test Loss: 0.561 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 25 cost time: 0.7999646663665771
Epoch: 25, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9341244697570801
Epoch: 26, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.558 Vali Acc: 0.839 Test Loss: 0.558 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8942396640777588
Epoch: 27, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.563 Vali Acc: 0.856 Test Loss: 0.563 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8694329261779785
Epoch: 28, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.570 Vali Acc: 0.856 Test Loss: 0.570 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9224808216094971
Epoch: 29, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.586 Vali Acc: 0.878 Test Loss: 0.586 Test Acc: 0.878
Validation loss decreased (-0.861105 --> -0.877772).  Saving model ...
Epoch: 30 cost time: 0.8406951427459717
Epoch: 30, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.567 Vali Acc: 0.844 Test Loss: 0.567 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8189480304718018
Epoch: 31, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.582 Vali Acc: 0.861 Test Loss: 0.582 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8735427856445312
Epoch: 32, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.583 Vali Acc: 0.867 Test Loss: 0.583 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8283088207244873
Epoch: 33, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.592 Vali Acc: 0.861 Test Loss: 0.592 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7712759971618652
Epoch: 34, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.621 Vali Acc: 0.856 Test Loss: 0.621 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8165628910064697
Epoch: 35, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.600 Vali Acc: 0.861 Test Loss: 0.600 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7975649833679199
Epoch: 36, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.598 Vali Acc: 0.844 Test Loss: 0.598 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8206570148468018
Epoch: 37, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.610 Vali Acc: 0.850 Test Loss: 0.610 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8859174251556396
Epoch: 38, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.634 Vali Acc: 0.867 Test Loss: 0.634 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.8787651062011719
Epoch: 39, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.613 Vali Acc: 0.878 Test Loss: 0.613 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 214671
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1649856567382812
Epoch: 1, Steps: 12 | Train Loss: 2.700 Vali Loss: 2.670 Vali Acc: 0.156 Test Loss: 2.670 Test Acc: 0.156
Validation loss decreased (inf --> -0.155529).  Saving model ...
Epoch: 2 cost time: 0.8216977119445801
Epoch: 2, Steps: 12 | Train Loss: 2.626 Vali Loss: 2.584 Vali Acc: 0.228 Test Loss: 2.584 Test Acc: 0.228
Validation loss decreased (-0.155529 --> -0.227752).  Saving model ...
Epoch: 3 cost time: 0.8284218311309814
Epoch: 3, Steps: 12 | Train Loss: 2.468 Vali Loss: 2.448 Vali Acc: 0.356 Test Loss: 2.448 Test Acc: 0.356
Validation loss decreased (-0.227752 --> -0.355531).  Saving model ...
Epoch: 4 cost time: 0.8333654403686523
Epoch: 4, Steps: 12 | Train Loss: 2.324 Vali Loss: 2.282 Vali Acc: 0.439 Test Loss: 2.282 Test Acc: 0.439
Validation loss decreased (-0.355531 --> -0.438866).  Saving model ...
Epoch: 5 cost time: 0.8435585498809814
Epoch: 5, Steps: 12 | Train Loss: 2.135 Vali Loss: 2.094 Vali Acc: 0.506 Test Loss: 2.094 Test Acc: 0.506
Validation loss decreased (-0.438866 --> -0.505535).  Saving model ...
Epoch: 6 cost time: 0.832719087600708
Epoch: 6, Steps: 12 | Train Loss: 1.895 Vali Loss: 1.899 Vali Acc: 0.539 Test Loss: 1.899 Test Acc: 0.539
Validation loss decreased (-0.505535 --> -0.538870).  Saving model ...
Epoch: 7 cost time: 0.8712797164916992
Epoch: 7, Steps: 12 | Train Loss: 1.689 Vali Loss: 1.714 Vali Acc: 0.589 Test Loss: 1.714 Test Acc: 0.589
Validation loss decreased (-0.538870 --> -0.588872).  Saving model ...
Epoch: 8 cost time: 0.8625936508178711
Epoch: 8, Steps: 12 | Train Loss: 1.492 Vali Loss: 1.529 Vali Acc: 0.639 Test Loss: 1.529 Test Acc: 0.639
Validation loss decreased (-0.588872 --> -0.638874).  Saving model ...
Epoch: 9 cost time: 0.8887307643890381
Epoch: 9, Steps: 12 | Train Loss: 1.285 Vali Loss: 1.329 Vali Acc: 0.661 Test Loss: 1.329 Test Acc: 0.661
Validation loss decreased (-0.638874 --> -0.661098).  Saving model ...
Epoch: 10 cost time: 0.8696517944335938
Epoch: 10, Steps: 12 | Train Loss: 1.071 Vali Loss: 1.203 Vali Acc: 0.706 Test Loss: 1.203 Test Acc: 0.706
Validation loss decreased (-0.661098 --> -0.705544).  Saving model ...
Epoch: 11 cost time: 0.8984053134918213
Epoch: 11, Steps: 12 | Train Loss: 0.957 Vali Loss: 1.063 Vali Acc: 0.722 Test Loss: 1.063 Test Acc: 0.722
Validation loss decreased (-0.705544 --> -0.722212).  Saving model ...
Epoch: 12 cost time: 0.8400030136108398
Epoch: 12, Steps: 12 | Train Loss: 0.804 Vali Loss: 0.964 Vali Acc: 0.750 Test Loss: 0.964 Test Acc: 0.750
Validation loss decreased (-0.722212 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 0.86513352394104
Epoch: 13, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.878 Vali Acc: 0.756 Test Loss: 0.878 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755547).  Saving model ...
Epoch: 14 cost time: 0.8189072608947754
Epoch: 14, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.822 Vali Acc: 0.778 Test Loss: 0.822 Test Acc: 0.778
Validation loss decreased (-0.755547 --> -0.777770).  Saving model ...
Epoch: 15 cost time: 0.7858438491821289
Epoch: 15, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.759 Vali Acc: 0.789 Test Loss: 0.759 Test Acc: 0.789
Validation loss decreased (-0.777770 --> -0.788881).  Saving model ...
Epoch: 16 cost time: 0.8036282062530518
Epoch: 16, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.712 Vali Acc: 0.806 Test Loss: 0.712 Test Acc: 0.806
Validation loss decreased (-0.788881 --> -0.805548).  Saving model ...
Epoch: 17 cost time: 0.768718957901001
Epoch: 17, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.669 Vali Acc: 0.817 Test Loss: 0.669 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816660).  Saving model ...
Epoch: 18 cost time: 0.8557755947113037
Epoch: 18, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.625 Vali Acc: 0.822 Test Loss: 0.625 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 19 cost time: 0.8259081840515137
Epoch: 19, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.593 Vali Acc: 0.828 Test Loss: 0.593 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 20 cost time: 0.8749616146087646
Epoch: 20, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.601 Vali Acc: 0.844 Test Loss: 0.601 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844438).  Saving model ...
Epoch: 21 cost time: 0.847714900970459
Epoch: 21, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.583 Vali Acc: 0.828 Test Loss: 0.583 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8566880226135254
Epoch: 22, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8179824352264404
Epoch: 23, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.559 Vali Acc: 0.839 Test Loss: 0.559 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8380632400512695
Epoch: 24, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855550).  Saving model ...
Epoch: 25 cost time: 0.9012069702148438
Epoch: 25, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.524 Vali Acc: 0.839 Test Loss: 0.524 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.888505220413208
Epoch: 26, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8785848617553711
Epoch: 27, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.537 Vali Acc: 0.850 Test Loss: 0.537 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7667758464813232
Epoch: 28, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.85086989402771
Epoch: 29, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8312976360321045
Epoch: 30, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.544 Vali Acc: 0.861 Test Loss: 0.544 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 31 cost time: 0.8264920711517334
Epoch: 31, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8521096706390381
Epoch: 32, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.515 Vali Acc: 0.856 Test Loss: 0.515 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8645064830780029
Epoch: 33, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.530 Vali Acc: 0.861 Test Loss: 0.530 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 34 cost time: 0.8686466217041016
Epoch: 34, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.510 Vali Acc: 0.861 Test Loss: 0.510 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 35 cost time: 0.8324759006500244
Epoch: 35, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.527 Vali Acc: 0.867 Test Loss: 0.527 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 36 cost time: 0.8364148139953613
Epoch: 36, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.557 Vali Acc: 0.872 Test Loss: 0.557 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 37 cost time: 0.9678440093994141
Epoch: 37, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.549 Vali Acc: 0.861 Test Loss: 0.549 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9214878082275391
Epoch: 38, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.533 Vali Acc: 0.856 Test Loss: 0.533 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8664388656616211
Epoch: 39, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.536 Vali Acc: 0.856 Test Loss: 0.536 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8472774028778076
Epoch: 40, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.555 Vali Acc: 0.861 Test Loss: 0.555 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.846543550491333
Epoch: 41, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.545 Vali Acc: 0.867 Test Loss: 0.545 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.84967041015625
Epoch: 42, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.568 Vali Acc: 0.872 Test Loss: 0.568 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.853473424911499
Epoch: 43, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.583 Vali Acc: 0.867 Test Loss: 0.583 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8127148151397705
Epoch: 44, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.584 Vali Acc: 0.867 Test Loss: 0.584 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8245165348052979
Epoch: 45, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.568 Vali Acc: 0.872 Test Loss: 0.568 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.8609344959259033
Epoch: 46, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.568 Vali Acc: 0.878 Test Loss: 0.568 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 47 cost time: 0.8661422729492188
Epoch: 47, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.567 Vali Acc: 0.883 Test Loss: 0.567 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 48 cost time: 0.9089634418487549
Epoch: 48, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.569 Vali Acc: 0.889 Test Loss: 0.569 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 49 cost time: 0.8325574398040771
Epoch: 49, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.601 Vali Acc: 0.883 Test Loss: 0.601 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8652479648590088
Epoch: 50, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.594 Vali Acc: 0.867 Test Loss: 0.594 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 211023
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0410776138305664
Epoch: 1, Steps: 12 | Train Loss: 2.646 Vali Loss: 2.594 Vali Acc: 0.200 Test Loss: 2.594 Test Acc: 0.200
Validation loss decreased (inf --> -0.199974).  Saving model ...
Epoch: 2 cost time: 0.768866777420044
Epoch: 2, Steps: 12 | Train Loss: 2.518 Vali Loss: 2.469 Vali Acc: 0.294 Test Loss: 2.469 Test Acc: 0.294
Validation loss decreased (-0.199974 --> -0.294420).  Saving model ...
Epoch: 3 cost time: 0.7731873989105225
Epoch: 3, Steps: 12 | Train Loss: 2.342 Vali Loss: 2.279 Vali Acc: 0.433 Test Loss: 2.279 Test Acc: 0.433
Validation loss decreased (-0.294420 --> -0.433311).  Saving model ...
Epoch: 4 cost time: 0.7606031894683838
Epoch: 4, Steps: 12 | Train Loss: 2.093 Vali Loss: 2.017 Vali Acc: 0.550 Test Loss: 2.017 Test Acc: 0.550
Validation loss decreased (-0.433311 --> -0.549980).  Saving model ...
Epoch: 5 cost time: 0.7658090591430664
Epoch: 5, Steps: 12 | Train Loss: 1.749 Vali Loss: 1.746 Vali Acc: 0.606 Test Loss: 1.746 Test Acc: 0.606
Validation loss decreased (-0.549980 --> -0.605538).  Saving model ...
Epoch: 6 cost time: 0.766981840133667
Epoch: 6, Steps: 12 | Train Loss: 1.524 Vali Loss: 1.519 Vali Acc: 0.622 Test Loss: 1.519 Test Acc: 0.622
Validation loss decreased (-0.605538 --> -0.622207).  Saving model ...
Epoch: 7 cost time: 0.7999286651611328
Epoch: 7, Steps: 12 | Train Loss: 1.254 Vali Loss: 1.311 Vali Acc: 0.639 Test Loss: 1.311 Test Acc: 0.639
Validation loss decreased (-0.622207 --> -0.638876).  Saving model ...
Epoch: 8 cost time: 0.7092421054840088
Epoch: 8, Steps: 12 | Train Loss: 1.065 Vali Loss: 1.165 Vali Acc: 0.656 Test Loss: 1.165 Test Acc: 0.656
Validation loss decreased (-0.638876 --> -0.655544).  Saving model ...
Epoch: 9 cost time: 0.7561790943145752
Epoch: 9, Steps: 12 | Train Loss: 0.845 Vali Loss: 1.094 Vali Acc: 0.672 Test Loss: 1.094 Test Acc: 0.672
Validation loss decreased (-0.655544 --> -0.672211).  Saving model ...
Epoch: 10 cost time: 0.7896740436553955
Epoch: 10, Steps: 12 | Train Loss: 0.767 Vali Loss: 0.996 Vali Acc: 0.667 Test Loss: 0.996 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7114434242248535
Epoch: 11, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.946 Vali Acc: 0.689 Test Loss: 0.946 Test Acc: 0.689
Validation loss decreased (-0.672211 --> -0.688879).  Saving model ...
Epoch: 12 cost time: 0.7445816993713379
Epoch: 12, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.915 Vali Acc: 0.706 Test Loss: 0.915 Test Acc: 0.706
Validation loss decreased (-0.688879 --> -0.705546).  Saving model ...
Epoch: 13 cost time: 0.7779998779296875
Epoch: 13, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.893 Vali Acc: 0.711 Test Loss: 0.893 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711102).  Saving model ...
Epoch: 14 cost time: 0.7517659664154053
Epoch: 14, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.829 Vali Acc: 0.722 Test Loss: 0.829 Test Acc: 0.722
Validation loss decreased (-0.711102 --> -0.722214).  Saving model ...
Epoch: 15 cost time: 0.7638294696807861
Epoch: 15, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.819 Vali Acc: 0.761 Test Loss: 0.819 Test Acc: 0.761
Validation loss decreased (-0.722214 --> -0.761103).  Saving model ...
Epoch: 16 cost time: 0.7987124919891357
Epoch: 16, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.808 Vali Acc: 0.783 Test Loss: 0.808 Test Acc: 0.783
Validation loss decreased (-0.761103 --> -0.783325).  Saving model ...
Epoch: 17 cost time: 0.7725944519042969
Epoch: 17, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.825 Vali Acc: 0.750 Test Loss: 0.825 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8232998847961426
Epoch: 18, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.795 Vali Acc: 0.778 Test Loss: 0.795 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7786636352539062
Epoch: 19, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.767 Vali Acc: 0.800 Test Loss: 0.767 Test Acc: 0.800
Validation loss decreased (-0.783325 --> -0.799992).  Saving model ...
Epoch: 20 cost time: 0.7917828559875488
Epoch: 20, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.762 Vali Acc: 0.806 Test Loss: 0.762 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805548).  Saving model ...
Epoch: 21 cost time: 0.7408807277679443
Epoch: 21, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.748 Vali Acc: 0.806 Test Loss: 0.748 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805548).  Saving model ...
Epoch: 22 cost time: 0.7436866760253906
Epoch: 22, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.812 Vali Acc: 0.822 Test Loss: 0.812 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822214).  Saving model ...
Epoch: 23 cost time: 0.7468359470367432
Epoch: 23, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.770 Vali Acc: 0.817 Test Loss: 0.770 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7979347705841064
Epoch: 24, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.785 Vali Acc: 0.817 Test Loss: 0.785 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8438990116119385
Epoch: 25, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.775 Vali Acc: 0.839 Test Loss: 0.775 Test Acc: 0.839
Validation loss decreased (-0.822214 --> -0.838881).  Saving model ...
Epoch: 26 cost time: 0.7790629863739014
Epoch: 26, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.789 Vali Acc: 0.817 Test Loss: 0.789 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7983255386352539
Epoch: 27, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.798 Vali Acc: 0.811 Test Loss: 0.798 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7880046367645264
Epoch: 28, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.765 Vali Acc: 0.828 Test Loss: 0.765 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8285796642303467
Epoch: 29, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.787 Vali Acc: 0.833 Test Loss: 0.787 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7981524467468262
Epoch: 30, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.826 Vali Acc: 0.844 Test Loss: 0.826 Test Acc: 0.844
Validation loss decreased (-0.838881 --> -0.844436).  Saving model ...
Epoch: 31 cost time: 0.8606488704681396
Epoch: 31, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.815 Vali Acc: 0.839 Test Loss: 0.815 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.785057544708252
Epoch: 32, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.828 Vali Acc: 0.856 Test Loss: 0.828 Test Acc: 0.856
Validation loss decreased (-0.844436 --> -0.855547).  Saving model ...
Epoch: 33 cost time: 0.8104536533355713
Epoch: 33, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.841 Vali Acc: 0.850 Test Loss: 0.841 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8562934398651123
Epoch: 34, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.856 Vali Acc: 0.850 Test Loss: 0.856 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8251056671142578
Epoch: 35, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.848 Vali Acc: 0.828 Test Loss: 0.848 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8098700046539307
Epoch: 36, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.869 Vali Acc: 0.850 Test Loss: 0.869 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7942140102386475
Epoch: 37, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.919 Vali Acc: 0.839 Test Loss: 0.919 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.82004714012146
Epoch: 38, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.983 Vali Acc: 0.833 Test Loss: 0.983 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8284451961517334
Epoch: 39, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.944 Vali Acc: 0.833 Test Loss: 0.944 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8148229122161865
Epoch: 40, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.957 Vali Acc: 0.839 Test Loss: 0.957 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.7849016189575195
Epoch: 41, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.956 Vali Acc: 0.839 Test Loss: 0.956 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.829390287399292
Epoch: 42, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.949 Vali Acc: 0.833 Test Loss: 0.949 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 96623
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.272099494934082
Epoch: 1, Steps: 12 | Train Loss: 2.716 Vali Loss: 2.703 Vali Acc: 0.078 Test Loss: 2.703 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 0.740257978439331
Epoch: 2, Steps: 12 | Train Loss: 2.655 Vali Loss: 2.640 Vali Acc: 0.111 Test Loss: 2.640 Test Acc: 0.111
Validation loss decreased (-0.077751 --> -0.111085).  Saving model ...
Epoch: 3 cost time: 0.7458484172821045
Epoch: 3, Steps: 12 | Train Loss: 2.518 Vali Loss: 2.533 Vali Acc: 0.211 Test Loss: 2.533 Test Acc: 0.211
Validation loss decreased (-0.111085 --> -0.211086).  Saving model ...
Epoch: 4 cost time: 0.779533863067627
Epoch: 4, Steps: 12 | Train Loss: 2.386 Vali Loss: 2.389 Vali Acc: 0.322 Test Loss: 2.389 Test Acc: 0.322
Validation loss decreased (-0.211086 --> -0.322198).  Saving model ...
Epoch: 5 cost time: 0.7362384796142578
Epoch: 5, Steps: 12 | Train Loss: 2.221 Vali Loss: 2.222 Vali Acc: 0.456 Test Loss: 2.222 Test Acc: 0.456
Validation loss decreased (-0.322198 --> -0.455533).  Saving model ...
Epoch: 6 cost time: 0.7510218620300293
Epoch: 6, Steps: 12 | Train Loss: 2.001 Vali Loss: 2.019 Vali Acc: 0.539 Test Loss: 2.019 Test Acc: 0.539
Validation loss decreased (-0.455533 --> -0.538869).  Saving model ...
Epoch: 7 cost time: 0.852318525314331
Epoch: 7, Steps: 12 | Train Loss: 1.765 Vali Loss: 1.835 Vali Acc: 0.567 Test Loss: 1.835 Test Acc: 0.567
Validation loss decreased (-0.538869 --> -0.566648).  Saving model ...
Epoch: 8 cost time: 0.7877535820007324
Epoch: 8, Steps: 12 | Train Loss: 1.529 Vali Loss: 1.651 Vali Acc: 0.617 Test Loss: 1.651 Test Acc: 0.617
Validation loss decreased (-0.566648 --> -0.616650).  Saving model ...
Epoch: 9 cost time: 0.7461845874786377
Epoch: 9, Steps: 12 | Train Loss: 1.342 Vali Loss: 1.457 Vali Acc: 0.639 Test Loss: 1.457 Test Acc: 0.639
Validation loss decreased (-0.616650 --> -0.638874).  Saving model ...
Epoch: 10 cost time: 0.7306547164916992
Epoch: 10, Steps: 12 | Train Loss: 1.176 Vali Loss: 1.317 Vali Acc: 0.672 Test Loss: 1.317 Test Acc: 0.672
Validation loss decreased (-0.638874 --> -0.672209).  Saving model ...
Epoch: 11 cost time: 0.7784874439239502
Epoch: 11, Steps: 12 | Train Loss: 0.992 Vali Loss: 1.210 Vali Acc: 0.667 Test Loss: 1.210 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7622547149658203
Epoch: 12, Steps: 12 | Train Loss: 0.882 Vali Loss: 1.138 Vali Acc: 0.672 Test Loss: 1.138 Test Acc: 0.672
Validation loss decreased (-0.672209 --> -0.672211).  Saving model ...
Epoch: 13 cost time: 0.7711503505706787
Epoch: 13, Steps: 12 | Train Loss: 0.776 Vali Loss: 1.053 Vali Acc: 0.689 Test Loss: 1.053 Test Acc: 0.689
Validation loss decreased (-0.672211 --> -0.688878).  Saving model ...
Epoch: 14 cost time: 0.7197961807250977
Epoch: 14, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.998 Vali Acc: 0.672 Test Loss: 0.998 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6960194110870361
Epoch: 15, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.954 Vali Acc: 0.700 Test Loss: 0.954 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699990).  Saving model ...
Epoch: 16 cost time: 0.7057738304138184
Epoch: 16, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.918 Vali Acc: 0.706 Test Loss: 0.918 Test Acc: 0.706
Validation loss decreased (-0.699990 --> -0.705546).  Saving model ...
Epoch: 17 cost time: 0.7166616916656494
Epoch: 17, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.887 Vali Acc: 0.722 Test Loss: 0.887 Test Acc: 0.722
Validation loss decreased (-0.705546 --> -0.722213).  Saving model ...
Epoch: 18 cost time: 0.7497856616973877
Epoch: 18, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.854 Vali Acc: 0.739 Test Loss: 0.854 Test Acc: 0.739
Validation loss decreased (-0.722213 --> -0.738880).  Saving model ...
Epoch: 19 cost time: 0.7692840099334717
Epoch: 19, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.836 Vali Acc: 0.739 Test Loss: 0.836 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738881).  Saving model ...
Epoch: 20 cost time: 0.7089729309082031
Epoch: 20, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.746 Vali Acc: 0.778 Test Loss: 0.746 Test Acc: 0.778
Validation loss decreased (-0.738881 --> -0.777770).  Saving model ...
Epoch: 21 cost time: 0.7565951347351074
Epoch: 21, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.743 Vali Acc: 0.772 Test Loss: 0.743 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7582902908325195
Epoch: 22, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.758 Vali Acc: 0.783 Test Loss: 0.758 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783326).  Saving model ...
Epoch: 23 cost time: 0.761796236038208
Epoch: 23, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.731 Vali Acc: 0.800 Test Loss: 0.731 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799993).  Saving model ...
Epoch: 24 cost time: 0.7674500942230225
Epoch: 24, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.677 Vali Acc: 0.817 Test Loss: 0.677 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816660).  Saving model ...
Epoch: 25 cost time: 0.7752823829650879
Epoch: 25, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.694 Vali Acc: 0.828 Test Loss: 0.694 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 26 cost time: 0.7518959045410156
Epoch: 26, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.668 Vali Acc: 0.828 Test Loss: 0.668 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 27 cost time: 0.739762544631958
Epoch: 27, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.656 Vali Acc: 0.850 Test Loss: 0.656 Test Acc: 0.850
Validation loss decreased (-0.827771 --> -0.849993).  Saving model ...
Epoch: 28 cost time: 0.729520320892334
Epoch: 28, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.671 Vali Acc: 0.839 Test Loss: 0.671 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.728499174118042
Epoch: 29, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.652 Vali Acc: 0.850 Test Loss: 0.652 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 30 cost time: 0.7131595611572266
Epoch: 30, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.637 Vali Acc: 0.833 Test Loss: 0.637 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.776787281036377
Epoch: 31, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.651 Vali Acc: 0.850 Test Loss: 0.651 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 32 cost time: 0.7236204147338867
Epoch: 32, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.642 Vali Acc: 0.839 Test Loss: 0.642 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7428486347198486
Epoch: 33, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.627 Vali Acc: 0.856 Test Loss: 0.627 Test Acc: 0.856
Validation loss decreased (-0.849993 --> -0.855549).  Saving model ...
Epoch: 34 cost time: 0.6909549236297607
Epoch: 34, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.641 Vali Acc: 0.844 Test Loss: 0.641 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7163503170013428
Epoch: 35, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.654 Vali Acc: 0.844 Test Loss: 0.654 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6875522136688232
Epoch: 36, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.656 Vali Acc: 0.828 Test Loss: 0.656 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7592203617095947
Epoch: 37, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.652 Vali Acc: 0.833 Test Loss: 0.652 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7279503345489502
Epoch: 38, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.678 Vali Acc: 0.839 Test Loss: 0.678 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.747352123260498
Epoch: 39, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.661 Vali Acc: 0.839 Test Loss: 0.661 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7586112022399902
Epoch: 40, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.658 Vali Acc: 0.844 Test Loss: 0.658 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.7608904838562012
Epoch: 41, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.674 Vali Acc: 0.850 Test Loss: 0.674 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.7407746315002441
Epoch: 42, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.715 Vali Acc: 0.839 Test Loss: 0.715 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.7369990348815918
Epoch: 43, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.695 Vali Acc: 0.850 Test Loss: 0.695 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 73615
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1400861740112305
Epoch: 1, Steps: 12 | Train Loss: 2.730 Vali Loss: 2.676 Vali Acc: 0.089 Test Loss: 2.676 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 0.8761286735534668
Epoch: 2, Steps: 12 | Train Loss: 2.636 Vali Loss: 2.592 Vali Acc: 0.228 Test Loss: 2.592 Test Acc: 0.228
Validation loss decreased (-0.088862 --> -0.227752).  Saving model ...
Epoch: 3 cost time: 0.8057489395141602
Epoch: 3, Steps: 12 | Train Loss: 2.521 Vali Loss: 2.475 Vali Acc: 0.350 Test Loss: 2.475 Test Acc: 0.350
Validation loss decreased (-0.227752 --> -0.349975).  Saving model ...
Epoch: 4 cost time: 0.7595193386077881
Epoch: 4, Steps: 12 | Train Loss: 2.351 Vali Loss: 2.318 Vali Acc: 0.411 Test Loss: 2.318 Test Acc: 0.411
Validation loss decreased (-0.349975 --> -0.411088).  Saving model ...
Epoch: 5 cost time: 0.7867684364318848
Epoch: 5, Steps: 12 | Train Loss: 2.191 Vali Loss: 2.110 Vali Acc: 0.517 Test Loss: 2.110 Test Acc: 0.517
Validation loss decreased (-0.411088 --> -0.516646).  Saving model ...
Epoch: 6 cost time: 0.8853998184204102
Epoch: 6, Steps: 12 | Train Loss: 1.987 Vali Loss: 1.904 Vali Acc: 0.550 Test Loss: 1.904 Test Acc: 0.550
Validation loss decreased (-0.516646 --> -0.549981).  Saving model ...
Epoch: 7 cost time: 0.77628493309021
Epoch: 7, Steps: 12 | Train Loss: 1.706 Vali Loss: 1.707 Vali Acc: 0.594 Test Loss: 1.707 Test Acc: 0.594
Validation loss decreased (-0.549981 --> -0.594427).  Saving model ...
Epoch: 8 cost time: 0.7755954265594482
Epoch: 8, Steps: 12 | Train Loss: 1.489 Vali Loss: 1.534 Vali Acc: 0.628 Test Loss: 1.534 Test Acc: 0.628
Validation loss decreased (-0.594427 --> -0.627762).  Saving model ...
Epoch: 9 cost time: 0.7757229804992676
Epoch: 9, Steps: 12 | Train Loss: 1.313 Vali Loss: 1.373 Vali Acc: 0.656 Test Loss: 1.373 Test Acc: 0.656
Validation loss decreased (-0.627762 --> -0.655542).  Saving model ...
Epoch: 10 cost time: 0.7558150291442871
Epoch: 10, Steps: 12 | Train Loss: 1.100 Vali Loss: 1.257 Vali Acc: 0.672 Test Loss: 1.257 Test Acc: 0.672
Validation loss decreased (-0.655542 --> -0.672210).  Saving model ...
Epoch: 11 cost time: 0.7563469409942627
Epoch: 11, Steps: 12 | Train Loss: 0.982 Vali Loss: 1.155 Vali Acc: 0.661 Test Loss: 1.155 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7631938457489014
Epoch: 12, Steps: 12 | Train Loss: 0.840 Vali Loss: 1.089 Vali Acc: 0.661 Test Loss: 1.089 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7459533214569092
Epoch: 13, Steps: 12 | Train Loss: 0.758 Vali Loss: 1.038 Vali Acc: 0.694 Test Loss: 1.038 Test Acc: 0.694
Validation loss decreased (-0.672210 --> -0.694434).  Saving model ...
Epoch: 14 cost time: 0.7460155487060547
Epoch: 14, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.984 Vali Acc: 0.689 Test Loss: 0.984 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8279812335968018
Epoch: 15, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.954 Vali Acc: 0.678 Test Loss: 0.954 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.763707160949707
Epoch: 16, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.870 Vali Acc: 0.706 Test Loss: 0.870 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705547).  Saving model ...
Epoch: 17 cost time: 0.8055758476257324
Epoch: 17, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.842 Vali Acc: 0.717 Test Loss: 0.842 Test Acc: 0.717
Validation loss decreased (-0.705547 --> -0.716658).  Saving model ...
Epoch: 18 cost time: 0.7580869197845459
Epoch: 18, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.850 Vali Acc: 0.739 Test Loss: 0.850 Test Acc: 0.739
Validation loss decreased (-0.716658 --> -0.738880).  Saving model ...
Epoch: 19 cost time: 0.7655909061431885
Epoch: 19, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.820 Vali Acc: 0.739 Test Loss: 0.820 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738881).  Saving model ...
Epoch: 20 cost time: 0.7700917720794678
Epoch: 20, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.752 Vali Acc: 0.783 Test Loss: 0.752 Test Acc: 0.783
Validation loss decreased (-0.738881 --> -0.783326).  Saving model ...
Epoch: 21 cost time: 0.8141281604766846
Epoch: 21, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.743 Vali Acc: 0.789 Test Loss: 0.743 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788881).  Saving model ...
Epoch: 22 cost time: 0.8674991130828857
Epoch: 22, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.720 Vali Acc: 0.794 Test Loss: 0.720 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794437).  Saving model ...
Epoch: 23 cost time: 0.7391154766082764
Epoch: 23, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.709 Vali Acc: 0.833 Test Loss: 0.709 Test Acc: 0.833
Validation loss decreased (-0.794437 --> -0.833326).  Saving model ...
Epoch: 24 cost time: 0.7386913299560547
Epoch: 24, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.701 Vali Acc: 0.806 Test Loss: 0.701 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8004183769226074
Epoch: 25, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.685 Vali Acc: 0.828 Test Loss: 0.685 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7918701171875
Epoch: 26, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.661 Vali Acc: 0.806 Test Loss: 0.661 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7863664627075195
Epoch: 27, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.665 Vali Acc: 0.828 Test Loss: 0.665 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7830142974853516
Epoch: 28, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.654 Vali Acc: 0.828 Test Loss: 0.654 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.81831955909729
Epoch: 29, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.639 Vali Acc: 0.839 Test Loss: 0.639 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838882).  Saving model ...
Epoch: 30 cost time: 0.782468318939209
Epoch: 30, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.664 Vali Acc: 0.833 Test Loss: 0.664 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8761250972747803
Epoch: 31, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.662 Vali Acc: 0.822 Test Loss: 0.662 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.776200532913208
Epoch: 32, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.660 Vali Acc: 0.828 Test Loss: 0.660 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8169965744018555
Epoch: 33, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.651 Vali Acc: 0.839 Test Loss: 0.651 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7919902801513672
Epoch: 34, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.669 Vali Acc: 0.828 Test Loss: 0.669 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8533155918121338
Epoch: 35, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.658 Vali Acc: 0.833 Test Loss: 0.658 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8144667148590088
Epoch: 36, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.647 Vali Acc: 0.844 Test Loss: 0.647 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 37 cost time: 0.7935776710510254
Epoch: 37, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.659 Vali Acc: 0.861 Test Loss: 0.659 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861105).  Saving model ...
Epoch: 38 cost time: 0.7714147567749023
Epoch: 38, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.670 Vali Acc: 0.850 Test Loss: 0.670 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.86006760597229
Epoch: 39, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.679 Vali Acc: 0.856 Test Loss: 0.679 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7983865737915039
Epoch: 40, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.717 Vali Acc: 0.861 Test Loss: 0.717 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7277884483337402
Epoch: 41, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.644 Vali Acc: 0.861 Test Loss: 0.644 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 42 cost time: 0.7653303146362305
Epoch: 42, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.660 Vali Acc: 0.867 Test Loss: 0.660 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 43 cost time: 0.7999141216278076
Epoch: 43, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.668 Vali Acc: 0.844 Test Loss: 0.668 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7660603523254395
Epoch: 44, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.689 Vali Acc: 0.861 Test Loss: 0.689 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7809491157531738
Epoch: 45, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.717 Vali Acc: 0.844 Test Loss: 0.717 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8041844367980957
Epoch: 46, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.687 Vali Acc: 0.861 Test Loss: 0.687 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.7764937877655029
Epoch: 47, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.736 Vali Acc: 0.850 Test Loss: 0.736 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.7834048271179199
Epoch: 48, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.757 Vali Acc: 0.861 Test Loss: 0.757 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.7647743225097656
Epoch: 49, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.725 Vali Acc: 0.861 Test Loss: 0.725 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.7529168128967285
Epoch: 50, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.761 Vali Acc: 0.850 Test Loss: 0.761 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 73647
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.102956533432007
Epoch: 1, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.703 Vali Acc: 0.089 Test Loss: 2.703 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 0.7682833671569824
Epoch: 2, Steps: 12 | Train Loss: 2.655 Vali Loss: 2.648 Vali Acc: 0.144 Test Loss: 2.648 Test Acc: 0.144
Validation loss decreased (-0.088862 --> -0.144418).  Saving model ...
Epoch: 3 cost time: 0.7643024921417236
Epoch: 3, Steps: 12 | Train Loss: 2.568 Vali Loss: 2.554 Vali Acc: 0.300 Test Loss: 2.554 Test Acc: 0.300
Validation loss decreased (-0.144418 --> -0.299974).  Saving model ...
Epoch: 4 cost time: 0.775233268737793
Epoch: 4, Steps: 12 | Train Loss: 2.461 Vali Loss: 2.429 Vali Acc: 0.439 Test Loss: 2.429 Test Acc: 0.439
Validation loss decreased (-0.299974 --> -0.438865).  Saving model ...
Epoch: 5 cost time: 0.7895677089691162
Epoch: 5, Steps: 12 | Train Loss: 2.293 Vali Loss: 2.288 Vali Acc: 0.489 Test Loss: 2.288 Test Acc: 0.489
Validation loss decreased (-0.438865 --> -0.488866).  Saving model ...
Epoch: 6 cost time: 0.7698993682861328
Epoch: 6, Steps: 12 | Train Loss: 2.134 Vali Loss: 2.099 Vali Acc: 0.567 Test Loss: 2.099 Test Acc: 0.567
Validation loss decreased (-0.488866 --> -0.566646).  Saving model ...
Epoch: 7 cost time: 0.7787413597106934
Epoch: 7, Steps: 12 | Train Loss: 1.904 Vali Loss: 1.913 Vali Acc: 0.606 Test Loss: 1.913 Test Acc: 0.606
Validation loss decreased (-0.566646 --> -0.605536).  Saving model ...
Epoch: 8 cost time: 0.8032464981079102
Epoch: 8, Steps: 12 | Train Loss: 1.702 Vali Loss: 1.733 Vali Acc: 0.622 Test Loss: 1.733 Test Acc: 0.622
Validation loss decreased (-0.605536 --> -0.622205).  Saving model ...
Epoch: 9 cost time: 0.7637536525726318
Epoch: 9, Steps: 12 | Train Loss: 1.486 Vali Loss: 1.568 Vali Acc: 0.661 Test Loss: 1.568 Test Acc: 0.661
Validation loss decreased (-0.622205 --> -0.661095).  Saving model ...
Epoch: 10 cost time: 0.7616212368011475
Epoch: 10, Steps: 12 | Train Loss: 1.289 Vali Loss: 1.425 Vali Acc: 0.667 Test Loss: 1.425 Test Acc: 0.667
Validation loss decreased (-0.661095 --> -0.666652).  Saving model ...
Epoch: 11 cost time: 0.7807343006134033
Epoch: 11, Steps: 12 | Train Loss: 1.132 Vali Loss: 1.300 Vali Acc: 0.656 Test Loss: 1.300 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7541003227233887
Epoch: 12, Steps: 12 | Train Loss: 1.041 Vali Loss: 1.180 Vali Acc: 0.656 Test Loss: 1.180 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8097877502441406
Epoch: 13, Steps: 12 | Train Loss: 0.881 Vali Loss: 1.097 Vali Acc: 0.678 Test Loss: 1.097 Test Acc: 0.678
Validation loss decreased (-0.666652 --> -0.677767).  Saving model ...
Epoch: 14 cost time: 0.7720632553100586
Epoch: 14, Steps: 12 | Train Loss: 0.839 Vali Loss: 1.039 Vali Acc: 0.700 Test Loss: 1.039 Test Acc: 0.700
Validation loss decreased (-0.677767 --> -0.699990).  Saving model ...
Epoch: 15 cost time: 0.7688086032867432
Epoch: 15, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.982 Vali Acc: 0.689 Test Loss: 0.982 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8226137161254883
Epoch: 16, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.937 Vali Acc: 0.706 Test Loss: 0.937 Test Acc: 0.706
Validation loss decreased (-0.699990 --> -0.705546).  Saving model ...
Epoch: 17 cost time: 0.791616678237915
Epoch: 17, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.872 Vali Acc: 0.722 Test Loss: 0.872 Test Acc: 0.722
Validation loss decreased (-0.705546 --> -0.722214).  Saving model ...
Epoch: 18 cost time: 0.7890214920043945
Epoch: 18, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.834 Vali Acc: 0.750 Test Loss: 0.834 Test Acc: 0.750
Validation loss decreased (-0.722214 --> -0.749992).  Saving model ...
Epoch: 19 cost time: 0.756427526473999
Epoch: 19, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.798 Vali Acc: 0.756 Test Loss: 0.798 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755548).  Saving model ...
Epoch: 20 cost time: 0.7494902610778809
Epoch: 20, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.771 Vali Acc: 0.783 Test Loss: 0.771 Test Acc: 0.783
Validation loss decreased (-0.755548 --> -0.783326).  Saving model ...
Epoch: 21 cost time: 0.742525577545166
Epoch: 21, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.771 Vali Acc: 0.783 Test Loss: 0.771 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783326).  Saving model ...
Epoch: 22 cost time: 0.8291845321655273
Epoch: 22, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.728 Vali Acc: 0.789 Test Loss: 0.728 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 23 cost time: 0.7924332618713379
Epoch: 23, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.721 Vali Acc: 0.806 Test Loss: 0.721 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805548).  Saving model ...
Epoch: 24 cost time: 0.7148950099945068
Epoch: 24, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.682 Vali Acc: 0.811 Test Loss: 0.682 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 25 cost time: 0.7769584655761719
Epoch: 25, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.665 Vali Acc: 0.839 Test Loss: 0.665 Test Acc: 0.839
Validation loss decreased (-0.811104 --> -0.838882).  Saving model ...
Epoch: 26 cost time: 0.8275392055511475
Epoch: 26, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.662 Vali Acc: 0.833 Test Loss: 0.662 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8113894462585449
Epoch: 27, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.652 Vali Acc: 0.839 Test Loss: 0.652 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838882).  Saving model ...
Epoch: 28 cost time: 0.8696200847625732
Epoch: 28, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.648 Vali Acc: 0.856 Test Loss: 0.648 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855549).  Saving model ...
Epoch: 29 cost time: 0.8044452667236328
Epoch: 29, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.612 Vali Acc: 0.861 Test Loss: 0.612 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 30 cost time: 0.9285087585449219
Epoch: 30, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.599 Vali Acc: 0.856 Test Loss: 0.599 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8436574935913086
Epoch: 31, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.608 Vali Acc: 0.844 Test Loss: 0.608 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8401782512664795
Epoch: 32, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.612 Vali Acc: 0.856 Test Loss: 0.612 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8133602142333984
Epoch: 33, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.612 Vali Acc: 0.850 Test Loss: 0.612 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8482437133789062
Epoch: 34, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.625 Vali Acc: 0.867 Test Loss: 0.625 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 35 cost time: 0.8280272483825684
Epoch: 35, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.600 Vali Acc: 0.872 Test Loss: 0.600 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872216).  Saving model ...
Epoch: 36 cost time: 0.8102374076843262
Epoch: 36, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.610 Vali Acc: 0.861 Test Loss: 0.610 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.776547908782959
Epoch: 37, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.618 Vali Acc: 0.861 Test Loss: 0.618 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7544248104095459
Epoch: 38, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.611 Vali Acc: 0.861 Test Loss: 0.611 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8374567031860352
Epoch: 39, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.606 Vali Acc: 0.861 Test Loss: 0.606 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7852401733398438
Epoch: 40, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.627 Vali Acc: 0.856 Test Loss: 0.627 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8179149627685547
Epoch: 41, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.649 Vali Acc: 0.861 Test Loss: 0.649 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7619204521179199
Epoch: 42, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.659 Vali Acc: 0.861 Test Loss: 0.659 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.8067173957824707
Epoch: 43, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.649 Vali Acc: 0.878 Test Loss: 0.649 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877771).  Saving model ...
Epoch: 44 cost time: 0.801466703414917
Epoch: 44, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.659 Vali Acc: 0.872 Test Loss: 0.659 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8306312561035156
Epoch: 45, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.675 Vali Acc: 0.878 Test Loss: 0.675 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7976794242858887
Epoch: 46, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.687 Vali Acc: 0.878 Test Loss: 0.687 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.8771193027496338
Epoch: 47, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.658 Vali Acc: 0.872 Test Loss: 0.658 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.8353254795074463
Epoch: 48, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.656 Vali Acc: 0.878 Test Loss: 0.656 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.8113999366760254
Epoch: 49, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.667 Vali Acc: 0.872 Test Loss: 0.667 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.8286352157592773
Epoch: 50, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.684 Vali Acc: 0.889 Test Loss: 0.684 Test Acc: 0.889
Validation loss decreased (-0.877771 --> -0.888882).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 67919
model size : 0.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.231050968170166
Epoch: 1, Steps: 12 | Train Loss: 2.747 Vali Loss: 2.703 Vali Acc: 0.089 Test Loss: 2.703 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 0.8860428333282471
Epoch: 2, Steps: 12 | Train Loss: 2.677 Vali Loss: 2.658 Vali Acc: 0.111 Test Loss: 2.658 Test Acc: 0.111
Validation loss decreased (-0.088862 --> -0.111085).  Saving model ...
Epoch: 3 cost time: 0.8546020984649658
Epoch: 3, Steps: 12 | Train Loss: 2.591 Vali Loss: 2.586 Vali Acc: 0.194 Test Loss: 2.586 Test Acc: 0.194
Validation loss decreased (-0.111085 --> -0.194419).  Saving model ...
Epoch: 4 cost time: 0.8887336254119873
Epoch: 4, Steps: 12 | Train Loss: 2.505 Vali Loss: 2.493 Vali Acc: 0.294 Test Loss: 2.493 Test Acc: 0.294
Validation loss decreased (-0.194419 --> -0.294420).  Saving model ...
Epoch: 5 cost time: 0.7918450832366943
Epoch: 5, Steps: 12 | Train Loss: 2.429 Vali Loss: 2.379 Vali Acc: 0.361 Test Loss: 2.379 Test Acc: 0.361
Validation loss decreased (-0.294420 --> -0.361087).  Saving model ...
Epoch: 6 cost time: 0.8189091682434082
Epoch: 6, Steps: 12 | Train Loss: 2.262 Vali Loss: 2.247 Vali Acc: 0.400 Test Loss: 2.247 Test Acc: 0.400
Validation loss decreased (-0.361087 --> -0.399978).  Saving model ...
Epoch: 7 cost time: 0.8458967208862305
Epoch: 7, Steps: 12 | Train Loss: 2.078 Vali Loss: 2.108 Vali Acc: 0.472 Test Loss: 2.108 Test Acc: 0.472
Validation loss decreased (-0.399978 --> -0.472201).  Saving model ...
Epoch: 8 cost time: 0.7979662418365479
Epoch: 8, Steps: 12 | Train Loss: 1.926 Vali Loss: 1.954 Vali Acc: 0.517 Test Loss: 1.954 Test Acc: 0.517
Validation loss decreased (-0.472201 --> -0.516647).  Saving model ...
Epoch: 9 cost time: 0.8582959175109863
Epoch: 9, Steps: 12 | Train Loss: 1.703 Vali Loss: 1.802 Vali Acc: 0.561 Test Loss: 1.802 Test Acc: 0.561
Validation loss decreased (-0.516647 --> -0.561093).  Saving model ...
Epoch: 10 cost time: 0.8297724723815918
Epoch: 10, Steps: 12 | Train Loss: 1.596 Vali Loss: 1.648 Vali Acc: 0.594 Test Loss: 1.648 Test Acc: 0.594
Validation loss decreased (-0.561093 --> -0.594428).  Saving model ...
Epoch: 11 cost time: 0.7989559173583984
Epoch: 11, Steps: 12 | Train Loss: 1.386 Vali Loss: 1.522 Vali Acc: 0.611 Test Loss: 1.522 Test Acc: 0.611
Validation loss decreased (-0.594428 --> -0.611096).  Saving model ...
Epoch: 12 cost time: 0.7700686454772949
Epoch: 12, Steps: 12 | Train Loss: 1.250 Vali Loss: 1.404 Vali Acc: 0.633 Test Loss: 1.404 Test Acc: 0.633
Validation loss decreased (-0.611096 --> -0.633319).  Saving model ...
Epoch: 13 cost time: 0.7992453575134277
Epoch: 13, Steps: 12 | Train Loss: 1.092 Vali Loss: 1.313 Vali Acc: 0.639 Test Loss: 1.313 Test Acc: 0.639
Validation loss decreased (-0.633319 --> -0.638876).  Saving model ...
Epoch: 14 cost time: 0.8250410556793213
Epoch: 14, Steps: 12 | Train Loss: 0.988 Vali Loss: 1.210 Vali Acc: 0.661 Test Loss: 1.210 Test Acc: 0.661
Validation loss decreased (-0.638876 --> -0.661099).  Saving model ...
Epoch: 15 cost time: 0.7625648975372314
Epoch: 15, Steps: 12 | Train Loss: 0.893 Vali Loss: 1.136 Vali Acc: 0.672 Test Loss: 1.136 Test Acc: 0.672
Validation loss decreased (-0.661099 --> -0.672211).  Saving model ...
Epoch: 16 cost time: 0.7553730010986328
Epoch: 16, Steps: 12 | Train Loss: 0.800 Vali Loss: 1.075 Vali Acc: 0.678 Test Loss: 1.075 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677767).  Saving model ...
Epoch: 17 cost time: 0.8406276702880859
Epoch: 17, Steps: 12 | Train Loss: 0.708 Vali Loss: 1.006 Vali Acc: 0.706 Test Loss: 1.006 Test Acc: 0.706
Validation loss decreased (-0.677767 --> -0.705545).  Saving model ...
Epoch: 18 cost time: 0.8664975166320801
Epoch: 18, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.959 Vali Acc: 0.717 Test Loss: 0.959 Test Acc: 0.717
Validation loss decreased (-0.705545 --> -0.716657).  Saving model ...
Epoch: 19 cost time: 0.8278443813323975
Epoch: 19, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.911 Vali Acc: 0.728 Test Loss: 0.911 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727769).  Saving model ...
Epoch: 20 cost time: 0.8159716129302979
Epoch: 20, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.881 Vali Acc: 0.744 Test Loss: 0.881 Test Acc: 0.744
Validation loss decreased (-0.727769 --> -0.744436).  Saving model ...
Epoch: 21 cost time: 0.8364896774291992
Epoch: 21, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.838 Vali Acc: 0.739 Test Loss: 0.838 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8008649349212646
Epoch: 22, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.801 Vali Acc: 0.778 Test Loss: 0.801 Test Acc: 0.778
Validation loss decreased (-0.744436 --> -0.777770).  Saving model ...
Epoch: 23 cost time: 0.8006255626678467
Epoch: 23, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.777 Vali Acc: 0.767 Test Loss: 0.777 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8226139545440674
Epoch: 24, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.751 Vali Acc: 0.806 Test Loss: 0.751 Test Acc: 0.806
Validation loss decreased (-0.777770 --> -0.805548).  Saving model ...
Epoch: 25 cost time: 0.8095183372497559
Epoch: 25, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.721 Vali Acc: 0.806 Test Loss: 0.721 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805548).  Saving model ...
Epoch: 26 cost time: 0.7082738876342773
Epoch: 26, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.703 Vali Acc: 0.839 Test Loss: 0.703 Test Acc: 0.839
Validation loss decreased (-0.805548 --> -0.838882).  Saving model ...
Epoch: 27 cost time: 0.8197793960571289
Epoch: 27, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.685 Vali Acc: 0.822 Test Loss: 0.685 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7898199558258057
Epoch: 28, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.690 Vali Acc: 0.817 Test Loss: 0.690 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.770435094833374
Epoch: 29, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.684 Vali Acc: 0.817 Test Loss: 0.684 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8175845146179199
Epoch: 30, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.654 Vali Acc: 0.844 Test Loss: 0.654 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 31 cost time: 0.7316110134124756
Epoch: 31, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.664 Vali Acc: 0.839 Test Loss: 0.664 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8378503322601318
Epoch: 32, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.647 Vali Acc: 0.833 Test Loss: 0.647 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8326704502105713
Epoch: 33, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.650 Vali Acc: 0.856 Test Loss: 0.650 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 34 cost time: 0.80033278465271
Epoch: 34, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.635 Vali Acc: 0.844 Test Loss: 0.635 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8266651630401611
Epoch: 35, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.636 Vali Acc: 0.850 Test Loss: 0.636 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.837256908416748
Epoch: 36, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.655 Vali Acc: 0.844 Test Loss: 0.655 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7938663959503174
Epoch: 37, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.650 Vali Acc: 0.850 Test Loss: 0.650 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8560268878936768
Epoch: 38, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.627 Vali Acc: 0.839 Test Loss: 0.627 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.7899246215820312
Epoch: 39, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.624 Vali Acc: 0.856 Test Loss: 0.624 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 40 cost time: 0.8022050857543945
Epoch: 40, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.685 Vali Acc: 0.850 Test Loss: 0.685 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8259704113006592
Epoch: 41, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.683 Vali Acc: 0.839 Test Loss: 0.683 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7182714939117432
Epoch: 42, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.668 Vali Acc: 0.844 Test Loss: 0.668 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8179197311401367
Epoch: 43, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.701 Vali Acc: 0.850 Test Loss: 0.701 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8037436008453369
Epoch: 44, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.666 Vali Acc: 0.850 Test Loss: 0.666 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8372581005096436
Epoch: 45, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.668 Vali Acc: 0.861 Test Loss: 0.668 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861104).  Saving model ...
Epoch: 46 cost time: 0.7527389526367188
Epoch: 46, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.675 Vali Acc: 0.850 Test Loss: 0.675 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8474290370941162
Epoch: 47, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.682 Vali Acc: 0.861 Test Loss: 0.682 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8881101608276367
Epoch: 48, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.718 Vali Acc: 0.839 Test Loss: 0.718 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.8158719539642334
Epoch: 49, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.677 Vali Acc: 0.856 Test Loss: 0.677 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.8010540008544922
Epoch: 50, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.662 Vali Acc: 0.861 Test Loss: 0.662 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861104).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 64143
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2602295875549316
Epoch: 1, Steps: 12 | Train Loss: 2.737 Vali Loss: 2.715 Vali Acc: 0.056 Test Loss: 2.715 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 0.785900354385376
Epoch: 2, Steps: 12 | Train Loss: 2.711 Vali Loss: 2.672 Vali Acc: 0.100 Test Loss: 2.672 Test Acc: 0.100
Validation loss decreased (-0.055528 --> -0.099973).  Saving model ...
Epoch: 3 cost time: 0.7673146724700928
Epoch: 3, Steps: 12 | Train Loss: 2.644 Vali Loss: 2.605 Vali Acc: 0.183 Test Loss: 2.605 Test Acc: 0.183
Validation loss decreased (-0.099973 --> -0.183307).  Saving model ...
Epoch: 4 cost time: 0.7939250469207764
Epoch: 4, Steps: 12 | Train Loss: 2.538 Vali Loss: 2.522 Vali Acc: 0.272 Test Loss: 2.522 Test Acc: 0.272
Validation loss decreased (-0.183307 --> -0.272197).  Saving model ...
Epoch: 5 cost time: 0.852581262588501
Epoch: 5, Steps: 12 | Train Loss: 2.463 Vali Loss: 2.428 Vali Acc: 0.333 Test Loss: 2.428 Test Acc: 0.333
Validation loss decreased (-0.272197 --> -0.333309).  Saving model ...
Epoch: 6 cost time: 0.8910632133483887
Epoch: 6, Steps: 12 | Train Loss: 2.357 Vali Loss: 2.318 Vali Acc: 0.394 Test Loss: 2.318 Test Acc: 0.394
Validation loss decreased (-0.333309 --> -0.394421).  Saving model ...
Epoch: 7 cost time: 0.8285765647888184
Epoch: 7, Steps: 12 | Train Loss: 2.221 Vali Loss: 2.199 Vali Acc: 0.456 Test Loss: 2.199 Test Acc: 0.456
Validation loss decreased (-0.394421 --> -0.455534).  Saving model ...
Epoch: 8 cost time: 0.8962633609771729
Epoch: 8, Steps: 12 | Train Loss: 2.039 Vali Loss: 2.047 Vali Acc: 0.494 Test Loss: 2.047 Test Acc: 0.494
Validation loss decreased (-0.455534 --> -0.494424).  Saving model ...
Epoch: 9 cost time: 0.8502786159515381
Epoch: 9, Steps: 12 | Train Loss: 1.881 Vali Loss: 1.892 Vali Acc: 0.528 Test Loss: 1.892 Test Acc: 0.528
Validation loss decreased (-0.494424 --> -0.527759).  Saving model ...
Epoch: 10 cost time: 0.8588089942932129
Epoch: 10, Steps: 12 | Train Loss: 1.688 Vali Loss: 1.734 Vali Acc: 0.556 Test Loss: 1.734 Test Acc: 0.556
Validation loss decreased (-0.527759 --> -0.555538).  Saving model ...
Epoch: 11 cost time: 0.9324691295623779
Epoch: 11, Steps: 12 | Train Loss: 1.534 Vali Loss: 1.592 Vali Acc: 0.572 Test Loss: 1.592 Test Acc: 0.572
Validation loss decreased (-0.555538 --> -0.572206).  Saving model ...
Epoch: 12 cost time: 0.7656121253967285
Epoch: 12, Steps: 12 | Train Loss: 1.368 Vali Loss: 1.467 Vali Acc: 0.611 Test Loss: 1.467 Test Acc: 0.611
Validation loss decreased (-0.572206 --> -0.611096).  Saving model ...
Epoch: 13 cost time: 0.8656179904937744
Epoch: 13, Steps: 12 | Train Loss: 1.208 Vali Loss: 1.355 Vali Acc: 0.633 Test Loss: 1.355 Test Acc: 0.633
Validation loss decreased (-0.611096 --> -0.633320).  Saving model ...
Epoch: 14 cost time: 0.8006503582000732
Epoch: 14, Steps: 12 | Train Loss: 1.059 Vali Loss: 1.256 Vali Acc: 0.644 Test Loss: 1.256 Test Acc: 0.644
Validation loss decreased (-0.633320 --> -0.644432).  Saving model ...
Epoch: 15 cost time: 0.8372695446014404
Epoch: 15, Steps: 12 | Train Loss: 0.948 Vali Loss: 1.167 Vali Acc: 0.661 Test Loss: 1.167 Test Acc: 0.661
Validation loss decreased (-0.644432 --> -0.661099).  Saving model ...
Epoch: 16 cost time: 0.7583293914794922
Epoch: 16, Steps: 12 | Train Loss: 0.894 Vali Loss: 1.115 Vali Acc: 0.678 Test Loss: 1.115 Test Acc: 0.678
Validation loss decreased (-0.661099 --> -0.677767).  Saving model ...
Epoch: 17 cost time: 0.8038616180419922
Epoch: 17, Steps: 12 | Train Loss: 0.811 Vali Loss: 1.052 Vali Acc: 0.683 Test Loss: 1.052 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683323).  Saving model ...
Epoch: 18 cost time: 0.8536312580108643
Epoch: 18, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.997 Vali Acc: 0.717 Test Loss: 0.997 Test Acc: 0.717
Validation loss decreased (-0.683323 --> -0.716657).  Saving model ...
Epoch: 19 cost time: 0.8454015254974365
Epoch: 19, Steps: 12 | Train Loss: 0.727 Vali Loss: 0.946 Vali Acc: 0.706 Test Loss: 0.946 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8551783561706543
Epoch: 20, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.886 Vali Acc: 0.722 Test Loss: 0.886 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722213).  Saving model ...
Epoch: 21 cost time: 0.8451757431030273
Epoch: 21, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.849 Vali Acc: 0.750 Test Loss: 0.849 Test Acc: 0.750
Validation loss decreased (-0.722213 --> -0.749992).  Saving model ...
Epoch: 22 cost time: 0.8477280139923096
Epoch: 22, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.825 Vali Acc: 0.739 Test Loss: 0.825 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8402981758117676
Epoch: 23, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.811 Vali Acc: 0.744 Test Loss: 0.811 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8599817752838135
Epoch: 24, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.755 Vali Acc: 0.761 Test Loss: 0.755 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761104).  Saving model ...
Epoch: 25 cost time: 0.8623433113098145
Epoch: 25, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.731 Vali Acc: 0.772 Test Loss: 0.731 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772215).  Saving model ...
Epoch: 26 cost time: 0.8677265644073486
Epoch: 26, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.705 Vali Acc: 0.800 Test Loss: 0.705 Test Acc: 0.800
Validation loss decreased (-0.772215 --> -0.799993).  Saving model ...
Epoch: 27 cost time: 0.8655896186828613
Epoch: 27, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.696 Vali Acc: 0.806 Test Loss: 0.696 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 28 cost time: 0.8734853267669678
Epoch: 28, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.665 Vali Acc: 0.828 Test Loss: 0.665 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827771).  Saving model ...
Epoch: 29 cost time: 0.8520338535308838
Epoch: 29, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.656 Vali Acc: 0.806 Test Loss: 0.656 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8231377601623535
Epoch: 30, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.652 Vali Acc: 0.806 Test Loss: 0.652 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.821793794631958
Epoch: 31, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.627 Vali Acc: 0.822 Test Loss: 0.627 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8188929557800293
Epoch: 32, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.618 Vali Acc: 0.828 Test Loss: 0.618 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827772).  Saving model ...
Epoch: 33 cost time: 0.8736259937286377
Epoch: 33, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.604 Vali Acc: 0.817 Test Loss: 0.604 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8473010063171387
Epoch: 34, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.603 Vali Acc: 0.822 Test Loss: 0.603 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8456952571868896
Epoch: 35, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.595 Vali Acc: 0.839 Test Loss: 0.595 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 36 cost time: 0.8799054622650146
Epoch: 36, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.599 Vali Acc: 0.839 Test Loss: 0.599 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.796438455581665
Epoch: 37, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.598 Vali Acc: 0.833 Test Loss: 0.598 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.829181432723999
Epoch: 38, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 39 cost time: 0.8549642562866211
Epoch: 39, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.573 Vali Acc: 0.850 Test Loss: 0.573 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 40 cost time: 0.8371438980102539
Epoch: 40, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8239853382110596
Epoch: 41, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.569 Vali Acc: 0.861 Test Loss: 0.569 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 42 cost time: 0.8461809158325195
Epoch: 42, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.563 Vali Acc: 0.861 Test Loss: 0.563 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 43 cost time: 0.8323104381561279
Epoch: 43, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.557 Vali Acc: 0.856 Test Loss: 0.557 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8268930912017822
Epoch: 44, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.560 Vali Acc: 0.856 Test Loss: 0.560 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.845268726348877
Epoch: 45, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.571 Vali Acc: 0.856 Test Loss: 0.571 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8249201774597168
Epoch: 46, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.563 Vali Acc: 0.861 Test Loss: 0.563 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8914000988006592
Epoch: 47, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.580 Vali Acc: 0.861 Test Loss: 0.580 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.833380937576294
Epoch: 48, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.588 Vali Acc: 0.856 Test Loss: 0.588 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.9043021202087402
Epoch: 49, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.588 Vali Acc: 0.867 Test Loss: 0.588 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 50 cost time: 0.8458731174468994
Epoch: 50, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 62287
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.139313220977783
Epoch: 1, Steps: 12 | Train Loss: 2.746 Vali Loss: 2.735 Vali Acc: 0.061 Test Loss: 2.735 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 0.8716328144073486
Epoch: 2, Steps: 12 | Train Loss: 2.699 Vali Loss: 2.703 Vali Acc: 0.083 Test Loss: 2.703 Test Acc: 0.083
Validation loss decreased (-0.061084 --> -0.083306).  Saving model ...
Epoch: 3 cost time: 0.84438157081604
Epoch: 3, Steps: 12 | Train Loss: 2.656 Vali Loss: 2.649 Vali Acc: 0.128 Test Loss: 2.649 Test Acc: 0.128
Validation loss decreased (-0.083306 --> -0.127751).  Saving model ...
Epoch: 4 cost time: 0.7928919792175293
Epoch: 4, Steps: 12 | Train Loss: 2.588 Vali Loss: 2.580 Vali Acc: 0.206 Test Loss: 2.580 Test Acc: 0.206
Validation loss decreased (-0.127751 --> -0.205530).  Saving model ...
Epoch: 5 cost time: 0.8093729019165039
Epoch: 5, Steps: 12 | Train Loss: 2.500 Vali Loss: 2.504 Vali Acc: 0.289 Test Loss: 2.504 Test Acc: 0.289
Validation loss decreased (-0.205530 --> -0.288864).  Saving model ...
Epoch: 6 cost time: 0.9687306880950928
Epoch: 6, Steps: 12 | Train Loss: 2.421 Vali Loss: 2.419 Vali Acc: 0.361 Test Loss: 2.419 Test Acc: 0.361
Validation loss decreased (-0.288864 --> -0.361087).  Saving model ...
Epoch: 7 cost time: 0.8261289596557617
Epoch: 7, Steps: 12 | Train Loss: 2.307 Vali Loss: 2.308 Vali Acc: 0.483 Test Loss: 2.308 Test Acc: 0.483
Validation loss decreased (-0.361087 --> -0.483310).  Saving model ...
Epoch: 8 cost time: 0.8292925357818604
Epoch: 8, Steps: 12 | Train Loss: 2.174 Vali Loss: 2.189 Vali Acc: 0.533 Test Loss: 2.189 Test Acc: 0.533
Validation loss decreased (-0.483310 --> -0.533311).  Saving model ...
Epoch: 9 cost time: 0.8795363903045654
Epoch: 9, Steps: 12 | Train Loss: 2.016 Vali Loss: 2.061 Vali Acc: 0.572 Test Loss: 2.061 Test Acc: 0.572
Validation loss decreased (-0.533311 --> -0.572202).  Saving model ...
Epoch: 10 cost time: 0.8612160682678223
Epoch: 10, Steps: 12 | Train Loss: 1.861 Vali Loss: 1.901 Vali Acc: 0.606 Test Loss: 1.901 Test Acc: 0.606
Validation loss decreased (-0.572202 --> -0.605537).  Saving model ...
Epoch: 11 cost time: 0.8388183116912842
Epoch: 11, Steps: 12 | Train Loss: 1.675 Vali Loss: 1.750 Vali Acc: 0.622 Test Loss: 1.750 Test Acc: 0.622
Validation loss decreased (-0.605537 --> -0.622205).  Saving model ...
Epoch: 12 cost time: 0.8328409194946289
Epoch: 12, Steps: 12 | Train Loss: 1.524 Vali Loss: 1.605 Vali Acc: 0.644 Test Loss: 1.605 Test Acc: 0.644
Validation loss decreased (-0.622205 --> -0.644428).  Saving model ...
Epoch: 13 cost time: 0.8858699798583984
Epoch: 13, Steps: 12 | Train Loss: 1.387 Vali Loss: 1.468 Vali Acc: 0.672 Test Loss: 1.468 Test Acc: 0.672
Validation loss decreased (-0.644428 --> -0.672208).  Saving model ...
Epoch: 14 cost time: 0.8793032169342041
Epoch: 14, Steps: 12 | Train Loss: 1.197 Vali Loss: 1.335 Vali Acc: 0.700 Test Loss: 1.335 Test Acc: 0.700
Validation loss decreased (-0.672208 --> -0.699987).  Saving model ...
Epoch: 15 cost time: 0.8371026515960693
Epoch: 15, Steps: 12 | Train Loss: 1.062 Vali Loss: 1.234 Vali Acc: 0.728 Test Loss: 1.234 Test Acc: 0.728
Validation loss decreased (-0.699987 --> -0.727765).  Saving model ...
Epoch: 16 cost time: 0.7804372310638428
Epoch: 16, Steps: 12 | Train Loss: 0.963 Vali Loss: 1.142 Vali Acc: 0.722 Test Loss: 1.142 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.919651985168457
Epoch: 17, Steps: 12 | Train Loss: 0.856 Vali Loss: 1.061 Vali Acc: 0.733 Test Loss: 1.061 Test Acc: 0.733
Validation loss decreased (-0.727765 --> -0.733323).  Saving model ...
Epoch: 18 cost time: 0.7865962982177734
Epoch: 18, Steps: 12 | Train Loss: 0.776 Vali Loss: 0.980 Vali Acc: 0.756 Test Loss: 0.980 Test Acc: 0.756
Validation loss decreased (-0.733323 --> -0.755546).  Saving model ...
Epoch: 19 cost time: 0.797900915145874
Epoch: 19, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.909 Vali Acc: 0.756 Test Loss: 0.909 Test Acc: 0.756
Validation loss decreased (-0.755546 --> -0.755546).  Saving model ...
Epoch: 20 cost time: 0.8187813758850098
Epoch: 20, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.857 Vali Acc: 0.778 Test Loss: 0.857 Test Acc: 0.778
Validation loss decreased (-0.755546 --> -0.777769).  Saving model ...
Epoch: 21 cost time: 0.823253870010376
Epoch: 21, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.817 Vali Acc: 0.772 Test Loss: 0.817 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.868610143661499
Epoch: 22, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.788 Vali Acc: 0.789 Test Loss: 0.788 Test Acc: 0.789
Validation loss decreased (-0.777769 --> -0.788881).  Saving model ...
Epoch: 23 cost time: 0.8198966979980469
Epoch: 23, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.746 Vali Acc: 0.800 Test Loss: 0.746 Test Acc: 0.800
Validation loss decreased (-0.788881 --> -0.799993).  Saving model ...
Epoch: 24 cost time: 0.8427412509918213
Epoch: 24, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.713 Vali Acc: 0.789 Test Loss: 0.713 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8325445652008057
Epoch: 25, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.692 Vali Acc: 0.811 Test Loss: 0.692 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 26 cost time: 0.8584845066070557
Epoch: 26, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.678 Vali Acc: 0.811 Test Loss: 0.678 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 27 cost time: 0.8615448474884033
Epoch: 27, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.634 Vali Acc: 0.822 Test Loss: 0.634 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822216).  Saving model ...
Epoch: 28 cost time: 0.8092799186706543
Epoch: 28, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.611 Vali Acc: 0.839 Test Loss: 0.611 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 29 cost time: 0.8899452686309814
Epoch: 29, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.608 Vali Acc: 0.833 Test Loss: 0.608 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8411886692047119
Epoch: 30, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.589 Vali Acc: 0.839 Test Loss: 0.589 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 31 cost time: 0.8588240146636963
Epoch: 31, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.579 Vali Acc: 0.856 Test Loss: 0.579 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 32 cost time: 0.8658368587493896
Epoch: 32, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.561 Vali Acc: 0.833 Test Loss: 0.561 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7974944114685059
Epoch: 33, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.554 Vali Acc: 0.839 Test Loss: 0.554 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.760188102722168
Epoch: 34, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.559 Vali Acc: 0.844 Test Loss: 0.559 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.892425537109375
Epoch: 35, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.538 Vali Acc: 0.867 Test Loss: 0.538 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 36 cost time: 0.9107592105865479
Epoch: 36, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8141539096832275
Epoch: 37, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8028321266174316
Epoch: 38, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.537 Vali Acc: 0.856 Test Loss: 0.537 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0063388347625732
Epoch: 39, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.547 Vali Acc: 0.839 Test Loss: 0.547 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8726279735565186
Epoch: 40, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.539 Vali Acc: 0.833 Test Loss: 0.539 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8733203411102295
Epoch: 41, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.514 Vali Acc: 0.856 Test Loss: 0.514 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.853205680847168
Epoch: 42, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.8140425682067871
Epoch: 43, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.495 Vali Acc: 0.861 Test Loss: 0.495 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.8144690990447998
Epoch: 44, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.491 Vali Acc: 0.872 Test Loss: 0.491 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 45 cost time: 0.830604076385498
Epoch: 45, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.499 Vali Acc: 0.867 Test Loss: 0.499 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8057324886322021
Epoch: 46, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.836702823638916
Epoch: 47, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.518 Vali Acc: 0.861 Test Loss: 0.518 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8225293159484863
Epoch: 48, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.536 Vali Acc: 0.872 Test Loss: 0.536 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.827965259552002
Epoch: 49, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.8593652248382568
Epoch: 50, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.554 Vali Acc: 0.856 Test Loss: 0.554 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 60463
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.421496629714966
Epoch: 1, Steps: 12 | Train Loss: 2.682 Vali Loss: 2.559 Vali Acc: 0.267 Test Loss: 2.559 Test Acc: 0.267
Validation loss decreased (inf --> -0.266641).  Saving model ...
Epoch: 2 cost time: 1.138866662979126
Epoch: 2, Steps: 12 | Train Loss: 2.207 Vali Loss: 2.090 Vali Acc: 0.539 Test Loss: 2.090 Test Acc: 0.539
Validation loss decreased (-0.266641 --> -0.538868).  Saving model ...
Epoch: 3 cost time: 1.160010576248169
Epoch: 3, Steps: 12 | Train Loss: 1.571 Vali Loss: 1.504 Vali Acc: 0.611 Test Loss: 1.504 Test Acc: 0.611
Validation loss decreased (-0.538868 --> -0.611096).  Saving model ...
Epoch: 4 cost time: 1.0837419033050537
Epoch: 4, Steps: 12 | Train Loss: 1.112 Vali Loss: 1.164 Vali Acc: 0.650 Test Loss: 1.164 Test Acc: 0.650
Validation loss decreased (-0.611096 --> -0.649988).  Saving model ...
Epoch: 5 cost time: 1.168743371963501
Epoch: 5, Steps: 12 | Train Loss: 0.700 Vali Loss: 0.947 Vali Acc: 0.694 Test Loss: 0.947 Test Acc: 0.694
Validation loss decreased (-0.649988 --> -0.694435).  Saving model ...
Epoch: 6 cost time: 1.115746021270752
Epoch: 6, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.950 Vali Acc: 0.694 Test Loss: 0.950 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1210949420928955
Epoch: 7, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.824 Vali Acc: 0.744 Test Loss: 0.824 Test Acc: 0.744
Validation loss decreased (-0.694435 --> -0.744436).  Saving model ...
Epoch: 8 cost time: 1.1458568572998047
Epoch: 8, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.829 Vali Acc: 0.750 Test Loss: 0.829 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749992).  Saving model ...
Epoch: 9 cost time: 1.1586487293243408
Epoch: 9, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.901 Vali Acc: 0.767 Test Loss: 0.901 Test Acc: 0.767
Validation loss decreased (-0.749992 --> -0.766658).  Saving model ...
Epoch: 10 cost time: 1.249218463897705
Epoch: 10, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.881 Vali Acc: 0.789 Test Loss: 0.881 Test Acc: 0.789
Validation loss decreased (-0.766658 --> -0.788880).  Saving model ...
Epoch: 11 cost time: 1.1805038452148438
Epoch: 11, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.799 Vali Acc: 0.822 Test Loss: 0.799 Test Acc: 0.822
Validation loss decreased (-0.788880 --> -0.822214).  Saving model ...
Epoch: 12 cost time: 1.1189899444580078
Epoch: 12, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.861 Vali Acc: 0.806 Test Loss: 0.861 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1517972946166992
Epoch: 13, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.840 Vali Acc: 0.811 Test Loss: 0.840 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.213219165802002
Epoch: 14, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.883 Vali Acc: 0.822 Test Loss: 0.883 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.241337537765503
Epoch: 15, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.919 Vali Acc: 0.817 Test Loss: 0.919 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0895237922668457
Epoch: 16, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.877 Vali Acc: 0.822 Test Loss: 0.877 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0942392349243164
Epoch: 17, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.003 Vali Acc: 0.839 Test Loss: 1.003 Test Acc: 0.839
Validation loss decreased (-0.822214 --> -0.838879).  Saving model ...
Epoch: 18 cost time: 1.147165060043335
Epoch: 18, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.859 Vali Acc: 0.856 Test Loss: 0.859 Test Acc: 0.856
Validation loss decreased (-0.838879 --> -0.855547).  Saving model ...
Epoch: 19 cost time: 1.1973154544830322
Epoch: 19, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.006 Vali Acc: 0.839 Test Loss: 1.006 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0763359069824219
Epoch: 20, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.991 Vali Acc: 0.861 Test Loss: 0.991 Test Acc: 0.861
Validation loss decreased (-0.855547 --> -0.861101).  Saving model ...
Epoch: 21 cost time: 1.085284948348999
Epoch: 21, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.009 Vali Acc: 0.844 Test Loss: 1.009 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2091972827911377
Epoch: 22, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.150 Vali Acc: 0.844 Test Loss: 1.150 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1427052021026611
Epoch: 23, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.997 Vali Acc: 0.856 Test Loss: 0.997 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.023521900177002
Epoch: 24, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.065 Vali Acc: 0.839 Test Loss: 1.065 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.084446668624878
Epoch: 25, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.088 Vali Acc: 0.844 Test Loss: 1.088 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9679369926452637
Epoch: 26, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.083 Vali Acc: 0.850 Test Loss: 1.083 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0309062004089355
Epoch: 27, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.115 Vali Acc: 0.867 Test Loss: 1.115 Test Acc: 0.867
Validation loss decreased (-0.861101 --> -0.866656).  Saving model ...
Epoch: 28 cost time: 1.1726725101470947
Epoch: 28, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.282 Vali Acc: 0.861 Test Loss: 1.282 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2142717838287354
Epoch: 29, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.315 Vali Acc: 0.844 Test Loss: 1.315 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.199913501739502
Epoch: 30, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.170 Vali Acc: 0.856 Test Loss: 1.170 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1496927738189697
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.142 Vali Acc: 0.850 Test Loss: 1.142 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.175654411315918
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.139 Vali Acc: 0.861 Test Loss: 1.139 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1485867500305176
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.189 Vali Acc: 0.872 Test Loss: 1.189 Test Acc: 0.872
Validation loss decreased (-0.866656 --> -0.872210).  Saving model ...
Epoch: 34 cost time: 1.1344118118286133
Epoch: 34, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.149 Vali Acc: 0.844 Test Loss: 1.149 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.201918601989746
Epoch: 35, Steps: 12 | Train Loss: 0.115 Vali Loss: 1.134 Vali Acc: 0.861 Test Loss: 1.134 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.200549840927124
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.121 Vali Acc: 0.867 Test Loss: 1.121 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1346065998077393
Epoch: 37, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.152 Vali Acc: 0.850 Test Loss: 1.152 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.119596004486084
Epoch: 38, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.210 Vali Acc: 0.867 Test Loss: 1.210 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2056188583374023
Epoch: 39, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.190 Vali Acc: 0.856 Test Loss: 1.190 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1312499046325684
Epoch: 40, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.653 Vali Acc: 0.789 Test Loss: 1.653 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.1793246269226074
Epoch: 41, Steps: 12 | Train Loss: 0.189 Vali Loss: 1.540 Vali Acc: 0.806 Test Loss: 1.540 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.1753077507019043
Epoch: 42, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.366 Vali Acc: 0.822 Test Loss: 1.366 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.3252758979797363
Epoch: 43, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.410 Vali Acc: 0.833 Test Loss: 1.410 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 924047
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1629254817962646
Epoch: 1, Steps: 12 | Train Loss: 2.755 Vali Loss: 2.626 Vali Acc: 0.161 Test Loss: 2.626 Test Acc: 0.161
Validation loss decreased (inf --> -0.161085).  Saving model ...
Epoch: 2 cost time: 0.9735608100891113
Epoch: 2, Steps: 12 | Train Loss: 2.457 Vali Loss: 2.359 Vali Acc: 0.467 Test Loss: 2.359 Test Acc: 0.467
Validation loss decreased (-0.161085 --> -0.466643).  Saving model ...
Epoch: 3 cost time: 1.1394753456115723
Epoch: 3, Steps: 12 | Train Loss: 2.028 Vali Loss: 1.940 Vali Acc: 0.539 Test Loss: 1.940 Test Acc: 0.539
Validation loss decreased (-0.466643 --> -0.538869).  Saving model ...
Epoch: 4 cost time: 1.1605331897735596
Epoch: 4, Steps: 12 | Train Loss: 1.492 Vali Loss: 1.490 Vali Acc: 0.583 Test Loss: 1.490 Test Acc: 0.583
Validation loss decreased (-0.538869 --> -0.583318).  Saving model ...
Epoch: 5 cost time: 1.1685442924499512
Epoch: 5, Steps: 12 | Train Loss: 1.129 Vali Loss: 1.207 Vali Acc: 0.644 Test Loss: 1.207 Test Acc: 0.644
Validation loss decreased (-0.583318 --> -0.644432).  Saving model ...
Epoch: 6 cost time: 0.9948844909667969
Epoch: 6, Steps: 12 | Train Loss: 0.839 Vali Loss: 1.021 Vali Acc: 0.667 Test Loss: 1.021 Test Acc: 0.667
Validation loss decreased (-0.644432 --> -0.666656).  Saving model ...
Epoch: 7 cost time: 0.9971187114715576
Epoch: 7, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.945 Vali Acc: 0.683 Test Loss: 0.945 Test Acc: 0.683
Validation loss decreased (-0.666656 --> -0.683324).  Saving model ...
Epoch: 8 cost time: 1.0496978759765625
Epoch: 8, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.889 Vali Acc: 0.711 Test Loss: 0.889 Test Acc: 0.711
Validation loss decreased (-0.683324 --> -0.711102).  Saving model ...
Epoch: 9 cost time: 1.0492939949035645
Epoch: 9, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.795 Vali Acc: 0.744 Test Loss: 0.795 Test Acc: 0.744
Validation loss decreased (-0.711102 --> -0.744436).  Saving model ...
Epoch: 10 cost time: 0.9600560665130615
Epoch: 10, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.759 Vali Acc: 0.789 Test Loss: 0.759 Test Acc: 0.789
Validation loss decreased (-0.744436 --> -0.788881).  Saving model ...
Epoch: 11 cost time: 0.9857232570648193
Epoch: 11, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.752 Vali Acc: 0.794 Test Loss: 0.752 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794437).  Saving model ...
Epoch: 12 cost time: 1.0181658267974854
Epoch: 12, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.750 Vali Acc: 0.828 Test Loss: 0.750 Test Acc: 0.828
Validation loss decreased (-0.794437 --> -0.827770).  Saving model ...
Epoch: 13 cost time: 1.005152940750122
Epoch: 13, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.623 Vali Acc: 0.822 Test Loss: 0.623 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0651335716247559
Epoch: 14, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.628 Vali Acc: 0.844 Test Loss: 0.628 Test Acc: 0.844
Validation loss decreased (-0.827770 --> -0.844438).  Saving model ...
Epoch: 15 cost time: 1.0867693424224854
Epoch: 15, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.691 Vali Acc: 0.822 Test Loss: 0.691 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0894641876220703
Epoch: 16, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.685 Vali Acc: 0.839 Test Loss: 0.685 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1400701999664307
Epoch: 17, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.668 Vali Acc: 0.861 Test Loss: 0.668 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861104).  Saving model ...
Epoch: 18 cost time: 1.0956225395202637
Epoch: 18, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.711 Vali Acc: 0.850 Test Loss: 0.711 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0344023704528809
Epoch: 19, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.765 Vali Acc: 0.806 Test Loss: 0.765 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0508322715759277
Epoch: 20, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.778 Vali Acc: 0.833 Test Loss: 0.778 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9313042163848877
Epoch: 21, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.764 Vali Acc: 0.861 Test Loss: 0.764 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.996680498123169
Epoch: 22, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.769 Vali Acc: 0.850 Test Loss: 0.769 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0089333057403564
Epoch: 23, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.813 Vali Acc: 0.833 Test Loss: 0.813 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0074467658996582
Epoch: 24, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.823 Vali Acc: 0.867 Test Loss: 0.823 Test Acc: 0.867
Validation loss decreased (-0.861104 --> -0.866658).  Saving model ...
Epoch: 25 cost time: 0.9693131446838379
Epoch: 25, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.802 Vali Acc: 0.867 Test Loss: 0.802 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866659).  Saving model ...
Epoch: 26 cost time: 1.0837280750274658
Epoch: 26, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.811 Vali Acc: 0.856 Test Loss: 0.811 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0217475891113281
Epoch: 27, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.918 Vali Acc: 0.856 Test Loss: 0.918 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.051762342453003
Epoch: 28, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.826 Vali Acc: 0.872 Test Loss: 0.826 Test Acc: 0.872
Validation loss decreased (-0.866659 --> -0.872214).  Saving model ...
Epoch: 29 cost time: 1.0643062591552734
Epoch: 29, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.836 Vali Acc: 0.878 Test Loss: 0.836 Test Acc: 0.878
Validation loss decreased (-0.872214 --> -0.877769).  Saving model ...
Epoch: 30 cost time: 1.0424141883850098
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.891 Vali Acc: 0.861 Test Loss: 0.891 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.016084909439087
Epoch: 31, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.921 Vali Acc: 0.856 Test Loss: 0.921 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.040884017944336
Epoch: 32, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.859 Vali Acc: 0.878 Test Loss: 0.859 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.039123773574829
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.837 Vali Acc: 0.878 Test Loss: 0.837 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.000791311264038
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.862 Vali Acc: 0.872 Test Loss: 0.862 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1342461109161377
Epoch: 35, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.899 Vali Acc: 0.872 Test Loss: 0.899 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0456373691558838
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.904 Vali Acc: 0.867 Test Loss: 0.904 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.0098662376403809
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.903 Vali Acc: 0.861 Test Loss: 0.903 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0342023372650146
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.911 Vali Acc: 0.867 Test Loss: 0.911 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.0590181350708008
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.926 Vali Acc: 0.867 Test Loss: 0.926 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 832015
model size : 3.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4175286293029785
Epoch: 1, Steps: 12 | Train Loss: 2.683 Vali Loss: 2.613 Vali Acc: 0.178 Test Loss: 2.613 Test Acc: 0.178
Validation loss decreased (inf --> -0.177752).  Saving model ...
Epoch: 2 cost time: 1.0571417808532715
Epoch: 2, Steps: 12 | Train Loss: 2.381 Vali Loss: 2.312 Vali Acc: 0.433 Test Loss: 2.312 Test Acc: 0.433
Validation loss decreased (-0.177752 --> -0.433310).  Saving model ...
Epoch: 3 cost time: 1.015592098236084
Epoch: 3, Steps: 12 | Train Loss: 1.902 Vali Loss: 1.864 Vali Acc: 0.556 Test Loss: 1.864 Test Acc: 0.556
Validation loss decreased (-0.433310 --> -0.555537).  Saving model ...
Epoch: 4 cost time: 1.0131826400756836
Epoch: 4, Steps: 12 | Train Loss: 1.380 Vali Loss: 1.459 Vali Acc: 0.633 Test Loss: 1.459 Test Acc: 0.633
Validation loss decreased (-0.555537 --> -0.633319).  Saving model ...
Epoch: 5 cost time: 1.0945816040039062
Epoch: 5, Steps: 12 | Train Loss: 1.038 Vali Loss: 1.175 Vali Acc: 0.644 Test Loss: 1.175 Test Acc: 0.644
Validation loss decreased (-0.633319 --> -0.644433).  Saving model ...
Epoch: 6 cost time: 1.0835144519805908
Epoch: 6, Steps: 12 | Train Loss: 0.807 Vali Loss: 1.021 Vali Acc: 0.672 Test Loss: 1.021 Test Acc: 0.672
Validation loss decreased (-0.644433 --> -0.672212).  Saving model ...
Epoch: 7 cost time: 1.0012497901916504
Epoch: 7, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.922 Vali Acc: 0.706 Test Loss: 0.922 Test Acc: 0.706
Validation loss decreased (-0.672212 --> -0.705546).  Saving model ...
Epoch: 8 cost time: 1.0504376888275146
Epoch: 8, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.883 Vali Acc: 0.744 Test Loss: 0.883 Test Acc: 0.744
Validation loss decreased (-0.705546 --> -0.744436).  Saving model ...
Epoch: 9 cost time: 1.0790400505065918
Epoch: 9, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.779 Vali Acc: 0.767 Test Loss: 0.779 Test Acc: 0.767
Validation loss decreased (-0.744436 --> -0.766659).  Saving model ...
Epoch: 10 cost time: 1.0001425743103027
Epoch: 10, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.699 Vali Acc: 0.789 Test Loss: 0.699 Test Acc: 0.789
Validation loss decreased (-0.766659 --> -0.788882).  Saving model ...
Epoch: 11 cost time: 1.0533385276794434
Epoch: 11, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.686 Vali Acc: 0.800 Test Loss: 0.686 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 1.0138826370239258
Epoch: 12, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.703 Vali Acc: 0.811 Test Loss: 0.703 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 13 cost time: 0.9877281188964844
Epoch: 13, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.666 Vali Acc: 0.822 Test Loss: 0.666 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822216).  Saving model ...
Epoch: 14 cost time: 1.0290560722351074
Epoch: 14, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.737 Vali Acc: 0.822 Test Loss: 0.737 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0208353996276855
Epoch: 15, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.642 Vali Acc: 0.844 Test Loss: 0.642 Test Acc: 0.844
Validation loss decreased (-0.822216 --> -0.844438).  Saving model ...
Epoch: 16 cost time: 1.009462833404541
Epoch: 16, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.690 Vali Acc: 0.850 Test Loss: 0.690 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849993).  Saving model ...
Epoch: 17 cost time: 1.0592126846313477
Epoch: 17, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.710 Vali Acc: 0.833 Test Loss: 0.710 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0989990234375
Epoch: 18, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.713 Vali Acc: 0.861 Test Loss: 0.713 Test Acc: 0.861
Validation loss decreased (-0.849993 --> -0.861104).  Saving model ...
Epoch: 19 cost time: 1.1013212203979492
Epoch: 19, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.690 Vali Acc: 0.867 Test Loss: 0.690 Test Acc: 0.867
Validation loss decreased (-0.861104 --> -0.866660).  Saving model ...
Epoch: 20 cost time: 1.095306396484375
Epoch: 20, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.710 Vali Acc: 0.861 Test Loss: 0.710 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1124980449676514
Epoch: 21, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.727 Vali Acc: 0.867 Test Loss: 0.727 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0125789642333984
Epoch: 22, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.762 Vali Acc: 0.861 Test Loss: 0.762 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0591554641723633
Epoch: 23, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.773 Vali Acc: 0.850 Test Loss: 0.773 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.046905755996704
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.772 Vali Acc: 0.878 Test Loss: 0.772 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877770).  Saving model ...
Epoch: 25 cost time: 0.98468017578125
Epoch: 25, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.832 Vali Acc: 0.850 Test Loss: 0.832 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0419182777404785
Epoch: 26, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.835 Vali Acc: 0.867 Test Loss: 0.835 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0014734268188477
Epoch: 27, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.852 Vali Acc: 0.861 Test Loss: 0.852 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0887930393218994
Epoch: 28, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.837 Vali Acc: 0.861 Test Loss: 0.837 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.079467535018921
Epoch: 29, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.798 Vali Acc: 0.850 Test Loss: 0.798 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0849120616912842
Epoch: 30, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.825 Vali Acc: 0.856 Test Loss: 0.825 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0951440334320068
Epoch: 31, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.852 Vali Acc: 0.856 Test Loss: 0.852 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.092900276184082
Epoch: 32, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.825 Vali Acc: 0.861 Test Loss: 0.825 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.026709794998169
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.823 Vali Acc: 0.867 Test Loss: 0.823 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0764620304107666
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.874 Vali Acc: 0.872 Test Loss: 0.874 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 832143
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.407533645629883
Epoch: 1, Steps: 12 | Train Loss: 2.702 Vali Loss: 2.611 Vali Acc: 0.222 Test Loss: 2.611 Test Acc: 0.222
Validation loss decreased (inf --> -0.222196).  Saving model ...
Epoch: 2 cost time: 1.0275521278381348
Epoch: 2, Steps: 12 | Train Loss: 2.469 Vali Loss: 2.380 Vali Acc: 0.400 Test Loss: 2.380 Test Acc: 0.400
Validation loss decreased (-0.222196 --> -0.399976).  Saving model ...
Epoch: 3 cost time: 1.0656185150146484
Epoch: 3, Steps: 12 | Train Loss: 2.101 Vali Loss: 2.033 Vali Acc: 0.539 Test Loss: 2.033 Test Acc: 0.539
Validation loss decreased (-0.399976 --> -0.538869).  Saving model ...
Epoch: 4 cost time: 1.096156358718872
Epoch: 4, Steps: 12 | Train Loss: 1.664 Vali Loss: 1.657 Vali Acc: 0.606 Test Loss: 1.657 Test Acc: 0.606
Validation loss decreased (-0.538869 --> -0.605539).  Saving model ...
Epoch: 5 cost time: 1.1041862964630127
Epoch: 5, Steps: 12 | Train Loss: 1.326 Vali Loss: 1.345 Vali Acc: 0.644 Test Loss: 1.345 Test Acc: 0.644
Validation loss decreased (-0.605539 --> -0.644431).  Saving model ...
Epoch: 6 cost time: 1.0765066146850586
Epoch: 6, Steps: 12 | Train Loss: 0.983 Vali Loss: 1.129 Vali Acc: 0.689 Test Loss: 1.129 Test Acc: 0.689
Validation loss decreased (-0.644431 --> -0.688878).  Saving model ...
Epoch: 7 cost time: 1.0059072971343994
Epoch: 7, Steps: 12 | Train Loss: 0.814 Vali Loss: 0.987 Vali Acc: 0.694 Test Loss: 0.987 Test Acc: 0.694
Validation loss decreased (-0.688878 --> -0.694435).  Saving model ...
Epoch: 8 cost time: 1.0155143737792969
Epoch: 8, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.886 Vali Acc: 0.739 Test Loss: 0.886 Test Acc: 0.739
Validation loss decreased (-0.694435 --> -0.738880).  Saving model ...
Epoch: 9 cost time: 1.0519516468048096
Epoch: 9, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.814 Vali Acc: 0.761 Test Loss: 0.814 Test Acc: 0.761
Validation loss decreased (-0.738880 --> -0.761103).  Saving model ...
Epoch: 10 cost time: 1.0682661533355713
Epoch: 10, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.726 Vali Acc: 0.789 Test Loss: 0.726 Test Acc: 0.789
Validation loss decreased (-0.761103 --> -0.788882).  Saving model ...
Epoch: 11 cost time: 1.066969633102417
Epoch: 11, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.726 Vali Acc: 0.806 Test Loss: 0.726 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805548).  Saving model ...
Epoch: 12 cost time: 1.1042485237121582
Epoch: 12, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.654 Vali Acc: 0.822 Test Loss: 0.654 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822216).  Saving model ...
Epoch: 13 cost time: 1.0618951320648193
Epoch: 13, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.640 Vali Acc: 0.822 Test Loss: 0.640 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 14 cost time: 1.1102991104125977
Epoch: 14, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.640 Vali Acc: 0.839 Test Loss: 0.640 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838882).  Saving model ...
Epoch: 15 cost time: 1.1175062656402588
Epoch: 15, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.633 Vali Acc: 0.833 Test Loss: 0.633 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1101884841918945
Epoch: 16, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.634 Vali Acc: 0.856 Test Loss: 0.634 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855549).  Saving model ...
Epoch: 17 cost time: 1.132854700088501
Epoch: 17, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.627 Vali Acc: 0.844 Test Loss: 0.627 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0386624336242676
Epoch: 18, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.641 Vali Acc: 0.850 Test Loss: 0.641 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0232641696929932
Epoch: 19, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.661 Vali Acc: 0.856 Test Loss: 0.661 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0965445041656494
Epoch: 20, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.678 Vali Acc: 0.872 Test Loss: 0.678 Test Acc: 0.872
Validation loss decreased (-0.855549 --> -0.872215).  Saving model ...
Epoch: 21 cost time: 1.0503997802734375
Epoch: 21, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.701 Vali Acc: 0.867 Test Loss: 0.701 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0532758235931396
Epoch: 22, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.681 Vali Acc: 0.867 Test Loss: 0.681 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0272746086120605
Epoch: 23, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.698 Vali Acc: 0.878 Test Loss: 0.698 Test Acc: 0.878
Validation loss decreased (-0.872215 --> -0.877771).  Saving model ...
Epoch: 24 cost time: 1.101771593093872
Epoch: 24, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.709 Vali Acc: 0.872 Test Loss: 0.709 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1661484241485596
Epoch: 25, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.760 Vali Acc: 0.861 Test Loss: 0.760 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.063415765762329
Epoch: 26, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.747 Vali Acc: 0.872 Test Loss: 0.747 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0967371463775635
Epoch: 27, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.769 Vali Acc: 0.883 Test Loss: 0.769 Test Acc: 0.883
Validation loss decreased (-0.877771 --> -0.883326).  Saving model ...
Epoch: 28 cost time: 1.0387535095214844
Epoch: 28, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.767 Vali Acc: 0.872 Test Loss: 0.767 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0378787517547607
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.774 Vali Acc: 0.872 Test Loss: 0.774 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9869182109832764
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.796 Vali Acc: 0.878 Test Loss: 0.796 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.055964469909668
Epoch: 31, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.843 Vali Acc: 0.856 Test Loss: 0.843 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.076977252960205
Epoch: 32, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.877 Vali Acc: 0.867 Test Loss: 0.877 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.090284824371338
Epoch: 33, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.852 Vali Acc: 0.861 Test Loss: 0.852 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0090713500976562
Epoch: 34, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.891 Vali Acc: 0.856 Test Loss: 0.891 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.0192811489105225
Epoch: 35, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.919 Vali Acc: 0.867 Test Loss: 0.919 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.0821905136108398
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.823 Vali Acc: 0.878 Test Loss: 0.823 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.1411335468292236
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.856 Vali Acc: 0.872 Test Loss: 0.856 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 809231
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.190793514251709
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.655 Vali Acc: 0.106 Test Loss: 2.655 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 0.9736783504486084
Epoch: 2, Steps: 12 | Train Loss: 2.498 Vali Loss: 2.448 Vali Acc: 0.267 Test Loss: 2.448 Test Acc: 0.267
Validation loss decreased (-0.105529 --> -0.266642).  Saving model ...
Epoch: 3 cost time: 0.9518229961395264
Epoch: 3, Steps: 12 | Train Loss: 2.139 Vali Loss: 2.115 Vali Acc: 0.489 Test Loss: 2.115 Test Acc: 0.489
Validation loss decreased (-0.266642 --> -0.488868).  Saving model ...
Epoch: 4 cost time: 0.9761030673980713
Epoch: 4, Steps: 12 | Train Loss: 1.813 Vali Loss: 1.740 Vali Acc: 0.556 Test Loss: 1.740 Test Acc: 0.556
Validation loss decreased (-0.488868 --> -0.555538).  Saving model ...
Epoch: 5 cost time: 1.000288963317871
Epoch: 5, Steps: 12 | Train Loss: 1.426 Vali Loss: 1.435 Vali Acc: 0.650 Test Loss: 1.435 Test Acc: 0.650
Validation loss decreased (-0.555538 --> -0.649986).  Saving model ...
Epoch: 6 cost time: 1.081749439239502
Epoch: 6, Steps: 12 | Train Loss: 1.089 Vali Loss: 1.195 Vali Acc: 0.694 Test Loss: 1.195 Test Acc: 0.694
Validation loss decreased (-0.649986 --> -0.694432).  Saving model ...
Epoch: 7 cost time: 1.0309128761291504
Epoch: 7, Steps: 12 | Train Loss: 0.850 Vali Loss: 1.064 Vali Acc: 0.678 Test Loss: 1.064 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0022594928741455
Epoch: 8, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.957 Vali Acc: 0.711 Test Loss: 0.957 Test Acc: 0.711
Validation loss decreased (-0.694432 --> -0.711102).  Saving model ...
Epoch: 9 cost time: 1.0775399208068848
Epoch: 9, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.861 Vali Acc: 0.711 Test Loss: 0.861 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711103).  Saving model ...
Epoch: 10 cost time: 1.0195732116699219
Epoch: 10, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.799 Vali Acc: 0.761 Test Loss: 0.799 Test Acc: 0.761
Validation loss decreased (-0.711103 --> -0.761103).  Saving model ...
Epoch: 11 cost time: 1.01483154296875
Epoch: 11, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.706 Vali Acc: 0.811 Test Loss: 0.706 Test Acc: 0.811
Validation loss decreased (-0.761103 --> -0.811104).  Saving model ...
Epoch: 12 cost time: 0.9662318229675293
Epoch: 12, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.694 Vali Acc: 0.811 Test Loss: 0.694 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 13 cost time: 0.9745194911956787
Epoch: 13, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.684 Vali Acc: 0.817 Test Loss: 0.684 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 14 cost time: 0.9800057411193848
Epoch: 14, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.603 Vali Acc: 0.833 Test Loss: 0.603 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 15 cost time: 1.016800880432129
Epoch: 15, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.609 Vali Acc: 0.844 Test Loss: 0.609 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 16 cost time: 0.9960002899169922
Epoch: 16, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.622 Vali Acc: 0.850 Test Loss: 0.622 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 0.9682743549346924
Epoch: 17, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.649 Vali Acc: 0.839 Test Loss: 0.649 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0137367248535156
Epoch: 18, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.656 Vali Acc: 0.839 Test Loss: 0.656 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0071594715118408
Epoch: 19, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.621 Vali Acc: 0.867 Test Loss: 0.621 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866660).  Saving model ...
Epoch: 20 cost time: 1.0265154838562012
Epoch: 20, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.636 Vali Acc: 0.867 Test Loss: 0.636 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.014007329940796
Epoch: 21, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.620 Vali Acc: 0.856 Test Loss: 0.620 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0307965278625488
Epoch: 22, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.625 Vali Acc: 0.856 Test Loss: 0.625 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0104014873504639
Epoch: 23, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.636 Vali Acc: 0.867 Test Loss: 0.636 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9815490245819092
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.693 Vali Acc: 0.883 Test Loss: 0.693 Test Acc: 0.883
Validation loss decreased (-0.866660 --> -0.883326).  Saving model ...
Epoch: 25 cost time: 0.9969260692596436
Epoch: 25, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.686 Vali Acc: 0.850 Test Loss: 0.686 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9994332790374756
Epoch: 26, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.763 Vali Acc: 0.867 Test Loss: 0.763 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9689950942993164
Epoch: 27, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.780 Vali Acc: 0.850 Test Loss: 0.780 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.991600751876831
Epoch: 28, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.729 Vali Acc: 0.844 Test Loss: 0.729 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9099998474121094
Epoch: 29, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.725 Vali Acc: 0.878 Test Loss: 0.725 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0445210933685303
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.740 Vali Acc: 0.867 Test Loss: 0.740 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0214593410491943
Epoch: 31, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.753 Vali Acc: 0.889 Test Loss: 0.753 Test Acc: 0.889
Validation loss decreased (-0.883326 --> -0.888881).  Saving model ...
Epoch: 32 cost time: 1.0754988193511963
Epoch: 32, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.787 Vali Acc: 0.872 Test Loss: 0.787 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0360538959503174
Epoch: 33, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.838 Vali Acc: 0.872 Test Loss: 0.838 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0733895301818848
Epoch: 34, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.802 Vali Acc: 0.856 Test Loss: 0.802 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9857804775238037
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.783 Vali Acc: 0.867 Test Loss: 0.783 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9976065158843994
Epoch: 36, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.804 Vali Acc: 0.872 Test Loss: 0.804 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2180054187774658
Epoch: 37, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.835 Vali Acc: 0.872 Test Loss: 0.835 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.1736884117126465
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.820 Vali Acc: 0.872 Test Loss: 0.820 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.0936064720153809
Epoch: 39, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.841 Vali Acc: 0.878 Test Loss: 0.841 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.1042287349700928
Epoch: 40, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.867 Vali Acc: 0.872 Test Loss: 0.867 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.1048693656921387
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.879 Vali Acc: 0.861 Test Loss: 0.879 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 794127
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2618377208709717
Epoch: 1, Steps: 12 | Train Loss: 2.717 Vali Loss: 2.665 Vali Acc: 0.094 Test Loss: 2.665 Test Acc: 0.094
Validation loss decreased (inf --> -0.094418).  Saving model ...
Epoch: 2 cost time: 1.0508530139923096
Epoch: 2, Steps: 12 | Train Loss: 2.539 Vali Loss: 2.487 Vali Acc: 0.389 Test Loss: 2.487 Test Acc: 0.389
Validation loss decreased (-0.094418 --> -0.388864).  Saving model ...
Epoch: 3 cost time: 0.9963233470916748
Epoch: 3, Steps: 12 | Train Loss: 2.238 Vali Loss: 2.201 Vali Acc: 0.550 Test Loss: 2.201 Test Acc: 0.550
Validation loss decreased (-0.388864 --> -0.549978).  Saving model ...
Epoch: 4 cost time: 1.0317883491516113
Epoch: 4, Steps: 12 | Train Loss: 1.879 Vali Loss: 1.864 Vali Acc: 0.617 Test Loss: 1.864 Test Acc: 0.617
Validation loss decreased (-0.549978 --> -0.616648).  Saving model ...
Epoch: 5 cost time: 0.9962179660797119
Epoch: 5, Steps: 12 | Train Loss: 1.545 Vali Loss: 1.537 Vali Acc: 0.644 Test Loss: 1.537 Test Acc: 0.644
Validation loss decreased (-0.616648 --> -0.644429).  Saving model ...
Epoch: 6 cost time: 0.9959378242492676
Epoch: 6, Steps: 12 | Train Loss: 1.225 Vali Loss: 1.292 Vali Acc: 0.667 Test Loss: 1.292 Test Acc: 0.667
Validation loss decreased (-0.644429 --> -0.666654).  Saving model ...
Epoch: 7 cost time: 1.0833337306976318
Epoch: 7, Steps: 12 | Train Loss: 0.997 Vali Loss: 1.130 Vali Acc: 0.667 Test Loss: 1.130 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666655).  Saving model ...
Epoch: 8 cost time: 1.0902924537658691
Epoch: 8, Steps: 12 | Train Loss: 0.799 Vali Loss: 0.967 Vali Acc: 0.722 Test Loss: 0.967 Test Acc: 0.722
Validation loss decreased (-0.666655 --> -0.722213).  Saving model ...
Epoch: 9 cost time: 1.020261526107788
Epoch: 9, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.858 Vali Acc: 0.744 Test Loss: 0.858 Test Acc: 0.744
Validation loss decreased (-0.722213 --> -0.744436).  Saving model ...
Epoch: 10 cost time: 1.0201494693756104
Epoch: 10, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.790 Vali Acc: 0.744 Test Loss: 0.790 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744437).  Saving model ...
Epoch: 11 cost time: 1.0325648784637451
Epoch: 11, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.737 Vali Acc: 0.772 Test Loss: 0.737 Test Acc: 0.772
Validation loss decreased (-0.744437 --> -0.772215).  Saving model ...
Epoch: 12 cost time: 1.064885139465332
Epoch: 12, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.661 Vali Acc: 0.800 Test Loss: 0.661 Test Acc: 0.800
Validation loss decreased (-0.772215 --> -0.799993).  Saving model ...
Epoch: 13 cost time: 0.9792311191558838
Epoch: 13, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.618 Vali Acc: 0.839 Test Loss: 0.618 Test Acc: 0.839
Validation loss decreased (-0.799993 --> -0.838883).  Saving model ...
Epoch: 14 cost time: 0.9488317966461182
Epoch: 14, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.621 Vali Acc: 0.839 Test Loss: 0.621 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9111871719360352
Epoch: 15, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.584 Vali Acc: 0.856 Test Loss: 0.584 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 16 cost time: 1.0514612197875977
Epoch: 16, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.587 Vali Acc: 0.844 Test Loss: 0.587 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9897024631500244
Epoch: 17, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9840538501739502
Epoch: 18, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.545 Vali Acc: 0.872 Test Loss: 0.545 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872217).  Saving model ...
Epoch: 19 cost time: 1.061079978942871
Epoch: 19, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.549 Vali Acc: 0.861 Test Loss: 0.549 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0588278770446777
Epoch: 20, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.560 Vali Acc: 0.867 Test Loss: 0.560 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.983165979385376
Epoch: 21, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.576 Vali Acc: 0.856 Test Loss: 0.576 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0077166557312012
Epoch: 22, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.563 Vali Acc: 0.878 Test Loss: 0.563 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 23 cost time: 1.0058441162109375
Epoch: 23, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.626 Vali Acc: 0.872 Test Loss: 0.626 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9735112190246582
Epoch: 24, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.653 Vali Acc: 0.839 Test Loss: 0.653 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0237164497375488
Epoch: 25, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.621 Vali Acc: 0.867 Test Loss: 0.621 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0231566429138184
Epoch: 26, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.601 Vali Acc: 0.889 Test Loss: 0.601 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888883).  Saving model ...
Epoch: 27 cost time: 1.009253978729248
Epoch: 27, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.626 Vali Acc: 0.867 Test Loss: 0.626 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.076413869857788
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.684 Vali Acc: 0.872 Test Loss: 0.684 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0074074268341064
Epoch: 29, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.693 Vali Acc: 0.883 Test Loss: 0.693 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0119273662567139
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.675 Vali Acc: 0.883 Test Loss: 0.675 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0023777484893799
Epoch: 31, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.690 Vali Acc: 0.878 Test Loss: 0.690 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9780750274658203
Epoch: 32, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.670 Vali Acc: 0.878 Test Loss: 0.670 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9974088668823242
Epoch: 33, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.680 Vali Acc: 0.883 Test Loss: 0.680 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9986200332641602
Epoch: 34, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.707 Vali Acc: 0.889 Test Loss: 0.707 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.9599013328552246
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.732 Vali Acc: 0.867 Test Loss: 0.732 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9208741188049316
Epoch: 36, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.724 Vali Acc: 0.878 Test Loss: 0.724 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 786703
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.245912790298462
Epoch: 1, Steps: 12 | Train Loss: 2.707 Vali Loss: 2.651 Vali Acc: 0.217 Test Loss: 2.651 Test Acc: 0.217
Validation loss decreased (inf --> -0.216640).  Saving model ...
Epoch: 2 cost time: 1.0582389831542969
Epoch: 2, Steps: 12 | Train Loss: 2.527 Vali Loss: 2.481 Vali Acc: 0.428 Test Loss: 2.481 Test Acc: 0.428
Validation loss decreased (-0.216640 --> -0.427753).  Saving model ...
Epoch: 3 cost time: 1.0879058837890625
Epoch: 3, Steps: 12 | Train Loss: 2.312 Vali Loss: 2.210 Vali Acc: 0.550 Test Loss: 2.210 Test Acc: 0.550
Validation loss decreased (-0.427753 --> -0.549978).  Saving model ...
Epoch: 4 cost time: 1.0767230987548828
Epoch: 4, Steps: 12 | Train Loss: 1.922 Vali Loss: 1.887 Vali Acc: 0.622 Test Loss: 1.887 Test Acc: 0.622
Validation loss decreased (-0.549978 --> -0.622203).  Saving model ...
Epoch: 5 cost time: 1.0869171619415283
Epoch: 5, Steps: 12 | Train Loss: 1.596 Vali Loss: 1.576 Vali Acc: 0.633 Test Loss: 1.576 Test Acc: 0.633
Validation loss decreased (-0.622203 --> -0.633318).  Saving model ...
Epoch: 6 cost time: 1.0197243690490723
Epoch: 6, Steps: 12 | Train Loss: 1.301 Vali Loss: 1.321 Vali Acc: 0.656 Test Loss: 1.321 Test Acc: 0.656
Validation loss decreased (-0.633318 --> -0.655542).  Saving model ...
Epoch: 7 cost time: 1.0220451354980469
Epoch: 7, Steps: 12 | Train Loss: 1.050 Vali Loss: 1.128 Vali Acc: 0.661 Test Loss: 1.128 Test Acc: 0.661
Validation loss decreased (-0.655542 --> -0.661100).  Saving model ...
Epoch: 8 cost time: 1.0387461185455322
Epoch: 8, Steps: 12 | Train Loss: 0.796 Vali Loss: 1.015 Vali Acc: 0.733 Test Loss: 1.015 Test Acc: 0.733
Validation loss decreased (-0.661100 --> -0.733323).  Saving model ...
Epoch: 9 cost time: 1.0016131401062012
Epoch: 9, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.904 Vali Acc: 0.756 Test Loss: 0.904 Test Acc: 0.756
Validation loss decreased (-0.733323 --> -0.755547).  Saving model ...
Epoch: 10 cost time: 1.0200610160827637
Epoch: 10, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.804 Vali Acc: 0.772 Test Loss: 0.804 Test Acc: 0.772
Validation loss decreased (-0.755547 --> -0.772214).  Saving model ...
Epoch: 11 cost time: 1.0398755073547363
Epoch: 11, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.730 Vali Acc: 0.783 Test Loss: 0.730 Test Acc: 0.783
Validation loss decreased (-0.772214 --> -0.783326).  Saving model ...
Epoch: 12 cost time: 1.0472538471221924
Epoch: 12, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.663 Vali Acc: 0.817 Test Loss: 0.663 Test Acc: 0.817
Validation loss decreased (-0.783326 --> -0.816660).  Saving model ...
Epoch: 13 cost time: 1.0788943767547607
Epoch: 13, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.626 Vali Acc: 0.822 Test Loss: 0.626 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 14 cost time: 1.0453195571899414
Epoch: 14, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.604 Vali Acc: 0.839 Test Loss: 0.604 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 15 cost time: 1.1195156574249268
Epoch: 15, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.573 Vali Acc: 0.811 Test Loss: 0.573 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0869226455688477
Epoch: 16, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849995).  Saving model ...
Epoch: 17 cost time: 1.0608201026916504
Epoch: 17, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.538 Vali Acc: 0.856 Test Loss: 0.538 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 18 cost time: 1.0825927257537842
Epoch: 18, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9922175407409668
Epoch: 19, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.529 Vali Acc: 0.861 Test Loss: 0.529 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 20 cost time: 0.999964714050293
Epoch: 20, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.515 Vali Acc: 0.861 Test Loss: 0.515 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 21 cost time: 1.091588020324707
Epoch: 21, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.522 Vali Acc: 0.856 Test Loss: 0.522 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0286357402801514
Epoch: 22, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.546 Vali Acc: 0.872 Test Loss: 0.546 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 23 cost time: 1.0068690776824951
Epoch: 23, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.531 Vali Acc: 0.844 Test Loss: 0.531 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9949138164520264
Epoch: 24, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.580 Vali Acc: 0.856 Test Loss: 0.580 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.029693603515625
Epoch: 25, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.558 Vali Acc: 0.878 Test Loss: 0.558 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 26 cost time: 1.0665931701660156
Epoch: 26, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.555 Vali Acc: 0.867 Test Loss: 0.555 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0424163341522217
Epoch: 27, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.577 Vali Acc: 0.883 Test Loss: 0.577 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 28 cost time: 1.1200473308563232
Epoch: 28, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.548 Vali Acc: 0.878 Test Loss: 0.548 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1504442691802979
Epoch: 29, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.561 Vali Acc: 0.861 Test Loss: 0.561 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0229685306549072
Epoch: 30, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.579 Vali Acc: 0.872 Test Loss: 0.579 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1525490283966064
Epoch: 31, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.586 Vali Acc: 0.867 Test Loss: 0.586 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0368638038635254
Epoch: 32, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.598 Vali Acc: 0.878 Test Loss: 0.598 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9953699111938477
Epoch: 33, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.611 Vali Acc: 0.878 Test Loss: 0.611 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9429616928100586
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.610 Vali Acc: 0.872 Test Loss: 0.610 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.0474224090576172
Epoch: 35, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.619 Vali Acc: 0.883 Test Loss: 0.619 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.0226829051971436
Epoch: 36, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.655 Vali Acc: 0.872 Test Loss: 0.655 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.0240612030029297
Epoch: 37, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.632 Vali Acc: 0.878 Test Loss: 0.632 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 779407
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3836753368377686
Epoch: 1, Steps: 12 | Train Loss: 2.675 Vali Loss: 2.618 Vali Acc: 0.239 Test Loss: 2.618 Test Acc: 0.239
Validation loss decreased (inf --> -0.238863).  Saving model ...
Epoch: 2 cost time: 0.8803970813751221
Epoch: 2, Steps: 12 | Train Loss: 2.392 Vali Loss: 2.357 Vali Acc: 0.411 Test Loss: 2.357 Test Acc: 0.411
Validation loss decreased (-0.238863 --> -0.411088).  Saving model ...
Epoch: 3 cost time: 0.8831510543823242
Epoch: 3, Steps: 12 | Train Loss: 2.016 Vali Loss: 1.956 Vali Acc: 0.567 Test Loss: 1.956 Test Acc: 0.567
Validation loss decreased (-0.411088 --> -0.566647).  Saving model ...
Epoch: 4 cost time: 0.8787841796875
Epoch: 4, Steps: 12 | Train Loss: 1.619 Vali Loss: 1.551 Vali Acc: 0.567 Test Loss: 1.551 Test Acc: 0.567
Validation loss decreased (-0.566647 --> -0.566651).  Saving model ...
Epoch: 5 cost time: 0.8294458389282227
Epoch: 5, Steps: 12 | Train Loss: 1.221 Vali Loss: 1.286 Vali Acc: 0.622 Test Loss: 1.286 Test Acc: 0.622
Validation loss decreased (-0.566651 --> -0.622209).  Saving model ...
Epoch: 6 cost time: 0.9087224006652832
Epoch: 6, Steps: 12 | Train Loss: 0.942 Vali Loss: 1.070 Vali Acc: 0.656 Test Loss: 1.070 Test Acc: 0.656
Validation loss decreased (-0.622209 --> -0.655545).  Saving model ...
Epoch: 7 cost time: 0.9090254306793213
Epoch: 7, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.978 Vali Acc: 0.678 Test Loss: 0.978 Test Acc: 0.678
Validation loss decreased (-0.655545 --> -0.677768).  Saving model ...
Epoch: 8 cost time: 0.8890674114227295
Epoch: 8, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.921 Vali Acc: 0.689 Test Loss: 0.921 Test Acc: 0.689
Validation loss decreased (-0.677768 --> -0.688880).  Saving model ...
Epoch: 9 cost time: 0.9009928703308105
Epoch: 9, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.864 Vali Acc: 0.683 Test Loss: 0.864 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8969330787658691
Epoch: 10, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.862 Vali Acc: 0.728 Test Loss: 0.862 Test Acc: 0.728
Validation loss decreased (-0.688880 --> -0.727769).  Saving model ...
Epoch: 11 cost time: 0.9180850982666016
Epoch: 11, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.863 Vali Acc: 0.761 Test Loss: 0.863 Test Acc: 0.761
Validation loss decreased (-0.727769 --> -0.761102).  Saving model ...
Epoch: 12 cost time: 0.9461531639099121
Epoch: 12, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.832 Vali Acc: 0.778 Test Loss: 0.832 Test Acc: 0.778
Validation loss decreased (-0.761102 --> -0.777769).  Saving model ...
Epoch: 13 cost time: 0.8327648639678955
Epoch: 13, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.795 Vali Acc: 0.756 Test Loss: 0.795 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8783373832702637
Epoch: 14, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.939 Vali Acc: 0.733 Test Loss: 0.939 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8278024196624756
Epoch: 15, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.795 Vali Acc: 0.811 Test Loss: 0.795 Test Acc: 0.811
Validation loss decreased (-0.777769 --> -0.811103).  Saving model ...
Epoch: 16 cost time: 0.8689253330230713
Epoch: 16, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.855 Vali Acc: 0.811 Test Loss: 0.855 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8542160987854004
Epoch: 17, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.796 Vali Acc: 0.800 Test Loss: 0.796 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9029638767242432
Epoch: 18, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.864 Vali Acc: 0.789 Test Loss: 0.864 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8744008541107178
Epoch: 19, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.854 Vali Acc: 0.822 Test Loss: 0.854 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822214).  Saving model ...
Epoch: 20 cost time: 0.9094099998474121
Epoch: 20, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.900 Vali Acc: 0.794 Test Loss: 0.900 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8995985984802246
Epoch: 21, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.897 Vali Acc: 0.806 Test Loss: 0.897 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9188132286071777
Epoch: 22, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.877 Vali Acc: 0.811 Test Loss: 0.877 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8833878040313721
Epoch: 23, Steps: 12 | Train Loss: 0.088 Vali Loss: 1.092 Vali Acc: 0.806 Test Loss: 1.092 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9206883907318115
Epoch: 24, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.968 Vali Acc: 0.828 Test Loss: 0.968 Test Acc: 0.828
Validation loss decreased (-0.822214 --> -0.827768).  Saving model ...
Epoch: 25 cost time: 0.9400355815887451
Epoch: 25, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.998 Vali Acc: 0.822 Test Loss: 0.998 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8248257637023926
Epoch: 26, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.945 Vali Acc: 0.833 Test Loss: 0.945 Test Acc: 0.833
Validation loss decreased (-0.827768 --> -0.833324).  Saving model ...
Epoch: 27 cost time: 0.9140591621398926
Epoch: 27, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.886 Vali Acc: 0.822 Test Loss: 0.886 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9560742378234863
Epoch: 28, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.951 Vali Acc: 0.861 Test Loss: 0.951 Test Acc: 0.861
Validation loss decreased (-0.833324 --> -0.861102).  Saving model ...
Epoch: 29 cost time: 0.7965025901794434
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.929 Vali Acc: 0.850 Test Loss: 0.929 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8789420127868652
Epoch: 30, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.917 Vali Acc: 0.844 Test Loss: 0.917 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8460628986358643
Epoch: 31, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.918 Vali Acc: 0.839 Test Loss: 0.918 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9566991329193115
Epoch: 32, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.932 Vali Acc: 0.833 Test Loss: 0.932 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9543857574462891
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.993 Vali Acc: 0.839 Test Loss: 0.993 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9055020809173584
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.003 Vali Acc: 0.833 Test Loss: 1.003 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.859623908996582
Epoch: 35, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.009 Vali Acc: 0.828 Test Loss: 1.009 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8949425220489502
Epoch: 36, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.019 Vali Acc: 0.833 Test Loss: 1.019 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.02754807472229
Epoch: 37, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.013 Vali Acc: 0.856 Test Loss: 1.013 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9031510353088379
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.958 Vali Acc: 0.850 Test Loss: 0.958 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 281807
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.058408260345459
Epoch: 1, Steps: 12 | Train Loss: 2.714 Vali Loss: 2.630 Vali Acc: 0.139 Test Loss: 2.630 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 0.7998600006103516
Epoch: 2, Steps: 12 | Train Loss: 2.607 Vali Loss: 2.489 Vali Acc: 0.317 Test Loss: 2.489 Test Acc: 0.317
Validation loss decreased (-0.138863 --> -0.316642).  Saving model ...
Epoch: 3 cost time: 0.9027273654937744
Epoch: 3, Steps: 12 | Train Loss: 2.335 Vali Loss: 2.261 Vali Acc: 0.500 Test Loss: 2.261 Test Acc: 0.500
Validation loss decreased (-0.316642 --> -0.499977).  Saving model ...
Epoch: 4 cost time: 0.8905832767486572
Epoch: 4, Steps: 12 | Train Loss: 2.053 Vali Loss: 1.950 Vali Acc: 0.572 Test Loss: 1.950 Test Acc: 0.572
Validation loss decreased (-0.499977 --> -0.572203).  Saving model ...
Epoch: 5 cost time: 0.8927350044250488
Epoch: 5, Steps: 12 | Train Loss: 1.721 Vali Loss: 1.666 Vali Acc: 0.594 Test Loss: 1.666 Test Acc: 0.594
Validation loss decreased (-0.572203 --> -0.594428).  Saving model ...
Epoch: 6 cost time: 0.924414873123169
Epoch: 6, Steps: 12 | Train Loss: 1.342 Vali Loss: 1.397 Vali Acc: 0.633 Test Loss: 1.397 Test Acc: 0.633
Validation loss decreased (-0.594428 --> -0.633319).  Saving model ...
Epoch: 7 cost time: 0.9123649597167969
Epoch: 7, Steps: 12 | Train Loss: 1.068 Vali Loss: 1.221 Vali Acc: 0.672 Test Loss: 1.221 Test Acc: 0.672
Validation loss decreased (-0.633319 --> -0.672210).  Saving model ...
Epoch: 8 cost time: 0.9316039085388184
Epoch: 8, Steps: 12 | Train Loss: 0.904 Vali Loss: 1.073 Vali Acc: 0.672 Test Loss: 1.073 Test Acc: 0.672
Validation loss decreased (-0.672210 --> -0.672211).  Saving model ...
Epoch: 9 cost time: 0.8869616985321045
Epoch: 9, Steps: 12 | Train Loss: 0.781 Vali Loss: 1.023 Vali Acc: 0.678 Test Loss: 1.023 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677768).  Saving model ...
Epoch: 10 cost time: 0.9036211967468262
Epoch: 10, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.943 Vali Acc: 0.667 Test Loss: 0.943 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8695147037506104
Epoch: 11, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.898 Vali Acc: 0.706 Test Loss: 0.898 Test Acc: 0.706
Validation loss decreased (-0.677768 --> -0.705547).  Saving model ...
Epoch: 12 cost time: 0.8655171394348145
Epoch: 12, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.814 Vali Acc: 0.750 Test Loss: 0.814 Test Acc: 0.750
Validation loss decreased (-0.705547 --> -0.749992).  Saving model ...
Epoch: 13 cost time: 0.8631229400634766
Epoch: 13, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.789 Vali Acc: 0.733 Test Loss: 0.789 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8877921104431152
Epoch: 14, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.781 Vali Acc: 0.778 Test Loss: 0.781 Test Acc: 0.778
Validation loss decreased (-0.749992 --> -0.777770).  Saving model ...
Epoch: 15 cost time: 0.8693842887878418
Epoch: 15, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.789 Vali Acc: 0.761 Test Loss: 0.789 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8661060333251953
Epoch: 16, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.739 Vali Acc: 0.767 Test Loss: 0.739 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8889670372009277
Epoch: 17, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.699 Vali Acc: 0.822 Test Loss: 0.699 Test Acc: 0.822
Validation loss decreased (-0.777770 --> -0.822215).  Saving model ...
Epoch: 18 cost time: 0.9222238063812256
Epoch: 18, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.688 Vali Acc: 0.822 Test Loss: 0.688 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 19 cost time: 0.9072616100311279
Epoch: 19, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.708 Vali Acc: 0.822 Test Loss: 0.708 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8879237174987793
Epoch: 20, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.681 Vali Acc: 0.822 Test Loss: 0.681 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 21 cost time: 0.8775346279144287
Epoch: 21, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.677 Vali Acc: 0.811 Test Loss: 0.677 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8658368587493896
Epoch: 22, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.696 Vali Acc: 0.833 Test Loss: 0.696 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833326).  Saving model ...
Epoch: 23 cost time: 0.9167845249176025
Epoch: 23, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.722 Vali Acc: 0.833 Test Loss: 0.722 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8770003318786621
Epoch: 24, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.717 Vali Acc: 0.828 Test Loss: 0.717 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8941841125488281
Epoch: 25, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.710 Vali Acc: 0.828 Test Loss: 0.710 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8667306900024414
Epoch: 26, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.727 Vali Acc: 0.833 Test Loss: 0.727 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8270387649536133
Epoch: 27, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.731 Vali Acc: 0.828 Test Loss: 0.731 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9302337169647217
Epoch: 28, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.761 Vali Acc: 0.861 Test Loss: 0.761 Test Acc: 0.861
Validation loss decreased (-0.833326 --> -0.861104).  Saving model ...
Epoch: 29 cost time: 0.8970193862915039
Epoch: 29, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.753 Vali Acc: 0.844 Test Loss: 0.753 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9435482025146484
Epoch: 30, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.766 Vali Acc: 0.850 Test Loss: 0.766 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8923063278198242
Epoch: 31, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.791 Vali Acc: 0.839 Test Loss: 0.791 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8876476287841797
Epoch: 32, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.811 Vali Acc: 0.850 Test Loss: 0.811 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8322639465332031
Epoch: 33, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.787 Vali Acc: 0.817 Test Loss: 0.787 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8869667053222656
Epoch: 34, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.839 Vali Acc: 0.844 Test Loss: 0.839 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8927514553070068
Epoch: 35, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.826 Vali Acc: 0.833 Test Loss: 0.826 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.855640172958374
Epoch: 36, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.775 Vali Acc: 0.839 Test Loss: 0.775 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.898979902267456
Epoch: 37, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.808 Vali Acc: 0.850 Test Loss: 0.808 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9534049034118652
Epoch: 38, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.887 Vali Acc: 0.828 Test Loss: 0.887 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 235791
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.177081346511841
Epoch: 1, Steps: 12 | Train Loss: 2.688 Vali Loss: 2.677 Vali Acc: 0.078 Test Loss: 2.677 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 0.898338794708252
Epoch: 2, Steps: 12 | Train Loss: 2.520 Vali Loss: 2.529 Vali Acc: 0.211 Test Loss: 2.529 Test Acc: 0.211
Validation loss decreased (-0.077751 --> -0.211086).  Saving model ...
Epoch: 3 cost time: 0.8367829322814941
Epoch: 3, Steps: 12 | Train Loss: 2.300 Vali Loss: 2.290 Vali Acc: 0.439 Test Loss: 2.290 Test Acc: 0.439
Validation loss decreased (-0.211086 --> -0.438866).  Saving model ...
Epoch: 4 cost time: 0.8681862354278564
Epoch: 4, Steps: 12 | Train Loss: 2.011 Vali Loss: 1.994 Vali Acc: 0.539 Test Loss: 1.994 Test Acc: 0.539
Validation loss decreased (-0.438866 --> -0.538869).  Saving model ...
Epoch: 5 cost time: 0.8657991886138916
Epoch: 5, Steps: 12 | Train Loss: 1.683 Vali Loss: 1.667 Vali Acc: 0.606 Test Loss: 1.667 Test Acc: 0.606
Validation loss decreased (-0.538869 --> -0.605539).  Saving model ...
Epoch: 6 cost time: 0.844693660736084
Epoch: 6, Steps: 12 | Train Loss: 1.345 Vali Loss: 1.412 Vali Acc: 0.639 Test Loss: 1.412 Test Acc: 0.639
Validation loss decreased (-0.605539 --> -0.638875).  Saving model ...
Epoch: 7 cost time: 0.9044027328491211
Epoch: 7, Steps: 12 | Train Loss: 1.115 Vali Loss: 1.228 Vali Acc: 0.667 Test Loss: 1.228 Test Acc: 0.667
Validation loss decreased (-0.638875 --> -0.666654).  Saving model ...
Epoch: 8 cost time: 0.9002158641815186
Epoch: 8, Steps: 12 | Train Loss: 0.864 Vali Loss: 1.114 Vali Acc: 0.672 Test Loss: 1.114 Test Acc: 0.672
Validation loss decreased (-0.666654 --> -0.672211).  Saving model ...
Epoch: 9 cost time: 0.8506989479064941
Epoch: 9, Steps: 12 | Train Loss: 0.759 Vali Loss: 1.023 Vali Acc: 0.683 Test Loss: 1.023 Test Acc: 0.683
Validation loss decreased (-0.672211 --> -0.683323).  Saving model ...
Epoch: 10 cost time: 0.8023760318756104
Epoch: 10, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.918 Vali Acc: 0.717 Test Loss: 0.918 Test Acc: 0.717
Validation loss decreased (-0.683323 --> -0.716657).  Saving model ...
Epoch: 11 cost time: 0.9130454063415527
Epoch: 11, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.867 Vali Acc: 0.733 Test Loss: 0.867 Test Acc: 0.733
Validation loss decreased (-0.716657 --> -0.733325).  Saving model ...
Epoch: 12 cost time: 0.8971121311187744
Epoch: 12, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.792 Vali Acc: 0.756 Test Loss: 0.792 Test Acc: 0.756
Validation loss decreased (-0.733325 --> -0.755548).  Saving model ...
Epoch: 13 cost time: 0.9122140407562256
Epoch: 13, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.765 Vali Acc: 0.761 Test Loss: 0.765 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761103).  Saving model ...
Epoch: 14 cost time: 0.9115879535675049
Epoch: 14, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.740 Vali Acc: 0.789 Test Loss: 0.740 Test Acc: 0.789
Validation loss decreased (-0.761103 --> -0.788881).  Saving model ...
Epoch: 15 cost time: 0.8932483196258545
Epoch: 15, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.704 Vali Acc: 0.811 Test Loss: 0.704 Test Acc: 0.811
Validation loss decreased (-0.788881 --> -0.811104).  Saving model ...
Epoch: 16 cost time: 0.8437998294830322
Epoch: 16, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.680 Vali Acc: 0.811 Test Loss: 0.680 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 17 cost time: 0.8201804161071777
Epoch: 17, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.644 Vali Acc: 0.817 Test Loss: 0.644 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 18 cost time: 0.831554651260376
Epoch: 18, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.618 Vali Acc: 0.828 Test Loss: 0.618 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827772).  Saving model ...
Epoch: 19 cost time: 0.8571186065673828
Epoch: 19, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.627 Vali Acc: 0.822 Test Loss: 0.627 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8969612121582031
Epoch: 20, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.629 Vali Acc: 0.833 Test Loss: 0.629 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833327).  Saving model ...
Epoch: 21 cost time: 0.9368984699249268
Epoch: 21, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.636 Vali Acc: 0.839 Test Loss: 0.636 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 22 cost time: 0.8358750343322754
Epoch: 22, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.636 Vali Acc: 0.833 Test Loss: 0.636 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8502259254455566
Epoch: 23, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.657 Vali Acc: 0.839 Test Loss: 0.657 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8854954242706299
Epoch: 24, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.634 Vali Acc: 0.850 Test Loss: 0.634 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 0.8782620429992676
Epoch: 25, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.659 Vali Acc: 0.822 Test Loss: 0.659 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8500607013702393
Epoch: 26, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.664 Vali Acc: 0.856 Test Loss: 0.664 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 27 cost time: 0.8851258754730225
Epoch: 27, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.636 Vali Acc: 0.839 Test Loss: 0.636 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8946335315704346
Epoch: 28, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.654 Vali Acc: 0.833 Test Loss: 0.654 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8797223567962646
Epoch: 29, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.651 Vali Acc: 0.861 Test Loss: 0.651 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 30 cost time: 0.8870847225189209
Epoch: 30, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.645 Vali Acc: 0.844 Test Loss: 0.645 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8645930290222168
Epoch: 31, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.724 Vali Acc: 0.844 Test Loss: 0.724 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8895726203918457
Epoch: 32, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.695 Vali Acc: 0.844 Test Loss: 0.695 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8676578998565674
Epoch: 33, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.696 Vali Acc: 0.856 Test Loss: 0.696 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8497505187988281
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.698 Vali Acc: 0.861 Test Loss: 0.698 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.852752685546875
Epoch: 35, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.669 Vali Acc: 0.844 Test Loss: 0.669 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7557454109191895
Epoch: 36, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.719 Vali Acc: 0.850 Test Loss: 0.719 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8596665859222412
Epoch: 37, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.695 Vali Acc: 0.856 Test Loss: 0.695 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8844561576843262
Epoch: 38, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.701 Vali Acc: 0.850 Test Loss: 0.701 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.8752963542938232
Epoch: 39, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.738 Vali Acc: 0.872 Test Loss: 0.738 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872215).  Saving model ...
Epoch: 40 cost time: 0.9191088676452637
Epoch: 40, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.721 Vali Acc: 0.867 Test Loss: 0.721 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8523688316345215
Epoch: 41, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.727 Vali Acc: 0.850 Test Loss: 0.727 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8110818862915039
Epoch: 42, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.709 Vali Acc: 0.850 Test Loss: 0.709 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.84291672706604
Epoch: 43, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.701 Vali Acc: 0.850 Test Loss: 0.701 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.834709882736206
Epoch: 44, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.725 Vali Acc: 0.856 Test Loss: 0.725 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8528103828430176
Epoch: 45, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.763 Vali Acc: 0.850 Test Loss: 0.763 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8487288951873779
Epoch: 46, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.768 Vali Acc: 0.844 Test Loss: 0.768 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.8454074859619141
Epoch: 47, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.766 Vali Acc: 0.856 Test Loss: 0.766 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.8926911354064941
Epoch: 48, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.796 Vali Acc: 0.856 Test Loss: 0.796 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.8458654880523682
Epoch: 49, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.809 Vali Acc: 0.861 Test Loss: 0.809 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 235855
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.146259307861328
Epoch: 1, Steps: 12 | Train Loss: 2.715 Vali Loss: 2.667 Vali Acc: 0.117 Test Loss: 2.667 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 0.8755550384521484
Epoch: 2, Steps: 12 | Train Loss: 2.607 Vali Loss: 2.547 Vali Acc: 0.261 Test Loss: 2.547 Test Acc: 0.261
Validation loss decreased (-0.116640 --> -0.261086).  Saving model ...
Epoch: 3 cost time: 0.8615748882293701
Epoch: 3, Steps: 12 | Train Loss: 2.422 Vali Loss: 2.351 Vali Acc: 0.461 Test Loss: 2.351 Test Acc: 0.461
Validation loss decreased (-0.261086 --> -0.461088).  Saving model ...
Epoch: 4 cost time: 0.875131368637085
Epoch: 4, Steps: 12 | Train Loss: 2.125 Vali Loss: 2.101 Vali Acc: 0.550 Test Loss: 2.101 Test Acc: 0.550
Validation loss decreased (-0.461088 --> -0.549979).  Saving model ...
Epoch: 5 cost time: 0.9031054973602295
Epoch: 5, Steps: 12 | Train Loss: 1.893 Vali Loss: 1.825 Vali Acc: 0.606 Test Loss: 1.825 Test Acc: 0.606
Validation loss decreased (-0.549979 --> -0.605537).  Saving model ...
Epoch: 6 cost time: 0.8841588497161865
Epoch: 6, Steps: 12 | Train Loss: 1.532 Vali Loss: 1.565 Vali Acc: 0.628 Test Loss: 1.565 Test Acc: 0.628
Validation loss decreased (-0.605537 --> -0.627762).  Saving model ...
Epoch: 7 cost time: 0.8855135440826416
Epoch: 7, Steps: 12 | Train Loss: 1.265 Vali Loss: 1.362 Vali Acc: 0.656 Test Loss: 1.362 Test Acc: 0.656
Validation loss decreased (-0.627762 --> -0.655542).  Saving model ...
Epoch: 8 cost time: 0.8567478656768799
Epoch: 8, Steps: 12 | Train Loss: 1.100 Vali Loss: 1.230 Vali Acc: 0.689 Test Loss: 1.230 Test Acc: 0.689
Validation loss decreased (-0.655542 --> -0.688877).  Saving model ...
Epoch: 9 cost time: 0.897874116897583
Epoch: 9, Steps: 12 | Train Loss: 0.884 Vali Loss: 1.104 Vali Acc: 0.700 Test Loss: 1.104 Test Acc: 0.700
Validation loss decreased (-0.688877 --> -0.699989).  Saving model ...
Epoch: 10 cost time: 0.8799769878387451
Epoch: 10, Steps: 12 | Train Loss: 0.758 Vali Loss: 1.016 Vali Acc: 0.689 Test Loss: 1.016 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9345433712005615
Epoch: 11, Steps: 12 | Train Loss: 0.639 Vali Loss: 0.930 Vali Acc: 0.689 Test Loss: 0.930 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9044656753540039
Epoch: 12, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.853 Vali Acc: 0.711 Test Loss: 0.853 Test Acc: 0.711
Validation loss decreased (-0.699989 --> -0.711103).  Saving model ...
Epoch: 13 cost time: 0.8784754276275635
Epoch: 13, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.828 Vali Acc: 0.728 Test Loss: 0.828 Test Acc: 0.728
Validation loss decreased (-0.711103 --> -0.727770).  Saving model ...
Epoch: 14 cost time: 0.8368847370147705
Epoch: 14, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.761 Vali Acc: 0.772 Test Loss: 0.761 Test Acc: 0.772
Validation loss decreased (-0.727770 --> -0.772215).  Saving model ...
Epoch: 15 cost time: 0.8438973426818848
Epoch: 15, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.733 Vali Acc: 0.800 Test Loss: 0.733 Test Acc: 0.800
Validation loss decreased (-0.772215 --> -0.799993).  Saving model ...
Epoch: 16 cost time: 0.8577637672424316
Epoch: 16, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.701 Vali Acc: 0.817 Test Loss: 0.701 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816660).  Saving model ...
Epoch: 17 cost time: 0.8908560276031494
Epoch: 17, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.663 Vali Acc: 0.839 Test Loss: 0.663 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838882).  Saving model ...
Epoch: 18 cost time: 0.8679158687591553
Epoch: 18, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.650 Vali Acc: 0.833 Test Loss: 0.650 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8152596950531006
Epoch: 19, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 0.8944079875946045
Epoch: 20, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.620 Vali Acc: 0.833 Test Loss: 0.620 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8559446334838867
Epoch: 21, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.614 Vali Acc: 0.839 Test Loss: 0.614 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9032282829284668
Epoch: 22, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.599 Vali Acc: 0.856 Test Loss: 0.599 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 23 cost time: 0.9028477668762207
Epoch: 23, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.614 Vali Acc: 0.867 Test Loss: 0.614 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 24 cost time: 0.914393424987793
Epoch: 24, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.587 Vali Acc: 0.856 Test Loss: 0.587 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9203214645385742
Epoch: 25, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.611 Vali Acc: 0.861 Test Loss: 0.611 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9360494613647461
Epoch: 26, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.634 Vali Acc: 0.861 Test Loss: 0.634 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9397132396697998
Epoch: 27, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.619 Vali Acc: 0.856 Test Loss: 0.619 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8904752731323242
Epoch: 28, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.643 Vali Acc: 0.856 Test Loss: 0.643 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9154219627380371
Epoch: 29, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.634 Vali Acc: 0.878 Test Loss: 0.634 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877771).  Saving model ...
Epoch: 30 cost time: 0.8750898838043213
Epoch: 30, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.654 Vali Acc: 0.878 Test Loss: 0.654 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8747260570526123
Epoch: 31, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.687 Vali Acc: 0.867 Test Loss: 0.687 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.887516975402832
Epoch: 32, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.690 Vali Acc: 0.861 Test Loss: 0.690 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8630869388580322
Epoch: 33, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.703 Vali Acc: 0.878 Test Loss: 0.703 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9040896892547607
Epoch: 34, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.668 Vali Acc: 0.889 Test Loss: 0.668 Test Acc: 0.889
Validation loss decreased (-0.877771 --> -0.888882).  Saving model ...
Epoch: 35 cost time: 0.921593189239502
Epoch: 35, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.733 Vali Acc: 0.861 Test Loss: 0.733 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9164295196533203
Epoch: 36, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.704 Vali Acc: 0.867 Test Loss: 0.704 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9186270236968994
Epoch: 37, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.715 Vali Acc: 0.867 Test Loss: 0.715 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9342918395996094
Epoch: 38, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.700 Vali Acc: 0.861 Test Loss: 0.700 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8941202163696289
Epoch: 39, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.691 Vali Acc: 0.861 Test Loss: 0.691 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.889904260635376
Epoch: 40, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.719 Vali Acc: 0.878 Test Loss: 0.719 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8893053531646729
Epoch: 41, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.767 Vali Acc: 0.867 Test Loss: 0.767 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8974530696868896
Epoch: 42, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.754 Vali Acc: 0.867 Test Loss: 0.754 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.8796896934509277
Epoch: 43, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.754 Vali Acc: 0.872 Test Loss: 0.754 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.897895336151123
Epoch: 44, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.766 Vali Acc: 0.883 Test Loss: 0.766 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 224399
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2732481956481934
Epoch: 1, Steps: 12 | Train Loss: 2.725 Vali Loss: 2.671 Vali Acc: 0.106 Test Loss: 2.671 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 0.9171507358551025
Epoch: 2, Steps: 12 | Train Loss: 2.610 Vali Loss: 2.577 Vali Acc: 0.200 Test Loss: 2.577 Test Acc: 0.200
Validation loss decreased (-0.105529 --> -0.199974).  Saving model ...
Epoch: 3 cost time: 0.843787670135498
Epoch: 3, Steps: 12 | Train Loss: 2.469 Vali Loss: 2.422 Vali Acc: 0.394 Test Loss: 2.422 Test Acc: 0.394
Validation loss decreased (-0.199974 --> -0.394420).  Saving model ...
Epoch: 4 cost time: 0.8532896041870117
Epoch: 4, Steps: 12 | Train Loss: 2.291 Vali Loss: 2.217 Vali Acc: 0.500 Test Loss: 2.217 Test Acc: 0.500
Validation loss decreased (-0.394420 --> -0.499978).  Saving model ...
Epoch: 5 cost time: 0.8478739261627197
Epoch: 5, Steps: 12 | Train Loss: 2.020 Vali Loss: 1.988 Vali Acc: 0.556 Test Loss: 1.988 Test Acc: 0.556
Validation loss decreased (-0.499978 --> -0.555536).  Saving model ...
Epoch: 6 cost time: 0.8352968692779541
Epoch: 6, Steps: 12 | Train Loss: 1.741 Vali Loss: 1.748 Vali Acc: 0.617 Test Loss: 1.748 Test Acc: 0.617
Validation loss decreased (-0.555536 --> -0.616649).  Saving model ...
Epoch: 7 cost time: 0.8035199642181396
Epoch: 7, Steps: 12 | Train Loss: 1.457 Vali Loss: 1.546 Vali Acc: 0.633 Test Loss: 1.546 Test Acc: 0.633
Validation loss decreased (-0.616649 --> -0.633318).  Saving model ...
Epoch: 8 cost time: 0.8777146339416504
Epoch: 8, Steps: 12 | Train Loss: 1.278 Vali Loss: 1.362 Vali Acc: 0.667 Test Loss: 1.362 Test Acc: 0.667
Validation loss decreased (-0.633318 --> -0.666653).  Saving model ...
Epoch: 9 cost time: 0.8726513385772705
Epoch: 9, Steps: 12 | Train Loss: 1.163 Vali Loss: 1.214 Vali Acc: 0.656 Test Loss: 1.214 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8893003463745117
Epoch: 10, Steps: 12 | Train Loss: 0.912 Vali Loss: 1.100 Vali Acc: 0.672 Test Loss: 1.100 Test Acc: 0.672
Validation loss decreased (-0.666653 --> -0.672211).  Saving model ...
Epoch: 11 cost time: 0.8454184532165527
Epoch: 11, Steps: 12 | Train Loss: 0.784 Vali Loss: 1.009 Vali Acc: 0.706 Test Loss: 1.009 Test Acc: 0.706
Validation loss decreased (-0.672211 --> -0.705545).  Saving model ...
Epoch: 12 cost time: 0.8875322341918945
Epoch: 12, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.953 Vali Acc: 0.717 Test Loss: 0.953 Test Acc: 0.717
Validation loss decreased (-0.705545 --> -0.716657).  Saving model ...
Epoch: 13 cost time: 0.8947138786315918
Epoch: 13, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.861 Vali Acc: 0.722 Test Loss: 0.861 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722214).  Saving model ...
Epoch: 14 cost time: 0.890251874923706
Epoch: 14, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.827 Vali Acc: 0.744 Test Loss: 0.827 Test Acc: 0.744
Validation loss decreased (-0.722214 --> -0.744436).  Saving model ...
Epoch: 15 cost time: 0.9084823131561279
Epoch: 15, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.782 Vali Acc: 0.783 Test Loss: 0.782 Test Acc: 0.783
Validation loss decreased (-0.744436 --> -0.783326).  Saving model ...
Epoch: 16 cost time: 0.8607525825500488
Epoch: 16, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.719 Vali Acc: 0.794 Test Loss: 0.719 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794437).  Saving model ...
Epoch: 17 cost time: 0.8377645015716553
Epoch: 17, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.708 Vali Acc: 0.778 Test Loss: 0.708 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.839442253112793
Epoch: 18, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.678 Vali Acc: 0.817 Test Loss: 0.678 Test Acc: 0.817
Validation loss decreased (-0.794437 --> -0.816660).  Saving model ...
Epoch: 19 cost time: 0.8377220630645752
Epoch: 19, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.659 Vali Acc: 0.822 Test Loss: 0.659 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 20 cost time: 0.9029660224914551
Epoch: 20, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.629 Vali Acc: 0.822 Test Loss: 0.629 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 21 cost time: 0.8571469783782959
Epoch: 21, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.612 Vali Acc: 0.844 Test Loss: 0.612 Test Acc: 0.844
Validation loss decreased (-0.822216 --> -0.844438).  Saving model ...
Epoch: 22 cost time: 0.8622260093688965
Epoch: 22, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.620 Vali Acc: 0.850 Test Loss: 0.620 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 0.8642475605010986
Epoch: 23, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 24 cost time: 0.856548547744751
Epoch: 24, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.603 Vali Acc: 0.844 Test Loss: 0.603 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9149882793426514
Epoch: 25, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.604 Vali Acc: 0.844 Test Loss: 0.604 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9114241600036621
Epoch: 26, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.609 Vali Acc: 0.856 Test Loss: 0.609 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 27 cost time: 0.9159748554229736
Epoch: 27, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9287464618682861
Epoch: 28, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.576 Vali Acc: 0.861 Test Loss: 0.576 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 29 cost time: 0.9071896076202393
Epoch: 29, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.596 Vali Acc: 0.867 Test Loss: 0.596 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 30 cost time: 0.847675085067749
Epoch: 30, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.654 Vali Acc: 0.867 Test Loss: 0.654 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8747589588165283
Epoch: 31, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.638 Vali Acc: 0.872 Test Loss: 0.638 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 32 cost time: 0.8396525382995605
Epoch: 32, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.626 Vali Acc: 0.878 Test Loss: 0.626 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 33 cost time: 0.8119304180145264
Epoch: 33, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.628 Vali Acc: 0.878 Test Loss: 0.628 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.858067512512207
Epoch: 34, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.659 Vali Acc: 0.878 Test Loss: 0.659 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.866610050201416
Epoch: 35, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.661 Vali Acc: 0.867 Test Loss: 0.661 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8663187026977539
Epoch: 36, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.673 Vali Acc: 0.872 Test Loss: 0.673 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8311145305633545
Epoch: 37, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.664 Vali Acc: 0.872 Test Loss: 0.664 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9337856769561768
Epoch: 38, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.671 Vali Acc: 0.856 Test Loss: 0.671 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9690840244293213
Epoch: 39, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.704 Vali Acc: 0.872 Test Loss: 0.704 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8739898204803467
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.684 Vali Acc: 0.856 Test Loss: 0.684 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9094023704528809
Epoch: 41, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.695 Vali Acc: 0.872 Test Loss: 0.695 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.9061918258666992
Epoch: 42, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.716 Vali Acc: 0.883 Test Loss: 0.716 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883326).  Saving model ...
Epoch: 43 cost time: 0.8495261669158936
Epoch: 43, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.743 Vali Acc: 0.872 Test Loss: 0.743 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8944909572601318
Epoch: 44, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.718 Vali Acc: 0.883 Test Loss: 0.718 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8747470378875732
Epoch: 45, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.714 Vali Acc: 0.883 Test Loss: 0.714 Test Acc: 0.883
Validation loss decreased (-0.883326 --> -0.883326).  Saving model ...
Epoch: 46 cost time: 0.8522169589996338
Epoch: 46, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.727 Vali Acc: 0.889 Test Loss: 0.727 Test Acc: 0.889
Validation loss decreased (-0.883326 --> -0.888882).  Saving model ...
Epoch: 47 cost time: 0.8694968223571777
Epoch: 47, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.758 Vali Acc: 0.889 Test Loss: 0.758 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9959957599639893
Epoch: 48, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.726 Vali Acc: 0.883 Test Loss: 0.726 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.8852777481079102
Epoch: 49, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.715 Vali Acc: 0.867 Test Loss: 0.715 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.815842866897583
Epoch: 50, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.719 Vali Acc: 0.889 Test Loss: 0.719 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888882).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 216847
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0913243293762207
Epoch: 1, Steps: 12 | Train Loss: 2.669 Vali Loss: 2.667 Vali Acc: 0.167 Test Loss: 2.667 Test Acc: 0.167
Validation loss decreased (inf --> -0.166640).  Saving model ...
Epoch: 2 cost time: 0.8591983318328857
Epoch: 2, Steps: 12 | Train Loss: 2.589 Vali Loss: 2.584 Vali Acc: 0.239 Test Loss: 2.584 Test Acc: 0.239
Validation loss decreased (-0.166640 --> -0.238863).  Saving model ...
Epoch: 3 cost time: 0.7770528793334961
Epoch: 3, Steps: 12 | Train Loss: 2.472 Vali Loss: 2.450 Vali Acc: 0.350 Test Loss: 2.450 Test Acc: 0.350
Validation loss decreased (-0.238863 --> -0.349975).  Saving model ...
Epoch: 4 cost time: 0.8236100673675537
Epoch: 4, Steps: 12 | Train Loss: 2.312 Vali Loss: 2.277 Vali Acc: 0.461 Test Loss: 2.277 Test Acc: 0.461
Validation loss decreased (-0.349975 --> -0.461088).  Saving model ...
Epoch: 5 cost time: 0.8976774215698242
Epoch: 5, Steps: 12 | Train Loss: 2.104 Vali Loss: 2.075 Vali Acc: 0.528 Test Loss: 2.075 Test Acc: 0.528
Validation loss decreased (-0.461088 --> -0.527757).  Saving model ...
Epoch: 6 cost time: 0.8332247734069824
Epoch: 6, Steps: 12 | Train Loss: 1.927 Vali Loss: 1.853 Vali Acc: 0.589 Test Loss: 1.853 Test Acc: 0.589
Validation loss decreased (-0.527757 --> -0.588870).  Saving model ...
Epoch: 7 cost time: 0.8092641830444336
Epoch: 7, Steps: 12 | Train Loss: 1.645 Vali Loss: 1.644 Vali Acc: 0.600 Test Loss: 1.644 Test Acc: 0.600
Validation loss decreased (-0.588870 --> -0.599984).  Saving model ...
Epoch: 8 cost time: 0.8630654811859131
Epoch: 8, Steps: 12 | Train Loss: 1.354 Vali Loss: 1.450 Vali Acc: 0.628 Test Loss: 1.450 Test Acc: 0.628
Validation loss decreased (-0.599984 --> -0.627763).  Saving model ...
Epoch: 9 cost time: 0.8503725528717041
Epoch: 9, Steps: 12 | Train Loss: 1.168 Vali Loss: 1.262 Vali Acc: 0.672 Test Loss: 1.262 Test Acc: 0.672
Validation loss decreased (-0.627763 --> -0.672210).  Saving model ...
Epoch: 10 cost time: 0.8451838493347168
Epoch: 10, Steps: 12 | Train Loss: 0.966 Vali Loss: 1.133 Vali Acc: 0.683 Test Loss: 1.133 Test Acc: 0.683
Validation loss decreased (-0.672210 --> -0.683322).  Saving model ...
Epoch: 11 cost time: 0.8710076808929443
Epoch: 11, Steps: 12 | Train Loss: 0.865 Vali Loss: 1.039 Vali Acc: 0.706 Test Loss: 1.039 Test Acc: 0.706
Validation loss decreased (-0.683322 --> -0.705545).  Saving model ...
Epoch: 12 cost time: 0.9150617122650146
Epoch: 12, Steps: 12 | Train Loss: 0.752 Vali Loss: 0.942 Vali Acc: 0.711 Test Loss: 0.942 Test Acc: 0.711
Validation loss decreased (-0.705545 --> -0.711102).  Saving model ...
Epoch: 13 cost time: 0.9302325248718262
Epoch: 13, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.867 Vali Acc: 0.733 Test Loss: 0.867 Test Acc: 0.733
Validation loss decreased (-0.711102 --> -0.733325).  Saving model ...
Epoch: 14 cost time: 0.9217314720153809
Epoch: 14, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.802 Vali Acc: 0.756 Test Loss: 0.802 Test Acc: 0.756
Validation loss decreased (-0.733325 --> -0.755548).  Saving model ...
Epoch: 15 cost time: 0.9426116943359375
Epoch: 15, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.760 Vali Acc: 0.778 Test Loss: 0.760 Test Acc: 0.778
Validation loss decreased (-0.755548 --> -0.777770).  Saving model ...
Epoch: 16 cost time: 0.9284451007843018
Epoch: 16, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.724 Vali Acc: 0.806 Test Loss: 0.724 Test Acc: 0.806
Validation loss decreased (-0.777770 --> -0.805548).  Saving model ...
Epoch: 17 cost time: 0.8854150772094727
Epoch: 17, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.691 Vali Acc: 0.794 Test Loss: 0.691 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8795382976531982
Epoch: 18, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.674 Vali Acc: 0.822 Test Loss: 0.674 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822215).  Saving model ...
Epoch: 19 cost time: 0.8913474082946777
Epoch: 19, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.633 Vali Acc: 0.817 Test Loss: 0.633 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.865922212600708
Epoch: 20, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.621 Vali Acc: 0.833 Test Loss: 0.621 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 21 cost time: 0.8907840251922607
Epoch: 21, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.595 Vali Acc: 0.844 Test Loss: 0.595 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 22 cost time: 0.8942680358886719
Epoch: 22, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.603 Vali Acc: 0.828 Test Loss: 0.603 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9213235378265381
Epoch: 23, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.581 Vali Acc: 0.828 Test Loss: 0.581 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9117445945739746
Epoch: 24, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.576 Vali Acc: 0.844 Test Loss: 0.576 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844439).  Saving model ...
Epoch: 25 cost time: 0.9077258110046387
Epoch: 25, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.562 Vali Acc: 0.839 Test Loss: 0.562 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8687593936920166
Epoch: 26, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.579 Vali Acc: 0.844 Test Loss: 0.579 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8413760662078857
Epoch: 27, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 28 cost time: 0.8943541049957275
Epoch: 28, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.565 Vali Acc: 0.856 Test Loss: 0.565 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8789057731628418
Epoch: 29, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.583 Vali Acc: 0.867 Test Loss: 0.583 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 30 cost time: 0.864581823348999
Epoch: 30, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8659276962280273
Epoch: 31, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.594 Vali Acc: 0.839 Test Loss: 0.594 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8415663242340088
Epoch: 32, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.626 Vali Acc: 0.850 Test Loss: 0.626 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8398623466491699
Epoch: 33, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.575 Vali Acc: 0.850 Test Loss: 0.575 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9268054962158203
Epoch: 34, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.631 Vali Acc: 0.856 Test Loss: 0.631 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9181051254272461
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.877547025680542
Epoch: 36, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.616 Vali Acc: 0.833 Test Loss: 0.616 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9029088020324707
Epoch: 37, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.653 Vali Acc: 0.878 Test Loss: 0.653 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877771).  Saving model ...
Epoch: 38 cost time: 0.9443099498748779
Epoch: 38, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.633 Vali Acc: 0.878 Test Loss: 0.633 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877771).  Saving model ...
Epoch: 39 cost time: 0.813054084777832
Epoch: 39, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.607 Vali Acc: 0.872 Test Loss: 0.607 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8463718891143799
Epoch: 40, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.635 Vali Acc: 0.872 Test Loss: 0.635 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8710274696350098
Epoch: 41, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.617 Vali Acc: 0.861 Test Loss: 0.617 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7856717109680176
Epoch: 42, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.607 Vali Acc: 0.867 Test Loss: 0.607 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.8459060192108154
Epoch: 43, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.670 Vali Acc: 0.872 Test Loss: 0.670 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.834571361541748
Epoch: 44, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.707 Vali Acc: 0.856 Test Loss: 0.707 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.8542985916137695
Epoch: 45, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.696 Vali Acc: 0.850 Test Loss: 0.696 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.8718366622924805
Epoch: 46, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.746 Vali Acc: 0.861 Test Loss: 0.746 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.8874814510345459
Epoch: 47, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.730 Vali Acc: 0.861 Test Loss: 0.730 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.8983538150787354
Epoch: 48, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.723 Vali Acc: 0.839 Test Loss: 0.723 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 213135
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.09525203704834
Epoch: 1, Steps: 12 | Train Loss: 2.681 Vali Loss: 2.656 Vali Acc: 0.089 Test Loss: 2.656 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 0.8688936233520508
Epoch: 2, Steps: 12 | Train Loss: 2.596 Vali Loss: 2.571 Vali Acc: 0.222 Test Loss: 2.571 Test Acc: 0.222
Validation loss decreased (-0.088862 --> -0.222197).  Saving model ...
Epoch: 3 cost time: 0.8088171482086182
Epoch: 3, Steps: 12 | Train Loss: 2.479 Vali Loss: 2.436 Vali Acc: 0.372 Test Loss: 2.436 Test Acc: 0.372
Validation loss decreased (-0.222197 --> -0.372198).  Saving model ...
Epoch: 4 cost time: 0.7996840476989746
Epoch: 4, Steps: 12 | Train Loss: 2.292 Vali Loss: 2.271 Vali Acc: 0.467 Test Loss: 2.271 Test Acc: 0.467
Validation loss decreased (-0.372198 --> -0.466644).  Saving model ...
Epoch: 5 cost time: 0.8003532886505127
Epoch: 5, Steps: 12 | Train Loss: 2.131 Vali Loss: 2.072 Vali Acc: 0.511 Test Loss: 2.072 Test Acc: 0.511
Validation loss decreased (-0.466644 --> -0.511090).  Saving model ...
Epoch: 6 cost time: 0.847412109375
Epoch: 6, Steps: 12 | Train Loss: 1.936 Vali Loss: 1.877 Vali Acc: 0.528 Test Loss: 1.877 Test Acc: 0.528
Validation loss decreased (-0.511090 --> -0.527759).  Saving model ...
Epoch: 7 cost time: 0.9154088497161865
Epoch: 7, Steps: 12 | Train Loss: 1.690 Vali Loss: 1.689 Vali Acc: 0.578 Test Loss: 1.689 Test Acc: 0.578
Validation loss decreased (-0.527759 --> -0.577761).  Saving model ...
Epoch: 8 cost time: 0.9014954566955566
Epoch: 8, Steps: 12 | Train Loss: 1.496 Vali Loss: 1.509 Vali Acc: 0.622 Test Loss: 1.509 Test Acc: 0.622
Validation loss decreased (-0.577761 --> -0.622207).  Saving model ...
Epoch: 9 cost time: 0.9054298400878906
Epoch: 9, Steps: 12 | Train Loss: 1.267 Vali Loss: 1.330 Vali Acc: 0.667 Test Loss: 1.330 Test Acc: 0.667
Validation loss decreased (-0.622207 --> -0.666653).  Saving model ...
Epoch: 10 cost time: 0.8768396377563477
Epoch: 10, Steps: 12 | Train Loss: 1.079 Vali Loss: 1.201 Vali Acc: 0.711 Test Loss: 1.201 Test Acc: 0.711
Validation loss decreased (-0.666653 --> -0.711099).  Saving model ...
Epoch: 11 cost time: 0.8349432945251465
Epoch: 11, Steps: 12 | Train Loss: 0.942 Vali Loss: 1.090 Vali Acc: 0.689 Test Loss: 1.090 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8353807926177979
Epoch: 12, Steps: 12 | Train Loss: 0.817 Vali Loss: 0.999 Vali Acc: 0.711 Test Loss: 0.999 Test Acc: 0.711
Validation loss decreased (-0.711099 --> -0.711101).  Saving model ...
Epoch: 13 cost time: 0.8344213962554932
Epoch: 13, Steps: 12 | Train Loss: 0.725 Vali Loss: 0.931 Vali Acc: 0.733 Test Loss: 0.931 Test Acc: 0.733
Validation loss decreased (-0.711101 --> -0.733324).  Saving model ...
Epoch: 14 cost time: 0.8861093521118164
Epoch: 14, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.864 Vali Acc: 0.750 Test Loss: 0.864 Test Acc: 0.750
Validation loss decreased (-0.733324 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 0.8076889514923096
Epoch: 15, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.802 Vali Acc: 0.756 Test Loss: 0.802 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.755548).  Saving model ...
Epoch: 16 cost time: 0.8330409526824951
Epoch: 16, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.751 Vali Acc: 0.800 Test Loss: 0.751 Test Acc: 0.800
Validation loss decreased (-0.755548 --> -0.799992).  Saving model ...
Epoch: 17 cost time: 0.7522544860839844
Epoch: 17, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.712 Vali Acc: 0.806 Test Loss: 0.712 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805548).  Saving model ...
Epoch: 18 cost time: 0.8239915370941162
Epoch: 18, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.674 Vali Acc: 0.806 Test Loss: 0.674 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805549).  Saving model ...
Epoch: 19 cost time: 0.7677211761474609
Epoch: 19, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.632 Vali Acc: 0.817 Test Loss: 0.632 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816660).  Saving model ...
Epoch: 20 cost time: 0.822338342666626
Epoch: 20, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.636 Vali Acc: 0.822 Test Loss: 0.636 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 21 cost time: 0.8159708976745605
Epoch: 21, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.619 Vali Acc: 0.828 Test Loss: 0.619 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 22 cost time: 0.7921042442321777
Epoch: 22, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.596 Vali Acc: 0.822 Test Loss: 0.596 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7543413639068604
Epoch: 23, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.586 Vali Acc: 0.844 Test Loss: 0.586 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844439).  Saving model ...
Epoch: 24 cost time: 0.7619471549987793
Epoch: 24, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.557 Vali Acc: 0.844 Test Loss: 0.557 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 25 cost time: 0.8031365871429443
Epoch: 25, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.559 Vali Acc: 0.839 Test Loss: 0.559 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8036611080169678
Epoch: 26, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.539 Vali Acc: 0.867 Test Loss: 0.539 Test Acc: 0.867
Validation loss decreased (-0.844439 --> -0.866661).  Saving model ...
Epoch: 27 cost time: 0.8798472881317139
Epoch: 27, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.557 Vali Acc: 0.856 Test Loss: 0.557 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8731412887573242
Epoch: 28, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.554 Vali Acc: 0.839 Test Loss: 0.554 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8522658348083496
Epoch: 29, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9042308330535889
Epoch: 30, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.537 Vali Acc: 0.839 Test Loss: 0.537 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8737337589263916
Epoch: 31, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.540 Vali Acc: 0.856 Test Loss: 0.540 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8023495674133301
Epoch: 32, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.525 Vali Acc: 0.861 Test Loss: 0.525 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8287065029144287
Epoch: 33, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.555 Vali Acc: 0.867 Test Loss: 0.555 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8131160736083984
Epoch: 34, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.570 Vali Acc: 0.878 Test Loss: 0.570 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 35 cost time: 0.8160083293914795
Epoch: 35, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.557 Vali Acc: 0.867 Test Loss: 0.557 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8419721126556396
Epoch: 36, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.552 Vali Acc: 0.867 Test Loss: 0.552 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8264613151550293
Epoch: 37, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.559 Vali Acc: 0.861 Test Loss: 0.559 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8289382457733154
Epoch: 38, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.560 Vali Acc: 0.861 Test Loss: 0.560 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8579287528991699
Epoch: 39, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.573 Vali Acc: 0.872 Test Loss: 0.573 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8914117813110352
Epoch: 40, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.580 Vali Acc: 0.861 Test Loss: 0.580 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8529438972473145
Epoch: 41, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.579 Vali Acc: 0.872 Test Loss: 0.579 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8795394897460938
Epoch: 42, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.585 Vali Acc: 0.883 Test Loss: 0.585 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 43 cost time: 0.8980627059936523
Epoch: 43, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.565 Vali Acc: 0.856 Test Loss: 0.565 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8782162666320801
Epoch: 44, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.580 Vali Acc: 0.856 Test Loss: 0.580 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9350180625915527
Epoch: 45, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.595 Vali Acc: 0.883 Test Loss: 0.595 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9095368385314941
Epoch: 46, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.609 Vali Acc: 0.889 Test Loss: 0.609 Test Acc: 0.889
Validation loss decreased (-0.883327 --> -0.888883).  Saving model ...
Epoch: 47 cost time: 0.907564640045166
Epoch: 47, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.598 Vali Acc: 0.878 Test Loss: 0.598 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8575241565704346
Epoch: 48, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.590 Vali Acc: 0.872 Test Loss: 0.590 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.8663175106048584
Epoch: 49, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.645 Vali Acc: 0.878 Test Loss: 0.645 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.7895562648773193
Epoch: 50, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.632 Vali Acc: 0.878 Test Loss: 0.632 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 209487
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9890899658203125
Epoch: 1, Steps: 12 | Train Loss: 2.692 Vali Loss: 2.659 Vali Acc: 0.111 Test Loss: 2.659 Test Acc: 0.111
Validation loss decreased (inf --> -0.111085).  Saving model ...
Epoch: 2 cost time: 0.7617490291595459
Epoch: 2, Steps: 12 | Train Loss: 2.587 Vali Loss: 2.545 Vali Acc: 0.200 Test Loss: 2.545 Test Acc: 0.200
Validation loss decreased (-0.111085 --> -0.199975).  Saving model ...
Epoch: 3 cost time: 0.7547800540924072
Epoch: 3, Steps: 12 | Train Loss: 2.405 Vali Loss: 2.372 Vali Acc: 0.433 Test Loss: 2.372 Test Acc: 0.433
Validation loss decreased (-0.199975 --> -0.433310).  Saving model ...
Epoch: 4 cost time: 0.7533183097839355
Epoch: 4, Steps: 12 | Train Loss: 2.150 Vali Loss: 2.118 Vali Acc: 0.522 Test Loss: 2.118 Test Acc: 0.522
Validation loss decreased (-0.433310 --> -0.522201).  Saving model ...
Epoch: 5 cost time: 0.7192082405090332
Epoch: 5, Steps: 12 | Train Loss: 1.880 Vali Loss: 1.838 Vali Acc: 0.556 Test Loss: 1.838 Test Acc: 0.556
Validation loss decreased (-0.522201 --> -0.555537).  Saving model ...
Epoch: 6 cost time: 0.7571859359741211
Epoch: 6, Steps: 12 | Train Loss: 1.572 Vali Loss: 1.587 Vali Acc: 0.600 Test Loss: 1.587 Test Acc: 0.600
Validation loss decreased (-0.555537 --> -0.599984).  Saving model ...
Epoch: 7 cost time: 0.7757740020751953
Epoch: 7, Steps: 12 | Train Loss: 1.337 Vali Loss: 1.376 Vali Acc: 0.628 Test Loss: 1.376 Test Acc: 0.628
Validation loss decreased (-0.599984 --> -0.627764).  Saving model ...
Epoch: 8 cost time: 0.8168027400970459
Epoch: 8, Steps: 12 | Train Loss: 1.053 Vali Loss: 1.213 Vali Acc: 0.667 Test Loss: 1.213 Test Acc: 0.667
Validation loss decreased (-0.627764 --> -0.666655).  Saving model ...
Epoch: 9 cost time: 0.7712709903717041
Epoch: 9, Steps: 12 | Train Loss: 0.915 Vali Loss: 1.123 Vali Acc: 0.678 Test Loss: 1.123 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677767).  Saving model ...
Epoch: 10 cost time: 0.7629780769348145
Epoch: 10, Steps: 12 | Train Loss: 0.722 Vali Loss: 1.027 Vali Acc: 0.661 Test Loss: 1.027 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7807350158691406
Epoch: 11, Steps: 12 | Train Loss: 0.626 Vali Loss: 0.948 Vali Acc: 0.683 Test Loss: 0.948 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683324).  Saving model ...
Epoch: 12 cost time: 0.811079740524292
Epoch: 12, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.897 Vali Acc: 0.689 Test Loss: 0.897 Test Acc: 0.689
Validation loss decreased (-0.683324 --> -0.688880).  Saving model ...
Epoch: 13 cost time: 0.6698517799377441
Epoch: 13, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.868 Vali Acc: 0.717 Test Loss: 0.868 Test Acc: 0.717
Validation loss decreased (-0.688880 --> -0.716658).  Saving model ...
Epoch: 14 cost time: 0.7575833797454834
Epoch: 14, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.826 Vali Acc: 0.733 Test Loss: 0.826 Test Acc: 0.733
Validation loss decreased (-0.716658 --> -0.733325).  Saving model ...
Epoch: 15 cost time: 0.766345739364624
Epoch: 15, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.805 Vali Acc: 0.739 Test Loss: 0.805 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738881).  Saving model ...
Epoch: 16 cost time: 0.82515549659729
Epoch: 16, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.765 Vali Acc: 0.778 Test Loss: 0.765 Test Acc: 0.778
Validation loss decreased (-0.738881 --> -0.777770).  Saving model ...
Epoch: 17 cost time: 0.7502343654632568
Epoch: 17, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.727 Vali Acc: 0.800 Test Loss: 0.727 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799993).  Saving model ...
Epoch: 18 cost time: 0.7713253498077393
Epoch: 18, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.724 Vali Acc: 0.800 Test Loss: 0.724 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 0.726569414138794
Epoch: 19, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.739 Vali Acc: 0.806 Test Loss: 0.739 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805548).  Saving model ...
Epoch: 20 cost time: 0.7173013687133789
Epoch: 20, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.695 Vali Acc: 0.811 Test Loss: 0.695 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 21 cost time: 0.7821927070617676
Epoch: 21, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.707 Vali Acc: 0.822 Test Loss: 0.707 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822215).  Saving model ...
Epoch: 22 cost time: 0.8119137287139893
Epoch: 22, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.698 Vali Acc: 0.822 Test Loss: 0.698 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 23 cost time: 0.8105790615081787
Epoch: 23, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.716 Vali Acc: 0.833 Test Loss: 0.716 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833326).  Saving model ...
Epoch: 24 cost time: 0.8050873279571533
Epoch: 24, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.713 Vali Acc: 0.833 Test Loss: 0.713 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833326).  Saving model ...
Epoch: 25 cost time: 0.7097346782684326
Epoch: 25, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.735 Vali Acc: 0.833 Test Loss: 0.735 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7750177383422852
Epoch: 26, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.728 Vali Acc: 0.833 Test Loss: 0.728 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7154185771942139
Epoch: 27, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.716 Vali Acc: 0.856 Test Loss: 0.716 Test Acc: 0.856
Validation loss decreased (-0.833326 --> -0.855548).  Saving model ...
Epoch: 28 cost time: 0.7212769985198975
Epoch: 28, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.730 Vali Acc: 0.856 Test Loss: 0.730 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7323808670043945
Epoch: 29, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.762 Vali Acc: 0.844 Test Loss: 0.762 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7331745624542236
Epoch: 30, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.771 Vali Acc: 0.856 Test Loss: 0.771 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8192846775054932
Epoch: 31, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.753 Vali Acc: 0.867 Test Loss: 0.753 Test Acc: 0.867
Validation loss decreased (-0.855548 --> -0.866659).  Saving model ...
Epoch: 32 cost time: 0.7381577491760254
Epoch: 32, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.796 Vali Acc: 0.856 Test Loss: 0.796 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7384195327758789
Epoch: 33, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.775 Vali Acc: 0.850 Test Loss: 0.775 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7610352039337158
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.865 Vali Acc: 0.850 Test Loss: 0.865 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7568812370300293
Epoch: 35, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.828 Vali Acc: 0.856 Test Loss: 0.828 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.757659912109375
Epoch: 36, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.785 Vali Acc: 0.844 Test Loss: 0.785 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.79813551902771
Epoch: 37, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.876 Vali Acc: 0.822 Test Loss: 0.876 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7871143817901611
Epoch: 38, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.932 Vali Acc: 0.856 Test Loss: 0.932 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7578530311584473
Epoch: 39, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.882 Vali Acc: 0.828 Test Loss: 0.882 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.7090470790863037
Epoch: 40, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.894 Vali Acc: 0.861 Test Loss: 0.894 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.7583408355712891
Epoch: 41, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.905 Vali Acc: 0.872 Test Loss: 0.905 Test Acc: 0.872
Validation loss decreased (-0.866659 --> -0.872213).  Saving model ...
Epoch: 42 cost time: 0.7821636199951172
Epoch: 42, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.895 Vali Acc: 0.861 Test Loss: 0.895 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7603180408477783
Epoch: 43, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.905 Vali Acc: 0.867 Test Loss: 0.905 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7984943389892578
Epoch: 44, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.857 Vali Acc: 0.850 Test Loss: 0.857 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7499599456787109
Epoch: 45, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.053 Vali Acc: 0.839 Test Loss: 1.053 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.7404420375823975
Epoch: 46, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.933 Vali Acc: 0.856 Test Loss: 0.933 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.7698335647583008
Epoch: 47, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.887 Vali Acc: 0.878 Test Loss: 0.887 Test Acc: 0.878
Validation loss decreased (-0.872213 --> -0.877769).  Saving model ...
Epoch: 48 cost time: 0.7612226009368896
Epoch: 48, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.917 Vali Acc: 0.883 Test Loss: 0.917 Test Acc: 0.883
Validation loss decreased (-0.877769 --> -0.883324).  Saving model ...
Epoch: 49 cost time: 0.7760286331176758
Epoch: 49, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.933 Vali Acc: 0.856 Test Loss: 0.933 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7687232494354248
Epoch: 50, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.985 Vali Acc: 0.856 Test Loss: 0.985 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 95855
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9225351810455322
Epoch: 1, Steps: 12 | Train Loss: 2.768 Vali Loss: 2.692 Vali Acc: 0.083 Test Loss: 2.692 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 0.8000731468200684
Epoch: 2, Steps: 12 | Train Loss: 2.687 Vali Loss: 2.631 Vali Acc: 0.161 Test Loss: 2.631 Test Acc: 0.161
Validation loss decreased (-0.083306 --> -0.161085).  Saving model ...
Epoch: 3 cost time: 0.7499997615814209
Epoch: 3, Steps: 12 | Train Loss: 2.574 Vali Loss: 2.526 Vali Acc: 0.244 Test Loss: 2.526 Test Acc: 0.244
Validation loss decreased (-0.161085 --> -0.244419).  Saving model ...
Epoch: 4 cost time: 0.7663941383361816
Epoch: 4, Steps: 12 | Train Loss: 2.408 Vali Loss: 2.378 Vali Acc: 0.361 Test Loss: 2.378 Test Acc: 0.361
Validation loss decreased (-0.244419 --> -0.361087).  Saving model ...
Epoch: 5 cost time: 0.7892594337463379
Epoch: 5, Steps: 12 | Train Loss: 2.257 Vali Loss: 2.207 Vali Acc: 0.456 Test Loss: 2.207 Test Acc: 0.456
Validation loss decreased (-0.361087 --> -0.455533).  Saving model ...
Epoch: 6 cost time: 0.7736220359802246
Epoch: 6, Steps: 12 | Train Loss: 2.062 Vali Loss: 1.999 Vali Acc: 0.517 Test Loss: 1.999 Test Acc: 0.517
Validation loss decreased (-0.455533 --> -0.516647).  Saving model ...
Epoch: 7 cost time: 0.7954339981079102
Epoch: 7, Steps: 12 | Train Loss: 1.817 Vali Loss: 1.805 Vali Acc: 0.539 Test Loss: 1.805 Test Acc: 0.539
Validation loss decreased (-0.516647 --> -0.538871).  Saving model ...
Epoch: 8 cost time: 0.7862339019775391
Epoch: 8, Steps: 12 | Train Loss: 1.560 Vali Loss: 1.613 Vali Acc: 0.600 Test Loss: 1.613 Test Acc: 0.600
Validation loss decreased (-0.538871 --> -0.599984).  Saving model ...
Epoch: 9 cost time: 0.7711431980133057
Epoch: 9, Steps: 12 | Train Loss: 1.348 Vali Loss: 1.459 Vali Acc: 0.617 Test Loss: 1.459 Test Acc: 0.617
Validation loss decreased (-0.599984 --> -0.616652).  Saving model ...
Epoch: 10 cost time: 0.7456533908843994
Epoch: 10, Steps: 12 | Train Loss: 1.163 Vali Loss: 1.337 Vali Acc: 0.650 Test Loss: 1.337 Test Acc: 0.650
Validation loss decreased (-0.616652 --> -0.649987).  Saving model ...
Epoch: 11 cost time: 0.7706055641174316
Epoch: 11, Steps: 12 | Train Loss: 1.013 Vali Loss: 1.220 Vali Acc: 0.661 Test Loss: 1.220 Test Acc: 0.661
Validation loss decreased (-0.649987 --> -0.661099).  Saving model ...
Epoch: 12 cost time: 0.7409853935241699
Epoch: 12, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.120 Vali Acc: 0.672 Test Loss: 1.120 Test Acc: 0.672
Validation loss decreased (-0.661099 --> -0.672211).  Saving model ...
Epoch: 13 cost time: 0.7598342895507812
Epoch: 13, Steps: 12 | Train Loss: 0.750 Vali Loss: 1.049 Vali Acc: 0.683 Test Loss: 1.049 Test Acc: 0.683
Validation loss decreased (-0.672211 --> -0.683323).  Saving model ...
Epoch: 14 cost time: 0.7507555484771729
Epoch: 14, Steps: 12 | Train Loss: 0.678 Vali Loss: 1.006 Vali Acc: 0.672 Test Loss: 1.006 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8063418865203857
Epoch: 15, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.933 Vali Acc: 0.689 Test Loss: 0.933 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688880).  Saving model ...
Epoch: 16 cost time: 0.7278919219970703
Epoch: 16, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.901 Vali Acc: 0.706 Test Loss: 0.901 Test Acc: 0.706
Validation loss decreased (-0.688880 --> -0.705547).  Saving model ...
Epoch: 17 cost time: 0.7725183963775635
Epoch: 17, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.856 Vali Acc: 0.706 Test Loss: 0.856 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
Epoch: 18 cost time: 0.788698673248291
Epoch: 18, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.822 Vali Acc: 0.722 Test Loss: 0.822 Test Acc: 0.722
Validation loss decreased (-0.705547 --> -0.722214).  Saving model ...
Epoch: 19 cost time: 0.799811601638794
Epoch: 19, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.821 Vali Acc: 0.733 Test Loss: 0.821 Test Acc: 0.733
Validation loss decreased (-0.722214 --> -0.733325).  Saving model ...
Epoch: 20 cost time: 0.7833871841430664
Epoch: 20, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.765 Vali Acc: 0.744 Test Loss: 0.765 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744437).  Saving model ...
Epoch: 21 cost time: 0.80291748046875
Epoch: 21, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.737 Vali Acc: 0.783 Test Loss: 0.737 Test Acc: 0.783
Validation loss decreased (-0.744437 --> -0.783326).  Saving model ...
Epoch: 22 cost time: 0.7621500492095947
Epoch: 22, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.719 Vali Acc: 0.806 Test Loss: 0.719 Test Acc: 0.806
Validation loss decreased (-0.783326 --> -0.805548).  Saving model ...
Epoch: 23 cost time: 0.7689783573150635
Epoch: 23, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.704 Vali Acc: 0.778 Test Loss: 0.704 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7798867225646973
Epoch: 24, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.686 Vali Acc: 0.783 Test Loss: 0.686 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7455480098724365
Epoch: 25, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.672 Vali Acc: 0.817 Test Loss: 0.672 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816660).  Saving model ...
Epoch: 26 cost time: 0.7828414440155029
Epoch: 26, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.658 Vali Acc: 0.794 Test Loss: 0.658 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7371644973754883
Epoch: 27, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.635 Vali Acc: 0.822 Test Loss: 0.635 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 28 cost time: 0.733792781829834
Epoch: 28, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.618 Vali Acc: 0.844 Test Loss: 0.618 Test Acc: 0.844
Validation loss decreased (-0.822216 --> -0.844438).  Saving model ...
Epoch: 29 cost time: 0.7255098819732666
Epoch: 29, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.619 Vali Acc: 0.839 Test Loss: 0.619 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7643468379974365
Epoch: 30, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.631 Vali Acc: 0.817 Test Loss: 0.631 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7803680896759033
Epoch: 31, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.606 Vali Acc: 0.844 Test Loss: 0.606 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 32 cost time: 0.8564298152923584
Epoch: 32, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.613 Vali Acc: 0.844 Test Loss: 0.613 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7613468170166016
Epoch: 33, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.642 Vali Acc: 0.828 Test Loss: 0.642 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7755911350250244
Epoch: 34, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.624 Vali Acc: 0.844 Test Loss: 0.624 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7532734870910645
Epoch: 35, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.617 Vali Acc: 0.856 Test Loss: 0.617 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 36 cost time: 0.7263381481170654
Epoch: 36, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.601 Vali Acc: 0.861 Test Loss: 0.601 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 37 cost time: 0.7600445747375488
Epoch: 37, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.617 Vali Acc: 0.856 Test Loss: 0.617 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.872412919998169
Epoch: 38, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.638 Vali Acc: 0.856 Test Loss: 0.638 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8071446418762207
Epoch: 39, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.637 Vali Acc: 0.850 Test Loss: 0.637 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7319791316986084
Epoch: 40, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.623 Vali Acc: 0.867 Test Loss: 0.623 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 41 cost time: 0.7410707473754883
Epoch: 41, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.634 Vali Acc: 0.861 Test Loss: 0.634 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7790729999542236
Epoch: 42, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.662 Vali Acc: 0.856 Test Loss: 0.662 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7858822345733643
Epoch: 43, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.650 Vali Acc: 0.856 Test Loss: 0.650 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8369009494781494
Epoch: 44, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.664 Vali Acc: 0.844 Test Loss: 0.664 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7949297428131104
Epoch: 45, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.647 Vali Acc: 0.850 Test Loss: 0.647 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.792945146560669
Epoch: 46, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.657 Vali Acc: 0.856 Test Loss: 0.657 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.7965877056121826
Epoch: 47, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.654 Vali Acc: 0.861 Test Loss: 0.654 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.7780799865722656
Epoch: 48, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.667 Vali Acc: 0.867 Test Loss: 0.667 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.7775046825408936
Epoch: 49, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.676 Vali Acc: 0.861 Test Loss: 0.676 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.7867872714996338
Epoch: 50, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.676 Vali Acc: 0.856 Test Loss: 0.676 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 72847
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.347085475921631
Epoch: 1, Steps: 12 | Train Loss: 2.733 Vali Loss: 2.669 Vali Acc: 0.056 Test Loss: 2.669 Test Acc: 0.056
Validation loss decreased (inf --> -0.055529).  Saving model ...
Epoch: 2 cost time: 0.7915394306182861
Epoch: 2, Steps: 12 | Train Loss: 2.647 Vali Loss: 2.588 Vali Acc: 0.150 Test Loss: 2.588 Test Acc: 0.150
Validation loss decreased (-0.055529 --> -0.149974).  Saving model ...
Epoch: 3 cost time: 0.7594873905181885
Epoch: 3, Steps: 12 | Train Loss: 2.529 Vali Loss: 2.467 Vali Acc: 0.344 Test Loss: 2.467 Test Acc: 0.344
Validation loss decreased (-0.149974 --> -0.344420).  Saving model ...
Epoch: 4 cost time: 0.771491527557373
Epoch: 4, Steps: 12 | Train Loss: 2.359 Vali Loss: 2.307 Vali Acc: 0.444 Test Loss: 2.307 Test Acc: 0.444
Validation loss decreased (-0.344420 --> -0.444421).  Saving model ...
Epoch: 5 cost time: 0.7678720951080322
Epoch: 5, Steps: 12 | Train Loss: 2.171 Vali Loss: 2.120 Vali Acc: 0.533 Test Loss: 2.120 Test Acc: 0.533
Validation loss decreased (-0.444421 --> -0.533312).  Saving model ...
Epoch: 6 cost time: 0.796149730682373
Epoch: 6, Steps: 12 | Train Loss: 1.955 Vali Loss: 1.930 Vali Acc: 0.583 Test Loss: 1.930 Test Acc: 0.583
Validation loss decreased (-0.533312 --> -0.583314).  Saving model ...
Epoch: 7 cost time: 0.7864553928375244
Epoch: 7, Steps: 12 | Train Loss: 1.728 Vali Loss: 1.728 Vali Acc: 0.611 Test Loss: 1.728 Test Acc: 0.611
Validation loss decreased (-0.583314 --> -0.611094).  Saving model ...
Epoch: 8 cost time: 0.7513322830200195
Epoch: 8, Steps: 12 | Train Loss: 1.535 Vali Loss: 1.548 Vali Acc: 0.611 Test Loss: 1.548 Test Acc: 0.611
Validation loss decreased (-0.611094 --> -0.611096).  Saving model ...
Epoch: 9 cost time: 0.740170955657959
Epoch: 9, Steps: 12 | Train Loss: 1.273 Vali Loss: 1.388 Vali Acc: 0.633 Test Loss: 1.388 Test Acc: 0.633
Validation loss decreased (-0.611096 --> -0.633319).  Saving model ...
Epoch: 10 cost time: 0.7657382488250732
Epoch: 10, Steps: 12 | Train Loss: 1.130 Vali Loss: 1.264 Vali Acc: 0.644 Test Loss: 1.264 Test Acc: 0.644
Validation loss decreased (-0.633319 --> -0.644432).  Saving model ...
Epoch: 11 cost time: 0.7982580661773682
Epoch: 11, Steps: 12 | Train Loss: 0.978 Vali Loss: 1.148 Vali Acc: 0.650 Test Loss: 1.148 Test Acc: 0.650
Validation loss decreased (-0.644432 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 0.7820155620574951
Epoch: 12, Steps: 12 | Train Loss: 0.876 Vali Loss: 1.076 Vali Acc: 0.694 Test Loss: 1.076 Test Acc: 0.694
Validation loss decreased (-0.649989 --> -0.694434).  Saving model ...
Epoch: 13 cost time: 0.7769150733947754
Epoch: 13, Steps: 12 | Train Loss: 0.735 Vali Loss: 1.000 Vali Acc: 0.700 Test Loss: 1.000 Test Acc: 0.700
Validation loss decreased (-0.694434 --> -0.699990).  Saving model ...
Epoch: 14 cost time: 0.7650213241577148
Epoch: 14, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.950 Vali Acc: 0.706 Test Loss: 0.950 Test Acc: 0.706
Validation loss decreased (-0.699990 --> -0.705546).  Saving model ...
Epoch: 15 cost time: 0.7555272579193115
Epoch: 15, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.919 Vali Acc: 0.722 Test Loss: 0.919 Test Acc: 0.722
Validation loss decreased (-0.705546 --> -0.722213).  Saving model ...
Epoch: 16 cost time: 0.7730998992919922
Epoch: 16, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.853 Vali Acc: 0.744 Test Loss: 0.853 Test Acc: 0.744
Validation loss decreased (-0.722213 --> -0.744436).  Saving model ...
Epoch: 17 cost time: 0.7833669185638428
Epoch: 17, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.808 Vali Acc: 0.756 Test Loss: 0.808 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755547).  Saving model ...
Epoch: 18 cost time: 0.7609238624572754
Epoch: 18, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.765 Vali Acc: 0.783 Test Loss: 0.765 Test Acc: 0.783
Validation loss decreased (-0.755547 --> -0.783326).  Saving model ...
Epoch: 19 cost time: 0.7845931053161621
Epoch: 19, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.729 Vali Acc: 0.789 Test Loss: 0.729 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 20 cost time: 0.7847557067871094
Epoch: 20, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.709 Vali Acc: 0.789 Test Loss: 0.709 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 21 cost time: 0.7813766002655029
Epoch: 21, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.685 Vali Acc: 0.800 Test Loss: 0.685 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 22 cost time: 0.7720839977264404
Epoch: 22, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.653 Vali Acc: 0.800 Test Loss: 0.653 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 23 cost time: 0.720076322555542
Epoch: 23, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.630 Vali Acc: 0.822 Test Loss: 0.630 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 24 cost time: 0.750068187713623
Epoch: 24, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.604 Vali Acc: 0.833 Test Loss: 0.604 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 25 cost time: 0.7263238430023193
Epoch: 25, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.602 Vali Acc: 0.828 Test Loss: 0.602 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7573182582855225
Epoch: 26, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.606 Vali Acc: 0.828 Test Loss: 0.606 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8072335720062256
Epoch: 27, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 0.7736101150512695
Epoch: 28, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.591 Vali Acc: 0.844 Test Loss: 0.591 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7955403327941895
Epoch: 29, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.588 Vali Acc: 0.844 Test Loss: 0.588 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.795496940612793
Epoch: 30, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.580 Vali Acc: 0.856 Test Loss: 0.580 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 31 cost time: 0.7217285633087158
Epoch: 31, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.578 Vali Acc: 0.850 Test Loss: 0.578 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7739670276641846
Epoch: 32, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.577 Vali Acc: 0.872 Test Loss: 0.577 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872216).  Saving model ...
Epoch: 33 cost time: 0.7703158855438232
Epoch: 33, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.596 Vali Acc: 0.856 Test Loss: 0.596 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7572195529937744
Epoch: 34, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7414588928222656
Epoch: 35, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.600 Vali Acc: 0.839 Test Loss: 0.600 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.789860725402832
Epoch: 36, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.598 Vali Acc: 0.856 Test Loss: 0.598 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.773322343826294
Epoch: 37, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.597 Vali Acc: 0.856 Test Loss: 0.597 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.758671760559082
Epoch: 38, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.614 Vali Acc: 0.861 Test Loss: 0.614 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.7672584056854248
Epoch: 39, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.7768459320068359
Epoch: 40, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.631 Vali Acc: 0.850 Test Loss: 0.631 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.8064267635345459
Epoch: 41, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.631 Vali Acc: 0.861 Test Loss: 0.631 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.7915585041046143
Epoch: 42, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.646 Vali Acc: 0.856 Test Loss: 0.646 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 72879
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9688501358032227
Epoch: 1, Steps: 12 | Train Loss: 2.743 Vali Loss: 2.696 Vali Acc: 0.067 Test Loss: 2.696 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 0.7514119148254395
Epoch: 2, Steps: 12 | Train Loss: 2.701 Vali Loss: 2.652 Vali Acc: 0.128 Test Loss: 2.652 Test Acc: 0.128
Validation loss decreased (-0.066640 --> -0.127751).  Saving model ...
Epoch: 3 cost time: 0.8261063098907471
Epoch: 3, Steps: 12 | Train Loss: 2.607 Vali Loss: 2.573 Vali Acc: 0.239 Test Loss: 2.573 Test Acc: 0.239
Validation loss decreased (-0.127751 --> -0.238863).  Saving model ...
Epoch: 4 cost time: 0.7941398620605469
Epoch: 4, Steps: 12 | Train Loss: 2.470 Vali Loss: 2.466 Vali Acc: 0.333 Test Loss: 2.466 Test Acc: 0.333
Validation loss decreased (-0.238863 --> -0.333309).  Saving model ...
Epoch: 5 cost time: 0.7902183532714844
Epoch: 5, Steps: 12 | Train Loss: 2.344 Vali Loss: 2.337 Vali Acc: 0.378 Test Loss: 2.337 Test Acc: 0.378
Validation loss decreased (-0.333309 --> -0.377754).  Saving model ...
Epoch: 6 cost time: 0.7623851299285889
Epoch: 6, Steps: 12 | Train Loss: 2.155 Vali Loss: 2.186 Vali Acc: 0.433 Test Loss: 2.186 Test Acc: 0.433
Validation loss decreased (-0.377754 --> -0.433311).  Saving model ...
Epoch: 7 cost time: 0.7664823532104492
Epoch: 7, Steps: 12 | Train Loss: 1.977 Vali Loss: 2.025 Vali Acc: 0.461 Test Loss: 2.025 Test Acc: 0.461
Validation loss decreased (-0.433311 --> -0.461091).  Saving model ...
Epoch: 8 cost time: 0.7653191089630127
Epoch: 8, Steps: 12 | Train Loss: 1.817 Vali Loss: 1.846 Vali Acc: 0.494 Test Loss: 1.846 Test Acc: 0.494
Validation loss decreased (-0.461091 --> -0.494426).  Saving model ...
Epoch: 9 cost time: 0.7483537197113037
Epoch: 9, Steps: 12 | Train Loss: 1.593 Vali Loss: 1.696 Vali Acc: 0.550 Test Loss: 1.696 Test Acc: 0.550
Validation loss decreased (-0.494426 --> -0.549983).  Saving model ...
Epoch: 10 cost time: 0.746117353439331
Epoch: 10, Steps: 12 | Train Loss: 1.388 Vali Loss: 1.535 Vali Acc: 0.606 Test Loss: 1.535 Test Acc: 0.606
Validation loss decreased (-0.549983 --> -0.605540).  Saving model ...
Epoch: 11 cost time: 0.707913875579834
Epoch: 11, Steps: 12 | Train Loss: 1.271 Vali Loss: 1.400 Vali Acc: 0.628 Test Loss: 1.400 Test Acc: 0.628
Validation loss decreased (-0.605540 --> -0.627764).  Saving model ...
Epoch: 12 cost time: 0.7423853874206543
Epoch: 12, Steps: 12 | Train Loss: 1.082 Vali Loss: 1.290 Vali Acc: 0.628 Test Loss: 1.290 Test Acc: 0.628
Validation loss decreased (-0.627764 --> -0.627765).  Saving model ...
Epoch: 13 cost time: 0.6894114017486572
Epoch: 13, Steps: 12 | Train Loss: 0.975 Vali Loss: 1.201 Vali Acc: 0.656 Test Loss: 1.201 Test Acc: 0.656
Validation loss decreased (-0.627765 --> -0.655544).  Saving model ...
Epoch: 14 cost time: 0.7846558094024658
Epoch: 14, Steps: 12 | Train Loss: 0.902 Vali Loss: 1.146 Vali Acc: 0.661 Test Loss: 1.146 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661100).  Saving model ...
Epoch: 15 cost time: 0.7447056770324707
Epoch: 15, Steps: 12 | Train Loss: 0.822 Vali Loss: 1.071 Vali Acc: 0.694 Test Loss: 1.071 Test Acc: 0.694
Validation loss decreased (-0.661100 --> -0.694434).  Saving model ...
Epoch: 16 cost time: 0.7572026252746582
Epoch: 16, Steps: 12 | Train Loss: 0.690 Vali Loss: 1.007 Vali Acc: 0.694 Test Loss: 1.007 Test Acc: 0.694
Validation loss decreased (-0.694434 --> -0.694434).  Saving model ...
Epoch: 17 cost time: 0.7811317443847656
Epoch: 17, Steps: 12 | Train Loss: 0.626 Vali Loss: 0.988 Vali Acc: 0.694 Test Loss: 0.988 Test Acc: 0.694
Validation loss decreased (-0.694434 --> -0.694435).  Saving model ...
Epoch: 18 cost time: 0.7662696838378906
Epoch: 18, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.914 Vali Acc: 0.694 Test Loss: 0.914 Test Acc: 0.694
Validation loss decreased (-0.694435 --> -0.694435).  Saving model ...
Epoch: 19 cost time: 0.8356001377105713
Epoch: 19, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.871 Vali Acc: 0.722 Test Loss: 0.871 Test Acc: 0.722
Validation loss decreased (-0.694435 --> -0.722214).  Saving model ...
Epoch: 20 cost time: 0.7703001499176025
Epoch: 20, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.862 Vali Acc: 0.739 Test Loss: 0.862 Test Acc: 0.739
Validation loss decreased (-0.722214 --> -0.738880).  Saving model ...
Epoch: 21 cost time: 0.7656023502349854
Epoch: 21, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.831 Vali Acc: 0.739 Test Loss: 0.831 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738881).  Saving model ...
Epoch: 22 cost time: 0.7617168426513672
Epoch: 22, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.804 Vali Acc: 0.783 Test Loss: 0.804 Test Acc: 0.783
Validation loss decreased (-0.738881 --> -0.783325).  Saving model ...
Epoch: 23 cost time: 0.737969160079956
Epoch: 23, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.768 Vali Acc: 0.778 Test Loss: 0.768 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8387689590454102
Epoch: 24, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.748 Vali Acc: 0.789 Test Loss: 0.748 Test Acc: 0.789
Validation loss decreased (-0.783325 --> -0.788881).  Saving model ...
Epoch: 25 cost time: 0.7112851142883301
Epoch: 25, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.734 Vali Acc: 0.806 Test Loss: 0.734 Test Acc: 0.806
Validation loss decreased (-0.788881 --> -0.805548).  Saving model ...
Epoch: 26 cost time: 0.7573728561401367
Epoch: 26, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.688 Vali Acc: 0.806 Test Loss: 0.688 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805549).  Saving model ...
Epoch: 27 cost time: 0.7492377758026123
Epoch: 27, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.686 Vali Acc: 0.811 Test Loss: 0.686 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811104).  Saving model ...
Epoch: 28 cost time: 0.727595329284668
Epoch: 28, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.677 Vali Acc: 0.833 Test Loss: 0.677 Test Acc: 0.833
Validation loss decreased (-0.811104 --> -0.833327).  Saving model ...
Epoch: 29 cost time: 0.7837207317352295
Epoch: 29, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.668 Vali Acc: 0.833 Test Loss: 0.668 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 30 cost time: 0.7683107852935791
Epoch: 30, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.642 Vali Acc: 0.850 Test Loss: 0.642 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 31 cost time: 0.7684991359710693
Epoch: 31, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.639 Vali Acc: 0.850 Test Loss: 0.639 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 32 cost time: 0.7730410099029541
Epoch: 32, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.663 Vali Acc: 0.844 Test Loss: 0.663 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7622394561767578
Epoch: 33, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.656 Vali Acc: 0.839 Test Loss: 0.656 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7469255924224854
Epoch: 34, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.658 Vali Acc: 0.828 Test Loss: 0.658 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7518901824951172
Epoch: 35, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.656 Vali Acc: 0.839 Test Loss: 0.656 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7754347324371338
Epoch: 36, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.659 Vali Acc: 0.844 Test Loss: 0.659 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.728062629699707
Epoch: 37, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.657 Vali Acc: 0.839 Test Loss: 0.657 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7331483364105225
Epoch: 38, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.674 Vali Acc: 0.844 Test Loss: 0.674 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7425198554992676
Epoch: 39, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.683 Vali Acc: 0.844 Test Loss: 0.683 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.7652487754821777
Epoch: 40, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.659 Vali Acc: 0.861 Test Loss: 0.659 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 41 cost time: 0.7973804473876953
Epoch: 41, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.670 Vali Acc: 0.867 Test Loss: 0.670 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 42 cost time: 0.7501628398895264
Epoch: 42, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.684 Vali Acc: 0.850 Test Loss: 0.684 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6395509243011475
Epoch: 43, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.688 Vali Acc: 0.839 Test Loss: 0.688 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8143091201782227
Epoch: 44, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.701 Vali Acc: 0.861 Test Loss: 0.701 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8042898178100586
Epoch: 45, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.698 Vali Acc: 0.861 Test Loss: 0.698 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.7580287456512451
Epoch: 46, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.742 Vali Acc: 0.850 Test Loss: 0.742 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.823106050491333
Epoch: 47, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.730 Vali Acc: 0.861 Test Loss: 0.730 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.8123462200164795
Epoch: 48, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.704 Vali Acc: 0.867 Test Loss: 0.704 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.7439367771148682
Epoch: 49, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.729 Vali Acc: 0.850 Test Loss: 0.729 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.7699089050292969
Epoch: 50, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.781 Vali Acc: 0.850 Test Loss: 0.781 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 67151
model size : 0.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.142756938934326
Epoch: 1, Steps: 12 | Train Loss: 2.781 Vali Loss: 2.709 Vali Acc: 0.106 Test Loss: 2.709 Test Acc: 0.106
Validation loss decreased (inf --> -0.105528).  Saving model ...
Epoch: 2 cost time: 0.8067474365234375
Epoch: 2, Steps: 12 | Train Loss: 2.725 Vali Loss: 2.669 Vali Acc: 0.106 Test Loss: 2.669 Test Acc: 0.106
Validation loss decreased (-0.105528 --> -0.105529).  Saving model ...
Epoch: 3 cost time: 0.7665696144104004
Epoch: 3, Steps: 12 | Train Loss: 2.648 Vali Loss: 2.599 Vali Acc: 0.144 Test Loss: 2.599 Test Acc: 0.144
Validation loss decreased (-0.105529 --> -0.144418).  Saving model ...
Epoch: 4 cost time: 0.7819688320159912
Epoch: 4, Steps: 12 | Train Loss: 2.555 Vali Loss: 2.505 Vali Acc: 0.228 Test Loss: 2.505 Test Acc: 0.228
Validation loss decreased (-0.144418 --> -0.227753).  Saving model ...
Epoch: 5 cost time: 0.7840793132781982
Epoch: 5, Steps: 12 | Train Loss: 2.453 Vali Loss: 2.405 Vali Acc: 0.333 Test Loss: 2.405 Test Acc: 0.333
Validation loss decreased (-0.227753 --> -0.333309).  Saving model ...
Epoch: 6 cost time: 0.8024845123291016
Epoch: 6, Steps: 12 | Train Loss: 2.314 Vali Loss: 2.293 Vali Acc: 0.394 Test Loss: 2.293 Test Acc: 0.394
Validation loss decreased (-0.333309 --> -0.394422).  Saving model ...
Epoch: 7 cost time: 0.7810556888580322
Epoch: 7, Steps: 12 | Train Loss: 2.197 Vali Loss: 2.144 Vali Acc: 0.494 Test Loss: 2.144 Test Acc: 0.494
Validation loss decreased (-0.394422 --> -0.494423).  Saving model ...
Epoch: 8 cost time: 0.818444013595581
Epoch: 8, Steps: 12 | Train Loss: 1.980 Vali Loss: 2.000 Vali Acc: 0.506 Test Loss: 2.000 Test Acc: 0.506
Validation loss decreased (-0.494423 --> -0.505536).  Saving model ...
Epoch: 9 cost time: 0.8866856098175049
Epoch: 9, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.858 Vali Acc: 0.556 Test Loss: 1.858 Test Acc: 0.556
Validation loss decreased (-0.505536 --> -0.555537).  Saving model ...
Epoch: 10 cost time: 0.8026885986328125
Epoch: 10, Steps: 12 | Train Loss: 1.622 Vali Loss: 1.713 Vali Acc: 0.567 Test Loss: 1.713 Test Acc: 0.567
Validation loss decreased (-0.555537 --> -0.566650).  Saving model ...
Epoch: 11 cost time: 0.7874033451080322
Epoch: 11, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.578 Vali Acc: 0.600 Test Loss: 1.578 Test Acc: 0.600
Validation loss decreased (-0.566650 --> -0.599984).  Saving model ...
Epoch: 12 cost time: 0.8190324306488037
Epoch: 12, Steps: 12 | Train Loss: 1.310 Vali Loss: 1.436 Vali Acc: 0.650 Test Loss: 1.436 Test Acc: 0.650
Validation loss decreased (-0.599984 --> -0.649986).  Saving model ...
Epoch: 13 cost time: 0.7403590679168701
Epoch: 13, Steps: 12 | Train Loss: 1.115 Vali Loss: 1.340 Vali Acc: 0.650 Test Loss: 1.340 Test Acc: 0.650
Validation loss decreased (-0.649986 --> -0.649987).  Saving model ...
Epoch: 14 cost time: 0.7755882740020752
Epoch: 14, Steps: 12 | Train Loss: 0.993 Vali Loss: 1.243 Vali Acc: 0.650 Test Loss: 1.243 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649988).  Saving model ...
Epoch: 15 cost time: 0.7760887145996094
Epoch: 15, Steps: 12 | Train Loss: 0.912 Vali Loss: 1.160 Vali Acc: 0.661 Test Loss: 1.160 Test Acc: 0.661
Validation loss decreased (-0.649988 --> -0.661100).  Saving model ...
Epoch: 16 cost time: 0.6992120742797852
Epoch: 16, Steps: 12 | Train Loss: 0.875 Vali Loss: 1.088 Vali Acc: 0.672 Test Loss: 1.088 Test Acc: 0.672
Validation loss decreased (-0.661100 --> -0.672211).  Saving model ...
Epoch: 17 cost time: 0.786060094833374
Epoch: 17, Steps: 12 | Train Loss: 0.762 Vali Loss: 1.024 Vali Acc: 0.689 Test Loss: 1.024 Test Acc: 0.689
Validation loss decreased (-0.672211 --> -0.688879).  Saving model ...
Epoch: 18 cost time: 0.6904687881469727
Epoch: 18, Steps: 12 | Train Loss: 0.738 Vali Loss: 0.954 Vali Acc: 0.661 Test Loss: 0.954 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7081453800201416
Epoch: 19, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.929 Vali Acc: 0.672 Test Loss: 0.929 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7149713039398193
Epoch: 20, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.898 Vali Acc: 0.683 Test Loss: 0.898 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7852787971496582
Epoch: 21, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.864 Vali Acc: 0.694 Test Loss: 0.864 Test Acc: 0.694
Validation loss decreased (-0.688879 --> -0.694436).  Saving model ...
Epoch: 22 cost time: 0.7768731117248535
Epoch: 22, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.833 Vali Acc: 0.717 Test Loss: 0.833 Test Acc: 0.717
Validation loss decreased (-0.694436 --> -0.716658).  Saving model ...
Epoch: 23 cost time: 0.7753586769104004
Epoch: 23, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.803 Vali Acc: 0.756 Test Loss: 0.803 Test Acc: 0.756
Validation loss decreased (-0.716658 --> -0.755548).  Saving model ...
Epoch: 24 cost time: 0.7912163734436035
Epoch: 24, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.764 Vali Acc: 0.756 Test Loss: 0.764 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 25 cost time: 0.7779524326324463
Epoch: 25, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.754 Vali Acc: 0.772 Test Loss: 0.754 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772215).  Saving model ...
Epoch: 26 cost time: 0.7525215148925781
Epoch: 26, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.739 Vali Acc: 0.789 Test Loss: 0.739 Test Acc: 0.789
Validation loss decreased (-0.772215 --> -0.788881).  Saving model ...
Epoch: 27 cost time: 0.7667875289916992
Epoch: 27, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.723 Vali Acc: 0.800 Test Loss: 0.723 Test Acc: 0.800
Validation loss decreased (-0.788881 --> -0.799993).  Saving model ...
Epoch: 28 cost time: 0.7841172218322754
Epoch: 28, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.696 Vali Acc: 0.806 Test Loss: 0.696 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 29 cost time: 0.7060723304748535
Epoch: 29, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.662 Vali Acc: 0.817 Test Loss: 0.662 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816660).  Saving model ...
Epoch: 30 cost time: 0.7881300449371338
Epoch: 30, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.669 Vali Acc: 0.828 Test Loss: 0.669 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 31 cost time: 0.7569119930267334
Epoch: 31, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.673 Vali Acc: 0.811 Test Loss: 0.673 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7368357181549072
Epoch: 32, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.662 Vali Acc: 0.833 Test Loss: 0.662 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 33 cost time: 0.8631327152252197
Epoch: 33, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.647 Vali Acc: 0.839 Test Loss: 0.647 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838882).  Saving model ...
Epoch: 34 cost time: 0.8112094402313232
Epoch: 34, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.663 Vali Acc: 0.833 Test Loss: 0.663 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6927471160888672
Epoch: 35, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.659 Vali Acc: 0.839 Test Loss: 0.659 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8119616508483887
Epoch: 36, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.661 Vali Acc: 0.844 Test Loss: 0.661 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 37 cost time: 0.785175085067749
Epoch: 37, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.624 Vali Acc: 0.844 Test Loss: 0.624 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 38 cost time: 0.8088924884796143
Epoch: 38, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.648 Vali Acc: 0.839 Test Loss: 0.648 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7249836921691895
Epoch: 39, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.646 Vali Acc: 0.833 Test Loss: 0.646 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8482716083526611
Epoch: 40, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.630 Vali Acc: 0.833 Test Loss: 0.630 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7825779914855957
Epoch: 41, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.648 Vali Acc: 0.850 Test Loss: 0.648 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 42 cost time: 0.8508293628692627
Epoch: 42, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.665 Vali Acc: 0.844 Test Loss: 0.665 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7738735675811768
Epoch: 43, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.629 Vali Acc: 0.844 Test Loss: 0.629 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8151631355285645
Epoch: 44, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.653 Vali Acc: 0.856 Test Loss: 0.653 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 45 cost time: 0.6928861141204834
Epoch: 45, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.653 Vali Acc: 0.867 Test Loss: 0.653 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866660).  Saving model ...
Epoch: 46 cost time: 0.7757871150970459
Epoch: 46, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7213325500488281
Epoch: 47, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.660 Vali Acc: 0.867 Test Loss: 0.660 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7885370254516602
Epoch: 48, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.656 Vali Acc: 0.861 Test Loss: 0.656 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7924823760986328
Epoch: 49, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.650 Vali Acc: 0.844 Test Loss: 0.650 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.7660961151123047
Epoch: 50, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.695 Vali Acc: 0.856 Test Loss: 0.695 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 63375
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.014186382293701
Epoch: 1, Steps: 12 | Train Loss: 2.806 Vali Loss: 2.704 Vali Acc: 0.133 Test Loss: 2.704 Test Acc: 0.133
Validation loss decreased (inf --> -0.133306).  Saving model ...
Epoch: 2 cost time: 0.7655613422393799
Epoch: 2, Steps: 12 | Train Loss: 2.755 Vali Loss: 2.663 Vali Acc: 0.156 Test Loss: 2.663 Test Acc: 0.156
Validation loss decreased (-0.133306 --> -0.155529).  Saving model ...
Epoch: 3 cost time: 0.7758562564849854
Epoch: 3, Steps: 12 | Train Loss: 2.664 Vali Loss: 2.593 Vali Acc: 0.217 Test Loss: 2.593 Test Acc: 0.217
Validation loss decreased (-0.155529 --> -0.216641).  Saving model ...
Epoch: 4 cost time: 0.7476396560668945
Epoch: 4, Steps: 12 | Train Loss: 2.603 Vali Loss: 2.506 Vali Acc: 0.294 Test Loss: 2.506 Test Acc: 0.294
Validation loss decreased (-0.216641 --> -0.294419).  Saving model ...
Epoch: 5 cost time: 0.801762580871582
Epoch: 5, Steps: 12 | Train Loss: 2.498 Vali Loss: 2.400 Vali Acc: 0.406 Test Loss: 2.400 Test Acc: 0.406
Validation loss decreased (-0.294419 --> -0.405532).  Saving model ...
Epoch: 6 cost time: 0.7412054538726807
Epoch: 6, Steps: 12 | Train Loss: 2.361 Vali Loss: 2.279 Vali Acc: 0.444 Test Loss: 2.279 Test Acc: 0.444
Validation loss decreased (-0.405532 --> -0.444422).  Saving model ...
Epoch: 7 cost time: 0.9145174026489258
Epoch: 7, Steps: 12 | Train Loss: 2.224 Vali Loss: 2.133 Vali Acc: 0.506 Test Loss: 2.133 Test Acc: 0.506
Validation loss decreased (-0.444422 --> -0.505534).  Saving model ...
Epoch: 8 cost time: 0.7882771492004395
Epoch: 8, Steps: 12 | Train Loss: 2.010 Vali Loss: 1.989 Vali Acc: 0.572 Test Loss: 1.989 Test Acc: 0.572
Validation loss decreased (-0.505534 --> -0.572202).  Saving model ...
Epoch: 9 cost time: 0.7883718013763428
Epoch: 9, Steps: 12 | Train Loss: 1.886 Vali Loss: 1.831 Vali Acc: 0.611 Test Loss: 1.831 Test Acc: 0.611
Validation loss decreased (-0.572202 --> -0.611093).  Saving model ...
Epoch: 10 cost time: 0.7769749164581299
Epoch: 10, Steps: 12 | Train Loss: 1.695 Vali Loss: 1.665 Vali Acc: 0.622 Test Loss: 1.665 Test Acc: 0.622
Validation loss decreased (-0.611093 --> -0.622206).  Saving model ...
Epoch: 11 cost time: 0.7804651260375977
Epoch: 11, Steps: 12 | Train Loss: 1.462 Vali Loss: 1.519 Vali Acc: 0.622 Test Loss: 1.519 Test Acc: 0.622
Validation loss decreased (-0.622206 --> -0.622207).  Saving model ...
Epoch: 12 cost time: 0.7602276802062988
Epoch: 12, Steps: 12 | Train Loss: 1.314 Vali Loss: 1.388 Vali Acc: 0.628 Test Loss: 1.388 Test Acc: 0.628
Validation loss decreased (-0.622207 --> -0.627764).  Saving model ...
Epoch: 13 cost time: 0.7356548309326172
Epoch: 13, Steps: 12 | Train Loss: 1.138 Vali Loss: 1.269 Vali Acc: 0.639 Test Loss: 1.269 Test Acc: 0.639
Validation loss decreased (-0.627764 --> -0.638876).  Saving model ...
Epoch: 14 cost time: 0.7706935405731201
Epoch: 14, Steps: 12 | Train Loss: 1.067 Vali Loss: 1.174 Vali Acc: 0.656 Test Loss: 1.174 Test Acc: 0.656
Validation loss decreased (-0.638876 --> -0.655544).  Saving model ...
Epoch: 15 cost time: 0.7472662925720215
Epoch: 15, Steps: 12 | Train Loss: 0.942 Vali Loss: 1.104 Vali Acc: 0.678 Test Loss: 1.104 Test Acc: 0.678
Validation loss decreased (-0.655544 --> -0.677767).  Saving model ...
Epoch: 16 cost time: 0.7509937286376953
Epoch: 16, Steps: 12 | Train Loss: 0.873 Vali Loss: 1.026 Vali Acc: 0.694 Test Loss: 1.026 Test Acc: 0.694
Validation loss decreased (-0.677767 --> -0.694434).  Saving model ...
Epoch: 17 cost time: 0.7832551002502441
Epoch: 17, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.971 Vali Acc: 0.733 Test Loss: 0.971 Test Acc: 0.733
Validation loss decreased (-0.694434 --> -0.733324).  Saving model ...
Epoch: 18 cost time: 0.7862560749053955
Epoch: 18, Steps: 12 | Train Loss: 0.658 Vali Loss: 0.917 Vali Acc: 0.750 Test Loss: 0.917 Test Acc: 0.750
Validation loss decreased (-0.733324 --> -0.749991).  Saving model ...
Epoch: 19 cost time: 0.7770841121673584
Epoch: 19, Steps: 12 | Train Loss: 0.626 Vali Loss: 0.881 Vali Acc: 0.750 Test Loss: 0.881 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 20 cost time: 0.7811002731323242
Epoch: 20, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.848 Vali Acc: 0.750 Test Loss: 0.848 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 21 cost time: 0.7481412887573242
Epoch: 21, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.802 Vali Acc: 0.761 Test Loss: 0.802 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761103).  Saving model ...
Epoch: 22 cost time: 0.7786991596221924
Epoch: 22, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.760 Vali Acc: 0.789 Test Loss: 0.760 Test Acc: 0.789
Validation loss decreased (-0.761103 --> -0.788881).  Saving model ...
Epoch: 23 cost time: 0.7723140716552734
Epoch: 23, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.741 Vali Acc: 0.783 Test Loss: 0.741 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7973639965057373
Epoch: 24, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.707 Vali Acc: 0.811 Test Loss: 0.707 Test Acc: 0.811
Validation loss decreased (-0.788881 --> -0.811104).  Saving model ...
Epoch: 25 cost time: 0.7673194408416748
Epoch: 25, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.689 Vali Acc: 0.817 Test Loss: 0.689 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 26 cost time: 0.7841105461120605
Epoch: 26, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.673 Vali Acc: 0.839 Test Loss: 0.673 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838882).  Saving model ...
Epoch: 27 cost time: 0.7298398017883301
Epoch: 27, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.644 Vali Acc: 0.839 Test Loss: 0.644 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838882).  Saving model ...
Epoch: 28 cost time: 0.7555913925170898
Epoch: 28, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.631 Vali Acc: 0.833 Test Loss: 0.631 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7304797172546387
Epoch: 29, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.621 Vali Acc: 0.833 Test Loss: 0.621 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7554495334625244
Epoch: 30, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.610 Vali Acc: 0.833 Test Loss: 0.610 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.744185209274292
Epoch: 31, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.609 Vali Acc: 0.839 Test Loss: 0.609 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 32 cost time: 0.7904529571533203
Epoch: 32, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.593 Vali Acc: 0.844 Test Loss: 0.593 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 33 cost time: 0.7431187629699707
Epoch: 33, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.586 Vali Acc: 0.839 Test Loss: 0.586 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8056511878967285
Epoch: 34, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.566 Vali Acc: 0.839 Test Loss: 0.566 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7798089981079102
Epoch: 35, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 36 cost time: 0.7998185157775879
Epoch: 36, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.577 Vali Acc: 0.850 Test Loss: 0.577 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7689812183380127
Epoch: 37, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7885231971740723
Epoch: 38, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.577 Vali Acc: 0.828 Test Loss: 0.577 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8092501163482666
Epoch: 39, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.571 Vali Acc: 0.822 Test Loss: 0.571 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7697913646697998
Epoch: 40, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.572 Vali Acc: 0.833 Test Loss: 0.572 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7982957363128662
Epoch: 41, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.604 Vali Acc: 0.833 Test Loss: 0.604 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7506325244903564
Epoch: 42, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.602 Vali Acc: 0.833 Test Loss: 0.602 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7964580059051514
Epoch: 43, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.593 Vali Acc: 0.844 Test Loss: 0.593 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.7619102001190186
Epoch: 44, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.585 Vali Acc: 0.839 Test Loss: 0.585 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.7755260467529297
Epoch: 45, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.85
model parameter : 61519
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1065316200256348
Epoch: 1, Steps: 12 | Train Loss: 2.721 Vali Loss: 2.699 Vali Acc: 0.100 Test Loss: 2.699 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 0.7630405426025391
Epoch: 2, Steps: 12 | Train Loss: 2.667 Vali Loss: 2.664 Vali Acc: 0.111 Test Loss: 2.664 Test Acc: 0.111
Validation loss decreased (-0.099973 --> -0.111084).  Saving model ...
Epoch: 3 cost time: 0.7951288223266602
Epoch: 3, Steps: 12 | Train Loss: 2.606 Vali Loss: 2.607 Vali Acc: 0.183 Test Loss: 2.607 Test Acc: 0.183
Validation loss decreased (-0.111084 --> -0.183307).  Saving model ...
Epoch: 4 cost time: 0.8082904815673828
Epoch: 4, Steps: 12 | Train Loss: 2.558 Vali Loss: 2.537 Vali Acc: 0.261 Test Loss: 2.537 Test Acc: 0.261
Validation loss decreased (-0.183307 --> -0.261086).  Saving model ...
Epoch: 5 cost time: 0.7709438800811768
Epoch: 5, Steps: 12 | Train Loss: 2.467 Vali Loss: 2.461 Vali Acc: 0.394 Test Loss: 2.461 Test Acc: 0.394
Validation loss decreased (-0.261086 --> -0.394420).  Saving model ...
Epoch: 6 cost time: 0.7852668762207031
Epoch: 6, Steps: 12 | Train Loss: 2.372 Vali Loss: 2.364 Vali Acc: 0.494 Test Loss: 2.364 Test Acc: 0.494
Validation loss decreased (-0.394420 --> -0.494421).  Saving model ...
Epoch: 7 cost time: 0.719759464263916
Epoch: 7, Steps: 12 | Train Loss: 2.263 Vali Loss: 2.261 Vali Acc: 0.489 Test Loss: 2.261 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7937824726104736
Epoch: 8, Steps: 12 | Train Loss: 2.130 Vali Loss: 2.131 Vali Acc: 0.511 Test Loss: 2.131 Test Acc: 0.511
Validation loss decreased (-0.494421 --> -0.511090).  Saving model ...
Epoch: 9 cost time: 0.8054165840148926
Epoch: 9, Steps: 12 | Train Loss: 1.977 Vali Loss: 1.987 Vali Acc: 0.550 Test Loss: 1.987 Test Acc: 0.550
Validation loss decreased (-0.511090 --> -0.549980).  Saving model ...
Epoch: 10 cost time: 0.7849361896514893
Epoch: 10, Steps: 12 | Train Loss: 1.809 Vali Loss: 1.857 Vali Acc: 0.589 Test Loss: 1.857 Test Acc: 0.589
Validation loss decreased (-0.549980 --> -0.588870).  Saving model ...
Epoch: 11 cost time: 0.8103675842285156
Epoch: 11, Steps: 12 | Train Loss: 1.627 Vali Loss: 1.690 Vali Acc: 0.589 Test Loss: 1.690 Test Acc: 0.589
Validation loss decreased (-0.588870 --> -0.588872).  Saving model ...
Epoch: 12 cost time: 0.7531113624572754
Epoch: 12, Steps: 12 | Train Loss: 1.483 Vali Loss: 1.538 Vali Acc: 0.656 Test Loss: 1.538 Test Acc: 0.656
Validation loss decreased (-0.588872 --> -0.655540).  Saving model ...
Epoch: 13 cost time: 0.7956256866455078
Epoch: 13, Steps: 12 | Train Loss: 1.282 Vali Loss: 1.407 Vali Acc: 0.656 Test Loss: 1.407 Test Acc: 0.656
Validation loss decreased (-0.655540 --> -0.655541).  Saving model ...
Epoch: 14 cost time: 0.8381681442260742
Epoch: 14, Steps: 12 | Train Loss: 1.173 Vali Loss: 1.283 Vali Acc: 0.678 Test Loss: 1.283 Test Acc: 0.678
Validation loss decreased (-0.655541 --> -0.677765).  Saving model ...
Epoch: 15 cost time: 0.7868704795837402
Epoch: 15, Steps: 12 | Train Loss: 1.055 Vali Loss: 1.185 Vali Acc: 0.689 Test Loss: 1.185 Test Acc: 0.689
Validation loss decreased (-0.677765 --> -0.688877).  Saving model ...
Epoch: 16 cost time: 0.785398006439209
Epoch: 16, Steps: 12 | Train Loss: 0.943 Vali Loss: 1.085 Vali Acc: 0.739 Test Loss: 1.085 Test Acc: 0.739
Validation loss decreased (-0.688877 --> -0.738878).  Saving model ...
Epoch: 17 cost time: 0.772122859954834
Epoch: 17, Steps: 12 | Train Loss: 0.824 Vali Loss: 0.998 Vali Acc: 0.767 Test Loss: 0.998 Test Acc: 0.767
Validation loss decreased (-0.738878 --> -0.766657).  Saving model ...
Epoch: 18 cost time: 0.7553062438964844
Epoch: 18, Steps: 12 | Train Loss: 0.773 Vali Loss: 0.938 Vali Acc: 0.772 Test Loss: 0.938 Test Acc: 0.772
Validation loss decreased (-0.766657 --> -0.772213).  Saving model ...
Epoch: 19 cost time: 0.7613000869750977
Epoch: 19, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.875 Vali Acc: 0.767 Test Loss: 0.875 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.806159257888794
Epoch: 20, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.817 Vali Acc: 0.789 Test Loss: 0.817 Test Acc: 0.789
Validation loss decreased (-0.772213 --> -0.788881).  Saving model ...
Epoch: 21 cost time: 0.8551011085510254
Epoch: 21, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.765 Vali Acc: 0.789 Test Loss: 0.765 Test Acc: 0.789
Validation loss decreased (-0.788881 --> -0.788881).  Saving model ...
Epoch: 22 cost time: 0.8855850696563721
Epoch: 22, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.726 Vali Acc: 0.811 Test Loss: 0.726 Test Acc: 0.811
Validation loss decreased (-0.788881 --> -0.811104).  Saving model ...
Epoch: 23 cost time: 0.8021881580352783
Epoch: 23, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.691 Vali Acc: 0.811 Test Loss: 0.691 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 24 cost time: 0.8363771438598633
Epoch: 24, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.667 Vali Acc: 0.822 Test Loss: 0.667 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822216).  Saving model ...
Epoch: 25 cost time: 0.7670257091522217
Epoch: 25, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.626 Vali Acc: 0.839 Test Loss: 0.626 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 26 cost time: 0.7892966270446777
Epoch: 26, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 27 cost time: 0.7866909503936768
Epoch: 27, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.577 Vali Acc: 0.861 Test Loss: 0.577 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 28 cost time: 0.7608683109283447
Epoch: 28, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.570 Vali Acc: 0.878 Test Loss: 0.570 Test Acc: 0.878
Validation loss decreased (-0.861105 --> -0.877772).  Saving model ...
Epoch: 29 cost time: 0.7959496974945068
Epoch: 29, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.571 Vali Acc: 0.839 Test Loss: 0.571 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7279853820800781
Epoch: 30, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.558 Vali Acc: 0.839 Test Loss: 0.558 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.796844482421875
Epoch: 31, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.535 Vali Acc: 0.856 Test Loss: 0.535 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7315144538879395
Epoch: 32, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.538 Vali Acc: 0.856 Test Loss: 0.538 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7485885620117188
Epoch: 33, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7700424194335938
Epoch: 34, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.510 Vali Acc: 0.867 Test Loss: 0.510 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7809631824493408
Epoch: 35, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.515 Vali Acc: 0.856 Test Loss: 0.515 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.7594039440155029
Epoch: 36, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.506 Vali Acc: 0.872 Test Loss: 0.506 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.7956185340881348
Epoch: 37, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.499 Vali Acc: 0.861 Test Loss: 0.499 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.7738101482391357
Epoch: 38, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.507 Vali Acc: 0.867 Test Loss: 0.507 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 59695
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1818244457244873
Epoch: 1, Steps: 12 | Train Loss: 2.485 Vali Loss: 2.161 Vali Acc: 0.456 Test Loss: 2.161 Test Acc: 0.456
Validation loss decreased (inf --> -0.455534).  Saving model ...
Epoch: 2 cost time: 0.9179620742797852
Epoch: 2, Steps: 12 | Train Loss: 1.425 Vali Loss: 1.409 Vali Acc: 0.589 Test Loss: 1.409 Test Acc: 0.589
Validation loss decreased (-0.455534 --> -0.588875).  Saving model ...
Epoch: 3 cost time: 0.9261107444763184
Epoch: 3, Steps: 12 | Train Loss: 0.830 Vali Loss: 1.061 Vali Acc: 0.672 Test Loss: 1.061 Test Acc: 0.672
Validation loss decreased (-0.588875 --> -0.672212).  Saving model ...
Epoch: 4 cost time: 0.8702309131622314
Epoch: 4, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.935 Vali Acc: 0.683 Test Loss: 0.935 Test Acc: 0.683
Validation loss decreased (-0.672212 --> -0.683324).  Saving model ...
Epoch: 5 cost time: 0.9510760307312012
Epoch: 5, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.883 Vali Acc: 0.750 Test Loss: 0.883 Test Acc: 0.750
Validation loss decreased (-0.683324 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 0.9099783897399902
Epoch: 6, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.875 Vali Acc: 0.733 Test Loss: 0.875 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9855499267578125
Epoch: 7, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.811 Vali Acc: 0.783 Test Loss: 0.811 Test Acc: 0.783
Validation loss decreased (-0.749991 --> -0.783325).  Saving model ...
Epoch: 8 cost time: 0.9905257225036621
Epoch: 8, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.701 Vali Acc: 0.806 Test Loss: 0.701 Test Acc: 0.806
Validation loss decreased (-0.783325 --> -0.805549).  Saving model ...
Epoch: 9 cost time: 0.9800190925598145
Epoch: 9, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.818 Vali Acc: 0.800 Test Loss: 0.818 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0326740741729736
Epoch: 10, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.787 Vali Acc: 0.839 Test Loss: 0.787 Test Acc: 0.839
Validation loss decreased (-0.805549 --> -0.838881).  Saving model ...
Epoch: 11 cost time: 0.9796233177185059
Epoch: 11, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.698 Vali Acc: 0.822 Test Loss: 0.698 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9190170764923096
Epoch: 12, Steps: 12 | Train Loss: 0.095 Vali Loss: 1.014 Vali Acc: 0.789 Test Loss: 1.014 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8987669944763184
Epoch: 13, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.905 Vali Acc: 0.833 Test Loss: 0.905 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8949563503265381
Epoch: 14, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.885 Vali Acc: 0.839 Test Loss: 0.885 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8944177627563477
Epoch: 15, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.853 Vali Acc: 0.856 Test Loss: 0.853 Test Acc: 0.856
Validation loss decreased (-0.838881 --> -0.855547).  Saving model ...
Epoch: 16 cost time: 0.911083459854126
Epoch: 16, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.036 Vali Acc: 0.844 Test Loss: 1.036 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9183523654937744
Epoch: 17, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.008 Vali Acc: 0.867 Test Loss: 1.008 Test Acc: 0.867
Validation loss decreased (-0.855547 --> -0.866657).  Saving model ...
Epoch: 18 cost time: 0.9716730117797852
Epoch: 18, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.950 Vali Acc: 0.856 Test Loss: 0.950 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9468405246734619
Epoch: 19, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.926 Vali Acc: 0.867 Test Loss: 0.926 Test Acc: 0.867
Validation loss decreased (-0.866657 --> -0.866657).  Saving model ...
Epoch: 20 cost time: 0.9618744850158691
Epoch: 20, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.020 Vali Acc: 0.867 Test Loss: 1.020 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9696395397186279
Epoch: 21, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.026 Vali Acc: 0.850 Test Loss: 1.026 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9763612747192383
Epoch: 22, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.134 Vali Acc: 0.844 Test Loss: 1.134 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9047839641571045
Epoch: 23, Steps: 12 | Train Loss: 0.061 Vali Loss: 1.195 Vali Acc: 0.833 Test Loss: 1.195 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9407439231872559
Epoch: 24, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.200 Vali Acc: 0.822 Test Loss: 1.200 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9330272674560547
Epoch: 25, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.068 Vali Acc: 0.839 Test Loss: 1.068 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9071230888366699
Epoch: 26, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.011 Vali Acc: 0.856 Test Loss: 1.011 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.939481258392334
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.110 Vali Acc: 0.839 Test Loss: 1.110 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9017074108123779
Epoch: 28, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.214 Vali Acc: 0.850 Test Loss: 1.214 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.916949987411499
Epoch: 29, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.222 Vali Acc: 0.833 Test Loss: 1.222 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 890127
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9878737926483154
Epoch: 1, Steps: 12 | Train Loss: 2.644 Vali Loss: 2.411 Vali Acc: 0.244 Test Loss: 2.411 Test Acc: 0.244
Validation loss decreased (inf --> -0.244420).  Saving model ...
Epoch: 2 cost time: 0.8689870834350586
Epoch: 2, Steps: 12 | Train Loss: 1.844 Vali Loss: 1.782 Vali Acc: 0.567 Test Loss: 1.782 Test Acc: 0.567
Validation loss decreased (-0.244420 --> -0.566649).  Saving model ...
Epoch: 3 cost time: 0.8555476665496826
Epoch: 3, Steps: 12 | Train Loss: 1.180 Vali Loss: 1.298 Vali Acc: 0.617 Test Loss: 1.298 Test Acc: 0.617
Validation loss decreased (-0.566649 --> -0.616654).  Saving model ...
Epoch: 4 cost time: 0.8309614658355713
Epoch: 4, Steps: 12 | Train Loss: 0.848 Vali Loss: 1.080 Vali Acc: 0.672 Test Loss: 1.080 Test Acc: 0.672
Validation loss decreased (-0.616654 --> -0.672211).  Saving model ...
Epoch: 5 cost time: 0.8374156951904297
Epoch: 5, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.879 Vali Acc: 0.717 Test Loss: 0.879 Test Acc: 0.717
Validation loss decreased (-0.672211 --> -0.716658).  Saving model ...
Epoch: 6 cost time: 0.8508479595184326
Epoch: 6, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.880 Vali Acc: 0.744 Test Loss: 0.880 Test Acc: 0.744
Validation loss decreased (-0.716658 --> -0.744436).  Saving model ...
Epoch: 7 cost time: 0.8791916370391846
Epoch: 7, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.802 Vali Acc: 0.767 Test Loss: 0.802 Test Acc: 0.767
Validation loss decreased (-0.744436 --> -0.766659).  Saving model ...
Epoch: 8 cost time: 0.8500638008117676
Epoch: 8, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.757 Vali Acc: 0.789 Test Loss: 0.757 Test Acc: 0.789
Validation loss decreased (-0.766659 --> -0.788881).  Saving model ...
Epoch: 9 cost time: 0.9211740493774414
Epoch: 9, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.713 Vali Acc: 0.811 Test Loss: 0.713 Test Acc: 0.811
Validation loss decreased (-0.788881 --> -0.811104).  Saving model ...
Epoch: 10 cost time: 0.8962225914001465
Epoch: 10, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.741 Vali Acc: 0.772 Test Loss: 0.741 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8639664649963379
Epoch: 11, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.631 Vali Acc: 0.822 Test Loss: 0.631 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822216).  Saving model ...
Epoch: 12 cost time: 0.8901770114898682
Epoch: 12, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.715 Vali Acc: 0.794 Test Loss: 0.715 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8909580707550049
Epoch: 13, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.677 Vali Acc: 0.828 Test Loss: 0.677 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827771).  Saving model ...
Epoch: 14 cost time: 0.882110595703125
Epoch: 14, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.723 Vali Acc: 0.833 Test Loss: 0.723 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833326).  Saving model ...
Epoch: 15 cost time: 0.8334288597106934
Epoch: 15, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.710 Vali Acc: 0.817 Test Loss: 0.710 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8463428020477295
Epoch: 16, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.757 Vali Acc: 0.839 Test Loss: 0.757 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838881).  Saving model ...
Epoch: 17 cost time: 0.8034474849700928
Epoch: 17, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.869 Vali Acc: 0.789 Test Loss: 0.869 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8558831214904785
Epoch: 18, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.825 Vali Acc: 0.817 Test Loss: 0.825 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8439857959747314
Epoch: 19, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.890 Vali Acc: 0.794 Test Loss: 0.890 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7962429523468018
Epoch: 20, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.769 Vali Acc: 0.811 Test Loss: 0.769 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9088060855865479
Epoch: 21, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.792 Vali Acc: 0.833 Test Loss: 0.792 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9037408828735352
Epoch: 22, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.814 Vali Acc: 0.850 Test Loss: 0.814 Test Acc: 0.850
Validation loss decreased (-0.838881 --> -0.849992).  Saving model ...
Epoch: 23 cost time: 0.9194386005401611
Epoch: 23, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.812 Vali Acc: 0.828 Test Loss: 0.812 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9485540390014648
Epoch: 24, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.777 Vali Acc: 0.844 Test Loss: 0.777 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9320781230926514
Epoch: 25, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.813 Vali Acc: 0.839 Test Loss: 0.813 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8388769626617432
Epoch: 26, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.827 Vali Acc: 0.839 Test Loss: 0.827 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8467733860015869
Epoch: 27, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.848 Vali Acc: 0.861 Test Loss: 0.848 Test Acc: 0.861
Validation loss decreased (-0.849992 --> -0.861103).  Saving model ...
Epoch: 28 cost time: 0.9669678211212158
Epoch: 28, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.843 Vali Acc: 0.844 Test Loss: 0.843 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9682528972625732
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.886 Vali Acc: 0.839 Test Loss: 0.886 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8676509857177734
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.848 Vali Acc: 0.844 Test Loss: 0.848 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8256106376647949
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.836 Vali Acc: 0.844 Test Loss: 0.836 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8466691970825195
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.873 Vali Acc: 0.844 Test Loss: 0.873 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8654041290283203
Epoch: 33, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.851 Vali Acc: 0.850 Test Loss: 0.851 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9137654304504395
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.900 Vali Acc: 0.844 Test Loss: 0.900 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.896289587020874
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.872 Vali Acc: 0.844 Test Loss: 0.872 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9318244457244873
Epoch: 36, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.852 Vali Acc: 0.850 Test Loss: 0.852 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.9516992568969727
Epoch: 37, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.948 Vali Acc: 0.850 Test Loss: 0.948 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 713743
model size : 2.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1190574169158936
Epoch: 1, Steps: 12 | Train Loss: 2.716 Vali Loss: 2.444 Vali Acc: 0.272 Test Loss: 2.444 Test Acc: 0.272
Validation loss decreased (inf --> -0.272198).  Saving model ...
Epoch: 2 cost time: 0.8343713283538818
Epoch: 2, Steps: 12 | Train Loss: 1.848 Vali Loss: 1.783 Vali Acc: 0.533 Test Loss: 1.783 Test Acc: 0.533
Validation loss decreased (-0.272198 --> -0.533316).  Saving model ...
Epoch: 3 cost time: 0.9198884963989258
Epoch: 3, Steps: 12 | Train Loss: 1.212 Vali Loss: 1.320 Vali Acc: 0.639 Test Loss: 1.320 Test Acc: 0.639
Validation loss decreased (-0.533316 --> -0.638876).  Saving model ...
Epoch: 4 cost time: 0.9099829196929932
Epoch: 4, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.063 Vali Acc: 0.689 Test Loss: 1.063 Test Acc: 0.689
Validation loss decreased (-0.638876 --> -0.688878).  Saving model ...
Epoch: 5 cost time: 0.8730213642120361
Epoch: 5, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.872 Vali Acc: 0.717 Test Loss: 0.872 Test Acc: 0.717
Validation loss decreased (-0.688878 --> -0.716658).  Saving model ...
Epoch: 6 cost time: 0.9055097103118896
Epoch: 6, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.801 Vali Acc: 0.767 Test Loss: 0.801 Test Acc: 0.767
Validation loss decreased (-0.716658 --> -0.766659).  Saving model ...
Epoch: 7 cost time: 0.8980121612548828
Epoch: 7, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.746 Vali Acc: 0.789 Test Loss: 0.746 Test Acc: 0.789
Validation loss decreased (-0.766659 --> -0.788881).  Saving model ...
Epoch: 8 cost time: 0.8558094501495361
Epoch: 8, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.663 Vali Acc: 0.789 Test Loss: 0.663 Test Acc: 0.789
Validation loss decreased (-0.788881 --> -0.788882).  Saving model ...
Epoch: 9 cost time: 0.8639087677001953
Epoch: 9, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.607 Vali Acc: 0.822 Test Loss: 0.607 Test Acc: 0.822
Validation loss decreased (-0.788882 --> -0.822216).  Saving model ...
Epoch: 10 cost time: 0.8497393131256104
Epoch: 10, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.632 Vali Acc: 0.822 Test Loss: 0.632 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8722410202026367
Epoch: 11, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.625 Vali Acc: 0.828 Test Loss: 0.625 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 12 cost time: 0.8862175941467285
Epoch: 12, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.588 Vali Acc: 0.839 Test Loss: 0.588 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 13 cost time: 0.8611996173858643
Epoch: 13, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.591 Vali Acc: 0.833 Test Loss: 0.591 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9673810005187988
Epoch: 14, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.620 Vali Acc: 0.839 Test Loss: 0.620 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8984522819519043
Epoch: 15, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.674 Vali Acc: 0.822 Test Loss: 0.674 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9103810787200928
Epoch: 16, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.722 Vali Acc: 0.844 Test Loss: 0.722 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844437).  Saving model ...
Epoch: 17 cost time: 0.866523265838623
Epoch: 17, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.624 Vali Acc: 0.839 Test Loss: 0.624 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.918022871017456
Epoch: 18, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.706 Vali Acc: 0.839 Test Loss: 0.706 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9297287464141846
Epoch: 19, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.714 Vali Acc: 0.856 Test Loss: 0.714 Test Acc: 0.856
Validation loss decreased (-0.844437 --> -0.855548).  Saving model ...
Epoch: 20 cost time: 0.7903921604156494
Epoch: 20, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.721 Vali Acc: 0.844 Test Loss: 0.721 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8607397079467773
Epoch: 21, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.737 Vali Acc: 0.867 Test Loss: 0.737 Test Acc: 0.867
Validation loss decreased (-0.855548 --> -0.866659).  Saving model ...
Epoch: 22 cost time: 0.8263506889343262
Epoch: 22, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.790 Vali Acc: 0.867 Test Loss: 0.790 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8083922863006592
Epoch: 23, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.755 Vali Acc: 0.872 Test Loss: 0.755 Test Acc: 0.872
Validation loss decreased (-0.866659 --> -0.872215).  Saving model ...
Epoch: 24 cost time: 0.8784072399139404
Epoch: 24, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.794 Vali Acc: 0.861 Test Loss: 0.794 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8731837272644043
Epoch: 25, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.793 Vali Acc: 0.872 Test Loss: 0.793 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8555190563201904
Epoch: 26, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.790 Vali Acc: 0.856 Test Loss: 0.790 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.931119441986084
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.773 Vali Acc: 0.861 Test Loss: 0.773 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8812365531921387
Epoch: 28, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.813 Vali Acc: 0.861 Test Loss: 0.813 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8883063793182373
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.783 Vali Acc: 0.867 Test Loss: 0.783 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8742341995239258
Epoch: 30, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.779 Vali Acc: 0.878 Test Loss: 0.779 Test Acc: 0.878
Validation loss decreased (-0.872215 --> -0.877770).  Saving model ...
Epoch: 31 cost time: 0.9418821334838867
Epoch: 31, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.811 Vali Acc: 0.839 Test Loss: 0.811 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9005367755889893
Epoch: 32, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.946 Vali Acc: 0.839 Test Loss: 0.946 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7881536483764648
Epoch: 33, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.755 Vali Acc: 0.867 Test Loss: 0.755 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.791865348815918
Epoch: 34, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.849 Vali Acc: 0.872 Test Loss: 0.849 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8058466911315918
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.797 Vali Acc: 0.883 Test Loss: 0.797 Test Acc: 0.883
Validation loss decreased (-0.877770 --> -0.883325).  Saving model ...
Epoch: 36 cost time: 0.8486309051513672
Epoch: 36, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.832 Vali Acc: 0.872 Test Loss: 0.832 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8810226917266846
Epoch: 37, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.794 Vali Acc: 0.878 Test Loss: 0.794 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8214712142944336
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.840 Vali Acc: 0.872 Test Loss: 0.840 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9285502433776855
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.885 Vali Acc: 0.878 Test Loss: 0.885 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8916847705841064
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.900 Vali Acc: 0.878 Test Loss: 0.900 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9288625717163086
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.901 Vali Acc: 0.872 Test Loss: 0.901 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.0077018737792969
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.918 Vali Acc: 0.867 Test Loss: 0.918 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9247045516967773
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.908 Vali Acc: 0.867 Test Loss: 0.908 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.8558166027069092
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.912 Vali Acc: 0.867 Test Loss: 0.912 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.8588201999664307
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.923 Vali Acc: 0.883 Test Loss: 0.923 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 713999
model size : 2.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4142003059387207
Epoch: 1, Steps: 12 | Train Loss: 2.650 Vali Loss: 2.458 Vali Acc: 0.311 Test Loss: 2.458 Test Acc: 0.311
Validation loss decreased (inf --> -0.311087).  Saving model ...
Epoch: 2 cost time: 0.8896710872650146
Epoch: 2, Steps: 12 | Train Loss: 2.027 Vali Loss: 1.935 Vali Acc: 0.517 Test Loss: 1.935 Test Acc: 0.517
Validation loss decreased (-0.311087 --> -0.516647).  Saving model ...
Epoch: 3 cost time: 0.9021942615509033
Epoch: 3, Steps: 12 | Train Loss: 1.444 Vali Loss: 1.461 Vali Acc: 0.644 Test Loss: 1.461 Test Acc: 0.644
Validation loss decreased (-0.516647 --> -0.644430).  Saving model ...
Epoch: 4 cost time: 0.8922743797302246
Epoch: 4, Steps: 12 | Train Loss: 1.032 Vali Loss: 1.186 Vali Acc: 0.689 Test Loss: 1.186 Test Acc: 0.689
Validation loss decreased (-0.644430 --> -0.688877).  Saving model ...
Epoch: 5 cost time: 0.9139342308044434
Epoch: 5, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.991 Vali Acc: 0.722 Test Loss: 0.991 Test Acc: 0.722
Validation loss decreased (-0.688877 --> -0.722212).  Saving model ...
Epoch: 6 cost time: 0.8476827144622803
Epoch: 6, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.895 Vali Acc: 0.739 Test Loss: 0.895 Test Acc: 0.739
Validation loss decreased (-0.722212 --> -0.738880).  Saving model ...
Epoch: 7 cost time: 0.8560812473297119
Epoch: 7, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.756 Vali Acc: 0.794 Test Loss: 0.756 Test Acc: 0.794
Validation loss decreased (-0.738880 --> -0.794437).  Saving model ...
Epoch: 8 cost time: 0.8938887119293213
Epoch: 8, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.677 Vali Acc: 0.800 Test Loss: 0.677 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 9 cost time: 0.8052916526794434
Epoch: 9, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.654 Vali Acc: 0.806 Test Loss: 0.654 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 10 cost time: 0.7802393436431885
Epoch: 10, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.592 Vali Acc: 0.833 Test Loss: 0.592 Test Acc: 0.833
Validation loss decreased (-0.805549 --> -0.833327).  Saving model ...
Epoch: 11 cost time: 0.8628060817718506
Epoch: 11, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.609 Vali Acc: 0.833 Test Loss: 0.609 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8043620586395264
Epoch: 12, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844439).  Saving model ...
Epoch: 13 cost time: 0.8052237033843994
Epoch: 13, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861106).  Saving model ...
Epoch: 14 cost time: 0.8469476699829102
Epoch: 14, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.567 Vali Acc: 0.856 Test Loss: 0.567 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8577790260314941
Epoch: 15, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.602 Vali Acc: 0.856 Test Loss: 0.602 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9490883350372314
Epoch: 16, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.574 Vali Acc: 0.850 Test Loss: 0.574 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9328739643096924
Epoch: 17, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.603 Vali Acc: 0.856 Test Loss: 0.603 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8888068199157715
Epoch: 18, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.589 Vali Acc: 0.861 Test Loss: 0.589 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8770060539245605
Epoch: 19, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.608 Vali Acc: 0.872 Test Loss: 0.608 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872216).  Saving model ...
Epoch: 20 cost time: 0.8788096904754639
Epoch: 20, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8762009143829346
Epoch: 21, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.618 Vali Acc: 0.850 Test Loss: 0.618 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9045698642730713
Epoch: 22, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.609 Vali Acc: 0.872 Test Loss: 0.609 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8418097496032715
Epoch: 23, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.680 Vali Acc: 0.878 Test Loss: 0.680 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877771).  Saving model ...
Epoch: 24 cost time: 0.8198716640472412
Epoch: 24, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.643 Vali Acc: 0.861 Test Loss: 0.643 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8595175743103027
Epoch: 25, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.728 Vali Acc: 0.872 Test Loss: 0.728 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.846360445022583
Epoch: 26, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.681 Vali Acc: 0.861 Test Loss: 0.681 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.879324197769165
Epoch: 27, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.723 Vali Acc: 0.872 Test Loss: 0.723 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8390598297119141
Epoch: 28, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.694 Vali Acc: 0.872 Test Loss: 0.694 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8727328777313232
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.724 Vali Acc: 0.867 Test Loss: 0.724 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7890563011169434
Epoch: 30, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.720 Vali Acc: 0.872 Test Loss: 0.720 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.957573413848877
Epoch: 31, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.766 Vali Acc: 0.872 Test Loss: 0.766 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8453247547149658
Epoch: 32, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.694 Vali Acc: 0.867 Test Loss: 0.694 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8777189254760742
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.749 Vali Acc: 0.872 Test Loss: 0.749 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 660495
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0743134021759033
Epoch: 1, Steps: 12 | Train Loss: 2.697 Vali Loss: 2.534 Vali Acc: 0.206 Test Loss: 2.534 Test Acc: 0.206
Validation loss decreased (inf --> -0.205530).  Saving model ...
Epoch: 2 cost time: 0.8470606803894043
Epoch: 2, Steps: 12 | Train Loss: 2.192 Vali Loss: 2.047 Vali Acc: 0.483 Test Loss: 2.047 Test Acc: 0.483
Validation loss decreased (-0.205530 --> -0.483313).  Saving model ...
Epoch: 3 cost time: 0.8105912208557129
Epoch: 3, Steps: 12 | Train Loss: 1.620 Vali Loss: 1.564 Vali Acc: 0.617 Test Loss: 1.564 Test Acc: 0.617
Validation loss decreased (-0.483313 --> -0.616651).  Saving model ...
Epoch: 4 cost time: 0.8308889865875244
Epoch: 4, Steps: 12 | Train Loss: 1.175 Vali Loss: 1.261 Vali Acc: 0.661 Test Loss: 1.261 Test Acc: 0.661
Validation loss decreased (-0.616651 --> -0.661099).  Saving model ...
Epoch: 5 cost time: 0.85697340965271
Epoch: 5, Steps: 12 | Train Loss: 0.894 Vali Loss: 1.063 Vali Acc: 0.700 Test Loss: 1.063 Test Acc: 0.700
Validation loss decreased (-0.661099 --> -0.699989).  Saving model ...
Epoch: 6 cost time: 0.864760160446167
Epoch: 6, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.897 Vali Acc: 0.744 Test Loss: 0.897 Test Acc: 0.744
Validation loss decreased (-0.699989 --> -0.744435).  Saving model ...
Epoch: 7 cost time: 0.8508286476135254
Epoch: 7, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.824 Vali Acc: 0.750 Test Loss: 0.824 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749992).  Saving model ...
Epoch: 8 cost time: 0.8329975605010986
Epoch: 8, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.744 Vali Acc: 0.794 Test Loss: 0.744 Test Acc: 0.794
Validation loss decreased (-0.749992 --> -0.794437).  Saving model ...
Epoch: 9 cost time: 0.8233604431152344
Epoch: 9, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.683 Vali Acc: 0.800 Test Loss: 0.683 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 10 cost time: 0.8465404510498047
Epoch: 10, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.639 Vali Acc: 0.817 Test Loss: 0.639 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816660).  Saving model ...
Epoch: 11 cost time: 0.8135066032409668
Epoch: 11, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.590 Vali Acc: 0.833 Test Loss: 0.590 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 12 cost time: 0.889136791229248
Epoch: 12, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.592 Vali Acc: 0.833 Test Loss: 0.592 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8530449867248535
Epoch: 13, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.561 Vali Acc: 0.844 Test Loss: 0.561 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844439).  Saving model ...
Epoch: 14 cost time: 0.8345315456390381
Epoch: 14, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.555 Vali Acc: 0.833 Test Loss: 0.555 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.856353759765625
Epoch: 15, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.550 Vali Acc: 0.839 Test Loss: 0.550 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9167041778564453
Epoch: 16, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.562 Vali Acc: 0.850 Test Loss: 0.562 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 0.8740146160125732
Epoch: 17, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.514 Vali Acc: 0.867 Test Loss: 0.514 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866662).  Saving model ...
Epoch: 18 cost time: 0.8958892822265625
Epoch: 18, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.567 Vali Acc: 0.883 Test Loss: 0.567 Test Acc: 0.883
Validation loss decreased (-0.866662 --> -0.883328).  Saving model ...
Epoch: 19 cost time: 0.8165175914764404
Epoch: 19, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.562 Vali Acc: 0.861 Test Loss: 0.562 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.83675217628479
Epoch: 20, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.538 Vali Acc: 0.861 Test Loss: 0.538 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8579485416412354
Epoch: 21, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.556 Vali Acc: 0.872 Test Loss: 0.556 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9169650077819824
Epoch: 22, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.559 Vali Acc: 0.878 Test Loss: 0.559 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8435430526733398
Epoch: 23, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.569 Vali Acc: 0.867 Test Loss: 0.569 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7900950908660889
Epoch: 24, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.584 Vali Acc: 0.872 Test Loss: 0.584 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9557113647460938
Epoch: 25, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.572 Vali Acc: 0.861 Test Loss: 0.572 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9111464023590088
Epoch: 26, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.583 Vali Acc: 0.867 Test Loss: 0.583 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8828694820404053
Epoch: 27, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.634 Vali Acc: 0.872 Test Loss: 0.634 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8815727233886719
Epoch: 28, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.628 Vali Acc: 0.867 Test Loss: 0.628 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 630287
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.083576202392578
Epoch: 1, Steps: 12 | Train Loss: 2.718 Vali Loss: 2.589 Vali Acc: 0.117 Test Loss: 2.589 Test Acc: 0.117
Validation loss decreased (inf --> -0.116641).  Saving model ...
Epoch: 2 cost time: 0.9002053737640381
Epoch: 2, Steps: 12 | Train Loss: 2.254 Vali Loss: 2.169 Vali Acc: 0.500 Test Loss: 2.169 Test Acc: 0.500
Validation loss decreased (-0.116641 --> -0.499978).  Saving model ...
Epoch: 3 cost time: 0.8667080402374268
Epoch: 3, Steps: 12 | Train Loss: 1.754 Vali Loss: 1.685 Vali Acc: 0.656 Test Loss: 1.685 Test Acc: 0.656
Validation loss decreased (-0.499978 --> -0.655539).  Saving model ...
Epoch: 4 cost time: 0.9193711280822754
Epoch: 4, Steps: 12 | Train Loss: 1.290 Vali Loss: 1.343 Vali Acc: 0.667 Test Loss: 1.343 Test Acc: 0.667
Validation loss decreased (-0.655539 --> -0.666653).  Saving model ...
Epoch: 5 cost time: 0.8879444599151611
Epoch: 5, Steps: 12 | Train Loss: 1.017 Vali Loss: 1.133 Vali Acc: 0.694 Test Loss: 1.133 Test Acc: 0.694
Validation loss decreased (-0.666653 --> -0.694433).  Saving model ...
Epoch: 6 cost time: 0.8211550712585449
Epoch: 6, Steps: 12 | Train Loss: 0.838 Vali Loss: 0.961 Vali Acc: 0.722 Test Loss: 0.961 Test Acc: 0.722
Validation loss decreased (-0.694433 --> -0.722213).  Saving model ...
Epoch: 7 cost time: 0.8544268608093262
Epoch: 7, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.885 Vali Acc: 0.733 Test Loss: 0.885 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 8 cost time: 0.9368228912353516
Epoch: 8, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.800 Vali Acc: 0.750 Test Loss: 0.800 Test Acc: 0.750
Validation loss decreased (-0.733324 --> -0.749992).  Saving model ...
Epoch: 9 cost time: 0.8660273551940918
Epoch: 9, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.726 Vali Acc: 0.794 Test Loss: 0.726 Test Acc: 0.794
Validation loss decreased (-0.749992 --> -0.794437).  Saving model ...
Epoch: 10 cost time: 0.8741638660430908
Epoch: 10, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.681 Vali Acc: 0.794 Test Loss: 0.681 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794438).  Saving model ...
Epoch: 11 cost time: 0.9053869247436523
Epoch: 11, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.633 Vali Acc: 0.811 Test Loss: 0.633 Test Acc: 0.811
Validation loss decreased (-0.794438 --> -0.811105).  Saving model ...
Epoch: 12 cost time: 0.8992671966552734
Epoch: 12, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.606 Vali Acc: 0.828 Test Loss: 0.606 Test Acc: 0.828
Validation loss decreased (-0.811105 --> -0.827772).  Saving model ...
Epoch: 13 cost time: 0.9189484119415283
Epoch: 13, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.556 Vali Acc: 0.839 Test Loss: 0.556 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 14 cost time: 0.895930290222168
Epoch: 14, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 0.8182888031005859
Epoch: 15, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 0.85915207862854
Epoch: 16, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8749263286590576
Epoch: 17, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.558 Vali Acc: 0.850 Test Loss: 0.558 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8180320262908936
Epoch: 18, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.529 Vali Acc: 0.856 Test Loss: 0.529 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 19 cost time: 0.8503098487854004
Epoch: 19, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.514 Vali Acc: 0.872 Test Loss: 0.514 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872217).  Saving model ...
Epoch: 20 cost time: 0.839540958404541
Epoch: 20, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.571 Vali Acc: 0.861 Test Loss: 0.571 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8667199611663818
Epoch: 21, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.577 Vali Acc: 0.856 Test Loss: 0.577 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9341707229614258
Epoch: 22, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.596 Vali Acc: 0.861 Test Loss: 0.596 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9406366348266602
Epoch: 23, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.570 Vali Acc: 0.856 Test Loss: 0.570 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8686597347259521
Epoch: 24, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.578 Vali Acc: 0.872 Test Loss: 0.578 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9161083698272705
Epoch: 25, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.583 Vali Acc: 0.861 Test Loss: 0.583 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8775234222412109
Epoch: 26, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.572 Vali Acc: 0.878 Test Loss: 0.572 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 27 cost time: 0.8862431049346924
Epoch: 27, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.571 Vali Acc: 0.883 Test Loss: 0.571 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 28 cost time: 0.8900241851806641
Epoch: 28, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.614 Vali Acc: 0.883 Test Loss: 0.614 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8519577980041504
Epoch: 29, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.635 Vali Acc: 0.883 Test Loss: 0.635 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8771500587463379
Epoch: 30, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.645 Vali Acc: 0.878 Test Loss: 0.645 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8699030876159668
Epoch: 31, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.651 Vali Acc: 0.856 Test Loss: 0.651 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8807215690612793
Epoch: 32, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.629 Vali Acc: 0.861 Test Loss: 0.629 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9251728057861328
Epoch: 33, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.661 Vali Acc: 0.878 Test Loss: 0.661 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8950717449188232
Epoch: 34, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.664 Vali Acc: 0.872 Test Loss: 0.664 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8602981567382812
Epoch: 35, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.676 Vali Acc: 0.878 Test Loss: 0.676 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8739092350006104
Epoch: 36, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.700 Vali Acc: 0.878 Test Loss: 0.700 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.8462438583374023
Epoch: 37, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.659 Vali Acc: 0.894 Test Loss: 0.659 Test Acc: 0.894
Validation loss decreased (-0.883328 --> -0.894438).  Saving model ...
Epoch: 38 cost time: 0.8314244747161865
Epoch: 38, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.654 Vali Acc: 0.894 Test Loss: 0.654 Test Acc: 0.894
Validation loss decreased (-0.894438 --> -0.894438).  Saving model ...
Epoch: 39 cost time: 0.8681252002716064
Epoch: 39, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.637 Vali Acc: 0.894 Test Loss: 0.637 Test Acc: 0.894
Validation loss decreased (-0.894438 --> -0.894438).  Saving model ...
Epoch: 40 cost time: 0.8411357402801514
Epoch: 40, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.655 Vali Acc: 0.889 Test Loss: 0.655 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9110095500946045
Epoch: 41, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.677 Vali Acc: 0.889 Test Loss: 0.677 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9451127052307129
Epoch: 42, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.686 Vali Acc: 0.889 Test Loss: 0.686 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9509010314941406
Epoch: 43, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.699 Vali Acc: 0.894 Test Loss: 0.699 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8884010314941406
Epoch: 44, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.725 Vali Acc: 0.889 Test Loss: 0.725 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8539013862609863
Epoch: 45, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.761 Vali Acc: 0.889 Test Loss: 0.761 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8639183044433594
Epoch: 46, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.711 Vali Acc: 0.900 Test Loss: 0.711 Test Acc: 0.900
Validation loss decreased (-0.894438 --> -0.899993).  Saving model ...
Epoch: 47 cost time: 0.8464043140411377
Epoch: 47, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.717 Vali Acc: 0.878 Test Loss: 0.717 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8559815883636475
Epoch: 48, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.772 Vali Acc: 0.883 Test Loss: 0.772 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.8760881423950195
Epoch: 49, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.805 Vali Acc: 0.878 Test Loss: 0.805 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.8433411121368408
Epoch: 50, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.717 Vali Acc: 0.883 Test Loss: 0.717 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 615439
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1778388023376465
Epoch: 1, Steps: 12 | Train Loss: 2.776 Vali Loss: 2.585 Vali Acc: 0.150 Test Loss: 2.585 Test Acc: 0.150
Validation loss decreased (inf --> -0.149974).  Saving model ...
Epoch: 2 cost time: 0.808344841003418
Epoch: 2, Steps: 12 | Train Loss: 2.397 Vali Loss: 2.240 Vali Acc: 0.456 Test Loss: 2.240 Test Acc: 0.456
Validation loss decreased (-0.149974 --> -0.455533).  Saving model ...
Epoch: 3 cost time: 0.8923776149749756
Epoch: 3, Steps: 12 | Train Loss: 1.924 Vali Loss: 1.808 Vali Acc: 0.572 Test Loss: 1.808 Test Acc: 0.572
Validation loss decreased (-0.455533 --> -0.572204).  Saving model ...
Epoch: 4 cost time: 0.8625452518463135
Epoch: 4, Steps: 12 | Train Loss: 1.495 Vali Loss: 1.463 Vali Acc: 0.661 Test Loss: 1.463 Test Acc: 0.661
Validation loss decreased (-0.572204 --> -0.661096).  Saving model ...
Epoch: 5 cost time: 0.918142557144165
Epoch: 5, Steps: 12 | Train Loss: 1.157 Vali Loss: 1.221 Vali Acc: 0.717 Test Loss: 1.221 Test Acc: 0.717
Validation loss decreased (-0.661096 --> -0.716654).  Saving model ...
Epoch: 6 cost time: 0.89267897605896
Epoch: 6, Steps: 12 | Train Loss: 0.901 Vali Loss: 1.037 Vali Acc: 0.739 Test Loss: 1.037 Test Acc: 0.739
Validation loss decreased (-0.716654 --> -0.738879).  Saving model ...
Epoch: 7 cost time: 0.8897113800048828
Epoch: 7, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.911 Vali Acc: 0.750 Test Loss: 0.911 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749991).  Saving model ...
Epoch: 8 cost time: 0.8807141780853271
Epoch: 8, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.817 Vali Acc: 0.750 Test Loss: 0.817 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 9 cost time: 0.9009785652160645
Epoch: 9, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.747 Vali Acc: 0.767 Test Loss: 0.747 Test Acc: 0.767
Validation loss decreased (-0.749992 --> -0.766659).  Saving model ...
Epoch: 10 cost time: 0.8410611152648926
Epoch: 10, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.691 Vali Acc: 0.811 Test Loss: 0.691 Test Acc: 0.811
Validation loss decreased (-0.766659 --> -0.811104).  Saving model ...
Epoch: 11 cost time: 0.861853837966919
Epoch: 11, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.662 Vali Acc: 0.794 Test Loss: 0.662 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8379616737365723
Epoch: 12, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.576 Vali Acc: 0.839 Test Loss: 0.576 Test Acc: 0.839
Validation loss decreased (-0.811104 --> -0.838883).  Saving model ...
Epoch: 13 cost time: 0.8344507217407227
Epoch: 13, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.577 Vali Acc: 0.833 Test Loss: 0.577 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8107099533081055
Epoch: 14, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.553 Vali Acc: 0.833 Test Loss: 0.553 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.884385347366333
Epoch: 15, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 16 cost time: 0.8737788200378418
Epoch: 16, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.511 Vali Acc: 0.861 Test Loss: 0.511 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861106).  Saving model ...
Epoch: 17 cost time: 0.8783912658691406
Epoch: 17, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.498 Vali Acc: 0.856 Test Loss: 0.498 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8556625843048096
Epoch: 18, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.497 Vali Acc: 0.867 Test Loss: 0.497 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 19 cost time: 0.8741452693939209
Epoch: 19, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.482 Vali Acc: 0.867 Test Loss: 0.482 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 20 cost time: 0.8511002063751221
Epoch: 20, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.485 Vali Acc: 0.861 Test Loss: 0.485 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8695087432861328
Epoch: 21, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.509 Vali Acc: 0.839 Test Loss: 0.509 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8265748023986816
Epoch: 22, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.491 Vali Acc: 0.867 Test Loss: 0.491 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.850846529006958
Epoch: 23, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.492 Vali Acc: 0.861 Test Loss: 0.492 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.833817720413208
Epoch: 24, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.503 Vali Acc: 0.867 Test Loss: 0.503 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8687028884887695
Epoch: 25, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.474 Vali Acc: 0.878 Test Loss: 0.474 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 26 cost time: 0.9118492603302002
Epoch: 26, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.496 Vali Acc: 0.883 Test Loss: 0.496 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 27 cost time: 0.8679070472717285
Epoch: 27, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.527 Vali Acc: 0.872 Test Loss: 0.527 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8395872116088867
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.516 Vali Acc: 0.861 Test Loss: 0.516 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8305971622467041
Epoch: 29, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.504 Vali Acc: 0.872 Test Loss: 0.504 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8509294986724854
Epoch: 30, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.518 Vali Acc: 0.889 Test Loss: 0.518 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888884).  Saving model ...
Epoch: 31 cost time: 0.8150999546051025
Epoch: 31, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.542 Vali Acc: 0.883 Test Loss: 0.542 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8001437187194824
Epoch: 32, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.553 Vali Acc: 0.889 Test Loss: 0.553 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8563539981842041
Epoch: 33, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.566 Vali Acc: 0.861 Test Loss: 0.566 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8482911586761475
Epoch: 34, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.583 Vali Acc: 0.872 Test Loss: 0.583 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8067197799682617
Epoch: 35, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.603 Vali Acc: 0.867 Test Loss: 0.603 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8851487636566162
Epoch: 36, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.585 Vali Acc: 0.861 Test Loss: 0.585 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8787646293640137
Epoch: 37, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.689 Vali Acc: 0.861 Test Loss: 0.689 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9015982151031494
Epoch: 38, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.630 Vali Acc: 0.878 Test Loss: 0.630 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.866485595703125
Epoch: 39, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.627 Vali Acc: 0.867 Test Loss: 0.627 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8431911468505859
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.608 Vali Acc: 0.883 Test Loss: 0.608 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 600847
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.209275245666504
Epoch: 1, Steps: 12 | Train Loss: 2.680 Vali Loss: 2.412 Vali Acc: 0.317 Test Loss: 2.412 Test Acc: 0.317
Validation loss decreased (inf --> -0.316643).  Saving model ...
Epoch: 2 cost time: 0.8689415454864502
Epoch: 2, Steps: 12 | Train Loss: 1.858 Vali Loss: 1.715 Vali Acc: 0.583 Test Loss: 1.715 Test Acc: 0.583
Validation loss decreased (-0.316643 --> -0.583316).  Saving model ...
Epoch: 3 cost time: 0.8092329502105713
Epoch: 3, Steps: 12 | Train Loss: 1.207 Vali Loss: 1.312 Vali Acc: 0.644 Test Loss: 1.312 Test Acc: 0.644
Validation loss decreased (-0.583316 --> -0.644431).  Saving model ...
Epoch: 4 cost time: 0.8245322704315186
Epoch: 4, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.022 Vali Acc: 0.667 Test Loss: 1.022 Test Acc: 0.667
Validation loss decreased (-0.644431 --> -0.666656).  Saving model ...
Epoch: 5 cost time: 0.772127628326416
Epoch: 5, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.905 Vali Acc: 0.706 Test Loss: 0.905 Test Acc: 0.706
Validation loss decreased (-0.666656 --> -0.705547).  Saving model ...
Epoch: 6 cost time: 0.8190419673919678
Epoch: 6, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.856 Vali Acc: 0.772 Test Loss: 0.856 Test Acc: 0.772
Validation loss decreased (-0.705547 --> -0.772214).  Saving model ...
Epoch: 7 cost time: 0.8405351638793945
Epoch: 7, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.787 Vali Acc: 0.761 Test Loss: 0.787 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8193433284759521
Epoch: 8, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.751 Vali Acc: 0.772 Test Loss: 0.751 Test Acc: 0.772
Validation loss decreased (-0.772214 --> -0.772215).  Saving model ...
Epoch: 9 cost time: 0.8097960948944092
Epoch: 9, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.724 Vali Acc: 0.778 Test Loss: 0.724 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777771).  Saving model ...
Epoch: 10 cost time: 0.7942366600036621
Epoch: 10, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.670 Vali Acc: 0.817 Test Loss: 0.670 Test Acc: 0.817
Validation loss decreased (-0.777771 --> -0.816660).  Saving model ...
Epoch: 11 cost time: 0.871281623840332
Epoch: 11, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.691 Vali Acc: 0.811 Test Loss: 0.691 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8537983894348145
Epoch: 12, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.682 Vali Acc: 0.811 Test Loss: 0.682 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8722403049468994
Epoch: 13, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.703 Vali Acc: 0.800 Test Loss: 0.703 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8548369407653809
Epoch: 14, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.709 Vali Acc: 0.844 Test Loss: 0.709 Test Acc: 0.844
Validation loss decreased (-0.816660 --> -0.844437).  Saving model ...
Epoch: 15 cost time: 0.8732671737670898
Epoch: 15, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.639 Vali Acc: 0.844 Test Loss: 0.639 Test Acc: 0.844
Validation loss decreased (-0.844437 --> -0.844438).  Saving model ...
Epoch: 16 cost time: 0.8551397323608398
Epoch: 16, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.652 Vali Acc: 0.856 Test Loss: 0.652 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 17 cost time: 0.8133044242858887
Epoch: 17, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.670 Vali Acc: 0.856 Test Loss: 0.670 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7886528968811035
Epoch: 18, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.705 Vali Acc: 0.844 Test Loss: 0.705 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7828888893127441
Epoch: 19, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.769 Vali Acc: 0.850 Test Loss: 0.769 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.799532413482666
Epoch: 20, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.738 Vali Acc: 0.839 Test Loss: 0.738 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8137345314025879
Epoch: 21, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.734 Vali Acc: 0.867 Test Loss: 0.734 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866659).  Saving model ...
Epoch: 22 cost time: 0.838350772857666
Epoch: 22, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.752 Vali Acc: 0.839 Test Loss: 0.752 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8405196666717529
Epoch: 23, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.777 Vali Acc: 0.839 Test Loss: 0.777 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8393764495849609
Epoch: 24, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.790 Vali Acc: 0.833 Test Loss: 0.790 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.929600715637207
Epoch: 25, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.765 Vali Acc: 0.844 Test Loss: 0.765 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8300142288208008
Epoch: 26, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.818 Vali Acc: 0.839 Test Loss: 0.818 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.836458683013916
Epoch: 27, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.790 Vali Acc: 0.844 Test Loss: 0.790 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8254013061523438
Epoch: 28, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.771 Vali Acc: 0.839 Test Loss: 0.771 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8288924694061279
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.797 Vali Acc: 0.844 Test Loss: 0.797 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9033651351928711
Epoch: 30, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.814 Vali Acc: 0.844 Test Loss: 0.814 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.816615104675293
Epoch: 31, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.982 Vali Acc: 0.844 Test Loss: 0.982 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 313999
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0202853679656982
Epoch: 1, Steps: 12 | Train Loss: 2.823 Vali Loss: 2.570 Vali Acc: 0.133 Test Loss: 2.570 Test Acc: 0.133
Validation loss decreased (inf --> -0.133308).  Saving model ...
Epoch: 2 cost time: 0.6943788528442383
Epoch: 2, Steps: 12 | Train Loss: 2.277 Vali Loss: 2.107 Vali Acc: 0.461 Test Loss: 2.107 Test Acc: 0.461
Validation loss decreased (-0.133308 --> -0.461090).  Saving model ...
Epoch: 3 cost time: 0.7190513610839844
Epoch: 3, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.646 Vali Acc: 0.611 Test Loss: 1.646 Test Acc: 0.611
Validation loss decreased (-0.461090 --> -0.611095).  Saving model ...
Epoch: 4 cost time: 0.700326681137085
Epoch: 4, Steps: 12 | Train Loss: 1.263 Vali Loss: 1.360 Vali Acc: 0.628 Test Loss: 1.360 Test Acc: 0.628
Validation loss decreased (-0.611095 --> -0.627764).  Saving model ...
Epoch: 5 cost time: 0.7370960712432861
Epoch: 5, Steps: 12 | Train Loss: 0.954 Vali Loss: 1.128 Vali Acc: 0.689 Test Loss: 1.128 Test Acc: 0.689
Validation loss decreased (-0.627764 --> -0.688878).  Saving model ...
Epoch: 6 cost time: 0.7385988235473633
Epoch: 6, Steps: 12 | Train Loss: 0.783 Vali Loss: 0.994 Vali Acc: 0.700 Test Loss: 0.994 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699990).  Saving model ...
Epoch: 7 cost time: 0.7251772880554199
Epoch: 7, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.932 Vali Acc: 0.722 Test Loss: 0.932 Test Acc: 0.722
Validation loss decreased (-0.699990 --> -0.722213).  Saving model ...
Epoch: 8 cost time: 0.7614977359771729
Epoch: 8, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.878 Vali Acc: 0.722 Test Loss: 0.878 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722213).  Saving model ...
Epoch: 9 cost time: 0.7312712669372559
Epoch: 9, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.786 Vali Acc: 0.761 Test Loss: 0.786 Test Acc: 0.761
Validation loss decreased (-0.722213 --> -0.761103).  Saving model ...
Epoch: 10 cost time: 0.7537322044372559
Epoch: 10, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.731 Vali Acc: 0.783 Test Loss: 0.731 Test Acc: 0.783
Validation loss decreased (-0.761103 --> -0.783326).  Saving model ...
Epoch: 11 cost time: 0.7220759391784668
Epoch: 11, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.690 Vali Acc: 0.778 Test Loss: 0.690 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7170534133911133
Epoch: 12, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.706 Vali Acc: 0.811 Test Loss: 0.706 Test Acc: 0.811
Validation loss decreased (-0.783326 --> -0.811104).  Saving model ...
Epoch: 13 cost time: 0.7406418323516846
Epoch: 13, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.684 Vali Acc: 0.806 Test Loss: 0.684 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6800007820129395
Epoch: 14, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.651 Vali Acc: 0.817 Test Loss: 0.651 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 15 cost time: 0.7061605453491211
Epoch: 15, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.625 Vali Acc: 0.856 Test Loss: 0.625 Test Acc: 0.856
Validation loss decreased (-0.816660 --> -0.855549).  Saving model ...
Epoch: 16 cost time: 0.7096006870269775
Epoch: 16, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.637 Vali Acc: 0.828 Test Loss: 0.637 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6853001117706299
Epoch: 17, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.608 Vali Acc: 0.828 Test Loss: 0.608 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.743706464767456
Epoch: 18, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.649 Vali Acc: 0.833 Test Loss: 0.649 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7113940715789795
Epoch: 19, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.625 Vali Acc: 0.833 Test Loss: 0.625 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7500426769256592
Epoch: 20, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.666 Vali Acc: 0.839 Test Loss: 0.666 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6963448524475098
Epoch: 21, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.644 Vali Acc: 0.833 Test Loss: 0.644 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7497696876525879
Epoch: 22, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.651 Vali Acc: 0.839 Test Loss: 0.651 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7017002105712891
Epoch: 23, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.666 Vali Acc: 0.839 Test Loss: 0.666 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7078595161437988
Epoch: 24, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.705 Vali Acc: 0.822 Test Loss: 0.705 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7055771350860596
Epoch: 25, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.719 Vali Acc: 0.839 Test Loss: 0.719 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 225807
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.060364007949829
Epoch: 1, Steps: 12 | Train Loss: 2.676 Vali Loss: 2.524 Vali Acc: 0.161 Test Loss: 2.524 Test Acc: 0.161
Validation loss decreased (inf --> -0.161086).  Saving model ...
Epoch: 2 cost time: 0.8246445655822754
Epoch: 2, Steps: 12 | Train Loss: 2.200 Vali Loss: 2.057 Vali Acc: 0.506 Test Loss: 2.057 Test Acc: 0.506
Validation loss decreased (-0.161086 --> -0.505535).  Saving model ...
Epoch: 3 cost time: 0.8121552467346191
Epoch: 3, Steps: 12 | Train Loss: 1.586 Vali Loss: 1.625 Vali Acc: 0.600 Test Loss: 1.625 Test Acc: 0.600
Validation loss decreased (-0.505535 --> -0.599984).  Saving model ...
Epoch: 4 cost time: 0.7864153385162354
Epoch: 4, Steps: 12 | Train Loss: 1.189 Vali Loss: 1.331 Vali Acc: 0.667 Test Loss: 1.331 Test Acc: 0.667
Validation loss decreased (-0.599984 --> -0.666653).  Saving model ...
Epoch: 5 cost time: 0.7939465045928955
Epoch: 5, Steps: 12 | Train Loss: 0.938 Vali Loss: 1.143 Vali Acc: 0.667 Test Loss: 1.143 Test Acc: 0.667
Validation loss decreased (-0.666653 --> -0.666655).  Saving model ...
Epoch: 6 cost time: 0.7481276988983154
Epoch: 6, Steps: 12 | Train Loss: 0.837 Vali Loss: 1.058 Vali Acc: 0.689 Test Loss: 1.058 Test Acc: 0.689
Validation loss decreased (-0.666655 --> -0.688878).  Saving model ...
Epoch: 7 cost time: 0.759197473526001
Epoch: 7, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.904 Vali Acc: 0.722 Test Loss: 0.904 Test Acc: 0.722
Validation loss decreased (-0.688878 --> -0.722213).  Saving model ...
Epoch: 8 cost time: 0.7762870788574219
Epoch: 8, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.863 Vali Acc: 0.739 Test Loss: 0.863 Test Acc: 0.739
Validation loss decreased (-0.722213 --> -0.738880).  Saving model ...
Epoch: 9 cost time: 0.8351442813873291
Epoch: 9, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.809 Vali Acc: 0.761 Test Loss: 0.809 Test Acc: 0.761
Validation loss decreased (-0.738880 --> -0.761103).  Saving model ...
Epoch: 10 cost time: 0.8238005638122559
Epoch: 10, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.760 Vali Acc: 0.783 Test Loss: 0.760 Test Acc: 0.783
Validation loss decreased (-0.761103 --> -0.783326).  Saving model ...
Epoch: 11 cost time: 0.8667936325073242
Epoch: 11, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.694 Vali Acc: 0.794 Test Loss: 0.694 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794438).  Saving model ...
Epoch: 12 cost time: 0.8469176292419434
Epoch: 12, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.652 Vali Acc: 0.811 Test Loss: 0.652 Test Acc: 0.811
Validation loss decreased (-0.794438 --> -0.811105).  Saving model ...
Epoch: 13 cost time: 0.7787785530090332
Epoch: 13, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.592 Vali Acc: 0.828 Test Loss: 0.592 Test Acc: 0.828
Validation loss decreased (-0.811105 --> -0.827772).  Saving model ...
Epoch: 14 cost time: 0.7517998218536377
Epoch: 14, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.605 Vali Acc: 0.817 Test Loss: 0.605 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8181018829345703
Epoch: 15, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.589 Vali Acc: 0.861 Test Loss: 0.589 Test Acc: 0.861
Validation loss decreased (-0.827772 --> -0.861105).  Saving model ...
Epoch: 16 cost time: 0.8050096035003662
Epoch: 16, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.594 Vali Acc: 0.833 Test Loss: 0.594 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7779092788696289
Epoch: 17, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.584 Vali Acc: 0.828 Test Loss: 0.584 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8026249408721924
Epoch: 18, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.559 Vali Acc: 0.844 Test Loss: 0.559 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7798280715942383
Epoch: 19, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.554 Vali Acc: 0.861 Test Loss: 0.554 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 20 cost time: 0.7869837284088135
Epoch: 20, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.591 Vali Acc: 0.844 Test Loss: 0.591 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8200135231018066
Epoch: 21, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.620 Vali Acc: 0.856 Test Loss: 0.620 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8384854793548584
Epoch: 22, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.595 Vali Acc: 0.833 Test Loss: 0.595 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7867703437805176
Epoch: 23, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.601 Vali Acc: 0.839 Test Loss: 0.601 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8068232536315918
Epoch: 24, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.623 Vali Acc: 0.861 Test Loss: 0.623 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7718677520751953
Epoch: 25, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.653 Vali Acc: 0.867 Test Loss: 0.653 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866660).  Saving model ...
Epoch: 26 cost time: 0.7957196235656738
Epoch: 26, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.652 Vali Acc: 0.833 Test Loss: 0.652 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7931733131408691
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.650 Vali Acc: 0.850 Test Loss: 0.650 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8056070804595947
Epoch: 28, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.637 Vali Acc: 0.867 Test Loss: 0.637 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866660).  Saving model ...
Epoch: 29 cost time: 0.8034307956695557
Epoch: 29, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.640 Vali Acc: 0.844 Test Loss: 0.640 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7838046550750732
Epoch: 30, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.678 Vali Acc: 0.856 Test Loss: 0.678 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.866051197052002
Epoch: 31, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.673 Vali Acc: 0.867 Test Loss: 0.673 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8143584728240967
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.693 Vali Acc: 0.872 Test Loss: 0.693 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872215).  Saving model ...
Epoch: 33 cost time: 0.8331725597381592
Epoch: 33, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.680 Vali Acc: 0.861 Test Loss: 0.680 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8690831661224365
Epoch: 34, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.679 Vali Acc: 0.850 Test Loss: 0.679 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8183515071868896
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.702 Vali Acc: 0.861 Test Loss: 0.702 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7907564640045166
Epoch: 36, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.729 Vali Acc: 0.856 Test Loss: 0.729 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8303074836730957
Epoch: 37, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.766 Vali Acc: 0.850 Test Loss: 0.766 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7872169017791748
Epoch: 38, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.714 Vali Acc: 0.867 Test Loss: 0.714 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8544762134552002
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.715 Vali Acc: 0.856 Test Loss: 0.715 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.7710287570953369
Epoch: 40, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.745 Vali Acc: 0.872 Test Loss: 0.745 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.8104758262634277
Epoch: 41, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.773 Vali Acc: 0.867 Test Loss: 0.773 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.8555407524108887
Epoch: 42, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.734 Vali Acc: 0.861 Test Loss: 0.734 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 225935
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0555381774902344
Epoch: 1, Steps: 12 | Train Loss: 2.737 Vali Loss: 2.637 Vali Acc: 0.122 Test Loss: 2.637 Test Acc: 0.122
Validation loss decreased (inf --> -0.122196).  Saving model ...
Epoch: 2 cost time: 0.8174953460693359
Epoch: 2, Steps: 12 | Train Loss: 2.407 Vali Loss: 2.287 Vali Acc: 0.317 Test Loss: 2.287 Test Acc: 0.317
Validation loss decreased (-0.122196 --> -0.316644).  Saving model ...
Epoch: 3 cost time: 0.7582418918609619
Epoch: 3, Steps: 12 | Train Loss: 1.919 Vali Loss: 1.877 Vali Acc: 0.561 Test Loss: 1.877 Test Acc: 0.561
Validation loss decreased (-0.316644 --> -0.561092).  Saving model ...
Epoch: 4 cost time: 0.808901309967041
Epoch: 4, Steps: 12 | Train Loss: 1.481 Vali Loss: 1.520 Vali Acc: 0.678 Test Loss: 1.520 Test Acc: 0.678
Validation loss decreased (-0.561092 --> -0.677763).  Saving model ...
Epoch: 5 cost time: 0.7746739387512207
Epoch: 5, Steps: 12 | Train Loss: 1.176 Vali Loss: 1.295 Vali Acc: 0.678 Test Loss: 1.295 Test Acc: 0.678
Validation loss decreased (-0.677763 --> -0.677765).  Saving model ...
Epoch: 6 cost time: 0.7730443477630615
Epoch: 6, Steps: 12 | Train Loss: 0.945 Vali Loss: 1.133 Vali Acc: 0.683 Test Loss: 1.133 Test Acc: 0.683
Validation loss decreased (-0.677765 --> -0.683322).  Saving model ...
Epoch: 7 cost time: 0.7990450859069824
Epoch: 7, Steps: 12 | Train Loss: 0.823 Vali Loss: 1.052 Vali Acc: 0.700 Test Loss: 1.052 Test Acc: 0.700
Validation loss decreased (-0.683322 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 0.7581305503845215
Epoch: 8, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.941 Vali Acc: 0.744 Test Loss: 0.941 Test Acc: 0.744
Validation loss decreased (-0.699989 --> -0.744435).  Saving model ...
Epoch: 9 cost time: 0.7717821598052979
Epoch: 9, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.859 Vali Acc: 0.739 Test Loss: 0.859 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6849033832550049
Epoch: 10, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.799 Vali Acc: 0.789 Test Loss: 0.799 Test Acc: 0.789
Validation loss decreased (-0.744435 --> -0.788881).  Saving model ...
Epoch: 11 cost time: 0.7247850894927979
Epoch: 11, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.740 Vali Acc: 0.767 Test Loss: 0.740 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7630515098571777
Epoch: 12, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.694 Vali Acc: 0.783 Test Loss: 0.694 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8350801467895508
Epoch: 13, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.695 Vali Acc: 0.789 Test Loss: 0.695 Test Acc: 0.789
Validation loss decreased (-0.788881 --> -0.788882).  Saving model ...
Epoch: 14 cost time: 0.8152220249176025
Epoch: 14, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.622 Vali Acc: 0.839 Test Loss: 0.622 Test Acc: 0.839
Validation loss decreased (-0.788882 --> -0.838883).  Saving model ...
Epoch: 15 cost time: 0.7682595252990723
Epoch: 15, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.593 Vali Acc: 0.856 Test Loss: 0.593 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 16 cost time: 0.80633544921875
Epoch: 16, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.782785177230835
Epoch: 17, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.577 Vali Acc: 0.839 Test Loss: 0.577 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8328893184661865
Epoch: 18, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.563 Vali Acc: 0.844 Test Loss: 0.563 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7998538017272949
Epoch: 19, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.543 Vali Acc: 0.856 Test Loss: 0.543 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 20 cost time: 0.7692742347717285
Epoch: 20, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.549 Vali Acc: 0.861 Test Loss: 0.549 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 21 cost time: 0.7295613288879395
Epoch: 21, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.558 Vali Acc: 0.850 Test Loss: 0.558 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7827556133270264
Epoch: 22, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.561 Vali Acc: 0.856 Test Loss: 0.561 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7764301300048828
Epoch: 23, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.758366584777832
Epoch: 24, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.602 Vali Acc: 0.850 Test Loss: 0.602 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7698006629943848
Epoch: 25, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.604 Vali Acc: 0.844 Test Loss: 0.604 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7404294013977051
Epoch: 26, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.623 Vali Acc: 0.839 Test Loss: 0.623 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7842593193054199
Epoch: 27, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.577 Vali Acc: 0.867 Test Loss: 0.577 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 28 cost time: 0.838446855545044
Epoch: 28, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8180027008056641
Epoch: 29, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.610 Vali Acc: 0.861 Test Loss: 0.610 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7669730186462402
Epoch: 30, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.643 Vali Acc: 0.861 Test Loss: 0.643 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8534066677093506
Epoch: 31, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.642 Vali Acc: 0.872 Test Loss: 0.642 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 32 cost time: 0.8027763366699219
Epoch: 32, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.644 Vali Acc: 0.856 Test Loss: 0.644 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8304543495178223
Epoch: 33, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.658 Vali Acc: 0.867 Test Loss: 0.658 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7966632843017578
Epoch: 34, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.664 Vali Acc: 0.867 Test Loss: 0.664 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8509202003479004
Epoch: 35, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.676 Vali Acc: 0.861 Test Loss: 0.676 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7485976219177246
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.703 Vali Acc: 0.867 Test Loss: 0.703 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8069396018981934
Epoch: 37, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.678 Vali Acc: 0.867 Test Loss: 0.678 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.8240809440612793
Epoch: 38, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.674 Vali Acc: 0.861 Test Loss: 0.674 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7947289943695068
Epoch: 39, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.799 Vali Acc: 0.850 Test Loss: 0.799 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.8000595569610596
Epoch: 40, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.765 Vali Acc: 0.856 Test Loss: 0.765 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.833397388458252
Epoch: 41, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.774 Vali Acc: 0.833 Test Loss: 0.774 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 199183
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0155868530273438
Epoch: 1, Steps: 12 | Train Loss: 2.757 Vali Loss: 2.626 Vali Acc: 0.111 Test Loss: 2.626 Test Acc: 0.111
Validation loss decreased (inf --> -0.111085).  Saving model ...
Epoch: 2 cost time: 0.8062386512756348
Epoch: 2, Steps: 12 | Train Loss: 2.484 Vali Loss: 2.370 Vali Acc: 0.350 Test Loss: 2.370 Test Acc: 0.350
Validation loss decreased (-0.111085 --> -0.349976).  Saving model ...
Epoch: 3 cost time: 0.7606968879699707
Epoch: 3, Steps: 12 | Train Loss: 2.105 Vali Loss: 2.015 Vali Acc: 0.489 Test Loss: 2.015 Test Acc: 0.489
Validation loss decreased (-0.349976 --> -0.488869).  Saving model ...
Epoch: 4 cost time: 0.8205676078796387
Epoch: 4, Steps: 12 | Train Loss: 1.731 Vali Loss: 1.693 Vali Acc: 0.567 Test Loss: 1.693 Test Acc: 0.567
Validation loss decreased (-0.488869 --> -0.566650).  Saving model ...
Epoch: 5 cost time: 0.8206503391265869
Epoch: 5, Steps: 12 | Train Loss: 1.402 Vali Loss: 1.451 Vali Acc: 0.606 Test Loss: 1.451 Test Acc: 0.606
Validation loss decreased (-0.566650 --> -0.605541).  Saving model ...
Epoch: 6 cost time: 0.7834534645080566
Epoch: 6, Steps: 12 | Train Loss: 1.166 Vali Loss: 1.251 Vali Acc: 0.650 Test Loss: 1.251 Test Acc: 0.650
Validation loss decreased (-0.605541 --> -0.649987).  Saving model ...
Epoch: 7 cost time: 0.7751939296722412
Epoch: 7, Steps: 12 | Train Loss: 0.928 Vali Loss: 1.109 Vali Acc: 0.661 Test Loss: 1.109 Test Acc: 0.661
Validation loss decreased (-0.649987 --> -0.661100).  Saving model ...
Epoch: 8 cost time: 0.7692925930023193
Epoch: 8, Steps: 12 | Train Loss: 0.804 Vali Loss: 1.007 Vali Acc: 0.694 Test Loss: 1.007 Test Acc: 0.694
Validation loss decreased (-0.661100 --> -0.694434).  Saving model ...
Epoch: 9 cost time: 0.7218735218048096
Epoch: 9, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.927 Vali Acc: 0.744 Test Loss: 0.927 Test Acc: 0.744
Validation loss decreased (-0.694434 --> -0.744435).  Saving model ...
Epoch: 10 cost time: 0.8231511116027832
Epoch: 10, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.860 Vali Acc: 0.767 Test Loss: 0.860 Test Acc: 0.767
Validation loss decreased (-0.744435 --> -0.766658).  Saving model ...
Epoch: 11 cost time: 0.7790250778198242
Epoch: 11, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.783 Vali Acc: 0.750 Test Loss: 0.783 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7510461807250977
Epoch: 12, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.745 Vali Acc: 0.778 Test Loss: 0.745 Test Acc: 0.778
Validation loss decreased (-0.766658 --> -0.777770).  Saving model ...
Epoch: 13 cost time: 0.7690951824188232
Epoch: 13, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.682 Vali Acc: 0.811 Test Loss: 0.682 Test Acc: 0.811
Validation loss decreased (-0.777770 --> -0.811104).  Saving model ...
Epoch: 14 cost time: 0.7594554424285889
Epoch: 14, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.662 Vali Acc: 0.822 Test Loss: 0.662 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822216).  Saving model ...
Epoch: 15 cost time: 0.7511420249938965
Epoch: 15, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.609 Vali Acc: 0.828 Test Loss: 0.609 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 16 cost time: 0.6878788471221924
Epoch: 16, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.586 Vali Acc: 0.828 Test Loss: 0.586 Test Acc: 0.828
Validation loss decreased (-0.827772 --> -0.827772).  Saving model ...
Epoch: 17 cost time: 0.7246322631835938
Epoch: 17, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.570 Vali Acc: 0.856 Test Loss: 0.570 Test Acc: 0.856
Validation loss decreased (-0.827772 --> -0.855550).  Saving model ...
Epoch: 18 cost time: 0.714292049407959
Epoch: 18, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6633124351501465
Epoch: 19, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.547 Vali Acc: 0.839 Test Loss: 0.547 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8382213115692139
Epoch: 20, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.534 Vali Acc: 0.861 Test Loss: 0.534 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 21 cost time: 0.7453088760375977
Epoch: 21, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8141555786132812
Epoch: 22, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.539 Vali Acc: 0.872 Test Loss: 0.539 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 23 cost time: 0.8096137046813965
Epoch: 23, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.536 Vali Acc: 0.861 Test Loss: 0.536 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.747016191482544
Epoch: 24, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7841665744781494
Epoch: 25, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.532 Vali Acc: 0.867 Test Loss: 0.532 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7324562072753906
Epoch: 26, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7225642204284668
Epoch: 27, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.531 Vali Acc: 0.867 Test Loss: 0.531 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6802678108215332
Epoch: 28, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.546 Vali Acc: 0.856 Test Loss: 0.546 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.797386884689331
Epoch: 29, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.534 Vali Acc: 0.861 Test Loss: 0.534 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7419464588165283
Epoch: 30, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.526 Vali Acc: 0.856 Test Loss: 0.526 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7554163932800293
Epoch: 31, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.560 Vali Acc: 0.867 Test Loss: 0.560 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7440364360809326
Epoch: 32, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.580 Vali Acc: 0.867 Test Loss: 0.580 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 184079
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9374020099639893
Epoch: 1, Steps: 12 | Train Loss: 2.789 Vali Loss: 2.672 Vali Acc: 0.150 Test Loss: 2.672 Test Acc: 0.150
Validation loss decreased (inf --> -0.149973).  Saving model ...
Epoch: 2 cost time: 0.7225847244262695
Epoch: 2, Steps: 12 | Train Loss: 2.553 Vali Loss: 2.431 Vali Acc: 0.344 Test Loss: 2.431 Test Acc: 0.344
Validation loss decreased (-0.149973 --> -0.344420).  Saving model ...
Epoch: 3 cost time: 0.7402315139770508
Epoch: 3, Steps: 12 | Train Loss: 2.199 Vali Loss: 2.103 Vali Acc: 0.500 Test Loss: 2.103 Test Acc: 0.500
Validation loss decreased (-0.344420 --> -0.499979).  Saving model ...
Epoch: 4 cost time: 0.7380599975585938
Epoch: 4, Steps: 12 | Train Loss: 1.828 Vali Loss: 1.775 Vali Acc: 0.617 Test Loss: 1.775 Test Acc: 0.617
Validation loss decreased (-0.499979 --> -0.616649).  Saving model ...
Epoch: 5 cost time: 0.7692992687225342
Epoch: 5, Steps: 12 | Train Loss: 1.532 Vali Loss: 1.513 Vali Acc: 0.689 Test Loss: 1.513 Test Acc: 0.689
Validation loss decreased (-0.616649 --> -0.688874).  Saving model ...
Epoch: 6 cost time: 0.7375319004058838
Epoch: 6, Steps: 12 | Train Loss: 1.303 Vali Loss: 1.315 Vali Acc: 0.706 Test Loss: 1.315 Test Acc: 0.706
Validation loss decreased (-0.688874 --> -0.705542).  Saving model ...
Epoch: 7 cost time: 0.7339630126953125
Epoch: 7, Steps: 12 | Train Loss: 1.040 Vali Loss: 1.168 Vali Acc: 0.717 Test Loss: 1.168 Test Acc: 0.717
Validation loss decreased (-0.705542 --> -0.716655).  Saving model ...
Epoch: 8 cost time: 0.8205442428588867
Epoch: 8, Steps: 12 | Train Loss: 0.878 Vali Loss: 1.076 Vali Acc: 0.728 Test Loss: 1.076 Test Acc: 0.728
Validation loss decreased (-0.716655 --> -0.727767).  Saving model ...
Epoch: 9 cost time: 0.7721633911132812
Epoch: 9, Steps: 12 | Train Loss: 0.805 Vali Loss: 0.979 Vali Acc: 0.772 Test Loss: 0.979 Test Acc: 0.772
Validation loss decreased (-0.727767 --> -0.772212).  Saving model ...
Epoch: 10 cost time: 0.7610163688659668
Epoch: 10, Steps: 12 | Train Loss: 0.673 Vali Loss: 0.909 Vali Acc: 0.778 Test Loss: 0.909 Test Acc: 0.778
Validation loss decreased (-0.772212 --> -0.777769).  Saving model ...
Epoch: 11 cost time: 0.7254424095153809
Epoch: 11, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.821 Vali Acc: 0.783 Test Loss: 0.821 Test Acc: 0.783
Validation loss decreased (-0.777769 --> -0.783325).  Saving model ...
Epoch: 12 cost time: 0.6854534149169922
Epoch: 12, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.791 Vali Acc: 0.800 Test Loss: 0.791 Test Acc: 0.800
Validation loss decreased (-0.783325 --> -0.799992).  Saving model ...
Epoch: 13 cost time: 0.7513751983642578
Epoch: 13, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.722 Vali Acc: 0.783 Test Loss: 0.722 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.744464635848999
Epoch: 14, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.708 Vali Acc: 0.806 Test Loss: 0.708 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805548).  Saving model ...
Epoch: 15 cost time: 0.7210626602172852
Epoch: 15, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.654 Vali Acc: 0.822 Test Loss: 0.654 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822216).  Saving model ...
Epoch: 16 cost time: 0.7626564502716064
Epoch: 16, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
Validation loss decreased (-0.822216 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 0.835334300994873
Epoch: 17, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.578 Vali Acc: 0.844 Test Loss: 0.578 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7599711418151855
Epoch: 18, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.550 Vali Acc: 0.844 Test Loss: 0.550 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7415199279785156
Epoch: 19, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 0.7302067279815674
Epoch: 20, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 21 cost time: 0.7439053058624268
Epoch: 21, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.527 Vali Acc: 0.861 Test Loss: 0.527 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861106).  Saving model ...
Epoch: 22 cost time: 0.7632541656494141
Epoch: 22, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.517 Vali Acc: 0.861 Test Loss: 0.517 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 23 cost time: 0.6970558166503906
Epoch: 23, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.519 Vali Acc: 0.867 Test Loss: 0.519 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 24 cost time: 0.7198078632354736
Epoch: 24, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.511 Vali Acc: 0.867 Test Loss: 0.511 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 25 cost time: 0.7125282287597656
Epoch: 25, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.506 Vali Acc: 0.872 Test Loss: 0.506 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 26 cost time: 0.747689962387085
Epoch: 26, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.484 Vali Acc: 0.878 Test Loss: 0.484 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 27 cost time: 0.7399084568023682
Epoch: 27, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.539 Vali Acc: 0.867 Test Loss: 0.539 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.72005295753479
Epoch: 28, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.509 Vali Acc: 0.872 Test Loss: 0.509 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7418656349182129
Epoch: 29, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.491 Vali Acc: 0.883 Test Loss: 0.491 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 30 cost time: 0.7470459938049316
Epoch: 30, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.498 Vali Acc: 0.878 Test Loss: 0.498 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7078957557678223
Epoch: 31, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.506 Vali Acc: 0.867 Test Loss: 0.506 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7489132881164551
Epoch: 32, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.528 Vali Acc: 0.856 Test Loss: 0.528 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7451329231262207
Epoch: 33, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.597 Vali Acc: 0.844 Test Loss: 0.597 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7451188564300537
Epoch: 34, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.535 Vali Acc: 0.872 Test Loss: 0.535 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7327799797058105
Epoch: 35, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.522 Vali Acc: 0.878 Test Loss: 0.522 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7426505088806152
Epoch: 36, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.558 Vali Acc: 0.856 Test Loss: 0.558 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7400078773498535
Epoch: 37, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.584 Vali Acc: 0.856 Test Loss: 0.584 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7958774566650391
Epoch: 38, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.564 Vali Acc: 0.883 Test Loss: 0.564 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7775905132293701
Epoch: 39, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.534 Vali Acc: 0.889 Test Loss: 0.534 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888884).  Saving model ...
Epoch: 40 cost time: 0.7451934814453125
Epoch: 40, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.546 Vali Acc: 0.889 Test Loss: 0.546 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6977910995483398
Epoch: 41, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.592 Vali Acc: 0.872 Test Loss: 0.592 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7322201728820801
Epoch: 42, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.573 Vali Acc: 0.872 Test Loss: 0.573 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7605507373809814
Epoch: 43, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.580 Vali Acc: 0.872 Test Loss: 0.580 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7284717559814453
Epoch: 44, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.596 Vali Acc: 0.878 Test Loss: 0.596 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.6963555812835693
Epoch: 45, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.587 Vali Acc: 0.883 Test Loss: 0.587 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7222895622253418
Epoch: 46, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.591 Vali Acc: 0.889 Test Loss: 0.591 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.6794459819793701
Epoch: 47, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.595 Vali Acc: 0.894 Test Loss: 0.595 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894438).  Saving model ...
Epoch: 48 cost time: 0.7720499038696289
Epoch: 48, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.611 Vali Acc: 0.872 Test Loss: 0.611 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7438786029815674
Epoch: 49, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.614 Vali Acc: 0.867 Test Loss: 0.614 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7686171531677246
Epoch: 50, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.641 Vali Acc: 0.883 Test Loss: 0.641 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 176655
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0551040172576904
Epoch: 1, Steps: 12 | Train Loss: 2.716 Vali Loss: 2.664 Vali Acc: 0.139 Test Loss: 2.664 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 0.9029278755187988
Epoch: 2, Steps: 12 | Train Loss: 2.529 Vali Loss: 2.468 Vali Acc: 0.228 Test Loss: 2.468 Test Acc: 0.228
Validation loss decreased (-0.138862 --> -0.227753).  Saving model ...
Epoch: 3 cost time: 0.7805464267730713
Epoch: 3, Steps: 12 | Train Loss: 2.252 Vali Loss: 2.173 Vali Acc: 0.472 Test Loss: 2.173 Test Acc: 0.472
Validation loss decreased (-0.227753 --> -0.472200).  Saving model ...
Epoch: 4 cost time: 0.76741623878479
Epoch: 4, Steps: 12 | Train Loss: 1.920 Vali Loss: 1.876 Vali Acc: 0.561 Test Loss: 1.876 Test Acc: 0.561
Validation loss decreased (-0.472200 --> -0.561092).  Saving model ...
Epoch: 5 cost time: 0.800386905670166
Epoch: 5, Steps: 12 | Train Loss: 1.624 Vali Loss: 1.635 Vali Acc: 0.611 Test Loss: 1.635 Test Acc: 0.611
Validation loss decreased (-0.561092 --> -0.611095).  Saving model ...
Epoch: 6 cost time: 0.7633266448974609
Epoch: 6, Steps: 12 | Train Loss: 1.397 Vali Loss: 1.459 Vali Acc: 0.667 Test Loss: 1.459 Test Acc: 0.667
Validation loss decreased (-0.611095 --> -0.666652).  Saving model ...
Epoch: 7 cost time: 0.8303432464599609
Epoch: 7, Steps: 12 | Train Loss: 1.193 Vali Loss: 1.305 Vali Acc: 0.678 Test Loss: 1.305 Test Acc: 0.678
Validation loss decreased (-0.666652 --> -0.677765).  Saving model ...
Epoch: 8 cost time: 0.7728750705718994
Epoch: 8, Steps: 12 | Train Loss: 1.001 Vali Loss: 1.154 Vali Acc: 0.706 Test Loss: 1.154 Test Acc: 0.706
Validation loss decreased (-0.677765 --> -0.705544).  Saving model ...
Epoch: 9 cost time: 0.7589950561523438
Epoch: 9, Steps: 12 | Train Loss: 0.882 Vali Loss: 1.042 Vali Acc: 0.722 Test Loss: 1.042 Test Acc: 0.722
Validation loss decreased (-0.705544 --> -0.722212).  Saving model ...
Epoch: 10 cost time: 0.7644541263580322
Epoch: 10, Steps: 12 | Train Loss: 0.804 Vali Loss: 0.977 Vali Acc: 0.750 Test Loss: 0.977 Test Acc: 0.750
Validation loss decreased (-0.722212 --> -0.749990).  Saving model ...
Epoch: 11 cost time: 0.7557647228240967
Epoch: 11, Steps: 12 | Train Loss: 0.734 Vali Loss: 0.893 Vali Acc: 0.767 Test Loss: 0.893 Test Acc: 0.767
Validation loss decreased (-0.749990 --> -0.766658).  Saving model ...
Epoch: 12 cost time: 0.7696835994720459
Epoch: 12, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.825 Vali Acc: 0.767 Test Loss: 0.825 Test Acc: 0.767
Validation loss decreased (-0.766658 --> -0.766658).  Saving model ...
Epoch: 13 cost time: 0.7751891613006592
Epoch: 13, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.780 Vali Acc: 0.767 Test Loss: 0.780 Test Acc: 0.767
Validation loss decreased (-0.766658 --> -0.766659).  Saving model ...
Epoch: 14 cost time: 0.7836630344390869
Epoch: 14, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.739 Vali Acc: 0.800 Test Loss: 0.739 Test Acc: 0.800
Validation loss decreased (-0.766659 --> -0.799993).  Saving model ...
Epoch: 15 cost time: 0.8116271495819092
Epoch: 15, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.675 Vali Acc: 0.828 Test Loss: 0.675 Test Acc: 0.828
Validation loss decreased (-0.799993 --> -0.827771).  Saving model ...
Epoch: 16 cost time: 0.7743697166442871
Epoch: 16, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.645 Vali Acc: 0.833 Test Loss: 0.645 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 17 cost time: 0.7628822326660156
Epoch: 17, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.610 Vali Acc: 0.833 Test Loss: 0.610 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 18 cost time: 0.743218183517456
Epoch: 18, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.589 Vali Acc: 0.833 Test Loss: 0.589 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 19 cost time: 0.786705493927002
Epoch: 19, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.573 Vali Acc: 0.817 Test Loss: 0.573 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7449948787689209
Epoch: 20, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844439).  Saving model ...
Epoch: 21 cost time: 0.7264997959136963
Epoch: 21, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.522 Vali Acc: 0.856 Test Loss: 0.522 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 22 cost time: 0.7746849060058594
Epoch: 22, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7052483558654785
Epoch: 23, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.500 Vali Acc: 0.839 Test Loss: 0.500 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7162771224975586
Epoch: 24, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855551).  Saving model ...
Epoch: 25 cost time: 0.8676128387451172
Epoch: 25, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7689976692199707
Epoch: 26, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.495 Vali Acc: 0.839 Test Loss: 0.495 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7822270393371582
Epoch: 27, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.485 Vali Acc: 0.850 Test Loss: 0.485 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.785621166229248
Epoch: 28, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.443 Vali Acc: 0.856 Test Loss: 0.443 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 29 cost time: 0.8078837394714355
Epoch: 29, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.455 Vali Acc: 0.861 Test Loss: 0.455 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861107).  Saving model ...
Epoch: 30 cost time: 0.757314920425415
Epoch: 30, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.468 Vali Acc: 0.856 Test Loss: 0.468 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7869625091552734
Epoch: 31, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7667317390441895
Epoch: 32, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.506 Vali Acc: 0.861 Test Loss: 0.506 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7425146102905273
Epoch: 33, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.475 Vali Acc: 0.844 Test Loss: 0.475 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7343361377716064
Epoch: 34, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.471 Vali Acc: 0.867 Test Loss: 0.471 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866662).  Saving model ...
Epoch: 35 cost time: 0.7539048194885254
Epoch: 35, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.481 Vali Acc: 0.861 Test Loss: 0.481 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8460502624511719
Epoch: 36, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.483 Vali Acc: 0.878 Test Loss: 0.483 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 37 cost time: 0.7753970623016357
Epoch: 37, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.483 Vali Acc: 0.867 Test Loss: 0.483 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7553162574768066
Epoch: 38, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.488 Vali Acc: 0.856 Test Loss: 0.488 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8113303184509277
Epoch: 39, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.487 Vali Acc: 0.872 Test Loss: 0.487 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7415883541107178
Epoch: 40, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.479 Vali Acc: 0.878 Test Loss: 0.479 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 41 cost time: 0.718738317489624
Epoch: 41, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.483 Vali Acc: 0.878 Test Loss: 0.483 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7682504653930664
Epoch: 42, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.530 Vali Acc: 0.878 Test Loss: 0.530 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.723505973815918
Epoch: 43, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.504 Vali Acc: 0.872 Test Loss: 0.504 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7429330348968506
Epoch: 44, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.484 Vali Acc: 0.878 Test Loss: 0.484 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7260026931762695
Epoch: 45, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.497 Vali Acc: 0.889 Test Loss: 0.497 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 46 cost time: 0.7753603458404541
Epoch: 46, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.514 Vali Acc: 0.889 Test Loss: 0.514 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8310105800628662
Epoch: 47, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.507 Vali Acc: 0.889 Test Loss: 0.507 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8113679885864258
Epoch: 48, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.505 Vali Acc: 0.883 Test Loss: 0.505 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7748956680297852
Epoch: 49, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.526 Vali Acc: 0.878 Test Loss: 0.526 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.7862823009490967
Epoch: 50, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.526 Vali Acc: 0.878 Test Loss: 0.526 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 169359
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9434089660644531
Epoch: 1, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.623 Vali Acc: 0.189 Test Loss: 2.623 Test Acc: 0.189
Validation loss decreased (inf --> -0.188863).  Saving model ...
Epoch: 2 cost time: 0.735919713973999
Epoch: 2, Steps: 12 | Train Loss: 2.211 Vali Loss: 2.158 Vali Acc: 0.439 Test Loss: 2.158 Test Acc: 0.439
Validation loss decreased (-0.188863 --> -0.438867).  Saving model ...
Epoch: 3 cost time: 0.733330488204956
Epoch: 3, Steps: 12 | Train Loss: 1.722 Vali Loss: 1.687 Vali Acc: 0.589 Test Loss: 1.687 Test Acc: 0.589
Validation loss decreased (-0.438867 --> -0.588872).  Saving model ...
Epoch: 4 cost time: 0.7536673545837402
Epoch: 4, Steps: 12 | Train Loss: 1.348 Vali Loss: 1.371 Vali Acc: 0.633 Test Loss: 1.371 Test Acc: 0.633
Validation loss decreased (-0.588872 --> -0.633320).  Saving model ...
Epoch: 5 cost time: 0.7628908157348633
Epoch: 5, Steps: 12 | Train Loss: 0.989 Vali Loss: 1.146 Vali Acc: 0.672 Test Loss: 1.146 Test Acc: 0.672
Validation loss decreased (-0.633320 --> -0.672211).  Saving model ...
Epoch: 6 cost time: 0.6900918483734131
Epoch: 6, Steps: 12 | Train Loss: 0.775 Vali Loss: 1.006 Vali Acc: 0.694 Test Loss: 1.006 Test Acc: 0.694
Validation loss decreased (-0.672211 --> -0.694434).  Saving model ...
Epoch: 7 cost time: 0.7043571472167969
Epoch: 7, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.925 Vali Acc: 0.717 Test Loss: 0.925 Test Acc: 0.717
Validation loss decreased (-0.694434 --> -0.716657).  Saving model ...
Epoch: 8 cost time: 0.7164602279663086
Epoch: 8, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.865 Vali Acc: 0.744 Test Loss: 0.865 Test Acc: 0.744
Validation loss decreased (-0.716657 --> -0.744436).  Saving model ...
Epoch: 9 cost time: 0.6934137344360352
Epoch: 9, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.809 Vali Acc: 0.750 Test Loss: 0.809 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749992).  Saving model ...
Epoch: 10 cost time: 0.7185957431793213
Epoch: 10, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.726 Vali Acc: 0.778 Test Loss: 0.726 Test Acc: 0.778
Validation loss decreased (-0.749992 --> -0.777771).  Saving model ...
Epoch: 11 cost time: 0.7393724918365479
Epoch: 11, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.740 Vali Acc: 0.778 Test Loss: 0.740 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7600963115692139
Epoch: 12, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.713 Vali Acc: 0.772 Test Loss: 0.713 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7514200210571289
Epoch: 13, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.700 Vali Acc: 0.806 Test Loss: 0.700 Test Acc: 0.806
Validation loss decreased (-0.777771 --> -0.805549).  Saving model ...
Epoch: 14 cost time: 0.8456144332885742
Epoch: 14, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.652 Vali Acc: 0.822 Test Loss: 0.652 Test Acc: 0.822
Validation loss decreased (-0.805549 --> -0.822216).  Saving model ...
Epoch: 15 cost time: 0.758129358291626
Epoch: 15, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.647 Vali Acc: 0.822 Test Loss: 0.647 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 16 cost time: 0.7702693939208984
Epoch: 16, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.646 Vali Acc: 0.828 Test Loss: 0.646 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827771).  Saving model ...
Epoch: 17 cost time: 0.7875044345855713
Epoch: 17, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.654 Vali Acc: 0.833 Test Loss: 0.654 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 18 cost time: 0.7250199317932129
Epoch: 18, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.630 Vali Acc: 0.833 Test Loss: 0.630 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 19 cost time: 0.6818711757659912
Epoch: 19, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.635 Vali Acc: 0.822 Test Loss: 0.635 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7271707057952881
Epoch: 20, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.641 Vali Acc: 0.839 Test Loss: 0.641 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838882).  Saving model ...
Epoch: 21 cost time: 0.7479784488677979
Epoch: 21, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.632 Vali Acc: 0.844 Test Loss: 0.632 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 22 cost time: 0.7149288654327393
Epoch: 22, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.646 Vali Acc: 0.844 Test Loss: 0.646 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7605206966400146
Epoch: 23, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.668 Vali Acc: 0.850 Test Loss: 0.668 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849993).  Saving model ...
Epoch: 24 cost time: 0.7346792221069336
Epoch: 24, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.656 Vali Acc: 0.850 Test Loss: 0.656 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 25 cost time: 0.7347683906555176
Epoch: 25, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.666 Vali Acc: 0.861 Test Loss: 0.666 Test Acc: 0.861
Validation loss decreased (-0.849993 --> -0.861104).  Saving model ...
Epoch: 26 cost time: 0.7577211856842041
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.765 Vali Acc: 0.850 Test Loss: 0.765 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7560865879058838
Epoch: 27, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.787 Vali Acc: 0.850 Test Loss: 0.787 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6847059726715088
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.769 Vali Acc: 0.839 Test Loss: 0.769 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7124824523925781
Epoch: 29, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.744 Vali Acc: 0.861 Test Loss: 0.744 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7379112243652344
Epoch: 30, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.759 Vali Acc: 0.844 Test Loss: 0.759 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7197399139404297
Epoch: 31, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.725 Vali Acc: 0.861 Test Loss: 0.725 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7254288196563721
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.722 Vali Acc: 0.844 Test Loss: 0.722 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7228074073791504
Epoch: 33, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.727 Vali Acc: 0.844 Test Loss: 0.727 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7311363220214844
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.737 Vali Acc: 0.839 Test Loss: 0.737 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7228376865386963
Epoch: 35, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.755 Vali Acc: 0.856 Test Loss: 0.755 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 124239
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.036987781524658
Epoch: 1, Steps: 12 | Train Loss: 2.795 Vali Loss: 2.665 Vali Acc: 0.106 Test Loss: 2.665 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 0.7875285148620605
Epoch: 2, Steps: 12 | Train Loss: 2.537 Vali Loss: 2.418 Vali Acc: 0.300 Test Loss: 2.418 Test Acc: 0.300
Validation loss decreased (-0.105529 --> -0.299976).  Saving model ...
Epoch: 3 cost time: 0.7942590713500977
Epoch: 3, Steps: 12 | Train Loss: 2.112 Vali Loss: 2.093 Vali Acc: 0.522 Test Loss: 2.093 Test Acc: 0.522
Validation loss decreased (-0.299976 --> -0.522201).  Saving model ...
Epoch: 4 cost time: 0.7616662979125977
Epoch: 4, Steps: 12 | Train Loss: 1.803 Vali Loss: 1.791 Vali Acc: 0.594 Test Loss: 1.791 Test Acc: 0.594
Validation loss decreased (-0.522201 --> -0.594427).  Saving model ...
Epoch: 5 cost time: 0.7227745056152344
Epoch: 5, Steps: 12 | Train Loss: 1.463 Vali Loss: 1.527 Vali Acc: 0.650 Test Loss: 1.527 Test Acc: 0.650
Validation loss decreased (-0.594427 --> -0.649985).  Saving model ...
Epoch: 6 cost time: 0.7009234428405762
Epoch: 6, Steps: 12 | Train Loss: 1.199 Vali Loss: 1.368 Vali Acc: 0.661 Test Loss: 1.368 Test Acc: 0.661
Validation loss decreased (-0.649985 --> -0.661097).  Saving model ...
Epoch: 7 cost time: 0.6904523372650146
Epoch: 7, Steps: 12 | Train Loss: 1.064 Vali Loss: 1.207 Vali Acc: 0.667 Test Loss: 1.207 Test Acc: 0.667
Validation loss decreased (-0.661097 --> -0.666655).  Saving model ...
Epoch: 8 cost time: 0.7454876899719238
Epoch: 8, Steps: 12 | Train Loss: 0.895 Vali Loss: 1.122 Vali Acc: 0.689 Test Loss: 1.122 Test Acc: 0.689
Validation loss decreased (-0.666655 --> -0.688878).  Saving model ...
Epoch: 9 cost time: 0.682903528213501
Epoch: 9, Steps: 12 | Train Loss: 0.773 Vali Loss: 1.025 Vali Acc: 0.717 Test Loss: 1.025 Test Acc: 0.717
Validation loss decreased (-0.688878 --> -0.716656).  Saving model ...
Epoch: 10 cost time: 0.6709983348846436
Epoch: 10, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.955 Vali Acc: 0.694 Test Loss: 0.955 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6532392501831055
Epoch: 11, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.903 Vali Acc: 0.722 Test Loss: 0.903 Test Acc: 0.722
Validation loss decreased (-0.716656 --> -0.722213).  Saving model ...
Epoch: 12 cost time: 0.7206230163574219
Epoch: 12, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.855 Vali Acc: 0.739 Test Loss: 0.855 Test Acc: 0.739
Validation loss decreased (-0.722213 --> -0.738880).  Saving model ...
Epoch: 13 cost time: 0.7583339214324951
Epoch: 13, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.789 Vali Acc: 0.761 Test Loss: 0.789 Test Acc: 0.761
Validation loss decreased (-0.738880 --> -0.761103).  Saving model ...
Epoch: 14 cost time: 0.7612826824188232
Epoch: 14, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.743 Vali Acc: 0.756 Test Loss: 0.743 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7213971614837646
Epoch: 15, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.741 Vali Acc: 0.756 Test Loss: 0.741 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7281560897827148
Epoch: 16, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.693 Vali Acc: 0.778 Test Loss: 0.693 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777771).  Saving model ...
Epoch: 17 cost time: 0.7630424499511719
Epoch: 17, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.676 Vali Acc: 0.817 Test Loss: 0.676 Test Acc: 0.817
Validation loss decreased (-0.777771 --> -0.816660).  Saving model ...
Epoch: 18 cost time: 0.7462599277496338
Epoch: 18, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.650 Vali Acc: 0.806 Test Loss: 0.650 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7449197769165039
Epoch: 19, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.616 Vali Acc: 0.822 Test Loss: 0.616 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 20 cost time: 0.7452847957611084
Epoch: 20, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.597 Vali Acc: 0.822 Test Loss: 0.597 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 21 cost time: 0.719980001449585
Epoch: 21, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.609 Vali Acc: 0.817 Test Loss: 0.609 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8088827133178711
Epoch: 22, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.585 Vali Acc: 0.850 Test Loss: 0.585 Test Acc: 0.850
Validation loss decreased (-0.822216 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 0.7606918811798096
Epoch: 23, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7571737766265869
Epoch: 24, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.595 Vali Acc: 0.839 Test Loss: 0.595 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7668976783752441
Epoch: 25, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.567 Vali Acc: 0.839 Test Loss: 0.567 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7487702369689941
Epoch: 26, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 27 cost time: 0.6934452056884766
Epoch: 27, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.620 Vali Acc: 0.833 Test Loss: 0.620 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7171404361724854
Epoch: 28, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.611 Vali Acc: 0.822 Test Loss: 0.611 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7036323547363281
Epoch: 29, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.605 Vali Acc: 0.850 Test Loss: 0.605 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7354304790496826
Epoch: 30, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.614 Vali Acc: 0.839 Test Loss: 0.614 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7236251831054688
Epoch: 31, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.613 Vali Acc: 0.833 Test Loss: 0.613 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7586159706115723
Epoch: 32, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.636 Vali Acc: 0.844 Test Loss: 0.636 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7812132835388184
Epoch: 33, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.661 Vali Acc: 0.839 Test Loss: 0.661 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7522940635681152
Epoch: 34, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.676 Vali Acc: 0.844 Test Loss: 0.676 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.7857315540313721
Epoch: 35, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.668 Vali Acc: 0.828 Test Loss: 0.668 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.7167718410491943
Epoch: 36, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.705 Vali Acc: 0.850 Test Loss: 0.705 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 80143
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0767135620117188
Epoch: 1, Steps: 12 | Train Loss: 2.793 Vali Loss: 2.710 Vali Acc: 0.056 Test Loss: 2.710 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 0.7266764640808105
Epoch: 2, Steps: 12 | Train Loss: 2.486 Vali Loss: 2.427 Vali Acc: 0.317 Test Loss: 2.427 Test Acc: 0.317
Validation loss decreased (-0.055528 --> -0.316642).  Saving model ...
Epoch: 3 cost time: 0.7225651741027832
Epoch: 3, Steps: 12 | Train Loss: 2.082 Vali Loss: 2.077 Vali Acc: 0.539 Test Loss: 2.077 Test Acc: 0.539
Validation loss decreased (-0.316642 --> -0.538868).  Saving model ...
Epoch: 4 cost time: 0.7450151443481445
Epoch: 4, Steps: 12 | Train Loss: 1.688 Vali Loss: 1.761 Vali Acc: 0.600 Test Loss: 1.761 Test Acc: 0.600
Validation loss decreased (-0.538868 --> -0.599982).  Saving model ...
Epoch: 5 cost time: 0.7659096717834473
Epoch: 5, Steps: 12 | Train Loss: 1.414 Vali Loss: 1.490 Vali Acc: 0.622 Test Loss: 1.490 Test Acc: 0.622
Validation loss decreased (-0.599982 --> -0.622207).  Saving model ...
Epoch: 6 cost time: 0.7279160022735596
Epoch: 6, Steps: 12 | Train Loss: 1.140 Vali Loss: 1.297 Vali Acc: 0.656 Test Loss: 1.297 Test Acc: 0.656
Validation loss decreased (-0.622207 --> -0.655543).  Saving model ...
Epoch: 7 cost time: 0.6987559795379639
Epoch: 7, Steps: 12 | Train Loss: 0.937 Vali Loss: 1.188 Vali Acc: 0.678 Test Loss: 1.188 Test Acc: 0.678
Validation loss decreased (-0.655543 --> -0.677766).  Saving model ...
Epoch: 8 cost time: 0.7249388694763184
Epoch: 8, Steps: 12 | Train Loss: 0.828 Vali Loss: 1.087 Vali Acc: 0.672 Test Loss: 1.087 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7339153289794922
Epoch: 9, Steps: 12 | Train Loss: 0.723 Vali Loss: 1.000 Vali Acc: 0.706 Test Loss: 1.000 Test Acc: 0.706
Validation loss decreased (-0.677766 --> -0.705546).  Saving model ...
Epoch: 10 cost time: 0.7653536796569824
Epoch: 10, Steps: 12 | Train Loss: 0.645 Vali Loss: 0.937 Vali Acc: 0.717 Test Loss: 0.937 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716657).  Saving model ...
Epoch: 11 cost time: 0.7785420417785645
Epoch: 11, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.876 Vali Acc: 0.728 Test Loss: 0.876 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727769).  Saving model ...
Epoch: 12 cost time: 0.7860629558563232
Epoch: 12, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.823 Vali Acc: 0.750 Test Loss: 0.823 Test Acc: 0.750
Validation loss decreased (-0.727769 --> -0.749992).  Saving model ...
Epoch: 13 cost time: 0.7603347301483154
Epoch: 13, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.791 Vali Acc: 0.761 Test Loss: 0.791 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761103).  Saving model ...
Epoch: 14 cost time: 0.7602574825286865
Epoch: 14, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.744 Vali Acc: 0.783 Test Loss: 0.744 Test Acc: 0.783
Validation loss decreased (-0.761103 --> -0.783326).  Saving model ...
Epoch: 15 cost time: 0.7052817344665527
Epoch: 15, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.714 Vali Acc: 0.800 Test Loss: 0.714 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799993).  Saving model ...
Epoch: 16 cost time: 0.6947095394134521
Epoch: 16, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.698 Vali Acc: 0.778 Test Loss: 0.698 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7497766017913818
Epoch: 17, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.656 Vali Acc: 0.822 Test Loss: 0.656 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 18 cost time: 0.7365844249725342
Epoch: 18, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.637 Vali Acc: 0.811 Test Loss: 0.637 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7250487804412842
Epoch: 19, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.631 Vali Acc: 0.806 Test Loss: 0.631 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7050812244415283
Epoch: 20, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.625 Vali Acc: 0.806 Test Loss: 0.625 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7531664371490479
Epoch: 21, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.588 Vali Acc: 0.828 Test Loss: 0.588 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 22 cost time: 0.7486767768859863
Epoch: 22, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.596 Vali Acc: 0.822 Test Loss: 0.596 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7510817050933838
Epoch: 23, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.595 Vali Acc: 0.844 Test Loss: 0.595 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844438).  Saving model ...
Epoch: 24 cost time: 0.7663955688476562
Epoch: 24, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.620 Vali Acc: 0.828 Test Loss: 0.620 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6859579086303711
Epoch: 25, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.603 Vali Acc: 0.833 Test Loss: 0.603 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7177860736846924
Epoch: 26, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.618 Vali Acc: 0.817 Test Loss: 0.618 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6547362804412842
Epoch: 27, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.610 Vali Acc: 0.828 Test Loss: 0.610 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6736140251159668
Epoch: 28, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.602 Vali Acc: 0.833 Test Loss: 0.602 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7021744251251221
Epoch: 29, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.628 Vali Acc: 0.839 Test Loss: 0.628 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.76352858543396
Epoch: 30, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.612 Vali Acc: 0.828 Test Loss: 0.612 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6390836238861084
Epoch: 31, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.619 Vali Acc: 0.833 Test Loss: 0.619 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6853353977203369
Epoch: 32, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.639 Vali Acc: 0.839 Test Loss: 0.639 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6736092567443848
Epoch: 33, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.654 Vali Acc: 0.844 Test Loss: 0.654 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 80207
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9045748710632324
Epoch: 1, Steps: 12 | Train Loss: 2.757 Vali Loss: 2.686 Vali Acc: 0.050 Test Loss: 2.686 Test Acc: 0.050
Validation loss decreased (inf --> -0.049973).  Saving model ...
Epoch: 2 cost time: 0.6847302913665771
Epoch: 2, Steps: 12 | Train Loss: 2.594 Vali Loss: 2.507 Vali Acc: 0.211 Test Loss: 2.507 Test Acc: 0.211
Validation loss decreased (-0.049973 --> -0.211086).  Saving model ...
Epoch: 3 cost time: 0.7565441131591797
Epoch: 3, Steps: 12 | Train Loss: 2.334 Vali Loss: 2.244 Vali Acc: 0.411 Test Loss: 2.244 Test Acc: 0.411
Validation loss decreased (-0.211086 --> -0.411089).  Saving model ...
Epoch: 4 cost time: 0.7328712940216064
Epoch: 4, Steps: 12 | Train Loss: 1.993 Vali Loss: 1.971 Vali Acc: 0.517 Test Loss: 1.971 Test Acc: 0.517
Validation loss decreased (-0.411089 --> -0.516647).  Saving model ...
Epoch: 5 cost time: 0.7354397773742676
Epoch: 5, Steps: 12 | Train Loss: 1.716 Vali Loss: 1.735 Vali Acc: 0.622 Test Loss: 1.735 Test Acc: 0.622
Validation loss decreased (-0.516647 --> -0.622205).  Saving model ...
Epoch: 6 cost time: 0.7375874519348145
Epoch: 6, Steps: 12 | Train Loss: 1.454 Vali Loss: 1.533 Vali Acc: 0.672 Test Loss: 1.533 Test Acc: 0.672
Validation loss decreased (-0.622205 --> -0.672207).  Saving model ...
Epoch: 7 cost time: 0.7160801887512207
Epoch: 7, Steps: 12 | Train Loss: 1.228 Vali Loss: 1.386 Vali Acc: 0.672 Test Loss: 1.386 Test Acc: 0.672
Validation loss decreased (-0.672207 --> -0.672208).  Saving model ...
Epoch: 8 cost time: 0.6947019100189209
Epoch: 8, Steps: 12 | Train Loss: 1.120 Vali Loss: 1.257 Vali Acc: 0.689 Test Loss: 1.257 Test Acc: 0.689
Validation loss decreased (-0.672208 --> -0.688876).  Saving model ...
Epoch: 9 cost time: 0.7103157043457031
Epoch: 9, Steps: 12 | Train Loss: 0.930 Vali Loss: 1.165 Vali Acc: 0.700 Test Loss: 1.165 Test Acc: 0.700
Validation loss decreased (-0.688876 --> -0.699988).  Saving model ...
Epoch: 10 cost time: 0.7090752124786377
Epoch: 10, Steps: 12 | Train Loss: 0.804 Vali Loss: 1.068 Vali Acc: 0.694 Test Loss: 1.068 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6959457397460938
Epoch: 11, Steps: 12 | Train Loss: 0.749 Vali Loss: 1.005 Vali Acc: 0.722 Test Loss: 1.005 Test Acc: 0.722
Validation loss decreased (-0.699988 --> -0.722212).  Saving model ...
Epoch: 12 cost time: 0.7150704860687256
Epoch: 12, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.947 Vali Acc: 0.722 Test Loss: 0.947 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722213).  Saving model ...
Epoch: 13 cost time: 0.7900712490081787
Epoch: 13, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.890 Vali Acc: 0.733 Test Loss: 0.890 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 14 cost time: 0.7224977016448975
Epoch: 14, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.861 Vali Acc: 0.739 Test Loss: 0.861 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738880).  Saving model ...
Epoch: 15 cost time: 0.7253031730651855
Epoch: 15, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.798 Vali Acc: 0.756 Test Loss: 0.798 Test Acc: 0.756
Validation loss decreased (-0.738880 --> -0.755548).  Saving model ...
Epoch: 16 cost time: 0.7546396255493164
Epoch: 16, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.758 Vali Acc: 0.767 Test Loss: 0.758 Test Acc: 0.767
Validation loss decreased (-0.755548 --> -0.766659).  Saving model ...
Epoch: 17 cost time: 0.6576671600341797
Epoch: 17, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.758 Vali Acc: 0.783 Test Loss: 0.758 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783326).  Saving model ...
Epoch: 18 cost time: 0.6856701374053955
Epoch: 18, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.687 Vali Acc: 0.783 Test Loss: 0.687 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783326).  Saving model ...
Epoch: 19 cost time: 0.6928236484527588
Epoch: 19, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.661 Vali Acc: 0.806 Test Loss: 0.661 Test Acc: 0.806
Validation loss decreased (-0.783326 --> -0.805549).  Saving model ...
Epoch: 20 cost time: 0.6969325542449951
Epoch: 20, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.665 Vali Acc: 0.800 Test Loss: 0.665 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7380802631378174
Epoch: 21, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.632 Vali Acc: 0.806 Test Loss: 0.632 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805549).  Saving model ...
Epoch: 22 cost time: 0.7187745571136475
Epoch: 22, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.620 Vali Acc: 0.817 Test Loss: 0.620 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816660).  Saving model ...
Epoch: 23 cost time: 0.6893339157104492
Epoch: 23, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.601 Vali Acc: 0.811 Test Loss: 0.601 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7008929252624512
Epoch: 24, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.612 Vali Acc: 0.811 Test Loss: 0.612 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7323203086853027
Epoch: 25, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.593 Vali Acc: 0.833 Test Loss: 0.593 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 26 cost time: 0.7227878570556641
Epoch: 26, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.585 Vali Acc: 0.828 Test Loss: 0.585 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7100570201873779
Epoch: 27, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.580 Vali Acc: 0.817 Test Loss: 0.580 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6991379261016846
Epoch: 28, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.575 Vali Acc: 0.861 Test Loss: 0.575 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861105).  Saving model ...
Epoch: 29 cost time: 0.696063756942749
Epoch: 29, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.568 Vali Acc: 0.844 Test Loss: 0.568 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6849610805511475
Epoch: 30, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.584 Vali Acc: 0.833 Test Loss: 0.584 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6748635768890381
Epoch: 31, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.590 Vali Acc: 0.839 Test Loss: 0.590 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7190358638763428
Epoch: 32, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.595 Vali Acc: 0.833 Test Loss: 0.595 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6954443454742432
Epoch: 33, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.607 Vali Acc: 0.833 Test Loss: 0.607 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.737421989440918
Epoch: 34, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.606 Vali Acc: 0.844 Test Loss: 0.606 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7302455902099609
Epoch: 35, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.606 Vali Acc: 0.844 Test Loss: 0.606 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.7105026245117188
Epoch: 36, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.623 Vali Acc: 0.822 Test Loss: 0.623 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.7081377506256104
Epoch: 37, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.630 Vali Acc: 0.844 Test Loss: 0.630 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.740790843963623
Epoch: 38, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.614 Vali Acc: 0.844 Test Loss: 0.614 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 66831
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.006279230117798
Epoch: 1, Steps: 12 | Train Loss: 2.741 Vali Loss: 2.701 Vali Acc: 0.050 Test Loss: 2.701 Test Acc: 0.050
Validation loss decreased (inf --> -0.049973).  Saving model ...
Epoch: 2 cost time: 0.729222297668457
Epoch: 2, Steps: 12 | Train Loss: 2.571 Vali Loss: 2.547 Vali Acc: 0.239 Test Loss: 2.547 Test Acc: 0.239
Validation loss decreased (-0.049973 --> -0.238863).  Saving model ...
Epoch: 3 cost time: 0.7255523204803467
Epoch: 3, Steps: 12 | Train Loss: 2.325 Vali Loss: 2.323 Vali Acc: 0.350 Test Loss: 2.323 Test Acc: 0.350
Validation loss decreased (-0.238863 --> -0.349977).  Saving model ...
Epoch: 4 cost time: 0.7639093399047852
Epoch: 4, Steps: 12 | Train Loss: 2.065 Vali Loss: 2.084 Vali Acc: 0.439 Test Loss: 2.084 Test Acc: 0.439
Validation loss decreased (-0.349977 --> -0.438868).  Saving model ...
Epoch: 5 cost time: 0.7206110954284668
Epoch: 5, Steps: 12 | Train Loss: 1.834 Vali Loss: 1.867 Vali Acc: 0.494 Test Loss: 1.867 Test Acc: 0.494
Validation loss decreased (-0.438868 --> -0.494426).  Saving model ...
Epoch: 6 cost time: 0.7236502170562744
Epoch: 6, Steps: 12 | Train Loss: 1.612 Vali Loss: 1.670 Vali Acc: 0.572 Test Loss: 1.670 Test Acc: 0.572
Validation loss decreased (-0.494426 --> -0.572206).  Saving model ...
Epoch: 7 cost time: 0.7254753112792969
Epoch: 7, Steps: 12 | Train Loss: 1.418 Vali Loss: 1.528 Vali Acc: 0.611 Test Loss: 1.528 Test Acc: 0.611
Validation loss decreased (-0.572206 --> -0.611096).  Saving model ...
Epoch: 8 cost time: 0.7228014469146729
Epoch: 8, Steps: 12 | Train Loss: 1.307 Vali Loss: 1.392 Vali Acc: 0.622 Test Loss: 1.392 Test Acc: 0.622
Validation loss decreased (-0.611096 --> -0.622208).  Saving model ...
Epoch: 9 cost time: 0.7130277156829834
Epoch: 9, Steps: 12 | Train Loss: 1.117 Vali Loss: 1.317 Vali Acc: 0.639 Test Loss: 1.317 Test Acc: 0.639
Validation loss decreased (-0.622208 --> -0.638876).  Saving model ...
Epoch: 10 cost time: 0.7095518112182617
Epoch: 10, Steps: 12 | Train Loss: 0.986 Vali Loss: 1.216 Vali Acc: 0.644 Test Loss: 1.216 Test Acc: 0.644
Validation loss decreased (-0.638876 --> -0.644432).  Saving model ...
Epoch: 11 cost time: 0.7463884353637695
Epoch: 11, Steps: 12 | Train Loss: 0.970 Vali Loss: 1.133 Vali Acc: 0.667 Test Loss: 1.133 Test Acc: 0.667
Validation loss decreased (-0.644432 --> -0.666655).  Saving model ...
Epoch: 12 cost time: 0.7176406383514404
Epoch: 12, Steps: 12 | Train Loss: 0.826 Vali Loss: 1.082 Vali Acc: 0.672 Test Loss: 1.082 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672211).  Saving model ...
Epoch: 13 cost time: 0.7457339763641357
Epoch: 13, Steps: 12 | Train Loss: 0.714 Vali Loss: 1.026 Vali Acc: 0.700 Test Loss: 1.026 Test Acc: 0.700
Validation loss decreased (-0.672211 --> -0.699990).  Saving model ...
Epoch: 14 cost time: 0.7733469009399414
Epoch: 14, Steps: 12 | Train Loss: 0.665 Vali Loss: 0.980 Vali Acc: 0.733 Test Loss: 0.980 Test Acc: 0.733
Validation loss decreased (-0.699990 --> -0.733324).  Saving model ...
Epoch: 15 cost time: 0.8054547309875488
Epoch: 15, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.925 Vali Acc: 0.722 Test Loss: 0.925 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.686229944229126
Epoch: 16, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.865 Vali Acc: 0.733 Test Loss: 0.865 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733325).  Saving model ...
Epoch: 17 cost time: 0.7151403427124023
Epoch: 17, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.842 Vali Acc: 0.744 Test Loss: 0.842 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744436).  Saving model ...
Epoch: 18 cost time: 0.7093210220336914
Epoch: 18, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.797 Vali Acc: 0.761 Test Loss: 0.797 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761103).  Saving model ...
Epoch: 19 cost time: 0.7165191173553467
Epoch: 19, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.760 Vali Acc: 0.794 Test Loss: 0.760 Test Acc: 0.794
Validation loss decreased (-0.761103 --> -0.794437).  Saving model ...
Epoch: 20 cost time: 0.7293057441711426
Epoch: 20, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.722 Vali Acc: 0.794 Test Loss: 0.722 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794437).  Saving model ...
Epoch: 21 cost time: 0.7907838821411133
Epoch: 21, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.690 Vali Acc: 0.794 Test Loss: 0.690 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794438).  Saving model ...
Epoch: 22 cost time: 0.7642357349395752
Epoch: 22, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.681 Vali Acc: 0.817 Test Loss: 0.681 Test Acc: 0.817
Validation loss decreased (-0.794438 --> -0.816660).  Saving model ...
Epoch: 23 cost time: 0.7400772571563721
Epoch: 23, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.666 Vali Acc: 0.817 Test Loss: 0.666 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 24 cost time: 0.7957892417907715
Epoch: 24, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.649 Vali Acc: 0.817 Test Loss: 0.649 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 25 cost time: 0.7225873470306396
Epoch: 25, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.634 Vali Acc: 0.828 Test Loss: 0.634 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 26 cost time: 0.7337660789489746
Epoch: 26, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.614 Vali Acc: 0.822 Test Loss: 0.614 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6902751922607422
Epoch: 27, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.599 Vali Acc: 0.822 Test Loss: 0.599 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7213423252105713
Epoch: 28, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.598 Vali Acc: 0.833 Test Loss: 0.598 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 29 cost time: 0.7442770004272461
Epoch: 29, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.593 Vali Acc: 0.856 Test Loss: 0.593 Test Acc: 0.856
Validation loss decreased (-0.833327 --> -0.855550).  Saving model ...
Epoch: 30 cost time: 0.7226653099060059
Epoch: 30, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.591 Vali Acc: 0.844 Test Loss: 0.591 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6978721618652344
Epoch: 31, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.577 Vali Acc: 0.839 Test Loss: 0.577 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7228469848632812
Epoch: 32, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.574 Vali Acc: 0.856 Test Loss: 0.574 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 33 cost time: 0.7798254489898682
Epoch: 33, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.575 Vali Acc: 0.861 Test Loss: 0.575 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 34 cost time: 0.7456705570220947
Epoch: 34, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.590 Vali Acc: 0.844 Test Loss: 0.590 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7461404800415039
Epoch: 35, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7096478939056396
Epoch: 36, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.589 Vali Acc: 0.856 Test Loss: 0.589 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7108364105224609
Epoch: 37, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.570 Vali Acc: 0.872 Test Loss: 0.570 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872217).  Saving model ...
Epoch: 38 cost time: 0.7301056385040283
Epoch: 38, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.589 Vali Acc: 0.867 Test Loss: 0.589 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7100915908813477
Epoch: 39, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.587 Vali Acc: 0.856 Test Loss: 0.587 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7411811351776123
Epoch: 40, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.620 Vali Acc: 0.867 Test Loss: 0.620 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7334847450256348
Epoch: 41, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.612 Vali Acc: 0.867 Test Loss: 0.612 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7417120933532715
Epoch: 42, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.635 Vali Acc: 0.861 Test Loss: 0.635 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7139441967010498
Epoch: 43, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.621 Vali Acc: 0.872 Test Loss: 0.621 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.7118866443634033
Epoch: 44, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.589 Vali Acc: 0.872 Test Loss: 0.589 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.7872161865234375
Epoch: 45, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.7393910884857178
Epoch: 46, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.627 Vali Acc: 0.867 Test Loss: 0.627 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.714400053024292
Epoch: 47, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.638 Vali Acc: 0.878 Test Loss: 0.638 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877771).  Saving model ...
Epoch: 48 cost time: 0.6929361820220947
Epoch: 48, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.630 Vali Acc: 0.878 Test Loss: 0.630 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877771).  Saving model ...
Epoch: 49 cost time: 0.7101762294769287
Epoch: 49, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.628 Vali Acc: 0.883 Test Loss: 0.628 Test Acc: 0.883
Validation loss decreased (-0.877771 --> -0.883327).  Saving model ...
Epoch: 50 cost time: 0.7352123260498047
Epoch: 50, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.639 Vali Acc: 0.872 Test Loss: 0.639 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 59279
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9457170963287354
Epoch: 1, Steps: 12 | Train Loss: 2.770 Vali Loss: 2.694 Vali Acc: 0.039 Test Loss: 2.694 Test Acc: 0.039
Validation loss decreased (inf --> -0.038862).  Saving model ...
Epoch: 2 cost time: 0.7095301151275635
Epoch: 2, Steps: 12 | Train Loss: 2.626 Vali Loss: 2.591 Vali Acc: 0.094 Test Loss: 2.591 Test Acc: 0.094
Validation loss decreased (-0.038862 --> -0.094419).  Saving model ...
Epoch: 3 cost time: 0.7506725788116455
Epoch: 3, Steps: 12 | Train Loss: 2.427 Vali Loss: 2.414 Vali Acc: 0.244 Test Loss: 2.414 Test Acc: 0.244
Validation loss decreased (-0.094419 --> -0.244420).  Saving model ...
Epoch: 4 cost time: 0.6706736087799072
Epoch: 4, Steps: 12 | Train Loss: 2.183 Vali Loss: 2.216 Vali Acc: 0.417 Test Loss: 2.216 Test Acc: 0.417
Validation loss decreased (-0.244420 --> -0.416645).  Saving model ...
Epoch: 5 cost time: 0.6956322193145752
Epoch: 5, Steps: 12 | Train Loss: 1.986 Vali Loss: 2.017 Vali Acc: 0.533 Test Loss: 2.017 Test Acc: 0.533
Validation loss decreased (-0.416645 --> -0.533313).  Saving model ...
Epoch: 6 cost time: 0.7049891948699951
Epoch: 6, Steps: 12 | Train Loss: 1.737 Vali Loss: 1.827 Vali Acc: 0.567 Test Loss: 1.827 Test Acc: 0.567
Validation loss decreased (-0.533313 --> -0.566648).  Saving model ...
Epoch: 7 cost time: 0.7551813125610352
Epoch: 7, Steps: 12 | Train Loss: 1.573 Vali Loss: 1.667 Vali Acc: 0.578 Test Loss: 1.667 Test Acc: 0.578
Validation loss decreased (-0.566648 --> -0.577761).  Saving model ...
Epoch: 8 cost time: 0.7009885311126709
Epoch: 8, Steps: 12 | Train Loss: 1.383 Vali Loss: 1.530 Vali Acc: 0.611 Test Loss: 1.530 Test Acc: 0.611
Validation loss decreased (-0.577761 --> -0.611096).  Saving model ...
Epoch: 9 cost time: 0.7460546493530273
Epoch: 9, Steps: 12 | Train Loss: 1.274 Vali Loss: 1.398 Vali Acc: 0.633 Test Loss: 1.398 Test Acc: 0.633
Validation loss decreased (-0.611096 --> -0.633319).  Saving model ...
Epoch: 10 cost time: 0.6577658653259277
Epoch: 10, Steps: 12 | Train Loss: 1.108 Vali Loss: 1.300 Vali Acc: 0.644 Test Loss: 1.300 Test Acc: 0.644
Validation loss decreased (-0.633319 --> -0.644431).  Saving model ...
Epoch: 11 cost time: 0.6794836521148682
Epoch: 11, Steps: 12 | Train Loss: 0.971 Vali Loss: 1.226 Vali Acc: 0.672 Test Loss: 1.226 Test Acc: 0.672
Validation loss decreased (-0.644431 --> -0.672210).  Saving model ...
Epoch: 12 cost time: 0.7532739639282227
Epoch: 12, Steps: 12 | Train Loss: 0.908 Vali Loss: 1.147 Vali Acc: 0.700 Test Loss: 1.147 Test Acc: 0.700
Validation loss decreased (-0.672210 --> -0.699989).  Saving model ...
Epoch: 13 cost time: 0.7591655254364014
Epoch: 13, Steps: 12 | Train Loss: 0.805 Vali Loss: 1.069 Vali Acc: 0.706 Test Loss: 1.069 Test Acc: 0.706
Validation loss decreased (-0.699989 --> -0.705545).  Saving model ...
Epoch: 14 cost time: 0.7442331314086914
Epoch: 14, Steps: 12 | Train Loss: 0.789 Vali Loss: 1.007 Vali Acc: 0.739 Test Loss: 1.007 Test Acc: 0.739
Validation loss decreased (-0.705545 --> -0.738879).  Saving model ...
Epoch: 15 cost time: 0.7284281253814697
Epoch: 15, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.944 Vali Acc: 0.767 Test Loss: 0.944 Test Acc: 0.767
Validation loss decreased (-0.738879 --> -0.766657).  Saving model ...
Epoch: 16 cost time: 0.7370476722717285
Epoch: 16, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.895 Vali Acc: 0.772 Test Loss: 0.895 Test Acc: 0.772
Validation loss decreased (-0.766657 --> -0.772213).  Saving model ...
Epoch: 17 cost time: 0.7547934055328369
Epoch: 17, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.861 Vali Acc: 0.767 Test Loss: 0.861 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7830972671508789
Epoch: 18, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.816 Vali Acc: 0.772 Test Loss: 0.816 Test Acc: 0.772
Validation loss decreased (-0.772213 --> -0.772214).  Saving model ...
Epoch: 19 cost time: 0.7447094917297363
Epoch: 19, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.774 Vali Acc: 0.789 Test Loss: 0.774 Test Acc: 0.789
Validation loss decreased (-0.772214 --> -0.788881).  Saving model ...
Epoch: 20 cost time: 0.6857671737670898
Epoch: 20, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.741 Vali Acc: 0.794 Test Loss: 0.741 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794437).  Saving model ...
Epoch: 21 cost time: 0.7177715301513672
Epoch: 21, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.735 Vali Acc: 0.806 Test Loss: 0.735 Test Acc: 0.806
Validation loss decreased (-0.794437 --> -0.805548).  Saving model ...
Epoch: 22 cost time: 0.7145812511444092
Epoch: 22, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.702 Vali Acc: 0.800 Test Loss: 0.702 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6757833957672119
Epoch: 23, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.677 Vali Acc: 0.833 Test Loss: 0.677 Test Acc: 0.833
Validation loss decreased (-0.805548 --> -0.833327).  Saving model ...
Epoch: 24 cost time: 0.72694993019104
Epoch: 24, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.661 Vali Acc: 0.828 Test Loss: 0.661 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6728034019470215
Epoch: 25, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 26 cost time: 0.6711547374725342
Epoch: 26, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.616 Vali Acc: 0.833 Test Loss: 0.616 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7268903255462646
Epoch: 27, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.619 Vali Acc: 0.822 Test Loss: 0.619 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7207753658294678
Epoch: 28, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.601 Vali Acc: 0.833 Test Loss: 0.601 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7421209812164307
Epoch: 29, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.577 Vali Acc: 0.844 Test Loss: 0.577 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7301764488220215
Epoch: 30, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.561 Vali Acc: 0.844 Test Loss: 0.561 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7325994968414307
Epoch: 31, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.546 Vali Acc: 0.861 Test Loss: 0.546 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861106).  Saving model ...
Epoch: 32 cost time: 0.7280068397521973
Epoch: 32, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.536 Vali Acc: 0.856 Test Loss: 0.536 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.722008228302002
Epoch: 33, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.540 Vali Acc: 0.856 Test Loss: 0.540 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7347750663757324
Epoch: 34, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.527 Vali Acc: 0.867 Test Loss: 0.527 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 35 cost time: 0.7493166923522949
Epoch: 35, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.693073034286499
Epoch: 36, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.525 Vali Acc: 0.861 Test Loss: 0.525 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7210426330566406
Epoch: 37, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7340798377990723
Epoch: 38, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.530 Vali Acc: 0.839 Test Loss: 0.530 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7104907035827637
Epoch: 39, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7115983963012695
Epoch: 40, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.557 Vali Acc: 0.833 Test Loss: 0.557 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.728804349899292
Epoch: 41, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7474608421325684
Epoch: 42, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.544 Vali Acc: 0.861 Test Loss: 0.544 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7010843753814697
Epoch: 43, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.7018833160400391
Epoch: 44, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.615 Vali Acc: 0.844 Test Loss: 0.615 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 55567
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8842332363128662
Epoch: 1, Steps: 12 | Train Loss: 2.835 Vali Loss: 2.717 Vali Acc: 0.067 Test Loss: 2.717 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 0.7134134769439697
Epoch: 2, Steps: 12 | Train Loss: 2.747 Vali Loss: 2.639 Vali Acc: 0.100 Test Loss: 2.639 Test Acc: 0.100
Validation loss decreased (-0.066639 --> -0.099974).  Saving model ...
Epoch: 3 cost time: 0.667670726776123
Epoch: 3, Steps: 12 | Train Loss: 2.558 Vali Loss: 2.496 Vali Acc: 0.178 Test Loss: 2.496 Test Acc: 0.178
Validation loss decreased (-0.099974 --> -0.177753).  Saving model ...
Epoch: 4 cost time: 0.702770471572876
Epoch: 4, Steps: 12 | Train Loss: 2.387 Vali Loss: 2.320 Vali Acc: 0.339 Test Loss: 2.320 Test Acc: 0.339
Validation loss decreased (-0.177753 --> -0.338866).  Saving model ...
Epoch: 5 cost time: 0.7138617038726807
Epoch: 5, Steps: 12 | Train Loss: 2.201 Vali Loss: 2.140 Vali Acc: 0.478 Test Loss: 2.140 Test Acc: 0.478
Validation loss decreased (-0.338866 --> -0.477756).  Saving model ...
Epoch: 6 cost time: 0.6652183532714844
Epoch: 6, Steps: 12 | Train Loss: 1.991 Vali Loss: 1.952 Vali Acc: 0.561 Test Loss: 1.952 Test Acc: 0.561
Validation loss decreased (-0.477756 --> -0.561092).  Saving model ...
Epoch: 7 cost time: 0.6990125179290771
Epoch: 7, Steps: 12 | Train Loss: 1.761 Vali Loss: 1.798 Vali Acc: 0.589 Test Loss: 1.798 Test Acc: 0.589
Validation loss decreased (-0.561092 --> -0.588871).  Saving model ...
Epoch: 8 cost time: 0.7182843685150146
Epoch: 8, Steps: 12 | Train Loss: 1.578 Vali Loss: 1.667 Vali Acc: 0.622 Test Loss: 1.667 Test Acc: 0.622
Validation loss decreased (-0.588871 --> -0.622206).  Saving model ...
Epoch: 9 cost time: 0.7447519302368164
Epoch: 9, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.525 Vali Acc: 0.644 Test Loss: 1.525 Test Acc: 0.644
Validation loss decreased (-0.622206 --> -0.644429).  Saving model ...
Epoch: 10 cost time: 0.717113733291626
Epoch: 10, Steps: 12 | Train Loss: 1.322 Vali Loss: 1.430 Vali Acc: 0.667 Test Loss: 1.430 Test Acc: 0.667
Validation loss decreased (-0.644429 --> -0.666652).  Saving model ...
Epoch: 11 cost time: 0.7351408004760742
Epoch: 11, Steps: 12 | Train Loss: 1.145 Vali Loss: 1.338 Vali Acc: 0.678 Test Loss: 1.338 Test Acc: 0.678
Validation loss decreased (-0.666652 --> -0.677764).  Saving model ...
Epoch: 12 cost time: 0.6666529178619385
Epoch: 12, Steps: 12 | Train Loss: 1.061 Vali Loss: 1.236 Vali Acc: 0.694 Test Loss: 1.236 Test Acc: 0.694
Validation loss decreased (-0.677764 --> -0.694432).  Saving model ...
Epoch: 13 cost time: 0.6935379505157471
Epoch: 13, Steps: 12 | Train Loss: 1.001 Vali Loss: 1.152 Vali Acc: 0.706 Test Loss: 1.152 Test Acc: 0.706
Validation loss decreased (-0.694432 --> -0.705544).  Saving model ...
Epoch: 14 cost time: 0.6714034080505371
Epoch: 14, Steps: 12 | Train Loss: 0.897 Vali Loss: 1.085 Vali Acc: 0.733 Test Loss: 1.085 Test Acc: 0.733
Validation loss decreased (-0.705544 --> -0.733322).  Saving model ...
Epoch: 15 cost time: 0.7116687297821045
Epoch: 15, Steps: 12 | Train Loss: 0.815 Vali Loss: 1.015 Vali Acc: 0.744 Test Loss: 1.015 Test Acc: 0.744
Validation loss decreased (-0.733322 --> -0.744434).  Saving model ...
Epoch: 16 cost time: 0.7113702297210693
Epoch: 16, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.988 Vali Acc: 0.750 Test Loss: 0.988 Test Acc: 0.750
Validation loss decreased (-0.744434 --> -0.749990).  Saving model ...
Epoch: 17 cost time: 0.6953682899475098
Epoch: 17, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.927 Vali Acc: 0.756 Test Loss: 0.927 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755546).  Saving model ...
Epoch: 18 cost time: 0.6908278465270996
Epoch: 18, Steps: 12 | Train Loss: 0.692 Vali Loss: 0.873 Vali Acc: 0.767 Test Loss: 0.873 Test Acc: 0.767
Validation loss decreased (-0.755546 --> -0.766658).  Saving model ...
Epoch: 19 cost time: 0.7085652351379395
Epoch: 19, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.828 Vali Acc: 0.772 Test Loss: 0.828 Test Acc: 0.772
Validation loss decreased (-0.766658 --> -0.772214).  Saving model ...
Epoch: 20 cost time: 0.717684268951416
Epoch: 20, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.814 Vali Acc: 0.778 Test Loss: 0.814 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777770).  Saving model ...
Epoch: 21 cost time: 0.734553337097168
Epoch: 21, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.769 Vali Acc: 0.783 Test Loss: 0.769 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783326).  Saving model ...
Epoch: 22 cost time: 0.7198266983032227
Epoch: 22, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.738 Vali Acc: 0.789 Test Loss: 0.738 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 23 cost time: 0.7176656723022461
Epoch: 23, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.693 Vali Acc: 0.794 Test Loss: 0.693 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794438).  Saving model ...
Epoch: 24 cost time: 0.7220396995544434
Epoch: 24, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.677 Vali Acc: 0.806 Test Loss: 0.677 Test Acc: 0.806
Validation loss decreased (-0.794438 --> -0.805549).  Saving model ...
Epoch: 25 cost time: 0.7200896739959717
Epoch: 25, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.650 Vali Acc: 0.806 Test Loss: 0.650 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805549).  Saving model ...
Epoch: 26 cost time: 0.694277286529541
Epoch: 26, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.633 Vali Acc: 0.817 Test Loss: 0.633 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816660).  Saving model ...
Epoch: 27 cost time: 0.703618049621582
Epoch: 27, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.609 Vali Acc: 0.828 Test Loss: 0.609 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827772).  Saving model ...
Epoch: 28 cost time: 0.6878137588500977
Epoch: 28, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.580 Vali Acc: 0.833 Test Loss: 0.580 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833328).  Saving model ...
Epoch: 29 cost time: 0.7327444553375244
Epoch: 29, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.576 Vali Acc: 0.839 Test Loss: 0.576 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838883).  Saving model ...
Epoch: 30 cost time: 0.723761796951294
Epoch: 30, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.571 Vali Acc: 0.844 Test Loss: 0.571 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 31 cost time: 0.7400047779083252
Epoch: 31, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.571 Vali Acc: 0.822 Test Loss: 0.571 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7286112308502197
Epoch: 32, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 33 cost time: 0.7085700035095215
Epoch: 33, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.532 Vali Acc: 0.844 Test Loss: 0.532 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6878507137298584
Epoch: 34, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.539 Vali Acc: 0.828 Test Loss: 0.539 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6817247867584229
Epoch: 35, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.516 Vali Acc: 0.844 Test Loss: 0.516 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7101020812988281
Epoch: 36, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 37 cost time: 0.6751043796539307
Epoch: 37, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855551).  Saving model ...
Epoch: 38 cost time: 0.7143344879150391
Epoch: 38, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.504 Vali Acc: 0.861 Test Loss: 0.504 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861106).  Saving model ...
Epoch: 39 cost time: 0.7449638843536377
Epoch: 39, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7271370887756348
Epoch: 40, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7372314929962158
Epoch: 41, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.492 Vali Acc: 0.856 Test Loss: 0.492 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7109062671661377
Epoch: 42, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.481 Vali Acc: 0.861 Test Loss: 0.481 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 43 cost time: 0.6795797348022461
Epoch: 43, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.484 Vali Acc: 0.856 Test Loss: 0.484 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6814224720001221
Epoch: 44, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.688950777053833
Epoch: 45, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.7201390266418457
Epoch: 46, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.498 Vali Acc: 0.856 Test Loss: 0.498 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.7132749557495117
Epoch: 47, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.505 Vali Acc: 0.872 Test Loss: 0.505 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 48 cost time: 0.7267143726348877
Epoch: 48, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.495 Vali Acc: 0.861 Test Loss: 0.495 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7514798641204834
Epoch: 49, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6970012187957764
Epoch: 50, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.450 Vali Acc: 0.883 Test Loss: 0.450 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883329).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 51919
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9970042705535889
Epoch: 1, Steps: 12 | Train Loss: 2.779 Vali Loss: 2.734 Vali Acc: 0.139 Test Loss: 2.734 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 0.69134521484375
Epoch: 2, Steps: 12 | Train Loss: 2.446 Vali Loss: 2.469 Vali Acc: 0.261 Test Loss: 2.469 Test Acc: 0.261
Validation loss decreased (-0.138862 --> -0.261086).  Saving model ...
Epoch: 3 cost time: 0.7131307125091553
Epoch: 3, Steps: 12 | Train Loss: 2.132 Vali Loss: 2.118 Vali Acc: 0.456 Test Loss: 2.118 Test Acc: 0.456
Validation loss decreased (-0.261086 --> -0.455534).  Saving model ...
Epoch: 4 cost time: 0.7298734188079834
Epoch: 4, Steps: 12 | Train Loss: 1.710 Vali Loss: 1.798 Vali Acc: 0.528 Test Loss: 1.798 Test Acc: 0.528
Validation loss decreased (-0.455534 --> -0.527760).  Saving model ...
Epoch: 5 cost time: 0.7212166786193848
Epoch: 5, Steps: 12 | Train Loss: 1.432 Vali Loss: 1.528 Vali Acc: 0.611 Test Loss: 1.528 Test Acc: 0.611
Validation loss decreased (-0.527760 --> -0.611096).  Saving model ...
Epoch: 6 cost time: 0.7342932224273682
Epoch: 6, Steps: 12 | Train Loss: 1.222 Vali Loss: 1.337 Vali Acc: 0.667 Test Loss: 1.337 Test Acc: 0.667
Validation loss decreased (-0.611096 --> -0.666653).  Saving model ...
Epoch: 7 cost time: 0.6802611351013184
Epoch: 7, Steps: 12 | Train Loss: 1.056 Vali Loss: 1.204 Vali Acc: 0.678 Test Loss: 1.204 Test Acc: 0.678
Validation loss decreased (-0.666653 --> -0.677766).  Saving model ...
Epoch: 8 cost time: 0.7031190395355225
Epoch: 8, Steps: 12 | Train Loss: 0.865 Vali Loss: 1.131 Vali Acc: 0.694 Test Loss: 1.131 Test Acc: 0.694
Validation loss decreased (-0.677766 --> -0.694433).  Saving model ...
Epoch: 9 cost time: 0.7010259628295898
Epoch: 9, Steps: 12 | Train Loss: 0.770 Vali Loss: 1.029 Vali Acc: 0.717 Test Loss: 1.029 Test Acc: 0.717
Validation loss decreased (-0.694433 --> -0.716656).  Saving model ...
Epoch: 10 cost time: 0.6519243717193604
Epoch: 10, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.956 Vali Acc: 0.733 Test Loss: 0.956 Test Acc: 0.733
Validation loss decreased (-0.716656 --> -0.733324).  Saving model ...
Epoch: 11 cost time: 0.7126915454864502
Epoch: 11, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.894 Vali Acc: 0.722 Test Loss: 0.894 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.696631669998169
Epoch: 12, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.859 Vali Acc: 0.733 Test Loss: 0.859 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733325).  Saving model ...
Epoch: 13 cost time: 0.7636837959289551
Epoch: 13, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.794 Vali Acc: 0.744 Test Loss: 0.794 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744437).  Saving model ...
Epoch: 14 cost time: 0.757439374923706
Epoch: 14, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.766 Vali Acc: 0.761 Test Loss: 0.766 Test Acc: 0.761
Validation loss decreased (-0.744437 --> -0.761103).  Saving model ...
Epoch: 15 cost time: 0.7513372898101807
Epoch: 15, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.744 Vali Acc: 0.772 Test Loss: 0.744 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772215).  Saving model ...
Epoch: 16 cost time: 0.758887767791748
Epoch: 16, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.714 Vali Acc: 0.778 Test Loss: 0.714 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777771).  Saving model ...
Epoch: 17 cost time: 0.6757400035858154
Epoch: 17, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.697 Vali Acc: 0.789 Test Loss: 0.697 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788882).  Saving model ...
Epoch: 18 cost time: 0.7075278759002686
Epoch: 18, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.674 Vali Acc: 0.800 Test Loss: 0.674 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 0.697615385055542
Epoch: 19, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.667 Vali Acc: 0.806 Test Loss: 0.667 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 20 cost time: 0.6718225479125977
Epoch: 20, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.678 Vali Acc: 0.800 Test Loss: 0.678 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6903412342071533
Epoch: 21, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.640 Vali Acc: 0.822 Test Loss: 0.640 Test Acc: 0.822
Validation loss decreased (-0.805549 --> -0.822216).  Saving model ...
Epoch: 22 cost time: 0.7189667224884033
Epoch: 22, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.644 Vali Acc: 0.817 Test Loss: 0.644 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6923675537109375
Epoch: 23, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.651 Vali Acc: 0.811 Test Loss: 0.651 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7874658107757568
Epoch: 24, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.632 Vali Acc: 0.833 Test Loss: 0.632 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 25 cost time: 0.7560956478118896
Epoch: 25, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.651 Vali Acc: 0.839 Test Loss: 0.651 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838882).  Saving model ...
Epoch: 26 cost time: 0.7423982620239258
Epoch: 26, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.623 Vali Acc: 0.822 Test Loss: 0.623 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7393887042999268
Epoch: 27, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.635 Vali Acc: 0.839 Test Loss: 0.635 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 28 cost time: 0.6942799091339111
Epoch: 28, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.623 Vali Acc: 0.833 Test Loss: 0.623 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.704838752746582
Epoch: 29, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.635 Vali Acc: 0.844 Test Loss: 0.635 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 30 cost time: 0.6986238956451416
Epoch: 30, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.637 Vali Acc: 0.844 Test Loss: 0.637 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7055709362030029
Epoch: 31, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.645 Vali Acc: 0.833 Test Loss: 0.645 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.700617790222168
Epoch: 32, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.651 Vali Acc: 0.844 Test Loss: 0.651 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.692040205001831
Epoch: 33, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.635 Vali Acc: 0.850 Test Loss: 0.635 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 34 cost time: 0.7187864780426025
Epoch: 34, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.660 Vali Acc: 0.844 Test Loss: 0.660 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7180657386779785
Epoch: 35, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.651 Vali Acc: 0.861 Test Loss: 0.651 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 36 cost time: 0.7241072654724121
Epoch: 36, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.663 Vali Acc: 0.861 Test Loss: 0.663 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.737464189529419
Epoch: 37, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.673 Vali Acc: 0.839 Test Loss: 0.673 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6619915962219238
Epoch: 38, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.689 Vali Acc: 0.856 Test Loss: 0.689 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7268795967102051
Epoch: 39, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.689 Vali Acc: 0.850 Test Loss: 0.689 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.701286792755127
Epoch: 40, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.703 Vali Acc: 0.861 Test Loss: 0.703 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6912093162536621
Epoch: 41, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.726 Vali Acc: 0.867 Test Loss: 0.726 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866659).  Saving model ...
Epoch: 42 cost time: 0.6737380027770996
Epoch: 42, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.736 Vali Acc: 0.844 Test Loss: 0.736 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6651771068572998
Epoch: 43, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.721 Vali Acc: 0.856 Test Loss: 0.721 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7017717361450195
Epoch: 44, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.738 Vali Acc: 0.850 Test Loss: 0.738 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7540080547332764
Epoch: 45, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.774 Vali Acc: 0.844 Test Loss: 0.774 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.7434883117675781
Epoch: 46, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.786 Vali Acc: 0.861 Test Loss: 0.786 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.7294793128967285
Epoch: 47, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.773 Vali Acc: 0.861 Test Loss: 0.773 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.716961145401001
Epoch: 48, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.780 Vali Acc: 0.867 Test Loss: 0.780 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.682051420211792
Epoch: 49, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.775 Vali Acc: 0.856 Test Loss: 0.775 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.7077980041503906
Epoch: 50, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.785 Vali Acc: 0.867 Test Loss: 0.785 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 53935
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8751177787780762
Epoch: 1, Steps: 12 | Train Loss: 2.751 Vali Loss: 2.669 Vali Acc: 0.061 Test Loss: 2.669 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 0.7296836376190186
Epoch: 2, Steps: 12 | Train Loss: 2.595 Vali Loss: 2.529 Vali Acc: 0.200 Test Loss: 2.529 Test Acc: 0.200
Validation loss decreased (-0.061084 --> -0.199975).  Saving model ...
Epoch: 3 cost time: 0.72623610496521
Epoch: 3, Steps: 12 | Train Loss: 2.339 Vali Loss: 2.337 Vali Acc: 0.350 Test Loss: 2.337 Test Acc: 0.350
Validation loss decreased (-0.199975 --> -0.349977).  Saving model ...
Epoch: 4 cost time: 0.6855134963989258
Epoch: 4, Steps: 12 | Train Loss: 2.087 Vali Loss: 2.132 Vali Acc: 0.461 Test Loss: 2.132 Test Acc: 0.461
Validation loss decreased (-0.349977 --> -0.461090).  Saving model ...
Epoch: 5 cost time: 0.6898353099822998
Epoch: 5, Steps: 12 | Train Loss: 1.860 Vali Loss: 1.925 Vali Acc: 0.522 Test Loss: 1.925 Test Acc: 0.522
Validation loss decreased (-0.461090 --> -0.522203).  Saving model ...
Epoch: 6 cost time: 0.71034836769104
Epoch: 6, Steps: 12 | Train Loss: 1.685 Vali Loss: 1.714 Vali Acc: 0.617 Test Loss: 1.714 Test Acc: 0.617
Validation loss decreased (-0.522203 --> -0.616650).  Saving model ...
Epoch: 7 cost time: 0.7037456035614014
Epoch: 7, Steps: 12 | Train Loss: 1.510 Vali Loss: 1.566 Vali Acc: 0.628 Test Loss: 1.566 Test Acc: 0.628
Validation loss decreased (-0.616650 --> -0.627762).  Saving model ...
Epoch: 8 cost time: 0.6716454029083252
Epoch: 8, Steps: 12 | Train Loss: 1.352 Vali Loss: 1.432 Vali Acc: 0.661 Test Loss: 1.432 Test Acc: 0.661
Validation loss decreased (-0.627762 --> -0.661097).  Saving model ...
Epoch: 9 cost time: 0.7247838973999023
Epoch: 9, Steps: 12 | Train Loss: 1.149 Vali Loss: 1.330 Vali Acc: 0.667 Test Loss: 1.330 Test Acc: 0.667
Validation loss decreased (-0.661097 --> -0.666653).  Saving model ...
Epoch: 10 cost time: 0.6800491809844971
Epoch: 10, Steps: 12 | Train Loss: 1.050 Vali Loss: 1.245 Vali Acc: 0.672 Test Loss: 1.245 Test Acc: 0.672
Validation loss decreased (-0.666653 --> -0.672210).  Saving model ...
Epoch: 11 cost time: 0.716266393661499
Epoch: 11, Steps: 12 | Train Loss: 0.928 Vali Loss: 1.171 Vali Acc: 0.694 Test Loss: 1.171 Test Acc: 0.694
Validation loss decreased (-0.672210 --> -0.694433).  Saving model ...
Epoch: 12 cost time: 0.7061195373535156
Epoch: 12, Steps: 12 | Train Loss: 0.908 Vali Loss: 1.102 Vali Acc: 0.694 Test Loss: 1.102 Test Acc: 0.694
Validation loss decreased (-0.694433 --> -0.694433).  Saving model ...
Epoch: 13 cost time: 0.7160229682922363
Epoch: 13, Steps: 12 | Train Loss: 0.769 Vali Loss: 1.032 Vali Acc: 0.717 Test Loss: 1.032 Test Acc: 0.717
Validation loss decreased (-0.694433 --> -0.716656).  Saving model ...
Epoch: 14 cost time: 0.7419273853302002
Epoch: 14, Steps: 12 | Train Loss: 0.764 Vali Loss: 0.986 Vali Acc: 0.711 Test Loss: 0.986 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7097041606903076
Epoch: 15, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.943 Vali Acc: 0.711 Test Loss: 0.943 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7198445796966553
Epoch: 16, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.909 Vali Acc: 0.711 Test Loss: 0.909 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6825258731842041
Epoch: 17, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.883 Vali Acc: 0.744 Test Loss: 0.883 Test Acc: 0.744
Validation loss decreased (-0.716656 --> -0.744436).  Saving model ...
Epoch: 18 cost time: 0.696854829788208
Epoch: 18, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.854 Vali Acc: 0.756 Test Loss: 0.854 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755547).  Saving model ...
Epoch: 19 cost time: 0.6966962814331055
Epoch: 19, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.819 Vali Acc: 0.739 Test Loss: 0.819 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6873531341552734
Epoch: 20, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.792 Vali Acc: 0.783 Test Loss: 0.792 Test Acc: 0.783
Validation loss decreased (-0.755547 --> -0.783325).  Saving model ...
Epoch: 21 cost time: 0.7122492790222168
Epoch: 21, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.784 Vali Acc: 0.750 Test Loss: 0.784 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7404210567474365
Epoch: 22, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.753 Vali Acc: 0.767 Test Loss: 0.753 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7190380096435547
Epoch: 23, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.742 Vali Acc: 0.789 Test Loss: 0.742 Test Acc: 0.789
Validation loss decreased (-0.783325 --> -0.788881).  Saving model ...
Epoch: 24 cost time: 0.768230676651001
Epoch: 24, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.740 Vali Acc: 0.794 Test Loss: 0.740 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794437).  Saving model ...
Epoch: 25 cost time: 0.6995737552642822
Epoch: 25, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.689 Vali Acc: 0.833 Test Loss: 0.689 Test Acc: 0.833
Validation loss decreased (-0.794437 --> -0.833326).  Saving model ...
Epoch: 26 cost time: 0.6895248889923096
Epoch: 26, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.671 Vali Acc: 0.839 Test Loss: 0.671 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838882).  Saving model ...
Epoch: 27 cost time: 0.7772543430328369
Epoch: 27, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.675 Vali Acc: 0.817 Test Loss: 0.675 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.640610933303833
Epoch: 28, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.665 Vali Acc: 0.817 Test Loss: 0.665 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7123227119445801
Epoch: 29, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.652 Vali Acc: 0.833 Test Loss: 0.652 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6955888271331787
Epoch: 30, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.642 Vali Acc: 0.844 Test Loss: 0.642 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 31 cost time: 0.6875853538513184
Epoch: 31, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.644 Vali Acc: 0.833 Test Loss: 0.644 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.790386438369751
Epoch: 32, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.642 Vali Acc: 0.839 Test Loss: 0.642 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7380344867706299
Epoch: 33, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.653 Vali Acc: 0.828 Test Loss: 0.653 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7196388244628906
Epoch: 34, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.634 Vali Acc: 0.844 Test Loss: 0.634 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 35 cost time: 0.7164046764373779
Epoch: 35, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.638 Vali Acc: 0.839 Test Loss: 0.638 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7429330348968506
Epoch: 36, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.625 Vali Acc: 0.833 Test Loss: 0.625 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6836600303649902
Epoch: 37, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.616 Vali Acc: 0.833 Test Loss: 0.616 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7044997215270996
Epoch: 38, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.637 Vali Acc: 0.844 Test Loss: 0.637 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7112300395965576
Epoch: 39, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.642 Vali Acc: 0.872 Test Loss: 0.642 Test Acc: 0.872
Validation loss decreased (-0.844438 --> -0.872216).  Saving model ...
Epoch: 40 cost time: 0.6874368190765381
Epoch: 40, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.619 Vali Acc: 0.833 Test Loss: 0.619 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6956672668457031
Epoch: 41, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.621 Vali Acc: 0.856 Test Loss: 0.621 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7397568225860596
Epoch: 42, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.631 Vali Acc: 0.844 Test Loss: 0.631 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7781281471252441
Epoch: 43, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.619 Vali Acc: 0.822 Test Loss: 0.619 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7832121849060059
Epoch: 44, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.635 Vali Acc: 0.844 Test Loss: 0.635 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.7368087768554688
Epoch: 45, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.631 Vali Acc: 0.850 Test Loss: 0.631 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7166469097137451
Epoch: 46, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.647 Vali Acc: 0.844 Test Loss: 0.647 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.6923599243164062
Epoch: 47, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.677 Vali Acc: 0.839 Test Loss: 0.677 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.6075327396392822
Epoch: 48, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.653 Vali Acc: 0.828 Test Loss: 0.653 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.6682813167572021
Epoch: 49, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.637 Vali Acc: 0.844 Test Loss: 0.637 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 31887
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8719308376312256
Epoch: 1, Steps: 12 | Train Loss: 2.803 Vali Loss: 2.754 Vali Acc: 0.050 Test Loss: 2.754 Test Acc: 0.050
Validation loss decreased (inf --> -0.049972).  Saving model ...
Epoch: 2 cost time: 0.792504072189331
Epoch: 2, Steps: 12 | Train Loss: 2.665 Vali Loss: 2.610 Vali Acc: 0.128 Test Loss: 2.610 Test Acc: 0.128
Validation loss decreased (-0.049972 --> -0.127752).  Saving model ...
Epoch: 3 cost time: 0.6920452117919922
Epoch: 3, Steps: 12 | Train Loss: 2.459 Vali Loss: 2.392 Vali Acc: 0.283 Test Loss: 2.392 Test Acc: 0.283
Validation loss decreased (-0.127752 --> -0.283309).  Saving model ...
Epoch: 4 cost time: 0.7121860980987549
Epoch: 4, Steps: 12 | Train Loss: 2.171 Vali Loss: 2.136 Vali Acc: 0.417 Test Loss: 2.136 Test Acc: 0.417
Validation loss decreased (-0.283309 --> -0.416645).  Saving model ...
Epoch: 5 cost time: 0.7279200553894043
Epoch: 5, Steps: 12 | Train Loss: 1.920 Vali Loss: 1.908 Vali Acc: 0.483 Test Loss: 1.908 Test Acc: 0.483
Validation loss decreased (-0.416645 --> -0.483314).  Saving model ...
Epoch: 6 cost time: 0.7521402835845947
Epoch: 6, Steps: 12 | Train Loss: 1.657 Vali Loss: 1.724 Vali Acc: 0.572 Test Loss: 1.724 Test Acc: 0.572
Validation loss decreased (-0.483314 --> -0.572205).  Saving model ...
Epoch: 7 cost time: 0.7007119655609131
Epoch: 7, Steps: 12 | Train Loss: 1.471 Vali Loss: 1.561 Vali Acc: 0.606 Test Loss: 1.561 Test Acc: 0.606
Validation loss decreased (-0.572205 --> -0.605540).  Saving model ...
Epoch: 8 cost time: 0.750316858291626
Epoch: 8, Steps: 12 | Train Loss: 1.344 Vali Loss: 1.417 Vali Acc: 0.650 Test Loss: 1.417 Test Acc: 0.650
Validation loss decreased (-0.605540 --> -0.649986).  Saving model ...
Epoch: 9 cost time: 0.7063279151916504
Epoch: 9, Steps: 12 | Train Loss: 1.137 Vali Loss: 1.297 Vali Acc: 0.656 Test Loss: 1.297 Test Acc: 0.656
Validation loss decreased (-0.649986 --> -0.655543).  Saving model ...
Epoch: 10 cost time: 0.7176918983459473
Epoch: 10, Steps: 12 | Train Loss: 1.094 Vali Loss: 1.210 Vali Acc: 0.694 Test Loss: 1.210 Test Acc: 0.694
Validation loss decreased (-0.655543 --> -0.694432).  Saving model ...
Epoch: 11 cost time: 0.7647161483764648
Epoch: 11, Steps: 12 | Train Loss: 0.938 Vali Loss: 1.138 Vali Acc: 0.700 Test Loss: 1.138 Test Acc: 0.700
Validation loss decreased (-0.694432 --> -0.699989).  Saving model ...
Epoch: 12 cost time: 0.6715283393859863
Epoch: 12, Steps: 12 | Train Loss: 0.808 Vali Loss: 1.080 Vali Acc: 0.700 Test Loss: 1.080 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 13 cost time: 0.7324988842010498
Epoch: 13, Steps: 12 | Train Loss: 0.712 Vali Loss: 1.028 Vali Acc: 0.728 Test Loss: 1.028 Test Acc: 0.728
Validation loss decreased (-0.699989 --> -0.727768).  Saving model ...
Epoch: 14 cost time: 0.6970508098602295
Epoch: 14, Steps: 12 | Train Loss: 0.683 Vali Loss: 0.982 Vali Acc: 0.733 Test Loss: 0.982 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733324).  Saving model ...
Epoch: 15 cost time: 0.6564915180206299
Epoch: 15, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.935 Vali Acc: 0.733 Test Loss: 0.935 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 16 cost time: 0.6821608543395996
Epoch: 16, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.895 Vali Acc: 0.767 Test Loss: 0.895 Test Acc: 0.767
Validation loss decreased (-0.733324 --> -0.766658).  Saving model ...
Epoch: 17 cost time: 0.6823573112487793
Epoch: 17, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.866 Vali Acc: 0.744 Test Loss: 0.866 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.66550612449646
Epoch: 18, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.827 Vali Acc: 0.750 Test Loss: 0.827 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7203202247619629
Epoch: 19, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.801 Vali Acc: 0.767 Test Loss: 0.801 Test Acc: 0.767
Validation loss decreased (-0.766658 --> -0.766659).  Saving model ...
Epoch: 20 cost time: 0.7390952110290527
Epoch: 20, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.803 Vali Acc: 0.767 Test Loss: 0.803 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7572882175445557
Epoch: 21, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.750 Vali Acc: 0.789 Test Loss: 0.750 Test Acc: 0.789
Validation loss decreased (-0.766659 --> -0.788881).  Saving model ...
Epoch: 22 cost time: 0.732708215713501
Epoch: 22, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.718 Vali Acc: 0.783 Test Loss: 0.718 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7015807628631592
Epoch: 23, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.720 Vali Acc: 0.806 Test Loss: 0.720 Test Acc: 0.806
Validation loss decreased (-0.788881 --> -0.805548).  Saving model ...
Epoch: 24 cost time: 0.7199649810791016
Epoch: 24, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.704 Vali Acc: 0.800 Test Loss: 0.704 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6947941780090332
Epoch: 25, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.673 Vali Acc: 0.817 Test Loss: 0.673 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816660).  Saving model ...
Epoch: 26 cost time: 0.6768617630004883
Epoch: 26, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.654 Vali Acc: 0.806 Test Loss: 0.654 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6734957695007324
Epoch: 27, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.654 Vali Acc: 0.822 Test Loss: 0.654 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 28 cost time: 0.678668737411499
Epoch: 28, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.652 Vali Acc: 0.833 Test Loss: 0.652 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 29 cost time: 0.6440181732177734
Epoch: 29, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.650 Vali Acc: 0.811 Test Loss: 0.650 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6902365684509277
Epoch: 30, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.638 Vali Acc: 0.822 Test Loss: 0.638 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7213397026062012
Epoch: 31, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.631 Vali Acc: 0.828 Test Loss: 0.631 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6960055828094482
Epoch: 32, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.608 Vali Acc: 0.833 Test Loss: 0.608 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 33 cost time: 0.7212743759155273
Epoch: 33, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.594 Vali Acc: 0.839 Test Loss: 0.594 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 34 cost time: 0.7126948833465576
Epoch: 34, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.610 Vali Acc: 0.817 Test Loss: 0.610 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6611461639404297
Epoch: 35, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.615 Vali Acc: 0.844 Test Loss: 0.615 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 36 cost time: 0.7016115188598633
Epoch: 36, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.591 Vali Acc: 0.822 Test Loss: 0.591 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6782863140106201
Epoch: 37, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.590 Vali Acc: 0.844 Test Loss: 0.590 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844439).  Saving model ...
Epoch: 38 cost time: 0.6855006217956543
Epoch: 38, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.589 Vali Acc: 0.839 Test Loss: 0.589 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6938900947570801
Epoch: 39, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.588 Vali Acc: 0.833 Test Loss: 0.588 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7400157451629639
Epoch: 40, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.626 Vali Acc: 0.844 Test Loss: 0.626 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7087695598602295
Epoch: 41, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.612 Vali Acc: 0.839 Test Loss: 0.612 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7346739768981934
Epoch: 42, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.626 Vali Acc: 0.839 Test Loss: 0.626 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7194063663482666
Epoch: 43, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.639 Vali Acc: 0.850 Test Loss: 0.639 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 44 cost time: 0.7199225425720215
Epoch: 44, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.618 Vali Acc: 0.839 Test Loss: 0.618 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6894724369049072
Epoch: 45, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.611 Vali Acc: 0.833 Test Loss: 0.611 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6931760311126709
Epoch: 46, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.629 Vali Acc: 0.850 Test Loss: 0.629 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 47 cost time: 0.6876463890075684
Epoch: 47, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.659 Vali Acc: 0.844 Test Loss: 0.659 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6764161586761475
Epoch: 48, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.647 Vali Acc: 0.844 Test Loss: 0.647 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7085399627685547
Epoch: 49, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.672 Vali Acc: 0.856 Test Loss: 0.672 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 50 cost time: 0.7159686088562012
Epoch: 50, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.671 Vali Acc: 0.844 Test Loss: 0.671 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 31919
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8031291961669922
Epoch: 1, Steps: 12 | Train Loss: 2.745 Vali Loss: 2.686 Vali Acc: 0.072 Test Loss: 2.686 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 0.6954340934753418
Epoch: 2, Steps: 12 | Train Loss: 2.651 Vali Loss: 2.580 Vali Acc: 0.178 Test Loss: 2.580 Test Acc: 0.178
Validation loss decreased (-0.072195 --> -0.177752).  Saving model ...
Epoch: 3 cost time: 0.7284536361694336
Epoch: 3, Steps: 12 | Train Loss: 2.481 Vali Loss: 2.438 Vali Acc: 0.272 Test Loss: 2.438 Test Acc: 0.272
Validation loss decreased (-0.177752 --> -0.272198).  Saving model ...
Epoch: 4 cost time: 0.6986274719238281
Epoch: 4, Steps: 12 | Train Loss: 2.270 Vali Loss: 2.265 Vali Acc: 0.356 Test Loss: 2.265 Test Acc: 0.356
Validation loss decreased (-0.272198 --> -0.355533).  Saving model ...
Epoch: 5 cost time: 0.702498197555542
Epoch: 5, Steps: 12 | Train Loss: 2.083 Vali Loss: 2.091 Vali Acc: 0.478 Test Loss: 2.091 Test Acc: 0.478
Validation loss decreased (-0.355533 --> -0.477757).  Saving model ...
Epoch: 6 cost time: 0.6818501949310303
Epoch: 6, Steps: 12 | Train Loss: 1.943 Vali Loss: 1.924 Vali Acc: 0.544 Test Loss: 1.924 Test Acc: 0.544
Validation loss decreased (-0.477757 --> -0.544425).  Saving model ...
Epoch: 7 cost time: 0.7340729236602783
Epoch: 7, Steps: 12 | Train Loss: 1.699 Vali Loss: 1.785 Vali Acc: 0.611 Test Loss: 1.785 Test Acc: 0.611
Validation loss decreased (-0.544425 --> -0.611093).  Saving model ...
Epoch: 8 cost time: 0.7491071224212646
Epoch: 8, Steps: 12 | Train Loss: 1.550 Vali Loss: 1.664 Vali Acc: 0.606 Test Loss: 1.664 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7027873992919922
Epoch: 9, Steps: 12 | Train Loss: 1.427 Vali Loss: 1.558 Vali Acc: 0.628 Test Loss: 1.558 Test Acc: 0.628
Validation loss decreased (-0.611093 --> -0.627762).  Saving model ...
Epoch: 10 cost time: 0.6990478038787842
Epoch: 10, Steps: 12 | Train Loss: 1.275 Vali Loss: 1.457 Vali Acc: 0.633 Test Loss: 1.457 Test Acc: 0.633
Validation loss decreased (-0.627762 --> -0.633319).  Saving model ...
Epoch: 11 cost time: 0.6584815979003906
Epoch: 11, Steps: 12 | Train Loss: 1.166 Vali Loss: 1.360 Vali Acc: 0.656 Test Loss: 1.360 Test Acc: 0.656
Validation loss decreased (-0.633319 --> -0.655542).  Saving model ...
Epoch: 12 cost time: 0.6701023578643799
Epoch: 12, Steps: 12 | Train Loss: 1.093 Vali Loss: 1.296 Vali Acc: 0.667 Test Loss: 1.296 Test Acc: 0.667
Validation loss decreased (-0.655542 --> -0.666654).  Saving model ...
Epoch: 13 cost time: 0.6892964839935303
Epoch: 13, Steps: 12 | Train Loss: 1.039 Vali Loss: 1.211 Vali Acc: 0.667 Test Loss: 1.211 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666655).  Saving model ...
Epoch: 14 cost time: 0.6959950923919678
Epoch: 14, Steps: 12 | Train Loss: 0.932 Vali Loss: 1.152 Vali Acc: 0.667 Test Loss: 1.152 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 15 cost time: 0.7013673782348633
Epoch: 15, Steps: 12 | Train Loss: 0.852 Vali Loss: 1.120 Vali Acc: 0.711 Test Loss: 1.120 Test Acc: 0.711
Validation loss decreased (-0.666655 --> -0.711100).  Saving model ...
Epoch: 16 cost time: 0.697188138961792
Epoch: 16, Steps: 12 | Train Loss: 0.821 Vali Loss: 1.054 Vali Acc: 0.700 Test Loss: 1.054 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6859021186828613
Epoch: 17, Steps: 12 | Train Loss: 0.725 Vali Loss: 1.019 Vali Acc: 0.728 Test Loss: 1.019 Test Acc: 0.728
Validation loss decreased (-0.711100 --> -0.727768).  Saving model ...
Epoch: 18 cost time: 0.7124154567718506
Epoch: 18, Steps: 12 | Train Loss: 0.693 Vali Loss: 0.965 Vali Acc: 0.733 Test Loss: 0.965 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733324).  Saving model ...
Epoch: 19 cost time: 0.7322311401367188
Epoch: 19, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.938 Vali Acc: 0.744 Test Loss: 0.938 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744435).  Saving model ...
Epoch: 20 cost time: 0.7567248344421387
Epoch: 20, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.909 Vali Acc: 0.761 Test Loss: 0.909 Test Acc: 0.761
Validation loss decreased (-0.744435 --> -0.761102).  Saving model ...
Epoch: 21 cost time: 0.7178843021392822
Epoch: 21, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.872 Vali Acc: 0.756 Test Loss: 0.872 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7851724624633789
Epoch: 22, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.830 Vali Acc: 0.772 Test Loss: 0.830 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772214).  Saving model ...
Epoch: 23 cost time: 0.692737340927124
Epoch: 23, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.787 Vali Acc: 0.778 Test Loss: 0.787 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777770).  Saving model ...
Epoch: 24 cost time: 0.6847708225250244
Epoch: 24, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.770 Vali Acc: 0.778 Test Loss: 0.770 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777770).  Saving model ...
Epoch: 25 cost time: 0.7078430652618408
Epoch: 25, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.754 Vali Acc: 0.800 Test Loss: 0.754 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799992).  Saving model ...
Epoch: 26 cost time: 0.691295862197876
Epoch: 26, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.726 Vali Acc: 0.822 Test Loss: 0.726 Test Acc: 0.822
Validation loss decreased (-0.799992 --> -0.822215).  Saving model ...
Epoch: 27 cost time: 0.6800251007080078
Epoch: 27, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.692 Vali Acc: 0.817 Test Loss: 0.692 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7385027408599854
Epoch: 28, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.677 Vali Acc: 0.806 Test Loss: 0.677 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6790928840637207
Epoch: 29, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.658 Vali Acc: 0.833 Test Loss: 0.658 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 30 cost time: 0.7269532680511475
Epoch: 30, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.640 Vali Acc: 0.828 Test Loss: 0.640 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7360994815826416
Epoch: 31, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.644 Vali Acc: 0.822 Test Loss: 0.644 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7335469722747803
Epoch: 32, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.626 Vali Acc: 0.844 Test Loss: 0.626 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 33 cost time: 0.7442073822021484
Epoch: 33, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.608 Vali Acc: 0.850 Test Loss: 0.608 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 34 cost time: 0.7015948295593262
Epoch: 34, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.601 Vali Acc: 0.850 Test Loss: 0.601 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 35 cost time: 0.6801345348358154
Epoch: 35, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.591 Vali Acc: 0.850 Test Loss: 0.591 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 36 cost time: 0.7181851863861084
Epoch: 36, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.588 Vali Acc: 0.844 Test Loss: 0.588 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7017886638641357
Epoch: 37, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 38 cost time: 0.7567112445831299
Epoch: 38, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.577 Vali Acc: 0.856 Test Loss: 0.577 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 39 cost time: 0.7176082134246826
Epoch: 39, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.575 Vali Acc: 0.850 Test Loss: 0.575 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7418291568756104
Epoch: 40, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.578 Vali Acc: 0.844 Test Loss: 0.578 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7171287536621094
Epoch: 41, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.581 Vali Acc: 0.844 Test Loss: 0.581 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6878845691680908
Epoch: 42, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.576 Vali Acc: 0.839 Test Loss: 0.576 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.7048108577728271
Epoch: 43, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.581 Vali Acc: 0.856 Test Loss: 0.581 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.7084317207336426
Epoch: 44, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.593 Vali Acc: 0.844 Test Loss: 0.593 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.7280421257019043
Epoch: 45, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.570 Vali Acc: 0.844 Test Loss: 0.570 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.6610391139984131
Epoch: 46, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.565 Vali Acc: 0.861 Test Loss: 0.565 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 47 cost time: 0.6891257762908936
Epoch: 47, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.569 Vali Acc: 0.856 Test Loss: 0.569 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7192697525024414
Epoch: 48, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.564 Vali Acc: 0.872 Test Loss: 0.564 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872217).  Saving model ...
Epoch: 49 cost time: 0.637415885925293
Epoch: 49, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.596 Vali Acc: 0.861 Test Loss: 0.596 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7086741924285889
Epoch: 50, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.583 Vali Acc: 0.856 Test Loss: 0.583 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 25231
model size : 0.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0329887866973877
Epoch: 1, Steps: 12 | Train Loss: 2.812 Vali Loss: 2.783 Vali Acc: 0.122 Test Loss: 2.783 Test Acc: 0.122
Validation loss decreased (inf --> -0.122194).  Saving model ...
Epoch: 2 cost time: 0.7535715103149414
Epoch: 2, Steps: 12 | Train Loss: 2.773 Vali Loss: 2.719 Vali Acc: 0.133 Test Loss: 2.719 Test Acc: 0.133
Validation loss decreased (-0.122194 --> -0.133306).  Saving model ...
Epoch: 3 cost time: 0.7257163524627686
Epoch: 3, Steps: 12 | Train Loss: 2.625 Vali Loss: 2.600 Vali Acc: 0.156 Test Loss: 2.600 Test Acc: 0.156
Validation loss decreased (-0.133306 --> -0.155530).  Saving model ...
Epoch: 4 cost time: 0.738379716873169
Epoch: 4, Steps: 12 | Train Loss: 2.488 Vali Loss: 2.457 Vali Acc: 0.217 Test Loss: 2.457 Test Acc: 0.217
Validation loss decreased (-0.155530 --> -0.216642).  Saving model ...
Epoch: 5 cost time: 0.7155673503875732
Epoch: 5, Steps: 12 | Train Loss: 2.343 Vali Loss: 2.315 Vali Acc: 0.306 Test Loss: 2.315 Test Acc: 0.306
Validation loss decreased (-0.216642 --> -0.305532).  Saving model ...
Epoch: 6 cost time: 0.697007417678833
Epoch: 6, Steps: 12 | Train Loss: 2.161 Vali Loss: 2.155 Vali Acc: 0.411 Test Loss: 2.155 Test Acc: 0.411
Validation loss decreased (-0.305532 --> -0.411090).  Saving model ...
Epoch: 7 cost time: 0.6541121006011963
Epoch: 7, Steps: 12 | Train Loss: 1.997 Vali Loss: 2.007 Vali Acc: 0.494 Test Loss: 2.007 Test Acc: 0.494
Validation loss decreased (-0.411090 --> -0.494424).  Saving model ...
Epoch: 8 cost time: 0.6977980136871338
Epoch: 8, Steps: 12 | Train Loss: 1.839 Vali Loss: 1.880 Vali Acc: 0.583 Test Loss: 1.880 Test Acc: 0.583
Validation loss decreased (-0.494424 --> -0.583315).  Saving model ...
Epoch: 9 cost time: 0.7270874977111816
Epoch: 9, Steps: 12 | Train Loss: 1.684 Vali Loss: 1.751 Vali Acc: 0.617 Test Loss: 1.751 Test Acc: 0.617
Validation loss decreased (-0.583315 --> -0.616649).  Saving model ...
Epoch: 10 cost time: 0.6895275115966797
Epoch: 10, Steps: 12 | Train Loss: 1.519 Vali Loss: 1.643 Vali Acc: 0.650 Test Loss: 1.643 Test Acc: 0.650
Validation loss decreased (-0.616649 --> -0.649984).  Saving model ...
Epoch: 11 cost time: 0.6960129737854004
Epoch: 11, Steps: 12 | Train Loss: 1.425 Vali Loss: 1.542 Vali Acc: 0.678 Test Loss: 1.542 Test Acc: 0.678
Validation loss decreased (-0.649984 --> -0.677762).  Saving model ...
Epoch: 12 cost time: 0.7270963191986084
Epoch: 12, Steps: 12 | Train Loss: 1.316 Vali Loss: 1.450 Vali Acc: 0.661 Test Loss: 1.450 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7280519008636475
Epoch: 13, Steps: 12 | Train Loss: 1.199 Vali Loss: 1.361 Vali Acc: 0.672 Test Loss: 1.361 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7343368530273438
Epoch: 14, Steps: 12 | Train Loss: 1.133 Vali Loss: 1.291 Vali Acc: 0.672 Test Loss: 1.291 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7071106433868408
Epoch: 15, Steps: 12 | Train Loss: 0.992 Vali Loss: 1.244 Vali Acc: 0.672 Test Loss: 1.244 Test Acc: 0.672
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6656007766723633
Epoch: 16, Steps: 12 | Train Loss: 0.964 Vali Loss: 1.182 Vali Acc: 0.683 Test Loss: 1.182 Test Acc: 0.683
Validation loss decreased (-0.677762 --> -0.683322).  Saving model ...
Epoch: 17 cost time: 0.6763226985931396
Epoch: 17, Steps: 12 | Train Loss: 0.871 Vali Loss: 1.133 Vali Acc: 0.694 Test Loss: 1.133 Test Acc: 0.694
Validation loss decreased (-0.683322 --> -0.694433).  Saving model ...
Epoch: 18 cost time: 0.6961724758148193
Epoch: 18, Steps: 12 | Train Loss: 0.814 Vali Loss: 1.081 Vali Acc: 0.689 Test Loss: 1.081 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6472597122192383
Epoch: 19, Steps: 12 | Train Loss: 0.810 Vali Loss: 1.028 Vali Acc: 0.711 Test Loss: 1.028 Test Acc: 0.711
Validation loss decreased (-0.694433 --> -0.711101).  Saving model ...
Epoch: 20 cost time: 0.6885137557983398
Epoch: 20, Steps: 12 | Train Loss: 0.720 Vali Loss: 0.991 Vali Acc: 0.706 Test Loss: 0.991 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6694624423980713
Epoch: 21, Steps: 12 | Train Loss: 0.680 Vali Loss: 0.945 Vali Acc: 0.728 Test Loss: 0.945 Test Acc: 0.728
Validation loss decreased (-0.711101 --> -0.727768).  Saving model ...
Epoch: 22 cost time: 0.6731374263763428
Epoch: 22, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.927 Vali Acc: 0.739 Test Loss: 0.927 Test Acc: 0.739
Validation loss decreased (-0.727768 --> -0.738880).  Saving model ...
Epoch: 23 cost time: 0.7673318386077881
Epoch: 23, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.882 Vali Acc: 0.744 Test Loss: 0.882 Test Acc: 0.744
Validation loss decreased (-0.738880 --> -0.744436).  Saving model ...
Epoch: 24 cost time: 0.7021629810333252
Epoch: 24, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.843 Vali Acc: 0.750 Test Loss: 0.843 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749992).  Saving model ...
Epoch: 25 cost time: 0.7044305801391602
Epoch: 25, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.827 Vali Acc: 0.756 Test Loss: 0.827 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755547).  Saving model ...
Epoch: 26 cost time: 0.7141447067260742
Epoch: 26, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.808 Vali Acc: 0.761 Test Loss: 0.808 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 27 cost time: 0.6472997665405273
Epoch: 27, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.776 Vali Acc: 0.767 Test Loss: 0.776 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766659).  Saving model ...
Epoch: 28 cost time: 0.6175022125244141
Epoch: 28, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.772 Vali Acc: 0.772 Test Loss: 0.772 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772214).  Saving model ...
Epoch: 29 cost time: 0.6737949848175049
Epoch: 29, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.745 Vali Acc: 0.772 Test Loss: 0.745 Test Acc: 0.772
Validation loss decreased (-0.772214 --> -0.772215).  Saving model ...
Epoch: 30 cost time: 0.6744112968444824
Epoch: 30, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.710 Vali Acc: 0.789 Test Loss: 0.710 Test Acc: 0.789
Validation loss decreased (-0.772215 --> -0.788882).  Saving model ...
Epoch: 31 cost time: 0.6564316749572754
Epoch: 31, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.686 Vali Acc: 0.811 Test Loss: 0.686 Test Acc: 0.811
Validation loss decreased (-0.788882 --> -0.811104).  Saving model ...
Epoch: 32 cost time: 0.7313778400421143
Epoch: 32, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.715 Vali Acc: 0.817 Test Loss: 0.715 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 33 cost time: 0.7191650867462158
Epoch: 33, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.682 Vali Acc: 0.806 Test Loss: 0.682 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7125856876373291
Epoch: 34, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.644 Vali Acc: 0.839 Test Loss: 0.644 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838882).  Saving model ...
Epoch: 35 cost time: 0.7061004638671875
Epoch: 35, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.634 Vali Acc: 0.833 Test Loss: 0.634 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7235546112060547
Epoch: 36, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.647 Vali Acc: 0.822 Test Loss: 0.647 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7016687393188477
Epoch: 37, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.624 Vali Acc: 0.828 Test Loss: 0.624 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7065045833587646
Epoch: 38, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.606 Vali Acc: 0.839 Test Loss: 0.606 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 39 cost time: 0.6854419708251953
Epoch: 39, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.605 Vali Acc: 0.839 Test Loss: 0.605 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 40 cost time: 0.729259729385376
Epoch: 40, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.587 Vali Acc: 0.839 Test Loss: 0.587 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 41 cost time: 0.6956174373626709
Epoch: 41, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.615 Vali Acc: 0.828 Test Loss: 0.615 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7027952671051025
Epoch: 42, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.602 Vali Acc: 0.828 Test Loss: 0.602 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6539714336395264
Epoch: 43, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.571 Vali Acc: 0.839 Test Loss: 0.571 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 44 cost time: 0.7325174808502197
Epoch: 44, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.570 Vali Acc: 0.839 Test Loss: 0.570 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 45 cost time: 0.6935575008392334
Epoch: 45, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.597 Vali Acc: 0.833 Test Loss: 0.597 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7295567989349365
Epoch: 46, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.608 Vali Acc: 0.850 Test Loss: 0.608 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 47 cost time: 0.7252480983734131
Epoch: 47, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.573 Vali Acc: 0.850 Test Loss: 0.573 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 48 cost time: 0.6880357265472412
Epoch: 48, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.575 Vali Acc: 0.833 Test Loss: 0.575 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7132861614227295
Epoch: 49, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.568 Vali Acc: 0.839 Test Loss: 0.568 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.709723711013794
Epoch: 50, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.581 Vali Acc: 0.839 Test Loss: 0.581 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.85
model parameter : 21455
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8973114490509033
Epoch: 1, Steps: 12 | Train Loss: 2.750 Vali Loss: 2.742 Vali Acc: 0.056 Test Loss: 2.742 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 0.7300770282745361
Epoch: 2, Steps: 12 | Train Loss: 2.711 Vali Loss: 2.693 Vali Acc: 0.111 Test Loss: 2.693 Test Acc: 0.111
Validation loss decreased (-0.055528 --> -0.111084).  Saving model ...
Epoch: 3 cost time: 0.6884913444519043
Epoch: 3, Steps: 12 | Train Loss: 2.604 Vali Loss: 2.600 Vali Acc: 0.178 Test Loss: 2.600 Test Acc: 0.178
Validation loss decreased (-0.111084 --> -0.177752).  Saving model ...
Epoch: 4 cost time: 0.6911885738372803
Epoch: 4, Steps: 12 | Train Loss: 2.477 Vali Loss: 2.486 Vali Acc: 0.300 Test Loss: 2.486 Test Acc: 0.300
Validation loss decreased (-0.177752 --> -0.299975).  Saving model ...
Epoch: 5 cost time: 0.6760993003845215
Epoch: 5, Steps: 12 | Train Loss: 2.373 Vali Loss: 2.354 Vali Acc: 0.356 Test Loss: 2.354 Test Acc: 0.356
Validation loss decreased (-0.299975 --> -0.355532).  Saving model ...
Epoch: 6 cost time: 0.7352943420410156
Epoch: 6, Steps: 12 | Train Loss: 2.221 Vali Loss: 2.225 Vali Acc: 0.394 Test Loss: 2.225 Test Acc: 0.394
Validation loss decreased (-0.355532 --> -0.394422).  Saving model ...
Epoch: 7 cost time: 0.6486148834228516
Epoch: 7, Steps: 12 | Train Loss: 2.060 Vali Loss: 2.110 Vali Acc: 0.450 Test Loss: 2.110 Test Acc: 0.450
Validation loss decreased (-0.394422 --> -0.449979).  Saving model ...
Epoch: 8 cost time: 0.6904439926147461
Epoch: 8, Steps: 12 | Train Loss: 1.905 Vali Loss: 1.977 Vali Acc: 0.478 Test Loss: 1.977 Test Acc: 0.478
Validation loss decreased (-0.449979 --> -0.477758).  Saving model ...
Epoch: 9 cost time: 0.6914694309234619
Epoch: 9, Steps: 12 | Train Loss: 1.770 Vali Loss: 1.877 Vali Acc: 0.528 Test Loss: 1.877 Test Acc: 0.528
Validation loss decreased (-0.477758 --> -0.527759).  Saving model ...
Epoch: 10 cost time: 0.7496089935302734
Epoch: 10, Steps: 12 | Train Loss: 1.650 Vali Loss: 1.763 Vali Acc: 0.561 Test Loss: 1.763 Test Acc: 0.561
Validation loss decreased (-0.527759 --> -0.561093).  Saving model ...
Epoch: 11 cost time: 0.7284331321716309
Epoch: 11, Steps: 12 | Train Loss: 1.558 Vali Loss: 1.669 Vali Acc: 0.578 Test Loss: 1.669 Test Acc: 0.578
Validation loss decreased (-0.561093 --> -0.577761).  Saving model ...
Epoch: 12 cost time: 0.7214417457580566
Epoch: 12, Steps: 12 | Train Loss: 1.438 Vali Loss: 1.579 Vali Acc: 0.611 Test Loss: 1.579 Test Acc: 0.611
Validation loss decreased (-0.577761 --> -0.611095).  Saving model ...
Epoch: 13 cost time: 0.7346351146697998
Epoch: 13, Steps: 12 | Train Loss: 1.338 Vali Loss: 1.512 Vali Acc: 0.661 Test Loss: 1.512 Test Acc: 0.661
Validation loss decreased (-0.611095 --> -0.661096).  Saving model ...
Epoch: 14 cost time: 0.6815590858459473
Epoch: 14, Steps: 12 | Train Loss: 1.228 Vali Loss: 1.423 Vali Acc: 0.661 Test Loss: 1.423 Test Acc: 0.661
Validation loss decreased (-0.661096 --> -0.661097).  Saving model ...
Epoch: 15 cost time: 0.6842062473297119
Epoch: 15, Steps: 12 | Train Loss: 1.154 Vali Loss: 1.350 Vali Acc: 0.678 Test Loss: 1.350 Test Acc: 0.678
Validation loss decreased (-0.661097 --> -0.677764).  Saving model ...
Epoch: 16 cost time: 0.6888446807861328
Epoch: 16, Steps: 12 | Train Loss: 1.069 Vali Loss: 1.298 Vali Acc: 0.683 Test Loss: 1.298 Test Acc: 0.683
Validation loss decreased (-0.677764 --> -0.683320).  Saving model ...
Epoch: 17 cost time: 0.6874034404754639
Epoch: 17, Steps: 12 | Train Loss: 1.020 Vali Loss: 1.234 Vali Acc: 0.689 Test Loss: 1.234 Test Acc: 0.689
Validation loss decreased (-0.683320 --> -0.688877).  Saving model ...
Epoch: 18 cost time: 0.7030446529388428
Epoch: 18, Steps: 12 | Train Loss: 0.957 Vali Loss: 1.156 Vali Acc: 0.711 Test Loss: 1.156 Test Acc: 0.711
Validation loss decreased (-0.688877 --> -0.711100).  Saving model ...
Epoch: 19 cost time: 0.6901631355285645
Epoch: 19, Steps: 12 | Train Loss: 0.914 Vali Loss: 1.103 Vali Acc: 0.717 Test Loss: 1.103 Test Acc: 0.717
Validation loss decreased (-0.711100 --> -0.716656).  Saving model ...
Epoch: 20 cost time: 0.6728625297546387
Epoch: 20, Steps: 12 | Train Loss: 0.816 Vali Loss: 1.083 Vali Acc: 0.733 Test Loss: 1.083 Test Acc: 0.733
Validation loss decreased (-0.716656 --> -0.733323).  Saving model ...
Epoch: 21 cost time: 0.7358357906341553
Epoch: 21, Steps: 12 | Train Loss: 0.772 Vali Loss: 1.015 Vali Acc: 0.761 Test Loss: 1.015 Test Acc: 0.761
Validation loss decreased (-0.733323 --> -0.761101).  Saving model ...
Epoch: 22 cost time: 0.694420576095581
Epoch: 22, Steps: 12 | Train Loss: 0.733 Vali Loss: 0.989 Vali Acc: 0.744 Test Loss: 0.989 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7073285579681396
Epoch: 23, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.945 Vali Acc: 0.750 Test Loss: 0.945 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7255785465240479
Epoch: 24, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.922 Vali Acc: 0.756 Test Loss: 0.922 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.661139965057373
Epoch: 25, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.888 Vali Acc: 0.744 Test Loss: 0.888 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6899731159210205
Epoch: 26, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.863 Vali Acc: 0.756 Test Loss: 0.863 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7152633666992188
Epoch: 27, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.832 Vali Acc: 0.761 Test Loss: 0.832 Test Acc: 0.761
Validation loss decreased (-0.761101 --> -0.761103).  Saving model ...
Epoch: 28 cost time: 0.7002584934234619
Epoch: 28, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.806 Vali Acc: 0.778 Test Loss: 0.806 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777770).  Saving model ...
Epoch: 29 cost time: 0.6932988166809082
Epoch: 29, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.783 Vali Acc: 0.783 Test Loss: 0.783 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783326).  Saving model ...
Epoch: 30 cost time: 0.7062458992004395
Epoch: 30, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.765 Vali Acc: 0.794 Test Loss: 0.765 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794437).  Saving model ...
Epoch: 31 cost time: 0.7056264877319336
Epoch: 31, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.744 Vali Acc: 0.783 Test Loss: 0.744 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7129182815551758
Epoch: 32, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.726 Vali Acc: 0.789 Test Loss: 0.726 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7335526943206787
Epoch: 33, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.698 Vali Acc: 0.789 Test Loss: 0.698 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7331902980804443
Epoch: 34, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.682 Vali Acc: 0.800 Test Loss: 0.682 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 35 cost time: 0.726787805557251
Epoch: 35, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.672 Vali Acc: 0.822 Test Loss: 0.672 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 36 cost time: 0.6848034858703613
Epoch: 36, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.662 Vali Acc: 0.806 Test Loss: 0.662 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.685617208480835
Epoch: 37, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.647 Vali Acc: 0.806 Test Loss: 0.647 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6829915046691895
Epoch: 38, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.628 Vali Acc: 0.817 Test Loss: 0.628 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6849589347839355
Epoch: 39, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.617 Vali Acc: 0.811 Test Loss: 0.617 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6851680278778076
Epoch: 40, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.614 Vali Acc: 0.817 Test Loss: 0.614 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.672276496887207
Epoch: 41, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.607 Vali Acc: 0.822 Test Loss: 0.607 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 42 cost time: 0.6884744167327881
Epoch: 42, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.599 Vali Acc: 0.828 Test Loss: 0.599 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 43 cost time: 0.7253820896148682
Epoch: 43, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.605 Vali Acc: 0.833 Test Loss: 0.605 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833327).  Saving model ...
Epoch: 44 cost time: 0.731842041015625
Epoch: 44, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.595 Vali Acc: 0.839 Test Loss: 0.595 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 45 cost time: 0.7004482746124268
Epoch: 45, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.598 Vali Acc: 0.844 Test Loss: 0.598 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 46 cost time: 0.7238247394561768
Epoch: 46, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.605 Vali Acc: 0.844 Test Loss: 0.605 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7141234874725342
Epoch: 47, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.605 Vali Acc: 0.839 Test Loss: 0.605 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.68813157081604
Epoch: 48, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.596 Vali Acc: 0.839 Test Loss: 0.596 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7000980377197266
Epoch: 49, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.583 Vali Acc: 0.817 Test Loss: 0.583 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.6985993385314941
Epoch: 50, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.587 Vali Acc: 0.839 Test Loss: 0.587 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 19599
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8658881187438965
Epoch: 1, Steps: 12 | Train Loss: 2.818 Vali Loss: 2.745 Vali Acc: 0.072 Test Loss: 2.745 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 0.6800010204315186
Epoch: 2, Steps: 12 | Train Loss: 2.786 Vali Loss: 2.708 Vali Acc: 0.078 Test Loss: 2.708 Test Acc: 0.078
Validation loss decreased (-0.072195 --> -0.077751).  Saving model ...
Epoch: 3 cost time: 0.6742663383483887
Epoch: 3, Steps: 12 | Train Loss: 2.675 Vali Loss: 2.626 Vali Acc: 0.089 Test Loss: 2.626 Test Acc: 0.089
Validation loss decreased (-0.077751 --> -0.088863).  Saving model ...
Epoch: 4 cost time: 0.708986759185791
Epoch: 4, Steps: 12 | Train Loss: 2.581 Vali Loss: 2.519 Vali Acc: 0.122 Test Loss: 2.519 Test Acc: 0.122
Validation loss decreased (-0.088863 --> -0.122197).  Saving model ...
Epoch: 5 cost time: 0.7065854072570801
Epoch: 5, Steps: 12 | Train Loss: 2.422 Vali Loss: 2.399 Vali Acc: 0.239 Test Loss: 2.399 Test Acc: 0.239
Validation loss decreased (-0.122197 --> -0.238865).  Saving model ...
Epoch: 6 cost time: 0.7097475528717041
Epoch: 6, Steps: 12 | Train Loss: 2.297 Vali Loss: 2.284 Vali Acc: 0.356 Test Loss: 2.284 Test Acc: 0.356
Validation loss decreased (-0.238865 --> -0.355533).  Saving model ...
Epoch: 7 cost time: 0.730046272277832
Epoch: 7, Steps: 12 | Train Loss: 2.158 Vali Loss: 2.166 Vali Acc: 0.494 Test Loss: 2.166 Test Acc: 0.494
Validation loss decreased (-0.355533 --> -0.494423).  Saving model ...
Epoch: 8 cost time: 0.715038537979126
Epoch: 8, Steps: 12 | Train Loss: 2.041 Vali Loss: 2.059 Vali Acc: 0.550 Test Loss: 2.059 Test Acc: 0.550
Validation loss decreased (-0.494423 --> -0.549979).  Saving model ...
Epoch: 9 cost time: 0.7188558578491211
Epoch: 9, Steps: 12 | Train Loss: 1.908 Vali Loss: 1.946 Vali Acc: 0.600 Test Loss: 1.946 Test Acc: 0.600
Validation loss decreased (-0.549979 --> -0.599981).  Saving model ...
Epoch: 10 cost time: 0.7428188323974609
Epoch: 10, Steps: 12 | Train Loss: 1.798 Vali Loss: 1.851 Vali Acc: 0.617 Test Loss: 1.851 Test Acc: 0.617
Validation loss decreased (-0.599981 --> -0.616648).  Saving model ...
Epoch: 11 cost time: 0.7101423740386963
Epoch: 11, Steps: 12 | Train Loss: 1.651 Vali Loss: 1.756 Vali Acc: 0.633 Test Loss: 1.756 Test Acc: 0.633
Validation loss decreased (-0.616648 --> -0.633316).  Saving model ...
Epoch: 12 cost time: 0.7104079723358154
Epoch: 12, Steps: 12 | Train Loss: 1.580 Vali Loss: 1.667 Vali Acc: 0.650 Test Loss: 1.667 Test Acc: 0.650
Validation loss decreased (-0.633316 --> -0.649983).  Saving model ...
Epoch: 13 cost time: 0.6803092956542969
Epoch: 13, Steps: 12 | Train Loss: 1.449 Vali Loss: 1.573 Vali Acc: 0.678 Test Loss: 1.573 Test Acc: 0.678
Validation loss decreased (-0.649983 --> -0.677762).  Saving model ...
Epoch: 14 cost time: 0.6936085224151611
Epoch: 14, Steps: 12 | Train Loss: 1.381 Vali Loss: 1.520 Vali Acc: 0.683 Test Loss: 1.520 Test Acc: 0.683
Validation loss decreased (-0.677762 --> -0.683318).  Saving model ...
Epoch: 15 cost time: 0.6874356269836426
Epoch: 15, Steps: 12 | Train Loss: 1.309 Vali Loss: 1.442 Vali Acc: 0.694 Test Loss: 1.442 Test Acc: 0.694
Validation loss decreased (-0.683318 --> -0.694430).  Saving model ...
Epoch: 16 cost time: 0.6832776069641113
Epoch: 16, Steps: 12 | Train Loss: 1.188 Vali Loss: 1.353 Vali Acc: 0.700 Test Loss: 1.353 Test Acc: 0.700
Validation loss decreased (-0.694430 --> -0.699986).  Saving model ...
Epoch: 17 cost time: 0.67500901222229
Epoch: 17, Steps: 12 | Train Loss: 1.135 Vali Loss: 1.297 Vali Acc: 0.694 Test Loss: 1.297 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.69283127784729
Epoch: 18, Steps: 12 | Train Loss: 1.051 Vali Loss: 1.257 Vali Acc: 0.717 Test Loss: 1.257 Test Acc: 0.717
Validation loss decreased (-0.699986 --> -0.716654).  Saving model ...
Epoch: 19 cost time: 0.7315435409545898
Epoch: 19, Steps: 12 | Train Loss: 1.003 Vali Loss: 1.196 Vali Acc: 0.717 Test Loss: 1.196 Test Acc: 0.717
Validation loss decreased (-0.716654 --> -0.716655).  Saving model ...
Epoch: 20 cost time: 0.7173283100128174
Epoch: 20, Steps: 12 | Train Loss: 0.952 Vali Loss: 1.129 Vali Acc: 0.733 Test Loss: 1.129 Test Acc: 0.733
Validation loss decreased (-0.716655 --> -0.733322).  Saving model ...
Epoch: 21 cost time: 0.6949458122253418
Epoch: 21, Steps: 12 | Train Loss: 0.888 Vali Loss: 1.096 Vali Acc: 0.739 Test Loss: 1.096 Test Acc: 0.739
Validation loss decreased (-0.733322 --> -0.738878).  Saving model ...
Epoch: 22 cost time: 0.7225227355957031
Epoch: 22, Steps: 12 | Train Loss: 0.878 Vali Loss: 1.031 Vali Acc: 0.750 Test Loss: 1.031 Test Acc: 0.750
Validation loss decreased (-0.738878 --> -0.749990).  Saving model ...
Epoch: 23 cost time: 0.6761453151702881
Epoch: 23, Steps: 12 | Train Loss: 0.804 Vali Loss: 0.983 Vali Acc: 0.739 Test Loss: 0.983 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6776061058044434
Epoch: 24, Steps: 12 | Train Loss: 0.763 Vali Loss: 0.941 Vali Acc: 0.756 Test Loss: 0.941 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755546).  Saving model ...
Epoch: 25 cost time: 0.6986932754516602
Epoch: 25, Steps: 12 | Train Loss: 0.692 Vali Loss: 0.909 Vali Acc: 0.767 Test Loss: 0.909 Test Acc: 0.767
Validation loss decreased (-0.755546 --> -0.766658).  Saving model ...
Epoch: 26 cost time: 0.6699247360229492
Epoch: 26, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.876 Vali Acc: 0.767 Test Loss: 0.876 Test Acc: 0.767
Validation loss decreased (-0.766658 --> -0.766658).  Saving model ...
Epoch: 27 cost time: 0.6914560794830322
Epoch: 27, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.846 Vali Acc: 0.778 Test Loss: 0.846 Test Acc: 0.778
Validation loss decreased (-0.766658 --> -0.777769).  Saving model ...
Epoch: 28 cost time: 0.6938858032226562
Epoch: 28, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.801 Vali Acc: 0.772 Test Loss: 0.801 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6816554069519043
Epoch: 29, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.773 Vali Acc: 0.789 Test Loss: 0.773 Test Acc: 0.789
Validation loss decreased (-0.777769 --> -0.788881).  Saving model ...
Epoch: 30 cost time: 0.7048122882843018
Epoch: 30, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.747 Vali Acc: 0.783 Test Loss: 0.747 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6866552829742432
Epoch: 31, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.722 Vali Acc: 0.778 Test Loss: 0.722 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7160212993621826
Epoch: 32, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.691 Vali Acc: 0.806 Test Loss: 0.691 Test Acc: 0.806
Validation loss decreased (-0.788881 --> -0.805549).  Saving model ...
Epoch: 33 cost time: 0.7033092975616455
Epoch: 33, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.677 Vali Acc: 0.794 Test Loss: 0.677 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.697282075881958
Epoch: 34, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.645 Vali Acc: 0.811 Test Loss: 0.645 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 35 cost time: 0.6669826507568359
Epoch: 35, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.635 Vali Acc: 0.811 Test Loss: 0.635 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 36 cost time: 0.6688334941864014
Epoch: 36, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.618 Vali Acc: 0.844 Test Loss: 0.618 Test Acc: 0.844
Validation loss decreased (-0.811105 --> -0.844438).  Saving model ...
Epoch: 37 cost time: 0.6590580940246582
Epoch: 37, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.606 Vali Acc: 0.833 Test Loss: 0.606 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6723041534423828
Epoch: 38, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.594 Vali Acc: 0.833 Test Loss: 0.594 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6730632781982422
Epoch: 39, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.579 Vali Acc: 0.839 Test Loss: 0.579 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6837215423583984
Epoch: 40, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.567 Vali Acc: 0.844 Test Loss: 0.567 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844439).  Saving model ...
Epoch: 41 cost time: 0.7052707672119141
Epoch: 41, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.546 Vali Acc: 0.856 Test Loss: 0.546 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 42 cost time: 0.7193624973297119
Epoch: 42, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 43 cost time: 0.7061557769775391
Epoch: 43, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.536 Vali Acc: 0.867 Test Loss: 0.536 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 44 cost time: 0.7205700874328613
Epoch: 44, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.530 Vali Acc: 0.861 Test Loss: 0.530 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7099266052246094
Epoch: 45, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.521 Vali Acc: 0.867 Test Loss: 0.521 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 46 cost time: 0.6721820831298828
Epoch: 46, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6827447414398193
Epoch: 47, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.503 Vali Acc: 0.861 Test Loss: 0.503 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6862666606903076
Epoch: 48, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.505 Vali Acc: 0.872 Test Loss: 0.505 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 49 cost time: 0.7064008712768555
Epoch: 49, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.499 Vali Acc: 0.861 Test Loss: 0.499 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.6914310455322266
Epoch: 50, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.496 Vali Acc: 0.856 Test Loss: 0.496 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 17775
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0970242023468018
Epoch: 1, Steps: 12 | Train Loss: 2.725 Vali Loss: 2.669 Vali Acc: 0.139 Test Loss: 2.669 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 0.9276645183563232
Epoch: 2, Steps: 12 | Train Loss: 2.616 Vali Loss: 2.568 Vali Acc: 0.244 Test Loss: 2.568 Test Acc: 0.244
Validation loss decreased (-0.138862 --> -0.244419).  Saving model ...
Epoch: 3 cost time: 0.916851282119751
Epoch: 3, Steps: 12 | Train Loss: 2.447 Vali Loss: 2.384 Vali Acc: 0.444 Test Loss: 2.384 Test Acc: 0.444
Validation loss decreased (-0.244419 --> -0.444421).  Saving model ...
Epoch: 4 cost time: 0.9191830158233643
Epoch: 4, Steps: 12 | Train Loss: 2.214 Vali Loss: 2.125 Vali Acc: 0.533 Test Loss: 2.125 Test Acc: 0.533
Validation loss decreased (-0.444421 --> -0.533312).  Saving model ...
Epoch: 5 cost time: 0.8527734279632568
Epoch: 5, Steps: 12 | Train Loss: 1.932 Vali Loss: 1.844 Vali Acc: 0.583 Test Loss: 1.844 Test Acc: 0.583
Validation loss decreased (-0.533312 --> -0.583315).  Saving model ...
Epoch: 6 cost time: 0.8588204383850098
Epoch: 6, Steps: 12 | Train Loss: 1.597 Vali Loss: 1.556 Vali Acc: 0.600 Test Loss: 1.556 Test Acc: 0.600
Validation loss decreased (-0.583315 --> -0.599984).  Saving model ...
Epoch: 7 cost time: 0.943336009979248
Epoch: 7, Steps: 12 | Train Loss: 1.232 Vali Loss: 1.320 Vali Acc: 0.661 Test Loss: 1.320 Test Acc: 0.661
Validation loss decreased (-0.599984 --> -0.661098).  Saving model ...
Epoch: 8 cost time: 0.9550831317901611
Epoch: 8, Steps: 12 | Train Loss: 1.093 Vali Loss: 1.174 Vali Acc: 0.694 Test Loss: 1.174 Test Acc: 0.694
Validation loss decreased (-0.661098 --> -0.694433).  Saving model ...
Epoch: 9 cost time: 0.9404468536376953
Epoch: 9, Steps: 12 | Train Loss: 0.851 Vali Loss: 1.023 Vali Acc: 0.700 Test Loss: 1.023 Test Acc: 0.700
Validation loss decreased (-0.694433 --> -0.699990).  Saving model ...
Epoch: 10 cost time: 0.8386325836181641
Epoch: 10, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.928 Vali Acc: 0.722 Test Loss: 0.928 Test Acc: 0.722
Validation loss decreased (-0.699990 --> -0.722213).  Saving model ...
Epoch: 11 cost time: 0.8843419551849365
Epoch: 11, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.843 Vali Acc: 0.756 Test Loss: 0.843 Test Acc: 0.756
Validation loss decreased (-0.722213 --> -0.755547).  Saving model ...
Epoch: 12 cost time: 0.8909087181091309
Epoch: 12, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.801 Vali Acc: 0.772 Test Loss: 0.801 Test Acc: 0.772
Validation loss decreased (-0.755547 --> -0.772214).  Saving model ...
Epoch: 13 cost time: 0.889366865158081
Epoch: 13, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.740 Vali Acc: 0.800 Test Loss: 0.740 Test Acc: 0.800
Validation loss decreased (-0.772214 --> -0.799993).  Saving model ...
Epoch: 14 cost time: 0.8870129585266113
Epoch: 14, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.671 Vali Acc: 0.822 Test Loss: 0.671 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 15 cost time: 0.8687107563018799
Epoch: 15, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.647 Vali Acc: 0.828 Test Loss: 0.647 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827771).  Saving model ...
Epoch: 16 cost time: 0.9014368057250977
Epoch: 16, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.632 Vali Acc: 0.833 Test Loss: 0.632 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 17 cost time: 0.9366555213928223
Epoch: 17, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.624 Vali Acc: 0.828 Test Loss: 0.624 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8970239162445068
Epoch: 18, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.569 Vali Acc: 0.861 Test Loss: 0.569 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861105).  Saving model ...
Epoch: 19 cost time: 0.9029433727264404
Epoch: 19, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.582 Vali Acc: 0.856 Test Loss: 0.582 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9140050411224365
Epoch: 20, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.947890043258667
Epoch: 21, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.568 Vali Acc: 0.872 Test Loss: 0.568 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872217).  Saving model ...
Epoch: 22 cost time: 0.9355990886688232
Epoch: 22, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.573 Vali Acc: 0.878 Test Loss: 0.573 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 23 cost time: 0.8410537242889404
Epoch: 23, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.559 Vali Acc: 0.878 Test Loss: 0.559 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 24 cost time: 0.8695950508117676
Epoch: 24, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.599 Vali Acc: 0.878 Test Loss: 0.599 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8644900321960449
Epoch: 25, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.586 Vali Acc: 0.867 Test Loss: 0.586 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9117255210876465
Epoch: 26, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.600 Vali Acc: 0.889 Test Loss: 0.600 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888883).  Saving model ...
Epoch: 27 cost time: 0.9161531925201416
Epoch: 27, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.588 Vali Acc: 0.867 Test Loss: 0.588 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9344279766082764
Epoch: 28, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.617 Vali Acc: 0.883 Test Loss: 0.617 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9140081405639648
Epoch: 29, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.681 Vali Acc: 0.861 Test Loss: 0.681 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9055569171905518
Epoch: 30, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.626 Vali Acc: 0.872 Test Loss: 0.626 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8586587905883789
Epoch: 31, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.667 Vali Acc: 0.878 Test Loss: 0.667 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8737287521362305
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.664 Vali Acc: 0.878 Test Loss: 0.664 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9647622108459473
Epoch: 33, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.672 Vali Acc: 0.889 Test Loss: 0.672 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.881403923034668
Epoch: 34, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.694 Vali Acc: 0.872 Test Loss: 0.694 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8981163501739502
Epoch: 35, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.693 Vali Acc: 0.872 Test Loss: 0.693 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9169187545776367
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.688 Vali Acc: 0.883 Test Loss: 0.688 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 167023
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.242654800415039
Epoch: 1, Steps: 12 | Train Loss: 2.703 Vali Loss: 2.709 Vali Acc: 0.117 Test Loss: 2.709 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 0.9002978801727295
Epoch: 2, Steps: 12 | Train Loss: 2.619 Vali Loss: 2.639 Vali Acc: 0.228 Test Loss: 2.639 Test Acc: 0.228
Validation loss decreased (-0.116640 --> -0.227751).  Saving model ...
Epoch: 3 cost time: 0.9205284118652344
Epoch: 3, Steps: 12 | Train Loss: 2.498 Vali Loss: 2.516 Vali Acc: 0.300 Test Loss: 2.516 Test Acc: 0.300
Validation loss decreased (-0.227751 --> -0.299975).  Saving model ...
Epoch: 4 cost time: 0.9065675735473633
Epoch: 4, Steps: 12 | Train Loss: 2.377 Vali Loss: 2.358 Vali Acc: 0.444 Test Loss: 2.358 Test Acc: 0.444
Validation loss decreased (-0.299975 --> -0.444421).  Saving model ...
Epoch: 5 cost time: 0.9017915725708008
Epoch: 5, Steps: 12 | Train Loss: 2.189 Vali Loss: 2.148 Vali Acc: 0.556 Test Loss: 2.148 Test Acc: 0.556
Validation loss decreased (-0.444421 --> -0.555534).  Saving model ...
Epoch: 6 cost time: 0.9008502960205078
Epoch: 6, Steps: 12 | Train Loss: 1.952 Vali Loss: 1.916 Vali Acc: 0.578 Test Loss: 1.916 Test Acc: 0.578
Validation loss decreased (-0.555534 --> -0.577759).  Saving model ...
Epoch: 7 cost time: 0.8832206726074219
Epoch: 7, Steps: 12 | Train Loss: 1.712 Vali Loss: 1.706 Vali Acc: 0.611 Test Loss: 1.706 Test Acc: 0.611
Validation loss decreased (-0.577759 --> -0.611094).  Saving model ...
Epoch: 8 cost time: 0.8486361503601074
Epoch: 8, Steps: 12 | Train Loss: 1.491 Vali Loss: 1.496 Vali Acc: 0.644 Test Loss: 1.496 Test Acc: 0.644
Validation loss decreased (-0.611094 --> -0.644429).  Saving model ...
Epoch: 9 cost time: 0.8598427772521973
Epoch: 9, Steps: 12 | Train Loss: 1.303 Vali Loss: 1.302 Vali Acc: 0.672 Test Loss: 1.302 Test Acc: 0.672
Validation loss decreased (-0.644429 --> -0.672209).  Saving model ...
Epoch: 10 cost time: 0.8906748294830322
Epoch: 10, Steps: 12 | Train Loss: 1.080 Vali Loss: 1.166 Vali Acc: 0.694 Test Loss: 1.166 Test Acc: 0.694
Validation loss decreased (-0.672209 --> -0.694433).  Saving model ...
Epoch: 11 cost time: 0.823716402053833
Epoch: 11, Steps: 12 | Train Loss: 0.883 Vali Loss: 1.068 Vali Acc: 0.711 Test Loss: 1.068 Test Acc: 0.711
Validation loss decreased (-0.694433 --> -0.711100).  Saving model ...
Epoch: 12 cost time: 0.8947563171386719
Epoch: 12, Steps: 12 | Train Loss: 0.760 Vali Loss: 0.981 Vali Acc: 0.728 Test Loss: 0.981 Test Acc: 0.728
Validation loss decreased (-0.711100 --> -0.727768).  Saving model ...
Epoch: 13 cost time: 0.9625074863433838
Epoch: 13, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.918 Vali Acc: 0.728 Test Loss: 0.918 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727769).  Saving model ...
Epoch: 14 cost time: 0.8968894481658936
Epoch: 14, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.849 Vali Acc: 0.722 Test Loss: 0.849 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8926005363464355
Epoch: 15, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.788 Vali Acc: 0.744 Test Loss: 0.788 Test Acc: 0.744
Validation loss decreased (-0.727769 --> -0.744437).  Saving model ...
Epoch: 16 cost time: 0.8691637516021729
Epoch: 16, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.739 Vali Acc: 0.772 Test Loss: 0.739 Test Acc: 0.772
Validation loss decreased (-0.744437 --> -0.772215).  Saving model ...
Epoch: 17 cost time: 0.8515233993530273
Epoch: 17, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.684 Vali Acc: 0.789 Test Loss: 0.684 Test Acc: 0.789
Validation loss decreased (-0.772215 --> -0.788882).  Saving model ...
Epoch: 18 cost time: 0.8514969348907471
Epoch: 18, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.667 Vali Acc: 0.800 Test Loss: 0.667 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 0.8867902755737305
Epoch: 19, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.634 Vali Acc: 0.822 Test Loss: 0.634 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 20 cost time: 0.8647375106811523
Epoch: 20, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.645 Vali Acc: 0.806 Test Loss: 0.645 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8600585460662842
Epoch: 21, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.603 Vali Acc: 0.839 Test Loss: 0.603 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 22 cost time: 0.9373679161071777
Epoch: 22, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861106).  Saving model ...
Epoch: 23 cost time: 0.9210774898529053
Epoch: 23, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.563 Vali Acc: 0.839 Test Loss: 0.563 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.890174388885498
Epoch: 24, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.557 Vali Acc: 0.856 Test Loss: 0.557 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9467723369598389
Epoch: 25, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.553 Vali Acc: 0.844 Test Loss: 0.553 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8393268585205078
Epoch: 26, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.560 Vali Acc: 0.839 Test Loss: 0.560 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8614168167114258
Epoch: 27, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8205671310424805
Epoch: 28, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.562 Vali Acc: 0.856 Test Loss: 0.562 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8304202556610107
Epoch: 29, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.560 Vali Acc: 0.872 Test Loss: 0.560 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 30 cost time: 0.9083318710327148
Epoch: 30, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.561 Vali Acc: 0.856 Test Loss: 0.561 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.902510404586792
Epoch: 31, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.555 Vali Acc: 0.861 Test Loss: 0.555 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9163405895233154
Epoch: 32, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.607 Vali Acc: 0.850 Test Loss: 0.607 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.917452335357666
Epoch: 33, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.560 Vali Acc: 0.861 Test Loss: 0.560 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8671586513519287
Epoch: 34, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.553 Vali Acc: 0.867 Test Loss: 0.553 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8483073711395264
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.611 Vali Acc: 0.878 Test Loss: 0.611 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 36 cost time: 0.8959929943084717
Epoch: 36, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.572 Vali Acc: 0.867 Test Loss: 0.572 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8484902381896973
Epoch: 37, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.590 Vali Acc: 0.878 Test Loss: 0.590 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 38 cost time: 0.8757450580596924
Epoch: 38, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.581 Vali Acc: 0.883 Test Loss: 0.581 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 39 cost time: 0.9364666938781738
Epoch: 39, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.597 Vali Acc: 0.883 Test Loss: 0.597 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9155220985412598
Epoch: 40, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.596 Vali Acc: 0.872 Test Loss: 0.596 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.879690408706665
Epoch: 41, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.632 Vali Acc: 0.872 Test Loss: 0.632 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8589448928833008
Epoch: 42, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.654 Vali Acc: 0.872 Test Loss: 0.654 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.862851619720459
Epoch: 43, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.639 Vali Acc: 0.878 Test Loss: 0.639 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.9041647911071777
Epoch: 44, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.637 Vali Acc: 0.872 Test Loss: 0.637 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.851043701171875
Epoch: 45, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.626 Vali Acc: 0.878 Test Loss: 0.626 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.907646656036377
Epoch: 46, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.612 Vali Acc: 0.872 Test Loss: 0.612 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.89974045753479
Epoch: 47, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.599 Vali Acc: 0.878 Test Loss: 0.599 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.8567802906036377
Epoch: 48, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.619 Vali Acc: 0.872 Test Loss: 0.619 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 144015
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.141643524169922
Epoch: 1, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.709 Vali Acc: 0.011 Test Loss: 2.709 Test Acc: 0.011
Validation loss decreased (inf --> -0.011084).  Saving model ...
Epoch: 2 cost time: 0.9211134910583496
Epoch: 2, Steps: 12 | Train Loss: 2.642 Vali Loss: 2.634 Vali Acc: 0.139 Test Loss: 2.634 Test Acc: 0.139
Validation loss decreased (-0.011084 --> -0.138863).  Saving model ...
Epoch: 3 cost time: 0.9398009777069092
Epoch: 3, Steps: 12 | Train Loss: 2.509 Vali Loss: 2.504 Vali Acc: 0.367 Test Loss: 2.504 Test Acc: 0.367
Validation loss decreased (-0.138863 --> -0.366642).  Saving model ...
Epoch: 4 cost time: 0.9342644214630127
Epoch: 4, Steps: 12 | Train Loss: 2.372 Vali Loss: 2.325 Vali Acc: 0.528 Test Loss: 2.325 Test Acc: 0.528
Validation loss decreased (-0.366642 --> -0.527755).  Saving model ...
Epoch: 5 cost time: 1.0619184970855713
Epoch: 5, Steps: 12 | Train Loss: 2.190 Vali Loss: 2.099 Vali Acc: 0.567 Test Loss: 2.099 Test Acc: 0.567
Validation loss decreased (-0.527755 --> -0.566646).  Saving model ...
Epoch: 6 cost time: 1.029710054397583
Epoch: 6, Steps: 12 | Train Loss: 1.939 Vali Loss: 1.869 Vali Acc: 0.589 Test Loss: 1.869 Test Acc: 0.589
Validation loss decreased (-0.566646 --> -0.588870).  Saving model ...
Epoch: 7 cost time: 0.977271318435669
Epoch: 7, Steps: 12 | Train Loss: 1.659 Vali Loss: 1.652 Vali Acc: 0.617 Test Loss: 1.652 Test Acc: 0.617
Validation loss decreased (-0.588870 --> -0.616650).  Saving model ...
Epoch: 8 cost time: 0.8659954071044922
Epoch: 8, Steps: 12 | Train Loss: 1.397 Vali Loss: 1.465 Vali Acc: 0.650 Test Loss: 1.465 Test Acc: 0.650
Validation loss decreased (-0.616650 --> -0.649985).  Saving model ...
Epoch: 9 cost time: 0.9486486911773682
Epoch: 9, Steps: 12 | Train Loss: 1.186 Vali Loss: 1.301 Vali Acc: 0.683 Test Loss: 1.301 Test Acc: 0.683
Validation loss decreased (-0.649985 --> -0.683320).  Saving model ...
Epoch: 10 cost time: 0.9266645908355713
Epoch: 10, Steps: 12 | Train Loss: 0.985 Vali Loss: 1.171 Vali Acc: 0.678 Test Loss: 1.171 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8639814853668213
Epoch: 11, Steps: 12 | Train Loss: 0.891 Vali Loss: 1.072 Vali Acc: 0.689 Test Loss: 1.072 Test Acc: 0.689
Validation loss decreased (-0.683320 --> -0.688878).  Saving model ...
Epoch: 12 cost time: 0.8974153995513916
Epoch: 12, Steps: 12 | Train Loss: 0.790 Vali Loss: 0.986 Vali Acc: 0.694 Test Loss: 0.986 Test Acc: 0.694
Validation loss decreased (-0.688878 --> -0.694435).  Saving model ...
Epoch: 13 cost time: 0.9360771179199219
Epoch: 13, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.915 Vali Acc: 0.711 Test Loss: 0.915 Test Acc: 0.711
Validation loss decreased (-0.694435 --> -0.711102).  Saving model ...
Epoch: 14 cost time: 0.9747452735900879
Epoch: 14, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.884 Vali Acc: 0.717 Test Loss: 0.884 Test Acc: 0.717
Validation loss decreased (-0.711102 --> -0.716658).  Saving model ...
Epoch: 15 cost time: 0.9464132785797119
Epoch: 15, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.826 Vali Acc: 0.739 Test Loss: 0.826 Test Acc: 0.739
Validation loss decreased (-0.716658 --> -0.738881).  Saving model ...
Epoch: 16 cost time: 0.8990192413330078
Epoch: 16, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.801 Vali Acc: 0.744 Test Loss: 0.801 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744436).  Saving model ...
Epoch: 17 cost time: 0.920722484588623
Epoch: 17, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.749 Vali Acc: 0.778 Test Loss: 0.749 Test Acc: 0.778
Validation loss decreased (-0.744436 --> -0.777770).  Saving model ...
Epoch: 18 cost time: 0.9213211536407471
Epoch: 18, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.714 Vali Acc: 0.794 Test Loss: 0.714 Test Acc: 0.794
Validation loss decreased (-0.777770 --> -0.794437).  Saving model ...
Epoch: 19 cost time: 0.8690590858459473
Epoch: 19, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.719 Vali Acc: 0.778 Test Loss: 0.719 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9133434295654297
Epoch: 20, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.695 Vali Acc: 0.794 Test Loss: 0.695 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794437).  Saving model ...
Epoch: 21 cost time: 0.9378068447113037
Epoch: 21, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.670 Vali Acc: 0.822 Test Loss: 0.670 Test Acc: 0.822
Validation loss decreased (-0.794437 --> -0.822216).  Saving model ...
Epoch: 22 cost time: 0.8636617660522461
Epoch: 22, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.661 Vali Acc: 0.817 Test Loss: 0.661 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9494631290435791
Epoch: 23, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.639 Vali Acc: 0.822 Test Loss: 0.639 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 24 cost time: 0.954899787902832
Epoch: 24, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.620 Vali Acc: 0.844 Test Loss: 0.620 Test Acc: 0.844
Validation loss decreased (-0.822216 --> -0.844438).  Saving model ...
Epoch: 25 cost time: 0.8737990856170654
Epoch: 25, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.603 Vali Acc: 0.833 Test Loss: 0.603 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8601527214050293
Epoch: 26, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.595 Vali Acc: 0.839 Test Loss: 0.595 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8874812126159668
Epoch: 27, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.592 Vali Acc: 0.856 Test Loss: 0.592 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855550).  Saving model ...
Epoch: 28 cost time: 0.9039332866668701
Epoch: 28, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.622 Vali Acc: 0.856 Test Loss: 0.622 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9462332725524902
Epoch: 29, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.577 Vali Acc: 0.861 Test Loss: 0.577 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 30 cost time: 0.8987164497375488
Epoch: 30, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9403791427612305
Epoch: 31, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.611 Vali Acc: 0.861 Test Loss: 0.611 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9417979717254639
Epoch: 32, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.599 Vali Acc: 0.861 Test Loss: 0.599 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9083788394927979
Epoch: 33, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.618 Vali Acc: 0.861 Test Loss: 0.618 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8902187347412109
Epoch: 34, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.599 Vali Acc: 0.861 Test Loss: 0.599 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0118882656097412
Epoch: 35, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.624 Vali Acc: 0.867 Test Loss: 0.624 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 36 cost time: 0.9200966358184814
Epoch: 36, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.635 Vali Acc: 0.856 Test Loss: 0.635 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8978531360626221
Epoch: 37, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.661 Vali Acc: 0.856 Test Loss: 0.661 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9952073097229004
Epoch: 38, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.674 Vali Acc: 0.867 Test Loss: 0.674 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9637527465820312
Epoch: 39, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.667 Vali Acc: 0.856 Test Loss: 0.667 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.015662431716919
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.698 Vali Acc: 0.861 Test Loss: 0.698 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9343376159667969
Epoch: 41, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.688 Vali Acc: 0.872 Test Loss: 0.688 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872215).  Saving model ...
Epoch: 42 cost time: 0.9371566772460938
Epoch: 42, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.665 Vali Acc: 0.867 Test Loss: 0.665 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.917963981628418
Epoch: 43, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.637 Vali Acc: 0.856 Test Loss: 0.637 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8943147659301758
Epoch: 44, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.663 Vali Acc: 0.861 Test Loss: 0.663 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9000222682952881
Epoch: 45, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.705 Vali Acc: 0.867 Test Loss: 0.705 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8857419490814209
Epoch: 46, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.696 Vali Acc: 0.867 Test Loss: 0.696 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.9051609039306641
Epoch: 47, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.696 Vali Acc: 0.850 Test Loss: 0.696 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.9729588031768799
Epoch: 48, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.728 Vali Acc: 0.867 Test Loss: 0.728 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9501876831054688
Epoch: 49, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.767 Vali Acc: 0.867 Test Loss: 0.767 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.9262127876281738
Epoch: 50, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.740 Vali Acc: 0.878 Test Loss: 0.740 Test Acc: 0.878
Validation loss decreased (-0.872215 --> -0.877770).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 144047
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1723735332489014
Epoch: 1, Steps: 12 | Train Loss: 2.712 Vali Loss: 2.706 Vali Acc: 0.039 Test Loss: 2.706 Test Acc: 0.039
Validation loss decreased (inf --> -0.038862).  Saving model ...
Epoch: 2 cost time: 0.9475197792053223
Epoch: 2, Steps: 12 | Train Loss: 2.664 Vali Loss: 2.651 Vali Acc: 0.089 Test Loss: 2.651 Test Acc: 0.089
Validation loss decreased (-0.038862 --> -0.088862).  Saving model ...
Epoch: 3 cost time: 0.9096612930297852
Epoch: 3, Steps: 12 | Train Loss: 2.552 Vali Loss: 2.558 Vali Acc: 0.222 Test Loss: 2.558 Test Acc: 0.222
Validation loss decreased (-0.088862 --> -0.222197).  Saving model ...
Epoch: 4 cost time: 0.9182381629943848
Epoch: 4, Steps: 12 | Train Loss: 2.446 Vali Loss: 2.436 Vali Acc: 0.339 Test Loss: 2.436 Test Acc: 0.339
Validation loss decreased (-0.222197 --> -0.338865).  Saving model ...
Epoch: 5 cost time: 0.9121122360229492
Epoch: 5, Steps: 12 | Train Loss: 2.325 Vali Loss: 2.291 Vali Acc: 0.417 Test Loss: 2.291 Test Acc: 0.417
Validation loss decreased (-0.338865 --> -0.416644).  Saving model ...
Epoch: 6 cost time: 0.9440290927886963
Epoch: 6, Steps: 12 | Train Loss: 2.116 Vali Loss: 2.122 Vali Acc: 0.483 Test Loss: 2.122 Test Acc: 0.483
Validation loss decreased (-0.416644 --> -0.483312).  Saving model ...
Epoch: 7 cost time: 0.8814408779144287
Epoch: 7, Steps: 12 | Train Loss: 1.934 Vali Loss: 1.934 Vali Acc: 0.517 Test Loss: 1.934 Test Acc: 0.517
Validation loss decreased (-0.483312 --> -0.516647).  Saving model ...
Epoch: 8 cost time: 0.8718419075012207
Epoch: 8, Steps: 12 | Train Loss: 1.695 Vali Loss: 1.747 Vali Acc: 0.589 Test Loss: 1.747 Test Acc: 0.589
Validation loss decreased (-0.516647 --> -0.588871).  Saving model ...
Epoch: 9 cost time: 0.9022924900054932
Epoch: 9, Steps: 12 | Train Loss: 1.512 Vali Loss: 1.542 Vali Acc: 0.644 Test Loss: 1.542 Test Acc: 0.644
Validation loss decreased (-0.588871 --> -0.644429).  Saving model ...
Epoch: 10 cost time: 0.9321026802062988
Epoch: 10, Steps: 12 | Train Loss: 1.341 Vali Loss: 1.360 Vali Acc: 0.672 Test Loss: 1.360 Test Acc: 0.672
Validation loss decreased (-0.644429 --> -0.672209).  Saving model ...
Epoch: 11 cost time: 0.8258471488952637
Epoch: 11, Steps: 12 | Train Loss: 1.107 Vali Loss: 1.240 Vali Acc: 0.689 Test Loss: 1.240 Test Acc: 0.689
Validation loss decreased (-0.672209 --> -0.688876).  Saving model ...
Epoch: 12 cost time: 0.9234867095947266
Epoch: 12, Steps: 12 | Train Loss: 0.940 Vali Loss: 1.133 Vali Acc: 0.683 Test Loss: 1.133 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9396436214447021
Epoch: 13, Steps: 12 | Train Loss: 0.847 Vali Loss: 1.009 Vali Acc: 0.706 Test Loss: 1.009 Test Acc: 0.706
Validation loss decreased (-0.688876 --> -0.705545).  Saving model ...
Epoch: 14 cost time: 0.8381984233856201
Epoch: 14, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.916 Vali Acc: 0.717 Test Loss: 0.916 Test Acc: 0.717
Validation loss decreased (-0.705545 --> -0.716658).  Saving model ...
Epoch: 15 cost time: 0.859644889831543
Epoch: 15, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.849 Vali Acc: 0.750 Test Loss: 0.849 Test Acc: 0.750
Validation loss decreased (-0.716658 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 0.8809311389923096
Epoch: 16, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.794 Vali Acc: 0.772 Test Loss: 0.794 Test Acc: 0.772
Validation loss decreased (-0.749992 --> -0.772214).  Saving model ...
Epoch: 17 cost time: 0.9492948055267334
Epoch: 17, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.743 Vali Acc: 0.772 Test Loss: 0.743 Test Acc: 0.772
Validation loss decreased (-0.772214 --> -0.772215).  Saving model ...
Epoch: 18 cost time: 0.8809988498687744
Epoch: 18, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.696 Vali Acc: 0.800 Test Loss: 0.696 Test Acc: 0.800
Validation loss decreased (-0.772215 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 0.9243099689483643
Epoch: 19, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.660 Vali Acc: 0.800 Test Loss: 0.660 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 20 cost time: 0.9213078022003174
Epoch: 20, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.630 Vali Acc: 0.822 Test Loss: 0.630 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 21 cost time: 0.9474103450775146
Epoch: 21, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.599 Vali Acc: 0.828 Test Loss: 0.599 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 22 cost time: 0.9033427238464355
Epoch: 22, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.571 Vali Acc: 0.839 Test Loss: 0.571 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 23 cost time: 0.8780155181884766
Epoch: 23, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.558 Vali Acc: 0.844 Test Loss: 0.558 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 24 cost time: 0.8996648788452148
Epoch: 24, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.557 Vali Acc: 0.839 Test Loss: 0.557 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8330256938934326
Epoch: 25, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 26 cost time: 0.9328720569610596
Epoch: 26, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.541 Vali Acc: 0.839 Test Loss: 0.541 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8737223148345947
Epoch: 27, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 28 cost time: 0.9024860858917236
Epoch: 28, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.531 Vali Acc: 0.844 Test Loss: 0.531 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.916468620300293
Epoch: 29, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.516 Vali Acc: 0.839 Test Loss: 0.516 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9172704219818115
Epoch: 30, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 31 cost time: 0.892906665802002
Epoch: 31, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.518 Vali Acc: 0.856 Test Loss: 0.518 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 32 cost time: 0.8591666221618652
Epoch: 32, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.508 Vali Acc: 0.861 Test Loss: 0.508 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 33 cost time: 0.8395276069641113
Epoch: 33, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.519 Vali Acc: 0.839 Test Loss: 0.519 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8522200584411621
Epoch: 34, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.526 Vali Acc: 0.839 Test Loss: 0.526 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9226515293121338
Epoch: 35, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.526 Vali Acc: 0.856 Test Loss: 0.526 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8741953372955322
Epoch: 36, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.535 Vali Acc: 0.839 Test Loss: 0.535 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9003596305847168
Epoch: 37, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9189388751983643
Epoch: 38, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.517 Vali Acc: 0.861 Test Loss: 0.517 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8993234634399414
Epoch: 39, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.858539342880249
Epoch: 40, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.567 Vali Acc: 0.856 Test Loss: 0.567 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9111018180847168
Epoch: 41, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.9180901050567627
Epoch: 42, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.551 Vali Acc: 0.856 Test Loss: 0.551 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 136399
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.098280906677246
Epoch: 1, Steps: 12 | Train Loss: 2.701 Vali Loss: 2.718 Vali Acc: 0.056 Test Loss: 2.718 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 0.848717212677002
Epoch: 2, Steps: 12 | Train Loss: 2.670 Vali Loss: 2.667 Vali Acc: 0.089 Test Loss: 2.667 Test Acc: 0.089
Validation loss decreased (-0.055528 --> -0.088862).  Saving model ...
Epoch: 3 cost time: 0.9032111167907715
Epoch: 3, Steps: 12 | Train Loss: 2.587 Vali Loss: 2.578 Vali Acc: 0.200 Test Loss: 2.578 Test Acc: 0.200
Validation loss decreased (-0.088862 --> -0.199974).  Saving model ...
Epoch: 4 cost time: 0.9203426837921143
Epoch: 4, Steps: 12 | Train Loss: 2.464 Vali Loss: 2.471 Vali Acc: 0.300 Test Loss: 2.471 Test Acc: 0.300
Validation loss decreased (-0.199974 --> -0.299975).  Saving model ...
Epoch: 5 cost time: 0.8626768589019775
Epoch: 5, Steps: 12 | Train Loss: 2.357 Vali Loss: 2.340 Vali Acc: 0.433 Test Loss: 2.340 Test Acc: 0.433
Validation loss decreased (-0.299975 --> -0.433310).  Saving model ...
Epoch: 6 cost time: 0.8221361637115479
Epoch: 6, Steps: 12 | Train Loss: 2.214 Vali Loss: 2.205 Vali Acc: 0.483 Test Loss: 2.205 Test Acc: 0.483
Validation loss decreased (-0.433310 --> -0.483311).  Saving model ...
Epoch: 7 cost time: 0.8920707702636719
Epoch: 7, Steps: 12 | Train Loss: 2.032 Vali Loss: 2.034 Vali Acc: 0.511 Test Loss: 2.034 Test Acc: 0.511
Validation loss decreased (-0.483311 --> -0.511091).  Saving model ...
Epoch: 8 cost time: 0.8857557773590088
Epoch: 8, Steps: 12 | Train Loss: 1.841 Vali Loss: 1.867 Vali Acc: 0.539 Test Loss: 1.867 Test Acc: 0.539
Validation loss decreased (-0.511091 --> -0.538870).  Saving model ...
Epoch: 9 cost time: 0.9201509952545166
Epoch: 9, Steps: 12 | Train Loss: 1.691 Vali Loss: 1.710 Vali Acc: 0.567 Test Loss: 1.710 Test Acc: 0.567
Validation loss decreased (-0.538870 --> -0.566650).  Saving model ...
Epoch: 10 cost time: 0.9066236019134521
Epoch: 10, Steps: 12 | Train Loss: 1.505 Vali Loss: 1.548 Vali Acc: 0.606 Test Loss: 1.548 Test Acc: 0.606
Validation loss decreased (-0.566650 --> -0.605540).  Saving model ...
Epoch: 11 cost time: 0.9160172939300537
Epoch: 11, Steps: 12 | Train Loss: 1.243 Vali Loss: 1.410 Vali Acc: 0.644 Test Loss: 1.410 Test Acc: 0.644
Validation loss decreased (-0.605540 --> -0.644430).  Saving model ...
Epoch: 12 cost time: 0.8319437503814697
Epoch: 12, Steps: 12 | Train Loss: 1.088 Vali Loss: 1.273 Vali Acc: 0.644 Test Loss: 1.273 Test Acc: 0.644
Validation loss decreased (-0.644430 --> -0.644432).  Saving model ...
Epoch: 13 cost time: 0.8718986511230469
Epoch: 13, Steps: 12 | Train Loss: 0.965 Vali Loss: 1.161 Vali Acc: 0.683 Test Loss: 1.161 Test Acc: 0.683
Validation loss decreased (-0.644432 --> -0.683322).  Saving model ...
Epoch: 14 cost time: 0.8273844718933105
Epoch: 14, Steps: 12 | Train Loss: 0.884 Vali Loss: 1.080 Vali Acc: 0.689 Test Loss: 1.080 Test Acc: 0.689
Validation loss decreased (-0.683322 --> -0.688878).  Saving model ...
Epoch: 15 cost time: 0.865588903427124
Epoch: 15, Steps: 12 | Train Loss: 0.779 Vali Loss: 1.000 Vali Acc: 0.722 Test Loss: 1.000 Test Acc: 0.722
Validation loss decreased (-0.688878 --> -0.722212).  Saving model ...
Epoch: 16 cost time: 0.8057830333709717
Epoch: 16, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.934 Vali Acc: 0.733 Test Loss: 0.934 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733324).  Saving model ...
Epoch: 17 cost time: 0.9332773685455322
Epoch: 17, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.876 Vali Acc: 0.733 Test Loss: 0.876 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733325).  Saving model ...
Epoch: 18 cost time: 0.9039716720581055
Epoch: 18, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.811 Vali Acc: 0.750 Test Loss: 0.811 Test Acc: 0.750
Validation loss decreased (-0.733325 --> -0.749992).  Saving model ...
Epoch: 19 cost time: 0.8664455413818359
Epoch: 19, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.761 Vali Acc: 0.767 Test Loss: 0.761 Test Acc: 0.767
Validation loss decreased (-0.749992 --> -0.766659).  Saving model ...
Epoch: 20 cost time: 0.8276333808898926
Epoch: 20, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.733 Vali Acc: 0.789 Test Loss: 0.733 Test Acc: 0.789
Validation loss decreased (-0.766659 --> -0.788882).  Saving model ...
Epoch: 21 cost time: 0.8268702030181885
Epoch: 21, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.690 Vali Acc: 0.794 Test Loss: 0.690 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794438).  Saving model ...
Epoch: 22 cost time: 0.7490239143371582
Epoch: 22, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.649 Vali Acc: 0.811 Test Loss: 0.649 Test Acc: 0.811
Validation loss decreased (-0.794438 --> -0.811105).  Saving model ...
Epoch: 23 cost time: 0.7541849613189697
Epoch: 23, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.602 Vali Acc: 0.822 Test Loss: 0.602 Test Acc: 0.822
Validation loss decreased (-0.811105 --> -0.822216).  Saving model ...
Epoch: 24 cost time: 0.8579535484313965
Epoch: 24, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.582 Vali Acc: 0.839 Test Loss: 0.582 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 25 cost time: 0.9119677543640137
Epoch: 25, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.555 Vali Acc: 0.839 Test Loss: 0.555 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 26 cost time: 0.8725638389587402
Epoch: 26, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.532 Vali Acc: 0.839 Test Loss: 0.532 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838884).  Saving model ...
Epoch: 27 cost time: 0.927809476852417
Epoch: 27, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.518 Vali Acc: 0.844 Test Loss: 0.518 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844439).  Saving model ...
Epoch: 28 cost time: 0.9076023101806641
Epoch: 28, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.524 Vali Acc: 0.839 Test Loss: 0.524 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8684725761413574
Epoch: 29, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.514 Vali Acc: 0.844 Test Loss: 0.514 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 30 cost time: 0.7426097393035889
Epoch: 30, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.488 Vali Acc: 0.856 Test Loss: 0.488 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855551).  Saving model ...
Epoch: 31 cost time: 0.9261868000030518
Epoch: 31, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.474 Vali Acc: 0.844 Test Loss: 0.474 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8680469989776611
Epoch: 32, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.470 Vali Acc: 0.856 Test Loss: 0.470 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 33 cost time: 0.8599298000335693
Epoch: 33, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.459 Vali Acc: 0.861 Test Loss: 0.459 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861107).  Saving model ...
Epoch: 34 cost time: 0.8501737117767334
Epoch: 34, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.460 Vali Acc: 0.856 Test Loss: 0.460 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8583686351776123
Epoch: 35, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.460 Vali Acc: 0.861 Test Loss: 0.460 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8502340316772461
Epoch: 36, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.453 Vali Acc: 0.856 Test Loss: 0.453 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8675425052642822
Epoch: 37, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.451 Vali Acc: 0.867 Test Loss: 0.451 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866662).  Saving model ...
Epoch: 38 cost time: 0.8673789501190186
Epoch: 38, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.447 Vali Acc: 0.856 Test Loss: 0.447 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8797211647033691
Epoch: 39, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.460 Vali Acc: 0.856 Test Loss: 0.460 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9926128387451172
Epoch: 40, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.472 Vali Acc: 0.872 Test Loss: 0.472 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 41 cost time: 0.9276859760284424
Epoch: 41, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.457 Vali Acc: 0.872 Test Loss: 0.457 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872218).  Saving model ...
Epoch: 42 cost time: 0.9603278636932373
Epoch: 42, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.458 Vali Acc: 0.878 Test Loss: 0.458 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877773).  Saving model ...
Epoch: 43 cost time: 0.8820998668670654
Epoch: 43, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.468 Vali Acc: 0.872 Test Loss: 0.468 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8933253288269043
Epoch: 44, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.461 Vali Acc: 0.883 Test Loss: 0.461 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 45 cost time: 0.9236326217651367
Epoch: 45, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.461 Vali Acc: 0.861 Test Loss: 0.461 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8835282325744629
Epoch: 46, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.466 Vali Acc: 0.883 Test Loss: 0.466 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8563823699951172
Epoch: 47, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.481 Vali Acc: 0.872 Test Loss: 0.481 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8356406688690186
Epoch: 48, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.483 Vali Acc: 0.878 Test Loss: 0.483 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8797039985656738
Epoch: 49, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.501 Vali Acc: 0.872 Test Loss: 0.501 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.9169840812683105
Epoch: 50, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.460 Vali Acc: 0.867 Test Loss: 0.460 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 132623
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1594302654266357
Epoch: 1, Steps: 12 | Train Loss: 2.718 Vali Loss: 2.686 Vali Acc: 0.078 Test Loss: 2.686 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 0.8593316078186035
Epoch: 2, Steps: 12 | Train Loss: 2.690 Vali Loss: 2.629 Vali Acc: 0.128 Test Loss: 2.629 Test Acc: 0.128
Validation loss decreased (-0.077751 --> -0.127751).  Saving model ...
Epoch: 3 cost time: 0.9340283870697021
Epoch: 3, Steps: 12 | Train Loss: 2.598 Vali Loss: 2.533 Vali Acc: 0.267 Test Loss: 2.533 Test Acc: 0.267
Validation loss decreased (-0.127751 --> -0.266641).  Saving model ...
Epoch: 4 cost time: 0.9468348026275635
Epoch: 4, Steps: 12 | Train Loss: 2.477 Vali Loss: 2.406 Vali Acc: 0.422 Test Loss: 2.406 Test Acc: 0.422
Validation loss decreased (-0.266641 --> -0.422198).  Saving model ...
Epoch: 5 cost time: 0.9057707786560059
Epoch: 5, Steps: 12 | Train Loss: 2.351 Vali Loss: 2.269 Vali Acc: 0.533 Test Loss: 2.269 Test Acc: 0.533
Validation loss decreased (-0.422198 --> -0.533311).  Saving model ...
Epoch: 6 cost time: 0.890413761138916
Epoch: 6, Steps: 12 | Train Loss: 2.230 Vali Loss: 2.139 Vali Acc: 0.589 Test Loss: 2.139 Test Acc: 0.589
Validation loss decreased (-0.533311 --> -0.588867).  Saving model ...
Epoch: 7 cost time: 0.8792381286621094
Epoch: 7, Steps: 12 | Train Loss: 2.056 Vali Loss: 1.984 Vali Acc: 0.572 Test Loss: 1.984 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8050036430358887
Epoch: 8, Steps: 12 | Train Loss: 1.863 Vali Loss: 1.817 Vali Acc: 0.611 Test Loss: 1.817 Test Acc: 0.611
Validation loss decreased (-0.588867 --> -0.611093).  Saving model ...
Epoch: 9 cost time: 0.8205864429473877
Epoch: 9, Steps: 12 | Train Loss: 1.671 Vali Loss: 1.654 Vali Acc: 0.639 Test Loss: 1.654 Test Acc: 0.639
Validation loss decreased (-0.611093 --> -0.638872).  Saving model ...
Epoch: 10 cost time: 0.8498532772064209
Epoch: 10, Steps: 12 | Train Loss: 1.480 Vali Loss: 1.490 Vali Acc: 0.656 Test Loss: 1.490 Test Acc: 0.656
Validation loss decreased (-0.638872 --> -0.655541).  Saving model ...
Epoch: 11 cost time: 0.7778892517089844
Epoch: 11, Steps: 12 | Train Loss: 1.311 Vali Loss: 1.347 Vali Acc: 0.661 Test Loss: 1.347 Test Acc: 0.661
Validation loss decreased (-0.655541 --> -0.661098).  Saving model ...
Epoch: 12 cost time: 0.7965023517608643
Epoch: 12, Steps: 12 | Train Loss: 1.168 Vali Loss: 1.249 Vali Acc: 0.672 Test Loss: 1.249 Test Acc: 0.672
Validation loss decreased (-0.661098 --> -0.672210).  Saving model ...
Epoch: 13 cost time: 0.8154723644256592
Epoch: 13, Steps: 12 | Train Loss: 1.041 Vali Loss: 1.158 Vali Acc: 0.706 Test Loss: 1.158 Test Acc: 0.706
Validation loss decreased (-0.672210 --> -0.705544).  Saving model ...
Epoch: 14 cost time: 0.7904860973358154
Epoch: 14, Steps: 12 | Train Loss: 0.953 Vali Loss: 1.068 Vali Acc: 0.711 Test Loss: 1.068 Test Acc: 0.711
Validation loss decreased (-0.705544 --> -0.711100).  Saving model ...
Epoch: 15 cost time: 0.7920176982879639
Epoch: 15, Steps: 12 | Train Loss: 0.812 Vali Loss: 0.979 Vali Acc: 0.728 Test Loss: 0.979 Test Acc: 0.728
Validation loss decreased (-0.711100 --> -0.727768).  Saving model ...
Epoch: 16 cost time: 0.876349687576294
Epoch: 16, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.930 Vali Acc: 0.733 Test Loss: 0.930 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733324).  Saving model ...
Epoch: 17 cost time: 0.9054419994354248
Epoch: 17, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.865 Vali Acc: 0.739 Test Loss: 0.865 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738880).  Saving model ...
Epoch: 18 cost time: 0.965162992477417
Epoch: 18, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.816 Vali Acc: 0.761 Test Loss: 0.816 Test Acc: 0.761
Validation loss decreased (-0.738880 --> -0.761103).  Saving model ...
Epoch: 19 cost time: 0.9245941638946533
Epoch: 19, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.774 Vali Acc: 0.772 Test Loss: 0.774 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772214).  Saving model ...
Epoch: 20 cost time: 1.0418784618377686
Epoch: 20, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.733 Vali Acc: 0.794 Test Loss: 0.733 Test Acc: 0.794
Validation loss decreased (-0.772214 --> -0.794437).  Saving model ...
Epoch: 21 cost time: 0.9283192157745361
Epoch: 21, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.706 Vali Acc: 0.817 Test Loss: 0.706 Test Acc: 0.817
Validation loss decreased (-0.794437 --> -0.816660).  Saving model ...
Epoch: 22 cost time: 0.9443047046661377
Epoch: 22, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.668 Vali Acc: 0.817 Test Loss: 0.668 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 23 cost time: 1.05035400390625
Epoch: 23, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.633 Vali Acc: 0.833 Test Loss: 0.633 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 24 cost time: 0.9791874885559082
Epoch: 24, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.641 Vali Acc: 0.828 Test Loss: 0.641 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9478297233581543
Epoch: 25, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.605 Vali Acc: 0.833 Test Loss: 0.605 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 26 cost time: 0.9083940982818604
Epoch: 26, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.585 Vali Acc: 0.839 Test Loss: 0.585 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 27 cost time: 0.9294052124023438
Epoch: 27, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.565 Vali Acc: 0.856 Test Loss: 0.565 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 28 cost time: 0.9872443675994873
Epoch: 28, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 29 cost time: 0.9142978191375732
Epoch: 29, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9595870971679688
Epoch: 30, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.531 Vali Acc: 0.844 Test Loss: 0.531 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0375018119812012
Epoch: 31, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.537 Vali Acc: 0.861 Test Loss: 0.537 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 32 cost time: 0.9206447601318359
Epoch: 32, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.892967939376831
Epoch: 33, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9592869281768799
Epoch: 34, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.530 Vali Acc: 0.861 Test Loss: 0.530 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 35 cost time: 0.9029359817504883
Epoch: 35, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.526 Vali Acc: 0.861 Test Loss: 0.526 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 36 cost time: 0.8953061103820801
Epoch: 36, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.529 Vali Acc: 0.861 Test Loss: 0.529 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9478695392608643
Epoch: 37, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.522 Vali Acc: 0.856 Test Loss: 0.522 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.962033748626709
Epoch: 38, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.537 Vali Acc: 0.878 Test Loss: 0.537 Test Acc: 0.878
Validation loss decreased (-0.861106 --> -0.877772).  Saving model ...
Epoch: 39 cost time: 0.9340803623199463
Epoch: 39, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.534 Vali Acc: 0.889 Test Loss: 0.534 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888884).  Saving model ...
Epoch: 40 cost time: 0.9759736061096191
Epoch: 40, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9822759628295898
Epoch: 41, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.546 Vali Acc: 0.867 Test Loss: 0.546 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8587000370025635
Epoch: 42, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9332115650177002
Epoch: 43, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.520 Vali Acc: 0.872 Test Loss: 0.520 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.9137840270996094
Epoch: 44, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.521 Vali Acc: 0.883 Test Loss: 0.521 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8360450267791748
Epoch: 45, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.527 Vali Acc: 0.878 Test Loss: 0.527 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8946270942687988
Epoch: 46, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.540 Vali Acc: 0.878 Test Loss: 0.540 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.9123408794403076
Epoch: 47, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.559 Vali Acc: 0.878 Test Loss: 0.559 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.913848876953125
Epoch: 48, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.539 Vali Acc: 0.878 Test Loss: 0.539 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.9679667949676514
Epoch: 49, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.553 Vali Acc: 0.872 Test Loss: 0.553 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 132687
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1791985034942627
Epoch: 1, Steps: 12 | Train Loss: 2.770 Vali Loss: 2.715 Vali Acc: 0.039 Test Loss: 2.715 Test Acc: 0.039
Validation loss decreased (inf --> -0.038862).  Saving model ...
Epoch: 2 cost time: 0.9497158527374268
Epoch: 2, Steps: 12 | Train Loss: 2.719 Vali Loss: 2.686 Vali Acc: 0.061 Test Loss: 2.686 Test Acc: 0.061
Validation loss decreased (-0.038862 --> -0.061084).  Saving model ...
Epoch: 3 cost time: 0.9296324253082275
Epoch: 3, Steps: 12 | Train Loss: 2.638 Vali Loss: 2.619 Vali Acc: 0.072 Test Loss: 2.619 Test Acc: 0.072
Validation loss decreased (-0.061084 --> -0.072196).  Saving model ...
Epoch: 4 cost time: 0.94651198387146
Epoch: 4, Steps: 12 | Train Loss: 2.533 Vali Loss: 2.523 Vali Acc: 0.211 Test Loss: 2.523 Test Acc: 0.211
Validation loss decreased (-0.072196 --> -0.211086).  Saving model ...
Epoch: 5 cost time: 0.9252924919128418
Epoch: 5, Steps: 12 | Train Loss: 2.416 Vali Loss: 2.427 Vali Acc: 0.422 Test Loss: 2.427 Test Acc: 0.422
Validation loss decreased (-0.211086 --> -0.422198).  Saving model ...
Epoch: 6 cost time: 0.9168031215667725
Epoch: 6, Steps: 12 | Train Loss: 2.303 Vali Loss: 2.304 Vali Acc: 0.511 Test Loss: 2.304 Test Acc: 0.511
Validation loss decreased (-0.422198 --> -0.511088).  Saving model ...
Epoch: 7 cost time: 0.9000892639160156
Epoch: 7, Steps: 12 | Train Loss: 2.190 Vali Loss: 2.188 Vali Acc: 0.556 Test Loss: 2.188 Test Acc: 0.556
Validation loss decreased (-0.511088 --> -0.555534).  Saving model ...
Epoch: 8 cost time: 0.8858568668365479
Epoch: 8, Steps: 12 | Train Loss: 2.024 Vali Loss: 2.073 Vali Acc: 0.572 Test Loss: 2.073 Test Acc: 0.572
Validation loss decreased (-0.555534 --> -0.572201).  Saving model ...
Epoch: 9 cost time: 0.9289071559906006
Epoch: 9, Steps: 12 | Train Loss: 1.841 Vali Loss: 1.907 Vali Acc: 0.589 Test Loss: 1.907 Test Acc: 0.589
Validation loss decreased (-0.572201 --> -0.588870).  Saving model ...
Epoch: 10 cost time: 0.8908741474151611
Epoch: 10, Steps: 12 | Train Loss: 1.719 Vali Loss: 1.733 Vali Acc: 0.594 Test Loss: 1.733 Test Acc: 0.594
Validation loss decreased (-0.588870 --> -0.594427).  Saving model ...
Epoch: 11 cost time: 0.8968396186828613
Epoch: 11, Steps: 12 | Train Loss: 1.557 Vali Loss: 1.588 Vali Acc: 0.633 Test Loss: 1.588 Test Acc: 0.633
Validation loss decreased (-0.594427 --> -0.633317).  Saving model ...
Epoch: 12 cost time: 0.9278833866119385
Epoch: 12, Steps: 12 | Train Loss: 1.350 Vali Loss: 1.454 Vali Acc: 0.667 Test Loss: 1.454 Test Acc: 0.667
Validation loss decreased (-0.633317 --> -0.666652).  Saving model ...
Epoch: 13 cost time: 0.9390456676483154
Epoch: 13, Steps: 12 | Train Loss: 1.180 Vali Loss: 1.317 Vali Acc: 0.694 Test Loss: 1.317 Test Acc: 0.694
Validation loss decreased (-0.666652 --> -0.694431).  Saving model ...
Epoch: 14 cost time: 0.9090054035186768
Epoch: 14, Steps: 12 | Train Loss: 1.085 Vali Loss: 1.217 Vali Acc: 0.706 Test Loss: 1.217 Test Acc: 0.706
Validation loss decreased (-0.694431 --> -0.705543).  Saving model ...
Epoch: 15 cost time: 0.8857376575469971
Epoch: 15, Steps: 12 | Train Loss: 0.945 Vali Loss: 1.109 Vali Acc: 0.722 Test Loss: 1.109 Test Acc: 0.722
Validation loss decreased (-0.705543 --> -0.722211).  Saving model ...
Epoch: 16 cost time: 0.9019508361816406
Epoch: 16, Steps: 12 | Train Loss: 0.834 Vali Loss: 1.027 Vali Acc: 0.733 Test Loss: 1.027 Test Acc: 0.733
Validation loss decreased (-0.722211 --> -0.733323).  Saving model ...
Epoch: 17 cost time: 0.9037718772888184
Epoch: 17, Steps: 12 | Train Loss: 0.741 Vali Loss: 0.963 Vali Acc: 0.756 Test Loss: 0.963 Test Acc: 0.756
Validation loss decreased (-0.733323 --> -0.755546).  Saving model ...
Epoch: 18 cost time: 0.9259028434753418
Epoch: 18, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.895 Vali Acc: 0.778 Test Loss: 0.895 Test Acc: 0.778
Validation loss decreased (-0.755546 --> -0.777769).  Saving model ...
Epoch: 19 cost time: 0.930417537689209
Epoch: 19, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.848 Vali Acc: 0.778 Test Loss: 0.848 Test Acc: 0.778
Validation loss decreased (-0.777769 --> -0.777769).  Saving model ...
Epoch: 20 cost time: 0.8971192836761475
Epoch: 20, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.795 Vali Acc: 0.772 Test Loss: 0.795 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9784915447235107
Epoch: 21, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.752 Vali Acc: 0.778 Test Loss: 0.752 Test Acc: 0.778
Validation loss decreased (-0.777769 --> -0.777770).  Saving model ...
Epoch: 22 cost time: 0.9497969150543213
Epoch: 22, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.722 Vali Acc: 0.789 Test Loss: 0.722 Test Acc: 0.789
Validation loss decreased (-0.777770 --> -0.788882).  Saving model ...
Epoch: 23 cost time: 0.9682161808013916
Epoch: 23, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.705 Vali Acc: 0.800 Test Loss: 0.705 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 24 cost time: 0.8893775939941406
Epoch: 24, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.676 Vali Acc: 0.828 Test Loss: 0.676 Test Acc: 0.828
Validation loss decreased (-0.799993 --> -0.827771).  Saving model ...
Epoch: 25 cost time: 0.9089539051055908
Epoch: 25, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.636 Vali Acc: 0.850 Test Loss: 0.636 Test Acc: 0.850
Validation loss decreased (-0.827771 --> -0.849994).  Saving model ...
Epoch: 26 cost time: 0.8967652320861816
Epoch: 26, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 27 cost time: 0.9566349983215332
Epoch: 27, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.612 Vali Acc: 0.833 Test Loss: 0.612 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9447164535522461
Epoch: 28, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.596 Vali Acc: 0.844 Test Loss: 0.596 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9065654277801514
Epoch: 29, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 30 cost time: 0.950554370880127
Epoch: 30, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.580 Vali Acc: 0.839 Test Loss: 0.580 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.024315357208252
Epoch: 31, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.570 Vali Acc: 0.844 Test Loss: 0.570 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.985621452331543
Epoch: 32, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.546 Vali Acc: 0.861 Test Loss: 0.546 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 33 cost time: 0.9527621269226074
Epoch: 33, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.549 Vali Acc: 0.867 Test Loss: 0.549 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 34 cost time: 0.9357051849365234
Epoch: 34, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.525 Vali Acc: 0.867 Test Loss: 0.525 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 35 cost time: 0.9918231964111328
Epoch: 35, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.534 Vali Acc: 0.861 Test Loss: 0.534 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9558396339416504
Epoch: 36, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8837399482727051
Epoch: 37, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.517 Vali Acc: 0.867 Test Loss: 0.517 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 38 cost time: 0.9278929233551025
Epoch: 38, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.518 Vali Acc: 0.872 Test Loss: 0.518 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 39 cost time: 0.9470984935760498
Epoch: 39, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.517 Vali Acc: 0.872 Test Loss: 0.517 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 40 cost time: 0.9948275089263916
Epoch: 40, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.538 Vali Acc: 0.867 Test Loss: 0.538 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9973623752593994
Epoch: 41, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.532 Vali Acc: 0.861 Test Loss: 0.532 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8860955238342285
Epoch: 42, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.542 Vali Acc: 0.872 Test Loss: 0.542 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0050303936004639
Epoch: 43, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.546 Vali Acc: 0.872 Test Loss: 0.546 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.9489381313323975
Epoch: 44, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.535 Vali Acc: 0.878 Test Loss: 0.535 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 45 cost time: 0.9953658580780029
Epoch: 45, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.522 Vali Acc: 0.878 Test Loss: 0.522 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877773).  Saving model ...
Epoch: 46 cost time: 0.9584240913391113
Epoch: 46, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.533 Vali Acc: 0.878 Test Loss: 0.533 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9226334095001221
Epoch: 47, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.543 Vali Acc: 0.867 Test Loss: 0.543 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9229080677032471
Epoch: 48, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.536 Vali Acc: 0.867 Test Loss: 0.536 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9123537540435791
Epoch: 49, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.543 Vali Acc: 0.872 Test Loss: 0.543 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.9755723476409912
Epoch: 50, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.555 Vali Acc: 0.878 Test Loss: 0.555 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 128943
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.205237627029419
Epoch: 1, Steps: 12 | Train Loss: 2.698 Vali Loss: 2.679 Vali Acc: 0.094 Test Loss: 2.679 Test Acc: 0.094
Validation loss decreased (inf --> -0.094418).  Saving model ...
Epoch: 2 cost time: 0.9679157733917236
Epoch: 2, Steps: 12 | Train Loss: 2.587 Vali Loss: 2.578 Vali Acc: 0.333 Test Loss: 2.578 Test Acc: 0.333
Validation loss decreased (-0.094418 --> -0.333308).  Saving model ...
Epoch: 3 cost time: 1.0824589729309082
Epoch: 3, Steps: 12 | Train Loss: 2.401 Vali Loss: 2.399 Vali Acc: 0.456 Test Loss: 2.399 Test Acc: 0.456
Validation loss decreased (-0.333308 --> -0.455532).  Saving model ...
Epoch: 4 cost time: 0.9489202499389648
Epoch: 4, Steps: 12 | Train Loss: 2.204 Vali Loss: 2.134 Vali Acc: 0.550 Test Loss: 2.134 Test Acc: 0.550
Validation loss decreased (-0.455532 --> -0.549979).  Saving model ...
Epoch: 5 cost time: 0.9406554698944092
Epoch: 5, Steps: 12 | Train Loss: 1.897 Vali Loss: 1.844 Vali Acc: 0.600 Test Loss: 1.844 Test Acc: 0.600
Validation loss decreased (-0.549979 --> -0.599982).  Saving model ...
Epoch: 6 cost time: 0.9587996006011963
Epoch: 6, Steps: 12 | Train Loss: 1.576 Vali Loss: 1.552 Vali Acc: 0.633 Test Loss: 1.552 Test Acc: 0.633
Validation loss decreased (-0.599982 --> -0.633318).  Saving model ...
Epoch: 7 cost time: 0.9874053001403809
Epoch: 7, Steps: 12 | Train Loss: 1.250 Vali Loss: 1.332 Vali Acc: 0.639 Test Loss: 1.332 Test Acc: 0.639
Validation loss decreased (-0.633318 --> -0.638876).  Saving model ...
Epoch: 8 cost time: 1.0484354496002197
Epoch: 8, Steps: 12 | Train Loss: 1.064 Vali Loss: 1.183 Vali Acc: 0.672 Test Loss: 1.183 Test Acc: 0.672
Validation loss decreased (-0.638876 --> -0.672210).  Saving model ...
Epoch: 9 cost time: 0.9789721965789795
Epoch: 9, Steps: 12 | Train Loss: 0.836 Vali Loss: 1.042 Vali Acc: 0.706 Test Loss: 1.042 Test Acc: 0.706
Validation loss decreased (-0.672210 --> -0.705545).  Saving model ...
Epoch: 10 cost time: 0.9726424217224121
Epoch: 10, Steps: 12 | Train Loss: 0.778 Vali Loss: 0.938 Vali Acc: 0.717 Test Loss: 0.938 Test Acc: 0.717
Validation loss decreased (-0.705545 --> -0.716657).  Saving model ...
Epoch: 11 cost time: 0.9596989154815674
Epoch: 11, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.856 Vali Acc: 0.722 Test Loss: 0.856 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722214).  Saving model ...
Epoch: 12 cost time: 0.9783847332000732
Epoch: 12, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.785 Vali Acc: 0.756 Test Loss: 0.785 Test Acc: 0.756
Validation loss decreased (-0.722214 --> -0.755548).  Saving model ...
Epoch: 13 cost time: 0.9843461513519287
Epoch: 13, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.752 Vali Acc: 0.772 Test Loss: 0.752 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772215).  Saving model ...
Epoch: 14 cost time: 0.9077250957489014
Epoch: 14, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.701 Vali Acc: 0.811 Test Loss: 0.701 Test Acc: 0.811
Validation loss decreased (-0.772215 --> -0.811104).  Saving model ...
Epoch: 15 cost time: 1.039595365524292
Epoch: 15, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.672 Vali Acc: 0.833 Test Loss: 0.672 Test Acc: 0.833
Validation loss decreased (-0.811104 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 1.0273816585540771
Epoch: 16, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.630 Vali Acc: 0.839 Test Loss: 0.630 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 17 cost time: 1.0587918758392334
Epoch: 17, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 0.9458386898040771
Epoch: 18, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9783382415771484
Epoch: 19, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.601 Vali Acc: 0.872 Test Loss: 0.601 Test Acc: 0.872
Validation loss decreased (-0.849994 --> -0.872216).  Saving model ...
Epoch: 20 cost time: 0.8984684944152832
Epoch: 20, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.602 Vali Acc: 0.861 Test Loss: 0.602 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9158492088317871
Epoch: 21, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.615 Vali Acc: 0.861 Test Loss: 0.615 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.059128999710083
Epoch: 22, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.610 Vali Acc: 0.861 Test Loss: 0.610 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8521270751953125
Epoch: 23, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.629 Vali Acc: 0.861 Test Loss: 0.629 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9384846687316895
Epoch: 24, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.626 Vali Acc: 0.878 Test Loss: 0.626 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 25 cost time: 0.9466903209686279
Epoch: 25, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.632 Vali Acc: 0.867 Test Loss: 0.632 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9266953468322754
Epoch: 26, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.666 Vali Acc: 0.867 Test Loss: 0.666 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9794466495513916
Epoch: 27, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.633 Vali Acc: 0.878 Test Loss: 0.633 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0023736953735352
Epoch: 28, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.644 Vali Acc: 0.872 Test Loss: 0.644 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9811921119689941
Epoch: 29, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.679 Vali Acc: 0.883 Test Loss: 0.679 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 30 cost time: 1.0212717056274414
Epoch: 30, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.674 Vali Acc: 0.861 Test Loss: 0.674 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9997546672821045
Epoch: 31, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.670 Vali Acc: 0.856 Test Loss: 0.670 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.997675895690918
Epoch: 32, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.689 Vali Acc: 0.889 Test Loss: 0.689 Test Acc: 0.889
Validation loss decreased (-0.883327 --> -0.888882).  Saving model ...
Epoch: 33 cost time: 0.9613137245178223
Epoch: 33, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.707 Vali Acc: 0.872 Test Loss: 0.707 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9594056606292725
Epoch: 34, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.688 Vali Acc: 0.878 Test Loss: 0.688 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9812426567077637
Epoch: 35, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.663 Vali Acc: 0.883 Test Loss: 0.663 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.015479326248169
Epoch: 36, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.665 Vali Acc: 0.883 Test Loss: 0.665 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9713101387023926
Epoch: 37, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.686 Vali Acc: 0.883 Test Loss: 0.686 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9627511501312256
Epoch: 38, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.743 Vali Acc: 0.872 Test Loss: 0.743 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9218287467956543
Epoch: 39, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.730 Vali Acc: 0.878 Test Loss: 0.730 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9124493598937988
Epoch: 40, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.699 Vali Acc: 0.883 Test Loss: 0.699 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9213306903839111
Epoch: 41, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.709 Vali Acc: 0.883 Test Loss: 0.709 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.9386065006256104
Epoch: 42, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.731 Vali Acc: 0.872 Test Loss: 0.731 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 165231
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2373175621032715
Epoch: 1, Steps: 12 | Train Loss: 2.689 Vali Loss: 2.681 Vali Acc: 0.117 Test Loss: 2.681 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 0.9504127502441406
Epoch: 2, Steps: 12 | Train Loss: 2.622 Vali Loss: 2.618 Vali Acc: 0.217 Test Loss: 2.618 Test Acc: 0.217
Validation loss decreased (-0.116640 --> -0.216640).  Saving model ...
Epoch: 3 cost time: 0.9756290912628174
Epoch: 3, Steps: 12 | Train Loss: 2.496 Vali Loss: 2.512 Vali Acc: 0.383 Test Loss: 2.512 Test Acc: 0.383
Validation loss decreased (-0.216640 --> -0.383308).  Saving model ...
Epoch: 4 cost time: 0.9546389579772949
Epoch: 4, Steps: 12 | Train Loss: 2.361 Vali Loss: 2.361 Vali Acc: 0.467 Test Loss: 2.361 Test Acc: 0.467
Validation loss decreased (-0.383308 --> -0.466643).  Saving model ...
Epoch: 5 cost time: 0.9160563945770264
Epoch: 5, Steps: 12 | Train Loss: 2.215 Vali Loss: 2.173 Vali Acc: 0.511 Test Loss: 2.173 Test Acc: 0.511
Validation loss decreased (-0.466643 --> -0.511089).  Saving model ...
Epoch: 6 cost time: 1.028031349182129
Epoch: 6, Steps: 12 | Train Loss: 1.975 Vali Loss: 1.961 Vali Acc: 0.561 Test Loss: 1.961 Test Acc: 0.561
Validation loss decreased (-0.511089 --> -0.561092).  Saving model ...
Epoch: 7 cost time: 0.9552457332611084
Epoch: 7, Steps: 12 | Train Loss: 1.752 Vali Loss: 1.748 Vali Acc: 0.567 Test Loss: 1.748 Test Acc: 0.567
Validation loss decreased (-0.561092 --> -0.566649).  Saving model ...
Epoch: 8 cost time: 1.008131980895996
Epoch: 8, Steps: 12 | Train Loss: 1.529 Vali Loss: 1.567 Vali Acc: 0.617 Test Loss: 1.567 Test Acc: 0.617
Validation loss decreased (-0.566649 --> -0.616651).  Saving model ...
Epoch: 9 cost time: 1.0577888488769531
Epoch: 9, Steps: 12 | Train Loss: 1.293 Vali Loss: 1.398 Vali Acc: 0.644 Test Loss: 1.398 Test Acc: 0.644
Validation loss decreased (-0.616651 --> -0.644430).  Saving model ...
Epoch: 10 cost time: 0.971388578414917
Epoch: 10, Steps: 12 | Train Loss: 1.157 Vali Loss: 1.271 Vali Acc: 0.672 Test Loss: 1.271 Test Acc: 0.672
Validation loss decreased (-0.644430 --> -0.672210).  Saving model ...
Epoch: 11 cost time: 1.0358176231384277
Epoch: 11, Steps: 12 | Train Loss: 0.946 Vali Loss: 1.163 Vali Acc: 0.661 Test Loss: 1.163 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9533419609069824
Epoch: 12, Steps: 12 | Train Loss: 0.793 Vali Loss: 1.038 Vali Acc: 0.683 Test Loss: 1.038 Test Acc: 0.683
Validation loss decreased (-0.672210 --> -0.683323).  Saving model ...
Epoch: 13 cost time: 0.9629886150360107
Epoch: 13, Steps: 12 | Train Loss: 0.758 Vali Loss: 0.959 Vali Acc: 0.700 Test Loss: 0.959 Test Acc: 0.700
Validation loss decreased (-0.683323 --> -0.699990).  Saving model ...
Epoch: 14 cost time: 1.076296329498291
Epoch: 14, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.896 Vali Acc: 0.717 Test Loss: 0.896 Test Acc: 0.717
Validation loss decreased (-0.699990 --> -0.716658).  Saving model ...
Epoch: 15 cost time: 1.0060405731201172
Epoch: 15, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.825 Vali Acc: 0.761 Test Loss: 0.825 Test Acc: 0.761
Validation loss decreased (-0.716658 --> -0.761103).  Saving model ...
Epoch: 16 cost time: 0.9329001903533936
Epoch: 16, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.773 Vali Acc: 0.778 Test Loss: 0.773 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777770).  Saving model ...
Epoch: 17 cost time: 1.0289270877838135
Epoch: 17, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.746 Vali Acc: 0.789 Test Loss: 0.746 Test Acc: 0.789
Validation loss decreased (-0.777770 --> -0.788881).  Saving model ...
Epoch: 18 cost time: 0.9930391311645508
Epoch: 18, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.708 Vali Acc: 0.811 Test Loss: 0.708 Test Acc: 0.811
Validation loss decreased (-0.788881 --> -0.811104).  Saving model ...
Epoch: 19 cost time: 1.012361764907837
Epoch: 19, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.668 Vali Acc: 0.811 Test Loss: 0.668 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 20 cost time: 0.968994140625
Epoch: 20, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.632 Vali Acc: 0.822 Test Loss: 0.632 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822216).  Saving model ...
Epoch: 21 cost time: 1.0003514289855957
Epoch: 21, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.624 Vali Acc: 0.844 Test Loss: 0.624 Test Acc: 0.844
Validation loss decreased (-0.822216 --> -0.844438).  Saving model ...
Epoch: 22 cost time: 0.989281177520752
Epoch: 22, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.601 Vali Acc: 0.844 Test Loss: 0.601 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 23 cost time: 1.0047612190246582
Epoch: 23, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 24 cost time: 0.9871401786804199
Epoch: 24, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.573 Vali Acc: 0.856 Test Loss: 0.573 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 25 cost time: 1.0255732536315918
Epoch: 25, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.560 Vali Acc: 0.867 Test Loss: 0.560 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 26 cost time: 0.9543168544769287
Epoch: 26, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9985034465789795
Epoch: 27, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9537851810455322
Epoch: 28, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.566 Vali Acc: 0.856 Test Loss: 0.566 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9664490222930908
Epoch: 29, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.562 Vali Acc: 0.867 Test Loss: 0.562 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9764730930328369
Epoch: 30, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.555 Vali Acc: 0.861 Test Loss: 0.555 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9542160034179688
Epoch: 31, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.567 Vali Acc: 0.867 Test Loss: 0.567 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9485526084899902
Epoch: 32, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.555 Vali Acc: 0.861 Test Loss: 0.555 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9691798686981201
Epoch: 33, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.589 Vali Acc: 0.861 Test Loss: 0.589 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9650042057037354
Epoch: 34, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.590 Vali Acc: 0.867 Test Loss: 0.590 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9380080699920654
Epoch: 35, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.599 Vali Acc: 0.856 Test Loss: 0.599 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 142223
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2957494258880615
Epoch: 1, Steps: 12 | Train Loss: 2.711 Vali Loss: 2.712 Vali Acc: 0.056 Test Loss: 2.712 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 0.9492249488830566
Epoch: 2, Steps: 12 | Train Loss: 2.652 Vali Loss: 2.634 Vali Acc: 0.211 Test Loss: 2.634 Test Acc: 0.211
Validation loss decreased (-0.055528 --> -0.211085).  Saving model ...
Epoch: 3 cost time: 1.0109782218933105
Epoch: 3, Steps: 12 | Train Loss: 2.556 Vali Loss: 2.507 Vali Acc: 0.339 Test Loss: 2.507 Test Acc: 0.339
Validation loss decreased (-0.211085 --> -0.338864).  Saving model ...
Epoch: 4 cost time: 0.9437777996063232
Epoch: 4, Steps: 12 | Train Loss: 2.385 Vali Loss: 2.344 Vali Acc: 0.506 Test Loss: 2.344 Test Acc: 0.506
Validation loss decreased (-0.338864 --> -0.505532).  Saving model ...
Epoch: 5 cost time: 0.9742214679718018
Epoch: 5, Steps: 12 | Train Loss: 2.218 Vali Loss: 2.157 Vali Acc: 0.517 Test Loss: 2.157 Test Acc: 0.517
Validation loss decreased (-0.505532 --> -0.516645).  Saving model ...
Epoch: 6 cost time: 0.9961690902709961
Epoch: 6, Steps: 12 | Train Loss: 1.977 Vali Loss: 1.957 Vali Acc: 0.572 Test Loss: 1.957 Test Acc: 0.572
Validation loss decreased (-0.516645 --> -0.572203).  Saving model ...
Epoch: 7 cost time: 1.0045392513275146
Epoch: 7, Steps: 12 | Train Loss: 1.787 Vali Loss: 1.747 Vali Acc: 0.583 Test Loss: 1.747 Test Acc: 0.583
Validation loss decreased (-0.572203 --> -0.583316).  Saving model ...
Epoch: 8 cost time: 0.9734523296356201
Epoch: 8, Steps: 12 | Train Loss: 1.519 Vali Loss: 1.522 Vali Acc: 0.611 Test Loss: 1.522 Test Acc: 0.611
Validation loss decreased (-0.583316 --> -0.611096).  Saving model ...
Epoch: 9 cost time: 0.9405457973480225
Epoch: 9, Steps: 12 | Train Loss: 1.343 Vali Loss: 1.355 Vali Acc: 0.661 Test Loss: 1.355 Test Acc: 0.661
Validation loss decreased (-0.611096 --> -0.661098).  Saving model ...
Epoch: 10 cost time: 1.049523115158081
Epoch: 10, Steps: 12 | Train Loss: 1.083 Vali Loss: 1.221 Vali Acc: 0.683 Test Loss: 1.221 Test Acc: 0.683
Validation loss decreased (-0.661098 --> -0.683321).  Saving model ...
Epoch: 11 cost time: 0.9572288990020752
Epoch: 11, Steps: 12 | Train Loss: 0.941 Vali Loss: 1.113 Vali Acc: 0.694 Test Loss: 1.113 Test Acc: 0.694
Validation loss decreased (-0.683321 --> -0.694433).  Saving model ...
Epoch: 12 cost time: 1.028789758682251
Epoch: 12, Steps: 12 | Train Loss: 0.829 Vali Loss: 1.027 Vali Acc: 0.689 Test Loss: 1.027 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1218235492706299
Epoch: 13, Steps: 12 | Train Loss: 0.700 Vali Loss: 0.958 Vali Acc: 0.722 Test Loss: 0.958 Test Acc: 0.722
Validation loss decreased (-0.694433 --> -0.722213).  Saving model ...
Epoch: 14 cost time: 1.0167763233184814
Epoch: 14, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.882 Vali Acc: 0.722 Test Loss: 0.882 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722213).  Saving model ...
Epoch: 15 cost time: 1.017503261566162
Epoch: 15, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.831 Vali Acc: 0.728 Test Loss: 0.831 Test Acc: 0.728
Validation loss decreased (-0.722213 --> -0.727769).  Saving model ...
Epoch: 16 cost time: 1.0132253170013428
Epoch: 16, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.788 Vali Acc: 0.761 Test Loss: 0.788 Test Acc: 0.761
Validation loss decreased (-0.727769 --> -0.761103).  Saving model ...
Epoch: 17 cost time: 1.0475866794586182
Epoch: 17, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.754 Vali Acc: 0.756 Test Loss: 0.754 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0108659267425537
Epoch: 18, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.696 Vali Acc: 0.806 Test Loss: 0.696 Test Acc: 0.806
Validation loss decreased (-0.761103 --> -0.805549).  Saving model ...
Epoch: 19 cost time: 0.9593784809112549
Epoch: 19, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.666 Vali Acc: 0.806 Test Loss: 0.666 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805549).  Saving model ...
Epoch: 20 cost time: 0.9142501354217529
Epoch: 20, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.636 Vali Acc: 0.822 Test Loss: 0.636 Test Acc: 0.822
Validation loss decreased (-0.805549 --> -0.822216).  Saving model ...
Epoch: 21 cost time: 0.9131059646606445
Epoch: 21, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.622 Vali Acc: 0.828 Test Loss: 0.622 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 22 cost time: 0.9126603603363037
Epoch: 22, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.601 Vali Acc: 0.817 Test Loss: 0.601 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9312734603881836
Epoch: 23, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.602 Vali Acc: 0.839 Test Loss: 0.602 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 24 cost time: 0.9976823329925537
Epoch: 24, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.589 Vali Acc: 0.844 Test Loss: 0.589 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 25 cost time: 0.9898345470428467
Epoch: 25, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.566 Vali Acc: 0.844 Test Loss: 0.566 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 26 cost time: 0.987907886505127
Epoch: 26, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.563 Vali Acc: 0.856 Test Loss: 0.563 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 27 cost time: 0.9870216846466064
Epoch: 27, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.573 Vali Acc: 0.861 Test Loss: 0.573 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 28 cost time: 1.0081565380096436
Epoch: 28, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.555 Vali Acc: 0.867 Test Loss: 0.555 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 29 cost time: 1.002847671508789
Epoch: 29, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.587 Vali Acc: 0.861 Test Loss: 0.587 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0021986961364746
Epoch: 30, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.595 Vali Acc: 0.856 Test Loss: 0.595 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9470443725585938
Epoch: 31, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9962267875671387
Epoch: 32, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.632 Vali Acc: 0.856 Test Loss: 0.632 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0489709377288818
Epoch: 33, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9499869346618652
Epoch: 34, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.602 Vali Acc: 0.867 Test Loss: 0.602 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9951157569885254
Epoch: 35, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.604 Vali Acc: 0.867 Test Loss: 0.604 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.9364750385284424
Epoch: 36, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.604 Vali Acc: 0.861 Test Loss: 0.604 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9448246955871582
Epoch: 37, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.626 Vali Acc: 0.867 Test Loss: 0.626 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9666528701782227
Epoch: 38, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.629 Vali Acc: 0.867 Test Loss: 0.629 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 142255
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.20487642288208
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.685 Vali Acc: 0.039 Test Loss: 2.685 Test Acc: 0.039
Validation loss decreased (inf --> -0.038862).  Saving model ...
Epoch: 2 cost time: 0.9373159408569336
Epoch: 2, Steps: 12 | Train Loss: 2.650 Vali Loss: 2.627 Vali Acc: 0.106 Test Loss: 2.627 Test Acc: 0.106
Validation loss decreased (-0.038862 --> -0.105529).  Saving model ...
Epoch: 3 cost time: 0.9433937072753906
Epoch: 3, Steps: 12 | Train Loss: 2.552 Vali Loss: 2.533 Vali Acc: 0.244 Test Loss: 2.533 Test Acc: 0.244
Validation loss decreased (-0.105529 --> -0.244419).  Saving model ...
Epoch: 4 cost time: 0.941586971282959
Epoch: 4, Steps: 12 | Train Loss: 2.425 Vali Loss: 2.408 Vali Acc: 0.361 Test Loss: 2.408 Test Acc: 0.361
Validation loss decreased (-0.244419 --> -0.361087).  Saving model ...
Epoch: 5 cost time: 0.9067387580871582
Epoch: 5, Steps: 12 | Train Loss: 2.326 Vali Loss: 2.253 Vali Acc: 0.467 Test Loss: 2.253 Test Acc: 0.467
Validation loss decreased (-0.361087 --> -0.466644).  Saving model ...
Epoch: 6 cost time: 0.8807270526885986
Epoch: 6, Steps: 12 | Train Loss: 2.119 Vali Loss: 2.101 Vali Acc: 0.517 Test Loss: 2.101 Test Acc: 0.517
Validation loss decreased (-0.466644 --> -0.516646).  Saving model ...
Epoch: 7 cost time: 0.9306912422180176
Epoch: 7, Steps: 12 | Train Loss: 1.944 Vali Loss: 1.909 Vali Acc: 0.544 Test Loss: 1.909 Test Acc: 0.544
Validation loss decreased (-0.516646 --> -0.544425).  Saving model ...
Epoch: 8 cost time: 1.0373408794403076
Epoch: 8, Steps: 12 | Train Loss: 1.709 Vali Loss: 1.739 Vali Acc: 0.611 Test Loss: 1.739 Test Acc: 0.611
Validation loss decreased (-0.544425 --> -0.611094).  Saving model ...
Epoch: 9 cost time: 1.0392093658447266
Epoch: 9, Steps: 12 | Train Loss: 1.512 Vali Loss: 1.570 Vali Acc: 0.617 Test Loss: 1.570 Test Acc: 0.617
Validation loss decreased (-0.611094 --> -0.616651).  Saving model ...
Epoch: 10 cost time: 0.9944932460784912
Epoch: 10, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.418 Vali Acc: 0.667 Test Loss: 1.418 Test Acc: 0.667
Validation loss decreased (-0.616651 --> -0.666652).  Saving model ...
Epoch: 11 cost time: 0.9470498561859131
Epoch: 11, Steps: 12 | Train Loss: 1.156 Vali Loss: 1.283 Vali Acc: 0.650 Test Loss: 1.283 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9509458541870117
Epoch: 12, Steps: 12 | Train Loss: 1.083 Vali Loss: 1.179 Vali Acc: 0.678 Test Loss: 1.179 Test Acc: 0.678
Validation loss decreased (-0.666652 --> -0.677766).  Saving model ...
Epoch: 13 cost time: 0.9788708686828613
Epoch: 13, Steps: 12 | Train Loss: 0.886 Vali Loss: 1.077 Vali Acc: 0.678 Test Loss: 1.077 Test Acc: 0.678
Validation loss decreased (-0.677766 --> -0.677767).  Saving model ...
Epoch: 14 cost time: 0.9534265995025635
Epoch: 14, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.994 Vali Acc: 0.711 Test Loss: 0.994 Test Acc: 0.711
Validation loss decreased (-0.677767 --> -0.711101).  Saving model ...
Epoch: 15 cost time: 0.9334511756896973
Epoch: 15, Steps: 12 | Train Loss: 0.658 Vali Loss: 0.921 Vali Acc: 0.711 Test Loss: 0.921 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711102).  Saving model ...
Epoch: 16 cost time: 1.023033618927002
Epoch: 16, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.867 Vali Acc: 0.717 Test Loss: 0.867 Test Acc: 0.717
Validation loss decreased (-0.711102 --> -0.716658).  Saving model ...
Epoch: 17 cost time: 0.9553494453430176
Epoch: 17, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.801 Vali Acc: 0.728 Test Loss: 0.801 Test Acc: 0.728
Validation loss decreased (-0.716658 --> -0.727770).  Saving model ...
Epoch: 18 cost time: 1.065746545791626
Epoch: 18, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.756 Vali Acc: 0.778 Test Loss: 0.756 Test Acc: 0.778
Validation loss decreased (-0.727770 --> -0.777770).  Saving model ...
Epoch: 19 cost time: 1.0155713558197021
Epoch: 19, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.696 Vali Acc: 0.789 Test Loss: 0.696 Test Acc: 0.789
Validation loss decreased (-0.777770 --> -0.788882).  Saving model ...
Epoch: 20 cost time: 0.9762473106384277
Epoch: 20, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.664 Vali Acc: 0.789 Test Loss: 0.664 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 21 cost time: 0.9930891990661621
Epoch: 21, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.643 Vali Acc: 0.800 Test Loss: 0.643 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799994).  Saving model ...
Epoch: 22 cost time: 0.9631259441375732
Epoch: 22, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.646 Vali Acc: 0.800 Test Loss: 0.646 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9800643920898438
Epoch: 23, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.609 Vali Acc: 0.822 Test Loss: 0.609 Test Acc: 0.822
Validation loss decreased (-0.799994 --> -0.822216).  Saving model ...
Epoch: 24 cost time: 0.9920697212219238
Epoch: 24, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.575 Vali Acc: 0.822 Test Loss: 0.575 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 25 cost time: 1.0002145767211914
Epoch: 25, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.563 Vali Acc: 0.828 Test Loss: 0.563 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 26 cost time: 1.0342533588409424
Epoch: 26, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.561 Vali Acc: 0.839 Test Loss: 0.561 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 27 cost time: 1.0506973266601562
Epoch: 27, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.567 Vali Acc: 0.833 Test Loss: 0.567 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.041478157043457
Epoch: 28, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.566 Vali Acc: 0.833 Test Loss: 0.566 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9758932590484619
Epoch: 29, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849995).  Saving model ...
Epoch: 30 cost time: 0.9544687271118164
Epoch: 30, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.527 Vali Acc: 0.861 Test Loss: 0.527 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861106).  Saving model ...
Epoch: 31 cost time: 0.9417505264282227
Epoch: 31, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9404482841491699
Epoch: 32, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.523 Vali Acc: 0.856 Test Loss: 0.523 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9181878566741943
Epoch: 33, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.035043478012085
Epoch: 34, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.547 Vali Acc: 0.867 Test Loss: 0.547 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 35 cost time: 0.9797019958496094
Epoch: 35, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.538 Vali Acc: 0.872 Test Loss: 0.538 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 36 cost time: 0.9796829223632812
Epoch: 36, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.576 Vali Acc: 0.867 Test Loss: 0.576 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9555134773254395
Epoch: 37, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.575 Vali Acc: 0.872 Test Loss: 0.575 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9700992107391357
Epoch: 38, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.564 Vali Acc: 0.861 Test Loss: 0.564 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9640910625457764
Epoch: 39, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.550 Vali Acc: 0.878 Test Loss: 0.550 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 40 cost time: 0.917665958404541
Epoch: 40, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.546 Vali Acc: 0.883 Test Loss: 0.546 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 41 cost time: 0.9724667072296143
Epoch: 41, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.563 Vali Acc: 0.872 Test Loss: 0.563 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9443118572235107
Epoch: 42, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.604 Vali Acc: 0.878 Test Loss: 0.604 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9257969856262207
Epoch: 43, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.588 Vali Acc: 0.872 Test Loss: 0.588 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9493546485900879
Epoch: 44, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.546 Vali Acc: 0.867 Test Loss: 0.546 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9553914070129395
Epoch: 45, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.565 Vali Acc: 0.878 Test Loss: 0.565 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9922370910644531
Epoch: 46, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.592 Vali Acc: 0.878 Test Loss: 0.592 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.9539530277252197
Epoch: 47, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.596 Vali Acc: 0.867 Test Loss: 0.596 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.9374804496765137
Epoch: 48, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.593 Vali Acc: 0.872 Test Loss: 0.593 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.9727554321289062
Epoch: 49, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.592 Vali Acc: 0.867 Test Loss: 0.592 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.976710319519043
Epoch: 50, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.612 Vali Acc: 0.861 Test Loss: 0.612 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 134607
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.27466082572937
Epoch: 1, Steps: 12 | Train Loss: 2.722 Vali Loss: 2.692 Vali Acc: 0.089 Test Loss: 2.692 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 0.9825284481048584
Epoch: 2, Steps: 12 | Train Loss: 2.658 Vali Loss: 2.642 Vali Acc: 0.128 Test Loss: 2.642 Test Acc: 0.128
Validation loss decreased (-0.088862 --> -0.127751).  Saving model ...
Epoch: 3 cost time: 1.032501459121704
Epoch: 3, Steps: 12 | Train Loss: 2.578 Vali Loss: 2.553 Vali Acc: 0.217 Test Loss: 2.553 Test Acc: 0.217
Validation loss decreased (-0.127751 --> -0.216641).  Saving model ...
Epoch: 4 cost time: 0.967024564743042
Epoch: 4, Steps: 12 | Train Loss: 2.473 Vali Loss: 2.445 Vali Acc: 0.300 Test Loss: 2.445 Test Acc: 0.300
Validation loss decreased (-0.216641 --> -0.299976).  Saving model ...
Epoch: 5 cost time: 0.9357359409332275
Epoch: 5, Steps: 12 | Train Loss: 2.370 Vali Loss: 2.326 Vali Acc: 0.417 Test Loss: 2.326 Test Acc: 0.417
Validation loss decreased (-0.299976 --> -0.416643).  Saving model ...
Epoch: 6 cost time: 0.8940427303314209
Epoch: 6, Steps: 12 | Train Loss: 2.237 Vali Loss: 2.188 Vali Acc: 0.461 Test Loss: 2.188 Test Acc: 0.461
Validation loss decreased (-0.416643 --> -0.461089).  Saving model ...
Epoch: 7 cost time: 0.8876864910125732
Epoch: 7, Steps: 12 | Train Loss: 2.078 Vali Loss: 2.037 Vali Acc: 0.517 Test Loss: 2.037 Test Acc: 0.517
Validation loss decreased (-0.461089 --> -0.516646).  Saving model ...
Epoch: 8 cost time: 0.9285414218902588
Epoch: 8, Steps: 12 | Train Loss: 1.908 Vali Loss: 1.877 Vali Acc: 0.583 Test Loss: 1.877 Test Acc: 0.583
Validation loss decreased (-0.516646 --> -0.583315).  Saving model ...
Epoch: 9 cost time: 1.0089118480682373
Epoch: 9, Steps: 12 | Train Loss: 1.687 Vali Loss: 1.697 Vali Acc: 0.583 Test Loss: 1.697 Test Acc: 0.583
Validation loss decreased (-0.583315 --> -0.583316).  Saving model ...
Epoch: 10 cost time: 0.9841177463531494
Epoch: 10, Steps: 12 | Train Loss: 1.500 Vali Loss: 1.551 Vali Acc: 0.611 Test Loss: 1.551 Test Acc: 0.611
Validation loss decreased (-0.583316 --> -0.611096).  Saving model ...
Epoch: 11 cost time: 0.9522709846496582
Epoch: 11, Steps: 12 | Train Loss: 1.314 Vali Loss: 1.395 Vali Acc: 0.639 Test Loss: 1.395 Test Acc: 0.639
Validation loss decreased (-0.611096 --> -0.638875).  Saving model ...
Epoch: 12 cost time: 0.9254186153411865
Epoch: 12, Steps: 12 | Train Loss: 1.148 Vali Loss: 1.260 Vali Acc: 0.661 Test Loss: 1.260 Test Acc: 0.661
Validation loss decreased (-0.638875 --> -0.661099).  Saving model ...
Epoch: 13 cost time: 0.9866015911102295
Epoch: 13, Steps: 12 | Train Loss: 1.016 Vali Loss: 1.158 Vali Acc: 0.667 Test Loss: 1.158 Test Acc: 0.667
Validation loss decreased (-0.661099 --> -0.666655).  Saving model ...
Epoch: 14 cost time: 0.9661123752593994
Epoch: 14, Steps: 12 | Train Loss: 0.900 Vali Loss: 1.081 Vali Acc: 0.678 Test Loss: 1.081 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677767).  Saving model ...
Epoch: 15 cost time: 0.9129712581634521
Epoch: 15, Steps: 12 | Train Loss: 0.777 Vali Loss: 1.007 Vali Acc: 0.683 Test Loss: 1.007 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683323).  Saving model ...
Epoch: 16 cost time: 0.8975281715393066
Epoch: 16, Steps: 12 | Train Loss: 0.752 Vali Loss: 0.911 Vali Acc: 0.722 Test Loss: 0.911 Test Acc: 0.722
Validation loss decreased (-0.683323 --> -0.722213).  Saving model ...
Epoch: 17 cost time: 0.9562952518463135
Epoch: 17, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.850 Vali Acc: 0.750 Test Loss: 0.850 Test Acc: 0.750
Validation loss decreased (-0.722213 --> -0.749991).  Saving model ...
Epoch: 18 cost time: 1.0727202892303467
Epoch: 18, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.798 Vali Acc: 0.756 Test Loss: 0.798 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.755548).  Saving model ...
Epoch: 19 cost time: 0.9092581272125244
Epoch: 19, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.750 Vali Acc: 0.767 Test Loss: 0.750 Test Acc: 0.767
Validation loss decreased (-0.755548 --> -0.766659).  Saving model ...
Epoch: 20 cost time: 0.9402711391448975
Epoch: 20, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.701 Vali Acc: 0.789 Test Loss: 0.701 Test Acc: 0.789
Validation loss decreased (-0.766659 --> -0.788882).  Saving model ...
Epoch: 21 cost time: 0.9414958953857422
Epoch: 21, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.677 Vali Acc: 0.806 Test Loss: 0.677 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805549).  Saving model ...
Epoch: 22 cost time: 0.8716912269592285
Epoch: 22, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.644 Vali Acc: 0.806 Test Loss: 0.644 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805549).  Saving model ...
Epoch: 23 cost time: 0.8594973087310791
Epoch: 23, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.611 Vali Acc: 0.822 Test Loss: 0.611 Test Acc: 0.822
Validation loss decreased (-0.805549 --> -0.822216).  Saving model ...
Epoch: 24 cost time: 0.9266083240509033
Epoch: 24, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.572 Vali Acc: 0.828 Test Loss: 0.572 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 25 cost time: 0.992211103439331
Epoch: 25, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.558 Vali Acc: 0.844 Test Loss: 0.558 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844439).  Saving model ...
Epoch: 26 cost time: 0.9231340885162354
Epoch: 26, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.541 Vali Acc: 0.839 Test Loss: 0.541 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.986154317855835
Epoch: 27, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.528 Vali Acc: 0.839 Test Loss: 0.528 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0123822689056396
Epoch: 28, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.504 Vali Acc: 0.867 Test Loss: 0.504 Test Acc: 0.867
Validation loss decreased (-0.844439 --> -0.866662).  Saving model ...
Epoch: 29 cost time: 0.997504711151123
Epoch: 29, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9763562679290771
Epoch: 30, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.500 Vali Acc: 0.878 Test Loss: 0.500 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 31 cost time: 0.9868931770324707
Epoch: 31, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.482 Vali Acc: 0.872 Test Loss: 0.482 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9910166263580322
Epoch: 32, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8737812042236328
Epoch: 33, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.467 Vali Acc: 0.867 Test Loss: 0.467 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9149858951568604
Epoch: 34, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.465 Vali Acc: 0.856 Test Loss: 0.465 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8767273426055908
Epoch: 35, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.480 Vali Acc: 0.856 Test Loss: 0.480 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8810200691223145
Epoch: 36, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.469 Vali Acc: 0.872 Test Loss: 0.469 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9022996425628662
Epoch: 37, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.461 Vali Acc: 0.861 Test Loss: 0.461 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.93355393409729
Epoch: 38, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.480 Vali Acc: 0.872 Test Loss: 0.480 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.9702174663543701
Epoch: 39, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.476 Vali Acc: 0.856 Test Loss: 0.476 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.9723320007324219
Epoch: 40, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.464 Vali Acc: 0.872 Test Loss: 0.464 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 130831
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2975223064422607
Epoch: 1, Steps: 12 | Train Loss: 2.741 Vali Loss: 2.709 Vali Acc: 0.111 Test Loss: 2.709 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 0.9838159084320068
Epoch: 2, Steps: 12 | Train Loss: 2.699 Vali Loss: 2.656 Vali Acc: 0.067 Test Loss: 2.656 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0306191444396973
Epoch: 3, Steps: 12 | Train Loss: 2.598 Vali Loss: 2.564 Vali Acc: 0.233 Test Loss: 2.564 Test Acc: 0.233
Validation loss decreased (-0.111084 --> -0.233308).  Saving model ...
Epoch: 4 cost time: 1.0004222393035889
Epoch: 4, Steps: 12 | Train Loss: 2.464 Vali Loss: 2.445 Vali Acc: 0.394 Test Loss: 2.445 Test Acc: 0.394
Validation loss decreased (-0.233308 --> -0.394420).  Saving model ...
Epoch: 5 cost time: 0.9551517963409424
Epoch: 5, Steps: 12 | Train Loss: 2.314 Vali Loss: 2.307 Vali Acc: 0.450 Test Loss: 2.307 Test Acc: 0.450
Validation loss decreased (-0.394420 --> -0.449977).  Saving model ...
Epoch: 6 cost time: 0.9774305820465088
Epoch: 6, Steps: 12 | Train Loss: 2.171 Vali Loss: 2.172 Vali Acc: 0.517 Test Loss: 2.172 Test Acc: 0.517
Validation loss decreased (-0.449977 --> -0.516645).  Saving model ...
Epoch: 7 cost time: 0.9373254776000977
Epoch: 7, Steps: 12 | Train Loss: 2.037 Vali Loss: 2.034 Vali Acc: 0.533 Test Loss: 2.034 Test Acc: 0.533
Validation loss decreased (-0.516645 --> -0.533313).  Saving model ...
Epoch: 8 cost time: 0.9948608875274658
Epoch: 8, Steps: 12 | Train Loss: 1.842 Vali Loss: 1.856 Vali Acc: 0.589 Test Loss: 1.856 Test Acc: 0.589
Validation loss decreased (-0.533313 --> -0.588870).  Saving model ...
Epoch: 9 cost time: 0.9950652122497559
Epoch: 9, Steps: 12 | Train Loss: 1.675 Vali Loss: 1.696 Vali Acc: 0.628 Test Loss: 1.696 Test Acc: 0.628
Validation loss decreased (-0.588870 --> -0.627761).  Saving model ...
Epoch: 10 cost time: 0.9370641708374023
Epoch: 10, Steps: 12 | Train Loss: 1.505 Vali Loss: 1.538 Vali Acc: 0.656 Test Loss: 1.538 Test Acc: 0.656
Validation loss decreased (-0.627761 --> -0.655540).  Saving model ...
Epoch: 11 cost time: 0.9694745540618896
Epoch: 11, Steps: 12 | Train Loss: 1.371 Vali Loss: 1.403 Vali Acc: 0.683 Test Loss: 1.403 Test Acc: 0.683
Validation loss decreased (-0.655540 --> -0.683319).  Saving model ...
Epoch: 12 cost time: 0.9494752883911133
Epoch: 12, Steps: 12 | Train Loss: 1.191 Vali Loss: 1.281 Vali Acc: 0.678 Test Loss: 1.281 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9805874824523926
Epoch: 13, Steps: 12 | Train Loss: 1.031 Vali Loss: 1.193 Vali Acc: 0.683 Test Loss: 1.193 Test Acc: 0.683
Validation loss decreased (-0.683319 --> -0.683321).  Saving model ...
Epoch: 14 cost time: 1.0441954135894775
Epoch: 14, Steps: 12 | Train Loss: 0.884 Vali Loss: 1.091 Vali Acc: 0.689 Test Loss: 1.091 Test Acc: 0.689
Validation loss decreased (-0.683321 --> -0.688878).  Saving model ...
Epoch: 15 cost time: 1.0025079250335693
Epoch: 15, Steps: 12 | Train Loss: 0.787 Vali Loss: 1.017 Vali Acc: 0.717 Test Loss: 1.017 Test Acc: 0.717
Validation loss decreased (-0.688878 --> -0.716656).  Saving model ...
Epoch: 16 cost time: 0.9943327903747559
Epoch: 16, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.930 Vali Acc: 0.739 Test Loss: 0.930 Test Acc: 0.739
Validation loss decreased (-0.716656 --> -0.738880).  Saving model ...
Epoch: 17 cost time: 0.96978759765625
Epoch: 17, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.881 Vali Acc: 0.750 Test Loss: 0.881 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749991).  Saving model ...
Epoch: 18 cost time: 0.9004700183868408
Epoch: 18, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.836 Vali Acc: 0.767 Test Loss: 0.836 Test Acc: 0.767
Validation loss decreased (-0.749991 --> -0.766658).  Saving model ...
Epoch: 19 cost time: 0.9617886543273926
Epoch: 19, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.785 Vali Acc: 0.778 Test Loss: 0.785 Test Acc: 0.778
Validation loss decreased (-0.766658 --> -0.777770).  Saving model ...
Epoch: 20 cost time: 0.9958407878875732
Epoch: 20, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.748 Vali Acc: 0.806 Test Loss: 0.748 Test Acc: 0.806
Validation loss decreased (-0.777770 --> -0.805548).  Saving model ...
Epoch: 21 cost time: 0.9805681705474854
Epoch: 21, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.717 Vali Acc: 0.817 Test Loss: 0.717 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816659).  Saving model ...
Epoch: 22 cost time: 0.9747378826141357
Epoch: 22, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.690 Vali Acc: 0.839 Test Loss: 0.690 Test Acc: 0.839
Validation loss decreased (-0.816659 --> -0.838882).  Saving model ...
Epoch: 23 cost time: 1.0226614475250244
Epoch: 23, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.650 Vali Acc: 0.833 Test Loss: 0.650 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9702017307281494
Epoch: 24, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.650 Vali Acc: 0.856 Test Loss: 0.650 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855549).  Saving model ...
Epoch: 25 cost time: 0.9675414562225342
Epoch: 25, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.615 Vali Acc: 0.828 Test Loss: 0.615 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9726090431213379
Epoch: 26, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.986182689666748
Epoch: 27, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.599 Vali Acc: 0.844 Test Loss: 0.599 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9889688491821289
Epoch: 28, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0436375141143799
Epoch: 29, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0536575317382812
Epoch: 30, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.576 Vali Acc: 0.872 Test Loss: 0.576 Test Acc: 0.872
Validation loss decreased (-0.855549 --> -0.872216).  Saving model ...
Epoch: 31 cost time: 1.0438954830169678
Epoch: 31, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.555 Vali Acc: 0.844 Test Loss: 0.555 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0399553775787354
Epoch: 32, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.558 Vali Acc: 0.867 Test Loss: 0.558 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0331556797027588
Epoch: 33, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.555 Vali Acc: 0.872 Test Loss: 0.555 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872217).  Saving model ...
Epoch: 34 cost time: 0.9314713478088379
Epoch: 34, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.550 Vali Acc: 0.878 Test Loss: 0.550 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 35 cost time: 0.9750380516052246
Epoch: 35, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.541 Vali Acc: 0.878 Test Loss: 0.541 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 36 cost time: 0.9562511444091797
Epoch: 36, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.553 Vali Acc: 0.867 Test Loss: 0.553 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9647376537322998
Epoch: 37, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.562 Vali Acc: 0.856 Test Loss: 0.562 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9338462352752686
Epoch: 38, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9056293964385986
Epoch: 39, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0171523094177246
Epoch: 40, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.554 Vali Acc: 0.861 Test Loss: 0.554 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.964968204498291
Epoch: 41, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.572 Vali Acc: 0.856 Test Loss: 0.572 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.991447925567627
Epoch: 42, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.577 Vali Acc: 0.861 Test Loss: 0.577 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.0140964984893799
Epoch: 43, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.584 Vali Acc: 0.856 Test Loss: 0.584 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.9514236450195312
Epoch: 44, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.612 Vali Acc: 0.850 Test Loss: 0.612 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.996239185333252
Epoch: 45, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.600 Vali Acc: 0.844 Test Loss: 0.600 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 130895
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.269378662109375
Epoch: 1, Steps: 12 | Train Loss: 2.704 Vali Loss: 2.703 Vali Acc: 0.061 Test Loss: 2.703 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 1.0559413433074951
Epoch: 2, Steps: 12 | Train Loss: 2.673 Vali Loss: 2.666 Vali Acc: 0.150 Test Loss: 2.666 Test Acc: 0.150
Validation loss decreased (-0.061084 --> -0.149973).  Saving model ...
Epoch: 3 cost time: 0.9647691249847412
Epoch: 3, Steps: 12 | Train Loss: 2.581 Vali Loss: 2.597 Vali Acc: 0.267 Test Loss: 2.597 Test Acc: 0.267
Validation loss decreased (-0.149973 --> -0.266641).  Saving model ...
Epoch: 4 cost time: 0.9557695388793945
Epoch: 4, Steps: 12 | Train Loss: 2.475 Vali Loss: 2.506 Vali Acc: 0.333 Test Loss: 2.506 Test Acc: 0.333
Validation loss decreased (-0.266641 --> -0.333308).  Saving model ...
Epoch: 5 cost time: 0.9618358612060547
Epoch: 5, Steps: 12 | Train Loss: 2.411 Vali Loss: 2.392 Vali Acc: 0.372 Test Loss: 2.392 Test Acc: 0.372
Validation loss decreased (-0.333308 --> -0.372198).  Saving model ...
Epoch: 6 cost time: 0.9825460910797119
Epoch: 6, Steps: 12 | Train Loss: 2.275 Vali Loss: 2.267 Vali Acc: 0.433 Test Loss: 2.267 Test Acc: 0.433
Validation loss decreased (-0.372198 --> -0.433311).  Saving model ...
Epoch: 7 cost time: 0.9448318481445312
Epoch: 7, Steps: 12 | Train Loss: 2.115 Vali Loss: 2.137 Vali Acc: 0.444 Test Loss: 2.137 Test Acc: 0.444
Validation loss decreased (-0.433311 --> -0.444423).  Saving model ...
Epoch: 8 cost time: 0.9841585159301758
Epoch: 8, Steps: 12 | Train Loss: 1.982 Vali Loss: 2.001 Vali Acc: 0.494 Test Loss: 2.001 Test Acc: 0.494
Validation loss decreased (-0.444423 --> -0.494424).  Saving model ...
Epoch: 9 cost time: 0.9700827598571777
Epoch: 9, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.837 Vali Acc: 0.528 Test Loss: 1.837 Test Acc: 0.528
Validation loss decreased (-0.494424 --> -0.527759).  Saving model ...
Epoch: 10 cost time: 1.00250244140625
Epoch: 10, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.674 Vali Acc: 0.572 Test Loss: 1.674 Test Acc: 0.572
Validation loss decreased (-0.527759 --> -0.572205).  Saving model ...
Epoch: 11 cost time: 1.0145313739776611
Epoch: 11, Steps: 12 | Train Loss: 1.499 Vali Loss: 1.519 Vali Acc: 0.644 Test Loss: 1.519 Test Acc: 0.644
Validation loss decreased (-0.572205 --> -0.644429).  Saving model ...
Epoch: 12 cost time: 0.9605422019958496
Epoch: 12, Steps: 12 | Train Loss: 1.310 Vali Loss: 1.383 Vali Acc: 0.689 Test Loss: 1.383 Test Acc: 0.689
Validation loss decreased (-0.644429 --> -0.688875).  Saving model ...
Epoch: 13 cost time: 0.9656276702880859
Epoch: 13, Steps: 12 | Train Loss: 1.186 Vali Loss: 1.294 Vali Acc: 0.711 Test Loss: 1.294 Test Acc: 0.711
Validation loss decreased (-0.688875 --> -0.711098).  Saving model ...
Epoch: 14 cost time: 0.9514553546905518
Epoch: 14, Steps: 12 | Train Loss: 1.040 Vali Loss: 1.177 Vali Acc: 0.722 Test Loss: 1.177 Test Acc: 0.722
Validation loss decreased (-0.711098 --> -0.722210).  Saving model ...
Epoch: 15 cost time: 1.0198674201965332
Epoch: 15, Steps: 12 | Train Loss: 0.957 Vali Loss: 1.067 Vali Acc: 0.744 Test Loss: 1.067 Test Acc: 0.744
Validation loss decreased (-0.722210 --> -0.744434).  Saving model ...
Epoch: 16 cost time: 0.9597549438476562
Epoch: 16, Steps: 12 | Train Loss: 0.848 Vali Loss: 0.995 Vali Acc: 0.739 Test Loss: 0.995 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.95821213722229
Epoch: 17, Steps: 12 | Train Loss: 0.730 Vali Loss: 0.929 Vali Acc: 0.756 Test Loss: 0.929 Test Acc: 0.756
Validation loss decreased (-0.744434 --> -0.755546).  Saving model ...
Epoch: 18 cost time: 0.9742209911346436
Epoch: 18, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.880 Vali Acc: 0.761 Test Loss: 0.880 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761102).  Saving model ...
Epoch: 19 cost time: 0.9775476455688477
Epoch: 19, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.820 Vali Acc: 0.767 Test Loss: 0.820 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766658).  Saving model ...
Epoch: 20 cost time: 0.9743056297302246
Epoch: 20, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.784 Vali Acc: 0.778 Test Loss: 0.784 Test Acc: 0.778
Validation loss decreased (-0.766658 --> -0.777770).  Saving model ...
Epoch: 21 cost time: 0.9256932735443115
Epoch: 21, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.725 Vali Acc: 0.783 Test Loss: 0.725 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783326).  Saving model ...
Epoch: 22 cost time: 0.9359192848205566
Epoch: 22, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.686 Vali Acc: 0.794 Test Loss: 0.686 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794438).  Saving model ...
Epoch: 23 cost time: 0.9946460723876953
Epoch: 23, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.673 Vali Acc: 0.822 Test Loss: 0.673 Test Acc: 0.822
Validation loss decreased (-0.794438 --> -0.822215).  Saving model ...
Epoch: 24 cost time: 0.8946390151977539
Epoch: 24, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.636 Vali Acc: 0.811 Test Loss: 0.636 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.956315279006958
Epoch: 25, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.625 Vali Acc: 0.822 Test Loss: 0.625 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822216).  Saving model ...
Epoch: 26 cost time: 0.92549729347229
Epoch: 26, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.585 Vali Acc: 0.828 Test Loss: 0.585 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 27 cost time: 0.9881465435028076
Epoch: 27, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.561 Vali Acc: 0.844 Test Loss: 0.561 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844439).  Saving model ...
Epoch: 28 cost time: 0.9482338428497314
Epoch: 28, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.550 Vali Acc: 0.844 Test Loss: 0.550 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 29 cost time: 0.9124767780303955
Epoch: 29, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.545 Vali Acc: 0.844 Test Loss: 0.545 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 30 cost time: 1.047947645187378
Epoch: 30, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 31 cost time: 0.9803695678710938
Epoch: 31, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 32 cost time: 0.9605810642242432
Epoch: 32, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.508 Vali Acc: 0.861 Test Loss: 0.508 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861106).  Saving model ...
Epoch: 33 cost time: 0.9633004665374756
Epoch: 33, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.490 Vali Acc: 0.872 Test Loss: 0.490 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 34 cost time: 1.040248155593872
Epoch: 34, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9856219291687012
Epoch: 35, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.494 Vali Acc: 0.867 Test Loss: 0.494 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9887080192565918
Epoch: 36, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.500 Vali Acc: 0.839 Test Loss: 0.500 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.971097469329834
Epoch: 37, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.495 Vali Acc: 0.839 Test Loss: 0.495 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9723033905029297
Epoch: 38, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0333003997802734
Epoch: 39, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.481 Vali Acc: 0.861 Test Loss: 0.481 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.8906853199005127
Epoch: 40, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.470 Vali Acc: 0.861 Test Loss: 0.470 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.8965113162994385
Epoch: 41, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.467 Vali Acc: 0.867 Test Loss: 0.467 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.9629497528076172
Epoch: 42, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.497 Vali Acc: 0.861 Test Loss: 0.497 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.9999165534973145
Epoch: 43, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.488 Vali Acc: 0.861 Test Loss: 0.488 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 127151
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4385263919830322
Epoch: 1, Steps: 12 | Train Loss: 2.710 Vali Loss: 2.586 Vali Acc: 0.283 Test Loss: 2.586 Test Acc: 0.283
Validation loss decreased (inf --> -0.283307).  Saving model ...
Epoch: 2 cost time: 1.150038719177246
Epoch: 2, Steps: 12 | Train Loss: 2.211 Vali Loss: 2.126 Vali Acc: 0.478 Test Loss: 2.126 Test Acc: 0.478
Validation loss decreased (-0.283307 --> -0.477757).  Saving model ...
Epoch: 3 cost time: 1.0821423530578613
Epoch: 3, Steps: 12 | Train Loss: 1.557 Vali Loss: 1.535 Vali Acc: 0.589 Test Loss: 1.535 Test Acc: 0.589
Validation loss decreased (-0.477757 --> -0.588874).  Saving model ...
Epoch: 4 cost time: 1.034160852432251
Epoch: 4, Steps: 12 | Train Loss: 1.076 Vali Loss: 1.151 Vali Acc: 0.644 Test Loss: 1.151 Test Acc: 0.644
Validation loss decreased (-0.588874 --> -0.644433).  Saving model ...
Epoch: 5 cost time: 0.996023416519165
Epoch: 5, Steps: 12 | Train Loss: 0.793 Vali Loss: 0.968 Vali Acc: 0.667 Test Loss: 0.968 Test Acc: 0.667
Validation loss decreased (-0.644433 --> -0.666657).  Saving model ...
Epoch: 6 cost time: 1.0195281505584717
Epoch: 6, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.922 Vali Acc: 0.700 Test Loss: 0.922 Test Acc: 0.700
Validation loss decreased (-0.666657 --> -0.699991).  Saving model ...
Epoch: 7 cost time: 1.1545658111572266
Epoch: 7, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.842 Vali Acc: 0.728 Test Loss: 0.842 Test Acc: 0.728
Validation loss decreased (-0.699991 --> -0.727769).  Saving model ...
Epoch: 8 cost time: 1.1219854354858398
Epoch: 8, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.859 Vali Acc: 0.761 Test Loss: 0.859 Test Acc: 0.761
Validation loss decreased (-0.727769 --> -0.761103).  Saving model ...
Epoch: 9 cost time: 1.1455814838409424
Epoch: 9, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.889 Vali Acc: 0.739 Test Loss: 0.889 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1187586784362793
Epoch: 10, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.827 Vali Acc: 0.772 Test Loss: 0.827 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772214).  Saving model ...
Epoch: 11 cost time: 1.1550376415252686
Epoch: 11, Steps: 12 | Train Loss: 0.169 Vali Loss: 1.020 Vali Acc: 0.750 Test Loss: 1.020 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1157124042510986
Epoch: 12, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.974 Vali Acc: 0.817 Test Loss: 0.974 Test Acc: 0.817
Validation loss decreased (-0.772214 --> -0.816657).  Saving model ...
Epoch: 13 cost time: 1.0825409889221191
Epoch: 13, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.946 Vali Acc: 0.794 Test Loss: 0.946 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1829421520233154
Epoch: 14, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.030 Vali Acc: 0.794 Test Loss: 1.030 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1105690002441406
Epoch: 15, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.898 Vali Acc: 0.828 Test Loss: 0.898 Test Acc: 0.828
Validation loss decreased (-0.816657 --> -0.827769).  Saving model ...
Epoch: 16 cost time: 1.1364951133728027
Epoch: 16, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.026 Vali Acc: 0.828 Test Loss: 1.026 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1825752258300781
Epoch: 17, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.174 Vali Acc: 0.828 Test Loss: 1.174 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1067099571228027
Epoch: 18, Steps: 12 | Train Loss: 0.126 Vali Loss: 1.007 Vali Acc: 0.811 Test Loss: 1.007 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1041057109832764
Epoch: 19, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.228 Vali Acc: 0.817 Test Loss: 1.228 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0838844776153564
Epoch: 20, Steps: 12 | Train Loss: 0.065 Vali Loss: 1.252 Vali Acc: 0.828 Test Loss: 1.252 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1729531288146973
Epoch: 21, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.133 Vali Acc: 0.828 Test Loss: 1.133 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1770668029785156
Epoch: 22, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.939 Vali Acc: 0.828 Test Loss: 0.939 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1001842021942139
Epoch: 23, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.050 Vali Acc: 0.844 Test Loss: 1.050 Test Acc: 0.844
Validation loss decreased (-0.827769 --> -0.844434).  Saving model ...
Epoch: 24 cost time: 1.224541187286377
Epoch: 24, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.149 Vali Acc: 0.850 Test Loss: 1.149 Test Acc: 0.850
Validation loss decreased (-0.844434 --> -0.849989).  Saving model ...
Epoch: 25 cost time: 1.2248821258544922
Epoch: 25, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.208 Vali Acc: 0.844 Test Loss: 1.208 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2104504108428955
Epoch: 26, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.177 Vali Acc: 0.844 Test Loss: 1.177 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2517659664154053
Epoch: 27, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.167 Vali Acc: 0.839 Test Loss: 1.167 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2027063369750977
Epoch: 28, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.230 Vali Acc: 0.839 Test Loss: 1.230 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.154355525970459
Epoch: 29, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.209 Vali Acc: 0.850 Test Loss: 1.209 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.145249366760254
Epoch: 30, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.259 Vali Acc: 0.817 Test Loss: 1.259 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1111159324645996
Epoch: 31, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.225 Vali Acc: 0.856 Test Loss: 1.225 Test Acc: 0.856
Validation loss decreased (-0.849989 --> -0.855543).  Saving model ...
Epoch: 32 cost time: 1.208695888519287
Epoch: 32, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.311 Vali Acc: 0.828 Test Loss: 1.311 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1727399826049805
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.367 Vali Acc: 0.844 Test Loss: 1.367 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2363924980163574
Epoch: 34, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.223 Vali Acc: 0.844 Test Loss: 1.223 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.158771276473999
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.301 Vali Acc: 0.856 Test Loss: 1.301 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.0820519924163818
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.414 Vali Acc: 0.833 Test Loss: 1.414 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.119203805923462
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.289 Vali Acc: 0.850 Test Loss: 1.289 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.1226468086242676
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.459 Vali Acc: 0.839 Test Loss: 1.459 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.121302843093872
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.344 Vali Acc: 0.856 Test Loss: 1.344 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.1742501258850098
Epoch: 40, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.360 Vali Acc: 0.856 Test Loss: 1.360 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.3030996322631836
Epoch: 41, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.752 Vali Acc: 0.828 Test Loss: 1.752 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 594831
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3427698612213135
Epoch: 1, Steps: 12 | Train Loss: 2.704 Vali Loss: 2.665 Vali Acc: 0.106 Test Loss: 2.665 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 1.0361196994781494
Epoch: 2, Steps: 12 | Train Loss: 2.423 Vali Loss: 2.395 Vali Acc: 0.344 Test Loss: 2.395 Test Acc: 0.344
Validation loss decreased (-0.105529 --> -0.344420).  Saving model ...
Epoch: 3 cost time: 1.1038191318511963
Epoch: 3, Steps: 12 | Train Loss: 2.001 Vali Loss: 1.981 Vali Acc: 0.544 Test Loss: 1.981 Test Acc: 0.544
Validation loss decreased (-0.344420 --> -0.544425).  Saving model ...
Epoch: 4 cost time: 1.1107099056243896
Epoch: 4, Steps: 12 | Train Loss: 1.554 Vali Loss: 1.562 Vali Acc: 0.589 Test Loss: 1.562 Test Acc: 0.589
Validation loss decreased (-0.544425 --> -0.588873).  Saving model ...
Epoch: 5 cost time: 1.1030118465423584
Epoch: 5, Steps: 12 | Train Loss: 1.181 Vali Loss: 1.246 Vali Acc: 0.656 Test Loss: 1.246 Test Acc: 0.656
Validation loss decreased (-0.588873 --> -0.655543).  Saving model ...
Epoch: 6 cost time: 1.1370346546173096
Epoch: 6, Steps: 12 | Train Loss: 0.841 Vali Loss: 1.040 Vali Acc: 0.678 Test Loss: 1.040 Test Acc: 0.678
Validation loss decreased (-0.655543 --> -0.677767).  Saving model ...
Epoch: 7 cost time: 1.0143229961395264
Epoch: 7, Steps: 12 | Train Loss: 0.707 Vali Loss: 0.929 Vali Acc: 0.689 Test Loss: 0.929 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688880).  Saving model ...
Epoch: 8 cost time: 1.0375056266784668
Epoch: 8, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.862 Vali Acc: 0.722 Test Loss: 0.862 Test Acc: 0.722
Validation loss decreased (-0.688880 --> -0.722214).  Saving model ...
Epoch: 9 cost time: 1.01397705078125
Epoch: 9, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.842 Vali Acc: 0.744 Test Loss: 0.842 Test Acc: 0.744
Validation loss decreased (-0.722214 --> -0.744436).  Saving model ...
Epoch: 10 cost time: 0.9640226364135742
Epoch: 10, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.786 Vali Acc: 0.756 Test Loss: 0.786 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755548).  Saving model ...
Epoch: 11 cost time: 0.9745757579803467
Epoch: 11, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.745 Vali Acc: 0.794 Test Loss: 0.745 Test Acc: 0.794
Validation loss decreased (-0.755548 --> -0.794437).  Saving model ...
Epoch: 12 cost time: 1.0319581031799316
Epoch: 12, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.793 Vali Acc: 0.783 Test Loss: 0.793 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1130483150482178
Epoch: 13, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.708 Vali Acc: 0.761 Test Loss: 0.708 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0352842807769775
Epoch: 14, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.712 Vali Acc: 0.811 Test Loss: 0.712 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811104).  Saving model ...
Epoch: 15 cost time: 1.1409742832183838
Epoch: 15, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.758 Vali Acc: 0.828 Test Loss: 0.758 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827770).  Saving model ...
Epoch: 16 cost time: 1.1531178951263428
Epoch: 16, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.782 Vali Acc: 0.828 Test Loss: 0.782 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.037992238998413
Epoch: 17, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.739 Vali Acc: 0.850 Test Loss: 0.739 Test Acc: 0.850
Validation loss decreased (-0.827770 --> -0.849993).  Saving model ...
Epoch: 18 cost time: 1.0414249897003174
Epoch: 18, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.721 Vali Acc: 0.844 Test Loss: 0.721 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0327229499816895
Epoch: 19, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.710 Vali Acc: 0.828 Test Loss: 0.710 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0944898128509521
Epoch: 20, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.772 Vali Acc: 0.839 Test Loss: 0.772 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0830936431884766
Epoch: 21, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.788 Vali Acc: 0.844 Test Loss: 0.788 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0860772132873535
Epoch: 22, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.790 Vali Acc: 0.850 Test Loss: 0.790 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1148734092712402
Epoch: 23, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.806 Vali Acc: 0.817 Test Loss: 0.806 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1040019989013672
Epoch: 24, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.804 Vali Acc: 0.828 Test Loss: 0.804 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0451114177703857
Epoch: 25, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.779 Vali Acc: 0.850 Test Loss: 0.779 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.088611364364624
Epoch: 26, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.846 Vali Acc: 0.828 Test Loss: 0.846 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0255310535430908
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.821 Vali Acc: 0.833 Test Loss: 0.821 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.85
model parameter : 502799
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2164859771728516
Epoch: 1, Steps: 12 | Train Loss: 2.656 Vali Loss: 2.629 Vali Acc: 0.211 Test Loss: 2.629 Test Acc: 0.211
Validation loss decreased (inf --> -0.211085).  Saving model ...
Epoch: 2 cost time: 1.0535814762115479
Epoch: 2, Steps: 12 | Train Loss: 2.363 Vali Loss: 2.319 Vali Acc: 0.472 Test Loss: 2.319 Test Acc: 0.472
Validation loss decreased (-0.211085 --> -0.472199).  Saving model ...
Epoch: 3 cost time: 1.0664963722229004
Epoch: 3, Steps: 12 | Train Loss: 1.961 Vali Loss: 1.871 Vali Acc: 0.544 Test Loss: 1.871 Test Acc: 0.544
Validation loss decreased (-0.472199 --> -0.544426).  Saving model ...
Epoch: 4 cost time: 1.0641093254089355
Epoch: 4, Steps: 12 | Train Loss: 1.461 Vali Loss: 1.468 Vali Acc: 0.622 Test Loss: 1.468 Test Acc: 0.622
Validation loss decreased (-0.544426 --> -0.622208).  Saving model ...
Epoch: 5 cost time: 0.9827725887298584
Epoch: 5, Steps: 12 | Train Loss: 1.098 Vali Loss: 1.205 Vali Acc: 0.661 Test Loss: 1.205 Test Acc: 0.661
Validation loss decreased (-0.622208 --> -0.661099).  Saving model ...
Epoch: 6 cost time: 1.0201959609985352
Epoch: 6, Steps: 12 | Train Loss: 0.827 Vali Loss: 1.032 Vali Acc: 0.683 Test Loss: 1.032 Test Acc: 0.683
Validation loss decreased (-0.661099 --> -0.683323).  Saving model ...
Epoch: 7 cost time: 1.0315823554992676
Epoch: 7, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.910 Vali Acc: 0.667 Test Loss: 0.910 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0360345840454102
Epoch: 8, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.841 Vali Acc: 0.739 Test Loss: 0.841 Test Acc: 0.739
Validation loss decreased (-0.683323 --> -0.738880).  Saving model ...
Epoch: 9 cost time: 1.059086799621582
Epoch: 9, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.793 Vali Acc: 0.728 Test Loss: 0.793 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0748317241668701
Epoch: 10, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.798 Vali Acc: 0.756 Test Loss: 0.798 Test Acc: 0.756
Validation loss decreased (-0.738880 --> -0.755548).  Saving model ...
Epoch: 11 cost time: 1.1719944477081299
Epoch: 11, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.759 Vali Acc: 0.772 Test Loss: 0.759 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772215).  Saving model ...
Epoch: 12 cost time: 1.0174891948699951
Epoch: 12, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.731 Vali Acc: 0.783 Test Loss: 0.731 Test Acc: 0.783
Validation loss decreased (-0.772215 --> -0.783326).  Saving model ...
Epoch: 13 cost time: 1.0305824279785156
Epoch: 13, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.709 Vali Acc: 0.789 Test Loss: 0.709 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 14 cost time: 1.140733242034912
Epoch: 14, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.734 Vali Acc: 0.800 Test Loss: 0.734 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 15 cost time: 1.0664849281311035
Epoch: 15, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.659 Vali Acc: 0.828 Test Loss: 0.659 Test Acc: 0.828
Validation loss decreased (-0.799993 --> -0.827771).  Saving model ...
Epoch: 16 cost time: 1.1763255596160889
Epoch: 16, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.711 Vali Acc: 0.817 Test Loss: 0.711 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1184518337249756
Epoch: 17, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.704 Vali Acc: 0.828 Test Loss: 0.704 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.125199317932129
Epoch: 18, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.725 Vali Acc: 0.839 Test Loss: 0.725 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 19 cost time: 1.0600788593292236
Epoch: 19, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.749 Vali Acc: 0.811 Test Loss: 0.749 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0752546787261963
Epoch: 20, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.796 Vali Acc: 0.828 Test Loss: 0.796 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.034048080444336
Epoch: 21, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.749 Vali Acc: 0.822 Test Loss: 0.749 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1087877750396729
Epoch: 22, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.714 Vali Acc: 0.844 Test Loss: 0.714 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844437).  Saving model ...
Epoch: 23 cost time: 1.1066880226135254
Epoch: 23, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.806 Vali Acc: 0.867 Test Loss: 0.806 Test Acc: 0.867
Validation loss decreased (-0.844437 --> -0.866659).  Saving model ...
Epoch: 24 cost time: 1.0932085514068604
Epoch: 24, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.785 Vali Acc: 0.867 Test Loss: 0.785 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866659).  Saving model ...
Epoch: 25 cost time: 1.0646517276763916
Epoch: 25, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.791 Vali Acc: 0.844 Test Loss: 0.791 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1547517776489258
Epoch: 26, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.858 Vali Acc: 0.850 Test Loss: 0.858 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.150477647781372
Epoch: 27, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.829 Vali Acc: 0.844 Test Loss: 0.829 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0534656047821045
Epoch: 28, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.855 Vali Acc: 0.833 Test Loss: 0.855 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.086897373199463
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.848 Vali Acc: 0.850 Test Loss: 0.848 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0587143898010254
Epoch: 30, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.827 Vali Acc: 0.850 Test Loss: 0.827 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.004530906677246
Epoch: 31, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.847 Vali Acc: 0.861 Test Loss: 0.847 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.0274839401245117
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.859 Vali Acc: 0.856 Test Loss: 0.859 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0356314182281494
Epoch: 33, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.926 Vali Acc: 0.856 Test Loss: 0.926 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0960607528686523
Epoch: 34, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.949 Vali Acc: 0.850 Test Loss: 0.949 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 502927
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.229127883911133
Epoch: 1, Steps: 12 | Train Loss: 2.749 Vali Loss: 2.698 Vali Acc: 0.089 Test Loss: 2.698 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 1.0729644298553467
Epoch: 2, Steps: 12 | Train Loss: 2.517 Vali Loss: 2.470 Vali Acc: 0.322 Test Loss: 2.470 Test Acc: 0.322
Validation loss decreased (-0.088862 --> -0.322198).  Saving model ...
Epoch: 3 cost time: 1.0611255168914795
Epoch: 3, Steps: 12 | Train Loss: 2.181 Vali Loss: 2.127 Vali Acc: 0.489 Test Loss: 2.127 Test Acc: 0.489
Validation loss decreased (-0.322198 --> -0.488868).  Saving model ...
Epoch: 4 cost time: 1.1173605918884277
Epoch: 4, Steps: 12 | Train Loss: 1.758 Vali Loss: 1.755 Vali Acc: 0.583 Test Loss: 1.755 Test Acc: 0.583
Validation loss decreased (-0.488868 --> -0.583316).  Saving model ...
Epoch: 5 cost time: 1.1026263236999512
Epoch: 5, Steps: 12 | Train Loss: 1.424 Vali Loss: 1.431 Vali Acc: 0.639 Test Loss: 1.431 Test Acc: 0.639
Validation loss decreased (-0.583316 --> -0.638875).  Saving model ...
Epoch: 6 cost time: 1.050374984741211
Epoch: 6, Steps: 12 | Train Loss: 1.105 Vali Loss: 1.185 Vali Acc: 0.667 Test Loss: 1.185 Test Acc: 0.667
Validation loss decreased (-0.638875 --> -0.666655).  Saving model ...
Epoch: 7 cost time: 1.0239872932434082
Epoch: 7, Steps: 12 | Train Loss: 0.799 Vali Loss: 1.015 Vali Acc: 0.706 Test Loss: 1.015 Test Acc: 0.706
Validation loss decreased (-0.666655 --> -0.705545).  Saving model ...
Epoch: 8 cost time: 1.1164751052856445
Epoch: 8, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.917 Vali Acc: 0.722 Test Loss: 0.917 Test Acc: 0.722
Validation loss decreased (-0.705545 --> -0.722213).  Saving model ...
Epoch: 9 cost time: 1.0336878299713135
Epoch: 9, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.834 Vali Acc: 0.717 Test Loss: 0.834 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0080323219299316
Epoch: 10, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.755 Vali Acc: 0.772 Test Loss: 0.755 Test Acc: 0.772
Validation loss decreased (-0.722213 --> -0.772215).  Saving model ...
Epoch: 11 cost time: 1.0046403408050537
Epoch: 11, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.739 Vali Acc: 0.806 Test Loss: 0.739 Test Acc: 0.806
Validation loss decreased (-0.772215 --> -0.805548).  Saving model ...
Epoch: 12 cost time: 1.060420274734497
Epoch: 12, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.736 Vali Acc: 0.778 Test Loss: 0.736 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.097562313079834
Epoch: 13, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.710 Vali Acc: 0.811 Test Loss: 0.710 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 14 cost time: 1.050889253616333
Epoch: 14, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.678 Vali Acc: 0.828 Test Loss: 0.678 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 15 cost time: 1.043290138244629
Epoch: 15, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.714 Vali Acc: 0.817 Test Loss: 0.714 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.017282485961914
Epoch: 16, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.650 Vali Acc: 0.811 Test Loss: 0.650 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9054238796234131
Epoch: 17, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.661 Vali Acc: 0.844 Test Loss: 0.661 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 18 cost time: 0.9476518630981445
Epoch: 18, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.720 Vali Acc: 0.811 Test Loss: 0.720 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9367308616638184
Epoch: 19, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.687 Vali Acc: 0.828 Test Loss: 0.687 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9241695404052734
Epoch: 20, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.702 Vali Acc: 0.839 Test Loss: 0.702 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9403836727142334
Epoch: 21, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.660 Vali Acc: 0.844 Test Loss: 0.660 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 22 cost time: 0.9215753078460693
Epoch: 22, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.700 Vali Acc: 0.872 Test Loss: 0.700 Test Acc: 0.872
Validation loss decreased (-0.844438 --> -0.872215).  Saving model ...
Epoch: 23 cost time: 0.9856624603271484
Epoch: 23, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.749 Vali Acc: 0.850 Test Loss: 0.749 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9426779747009277
Epoch: 24, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.711 Vali Acc: 0.850 Test Loss: 0.711 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0045442581176758
Epoch: 25, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.742 Vali Acc: 0.850 Test Loss: 0.742 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9937546253204346
Epoch: 26, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.710 Vali Acc: 0.867 Test Loss: 0.710 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.001601219177246
Epoch: 27, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.722 Vali Acc: 0.867 Test Loss: 0.722 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0106899738311768
Epoch: 28, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.784 Vali Acc: 0.878 Test Loss: 0.784 Test Acc: 0.878
Validation loss decreased (-0.872215 --> -0.877770).  Saving model ...
Epoch: 29 cost time: 1.0654597282409668
Epoch: 29, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.763 Vali Acc: 0.878 Test Loss: 0.763 Test Acc: 0.878
Validation loss decreased (-0.877770 --> -0.877770).  Saving model ...
Epoch: 30 cost time: 1.0344107151031494
Epoch: 30, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.754 Vali Acc: 0.872 Test Loss: 0.754 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0573413372039795
Epoch: 31, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.770 Vali Acc: 0.867 Test Loss: 0.770 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0498356819152832
Epoch: 32, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.776 Vali Acc: 0.878 Test Loss: 0.776 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9755494594573975
Epoch: 33, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.780 Vali Acc: 0.861 Test Loss: 0.780 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0227527618408203
Epoch: 34, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.813 Vali Acc: 0.867 Test Loss: 0.813 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.019517421722412
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.784 Vali Acc: 0.867 Test Loss: 0.784 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9920868873596191
Epoch: 36, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.864 Vali Acc: 0.867 Test Loss: 0.864 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.007680892944336
Epoch: 37, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.877 Vali Acc: 0.850 Test Loss: 0.877 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0550615787506104
Epoch: 38, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.865 Vali Acc: 0.861 Test Loss: 0.865 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.0494418144226074
Epoch: 39, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.863 Vali Acc: 0.850 Test Loss: 0.863 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 480015
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2687301635742188
Epoch: 1, Steps: 12 | Train Loss: 2.694 Vali Loss: 2.603 Vali Acc: 0.139 Test Loss: 2.603 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 0.9406633377075195
Epoch: 2, Steps: 12 | Train Loss: 2.485 Vali Loss: 2.405 Vali Acc: 0.344 Test Loss: 2.405 Test Acc: 0.344
Validation loss decreased (-0.138863 --> -0.344420).  Saving model ...
Epoch: 3 cost time: 1.1094722747802734
Epoch: 3, Steps: 12 | Train Loss: 2.173 Vali Loss: 2.100 Vali Acc: 0.506 Test Loss: 2.100 Test Acc: 0.506
Validation loss decreased (-0.344420 --> -0.505535).  Saving model ...
Epoch: 4 cost time: 1.0642154216766357
Epoch: 4, Steps: 12 | Train Loss: 1.839 Vali Loss: 1.760 Vali Acc: 0.594 Test Loss: 1.760 Test Acc: 0.594
Validation loss decreased (-0.505535 --> -0.594427).  Saving model ...
Epoch: 5 cost time: 1.0732171535491943
Epoch: 5, Steps: 12 | Train Loss: 1.486 Vali Loss: 1.472 Vali Acc: 0.639 Test Loss: 1.472 Test Acc: 0.639
Validation loss decreased (-0.594427 --> -0.638874).  Saving model ...
Epoch: 6 cost time: 1.0236942768096924
Epoch: 6, Steps: 12 | Train Loss: 1.157 Vali Loss: 1.247 Vali Acc: 0.672 Test Loss: 1.247 Test Acc: 0.672
Validation loss decreased (-0.638874 --> -0.672210).  Saving model ...
Epoch: 7 cost time: 1.0539064407348633
Epoch: 7, Steps: 12 | Train Loss: 0.935 Vali Loss: 1.088 Vali Acc: 0.694 Test Loss: 1.088 Test Acc: 0.694
Validation loss decreased (-0.672210 --> -0.694434).  Saving model ...
Epoch: 8 cost time: 1.0489397048950195
Epoch: 8, Steps: 12 | Train Loss: 0.785 Vali Loss: 1.006 Vali Acc: 0.639 Test Loss: 1.006 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0481207370758057
Epoch: 9, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.909 Vali Acc: 0.694 Test Loss: 0.909 Test Acc: 0.694
Validation loss decreased (-0.694434 --> -0.694435).  Saving model ...
Epoch: 10 cost time: 1.1420280933380127
Epoch: 10, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.842 Vali Acc: 0.739 Test Loss: 0.842 Test Acc: 0.739
Validation loss decreased (-0.694435 --> -0.738880).  Saving model ...
Epoch: 11 cost time: 1.0663540363311768
Epoch: 11, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.799 Vali Acc: 0.761 Test Loss: 0.799 Test Acc: 0.761
Validation loss decreased (-0.738880 --> -0.761103).  Saving model ...
Epoch: 12 cost time: 1.1013603210449219
Epoch: 12, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.739 Vali Acc: 0.778 Test Loss: 0.739 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777770).  Saving model ...
Epoch: 13 cost time: 1.1031599044799805
Epoch: 13, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.671 Vali Acc: 0.806 Test Loss: 0.671 Test Acc: 0.806
Validation loss decreased (-0.777770 --> -0.805549).  Saving model ...
Epoch: 14 cost time: 1.124605655670166
Epoch: 14, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.684 Vali Acc: 0.800 Test Loss: 0.684 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0586118698120117
Epoch: 15, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.641 Vali Acc: 0.839 Test Loss: 0.641 Test Acc: 0.839
Validation loss decreased (-0.805549 --> -0.838882).  Saving model ...
Epoch: 16 cost time: 1.0599744319915771
Epoch: 16, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855550).  Saving model ...
Epoch: 17 cost time: 1.0375494956970215
Epoch: 17, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.628 Vali Acc: 0.844 Test Loss: 0.628 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.055821180343628
Epoch: 18, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.632 Vali Acc: 0.850 Test Loss: 0.632 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.065958023071289
Epoch: 19, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.604 Vali Acc: 0.856 Test Loss: 0.604 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 20 cost time: 1.0517504215240479
Epoch: 20, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.626 Vali Acc: 0.861 Test Loss: 0.626 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 21 cost time: 1.0418882369995117
Epoch: 21, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.623 Vali Acc: 0.850 Test Loss: 0.623 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0615143775939941
Epoch: 22, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.648 Vali Acc: 0.867 Test Loss: 0.648 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 23 cost time: 1.0508170127868652
Epoch: 23, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.699 Vali Acc: 0.861 Test Loss: 0.699 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0109062194824219
Epoch: 24, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.646 Vali Acc: 0.839 Test Loss: 0.646 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.035365104675293
Epoch: 25, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.694 Vali Acc: 0.861 Test Loss: 0.694 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9439024925231934
Epoch: 26, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.673 Vali Acc: 0.856 Test Loss: 0.673 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9753704071044922
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.698 Vali Acc: 0.883 Test Loss: 0.698 Test Acc: 0.883
Validation loss decreased (-0.866660 --> -0.883326).  Saving model ...
Epoch: 28 cost time: 1.05214524269104
Epoch: 28, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.768 Vali Acc: 0.867 Test Loss: 0.768 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0644958019256592
Epoch: 29, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.694 Vali Acc: 0.861 Test Loss: 0.694 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0989220142364502
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.707 Vali Acc: 0.856 Test Loss: 0.707 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0731925964355469
Epoch: 31, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.743 Vali Acc: 0.878 Test Loss: 0.743 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0858983993530273
Epoch: 32, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.773 Vali Acc: 0.872 Test Loss: 0.773 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0149643421173096
Epoch: 33, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.720 Vali Acc: 0.872 Test Loss: 0.720 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0665960311889648
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.726 Vali Acc: 0.878 Test Loss: 0.726 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.0483853816986084
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.782 Vali Acc: 0.856 Test Loss: 0.782 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.0363643169403076
Epoch: 36, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.758 Vali Acc: 0.850 Test Loss: 0.758 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.0480434894561768
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.756 Vali Acc: 0.861 Test Loss: 0.756 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 464911
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2093756198883057
Epoch: 1, Steps: 12 | Train Loss: 2.672 Vali Loss: 2.664 Vali Acc: 0.128 Test Loss: 2.664 Test Acc: 0.128
Validation loss decreased (inf --> -0.127751).  Saving model ...
Epoch: 2 cost time: 1.0679030418395996
Epoch: 2, Steps: 12 | Train Loss: 2.493 Vali Loss: 2.484 Vali Acc: 0.356 Test Loss: 2.484 Test Acc: 0.356
Validation loss decreased (-0.127751 --> -0.355531).  Saving model ...
Epoch: 3 cost time: 1.0095202922821045
Epoch: 3, Steps: 12 | Train Loss: 2.230 Vali Loss: 2.214 Vali Acc: 0.483 Test Loss: 2.214 Test Acc: 0.483
Validation loss decreased (-0.355531 --> -0.483311).  Saving model ...
Epoch: 4 cost time: 1.024733543395996
Epoch: 4, Steps: 12 | Train Loss: 1.926 Vali Loss: 1.883 Vali Acc: 0.606 Test Loss: 1.883 Test Acc: 0.606
Validation loss decreased (-0.483311 --> -0.605537).  Saving model ...
Epoch: 5 cost time: 1.0166363716125488
Epoch: 5, Steps: 12 | Train Loss: 1.540 Vali Loss: 1.587 Vali Acc: 0.644 Test Loss: 1.587 Test Acc: 0.644
Validation loss decreased (-0.605537 --> -0.644429).  Saving model ...
Epoch: 6 cost time: 1.0514864921569824
Epoch: 6, Steps: 12 | Train Loss: 1.295 Vali Loss: 1.331 Vali Acc: 0.639 Test Loss: 1.331 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0503642559051514
Epoch: 7, Steps: 12 | Train Loss: 0.969 Vali Loss: 1.144 Vali Acc: 0.689 Test Loss: 1.144 Test Acc: 0.689
Validation loss decreased (-0.644429 --> -0.688877).  Saving model ...
Epoch: 8 cost time: 0.9992852210998535
Epoch: 8, Steps: 12 | Train Loss: 0.790 Vali Loss: 1.008 Vali Acc: 0.706 Test Loss: 1.008 Test Acc: 0.706
Validation loss decreased (-0.688877 --> -0.705545).  Saving model ...
Epoch: 9 cost time: 0.9722895622253418
Epoch: 9, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.893 Vali Acc: 0.722 Test Loss: 0.893 Test Acc: 0.722
Validation loss decreased (-0.705545 --> -0.722213).  Saving model ...
Epoch: 10 cost time: 1.0188202857971191
Epoch: 10, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.818 Vali Acc: 0.761 Test Loss: 0.818 Test Acc: 0.761
Validation loss decreased (-0.722213 --> -0.761103).  Saving model ...
Epoch: 11 cost time: 0.9391219615936279
Epoch: 11, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.744 Vali Acc: 0.794 Test Loss: 0.744 Test Acc: 0.794
Validation loss decreased (-0.761103 --> -0.794437).  Saving model ...
Epoch: 12 cost time: 1.0176758766174316
Epoch: 12, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.698 Vali Acc: 0.794 Test Loss: 0.698 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794437).  Saving model ...
Epoch: 13 cost time: 1.0944404602050781
Epoch: 13, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.658 Vali Acc: 0.811 Test Loss: 0.658 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811105).  Saving model ...
Epoch: 14 cost time: 1.003220796585083
Epoch: 14, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.606 Vali Acc: 0.833 Test Loss: 0.606 Test Acc: 0.833
Validation loss decreased (-0.811105 --> -0.833327).  Saving model ...
Epoch: 15 cost time: 1.0693848133087158
Epoch: 15, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.623 Vali Acc: 0.806 Test Loss: 0.623 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0648119449615479
Epoch: 16, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.583 Vali Acc: 0.828 Test Loss: 0.583 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0118381977081299
Epoch: 17, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.559 Vali Acc: 0.844 Test Loss: 0.559 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844439).  Saving model ...
Epoch: 18 cost time: 0.9854483604431152
Epoch: 18, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.547 Vali Acc: 0.861 Test Loss: 0.547 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861106).  Saving model ...
Epoch: 19 cost time: 1.0118954181671143
Epoch: 19, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.536 Vali Acc: 0.867 Test Loss: 0.536 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 20 cost time: 1.0392813682556152
Epoch: 20, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9672517776489258
Epoch: 21, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.552 Vali Acc: 0.872 Test Loss: 0.552 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 22 cost time: 1.0476996898651123
Epoch: 22, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.542 Vali Acc: 0.867 Test Loss: 0.542 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0258769989013672
Epoch: 23, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.561 Vali Acc: 0.872 Test Loss: 0.561 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.052182674407959
Epoch: 24, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.549 Vali Acc: 0.872 Test Loss: 0.549 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 25 cost time: 1.0330698490142822
Epoch: 25, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9995260238647461
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.601 Vali Acc: 0.867 Test Loss: 0.601 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.036865234375
Epoch: 27, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.603 Vali Acc: 0.867 Test Loss: 0.603 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0330824851989746
Epoch: 28, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.619 Vali Acc: 0.878 Test Loss: 0.619 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 29 cost time: 1.0700719356536865
Epoch: 29, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.592 Vali Acc: 0.872 Test Loss: 0.592 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0638766288757324
Epoch: 30, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.591 Vali Acc: 0.878 Test Loss: 0.591 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 31 cost time: 1.0601143836975098
Epoch: 31, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.615 Vali Acc: 0.872 Test Loss: 0.615 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1146152019500732
Epoch: 32, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.600 Vali Acc: 0.872 Test Loss: 0.600 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0528945922851562
Epoch: 33, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.664 Vali Acc: 0.883 Test Loss: 0.664 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 34 cost time: 1.0302355289459229
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.615 Vali Acc: 0.872 Test Loss: 0.615 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.998131513595581
Epoch: 35, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.634 Vali Acc: 0.872 Test Loss: 0.634 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.993471622467041
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.705 Vali Acc: 0.878 Test Loss: 0.705 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9444377422332764
Epoch: 37, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.675 Vali Acc: 0.867 Test Loss: 0.675 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9643490314483643
Epoch: 38, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.664 Vali Acc: 0.878 Test Loss: 0.664 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0162875652313232
Epoch: 39, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.676 Vali Acc: 0.861 Test Loss: 0.676 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0499742031097412
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.653 Vali Acc: 0.889 Test Loss: 0.653 Test Acc: 0.889
Validation loss decreased (-0.883327 --> -0.888882).  Saving model ...
Epoch: 41 cost time: 1.049952745437622
Epoch: 41, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.628 Vali Acc: 0.867 Test Loss: 0.628 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0463356971740723
Epoch: 42, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.626 Vali Acc: 0.867 Test Loss: 0.626 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9898149967193604
Epoch: 43, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.653 Vali Acc: 0.872 Test Loss: 0.653 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.988548994064331
Epoch: 44, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.668 Vali Acc: 0.856 Test Loss: 0.668 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.993344783782959
Epoch: 45, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.683 Vali Acc: 0.872 Test Loss: 0.683 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.0144717693328857
Epoch: 46, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.674 Vali Acc: 0.883 Test Loss: 0.674 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.0389089584350586
Epoch: 47, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.676 Vali Acc: 0.872 Test Loss: 0.676 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.07016921043396
Epoch: 48, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.707 Vali Acc: 0.878 Test Loss: 0.707 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.045508623123169
Epoch: 49, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.709 Vali Acc: 0.878 Test Loss: 0.709 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.9687893390655518
Epoch: 50, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.727 Vali Acc: 0.872 Test Loss: 0.727 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 457487
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.319852113723755
Epoch: 1, Steps: 12 | Train Loss: 2.660 Vali Loss: 2.632 Vali Acc: 0.161 Test Loss: 2.632 Test Acc: 0.161
Validation loss decreased (inf --> -0.161085).  Saving model ...
Epoch: 2 cost time: 1.0836000442504883
Epoch: 2, Steps: 12 | Train Loss: 2.539 Vali Loss: 2.470 Vali Acc: 0.317 Test Loss: 2.470 Test Acc: 0.317
Validation loss decreased (-0.161085 --> -0.316642).  Saving model ...
Epoch: 3 cost time: 1.0335988998413086
Epoch: 3, Steps: 12 | Train Loss: 2.287 Vali Loss: 2.232 Vali Acc: 0.506 Test Loss: 2.232 Test Acc: 0.506
Validation loss decreased (-0.316642 --> -0.505533).  Saving model ...
Epoch: 4 cost time: 1.0446395874023438
Epoch: 4, Steps: 12 | Train Loss: 2.001 Vali Loss: 1.949 Vali Acc: 0.572 Test Loss: 1.949 Test Acc: 0.572
Validation loss decreased (-0.505533 --> -0.572203).  Saving model ...
Epoch: 5 cost time: 0.9378912448883057
Epoch: 5, Steps: 12 | Train Loss: 1.703 Vali Loss: 1.674 Vali Acc: 0.611 Test Loss: 1.674 Test Acc: 0.611
Validation loss decreased (-0.572203 --> -0.611094).  Saving model ...
Epoch: 6 cost time: 0.9499890804290771
Epoch: 6, Steps: 12 | Train Loss: 1.359 Vali Loss: 1.392 Vali Acc: 0.650 Test Loss: 1.392 Test Acc: 0.650
Validation loss decreased (-0.611094 --> -0.649986).  Saving model ...
Epoch: 7 cost time: 1.0255136489868164
Epoch: 7, Steps: 12 | Train Loss: 1.157 Vali Loss: 1.221 Vali Acc: 0.689 Test Loss: 1.221 Test Acc: 0.689
Validation loss decreased (-0.649986 --> -0.688877).  Saving model ...
Epoch: 8 cost time: 1.0038793087005615
Epoch: 8, Steps: 12 | Train Loss: 0.865 Vali Loss: 1.059 Vali Acc: 0.706 Test Loss: 1.059 Test Acc: 0.706
Validation loss decreased (-0.688877 --> -0.705545).  Saving model ...
Epoch: 9 cost time: 1.033419132232666
Epoch: 9, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.933 Vali Acc: 0.750 Test Loss: 0.933 Test Acc: 0.750
Validation loss decreased (-0.705545 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 1.0606751441955566
Epoch: 10, Steps: 12 | Train Loss: 0.622 Vali Loss: 0.820 Vali Acc: 0.767 Test Loss: 0.820 Test Acc: 0.767
Validation loss decreased (-0.749991 --> -0.766658).  Saving model ...
Epoch: 11 cost time: 1.0091428756713867
Epoch: 11, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.742 Vali Acc: 0.794 Test Loss: 0.742 Test Acc: 0.794
Validation loss decreased (-0.766658 --> -0.794437).  Saving model ...
Epoch: 12 cost time: 1.038684606552124
Epoch: 12, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.687 Vali Acc: 0.800 Test Loss: 0.687 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 13 cost time: 1.0307235717773438
Epoch: 13, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.639 Vali Acc: 0.811 Test Loss: 0.639 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811105).  Saving model ...
Epoch: 14 cost time: 1.0333807468414307
Epoch: 14, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.588 Vali Acc: 0.828 Test Loss: 0.588 Test Acc: 0.828
Validation loss decreased (-0.811105 --> -0.827772).  Saving model ...
Epoch: 15 cost time: 1.0563809871673584
Epoch: 15, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.580 Vali Acc: 0.822 Test Loss: 0.580 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0560073852539062
Epoch: 16, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.551 Vali Acc: 0.839 Test Loss: 0.551 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 17 cost time: 1.0940334796905518
Epoch: 17, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 18 cost time: 1.1165602207183838
Epoch: 18, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.545 Vali Acc: 0.856 Test Loss: 0.545 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0730082988739014
Epoch: 19, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.545 Vali Acc: 0.833 Test Loss: 0.545 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.042245864868164
Epoch: 20, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.551 Vali Acc: 0.861 Test Loss: 0.551 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 21 cost time: 1.0760600566864014
Epoch: 21, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.531 Vali Acc: 0.878 Test Loss: 0.531 Test Acc: 0.878
Validation loss decreased (-0.861106 --> -0.877772).  Saving model ...
Epoch: 22 cost time: 1.0008270740509033
Epoch: 22, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.512 Vali Acc: 0.872 Test Loss: 0.512 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0019240379333496
Epoch: 23, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.509 Vali Acc: 0.861 Test Loss: 0.509 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9778146743774414
Epoch: 24, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.544 Vali Acc: 0.861 Test Loss: 0.544 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0501899719238281
Epoch: 25, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.537 Vali Acc: 0.861 Test Loss: 0.537 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.062708854675293
Epoch: 26, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.530 Vali Acc: 0.878 Test Loss: 0.530 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 27 cost time: 1.069767951965332
Epoch: 27, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.549 Vali Acc: 0.878 Test Loss: 0.549 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0223376750946045
Epoch: 28, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.563 Vali Acc: 0.883 Test Loss: 0.563 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 29 cost time: 1.014955997467041
Epoch: 29, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.579 Vali Acc: 0.878 Test Loss: 0.579 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9886200428009033
Epoch: 30, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.597 Vali Acc: 0.878 Test Loss: 0.597 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9566640853881836
Epoch: 31, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.549 Vali Acc: 0.872 Test Loss: 0.549 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.969310998916626
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.531 Vali Acc: 0.878 Test Loss: 0.531 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.951237678527832
Epoch: 33, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.539 Vali Acc: 0.872 Test Loss: 0.539 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0341362953186035
Epoch: 34, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.577 Vali Acc: 0.872 Test Loss: 0.577 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0340721607208252
Epoch: 35, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.580 Vali Acc: 0.878 Test Loss: 0.580 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0876679420471191
Epoch: 36, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.581 Vali Acc: 0.878 Test Loss: 0.581 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0688872337341309
Epoch: 37, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.603 Vali Acc: 0.878 Test Loss: 0.603 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.0771586894989014
Epoch: 38, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.613 Vali Acc: 0.883 Test Loss: 0.613 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 450191
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1014492511749268
Epoch: 1, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.660 Vali Acc: 0.100 Test Loss: 2.660 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 0.9084522724151611
Epoch: 2, Steps: 12 | Train Loss: 2.491 Vali Loss: 2.413 Vali Acc: 0.439 Test Loss: 2.413 Test Acc: 0.439
Validation loss decreased (-0.099973 --> -0.438865).  Saving model ...
Epoch: 3 cost time: 0.9881248474121094
Epoch: 3, Steps: 12 | Train Loss: 2.121 Vali Loss: 2.064 Vali Acc: 0.544 Test Loss: 2.064 Test Acc: 0.544
Validation loss decreased (-0.438865 --> -0.544424).  Saving model ...
Epoch: 4 cost time: 0.9084653854370117
Epoch: 4, Steps: 12 | Train Loss: 1.662 Vali Loss: 1.632 Vali Acc: 0.611 Test Loss: 1.632 Test Acc: 0.611
Validation loss decreased (-0.544424 --> -0.611095).  Saving model ...
Epoch: 5 cost time: 0.9250342845916748
Epoch: 5, Steps: 12 | Train Loss: 1.267 Vali Loss: 1.288 Vali Acc: 0.672 Test Loss: 1.288 Test Acc: 0.672
Validation loss decreased (-0.611095 --> -0.672209).  Saving model ...
Epoch: 6 cost time: 0.8924338817596436
Epoch: 6, Steps: 12 | Train Loss: 0.980 Vali Loss: 1.118 Vali Acc: 0.661 Test Loss: 1.118 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9293065071105957
Epoch: 7, Steps: 12 | Train Loss: 0.825 Vali Loss: 0.983 Vali Acc: 0.683 Test Loss: 0.983 Test Acc: 0.683
Validation loss decreased (-0.672209 --> -0.683324).  Saving model ...
Epoch: 8 cost time: 0.8756985664367676
Epoch: 8, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.918 Vali Acc: 0.694 Test Loss: 0.918 Test Acc: 0.694
Validation loss decreased (-0.683324 --> -0.694435).  Saving model ...
Epoch: 9 cost time: 0.9405322074890137
Epoch: 9, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.851 Vali Acc: 0.717 Test Loss: 0.851 Test Acc: 0.717
Validation loss decreased (-0.694435 --> -0.716658).  Saving model ...
Epoch: 10 cost time: 0.9394891262054443
Epoch: 10, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.837 Vali Acc: 0.722 Test Loss: 0.837 Test Acc: 0.722
Validation loss decreased (-0.716658 --> -0.722214).  Saving model ...
Epoch: 11 cost time: 0.9207377433776855
Epoch: 11, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.821 Vali Acc: 0.739 Test Loss: 0.821 Test Acc: 0.739
Validation loss decreased (-0.722214 --> -0.738881).  Saving model ...
Epoch: 12 cost time: 1.0071322917938232
Epoch: 12, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.834 Vali Acc: 0.761 Test Loss: 0.834 Test Acc: 0.761
Validation loss decreased (-0.738881 --> -0.761103).  Saving model ...
Epoch: 13 cost time: 0.9395432472229004
Epoch: 13, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.816 Vali Acc: 0.789 Test Loss: 0.816 Test Acc: 0.789
Validation loss decreased (-0.761103 --> -0.788881).  Saving model ...
Epoch: 14 cost time: 0.9357240200042725
Epoch: 14, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.794 Vali Acc: 0.778 Test Loss: 0.794 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9319348335266113
Epoch: 15, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.763 Vali Acc: 0.789 Test Loss: 0.763 Test Acc: 0.789
Validation loss decreased (-0.788881 --> -0.788881).  Saving model ...
Epoch: 16 cost time: 0.8680920600891113
Epoch: 16, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.825 Vali Acc: 0.778 Test Loss: 0.825 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8382961750030518
Epoch: 17, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.819 Vali Acc: 0.822 Test Loss: 0.819 Test Acc: 0.822
Validation loss decreased (-0.788881 --> -0.822214).  Saving model ...
Epoch: 18 cost time: 0.8593518733978271
Epoch: 18, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.813 Vali Acc: 0.806 Test Loss: 0.813 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9346795082092285
Epoch: 19, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.843 Vali Acc: 0.811 Test Loss: 0.843 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9117417335510254
Epoch: 20, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.803 Vali Acc: 0.817 Test Loss: 0.803 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.952622652053833
Epoch: 21, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.862 Vali Acc: 0.822 Test Loss: 0.862 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8990225791931152
Epoch: 22, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.861 Vali Acc: 0.822 Test Loss: 0.861 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8530466556549072
Epoch: 23, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.910 Vali Acc: 0.811 Test Loss: 0.910 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8641870021820068
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.908 Vali Acc: 0.822 Test Loss: 0.908 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8887476921081543
Epoch: 25, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.878 Vali Acc: 0.844 Test Loss: 0.878 Test Acc: 0.844
Validation loss decreased (-0.822214 --> -0.844436).  Saving model ...
Epoch: 26 cost time: 0.8812735080718994
Epoch: 26, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.865 Vali Acc: 0.833 Test Loss: 0.865 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9084115028381348
Epoch: 27, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.929 Vali Acc: 0.844 Test Loss: 0.929 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7481651306152344
Epoch: 28, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.907 Vali Acc: 0.833 Test Loss: 0.907 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7941741943359375
Epoch: 29, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.886 Vali Acc: 0.839 Test Loss: 0.886 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8131692409515381
Epoch: 30, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.173 Vali Acc: 0.839 Test Loss: 1.173 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9301481246948242
Epoch: 31, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.037 Vali Acc: 0.850 Test Loss: 1.037 Test Acc: 0.850
Validation loss decreased (-0.844436 --> -0.849990).  Saving model ...
Epoch: 32 cost time: 0.8947708606719971
Epoch: 32, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.012 Vali Acc: 0.850 Test Loss: 1.012 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849990).  Saving model ...
Epoch: 33 cost time: 0.9403510093688965
Epoch: 33, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.092 Vali Acc: 0.833 Test Loss: 1.092 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9157524108886719
Epoch: 34, Steps: 12 | Train Loss: 0.083 Vali Loss: 1.018 Vali Acc: 0.867 Test Loss: 1.018 Test Acc: 0.867
Validation loss decreased (-0.849990 --> -0.866656).  Saving model ...
Epoch: 35 cost time: 0.9005579948425293
Epoch: 35, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.017 Vali Acc: 0.844 Test Loss: 1.017 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.91379714012146
Epoch: 36, Steps: 12 | Train Loss: 0.142 Vali Loss: 1.133 Vali Acc: 0.844 Test Loss: 1.133 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8915891647338867
Epoch: 37, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.079 Vali Acc: 0.844 Test Loss: 1.079 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.95458984375
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.243 Vali Acc: 0.844 Test Loss: 1.243 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9746737480163574
Epoch: 39, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.247 Vali Acc: 0.856 Test Loss: 1.247 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9682574272155762
Epoch: 40, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.164 Vali Acc: 0.839 Test Loss: 1.164 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.941497802734375
Epoch: 41, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.230 Vali Acc: 0.828 Test Loss: 1.230 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.9273350238800049
Epoch: 42, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.311 Vali Acc: 0.844 Test Loss: 1.311 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.8725144863128662
Epoch: 43, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.178 Vali Acc: 0.850 Test Loss: 1.178 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.9034807682037354
Epoch: 44, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.316 Vali Acc: 0.856 Test Loss: 1.316 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 199119
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1475346088409424
Epoch: 1, Steps: 12 | Train Loss: 2.704 Vali Loss: 2.689 Vali Acc: 0.089 Test Loss: 2.689 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 0.875267505645752
Epoch: 2, Steps: 12 | Train Loss: 2.574 Vali Loss: 2.546 Vali Acc: 0.261 Test Loss: 2.546 Test Acc: 0.261
Validation loss decreased (-0.088862 --> -0.261086).  Saving model ...
Epoch: 3 cost time: 0.9083964824676514
Epoch: 3, Steps: 12 | Train Loss: 2.384 Vali Loss: 2.325 Vali Acc: 0.511 Test Loss: 2.325 Test Acc: 0.511
Validation loss decreased (-0.261086 --> -0.511088).  Saving model ...
Epoch: 4 cost time: 0.8328921794891357
Epoch: 4, Steps: 12 | Train Loss: 2.135 Vali Loss: 2.042 Vali Acc: 0.544 Test Loss: 2.042 Test Acc: 0.544
Validation loss decreased (-0.511088 --> -0.544424).  Saving model ...
Epoch: 5 cost time: 0.9235455989837646
Epoch: 5, Steps: 12 | Train Loss: 1.810 Vali Loss: 1.756 Vali Acc: 0.617 Test Loss: 1.756 Test Acc: 0.617
Validation loss decreased (-0.544424 --> -0.616649).  Saving model ...
Epoch: 6 cost time: 0.897925853729248
Epoch: 6, Steps: 12 | Train Loss: 1.489 Vali Loss: 1.498 Vali Acc: 0.644 Test Loss: 1.498 Test Acc: 0.644
Validation loss decreased (-0.616649 --> -0.644429).  Saving model ...
Epoch: 7 cost time: 0.8828222751617432
Epoch: 7, Steps: 12 | Train Loss: 1.238 Vali Loss: 1.286 Vali Acc: 0.672 Test Loss: 1.286 Test Acc: 0.672
Validation loss decreased (-0.644429 --> -0.672209).  Saving model ...
Epoch: 8 cost time: 0.9976613521575928
Epoch: 8, Steps: 12 | Train Loss: 0.957 Vali Loss: 1.133 Vali Acc: 0.678 Test Loss: 1.133 Test Acc: 0.678
Validation loss decreased (-0.672209 --> -0.677766).  Saving model ...
Epoch: 9 cost time: 0.9478449821472168
Epoch: 9, Steps: 12 | Train Loss: 0.780 Vali Loss: 1.032 Vali Acc: 0.694 Test Loss: 1.032 Test Acc: 0.694
Validation loss decreased (-0.677766 --> -0.694434).  Saving model ...
Epoch: 10 cost time: 0.9625551700592041
Epoch: 10, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.964 Vali Acc: 0.689 Test Loss: 0.964 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9127588272094727
Epoch: 11, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.922 Vali Acc: 0.706 Test Loss: 0.922 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705546).  Saving model ...
Epoch: 12 cost time: 0.9481699466705322
Epoch: 12, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.875 Vali Acc: 0.706 Test Loss: 0.875 Test Acc: 0.706
Validation loss decreased (-0.705546 --> -0.705547).  Saving model ...
Epoch: 13 cost time: 0.9124245643615723
Epoch: 13, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.810 Vali Acc: 0.728 Test Loss: 0.810 Test Acc: 0.728
Validation loss decreased (-0.705547 --> -0.727770).  Saving model ...
Epoch: 14 cost time: 0.9041211605072021
Epoch: 14, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.768 Vali Acc: 0.756 Test Loss: 0.768 Test Acc: 0.756
Validation loss decreased (-0.727770 --> -0.755548).  Saving model ...
Epoch: 15 cost time: 0.935077428817749
Epoch: 15, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.750 Vali Acc: 0.761 Test Loss: 0.750 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761104).  Saving model ...
Epoch: 16 cost time: 0.8959095478057861
Epoch: 16, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.744 Vali Acc: 0.800 Test Loss: 0.744 Test Acc: 0.800
Validation loss decreased (-0.761104 --> -0.799993).  Saving model ...
Epoch: 17 cost time: 0.9309005737304688
Epoch: 17, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.715 Vali Acc: 0.806 Test Loss: 0.715 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805548).  Saving model ...
Epoch: 18 cost time: 0.9086997509002686
Epoch: 18, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.674 Vali Acc: 0.794 Test Loss: 0.674 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9121599197387695
Epoch: 19, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.710 Vali Acc: 0.811 Test Loss: 0.710 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 20 cost time: 0.9460079669952393
Epoch: 20, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.696 Vali Acc: 0.828 Test Loss: 0.696 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 21 cost time: 0.8970077037811279
Epoch: 21, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.664 Vali Acc: 0.811 Test Loss: 0.664 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7998988628387451
Epoch: 22, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.669 Vali Acc: 0.833 Test Loss: 0.669 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 23 cost time: 0.8284544944763184
Epoch: 23, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.691 Vali Acc: 0.828 Test Loss: 0.691 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.801023006439209
Epoch: 24, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.659 Vali Acc: 0.844 Test Loss: 0.659 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 25 cost time: 0.7545065879821777
Epoch: 25, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.633 Vali Acc: 0.872 Test Loss: 0.633 Test Acc: 0.872
Validation loss decreased (-0.844438 --> -0.872216).  Saving model ...
Epoch: 26 cost time: 0.8435134887695312
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.649 Vali Acc: 0.850 Test Loss: 0.649 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8447935581207275
Epoch: 27, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.691 Vali Acc: 0.828 Test Loss: 0.691 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9261422157287598
Epoch: 28, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.665 Vali Acc: 0.856 Test Loss: 0.665 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9469459056854248
Epoch: 29, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.694 Vali Acc: 0.861 Test Loss: 0.694 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.004523754119873
Epoch: 30, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.724 Vali Acc: 0.844 Test Loss: 0.724 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9187746047973633
Epoch: 31, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.724 Vali Acc: 0.856 Test Loss: 0.724 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9437670707702637
Epoch: 32, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.771 Vali Acc: 0.850 Test Loss: 0.771 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.933434009552002
Epoch: 33, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.763 Vali Acc: 0.867 Test Loss: 0.763 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9607181549072266
Epoch: 34, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.744 Vali Acc: 0.872 Test Loss: 0.744 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9294404983520508
Epoch: 35, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.746 Vali Acc: 0.861 Test Loss: 0.746 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 153103
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1789677143096924
Epoch: 1, Steps: 12 | Train Loss: 2.734 Vali Loss: 2.710 Vali Acc: 0.044 Test Loss: 2.710 Test Acc: 0.044
Validation loss decreased (inf --> -0.044417).  Saving model ...
Epoch: 2 cost time: 0.9089953899383545
Epoch: 2, Steps: 12 | Train Loss: 2.581 Vali Loss: 2.578 Vali Acc: 0.244 Test Loss: 2.578 Test Acc: 0.244
Validation loss decreased (-0.044417 --> -0.244419).  Saving model ...
Epoch: 3 cost time: 0.8823275566101074
Epoch: 3, Steps: 12 | Train Loss: 2.401 Vali Loss: 2.377 Vali Acc: 0.406 Test Loss: 2.377 Test Acc: 0.406
Validation loss decreased (-0.244419 --> -0.405532).  Saving model ...
Epoch: 4 cost time: 0.9015305042266846
Epoch: 4, Steps: 12 | Train Loss: 2.133 Vali Loss: 2.117 Vali Acc: 0.472 Test Loss: 2.117 Test Acc: 0.472
Validation loss decreased (-0.405532 --> -0.472201).  Saving model ...
Epoch: 5 cost time: 0.8967957496643066
Epoch: 5, Steps: 12 | Train Loss: 1.823 Vali Loss: 1.821 Vali Acc: 0.522 Test Loss: 1.821 Test Acc: 0.522
Validation loss decreased (-0.472201 --> -0.522204).  Saving model ...
Epoch: 6 cost time: 0.9235661029815674
Epoch: 6, Steps: 12 | Train Loss: 1.536 Vali Loss: 1.559 Vali Acc: 0.578 Test Loss: 1.559 Test Acc: 0.578
Validation loss decreased (-0.522204 --> -0.577762).  Saving model ...
Epoch: 7 cost time: 0.9278109073638916
Epoch: 7, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.358 Vali Acc: 0.628 Test Loss: 1.358 Test Acc: 0.628
Validation loss decreased (-0.577762 --> -0.627764).  Saving model ...
Epoch: 8 cost time: 0.9269618988037109
Epoch: 8, Steps: 12 | Train Loss: 0.983 Vali Loss: 1.162 Vali Acc: 0.667 Test Loss: 1.162 Test Acc: 0.667
Validation loss decreased (-0.627764 --> -0.666655).  Saving model ...
Epoch: 9 cost time: 0.9118504524230957
Epoch: 9, Steps: 12 | Train Loss: 0.887 Vali Loss: 1.051 Vali Acc: 0.672 Test Loss: 1.051 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672212).  Saving model ...
Epoch: 10 cost time: 0.9364676475524902
Epoch: 10, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.940 Vali Acc: 0.700 Test Loss: 0.940 Test Acc: 0.700
Validation loss decreased (-0.672212 --> -0.699991).  Saving model ...
Epoch: 11 cost time: 0.8420829772949219
Epoch: 11, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.897 Vali Acc: 0.706 Test Loss: 0.897 Test Acc: 0.706
Validation loss decreased (-0.699991 --> -0.705547).  Saving model ...
Epoch: 12 cost time: 0.8953933715820312
Epoch: 12, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.833 Vali Acc: 0.706 Test Loss: 0.833 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
Epoch: 13 cost time: 0.9184579849243164
Epoch: 13, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.781 Vali Acc: 0.728 Test Loss: 0.781 Test Acc: 0.728
Validation loss decreased (-0.705547 --> -0.727770).  Saving model ...
Epoch: 14 cost time: 0.8533930778503418
Epoch: 14, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.739 Vali Acc: 0.772 Test Loss: 0.739 Test Acc: 0.772
Validation loss decreased (-0.727770 --> -0.772215).  Saving model ...
Epoch: 15 cost time: 0.8844518661499023
Epoch: 15, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.702 Vali Acc: 0.806 Test Loss: 0.702 Test Acc: 0.806
Validation loss decreased (-0.772215 --> -0.805549).  Saving model ...
Epoch: 16 cost time: 0.9107928276062012
Epoch: 16, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.673 Vali Acc: 0.806 Test Loss: 0.673 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805549).  Saving model ...
Epoch: 17 cost time: 0.9272031784057617
Epoch: 17, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.627 Vali Acc: 0.844 Test Loss: 0.627 Test Acc: 0.844
Validation loss decreased (-0.805549 --> -0.844438).  Saving model ...
Epoch: 18 cost time: 0.9235644340515137
Epoch: 18, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.627 Vali Acc: 0.833 Test Loss: 0.627 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9188318252563477
Epoch: 19, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.611 Vali Acc: 0.833 Test Loss: 0.611 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9153106212615967
Epoch: 20, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.586 Vali Acc: 0.828 Test Loss: 0.586 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.902947187423706
Epoch: 21, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.597 Vali Acc: 0.850 Test Loss: 0.597 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 22 cost time: 0.896690845489502
Epoch: 22, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.601 Vali Acc: 0.856 Test Loss: 0.601 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 23 cost time: 0.8737542629241943
Epoch: 23, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.598 Vali Acc: 0.850 Test Loss: 0.598 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8847723007202148
Epoch: 24, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.634 Vali Acc: 0.856 Test Loss: 0.634 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9170596599578857
Epoch: 25, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.631 Vali Acc: 0.861 Test Loss: 0.631 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 26 cost time: 0.9287974834442139
Epoch: 26, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.611 Vali Acc: 0.861 Test Loss: 0.611 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 27 cost time: 0.9028177261352539
Epoch: 27, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.609 Vali Acc: 0.861 Test Loss: 0.609 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 28 cost time: 0.8967137336730957
Epoch: 28, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.626 Vali Acc: 0.872 Test Loss: 0.626 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 29 cost time: 0.8400313854217529
Epoch: 29, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.639 Vali Acc: 0.850 Test Loss: 0.639 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9173829555511475
Epoch: 30, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.641 Vali Acc: 0.861 Test Loss: 0.641 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8570313453674316
Epoch: 31, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.653 Vali Acc: 0.850 Test Loss: 0.653 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8698976039886475
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.696 Vali Acc: 0.856 Test Loss: 0.696 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8761615753173828
Epoch: 33, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.666 Vali Acc: 0.861 Test Loss: 0.666 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.886101245880127
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.678 Vali Acc: 0.844 Test Loss: 0.678 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9178006649017334
Epoch: 35, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.719 Vali Acc: 0.861 Test Loss: 0.719 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.9305131435394287
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.670 Vali Acc: 0.856 Test Loss: 0.670 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.94081711769104
Epoch: 37, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.667 Vali Acc: 0.856 Test Loss: 0.667 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9220225811004639
Epoch: 38, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.680 Vali Acc: 0.867 Test Loss: 0.680 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 153167
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2364935874938965
Epoch: 1, Steps: 12 | Train Loss: 2.724 Vali Loss: 2.677 Vali Acc: 0.067 Test Loss: 2.677 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 0.9180641174316406
Epoch: 2, Steps: 12 | Train Loss: 2.620 Vali Loss: 2.566 Vali Acc: 0.139 Test Loss: 2.566 Test Acc: 0.139
Validation loss decreased (-0.066640 --> -0.138863).  Saving model ...
Epoch: 3 cost time: 0.9361541271209717
Epoch: 3, Steps: 12 | Train Loss: 2.421 Vali Loss: 2.391 Vali Acc: 0.450 Test Loss: 2.391 Test Acc: 0.450
Validation loss decreased (-0.138863 --> -0.449976).  Saving model ...
Epoch: 4 cost time: 0.89404296875
Epoch: 4, Steps: 12 | Train Loss: 2.186 Vali Loss: 2.154 Vali Acc: 0.478 Test Loss: 2.154 Test Acc: 0.478
Validation loss decreased (-0.449976 --> -0.477756).  Saving model ...
Epoch: 5 cost time: 0.7862355709075928
Epoch: 5, Steps: 12 | Train Loss: 1.938 Vali Loss: 1.898 Vali Acc: 0.517 Test Loss: 1.898 Test Acc: 0.517
Validation loss decreased (-0.477756 --> -0.516648).  Saving model ...
Epoch: 6 cost time: 0.8022527694702148
Epoch: 6, Steps: 12 | Train Loss: 1.661 Vali Loss: 1.650 Vali Acc: 0.572 Test Loss: 1.650 Test Acc: 0.572
Validation loss decreased (-0.516648 --> -0.572206).  Saving model ...
Epoch: 7 cost time: 0.893500566482544
Epoch: 7, Steps: 12 | Train Loss: 1.380 Vali Loss: 1.463 Vali Acc: 0.594 Test Loss: 1.463 Test Acc: 0.594
Validation loss decreased (-0.572206 --> -0.594430).  Saving model ...
Epoch: 8 cost time: 0.7778453826904297
Epoch: 8, Steps: 12 | Train Loss: 1.171 Vali Loss: 1.253 Vali Acc: 0.644 Test Loss: 1.253 Test Acc: 0.644
Validation loss decreased (-0.594430 --> -0.644432).  Saving model ...
Epoch: 9 cost time: 0.7961020469665527
Epoch: 9, Steps: 12 | Train Loss: 0.936 Vali Loss: 1.121 Vali Acc: 0.683 Test Loss: 1.121 Test Acc: 0.683
Validation loss decreased (-0.644432 --> -0.683322).  Saving model ...
Epoch: 10 cost time: 0.9209136962890625
Epoch: 10, Steps: 12 | Train Loss: 0.777 Vali Loss: 1.039 Vali Acc: 0.678 Test Loss: 1.039 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9311051368713379
Epoch: 11, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.952 Vali Acc: 0.678 Test Loss: 0.952 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9407365322113037
Epoch: 12, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.863 Vali Acc: 0.739 Test Loss: 0.863 Test Acc: 0.739
Validation loss decreased (-0.683322 --> -0.738880).  Saving model ...
Epoch: 13 cost time: 0.9954602718353271
Epoch: 13, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.830 Vali Acc: 0.761 Test Loss: 0.830 Test Acc: 0.761
Validation loss decreased (-0.738880 --> -0.761103).  Saving model ...
Epoch: 14 cost time: 0.9491791725158691
Epoch: 14, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.787 Vali Acc: 0.783 Test Loss: 0.787 Test Acc: 0.783
Validation loss decreased (-0.761103 --> -0.783325).  Saving model ...
Epoch: 15 cost time: 0.8861110210418701
Epoch: 15, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.754 Vali Acc: 0.794 Test Loss: 0.754 Test Acc: 0.794
Validation loss decreased (-0.783325 --> -0.794437).  Saving model ...
Epoch: 16 cost time: 0.9827558994293213
Epoch: 16, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.705 Vali Acc: 0.794 Test Loss: 0.705 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794437).  Saving model ...
Epoch: 17 cost time: 1.0089714527130127
Epoch: 17, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.632 Vali Acc: 0.828 Test Loss: 0.632 Test Acc: 0.828
Validation loss decreased (-0.794437 --> -0.827771).  Saving model ...
Epoch: 18 cost time: 0.9254467487335205
Epoch: 18, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.651 Vali Acc: 0.817 Test Loss: 0.651 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0333552360534668
Epoch: 19, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.626 Vali Acc: 0.811 Test Loss: 0.626 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9687008857727051
Epoch: 20, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.628 Vali Acc: 0.822 Test Loss: 0.628 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9505753517150879
Epoch: 21, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.630 Vali Acc: 0.839 Test Loss: 0.630 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838883).  Saving model ...
Epoch: 22 cost time: 0.9505128860473633
Epoch: 22, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 0.9312093257904053
Epoch: 23, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.591 Vali Acc: 0.844 Test Loss: 0.591 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9073925018310547
Epoch: 24, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 0.8770830631256104
Epoch: 25, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.597 Vali Acc: 0.844 Test Loss: 0.597 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8829939365386963
Epoch: 26, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.618 Vali Acc: 0.850 Test Loss: 0.618 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8539764881134033
Epoch: 27, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.601 Vali Acc: 0.861 Test Loss: 0.601 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 28 cost time: 0.8750784397125244
Epoch: 28, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.601 Vali Acc: 0.867 Test Loss: 0.601 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 29 cost time: 0.8664283752441406
Epoch: 29, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.591 Vali Acc: 0.867 Test Loss: 0.591 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 30 cost time: 0.8661983013153076
Epoch: 30, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.604 Vali Acc: 0.878 Test Loss: 0.604 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 31 cost time: 0.938481330871582
Epoch: 31, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.650 Vali Acc: 0.850 Test Loss: 0.650 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9054656028747559
Epoch: 32, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.668 Vali Acc: 0.850 Test Loss: 0.668 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9137773513793945
Epoch: 33, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.662 Vali Acc: 0.872 Test Loss: 0.662 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9037175178527832
Epoch: 34, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.660 Vali Acc: 0.867 Test Loss: 0.660 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9150407314300537
Epoch: 35, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.663 Vali Acc: 0.883 Test Loss: 0.663 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 36 cost time: 0.9040987491607666
Epoch: 36, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.646 Vali Acc: 0.872 Test Loss: 0.646 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.914250373840332
Epoch: 37, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.651 Vali Acc: 0.856 Test Loss: 0.651 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9052736759185791
Epoch: 38, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.704 Vali Acc: 0.872 Test Loss: 0.704 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9462916851043701
Epoch: 39, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.686 Vali Acc: 0.872 Test Loss: 0.686 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9545974731445312
Epoch: 40, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.683 Vali Acc: 0.872 Test Loss: 0.683 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9167108535766602
Epoch: 41, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.693 Vali Acc: 0.878 Test Loss: 0.693 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.9394488334655762
Epoch: 42, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.729 Vali Acc: 0.883 Test Loss: 0.729 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9319343566894531
Epoch: 43, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.715 Vali Acc: 0.867 Test Loss: 0.715 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.9223978519439697
Epoch: 44, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.714 Vali Acc: 0.861 Test Loss: 0.714 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.8538954257965088
Epoch: 45, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.720 Vali Acc: 0.856 Test Loss: 0.720 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 141711
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.003945827484131
Epoch: 1, Steps: 12 | Train Loss: 2.736 Vali Loss: 2.697 Vali Acc: 0.111 Test Loss: 2.697 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 0.8409745693206787
Epoch: 2, Steps: 12 | Train Loss: 2.630 Vali Loss: 2.614 Vali Acc: 0.144 Test Loss: 2.614 Test Acc: 0.144
Validation loss decreased (-0.111084 --> -0.144418).  Saving model ...
Epoch: 3 cost time: 0.8257961273193359
Epoch: 3, Steps: 12 | Train Loss: 2.485 Vali Loss: 2.474 Vali Acc: 0.306 Test Loss: 2.474 Test Acc: 0.306
Validation loss decreased (-0.144418 --> -0.305531).  Saving model ...
Epoch: 4 cost time: 0.8337748050689697
Epoch: 4, Steps: 12 | Train Loss: 2.327 Vali Loss: 2.276 Vali Acc: 0.439 Test Loss: 2.276 Test Acc: 0.439
Validation loss decreased (-0.305531 --> -0.438866).  Saving model ...
Epoch: 5 cost time: 0.8511991500854492
Epoch: 5, Steps: 12 | Train Loss: 2.132 Vali Loss: 2.070 Vali Acc: 0.556 Test Loss: 2.070 Test Acc: 0.556
Validation loss decreased (-0.438866 --> -0.555535).  Saving model ...
Epoch: 6 cost time: 0.9111735820770264
Epoch: 6, Steps: 12 | Train Loss: 1.835 Vali Loss: 1.820 Vali Acc: 0.611 Test Loss: 1.820 Test Acc: 0.611
Validation loss decreased (-0.555535 --> -0.611093).  Saving model ...
Epoch: 7 cost time: 0.9251265525817871
Epoch: 7, Steps: 12 | Train Loss: 1.553 Vali Loss: 1.604 Vali Acc: 0.633 Test Loss: 1.604 Test Acc: 0.633
Validation loss decreased (-0.611093 --> -0.633317).  Saving model ...
Epoch: 8 cost time: 0.9111969470977783
Epoch: 8, Steps: 12 | Train Loss: 1.290 Vali Loss: 1.424 Vali Acc: 0.639 Test Loss: 1.424 Test Acc: 0.639
Validation loss decreased (-0.633317 --> -0.638875).  Saving model ...
Epoch: 9 cost time: 0.9105041027069092
Epoch: 9, Steps: 12 | Train Loss: 1.133 Vali Loss: 1.256 Vali Acc: 0.656 Test Loss: 1.256 Test Acc: 0.656
Validation loss decreased (-0.638875 --> -0.655543).  Saving model ...
Epoch: 10 cost time: 0.8967344760894775
Epoch: 10, Steps: 12 | Train Loss: 0.973 Vali Loss: 1.127 Vali Acc: 0.650 Test Loss: 1.127 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9205482006072998
Epoch: 11, Steps: 12 | Train Loss: 0.820 Vali Loss: 1.035 Vali Acc: 0.694 Test Loss: 1.035 Test Acc: 0.694
Validation loss decreased (-0.655543 --> -0.694434).  Saving model ...
Epoch: 12 cost time: 0.9239091873168945
Epoch: 12, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.935 Vali Acc: 0.728 Test Loss: 0.935 Test Acc: 0.728
Validation loss decreased (-0.694434 --> -0.727768).  Saving model ...
Epoch: 13 cost time: 0.8875002861022949
Epoch: 13, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.879 Vali Acc: 0.733 Test Loss: 0.879 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733325).  Saving model ...
Epoch: 14 cost time: 0.9852597713470459
Epoch: 14, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.826 Vali Acc: 0.761 Test Loss: 0.826 Test Acc: 0.761
Validation loss decreased (-0.733325 --> -0.761103).  Saving model ...
Epoch: 15 cost time: 0.9504742622375488
Epoch: 15, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.743 Vali Acc: 0.789 Test Loss: 0.743 Test Acc: 0.789
Validation loss decreased (-0.761103 --> -0.788881).  Saving model ...
Epoch: 16 cost time: 0.9402556419372559
Epoch: 16, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.709 Vali Acc: 0.794 Test Loss: 0.709 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794437).  Saving model ...
Epoch: 17 cost time: 0.9257862567901611
Epoch: 17, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.689 Vali Acc: 0.811 Test Loss: 0.689 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811104).  Saving model ...
Epoch: 18 cost time: 0.8893368244171143
Epoch: 18, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.657 Vali Acc: 0.822 Test Loss: 0.657 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822216).  Saving model ...
Epoch: 19 cost time: 0.9333996772766113
Epoch: 19, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.632 Vali Acc: 0.828 Test Loss: 0.632 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827771).  Saving model ...
Epoch: 20 cost time: 0.8805649280548096
Epoch: 20, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.604 Vali Acc: 0.844 Test Loss: 0.604 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 21 cost time: 0.9166245460510254
Epoch: 21, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 22 cost time: 0.8961613178253174
Epoch: 22, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.601 Vali Acc: 0.850 Test Loss: 0.601 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.863699197769165
Epoch: 23, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.560 Vali Acc: 0.867 Test Loss: 0.560 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866661).  Saving model ...
Epoch: 24 cost time: 0.872685432434082
Epoch: 24, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.570 Vali Acc: 0.867 Test Loss: 0.570 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8948283195495605
Epoch: 25, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.568 Vali Acc: 0.856 Test Loss: 0.568 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8890929222106934
Epoch: 26, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.581 Vali Acc: 0.861 Test Loss: 0.581 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8538541793823242
Epoch: 27, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.595 Vali Acc: 0.861 Test Loss: 0.595 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.906156063079834
Epoch: 28, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.603 Vali Acc: 0.850 Test Loss: 0.603 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9255032539367676
Epoch: 29, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.607 Vali Acc: 0.844 Test Loss: 0.607 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9342448711395264
Epoch: 30, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.576 Vali Acc: 0.861 Test Loss: 0.576 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9185190200805664
Epoch: 31, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.570 Vali Acc: 0.867 Test Loss: 0.570 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9501705169677734
Epoch: 32, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.589 Vali Acc: 0.867 Test Loss: 0.589 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9235608577728271
Epoch: 33, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.609 Vali Acc: 0.861 Test Loss: 0.609 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 134159
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2072861194610596
Epoch: 1, Steps: 12 | Train Loss: 2.694 Vali Loss: 2.656 Vali Acc: 0.083 Test Loss: 2.656 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 0.8577535152435303
Epoch: 2, Steps: 12 | Train Loss: 2.594 Vali Loss: 2.581 Vali Acc: 0.161 Test Loss: 2.581 Test Acc: 0.161
Validation loss decreased (-0.083307 --> -0.161085).  Saving model ...
Epoch: 3 cost time: 0.9118027687072754
Epoch: 3, Steps: 12 | Train Loss: 2.466 Vali Loss: 2.464 Vali Acc: 0.372 Test Loss: 2.464 Test Acc: 0.372
Validation loss decreased (-0.161085 --> -0.372198).  Saving model ...
Epoch: 4 cost time: 0.921724796295166
Epoch: 4, Steps: 12 | Train Loss: 2.342 Vali Loss: 2.301 Vali Acc: 0.450 Test Loss: 2.301 Test Acc: 0.450
Validation loss decreased (-0.372198 --> -0.449977).  Saving model ...
Epoch: 5 cost time: 0.9167752265930176
Epoch: 5, Steps: 12 | Train Loss: 2.168 Vali Loss: 2.113 Vali Acc: 0.583 Test Loss: 2.113 Test Acc: 0.583
Validation loss decreased (-0.449977 --> -0.583312).  Saving model ...
Epoch: 6 cost time: 0.9256715774536133
Epoch: 6, Steps: 12 | Train Loss: 1.922 Vali Loss: 1.904 Vali Acc: 0.606 Test Loss: 1.904 Test Acc: 0.606
Validation loss decreased (-0.583312 --> -0.605537).  Saving model ...
Epoch: 7 cost time: 0.8701903820037842
Epoch: 7, Steps: 12 | Train Loss: 1.688 Vali Loss: 1.704 Vali Acc: 0.617 Test Loss: 1.704 Test Acc: 0.617
Validation loss decreased (-0.605537 --> -0.616650).  Saving model ...
Epoch: 8 cost time: 0.8957772254943848
Epoch: 8, Steps: 12 | Train Loss: 1.471 Vali Loss: 1.492 Vali Acc: 0.650 Test Loss: 1.492 Test Acc: 0.650
Validation loss decreased (-0.616650 --> -0.649985).  Saving model ...
Epoch: 9 cost time: 0.9034183025360107
Epoch: 9, Steps: 12 | Train Loss: 1.263 Vali Loss: 1.321 Vali Acc: 0.656 Test Loss: 1.321 Test Acc: 0.656
Validation loss decreased (-0.649985 --> -0.655542).  Saving model ...
Epoch: 10 cost time: 0.8902683258056641
Epoch: 10, Steps: 12 | Train Loss: 1.058 Vali Loss: 1.194 Vali Acc: 0.689 Test Loss: 1.194 Test Acc: 0.689
Validation loss decreased (-0.655542 --> -0.688877).  Saving model ...
Epoch: 11 cost time: 0.8943805694580078
Epoch: 11, Steps: 12 | Train Loss: 0.895 Vali Loss: 1.067 Vali Acc: 0.689 Test Loss: 1.067 Test Acc: 0.689
Validation loss decreased (-0.688877 --> -0.688878).  Saving model ...
Epoch: 12 cost time: 0.8027691841125488
Epoch: 12, Steps: 12 | Train Loss: 0.769 Vali Loss: 0.972 Vali Acc: 0.717 Test Loss: 0.972 Test Acc: 0.717
Validation loss decreased (-0.688878 --> -0.716657).  Saving model ...
Epoch: 13 cost time: 0.8821263313293457
Epoch: 13, Steps: 12 | Train Loss: 0.689 Vali Loss: 0.902 Vali Acc: 0.750 Test Loss: 0.902 Test Acc: 0.750
Validation loss decreased (-0.716657 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.8910934925079346
Epoch: 14, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.820 Vali Acc: 0.778 Test Loss: 0.820 Test Acc: 0.778
Validation loss decreased (-0.749991 --> -0.777770).  Saving model ...
Epoch: 15 cost time: 1.0571632385253906
Epoch: 15, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.774 Vali Acc: 0.794 Test Loss: 0.774 Test Acc: 0.794
Validation loss decreased (-0.777770 --> -0.794437).  Saving model ...
Epoch: 16 cost time: 0.9750227928161621
Epoch: 16, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.725 Vali Acc: 0.811 Test Loss: 0.725 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811104).  Saving model ...
Epoch: 17 cost time: 0.9416301250457764
Epoch: 17, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.675 Vali Acc: 0.833 Test Loss: 0.675 Test Acc: 0.833
Validation loss decreased (-0.811104 --> -0.833327).  Saving model ...
Epoch: 18 cost time: 0.9246714115142822
Epoch: 18, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.661 Vali Acc: 0.822 Test Loss: 0.661 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8651251792907715
Epoch: 19, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.637 Vali Acc: 0.817 Test Loss: 0.637 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.953683614730835
Epoch: 20, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.601 Vali Acc: 0.844 Test Loss: 0.601 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 21 cost time: 0.9287772178649902
Epoch: 21, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.587 Vali Acc: 0.850 Test Loss: 0.587 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 22 cost time: 0.9425661563873291
Epoch: 22, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.575 Vali Acc: 0.833 Test Loss: 0.575 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9132051467895508
Epoch: 23, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.556 Vali Acc: 0.872 Test Loss: 0.556 Test Acc: 0.872
Validation loss decreased (-0.849994 --> -0.872217).  Saving model ...
Epoch: 24 cost time: 0.9461455345153809
Epoch: 24, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9264612197875977
Epoch: 25, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.566 Vali Acc: 0.839 Test Loss: 0.566 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8943588733673096
Epoch: 26, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.570 Vali Acc: 0.850 Test Loss: 0.570 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9327750205993652
Epoch: 27, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8929572105407715
Epoch: 28, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.538 Vali Acc: 0.861 Test Loss: 0.538 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8984034061431885
Epoch: 29, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.551 Vali Acc: 0.878 Test Loss: 0.551 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 30 cost time: 0.9022035598754883
Epoch: 30, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.552 Vali Acc: 0.861 Test Loss: 0.552 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8995239734649658
Epoch: 31, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.551 Vali Acc: 0.878 Test Loss: 0.551 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 32 cost time: 0.8706021308898926
Epoch: 32, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.544 Vali Acc: 0.867 Test Loss: 0.544 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8929729461669922
Epoch: 33, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.581 Vali Acc: 0.872 Test Loss: 0.581 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9312727451324463
Epoch: 34, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.571 Vali Acc: 0.872 Test Loss: 0.571 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9758872985839844
Epoch: 35, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.566 Vali Acc: 0.872 Test Loss: 0.566 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8848724365234375
Epoch: 36, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.569 Vali Acc: 0.872 Test Loss: 0.569 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9320793151855469
Epoch: 37, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.576 Vali Acc: 0.878 Test Loss: 0.576 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.99544358253479
Epoch: 38, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.578 Vali Acc: 0.878 Test Loss: 0.578 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.9704985618591309
Epoch: 39, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.616 Vali Acc: 0.861 Test Loss: 0.616 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.981389045715332
Epoch: 40, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.624 Vali Acc: 0.872 Test Loss: 0.624 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.9376382827758789
Epoch: 41, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.617 Vali Acc: 0.861 Test Loss: 0.617 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 130447
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0592637062072754
Epoch: 1, Steps: 12 | Train Loss: 2.784 Vali Loss: 2.760 Vali Acc: 0.061 Test Loss: 2.760 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 0.8966758251190186
Epoch: 2, Steps: 12 | Train Loss: 2.658 Vali Loss: 2.695 Vali Acc: 0.094 Test Loss: 2.695 Test Acc: 0.094
Validation loss decreased (-0.061084 --> -0.094417).  Saving model ...
Epoch: 3 cost time: 0.9321260452270508
Epoch: 3, Steps: 12 | Train Loss: 2.572 Vali Loss: 2.577 Vali Acc: 0.194 Test Loss: 2.577 Test Acc: 0.194
Validation loss decreased (-0.094417 --> -0.194419).  Saving model ...
Epoch: 4 cost time: 0.8594977855682373
Epoch: 4, Steps: 12 | Train Loss: 2.439 Vali Loss: 2.425 Vali Acc: 0.311 Test Loss: 2.425 Test Acc: 0.311
Validation loss decreased (-0.194419 --> -0.311087).  Saving model ...
Epoch: 5 cost time: 0.896181583404541
Epoch: 5, Steps: 12 | Train Loss: 2.250 Vali Loss: 2.250 Vali Acc: 0.456 Test Loss: 2.250 Test Acc: 0.456
Validation loss decreased (-0.311087 --> -0.455533).  Saving model ...
Epoch: 6 cost time: 0.8566696643829346
Epoch: 6, Steps: 12 | Train Loss: 2.009 Vali Loss: 2.069 Vali Acc: 0.539 Test Loss: 2.069 Test Acc: 0.539
Validation loss decreased (-0.455533 --> -0.538868).  Saving model ...
Epoch: 7 cost time: 0.8887050151824951
Epoch: 7, Steps: 12 | Train Loss: 1.847 Vali Loss: 1.868 Vali Acc: 0.572 Test Loss: 1.868 Test Acc: 0.572
Validation loss decreased (-0.538868 --> -0.572204).  Saving model ...
Epoch: 8 cost time: 0.8603549003601074
Epoch: 8, Steps: 12 | Train Loss: 1.572 Vali Loss: 1.678 Vali Acc: 0.600 Test Loss: 1.678 Test Acc: 0.600
Validation loss decreased (-0.572204 --> -0.599983).  Saving model ...
Epoch: 9 cost time: 0.917510986328125
Epoch: 9, Steps: 12 | Train Loss: 1.393 Vali Loss: 1.479 Vali Acc: 0.639 Test Loss: 1.479 Test Acc: 0.639
Validation loss decreased (-0.599983 --> -0.638874).  Saving model ...
Epoch: 10 cost time: 0.8975706100463867
Epoch: 10, Steps: 12 | Train Loss: 1.229 Vali Loss: 1.304 Vali Acc: 0.656 Test Loss: 1.304 Test Acc: 0.656
Validation loss decreased (-0.638874 --> -0.655543).  Saving model ...
Epoch: 11 cost time: 0.9154386520385742
Epoch: 11, Steps: 12 | Train Loss: 1.024 Vali Loss: 1.175 Vali Acc: 0.689 Test Loss: 1.175 Test Acc: 0.689
Validation loss decreased (-0.655543 --> -0.688877).  Saving model ...
Epoch: 12 cost time: 0.8701784610748291
Epoch: 12, Steps: 12 | Train Loss: 0.923 Vali Loss: 1.086 Vali Acc: 0.694 Test Loss: 1.086 Test Acc: 0.694
Validation loss decreased (-0.688877 --> -0.694434).  Saving model ...
Epoch: 13 cost time: 0.8932821750640869
Epoch: 13, Steps: 12 | Train Loss: 0.809 Vali Loss: 0.987 Vali Acc: 0.733 Test Loss: 0.987 Test Acc: 0.733
Validation loss decreased (-0.694434 --> -0.733323).  Saving model ...
Epoch: 14 cost time: 0.9171018600463867
Epoch: 14, Steps: 12 | Train Loss: 0.672 Vali Loss: 0.895 Vali Acc: 0.772 Test Loss: 0.895 Test Acc: 0.772
Validation loss decreased (-0.733323 --> -0.772213).  Saving model ...
Epoch: 15 cost time: 0.9149894714355469
Epoch: 15, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.827 Vali Acc: 0.767 Test Loss: 0.827 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8648579120635986
Epoch: 16, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.772 Vali Acc: 0.772 Test Loss: 0.772 Test Acc: 0.772
Validation loss decreased (-0.772213 --> -0.772215).  Saving model ...
Epoch: 17 cost time: 0.9027531147003174
Epoch: 17, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.724 Vali Acc: 0.789 Test Loss: 0.724 Test Acc: 0.789
Validation loss decreased (-0.772215 --> -0.788882).  Saving model ...
Epoch: 18 cost time: 0.9331037998199463
Epoch: 18, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.682 Vali Acc: 0.806 Test Loss: 0.682 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805549).  Saving model ...
Epoch: 19 cost time: 0.9298398494720459
Epoch: 19, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.644 Vali Acc: 0.806 Test Loss: 0.644 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805549).  Saving model ...
Epoch: 20 cost time: 0.9279935359954834
Epoch: 20, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.638 Vali Acc: 0.811 Test Loss: 0.638 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 21 cost time: 0.8913400173187256
Epoch: 21, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.606 Vali Acc: 0.817 Test Loss: 0.606 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
Epoch: 22 cost time: 0.9304864406585693
Epoch: 22, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.588 Vali Acc: 0.822 Test Loss: 0.588 Test Acc: 0.822
Validation loss decreased (-0.816661 --> -0.822216).  Saving model ...
Epoch: 23 cost time: 0.8680884838104248
Epoch: 23, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.577 Vali Acc: 0.822 Test Loss: 0.577 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 24 cost time: 0.8273260593414307
Epoch: 24, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.562 Vali Acc: 0.828 Test Loss: 0.562 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 25 cost time: 0.8627040386199951
Epoch: 25, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.536 Vali Acc: 0.833 Test Loss: 0.536 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833328).  Saving model ...
Epoch: 26 cost time: 0.8855631351470947
Epoch: 26, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.525 Vali Acc: 0.839 Test Loss: 0.525 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838884).  Saving model ...
Epoch: 27 cost time: 0.91021728515625
Epoch: 27, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.551 Vali Acc: 0.839 Test Loss: 0.551 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8560118675231934
Epoch: 28, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.534 Vali Acc: 0.839 Test Loss: 0.534 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8503978252410889
Epoch: 29, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.554 Vali Acc: 0.839 Test Loss: 0.554 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8621194362640381
Epoch: 30, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844439).  Saving model ...
Epoch: 31 cost time: 0.8793554306030273
Epoch: 31, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.526 Vali Acc: 0.844 Test Loss: 0.526 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8509917259216309
Epoch: 32, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.521 Vali Acc: 0.861 Test Loss: 0.521 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861106).  Saving model ...
Epoch: 33 cost time: 0.8313710689544678
Epoch: 33, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8912403583526611
Epoch: 34, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.521 Vali Acc: 0.856 Test Loss: 0.521 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9135582447052002
Epoch: 35, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.535 Vali Acc: 0.856 Test Loss: 0.535 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9298536777496338
Epoch: 36, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.532 Vali Acc: 0.861 Test Loss: 0.532 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8668558597564697
Epoch: 37, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.536 Vali Acc: 0.867 Test Loss: 0.536 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 38 cost time: 0.906625509262085
Epoch: 38, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.554 Vali Acc: 0.861 Test Loss: 0.554 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9274089336395264
Epoch: 39, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.549 Vali Acc: 0.861 Test Loss: 0.549 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8991248607635498
Epoch: 40, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.541 Vali Acc: 0.872 Test Loss: 0.541 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 41 cost time: 0.8945558071136475
Epoch: 41, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9459209442138672
Epoch: 42, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.956841230392456
Epoch: 43, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.581 Vali Acc: 0.856 Test Loss: 0.581 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9398837089538574
Epoch: 44, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.570 Vali Acc: 0.861 Test Loss: 0.570 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8483560085296631
Epoch: 45, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.568 Vali Acc: 0.861 Test Loss: 0.568 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9545924663543701
Epoch: 46, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.590 Vali Acc: 0.872 Test Loss: 0.590 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.8900489807128906
Epoch: 47, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.588 Vali Acc: 0.861 Test Loss: 0.588 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.8869543075561523
Epoch: 48, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.575 Vali Acc: 0.844 Test Loss: 0.575 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.8843317031860352
Epoch: 49, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.577 Vali Acc: 0.856 Test Loss: 0.577 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.8879804611206055
Epoch: 50, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.582 Vali Acc: 0.872 Test Loss: 0.582 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 126799
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.202286958694458
Epoch: 1, Steps: 12 | Train Loss: 2.756 Vali Loss: 2.717 Vali Acc: 0.094 Test Loss: 2.717 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 0.8153455257415771
Epoch: 2, Steps: 12 | Train Loss: 2.612 Vali Loss: 2.605 Vali Acc: 0.178 Test Loss: 2.605 Test Acc: 0.178
Validation loss decreased (-0.094417 --> -0.177752).  Saving model ...
Epoch: 3 cost time: 0.7906532287597656
Epoch: 3, Steps: 12 | Train Loss: 2.450 Vali Loss: 2.426 Vali Acc: 0.422 Test Loss: 2.426 Test Acc: 0.422
Validation loss decreased (-0.177752 --> -0.422198).  Saving model ...
Epoch: 4 cost time: 0.7899785041809082
Epoch: 4, Steps: 12 | Train Loss: 2.243 Vali Loss: 2.186 Vali Acc: 0.494 Test Loss: 2.186 Test Acc: 0.494
Validation loss decreased (-0.422198 --> -0.494423).  Saving model ...
Epoch: 5 cost time: 0.782289981842041
Epoch: 5, Steps: 12 | Train Loss: 1.962 Vali Loss: 1.923 Vali Acc: 0.589 Test Loss: 1.923 Test Acc: 0.589
Validation loss decreased (-0.494423 --> -0.588870).  Saving model ...
Epoch: 6 cost time: 0.7794477939605713
Epoch: 6, Steps: 12 | Train Loss: 1.617 Vali Loss: 1.636 Vali Acc: 0.633 Test Loss: 1.636 Test Acc: 0.633
Validation loss decreased (-0.588870 --> -0.633317).  Saving model ...
Epoch: 7 cost time: 0.8017590045928955
Epoch: 7, Steps: 12 | Train Loss: 1.389 Vali Loss: 1.426 Vali Acc: 0.606 Test Loss: 1.426 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7597324848175049
Epoch: 8, Steps: 12 | Train Loss: 1.170 Vali Loss: 1.254 Vali Acc: 0.644 Test Loss: 1.254 Test Acc: 0.644
Validation loss decreased (-0.633317 --> -0.644432).  Saving model ...
Epoch: 9 cost time: 0.761821985244751
Epoch: 9, Steps: 12 | Train Loss: 0.968 Vali Loss: 1.132 Vali Acc: 0.650 Test Loss: 1.132 Test Acc: 0.650
Validation loss decreased (-0.644432 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 0.8168501853942871
Epoch: 10, Steps: 12 | Train Loss: 0.797 Vali Loss: 1.055 Vali Acc: 0.683 Test Loss: 1.055 Test Acc: 0.683
Validation loss decreased (-0.649989 --> -0.683323).  Saving model ...
Epoch: 11 cost time: 0.7792642116546631
Epoch: 11, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.985 Vali Acc: 0.694 Test Loss: 0.985 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694435).  Saving model ...
Epoch: 12 cost time: 0.7920174598693848
Epoch: 12, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.938 Vali Acc: 0.689 Test Loss: 0.938 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.725430965423584
Epoch: 13, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.924 Vali Acc: 0.700 Test Loss: 0.924 Test Acc: 0.700
Validation loss decreased (-0.694435 --> -0.699991).  Saving model ...
Epoch: 14 cost time: 0.780127763748169
Epoch: 14, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.872 Vali Acc: 0.717 Test Loss: 0.872 Test Acc: 0.717
Validation loss decreased (-0.699991 --> -0.716658).  Saving model ...
Epoch: 15 cost time: 0.8759589195251465
Epoch: 15, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.810 Vali Acc: 0.767 Test Loss: 0.810 Test Acc: 0.767
Validation loss decreased (-0.716658 --> -0.766659).  Saving model ...
Epoch: 16 cost time: 0.7973084449768066
Epoch: 16, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.822 Vali Acc: 0.739 Test Loss: 0.822 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.763115406036377
Epoch: 17, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.802 Vali Acc: 0.767 Test Loss: 0.802 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 18 cost time: 0.7432398796081543
Epoch: 18, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.809 Vali Acc: 0.767 Test Loss: 0.809 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7095987796783447
Epoch: 19, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.800 Vali Acc: 0.794 Test Loss: 0.800 Test Acc: 0.794
Validation loss decreased (-0.766659 --> -0.794436).  Saving model ...
Epoch: 20 cost time: 0.7510735988616943
Epoch: 20, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.789 Vali Acc: 0.767 Test Loss: 0.789 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7282524108886719
Epoch: 21, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.800 Vali Acc: 0.761 Test Loss: 0.800 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7379093170166016
Epoch: 22, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.785 Vali Acc: 0.817 Test Loss: 0.785 Test Acc: 0.817
Validation loss decreased (-0.794436 --> -0.816659).  Saving model ...
Epoch: 23 cost time: 0.7623655796051025
Epoch: 23, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.809 Vali Acc: 0.800 Test Loss: 0.809 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7769169807434082
Epoch: 24, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.838 Vali Acc: 0.789 Test Loss: 0.838 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7803940773010254
Epoch: 25, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.815 Vali Acc: 0.800 Test Loss: 0.815 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.777275562286377
Epoch: 26, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.797 Vali Acc: 0.800 Test Loss: 0.797 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7861354351043701
Epoch: 27, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.833 Vali Acc: 0.822 Test Loss: 0.833 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822214).  Saving model ...
Epoch: 28 cost time: 0.7992165088653564
Epoch: 28, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.800 Vali Acc: 0.833 Test Loss: 0.800 Test Acc: 0.833
Validation loss decreased (-0.822214 --> -0.833325).  Saving model ...
Epoch: 29 cost time: 0.799522876739502
Epoch: 29, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.788 Vali Acc: 0.817 Test Loss: 0.788 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8347628116607666
Epoch: 30, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.829 Vali Acc: 0.811 Test Loss: 0.829 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7606501579284668
Epoch: 31, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.843 Vali Acc: 0.822 Test Loss: 0.843 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7949352264404297
Epoch: 32, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.878 Vali Acc: 0.828 Test Loss: 0.878 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7644927501678467
Epoch: 33, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.886 Vali Acc: 0.817 Test Loss: 0.886 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7345490455627441
Epoch: 34, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.903 Vali Acc: 0.833 Test Loss: 0.903 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7828664779663086
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.812 Vali Acc: 0.844 Test Loss: 0.812 Test Acc: 0.844
Validation loss decreased (-0.833325 --> -0.844436).  Saving model ...
Epoch: 36 cost time: 0.8143563270568848
Epoch: 36, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.839 Vali Acc: 0.828 Test Loss: 0.839 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7645516395568848
Epoch: 37, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.864 Vali Acc: 0.839 Test Loss: 0.864 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7810893058776855
Epoch: 38, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.898 Vali Acc: 0.839 Test Loss: 0.898 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7726612091064453
Epoch: 39, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.954 Vali Acc: 0.833 Test Loss: 0.954 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7826073169708252
Epoch: 40, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.890 Vali Acc: 0.833 Test Loss: 0.890 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8065428733825684
Epoch: 41, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.963 Vali Acc: 0.828 Test Loss: 0.963 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7487990856170654
Epoch: 42, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.944 Vali Acc: 0.839 Test Loss: 0.944 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7659265995025635
Epoch: 43, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.957 Vali Acc: 0.822 Test Loss: 0.957 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.7669470310211182
Epoch: 44, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.048 Vali Acc: 0.828 Test Loss: 1.048 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.7837626934051514
Epoch: 45, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.037 Vali Acc: 0.794 Test Loss: 1.037 Test Acc: 0.794
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 74991
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.019336700439453
Epoch: 1, Steps: 12 | Train Loss: 2.700 Vali Loss: 2.714 Vali Acc: 0.083 Test Loss: 2.714 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 0.7645807266235352
Epoch: 2, Steps: 12 | Train Loss: 2.619 Vali Loss: 2.652 Vali Acc: 0.156 Test Loss: 2.652 Test Acc: 0.156
Validation loss decreased (-0.083306 --> -0.155529).  Saving model ...
Epoch: 3 cost time: 0.7949028015136719
Epoch: 3, Steps: 12 | Train Loss: 2.506 Vali Loss: 2.552 Vali Acc: 0.272 Test Loss: 2.552 Test Acc: 0.272
Validation loss decreased (-0.155529 --> -0.272197).  Saving model ...
Epoch: 4 cost time: 0.7542469501495361
Epoch: 4, Steps: 12 | Train Loss: 2.383 Vali Loss: 2.415 Vali Acc: 0.417 Test Loss: 2.415 Test Acc: 0.417
Validation loss decreased (-0.272197 --> -0.416643).  Saving model ...
Epoch: 5 cost time: 0.7610630989074707
Epoch: 5, Steps: 12 | Train Loss: 2.201 Vali Loss: 2.237 Vali Acc: 0.494 Test Loss: 2.237 Test Acc: 0.494
Validation loss decreased (-0.416643 --> -0.494422).  Saving model ...
Epoch: 6 cost time: 0.8223931789398193
Epoch: 6, Steps: 12 | Train Loss: 1.996 Vali Loss: 2.047 Vali Acc: 0.550 Test Loss: 2.047 Test Acc: 0.550
Validation loss decreased (-0.494422 --> -0.549980).  Saving model ...
Epoch: 7 cost time: 0.7742540836334229
Epoch: 7, Steps: 12 | Train Loss: 1.812 Vali Loss: 1.839 Vali Acc: 0.544 Test Loss: 1.839 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7948634624481201
Epoch: 8, Steps: 12 | Train Loss: 1.570 Vali Loss: 1.665 Vali Acc: 0.594 Test Loss: 1.665 Test Acc: 0.594
Validation loss decreased (-0.549980 --> -0.594428).  Saving model ...
Epoch: 9 cost time: 0.7765119075775146
Epoch: 9, Steps: 12 | Train Loss: 1.411 Vali Loss: 1.511 Vali Acc: 0.633 Test Loss: 1.511 Test Acc: 0.633
Validation loss decreased (-0.594428 --> -0.633318).  Saving model ...
Epoch: 10 cost time: 0.794144868850708
Epoch: 10, Steps: 12 | Train Loss: 1.157 Vali Loss: 1.360 Vali Acc: 0.650 Test Loss: 1.360 Test Acc: 0.650
Validation loss decreased (-0.633318 --> -0.649986).  Saving model ...
Epoch: 11 cost time: 0.8023686408996582
Epoch: 11, Steps: 12 | Train Loss: 1.019 Vali Loss: 1.258 Vali Acc: 0.661 Test Loss: 1.258 Test Acc: 0.661
Validation loss decreased (-0.649986 --> -0.661099).  Saving model ...
Epoch: 12 cost time: 0.7788119316101074
Epoch: 12, Steps: 12 | Train Loss: 0.896 Vali Loss: 1.158 Vali Acc: 0.672 Test Loss: 1.158 Test Acc: 0.672
Validation loss decreased (-0.661099 --> -0.672211).  Saving model ...
Epoch: 13 cost time: 0.7501006126403809
Epoch: 13, Steps: 12 | Train Loss: 0.828 Vali Loss: 1.073 Vali Acc: 0.661 Test Loss: 1.073 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7993366718292236
Epoch: 14, Steps: 12 | Train Loss: 0.703 Vali Loss: 1.004 Vali Acc: 0.672 Test Loss: 1.004 Test Acc: 0.672
Validation loss decreased (-0.672211 --> -0.672212).  Saving model ...
Epoch: 15 cost time: 0.7658190727233887
Epoch: 15, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.956 Vali Acc: 0.683 Test Loss: 0.956 Test Acc: 0.683
Validation loss decreased (-0.672212 --> -0.683324).  Saving model ...
Epoch: 16 cost time: 0.7574286460876465
Epoch: 16, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.929 Vali Acc: 0.706 Test Loss: 0.929 Test Acc: 0.706
Validation loss decreased (-0.683324 --> -0.705546).  Saving model ...
Epoch: 17 cost time: 0.7688884735107422
Epoch: 17, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.858 Vali Acc: 0.717 Test Loss: 0.858 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716658).  Saving model ...
Epoch: 18 cost time: 0.754220724105835
Epoch: 18, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.817 Vali Acc: 0.739 Test Loss: 0.817 Test Acc: 0.739
Validation loss decreased (-0.716658 --> -0.738881).  Saving model ...
Epoch: 19 cost time: 0.7539541721343994
Epoch: 19, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.821 Vali Acc: 0.733 Test Loss: 0.821 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7278296947479248
Epoch: 20, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.787 Vali Acc: 0.744 Test Loss: 0.787 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744437).  Saving model ...
Epoch: 21 cost time: 0.7714781761169434
Epoch: 21, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.748 Vali Acc: 0.783 Test Loss: 0.748 Test Acc: 0.783
Validation loss decreased (-0.744437 --> -0.783326).  Saving model ...
Epoch: 22 cost time: 0.7346620559692383
Epoch: 22, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.731 Vali Acc: 0.778 Test Loss: 0.731 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7916820049285889
Epoch: 23, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.699 Vali Acc: 0.811 Test Loss: 0.699 Test Acc: 0.811
Validation loss decreased (-0.783326 --> -0.811104).  Saving model ...
Epoch: 24 cost time: 0.742499589920044
Epoch: 24, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.714 Vali Acc: 0.806 Test Loss: 0.714 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7354607582092285
Epoch: 25, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.693 Vali Acc: 0.828 Test Loss: 0.693 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 26 cost time: 0.764533281326294
Epoch: 26, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.644 Vali Acc: 0.844 Test Loss: 0.644 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 27 cost time: 0.7795901298522949
Epoch: 27, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.650 Vali Acc: 0.806 Test Loss: 0.650 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7944436073303223
Epoch: 28, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.650 Vali Acc: 0.806 Test Loss: 0.650 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8272995948791504
Epoch: 29, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.627 Vali Acc: 0.844 Test Loss: 0.627 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 30 cost time: 0.737065315246582
Epoch: 30, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.604 Vali Acc: 0.822 Test Loss: 0.604 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7412559986114502
Epoch: 31, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.617 Vali Acc: 0.822 Test Loss: 0.617 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7460851669311523
Epoch: 32, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.591 Vali Acc: 0.850 Test Loss: 0.591 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 33 cost time: 0.6813864707946777
Epoch: 33, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.613 Vali Acc: 0.833 Test Loss: 0.613 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7694294452667236
Epoch: 34, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.621 Vali Acc: 0.844 Test Loss: 0.621 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7638518810272217
Epoch: 35, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.633 Vali Acc: 0.844 Test Loss: 0.633 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7274758815765381
Epoch: 36, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.620 Vali Acc: 0.850 Test Loss: 0.620 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.707097053527832
Epoch: 37, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.626 Vali Acc: 0.867 Test Loss: 0.626 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866660).  Saving model ...
Epoch: 38 cost time: 0.7700684070587158
Epoch: 38, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.611 Vali Acc: 0.872 Test Loss: 0.611 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872216).  Saving model ...
Epoch: 39 cost time: 0.7418015003204346
Epoch: 39, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.593 Vali Acc: 0.872 Test Loss: 0.593 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 40 cost time: 0.8392572402954102
Epoch: 40, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.609 Vali Acc: 0.872 Test Loss: 0.609 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8260047435760498
Epoch: 41, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.623 Vali Acc: 0.878 Test Loss: 0.623 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 42 cost time: 0.7647407054901123
Epoch: 42, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.642 Vali Acc: 0.861 Test Loss: 0.642 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7473349571228027
Epoch: 43, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.643 Vali Acc: 0.861 Test Loss: 0.643 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8137209415435791
Epoch: 44, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.641 Vali Acc: 0.867 Test Loss: 0.641 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7788863182067871
Epoch: 45, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.651 Vali Acc: 0.856 Test Loss: 0.651 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8079872131347656
Epoch: 46, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.656 Vali Acc: 0.861 Test Loss: 0.656 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.7065472602844238
Epoch: 47, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.663 Vali Acc: 0.878 Test Loss: 0.663 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.759321928024292
Epoch: 48, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.670 Vali Acc: 0.878 Test Loss: 0.670 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.7079832553863525
Epoch: 49, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.675 Vali Acc: 0.883 Test Loss: 0.675 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 50 cost time: 0.7017061710357666
Epoch: 50, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.697 Vali Acc: 0.878 Test Loss: 0.697 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 51983
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9767823219299316
Epoch: 1, Steps: 12 | Train Loss: 2.751 Vali Loss: 2.731 Vali Acc: 0.067 Test Loss: 2.731 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 0.7606496810913086
Epoch: 2, Steps: 12 | Train Loss: 2.689 Vali Loss: 2.662 Vali Acc: 0.067 Test Loss: 2.662 Test Acc: 0.067
Validation loss decreased (-0.066639 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 0.7701497077941895
Epoch: 3, Steps: 12 | Train Loss: 2.571 Vali Loss: 2.544 Vali Acc: 0.200 Test Loss: 2.544 Test Acc: 0.200
Validation loss decreased (-0.066640 --> -0.199975).  Saving model ...
Epoch: 4 cost time: 0.781724214553833
Epoch: 4, Steps: 12 | Train Loss: 2.411 Vali Loss: 2.391 Vali Acc: 0.389 Test Loss: 2.391 Test Acc: 0.389
Validation loss decreased (-0.199975 --> -0.388865).  Saving model ...
Epoch: 5 cost time: 0.7704837322235107
Epoch: 5, Steps: 12 | Train Loss: 2.264 Vali Loss: 2.211 Vali Acc: 0.522 Test Loss: 2.211 Test Acc: 0.522
Validation loss decreased (-0.388865 --> -0.522200).  Saving model ...
Epoch: 6 cost time: 0.8422105312347412
Epoch: 6, Steps: 12 | Train Loss: 1.991 Vali Loss: 2.007 Vali Acc: 0.572 Test Loss: 2.007 Test Acc: 0.572
Validation loss decreased (-0.522200 --> -0.572202).  Saving model ...
Epoch: 7 cost time: 0.8651630878448486
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.803 Vali Acc: 0.583 Test Loss: 1.803 Test Acc: 0.583
Validation loss decreased (-0.572202 --> -0.583315).  Saving model ...
Epoch: 8 cost time: 0.7608184814453125
Epoch: 8, Steps: 12 | Train Loss: 1.524 Vali Loss: 1.611 Vali Acc: 0.611 Test Loss: 1.611 Test Acc: 0.611
Validation loss decreased (-0.583315 --> -0.611095).  Saving model ...
Epoch: 9 cost time: 0.7633950710296631
Epoch: 9, Steps: 12 | Train Loss: 1.345 Vali Loss: 1.433 Vali Acc: 0.633 Test Loss: 1.433 Test Acc: 0.633
Validation loss decreased (-0.611095 --> -0.633319).  Saving model ...
Epoch: 10 cost time: 0.7796545028686523
Epoch: 10, Steps: 12 | Train Loss: 1.154 Vali Loss: 1.289 Vali Acc: 0.650 Test Loss: 1.289 Test Acc: 0.650
Validation loss decreased (-0.633319 --> -0.649987).  Saving model ...
Epoch: 11 cost time: 0.7936570644378662
Epoch: 11, Steps: 12 | Train Loss: 1.003 Vali Loss: 1.191 Vali Acc: 0.667 Test Loss: 1.191 Test Acc: 0.667
Validation loss decreased (-0.649987 --> -0.666655).  Saving model ...
Epoch: 12 cost time: 0.7791855335235596
Epoch: 12, Steps: 12 | Train Loss: 0.864 Vali Loss: 1.121 Vali Acc: 0.667 Test Loss: 1.121 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 13 cost time: 0.7447865009307861
Epoch: 13, Steps: 12 | Train Loss: 0.732 Vali Loss: 1.029 Vali Acc: 0.683 Test Loss: 1.029 Test Acc: 0.683
Validation loss decreased (-0.666655 --> -0.683323).  Saving model ...
Epoch: 14 cost time: 0.7603342533111572
Epoch: 14, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.971 Vali Acc: 0.683 Test Loss: 0.971 Test Acc: 0.683
Validation loss decreased (-0.683323 --> -0.683324).  Saving model ...
Epoch: 15 cost time: 0.7825191020965576
Epoch: 15, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.937 Vali Acc: 0.689 Test Loss: 0.937 Test Acc: 0.689
Validation loss decreased (-0.683324 --> -0.688880).  Saving model ...
Epoch: 16 cost time: 0.7922382354736328
Epoch: 16, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.895 Vali Acc: 0.711 Test Loss: 0.895 Test Acc: 0.711
Validation loss decreased (-0.688880 --> -0.711102).  Saving model ...
Epoch: 17 cost time: 0.7920660972595215
Epoch: 17, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.855 Vali Acc: 0.706 Test Loss: 0.855 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7515256404876709
Epoch: 18, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.822 Vali Acc: 0.750 Test Loss: 0.822 Test Acc: 0.750
Validation loss decreased (-0.711102 --> -0.749992).  Saving model ...
Epoch: 19 cost time: 0.7775208950042725
Epoch: 19, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.782 Vali Acc: 0.767 Test Loss: 0.782 Test Acc: 0.767
Validation loss decreased (-0.749992 --> -0.766659).  Saving model ...
Epoch: 20 cost time: 0.7653086185455322
Epoch: 20, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.802 Vali Acc: 0.750 Test Loss: 0.802 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7210586071014404
Epoch: 21, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.763 Vali Acc: 0.778 Test Loss: 0.763 Test Acc: 0.778
Validation loss decreased (-0.766659 --> -0.777770).  Saving model ...
Epoch: 22 cost time: 0.7413229942321777
Epoch: 22, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.719 Vali Acc: 0.789 Test Loss: 0.719 Test Acc: 0.789
Validation loss decreased (-0.777770 --> -0.788882).  Saving model ...
Epoch: 23 cost time: 0.7965710163116455
Epoch: 23, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.709 Vali Acc: 0.783 Test Loss: 0.709 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7897205352783203
Epoch: 24, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.697 Vali Acc: 0.778 Test Loss: 0.697 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7888755798339844
Epoch: 25, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.680 Vali Acc: 0.817 Test Loss: 0.680 Test Acc: 0.817
Validation loss decreased (-0.788882 --> -0.816660).  Saving model ...
Epoch: 26 cost time: 0.7773926258087158
Epoch: 26, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.663 Vali Acc: 0.822 Test Loss: 0.663 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 27 cost time: 0.7523419857025146
Epoch: 27, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.679 Vali Acc: 0.806 Test Loss: 0.679 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7486739158630371
Epoch: 28, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.646 Vali Acc: 0.839 Test Loss: 0.646 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838882).  Saving model ...
Epoch: 29 cost time: 0.7653141021728516
Epoch: 29, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.669 Vali Acc: 0.833 Test Loss: 0.669 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7464745044708252
Epoch: 30, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.668 Vali Acc: 0.844 Test Loss: 0.668 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 31 cost time: 0.7802884578704834
Epoch: 31, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.650 Vali Acc: 0.817 Test Loss: 0.650 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7696740627288818
Epoch: 32, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.630 Vali Acc: 0.839 Test Loss: 0.630 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7356724739074707
Epoch: 33, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.647 Vali Acc: 0.822 Test Loss: 0.647 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7725818157196045
Epoch: 34, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.648 Vali Acc: 0.850 Test Loss: 0.648 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 35 cost time: 0.7782740592956543
Epoch: 35, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.627 Vali Acc: 0.839 Test Loss: 0.627 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7830069065093994
Epoch: 36, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.627 Vali Acc: 0.844 Test Loss: 0.627 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7086999416351318
Epoch: 37, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.646 Vali Acc: 0.828 Test Loss: 0.646 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7736060619354248
Epoch: 38, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.664 Vali Acc: 0.839 Test Loss: 0.664 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7671585083007812
Epoch: 39, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.662 Vali Acc: 0.850 Test Loss: 0.662 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7549304962158203
Epoch: 40, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.674 Vali Acc: 0.839 Test Loss: 0.674 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7710480690002441
Epoch: 41, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.669 Vali Acc: 0.839 Test Loss: 0.669 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8199012279510498
Epoch: 42, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.690 Vali Acc: 0.844 Test Loss: 0.690 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7490789890289307
Epoch: 43, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.717 Vali Acc: 0.839 Test Loss: 0.717 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.755333662033081
Epoch: 44, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.703 Vali Acc: 0.850 Test Loss: 0.703 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.85
model parameter : 52015
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8744559288024902
Epoch: 1, Steps: 12 | Train Loss: 2.750 Vali Loss: 2.710 Vali Acc: 0.100 Test Loss: 2.710 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 0.771125078201294
Epoch: 2, Steps: 12 | Train Loss: 2.690 Vali Loss: 2.651 Vali Acc: 0.128 Test Loss: 2.651 Test Acc: 0.128
Validation loss decreased (-0.099973 --> -0.127751).  Saving model ...
Epoch: 3 cost time: 0.7888612747192383
Epoch: 3, Steps: 12 | Train Loss: 2.614 Vali Loss: 2.566 Vali Acc: 0.256 Test Loss: 2.566 Test Acc: 0.256
Validation loss decreased (-0.127751 --> -0.255530).  Saving model ...
Epoch: 4 cost time: 0.7711637020111084
Epoch: 4, Steps: 12 | Train Loss: 2.504 Vali Loss: 2.461 Vali Acc: 0.439 Test Loss: 2.461 Test Acc: 0.439
Validation loss decreased (-0.255530 --> -0.438864).  Saving model ...
Epoch: 5 cost time: 0.8270723819732666
Epoch: 5, Steps: 12 | Train Loss: 2.394 Vali Loss: 2.325 Vali Acc: 0.528 Test Loss: 2.325 Test Acc: 0.528
Validation loss decreased (-0.438864 --> -0.527755).  Saving model ...
Epoch: 6 cost time: 0.8348400592803955
Epoch: 6, Steps: 12 | Train Loss: 2.254 Vali Loss: 2.174 Vali Acc: 0.583 Test Loss: 2.174 Test Acc: 0.583
Validation loss decreased (-0.527755 --> -0.583312).  Saving model ...
Epoch: 7 cost time: 0.8054883480072021
Epoch: 7, Steps: 12 | Train Loss: 2.041 Vali Loss: 2.004 Vali Acc: 0.578 Test Loss: 2.004 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.774376630783081
Epoch: 8, Steps: 12 | Train Loss: 1.838 Vali Loss: 1.828 Vali Acc: 0.617 Test Loss: 1.828 Test Acc: 0.617
Validation loss decreased (-0.583312 --> -0.616648).  Saving model ...
Epoch: 9 cost time: 0.793952465057373
Epoch: 9, Steps: 12 | Train Loss: 1.618 Vali Loss: 1.655 Vali Acc: 0.628 Test Loss: 1.655 Test Acc: 0.628
Validation loss decreased (-0.616648 --> -0.627761).  Saving model ...
Epoch: 10 cost time: 0.7749929428100586
Epoch: 10, Steps: 12 | Train Loss: 1.493 Vali Loss: 1.489 Vali Acc: 0.650 Test Loss: 1.489 Test Acc: 0.650
Validation loss decreased (-0.627761 --> -0.649985).  Saving model ...
Epoch: 11 cost time: 0.7966761589050293
Epoch: 11, Steps: 12 | Train Loss: 1.273 Vali Loss: 1.342 Vali Acc: 0.639 Test Loss: 1.342 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7685501575469971
Epoch: 12, Steps: 12 | Train Loss: 1.074 Vali Loss: 1.235 Vali Acc: 0.683 Test Loss: 1.235 Test Acc: 0.683
Validation loss decreased (-0.649985 --> -0.683321).  Saving model ...
Epoch: 13 cost time: 0.7891852855682373
Epoch: 13, Steps: 12 | Train Loss: 0.974 Vali Loss: 1.141 Vali Acc: 0.667 Test Loss: 1.141 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7705576419830322
Epoch: 14, Steps: 12 | Train Loss: 0.859 Vali Loss: 1.069 Vali Acc: 0.700 Test Loss: 1.069 Test Acc: 0.700
Validation loss decreased (-0.683321 --> -0.699989).  Saving model ...
Epoch: 15 cost time: 0.7736537456512451
Epoch: 15, Steps: 12 | Train Loss: 0.785 Vali Loss: 0.999 Vali Acc: 0.733 Test Loss: 0.999 Test Acc: 0.733
Validation loss decreased (-0.699989 --> -0.733323).  Saving model ...
Epoch: 16 cost time: 0.7389414310455322
Epoch: 16, Steps: 12 | Train Loss: 0.707 Vali Loss: 0.954 Vali Acc: 0.739 Test Loss: 0.954 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738879).  Saving model ...
Epoch: 17 cost time: 0.7299530506134033
Epoch: 17, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.908 Vali Acc: 0.739 Test Loss: 0.908 Test Acc: 0.739
Validation loss decreased (-0.738879 --> -0.738880).  Saving model ...
Epoch: 18 cost time: 0.6729152202606201
Epoch: 18, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.878 Vali Acc: 0.722 Test Loss: 0.878 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8221323490142822
Epoch: 19, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.825 Vali Acc: 0.750 Test Loss: 0.825 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749992).  Saving model ...
Epoch: 20 cost time: 0.761185884475708
Epoch: 20, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.799 Vali Acc: 0.783 Test Loss: 0.799 Test Acc: 0.783
Validation loss decreased (-0.749992 --> -0.783325).  Saving model ...
Epoch: 21 cost time: 0.7999897003173828
Epoch: 21, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.753 Vali Acc: 0.789 Test Loss: 0.753 Test Acc: 0.789
Validation loss decreased (-0.783325 --> -0.788881).  Saving model ...
Epoch: 22 cost time: 0.7636916637420654
Epoch: 22, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.734 Vali Acc: 0.817 Test Loss: 0.734 Test Acc: 0.817
Validation loss decreased (-0.788881 --> -0.816659).  Saving model ...
Epoch: 23 cost time: 0.8012478351593018
Epoch: 23, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.709 Vali Acc: 0.817 Test Loss: 0.709 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816660).  Saving model ...
Epoch: 24 cost time: 0.7806730270385742
Epoch: 24, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.684 Vali Acc: 0.800 Test Loss: 0.684 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7821815013885498
Epoch: 25, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.657 Vali Acc: 0.817 Test Loss: 0.657 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 26 cost time: 0.785855770111084
Epoch: 26, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.665 Vali Acc: 0.822 Test Loss: 0.665 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 27 cost time: 0.7696454524993896
Epoch: 27, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.637 Vali Acc: 0.811 Test Loss: 0.637 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8101108074188232
Epoch: 28, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.635 Vali Acc: 0.850 Test Loss: 0.635 Test Acc: 0.850
Validation loss decreased (-0.822216 --> -0.849994).  Saving model ...
Epoch: 29 cost time: 0.8126828670501709
Epoch: 29, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.627 Vali Acc: 0.839 Test Loss: 0.627 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7895071506500244
Epoch: 30, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.603 Vali Acc: 0.833 Test Loss: 0.603 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8006601333618164
Epoch: 31, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.597 Vali Acc: 0.861 Test Loss: 0.597 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 32 cost time: 0.8119750022888184
Epoch: 32, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8380208015441895
Epoch: 33, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.601 Vali Acc: 0.856 Test Loss: 0.601 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7898437976837158
Epoch: 34, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.580 Vali Acc: 0.867 Test Loss: 0.580 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 35 cost time: 0.7937765121459961
Epoch: 35, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.582 Vali Acc: 0.867 Test Loss: 0.582 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7734897136688232
Epoch: 36, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.574 Vali Acc: 0.856 Test Loss: 0.574 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8239610195159912
Epoch: 37, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.578 Vali Acc: 0.867 Test Loss: 0.578 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 38 cost time: 0.8114430904388428
Epoch: 38, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.598 Vali Acc: 0.861 Test Loss: 0.598 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8102774620056152
Epoch: 39, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.607 Vali Acc: 0.867 Test Loss: 0.607 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.817594051361084
Epoch: 40, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.603 Vali Acc: 0.861 Test Loss: 0.603 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.803347110748291
Epoch: 41, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.601 Vali Acc: 0.878 Test Loss: 0.601 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 42 cost time: 0.8046927452087402
Epoch: 42, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.618 Vali Acc: 0.867 Test Loss: 0.618 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.861220121383667
Epoch: 43, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.629 Vali Acc: 0.872 Test Loss: 0.629 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.810267448425293
Epoch: 44, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.629 Vali Acc: 0.867 Test Loss: 0.629 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7993733882904053
Epoch: 45, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.623 Vali Acc: 0.872 Test Loss: 0.623 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8265199661254883
Epoch: 46, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.624 Vali Acc: 0.872 Test Loss: 0.624 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.8312678337097168
Epoch: 47, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.634 Vali Acc: 0.867 Test Loss: 0.634 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.8382010459899902
Epoch: 48, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.641 Vali Acc: 0.878 Test Loss: 0.641 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.7906937599182129
Epoch: 49, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.653 Vali Acc: 0.867 Test Loss: 0.653 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.8280344009399414
Epoch: 50, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.638 Vali Acc: 0.872 Test Loss: 0.638 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 46287
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0811753273010254
Epoch: 1, Steps: 12 | Train Loss: 2.672 Vali Loss: 2.666 Vali Acc: 0.111 Test Loss: 2.666 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 0.7621228694915771
Epoch: 2, Steps: 12 | Train Loss: 2.613 Vali Loss: 2.626 Vali Acc: 0.139 Test Loss: 2.626 Test Acc: 0.139
Validation loss decreased (-0.111084 --> -0.138863).  Saving model ...
Epoch: 3 cost time: 0.793999195098877
Epoch: 3, Steps: 12 | Train Loss: 2.564 Vali Loss: 2.563 Vali Acc: 0.211 Test Loss: 2.563 Test Acc: 0.211
Validation loss decreased (-0.138863 --> -0.211085).  Saving model ...
Epoch: 4 cost time: 0.8058688640594482
Epoch: 4, Steps: 12 | Train Loss: 2.469 Vali Loss: 2.465 Vali Acc: 0.322 Test Loss: 2.465 Test Acc: 0.322
Validation loss decreased (-0.211085 --> -0.322198).  Saving model ...
Epoch: 5 cost time: 0.8369641304016113
Epoch: 5, Steps: 12 | Train Loss: 2.346 Vali Loss: 2.365 Vali Acc: 0.411 Test Loss: 2.365 Test Acc: 0.411
Validation loss decreased (-0.322198 --> -0.411087).  Saving model ...
Epoch: 6 cost time: 0.793133020401001
Epoch: 6, Steps: 12 | Train Loss: 2.237 Vali Loss: 2.246 Vali Acc: 0.461 Test Loss: 2.246 Test Acc: 0.461
Validation loss decreased (-0.411087 --> -0.461089).  Saving model ...
Epoch: 7 cost time: 0.8021273612976074
Epoch: 7, Steps: 12 | Train Loss: 2.071 Vali Loss: 2.108 Vali Acc: 0.483 Test Loss: 2.108 Test Acc: 0.483
Validation loss decreased (-0.461089 --> -0.483312).  Saving model ...
Epoch: 8 cost time: 0.8103089332580566
Epoch: 8, Steps: 12 | Train Loss: 1.931 Vali Loss: 1.955 Vali Acc: 0.506 Test Loss: 1.955 Test Acc: 0.506
Validation loss decreased (-0.483312 --> -0.505536).  Saving model ...
Epoch: 9 cost time: 0.7482883930206299
Epoch: 9, Steps: 12 | Train Loss: 1.737 Vali Loss: 1.811 Vali Acc: 0.578 Test Loss: 1.811 Test Acc: 0.578
Validation loss decreased (-0.505536 --> -0.577760).  Saving model ...
Epoch: 10 cost time: 0.8356506824493408
Epoch: 10, Steps: 12 | Train Loss: 1.580 Vali Loss: 1.663 Vali Acc: 0.622 Test Loss: 1.663 Test Acc: 0.622
Validation loss decreased (-0.577760 --> -0.622206).  Saving model ...
Epoch: 11 cost time: 0.7774026393890381
Epoch: 11, Steps: 12 | Train Loss: 1.401 Vali Loss: 1.530 Vali Acc: 0.644 Test Loss: 1.530 Test Acc: 0.644
Validation loss decreased (-0.622206 --> -0.644429).  Saving model ...
Epoch: 12 cost time: 0.7779984474182129
Epoch: 12, Steps: 12 | Train Loss: 1.198 Vali Loss: 1.417 Vali Acc: 0.661 Test Loss: 1.417 Test Acc: 0.661
Validation loss decreased (-0.644429 --> -0.661097).  Saving model ...
Epoch: 13 cost time: 0.7680675983428955
Epoch: 13, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.305 Vali Acc: 0.678 Test Loss: 1.305 Test Acc: 0.678
Validation loss decreased (-0.661097 --> -0.677765).  Saving model ...
Epoch: 14 cost time: 0.8117330074310303
Epoch: 14, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.227 Vali Acc: 0.689 Test Loss: 1.227 Test Acc: 0.689
Validation loss decreased (-0.677765 --> -0.688877).  Saving model ...
Epoch: 15 cost time: 0.7895979881286621
Epoch: 15, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.143 Vali Acc: 0.672 Test Loss: 1.143 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.822695255279541
Epoch: 16, Steps: 12 | Train Loss: 0.813 Vali Loss: 1.077 Vali Acc: 0.678 Test Loss: 1.077 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7700772285461426
Epoch: 17, Steps: 12 | Train Loss: 0.772 Vali Loss: 1.008 Vali Acc: 0.694 Test Loss: 1.008 Test Acc: 0.694
Validation loss decreased (-0.688877 --> -0.694434).  Saving model ...
Epoch: 18 cost time: 0.8171195983886719
Epoch: 18, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.961 Vali Acc: 0.700 Test Loss: 0.961 Test Acc: 0.700
Validation loss decreased (-0.694434 --> -0.699990).  Saving model ...
Epoch: 19 cost time: 0.8167541027069092
Epoch: 19, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.926 Vali Acc: 0.706 Test Loss: 0.926 Test Acc: 0.706
Validation loss decreased (-0.699990 --> -0.705546).  Saving model ...
Epoch: 20 cost time: 0.6288471221923828
Epoch: 20, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.899 Vali Acc: 0.711 Test Loss: 0.899 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711102).  Saving model ...
Epoch: 21 cost time: 0.7776501178741455
Epoch: 21, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.844 Vali Acc: 0.728 Test Loss: 0.844 Test Acc: 0.728
Validation loss decreased (-0.711102 --> -0.727769).  Saving model ...
Epoch: 22 cost time: 0.8181278705596924
Epoch: 22, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.814 Vali Acc: 0.733 Test Loss: 0.814 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733325).  Saving model ...
Epoch: 23 cost time: 0.8129568099975586
Epoch: 23, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.795 Vali Acc: 0.761 Test Loss: 0.795 Test Acc: 0.761
Validation loss decreased (-0.733325 --> -0.761103).  Saving model ...
Epoch: 24 cost time: 0.7633252143859863
Epoch: 24, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.756 Vali Acc: 0.778 Test Loss: 0.756 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777770).  Saving model ...
Epoch: 25 cost time: 0.7815961837768555
Epoch: 25, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.734 Vali Acc: 0.783 Test Loss: 0.734 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783326).  Saving model ...
Epoch: 26 cost time: 0.8430874347686768
Epoch: 26, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.704 Vali Acc: 0.806 Test Loss: 0.704 Test Acc: 0.806
Validation loss decreased (-0.783326 --> -0.805549).  Saving model ...
Epoch: 27 cost time: 0.7742393016815186
Epoch: 27, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.683 Vali Acc: 0.811 Test Loss: 0.683 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811104).  Saving model ...
Epoch: 28 cost time: 0.7747981548309326
Epoch: 28, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.664 Vali Acc: 0.828 Test Loss: 0.664 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 29 cost time: 0.7460024356842041
Epoch: 29, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.646 Vali Acc: 0.839 Test Loss: 0.646 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 30 cost time: 0.7586197853088379
Epoch: 30, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.636 Vali Acc: 0.833 Test Loss: 0.636 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7450358867645264
Epoch: 31, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.619 Vali Acc: 0.839 Test Loss: 0.619 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 32 cost time: 0.7492995262145996
Epoch: 32, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.626 Vali Acc: 0.839 Test Loss: 0.626 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7809116840362549
Epoch: 33, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.610 Vali Acc: 0.839 Test Loss: 0.610 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 34 cost time: 0.7691092491149902
Epoch: 34, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.605 Vali Acc: 0.850 Test Loss: 0.605 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 35 cost time: 0.8079502582550049
Epoch: 35, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.595 Vali Acc: 0.872 Test Loss: 0.595 Test Acc: 0.872
Validation loss decreased (-0.849994 --> -0.872216).  Saving model ...
Epoch: 36 cost time: 0.7846612930297852
Epoch: 36, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.594 Vali Acc: 0.856 Test Loss: 0.594 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.823082685470581
Epoch: 37, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.593 Vali Acc: 0.861 Test Loss: 0.593 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7756402492523193
Epoch: 38, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.613 Vali Acc: 0.856 Test Loss: 0.613 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7295794486999512
Epoch: 39, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.600 Vali Acc: 0.872 Test Loss: 0.600 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.736966609954834
Epoch: 40, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.614 Vali Acc: 0.867 Test Loss: 0.614 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7909207344055176
Epoch: 41, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.606 Vali Acc: 0.872 Test Loss: 0.606 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7404942512512207
Epoch: 42, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.613 Vali Acc: 0.872 Test Loss: 0.613 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7759847640991211
Epoch: 43, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.602 Vali Acc: 0.861 Test Loss: 0.602 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.8327007293701172
Epoch: 44, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.597 Vali Acc: 0.861 Test Loss: 0.597 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.7726469039916992
Epoch: 45, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.612 Vali Acc: 0.872 Test Loss: 0.612 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 42511
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.030731678009033
Epoch: 1, Steps: 12 | Train Loss: 2.692 Vali Loss: 2.666 Vali Acc: 0.106 Test Loss: 2.666 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 0.8187899589538574
Epoch: 2, Steps: 12 | Train Loss: 2.654 Vali Loss: 2.621 Vali Acc: 0.178 Test Loss: 2.621 Test Acc: 0.178
Validation loss decreased (-0.105529 --> -0.177752).  Saving model ...
Epoch: 3 cost time: 0.7740428447723389
Epoch: 3, Steps: 12 | Train Loss: 2.615 Vali Loss: 2.559 Vali Acc: 0.250 Test Loss: 2.559 Test Acc: 0.250
Validation loss decreased (-0.177752 --> -0.249974).  Saving model ...
Epoch: 4 cost time: 0.7708814144134521
Epoch: 4, Steps: 12 | Train Loss: 2.529 Vali Loss: 2.485 Vali Acc: 0.356 Test Loss: 2.485 Test Acc: 0.356
Validation loss decreased (-0.249974 --> -0.355531).  Saving model ...
Epoch: 5 cost time: 0.7760848999023438
Epoch: 5, Steps: 12 | Train Loss: 2.420 Vali Loss: 2.396 Vali Acc: 0.428 Test Loss: 2.396 Test Acc: 0.428
Validation loss decreased (-0.355531 --> -0.427754).  Saving model ...
Epoch: 6 cost time: 0.7622251510620117
Epoch: 6, Steps: 12 | Train Loss: 2.312 Vali Loss: 2.298 Vali Acc: 0.461 Test Loss: 2.298 Test Acc: 0.461
Validation loss decreased (-0.427754 --> -0.461088).  Saving model ...
Epoch: 7 cost time: 0.7446646690368652
Epoch: 7, Steps: 12 | Train Loss: 2.186 Vali Loss: 2.185 Vali Acc: 0.500 Test Loss: 2.185 Test Acc: 0.500
Validation loss decreased (-0.461088 --> -0.499978).  Saving model ...
Epoch: 8 cost time: 0.7658638954162598
Epoch: 8, Steps: 12 | Train Loss: 2.041 Vali Loss: 2.049 Vali Acc: 0.528 Test Loss: 2.049 Test Acc: 0.528
Validation loss decreased (-0.499978 --> -0.527757).  Saving model ...
Epoch: 9 cost time: 0.7718911170959473
Epoch: 9, Steps: 12 | Train Loss: 1.883 Vali Loss: 1.911 Vali Acc: 0.544 Test Loss: 1.911 Test Acc: 0.544
Validation loss decreased (-0.527757 --> -0.544425).  Saving model ...
Epoch: 10 cost time: 0.7348372936248779
Epoch: 10, Steps: 12 | Train Loss: 1.710 Vali Loss: 1.766 Vali Acc: 0.550 Test Loss: 1.766 Test Acc: 0.550
Validation loss decreased (-0.544425 --> -0.549982).  Saving model ...
Epoch: 11 cost time: 0.7351906299591064
Epoch: 11, Steps: 12 | Train Loss: 1.571 Vali Loss: 1.651 Vali Acc: 0.583 Test Loss: 1.651 Test Acc: 0.583
Validation loss decreased (-0.549982 --> -0.583317).  Saving model ...
Epoch: 12 cost time: 0.7480432987213135
Epoch: 12, Steps: 12 | Train Loss: 1.399 Vali Loss: 1.512 Vali Acc: 0.617 Test Loss: 1.512 Test Acc: 0.617
Validation loss decreased (-0.583317 --> -0.616652).  Saving model ...
Epoch: 13 cost time: 0.745492696762085
Epoch: 13, Steps: 12 | Train Loss: 1.290 Vali Loss: 1.369 Vali Acc: 0.644 Test Loss: 1.369 Test Acc: 0.644
Validation loss decreased (-0.616652 --> -0.644431).  Saving model ...
Epoch: 14 cost time: 0.7320098876953125
Epoch: 14, Steps: 12 | Train Loss: 1.147 Vali Loss: 1.260 Vali Acc: 0.656 Test Loss: 1.260 Test Acc: 0.656
Validation loss decreased (-0.644431 --> -0.655543).  Saving model ...
Epoch: 15 cost time: 0.719459056854248
Epoch: 15, Steps: 12 | Train Loss: 1.006 Vali Loss: 1.150 Vali Acc: 0.672 Test Loss: 1.150 Test Acc: 0.672
Validation loss decreased (-0.655543 --> -0.672211).  Saving model ...
Epoch: 16 cost time: 0.7290008068084717
Epoch: 16, Steps: 12 | Train Loss: 0.918 Vali Loss: 1.080 Vali Acc: 0.672 Test Loss: 1.080 Test Acc: 0.672
Validation loss decreased (-0.672211 --> -0.672211).  Saving model ...
Epoch: 17 cost time: 0.7630314826965332
Epoch: 17, Steps: 12 | Train Loss: 0.836 Vali Loss: 1.019 Vali Acc: 0.683 Test Loss: 1.019 Test Acc: 0.683
Validation loss decreased (-0.672211 --> -0.683323).  Saving model ...
Epoch: 18 cost time: 0.7773985862731934
Epoch: 18, Steps: 12 | Train Loss: 0.727 Vali Loss: 0.970 Vali Acc: 0.711 Test Loss: 0.970 Test Acc: 0.711
Validation loss decreased (-0.683323 --> -0.711101).  Saving model ...
Epoch: 19 cost time: 0.7569894790649414
Epoch: 19, Steps: 12 | Train Loss: 0.727 Vali Loss: 0.903 Vali Acc: 0.711 Test Loss: 0.903 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711102).  Saving model ...
Epoch: 20 cost time: 0.7783937454223633
Epoch: 20, Steps: 12 | Train Loss: 0.601 Vali Loss: 0.865 Vali Acc: 0.733 Test Loss: 0.865 Test Acc: 0.733
Validation loss decreased (-0.711102 --> -0.733325).  Saving model ...
Epoch: 21 cost time: 0.7452731132507324
Epoch: 21, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.824 Vali Acc: 0.733 Test Loss: 0.824 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 22 cost time: 0.7894463539123535
Epoch: 22, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.789 Vali Acc: 0.767 Test Loss: 0.789 Test Acc: 0.767
Validation loss decreased (-0.733325 --> -0.766659).  Saving model ...
Epoch: 23 cost time: 0.7483031749725342
Epoch: 23, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.758 Vali Acc: 0.778 Test Loss: 0.758 Test Acc: 0.778
Validation loss decreased (-0.766659 --> -0.777770).  Saving model ...
Epoch: 24 cost time: 0.749286413192749
Epoch: 24, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.732 Vali Acc: 0.783 Test Loss: 0.732 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783326).  Saving model ...
Epoch: 25 cost time: 0.7475154399871826
Epoch: 25, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.713 Vali Acc: 0.778 Test Loss: 0.713 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7255935668945312
Epoch: 26, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.680 Vali Acc: 0.822 Test Loss: 0.680 Test Acc: 0.822
Validation loss decreased (-0.783326 --> -0.822215).  Saving model ...
Epoch: 27 cost time: 0.7460153102874756
Epoch: 27, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.651 Vali Acc: 0.822 Test Loss: 0.651 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822216).  Saving model ...
Epoch: 28 cost time: 0.7561769485473633
Epoch: 28, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.641 Vali Acc: 0.822 Test Loss: 0.641 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 29 cost time: 0.716322660446167
Epoch: 29, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.617 Vali Acc: 0.828 Test Loss: 0.617 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 30 cost time: 0.758521556854248
Epoch: 30, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.622 Vali Acc: 0.833 Test Loss: 0.622 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833327).  Saving model ...
Epoch: 31 cost time: 0.7565879821777344
Epoch: 31, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.619 Vali Acc: 0.817 Test Loss: 0.619 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.762601375579834
Epoch: 32, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.595 Vali Acc: 0.822 Test Loss: 0.595 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7691516876220703
Epoch: 33, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.579 Vali Acc: 0.844 Test Loss: 0.579 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844439).  Saving model ...
Epoch: 34 cost time: 0.7367815971374512
Epoch: 34, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.577 Vali Acc: 0.850 Test Loss: 0.577 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 35 cost time: 0.7528321743011475
Epoch: 35, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 36 cost time: 0.7639737129211426
Epoch: 36, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.553 Vali Acc: 0.856 Test Loss: 0.553 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 37 cost time: 0.7666747570037842
Epoch: 37, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.548 Vali Acc: 0.856 Test Loss: 0.548 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 38 cost time: 0.742755651473999
Epoch: 38, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.560 Vali Acc: 0.867 Test Loss: 0.560 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 39 cost time: 0.7820196151733398
Epoch: 39, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.553 Vali Acc: 0.844 Test Loss: 0.553 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7564778327941895
Epoch: 40, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.547 Vali Acc: 0.861 Test Loss: 0.547 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.820918083190918
Epoch: 41, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.546 Vali Acc: 0.867 Test Loss: 0.546 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 42 cost time: 0.7531936168670654
Epoch: 42, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7931709289550781
Epoch: 43, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.552 Vali Acc: 0.861 Test Loss: 0.552 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7380027770996094
Epoch: 44, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.560 Vali Acc: 0.861 Test Loss: 0.560 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7276618480682373
Epoch: 45, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.560 Vali Acc: 0.861 Test Loss: 0.560 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.7582113742828369
Epoch: 46, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.7350044250488281
Epoch: 47, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.744596004486084
Epoch: 48, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.568 Vali Acc: 0.844 Test Loss: 0.568 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.7528483867645264
Epoch: 49, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.575 Vali Acc: 0.867 Test Loss: 0.575 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.7806150913238525
Epoch: 50, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.572 Vali Acc: 0.861 Test Loss: 0.572 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 40655
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.047943115234375
Epoch: 1, Steps: 12 | Train Loss: 2.721 Vali Loss: 2.720 Vali Acc: 0.061 Test Loss: 2.720 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 0.786541223526001
Epoch: 2, Steps: 12 | Train Loss: 2.684 Vali Loss: 2.697 Vali Acc: 0.083 Test Loss: 2.697 Test Acc: 0.083
Validation loss decreased (-0.061084 --> -0.083306).  Saving model ...
Epoch: 3 cost time: 0.7932252883911133
Epoch: 3, Steps: 12 | Train Loss: 2.637 Vali Loss: 2.652 Vali Acc: 0.133 Test Loss: 2.652 Test Acc: 0.133
Validation loss decreased (-0.083306 --> -0.133307).  Saving model ...
Epoch: 4 cost time: 0.7658042907714844
Epoch: 4, Steps: 12 | Train Loss: 2.575 Vali Loss: 2.587 Vali Acc: 0.183 Test Loss: 2.587 Test Acc: 0.183
Validation loss decreased (-0.133307 --> -0.183307).  Saving model ...
Epoch: 5 cost time: 0.7495508193969727
Epoch: 5, Steps: 12 | Train Loss: 2.505 Vali Loss: 2.509 Vali Acc: 0.294 Test Loss: 2.509 Test Acc: 0.294
Validation loss decreased (-0.183307 --> -0.294419).  Saving model ...
Epoch: 6 cost time: 0.7531850337982178
Epoch: 6, Steps: 12 | Train Loss: 2.407 Vali Loss: 2.432 Vali Acc: 0.439 Test Loss: 2.432 Test Acc: 0.439
Validation loss decreased (-0.294419 --> -0.438865).  Saving model ...
Epoch: 7 cost time: 0.7701857089996338
Epoch: 7, Steps: 12 | Train Loss: 2.320 Vali Loss: 2.341 Vali Acc: 0.467 Test Loss: 2.341 Test Acc: 0.467
Validation loss decreased (-0.438865 --> -0.466643).  Saving model ...
Epoch: 8 cost time: 0.7509181499481201
Epoch: 8, Steps: 12 | Train Loss: 2.219 Vali Loss: 2.227 Vali Acc: 0.539 Test Loss: 2.227 Test Acc: 0.539
Validation loss decreased (-0.466643 --> -0.538867).  Saving model ...
Epoch: 9 cost time: 0.7647373676300049
Epoch: 9, Steps: 12 | Train Loss: 2.071 Vali Loss: 2.114 Vali Acc: 0.556 Test Loss: 2.114 Test Acc: 0.556
Validation loss decreased (-0.538867 --> -0.555534).  Saving model ...
Epoch: 10 cost time: 0.7621350288391113
Epoch: 10, Steps: 12 | Train Loss: 1.936 Vali Loss: 1.983 Vali Acc: 0.561 Test Loss: 1.983 Test Acc: 0.561
Validation loss decreased (-0.555534 --> -0.561091).  Saving model ...
Epoch: 11 cost time: 0.7473053932189941
Epoch: 11, Steps: 12 | Train Loss: 1.812 Vali Loss: 1.832 Vali Acc: 0.617 Test Loss: 1.832 Test Acc: 0.617
Validation loss decreased (-0.561091 --> -0.616648).  Saving model ...
Epoch: 12 cost time: 0.7759222984313965
Epoch: 12, Steps: 12 | Train Loss: 1.644 Vali Loss: 1.679 Vali Acc: 0.661 Test Loss: 1.679 Test Acc: 0.661
Validation loss decreased (-0.616648 --> -0.661094).  Saving model ...
Epoch: 13 cost time: 0.7702264785766602
Epoch: 13, Steps: 12 | Train Loss: 1.453 Vali Loss: 1.540 Vali Acc: 0.689 Test Loss: 1.540 Test Acc: 0.689
Validation loss decreased (-0.661094 --> -0.688873).  Saving model ...
Epoch: 14 cost time: 0.763932466506958
Epoch: 14, Steps: 12 | Train Loss: 1.348 Vali Loss: 1.416 Vali Acc: 0.683 Test Loss: 1.416 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7324473857879639
Epoch: 15, Steps: 12 | Train Loss: 1.190 Vali Loss: 1.304 Vali Acc: 0.711 Test Loss: 1.304 Test Acc: 0.711
Validation loss decreased (-0.688873 --> -0.711098).  Saving model ...
Epoch: 16 cost time: 0.7500917911529541
Epoch: 16, Steps: 12 | Train Loss: 1.035 Vali Loss: 1.202 Vali Acc: 0.717 Test Loss: 1.202 Test Acc: 0.717
Validation loss decreased (-0.711098 --> -0.716655).  Saving model ...
Epoch: 17 cost time: 0.7462584972381592
Epoch: 17, Steps: 12 | Train Loss: 1.013 Vali Loss: 1.102 Vali Acc: 0.728 Test Loss: 1.102 Test Acc: 0.728
Validation loss decreased (-0.716655 --> -0.727767).  Saving model ...
Epoch: 18 cost time: 0.7966043949127197
Epoch: 18, Steps: 12 | Train Loss: 0.868 Vali Loss: 1.029 Vali Acc: 0.706 Test Loss: 1.029 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7982392311096191
Epoch: 19, Steps: 12 | Train Loss: 0.745 Vali Loss: 0.964 Vali Acc: 0.739 Test Loss: 0.964 Test Acc: 0.739
Validation loss decreased (-0.727767 --> -0.738879).  Saving model ...
Epoch: 20 cost time: 0.7716138362884521
Epoch: 20, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.892 Vali Acc: 0.756 Test Loss: 0.892 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755547).  Saving model ...
Epoch: 21 cost time: 0.787372350692749
Epoch: 21, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.858 Vali Acc: 0.761 Test Loss: 0.858 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 22 cost time: 0.7695903778076172
Epoch: 22, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.812 Vali Acc: 0.789 Test Loss: 0.812 Test Acc: 0.789
Validation loss decreased (-0.761103 --> -0.788881).  Saving model ...
Epoch: 23 cost time: 0.7331395149230957
Epoch: 23, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.760 Vali Acc: 0.794 Test Loss: 0.760 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794437).  Saving model ...
Epoch: 24 cost time: 0.7434136867523193
Epoch: 24, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.724 Vali Acc: 0.806 Test Loss: 0.724 Test Acc: 0.806
Validation loss decreased (-0.794437 --> -0.805548).  Saving model ...
Epoch: 25 cost time: 0.7954111099243164
Epoch: 25, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.690 Vali Acc: 0.806 Test Loss: 0.690 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805549).  Saving model ...
Epoch: 26 cost time: 0.7339551448822021
Epoch: 26, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.654 Vali Acc: 0.811 Test Loss: 0.654 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 27 cost time: 0.767568826675415
Epoch: 27, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.638 Vali Acc: 0.817 Test Loss: 0.638 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816660).  Saving model ...
Epoch: 28 cost time: 0.7556004524230957
Epoch: 28, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.612 Vali Acc: 0.822 Test Loss: 0.612 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 29 cost time: 0.7923073768615723
Epoch: 29, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.610 Vali Acc: 0.844 Test Loss: 0.610 Test Acc: 0.844
Validation loss decreased (-0.822216 --> -0.844438).  Saving model ...
Epoch: 30 cost time: 0.7788784503936768
Epoch: 30, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844439).  Saving model ...
Epoch: 31 cost time: 0.7307629585266113
Epoch: 31, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 32 cost time: 0.7538349628448486
Epoch: 32, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861106).  Saving model ...
Epoch: 33 cost time: 0.7487480640411377
Epoch: 33, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.537 Vali Acc: 0.856 Test Loss: 0.537 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7533667087554932
Epoch: 34, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7536914348602295
Epoch: 35, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.522 Vali Acc: 0.839 Test Loss: 0.522 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7869858741760254
Epoch: 36, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.529 Vali Acc: 0.856 Test Loss: 0.529 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7382621765136719
Epoch: 37, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.518 Vali Acc: 0.872 Test Loss: 0.518 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 38 cost time: 0.7274973392486572
Epoch: 38, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.507 Vali Acc: 0.872 Test Loss: 0.507 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 39 cost time: 0.7513093948364258
Epoch: 39, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.502 Vali Acc: 0.872 Test Loss: 0.502 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 40 cost time: 0.7773821353912354
Epoch: 40, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.496 Vali Acc: 0.867 Test Loss: 0.496 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7515740394592285
Epoch: 41, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.487 Vali Acc: 0.861 Test Loss: 0.487 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6828904151916504
Epoch: 42, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.492 Vali Acc: 0.861 Test Loss: 0.492 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7122790813446045
Epoch: 43, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.508 Vali Acc: 0.861 Test Loss: 0.508 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7180492877960205
Epoch: 44, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.499 Vali Acc: 0.872 Test Loss: 0.499 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 45 cost time: 0.7257418632507324
Epoch: 45, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.485 Vali Acc: 0.889 Test Loss: 0.485 Test Acc: 0.889
Validation loss decreased (-0.872217 --> -0.888884).  Saving model ...
Epoch: 46 cost time: 0.7007913589477539
Epoch: 46, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.491 Vali Acc: 0.878 Test Loss: 0.491 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7182857990264893
Epoch: 47, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.483 Vali Acc: 0.878 Test Loss: 0.483 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7041332721710205
Epoch: 48, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.467 Vali Acc: 0.878 Test Loss: 0.467 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7164139747619629
Epoch: 49, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.482 Vali Acc: 0.872 Test Loss: 0.482 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.7054269313812256
Epoch: 50, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.499 Vali Acc: 0.878 Test Loss: 0.499 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 38831
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.245732069015503
Epoch: 1, Steps: 12 | Train Loss: 2.699 Vali Loss: 2.571 Vali Acc: 0.306 Test Loss: 2.571 Test Acc: 0.306
Validation loss decreased (inf --> -0.305530).  Saving model ...
Epoch: 2 cost time: 1.030299425125122
Epoch: 2, Steps: 12 | Train Loss: 2.231 Vali Loss: 2.144 Vali Acc: 0.494 Test Loss: 2.144 Test Acc: 0.494
Validation loss decreased (-0.305530 --> -0.494423).  Saving model ...
Epoch: 3 cost time: 1.0533828735351562
Epoch: 3, Steps: 12 | Train Loss: 1.674 Vali Loss: 1.592 Vali Acc: 0.594 Test Loss: 1.592 Test Acc: 0.594
Validation loss decreased (-0.494423 --> -0.594429).  Saving model ...
Epoch: 4 cost time: 0.9916207790374756
Epoch: 4, Steps: 12 | Train Loss: 1.183 Vali Loss: 1.206 Vali Acc: 0.667 Test Loss: 1.206 Test Acc: 0.667
Validation loss decreased (-0.594429 --> -0.666655).  Saving model ...
Epoch: 5 cost time: 1.0512471199035645
Epoch: 5, Steps: 12 | Train Loss: 0.815 Vali Loss: 1.047 Vali Acc: 0.672 Test Loss: 1.047 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672212).  Saving model ...
Epoch: 6 cost time: 1.0053832530975342
Epoch: 6, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.893 Vali Acc: 0.717 Test Loss: 0.893 Test Acc: 0.717
Validation loss decreased (-0.672212 --> -0.716658).  Saving model ...
Epoch: 7 cost time: 1.0859827995300293
Epoch: 7, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.910 Vali Acc: 0.700 Test Loss: 0.910 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0035769939422607
Epoch: 8, Steps: 12 | Train Loss: 0.392 Vali Loss: 1.010 Vali Acc: 0.700 Test Loss: 1.010 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0041499137878418
Epoch: 9, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.840 Vali Acc: 0.761 Test Loss: 0.840 Test Acc: 0.761
Validation loss decreased (-0.716658 --> -0.761103).  Saving model ...
Epoch: 10 cost time: 0.9464981555938721
Epoch: 10, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.994 Vali Acc: 0.761 Test Loss: 0.994 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9181618690490723
Epoch: 11, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.910 Vali Acc: 0.756 Test Loss: 0.910 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9169197082519531
Epoch: 12, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.999 Vali Acc: 0.783 Test Loss: 0.999 Test Acc: 0.783
Validation loss decreased (-0.761103 --> -0.783323).  Saving model ...
Epoch: 13 cost time: 1.0189499855041504
Epoch: 13, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.938 Vali Acc: 0.789 Test Loss: 0.938 Test Acc: 0.789
Validation loss decreased (-0.783323 --> -0.788880).  Saving model ...
Epoch: 14 cost time: 1.0369229316711426
Epoch: 14, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.962 Vali Acc: 0.772 Test Loss: 0.962 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.044952630996704
Epoch: 15, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.880 Vali Acc: 0.822 Test Loss: 0.880 Test Acc: 0.822
Validation loss decreased (-0.788880 --> -0.822213).  Saving model ...
Epoch: 16 cost time: 1.0798518657684326
Epoch: 16, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.936 Vali Acc: 0.822 Test Loss: 0.936 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0693573951721191
Epoch: 17, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.002 Vali Acc: 0.817 Test Loss: 1.002 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0817389488220215
Epoch: 18, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.953 Vali Acc: 0.844 Test Loss: 0.953 Test Acc: 0.844
Validation loss decreased (-0.822213 --> -0.844435).  Saving model ...
Epoch: 19 cost time: 1.0056493282318115
Epoch: 19, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.057 Vali Acc: 0.817 Test Loss: 1.057 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0301740169525146
Epoch: 20, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.074 Vali Acc: 0.817 Test Loss: 1.074 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0184533596038818
Epoch: 21, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.210 Vali Acc: 0.817 Test Loss: 1.210 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.063849925994873
Epoch: 22, Steps: 12 | Train Loss: 0.061 Vali Loss: 1.054 Vali Acc: 0.828 Test Loss: 1.054 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.055375099182129
Epoch: 23, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.144 Vali Acc: 0.800 Test Loss: 1.144 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0093388557434082
Epoch: 24, Steps: 12 | Train Loss: 0.093 Vali Loss: 1.198 Vali Acc: 0.828 Test Loss: 1.198 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9600858688354492
Epoch: 25, Steps: 12 | Train Loss: 0.091 Vali Loss: 1.000 Vali Acc: 0.856 Test Loss: 1.000 Test Acc: 0.856
Validation loss decreased (-0.844435 --> -0.855546).  Saving model ...
Epoch: 26 cost time: 0.950721263885498
Epoch: 26, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.057 Vali Acc: 0.856 Test Loss: 1.057 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.983381986618042
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.174 Vali Acc: 0.856 Test Loss: 1.174 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0893349647521973
Epoch: 28, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.078 Vali Acc: 0.850 Test Loss: 1.078 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0283925533294678
Epoch: 29, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.119 Vali Acc: 0.844 Test Loss: 1.119 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9857587814331055
Epoch: 30, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.256 Vali Acc: 0.811 Test Loss: 1.256 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9706990718841553
Epoch: 31, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.126 Vali Acc: 0.822 Test Loss: 1.126 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9511277675628662
Epoch: 32, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.138 Vali Acc: 0.856 Test Loss: 1.138 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9976546764373779
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.216 Vali Acc: 0.839 Test Loss: 1.216 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0727431774139404
Epoch: 34, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.186 Vali Acc: 0.850 Test Loss: 1.186 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.0869858264923096
Epoch: 35, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.200 Vali Acc: 0.861 Test Loss: 1.200 Test Acc: 0.861
Validation loss decreased (-0.855546 --> -0.861099).  Saving model ...
Epoch: 36 cost time: 1.0408098697662354
Epoch: 36, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.189 Vali Acc: 0.850 Test Loss: 1.189 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.050248622894287
Epoch: 37, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.544 Vali Acc: 0.833 Test Loss: 1.544 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0287907123565674
Epoch: 38, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.382 Vali Acc: 0.844 Test Loss: 1.382 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0044491291046143
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.292 Vali Acc: 0.850 Test Loss: 1.292 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.005692958831787
Epoch: 40, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.174 Vali Acc: 0.867 Test Loss: 1.174 Test Acc: 0.867
Validation loss decreased (-0.861099 --> -0.866655).  Saving model ...
Epoch: 41 cost time: 1.0524523258209229
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.146 Vali Acc: 0.867 Test Loss: 1.146 Test Acc: 0.867
Validation loss decreased (-0.866655 --> -0.866655).  Saving model ...
Epoch: 42 cost time: 1.043889045715332
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.186 Vali Acc: 0.861 Test Loss: 1.186 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9978301525115967
Epoch: 43, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.195 Vali Acc: 0.867 Test Loss: 1.195 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0386621952056885
Epoch: 44, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.183 Vali Acc: 0.872 Test Loss: 1.183 Test Acc: 0.872
Validation loss decreased (-0.866655 --> -0.872210).  Saving model ...
Epoch: 45 cost time: 0.9643020629882812
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.194 Vali Acc: 0.872 Test Loss: 1.194 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.982102632522583
Epoch: 46, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.211 Vali Acc: 0.856 Test Loss: 1.211 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9796693325042725
Epoch: 47, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.856 Test Loss: 1.234 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0605566501617432
Epoch: 48, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.229 Vali Acc: 0.856 Test Loss: 1.229 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.0307505130767822
Epoch: 49, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.241 Vali Acc: 0.844 Test Loss: 1.241 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.014606237411499
Epoch: 50, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.268 Vali Acc: 0.844 Test Loss: 1.268 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 591759
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.156473159790039
Epoch: 1, Steps: 12 | Train Loss: 2.723 Vali Loss: 2.640 Vali Acc: 0.094 Test Loss: 2.640 Test Acc: 0.094
Validation loss decreased (inf --> -0.094418).  Saving model ...
Epoch: 2 cost time: 1.037567138671875
Epoch: 2, Steps: 12 | Train Loss: 2.441 Vali Loss: 2.369 Vali Acc: 0.439 Test Loss: 2.369 Test Acc: 0.439
Validation loss decreased (-0.094418 --> -0.438865).  Saving model ...
Epoch: 3 cost time: 0.9927265644073486
Epoch: 3, Steps: 12 | Train Loss: 2.006 Vali Loss: 1.947 Vali Acc: 0.528 Test Loss: 1.947 Test Acc: 0.528
Validation loss decreased (-0.438865 --> -0.527758).  Saving model ...
Epoch: 4 cost time: 1.0172154903411865
Epoch: 4, Steps: 12 | Train Loss: 1.525 Vali Loss: 1.515 Vali Acc: 0.611 Test Loss: 1.515 Test Acc: 0.611
Validation loss decreased (-0.527758 --> -0.611096).  Saving model ...
Epoch: 5 cost time: 0.9711451530456543
Epoch: 5, Steps: 12 | Train Loss: 1.117 Vali Loss: 1.226 Vali Acc: 0.656 Test Loss: 1.226 Test Acc: 0.656
Validation loss decreased (-0.611096 --> -0.655543).  Saving model ...
Epoch: 6 cost time: 0.9376826286315918
Epoch: 6, Steps: 12 | Train Loss: 0.921 Vali Loss: 1.061 Vali Acc: 0.667 Test Loss: 1.061 Test Acc: 0.667
Validation loss decreased (-0.655543 --> -0.666656).  Saving model ...
Epoch: 7 cost time: 1.0050415992736816
Epoch: 7, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.986 Vali Acc: 0.678 Test Loss: 0.986 Test Acc: 0.678
Validation loss decreased (-0.666656 --> -0.677768).  Saving model ...
Epoch: 8 cost time: 0.9492876529693604
Epoch: 8, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.854 Vali Acc: 0.711 Test Loss: 0.854 Test Acc: 0.711
Validation loss decreased (-0.677768 --> -0.711103).  Saving model ...
Epoch: 9 cost time: 0.962130069732666
Epoch: 9, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.875 Vali Acc: 0.700 Test Loss: 0.875 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9294705390930176
Epoch: 10, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.787 Vali Acc: 0.739 Test Loss: 0.787 Test Acc: 0.739
Validation loss decreased (-0.711103 --> -0.738881).  Saving model ...
Epoch: 11 cost time: 0.9383926391601562
Epoch: 11, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.787 Vali Acc: 0.756 Test Loss: 0.787 Test Acc: 0.756
Validation loss decreased (-0.738881 --> -0.755548).  Saving model ...
Epoch: 12 cost time: 0.93711256980896
Epoch: 12, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.758 Vali Acc: 0.778 Test Loss: 0.758 Test Acc: 0.778
Validation loss decreased (-0.755548 --> -0.777770).  Saving model ...
Epoch: 13 cost time: 0.9868934154510498
Epoch: 13, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.804 Vali Acc: 0.783 Test Loss: 0.804 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783325).  Saving model ...
Epoch: 14 cost time: 0.9918630123138428
Epoch: 14, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.747 Vali Acc: 0.783 Test Loss: 0.747 Test Acc: 0.783
Validation loss decreased (-0.783325 --> -0.783326).  Saving model ...
Epoch: 15 cost time: 0.9737491607666016
Epoch: 15, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.723 Vali Acc: 0.811 Test Loss: 0.723 Test Acc: 0.811
Validation loss decreased (-0.783326 --> -0.811104).  Saving model ...
Epoch: 16 cost time: 1.026491403579712
Epoch: 16, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.729 Vali Acc: 0.811 Test Loss: 0.729 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9229879379272461
Epoch: 17, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.696 Vali Acc: 0.839 Test Loss: 0.696 Test Acc: 0.839
Validation loss decreased (-0.811104 --> -0.838882).  Saving model ...
Epoch: 18 cost time: 0.9618091583251953
Epoch: 18, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.741 Vali Acc: 0.817 Test Loss: 0.741 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9507694244384766
Epoch: 19, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.818 Vali Acc: 0.811 Test Loss: 0.818 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9658749103546143
Epoch: 20, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.886 Vali Acc: 0.839 Test Loss: 0.886 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9947657585144043
Epoch: 21, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.804 Vali Acc: 0.811 Test Loss: 0.804 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9756577014923096
Epoch: 22, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.872 Vali Acc: 0.828 Test Loss: 0.872 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9922308921813965
Epoch: 23, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.849 Vali Acc: 0.833 Test Loss: 0.849 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9588665962219238
Epoch: 24, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.850 Vali Acc: 0.850 Test Loss: 0.850 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849991).  Saving model ...
Epoch: 25 cost time: 0.964362382888794
Epoch: 25, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.922 Vali Acc: 0.861 Test Loss: 0.922 Test Acc: 0.861
Validation loss decreased (-0.849991 --> -0.861102).  Saving model ...
Epoch: 26 cost time: 0.9375419616699219
Epoch: 26, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.934 Vali Acc: 0.822 Test Loss: 0.934 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9303817749023438
Epoch: 27, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.943 Vali Acc: 0.844 Test Loss: 0.943 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8826584815979004
Epoch: 28, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.946 Vali Acc: 0.850 Test Loss: 0.946 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9764583110809326
Epoch: 29, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.843 Vali Acc: 0.839 Test Loss: 0.843 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9449782371520996
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.918 Vali Acc: 0.839 Test Loss: 0.918 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9442012310028076
Epoch: 31, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.950 Vali Acc: 0.850 Test Loss: 0.950 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9928250312805176
Epoch: 32, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.912 Vali Acc: 0.850 Test Loss: 0.912 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.904916524887085
Epoch: 33, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.911 Vali Acc: 0.856 Test Loss: 0.911 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9352264404296875
Epoch: 34, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.969 Vali Acc: 0.861 Test Loss: 0.969 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9965717792510986
Epoch: 35, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.134 Vali Acc: 0.839 Test Loss: 1.134 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 499727
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1186647415161133
Epoch: 1, Steps: 12 | Train Loss: 2.636 Vali Loss: 2.595 Vali Acc: 0.139 Test Loss: 2.595 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 0.9887161254882812
Epoch: 2, Steps: 12 | Train Loss: 2.360 Vali Loss: 2.324 Vali Acc: 0.428 Test Loss: 2.324 Test Acc: 0.428
Validation loss decreased (-0.138863 --> -0.427755).  Saving model ...
Epoch: 3 cost time: 0.9876649379730225
Epoch: 3, Steps: 12 | Train Loss: 1.982 Vali Loss: 1.906 Vali Acc: 0.533 Test Loss: 1.906 Test Acc: 0.533
Validation loss decreased (-0.427755 --> -0.533314).  Saving model ...
Epoch: 4 cost time: 1.023380994796753
Epoch: 4, Steps: 12 | Train Loss: 1.489 Vali Loss: 1.505 Vali Acc: 0.622 Test Loss: 1.505 Test Acc: 0.622
Validation loss decreased (-0.533314 --> -0.622207).  Saving model ...
Epoch: 5 cost time: 0.9280140399932861
Epoch: 5, Steps: 12 | Train Loss: 1.115 Vali Loss: 1.215 Vali Acc: 0.644 Test Loss: 1.215 Test Acc: 0.644
Validation loss decreased (-0.622207 --> -0.644432).  Saving model ...
Epoch: 6 cost time: 0.9059309959411621
Epoch: 6, Steps: 12 | Train Loss: 0.839 Vali Loss: 1.030 Vali Acc: 0.678 Test Loss: 1.030 Test Acc: 0.678
Validation loss decreased (-0.644432 --> -0.677767).  Saving model ...
Epoch: 7 cost time: 0.910355806350708
Epoch: 7, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.902 Vali Acc: 0.700 Test Loss: 0.902 Test Acc: 0.700
Validation loss decreased (-0.677767 --> -0.699991).  Saving model ...
Epoch: 8 cost time: 0.9825453758239746
Epoch: 8, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.832 Vali Acc: 0.706 Test Loss: 0.832 Test Acc: 0.706
Validation loss decreased (-0.699991 --> -0.705547).  Saving model ...
Epoch: 9 cost time: 0.899320125579834
Epoch: 9, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.806 Vali Acc: 0.767 Test Loss: 0.806 Test Acc: 0.767
Validation loss decreased (-0.705547 --> -0.766659).  Saving model ...
Epoch: 10 cost time: 0.9905362129211426
Epoch: 10, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.727 Vali Acc: 0.794 Test Loss: 0.727 Test Acc: 0.794
Validation loss decreased (-0.766659 --> -0.794437).  Saving model ...
Epoch: 11 cost time: 1.0220940113067627
Epoch: 11, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.718 Vali Acc: 0.806 Test Loss: 0.718 Test Acc: 0.806
Validation loss decreased (-0.794437 --> -0.805548).  Saving model ...
Epoch: 12 cost time: 1.0308763980865479
Epoch: 12, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.704 Vali Acc: 0.806 Test Loss: 0.704 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805549).  Saving model ...
Epoch: 13 cost time: 0.9816257953643799
Epoch: 13, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.662 Vali Acc: 0.817 Test Loss: 0.662 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816660).  Saving model ...
Epoch: 14 cost time: 1.0306804180145264
Epoch: 14, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.640 Vali Acc: 0.839 Test Loss: 0.640 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838882).  Saving model ...
Epoch: 15 cost time: 1.0434527397155762
Epoch: 15, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.650 Vali Acc: 0.822 Test Loss: 0.650 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0401344299316406
Epoch: 16, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.647 Vali Acc: 0.839 Test Loss: 0.647 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0438082218170166
Epoch: 17, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.733 Vali Acc: 0.833 Test Loss: 0.733 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.026277780532837
Epoch: 18, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.698 Vali Acc: 0.839 Test Loss: 0.698 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0442678928375244
Epoch: 19, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.643 Vali Acc: 0.856 Test Loss: 0.643 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855549).  Saving model ...
Epoch: 20 cost time: 1.0108132362365723
Epoch: 20, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.701 Vali Acc: 0.844 Test Loss: 0.701 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0028810501098633
Epoch: 21, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.793 Vali Acc: 0.822 Test Loss: 0.793 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9791080951690674
Epoch: 22, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.787 Vali Acc: 0.817 Test Loss: 0.787 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9476127624511719
Epoch: 23, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.716 Vali Acc: 0.867 Test Loss: 0.716 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866660).  Saving model ...
Epoch: 24 cost time: 0.9910712242126465
Epoch: 24, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.661 Vali Acc: 0.856 Test Loss: 0.661 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9784731864929199
Epoch: 25, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.682 Vali Acc: 0.867 Test Loss: 0.682 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866660).  Saving model ...
Epoch: 26 cost time: 1.0203430652618408
Epoch: 26, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.703 Vali Acc: 0.861 Test Loss: 0.703 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9690897464752197
Epoch: 27, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.746 Vali Acc: 0.861 Test Loss: 0.746 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0474565029144287
Epoch: 28, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.729 Vali Acc: 0.856 Test Loss: 0.729 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0417201519012451
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.854 Vali Acc: 0.861 Test Loss: 0.854 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9398176670074463
Epoch: 30, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.806 Vali Acc: 0.844 Test Loss: 0.806 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0577669143676758
Epoch: 31, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.788 Vali Acc: 0.856 Test Loss: 0.788 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0597813129425049
Epoch: 32, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.796 Vali Acc: 0.856 Test Loss: 0.796 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0299065113067627
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.785 Vali Acc: 0.878 Test Loss: 0.785 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877770).  Saving model ...
Epoch: 34 cost time: 1.0598571300506592
Epoch: 34, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.756 Vali Acc: 0.861 Test Loss: 0.756 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0642421245574951
Epoch: 35, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.877 Vali Acc: 0.867 Test Loss: 0.877 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.07313871383667
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.800 Vali Acc: 0.861 Test Loss: 0.800 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0798730850219727
Epoch: 37, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.860 Vali Acc: 0.867 Test Loss: 0.860 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1312129497528076
Epoch: 38, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.855 Vali Acc: 0.872 Test Loss: 0.855 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0615320205688477
Epoch: 39, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.909 Vali Acc: 0.867 Test Loss: 0.909 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0165534019470215
Epoch: 40, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.921 Vali Acc: 0.856 Test Loss: 0.921 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.9841196537017822
Epoch: 41, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.890 Vali Acc: 0.878 Test Loss: 0.890 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.9836101531982422
Epoch: 42, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.886 Vali Acc: 0.872 Test Loss: 0.886 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.019864559173584
Epoch: 43, Steps: 12 | Train Loss: 0.109 Vali Loss: 1.023 Vali Acc: 0.850 Test Loss: 1.023 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 499855
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4525129795074463
Epoch: 1, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.640 Vali Acc: 0.128 Test Loss: 2.640 Test Acc: 0.128
Validation loss decreased (inf --> -0.127751).  Saving model ...
Epoch: 2 cost time: 1.0195722579956055
Epoch: 2, Steps: 12 | Train Loss: 2.523 Vali Loss: 2.413 Vali Acc: 0.394 Test Loss: 2.413 Test Acc: 0.394
Validation loss decreased (-0.127751 --> -0.394420).  Saving model ...
Epoch: 3 cost time: 1.025306224822998
Epoch: 3, Steps: 12 | Train Loss: 2.193 Vali Loss: 2.076 Vali Acc: 0.533 Test Loss: 2.076 Test Acc: 0.533
Validation loss decreased (-0.394420 --> -0.533313).  Saving model ...
Epoch: 4 cost time: 1.0436832904815674
Epoch: 4, Steps: 12 | Train Loss: 1.796 Vali Loss: 1.667 Vali Acc: 0.639 Test Loss: 1.667 Test Acc: 0.639
Validation loss decreased (-0.533313 --> -0.638872).  Saving model ...
Epoch: 5 cost time: 1.0575757026672363
Epoch: 5, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.325 Vali Acc: 0.650 Test Loss: 1.325 Test Acc: 0.650
Validation loss decreased (-0.638872 --> -0.649987).  Saving model ...
Epoch: 6 cost time: 1.0043983459472656
Epoch: 6, Steps: 12 | Train Loss: 1.065 Vali Loss: 1.104 Vali Acc: 0.672 Test Loss: 1.104 Test Acc: 0.672
Validation loss decreased (-0.649987 --> -0.672211).  Saving model ...
Epoch: 7 cost time: 1.0260581970214844
Epoch: 7, Steps: 12 | Train Loss: 0.811 Vali Loss: 0.971 Vali Acc: 0.706 Test Loss: 0.971 Test Acc: 0.706
Validation loss decreased (-0.672211 --> -0.705546).  Saving model ...
Epoch: 8 cost time: 1.0252025127410889
Epoch: 8, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.856 Vali Acc: 0.733 Test Loss: 0.856 Test Acc: 0.733
Validation loss decreased (-0.705546 --> -0.733325).  Saving model ...
Epoch: 9 cost time: 1.029637098312378
Epoch: 9, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.799 Vali Acc: 0.744 Test Loss: 0.799 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744436).  Saving model ...
Epoch: 10 cost time: 1.036393165588379
Epoch: 10, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.745 Vali Acc: 0.778 Test Loss: 0.745 Test Acc: 0.778
Validation loss decreased (-0.744436 --> -0.777770).  Saving model ...
Epoch: 11 cost time: 0.9594869613647461
Epoch: 11, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.689 Vali Acc: 0.800 Test Loss: 0.689 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 0.941068172454834
Epoch: 12, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.697 Vali Acc: 0.794 Test Loss: 0.697 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9961791038513184
Epoch: 13, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.652 Vali Acc: 0.806 Test Loss: 0.652 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 14 cost time: 0.9491786956787109
Epoch: 14, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.637 Vali Acc: 0.822 Test Loss: 0.637 Test Acc: 0.822
Validation loss decreased (-0.805549 --> -0.822216).  Saving model ...
Epoch: 15 cost time: 0.9153304100036621
Epoch: 15, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.654 Vali Acc: 0.844 Test Loss: 0.654 Test Acc: 0.844
Validation loss decreased (-0.822216 --> -0.844438).  Saving model ...
Epoch: 16 cost time: 1.0089285373687744
Epoch: 16, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.653 Vali Acc: 0.839 Test Loss: 0.653 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9819474220275879
Epoch: 17, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.653 Vali Acc: 0.850 Test Loss: 0.653 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849993).  Saving model ...
Epoch: 18 cost time: 1.0343818664550781
Epoch: 18, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.573 Vali Acc: 0.867 Test Loss: 0.573 Test Acc: 0.867
Validation loss decreased (-0.849993 --> -0.866661).  Saving model ...
Epoch: 19 cost time: 1.0176868438720703
Epoch: 19, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.610 Vali Acc: 0.867 Test Loss: 0.610 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0287413597106934
Epoch: 20, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.630 Vali Acc: 0.861 Test Loss: 0.630 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9682197570800781
Epoch: 21, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.685 Vali Acc: 0.856 Test Loss: 0.685 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9719274044036865
Epoch: 22, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.650 Vali Acc: 0.878 Test Loss: 0.650 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877771).  Saving model ...
Epoch: 23 cost time: 0.9625411033630371
Epoch: 23, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.659 Vali Acc: 0.883 Test Loss: 0.659 Test Acc: 0.883
Validation loss decreased (-0.877771 --> -0.883327).  Saving model ...
Epoch: 24 cost time: 0.9969701766967773
Epoch: 24, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.718 Vali Acc: 0.867 Test Loss: 0.718 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9930069446563721
Epoch: 25, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.680 Vali Acc: 0.861 Test Loss: 0.680 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0309600830078125
Epoch: 26, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.730 Vali Acc: 0.872 Test Loss: 0.730 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0276496410369873
Epoch: 27, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.725 Vali Acc: 0.861 Test Loss: 0.725 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0421290397644043
Epoch: 28, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.730 Vali Acc: 0.872 Test Loss: 0.730 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9420835971832275
Epoch: 29, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.765 Vali Acc: 0.872 Test Loss: 0.765 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9659419059753418
Epoch: 30, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.795 Vali Acc: 0.878 Test Loss: 0.795 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9608697891235352
Epoch: 31, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.811 Vali Acc: 0.861 Test Loss: 0.811 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1220037937164307
Epoch: 32, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.821 Vali Acc: 0.872 Test Loss: 0.821 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8445804119110107
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.831 Vali Acc: 0.867 Test Loss: 0.831 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 476943
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1184070110321045
Epoch: 1, Steps: 12 | Train Loss: 2.757 Vali Loss: 2.668 Vali Acc: 0.094 Test Loss: 2.668 Test Acc: 0.094
Validation loss decreased (inf --> -0.094418).  Saving model ...
Epoch: 2 cost time: 1.0045523643493652
Epoch: 2, Steps: 12 | Train Loss: 2.533 Vali Loss: 2.482 Vali Acc: 0.322 Test Loss: 2.482 Test Acc: 0.322
Validation loss decreased (-0.094418 --> -0.322197).  Saving model ...
Epoch: 3 cost time: 1.00935959815979
Epoch: 3, Steps: 12 | Train Loss: 2.284 Vali Loss: 2.203 Vali Acc: 0.511 Test Loss: 2.203 Test Acc: 0.511
Validation loss decreased (-0.322197 --> -0.511089).  Saving model ...
Epoch: 4 cost time: 1.0454599857330322
Epoch: 4, Steps: 12 | Train Loss: 1.919 Vali Loss: 1.864 Vali Acc: 0.633 Test Loss: 1.864 Test Acc: 0.633
Validation loss decreased (-0.511089 --> -0.633315).  Saving model ...
Epoch: 5 cost time: 1.0277419090270996
Epoch: 5, Steps: 12 | Train Loss: 1.530 Vali Loss: 1.522 Vali Acc: 0.622 Test Loss: 1.522 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9888842105865479
Epoch: 6, Steps: 12 | Train Loss: 1.208 Vali Loss: 1.260 Vali Acc: 0.661 Test Loss: 1.260 Test Acc: 0.661
Validation loss decreased (-0.633315 --> -0.661099).  Saving model ...
Epoch: 7 cost time: 0.9940810203552246
Epoch: 7, Steps: 12 | Train Loss: 0.948 Vali Loss: 1.083 Vali Acc: 0.678 Test Loss: 1.083 Test Acc: 0.678
Validation loss decreased (-0.661099 --> -0.677767).  Saving model ...
Epoch: 8 cost time: 1.0041170120239258
Epoch: 8, Steps: 12 | Train Loss: 0.788 Vali Loss: 0.993 Vali Acc: 0.700 Test Loss: 0.993 Test Acc: 0.700
Validation loss decreased (-0.677767 --> -0.699990).  Saving model ...
Epoch: 9 cost time: 1.0399422645568848
Epoch: 9, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.888 Vali Acc: 0.706 Test Loss: 0.888 Test Acc: 0.706
Validation loss decreased (-0.699990 --> -0.705547).  Saving model ...
Epoch: 10 cost time: 1.0729761123657227
Epoch: 10, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.816 Vali Acc: 0.739 Test Loss: 0.816 Test Acc: 0.739
Validation loss decreased (-0.705547 --> -0.738881).  Saving model ...
Epoch: 11 cost time: 0.9450440406799316
Epoch: 11, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.741 Vali Acc: 0.817 Test Loss: 0.741 Test Acc: 0.817
Validation loss decreased (-0.738881 --> -0.816659).  Saving model ...
Epoch: 12 cost time: 0.942446231842041
Epoch: 12, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.726 Vali Acc: 0.800 Test Loss: 0.726 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9120736122131348
Epoch: 13, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.699 Vali Acc: 0.789 Test Loss: 0.699 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9204962253570557
Epoch: 14, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.690 Vali Acc: 0.811 Test Loss: 0.690 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.109666347503662
Epoch: 15, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.654 Vali Acc: 0.833 Test Loss: 0.654 Test Acc: 0.833
Validation loss decreased (-0.816659 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 1.0727458000183105
Epoch: 16, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.617 Vali Acc: 0.833 Test Loss: 0.617 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 17 cost time: 1.0103261470794678
Epoch: 17, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.593 Vali Acc: 0.839 Test Loss: 0.593 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 18 cost time: 0.9761855602264404
Epoch: 18, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.603 Vali Acc: 0.844 Test Loss: 0.603 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 19 cost time: 1.051375150680542
Epoch: 19, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.664 Vali Acc: 0.839 Test Loss: 0.664 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9658477306365967
Epoch: 20, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.664 Vali Acc: 0.861 Test Loss: 0.664 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861104).  Saving model ...
Epoch: 21 cost time: 1.0697402954101562
Epoch: 21, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.612 Vali Acc: 0.861 Test Loss: 0.612 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861105).  Saving model ...
Epoch: 22 cost time: 0.9907019138336182
Epoch: 22, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.687 Vali Acc: 0.856 Test Loss: 0.687 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9670851230621338
Epoch: 23, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.663 Vali Acc: 0.844 Test Loss: 0.663 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.031639814376831
Epoch: 24, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.695 Vali Acc: 0.856 Test Loss: 0.695 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0064222812652588
Epoch: 25, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.703 Vali Acc: 0.861 Test Loss: 0.703 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9794392585754395
Epoch: 26, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.727 Vali Acc: 0.856 Test Loss: 0.727 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9857323169708252
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.772 Vali Acc: 0.867 Test Loss: 0.772 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866659).  Saving model ...
Epoch: 28 cost time: 0.9822981357574463
Epoch: 28, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.721 Vali Acc: 0.872 Test Loss: 0.721 Test Acc: 0.872
Validation loss decreased (-0.866659 --> -0.872215).  Saving model ...
Epoch: 29 cost time: 0.9842071533203125
Epoch: 29, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.713 Vali Acc: 0.861 Test Loss: 0.713 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8704662322998047
Epoch: 30, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.739 Vali Acc: 0.861 Test Loss: 0.739 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9654510021209717
Epoch: 31, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.750 Vali Acc: 0.856 Test Loss: 0.750 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9944422245025635
Epoch: 32, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.718 Vali Acc: 0.867 Test Loss: 0.718 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9951813220977783
Epoch: 33, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.729 Vali Acc: 0.867 Test Loss: 0.729 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0128660202026367
Epoch: 34, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.733 Vali Acc: 0.872 Test Loss: 0.733 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.004765272140503
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.704 Vali Acc: 0.861 Test Loss: 0.704 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0048272609710693
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.731 Vali Acc: 0.872 Test Loss: 0.731 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9942588806152344
Epoch: 37, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.754 Vali Acc: 0.867 Test Loss: 0.754 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.0083668231964111
Epoch: 38, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.796 Vali Acc: 0.867 Test Loss: 0.796 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 461839
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1836485862731934
Epoch: 1, Steps: 12 | Train Loss: 2.671 Vali Loss: 2.625 Vali Acc: 0.133 Test Loss: 2.625 Test Acc: 0.133
Validation loss decreased (inf --> -0.133307).  Saving model ...
Epoch: 2 cost time: 0.9995055198669434
Epoch: 2, Steps: 12 | Train Loss: 2.502 Vali Loss: 2.464 Vali Acc: 0.422 Test Loss: 2.464 Test Acc: 0.422
Validation loss decreased (-0.133307 --> -0.422198).  Saving model ...
Epoch: 3 cost time: 1.0462861061096191
Epoch: 3, Steps: 12 | Train Loss: 2.281 Vali Loss: 2.208 Vali Acc: 0.472 Test Loss: 2.208 Test Acc: 0.472
Validation loss decreased (-0.422198 --> -0.472200).  Saving model ...
Epoch: 4 cost time: 1.0451853275299072
Epoch: 4, Steps: 12 | Train Loss: 1.919 Vali Loss: 1.901 Vali Acc: 0.567 Test Loss: 1.901 Test Acc: 0.567
Validation loss decreased (-0.472200 --> -0.566648).  Saving model ...
Epoch: 5 cost time: 0.9892292022705078
Epoch: 5, Steps: 12 | Train Loss: 1.632 Vali Loss: 1.626 Vali Acc: 0.639 Test Loss: 1.626 Test Acc: 0.639
Validation loss decreased (-0.566648 --> -0.638873).  Saving model ...
Epoch: 6 cost time: 1.0403895378112793
Epoch: 6, Steps: 12 | Train Loss: 1.269 Vali Loss: 1.378 Vali Acc: 0.678 Test Loss: 1.378 Test Acc: 0.678
Validation loss decreased (-0.638873 --> -0.677764).  Saving model ...
Epoch: 7 cost time: 1.018772840499878
Epoch: 7, Steps: 12 | Train Loss: 1.026 Vali Loss: 1.144 Vali Acc: 0.683 Test Loss: 1.144 Test Acc: 0.683
Validation loss decreased (-0.677764 --> -0.683322).  Saving model ...
Epoch: 8 cost time: 0.989757776260376
Epoch: 8, Steps: 12 | Train Loss: 0.831 Vali Loss: 0.991 Vali Acc: 0.706 Test Loss: 0.991 Test Acc: 0.706
Validation loss decreased (-0.683322 --> -0.705546).  Saving model ...
Epoch: 9 cost time: 1.0691516399383545
Epoch: 9, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.890 Vali Acc: 0.739 Test Loss: 0.890 Test Acc: 0.739
Validation loss decreased (-0.705546 --> -0.738880).  Saving model ...
Epoch: 10 cost time: 1.1258232593536377
Epoch: 10, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.818 Vali Acc: 0.767 Test Loss: 0.818 Test Acc: 0.767
Validation loss decreased (-0.738880 --> -0.766658).  Saving model ...
Epoch: 11 cost time: 1.0268619060516357
Epoch: 11, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.734 Vali Acc: 0.783 Test Loss: 0.734 Test Acc: 0.783
Validation loss decreased (-0.766658 --> -0.783326).  Saving model ...
Epoch: 12 cost time: 1.0345146656036377
Epoch: 12, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.663 Vali Acc: 0.794 Test Loss: 0.663 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794438).  Saving model ...
Epoch: 13 cost time: 1.0061819553375244
Epoch: 13, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.634 Vali Acc: 0.833 Test Loss: 0.634 Test Acc: 0.833
Validation loss decreased (-0.794438 --> -0.833327).  Saving model ...
Epoch: 14 cost time: 0.9905259609222412
Epoch: 14, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.615 Vali Acc: 0.828 Test Loss: 0.615 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9990508556365967
Epoch: 15, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.586 Vali Acc: 0.817 Test Loss: 0.586 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.069580316543579
Epoch: 16, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.611 Vali Acc: 0.856 Test Loss: 0.611 Test Acc: 0.856
Validation loss decreased (-0.833327 --> -0.855549).  Saving model ...
Epoch: 17 cost time: 1.0421369075775146
Epoch: 17, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.597 Vali Acc: 0.839 Test Loss: 0.597 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0094842910766602
Epoch: 18, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.608 Vali Acc: 0.844 Test Loss: 0.608 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.993994951248169
Epoch: 19, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.570 Vali Acc: 0.856 Test Loss: 0.570 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855550).  Saving model ...
Epoch: 20 cost time: 1.0043842792510986
Epoch: 20, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.614 Vali Acc: 0.856 Test Loss: 0.614 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0442042350769043
Epoch: 21, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.617 Vali Acc: 0.856 Test Loss: 0.617 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9986469745635986
Epoch: 22, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.620 Vali Acc: 0.861 Test Loss: 0.620 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 23 cost time: 0.9916062355041504
Epoch: 23, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.608 Vali Acc: 0.872 Test Loss: 0.608 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 24 cost time: 1.0234935283660889
Epoch: 24, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.597 Vali Acc: 0.872 Test Loss: 0.597 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 25 cost time: 1.0499355792999268
Epoch: 25, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.624 Vali Acc: 0.883 Test Loss: 0.624 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883327).  Saving model ...
Epoch: 26 cost time: 0.96718430519104
Epoch: 26, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.617 Vali Acc: 0.856 Test Loss: 0.617 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9746348857879639
Epoch: 27, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.646 Vali Acc: 0.856 Test Loss: 0.646 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.997488260269165
Epoch: 28, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.641 Vali Acc: 0.867 Test Loss: 0.641 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0455389022827148
Epoch: 29, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.716 Vali Acc: 0.867 Test Loss: 0.716 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0652759075164795
Epoch: 30, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.691 Vali Acc: 0.839 Test Loss: 0.691 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0132782459259033
Epoch: 31, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.692 Vali Acc: 0.861 Test Loss: 0.692 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0018069744110107
Epoch: 32, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.720 Vali Acc: 0.867 Test Loss: 0.720 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.104245901107788
Epoch: 33, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.687 Vali Acc: 0.861 Test Loss: 0.687 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.1958744525909424
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.715 Vali Acc: 0.889 Test Loss: 0.715 Test Acc: 0.889
Validation loss decreased (-0.883327 --> -0.888882).  Saving model ...
Epoch: 35 cost time: 1.0985064506530762
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.728 Vali Acc: 0.889 Test Loss: 0.728 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.111588478088379
Epoch: 36, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.708 Vali Acc: 0.883 Test Loss: 0.708 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.184718370437622
Epoch: 37, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.730 Vali Acc: 0.883 Test Loss: 0.730 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1395158767700195
Epoch: 38, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.705 Vali Acc: 0.856 Test Loss: 0.705 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.1657772064208984
Epoch: 39, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.766 Vali Acc: 0.883 Test Loss: 0.766 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.067708969116211
Epoch: 40, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.789 Vali Acc: 0.856 Test Loss: 0.789 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.1506714820861816
Epoch: 41, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.795 Vali Acc: 0.828 Test Loss: 0.795 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.044490098953247
Epoch: 42, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.792 Vali Acc: 0.867 Test Loss: 0.792 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.0424225330352783
Epoch: 43, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.806 Vali Acc: 0.878 Test Loss: 0.806 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.0930349826812744
Epoch: 44, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.818 Vali Acc: 0.878 Test Loss: 0.818 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 454415
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.287654399871826
Epoch: 1, Steps: 12 | Train Loss: 2.754 Vali Loss: 2.681 Vali Acc: 0.072 Test Loss: 2.681 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 0.9855496883392334
Epoch: 2, Steps: 12 | Train Loss: 2.598 Vali Loss: 2.523 Vali Acc: 0.300 Test Loss: 2.523 Test Acc: 0.300
Validation loss decreased (-0.072195 --> -0.299975).  Saving model ...
Epoch: 3 cost time: 1.0483622550964355
Epoch: 3, Steps: 12 | Train Loss: 2.355 Vali Loss: 2.272 Vali Acc: 0.489 Test Loss: 2.272 Test Acc: 0.489
Validation loss decreased (-0.299975 --> -0.488866).  Saving model ...
Epoch: 4 cost time: 0.9825208187103271
Epoch: 4, Steps: 12 | Train Loss: 2.037 Vali Loss: 1.973 Vali Acc: 0.561 Test Loss: 1.973 Test Acc: 0.561
Validation loss decreased (-0.488866 --> -0.561091).  Saving model ...
Epoch: 5 cost time: 0.9924767017364502
Epoch: 5, Steps: 12 | Train Loss: 1.717 Vali Loss: 1.670 Vali Acc: 0.583 Test Loss: 1.670 Test Acc: 0.583
Validation loss decreased (-0.561091 --> -0.583317).  Saving model ...
Epoch: 6 cost time: 1.0125787258148193
Epoch: 6, Steps: 12 | Train Loss: 1.388 Vali Loss: 1.425 Vali Acc: 0.633 Test Loss: 1.425 Test Acc: 0.633
Validation loss decreased (-0.583317 --> -0.633319).  Saving model ...
Epoch: 7 cost time: 1.0062947273254395
Epoch: 7, Steps: 12 | Train Loss: 1.143 Vali Loss: 1.235 Vali Acc: 0.650 Test Loss: 1.235 Test Acc: 0.650
Validation loss decreased (-0.633319 --> -0.649988).  Saving model ...
Epoch: 8 cost time: 1.0368669033050537
Epoch: 8, Steps: 12 | Train Loss: 0.940 Vali Loss: 1.086 Vali Acc: 0.733 Test Loss: 1.086 Test Acc: 0.733
Validation loss decreased (-0.649988 --> -0.733322).  Saving model ...
Epoch: 9 cost time: 1.044039249420166
Epoch: 9, Steps: 12 | Train Loss: 0.793 Vali Loss: 0.932 Vali Acc: 0.733 Test Loss: 0.932 Test Acc: 0.733
Validation loss decreased (-0.733322 --> -0.733324).  Saving model ...
Epoch: 10 cost time: 0.978886604309082
Epoch: 10, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.836 Vali Acc: 0.772 Test Loss: 0.836 Test Acc: 0.772
Validation loss decreased (-0.733324 --> -0.772214).  Saving model ...
Epoch: 11 cost time: 0.9914686679840088
Epoch: 11, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.759 Vali Acc: 0.789 Test Loss: 0.759 Test Acc: 0.789
Validation loss decreased (-0.772214 --> -0.788881).  Saving model ...
Epoch: 12 cost time: 0.9422438144683838
Epoch: 12, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.678 Vali Acc: 0.811 Test Loss: 0.678 Test Acc: 0.811
Validation loss decreased (-0.788881 --> -0.811104).  Saving model ...
Epoch: 13 cost time: 1.000056266784668
Epoch: 13, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.656 Vali Acc: 0.811 Test Loss: 0.656 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811105).  Saving model ...
Epoch: 14 cost time: 0.9283490180969238
Epoch: 14, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.583 Vali Acc: 0.800 Test Loss: 0.583 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0263209342956543
Epoch: 15, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.578 Vali Acc: 0.839 Test Loss: 0.578 Test Acc: 0.839
Validation loss decreased (-0.811105 --> -0.838883).  Saving model ...
Epoch: 16 cost time: 0.9932923316955566
Epoch: 16, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.549 Vali Acc: 0.844 Test Loss: 0.549 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 17 cost time: 1.0097615718841553
Epoch: 17, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.551 Vali Acc: 0.833 Test Loss: 0.551 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.122056007385254
Epoch: 18, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861106).  Saving model ...
Epoch: 19 cost time: 1.0023212432861328
Epoch: 19, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0564978122711182
Epoch: 20, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0611038208007812
Epoch: 21, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1716821193695068
Epoch: 22, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2150216102600098
Epoch: 23, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.525 Vali Acc: 0.872 Test Loss: 0.525 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 24 cost time: 1.145667552947998
Epoch: 24, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.521 Vali Acc: 0.867 Test Loss: 0.521 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1479575634002686
Epoch: 25, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.539 Vali Acc: 0.861 Test Loss: 0.539 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1010792255401611
Epoch: 26, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.570 Vali Acc: 0.867 Test Loss: 0.570 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1450729370117188
Epoch: 27, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.557 Vali Acc: 0.878 Test Loss: 0.557 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 28 cost time: 1.0910840034484863
Epoch: 28, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.566 Vali Acc: 0.861 Test Loss: 0.566 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.073488712310791
Epoch: 29, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.584 Vali Acc: 0.861 Test Loss: 0.584 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.237595796585083
Epoch: 30, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.583 Vali Acc: 0.867 Test Loss: 0.583 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2068185806274414
Epoch: 31, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.605 Vali Acc: 0.883 Test Loss: 0.605 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 32 cost time: 0.9925563335418701
Epoch: 32, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.606 Vali Acc: 0.856 Test Loss: 0.606 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.036038875579834
Epoch: 33, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.606 Vali Acc: 0.867 Test Loss: 0.606 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0442335605621338
Epoch: 34, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.621 Vali Acc: 0.867 Test Loss: 0.621 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0647563934326172
Epoch: 35, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.611 Vali Acc: 0.867 Test Loss: 0.611 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.152364730834961
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.608 Vali Acc: 0.872 Test Loss: 0.608 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.206360101699829
Epoch: 37, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.635 Vali Acc: 0.878 Test Loss: 0.635 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.1641442775726318
Epoch: 38, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.623 Vali Acc: 0.867 Test Loss: 0.623 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.1690518856048584
Epoch: 39, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.616 Vali Acc: 0.872 Test Loss: 0.616 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.1654586791992188
Epoch: 40, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.617 Vali Acc: 0.872 Test Loss: 0.617 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.1264538764953613
Epoch: 41, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.607 Vali Acc: 0.878 Test Loss: 0.607 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 447119
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.417278528213501
Epoch: 1, Steps: 12 | Train Loss: 2.685 Vali Loss: 2.622 Vali Acc: 0.161 Test Loss: 2.622 Test Acc: 0.161
Validation loss decreased (inf --> -0.161085).  Saving model ...
Epoch: 2 cost time: 0.9333088397979736
Epoch: 2, Steps: 12 | Train Loss: 2.406 Vali Loss: 2.341 Vali Acc: 0.383 Test Loss: 2.341 Test Acc: 0.383
Validation loss decreased (-0.161085 --> -0.383310).  Saving model ...
Epoch: 3 cost time: 0.9082019329071045
Epoch: 3, Steps: 12 | Train Loss: 2.011 Vali Loss: 1.993 Vali Acc: 0.511 Test Loss: 1.993 Test Acc: 0.511
Validation loss decreased (-0.383310 --> -0.511091).  Saving model ...
Epoch: 4 cost time: 0.9571235179901123
Epoch: 4, Steps: 12 | Train Loss: 1.584 Vali Loss: 1.565 Vali Acc: 0.622 Test Loss: 1.565 Test Acc: 0.622
Validation loss decreased (-0.511091 --> -0.622207).  Saving model ...
Epoch: 5 cost time: 0.9455313682556152
Epoch: 5, Steps: 12 | Train Loss: 1.197 Vali Loss: 1.267 Vali Acc: 0.650 Test Loss: 1.267 Test Acc: 0.650
Validation loss decreased (-0.622207 --> -0.649987).  Saving model ...
Epoch: 6 cost time: 0.9659240245819092
Epoch: 6, Steps: 12 | Train Loss: 0.989 Vali Loss: 1.070 Vali Acc: 0.667 Test Loss: 1.070 Test Acc: 0.667
Validation loss decreased (-0.649987 --> -0.666656).  Saving model ...
Epoch: 7 cost time: 1.0557143688201904
Epoch: 7, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.972 Vali Acc: 0.689 Test Loss: 0.972 Test Acc: 0.689
Validation loss decreased (-0.666656 --> -0.688879).  Saving model ...
Epoch: 8 cost time: 0.9031774997711182
Epoch: 8, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.893 Vali Acc: 0.711 Test Loss: 0.893 Test Acc: 0.711
Validation loss decreased (-0.688879 --> -0.711102).  Saving model ...
Epoch: 9 cost time: 1.0684618949890137
Epoch: 9, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.856 Vali Acc: 0.728 Test Loss: 0.856 Test Acc: 0.728
Validation loss decreased (-0.711102 --> -0.727769).  Saving model ...
Epoch: 10 cost time: 1.038661241531372
Epoch: 10, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.808 Vali Acc: 0.739 Test Loss: 0.808 Test Acc: 0.739
Validation loss decreased (-0.727769 --> -0.738881).  Saving model ...
Epoch: 11 cost time: 1.048945426940918
Epoch: 11, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.821 Vali Acc: 0.756 Test Loss: 0.821 Test Acc: 0.756
Validation loss decreased (-0.738881 --> -0.755547).  Saving model ...
Epoch: 12 cost time: 1.0614027976989746
Epoch: 12, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.749 Vali Acc: 0.778 Test Loss: 0.749 Test Acc: 0.778
Validation loss decreased (-0.755547 --> -0.777770).  Saving model ...
Epoch: 13 cost time: 0.9069187641143799
Epoch: 13, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.789 Vali Acc: 0.794 Test Loss: 0.789 Test Acc: 0.794
Validation loss decreased (-0.777770 --> -0.794437).  Saving model ...
Epoch: 14 cost time: 0.9677824974060059
Epoch: 14, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.823 Vali Acc: 0.778 Test Loss: 0.823 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8902668952941895
Epoch: 15, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.757 Vali Acc: 0.800 Test Loss: 0.757 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799992).  Saving model ...
Epoch: 16 cost time: 0.9059417247772217
Epoch: 16, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.781 Vali Acc: 0.789 Test Loss: 0.781 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9375653266906738
Epoch: 17, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.776 Vali Acc: 0.822 Test Loss: 0.776 Test Acc: 0.822
Validation loss decreased (-0.799992 --> -0.822214).  Saving model ...
Epoch: 18 cost time: 1.1171998977661133
Epoch: 18, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.767 Vali Acc: 0.839 Test Loss: 0.767 Test Acc: 0.839
Validation loss decreased (-0.822214 --> -0.838881).  Saving model ...
Epoch: 19 cost time: 1.0690326690673828
Epoch: 19, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.771 Vali Acc: 0.839 Test Loss: 0.771 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8927717208862305
Epoch: 20, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.827 Vali Acc: 0.833 Test Loss: 0.827 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.086791753768921
Epoch: 21, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.810 Vali Acc: 0.822 Test Loss: 0.810 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9366440773010254
Epoch: 22, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.866 Vali Acc: 0.833 Test Loss: 0.866 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9681746959686279
Epoch: 23, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.873 Vali Acc: 0.844 Test Loss: 0.873 Test Acc: 0.844
Validation loss decreased (-0.838881 --> -0.844436).  Saving model ...
Epoch: 24 cost time: 1.0156898498535156
Epoch: 24, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.895 Vali Acc: 0.844 Test Loss: 0.895 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9757719039916992
Epoch: 25, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.038 Vali Acc: 0.828 Test Loss: 1.038 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.014355182647705
Epoch: 26, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.964 Vali Acc: 0.778 Test Loss: 0.964 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.004070520401001
Epoch: 27, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.013 Vali Acc: 0.822 Test Loss: 1.013 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0226943492889404
Epoch: 28, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.019 Vali Acc: 0.839 Test Loss: 1.019 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0490293502807617
Epoch: 29, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.096 Vali Acc: 0.806 Test Loss: 1.096 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.031653881072998
Epoch: 30, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.145 Vali Acc: 0.811 Test Loss: 1.145 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0575249195098877
Epoch: 31, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.980 Vali Acc: 0.822 Test Loss: 0.980 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0086827278137207
Epoch: 32, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.948 Vali Acc: 0.833 Test Loss: 0.948 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0079290866851807
Epoch: 33, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.993 Vali Acc: 0.850 Test Loss: 0.993 Test Acc: 0.850
Validation loss decreased (-0.844436 --> -0.849990).  Saving model ...
Epoch: 34 cost time: 0.9770824909210205
Epoch: 34, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.968 Vali Acc: 0.839 Test Loss: 0.968 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0063648223876953
Epoch: 35, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.989 Vali Acc: 0.839 Test Loss: 0.989 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9652793407440186
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.111 Vali Acc: 0.828 Test Loss: 1.111 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0063014030456543
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.011 Vali Acc: 0.856 Test Loss: 1.011 Test Acc: 0.856
Validation loss decreased (-0.849990 --> -0.855545).  Saving model ...
Epoch: 38 cost time: 1.0235192775726318
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.019 Vali Acc: 0.833 Test Loss: 1.019 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9547255039215088
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.132 Vali Acc: 0.822 Test Loss: 1.132 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.030235767364502
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.043 Vali Acc: 0.833 Test Loss: 1.043 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9880690574645996
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.072 Vali Acc: 0.833 Test Loss: 1.072 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.1052978038787842
Epoch: 42, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.054 Vali Acc: 0.817 Test Loss: 1.054 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.002340316772461
Epoch: 43, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.184 Vali Acc: 0.822 Test Loss: 1.184 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.0242884159088135
Epoch: 44, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.120 Vali Acc: 0.850 Test Loss: 1.120 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.047245740890503
Epoch: 45, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.071 Vali Acc: 0.850 Test Loss: 1.071 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.035651683807373
Epoch: 46, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.152 Vali Acc: 0.839 Test Loss: 1.152 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.9593231678009033
Epoch: 47, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.305 Vali Acc: 0.839 Test Loss: 1.305 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 197583
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2456653118133545
Epoch: 1, Steps: 12 | Train Loss: 2.649 Vali Loss: 2.614 Vali Acc: 0.167 Test Loss: 2.614 Test Acc: 0.167
Validation loss decreased (inf --> -0.166641).  Saving model ...
Epoch: 2 cost time: 0.7820816040039062
Epoch: 2, Steps: 12 | Train Loss: 2.499 Vali Loss: 2.460 Vali Acc: 0.322 Test Loss: 2.460 Test Acc: 0.322
Validation loss decreased (-0.166641 --> -0.322198).  Saving model ...
Epoch: 3 cost time: 0.8370323181152344
Epoch: 3, Steps: 12 | Train Loss: 2.272 Vali Loss: 2.233 Vali Acc: 0.467 Test Loss: 2.233 Test Acc: 0.467
Validation loss decreased (-0.322198 --> -0.466644).  Saving model ...
Epoch: 4 cost time: 0.8409078121185303
Epoch: 4, Steps: 12 | Train Loss: 2.008 Vali Loss: 1.935 Vali Acc: 0.572 Test Loss: 1.935 Test Acc: 0.572
Validation loss decreased (-0.466644 --> -0.572203).  Saving model ...
Epoch: 5 cost time: 0.9233872890472412
Epoch: 5, Steps: 12 | Train Loss: 1.687 Vali Loss: 1.661 Vali Acc: 0.594 Test Loss: 1.661 Test Acc: 0.594
Validation loss decreased (-0.572203 --> -0.594428).  Saving model ...
Epoch: 6 cost time: 0.9050462245941162
Epoch: 6, Steps: 12 | Train Loss: 1.368 Vali Loss: 1.409 Vali Acc: 0.622 Test Loss: 1.409 Test Acc: 0.622
Validation loss decreased (-0.594428 --> -0.622208).  Saving model ...
Epoch: 7 cost time: 0.9282054901123047
Epoch: 7, Steps: 12 | Train Loss: 1.120 Vali Loss: 1.236 Vali Acc: 0.633 Test Loss: 1.236 Test Acc: 0.633
Validation loss decreased (-0.622208 --> -0.633321).  Saving model ...
Epoch: 8 cost time: 0.936575174331665
Epoch: 8, Steps: 12 | Train Loss: 0.936 Vali Loss: 1.119 Vali Acc: 0.672 Test Loss: 1.119 Test Acc: 0.672
Validation loss decreased (-0.633321 --> -0.672211).  Saving model ...
Epoch: 9 cost time: 0.8813581466674805
Epoch: 9, Steps: 12 | Train Loss: 0.799 Vali Loss: 1.041 Vali Acc: 0.672 Test Loss: 1.041 Test Acc: 0.672
Validation loss decreased (-0.672211 --> -0.672212).  Saving model ...
Epoch: 10 cost time: 0.9288971424102783
Epoch: 10, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.955 Vali Acc: 0.683 Test Loss: 0.955 Test Acc: 0.683
Validation loss decreased (-0.672212 --> -0.683324).  Saving model ...
Epoch: 11 cost time: 0.8821060657501221
Epoch: 11, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.907 Vali Acc: 0.700 Test Loss: 0.907 Test Acc: 0.700
Validation loss decreased (-0.683324 --> -0.699991).  Saving model ...
Epoch: 12 cost time: 0.9198048114776611
Epoch: 12, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.882 Vali Acc: 0.717 Test Loss: 0.882 Test Acc: 0.717
Validation loss decreased (-0.699991 --> -0.716658).  Saving model ...
Epoch: 13 cost time: 0.9503488540649414
Epoch: 13, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.833 Vali Acc: 0.733 Test Loss: 0.833 Test Acc: 0.733
Validation loss decreased (-0.716658 --> -0.733325).  Saving model ...
Epoch: 14 cost time: 0.9469001293182373
Epoch: 14, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.807 Vali Acc: 0.778 Test Loss: 0.807 Test Acc: 0.778
Validation loss decreased (-0.733325 --> -0.777770).  Saving model ...
Epoch: 15 cost time: 0.9298202991485596
Epoch: 15, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.810 Vali Acc: 0.750 Test Loss: 0.810 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.944000244140625
Epoch: 16, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.762 Vali Acc: 0.778 Test Loss: 0.762 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777770).  Saving model ...
Epoch: 17 cost time: 0.9124705791473389
Epoch: 17, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.739 Vali Acc: 0.800 Test Loss: 0.739 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799993).  Saving model ...
Epoch: 18 cost time: 0.9414117336273193
Epoch: 18, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.781 Vali Acc: 0.789 Test Loss: 0.781 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9304351806640625
Epoch: 19, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.704 Vali Acc: 0.806 Test Loss: 0.704 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 20 cost time: 0.9160735607147217
Epoch: 20, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.748 Vali Acc: 0.811 Test Loss: 0.748 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811104).  Saving model ...
Epoch: 21 cost time: 0.9683425426483154
Epoch: 21, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.738 Vali Acc: 0.828 Test Loss: 0.738 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827770).  Saving model ...
Epoch: 22 cost time: 0.9545526504516602
Epoch: 22, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.734 Vali Acc: 0.828 Test Loss: 0.734 Test Acc: 0.828
Validation loss decreased (-0.827770 --> -0.827770).  Saving model ...
Epoch: 23 cost time: 0.9365592002868652
Epoch: 23, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.703 Vali Acc: 0.817 Test Loss: 0.703 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9124484062194824
Epoch: 24, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.716 Vali Acc: 0.844 Test Loss: 0.716 Test Acc: 0.844
Validation loss decreased (-0.827770 --> -0.844437).  Saving model ...
Epoch: 25 cost time: 0.9255597591400146
Epoch: 25, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.690 Vali Acc: 0.833 Test Loss: 0.690 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9634902477264404
Epoch: 26, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.736 Vali Acc: 0.828 Test Loss: 0.736 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9131405353546143
Epoch: 27, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.716 Vali Acc: 0.856 Test Loss: 0.716 Test Acc: 0.856
Validation loss decreased (-0.844437 --> -0.855548).  Saving model ...
Epoch: 28 cost time: 0.9291925430297852
Epoch: 28, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.679 Vali Acc: 0.828 Test Loss: 0.679 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9181466102600098
Epoch: 29, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.749 Vali Acc: 0.839 Test Loss: 0.749 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9487090110778809
Epoch: 30, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.717 Vali Acc: 0.822 Test Loss: 0.717 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9700844287872314
Epoch: 31, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.728 Vali Acc: 0.844 Test Loss: 0.728 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9263336658477783
Epoch: 32, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.744 Vali Acc: 0.861 Test Loss: 0.744 Test Acc: 0.861
Validation loss decreased (-0.855548 --> -0.861104).  Saving model ...
Epoch: 33 cost time: 0.9445688724517822
Epoch: 33, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.766 Vali Acc: 0.833 Test Loss: 0.766 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9317529201507568
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.801 Vali Acc: 0.861 Test Loss: 0.801 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9223365783691406
Epoch: 35, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.764 Vali Acc: 0.856 Test Loss: 0.764 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9430544376373291
Epoch: 36, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.763 Vali Acc: 0.844 Test Loss: 0.763 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9449577331542969
Epoch: 37, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.799 Vali Acc: 0.856 Test Loss: 0.799 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9534730911254883
Epoch: 38, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.813 Vali Acc: 0.856 Test Loss: 0.813 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9822366237640381
Epoch: 39, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.816 Vali Acc: 0.833 Test Loss: 0.816 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9037699699401855
Epoch: 40, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.866 Vali Acc: 0.856 Test Loss: 0.866 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9093174934387207
Epoch: 41, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.842 Vali Acc: 0.861 Test Loss: 0.842 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.8443145751953125
Epoch: 42, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.859 Vali Acc: 0.844 Test Loss: 0.859 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 151567
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4180891513824463
Epoch: 1, Steps: 12 | Train Loss: 2.685 Vali Loss: 2.656 Vali Acc: 0.106 Test Loss: 2.656 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 0.9222571849822998
Epoch: 2, Steps: 12 | Train Loss: 2.558 Vali Loss: 2.523 Vali Acc: 0.278 Test Loss: 2.523 Test Acc: 0.278
Validation loss decreased (-0.105529 --> -0.277753).  Saving model ...
Epoch: 3 cost time: 0.9511129856109619
Epoch: 3, Steps: 12 | Train Loss: 2.358 Vali Loss: 2.318 Vali Acc: 0.478 Test Loss: 2.318 Test Acc: 0.478
Validation loss decreased (-0.277753 --> -0.477755).  Saving model ...
Epoch: 4 cost time: 0.8836109638214111
Epoch: 4, Steps: 12 | Train Loss: 2.111 Vali Loss: 2.057 Vali Acc: 0.611 Test Loss: 2.057 Test Acc: 0.611
Validation loss decreased (-0.477755 --> -0.611091).  Saving model ...
Epoch: 5 cost time: 0.9402050971984863
Epoch: 5, Steps: 12 | Train Loss: 1.731 Vali Loss: 1.769 Vali Acc: 0.617 Test Loss: 1.769 Test Acc: 0.617
Validation loss decreased (-0.611091 --> -0.616649).  Saving model ...
Epoch: 6 cost time: 0.9292550086975098
Epoch: 6, Steps: 12 | Train Loss: 1.453 Vali Loss: 1.499 Vali Acc: 0.656 Test Loss: 1.499 Test Acc: 0.656
Validation loss decreased (-0.616649 --> -0.655541).  Saving model ...
Epoch: 7 cost time: 0.935469388961792
Epoch: 7, Steps: 12 | Train Loss: 1.171 Vali Loss: 1.291 Vali Acc: 0.678 Test Loss: 1.291 Test Acc: 0.678
Validation loss decreased (-0.655541 --> -0.677765).  Saving model ...
Epoch: 8 cost time: 0.9212276935577393
Epoch: 8, Steps: 12 | Train Loss: 0.954 Vali Loss: 1.146 Vali Acc: 0.683 Test Loss: 1.146 Test Acc: 0.683
Validation loss decreased (-0.677765 --> -0.683322).  Saving model ...
Epoch: 9 cost time: 0.8936986923217773
Epoch: 9, Steps: 12 | Train Loss: 0.822 Vali Loss: 1.009 Vali Acc: 0.711 Test Loss: 1.009 Test Acc: 0.711
Validation loss decreased (-0.683322 --> -0.711101).  Saving model ...
Epoch: 10 cost time: 0.8797626495361328
Epoch: 10, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.957 Vali Acc: 0.722 Test Loss: 0.957 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722213).  Saving model ...
Epoch: 11 cost time: 0.9189181327819824
Epoch: 11, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.866 Vali Acc: 0.750 Test Loss: 0.866 Test Acc: 0.750
Validation loss decreased (-0.722213 --> -0.749991).  Saving model ...
Epoch: 12 cost time: 0.9615650177001953
Epoch: 12, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.780 Vali Acc: 0.783 Test Loss: 0.780 Test Acc: 0.783
Validation loss decreased (-0.749991 --> -0.783326).  Saving model ...
Epoch: 13 cost time: 1.0235795974731445
Epoch: 13, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.731 Vali Acc: 0.794 Test Loss: 0.731 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794437).  Saving model ...
Epoch: 14 cost time: 0.9674394130706787
Epoch: 14, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.732 Vali Acc: 0.778 Test Loss: 0.732 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8844666481018066
Epoch: 15, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.676 Vali Acc: 0.794 Test Loss: 0.676 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794438).  Saving model ...
Epoch: 16 cost time: 0.869981050491333
Epoch: 16, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.635 Vali Acc: 0.828 Test Loss: 0.635 Test Acc: 0.828
Validation loss decreased (-0.794438 --> -0.827771).  Saving model ...
Epoch: 17 cost time: 0.8725605010986328
Epoch: 17, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.610 Vali Acc: 0.806 Test Loss: 0.610 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9740006923675537
Epoch: 18, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.625 Vali Acc: 0.839 Test Loss: 0.625 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838883).  Saving model ...
Epoch: 19 cost time: 0.8182857036590576
Epoch: 19, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.600 Vali Acc: 0.844 Test Loss: 0.600 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 20 cost time: 0.8526642322540283
Epoch: 20, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.577 Vali Acc: 0.833 Test Loss: 0.577 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9212596416473389
Epoch: 21, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844439).  Saving model ...
Epoch: 22 cost time: 0.9185395240783691
Epoch: 22, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.540 Vali Acc: 0.856 Test Loss: 0.540 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 23 cost time: 0.906198263168335
Epoch: 23, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.562 Vali Acc: 0.839 Test Loss: 0.562 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9295825958251953
Epoch: 24, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.574 Vali Acc: 0.839 Test Loss: 0.574 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9373538494110107
Epoch: 25, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.605 Vali Acc: 0.850 Test Loss: 0.605 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9423389434814453
Epoch: 26, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.609 Vali Acc: 0.861 Test Loss: 0.609 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 27 cost time: 0.9618008136749268
Epoch: 27, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.581 Vali Acc: 0.872 Test Loss: 0.581 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 28 cost time: 0.9159104824066162
Epoch: 28, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9498863220214844
Epoch: 29, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.664 Vali Acc: 0.861 Test Loss: 0.664 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9144222736358643
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.666 Vali Acc: 0.867 Test Loss: 0.666 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0159564018249512
Epoch: 31, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.680 Vali Acc: 0.850 Test Loss: 0.680 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9144973754882812
Epoch: 32, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.713 Vali Acc: 0.850 Test Loss: 0.713 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9402377605438232
Epoch: 33, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.697 Vali Acc: 0.839 Test Loss: 0.697 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9135076999664307
Epoch: 34, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.698 Vali Acc: 0.861 Test Loss: 0.698 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8752081394195557
Epoch: 35, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.752 Vali Acc: 0.861 Test Loss: 0.752 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8661363124847412
Epoch: 36, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.720 Vali Acc: 0.856 Test Loss: 0.720 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.8953771591186523
Epoch: 37, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.727 Vali Acc: 0.856 Test Loss: 0.727 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 151631
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.150550603866577
Epoch: 1, Steps: 12 | Train Loss: 2.727 Vali Loss: 2.693 Vali Acc: 0.139 Test Loss: 2.693 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 0.9269790649414062
Epoch: 2, Steps: 12 | Train Loss: 2.601 Vali Loss: 2.586 Vali Acc: 0.222 Test Loss: 2.586 Test Acc: 0.222
Validation loss decreased (-0.138862 --> -0.222196).  Saving model ...
Epoch: 3 cost time: 0.9464452266693115
Epoch: 3, Steps: 12 | Train Loss: 2.452 Vali Loss: 2.415 Vali Acc: 0.372 Test Loss: 2.415 Test Acc: 0.372
Validation loss decreased (-0.222196 --> -0.372198).  Saving model ...
Epoch: 4 cost time: 0.9280478954315186
Epoch: 4, Steps: 12 | Train Loss: 2.195 Vali Loss: 2.184 Vali Acc: 0.489 Test Loss: 2.184 Test Acc: 0.489
Validation loss decreased (-0.372198 --> -0.488867).  Saving model ...
Epoch: 5 cost time: 0.9554352760314941
Epoch: 5, Steps: 12 | Train Loss: 1.957 Vali Loss: 1.897 Vali Acc: 0.561 Test Loss: 1.897 Test Acc: 0.561
Validation loss decreased (-0.488867 --> -0.561092).  Saving model ...
Epoch: 6 cost time: 0.8802337646484375
Epoch: 6, Steps: 12 | Train Loss: 1.642 Vali Loss: 1.638 Vali Acc: 0.583 Test Loss: 1.638 Test Acc: 0.583
Validation loss decreased (-0.561092 --> -0.583317).  Saving model ...
Epoch: 7 cost time: 0.8858146667480469
Epoch: 7, Steps: 12 | Train Loss: 1.414 Vali Loss: 1.413 Vali Acc: 0.656 Test Loss: 1.413 Test Acc: 0.656
Validation loss decreased (-0.583317 --> -0.655541).  Saving model ...
Epoch: 8 cost time: 0.9002676010131836
Epoch: 8, Steps: 12 | Train Loss: 1.127 Vali Loss: 1.214 Vali Acc: 0.650 Test Loss: 1.214 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9363374710083008
Epoch: 9, Steps: 12 | Train Loss: 0.949 Vali Loss: 1.095 Vali Acc: 0.656 Test Loss: 1.095 Test Acc: 0.656
Validation loss decreased (-0.655541 --> -0.655545).  Saving model ...
Epoch: 10 cost time: 0.8778707981109619
Epoch: 10, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.996 Vali Acc: 0.694 Test Loss: 0.996 Test Acc: 0.694
Validation loss decreased (-0.655545 --> -0.694434).  Saving model ...
Epoch: 11 cost time: 0.8976378440856934
Epoch: 11, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.932 Vali Acc: 0.700 Test Loss: 0.932 Test Acc: 0.700
Validation loss decreased (-0.694434 --> -0.699991).  Saving model ...
Epoch: 12 cost time: 0.8815138339996338
Epoch: 12, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.870 Vali Acc: 0.711 Test Loss: 0.870 Test Acc: 0.711
Validation loss decreased (-0.699991 --> -0.711102).  Saving model ...
Epoch: 13 cost time: 0.8572559356689453
Epoch: 13, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.798 Vali Acc: 0.761 Test Loss: 0.798 Test Acc: 0.761
Validation loss decreased (-0.711102 --> -0.761103).  Saving model ...
Epoch: 14 cost time: 0.8206620216369629
Epoch: 14, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.745 Vali Acc: 0.767 Test Loss: 0.745 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766659).  Saving model ...
Epoch: 15 cost time: 0.8264176845550537
Epoch: 15, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.733 Vali Acc: 0.783 Test Loss: 0.733 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783326).  Saving model ...
Epoch: 16 cost time: 0.8269588947296143
Epoch: 16, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.704 Vali Acc: 0.806 Test Loss: 0.704 Test Acc: 0.806
Validation loss decreased (-0.783326 --> -0.805549).  Saving model ...
Epoch: 17 cost time: 0.8266282081604004
Epoch: 17, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.652 Vali Acc: 0.828 Test Loss: 0.652 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827771).  Saving model ...
Epoch: 18 cost time: 0.7989208698272705
Epoch: 18, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.656 Vali Acc: 0.806 Test Loss: 0.656 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8795566558837891
Epoch: 19, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.645 Vali Acc: 0.839 Test Loss: 0.645 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 20 cost time: 0.9443662166595459
Epoch: 20, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.616 Vali Acc: 0.828 Test Loss: 0.616 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8939099311828613
Epoch: 21, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 22 cost time: 0.8410501480102539
Epoch: 22, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.649 Vali Acc: 0.850 Test Loss: 0.649 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9177892208099365
Epoch: 23, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.634 Vali Acc: 0.850 Test Loss: 0.634 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.879951000213623
Epoch: 24, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.633 Vali Acc: 0.850 Test Loss: 0.633 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.902616024017334
Epoch: 25, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.613 Vali Acc: 0.828 Test Loss: 0.613 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8527915477752686
Epoch: 26, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.667 Vali Acc: 0.839 Test Loss: 0.667 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9184567928314209
Epoch: 27, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.628 Vali Acc: 0.839 Test Loss: 0.628 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9659559726715088
Epoch: 28, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.652 Vali Acc: 0.839 Test Loss: 0.652 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9106061458587646
Epoch: 29, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.684 Vali Acc: 0.861 Test Loss: 0.684 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861104).  Saving model ...
Epoch: 30 cost time: 0.8879480361938477
Epoch: 30, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.683 Vali Acc: 0.856 Test Loss: 0.683 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8881678581237793
Epoch: 31, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.664 Vali Acc: 0.839 Test Loss: 0.664 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8964712619781494
Epoch: 32, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.672 Vali Acc: 0.856 Test Loss: 0.672 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9102084636688232
Epoch: 33, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.665 Vali Acc: 0.878 Test Loss: 0.665 Test Acc: 0.878
Validation loss decreased (-0.861104 --> -0.877771).  Saving model ...
Epoch: 34 cost time: 0.8355026245117188
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.664 Vali Acc: 0.861 Test Loss: 0.664 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8582112789154053
Epoch: 35, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.711 Vali Acc: 0.833 Test Loss: 0.711 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.877861738204956
Epoch: 36, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.714 Vali Acc: 0.839 Test Loss: 0.714 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8661627769470215
Epoch: 37, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.716 Vali Acc: 0.850 Test Loss: 0.716 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8262972831726074
Epoch: 38, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.704 Vali Acc: 0.856 Test Loss: 0.704 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9145016670227051
Epoch: 39, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.731 Vali Acc: 0.861 Test Loss: 0.731 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.8766453266143799
Epoch: 40, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.748 Vali Acc: 0.872 Test Loss: 0.748 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.908313512802124
Epoch: 41, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.747 Vali Acc: 0.878 Test Loss: 0.747 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.8702526092529297
Epoch: 42, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.755 Vali Acc: 0.878 Test Loss: 0.755 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.9350135326385498
Epoch: 43, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.762 Vali Acc: 0.867 Test Loss: 0.762 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 140175
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0027477741241455
Epoch: 1, Steps: 12 | Train Loss: 2.679 Vali Loss: 2.693 Vali Acc: 0.056 Test Loss: 2.693 Test Acc: 0.056
Validation loss decreased (inf --> -0.055529).  Saving model ...
Epoch: 2 cost time: 0.8654613494873047
Epoch: 2, Steps: 12 | Train Loss: 2.605 Vali Loss: 2.606 Vali Acc: 0.133 Test Loss: 2.606 Test Acc: 0.133
Validation loss decreased (-0.055529 --> -0.133307).  Saving model ...
Epoch: 3 cost time: 0.9054272174835205
Epoch: 3, Steps: 12 | Train Loss: 2.464 Vali Loss: 2.456 Vali Acc: 0.367 Test Loss: 2.456 Test Acc: 0.367
Validation loss decreased (-0.133307 --> -0.366642).  Saving model ...
Epoch: 4 cost time: 0.9012465476989746
Epoch: 4, Steps: 12 | Train Loss: 2.280 Vali Loss: 2.267 Vali Acc: 0.456 Test Loss: 2.267 Test Acc: 0.456
Validation loss decreased (-0.366642 --> -0.455533).  Saving model ...
Epoch: 5 cost time: 0.8546538352966309
Epoch: 5, Steps: 12 | Train Loss: 2.040 Vali Loss: 2.043 Vali Acc: 0.506 Test Loss: 2.043 Test Acc: 0.506
Validation loss decreased (-0.455533 --> -0.505535).  Saving model ...
Epoch: 6 cost time: 0.8895974159240723
Epoch: 6, Steps: 12 | Train Loss: 1.811 Vali Loss: 1.829 Vali Acc: 0.539 Test Loss: 1.829 Test Acc: 0.539
Validation loss decreased (-0.505535 --> -0.538871).  Saving model ...
Epoch: 7 cost time: 0.8202431201934814
Epoch: 7, Steps: 12 | Train Loss: 1.557 Vali Loss: 1.602 Vali Acc: 0.600 Test Loss: 1.602 Test Acc: 0.600
Validation loss decreased (-0.538871 --> -0.599984).  Saving model ...
Epoch: 8 cost time: 0.8816647529602051
Epoch: 8, Steps: 12 | Train Loss: 1.333 Vali Loss: 1.409 Vali Acc: 0.633 Test Loss: 1.409 Test Acc: 0.633
Validation loss decreased (-0.599984 --> -0.633319).  Saving model ...
Epoch: 9 cost time: 0.8828368186950684
Epoch: 9, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.261 Vali Acc: 0.678 Test Loss: 1.261 Test Acc: 0.678
Validation loss decreased (-0.633319 --> -0.677765).  Saving model ...
Epoch: 10 cost time: 0.8333263397216797
Epoch: 10, Steps: 12 | Train Loss: 0.938 Vali Loss: 1.152 Vali Acc: 0.678 Test Loss: 1.152 Test Acc: 0.678
Validation loss decreased (-0.677765 --> -0.677766).  Saving model ...
Epoch: 11 cost time: 0.8312637805938721
Epoch: 11, Steps: 12 | Train Loss: 0.805 Vali Loss: 1.056 Vali Acc: 0.689 Test Loss: 1.056 Test Acc: 0.689
Validation loss decreased (-0.677766 --> -0.688878).  Saving model ...
Epoch: 12 cost time: 0.905402660369873
Epoch: 12, Steps: 12 | Train Loss: 0.711 Vali Loss: 0.967 Vali Acc: 0.722 Test Loss: 0.967 Test Acc: 0.722
Validation loss decreased (-0.688878 --> -0.722213).  Saving model ...
Epoch: 13 cost time: 0.8746707439422607
Epoch: 13, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.896 Vali Acc: 0.733 Test Loss: 0.896 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 14 cost time: 0.8499689102172852
Epoch: 14, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.846 Vali Acc: 0.756 Test Loss: 0.846 Test Acc: 0.756
Validation loss decreased (-0.733324 --> -0.755547).  Saving model ...
Epoch: 15 cost time: 0.8898191452026367
Epoch: 15, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.772 Vali Acc: 0.767 Test Loss: 0.772 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766659).  Saving model ...
Epoch: 16 cost time: 0.8428223133087158
Epoch: 16, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.723 Vali Acc: 0.789 Test Loss: 0.723 Test Acc: 0.789
Validation loss decreased (-0.766659 --> -0.788882).  Saving model ...
Epoch: 17 cost time: 0.880169153213501
Epoch: 17, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.711 Vali Acc: 0.794 Test Loss: 0.711 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794437).  Saving model ...
Epoch: 18 cost time: 0.8285114765167236
Epoch: 18, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.698 Vali Acc: 0.800 Test Loss: 0.698 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 0.8936214447021484
Epoch: 19, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.657 Vali Acc: 0.817 Test Loss: 0.657 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816660).  Saving model ...
Epoch: 20 cost time: 0.91033935546875
Epoch: 20, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.640 Vali Acc: 0.833 Test Loss: 0.640 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 21 cost time: 0.8620259761810303
Epoch: 21, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.620 Vali Acc: 0.817 Test Loss: 0.620 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.857032299041748
Epoch: 22, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.621 Vali Acc: 0.833 Test Loss: 0.621 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 23 cost time: 0.8800392150878906
Epoch: 23, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.625 Vali Acc: 0.839 Test Loss: 0.625 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 24 cost time: 0.8615553379058838
Epoch: 24, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 0.8894116878509521
Epoch: 25, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.626 Vali Acc: 0.856 Test Loss: 0.626 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 26 cost time: 0.9386024475097656
Epoch: 26, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.595 Vali Acc: 0.844 Test Loss: 0.595 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8976953029632568
Epoch: 27, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.611 Vali Acc: 0.844 Test Loss: 0.611 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8622210025787354
Epoch: 28, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8380687236785889
Epoch: 29, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.587 Vali Acc: 0.850 Test Loss: 0.587 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8668961524963379
Epoch: 30, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.610 Vali Acc: 0.850 Test Loss: 0.610 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.856048583984375
Epoch: 31, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8340530395507812
Epoch: 32, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.626 Vali Acc: 0.861 Test Loss: 0.626 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 33 cost time: 0.8870704174041748
Epoch: 33, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.612 Vali Acc: 0.850 Test Loss: 0.612 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9126360416412354
Epoch: 34, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.679 Vali Acc: 0.861 Test Loss: 0.679 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9712967872619629
Epoch: 35, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.642 Vali Acc: 0.856 Test Loss: 0.642 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.898777961730957
Epoch: 36, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.608 Vali Acc: 0.867 Test Loss: 0.608 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 37 cost time: 0.8429381847381592
Epoch: 37, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.625 Vali Acc: 0.867 Test Loss: 0.625 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9107520580291748
Epoch: 38, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.632 Vali Acc: 0.861 Test Loss: 0.632 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8853487968444824
Epoch: 39, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.641 Vali Acc: 0.872 Test Loss: 0.641 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 40 cost time: 0.9020507335662842
Epoch: 40, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.646 Vali Acc: 0.872 Test Loss: 0.646 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8970305919647217
Epoch: 41, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.658 Vali Acc: 0.861 Test Loss: 0.658 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9428303241729736
Epoch: 42, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.652 Vali Acc: 0.883 Test Loss: 0.652 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883327).  Saving model ...
Epoch: 43 cost time: 0.8888809680938721
Epoch: 43, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.685 Vali Acc: 0.878 Test Loss: 0.685 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9128329753875732
Epoch: 44, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.678 Vali Acc: 0.872 Test Loss: 0.678 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8164989948272705
Epoch: 45, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.649 Vali Acc: 0.878 Test Loss: 0.649 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8761587142944336
Epoch: 46, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.664 Vali Acc: 0.872 Test Loss: 0.664 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8643760681152344
Epoch: 47, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.669 Vali Acc: 0.872 Test Loss: 0.669 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.8539342880249023
Epoch: 48, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.686 Vali Acc: 0.867 Test Loss: 0.686 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.8375883102416992
Epoch: 49, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.691 Vali Acc: 0.867 Test Loss: 0.691 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.9089891910552979
Epoch: 50, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.729 Vali Acc: 0.878 Test Loss: 0.729 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 132623
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.187262535095215
Epoch: 1, Steps: 12 | Train Loss: 2.749 Vali Loss: 2.710 Vali Acc: 0.122 Test Loss: 2.710 Test Acc: 0.122
Validation loss decreased (inf --> -0.122195).  Saving model ...
Epoch: 2 cost time: 0.8952507972717285
Epoch: 2, Steps: 12 | Train Loss: 2.653 Vali Loss: 2.634 Vali Acc: 0.211 Test Loss: 2.634 Test Acc: 0.211
Validation loss decreased (-0.122195 --> -0.211085).  Saving model ...
Epoch: 3 cost time: 0.8814692497253418
Epoch: 3, Steps: 12 | Train Loss: 2.538 Vali Loss: 2.509 Vali Acc: 0.400 Test Loss: 2.509 Test Acc: 0.400
Validation loss decreased (-0.211085 --> -0.399975).  Saving model ...
Epoch: 4 cost time: 0.8774235248565674
Epoch: 4, Steps: 12 | Train Loss: 2.367 Vali Loss: 2.334 Vali Acc: 0.533 Test Loss: 2.334 Test Acc: 0.533
Validation loss decreased (-0.399975 --> -0.533310).  Saving model ...
Epoch: 5 cost time: 0.8582139015197754
Epoch: 5, Steps: 12 | Train Loss: 2.191 Vali Loss: 2.141 Vali Acc: 0.578 Test Loss: 2.141 Test Acc: 0.578
Validation loss decreased (-0.533310 --> -0.577756).  Saving model ...
Epoch: 6 cost time: 0.8360800743103027
Epoch: 6, Steps: 12 | Train Loss: 1.963 Vali Loss: 1.943 Vali Acc: 0.583 Test Loss: 1.943 Test Acc: 0.583
Validation loss decreased (-0.577756 --> -0.583314).  Saving model ...
Epoch: 7 cost time: 0.9243648052215576
Epoch: 7, Steps: 12 | Train Loss: 1.736 Vali Loss: 1.727 Vali Acc: 0.622 Test Loss: 1.727 Test Acc: 0.622
Validation loss decreased (-0.583314 --> -0.622205).  Saving model ...
Epoch: 8 cost time: 0.8165831565856934
Epoch: 8, Steps: 12 | Train Loss: 1.487 Vali Loss: 1.517 Vali Acc: 0.639 Test Loss: 1.517 Test Acc: 0.639
Validation loss decreased (-0.622205 --> -0.638874).  Saving model ...
Epoch: 9 cost time: 0.8454656600952148
Epoch: 9, Steps: 12 | Train Loss: 1.274 Vali Loss: 1.357 Vali Acc: 0.656 Test Loss: 1.357 Test Acc: 0.656
Validation loss decreased (-0.638874 --> -0.655542).  Saving model ...
Epoch: 10 cost time: 0.860156774520874
Epoch: 10, Steps: 12 | Train Loss: 1.046 Vali Loss: 1.190 Vali Acc: 0.689 Test Loss: 1.190 Test Acc: 0.689
Validation loss decreased (-0.655542 --> -0.688877).  Saving model ...
Epoch: 11 cost time: 0.8729567527770996
Epoch: 11, Steps: 12 | Train Loss: 0.896 Vali Loss: 1.062 Vali Acc: 0.694 Test Loss: 1.062 Test Acc: 0.694
Validation loss decreased (-0.688877 --> -0.694434).  Saving model ...
Epoch: 12 cost time: 0.8675632476806641
Epoch: 12, Steps: 12 | Train Loss: 0.808 Vali Loss: 0.971 Vali Acc: 0.706 Test Loss: 0.971 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705546).  Saving model ...
Epoch: 13 cost time: 0.7835421562194824
Epoch: 13, Steps: 12 | Train Loss: 0.658 Vali Loss: 0.916 Vali Acc: 0.750 Test Loss: 0.916 Test Acc: 0.750
Validation loss decreased (-0.705546 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.8445703983306885
Epoch: 14, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.830 Vali Acc: 0.750 Test Loss: 0.830 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 15 cost time: 0.7783448696136475
Epoch: 15, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.771 Vali Acc: 0.767 Test Loss: 0.771 Test Acc: 0.767
Validation loss decreased (-0.749992 --> -0.766659).  Saving model ...
Epoch: 16 cost time: 0.8185241222381592
Epoch: 16, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.736 Vali Acc: 0.789 Test Loss: 0.736 Test Acc: 0.789
Validation loss decreased (-0.766659 --> -0.788882).  Saving model ...
Epoch: 17 cost time: 0.8326504230499268
Epoch: 17, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.676 Vali Acc: 0.811 Test Loss: 0.676 Test Acc: 0.811
Validation loss decreased (-0.788882 --> -0.811104).  Saving model ...
Epoch: 18 cost time: 0.8695783615112305
Epoch: 18, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.630 Vali Acc: 0.817 Test Loss: 0.630 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 19 cost time: 0.8884141445159912
Epoch: 19, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.618 Vali Acc: 0.822 Test Loss: 0.618 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 20 cost time: 0.8728845119476318
Epoch: 20, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.603 Vali Acc: 0.839 Test Loss: 0.603 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 21 cost time: 0.8336567878723145
Epoch: 21, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.597 Vali Acc: 0.833 Test Loss: 0.597 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8556745052337646
Epoch: 22, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 0.8380036354064941
Epoch: 23, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.558 Vali Acc: 0.839 Test Loss: 0.558 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8190116882324219
Epoch: 24, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8025219440460205
Epoch: 25, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.545 Vali Acc: 0.867 Test Loss: 0.545 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866661).  Saving model ...
Epoch: 26 cost time: 0.8943276405334473
Epoch: 26, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.537 Vali Acc: 0.861 Test Loss: 0.537 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9188947677612305
Epoch: 27, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.542 Vali Acc: 0.856 Test Loss: 0.542 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8489069938659668
Epoch: 28, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8377180099487305
Epoch: 29, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.551 Vali Acc: 0.844 Test Loss: 0.551 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8429694175720215
Epoch: 30, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.542 Vali Acc: 0.867 Test Loss: 0.542 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 31 cost time: 0.872448205947876
Epoch: 31, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.554 Vali Acc: 0.872 Test Loss: 0.554 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 32 cost time: 0.8802709579467773
Epoch: 32, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.556 Vali Acc: 0.867 Test Loss: 0.556 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7366468906402588
Epoch: 33, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.841874361038208
Epoch: 34, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8633849620819092
Epoch: 35, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8590304851531982
Epoch: 36, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.585 Vali Acc: 0.861 Test Loss: 0.585 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8122527599334717
Epoch: 37, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.598 Vali Acc: 0.867 Test Loss: 0.598 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.8076276779174805
Epoch: 38, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.624 Vali Acc: 0.872 Test Loss: 0.624 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.824042558670044
Epoch: 39, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.594 Vali Acc: 0.872 Test Loss: 0.594 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.8715779781341553
Epoch: 40, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.590 Vali Acc: 0.867 Test Loss: 0.590 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.8455634117126465
Epoch: 41, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.613 Vali Acc: 0.878 Test Loss: 0.613 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 42 cost time: 0.9059922695159912
Epoch: 42, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.616 Vali Acc: 0.878 Test Loss: 0.616 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8826115131378174
Epoch: 43, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.602 Vali Acc: 0.872 Test Loss: 0.602 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8506793975830078
Epoch: 44, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.611 Vali Acc: 0.867 Test Loss: 0.611 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8492555618286133
Epoch: 45, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.634 Vali Acc: 0.867 Test Loss: 0.634 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8764421939849854
Epoch: 46, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.631 Vali Acc: 0.872 Test Loss: 0.631 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.8620615005493164
Epoch: 47, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.626 Vali Acc: 0.878 Test Loss: 0.626 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.8343768119812012
Epoch: 48, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.646 Vali Acc: 0.867 Test Loss: 0.646 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.8788487911224365
Epoch: 49, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.691 Vali Acc: 0.856 Test Loss: 0.691 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.8590314388275146
Epoch: 50, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.657 Vali Acc: 0.861 Test Loss: 0.657 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 128911
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0046427249908447
Epoch: 1, Steps: 12 | Train Loss: 2.723 Vali Loss: 2.676 Vali Acc: 0.061 Test Loss: 2.676 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 0.781954288482666
Epoch: 2, Steps: 12 | Train Loss: 2.635 Vali Loss: 2.596 Vali Acc: 0.161 Test Loss: 2.596 Test Acc: 0.161
Validation loss decreased (-0.061084 --> -0.161085).  Saving model ...
Epoch: 3 cost time: 0.8630313873291016
Epoch: 3, Steps: 12 | Train Loss: 2.506 Vali Loss: 2.471 Vali Acc: 0.339 Test Loss: 2.471 Test Acc: 0.339
Validation loss decreased (-0.161085 --> -0.338864).  Saving model ...
Epoch: 4 cost time: 0.8893852233886719
Epoch: 4, Steps: 12 | Train Loss: 2.374 Vali Loss: 2.310 Vali Acc: 0.439 Test Loss: 2.310 Test Acc: 0.439
Validation loss decreased (-0.338864 --> -0.438866).  Saving model ...
Epoch: 5 cost time: 0.8696119785308838
Epoch: 5, Steps: 12 | Train Loss: 2.203 Vali Loss: 2.140 Vali Acc: 0.556 Test Loss: 2.140 Test Acc: 0.556
Validation loss decreased (-0.438866 --> -0.555534).  Saving model ...
Epoch: 6 cost time: 0.8403995037078857
Epoch: 6, Steps: 12 | Train Loss: 1.991 Vali Loss: 1.934 Vali Acc: 0.567 Test Loss: 1.934 Test Acc: 0.567
Validation loss decreased (-0.555534 --> -0.566647).  Saving model ...
Epoch: 7 cost time: 0.809412956237793
Epoch: 7, Steps: 12 | Train Loss: 1.749 Vali Loss: 1.738 Vali Acc: 0.594 Test Loss: 1.738 Test Acc: 0.594
Validation loss decreased (-0.566647 --> -0.594427).  Saving model ...
Epoch: 8 cost time: 0.8790297508239746
Epoch: 8, Steps: 12 | Train Loss: 1.490 Vali Loss: 1.566 Vali Acc: 0.639 Test Loss: 1.566 Test Acc: 0.639
Validation loss decreased (-0.594427 --> -0.638873).  Saving model ...
Epoch: 9 cost time: 0.8854715824127197
Epoch: 9, Steps: 12 | Train Loss: 1.327 Vali Loss: 1.366 Vali Acc: 0.661 Test Loss: 1.366 Test Acc: 0.661
Validation loss decreased (-0.638873 --> -0.661097).  Saving model ...
Epoch: 10 cost time: 0.873201847076416
Epoch: 10, Steps: 12 | Train Loss: 1.111 Vali Loss: 1.235 Vali Acc: 0.678 Test Loss: 1.235 Test Acc: 0.678
Validation loss decreased (-0.661097 --> -0.677765).  Saving model ...
Epoch: 11 cost time: 0.8591382503509521
Epoch: 11, Steps: 12 | Train Loss: 0.970 Vali Loss: 1.102 Vali Acc: 0.689 Test Loss: 1.102 Test Acc: 0.689
Validation loss decreased (-0.677765 --> -0.688878).  Saving model ...
Epoch: 12 cost time: 0.8538117408752441
Epoch: 12, Steps: 12 | Train Loss: 0.835 Vali Loss: 1.016 Vali Acc: 0.711 Test Loss: 1.016 Test Acc: 0.711
Validation loss decreased (-0.688878 --> -0.711101).  Saving model ...
Epoch: 13 cost time: 0.8326413631439209
Epoch: 13, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.929 Vali Acc: 0.739 Test Loss: 0.929 Test Acc: 0.739
Validation loss decreased (-0.711101 --> -0.738880).  Saving model ...
Epoch: 14 cost time: 0.8605012893676758
Epoch: 14, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.849 Vali Acc: 0.750 Test Loss: 0.849 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749992).  Saving model ...
Epoch: 15 cost time: 0.8701536655426025
Epoch: 15, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.793 Vali Acc: 0.750 Test Loss: 0.793 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 0.8830316066741943
Epoch: 16, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.733 Vali Acc: 0.778 Test Loss: 0.733 Test Acc: 0.778
Validation loss decreased (-0.749992 --> -0.777770).  Saving model ...
Epoch: 17 cost time: 0.8894882202148438
Epoch: 17, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.700 Vali Acc: 0.806 Test Loss: 0.700 Test Acc: 0.806
Validation loss decreased (-0.777770 --> -0.805549).  Saving model ...
Epoch: 18 cost time: 0.8534383773803711
Epoch: 18, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.670 Vali Acc: 0.789 Test Loss: 0.670 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8374714851379395
Epoch: 19, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.642 Vali Acc: 0.800 Test Loss: 0.642 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.860166072845459
Epoch: 20, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.619 Vali Acc: 0.828 Test Loss: 0.619 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827772).  Saving model ...
Epoch: 21 cost time: 0.7705504894256592
Epoch: 21, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.610 Vali Acc: 0.817 Test Loss: 0.610 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8228695392608643
Epoch: 22, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.579 Vali Acc: 0.828 Test Loss: 0.579 Test Acc: 0.828
Validation loss decreased (-0.827772 --> -0.827772).  Saving model ...
Epoch: 23 cost time: 0.8098909854888916
Epoch: 23, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.581 Vali Acc: 0.839 Test Loss: 0.581 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 24 cost time: 0.8756921291351318
Epoch: 24, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.567 Vali Acc: 0.828 Test Loss: 0.567 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8953142166137695
Epoch: 25, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.558 Vali Acc: 0.839 Test Loss: 0.558 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 26 cost time: 0.8778848648071289
Epoch: 26, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.549 Vali Acc: 0.844 Test Loss: 0.549 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 27 cost time: 0.8293378353118896
Epoch: 27, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.554 Vali Acc: 0.839 Test Loss: 0.554 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8727755546569824
Epoch: 28, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.532 Vali Acc: 0.839 Test Loss: 0.532 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8784339427947998
Epoch: 29, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.528 Vali Acc: 0.844 Test Loss: 0.528 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 30 cost time: 0.8747315406799316
Epoch: 30, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.534 Vali Acc: 0.856 Test Loss: 0.534 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 31 cost time: 0.9042754173278809
Epoch: 31, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.543 Vali Acc: 0.856 Test Loss: 0.543 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8921856880187988
Epoch: 32, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.870957612991333
Epoch: 33, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.546 Vali Acc: 0.856 Test Loss: 0.546 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9098985195159912
Epoch: 34, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8966846466064453
Epoch: 35, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.546 Vali Acc: 0.861 Test Loss: 0.546 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 36 cost time: 0.851625919342041
Epoch: 36, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.545 Vali Acc: 0.861 Test Loss: 0.545 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 37 cost time: 0.9070804119110107
Epoch: 37, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.545 Vali Acc: 0.839 Test Loss: 0.545 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7650125026702881
Epoch: 38, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.571 Vali Acc: 0.867 Test Loss: 0.571 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 39 cost time: 0.8928477764129639
Epoch: 39, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.566 Vali Acc: 0.878 Test Loss: 0.566 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 40 cost time: 0.8553390502929688
Epoch: 40, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.534 Vali Acc: 0.861 Test Loss: 0.534 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8017058372497559
Epoch: 41, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.548 Vali Acc: 0.856 Test Loss: 0.548 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8437502384185791
Epoch: 42, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.590 Vali Acc: 0.856 Test Loss: 0.590 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8963761329650879
Epoch: 43, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.573 Vali Acc: 0.867 Test Loss: 0.573 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.872412919998169
Epoch: 44, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.580 Vali Acc: 0.861 Test Loss: 0.580 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8827860355377197
Epoch: 45, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.585 Vali Acc: 0.872 Test Loss: 0.585 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8648655414581299
Epoch: 46, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.572 Vali Acc: 0.872 Test Loss: 0.572 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.851693868637085
Epoch: 47, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.568 Vali Acc: 0.883 Test Loss: 0.568 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 48 cost time: 0.8980319499969482
Epoch: 48, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.567 Vali Acc: 0.883 Test Loss: 0.567 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 49 cost time: 0.8711471557617188
Epoch: 49, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.578 Vali Acc: 0.867 Test Loss: 0.578 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8557274341583252
Epoch: 50, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.579 Vali Acc: 0.872 Test Loss: 0.579 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 125263
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9091427326202393
Epoch: 1, Steps: 12 | Train Loss: 2.723 Vali Loss: 2.680 Vali Acc: 0.078 Test Loss: 2.680 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 0.7742710113525391
Epoch: 2, Steps: 12 | Train Loss: 2.596 Vali Loss: 2.564 Vali Acc: 0.228 Test Loss: 2.564 Test Acc: 0.228
Validation loss decreased (-0.077751 --> -0.227752).  Saving model ...
Epoch: 3 cost time: 0.6630575656890869
Epoch: 3, Steps: 12 | Train Loss: 2.402 Vali Loss: 2.392 Vali Acc: 0.444 Test Loss: 2.392 Test Acc: 0.444
Validation loss decreased (-0.227752 --> -0.444421).  Saving model ...
Epoch: 4 cost time: 0.8049049377441406
Epoch: 4, Steps: 12 | Train Loss: 2.180 Vali Loss: 2.151 Vali Acc: 0.528 Test Loss: 2.151 Test Acc: 0.528
Validation loss decreased (-0.444421 --> -0.527756).  Saving model ...
Epoch: 5 cost time: 0.7086718082427979
Epoch: 5, Steps: 12 | Train Loss: 1.892 Vali Loss: 1.894 Vali Acc: 0.583 Test Loss: 1.894 Test Acc: 0.583
Validation loss decreased (-0.527756 --> -0.583314).  Saving model ...
Epoch: 6 cost time: 0.7290897369384766
Epoch: 6, Steps: 12 | Train Loss: 1.637 Vali Loss: 1.622 Vali Acc: 0.606 Test Loss: 1.622 Test Acc: 0.606
Validation loss decreased (-0.583314 --> -0.605539).  Saving model ...
Epoch: 7 cost time: 0.8065381050109863
Epoch: 7, Steps: 12 | Train Loss: 1.364 Vali Loss: 1.411 Vali Acc: 0.628 Test Loss: 1.411 Test Acc: 0.628
Validation loss decreased (-0.605539 --> -0.627764).  Saving model ...
Epoch: 8 cost time: 0.7238988876342773
Epoch: 8, Steps: 12 | Train Loss: 1.131 Vali Loss: 1.247 Vali Acc: 0.622 Test Loss: 1.247 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7297518253326416
Epoch: 9, Steps: 12 | Train Loss: 0.921 Vali Loss: 1.136 Vali Acc: 0.672 Test Loss: 1.136 Test Acc: 0.672
Validation loss decreased (-0.627764 --> -0.672211).  Saving model ...
Epoch: 10 cost time: 0.7469866275787354
Epoch: 10, Steps: 12 | Train Loss: 0.773 Vali Loss: 1.042 Vali Acc: 0.694 Test Loss: 1.042 Test Acc: 0.694
Validation loss decreased (-0.672211 --> -0.694434).  Saving model ...
Epoch: 11 cost time: 0.620091438293457
Epoch: 11, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.978 Vali Acc: 0.672 Test Loss: 0.978 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6422374248504639
Epoch: 12, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.933 Vali Acc: 0.706 Test Loss: 0.933 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705546).  Saving model ...
Epoch: 13 cost time: 0.7118411064147949
Epoch: 13, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.863 Vali Acc: 0.711 Test Loss: 0.863 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711102).  Saving model ...
Epoch: 14 cost time: 0.6661531925201416
Epoch: 14, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.859 Vali Acc: 0.733 Test Loss: 0.859 Test Acc: 0.733
Validation loss decreased (-0.711102 --> -0.733325).  Saving model ...
Epoch: 15 cost time: 0.7124309539794922
Epoch: 15, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.843 Vali Acc: 0.750 Test Loss: 0.843 Test Acc: 0.750
Validation loss decreased (-0.733325 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 0.7549104690551758
Epoch: 16, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.802 Vali Acc: 0.767 Test Loss: 0.802 Test Acc: 0.767
Validation loss decreased (-0.749992 --> -0.766659).  Saving model ...
Epoch: 17 cost time: 0.7756986618041992
Epoch: 17, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.794 Vali Acc: 0.750 Test Loss: 0.794 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.80039381980896
Epoch: 18, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.818 Vali Acc: 0.761 Test Loss: 0.818 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7990410327911377
Epoch: 19, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.803 Vali Acc: 0.767 Test Loss: 0.803 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8030202388763428
Epoch: 20, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.792 Vali Acc: 0.778 Test Loss: 0.792 Test Acc: 0.778
Validation loss decreased (-0.766659 --> -0.777770).  Saving model ...
Epoch: 21 cost time: 0.7641024589538574
Epoch: 21, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.778 Vali Acc: 0.800 Test Loss: 0.778 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799992).  Saving model ...
Epoch: 22 cost time: 0.8656673431396484
Epoch: 22, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.812 Vali Acc: 0.806 Test Loss: 0.812 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805547).  Saving model ...
Epoch: 23 cost time: 0.7703959941864014
Epoch: 23, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.815 Vali Acc: 0.794 Test Loss: 0.815 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7589585781097412
Epoch: 24, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.807 Vali Acc: 0.794 Test Loss: 0.807 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7542078495025635
Epoch: 25, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.809 Vali Acc: 0.794 Test Loss: 0.809 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.763746976852417
Epoch: 26, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.860 Vali Acc: 0.794 Test Loss: 0.860 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.768510103225708
Epoch: 27, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.873 Vali Acc: 0.789 Test Loss: 0.873 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.763617992401123
Epoch: 28, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.858 Vali Acc: 0.794 Test Loss: 0.858 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7591540813446045
Epoch: 29, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.901 Vali Acc: 0.778 Test Loss: 0.901 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7289588451385498
Epoch: 30, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.895 Vali Acc: 0.789 Test Loss: 0.895 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7989962100982666
Epoch: 31, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.958 Vali Acc: 0.794 Test Loss: 0.958 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7677316665649414
Epoch: 32, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.991 Vali Acc: 0.817 Test Loss: 0.991 Test Acc: 0.817
Validation loss decreased (-0.805547 --> -0.816657).  Saving model ...
Epoch: 33 cost time: 0.7700355052947998
Epoch: 33, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.968 Vali Acc: 0.811 Test Loss: 0.968 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8343029022216797
Epoch: 34, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.007 Vali Acc: 0.817 Test Loss: 1.007 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7484617233276367
Epoch: 35, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.911 Vali Acc: 0.794 Test Loss: 0.911 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7933378219604492
Epoch: 36, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.921 Vali Acc: 0.828 Test Loss: 0.921 Test Acc: 0.828
Validation loss decreased (-0.816657 --> -0.827769).  Saving model ...
Epoch: 37 cost time: 0.7055096626281738
Epoch: 37, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.925 Vali Acc: 0.794 Test Loss: 0.925 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7556848526000977
Epoch: 38, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.952 Vali Acc: 0.800 Test Loss: 0.952 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7826285362243652
Epoch: 39, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.965 Vali Acc: 0.833 Test Loss: 0.965 Test Acc: 0.833
Validation loss decreased (-0.827769 --> -0.833324).  Saving model ...
Epoch: 40 cost time: 0.7823376655578613
Epoch: 40, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.965 Vali Acc: 0.839 Test Loss: 0.965 Test Acc: 0.839
Validation loss decreased (-0.833324 --> -0.838879).  Saving model ...
Epoch: 41 cost time: 0.7741575241088867
Epoch: 41, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.969 Vali Acc: 0.822 Test Loss: 0.969 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7946226596832275
Epoch: 42, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.955 Vali Acc: 0.833 Test Loss: 0.955 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7352461814880371
Epoch: 43, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.992 Vali Acc: 0.800 Test Loss: 0.992 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7757358551025391
Epoch: 44, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.960 Vali Acc: 0.833 Test Loss: 0.960 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7815332412719727
Epoch: 45, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.001 Vali Acc: 0.844 Test Loss: 1.001 Test Acc: 0.844
Validation loss decreased (-0.838879 --> -0.844434).  Saving model ...
Epoch: 46 cost time: 0.755115270614624
Epoch: 46, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.005 Vali Acc: 0.828 Test Loss: 1.005 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7786221504211426
Epoch: 47, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.011 Vali Acc: 0.822 Test Loss: 1.011 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7686543464660645
Epoch: 48, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.043 Vali Acc: 0.850 Test Loss: 1.043 Test Acc: 0.850
Validation loss decreased (-0.844434 --> -0.849990).  Saving model ...
Epoch: 49 cost time: 0.7972533702850342
Epoch: 49, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.024 Vali Acc: 0.833 Test Loss: 1.024 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7559401988983154
Epoch: 50, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.029 Vali Acc: 0.833 Test Loss: 1.029 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.85
model parameter : 74223
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0146634578704834
Epoch: 1, Steps: 12 | Train Loss: 2.756 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 0.7474837303161621
Epoch: 2, Steps: 12 | Train Loss: 2.668 Vali Loss: 2.662 Vali Acc: 0.122 Test Loss: 2.662 Test Acc: 0.122
Validation loss decreased (-0.066640 --> -0.122196).  Saving model ...
Epoch: 3 cost time: 0.7616939544677734
Epoch: 3, Steps: 12 | Train Loss: 2.596 Vali Loss: 2.572 Vali Acc: 0.222 Test Loss: 2.572 Test Acc: 0.222
Validation loss decreased (-0.122196 --> -0.222197).  Saving model ...
Epoch: 4 cost time: 0.78399658203125
Epoch: 4, Steps: 12 | Train Loss: 2.455 Vali Loss: 2.449 Vali Acc: 0.311 Test Loss: 2.449 Test Acc: 0.311
Validation loss decreased (-0.222197 --> -0.311087).  Saving model ...
Epoch: 5 cost time: 0.7280378341674805
Epoch: 5, Steps: 12 | Train Loss: 2.317 Vali Loss: 2.295 Vali Acc: 0.406 Test Loss: 2.295 Test Acc: 0.406
Validation loss decreased (-0.311087 --> -0.405533).  Saving model ...
Epoch: 6 cost time: 0.7717812061309814
Epoch: 6, Steps: 12 | Train Loss: 2.095 Vali Loss: 2.112 Vali Acc: 0.489 Test Loss: 2.112 Test Acc: 0.489
Validation loss decreased (-0.405533 --> -0.488868).  Saving model ...
Epoch: 7 cost time: 0.744971513748169
Epoch: 7, Steps: 12 | Train Loss: 1.917 Vali Loss: 1.902 Vali Acc: 0.522 Test Loss: 1.902 Test Acc: 0.522
Validation loss decreased (-0.488868 --> -0.522203).  Saving model ...
Epoch: 8 cost time: 0.7796270847320557
Epoch: 8, Steps: 12 | Train Loss: 1.651 Vali Loss: 1.692 Vali Acc: 0.567 Test Loss: 1.692 Test Acc: 0.567
Validation loss decreased (-0.522203 --> -0.566650).  Saving model ...
Epoch: 9 cost time: 0.7779054641723633
Epoch: 9, Steps: 12 | Train Loss: 1.387 Vali Loss: 1.520 Vali Acc: 0.622 Test Loss: 1.520 Test Acc: 0.622
Validation loss decreased (-0.566650 --> -0.622207).  Saving model ...
Epoch: 10 cost time: 0.7786495685577393
Epoch: 10, Steps: 12 | Train Loss: 1.297 Vali Loss: 1.368 Vali Acc: 0.628 Test Loss: 1.368 Test Acc: 0.628
Validation loss decreased (-0.622207 --> -0.627764).  Saving model ...
Epoch: 11 cost time: 0.7470436096191406
Epoch: 11, Steps: 12 | Train Loss: 1.060 Vali Loss: 1.253 Vali Acc: 0.628 Test Loss: 1.253 Test Acc: 0.628
Validation loss decreased (-0.627764 --> -0.627765).  Saving model ...
Epoch: 12 cost time: 0.7560081481933594
Epoch: 12, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.152 Vali Acc: 0.644 Test Loss: 1.152 Test Acc: 0.644
Validation loss decreased (-0.627765 --> -0.644433).  Saving model ...
Epoch: 13 cost time: 0.8265175819396973
Epoch: 13, Steps: 12 | Train Loss: 0.842 Vali Loss: 1.069 Vali Acc: 0.678 Test Loss: 1.069 Test Acc: 0.678
Validation loss decreased (-0.644433 --> -0.677767).  Saving model ...
Epoch: 14 cost time: 0.800612211227417
Epoch: 14, Steps: 12 | Train Loss: 0.722 Vali Loss: 1.028 Vali Acc: 0.672 Test Loss: 1.028 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8019647598266602
Epoch: 15, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.951 Vali Acc: 0.689 Test Loss: 0.951 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688879).  Saving model ...
Epoch: 16 cost time: 0.7539114952087402
Epoch: 16, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.899 Vali Acc: 0.683 Test Loss: 0.899 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7454347610473633
Epoch: 17, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.874 Vali Acc: 0.700 Test Loss: 0.874 Test Acc: 0.700
Validation loss decreased (-0.688879 --> -0.699991).  Saving model ...
Epoch: 18 cost time: 0.7657771110534668
Epoch: 18, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.849 Vali Acc: 0.717 Test Loss: 0.849 Test Acc: 0.717
Validation loss decreased (-0.699991 --> -0.716658).  Saving model ...
Epoch: 19 cost time: 0.7571139335632324
Epoch: 19, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.819 Vali Acc: 0.739 Test Loss: 0.819 Test Acc: 0.739
Validation loss decreased (-0.716658 --> -0.738881).  Saving model ...
Epoch: 20 cost time: 0.7716021537780762
Epoch: 20, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.780 Vali Acc: 0.744 Test Loss: 0.780 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744437).  Saving model ...
Epoch: 21 cost time: 0.7851715087890625
Epoch: 21, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.757 Vali Acc: 0.761 Test Loss: 0.757 Test Acc: 0.761
Validation loss decreased (-0.744437 --> -0.761104).  Saving model ...
Epoch: 22 cost time: 0.7437100410461426
Epoch: 22, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.770 Vali Acc: 0.767 Test Loss: 0.770 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766659).  Saving model ...
Epoch: 23 cost time: 0.7876050472259521
Epoch: 23, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.741 Vali Acc: 0.767 Test Loss: 0.741 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 24 cost time: 0.7427215576171875
Epoch: 24, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.711 Vali Acc: 0.767 Test Loss: 0.711 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766660).  Saving model ...
Epoch: 25 cost time: 0.7493109703063965
Epoch: 25, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.718 Vali Acc: 0.789 Test Loss: 0.718 Test Acc: 0.789
Validation loss decreased (-0.766660 --> -0.788882).  Saving model ...
Epoch: 26 cost time: 0.77402663230896
Epoch: 26, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.722 Vali Acc: 0.794 Test Loss: 0.722 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794437).  Saving model ...
Epoch: 27 cost time: 0.8184306621551514
Epoch: 27, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.714 Vali Acc: 0.811 Test Loss: 0.714 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811104).  Saving model ...
Epoch: 28 cost time: 0.7709944248199463
Epoch: 28, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.700 Vali Acc: 0.811 Test Loss: 0.700 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 29 cost time: 0.8356339931488037
Epoch: 29, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.709 Vali Acc: 0.806 Test Loss: 0.709 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7552838325500488
Epoch: 30, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.747 Vali Acc: 0.817 Test Loss: 0.747 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816659).  Saving model ...
Epoch: 31 cost time: 0.736616849899292
Epoch: 31, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.748 Vali Acc: 0.828 Test Loss: 0.748 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827770).  Saving model ...
Epoch: 32 cost time: 0.7481799125671387
Epoch: 32, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.712 Vali Acc: 0.811 Test Loss: 0.712 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7706949710845947
Epoch: 33, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.715 Vali Acc: 0.817 Test Loss: 0.715 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7522177696228027
Epoch: 34, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.741 Vali Acc: 0.822 Test Loss: 0.741 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7665252685546875
Epoch: 35, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.747 Vali Acc: 0.839 Test Loss: 0.747 Test Acc: 0.839
Validation loss decreased (-0.827770 --> -0.838881).  Saving model ...
Epoch: 36 cost time: 0.7997615337371826
Epoch: 36, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.721 Vali Acc: 0.828 Test Loss: 0.721 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7709712982177734
Epoch: 37, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.731 Vali Acc: 0.817 Test Loss: 0.731 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.70963454246521
Epoch: 38, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.777 Vali Acc: 0.817 Test Loss: 0.777 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7859833240509033
Epoch: 39, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.732 Vali Acc: 0.828 Test Loss: 0.732 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8288531303405762
Epoch: 40, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.738 Vali Acc: 0.833 Test Loss: 0.738 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7747335433959961
Epoch: 41, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.729 Vali Acc: 0.839 Test Loss: 0.729 Test Acc: 0.839
Validation loss decreased (-0.838881 --> -0.838882).  Saving model ...
Epoch: 42 cost time: 0.7682561874389648
Epoch: 42, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.725 Vali Acc: 0.839 Test Loss: 0.725 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838882).  Saving model ...
Epoch: 43 cost time: 0.7884211540222168
Epoch: 43, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.728 Vali Acc: 0.828 Test Loss: 0.728 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7414693832397461
Epoch: 44, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.766 Vali Acc: 0.828 Test Loss: 0.766 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.759145975112915
Epoch: 45, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.799 Vali Acc: 0.811 Test Loss: 0.799 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.7656166553497314
Epoch: 46, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.811 Vali Acc: 0.822 Test Loss: 0.811 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.758162260055542
Epoch: 47, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.778 Vali Acc: 0.828 Test Loss: 0.778 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.7668137550354004
Epoch: 48, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.759 Vali Acc: 0.828 Test Loss: 0.759 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.7566878795623779
Epoch: 49, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.779 Vali Acc: 0.828 Test Loss: 0.779 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.7143411636352539
Epoch: 50, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.776 Vali Acc: 0.828 Test Loss: 0.776 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 51215
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9600999355316162
Epoch: 1, Steps: 12 | Train Loss: 2.720 Vali Loss: 2.676 Vali Acc: 0.094 Test Loss: 2.676 Test Acc: 0.094
Validation loss decreased (inf --> -0.094418).  Saving model ...
Epoch: 2 cost time: 0.7227573394775391
Epoch: 2, Steps: 12 | Train Loss: 2.647 Vali Loss: 2.609 Vali Acc: 0.156 Test Loss: 2.609 Test Acc: 0.156
Validation loss decreased (-0.094418 --> -0.155529).  Saving model ...
Epoch: 3 cost time: 0.715277910232544
Epoch: 3, Steps: 12 | Train Loss: 2.560 Vali Loss: 2.498 Vali Acc: 0.261 Test Loss: 2.498 Test Acc: 0.261
Validation loss decreased (-0.155529 --> -0.261086).  Saving model ...
Epoch: 4 cost time: 0.7246749401092529
Epoch: 4, Steps: 12 | Train Loss: 2.397 Vali Loss: 2.353 Vali Acc: 0.372 Test Loss: 2.353 Test Acc: 0.372
Validation loss decreased (-0.261086 --> -0.372199).  Saving model ...
Epoch: 5 cost time: 0.7069814205169678
Epoch: 5, Steps: 12 | Train Loss: 2.185 Vali Loss: 2.193 Vali Acc: 0.483 Test Loss: 2.193 Test Acc: 0.483
Validation loss decreased (-0.372199 --> -0.483311).  Saving model ...
Epoch: 6 cost time: 0.7178354263305664
Epoch: 6, Steps: 12 | Train Loss: 2.050 Vali Loss: 2.000 Vali Acc: 0.544 Test Loss: 2.000 Test Acc: 0.544
Validation loss decreased (-0.483311 --> -0.544424).  Saving model ...
Epoch: 7 cost time: 0.7553644180297852
Epoch: 7, Steps: 12 | Train Loss: 1.824 Vali Loss: 1.825 Vali Acc: 0.539 Test Loss: 1.825 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.846092939376831
Epoch: 8, Steps: 12 | Train Loss: 1.582 Vali Loss: 1.645 Vali Acc: 0.606 Test Loss: 1.645 Test Acc: 0.606
Validation loss decreased (-0.544424 --> -0.605539).  Saving model ...
Epoch: 9 cost time: 0.8206679821014404
Epoch: 9, Steps: 12 | Train Loss: 1.408 Vali Loss: 1.481 Vali Acc: 0.617 Test Loss: 1.481 Test Acc: 0.617
Validation loss decreased (-0.605539 --> -0.616652).  Saving model ...
Epoch: 10 cost time: 0.7961983680725098
Epoch: 10, Steps: 12 | Train Loss: 1.187 Vali Loss: 1.352 Vali Acc: 0.639 Test Loss: 1.352 Test Acc: 0.639
Validation loss decreased (-0.616652 --> -0.638875).  Saving model ...
Epoch: 11 cost time: 0.7818167209625244
Epoch: 11, Steps: 12 | Train Loss: 1.045 Vali Loss: 1.227 Vali Acc: 0.661 Test Loss: 1.227 Test Acc: 0.661
Validation loss decreased (-0.638875 --> -0.661099).  Saving model ...
Epoch: 12 cost time: 0.7797279357910156
Epoch: 12, Steps: 12 | Train Loss: 0.921 Vali Loss: 1.139 Vali Acc: 0.650 Test Loss: 1.139 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.850726842880249
Epoch: 13, Steps: 12 | Train Loss: 0.822 Vali Loss: 1.071 Vali Acc: 0.661 Test Loss: 1.071 Test Acc: 0.661
Validation loss decreased (-0.661099 --> -0.661100).  Saving model ...
Epoch: 14 cost time: 0.7920582294464111
Epoch: 14, Steps: 12 | Train Loss: 0.712 Vali Loss: 1.013 Vali Acc: 0.689 Test Loss: 1.013 Test Acc: 0.689
Validation loss decreased (-0.661100 --> -0.688879).  Saving model ...
Epoch: 15 cost time: 0.850670337677002
Epoch: 15, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.959 Vali Acc: 0.672 Test Loss: 0.959 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7952346801757812
Epoch: 16, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.912 Vali Acc: 0.689 Test Loss: 0.912 Test Acc: 0.689
Validation loss decreased (-0.688879 --> -0.688880).  Saving model ...
Epoch: 17 cost time: 0.780073881149292
Epoch: 17, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.882 Vali Acc: 0.722 Test Loss: 0.882 Test Acc: 0.722
Validation loss decreased (-0.688880 --> -0.722213).  Saving model ...
Epoch: 18 cost time: 0.7848913669586182
Epoch: 18, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.856 Vali Acc: 0.739 Test Loss: 0.856 Test Acc: 0.739
Validation loss decreased (-0.722213 --> -0.738880).  Saving model ...
Epoch: 19 cost time: 0.8250448703765869
Epoch: 19, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.819 Vali Acc: 0.722 Test Loss: 0.819 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8215785026550293
Epoch: 20, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.796 Vali Acc: 0.750 Test Loss: 0.796 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749992).  Saving model ...
Epoch: 21 cost time: 0.8480849266052246
Epoch: 21, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.779 Vali Acc: 0.778 Test Loss: 0.779 Test Acc: 0.778
Validation loss decreased (-0.749992 --> -0.777770).  Saving model ...
Epoch: 22 cost time: 0.7702779769897461
Epoch: 22, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.777 Vali Acc: 0.767 Test Loss: 0.777 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8066601753234863
Epoch: 23, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.734 Vali Acc: 0.794 Test Loss: 0.734 Test Acc: 0.794
Validation loss decreased (-0.777770 --> -0.794437).  Saving model ...
Epoch: 24 cost time: 0.8373582363128662
Epoch: 24, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.714 Vali Acc: 0.811 Test Loss: 0.714 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811104).  Saving model ...
Epoch: 25 cost time: 0.7420294284820557
Epoch: 25, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.711 Vali Acc: 0.817 Test Loss: 0.711 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 26 cost time: 0.7399759292602539
Epoch: 26, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.736 Vali Acc: 0.789 Test Loss: 0.736 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8069431781768799
Epoch: 27, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.746 Vali Acc: 0.806 Test Loss: 0.746 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7904431819915771
Epoch: 28, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.690 Vali Acc: 0.800 Test Loss: 0.690 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8216361999511719
Epoch: 29, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.675 Vali Acc: 0.833 Test Loss: 0.675 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 30 cost time: 0.7528221607208252
Epoch: 30, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.697 Vali Acc: 0.828 Test Loss: 0.697 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7755370140075684
Epoch: 31, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.702 Vali Acc: 0.844 Test Loss: 0.702 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844437).  Saving model ...
Epoch: 32 cost time: 0.7666447162628174
Epoch: 32, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.675 Vali Acc: 0.822 Test Loss: 0.675 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7410366535186768
Epoch: 33, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.667 Vali Acc: 0.822 Test Loss: 0.667 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.806410551071167
Epoch: 34, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.701 Vali Acc: 0.833 Test Loss: 0.701 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.779822587966919
Epoch: 35, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.676 Vali Acc: 0.839 Test Loss: 0.676 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7766239643096924
Epoch: 36, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.701 Vali Acc: 0.833 Test Loss: 0.701 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.7663216590881348
Epoch: 37, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.701 Vali Acc: 0.839 Test Loss: 0.701 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7790317535400391
Epoch: 38, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.704 Vali Acc: 0.833 Test Loss: 0.704 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.8178727626800537
Epoch: 39, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.690 Vali Acc: 0.822 Test Loss: 0.690 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.7782063484191895
Epoch: 40, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.705 Vali Acc: 0.817 Test Loss: 0.705 Test Acc: 0.817
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.815110445022583
Epoch: 41, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.720 Vali Acc: 0.839 Test Loss: 0.720 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 51247
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0063042640686035
Epoch: 1, Steps: 12 | Train Loss: 2.698 Vali Loss: 2.678 Vali Acc: 0.128 Test Loss: 2.678 Test Acc: 0.128
Validation loss decreased (inf --> -0.127751).  Saving model ...
Epoch: 2 cost time: 0.7032814025878906
Epoch: 2, Steps: 12 | Train Loss: 2.642 Vali Loss: 2.622 Vali Acc: 0.150 Test Loss: 2.622 Test Acc: 0.150
Validation loss decreased (-0.127751 --> -0.149974).  Saving model ...
Epoch: 3 cost time: 0.6961474418640137
Epoch: 3, Steps: 12 | Train Loss: 2.569 Vali Loss: 2.537 Vali Acc: 0.233 Test Loss: 2.537 Test Acc: 0.233
Validation loss decreased (-0.149974 --> -0.233308).  Saving model ...
Epoch: 4 cost time: 0.7352585792541504
Epoch: 4, Steps: 12 | Train Loss: 2.484 Vali Loss: 2.425 Vali Acc: 0.328 Test Loss: 2.425 Test Acc: 0.328
Validation loss decreased (-0.233308 --> -0.327754).  Saving model ...
Epoch: 5 cost time: 0.8259022235870361
Epoch: 5, Steps: 12 | Train Loss: 2.332 Vali Loss: 2.297 Vali Acc: 0.450 Test Loss: 2.297 Test Acc: 0.450
Validation loss decreased (-0.327754 --> -0.449977).  Saving model ...
Epoch: 6 cost time: 0.8169631958007812
Epoch: 6, Steps: 12 | Train Loss: 2.162 Vali Loss: 2.146 Vali Acc: 0.489 Test Loss: 2.146 Test Acc: 0.489
Validation loss decreased (-0.449977 --> -0.488867).  Saving model ...
Epoch: 7 cost time: 0.7963578701019287
Epoch: 7, Steps: 12 | Train Loss: 1.976 Vali Loss: 1.978 Vali Acc: 0.528 Test Loss: 1.978 Test Acc: 0.528
Validation loss decreased (-0.488867 --> -0.527758).  Saving model ...
Epoch: 8 cost time: 0.8096823692321777
Epoch: 8, Steps: 12 | Train Loss: 1.782 Vali Loss: 1.786 Vali Acc: 0.544 Test Loss: 1.786 Test Acc: 0.544
Validation loss decreased (-0.527758 --> -0.544427).  Saving model ...
Epoch: 9 cost time: 0.8158283233642578
Epoch: 9, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.632 Vali Acc: 0.578 Test Loss: 1.632 Test Acc: 0.578
Validation loss decreased (-0.544427 --> -0.577761).  Saving model ...
Epoch: 10 cost time: 0.7776055335998535
Epoch: 10, Steps: 12 | Train Loss: 1.412 Vali Loss: 1.454 Vali Acc: 0.644 Test Loss: 1.454 Test Acc: 0.644
Validation loss decreased (-0.577761 --> -0.644430).  Saving model ...
Epoch: 11 cost time: 0.7645220756530762
Epoch: 11, Steps: 12 | Train Loss: 1.212 Vali Loss: 1.319 Vali Acc: 0.678 Test Loss: 1.319 Test Acc: 0.678
Validation loss decreased (-0.644430 --> -0.677765).  Saving model ...
Epoch: 12 cost time: 0.7349250316619873
Epoch: 12, Steps: 12 | Train Loss: 1.081 Vali Loss: 1.218 Vali Acc: 0.683 Test Loss: 1.218 Test Acc: 0.683
Validation loss decreased (-0.677765 --> -0.683321).  Saving model ...
Epoch: 13 cost time: 0.784553050994873
Epoch: 13, Steps: 12 | Train Loss: 0.963 Vali Loss: 1.144 Vali Acc: 0.678 Test Loss: 1.144 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8067543506622314
Epoch: 14, Steps: 12 | Train Loss: 0.860 Vali Loss: 1.058 Vali Acc: 0.694 Test Loss: 1.058 Test Acc: 0.694
Validation loss decreased (-0.683321 --> -0.694434).  Saving model ...
Epoch: 15 cost time: 0.7988541126251221
Epoch: 15, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.999 Vali Acc: 0.694 Test Loss: 0.999 Test Acc: 0.694
Validation loss decreased (-0.694434 --> -0.694434).  Saving model ...
Epoch: 16 cost time: 0.8202385902404785
Epoch: 16, Steps: 12 | Train Loss: 0.677 Vali Loss: 0.958 Vali Acc: 0.694 Test Loss: 0.958 Test Acc: 0.694
Validation loss decreased (-0.694434 --> -0.694435).  Saving model ...
Epoch: 17 cost time: 0.8151564598083496
Epoch: 17, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.909 Vali Acc: 0.717 Test Loss: 0.909 Test Acc: 0.717
Validation loss decreased (-0.694435 --> -0.716658).  Saving model ...
Epoch: 18 cost time: 0.8480722904205322
Epoch: 18, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.884 Vali Acc: 0.711 Test Loss: 0.884 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8753516674041748
Epoch: 19, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.859 Vali Acc: 0.717 Test Loss: 0.859 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716658).  Saving model ...
Epoch: 20 cost time: 0.8129115104675293
Epoch: 20, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.814 Vali Acc: 0.744 Test Loss: 0.814 Test Acc: 0.744
Validation loss decreased (-0.716658 --> -0.744436).  Saving model ...
Epoch: 21 cost time: 0.8860137462615967
Epoch: 21, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.773 Vali Acc: 0.767 Test Loss: 0.773 Test Acc: 0.767
Validation loss decreased (-0.744436 --> -0.766659).  Saving model ...
Epoch: 22 cost time: 0.7945966720581055
Epoch: 22, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.759 Vali Acc: 0.778 Test Loss: 0.759 Test Acc: 0.778
Validation loss decreased (-0.766659 --> -0.777770).  Saving model ...
Epoch: 23 cost time: 0.8254764080047607
Epoch: 23, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.727 Vali Acc: 0.778 Test Loss: 0.727 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777771).  Saving model ...
Epoch: 24 cost time: 0.8488726615905762
Epoch: 24, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.723 Vali Acc: 0.794 Test Loss: 0.723 Test Acc: 0.794
Validation loss decreased (-0.777771 --> -0.794437).  Saving model ...
Epoch: 25 cost time: 0.8292853832244873
Epoch: 25, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.701 Vali Acc: 0.811 Test Loss: 0.701 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811104).  Saving model ...
Epoch: 26 cost time: 0.8346381187438965
Epoch: 26, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.666 Vali Acc: 0.839 Test Loss: 0.666 Test Acc: 0.839
Validation loss decreased (-0.811104 --> -0.838882).  Saving model ...
Epoch: 27 cost time: 0.880709171295166
Epoch: 27, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.663 Vali Acc: 0.833 Test Loss: 0.663 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8347582817077637
Epoch: 28, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.657 Vali Acc: 0.828 Test Loss: 0.657 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.820979118347168
Epoch: 29, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.653 Vali Acc: 0.844 Test Loss: 0.653 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 30 cost time: 0.820228099822998
Epoch: 30, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.635 Vali Acc: 0.856 Test Loss: 0.635 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 31 cost time: 0.8578534126281738
Epoch: 31, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.635 Vali Acc: 0.850 Test Loss: 0.635 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8101634979248047
Epoch: 32, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.619 Vali Acc: 0.856 Test Loss: 0.619 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 33 cost time: 0.7565362453460693
Epoch: 33, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.619 Vali Acc: 0.856 Test Loss: 0.619 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 34 cost time: 0.8093547821044922
Epoch: 34, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.595 Vali Acc: 0.844 Test Loss: 0.595 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7906522750854492
Epoch: 35, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.610 Vali Acc: 0.861 Test Loss: 0.610 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 36 cost time: 0.8231837749481201
Epoch: 36, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.596 Vali Acc: 0.856 Test Loss: 0.596 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8132612705230713
Epoch: 37, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.620 Vali Acc: 0.861 Test Loss: 0.620 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7741117477416992
Epoch: 38, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.638 Vali Acc: 0.844 Test Loss: 0.638 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7940399646759033
Epoch: 39, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.632 Vali Acc: 0.850 Test Loss: 0.632 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7533292770385742
Epoch: 40, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.648 Vali Acc: 0.861 Test Loss: 0.648 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7772102355957031
Epoch: 41, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.647 Vali Acc: 0.861 Test Loss: 0.647 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7892763614654541
Epoch: 42, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.624 Vali Acc: 0.867 Test Loss: 0.624 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 43 cost time: 0.8828051090240479
Epoch: 43, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.646 Vali Acc: 0.861 Test Loss: 0.646 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8336000442504883
Epoch: 44, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.663 Vali Acc: 0.861 Test Loss: 0.663 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.826483964920044
Epoch: 45, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.656 Vali Acc: 0.856 Test Loss: 0.656 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8783309459686279
Epoch: 46, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.670 Vali Acc: 0.861 Test Loss: 0.670 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8057940006256104
Epoch: 47, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.696 Vali Acc: 0.856 Test Loss: 0.696 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.8076057434082031
Epoch: 48, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.675 Vali Acc: 0.872 Test Loss: 0.675 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872215).  Saving model ...
Epoch: 49 cost time: 0.8126497268676758
Epoch: 49, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.688 Vali Acc: 0.861 Test Loss: 0.688 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8140988349914551
Epoch: 50, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.704 Vali Acc: 0.861 Test Loss: 0.704 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 45519
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.947713851928711
Epoch: 1, Steps: 12 | Train Loss: 2.769 Vali Loss: 2.701 Vali Acc: 0.111 Test Loss: 2.701 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 0.7864313125610352
Epoch: 2, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.667 Vali Acc: 0.150 Test Loss: 2.667 Test Acc: 0.150
Validation loss decreased (-0.111084 --> -0.149973).  Saving model ...
Epoch: 3 cost time: 0.7636783123016357
Epoch: 3, Steps: 12 | Train Loss: 2.654 Vali Loss: 2.609 Vali Acc: 0.172 Test Loss: 2.609 Test Acc: 0.172
Validation loss decreased (-0.149973 --> -0.172196).  Saving model ...
Epoch: 4 cost time: 0.748723030090332
Epoch: 4, Steps: 12 | Train Loss: 2.586 Vali Loss: 2.527 Vali Acc: 0.250 Test Loss: 2.527 Test Acc: 0.250
Validation loss decreased (-0.172196 --> -0.249975).  Saving model ...
Epoch: 5 cost time: 0.8153078556060791
Epoch: 5, Steps: 12 | Train Loss: 2.490 Vali Loss: 2.432 Vali Acc: 0.361 Test Loss: 2.432 Test Acc: 0.361
Validation loss decreased (-0.249975 --> -0.361087).  Saving model ...
Epoch: 6 cost time: 0.7937915325164795
Epoch: 6, Steps: 12 | Train Loss: 2.360 Vali Loss: 2.326 Vali Acc: 0.428 Test Loss: 2.326 Test Acc: 0.428
Validation loss decreased (-0.361087 --> -0.427755).  Saving model ...
Epoch: 7 cost time: 0.7460095882415771
Epoch: 7, Steps: 12 | Train Loss: 2.220 Vali Loss: 2.195 Vali Acc: 0.461 Test Loss: 2.195 Test Acc: 0.461
Validation loss decreased (-0.427755 --> -0.461089).  Saving model ...
Epoch: 8 cost time: 0.7834794521331787
Epoch: 8, Steps: 12 | Train Loss: 2.065 Vali Loss: 2.042 Vali Acc: 0.500 Test Loss: 2.042 Test Acc: 0.500
Validation loss decreased (-0.461089 --> -0.499980).  Saving model ...
Epoch: 9 cost time: 0.8232080936431885
Epoch: 9, Steps: 12 | Train Loss: 1.929 Vali Loss: 1.867 Vali Acc: 0.556 Test Loss: 1.867 Test Acc: 0.556
Validation loss decreased (-0.499980 --> -0.555537).  Saving model ...
Epoch: 10 cost time: 0.852020263671875
Epoch: 10, Steps: 12 | Train Loss: 1.700 Vali Loss: 1.722 Vali Acc: 0.600 Test Loss: 1.722 Test Acc: 0.600
Validation loss decreased (-0.555537 --> -0.599983).  Saving model ...
Epoch: 11 cost time: 0.7870156764984131
Epoch: 11, Steps: 12 | Train Loss: 1.543 Vali Loss: 1.574 Vali Acc: 0.628 Test Loss: 1.574 Test Acc: 0.628
Validation loss decreased (-0.599983 --> -0.627762).  Saving model ...
Epoch: 12 cost time: 0.7710139751434326
Epoch: 12, Steps: 12 | Train Loss: 1.332 Vali Loss: 1.436 Vali Acc: 0.639 Test Loss: 1.436 Test Acc: 0.639
Validation loss decreased (-0.627762 --> -0.638875).  Saving model ...
Epoch: 13 cost time: 0.7803125381469727
Epoch: 13, Steps: 12 | Train Loss: 1.198 Vali Loss: 1.326 Vali Acc: 0.650 Test Loss: 1.326 Test Acc: 0.650
Validation loss decreased (-0.638875 --> -0.649987).  Saving model ...
Epoch: 14 cost time: 0.7658123970031738
Epoch: 14, Steps: 12 | Train Loss: 1.054 Vali Loss: 1.239 Vali Acc: 0.661 Test Loss: 1.239 Test Acc: 0.661
Validation loss decreased (-0.649987 --> -0.661099).  Saving model ...
Epoch: 15 cost time: 0.7724323272705078
Epoch: 15, Steps: 12 | Train Loss: 0.926 Vali Loss: 1.146 Vali Acc: 0.678 Test Loss: 1.146 Test Acc: 0.678
Validation loss decreased (-0.661099 --> -0.677766).  Saving model ...
Epoch: 16 cost time: 0.7924997806549072
Epoch: 16, Steps: 12 | Train Loss: 0.840 Vali Loss: 1.084 Vali Acc: 0.672 Test Loss: 1.084 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.780083179473877
Epoch: 17, Steps: 12 | Train Loss: 0.741 Vali Loss: 1.028 Vali Acc: 0.694 Test Loss: 1.028 Test Acc: 0.694
Validation loss decreased (-0.677766 --> -0.694434).  Saving model ...
Epoch: 18 cost time: 0.7617654800415039
Epoch: 18, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.971 Vali Acc: 0.694 Test Loss: 0.971 Test Acc: 0.694
Validation loss decreased (-0.694434 --> -0.694435).  Saving model ...
Epoch: 19 cost time: 0.7984867095947266
Epoch: 19, Steps: 12 | Train Loss: 0.626 Vali Loss: 0.925 Vali Acc: 0.711 Test Loss: 0.925 Test Acc: 0.711
Validation loss decreased (-0.694435 --> -0.711102).  Saving model ...
Epoch: 20 cost time: 0.7311558723449707
Epoch: 20, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.887 Vali Acc: 0.711 Test Loss: 0.887 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711102).  Saving model ...
Epoch: 21 cost time: 0.7675385475158691
Epoch: 21, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.847 Vali Acc: 0.722 Test Loss: 0.847 Test Acc: 0.722
Validation loss decreased (-0.711102 --> -0.722214).  Saving model ...
Epoch: 22 cost time: 0.789438009262085
Epoch: 22, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.798 Vali Acc: 0.744 Test Loss: 0.798 Test Acc: 0.744
Validation loss decreased (-0.722214 --> -0.744436).  Saving model ...
Epoch: 23 cost time: 0.8480808734893799
Epoch: 23, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.757 Vali Acc: 0.767 Test Loss: 0.757 Test Acc: 0.767
Validation loss decreased (-0.744436 --> -0.766659).  Saving model ...
Epoch: 24 cost time: 0.7903256416320801
Epoch: 24, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.738 Vali Acc: 0.783 Test Loss: 0.738 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783326).  Saving model ...
Epoch: 25 cost time: 0.7787775993347168
Epoch: 25, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.711 Vali Acc: 0.806 Test Loss: 0.711 Test Acc: 0.806
Validation loss decreased (-0.783326 --> -0.805548).  Saving model ...
Epoch: 26 cost time: 0.7846229076385498
Epoch: 26, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.709 Vali Acc: 0.794 Test Loss: 0.709 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7956924438476562
Epoch: 27, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.672 Vali Acc: 0.806 Test Loss: 0.672 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805549).  Saving model ...
Epoch: 28 cost time: 0.8044981956481934
Epoch: 28, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.678 Vali Acc: 0.811 Test Loss: 0.678 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811104).  Saving model ...
Epoch: 29 cost time: 0.8090605735778809
Epoch: 29, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.655 Vali Acc: 0.817 Test Loss: 0.655 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 30 cost time: 0.8016929626464844
Epoch: 30, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.633 Vali Acc: 0.800 Test Loss: 0.633 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7900419235229492
Epoch: 31, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.628 Vali Acc: 0.811 Test Loss: 0.628 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8099079132080078
Epoch: 32, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.626 Vali Acc: 0.828 Test Loss: 0.626 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827772).  Saving model ...
Epoch: 33 cost time: 0.8228437900543213
Epoch: 33, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.604 Vali Acc: 0.833 Test Loss: 0.604 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833327).  Saving model ...
Epoch: 34 cost time: 0.7917635440826416
Epoch: 34, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.602 Vali Acc: 0.839 Test Loss: 0.602 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 35 cost time: 0.8160326480865479
Epoch: 35, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.593 Vali Acc: 0.833 Test Loss: 0.593 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8177406787872314
Epoch: 36, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.609 Vali Acc: 0.839 Test Loss: 0.609 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8257999420166016
Epoch: 37, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.614 Vali Acc: 0.839 Test Loss: 0.614 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7657268047332764
Epoch: 38, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.603 Vali Acc: 0.828 Test Loss: 0.603 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8081679344177246
Epoch: 39, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 40 cost time: 0.8033111095428467
Epoch: 40, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.606 Vali Acc: 0.844 Test Loss: 0.606 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8027253150939941
Epoch: 41, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.601 Vali Acc: 0.850 Test Loss: 0.601 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8235571384429932
Epoch: 42, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.619 Vali Acc: 0.833 Test Loss: 0.619 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7665951251983643
Epoch: 43, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 44 cost time: 0.78043532371521
Epoch: 44, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.611 Vali Acc: 0.861 Test Loss: 0.611 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 45 cost time: 0.809067964553833
Epoch: 45, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.613 Vali Acc: 0.856 Test Loss: 0.613 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7998044490814209
Epoch: 46, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.623 Vali Acc: 0.839 Test Loss: 0.623 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7754926681518555
Epoch: 47, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.620 Vali Acc: 0.850 Test Loss: 0.620 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7731263637542725
Epoch: 48, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.632 Vali Acc: 0.850 Test Loss: 0.632 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8027939796447754
Epoch: 49, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.628 Vali Acc: 0.844 Test Loss: 0.628 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.7856466770172119
Epoch: 50, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.630 Vali Acc: 0.861 Test Loss: 0.630 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 41743
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.004938840866089
Epoch: 1, Steps: 12 | Train Loss: 2.730 Vali Loss: 2.717 Vali Acc: 0.089 Test Loss: 2.717 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 0.7883574962615967
Epoch: 2, Steps: 12 | Train Loss: 2.674 Vali Loss: 2.677 Vali Acc: 0.100 Test Loss: 2.677 Test Acc: 0.100
Validation loss decreased (-0.088862 --> -0.099973).  Saving model ...
Epoch: 3 cost time: 0.7858791351318359
Epoch: 3, Steps: 12 | Train Loss: 2.624 Vali Loss: 2.611 Vali Acc: 0.156 Test Loss: 2.611 Test Acc: 0.156
Validation loss decreased (-0.099973 --> -0.155529).  Saving model ...
Epoch: 4 cost time: 0.7878670692443848
Epoch: 4, Steps: 12 | Train Loss: 2.536 Vali Loss: 2.527 Vali Acc: 0.244 Test Loss: 2.527 Test Acc: 0.244
Validation loss decreased (-0.155529 --> -0.244419).  Saving model ...
Epoch: 5 cost time: 0.819282054901123
Epoch: 5, Steps: 12 | Train Loss: 2.457 Vali Loss: 2.427 Vali Acc: 0.328 Test Loss: 2.427 Test Acc: 0.328
Validation loss decreased (-0.244419 --> -0.327754).  Saving model ...
Epoch: 6 cost time: 0.8318679332733154
Epoch: 6, Steps: 12 | Train Loss: 2.357 Vali Loss: 2.330 Vali Acc: 0.389 Test Loss: 2.330 Test Acc: 0.389
Validation loss decreased (-0.327754 --> -0.388866).  Saving model ...
Epoch: 7 cost time: 0.8491647243499756
Epoch: 7, Steps: 12 | Train Loss: 2.203 Vali Loss: 2.208 Vali Acc: 0.439 Test Loss: 2.208 Test Acc: 0.439
Validation loss decreased (-0.388866 --> -0.438867).  Saving model ...
Epoch: 8 cost time: 0.8408138751983643
Epoch: 8, Steps: 12 | Train Loss: 2.056 Vali Loss: 2.071 Vali Acc: 0.472 Test Loss: 2.071 Test Acc: 0.472
Validation loss decreased (-0.438867 --> -0.472202).  Saving model ...
Epoch: 9 cost time: 0.8575751781463623
Epoch: 9, Steps: 12 | Train Loss: 1.911 Vali Loss: 1.926 Vali Acc: 0.472 Test Loss: 1.926 Test Acc: 0.472
Validation loss decreased (-0.472202 --> -0.472203).  Saving model ...
Epoch: 10 cost time: 0.853339433670044
Epoch: 10, Steps: 12 | Train Loss: 1.729 Vali Loss: 1.774 Vali Acc: 0.539 Test Loss: 1.774 Test Acc: 0.539
Validation loss decreased (-0.472203 --> -0.538871).  Saving model ...
Epoch: 11 cost time: 0.7664132118225098
Epoch: 11, Steps: 12 | Train Loss: 1.619 Vali Loss: 1.636 Vali Acc: 0.583 Test Loss: 1.636 Test Acc: 0.583
Validation loss decreased (-0.538871 --> -0.583317).  Saving model ...
Epoch: 12 cost time: 0.8069643974304199
Epoch: 12, Steps: 12 | Train Loss: 1.476 Vali Loss: 1.512 Vali Acc: 0.606 Test Loss: 1.512 Test Acc: 0.606
Validation loss decreased (-0.583317 --> -0.605540).  Saving model ...
Epoch: 13 cost time: 0.7962734699249268
Epoch: 13, Steps: 12 | Train Loss: 1.256 Vali Loss: 1.395 Vali Acc: 0.656 Test Loss: 1.395 Test Acc: 0.656
Validation loss decreased (-0.605540 --> -0.655542).  Saving model ...
Epoch: 14 cost time: 0.8051164150238037
Epoch: 14, Steps: 12 | Train Loss: 1.204 Vali Loss: 1.277 Vali Acc: 0.667 Test Loss: 1.277 Test Acc: 0.667
Validation loss decreased (-0.655542 --> -0.666654).  Saving model ...
Epoch: 15 cost time: 0.8115534782409668
Epoch: 15, Steps: 12 | Train Loss: 1.039 Vali Loss: 1.174 Vali Acc: 0.667 Test Loss: 1.174 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666655).  Saving model ...
Epoch: 16 cost time: 0.7933907508850098
Epoch: 16, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.101 Vali Acc: 0.672 Test Loss: 1.101 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672211).  Saving model ...
Epoch: 17 cost time: 0.7710912227630615
Epoch: 17, Steps: 12 | Train Loss: 0.850 Vali Loss: 1.050 Vali Acc: 0.683 Test Loss: 1.050 Test Acc: 0.683
Validation loss decreased (-0.672211 --> -0.683323).  Saving model ...
Epoch: 18 cost time: 0.8373117446899414
Epoch: 18, Steps: 12 | Train Loss: 0.846 Vali Loss: 1.000 Vali Acc: 0.711 Test Loss: 1.000 Test Acc: 0.711
Validation loss decreased (-0.683323 --> -0.711101).  Saving model ...
Epoch: 19 cost time: 0.7591071128845215
Epoch: 19, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.937 Vali Acc: 0.711 Test Loss: 0.937 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711102).  Saving model ...
Epoch: 20 cost time: 0.7489972114562988
Epoch: 20, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.894 Vali Acc: 0.728 Test Loss: 0.894 Test Acc: 0.728
Validation loss decreased (-0.711102 --> -0.727769).  Saving model ...
Epoch: 21 cost time: 0.7516756057739258
Epoch: 21, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.840 Vali Acc: 0.739 Test Loss: 0.840 Test Acc: 0.739
Validation loss decreased (-0.727769 --> -0.738880).  Saving model ...
Epoch: 22 cost time: 0.6938841342926025
Epoch: 22, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.812 Vali Acc: 0.733 Test Loss: 0.812 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8449287414550781
Epoch: 23, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.779 Vali Acc: 0.772 Test Loss: 0.779 Test Acc: 0.772
Validation loss decreased (-0.738880 --> -0.772214).  Saving model ...
Epoch: 24 cost time: 0.8207616806030273
Epoch: 24, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.736 Vali Acc: 0.772 Test Loss: 0.736 Test Acc: 0.772
Validation loss decreased (-0.772214 --> -0.772215).  Saving model ...
Epoch: 25 cost time: 0.8660323619842529
Epoch: 25, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.714 Vali Acc: 0.800 Test Loss: 0.714 Test Acc: 0.800
Validation loss decreased (-0.772215 --> -0.799993).  Saving model ...
Epoch: 26 cost time: 0.8204483985900879
Epoch: 26, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.692 Vali Acc: 0.806 Test Loss: 0.692 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 27 cost time: 0.8418312072753906
Epoch: 27, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.690 Vali Acc: 0.817 Test Loss: 0.690 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816660).  Saving model ...
Epoch: 28 cost time: 0.854367733001709
Epoch: 28, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.651 Vali Acc: 0.811 Test Loss: 0.651 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8089783191680908
Epoch: 29, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.645 Vali Acc: 0.839 Test Loss: 0.645 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838882).  Saving model ...
Epoch: 30 cost time: 0.8555543422698975
Epoch: 30, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.602 Vali Acc: 0.811 Test Loss: 0.602 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8703505992889404
Epoch: 31, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.589 Vali Acc: 0.822 Test Loss: 0.589 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.848341703414917
Epoch: 32, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.591 Vali Acc: 0.844 Test Loss: 0.591 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844439).  Saving model ...
Epoch: 33 cost time: 0.8399429321289062
Epoch: 33, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.576 Vali Acc: 0.844 Test Loss: 0.576 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 34 cost time: 0.8421628475189209
Epoch: 34, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.566 Vali Acc: 0.833 Test Loss: 0.566 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8132257461547852
Epoch: 35, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.567 Vali Acc: 0.839 Test Loss: 0.567 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8307673931121826
Epoch: 36, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.565 Vali Acc: 0.839 Test Loss: 0.565 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8018689155578613
Epoch: 37, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 38 cost time: 0.8200936317443848
Epoch: 38, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7957053184509277
Epoch: 39, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.572 Vali Acc: 0.828 Test Loss: 0.572 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8225255012512207
Epoch: 40, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.551 Vali Acc: 0.844 Test Loss: 0.551 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7689216136932373
Epoch: 41, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6958730220794678
Epoch: 42, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.550 Vali Acc: 0.844 Test Loss: 0.550 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7259366512298584
Epoch: 43, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.573 Vali Acc: 0.844 Test Loss: 0.573 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6699070930480957
Epoch: 44, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.564 Vali Acc: 0.844 Test Loss: 0.564 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.7332503795623779
Epoch: 45, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.549 Vali Acc: 0.844 Test Loss: 0.549 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.7362263202667236
Epoch: 46, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.533 Vali Acc: 0.867 Test Loss: 0.533 Test Acc: 0.867
Validation loss decreased (-0.849995 --> -0.866661).  Saving model ...
Epoch: 47 cost time: 0.7254109382629395
Epoch: 47, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.529 Vali Acc: 0.878 Test Loss: 0.529 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 48 cost time: 0.7152276039123535
Epoch: 48, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.535 Vali Acc: 0.867 Test Loss: 0.535 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7429769039154053
Epoch: 49, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.544 Vali Acc: 0.867 Test Loss: 0.544 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7544593811035156
Epoch: 50, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.528 Vali Acc: 0.861 Test Loss: 0.528 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 39887
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8323357105255127
Epoch: 1, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.692 Vali Acc: 0.022 Test Loss: 2.692 Test Acc: 0.022
Validation loss decreased (inf --> -0.022195).  Saving model ...
Epoch: 2 cost time: 0.812124490737915
Epoch: 2, Steps: 12 | Train Loss: 2.699 Vali Loss: 2.663 Vali Acc: 0.061 Test Loss: 2.663 Test Acc: 0.061
Validation loss decreased (-0.022195 --> -0.061084).  Saving model ...
Epoch: 3 cost time: 0.7287483215332031
Epoch: 3, Steps: 12 | Train Loss: 2.639 Vali Loss: 2.616 Vali Acc: 0.139 Test Loss: 2.616 Test Acc: 0.139
Validation loss decreased (-0.061084 --> -0.138863).  Saving model ...
Epoch: 4 cost time: 0.6658878326416016
Epoch: 4, Steps: 12 | Train Loss: 2.558 Vali Loss: 2.555 Vali Acc: 0.233 Test Loss: 2.555 Test Acc: 0.233
Validation loss decreased (-0.138863 --> -0.233308).  Saving model ...
Epoch: 5 cost time: 0.7190358638763428
Epoch: 5, Steps: 12 | Train Loss: 2.513 Vali Loss: 2.482 Vali Acc: 0.272 Test Loss: 2.482 Test Acc: 0.272
Validation loss decreased (-0.233308 --> -0.272197).  Saving model ...
Epoch: 6 cost time: 0.6681389808654785
Epoch: 6, Steps: 12 | Train Loss: 2.410 Vali Loss: 2.394 Vali Acc: 0.383 Test Loss: 2.394 Test Acc: 0.383
Validation loss decreased (-0.272197 --> -0.383309).  Saving model ...
Epoch: 7 cost time: 0.6775112152099609
Epoch: 7, Steps: 12 | Train Loss: 2.326 Vali Loss: 2.297 Vali Acc: 0.417 Test Loss: 2.297 Test Acc: 0.417
Validation loss decreased (-0.383309 --> -0.416644).  Saving model ...
Epoch: 8 cost time: 0.6072442531585693
Epoch: 8, Steps: 12 | Train Loss: 2.186 Vali Loss: 2.194 Vali Acc: 0.500 Test Loss: 2.194 Test Acc: 0.500
Validation loss decreased (-0.416644 --> -0.499978).  Saving model ...
Epoch: 9 cost time: 0.7174346446990967
Epoch: 9, Steps: 12 | Train Loss: 2.062 Vali Loss: 2.063 Vali Acc: 0.506 Test Loss: 2.063 Test Acc: 0.506
Validation loss decreased (-0.499978 --> -0.505535).  Saving model ...
Epoch: 10 cost time: 0.7112102508544922
Epoch: 10, Steps: 12 | Train Loss: 1.891 Vali Loss: 1.911 Vali Acc: 0.561 Test Loss: 1.911 Test Acc: 0.561
Validation loss decreased (-0.505535 --> -0.561092).  Saving model ...
Epoch: 11 cost time: 0.7209019660949707
Epoch: 11, Steps: 12 | Train Loss: 1.741 Vali Loss: 1.769 Vali Acc: 0.550 Test Loss: 1.769 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6844620704650879
Epoch: 12, Steps: 12 | Train Loss: 1.596 Vali Loss: 1.624 Vali Acc: 0.611 Test Loss: 1.624 Test Acc: 0.611
Validation loss decreased (-0.561092 --> -0.611095).  Saving model ...
Epoch: 13 cost time: 0.5896663665771484
Epoch: 13, Steps: 12 | Train Loss: 1.393 Vali Loss: 1.487 Vali Acc: 0.644 Test Loss: 1.487 Test Acc: 0.644
Validation loss decreased (-0.611095 --> -0.644430).  Saving model ...
Epoch: 14 cost time: 0.6042635440826416
Epoch: 14, Steps: 12 | Train Loss: 1.298 Vali Loss: 1.360 Vali Acc: 0.650 Test Loss: 1.360 Test Acc: 0.650
Validation loss decreased (-0.644430 --> -0.649986).  Saving model ...
Epoch: 15 cost time: 0.6296980381011963
Epoch: 15, Steps: 12 | Train Loss: 1.151 Vali Loss: 1.259 Vali Acc: 0.700 Test Loss: 1.259 Test Acc: 0.700
Validation loss decreased (-0.649986 --> -0.699987).  Saving model ...
Epoch: 16 cost time: 0.6134226322174072
Epoch: 16, Steps: 12 | Train Loss: 1.012 Vali Loss: 1.162 Vali Acc: 0.700 Test Loss: 1.162 Test Acc: 0.700
Validation loss decreased (-0.699987 --> -0.699988).  Saving model ...
Epoch: 17 cost time: 0.630805492401123
Epoch: 17, Steps: 12 | Train Loss: 0.979 Vali Loss: 1.056 Vali Acc: 0.722 Test Loss: 1.056 Test Acc: 0.722
Validation loss decreased (-0.699988 --> -0.722212).  Saving model ...
Epoch: 18 cost time: 0.7460482120513916
Epoch: 18, Steps: 12 | Train Loss: 0.807 Vali Loss: 0.965 Vali Acc: 0.744 Test Loss: 0.965 Test Acc: 0.744
Validation loss decreased (-0.722212 --> -0.744435).  Saving model ...
Epoch: 19 cost time: 0.6521356105804443
Epoch: 19, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.908 Vali Acc: 0.783 Test Loss: 0.908 Test Acc: 0.783
Validation loss decreased (-0.744435 --> -0.783324).  Saving model ...
Epoch: 20 cost time: 0.7549009323120117
Epoch: 20, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.855 Vali Acc: 0.772 Test Loss: 0.855 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7415392398834229
Epoch: 21, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.805 Vali Acc: 0.772 Test Loss: 0.805 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6709561347961426
Epoch: 22, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.776 Vali Acc: 0.778 Test Loss: 0.776 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7077054977416992
Epoch: 23, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.716 Vali Acc: 0.783 Test Loss: 0.716 Test Acc: 0.783
Validation loss decreased (-0.783324 --> -0.783326).  Saving model ...
Epoch: 24 cost time: 0.6165339946746826
Epoch: 24, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.677 Vali Acc: 0.783 Test Loss: 0.677 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783327).  Saving model ...
Epoch: 25 cost time: 0.7515397071838379
Epoch: 25, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.663 Vali Acc: 0.789 Test Loss: 0.663 Test Acc: 0.789
Validation loss decreased (-0.783327 --> -0.788882).  Saving model ...
Epoch: 26 cost time: 0.7411928176879883
Epoch: 26, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.644 Vali Acc: 0.800 Test Loss: 0.644 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799994).  Saving model ...
Epoch: 27 cost time: 0.7524654865264893
Epoch: 27, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.610 Vali Acc: 0.806 Test Loss: 0.610 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.805549).  Saving model ...
Epoch: 28 cost time: 0.6790268421173096
Epoch: 28, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.593 Vali Acc: 0.817 Test Loss: 0.593 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816661).  Saving model ...
Epoch: 29 cost time: 0.7397494316101074
Epoch: 29, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.572 Vali Acc: 0.828 Test Loss: 0.572 Test Acc: 0.828
Validation loss decreased (-0.816661 --> -0.827772).  Saving model ...
Epoch: 30 cost time: 0.8049840927124023
Epoch: 30, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.549 Vali Acc: 0.844 Test Loss: 0.549 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844439).  Saving model ...
Epoch: 31 cost time: 0.6272311210632324
Epoch: 31, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 32 cost time: 0.7858054637908936
Epoch: 32, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 33 cost time: 0.7152042388916016
Epoch: 33, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.522 Vali Acc: 0.844 Test Loss: 0.522 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.722196102142334
Epoch: 34, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.515 Vali Acc: 0.856 Test Loss: 0.515 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 35 cost time: 0.6775133609771729
Epoch: 35, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.522 Vali Acc: 0.856 Test Loss: 0.522 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7017467021942139
Epoch: 36, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.494 Vali Acc: 0.867 Test Loss: 0.494 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866662).  Saving model ...
Epoch: 37 cost time: 0.7190601825714111
Epoch: 37, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.486 Vali Acc: 0.861 Test Loss: 0.486 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6849985122680664
Epoch: 38, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.483 Vali Acc: 0.867 Test Loss: 0.483 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 39 cost time: 0.6670815944671631
Epoch: 39, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.484 Vali Acc: 0.861 Test Loss: 0.484 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.745105504989624
Epoch: 40, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.474 Vali Acc: 0.872 Test Loss: 0.474 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 41 cost time: 0.6659834384918213
Epoch: 41, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.477 Vali Acc: 0.867 Test Loss: 0.477 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7073993682861328
Epoch: 42, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.471 Vali Acc: 0.867 Test Loss: 0.471 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6870565414428711
Epoch: 43, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.459 Vali Acc: 0.872 Test Loss: 0.459 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872218).  Saving model ...
Epoch: 44 cost time: 0.6689109802246094
Epoch: 44, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.471 Vali Acc: 0.872 Test Loss: 0.471 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6718752384185791
Epoch: 45, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6984226703643799
Epoch: 46, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.475 Vali Acc: 0.867 Test Loss: 0.475 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.7369115352630615
Epoch: 47, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.477 Vali Acc: 0.861 Test Loss: 0.477 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.7196393013000488
Epoch: 48, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.484 Vali Acc: 0.883 Test Loss: 0.484 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883328).  Saving model ...
Epoch: 49 cost time: 0.7753901481628418
Epoch: 49, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.488 Vali Acc: 0.867 Test Loss: 0.488 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8477723598480225
Epoch: 50, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.482 Vali Acc: 0.867 Test Loss: 0.482 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 38063
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8670222759246826
Epoch: 1, Steps: 12 | Train Loss: 2.624 Vali Loss: 2.153 Vali Acc: 0.483 Test Loss: 2.153 Test Acc: 0.483
Validation loss decreased (inf --> -0.483312).  Saving model ...
Epoch: 2 cost time: 0.7728755474090576
Epoch: 2, Steps: 12 | Train Loss: 1.438 Vali Loss: 1.399 Vali Acc: 0.617 Test Loss: 1.399 Test Acc: 0.617
Validation loss decreased (-0.483312 --> -0.616653).  Saving model ...
Epoch: 3 cost time: 0.7549610137939453
Epoch: 3, Steps: 12 | Train Loss: 0.895 Vali Loss: 1.066 Vali Acc: 0.628 Test Loss: 1.066 Test Acc: 0.628
Validation loss decreased (-0.616653 --> -0.627767).  Saving model ...
Epoch: 4 cost time: 0.8172781467437744
Epoch: 4, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.921 Vali Acc: 0.733 Test Loss: 0.921 Test Acc: 0.733
Validation loss decreased (-0.627767 --> -0.733324).  Saving model ...
Epoch: 5 cost time: 0.7466089725494385
Epoch: 5, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.783 Vali Acc: 0.756 Test Loss: 0.783 Test Acc: 0.756
Validation loss decreased (-0.733324 --> -0.755548).  Saving model ...
Epoch: 6 cost time: 0.7117874622344971
Epoch: 6, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.906 Vali Acc: 0.722 Test Loss: 0.906 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7388277053833008
Epoch: 7, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.800 Vali Acc: 0.778 Test Loss: 0.800 Test Acc: 0.778
Validation loss decreased (-0.755548 --> -0.777770).  Saving model ...
Epoch: 8 cost time: 0.7576148509979248
Epoch: 8, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.782 Vali Acc: 0.761 Test Loss: 0.782 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7601649761199951
Epoch: 9, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.786 Vali Acc: 0.817 Test Loss: 0.786 Test Acc: 0.817
Validation loss decreased (-0.777770 --> -0.816659).  Saving model ...
Epoch: 10 cost time: 0.7394721508026123
Epoch: 10, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.781 Vali Acc: 0.772 Test Loss: 0.781 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8061239719390869
Epoch: 11, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.901 Vali Acc: 0.789 Test Loss: 0.901 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7699496746063232
Epoch: 12, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.961 Vali Acc: 0.794 Test Loss: 0.961 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7883942127227783
Epoch: 13, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.807 Vali Acc: 0.817 Test Loss: 0.807 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7812142372131348
Epoch: 14, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.868 Vali Acc: 0.833 Test Loss: 0.868 Test Acc: 0.833
Validation loss decreased (-0.816659 --> -0.833325).  Saving model ...
Epoch: 15 cost time: 0.7937004566192627
Epoch: 15, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.958 Vali Acc: 0.817 Test Loss: 0.958 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8154304027557373
Epoch: 16, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.005 Vali Acc: 0.828 Test Loss: 1.005 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8050727844238281
Epoch: 17, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.958 Vali Acc: 0.806 Test Loss: 0.958 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7873275279998779
Epoch: 18, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.921 Vali Acc: 0.844 Test Loss: 0.921 Test Acc: 0.844
Validation loss decreased (-0.833325 --> -0.844435).  Saving model ...
Epoch: 19 cost time: 0.816368579864502
Epoch: 19, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.911 Vali Acc: 0.844 Test Loss: 0.911 Test Acc: 0.844
Validation loss decreased (-0.844435 --> -0.844435).  Saving model ...
Epoch: 20 cost time: 0.7899434566497803
Epoch: 20, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.933 Vali Acc: 0.861 Test Loss: 0.933 Test Acc: 0.861
Validation loss decreased (-0.844435 --> -0.861102).  Saving model ...
Epoch: 21 cost time: 0.7918078899383545
Epoch: 21, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.961 Vali Acc: 0.856 Test Loss: 0.961 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7740943431854248
Epoch: 22, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.985 Vali Acc: 0.872 Test Loss: 0.985 Test Acc: 0.872
Validation loss decreased (-0.861102 --> -0.872212).  Saving model ...
Epoch: 23 cost time: 0.8119573593139648
Epoch: 23, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.979 Vali Acc: 0.844 Test Loss: 0.979 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8192813396453857
Epoch: 24, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.956 Vali Acc: 0.839 Test Loss: 0.956 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7705907821655273
Epoch: 25, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.005 Vali Acc: 0.856 Test Loss: 1.005 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7213821411132812
Epoch: 26, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.041 Vali Acc: 0.839 Test Loss: 1.041 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7165999412536621
Epoch: 27, Steps: 12 | Train Loss: 0.100 Vali Loss: 1.257 Vali Acc: 0.839 Test Loss: 1.257 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6805837154388428
Epoch: 28, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.239 Vali Acc: 0.828 Test Loss: 1.239 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7159323692321777
Epoch: 29, Steps: 12 | Train Loss: 0.098 Vali Loss: 1.958 Vali Acc: 0.800 Test Loss: 1.958 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7772781848907471
Epoch: 30, Steps: 12 | Train Loss: 0.345 Vali Loss: 1.608 Vali Acc: 0.833 Test Loss: 1.608 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8072609901428223
Epoch: 31, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.312 Vali Acc: 0.844 Test Loss: 1.312 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8009419441223145
Epoch: 32, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.575 Vali Acc: 0.850 Test Loss: 1.575 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 624911
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0086636543273926
Epoch: 1, Steps: 12 | Train Loss: 2.696 Vali Loss: 2.452 Vali Acc: 0.306 Test Loss: 2.452 Test Acc: 0.306
Validation loss decreased (inf --> -0.305531).  Saving model ...
Epoch: 2 cost time: 0.8192579746246338
Epoch: 2, Steps: 12 | Train Loss: 1.889 Vali Loss: 1.758 Vali Acc: 0.572 Test Loss: 1.758 Test Acc: 0.572
Validation loss decreased (-0.305531 --> -0.572205).  Saving model ...
Epoch: 3 cost time: 0.8490450382232666
Epoch: 3, Steps: 12 | Train Loss: 1.234 Vali Loss: 1.278 Vali Acc: 0.644 Test Loss: 1.278 Test Acc: 0.644
Validation loss decreased (-0.572205 --> -0.644432).  Saving model ...
Epoch: 4 cost time: 0.8071317672729492
Epoch: 4, Steps: 12 | Train Loss: 0.836 Vali Loss: 1.046 Vali Acc: 0.689 Test Loss: 1.046 Test Acc: 0.689
Validation loss decreased (-0.644432 --> -0.688878).  Saving model ...
Epoch: 5 cost time: 0.789879560470581
Epoch: 5, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.934 Vali Acc: 0.717 Test Loss: 0.934 Test Acc: 0.717
Validation loss decreased (-0.688878 --> -0.716657).  Saving model ...
Epoch: 6 cost time: 0.7751083374023438
Epoch: 6, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.792 Vali Acc: 0.767 Test Loss: 0.792 Test Acc: 0.767
Validation loss decreased (-0.716657 --> -0.766659).  Saving model ...
Epoch: 7 cost time: 0.7383949756622314
Epoch: 7, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.736 Vali Acc: 0.767 Test Loss: 0.736 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 8 cost time: 0.7662274837493896
Epoch: 8, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.735 Vali Acc: 0.767 Test Loss: 0.735 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 9 cost time: 0.7030103206634521
Epoch: 9, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.710 Vali Acc: 0.800 Test Loss: 0.710 Test Acc: 0.800
Validation loss decreased (-0.766659 --> -0.799993).  Saving model ...
Epoch: 10 cost time: 0.7851619720458984
Epoch: 10, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.727 Vali Acc: 0.800 Test Loss: 0.727 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7135779857635498
Epoch: 11, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.673 Vali Acc: 0.833 Test Loss: 0.673 Test Acc: 0.833
Validation loss decreased (-0.799993 --> -0.833327).  Saving model ...
Epoch: 12 cost time: 0.8108556270599365
Epoch: 12, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.685 Vali Acc: 0.800 Test Loss: 0.685 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7871189117431641
Epoch: 13, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.613 Vali Acc: 0.833 Test Loss: 0.613 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 14 cost time: 0.7621779441833496
Epoch: 14, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.672 Vali Acc: 0.806 Test Loss: 0.672 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7598152160644531
Epoch: 15, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.733 Vali Acc: 0.817 Test Loss: 0.733 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7955605983734131
Epoch: 16, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.733 Vali Acc: 0.778 Test Loss: 0.733 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.743485689163208
Epoch: 17, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.715 Vali Acc: 0.828 Test Loss: 0.715 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7578117847442627
Epoch: 18, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.807 Vali Acc: 0.794 Test Loss: 0.807 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7967016696929932
Epoch: 19, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.729 Vali Acc: 0.850 Test Loss: 0.729 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849993).  Saving model ...
Epoch: 20 cost time: 0.7691788673400879
Epoch: 20, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.725 Vali Acc: 0.844 Test Loss: 0.725 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.78202223777771
Epoch: 21, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.752 Vali Acc: 0.850 Test Loss: 0.752 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8290321826934814
Epoch: 22, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.759 Vali Acc: 0.844 Test Loss: 0.759 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7685575485229492
Epoch: 23, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.759 Vali Acc: 0.839 Test Loss: 0.759 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8271842002868652
Epoch: 24, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.823 Vali Acc: 0.856 Test Loss: 0.823 Test Acc: 0.856
Validation loss decreased (-0.849993 --> -0.855547).  Saving model ...
Epoch: 25 cost time: 0.7555992603302002
Epoch: 25, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.754 Vali Acc: 0.844 Test Loss: 0.754 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7622926235198975
Epoch: 26, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.742 Vali Acc: 0.850 Test Loss: 0.742 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7549452781677246
Epoch: 27, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.759 Vali Acc: 0.856 Test Loss: 0.759 Test Acc: 0.856
Validation loss decreased (-0.855547 --> -0.855548).  Saving model ...
Epoch: 28 cost time: 0.7368483543395996
Epoch: 28, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.771 Vali Acc: 0.856 Test Loss: 0.771 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7877609729766846
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.816 Vali Acc: 0.872 Test Loss: 0.816 Test Acc: 0.872
Validation loss decreased (-0.855548 --> -0.872214).  Saving model ...
Epoch: 30 cost time: 0.7339754104614258
Epoch: 30, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.823 Vali Acc: 0.872 Test Loss: 0.823 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7472634315490723
Epoch: 31, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.813 Vali Acc: 0.861 Test Loss: 0.813 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6162805557250977
Epoch: 32, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.853 Vali Acc: 0.867 Test Loss: 0.853 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6547026634216309
Epoch: 33, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.821 Vali Acc: 0.856 Test Loss: 0.821 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6347086429595947
Epoch: 34, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.834 Vali Acc: 0.861 Test Loss: 0.834 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6724622249603271
Epoch: 35, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.856 Vali Acc: 0.867 Test Loss: 0.856 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.5999722480773926
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.929 Vali Acc: 0.867 Test Loss: 0.929 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7909049987792969
Epoch: 37, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.919 Vali Acc: 0.850 Test Loss: 0.919 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7899723052978516
Epoch: 38, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.029 Vali Acc: 0.844 Test Loss: 1.029 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7792477607727051
Epoch: 39, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.997 Vali Acc: 0.828 Test Loss: 0.997 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 448527
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8708302974700928
Epoch: 1, Steps: 12 | Train Loss: 2.721 Vali Loss: 2.483 Vali Acc: 0.289 Test Loss: 2.483 Test Acc: 0.289
Validation loss decreased (inf --> -0.288864).  Saving model ...
Epoch: 2 cost time: 0.7966468334197998
Epoch: 2, Steps: 12 | Train Loss: 1.865 Vali Loss: 1.775 Vali Acc: 0.544 Test Loss: 1.775 Test Acc: 0.544
Validation loss decreased (-0.288864 --> -0.544427).  Saving model ...
Epoch: 3 cost time: 0.8294427394866943
Epoch: 3, Steps: 12 | Train Loss: 1.228 Vali Loss: 1.292 Vali Acc: 0.683 Test Loss: 1.292 Test Acc: 0.683
Validation loss decreased (-0.544427 --> -0.683320).  Saving model ...
Epoch: 4 cost time: 0.8173646926879883
Epoch: 4, Steps: 12 | Train Loss: 0.840 Vali Loss: 1.000 Vali Acc: 0.717 Test Loss: 1.000 Test Acc: 0.717
Validation loss decreased (-0.683320 --> -0.716657).  Saving model ...
Epoch: 5 cost time: 0.7883148193359375
Epoch: 5, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.901 Vali Acc: 0.744 Test Loss: 0.901 Test Acc: 0.744
Validation loss decreased (-0.716657 --> -0.744435).  Saving model ...
Epoch: 6 cost time: 0.7747704982757568
Epoch: 6, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.795 Vali Acc: 0.750 Test Loss: 0.795 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749992).  Saving model ...
Epoch: 7 cost time: 0.7009668350219727
Epoch: 7, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.695 Vali Acc: 0.800 Test Loss: 0.695 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 0.725111722946167
Epoch: 8, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.684 Vali Acc: 0.800 Test Loss: 0.684 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 9 cost time: 0.7484550476074219
Epoch: 9, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.648 Vali Acc: 0.811 Test Loss: 0.648 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811105).  Saving model ...
Epoch: 10 cost time: 0.7023758888244629
Epoch: 10, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.652 Vali Acc: 0.822 Test Loss: 0.652 Test Acc: 0.822
Validation loss decreased (-0.811105 --> -0.822216).  Saving model ...
Epoch: 11 cost time: 0.7306156158447266
Epoch: 11, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.654 Vali Acc: 0.794 Test Loss: 0.654 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7798800468444824
Epoch: 12, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.678 Vali Acc: 0.833 Test Loss: 0.678 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 13 cost time: 0.7540028095245361
Epoch: 13, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.626 Vali Acc: 0.800 Test Loss: 0.626 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.798630952835083
Epoch: 14, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.699 Vali Acc: 0.844 Test Loss: 0.699 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844437).  Saving model ...
Epoch: 15 cost time: 0.7223618030548096
Epoch: 15, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.621 Vali Acc: 0.839 Test Loss: 0.621 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7563090324401855
Epoch: 16, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.645 Vali Acc: 0.839 Test Loss: 0.645 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7619414329528809
Epoch: 17, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.701 Vali Acc: 0.839 Test Loss: 0.701 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8461651802062988
Epoch: 18, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.658 Vali Acc: 0.844 Test Loss: 0.658 Test Acc: 0.844
Validation loss decreased (-0.844437 --> -0.844438).  Saving model ...
Epoch: 19 cost time: 0.780541181564331
Epoch: 19, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.713 Vali Acc: 0.867 Test Loss: 0.713 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866660).  Saving model ...
Epoch: 20 cost time: 0.8157649040222168
Epoch: 20, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.794 Vali Acc: 0.872 Test Loss: 0.794 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872214).  Saving model ...
Epoch: 21 cost time: 0.807553768157959
Epoch: 21, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.725 Vali Acc: 0.883 Test Loss: 0.725 Test Acc: 0.883
Validation loss decreased (-0.872214 --> -0.883326).  Saving model ...
Epoch: 22 cost time: 0.805452823638916
Epoch: 22, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.744 Vali Acc: 0.872 Test Loss: 0.744 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7647626399993896
Epoch: 23, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.948 Vali Acc: 0.839 Test Loss: 0.948 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7539982795715332
Epoch: 24, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.736 Vali Acc: 0.872 Test Loss: 0.736 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.793912410736084
Epoch: 25, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.733 Vali Acc: 0.867 Test Loss: 0.733 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7357521057128906
Epoch: 26, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.711 Vali Acc: 0.878 Test Loss: 0.711 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7512836456298828
Epoch: 27, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.723 Vali Acc: 0.872 Test Loss: 0.723 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7293441295623779
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.748 Vali Acc: 0.872 Test Loss: 0.748 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7475972175598145
Epoch: 29, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.757 Vali Acc: 0.867 Test Loss: 0.757 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7759649753570557
Epoch: 30, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.816 Vali Acc: 0.872 Test Loss: 0.816 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7863965034484863
Epoch: 31, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.944 Vali Acc: 0.839 Test Loss: 0.944 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 448783
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.911212682723999
Epoch: 1, Steps: 12 | Train Loss: 2.712 Vali Loss: 2.505 Vali Acc: 0.239 Test Loss: 2.505 Test Acc: 0.239
Validation loss decreased (inf --> -0.238864).  Saving model ...
Epoch: 2 cost time: 0.7710850238800049
Epoch: 2, Steps: 12 | Train Loss: 2.062 Vali Loss: 1.968 Vali Acc: 0.528 Test Loss: 1.968 Test Acc: 0.528
Validation loss decreased (-0.238864 --> -0.527758).  Saving model ...
Epoch: 3 cost time: 0.7849488258361816
Epoch: 3, Steps: 12 | Train Loss: 1.454 Vali Loss: 1.465 Vali Acc: 0.644 Test Loss: 1.465 Test Acc: 0.644
Validation loss decreased (-0.527758 --> -0.644430).  Saving model ...
Epoch: 4 cost time: 0.7688367366790771
Epoch: 4, Steps: 12 | Train Loss: 1.030 Vali Loss: 1.185 Vali Acc: 0.678 Test Loss: 1.185 Test Acc: 0.678
Validation loss decreased (-0.644430 --> -0.677766).  Saving model ...
Epoch: 5 cost time: 0.7656967639923096
Epoch: 5, Steps: 12 | Train Loss: 0.756 Vali Loss: 0.989 Vali Acc: 0.717 Test Loss: 0.989 Test Acc: 0.717
Validation loss decreased (-0.677766 --> -0.716657).  Saving model ...
Epoch: 6 cost time: 0.8389191627502441
Epoch: 6, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.881 Vali Acc: 0.722 Test Loss: 0.881 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722213).  Saving model ...
Epoch: 7 cost time: 0.7853391170501709
Epoch: 7, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.834 Vali Acc: 0.756 Test Loss: 0.834 Test Acc: 0.756
Validation loss decreased (-0.722213 --> -0.755547).  Saving model ...
Epoch: 8 cost time: 0.7194211483001709
Epoch: 8, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.761 Vali Acc: 0.767 Test Loss: 0.761 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766659).  Saving model ...
Epoch: 9 cost time: 0.8118200302124023
Epoch: 9, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.695 Vali Acc: 0.811 Test Loss: 0.695 Test Acc: 0.811
Validation loss decreased (-0.766659 --> -0.811104).  Saving model ...
Epoch: 10 cost time: 0.7751548290252686
Epoch: 10, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.651 Vali Acc: 0.822 Test Loss: 0.651 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822216).  Saving model ...
Epoch: 11 cost time: 0.7998251914978027
Epoch: 11, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.600 Vali Acc: 0.828 Test Loss: 0.600 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 12 cost time: 0.7923619747161865
Epoch: 12, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.590 Vali Acc: 0.822 Test Loss: 0.590 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7850813865661621
Epoch: 13, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.612 Vali Acc: 0.833 Test Loss: 0.612 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833327).  Saving model ...
Epoch: 14 cost time: 0.8311488628387451
Epoch: 14, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.610 Vali Acc: 0.839 Test Loss: 0.610 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 15 cost time: 0.8382539749145508
Epoch: 15, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861106).  Saving model ...
Epoch: 16 cost time: 0.7710297107696533
Epoch: 16, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.596 Vali Acc: 0.856 Test Loss: 0.596 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7423043251037598
Epoch: 17, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.535 Vali Acc: 0.867 Test Loss: 0.535 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 18 cost time: 0.7686679363250732
Epoch: 18, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.582 Vali Acc: 0.872 Test Loss: 0.582 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 19 cost time: 0.7397541999816895
Epoch: 19, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.598 Vali Acc: 0.861 Test Loss: 0.598 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7543199062347412
Epoch: 20, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.593 Vali Acc: 0.872 Test Loss: 0.593 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7379739284515381
Epoch: 21, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.603 Vali Acc: 0.861 Test Loss: 0.603 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7780797481536865
Epoch: 22, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.619 Vali Acc: 0.867 Test Loss: 0.619 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7630283832550049
Epoch: 23, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.616 Vali Acc: 0.861 Test Loss: 0.616 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7878262996673584
Epoch: 24, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.627 Vali Acc: 0.872 Test Loss: 0.627 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7276523113250732
Epoch: 25, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.670 Vali Acc: 0.878 Test Loss: 0.670 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877771).  Saving model ...
Epoch: 26 cost time: 0.7225563526153564
Epoch: 26, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.721 Vali Acc: 0.861 Test Loss: 0.721 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7050182819366455
Epoch: 27, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.688 Vali Acc: 0.867 Test Loss: 0.688 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6505007743835449
Epoch: 28, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.700 Vali Acc: 0.861 Test Loss: 0.700 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7554118633270264
Epoch: 29, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.697 Vali Acc: 0.861 Test Loss: 0.697 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7556295394897461
Epoch: 30, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.701 Vali Acc: 0.872 Test Loss: 0.701 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7966856956481934
Epoch: 31, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.687 Vali Acc: 0.861 Test Loss: 0.687 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7538042068481445
Epoch: 32, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.716 Vali Acc: 0.867 Test Loss: 0.716 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8073334693908691
Epoch: 33, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.738 Vali Acc: 0.861 Test Loss: 0.738 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7914624214172363
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.745 Vali Acc: 0.867 Test Loss: 0.745 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.757880449295044
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.744 Vali Acc: 0.861 Test Loss: 0.744 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 395279
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9151899814605713
Epoch: 1, Steps: 12 | Train Loss: 2.675 Vali Loss: 2.546 Vali Acc: 0.222 Test Loss: 2.546 Test Acc: 0.222
Validation loss decreased (inf --> -0.222197).  Saving model ...
Epoch: 2 cost time: 0.7640173435211182
Epoch: 2, Steps: 12 | Train Loss: 2.178 Vali Loss: 2.065 Vali Acc: 0.483 Test Loss: 2.065 Test Acc: 0.483
Validation loss decreased (-0.222197 --> -0.483313).  Saving model ...
Epoch: 3 cost time: 0.6983237266540527
Epoch: 3, Steps: 12 | Train Loss: 1.621 Vali Loss: 1.580 Vali Acc: 0.633 Test Loss: 1.580 Test Acc: 0.633
Validation loss decreased (-0.483313 --> -0.633318).  Saving model ...
Epoch: 4 cost time: 0.7374422550201416
Epoch: 4, Steps: 12 | Train Loss: 1.242 Vali Loss: 1.291 Vali Acc: 0.661 Test Loss: 1.291 Test Acc: 0.661
Validation loss decreased (-0.633318 --> -0.661098).  Saving model ...
Epoch: 5 cost time: 0.6996233463287354
Epoch: 5, Steps: 12 | Train Loss: 1.034 Vali Loss: 1.080 Vali Acc: 0.700 Test Loss: 1.080 Test Acc: 0.700
Validation loss decreased (-0.661098 --> -0.699989).  Saving model ...
Epoch: 6 cost time: 0.632347583770752
Epoch: 6, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.930 Vali Acc: 0.694 Test Loss: 0.930 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6652677059173584
Epoch: 7, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.861 Vali Acc: 0.750 Test Loss: 0.861 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749991).  Saving model ...
Epoch: 8 cost time: 0.7842175960540771
Epoch: 8, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.796 Vali Acc: 0.772 Test Loss: 0.796 Test Acc: 0.772
Validation loss decreased (-0.749991 --> -0.772214).  Saving model ...
Epoch: 9 cost time: 0.7662563323974609
Epoch: 9, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.717 Vali Acc: 0.794 Test Loss: 0.717 Test Acc: 0.794
Validation loss decreased (-0.772214 --> -0.794437).  Saving model ...
Epoch: 10 cost time: 0.7513842582702637
Epoch: 10, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.690 Vali Acc: 0.800 Test Loss: 0.690 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 11 cost time: 0.7750420570373535
Epoch: 11, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.668 Vali Acc: 0.789 Test Loss: 0.668 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7534573078155518
Epoch: 12, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.610 Vali Acc: 0.822 Test Loss: 0.610 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 13 cost time: 0.7420721054077148
Epoch: 13, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.593 Vali Acc: 0.833 Test Loss: 0.593 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 14 cost time: 0.7572824954986572
Epoch: 14, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.571 Vali Acc: 0.822 Test Loss: 0.571 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7400603294372559
Epoch: 15, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.594 Vali Acc: 0.817 Test Loss: 0.594 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8120615482330322
Epoch: 16, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.589 Vali Acc: 0.839 Test Loss: 0.589 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 17 cost time: 0.770897388458252
Epoch: 17, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861106).  Saving model ...
Epoch: 18 cost time: 0.7863636016845703
Epoch: 18, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.763427734375
Epoch: 19, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.562 Vali Acc: 0.856 Test Loss: 0.562 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.772512674331665
Epoch: 20, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.531 Vali Acc: 0.867 Test Loss: 0.531 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 21 cost time: 0.7005078792572021
Epoch: 21, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.558 Vali Acc: 0.856 Test Loss: 0.558 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7106444835662842
Epoch: 22, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.579 Vali Acc: 0.867 Test Loss: 0.579 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7271382808685303
Epoch: 23, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.577 Vali Acc: 0.856 Test Loss: 0.577 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7471170425415039
Epoch: 24, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.578 Vali Acc: 0.861 Test Loss: 0.578 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.698512077331543
Epoch: 25, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.581 Vali Acc: 0.861 Test Loss: 0.581 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.715289831161499
Epoch: 26, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7326374053955078
Epoch: 27, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.605 Vali Acc: 0.867 Test Loss: 0.605 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7137043476104736
Epoch: 28, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.593 Vali Acc: 0.867 Test Loss: 0.593 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6655020713806152
Epoch: 29, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.604 Vali Acc: 0.867 Test Loss: 0.604 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7434585094451904
Epoch: 30, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.697 Vali Acc: 0.872 Test Loss: 0.697 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872215).  Saving model ...
Epoch: 31 cost time: 0.7237305641174316
Epoch: 31, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.654 Vali Acc: 0.872 Test Loss: 0.654 Test Acc: 0.872
Validation loss decreased (-0.872215 --> -0.872216).  Saving model ...
Epoch: 32 cost time: 0.7636475563049316
Epoch: 32, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.640 Vali Acc: 0.872 Test Loss: 0.640 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 33 cost time: 0.7279276847839355
Epoch: 33, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.679 Vali Acc: 0.872 Test Loss: 0.679 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8010783195495605
Epoch: 34, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.657 Vali Acc: 0.867 Test Loss: 0.657 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7530748844146729
Epoch: 35, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.627 Vali Acc: 0.856 Test Loss: 0.627 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7548904418945312
Epoch: 36, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.653 Vali Acc: 0.861 Test Loss: 0.653 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7462790012359619
Epoch: 37, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.647 Vali Acc: 0.861 Test Loss: 0.647 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7687077522277832
Epoch: 38, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.660 Vali Acc: 0.861 Test Loss: 0.660 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.78458571434021
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.678 Vali Acc: 0.861 Test Loss: 0.678 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.7362902164459229
Epoch: 40, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.688 Vali Acc: 0.872 Test Loss: 0.688 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.7235417366027832
Epoch: 41, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.698 Vali Acc: 0.867 Test Loss: 0.698 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.7057819366455078
Epoch: 42, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.712 Vali Acc: 0.867 Test Loss: 0.712 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 365071
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.811889886856079
Epoch: 1, Steps: 12 | Train Loss: 2.721 Vali Loss: 2.642 Vali Acc: 0.178 Test Loss: 2.642 Test Acc: 0.178
Validation loss decreased (inf --> -0.177751).  Saving model ...
Epoch: 2 cost time: 0.7688391208648682
Epoch: 2, Steps: 12 | Train Loss: 2.324 Vali Loss: 2.210 Vali Acc: 0.439 Test Loss: 2.210 Test Acc: 0.439
Validation loss decreased (-0.177751 --> -0.438867).  Saving model ...
Epoch: 3 cost time: 0.7533664703369141
Epoch: 3, Steps: 12 | Train Loss: 1.739 Vali Loss: 1.729 Vali Acc: 0.594 Test Loss: 1.729 Test Acc: 0.594
Validation loss decreased (-0.438867 --> -0.594427).  Saving model ...
Epoch: 4 cost time: 0.7995414733886719
Epoch: 4, Steps: 12 | Train Loss: 1.344 Vali Loss: 1.374 Vali Acc: 0.667 Test Loss: 1.374 Test Acc: 0.667
Validation loss decreased (-0.594427 --> -0.666653).  Saving model ...
Epoch: 5 cost time: 0.7658615112304688
Epoch: 5, Steps: 12 | Train Loss: 1.019 Vali Loss: 1.135 Vali Acc: 0.711 Test Loss: 1.135 Test Acc: 0.711
Validation loss decreased (-0.666653 --> -0.711100).  Saving model ...
Epoch: 6 cost time: 0.7841396331787109
Epoch: 6, Steps: 12 | Train Loss: 0.828 Vali Loss: 0.965 Vali Acc: 0.728 Test Loss: 0.965 Test Acc: 0.728
Validation loss decreased (-0.711100 --> -0.727768).  Saving model ...
Epoch: 7 cost time: 0.7462117671966553
Epoch: 7, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.886 Vali Acc: 0.756 Test Loss: 0.886 Test Acc: 0.756
Validation loss decreased (-0.727768 --> -0.755547).  Saving model ...
Epoch: 8 cost time: 0.724043607711792
Epoch: 8, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.795 Vali Acc: 0.767 Test Loss: 0.795 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766659).  Saving model ...
Epoch: 9 cost time: 0.722322940826416
Epoch: 9, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.719 Vali Acc: 0.794 Test Loss: 0.719 Test Acc: 0.794
Validation loss decreased (-0.766659 --> -0.794437).  Saving model ...
Epoch: 10 cost time: 0.8195734024047852
Epoch: 10, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.683 Vali Acc: 0.800 Test Loss: 0.683 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 11 cost time: 0.6955211162567139
Epoch: 11, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.626 Vali Acc: 0.833 Test Loss: 0.626 Test Acc: 0.833
Validation loss decreased (-0.799993 --> -0.833327).  Saving model ...
Epoch: 12 cost time: 0.7129876613616943
Epoch: 12, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.592 Vali Acc: 0.839 Test Loss: 0.592 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 13 cost time: 0.7080492973327637
Epoch: 13, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.576 Vali Acc: 0.822 Test Loss: 0.576 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7363457679748535
Epoch: 14, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.561 Vali Acc: 0.844 Test Loss: 0.561 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 15 cost time: 0.7048382759094238
Epoch: 15, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.545 Vali Acc: 0.856 Test Loss: 0.545 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 16 cost time: 0.7658112049102783
Epoch: 16, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.534 Vali Acc: 0.867 Test Loss: 0.534 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 17 cost time: 0.791053056716919
Epoch: 17, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.508 Vali Acc: 0.867 Test Loss: 0.508 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 18 cost time: 0.7599539756774902
Epoch: 18, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.499 Vali Acc: 0.872 Test Loss: 0.499 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 19 cost time: 0.7665812969207764
Epoch: 19, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.528 Vali Acc: 0.861 Test Loss: 0.528 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7346196174621582
Epoch: 20, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.517 Vali Acc: 0.872 Test Loss: 0.517 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.746258020401001
Epoch: 21, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.520 Vali Acc: 0.883 Test Loss: 0.520 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 22 cost time: 0.7799127101898193
Epoch: 22, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.564 Vali Acc: 0.872 Test Loss: 0.564 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.712559700012207
Epoch: 23, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.584 Vali Acc: 0.861 Test Loss: 0.584 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7725365161895752
Epoch: 24, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.568 Vali Acc: 0.861 Test Loss: 0.568 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.758746862411499
Epoch: 25, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.583 Vali Acc: 0.867 Test Loss: 0.583 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7325558662414551
Epoch: 26, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.616 Vali Acc: 0.878 Test Loss: 0.616 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7376174926757812
Epoch: 27, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.584 Vali Acc: 0.878 Test Loss: 0.584 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7469077110290527
Epoch: 28, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.585 Vali Acc: 0.878 Test Loss: 0.585 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7203752994537354
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.596 Vali Acc: 0.889 Test Loss: 0.596 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 30 cost time: 0.7409393787384033
Epoch: 30, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.599 Vali Acc: 0.867 Test Loss: 0.599 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7023758888244629
Epoch: 31, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.631 Vali Acc: 0.856 Test Loss: 0.631 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.744619607925415
Epoch: 32, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.642 Vali Acc: 0.867 Test Loss: 0.642 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7389223575592041
Epoch: 33, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.655 Vali Acc: 0.872 Test Loss: 0.655 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8091354370117188
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.637 Vali Acc: 0.867 Test Loss: 0.637 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7938919067382812
Epoch: 35, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.693 Vali Acc: 0.856 Test Loss: 0.693 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8671388626098633
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.671 Vali Acc: 0.872 Test Loss: 0.671 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7866060733795166
Epoch: 37, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.661 Vali Acc: 0.872 Test Loss: 0.661 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.806312084197998
Epoch: 38, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.760 Vali Acc: 0.861 Test Loss: 0.760 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7961037158966064
Epoch: 39, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.681 Vali Acc: 0.867 Test Loss: 0.681 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 350223
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9071967601776123
Epoch: 1, Steps: 12 | Train Loss: 2.775 Vali Loss: 2.603 Vali Acc: 0.128 Test Loss: 2.603 Test Acc: 0.128
Validation loss decreased (inf --> -0.127752).  Saving model ...
Epoch: 2 cost time: 0.7709696292877197
Epoch: 2, Steps: 12 | Train Loss: 2.394 Vali Loss: 2.264 Vali Acc: 0.450 Test Loss: 2.264 Test Acc: 0.450
Validation loss decreased (-0.127752 --> -0.449977).  Saving model ...
Epoch: 3 cost time: 0.7187142372131348
Epoch: 3, Steps: 12 | Train Loss: 1.893 Vali Loss: 1.824 Vali Acc: 0.650 Test Loss: 1.824 Test Acc: 0.650
Validation loss decreased (-0.449977 --> -0.649982).  Saving model ...
Epoch: 4 cost time: 0.7244961261749268
Epoch: 4, Steps: 12 | Train Loss: 1.494 Vali Loss: 1.469 Vali Acc: 0.706 Test Loss: 1.469 Test Acc: 0.706
Validation loss decreased (-0.649982 --> -0.705541).  Saving model ...
Epoch: 5 cost time: 0.7387540340423584
Epoch: 5, Steps: 12 | Train Loss: 1.132 Vali Loss: 1.262 Vali Acc: 0.706 Test Loss: 1.262 Test Acc: 0.706
Validation loss decreased (-0.705541 --> -0.705543).  Saving model ...
Epoch: 6 cost time: 0.7277441024780273
Epoch: 6, Steps: 12 | Train Loss: 0.916 Vali Loss: 1.077 Vali Acc: 0.711 Test Loss: 1.077 Test Acc: 0.711
Validation loss decreased (-0.705543 --> -0.711100).  Saving model ...
Epoch: 7 cost time: 0.7848575115203857
Epoch: 7, Steps: 12 | Train Loss: 0.785 Vali Loss: 0.936 Vali Acc: 0.744 Test Loss: 0.936 Test Acc: 0.744
Validation loss decreased (-0.711100 --> -0.744435).  Saving model ...
Epoch: 8 cost time: 0.753915548324585
Epoch: 8, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.881 Vali Acc: 0.750 Test Loss: 0.881 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 0.7659425735473633
Epoch: 9, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.777 Vali Acc: 0.778 Test Loss: 0.777 Test Acc: 0.778
Validation loss decreased (-0.749991 --> -0.777770).  Saving model ...
Epoch: 10 cost time: 0.7550418376922607
Epoch: 10, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.720 Vali Acc: 0.794 Test Loss: 0.720 Test Acc: 0.794
Validation loss decreased (-0.777770 --> -0.794437).  Saving model ...
Epoch: 11 cost time: 0.762049674987793
Epoch: 11, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.696 Vali Acc: 0.789 Test Loss: 0.696 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7400946617126465
Epoch: 12, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.607 Vali Acc: 0.817 Test Loss: 0.607 Test Acc: 0.817
Validation loss decreased (-0.794437 --> -0.816661).  Saving model ...
Epoch: 13 cost time: 0.7753627300262451
Epoch: 13, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.569 Vali Acc: 0.833 Test Loss: 0.569 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833328).  Saving model ...
Epoch: 14 cost time: 0.7644555568695068
Epoch: 14, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.546 Vali Acc: 0.833 Test Loss: 0.546 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 15 cost time: 0.7773499488830566
Epoch: 15, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844439).  Saving model ...
Epoch: 16 cost time: 0.8192398548126221
Epoch: 16, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 17 cost time: 0.8185057640075684
Epoch: 17, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.493 Vali Acc: 0.844 Test Loss: 0.493 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844440).  Saving model ...
Epoch: 18 cost time: 0.8058562278747559
Epoch: 18, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
Validation loss decreased (-0.844440 --> -0.855551).  Saving model ...
Epoch: 19 cost time: 0.7526414394378662
Epoch: 19, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.473 Vali Acc: 0.872 Test Loss: 0.473 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872217).  Saving model ...
Epoch: 20 cost time: 0.7366724014282227
Epoch: 20, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8633286952972412
Epoch: 21, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.496 Vali Acc: 0.839 Test Loss: 0.496 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7244417667388916
Epoch: 22, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.498 Vali Acc: 0.878 Test Loss: 0.498 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 23 cost time: 0.7345626354217529
Epoch: 23, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.562 Vali Acc: 0.867 Test Loss: 0.562 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7063112258911133
Epoch: 24, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.483 Vali Acc: 0.867 Test Loss: 0.483 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6911463737487793
Epoch: 25, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.498 Vali Acc: 0.867 Test Loss: 0.498 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7430987358093262
Epoch: 26, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.557 Vali Acc: 0.844 Test Loss: 0.557 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7372925281524658
Epoch: 27, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.747917890548706
Epoch: 28, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.527 Vali Acc: 0.856 Test Loss: 0.527 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7701582908630371
Epoch: 29, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7659962177276611
Epoch: 30, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.544 Vali Acc: 0.856 Test Loss: 0.544 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7644338607788086
Epoch: 31, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.555 Vali Acc: 0.861 Test Loss: 0.555 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7329699993133545
Epoch: 32, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.568 Vali Acc: 0.861 Test Loss: 0.568 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 335631
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8287739753723145
Epoch: 1, Steps: 12 | Train Loss: 2.571 Vali Loss: 2.390 Vali Acc: 0.406 Test Loss: 2.390 Test Acc: 0.406
Validation loss decreased (inf --> -0.405532).  Saving model ...
Epoch: 2 cost time: 0.7200617790222168
Epoch: 2, Steps: 12 | Train Loss: 1.858 Vali Loss: 1.745 Vali Acc: 0.539 Test Loss: 1.745 Test Acc: 0.539
Validation loss decreased (-0.405532 --> -0.538871).  Saving model ...
Epoch: 3 cost time: 0.7018442153930664
Epoch: 3, Steps: 12 | Train Loss: 1.239 Vali Loss: 1.295 Vali Acc: 0.656 Test Loss: 1.295 Test Acc: 0.656
Validation loss decreased (-0.538871 --> -0.655543).  Saving model ...
Epoch: 4 cost time: 0.696789026260376
Epoch: 4, Steps: 12 | Train Loss: 0.882 Vali Loss: 1.066 Vali Acc: 0.678 Test Loss: 1.066 Test Acc: 0.678
Validation loss decreased (-0.655543 --> -0.677767).  Saving model ...
Epoch: 5 cost time: 0.7003426551818848
Epoch: 5, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.900 Vali Acc: 0.717 Test Loss: 0.900 Test Acc: 0.717
Validation loss decreased (-0.677767 --> -0.716658).  Saving model ...
Epoch: 6 cost time: 0.6818420886993408
Epoch: 6, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.836 Vali Acc: 0.739 Test Loss: 0.836 Test Acc: 0.739
Validation loss decreased (-0.716658 --> -0.738881).  Saving model ...
Epoch: 7 cost time: 0.7471411228179932
Epoch: 7, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.752 Vali Acc: 0.750 Test Loss: 0.752 Test Acc: 0.750
Validation loss decreased (-0.738881 --> -0.749992).  Saving model ...
Epoch: 8 cost time: 0.7779018878936768
Epoch: 8, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.784 Vali Acc: 0.761 Test Loss: 0.784 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761103).  Saving model ...
Epoch: 9 cost time: 0.7417299747467041
Epoch: 9, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.730 Vali Acc: 0.800 Test Loss: 0.730 Test Acc: 0.800
Validation loss decreased (-0.761103 --> -0.799993).  Saving model ...
Epoch: 10 cost time: 0.6546895503997803
Epoch: 10, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.745 Vali Acc: 0.789 Test Loss: 0.745 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6991477012634277
Epoch: 11, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.680 Vali Acc: 0.789 Test Loss: 0.680 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7262110710144043
Epoch: 12, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.692 Vali Acc: 0.811 Test Loss: 0.692 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 13 cost time: 0.6881611347198486
Epoch: 13, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.666 Vali Acc: 0.839 Test Loss: 0.666 Test Acc: 0.839
Validation loss decreased (-0.811104 --> -0.838882).  Saving model ...
Epoch: 14 cost time: 0.7381772994995117
Epoch: 14, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.722 Vali Acc: 0.839 Test Loss: 0.722 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7639834880828857
Epoch: 15, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.701 Vali Acc: 0.817 Test Loss: 0.701 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7210631370544434
Epoch: 16, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.699 Vali Acc: 0.822 Test Loss: 0.699 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6918566226959229
Epoch: 17, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.714 Vali Acc: 0.833 Test Loss: 0.714 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6886038780212402
Epoch: 18, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.718 Vali Acc: 0.850 Test Loss: 0.718 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849993).  Saving model ...
Epoch: 19 cost time: 0.7107996940612793
Epoch: 19, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.669 Vali Acc: 0.828 Test Loss: 0.669 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6482532024383545
Epoch: 20, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.708 Vali Acc: 0.839 Test Loss: 0.708 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6804842948913574
Epoch: 21, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.719 Vali Acc: 0.844 Test Loss: 0.719 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6717555522918701
Epoch: 22, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.739 Vali Acc: 0.839 Test Loss: 0.739 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7191801071166992
Epoch: 23, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.735 Vali Acc: 0.867 Test Loss: 0.735 Test Acc: 0.867
Validation loss decreased (-0.849993 --> -0.866659).  Saving model ...
Epoch: 24 cost time: 0.6209557056427002
Epoch: 24, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.856 Vali Acc: 0.822 Test Loss: 0.856 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.637500524520874
Epoch: 25, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.807 Vali Acc: 0.856 Test Loss: 0.807 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6648857593536377
Epoch: 26, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.820 Vali Acc: 0.850 Test Loss: 0.820 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6131625175476074
Epoch: 27, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.841 Vali Acc: 0.856 Test Loss: 0.841 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6343576908111572
Epoch: 28, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.786 Vali Acc: 0.867 Test Loss: 0.786 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.693495512008667
Epoch: 29, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.776 Vali Acc: 0.861 Test Loss: 0.776 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6476047039031982
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.806 Vali Acc: 0.872 Test Loss: 0.806 Test Acc: 0.872
Validation loss decreased (-0.866659 --> -0.872214).  Saving model ...
Epoch: 31 cost time: 0.7397115230560303
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.817 Vali Acc: 0.872 Test Loss: 0.817 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7212624549865723
Epoch: 32, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.810 Vali Acc: 0.872 Test Loss: 0.810 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.712543249130249
Epoch: 33, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.818 Vali Acc: 0.861 Test Loss: 0.818 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7274842262268066
Epoch: 34, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.815 Vali Acc: 0.867 Test Loss: 0.815 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7225167751312256
Epoch: 35, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.814 Vali Acc: 0.861 Test Loss: 0.814 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7260162830352783
Epoch: 36, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.834 Vali Acc: 0.872 Test Loss: 0.834 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7469818592071533
Epoch: 37, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.886 Vali Acc: 0.878 Test Loss: 0.886 Test Acc: 0.878
Validation loss decreased (-0.872214 --> -0.877769).  Saving model ...
Epoch: 38 cost time: 0.7359559535980225
Epoch: 38, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.972 Vali Acc: 0.844 Test Loss: 0.972 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7140886783599854
Epoch: 39, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.928 Vali Acc: 0.867 Test Loss: 0.928 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.67759108543396
Epoch: 40, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.984 Vali Acc: 0.844 Test Loss: 0.984 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7050883769989014
Epoch: 41, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.954 Vali Acc: 0.861 Test Loss: 0.954 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7320117950439453
Epoch: 42, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.097 Vali Acc: 0.844 Test Loss: 1.097 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6880342960357666
Epoch: 43, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.992 Vali Acc: 0.867 Test Loss: 0.992 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6483662128448486
Epoch: 44, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.934 Vali Acc: 0.867 Test Loss: 0.934 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.7045872211456299
Epoch: 45, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.057 Vali Acc: 0.833 Test Loss: 1.057 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.6367719173431396
Epoch: 46, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.219 Vali Acc: 0.828 Test Loss: 1.219 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.6925475597381592
Epoch: 47, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.527 Vali Acc: 0.794 Test Loss: 1.527 Test Acc: 0.794
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 246927
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.095977783203125
Epoch: 1, Steps: 12 | Train Loss: 2.770 Vali Loss: 2.623 Vali Acc: 0.117 Test Loss: 2.623 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 0.6838278770446777
Epoch: 2, Steps: 12 | Train Loss: 2.258 Vali Loss: 2.147 Vali Acc: 0.478 Test Loss: 2.147 Test Acc: 0.478
Validation loss decreased (-0.116640 --> -0.477756).  Saving model ...
Epoch: 3 cost time: 0.7080600261688232
Epoch: 3, Steps: 12 | Train Loss: 1.680 Vali Loss: 1.663 Vali Acc: 0.567 Test Loss: 1.663 Test Acc: 0.567
Validation loss decreased (-0.477756 --> -0.566650).  Saving model ...
Epoch: 4 cost time: 0.7399718761444092
Epoch: 4, Steps: 12 | Train Loss: 1.232 Vali Loss: 1.345 Vali Acc: 0.644 Test Loss: 1.345 Test Acc: 0.644
Validation loss decreased (-0.566650 --> -0.644431).  Saving model ...
Epoch: 5 cost time: 0.6923158168792725
Epoch: 5, Steps: 12 | Train Loss: 0.953 Vali Loss: 1.130 Vali Acc: 0.694 Test Loss: 1.130 Test Acc: 0.694
Validation loss decreased (-0.644431 --> -0.694433).  Saving model ...
Epoch: 6 cost time: 0.6931955814361572
Epoch: 6, Steps: 12 | Train Loss: 0.846 Vali Loss: 1.005 Vali Acc: 0.711 Test Loss: 1.005 Test Acc: 0.711
Validation loss decreased (-0.694433 --> -0.711101).  Saving model ...
Epoch: 7 cost time: 0.6732869148254395
Epoch: 7, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.932 Vali Acc: 0.722 Test Loss: 0.932 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722213).  Saving model ...
Epoch: 8 cost time: 0.5995278358459473
Epoch: 8, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.859 Vali Acc: 0.750 Test Loss: 0.859 Test Acc: 0.750
Validation loss decreased (-0.722213 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 0.7065508365631104
Epoch: 9, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.821 Vali Acc: 0.744 Test Loss: 0.821 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6306562423706055
Epoch: 10, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.718 Vali Acc: 0.806 Test Loss: 0.718 Test Acc: 0.806
Validation loss decreased (-0.749991 --> -0.805548).  Saving model ...
Epoch: 11 cost time: 0.6720926761627197
Epoch: 11, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.692 Vali Acc: 0.806 Test Loss: 0.692 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805549).  Saving model ...
Epoch: 12 cost time: 0.6396145820617676
Epoch: 12, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.716 Vali Acc: 0.800 Test Loss: 0.716 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6142783164978027
Epoch: 13, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.657 Vali Acc: 0.817 Test Loss: 0.657 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816660).  Saving model ...
Epoch: 14 cost time: 0.6672415733337402
Epoch: 14, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.640 Vali Acc: 0.806 Test Loss: 0.640 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6598010063171387
Epoch: 15, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.663 Vali Acc: 0.806 Test Loss: 0.663 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6741557121276855
Epoch: 16, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.625 Vali Acc: 0.828 Test Loss: 0.625 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827772).  Saving model ...
Epoch: 17 cost time: 0.6763544082641602
Epoch: 17, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.627 Vali Acc: 0.822 Test Loss: 0.627 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6376922130584717
Epoch: 18, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.594 Vali Acc: 0.822 Test Loss: 0.594 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6767942905426025
Epoch: 19, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.586 Vali Acc: 0.839 Test Loss: 0.586 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 20 cost time: 0.6702497005462646
Epoch: 20, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.615 Vali Acc: 0.811 Test Loss: 0.615 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6856105327606201
Epoch: 21, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.610 Vali Acc: 0.839 Test Loss: 0.610 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6755330562591553
Epoch: 22, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.569 Vali Acc: 0.839 Test Loss: 0.569 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 23 cost time: 0.6839621067047119
Epoch: 23, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.596 Vali Acc: 0.833 Test Loss: 0.596 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6768016815185547
Epoch: 24, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.609 Vali Acc: 0.817 Test Loss: 0.609 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6709332466125488
Epoch: 25, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.622 Vali Acc: 0.839 Test Loss: 0.622 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7143673896789551
Epoch: 26, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.616 Vali Acc: 0.833 Test Loss: 0.616 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.667637825012207
Epoch: 27, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.620 Vali Acc: 0.844 Test Loss: 0.620 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 28 cost time: 0.706730842590332
Epoch: 28, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 29 cost time: 0.693183422088623
Epoch: 29, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.678 Vali Acc: 0.839 Test Loss: 0.678 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6823828220367432
Epoch: 30, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.705 Vali Acc: 0.822 Test Loss: 0.705 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6841273307800293
Epoch: 31, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.683 Vali Acc: 0.828 Test Loss: 0.683 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6794605255126953
Epoch: 32, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.707 Vali Acc: 0.828 Test Loss: 0.707 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6781947612762451
Epoch: 33, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.703 Vali Acc: 0.828 Test Loss: 0.703 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6668040752410889
Epoch: 34, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.688 Vali Acc: 0.822 Test Loss: 0.688 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6943080425262451
Epoch: 35, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.726 Vali Acc: 0.844 Test Loss: 0.726 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6703565120697021
Epoch: 36, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.728 Vali Acc: 0.833 Test Loss: 0.728 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6568593978881836
Epoch: 37, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.717 Vali Acc: 0.833 Test Loss: 0.717 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.6489996910095215
Epoch: 38, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.727 Vali Acc: 0.850 Test Loss: 0.727 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.85
model parameter : 158735
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1619341373443604
Epoch: 1, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.609 Vali Acc: 0.144 Test Loss: 2.609 Test Acc: 0.144
Validation loss decreased (inf --> -0.144418).  Saving model ...
Epoch: 2 cost time: 0.6764233112335205
Epoch: 2, Steps: 12 | Train Loss: 2.248 Vali Loss: 2.149 Vali Acc: 0.511 Test Loss: 2.149 Test Acc: 0.511
Validation loss decreased (-0.144418 --> -0.511090).  Saving model ...
Epoch: 3 cost time: 0.7101414203643799
Epoch: 3, Steps: 12 | Train Loss: 1.656 Vali Loss: 1.676 Vali Acc: 0.611 Test Loss: 1.676 Test Acc: 0.611
Validation loss decreased (-0.511090 --> -0.611094).  Saving model ...
Epoch: 4 cost time: 0.7628278732299805
Epoch: 4, Steps: 12 | Train Loss: 1.282 Vali Loss: 1.349 Vali Acc: 0.667 Test Loss: 1.349 Test Acc: 0.667
Validation loss decreased (-0.611094 --> -0.666653).  Saving model ...
Epoch: 5 cost time: 0.6913080215454102
Epoch: 5, Steps: 12 | Train Loss: 1.052 Vali Loss: 1.101 Vali Acc: 0.678 Test Loss: 1.101 Test Acc: 0.678
Validation loss decreased (-0.666653 --> -0.677767).  Saving model ...
Epoch: 6 cost time: 0.7196667194366455
Epoch: 6, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.985 Vali Acc: 0.706 Test Loss: 0.985 Test Acc: 0.706
Validation loss decreased (-0.677767 --> -0.705546).  Saving model ...
Epoch: 7 cost time: 0.6611769199371338
Epoch: 7, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.893 Vali Acc: 0.739 Test Loss: 0.893 Test Acc: 0.739
Validation loss decreased (-0.705546 --> -0.738880).  Saving model ...
Epoch: 8 cost time: 0.6786646842956543
Epoch: 8, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.832 Vali Acc: 0.767 Test Loss: 0.832 Test Acc: 0.767
Validation loss decreased (-0.738880 --> -0.766658).  Saving model ...
Epoch: 9 cost time: 0.6782279014587402
Epoch: 9, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.785 Vali Acc: 0.756 Test Loss: 0.785 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6866002082824707
Epoch: 10, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.731 Vali Acc: 0.794 Test Loss: 0.731 Test Acc: 0.794
Validation loss decreased (-0.766658 --> -0.794437).  Saving model ...
Epoch: 11 cost time: 0.6666195392608643
Epoch: 11, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.696 Vali Acc: 0.783 Test Loss: 0.696 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6680924892425537
Epoch: 12, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.651 Vali Acc: 0.794 Test Loss: 0.651 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794438).  Saving model ...
Epoch: 13 cost time: 0.6904141902923584
Epoch: 13, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.656 Vali Acc: 0.806 Test Loss: 0.656 Test Acc: 0.806
Validation loss decreased (-0.794438 --> -0.805549).  Saving model ...
Epoch: 14 cost time: 0.7153077125549316
Epoch: 14, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.653 Vali Acc: 0.822 Test Loss: 0.653 Test Acc: 0.822
Validation loss decreased (-0.805549 --> -0.822216).  Saving model ...
Epoch: 15 cost time: 0.712982177734375
Epoch: 15, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.619 Vali Acc: 0.833 Test Loss: 0.619 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 0.6445050239562988
Epoch: 16, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.627 Vali Acc: 0.811 Test Loss: 0.627 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7427577972412109
Epoch: 17, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.607 Vali Acc: 0.817 Test Loss: 0.607 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6857931613922119
Epoch: 18, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.626 Vali Acc: 0.828 Test Loss: 0.626 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6692318916320801
Epoch: 19, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.655 Vali Acc: 0.839 Test Loss: 0.655 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838882).  Saving model ...
Epoch: 20 cost time: 0.6589503288269043
Epoch: 20, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.637 Vali Acc: 0.833 Test Loss: 0.637 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7101137638092041
Epoch: 21, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.619 Vali Acc: 0.844 Test Loss: 0.619 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 22 cost time: 0.6824696063995361
Epoch: 22, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.620 Vali Acc: 0.861 Test Loss: 0.620 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861105).  Saving model ...
Epoch: 23 cost time: 0.6912505626678467
Epoch: 23, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.612 Vali Acc: 0.844 Test Loss: 0.612 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7087202072143555
Epoch: 24, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.617 Vali Acc: 0.861 Test Loss: 0.617 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 25 cost time: 0.694744348526001
Epoch: 25, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.626 Vali Acc: 0.850 Test Loss: 0.626 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7165255546569824
Epoch: 26, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.651 Vali Acc: 0.856 Test Loss: 0.651 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7141726016998291
Epoch: 27, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.669 Vali Acc: 0.850 Test Loss: 0.669 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6754961013793945
Epoch: 28, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.693 Vali Acc: 0.839 Test Loss: 0.693 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.780388593673706
Epoch: 29, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.760 Vali Acc: 0.839 Test Loss: 0.760 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7096767425537109
Epoch: 30, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.756 Vali Acc: 0.839 Test Loss: 0.756 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6562597751617432
Epoch: 31, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.736 Vali Acc: 0.839 Test Loss: 0.736 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6704401969909668
Epoch: 32, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.759 Vali Acc: 0.839 Test Loss: 0.759 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6802897453308105
Epoch: 33, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.754 Vali Acc: 0.856 Test Loss: 0.754 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6935818195343018
Epoch: 34, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.748 Vali Acc: 0.856 Test Loss: 0.748 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 158863
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.094341516494751
Epoch: 1, Steps: 12 | Train Loss: 2.758 Vali Loss: 2.593 Vali Acc: 0.161 Test Loss: 2.593 Test Acc: 0.161
Validation loss decreased (inf --> -0.161085).  Saving model ...
Epoch: 2 cost time: 0.6572756767272949
Epoch: 2, Steps: 12 | Train Loss: 2.435 Vali Loss: 2.269 Vali Acc: 0.389 Test Loss: 2.269 Test Acc: 0.389
Validation loss decreased (-0.161085 --> -0.388866).  Saving model ...
Epoch: 3 cost time: 0.733694314956665
Epoch: 3, Steps: 12 | Train Loss: 1.920 Vali Loss: 1.898 Vali Acc: 0.533 Test Loss: 1.898 Test Acc: 0.533
Validation loss decreased (-0.388866 --> -0.533314).  Saving model ...
Epoch: 4 cost time: 0.8441731929779053
Epoch: 4, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.569 Vali Acc: 0.617 Test Loss: 1.569 Test Acc: 0.617
Validation loss decreased (-0.533314 --> -0.616651).  Saving model ...
Epoch: 5 cost time: 0.7694311141967773
Epoch: 5, Steps: 12 | Train Loss: 1.230 Vali Loss: 1.325 Vali Acc: 0.650 Test Loss: 1.325 Test Acc: 0.650
Validation loss decreased (-0.616651 --> -0.649987).  Saving model ...
Epoch: 6 cost time: 0.7483031749725342
Epoch: 6, Steps: 12 | Train Loss: 1.011 Vali Loss: 1.181 Vali Acc: 0.689 Test Loss: 1.181 Test Acc: 0.689
Validation loss decreased (-0.649987 --> -0.688877).  Saving model ...
Epoch: 7 cost time: 0.7465648651123047
Epoch: 7, Steps: 12 | Train Loss: 0.832 Vali Loss: 1.044 Vali Acc: 0.694 Test Loss: 1.044 Test Acc: 0.694
Validation loss decreased (-0.688877 --> -0.694434).  Saving model ...
Epoch: 8 cost time: 0.7468013763427734
Epoch: 8, Steps: 12 | Train Loss: 0.670 Vali Loss: 0.965 Vali Acc: 0.733 Test Loss: 0.965 Test Acc: 0.733
Validation loss decreased (-0.694434 --> -0.733324).  Saving model ...
Epoch: 9 cost time: 0.7562730312347412
Epoch: 9, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.868 Vali Acc: 0.728 Test Loss: 0.868 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6866481304168701
Epoch: 10, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.807 Vali Acc: 0.772 Test Loss: 0.807 Test Acc: 0.772
Validation loss decreased (-0.733324 --> -0.772214).  Saving model ...
Epoch: 11 cost time: 0.7173788547515869
Epoch: 11, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.760 Vali Acc: 0.767 Test Loss: 0.760 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7297730445861816
Epoch: 12, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.719 Vali Acc: 0.772 Test Loss: 0.719 Test Acc: 0.772
Validation loss decreased (-0.772214 --> -0.772215).  Saving model ...
Epoch: 13 cost time: 0.6762971878051758
Epoch: 13, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.683 Vali Acc: 0.800 Test Loss: 0.683 Test Acc: 0.800
Validation loss decreased (-0.772215 --> -0.799993).  Saving model ...
Epoch: 14 cost time: 0.6103305816650391
Epoch: 14, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.646 Vali Acc: 0.806 Test Loss: 0.646 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 15 cost time: 0.9262809753417969
Epoch: 15, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.636 Vali Acc: 0.811 Test Loss: 0.636 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 16 cost time: 0.6569304466247559
Epoch: 16, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.613 Vali Acc: 0.811 Test Loss: 0.613 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 17 cost time: 0.6830146312713623
Epoch: 17, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.583 Vali Acc: 0.817 Test Loss: 0.583 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
Epoch: 18 cost time: 0.6696419715881348
Epoch: 18, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.616 Vali Acc: 0.833 Test Loss: 0.616 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833327).  Saving model ...
Epoch: 19 cost time: 0.695000410079956
Epoch: 19, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.582 Vali Acc: 0.844 Test Loss: 0.582 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844439).  Saving model ...
Epoch: 20 cost time: 0.7174990177154541
Epoch: 20, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.572 Vali Acc: 0.844 Test Loss: 0.572 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 21 cost time: 0.6779298782348633
Epoch: 21, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.558 Vali Acc: 0.856 Test Loss: 0.558 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 22 cost time: 0.6857025623321533
Epoch: 22, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7331039905548096
Epoch: 23, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.577 Vali Acc: 0.850 Test Loss: 0.577 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7173430919647217
Epoch: 24, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.571 Vali Acc: 0.856 Test Loss: 0.571 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7166171073913574
Epoch: 25, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.569 Vali Acc: 0.839 Test Loss: 0.569 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7016901969909668
Epoch: 26, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.581 Vali Acc: 0.861 Test Loss: 0.581 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 27 cost time: 0.6731541156768799
Epoch: 27, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.596 Vali Acc: 0.856 Test Loss: 0.596 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6729581356048584
Epoch: 28, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.591 Vali Acc: 0.867 Test Loss: 0.591 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 29 cost time: 0.6912448406219482
Epoch: 29, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.572 Vali Acc: 0.856 Test Loss: 0.572 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6228652000427246
Epoch: 30, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.585 Vali Acc: 0.867 Test Loss: 0.585 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 31 cost time: 0.6739242076873779
Epoch: 31, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.593 Vali Acc: 0.867 Test Loss: 0.593 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6706509590148926
Epoch: 32, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.613 Vali Acc: 0.872 Test Loss: 0.613 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 33 cost time: 0.6459934711456299
Epoch: 33, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.675 Vali Acc: 0.856 Test Loss: 0.675 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6487612724304199
Epoch: 34, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.711 Vali Acc: 0.856 Test Loss: 0.711 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6660053730010986
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.689 Vali Acc: 0.856 Test Loss: 0.689 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6784961223602295
Epoch: 36, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.678 Vali Acc: 0.867 Test Loss: 0.678 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.749030590057373
Epoch: 37, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.691 Vali Acc: 0.867 Test Loss: 0.691 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.745020866394043
Epoch: 38, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.672 Vali Acc: 0.872 Test Loss: 0.672 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8189482688903809
Epoch: 39, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.712 Vali Acc: 0.861 Test Loss: 0.712 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.7507786750793457
Epoch: 40, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.735 Vali Acc: 0.878 Test Loss: 0.735 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877770).  Saving model ...
Epoch: 41 cost time: 0.8220827579498291
Epoch: 41, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.698 Vali Acc: 0.872 Test Loss: 0.698 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7745344638824463
Epoch: 42, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.688 Vali Acc: 0.867 Test Loss: 0.688 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7677521705627441
Epoch: 43, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.704 Vali Acc: 0.861 Test Loss: 0.704 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8149099349975586
Epoch: 44, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.688 Vali Acc: 0.867 Test Loss: 0.688 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7375996112823486
Epoch: 45, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.676 Vali Acc: 0.878 Test Loss: 0.676 Test Acc: 0.878
Validation loss decreased (-0.877770 --> -0.877771).  Saving model ...
Epoch: 46 cost time: 0.7437295913696289
Epoch: 46, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.712 Vali Acc: 0.878 Test Loss: 0.712 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8205533027648926
Epoch: 47, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.709 Vali Acc: 0.878 Test Loss: 0.709 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7846190929412842
Epoch: 48, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.726 Vali Acc: 0.872 Test Loss: 0.726 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7927613258361816
Epoch: 49, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.749 Vali Acc: 0.883 Test Loss: 0.749 Test Acc: 0.883
Validation loss decreased (-0.877771 --> -0.883326).  Saving model ...
Epoch: 50 cost time: 0.6991920471191406
Epoch: 50, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.759 Vali Acc: 0.867 Test Loss: 0.759 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 132111
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8868372440338135
Epoch: 1, Steps: 12 | Train Loss: 2.817 Vali Loss: 2.668 Vali Acc: 0.144 Test Loss: 2.668 Test Acc: 0.144
Validation loss decreased (inf --> -0.144418).  Saving model ...
Epoch: 2 cost time: 0.6487891674041748
Epoch: 2, Steps: 12 | Train Loss: 2.502 Vali Loss: 2.411 Vali Acc: 0.322 Test Loss: 2.411 Test Acc: 0.322
Validation loss decreased (-0.144418 --> -0.322198).  Saving model ...
Epoch: 3 cost time: 0.6897134780883789
Epoch: 3, Steps: 12 | Train Loss: 2.110 Vali Loss: 2.044 Vali Acc: 0.506 Test Loss: 2.044 Test Acc: 0.506
Validation loss decreased (-0.322198 --> -0.505535).  Saving model ...
Epoch: 4 cost time: 0.7079081535339355
Epoch: 4, Steps: 12 | Train Loss: 1.737 Vali Loss: 1.718 Vali Acc: 0.594 Test Loss: 1.718 Test Acc: 0.594
Validation loss decreased (-0.505535 --> -0.594427).  Saving model ...
Epoch: 5 cost time: 0.6703445911407471
Epoch: 5, Steps: 12 | Train Loss: 1.399 Vali Loss: 1.497 Vali Acc: 0.644 Test Loss: 1.497 Test Acc: 0.644
Validation loss decreased (-0.594427 --> -0.644429).  Saving model ...
Epoch: 6 cost time: 0.7399065494537354
Epoch: 6, Steps: 12 | Train Loss: 1.145 Vali Loss: 1.320 Vali Acc: 0.650 Test Loss: 1.320 Test Acc: 0.650
Validation loss decreased (-0.644429 --> -0.649987).  Saving model ...
Epoch: 7 cost time: 0.6745269298553467
Epoch: 7, Steps: 12 | Train Loss: 1.008 Vali Loss: 1.170 Vali Acc: 0.689 Test Loss: 1.170 Test Acc: 0.689
Validation loss decreased (-0.649987 --> -0.688877).  Saving model ...
Epoch: 8 cost time: 0.6971652507781982
Epoch: 8, Steps: 12 | Train Loss: 0.813 Vali Loss: 1.034 Vali Acc: 0.706 Test Loss: 1.034 Test Acc: 0.706
Validation loss decreased (-0.688877 --> -0.705545).  Saving model ...
Epoch: 9 cost time: 0.7380149364471436
Epoch: 9, Steps: 12 | Train Loss: 0.711 Vali Loss: 0.944 Vali Acc: 0.733 Test Loss: 0.944 Test Acc: 0.733
Validation loss decreased (-0.705545 --> -0.733324).  Saving model ...
Epoch: 10 cost time: 0.731743574142456
Epoch: 10, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.870 Vali Acc: 0.744 Test Loss: 0.870 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744436).  Saving model ...
Epoch: 11 cost time: 0.7365586757659912
Epoch: 11, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.806 Vali Acc: 0.778 Test Loss: 0.806 Test Acc: 0.778
Validation loss decreased (-0.744436 --> -0.777770).  Saving model ...
Epoch: 12 cost time: 0.7133533954620361
Epoch: 12, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.762 Vali Acc: 0.794 Test Loss: 0.762 Test Acc: 0.794
Validation loss decreased (-0.777770 --> -0.794437).  Saving model ...
Epoch: 13 cost time: 0.7510812282562256
Epoch: 13, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.700 Vali Acc: 0.811 Test Loss: 0.700 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811104).  Saving model ...
Epoch: 14 cost time: 0.6865546703338623
Epoch: 14, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.665 Vali Acc: 0.806 Test Loss: 0.665 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6588375568389893
Epoch: 15, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.618 Vali Acc: 0.833 Test Loss: 0.618 Test Acc: 0.833
Validation loss decreased (-0.811104 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 0.6843369007110596
Epoch: 16, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.605 Vali Acc: 0.822 Test Loss: 0.605 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7801780700683594
Epoch: 17, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.604 Vali Acc: 0.828 Test Loss: 0.604 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6912758350372314
Epoch: 18, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.563 Vali Acc: 0.839 Test Loss: 0.563 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 19 cost time: 0.6430785655975342
Epoch: 19, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.539 Vali Acc: 0.833 Test Loss: 0.539 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6970052719116211
Epoch: 20, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.544 Vali Acc: 0.833 Test Loss: 0.544 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6831674575805664
Epoch: 21, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 22 cost time: 0.7006881237030029
Epoch: 22, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.528 Vali Acc: 0.839 Test Loss: 0.528 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7260396480560303
Epoch: 23, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.524 Vali Acc: 0.856 Test Loss: 0.524 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 24 cost time: 0.70235276222229
Epoch: 24, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.725513219833374
Epoch: 25, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7058541774749756
Epoch: 26, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.514 Vali Acc: 0.867 Test Loss: 0.514 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866662).  Saving model ...
Epoch: 27 cost time: 0.7342860698699951
Epoch: 27, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.526 Vali Acc: 0.861 Test Loss: 0.526 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7132551670074463
Epoch: 28, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.515 Vali Acc: 0.856 Test Loss: 0.515 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7181181907653809
Epoch: 29, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.514 Vali Acc: 0.856 Test Loss: 0.514 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7243890762329102
Epoch: 30, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.521 Vali Acc: 0.861 Test Loss: 0.521 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7030584812164307
Epoch: 31, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.519 Vali Acc: 0.878 Test Loss: 0.519 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 32 cost time: 0.6753718852996826
Epoch: 32, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.519 Vali Acc: 0.861 Test Loss: 0.519 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6984186172485352
Epoch: 33, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.524 Vali Acc: 0.867 Test Loss: 0.524 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6836056709289551
Epoch: 34, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.515 Vali Acc: 0.872 Test Loss: 0.515 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6463749408721924
Epoch: 35, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.529 Vali Acc: 0.861 Test Loss: 0.529 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7067310810089111
Epoch: 36, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.524 Vali Acc: 0.878 Test Loss: 0.524 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6708691120147705
Epoch: 37, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.542 Vali Acc: 0.872 Test Loss: 0.542 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7222588062286377
Epoch: 38, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.557 Vali Acc: 0.872 Test Loss: 0.557 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6760036945343018
Epoch: 39, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.560 Vali Acc: 0.878 Test Loss: 0.560 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.7215719223022461
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.548 Vali Acc: 0.883 Test Loss: 0.548 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 41 cost time: 0.6891036033630371
Epoch: 41, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.579 Vali Acc: 0.889 Test Loss: 0.579 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 42 cost time: 0.7093276977539062
Epoch: 42, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.552 Vali Acc: 0.872 Test Loss: 0.552 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7322723865509033
Epoch: 43, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.554 Vali Acc: 0.861 Test Loss: 0.554 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6633508205413818
Epoch: 44, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.571 Vali Acc: 0.856 Test Loss: 0.571 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7031111717224121
Epoch: 45, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.582 Vali Acc: 0.861 Test Loss: 0.582 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.7417941093444824
Epoch: 46, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.599 Vali Acc: 0.878 Test Loss: 0.599 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.6962215900421143
Epoch: 47, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.577 Vali Acc: 0.861 Test Loss: 0.577 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.7004134654998779
Epoch: 48, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.611 Vali Acc: 0.872 Test Loss: 0.611 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.6856017112731934
Epoch: 49, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.632 Vali Acc: 0.867 Test Loss: 0.632 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.6681272983551025
Epoch: 50, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.575 Vali Acc: 0.889 Test Loss: 0.575 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 117007
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9483463764190674
Epoch: 1, Steps: 12 | Train Loss: 2.774 Vali Loss: 2.689 Vali Acc: 0.111 Test Loss: 2.689 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 0.6248595714569092
Epoch: 2, Steps: 12 | Train Loss: 2.542 Vali Loss: 2.458 Vali Acc: 0.317 Test Loss: 2.458 Test Acc: 0.317
Validation loss decreased (-0.111084 --> -0.316642).  Saving model ...
Epoch: 3 cost time: 0.6175022125244141
Epoch: 3, Steps: 12 | Train Loss: 2.177 Vali Loss: 2.132 Vali Acc: 0.400 Test Loss: 2.132 Test Acc: 0.400
Validation loss decreased (-0.316642 --> -0.399979).  Saving model ...
Epoch: 4 cost time: 0.6124341487884521
Epoch: 4, Steps: 12 | Train Loss: 1.850 Vali Loss: 1.816 Vali Acc: 0.544 Test Loss: 1.816 Test Acc: 0.544
Validation loss decreased (-0.399979 --> -0.544426).  Saving model ...
Epoch: 5 cost time: 0.6614177227020264
Epoch: 5, Steps: 12 | Train Loss: 1.510 Vali Loss: 1.563 Vali Acc: 0.622 Test Loss: 1.563 Test Acc: 0.622
Validation loss decreased (-0.544426 --> -0.622207).  Saving model ...
Epoch: 6 cost time: 0.7358047962188721
Epoch: 6, Steps: 12 | Train Loss: 1.349 Vali Loss: 1.357 Vali Acc: 0.661 Test Loss: 1.357 Test Acc: 0.661
Validation loss decreased (-0.622207 --> -0.661098).  Saving model ...
Epoch: 7 cost time: 0.7356374263763428
Epoch: 7, Steps: 12 | Train Loss: 1.061 Vali Loss: 1.217 Vali Acc: 0.706 Test Loss: 1.217 Test Acc: 0.706
Validation loss decreased (-0.661098 --> -0.705543).  Saving model ...
Epoch: 8 cost time: 0.9027252197265625
Epoch: 8, Steps: 12 | Train Loss: 0.923 Vali Loss: 1.091 Vali Acc: 0.733 Test Loss: 1.091 Test Acc: 0.733
Validation loss decreased (-0.705543 --> -0.733322).  Saving model ...
Epoch: 9 cost time: 0.8056247234344482
Epoch: 9, Steps: 12 | Train Loss: 0.790 Vali Loss: 0.990 Vali Acc: 0.739 Test Loss: 0.990 Test Acc: 0.739
Validation loss decreased (-0.733322 --> -0.738879).  Saving model ...
Epoch: 10 cost time: 0.7667739391326904
Epoch: 10, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.922 Vali Acc: 0.733 Test Loss: 0.922 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7585000991821289
Epoch: 11, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.856 Vali Acc: 0.778 Test Loss: 0.856 Test Acc: 0.778
Validation loss decreased (-0.738879 --> -0.777769).  Saving model ...
Epoch: 12 cost time: 0.7396981716156006
Epoch: 12, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.765 Vali Acc: 0.783 Test Loss: 0.765 Test Acc: 0.783
Validation loss decreased (-0.777769 --> -0.783326).  Saving model ...
Epoch: 13 cost time: 0.7538635730743408
Epoch: 13, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.740 Vali Acc: 0.794 Test Loss: 0.740 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794437).  Saving model ...
Epoch: 14 cost time: 0.7960405349731445
Epoch: 14, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.730 Vali Acc: 0.783 Test Loss: 0.730 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7887916564941406
Epoch: 15, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.675 Vali Acc: 0.800 Test Loss: 0.675 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 16 cost time: 0.7817869186401367
Epoch: 16, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.643 Vali Acc: 0.822 Test Loss: 0.643 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 17 cost time: 0.7742714881896973
Epoch: 17, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.636 Vali Acc: 0.817 Test Loss: 0.636 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7625761032104492
Epoch: 18, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.607 Vali Acc: 0.833 Test Loss: 0.607 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 19 cost time: 0.6923940181732178
Epoch: 19, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.574 Vali Acc: 0.833 Test Loss: 0.574 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833328).  Saving model ...
Epoch: 20 cost time: 0.6643738746643066
Epoch: 20, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.537 Vali Acc: 0.856 Test Loss: 0.537 Test Acc: 0.856
Validation loss decreased (-0.833328 --> -0.855550).  Saving model ...
Epoch: 21 cost time: 0.6926531791687012
Epoch: 21, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.541 Vali Acc: 0.861 Test Loss: 0.541 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 22 cost time: 0.725609302520752
Epoch: 22, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7289316654205322
Epoch: 23, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.520 Vali Acc: 0.856 Test Loss: 0.520 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8029241561889648
Epoch: 24, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.514 Vali Acc: 0.861 Test Loss: 0.514 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 25 cost time: 0.9191684722900391
Epoch: 25, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.522 Vali Acc: 0.867 Test Loss: 0.522 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 26 cost time: 0.8801143169403076
Epoch: 26, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.530 Vali Acc: 0.856 Test Loss: 0.530 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.901134729385376
Epoch: 27, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9092981815338135
Epoch: 28, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.532 Vali Acc: 0.861 Test Loss: 0.532 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.940802812576294
Epoch: 29, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.527 Vali Acc: 0.872 Test Loss: 0.527 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 30 cost time: 0.9399049282073975
Epoch: 30, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.542 Vali Acc: 0.872 Test Loss: 0.542 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8939418792724609
Epoch: 31, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.543 Vali Acc: 0.856 Test Loss: 0.543 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8424079418182373
Epoch: 32, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.544 Vali Acc: 0.856 Test Loss: 0.544 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8594937324523926
Epoch: 33, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.570 Vali Acc: 0.867 Test Loss: 0.570 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8789727687835693
Epoch: 34, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.569 Vali Acc: 0.867 Test Loss: 0.569 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.835951566696167
Epoch: 35, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.546 Vali Acc: 0.867 Test Loss: 0.546 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8352954387664795
Epoch: 36, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.558 Vali Acc: 0.878 Test Loss: 0.558 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 37 cost time: 0.8994588851928711
Epoch: 37, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.570 Vali Acc: 0.867 Test Loss: 0.570 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8102796077728271
Epoch: 38, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.581 Vali Acc: 0.861 Test Loss: 0.581 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8300082683563232
Epoch: 39, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.586 Vali Acc: 0.878 Test Loss: 0.586 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7580697536468506
Epoch: 40, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.555 Vali Acc: 0.878 Test Loss: 0.555 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 41 cost time: 0.8596429824829102
Epoch: 41, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.598 Vali Acc: 0.878 Test Loss: 0.598 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.82967209815979
Epoch: 42, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.617 Vali Acc: 0.889 Test Loss: 0.617 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888883).  Saving model ...
Epoch: 43 cost time: 0.8824589252471924
Epoch: 43, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.615 Vali Acc: 0.867 Test Loss: 0.615 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8484740257263184
Epoch: 44, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.610 Vali Acc: 0.883 Test Loss: 0.610 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6513302326202393
Epoch: 45, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.636 Vali Acc: 0.889 Test Loss: 0.636 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8507616519927979
Epoch: 46, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.625 Vali Acc: 0.883 Test Loss: 0.625 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8919508457183838
Epoch: 47, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.626 Vali Acc: 0.878 Test Loss: 0.626 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.8733770847320557
Epoch: 48, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.658 Vali Acc: 0.883 Test Loss: 0.658 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.7696363925933838
Epoch: 49, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.681 Vali Acc: 0.867 Test Loss: 0.681 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.7621443271636963
Epoch: 50, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.648 Vali Acc: 0.878 Test Loss: 0.648 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 109583
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8505785465240479
Epoch: 1, Steps: 12 | Train Loss: 2.857 Vali Loss: 2.722 Vali Acc: 0.078 Test Loss: 2.722 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 0.6984806060791016
Epoch: 2, Steps: 12 | Train Loss: 2.635 Vali Loss: 2.547 Vali Acc: 0.200 Test Loss: 2.547 Test Acc: 0.200
Validation loss decreased (-0.077751 --> -0.199975).  Saving model ...
Epoch: 3 cost time: 0.7270853519439697
Epoch: 3, Steps: 12 | Train Loss: 2.374 Vali Loss: 2.274 Vali Acc: 0.433 Test Loss: 2.274 Test Acc: 0.433
Validation loss decreased (-0.199975 --> -0.433311).  Saving model ...
Epoch: 4 cost time: 0.6835458278656006
Epoch: 4, Steps: 12 | Train Loss: 2.046 Vali Loss: 1.982 Vali Acc: 0.544 Test Loss: 1.982 Test Acc: 0.544
Validation loss decreased (-0.433311 --> -0.544425).  Saving model ...
Epoch: 5 cost time: 0.6983840465545654
Epoch: 5, Steps: 12 | Train Loss: 1.765 Vali Loss: 1.720 Vali Acc: 0.594 Test Loss: 1.720 Test Acc: 0.594
Validation loss decreased (-0.544425 --> -0.594427).  Saving model ...
Epoch: 6 cost time: 0.6901464462280273
Epoch: 6, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.499 Vali Acc: 0.633 Test Loss: 1.499 Test Acc: 0.633
Validation loss decreased (-0.594427 --> -0.633318).  Saving model ...
Epoch: 7 cost time: 0.6753952503204346
Epoch: 7, Steps: 12 | Train Loss: 1.242 Vali Loss: 1.336 Vali Acc: 0.700 Test Loss: 1.336 Test Acc: 0.700
Validation loss decreased (-0.633318 --> -0.699987).  Saving model ...
Epoch: 8 cost time: 0.6725554466247559
Epoch: 8, Steps: 12 | Train Loss: 1.044 Vali Loss: 1.199 Vali Acc: 0.717 Test Loss: 1.199 Test Acc: 0.717
Validation loss decreased (-0.699987 --> -0.716655).  Saving model ...
Epoch: 9 cost time: 0.6481490135192871
Epoch: 9, Steps: 12 | Train Loss: 0.927 Vali Loss: 1.086 Vali Acc: 0.739 Test Loss: 1.086 Test Acc: 0.739
Validation loss decreased (-0.716655 --> -0.738878).  Saving model ...
Epoch: 10 cost time: 0.6660728454589844
Epoch: 10, Steps: 12 | Train Loss: 0.808 Vali Loss: 0.998 Vali Acc: 0.739 Test Loss: 0.998 Test Acc: 0.739
Validation loss decreased (-0.738878 --> -0.738879).  Saving model ...
Epoch: 11 cost time: 0.6508679389953613
Epoch: 11, Steps: 12 | Train Loss: 0.700 Vali Loss: 0.921 Vali Acc: 0.761 Test Loss: 0.921 Test Acc: 0.761
Validation loss decreased (-0.738879 --> -0.761102).  Saving model ...
Epoch: 12 cost time: 0.6519162654876709
Epoch: 12, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.855 Vali Acc: 0.744 Test Loss: 0.855 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6240859031677246
Epoch: 13, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.825 Vali Acc: 0.744 Test Loss: 0.825 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6288888454437256
Epoch: 14, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.759 Vali Acc: 0.772 Test Loss: 0.759 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772215).  Saving model ...
Epoch: 15 cost time: 0.6392030715942383
Epoch: 15, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.718 Vali Acc: 0.783 Test Loss: 0.718 Test Acc: 0.783
Validation loss decreased (-0.772215 --> -0.783326).  Saving model ...
Epoch: 16 cost time: 0.633838415145874
Epoch: 16, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.676 Vali Acc: 0.800 Test Loss: 0.676 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799993).  Saving model ...
Epoch: 17 cost time: 0.6665127277374268
Epoch: 17, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.656 Vali Acc: 0.789 Test Loss: 0.656 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5970127582550049
Epoch: 18, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.642 Vali Acc: 0.806 Test Loss: 0.642 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 19 cost time: 0.659106969833374
Epoch: 19, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.590 Vali Acc: 0.828 Test Loss: 0.590 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827772).  Saving model ...
Epoch: 20 cost time: 0.6706116199493408
Epoch: 20, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.575 Vali Acc: 0.822 Test Loss: 0.575 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6849486827850342
Epoch: 21, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.560 Vali Acc: 0.839 Test Loss: 0.560 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 22 cost time: 0.6697967052459717
Epoch: 22, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 23 cost time: 0.6920125484466553
Epoch: 23, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.540 Vali Acc: 0.833 Test Loss: 0.540 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6731531620025635
Epoch: 24, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.515 Vali Acc: 0.844 Test Loss: 0.515 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 25 cost time: 0.6766691207885742
Epoch: 25, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.515 Vali Acc: 0.844 Test Loss: 0.515 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6965916156768799
Epoch: 26, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 27 cost time: 0.6388123035430908
Epoch: 27, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.485 Vali Acc: 0.850 Test Loss: 0.485 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 28 cost time: 0.6761288642883301
Epoch: 28, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6816966533660889
Epoch: 29, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.493 Vali Acc: 0.839 Test Loss: 0.493 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6404426097869873
Epoch: 30, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.485 Vali Acc: 0.856 Test Loss: 0.485 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855551).  Saving model ...
Epoch: 31 cost time: 0.6373531818389893
Epoch: 31, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.497 Vali Acc: 0.856 Test Loss: 0.497 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6311686038970947
Epoch: 32, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.475 Vali Acc: 0.856 Test Loss: 0.475 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 33 cost time: 0.5696263313293457
Epoch: 33, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6155786514282227
Epoch: 34, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.472 Vali Acc: 0.867 Test Loss: 0.472 Test Acc: 0.867
Validation loss decreased (-0.855551 --> -0.866662).  Saving model ...
Epoch: 35 cost time: 0.6711006164550781
Epoch: 35, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.476 Vali Acc: 0.861 Test Loss: 0.476 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6531951427459717
Epoch: 36, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.482 Vali Acc: 0.861 Test Loss: 0.482 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6369788646697998
Epoch: 37, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.501 Vali Acc: 0.872 Test Loss: 0.501 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 38 cost time: 0.6146318912506104
Epoch: 38, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.480 Vali Acc: 0.867 Test Loss: 0.480 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6597650051116943
Epoch: 39, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.482 Vali Acc: 0.867 Test Loss: 0.482 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6545085906982422
Epoch: 40, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.483 Vali Acc: 0.872 Test Loss: 0.483 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 41 cost time: 0.6862962245941162
Epoch: 41, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.506 Vali Acc: 0.878 Test Loss: 0.506 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 42 cost time: 0.6728715896606445
Epoch: 42, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.527 Vali Acc: 0.872 Test Loss: 0.527 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6964068412780762
Epoch: 43, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6756448745727539
Epoch: 44, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.499 Vali Acc: 0.867 Test Loss: 0.499 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6759645938873291
Epoch: 45, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.528 Vali Acc: 0.867 Test Loss: 0.528 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6520693302154541
Epoch: 46, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.527 Vali Acc: 0.867 Test Loss: 0.527 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.6795947551727295
Epoch: 47, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.519 Vali Acc: 0.872 Test Loss: 0.519 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.6385290622711182
Epoch: 48, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.533 Vali Acc: 0.878 Test Loss: 0.533 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.6590440273284912
Epoch: 49, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.541 Vali Acc: 0.867 Test Loss: 0.541 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.6841492652893066
Epoch: 50, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.551 Vali Acc: 0.861 Test Loss: 0.551 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 102287
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.7624545097351074
Epoch: 1, Steps: 12 | Train Loss: 2.742 Vali Loss: 2.559 Vali Acc: 0.183 Test Loss: 2.559 Test Acc: 0.183
Validation loss decreased (inf --> -0.183308).  Saving model ...
Epoch: 2 cost time: 0.7038974761962891
Epoch: 2, Steps: 12 | Train Loss: 2.253 Vali Loss: 2.112 Vali Acc: 0.494 Test Loss: 2.112 Test Acc: 0.494
Validation loss decreased (-0.183308 --> -0.494423).  Saving model ...
Epoch: 3 cost time: 0.686579704284668
Epoch: 3, Steps: 12 | Train Loss: 1.677 Vali Loss: 1.670 Vali Acc: 0.628 Test Loss: 1.670 Test Acc: 0.628
Validation loss decreased (-0.494423 --> -0.627761).  Saving model ...
Epoch: 4 cost time: 0.7306017875671387
Epoch: 4, Steps: 12 | Train Loss: 1.268 Vali Loss: 1.328 Vali Acc: 0.656 Test Loss: 1.328 Test Acc: 0.656
Validation loss decreased (-0.627761 --> -0.655542).  Saving model ...
Epoch: 5 cost time: 0.6668288707733154
Epoch: 5, Steps: 12 | Train Loss: 1.017 Vali Loss: 1.101 Vali Acc: 0.711 Test Loss: 1.101 Test Acc: 0.711
Validation loss decreased (-0.655542 --> -0.711100).  Saving model ...
Epoch: 6 cost time: 0.6839442253112793
Epoch: 6, Steps: 12 | Train Loss: 0.831 Vali Loss: 0.973 Vali Acc: 0.744 Test Loss: 0.973 Test Acc: 0.744
Validation loss decreased (-0.711100 --> -0.744435).  Saving model ...
Epoch: 7 cost time: 0.7020549774169922
Epoch: 7, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.884 Vali Acc: 0.728 Test Loss: 0.884 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6521754264831543
Epoch: 8, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.791 Vali Acc: 0.750 Test Loss: 0.791 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749992).  Saving model ...
Epoch: 9 cost time: 0.7043328285217285
Epoch: 9, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.751 Vali Acc: 0.783 Test Loss: 0.751 Test Acc: 0.783
Validation loss decreased (-0.749992 --> -0.783326).  Saving model ...
Epoch: 10 cost time: 0.6908588409423828
Epoch: 10, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.703 Vali Acc: 0.794 Test Loss: 0.703 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794437).  Saving model ...
Epoch: 11 cost time: 0.6485157012939453
Epoch: 11, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.673 Vali Acc: 0.789 Test Loss: 0.673 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6442711353302002
Epoch: 12, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.639 Vali Acc: 0.817 Test Loss: 0.639 Test Acc: 0.817
Validation loss decreased (-0.794437 --> -0.816660).  Saving model ...
Epoch: 13 cost time: 0.635096549987793
Epoch: 13, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.636 Vali Acc: 0.806 Test Loss: 0.636 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6483933925628662
Epoch: 14, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.622 Vali Acc: 0.833 Test Loss: 0.622 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 15 cost time: 0.6399962902069092
Epoch: 15, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.573 Vali Acc: 0.850 Test Loss: 0.573 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 16 cost time: 0.6326119899749756
Epoch: 16, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.594 Vali Acc: 0.833 Test Loss: 0.594 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6854097843170166
Epoch: 17, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.594 Vali Acc: 0.850 Test Loss: 0.594 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6518378257751465
Epoch: 18, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 19 cost time: 0.7134745121002197
Epoch: 19, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.594 Vali Acc: 0.844 Test Loss: 0.594 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.631594181060791
Epoch: 20, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.614 Vali Acc: 0.839 Test Loss: 0.614 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6225221157073975
Epoch: 21, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.619 Vali Acc: 0.839 Test Loss: 0.619 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.697789192199707
Epoch: 22, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.608 Vali Acc: 0.856 Test Loss: 0.608 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6580870151519775
Epoch: 23, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.616 Vali Acc: 0.856 Test Loss: 0.616 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6913390159606934
Epoch: 24, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7097854614257812
Epoch: 25, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.673 Vali Acc: 0.850 Test Loss: 0.673 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5652363300323486
Epoch: 26, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.669 Vali Acc: 0.850 Test Loss: 0.669 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6623587608337402
Epoch: 27, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.674 Vali Acc: 0.833 Test Loss: 0.674 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6255514621734619
Epoch: 28, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.673 Vali Acc: 0.861 Test Loss: 0.673 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861104).  Saving model ...
Epoch: 29 cost time: 0.6237051486968994
Epoch: 29, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.637 Vali Acc: 0.844 Test Loss: 0.637 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6470303535461426
Epoch: 30, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.686 Vali Acc: 0.861 Test Loss: 0.686 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.635472297668457
Epoch: 31, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.708 Vali Acc: 0.850 Test Loss: 0.708 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6194751262664795
Epoch: 32, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.677 Vali Acc: 0.856 Test Loss: 0.677 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6386322975158691
Epoch: 33, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.691 Vali Acc: 0.872 Test Loss: 0.691 Test Acc: 0.872
Validation loss decreased (-0.861104 --> -0.872215).  Saving model ...
Epoch: 34 cost time: 0.6107029914855957
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.726 Vali Acc: 0.861 Test Loss: 0.726 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5706264972686768
Epoch: 35, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.721 Vali Acc: 0.861 Test Loss: 0.721 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7077159881591797
Epoch: 36, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.701 Vali Acc: 0.872 Test Loss: 0.701 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.681840181350708
Epoch: 37, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.681 Vali Acc: 0.856 Test Loss: 0.681 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6190612316131592
Epoch: 38, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.720 Vali Acc: 0.878 Test Loss: 0.720 Test Acc: 0.878
Validation loss decreased (-0.872215 --> -0.877771).  Saving model ...
Epoch: 39 cost time: 0.5960354804992676
Epoch: 39, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.731 Vali Acc: 0.861 Test Loss: 0.731 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6828787326812744
Epoch: 40, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.690 Vali Acc: 0.878 Test Loss: 0.690 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877771).  Saving model ...
Epoch: 41 cost time: 0.6482362747192383
Epoch: 41, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.703 Vali Acc: 0.878 Test Loss: 0.703 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6442463397979736
Epoch: 42, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.697 Vali Acc: 0.867 Test Loss: 0.697 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6814875602722168
Epoch: 43, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.741 Vali Acc: 0.872 Test Loss: 0.741 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6753060817718506
Epoch: 44, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.738 Vali Acc: 0.867 Test Loss: 0.738 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.6200675964355469
Epoch: 45, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.733 Vali Acc: 0.844 Test Loss: 0.733 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.6077456474304199
Epoch: 46, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.726 Vali Acc: 0.872 Test Loss: 0.726 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.5930092334747314
Epoch: 47, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.742 Vali Acc: 0.856 Test Loss: 0.742 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.7169613838195801
Epoch: 48, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.740 Vali Acc: 0.850 Test Loss: 0.740 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.5700981616973877
Epoch: 49, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.798 Vali Acc: 0.861 Test Loss: 0.798 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.6434383392333984
Epoch: 50, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.821 Vali Acc: 0.856 Test Loss: 0.821 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 107087
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9326212406158447
Epoch: 1, Steps: 12 | Train Loss: 2.870 Vali Loss: 2.705 Vali Acc: 0.144 Test Loss: 2.705 Test Acc: 0.144
Validation loss decreased (inf --> -0.144417).  Saving model ...
Epoch: 2 cost time: 0.693209171295166
Epoch: 2, Steps: 12 | Train Loss: 2.571 Vali Loss: 2.437 Vali Acc: 0.306 Test Loss: 2.437 Test Acc: 0.306
Validation loss decreased (-0.144417 --> -0.305531).  Saving model ...
Epoch: 3 cost time: 0.7832956314086914
Epoch: 3, Steps: 12 | Train Loss: 2.200 Vali Loss: 2.081 Vali Acc: 0.500 Test Loss: 2.081 Test Acc: 0.500
Validation loss decreased (-0.305531 --> -0.499979).  Saving model ...
Epoch: 4 cost time: 0.6993060111999512
Epoch: 4, Steps: 12 | Train Loss: 1.863 Vali Loss: 1.739 Vali Acc: 0.617 Test Loss: 1.739 Test Acc: 0.617
Validation loss decreased (-0.499979 --> -0.616649).  Saving model ...
Epoch: 5 cost time: 0.6736907958984375
Epoch: 5, Steps: 12 | Train Loss: 1.491 Vali Loss: 1.499 Vali Acc: 0.628 Test Loss: 1.499 Test Acc: 0.628
Validation loss decreased (-0.616649 --> -0.627763).  Saving model ...
Epoch: 6 cost time: 0.6801431179046631
Epoch: 6, Steps: 12 | Train Loss: 1.213 Vali Loss: 1.341 Vali Acc: 0.678 Test Loss: 1.341 Test Acc: 0.678
Validation loss decreased (-0.627763 --> -0.677764).  Saving model ...
Epoch: 7 cost time: 0.6983842849731445
Epoch: 7, Steps: 12 | Train Loss: 1.024 Vali Loss: 1.202 Vali Acc: 0.683 Test Loss: 1.202 Test Acc: 0.683
Validation loss decreased (-0.677764 --> -0.683321).  Saving model ...
Epoch: 8 cost time: 0.7008943557739258
Epoch: 8, Steps: 12 | Train Loss: 0.884 Vali Loss: 1.080 Vali Acc: 0.694 Test Loss: 1.080 Test Acc: 0.694
Validation loss decreased (-0.683321 --> -0.694434).  Saving model ...
Epoch: 9 cost time: 0.6690871715545654
Epoch: 9, Steps: 12 | Train Loss: 0.759 Vali Loss: 1.011 Vali Acc: 0.711 Test Loss: 1.011 Test Acc: 0.711
Validation loss decreased (-0.694434 --> -0.711101).  Saving model ...
Epoch: 10 cost time: 0.7275888919830322
Epoch: 10, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.960 Vali Acc: 0.717 Test Loss: 0.960 Test Acc: 0.717
Validation loss decreased (-0.711101 --> -0.716657).  Saving model ...
Epoch: 11 cost time: 0.6797895431518555
Epoch: 11, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.895 Vali Acc: 0.711 Test Loss: 0.895 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7291748523712158
Epoch: 12, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.846 Vali Acc: 0.739 Test Loss: 0.846 Test Acc: 0.739
Validation loss decreased (-0.716657 --> -0.738880).  Saving model ...
Epoch: 13 cost time: 0.572096586227417
Epoch: 13, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.817 Vali Acc: 0.739 Test Loss: 0.817 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738881).  Saving model ...
Epoch: 14 cost time: 0.6008100509643555
Epoch: 14, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.786 Vali Acc: 0.767 Test Loss: 0.786 Test Acc: 0.767
Validation loss decreased (-0.738881 --> -0.766659).  Saving model ...
Epoch: 15 cost time: 0.590501070022583
Epoch: 15, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.734 Vali Acc: 0.778 Test Loss: 0.734 Test Acc: 0.778
Validation loss decreased (-0.766659 --> -0.777770).  Saving model ...
Epoch: 16 cost time: 0.7228569984436035
Epoch: 16, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.706 Vali Acc: 0.783 Test Loss: 0.706 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783326).  Saving model ...
Epoch: 17 cost time: 0.6634871959686279
Epoch: 17, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.696 Vali Acc: 0.800 Test Loss: 0.696 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799993).  Saving model ...
Epoch: 18 cost time: 0.6696920394897461
Epoch: 18, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.667 Vali Acc: 0.783 Test Loss: 0.667 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6997463703155518
Epoch: 19, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.658 Vali Acc: 0.822 Test Loss: 0.658 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 20 cost time: 0.6934947967529297
Epoch: 20, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.652 Vali Acc: 0.800 Test Loss: 0.652 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.673149824142456
Epoch: 21, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.634 Vali Acc: 0.811 Test Loss: 0.634 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7062442302703857
Epoch: 22, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.607 Vali Acc: 0.833 Test Loss: 0.607 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 23 cost time: 0.6686067581176758
Epoch: 23, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.583 Vali Acc: 0.817 Test Loss: 0.583 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6268947124481201
Epoch: 24, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.569 Vali Acc: 0.833 Test Loss: 0.569 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833328).  Saving model ...
Epoch: 25 cost time: 0.6761236190795898
Epoch: 25, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.549 Vali Acc: 0.833 Test Loss: 0.549 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 26 cost time: 0.6780548095703125
Epoch: 26, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.532 Vali Acc: 0.833 Test Loss: 0.532 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 27 cost time: 0.6772701740264893
Epoch: 27, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.549 Vali Acc: 0.833 Test Loss: 0.549 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7115676403045654
Epoch: 28, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.573 Vali Acc: 0.817 Test Loss: 0.573 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.674314022064209
Epoch: 29, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.575 Vali Acc: 0.833 Test Loss: 0.575 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7100558280944824
Epoch: 30, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.571 Vali Acc: 0.839 Test Loss: 0.571 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838883).  Saving model ...
Epoch: 31 cost time: 0.6943259239196777
Epoch: 31, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.569 Vali Acc: 0.833 Test Loss: 0.569 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.682086706161499
Epoch: 32, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.568 Vali Acc: 0.839 Test Loss: 0.568 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 33 cost time: 0.6477291584014893
Epoch: 33, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 34 cost time: 0.6597592830657959
Epoch: 34, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.577 Vali Acc: 0.844 Test Loss: 0.577 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6742837429046631
Epoch: 35, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.556 Vali Acc: 0.844 Test Loss: 0.556 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6670928001403809
Epoch: 36, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 37 cost time: 0.7242951393127441
Epoch: 37, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.573 Vali Acc: 0.850 Test Loss: 0.573 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7034194469451904
Epoch: 38, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.594 Vali Acc: 0.856 Test Loss: 0.594 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 39 cost time: 0.7222697734832764
Epoch: 39, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.602 Vali Acc: 0.856 Test Loss: 0.602 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6984798908233643
Epoch: 40, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6826522350311279
Epoch: 41, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.601 Vali Acc: 0.839 Test Loss: 0.601 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7244396209716797
Epoch: 42, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.622 Vali Acc: 0.872 Test Loss: 0.622 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872216).  Saving model ...
Epoch: 43 cost time: 0.6751337051391602
Epoch: 43, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.611 Vali Acc: 0.872 Test Loss: 0.611 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 44 cost time: 0.713172435760498
Epoch: 44, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6740696430206299
Epoch: 45, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.581 Vali Acc: 0.844 Test Loss: 0.581 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7115969657897949
Epoch: 46, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.608 Vali Acc: 0.856 Test Loss: 0.608 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6940186023712158
Epoch: 47, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.587 Vali Acc: 0.850 Test Loss: 0.587 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6875405311584473
Epoch: 48, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.578 Vali Acc: 0.856 Test Loss: 0.578 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.6546623706817627
Epoch: 49, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.626 Vali Acc: 0.839 Test Loss: 0.626 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.6537346839904785
Epoch: 50, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.638 Vali Acc: 0.850 Test Loss: 0.638 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 62991
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.020353078842163
Epoch: 1, Steps: 12 | Train Loss: 2.743 Vali Loss: 2.646 Vali Acc: 0.117 Test Loss: 2.646 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 0.7371830940246582
Epoch: 2, Steps: 12 | Train Loss: 2.450 Vali Loss: 2.402 Vali Acc: 0.378 Test Loss: 2.402 Test Acc: 0.378
Validation loss decreased (-0.116640 --> -0.377754).  Saving model ...
Epoch: 3 cost time: 0.7360711097717285
Epoch: 3, Steps: 12 | Train Loss: 2.103 Vali Loss: 2.050 Vali Acc: 0.506 Test Loss: 2.050 Test Acc: 0.506
Validation loss decreased (-0.377754 --> -0.505535).  Saving model ...
Epoch: 4 cost time: 0.7221710681915283
Epoch: 4, Steps: 12 | Train Loss: 1.761 Vali Loss: 1.726 Vali Acc: 0.611 Test Loss: 1.726 Test Acc: 0.611
Validation loss decreased (-0.505535 --> -0.611094).  Saving model ...
Epoch: 5 cost time: 0.7179059982299805
Epoch: 5, Steps: 12 | Train Loss: 1.455 Vali Loss: 1.496 Vali Acc: 0.644 Test Loss: 1.496 Test Acc: 0.644
Validation loss decreased (-0.611094 --> -0.644429).  Saving model ...
Epoch: 6 cost time: 0.7542698383331299
Epoch: 6, Steps: 12 | Train Loss: 1.192 Vali Loss: 1.334 Vali Acc: 0.650 Test Loss: 1.334 Test Acc: 0.650
Validation loss decreased (-0.644429 --> -0.649987).  Saving model ...
Epoch: 7 cost time: 0.7312870025634766
Epoch: 7, Steps: 12 | Train Loss: 1.077 Vali Loss: 1.158 Vali Acc: 0.683 Test Loss: 1.158 Test Acc: 0.683
Validation loss decreased (-0.649987 --> -0.683322).  Saving model ...
Epoch: 8 cost time: 0.7397866249084473
Epoch: 8, Steps: 12 | Train Loss: 0.855 Vali Loss: 1.072 Vali Acc: 0.711 Test Loss: 1.072 Test Acc: 0.711
Validation loss decreased (-0.683322 --> -0.711100).  Saving model ...
Epoch: 9 cost time: 0.6698131561279297
Epoch: 9, Steps: 12 | Train Loss: 0.775 Vali Loss: 1.008 Vali Acc: 0.728 Test Loss: 1.008 Test Acc: 0.728
Validation loss decreased (-0.711100 --> -0.727768).  Saving model ...
Epoch: 10 cost time: 0.6768133640289307
Epoch: 10, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.939 Vali Acc: 0.711 Test Loss: 0.939 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6698963642120361
Epoch: 11, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.879 Vali Acc: 0.739 Test Loss: 0.879 Test Acc: 0.739
Validation loss decreased (-0.727768 --> -0.738880).  Saving model ...
Epoch: 12 cost time: 0.6296648979187012
Epoch: 12, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.831 Vali Acc: 0.756 Test Loss: 0.831 Test Acc: 0.756
Validation loss decreased (-0.738880 --> -0.755547).  Saving model ...
Epoch: 13 cost time: 0.6536660194396973
Epoch: 13, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.803 Vali Acc: 0.756 Test Loss: 0.803 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755548).  Saving model ...
Epoch: 14 cost time: 0.6877877712249756
Epoch: 14, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.755 Vali Acc: 0.778 Test Loss: 0.755 Test Acc: 0.778
Validation loss decreased (-0.755548 --> -0.777770).  Saving model ...
Epoch: 15 cost time: 0.6746039390563965
Epoch: 15, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.711 Vali Acc: 0.783 Test Loss: 0.711 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783326).  Saving model ...
Epoch: 16 cost time: 0.7099268436431885
Epoch: 16, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.686 Vali Acc: 0.806 Test Loss: 0.686 Test Acc: 0.806
Validation loss decreased (-0.783326 --> -0.805549).  Saving model ...
Epoch: 17 cost time: 0.7064032554626465
Epoch: 17, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.655 Vali Acc: 0.806 Test Loss: 0.655 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805549).  Saving model ...
Epoch: 18 cost time: 0.6988317966461182
Epoch: 18, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.617 Vali Acc: 0.800 Test Loss: 0.617 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7054080963134766
Epoch: 19, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.620 Vali Acc: 0.806 Test Loss: 0.620 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805549).  Saving model ...
Epoch: 20 cost time: 0.7508792877197266
Epoch: 20, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.616 Vali Acc: 0.806 Test Loss: 0.616 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805549).  Saving model ...
Epoch: 21 cost time: 0.7030270099639893
Epoch: 21, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.604 Vali Acc: 0.828 Test Loss: 0.604 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827772).  Saving model ...
Epoch: 22 cost time: 0.7109761238098145
Epoch: 22, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.595 Vali Acc: 0.828 Test Loss: 0.595 Test Acc: 0.828
Validation loss decreased (-0.827772 --> -0.827772).  Saving model ...
Epoch: 23 cost time: 0.7377662658691406
Epoch: 23, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.586 Vali Acc: 0.833 Test Loss: 0.586 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833327).  Saving model ...
Epoch: 24 cost time: 0.6981849670410156
Epoch: 24, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6926755905151367
Epoch: 25, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.593 Vali Acc: 0.833 Test Loss: 0.593 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7149550914764404
Epoch: 26, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.586 Vali Acc: 0.833 Test Loss: 0.586 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 27 cost time: 0.718578577041626
Epoch: 27, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.566 Vali Acc: 0.850 Test Loss: 0.566 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 0.6484396457672119
Epoch: 28, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.547 Vali Acc: 0.828 Test Loss: 0.547 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.699688196182251
Epoch: 29, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7667195796966553
Epoch: 30, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.590 Vali Acc: 0.828 Test Loss: 0.590 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7036044597625732
Epoch: 31, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.595 Vali Acc: 0.833 Test Loss: 0.595 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.609133243560791
Epoch: 32, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.597 Vali Acc: 0.839 Test Loss: 0.597 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6704251766204834
Epoch: 33, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.588 Vali Acc: 0.839 Test Loss: 0.588 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6872737407684326
Epoch: 34, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.598 Vali Acc: 0.833 Test Loss: 0.598 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.744488000869751
Epoch: 35, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.606 Vali Acc: 0.839 Test Loss: 0.606 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.6922762393951416
Epoch: 36, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.619 Vali Acc: 0.861 Test Loss: 0.619 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 37 cost time: 0.7209334373474121
Epoch: 37, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.592 Vali Acc: 0.844 Test Loss: 0.592 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6905581951141357
Epoch: 38, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.614 Vali Acc: 0.844 Test Loss: 0.614 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6789300441741943
Epoch: 39, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.606 Vali Acc: 0.856 Test Loss: 0.606 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7392520904541016
Epoch: 40, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.602 Vali Acc: 0.867 Test Loss: 0.602 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 41 cost time: 0.7317554950714111
Epoch: 41, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.618 Vali Acc: 0.850 Test Loss: 0.618 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7203071117401123
Epoch: 42, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.628 Vali Acc: 0.839 Test Loss: 0.628 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6600332260131836
Epoch: 43, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.629 Vali Acc: 0.850 Test Loss: 0.629 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7390172481536865
Epoch: 44, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.646 Vali Acc: 0.833 Test Loss: 0.646 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7402372360229492
Epoch: 45, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.662 Vali Acc: 0.850 Test Loss: 0.662 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.7009258270263672
Epoch: 46, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.669 Vali Acc: 0.856 Test Loss: 0.669 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.710115909576416
Epoch: 47, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.667 Vali Acc: 0.850 Test Loss: 0.667 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.735123872756958
Epoch: 48, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.679 Vali Acc: 0.850 Test Loss: 0.679 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.7306411266326904
Epoch: 49, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.669 Vali Acc: 0.861 Test Loss: 0.669 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.7624738216400146
Epoch: 50, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.692 Vali Acc: 0.861 Test Loss: 0.692 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 63055
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.114158868789673
Epoch: 1, Steps: 12 | Train Loss: 2.845 Vali Loss: 2.805 Vali Acc: 0.100 Test Loss: 2.805 Test Acc: 0.100
Validation loss decreased (inf --> -0.099972).  Saving model ...
Epoch: 2 cost time: 0.6620800495147705
Epoch: 2, Steps: 12 | Train Loss: 2.670 Vali Loss: 2.622 Vali Acc: 0.222 Test Loss: 2.622 Test Acc: 0.222
Validation loss decreased (-0.099972 --> -0.222196).  Saving model ...
Epoch: 3 cost time: 0.657670259475708
Epoch: 3, Steps: 12 | Train Loss: 2.363 Vali Loss: 2.358 Vali Acc: 0.389 Test Loss: 2.358 Test Acc: 0.389
Validation loss decreased (-0.222196 --> -0.388865).  Saving model ...
Epoch: 4 cost time: 0.7035348415374756
Epoch: 4, Steps: 12 | Train Loss: 2.064 Vali Loss: 2.070 Vali Acc: 0.533 Test Loss: 2.070 Test Acc: 0.533
Validation loss decreased (-0.388865 --> -0.533313).  Saving model ...
Epoch: 5 cost time: 0.6904115676879883
Epoch: 5, Steps: 12 | Train Loss: 1.745 Vali Loss: 1.822 Vali Acc: 0.594 Test Loss: 1.822 Test Acc: 0.594
Validation loss decreased (-0.533313 --> -0.594426).  Saving model ...
Epoch: 6 cost time: 0.6765797138214111
Epoch: 6, Steps: 12 | Train Loss: 1.479 Vali Loss: 1.610 Vali Acc: 0.622 Test Loss: 1.610 Test Acc: 0.622
Validation loss decreased (-0.594426 --> -0.622206).  Saving model ...
Epoch: 7 cost time: 0.7456490993499756
Epoch: 7, Steps: 12 | Train Loss: 1.308 Vali Loss: 1.455 Vali Acc: 0.617 Test Loss: 1.455 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7123210430145264
Epoch: 8, Steps: 12 | Train Loss: 1.100 Vali Loss: 1.319 Vali Acc: 0.683 Test Loss: 1.319 Test Acc: 0.683
Validation loss decreased (-0.622206 --> -0.683320).  Saving model ...
Epoch: 9 cost time: 0.7030365467071533
Epoch: 9, Steps: 12 | Train Loss: 0.989 Vali Loss: 1.196 Vali Acc: 0.706 Test Loss: 1.196 Test Acc: 0.706
Validation loss decreased (-0.683320 --> -0.705544).  Saving model ...
Epoch: 10 cost time: 0.7231447696685791
Epoch: 10, Steps: 12 | Train Loss: 0.899 Vali Loss: 1.110 Vali Acc: 0.728 Test Loss: 1.110 Test Acc: 0.728
Validation loss decreased (-0.705544 --> -0.727767).  Saving model ...
Epoch: 11 cost time: 0.7243850231170654
Epoch: 11, Steps: 12 | Train Loss: 0.807 Vali Loss: 1.034 Vali Acc: 0.711 Test Loss: 1.034 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7009336948394775
Epoch: 12, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.978 Vali Acc: 0.728 Test Loss: 0.978 Test Acc: 0.728
Validation loss decreased (-0.727767 --> -0.727768).  Saving model ...
Epoch: 13 cost time: 0.7667031288146973
Epoch: 13, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.913 Vali Acc: 0.744 Test Loss: 0.913 Test Acc: 0.744
Validation loss decreased (-0.727768 --> -0.744435).  Saving model ...
Epoch: 14 cost time: 0.6835312843322754
Epoch: 14, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.865 Vali Acc: 0.767 Test Loss: 0.865 Test Acc: 0.767
Validation loss decreased (-0.744435 --> -0.766658).  Saving model ...
Epoch: 15 cost time: 0.6221997737884521
Epoch: 15, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.823 Vali Acc: 0.761 Test Loss: 0.823 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6626203060150146
Epoch: 16, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.789 Vali Acc: 0.789 Test Loss: 0.789 Test Acc: 0.789
Validation loss decreased (-0.766658 --> -0.788881).  Saving model ...
Epoch: 17 cost time: 0.7645938396453857
Epoch: 17, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.769 Vali Acc: 0.789 Test Loss: 0.769 Test Acc: 0.789
Validation loss decreased (-0.788881 --> -0.788881).  Saving model ...
Epoch: 18 cost time: 0.7696893215179443
Epoch: 18, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.728 Vali Acc: 0.800 Test Loss: 0.728 Test Acc: 0.800
Validation loss decreased (-0.788881 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 0.7409052848815918
Epoch: 19, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.692 Vali Acc: 0.806 Test Loss: 0.692 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 20 cost time: 0.6864173412322998
Epoch: 20, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.674 Vali Acc: 0.806 Test Loss: 0.674 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805549).  Saving model ...
Epoch: 21 cost time: 0.7265865802764893
Epoch: 21, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.637 Vali Acc: 0.828 Test Loss: 0.637 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827771).  Saving model ...
Epoch: 22 cost time: 0.7063944339752197
Epoch: 22, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.632 Vali Acc: 0.844 Test Loss: 0.632 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 23 cost time: 0.6536116600036621
Epoch: 23, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.609 Vali Acc: 0.833 Test Loss: 0.609 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7471368312835693
Epoch: 24, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.607 Vali Acc: 0.828 Test Loss: 0.607 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7529630661010742
Epoch: 25, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.594 Vali Acc: 0.822 Test Loss: 0.594 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7223398685455322
Epoch: 26, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.571 Vali Acc: 0.850 Test Loss: 0.571 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 27 cost time: 0.7387406826019287
Epoch: 27, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.577 Vali Acc: 0.850 Test Loss: 0.577 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8233897686004639
Epoch: 28, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.563 Vali Acc: 0.839 Test Loss: 0.563 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8280415534973145
Epoch: 29, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.566 Vali Acc: 0.850 Test Loss: 0.566 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 30 cost time: 0.8067262172698975
Epoch: 30, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.565 Vali Acc: 0.839 Test Loss: 0.565 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7300045490264893
Epoch: 31, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.566 Vali Acc: 0.833 Test Loss: 0.566 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7998578548431396
Epoch: 32, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.560 Vali Acc: 0.839 Test Loss: 0.560 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7764327526092529
Epoch: 33, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.563 Vali Acc: 0.839 Test Loss: 0.563 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7691941261291504
Epoch: 34, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.568 Vali Acc: 0.856 Test Loss: 0.568 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 35 cost time: 0.8123352527618408
Epoch: 35, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.554 Vali Acc: 0.856 Test Loss: 0.554 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 36 cost time: 0.7584996223449707
Epoch: 36, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8133199214935303
Epoch: 37, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.569 Vali Acc: 0.856 Test Loss: 0.569 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8141636848449707
Epoch: 38, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.572 Vali Acc: 0.844 Test Loss: 0.572 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7874755859375
Epoch: 39, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7959551811218262
Epoch: 40, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.587 Vali Acc: 0.850 Test Loss: 0.587 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7448010444641113
Epoch: 41, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.579 Vali Acc: 0.856 Test Loss: 0.579 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6764974594116211
Epoch: 42, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.583 Vali Acc: 0.844 Test Loss: 0.583 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7687218189239502
Epoch: 43, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.604 Vali Acc: 0.839 Test Loss: 0.604 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.772038459777832
Epoch: 44, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.587 Vali Acc: 0.850 Test Loss: 0.587 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.7590980529785156
Epoch: 45, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.593 Vali Acc: 0.856 Test Loss: 0.593 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 49679
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9743080139160156
Epoch: 1, Steps: 12 | Train Loss: 2.749 Vali Loss: 2.717 Vali Acc: 0.133 Test Loss: 2.717 Test Acc: 0.133
Validation loss decreased (inf --> -0.133306).  Saving model ...
Epoch: 2 cost time: 0.7157816886901855
Epoch: 2, Steps: 12 | Train Loss: 2.592 Vali Loss: 2.568 Vali Acc: 0.217 Test Loss: 2.568 Test Acc: 0.217
Validation loss decreased (-0.133306 --> -0.216641).  Saving model ...
Epoch: 3 cost time: 0.7284402847290039
Epoch: 3, Steps: 12 | Train Loss: 2.406 Vali Loss: 2.352 Vali Acc: 0.350 Test Loss: 2.352 Test Acc: 0.350
Validation loss decreased (-0.216641 --> -0.349976).  Saving model ...
Epoch: 4 cost time: 0.727546215057373
Epoch: 4, Steps: 12 | Train Loss: 2.143 Vali Loss: 2.118 Vali Acc: 0.450 Test Loss: 2.118 Test Acc: 0.450
Validation loss decreased (-0.349976 --> -0.449979).  Saving model ...
Epoch: 5 cost time: 0.717421293258667
Epoch: 5, Steps: 12 | Train Loss: 1.887 Vali Loss: 1.907 Vali Acc: 0.550 Test Loss: 1.907 Test Acc: 0.550
Validation loss decreased (-0.449979 --> -0.549981).  Saving model ...
Epoch: 6 cost time: 0.668987512588501
Epoch: 6, Steps: 12 | Train Loss: 1.742 Vali Loss: 1.707 Vali Acc: 0.589 Test Loss: 1.707 Test Acc: 0.589
Validation loss decreased (-0.549981 --> -0.588872).  Saving model ...
Epoch: 7 cost time: 0.6713528633117676
Epoch: 7, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.550 Vali Acc: 0.661 Test Loss: 1.550 Test Acc: 0.661
Validation loss decreased (-0.588872 --> -0.661096).  Saving model ...
Epoch: 8 cost time: 0.6487751007080078
Epoch: 8, Steps: 12 | Train Loss: 1.296 Vali Loss: 1.415 Vali Acc: 0.672 Test Loss: 1.415 Test Acc: 0.672
Validation loss decreased (-0.661096 --> -0.672208).  Saving model ...
Epoch: 9 cost time: 0.7002513408660889
Epoch: 9, Steps: 12 | Train Loss: 1.176 Vali Loss: 1.300 Vali Acc: 0.672 Test Loss: 1.300 Test Acc: 0.672
Validation loss decreased (-0.672208 --> -0.672209).  Saving model ...
Epoch: 10 cost time: 0.7108249664306641
Epoch: 10, Steps: 12 | Train Loss: 1.015 Vali Loss: 1.190 Vali Acc: 0.694 Test Loss: 1.190 Test Acc: 0.694
Validation loss decreased (-0.672209 --> -0.694433).  Saving model ...
Epoch: 11 cost time: 0.6875760555267334
Epoch: 11, Steps: 12 | Train Loss: 0.915 Vali Loss: 1.129 Vali Acc: 0.678 Test Loss: 1.129 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7159101963043213
Epoch: 12, Steps: 12 | Train Loss: 0.808 Vali Loss: 1.036 Vali Acc: 0.694 Test Loss: 1.036 Test Acc: 0.694
Validation loss decreased (-0.694433 --> -0.694434).  Saving model ...
Epoch: 13 cost time: 0.6940422058105469
Epoch: 13, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.986 Vali Acc: 0.722 Test Loss: 0.986 Test Acc: 0.722
Validation loss decreased (-0.694434 --> -0.722212).  Saving model ...
Epoch: 14 cost time: 0.7516932487487793
Epoch: 14, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.927 Vali Acc: 0.733 Test Loss: 0.927 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733324).  Saving model ...
Epoch: 15 cost time: 0.737534761428833
Epoch: 15, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.889 Vali Acc: 0.739 Test Loss: 0.889 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738880).  Saving model ...
Epoch: 16 cost time: 0.7378721237182617
Epoch: 16, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.831 Vali Acc: 0.761 Test Loss: 0.831 Test Acc: 0.761
Validation loss decreased (-0.738880 --> -0.761103).  Saving model ...
Epoch: 17 cost time: 0.7259759902954102
Epoch: 17, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.802 Vali Acc: 0.767 Test Loss: 0.802 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766659).  Saving model ...
Epoch: 18 cost time: 0.7602338790893555
Epoch: 18, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.768 Vali Acc: 0.761 Test Loss: 0.768 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7105140686035156
Epoch: 19, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.747 Vali Acc: 0.778 Test Loss: 0.747 Test Acc: 0.778
Validation loss decreased (-0.766659 --> -0.777770).  Saving model ...
Epoch: 20 cost time: 0.6723988056182861
Epoch: 20, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.704 Vali Acc: 0.794 Test Loss: 0.704 Test Acc: 0.794
Validation loss decreased (-0.777770 --> -0.794437).  Saving model ...
Epoch: 21 cost time: 0.7386224269866943
Epoch: 21, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.675 Vali Acc: 0.794 Test Loss: 0.675 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794438).  Saving model ...
Epoch: 22 cost time: 0.6859951019287109
Epoch: 22, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.659 Vali Acc: 0.817 Test Loss: 0.659 Test Acc: 0.817
Validation loss decreased (-0.794438 --> -0.816660).  Saving model ...
Epoch: 23 cost time: 0.6882429122924805
Epoch: 23, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.636 Vali Acc: 0.833 Test Loss: 0.636 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 24 cost time: 0.6818971633911133
Epoch: 24, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.611 Vali Acc: 0.822 Test Loss: 0.611 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7009158134460449
Epoch: 25, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.578 Vali Acc: 0.828 Test Loss: 0.578 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6748228073120117
Epoch: 26, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.577 Vali Acc: 0.833 Test Loss: 0.577 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833328).  Saving model ...
Epoch: 27 cost time: 0.6904335021972656
Epoch: 27, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.561 Vali Acc: 0.833 Test Loss: 0.561 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 28 cost time: 0.7143642902374268
Epoch: 28, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844439).  Saving model ...
Epoch: 29 cost time: 0.716578483581543
Epoch: 29, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 30 cost time: 0.7371633052825928
Epoch: 30, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.510 Vali Acc: 0.856 Test Loss: 0.510 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 31 cost time: 0.6776926517486572
Epoch: 31, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.517 Vali Acc: 0.861 Test Loss: 0.517 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 32 cost time: 0.7736403942108154
Epoch: 32, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.515 Vali Acc: 0.844 Test Loss: 0.515 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6919429302215576
Epoch: 33, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.516 Vali Acc: 0.861 Test Loss: 0.516 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 34 cost time: 0.7334794998168945
Epoch: 34, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6196432113647461
Epoch: 35, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6829128265380859
Epoch: 36, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.496 Vali Acc: 0.867 Test Loss: 0.496 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 37 cost time: 0.720900297164917
Epoch: 37, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.481 Vali Acc: 0.872 Test Loss: 0.481 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 38 cost time: 0.6768600940704346
Epoch: 38, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.490 Vali Acc: 0.867 Test Loss: 0.490 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6463475227355957
Epoch: 39, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.507 Vali Acc: 0.856 Test Loss: 0.507 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7119712829589844
Epoch: 40, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.508 Vali Acc: 0.844 Test Loss: 0.508 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6815881729125977
Epoch: 41, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.496 Vali Acc: 0.861 Test Loss: 0.496 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6664481163024902
Epoch: 42, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.498 Vali Acc: 0.861 Test Loss: 0.498 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6049690246582031
Epoch: 43, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.502 Vali Acc: 0.867 Test Loss: 0.502 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.7454707622528076
Epoch: 44, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.514 Vali Acc: 0.861 Test Loss: 0.514 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.7237498760223389
Epoch: 45, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.533 Vali Acc: 0.861 Test Loss: 0.533 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.7262990474700928
Epoch: 46, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.531 Vali Acc: 0.872 Test Loss: 0.531 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.6951019763946533
Epoch: 47, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.505 Vali Acc: 0.867 Test Loss: 0.505 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 42127
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9489641189575195
Epoch: 1, Steps: 12 | Train Loss: 2.813 Vali Loss: 2.676 Vali Acc: 0.044 Test Loss: 2.676 Test Acc: 0.044
Validation loss decreased (inf --> -0.044418).  Saving model ...
Epoch: 2 cost time: 0.661945104598999
Epoch: 2, Steps: 12 | Train Loss: 2.704 Vali Loss: 2.558 Vali Acc: 0.133 Test Loss: 2.558 Test Acc: 0.133
Validation loss decreased (-0.044418 --> -0.133308).  Saving model ...
Epoch: 3 cost time: 0.6551680564880371
Epoch: 3, Steps: 12 | Train Loss: 2.497 Vali Loss: 2.388 Vali Acc: 0.339 Test Loss: 2.388 Test Acc: 0.339
Validation loss decreased (-0.133308 --> -0.338865).  Saving model ...
Epoch: 4 cost time: 0.6605339050292969
Epoch: 4, Steps: 12 | Train Loss: 2.274 Vali Loss: 2.191 Vali Acc: 0.517 Test Loss: 2.191 Test Acc: 0.517
Validation loss decreased (-0.338865 --> -0.516645).  Saving model ...
Epoch: 5 cost time: 0.672692060470581
Epoch: 5, Steps: 12 | Train Loss: 2.073 Vali Loss: 1.980 Vali Acc: 0.628 Test Loss: 1.980 Test Acc: 0.628
Validation loss decreased (-0.516645 --> -0.627758).  Saving model ...
Epoch: 6 cost time: 0.6943533420562744
Epoch: 6, Steps: 12 | Train Loss: 1.809 Vali Loss: 1.798 Vali Acc: 0.644 Test Loss: 1.798 Test Acc: 0.644
Validation loss decreased (-0.627758 --> -0.644426).  Saving model ...
Epoch: 7 cost time: 0.7091379165649414
Epoch: 7, Steps: 12 | Train Loss: 1.627 Vali Loss: 1.631 Vali Acc: 0.628 Test Loss: 1.631 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7052767276763916
Epoch: 8, Steps: 12 | Train Loss: 1.437 Vali Loss: 1.482 Vali Acc: 0.644 Test Loss: 1.482 Test Acc: 0.644
Validation loss decreased (-0.644426 --> -0.644430).  Saving model ...
Epoch: 9 cost time: 0.6824560165405273
Epoch: 9, Steps: 12 | Train Loss: 1.213 Vali Loss: 1.369 Vali Acc: 0.694 Test Loss: 1.369 Test Acc: 0.694
Validation loss decreased (-0.644430 --> -0.694431).  Saving model ...
Epoch: 10 cost time: 0.6935086250305176
Epoch: 10, Steps: 12 | Train Loss: 1.121 Vali Loss: 1.270 Vali Acc: 0.694 Test Loss: 1.270 Test Acc: 0.694
Validation loss decreased (-0.694431 --> -0.694432).  Saving model ...
Epoch: 11 cost time: 0.7311160564422607
Epoch: 11, Steps: 12 | Train Loss: 0.977 Vali Loss: 1.171 Vali Acc: 0.700 Test Loss: 1.171 Test Acc: 0.700
Validation loss decreased (-0.694432 --> -0.699988).  Saving model ...
Epoch: 12 cost time: 0.7020587921142578
Epoch: 12, Steps: 12 | Train Loss: 0.941 Vali Loss: 1.116 Vali Acc: 0.717 Test Loss: 1.116 Test Acc: 0.717
Validation loss decreased (-0.699988 --> -0.716656).  Saving model ...
Epoch: 13 cost time: 0.6064307689666748
Epoch: 13, Steps: 12 | Train Loss: 0.820 Vali Loss: 1.046 Vali Acc: 0.744 Test Loss: 1.046 Test Acc: 0.744
Validation loss decreased (-0.716656 --> -0.744434).  Saving model ...
Epoch: 14 cost time: 0.6655738353729248
Epoch: 14, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.976 Vali Acc: 0.756 Test Loss: 0.976 Test Acc: 0.756
Validation loss decreased (-0.744434 --> -0.755546).  Saving model ...
Epoch: 15 cost time: 0.7486128807067871
Epoch: 15, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.945 Vali Acc: 0.756 Test Loss: 0.945 Test Acc: 0.756
Validation loss decreased (-0.755546 --> -0.755546).  Saving model ...
Epoch: 16 cost time: 0.7056441307067871
Epoch: 16, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.895 Vali Acc: 0.739 Test Loss: 0.895 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6723542213439941
Epoch: 17, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.844 Vali Acc: 0.767 Test Loss: 0.844 Test Acc: 0.767
Validation loss decreased (-0.755546 --> -0.766658).  Saving model ...
Epoch: 18 cost time: 0.6796433925628662
Epoch: 18, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.813 Vali Acc: 0.772 Test Loss: 0.813 Test Acc: 0.772
Validation loss decreased (-0.766658 --> -0.772214).  Saving model ...
Epoch: 19 cost time: 0.7050094604492188
Epoch: 19, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.788 Vali Acc: 0.783 Test Loss: 0.788 Test Acc: 0.783
Validation loss decreased (-0.772214 --> -0.783325).  Saving model ...
Epoch: 20 cost time: 0.6349489688873291
Epoch: 20, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.737 Vali Acc: 0.789 Test Loss: 0.737 Test Acc: 0.789
Validation loss decreased (-0.783325 --> -0.788882).  Saving model ...
Epoch: 21 cost time: 0.6916348934173584
Epoch: 21, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.720 Vali Acc: 0.806 Test Loss: 0.720 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805548).  Saving model ...
Epoch: 22 cost time: 0.7020077705383301
Epoch: 22, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.694 Vali Acc: 0.817 Test Loss: 0.694 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816660).  Saving model ...
Epoch: 23 cost time: 0.6952366828918457
Epoch: 23, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.670 Vali Acc: 0.828 Test Loss: 0.670 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 24 cost time: 0.679638147354126
Epoch: 24, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.627 Vali Acc: 0.839 Test Loss: 0.627 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838883).  Saving model ...
Epoch: 25 cost time: 0.6517817974090576
Epoch: 25, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.611 Vali Acc: 0.828 Test Loss: 0.611 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7128760814666748
Epoch: 26, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.606 Vali Acc: 0.822 Test Loss: 0.606 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7096197605133057
Epoch: 27, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.587 Vali Acc: 0.828 Test Loss: 0.587 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6870613098144531
Epoch: 28, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.571 Vali Acc: 0.839 Test Loss: 0.571 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 29 cost time: 0.6243939399719238
Epoch: 29, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.542 Vali Acc: 0.844 Test Loss: 0.542 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 30 cost time: 0.648688554763794
Epoch: 30, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 31 cost time: 0.6475179195404053
Epoch: 31, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 32 cost time: 0.6528048515319824
Epoch: 32, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.511 Vali Acc: 0.856 Test Loss: 0.511 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 33 cost time: 0.6865832805633545
Epoch: 33, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6944277286529541
Epoch: 34, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6686975955963135
Epoch: 35, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6860620975494385
Epoch: 36, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.513 Vali Acc: 0.856 Test Loss: 0.513 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6709957122802734
Epoch: 37, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7070188522338867
Epoch: 38, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.485 Vali Acc: 0.861 Test Loss: 0.485 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 39 cost time: 0.7116718292236328
Epoch: 39, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.491 Vali Acc: 0.861 Test Loss: 0.491 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7551412582397461
Epoch: 40, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.480 Vali Acc: 0.856 Test Loss: 0.480 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7241089344024658
Epoch: 41, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.495 Vali Acc: 0.861 Test Loss: 0.495 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6989872455596924
Epoch: 42, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.473 Vali Acc: 0.861 Test Loss: 0.473 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 43 cost time: 0.6930792331695557
Epoch: 43, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.474 Vali Acc: 0.867 Test Loss: 0.474 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 44 cost time: 0.6893949508666992
Epoch: 44, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.496 Vali Acc: 0.856 Test Loss: 0.496 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5373337268829346
Epoch: 45, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.481 Vali Acc: 0.856 Test Loss: 0.481 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6467890739440918
Epoch: 46, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.483 Vali Acc: 0.861 Test Loss: 0.483 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6933488845825195
Epoch: 47, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.500 Vali Acc: 0.872 Test Loss: 0.500 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 48 cost time: 0.6521368026733398
Epoch: 48, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.494 Vali Acc: 0.861 Test Loss: 0.494 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6200149059295654
Epoch: 49, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.491 Vali Acc: 0.872 Test Loss: 0.491 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 50 cost time: 0.6587705612182617
Epoch: 50, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.499 Vali Acc: 0.872 Test Loss: 0.499 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 38415
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9583804607391357
Epoch: 1, Steps: 12 | Train Loss: 2.782 Vali Loss: 2.705 Vali Acc: 0.078 Test Loss: 2.705 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 0.8066599369049072
Epoch: 2, Steps: 12 | Train Loss: 2.623 Vali Loss: 2.622 Vali Acc: 0.122 Test Loss: 2.622 Test Acc: 0.122
Validation loss decreased (-0.077751 --> -0.122196).  Saving model ...
Epoch: 3 cost time: 0.7370748519897461
Epoch: 3, Steps: 12 | Train Loss: 2.476 Vali Loss: 2.475 Vali Acc: 0.261 Test Loss: 2.475 Test Acc: 0.261
Validation loss decreased (-0.122196 --> -0.261086).  Saving model ...
Epoch: 4 cost time: 0.71514892578125
Epoch: 4, Steps: 12 | Train Loss: 2.293 Vali Loss: 2.299 Vali Acc: 0.383 Test Loss: 2.299 Test Acc: 0.383
Validation loss decreased (-0.261086 --> -0.383310).  Saving model ...
Epoch: 5 cost time: 0.6592679023742676
Epoch: 5, Steps: 12 | Train Loss: 2.134 Vali Loss: 2.125 Vali Acc: 0.472 Test Loss: 2.125 Test Acc: 0.472
Validation loss decreased (-0.383310 --> -0.472201).  Saving model ...
Epoch: 6 cost time: 0.719822883605957
Epoch: 6, Steps: 12 | Train Loss: 1.932 Vali Loss: 1.958 Vali Acc: 0.561 Test Loss: 1.958 Test Acc: 0.561
Validation loss decreased (-0.472201 --> -0.561092).  Saving model ...
Epoch: 7 cost time: 0.6901297569274902
Epoch: 7, Steps: 12 | Train Loss: 1.767 Vali Loss: 1.816 Vali Acc: 0.594 Test Loss: 1.816 Test Acc: 0.594
Validation loss decreased (-0.561092 --> -0.594426).  Saving model ...
Epoch: 8 cost time: 0.7666730880737305
Epoch: 8, Steps: 12 | Train Loss: 1.596 Vali Loss: 1.682 Vali Acc: 0.628 Test Loss: 1.682 Test Acc: 0.628
Validation loss decreased (-0.594426 --> -0.627761).  Saving model ...
Epoch: 9 cost time: 0.5953600406646729
Epoch: 9, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.550 Vali Acc: 0.639 Test Loss: 1.550 Test Acc: 0.639
Validation loss decreased (-0.627761 --> -0.638873).  Saving model ...
Epoch: 10 cost time: 0.625725269317627
Epoch: 10, Steps: 12 | Train Loss: 1.319 Vali Loss: 1.459 Vali Acc: 0.667 Test Loss: 1.459 Test Acc: 0.667
Validation loss decreased (-0.638873 --> -0.666652).  Saving model ...
Epoch: 11 cost time: 0.7689571380615234
Epoch: 11, Steps: 12 | Train Loss: 1.176 Vali Loss: 1.380 Vali Acc: 0.683 Test Loss: 1.380 Test Acc: 0.683
Validation loss decreased (-0.666652 --> -0.683320).  Saving model ...
Epoch: 12 cost time: 0.6506016254425049
Epoch: 12, Steps: 12 | Train Loss: 1.093 Vali Loss: 1.279 Vali Acc: 0.683 Test Loss: 1.279 Test Acc: 0.683
Validation loss decreased (-0.683320 --> -0.683321).  Saving model ...
Epoch: 13 cost time: 0.7262771129608154
Epoch: 13, Steps: 12 | Train Loss: 0.976 Vali Loss: 1.188 Vali Acc: 0.711 Test Loss: 1.188 Test Acc: 0.711
Validation loss decreased (-0.683321 --> -0.711099).  Saving model ...
Epoch: 14 cost time: 0.6949589252471924
Epoch: 14, Steps: 12 | Train Loss: 0.880 Vali Loss: 1.120 Vali Acc: 0.717 Test Loss: 1.120 Test Acc: 0.717
Validation loss decreased (-0.711099 --> -0.716655).  Saving model ...
Epoch: 15 cost time: 0.6915018558502197
Epoch: 15, Steps: 12 | Train Loss: 0.832 Vali Loss: 1.051 Vali Acc: 0.717 Test Loss: 1.051 Test Acc: 0.717
Validation loss decreased (-0.716655 --> -0.716656).  Saving model ...
Epoch: 16 cost time: 0.6844193935394287
Epoch: 16, Steps: 12 | Train Loss: 0.750 Vali Loss: 1.010 Vali Acc: 0.728 Test Loss: 1.010 Test Acc: 0.728
Validation loss decreased (-0.716656 --> -0.727768).  Saving model ...
Epoch: 17 cost time: 0.6835649013519287
Epoch: 17, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.967 Vali Acc: 0.739 Test Loss: 0.967 Test Acc: 0.739
Validation loss decreased (-0.727768 --> -0.738879).  Saving model ...
Epoch: 18 cost time: 0.6905331611633301
Epoch: 18, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.910 Vali Acc: 0.739 Test Loss: 0.910 Test Acc: 0.739
Validation loss decreased (-0.738879 --> -0.738880).  Saving model ...
Epoch: 19 cost time: 0.7231354713439941
Epoch: 19, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.876 Vali Acc: 0.756 Test Loss: 0.876 Test Acc: 0.756
Validation loss decreased (-0.738880 --> -0.755547).  Saving model ...
Epoch: 20 cost time: 0.6783881187438965
Epoch: 20, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.831 Vali Acc: 0.772 Test Loss: 0.831 Test Acc: 0.772
Validation loss decreased (-0.755547 --> -0.772214).  Saving model ...
Epoch: 21 cost time: 0.6885690689086914
Epoch: 21, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.818 Vali Acc: 0.767 Test Loss: 0.818 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6849076747894287
Epoch: 22, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.771 Vali Acc: 0.783 Test Loss: 0.771 Test Acc: 0.783
Validation loss decreased (-0.772214 --> -0.783326).  Saving model ...
Epoch: 23 cost time: 0.7583308219909668
Epoch: 23, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.733 Vali Acc: 0.783 Test Loss: 0.733 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783326).  Saving model ...
Epoch: 24 cost time: 0.7140407562255859
Epoch: 24, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.719 Vali Acc: 0.783 Test Loss: 0.719 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783326).  Saving model ...
Epoch: 25 cost time: 0.6837654113769531
Epoch: 25, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.689 Vali Acc: 0.783 Test Loss: 0.689 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783326).  Saving model ...
Epoch: 26 cost time: 0.6819915771484375
Epoch: 26, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.668 Vali Acc: 0.783 Test Loss: 0.668 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783327).  Saving model ...
Epoch: 27 cost time: 0.6836376190185547
Epoch: 27, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.634 Vali Acc: 0.817 Test Loss: 0.634 Test Acc: 0.817
Validation loss decreased (-0.783327 --> -0.816660).  Saving model ...
Epoch: 28 cost time: 0.7446208000183105
Epoch: 28, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.601 Vali Acc: 0.811 Test Loss: 0.601 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6059672832489014
Epoch: 29, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.585 Vali Acc: 0.811 Test Loss: 0.585 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.706566572189331
Epoch: 30, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.575 Vali Acc: 0.822 Test Loss: 0.575 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 31 cost time: 0.6676526069641113
Epoch: 31, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.566 Vali Acc: 0.833 Test Loss: 0.566 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833328).  Saving model ...
Epoch: 32 cost time: 0.6987855434417725
Epoch: 32, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.556 Vali Acc: 0.822 Test Loss: 0.556 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7070233821868896
Epoch: 33, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6699244976043701
Epoch: 34, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.551 Vali Acc: 0.844 Test Loss: 0.551 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844439).  Saving model ...
Epoch: 35 cost time: 0.6963169574737549
Epoch: 35, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.521 Vali Acc: 0.839 Test Loss: 0.521 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6661713123321533
Epoch: 36, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.506 Vali Acc: 0.839 Test Loss: 0.506 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.700925350189209
Epoch: 37, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.525 Vali Acc: 0.833 Test Loss: 0.525 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6616253852844238
Epoch: 38, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.545 Vali Acc: 0.828 Test Loss: 0.545 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7023043632507324
Epoch: 39, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.544 Vali Acc: 0.844 Test Loss: 0.544 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 40 cost time: 0.7744812965393066
Epoch: 40, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 41 cost time: 0.765413761138916
Epoch: 41, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6966290473937988
Epoch: 42, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7836813926696777
Epoch: 43, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.503 Vali Acc: 0.861 Test Loss: 0.503 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861106).  Saving model ...
Epoch: 44 cost time: 0.7879440784454346
Epoch: 44, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.515 Vali Acc: 0.867 Test Loss: 0.515 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 45 cost time: 0.8061449527740479
Epoch: 45, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.517 Vali Acc: 0.856 Test Loss: 0.517 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8024420738220215
Epoch: 46, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.498 Vali Acc: 0.872 Test Loss: 0.498 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 47 cost time: 0.8421103954315186
Epoch: 47, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.491 Vali Acc: 0.856 Test Loss: 0.491 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7768757343292236
Epoch: 48, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.517 Vali Acc: 0.844 Test Loss: 0.517 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7947998046875
Epoch: 49, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.7535388469696045
Epoch: 50, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.533 Vali Acc: 0.856 Test Loss: 0.533 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 34767
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9754295349121094
Epoch: 1, Steps: 12 | Train Loss: 2.710 Vali Loss: 2.674 Vali Acc: 0.128 Test Loss: 2.674 Test Acc: 0.128
Validation loss decreased (inf --> -0.127751).  Saving model ...
Epoch: 2 cost time: 0.6977009773254395
Epoch: 2, Steps: 12 | Train Loss: 2.461 Vali Loss: 2.416 Vali Acc: 0.378 Test Loss: 2.416 Test Acc: 0.378
Validation loss decreased (-0.127751 --> -0.377754).  Saving model ...
Epoch: 3 cost time: 0.7349636554718018
Epoch: 3, Steps: 12 | Train Loss: 2.082 Vali Loss: 2.067 Vali Acc: 0.517 Test Loss: 2.067 Test Acc: 0.517
Validation loss decreased (-0.377754 --> -0.516646).  Saving model ...
Epoch: 4 cost time: 0.7328827381134033
Epoch: 4, Steps: 12 | Train Loss: 1.746 Vali Loss: 1.725 Vali Acc: 0.617 Test Loss: 1.725 Test Acc: 0.617
Validation loss decreased (-0.516646 --> -0.616649).  Saving model ...
Epoch: 5 cost time: 0.7145891189575195
Epoch: 5, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.480 Vali Acc: 0.644 Test Loss: 1.480 Test Acc: 0.644
Validation loss decreased (-0.616649 --> -0.644430).  Saving model ...
Epoch: 6 cost time: 0.7478668689727783
Epoch: 6, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.315 Vali Acc: 0.683 Test Loss: 1.315 Test Acc: 0.683
Validation loss decreased (-0.644430 --> -0.683320).  Saving model ...
Epoch: 7 cost time: 0.7184765338897705
Epoch: 7, Steps: 12 | Train Loss: 1.044 Vali Loss: 1.191 Vali Acc: 0.694 Test Loss: 1.191 Test Acc: 0.694
Validation loss decreased (-0.683320 --> -0.694433).  Saving model ...
Epoch: 8 cost time: 0.6974303722381592
Epoch: 8, Steps: 12 | Train Loss: 0.871 Vali Loss: 1.086 Vali Acc: 0.683 Test Loss: 1.086 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6317853927612305
Epoch: 9, Steps: 12 | Train Loss: 0.794 Vali Loss: 1.024 Vali Acc: 0.700 Test Loss: 1.024 Test Acc: 0.700
Validation loss decreased (-0.694433 --> -0.699990).  Saving model ...
Epoch: 10 cost time: 0.686089038848877
Epoch: 10, Steps: 12 | Train Loss: 0.698 Vali Loss: 0.938 Vali Acc: 0.728 Test Loss: 0.938 Test Acc: 0.728
Validation loss decreased (-0.699990 --> -0.727768).  Saving model ...
Epoch: 11 cost time: 0.6888370513916016
Epoch: 11, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.890 Vali Acc: 0.717 Test Loss: 0.890 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6688504219055176
Epoch: 12, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.853 Vali Acc: 0.739 Test Loss: 0.853 Test Acc: 0.739
Validation loss decreased (-0.727768 --> -0.738880).  Saving model ...
Epoch: 13 cost time: 0.6857891082763672
Epoch: 13, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.829 Vali Acc: 0.739 Test Loss: 0.829 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738881).  Saving model ...
Epoch: 14 cost time: 0.6770157814025879
Epoch: 14, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.788 Vali Acc: 0.767 Test Loss: 0.788 Test Acc: 0.767
Validation loss decreased (-0.738881 --> -0.766659).  Saving model ...
Epoch: 15 cost time: 0.617218017578125
Epoch: 15, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.750 Vali Acc: 0.783 Test Loss: 0.750 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783326).  Saving model ...
Epoch: 16 cost time: 0.6750080585479736
Epoch: 16, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.715 Vali Acc: 0.783 Test Loss: 0.715 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783326).  Saving model ...
Epoch: 17 cost time: 0.5988733768463135
Epoch: 17, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.700 Vali Acc: 0.806 Test Loss: 0.700 Test Acc: 0.806
Validation loss decreased (-0.783326 --> -0.805549).  Saving model ...
Epoch: 18 cost time: 0.6466901302337646
Epoch: 18, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.678 Vali Acc: 0.806 Test Loss: 0.678 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805549).  Saving model ...
Epoch: 19 cost time: 0.6745486259460449
Epoch: 19, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.658 Vali Acc: 0.811 Test Loss: 0.658 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 20 cost time: 0.7155330181121826
Epoch: 20, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.663 Vali Acc: 0.800 Test Loss: 0.663 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7288393974304199
Epoch: 21, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.633 Vali Acc: 0.822 Test Loss: 0.633 Test Acc: 0.822
Validation loss decreased (-0.811105 --> -0.822216).  Saving model ...
Epoch: 22 cost time: 0.7469785213470459
Epoch: 22, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.669 Vali Acc: 0.817 Test Loss: 0.669 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6907341480255127
Epoch: 23, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.649 Vali Acc: 0.811 Test Loss: 0.649 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7038753032684326
Epoch: 24, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.608 Vali Acc: 0.822 Test Loss: 0.608 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 25 cost time: 0.7153124809265137
Epoch: 25, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.592 Vali Acc: 0.844 Test Loss: 0.592 Test Acc: 0.844
Validation loss decreased (-0.822216 --> -0.844439).  Saving model ...
Epoch: 26 cost time: 0.7617747783660889
Epoch: 26, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.609 Vali Acc: 0.839 Test Loss: 0.609 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7751846313476562
Epoch: 27, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.616 Vali Acc: 0.839 Test Loss: 0.616 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7149391174316406
Epoch: 28, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.608 Vali Acc: 0.833 Test Loss: 0.608 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.706341028213501
Epoch: 29, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.612 Vali Acc: 0.828 Test Loss: 0.612 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7939841747283936
Epoch: 30, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.611 Vali Acc: 0.844 Test Loss: 0.611 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6506330966949463
Epoch: 31, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.606 Vali Acc: 0.850 Test Loss: 0.606 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 32 cost time: 0.6884737014770508
Epoch: 32, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.601 Vali Acc: 0.844 Test Loss: 0.601 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6778733730316162
Epoch: 33, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6805646419525146
Epoch: 34, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.609 Vali Acc: 0.850 Test Loss: 0.609 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6804368495941162
Epoch: 35, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.619 Vali Acc: 0.844 Test Loss: 0.619 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7469959259033203
Epoch: 36, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.636 Vali Acc: 0.856 Test Loss: 0.636 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 37 cost time: 0.6758549213409424
Epoch: 37, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.617 Vali Acc: 0.844 Test Loss: 0.617 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7497119903564453
Epoch: 38, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.617 Vali Acc: 0.856 Test Loss: 0.617 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 39 cost time: 0.6702344417572021
Epoch: 39, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.622 Vali Acc: 0.867 Test Loss: 0.622 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866660).  Saving model ...
Epoch: 40 cost time: 0.7521731853485107
Epoch: 40, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.649 Vali Acc: 0.856 Test Loss: 0.649 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7060763835906982
Epoch: 41, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.650 Vali Acc: 0.844 Test Loss: 0.650 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8222124576568604
Epoch: 42, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.632 Vali Acc: 0.844 Test Loss: 0.632 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7385344505310059
Epoch: 43, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.659 Vali Acc: 0.856 Test Loss: 0.659 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7688841819763184
Epoch: 44, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.660 Vali Acc: 0.856 Test Loss: 0.660 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8572521209716797
Epoch: 45, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.696 Vali Acc: 0.861 Test Loss: 0.696 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7565312385559082
Epoch: 46, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.699 Vali Acc: 0.856 Test Loss: 0.699 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.7163965702056885
Epoch: 47, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.669 Vali Acc: 0.856 Test Loss: 0.669 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.7238285541534424
Epoch: 48, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.660 Vali Acc: 0.861 Test Loss: 0.660 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.7201263904571533
Epoch: 49, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.665 Vali Acc: 0.872 Test Loss: 0.665 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872216).  Saving model ...
Epoch: 50 cost time: 0.711749792098999
Epoch: 50, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.668 Vali Acc: 0.878 Test Loss: 0.668 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877771).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 49455
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.878814697265625
Epoch: 1, Steps: 12 | Train Loss: 2.787 Vali Loss: 2.726 Vali Acc: 0.072 Test Loss: 2.726 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 0.6668663024902344
Epoch: 2, Steps: 12 | Train Loss: 2.664 Vali Loss: 2.603 Vali Acc: 0.122 Test Loss: 2.603 Test Acc: 0.122
Validation loss decreased (-0.072195 --> -0.122196).  Saving model ...
Epoch: 3 cost time: 0.6146767139434814
Epoch: 3, Steps: 12 | Train Loss: 2.447 Vali Loss: 2.410 Vali Acc: 0.283 Test Loss: 2.410 Test Acc: 0.283
Validation loss decreased (-0.122196 --> -0.283309).  Saving model ...
Epoch: 4 cost time: 0.6847541332244873
Epoch: 4, Steps: 12 | Train Loss: 2.225 Vali Loss: 2.172 Vali Acc: 0.483 Test Loss: 2.172 Test Acc: 0.483
Validation loss decreased (-0.283309 --> -0.483312).  Saving model ...
Epoch: 5 cost time: 0.6578450202941895
Epoch: 5, Steps: 12 | Train Loss: 1.980 Vali Loss: 1.951 Vali Acc: 0.533 Test Loss: 1.951 Test Acc: 0.533
Validation loss decreased (-0.483312 --> -0.533314).  Saving model ...
Epoch: 6 cost time: 0.6542060375213623
Epoch: 6, Steps: 12 | Train Loss: 1.710 Vali Loss: 1.756 Vali Acc: 0.589 Test Loss: 1.756 Test Acc: 0.589
Validation loss decreased (-0.533314 --> -0.588871).  Saving model ...
Epoch: 7 cost time: 0.7109558582305908
Epoch: 7, Steps: 12 | Train Loss: 1.522 Vali Loss: 1.602 Vali Acc: 0.633 Test Loss: 1.602 Test Acc: 0.633
Validation loss decreased (-0.588871 --> -0.633317).  Saving model ...
Epoch: 8 cost time: 0.7310614585876465
Epoch: 8, Steps: 12 | Train Loss: 1.342 Vali Loss: 1.453 Vali Acc: 0.661 Test Loss: 1.453 Test Acc: 0.661
Validation loss decreased (-0.633317 --> -0.661097).  Saving model ...
Epoch: 9 cost time: 0.7101821899414062
Epoch: 9, Steps: 12 | Train Loss: 1.184 Vali Loss: 1.323 Vali Acc: 0.678 Test Loss: 1.323 Test Acc: 0.678
Validation loss decreased (-0.661097 --> -0.677765).  Saving model ...
Epoch: 10 cost time: 0.7085292339324951
Epoch: 10, Steps: 12 | Train Loss: 1.032 Vali Loss: 1.247 Vali Acc: 0.700 Test Loss: 1.247 Test Acc: 0.700
Validation loss decreased (-0.677765 --> -0.699988).  Saving model ...
Epoch: 11 cost time: 0.7278909683227539
Epoch: 11, Steps: 12 | Train Loss: 0.956 Vali Loss: 1.154 Vali Acc: 0.706 Test Loss: 1.154 Test Acc: 0.706
Validation loss decreased (-0.699988 --> -0.705544).  Saving model ...
Epoch: 12 cost time: 0.7107892036437988
Epoch: 12, Steps: 12 | Train Loss: 0.809 Vali Loss: 1.073 Vali Acc: 0.706 Test Loss: 1.073 Test Acc: 0.706
Validation loss decreased (-0.705544 --> -0.705545).  Saving model ...
Epoch: 13 cost time: 0.7247970104217529
Epoch: 13, Steps: 12 | Train Loss: 0.750 Vali Loss: 1.034 Vali Acc: 0.711 Test Loss: 1.034 Test Acc: 0.711
Validation loss decreased (-0.705545 --> -0.711101).  Saving model ...
Epoch: 14 cost time: 0.6130621433258057
Epoch: 14, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.981 Vali Acc: 0.733 Test Loss: 0.981 Test Acc: 0.733
Validation loss decreased (-0.711101 --> -0.733324).  Saving model ...
Epoch: 15 cost time: 0.6592931747436523
Epoch: 15, Steps: 12 | Train Loss: 0.670 Vali Loss: 0.913 Vali Acc: 0.744 Test Loss: 0.913 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744435).  Saving model ...
Epoch: 16 cost time: 0.6322939395904541
Epoch: 16, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.876 Vali Acc: 0.733 Test Loss: 0.876 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6316566467285156
Epoch: 17, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.859 Vali Acc: 0.733 Test Loss: 0.859 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6530463695526123
Epoch: 18, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.807 Vali Acc: 0.739 Test Loss: 0.807 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5942797660827637
Epoch: 19, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.773 Vali Acc: 0.739 Test Loss: 0.773 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6372466087341309
Epoch: 20, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.737 Vali Acc: 0.761 Test Loss: 0.737 Test Acc: 0.761
Validation loss decreased (-0.744435 --> -0.761104).  Saving model ...
Epoch: 21 cost time: 0.6310164928436279
Epoch: 21, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.738 Vali Acc: 0.767 Test Loss: 0.738 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766659).  Saving model ...
Epoch: 22 cost time: 0.6124095916748047
Epoch: 22, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.709 Vali Acc: 0.772 Test Loss: 0.709 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772215).  Saving model ...
Epoch: 23 cost time: 0.6495711803436279
Epoch: 23, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.690 Vali Acc: 0.778 Test Loss: 0.690 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777771).  Saving model ...
Epoch: 24 cost time: 0.6824827194213867
Epoch: 24, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.662 Vali Acc: 0.811 Test Loss: 0.662 Test Acc: 0.811
Validation loss decreased (-0.777771 --> -0.811104).  Saving model ...
Epoch: 25 cost time: 0.6597199440002441
Epoch: 25, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.637 Vali Acc: 0.817 Test Loss: 0.637 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 26 cost time: 0.672703742980957
Epoch: 26, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.646 Vali Acc: 0.806 Test Loss: 0.646 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6540253162384033
Epoch: 27, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.655 Vali Acc: 0.811 Test Loss: 0.655 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7191989421844482
Epoch: 28, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.621 Vali Acc: 0.817 Test Loss: 0.621 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 29 cost time: 0.6935060024261475
Epoch: 29, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.633 Vali Acc: 0.811 Test Loss: 0.633 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.655738353729248
Epoch: 30, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.610 Vali Acc: 0.811 Test Loss: 0.610 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6741764545440674
Epoch: 31, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.608 Vali Acc: 0.828 Test Loss: 0.608 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827772).  Saving model ...
Epoch: 32 cost time: 0.7829582691192627
Epoch: 32, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.592 Vali Acc: 0.811 Test Loss: 0.592 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6664919853210449
Epoch: 33, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.603 Vali Acc: 0.839 Test Loss: 0.603 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 34 cost time: 0.6960644721984863
Epoch: 34, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.598 Vali Acc: 0.833 Test Loss: 0.598 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6323056221008301
Epoch: 35, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.591 Vali Acc: 0.828 Test Loss: 0.591 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6375842094421387
Epoch: 36, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.573 Vali Acc: 0.839 Test Loss: 0.573 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 37 cost time: 0.6403682231903076
Epoch: 37, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7156317234039307
Epoch: 38, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.567 Vali Acc: 0.839 Test Loss: 0.567 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 39 cost time: 0.6188931465148926
Epoch: 39, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.581 Vali Acc: 0.844 Test Loss: 0.581 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 40 cost time: 0.6540899276733398
Epoch: 40, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.589 Vali Acc: 0.839 Test Loss: 0.589 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6648273468017578
Epoch: 41, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.576 Vali Acc: 0.828 Test Loss: 0.576 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6805403232574463
Epoch: 42, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.572 Vali Acc: 0.839 Test Loss: 0.572 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6136319637298584
Epoch: 43, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.580 Vali Acc: 0.839 Test Loss: 0.580 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.47045183181762695
Epoch: 44, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.579 Vali Acc: 0.844 Test Loss: 0.579 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 45 cost time: 0.5887374877929688
Epoch: 45, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.573 Vali Acc: 0.856 Test Loss: 0.573 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 46 cost time: 0.5784580707550049
Epoch: 46, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.579 Vali Acc: 0.856 Test Loss: 0.579 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5834455490112305
Epoch: 47, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.575 Vali Acc: 0.839 Test Loss: 0.575 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5849637985229492
Epoch: 48, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.597 Vali Acc: 0.850 Test Loss: 0.597 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.6435823440551758
Epoch: 49, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.612 Vali Acc: 0.844 Test Loss: 0.612 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.700838565826416
Epoch: 50, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.601 Vali Acc: 0.856 Test Loss: 0.601 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 27407
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.7378206253051758
Epoch: 1, Steps: 12 | Train Loss: 2.822 Vali Loss: 2.726 Vali Acc: 0.061 Test Loss: 2.726 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 0.6443195343017578
Epoch: 2, Steps: 12 | Train Loss: 2.642 Vali Loss: 2.576 Vali Acc: 0.139 Test Loss: 2.576 Test Acc: 0.139
Validation loss decreased (-0.061084 --> -0.138863).  Saving model ...
Epoch: 3 cost time: 0.6633031368255615
Epoch: 3, Steps: 12 | Train Loss: 2.400 Vali Loss: 2.362 Vali Acc: 0.344 Test Loss: 2.362 Test Acc: 0.344
Validation loss decreased (-0.138863 --> -0.344421).  Saving model ...
Epoch: 4 cost time: 0.6207189559936523
Epoch: 4, Steps: 12 | Train Loss: 2.156 Vali Loss: 2.123 Vali Acc: 0.517 Test Loss: 2.123 Test Acc: 0.517
Validation loss decreased (-0.344421 --> -0.516645).  Saving model ...
Epoch: 5 cost time: 0.6107583045959473
Epoch: 5, Steps: 12 | Train Loss: 1.904 Vali Loss: 1.899 Vali Acc: 0.583 Test Loss: 1.899 Test Acc: 0.583
Validation loss decreased (-0.516645 --> -0.583314).  Saving model ...
Epoch: 6 cost time: 0.6824593544006348
Epoch: 6, Steps: 12 | Train Loss: 1.664 Vali Loss: 1.734 Vali Acc: 0.644 Test Loss: 1.734 Test Acc: 0.644
Validation loss decreased (-0.583314 --> -0.644427).  Saving model ...
Epoch: 7 cost time: 0.6358351707458496
Epoch: 7, Steps: 12 | Train Loss: 1.485 Vali Loss: 1.572 Vali Acc: 0.661 Test Loss: 1.572 Test Acc: 0.661
Validation loss decreased (-0.644427 --> -0.661095).  Saving model ...
Epoch: 8 cost time: 0.6491198539733887
Epoch: 8, Steps: 12 | Train Loss: 1.290 Vali Loss: 1.431 Vali Acc: 0.683 Test Loss: 1.431 Test Acc: 0.683
Validation loss decreased (-0.661095 --> -0.683319).  Saving model ...
Epoch: 9 cost time: 0.6693980693817139
Epoch: 9, Steps: 12 | Train Loss: 1.140 Vali Loss: 1.334 Vali Acc: 0.678 Test Loss: 1.334 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7011175155639648
Epoch: 10, Steps: 12 | Train Loss: 1.059 Vali Loss: 1.241 Vali Acc: 0.672 Test Loss: 1.241 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6851291656494141
Epoch: 11, Steps: 12 | Train Loss: 0.957 Vali Loss: 1.145 Vali Acc: 0.689 Test Loss: 1.145 Test Acc: 0.689
Validation loss decreased (-0.683319 --> -0.688877).  Saving model ...
Epoch: 12 cost time: 0.6752686500549316
Epoch: 12, Steps: 12 | Train Loss: 0.861 Vali Loss: 1.084 Vali Acc: 0.700 Test Loss: 1.084 Test Acc: 0.700
Validation loss decreased (-0.688877 --> -0.699989).  Saving model ...
Epoch: 13 cost time: 0.6662142276763916
Epoch: 13, Steps: 12 | Train Loss: 0.767 Vali Loss: 1.048 Vali Acc: 0.711 Test Loss: 1.048 Test Acc: 0.711
Validation loss decreased (-0.699989 --> -0.711101).  Saving model ...
Epoch: 14 cost time: 0.6637623310089111
Epoch: 14, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.978 Vali Acc: 0.733 Test Loss: 0.978 Test Acc: 0.733
Validation loss decreased (-0.711101 --> -0.733324).  Saving model ...
Epoch: 15 cost time: 0.6450846195220947
Epoch: 15, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.932 Vali Acc: 0.739 Test Loss: 0.932 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738880).  Saving model ...
Epoch: 16 cost time: 0.6994044780731201
Epoch: 16, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.882 Vali Acc: 0.767 Test Loss: 0.882 Test Acc: 0.767
Validation loss decreased (-0.738880 --> -0.766658).  Saving model ...
Epoch: 17 cost time: 0.6998319625854492
Epoch: 17, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.862 Vali Acc: 0.761 Test Loss: 0.862 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6859779357910156
Epoch: 18, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.820 Vali Acc: 0.778 Test Loss: 0.820 Test Acc: 0.778
Validation loss decreased (-0.766658 --> -0.777770).  Saving model ...
Epoch: 19 cost time: 0.7200396060943604
Epoch: 19, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.794 Vali Acc: 0.800 Test Loss: 0.794 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799992).  Saving model ...
Epoch: 20 cost time: 0.6254241466522217
Epoch: 20, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.760 Vali Acc: 0.822 Test Loss: 0.760 Test Acc: 0.822
Validation loss decreased (-0.799992 --> -0.822215).  Saving model ...
Epoch: 21 cost time: 0.599064826965332
Epoch: 21, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.722 Vali Acc: 0.811 Test Loss: 0.722 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6553366184234619
Epoch: 22, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.713 Vali Acc: 0.811 Test Loss: 0.713 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6564977169036865
Epoch: 23, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.705 Vali Acc: 0.800 Test Loss: 0.705 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6282739639282227
Epoch: 24, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.670 Vali Acc: 0.828 Test Loss: 0.670 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 25 cost time: 0.6815588474273682
Epoch: 25, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.670 Vali Acc: 0.828 Test Loss: 0.670 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 26 cost time: 0.7269046306610107
Epoch: 26, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.642 Vali Acc: 0.839 Test Loss: 0.642 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 27 cost time: 0.7066972255706787
Epoch: 27, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 0.6682865619659424
Epoch: 28, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.609 Vali Acc: 0.839 Test Loss: 0.609 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6793556213378906
Epoch: 29, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.603 Vali Acc: 0.833 Test Loss: 0.603 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7017409801483154
Epoch: 30, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 31 cost time: 0.7104144096374512
Epoch: 31, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 32 cost time: 0.7166955471038818
Epoch: 32, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 33 cost time: 0.6813080310821533
Epoch: 33, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.557 Vali Acc: 0.828 Test Loss: 0.557 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6689705848693848
Epoch: 34, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.552 Vali Acc: 0.861 Test Loss: 0.552 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 35 cost time: 0.6271722316741943
Epoch: 35, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7766628265380859
Epoch: 36, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.577 Vali Acc: 0.844 Test Loss: 0.577 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6093335151672363
Epoch: 37, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6991956233978271
Epoch: 38, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7225341796875
Epoch: 39, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6495752334594727
Epoch: 40, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.561 Vali Acc: 0.867 Test Loss: 0.561 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 41 cost time: 0.6097891330718994
Epoch: 41, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.548 Vali Acc: 0.856 Test Loss: 0.548 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6719918251037598
Epoch: 42, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.544 Vali Acc: 0.861 Test Loss: 0.544 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.682478666305542
Epoch: 43, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.539 Vali Acc: 0.867 Test Loss: 0.539 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 44 cost time: 0.6634581089019775
Epoch: 44, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.547 Vali Acc: 0.861 Test Loss: 0.547 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7022218704223633
Epoch: 45, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.551 Vali Acc: 0.867 Test Loss: 0.551 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7169389724731445
Epoch: 46, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.560 Vali Acc: 0.856 Test Loss: 0.560 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6663181781768799
Epoch: 47, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6908514499664307
Epoch: 48, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.581 Vali Acc: 0.867 Test Loss: 0.581 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.7505490779876709
Epoch: 49, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.582 Vali Acc: 0.861 Test Loss: 0.582 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.6954026222229004
Epoch: 50, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.566 Vali Acc: 0.856 Test Loss: 0.566 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 27439
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.154311418533325
Epoch: 1, Steps: 12 | Train Loss: 2.745 Vali Loss: 2.696 Vali Acc: 0.111 Test Loss: 2.696 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 0.6741018295288086
Epoch: 2, Steps: 12 | Train Loss: 2.628 Vali Loss: 2.589 Vali Acc: 0.156 Test Loss: 2.589 Test Acc: 0.156
Validation loss decreased (-0.111084 --> -0.155530).  Saving model ...
Epoch: 3 cost time: 0.7490444183349609
Epoch: 3, Steps: 12 | Train Loss: 2.445 Vali Loss: 2.434 Vali Acc: 0.233 Test Loss: 2.434 Test Acc: 0.233
Validation loss decreased (-0.155530 --> -0.233309).  Saving model ...
Epoch: 4 cost time: 0.6924500465393066
Epoch: 4, Steps: 12 | Train Loss: 2.302 Vali Loss: 2.249 Vali Acc: 0.383 Test Loss: 2.249 Test Acc: 0.383
Validation loss decreased (-0.233309 --> -0.383311).  Saving model ...
Epoch: 5 cost time: 0.694014310836792
Epoch: 5, Steps: 12 | Train Loss: 2.084 Vali Loss: 2.065 Vali Acc: 0.450 Test Loss: 2.065 Test Acc: 0.450
Validation loss decreased (-0.383311 --> -0.449979).  Saving model ...
Epoch: 6 cost time: 0.7269349098205566
Epoch: 6, Steps: 12 | Train Loss: 1.930 Vali Loss: 1.884 Vali Acc: 0.556 Test Loss: 1.884 Test Acc: 0.556
Validation loss decreased (-0.449979 --> -0.555537).  Saving model ...
Epoch: 7 cost time: 0.6696281433105469
Epoch: 7, Steps: 12 | Train Loss: 1.701 Vali Loss: 1.768 Vali Acc: 0.617 Test Loss: 1.768 Test Acc: 0.617
Validation loss decreased (-0.555537 --> -0.616649).  Saving model ...
Epoch: 8 cost time: 0.6708297729492188
Epoch: 8, Steps: 12 | Train Loss: 1.545 Vali Loss: 1.649 Vali Acc: 0.617 Test Loss: 1.649 Test Acc: 0.617
Validation loss decreased (-0.616649 --> -0.616650).  Saving model ...
Epoch: 9 cost time: 0.6812229156494141
Epoch: 9, Steps: 12 | Train Loss: 1.426 Vali Loss: 1.525 Vali Acc: 0.639 Test Loss: 1.525 Test Acc: 0.639
Validation loss decreased (-0.616650 --> -0.638874).  Saving model ...
Epoch: 10 cost time: 0.7479546070098877
Epoch: 10, Steps: 12 | Train Loss: 1.296 Vali Loss: 1.417 Vali Acc: 0.661 Test Loss: 1.417 Test Acc: 0.661
Validation loss decreased (-0.638874 --> -0.661097).  Saving model ...
Epoch: 11 cost time: 0.6396002769470215
Epoch: 11, Steps: 12 | Train Loss: 1.225 Vali Loss: 1.321 Vali Acc: 0.672 Test Loss: 1.321 Test Acc: 0.672
Validation loss decreased (-0.661097 --> -0.672209).  Saving model ...
Epoch: 12 cost time: 0.6917309761047363
Epoch: 12, Steps: 12 | Train Loss: 1.087 Vali Loss: 1.257 Vali Acc: 0.678 Test Loss: 1.257 Test Acc: 0.678
Validation loss decreased (-0.672209 --> -0.677765).  Saving model ...
Epoch: 13 cost time: 0.705625057220459
Epoch: 13, Steps: 12 | Train Loss: 1.016 Vali Loss: 1.199 Vali Acc: 0.689 Test Loss: 1.199 Test Acc: 0.689
Validation loss decreased (-0.677765 --> -0.688877).  Saving model ...
Epoch: 14 cost time: 0.6995625495910645
Epoch: 14, Steps: 12 | Train Loss: 0.966 Vali Loss: 1.132 Vali Acc: 0.694 Test Loss: 1.132 Test Acc: 0.694
Validation loss decreased (-0.688877 --> -0.694433).  Saving model ...
Epoch: 15 cost time: 0.6918578147888184
Epoch: 15, Steps: 12 | Train Loss: 0.892 Vali Loss: 1.083 Vali Acc: 0.700 Test Loss: 1.083 Test Acc: 0.700
Validation loss decreased (-0.694433 --> -0.699989).  Saving model ...
Epoch: 16 cost time: 0.7063729763031006
Epoch: 16, Steps: 12 | Train Loss: 0.814 Vali Loss: 1.037 Vali Acc: 0.717 Test Loss: 1.037 Test Acc: 0.717
Validation loss decreased (-0.699989 --> -0.716656).  Saving model ...
Epoch: 17 cost time: 0.7063210010528564
Epoch: 17, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.999 Vali Acc: 0.739 Test Loss: 0.999 Test Acc: 0.739
Validation loss decreased (-0.716656 --> -0.738879).  Saving model ...
Epoch: 18 cost time: 0.7167272567749023
Epoch: 18, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.952 Vali Acc: 0.739 Test Loss: 0.952 Test Acc: 0.739
Validation loss decreased (-0.738879 --> -0.738879).  Saving model ...
Epoch: 19 cost time: 0.6897287368774414
Epoch: 19, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.915 Vali Acc: 0.733 Test Loss: 0.915 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.676783561706543
Epoch: 20, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.892 Vali Acc: 0.750 Test Loss: 0.892 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749991).  Saving model ...
Epoch: 21 cost time: 0.6956937313079834
Epoch: 21, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.871 Vali Acc: 0.750 Test Loss: 0.871 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 22 cost time: 0.7415266036987305
Epoch: 22, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.830 Vali Acc: 0.767 Test Loss: 0.830 Test Acc: 0.767
Validation loss decreased (-0.749991 --> -0.766658).  Saving model ...
Epoch: 23 cost time: 0.5859465599060059
Epoch: 23, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.810 Vali Acc: 0.789 Test Loss: 0.810 Test Acc: 0.789
Validation loss decreased (-0.766658 --> -0.788881).  Saving model ...
Epoch: 24 cost time: 0.6399314403533936
Epoch: 24, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.796 Vali Acc: 0.794 Test Loss: 0.796 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794436).  Saving model ...
Epoch: 25 cost time: 0.7167537212371826
Epoch: 25, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.763 Vali Acc: 0.778 Test Loss: 0.763 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7244212627410889
Epoch: 26, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.756 Vali Acc: 0.806 Test Loss: 0.756 Test Acc: 0.806
Validation loss decreased (-0.794436 --> -0.805548).  Saving model ...
Epoch: 27 cost time: 0.767378568649292
Epoch: 27, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.723 Vali Acc: 0.811 Test Loss: 0.723 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 28 cost time: 0.6698412895202637
Epoch: 28, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.702 Vali Acc: 0.822 Test Loss: 0.702 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822215).  Saving model ...
Epoch: 29 cost time: 0.7242293357849121
Epoch: 29, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.681 Vali Acc: 0.817 Test Loss: 0.681 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.637718915939331
Epoch: 30, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.670 Vali Acc: 0.817 Test Loss: 0.670 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7089023590087891
Epoch: 31, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.655 Vali Acc: 0.839 Test Loss: 0.655 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838882).  Saving model ...
Epoch: 32 cost time: 0.7154760360717773
Epoch: 32, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.643 Vali Acc: 0.833 Test Loss: 0.643 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7280545234680176
Epoch: 33, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.636 Vali Acc: 0.822 Test Loss: 0.636 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7514991760253906
Epoch: 34, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.611 Vali Acc: 0.822 Test Loss: 0.611 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7483892440795898
Epoch: 35, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.612 Vali Acc: 0.833 Test Loss: 0.612 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7340657711029053
Epoch: 36, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.601 Vali Acc: 0.844 Test Loss: 0.601 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 37 cost time: 0.7461771965026855
Epoch: 37, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.601 Vali Acc: 0.856 Test Loss: 0.601 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855550).  Saving model ...
Epoch: 38 cost time: 0.6741242408752441
Epoch: 38, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.581 Vali Acc: 0.844 Test Loss: 0.581 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7080731391906738
Epoch: 39, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.579 Vali Acc: 0.861 Test Loss: 0.579 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 40 cost time: 0.7067911624908447
Epoch: 40, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.572 Vali Acc: 0.839 Test Loss: 0.572 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6860659122467041
Epoch: 41, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.581 Vali Acc: 0.833 Test Loss: 0.581 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6794214248657227
Epoch: 42, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6632704734802246
Epoch: 43, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.559 Vali Acc: 0.856 Test Loss: 0.559 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6912806034088135
Epoch: 44, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.548 Vali Acc: 0.861 Test Loss: 0.548 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 45 cost time: 0.7261097431182861
Epoch: 45, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7204010486602783
Epoch: 46, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.565 Vali Acc: 0.861 Test Loss: 0.565 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.693528413772583
Epoch: 47, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.563 Vali Acc: 0.856 Test Loss: 0.563 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7250704765319824
Epoch: 48, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.568 Vali Acc: 0.844 Test Loss: 0.568 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7390396595001221
Epoch: 49, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.565 Vali Acc: 0.878 Test Loss: 0.565 Test Acc: 0.878
Validation loss decreased (-0.861106 --> -0.877772).  Saving model ...
Epoch: 50 cost time: 0.712653398513794
Epoch: 50, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.567 Vali Acc: 0.867 Test Loss: 0.567 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 20751
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.6882960796356201
Epoch: 1, Steps: 12 | Train Loss: 2.804 Vali Loss: 2.753 Vali Acc: 0.072 Test Loss: 2.753 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 0.6113033294677734
Epoch: 2, Steps: 12 | Train Loss: 2.743 Vali Loss: 2.692 Vali Acc: 0.133 Test Loss: 2.692 Test Acc: 0.133
Validation loss decreased (-0.072195 --> -0.133306).  Saving model ...
Epoch: 3 cost time: 0.6325984001159668
Epoch: 3, Steps: 12 | Train Loss: 2.608 Vali Loss: 2.581 Vali Acc: 0.167 Test Loss: 2.581 Test Acc: 0.167
Validation loss decreased (-0.133306 --> -0.166641).  Saving model ...
Epoch: 4 cost time: 0.5991971492767334
Epoch: 4, Steps: 12 | Train Loss: 2.464 Vali Loss: 2.446 Vali Acc: 0.256 Test Loss: 2.446 Test Acc: 0.256
Validation loss decreased (-0.166641 --> -0.255531).  Saving model ...
Epoch: 5 cost time: 0.5901520252227783
Epoch: 5, Steps: 12 | Train Loss: 2.320 Vali Loss: 2.309 Vali Acc: 0.350 Test Loss: 2.309 Test Acc: 0.350
Validation loss decreased (-0.255531 --> -0.349977).  Saving model ...
Epoch: 6 cost time: 0.7599637508392334
Epoch: 6, Steps: 12 | Train Loss: 2.143 Vali Loss: 2.165 Vali Acc: 0.456 Test Loss: 2.165 Test Acc: 0.456
Validation loss decreased (-0.349977 --> -0.455534).  Saving model ...
Epoch: 7 cost time: 0.7198987007141113
Epoch: 7, Steps: 12 | Train Loss: 1.948 Vali Loss: 2.019 Vali Acc: 0.522 Test Loss: 2.019 Test Acc: 0.522
Validation loss decreased (-0.455534 --> -0.522202).  Saving model ...
Epoch: 8 cost time: 0.7620415687561035
Epoch: 8, Steps: 12 | Train Loss: 1.811 Vali Loss: 1.896 Vali Acc: 0.561 Test Loss: 1.896 Test Acc: 0.561
Validation loss decreased (-0.522202 --> -0.561092).  Saving model ...
Epoch: 9 cost time: 0.713794469833374
Epoch: 9, Steps: 12 | Train Loss: 1.645 Vali Loss: 1.768 Vali Acc: 0.594 Test Loss: 1.768 Test Acc: 0.594
Validation loss decreased (-0.561092 --> -0.594427).  Saving model ...
Epoch: 10 cost time: 0.7089245319366455
Epoch: 10, Steps: 12 | Train Loss: 1.604 Vali Loss: 1.657 Vali Acc: 0.628 Test Loss: 1.657 Test Acc: 0.628
Validation loss decreased (-0.594427 --> -0.627761).  Saving model ...
Epoch: 11 cost time: 0.7121684551239014
Epoch: 11, Steps: 12 | Train Loss: 1.437 Vali Loss: 1.551 Vali Acc: 0.644 Test Loss: 1.551 Test Acc: 0.644
Validation loss decreased (-0.627761 --> -0.644429).  Saving model ...
Epoch: 12 cost time: 0.7263922691345215
Epoch: 12, Steps: 12 | Train Loss: 1.319 Vali Loss: 1.472 Vali Acc: 0.650 Test Loss: 1.472 Test Acc: 0.650
Validation loss decreased (-0.644429 --> -0.649985).  Saving model ...
Epoch: 13 cost time: 0.7017824649810791
Epoch: 13, Steps: 12 | Train Loss: 1.220 Vali Loss: 1.391 Vali Acc: 0.661 Test Loss: 1.391 Test Acc: 0.661
Validation loss decreased (-0.649985 --> -0.661097).  Saving model ...
Epoch: 14 cost time: 0.6844584941864014
Epoch: 14, Steps: 12 | Train Loss: 1.146 Vali Loss: 1.303 Vali Acc: 0.683 Test Loss: 1.303 Test Acc: 0.683
Validation loss decreased (-0.661097 --> -0.683320).  Saving model ...
Epoch: 15 cost time: 0.7020518779754639
Epoch: 15, Steps: 12 | Train Loss: 1.059 Vali Loss: 1.256 Vali Acc: 0.689 Test Loss: 1.256 Test Acc: 0.689
Validation loss decreased (-0.683320 --> -0.688876).  Saving model ...
Epoch: 16 cost time: 0.6930031776428223
Epoch: 16, Steps: 12 | Train Loss: 1.004 Vali Loss: 1.199 Vali Acc: 0.706 Test Loss: 1.199 Test Acc: 0.706
Validation loss decreased (-0.688876 --> -0.705544).  Saving model ...
Epoch: 17 cost time: 0.6725804805755615
Epoch: 17, Steps: 12 | Train Loss: 0.927 Vali Loss: 1.160 Vali Acc: 0.706 Test Loss: 1.160 Test Acc: 0.706
Validation loss decreased (-0.705544 --> -0.705544).  Saving model ...
Epoch: 18 cost time: 0.7088727951049805
Epoch: 18, Steps: 12 | Train Loss: 0.865 Vali Loss: 1.120 Vali Acc: 0.717 Test Loss: 1.120 Test Acc: 0.717
Validation loss decreased (-0.705544 --> -0.716655).  Saving model ...
Epoch: 19 cost time: 0.7073731422424316
Epoch: 19, Steps: 12 | Train Loss: 0.778 Vali Loss: 1.073 Vali Acc: 0.717 Test Loss: 1.073 Test Acc: 0.717
Validation loss decreased (-0.716655 --> -0.716656).  Saving model ...
Epoch: 20 cost time: 0.6938478946685791
Epoch: 20, Steps: 12 | Train Loss: 0.757 Vali Loss: 1.033 Vali Acc: 0.711 Test Loss: 1.033 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6860036849975586
Epoch: 21, Steps: 12 | Train Loss: 0.735 Vali Loss: 0.986 Vali Acc: 0.717 Test Loss: 0.986 Test Acc: 0.717
Validation loss decreased (-0.716656 --> -0.716657).  Saving model ...
Epoch: 22 cost time: 0.6568238735198975
Epoch: 22, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.954 Vali Acc: 0.739 Test Loss: 0.954 Test Acc: 0.739
Validation loss decreased (-0.716657 --> -0.738879).  Saving model ...
Epoch: 23 cost time: 0.6411354541778564
Epoch: 23, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.921 Vali Acc: 0.756 Test Loss: 0.921 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755546).  Saving model ...
Epoch: 24 cost time: 0.6919193267822266
Epoch: 24, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.901 Vali Acc: 0.767 Test Loss: 0.901 Test Acc: 0.767
Validation loss decreased (-0.755546 --> -0.766658).  Saving model ...
Epoch: 25 cost time: 0.6106710433959961
Epoch: 25, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.869 Vali Acc: 0.761 Test Loss: 0.869 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6619307994842529
Epoch: 26, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.832 Vali Acc: 0.767 Test Loss: 0.832 Test Acc: 0.767
Validation loss decreased (-0.766658 --> -0.766658).  Saving model ...
Epoch: 27 cost time: 0.6076855659484863
Epoch: 27, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.812 Vali Acc: 0.772 Test Loss: 0.812 Test Acc: 0.772
Validation loss decreased (-0.766658 --> -0.772214).  Saving model ...
Epoch: 28 cost time: 0.6834211349487305
Epoch: 28, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.795 Vali Acc: 0.778 Test Loss: 0.795 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777770).  Saving model ...
Epoch: 29 cost time: 0.6937906742095947
Epoch: 29, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.792 Vali Acc: 0.783 Test Loss: 0.792 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783325).  Saving model ...
Epoch: 30 cost time: 0.765988826751709
Epoch: 30, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.765 Vali Acc: 0.783 Test Loss: 0.765 Test Acc: 0.783
Validation loss decreased (-0.783325 --> -0.783326).  Saving model ...
Epoch: 31 cost time: 0.7158689498901367
Epoch: 31, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.743 Vali Acc: 0.800 Test Loss: 0.743 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799993).  Saving model ...
Epoch: 32 cost time: 0.6976759433746338
Epoch: 32, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.711 Vali Acc: 0.811 Test Loss: 0.711 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 33 cost time: 0.7198073863983154
Epoch: 33, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.701 Vali Acc: 0.817 Test Loss: 0.701 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 34 cost time: 0.7252061367034912
Epoch: 34, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.700 Vali Acc: 0.811 Test Loss: 0.700 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7242436408996582
Epoch: 35, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.691 Vali Acc: 0.811 Test Loss: 0.691 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7322037220001221
Epoch: 36, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.669 Vali Acc: 0.806 Test Loss: 0.669 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7233963012695312
Epoch: 37, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.652 Vali Acc: 0.822 Test Loss: 0.652 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 38 cost time: 0.6357944011688232
Epoch: 38, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.643 Vali Acc: 0.822 Test Loss: 0.643 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 39 cost time: 0.700524091720581
Epoch: 39, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.631 Vali Acc: 0.828 Test Loss: 0.631 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827771).  Saving model ...
Epoch: 40 cost time: 0.6946477890014648
Epoch: 40, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.627 Vali Acc: 0.839 Test Loss: 0.627 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838883).  Saving model ...
Epoch: 41 cost time: 0.6677062511444092
Epoch: 41, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.627 Vali Acc: 0.817 Test Loss: 0.627 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6836671829223633
Epoch: 42, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.597 Vali Acc: 0.828 Test Loss: 0.597 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6325695514678955
Epoch: 43, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.594 Vali Acc: 0.839 Test Loss: 0.594 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 44 cost time: 0.6810386180877686
Epoch: 44, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.600 Vali Acc: 0.833 Test Loss: 0.600 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6333165168762207
Epoch: 45, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.594 Vali Acc: 0.839 Test Loss: 0.594 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.718860387802124
Epoch: 46, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.591 Vali Acc: 0.833 Test Loss: 0.591 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6246237754821777
Epoch: 47, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.569 Vali Acc: 0.844 Test Loss: 0.569 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 48 cost time: 0.684600830078125
Epoch: 48, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 49 cost time: 0.7082293033599854
Epoch: 49, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.556 Vali Acc: 0.856 Test Loss: 0.556 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7117352485656738
Epoch: 50, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.576 Vali Acc: 0.850 Test Loss: 0.576 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 16975
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0543506145477295
Epoch: 1, Steps: 12 | Train Loss: 2.755 Vali Loss: 2.726 Vali Acc: 0.072 Test Loss: 2.726 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 0.719707727432251
Epoch: 2, Steps: 12 | Train Loss: 2.717 Vali Loss: 2.669 Vali Acc: 0.100 Test Loss: 2.669 Test Acc: 0.100
Validation loss decreased (-0.072195 --> -0.099973).  Saving model ...
Epoch: 3 cost time: 0.6861100196838379
Epoch: 3, Steps: 12 | Train Loss: 2.594 Vali Loss: 2.573 Vali Acc: 0.133 Test Loss: 2.573 Test Acc: 0.133
Validation loss decreased (-0.099973 --> -0.133308).  Saving model ...
Epoch: 4 cost time: 0.6760692596435547
Epoch: 4, Steps: 12 | Train Loss: 2.505 Vali Loss: 2.470 Vali Acc: 0.211 Test Loss: 2.470 Test Acc: 0.211
Validation loss decreased (-0.133308 --> -0.211086).  Saving model ...
Epoch: 5 cost time: 0.6816365718841553
Epoch: 5, Steps: 12 | Train Loss: 2.403 Vali Loss: 2.350 Vali Acc: 0.283 Test Loss: 2.350 Test Acc: 0.283
Validation loss decreased (-0.211086 --> -0.283310).  Saving model ...
Epoch: 6 cost time: 0.6537456512451172
Epoch: 6, Steps: 12 | Train Loss: 2.240 Vali Loss: 2.230 Vali Acc: 0.350 Test Loss: 2.230 Test Acc: 0.350
Validation loss decreased (-0.283310 --> -0.349978).  Saving model ...
Epoch: 7 cost time: 0.6789329051971436
Epoch: 7, Steps: 12 | Train Loss: 2.082 Vali Loss: 2.112 Vali Acc: 0.450 Test Loss: 2.112 Test Acc: 0.450
Validation loss decreased (-0.349978 --> -0.449979).  Saving model ...
Epoch: 8 cost time: 0.693504810333252
Epoch: 8, Steps: 12 | Train Loss: 1.955 Vali Loss: 1.993 Vali Acc: 0.533 Test Loss: 1.993 Test Acc: 0.533
Validation loss decreased (-0.449979 --> -0.533313).  Saving model ...
Epoch: 9 cost time: 0.648801326751709
Epoch: 9, Steps: 12 | Train Loss: 1.830 Vali Loss: 1.881 Vali Acc: 0.617 Test Loss: 1.881 Test Acc: 0.617
Validation loss decreased (-0.533313 --> -0.616648).  Saving model ...
Epoch: 10 cost time: 0.6684212684631348
Epoch: 10, Steps: 12 | Train Loss: 1.703 Vali Loss: 1.780 Vali Acc: 0.628 Test Loss: 1.780 Test Acc: 0.628
Validation loss decreased (-0.616648 --> -0.627760).  Saving model ...
Epoch: 11 cost time: 0.6683425903320312
Epoch: 11, Steps: 12 | Train Loss: 1.577 Vali Loss: 1.665 Vali Acc: 0.650 Test Loss: 1.665 Test Acc: 0.650
Validation loss decreased (-0.627760 --> -0.649983).  Saving model ...
Epoch: 12 cost time: 0.6779897212982178
Epoch: 12, Steps: 12 | Train Loss: 1.475 Vali Loss: 1.571 Vali Acc: 0.683 Test Loss: 1.571 Test Acc: 0.683
Validation loss decreased (-0.649983 --> -0.683318).  Saving model ...
Epoch: 13 cost time: 0.6066951751708984
Epoch: 13, Steps: 12 | Train Loss: 1.363 Vali Loss: 1.493 Vali Acc: 0.700 Test Loss: 1.493 Test Acc: 0.700
Validation loss decreased (-0.683318 --> -0.699985).  Saving model ...
Epoch: 14 cost time: 0.700089693069458
Epoch: 14, Steps: 12 | Train Loss: 1.271 Vali Loss: 1.417 Vali Acc: 0.706 Test Loss: 1.417 Test Acc: 0.706
Validation loss decreased (-0.699985 --> -0.705541).  Saving model ...
Epoch: 15 cost time: 0.7740747928619385
Epoch: 15, Steps: 12 | Train Loss: 1.190 Vali Loss: 1.347 Vali Acc: 0.706 Test Loss: 1.347 Test Acc: 0.706
Validation loss decreased (-0.705541 --> -0.705542).  Saving model ...
Epoch: 16 cost time: 0.7672436237335205
Epoch: 16, Steps: 12 | Train Loss: 1.106 Vali Loss: 1.265 Vali Acc: 0.700 Test Loss: 1.265 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7424290180206299
Epoch: 17, Steps: 12 | Train Loss: 0.997 Vali Loss: 1.195 Vali Acc: 0.728 Test Loss: 1.195 Test Acc: 0.728
Validation loss decreased (-0.705542 --> -0.727766).  Saving model ...
Epoch: 18 cost time: 0.811518669128418
Epoch: 18, Steps: 12 | Train Loss: 0.918 Vali Loss: 1.138 Vali Acc: 0.739 Test Loss: 1.138 Test Acc: 0.739
Validation loss decreased (-0.727766 --> -0.738878).  Saving model ...
Epoch: 19 cost time: 0.7344164848327637
Epoch: 19, Steps: 12 | Train Loss: 0.865 Vali Loss: 1.089 Vali Acc: 0.733 Test Loss: 1.089 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7496023178100586
Epoch: 20, Steps: 12 | Train Loss: 0.787 Vali Loss: 1.044 Vali Acc: 0.739 Test Loss: 1.044 Test Acc: 0.739
Validation loss decreased (-0.738878 --> -0.738878).  Saving model ...
Epoch: 21 cost time: 0.7215931415557861
Epoch: 21, Steps: 12 | Train Loss: 0.767 Vali Loss: 1.001 Vali Acc: 0.756 Test Loss: 1.001 Test Acc: 0.756
Validation loss decreased (-0.738878 --> -0.755546).  Saving model ...
Epoch: 22 cost time: 0.7795577049255371
Epoch: 22, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.963 Vali Acc: 0.761 Test Loss: 0.963 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761101).  Saving model ...
Epoch: 23 cost time: 0.729813814163208
Epoch: 23, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.901 Vali Acc: 0.778 Test Loss: 0.901 Test Acc: 0.778
Validation loss decreased (-0.761101 --> -0.777769).  Saving model ...
Epoch: 24 cost time: 0.744384765625
Epoch: 24, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.856 Vali Acc: 0.767 Test Loss: 0.856 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7908644676208496
Epoch: 25, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.848 Vali Acc: 0.756 Test Loss: 0.848 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7424888610839844
Epoch: 26, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.798 Vali Acc: 0.761 Test Loss: 0.798 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7485790252685547
Epoch: 27, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.783 Vali Acc: 0.783 Test Loss: 0.783 Test Acc: 0.783
Validation loss decreased (-0.777769 --> -0.783326).  Saving model ...
Epoch: 28 cost time: 0.7016205787658691
Epoch: 28, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.748 Vali Acc: 0.794 Test Loss: 0.748 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794437).  Saving model ...
Epoch: 29 cost time: 0.7335257530212402
Epoch: 29, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.723 Vali Acc: 0.794 Test Loss: 0.723 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794437).  Saving model ...
Epoch: 30 cost time: 0.6959972381591797
Epoch: 30, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.698 Vali Acc: 0.811 Test Loss: 0.698 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811104).  Saving model ...
Epoch: 31 cost time: 0.6952865123748779
Epoch: 31, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.694 Vali Acc: 0.806 Test Loss: 0.694 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7357268333435059
Epoch: 32, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.665 Vali Acc: 0.817 Test Loss: 0.665 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 33 cost time: 0.7503931522369385
Epoch: 33, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.656 Vali Acc: 0.806 Test Loss: 0.656 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7694261074066162
Epoch: 34, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.634 Vali Acc: 0.822 Test Loss: 0.634 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 35 cost time: 0.7449913024902344
Epoch: 35, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.613 Vali Acc: 0.839 Test Loss: 0.613 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 36 cost time: 0.7648680210113525
Epoch: 36, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.604 Vali Acc: 0.833 Test Loss: 0.604 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7759287357330322
Epoch: 37, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.590 Vali Acc: 0.833 Test Loss: 0.590 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8158280849456787
Epoch: 38, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.593 Vali Acc: 0.828 Test Loss: 0.593 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7488982677459717
Epoch: 39, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.570 Vali Acc: 0.839 Test Loss: 0.570 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 40 cost time: 0.7751944065093994
Epoch: 40, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.571 Vali Acc: 0.844 Test Loss: 0.571 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 41 cost time: 0.7911899089813232
Epoch: 41, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.565 Vali Acc: 0.844 Test Loss: 0.565 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 42 cost time: 0.7098393440246582
Epoch: 42, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.569 Vali Acc: 0.839 Test Loss: 0.569 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8042874336242676
Epoch: 43, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.546 Vali Acc: 0.856 Test Loss: 0.546 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 44 cost time: 0.7435357570648193
Epoch: 44, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7327244281768799
Epoch: 45, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7408807277679443
Epoch: 46, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.7250576019287109
Epoch: 47, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.7453954219818115
Epoch: 48, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.549 Vali Acc: 0.844 Test Loss: 0.549 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.7405407428741455
Epoch: 49, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.7708489894866943
Epoch: 50, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps9_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 15119
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1410434246063232
Epoch: 1, Steps: 12 | Train Loss: 2.867 Vali Loss: 2.844 Vali Acc: 0.067 Test Loss: 2.844 Test Acc: 0.067
Validation loss decreased (inf --> -0.066638).  Saving model ...
Epoch: 2 cost time: 0.7140100002288818
Epoch: 2, Steps: 12 | Train Loss: 2.819 Vali Loss: 2.806 Vali Acc: 0.078 Test Loss: 2.806 Test Acc: 0.078
Validation loss decreased (-0.066638 --> -0.077750).  Saving model ...
Epoch: 3 cost time: 0.7172689437866211
Epoch: 3, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.725 Vali Acc: 0.100 Test Loss: 2.725 Test Acc: 0.100
Validation loss decreased (-0.077750 --> -0.099973).  Saving model ...
Epoch: 4 cost time: 0.6851670742034912
Epoch: 4, Steps: 12 | Train Loss: 2.628 Vali Loss: 2.616 Vali Acc: 0.161 Test Loss: 2.616 Test Acc: 0.161
Validation loss decreased (-0.099973 --> -0.161085).  Saving model ...
Epoch: 5 cost time: 0.6277761459350586
Epoch: 5, Steps: 12 | Train Loss: 2.475 Vali Loss: 2.495 Vali Acc: 0.206 Test Loss: 2.495 Test Acc: 0.206
Validation loss decreased (-0.161085 --> -0.205531).  Saving model ...
Epoch: 6 cost time: 0.6705925464630127
Epoch: 6, Steps: 12 | Train Loss: 2.343 Vali Loss: 2.374 Vali Acc: 0.239 Test Loss: 2.374 Test Acc: 0.239
Validation loss decreased (-0.205531 --> -0.238865).  Saving model ...
Epoch: 7 cost time: 0.6033341884613037
Epoch: 7, Steps: 12 | Train Loss: 2.243 Vali Loss: 2.250 Vali Acc: 0.317 Test Loss: 2.250 Test Acc: 0.317
Validation loss decreased (-0.238865 --> -0.316644).  Saving model ...
Epoch: 8 cost time: 0.6386137008666992
Epoch: 8, Steps: 12 | Train Loss: 2.130 Vali Loss: 2.125 Vali Acc: 0.378 Test Loss: 2.125 Test Acc: 0.378
Validation loss decreased (-0.316644 --> -0.377757).  Saving model ...
Epoch: 9 cost time: 0.6861317157745361
Epoch: 9, Steps: 12 | Train Loss: 1.957 Vali Loss: 2.018 Vali Acc: 0.444 Test Loss: 2.018 Test Acc: 0.444
Validation loss decreased (-0.377757 --> -0.444424).  Saving model ...
Epoch: 10 cost time: 0.7077703475952148
Epoch: 10, Steps: 12 | Train Loss: 1.874 Vali Loss: 1.917 Vali Acc: 0.544 Test Loss: 1.917 Test Acc: 0.544
Validation loss decreased (-0.444424 --> -0.544425).  Saving model ...
Epoch: 11 cost time: 0.6836118698120117
Epoch: 11, Steps: 12 | Train Loss: 1.755 Vali Loss: 1.818 Vali Acc: 0.589 Test Loss: 1.818 Test Acc: 0.589
Validation loss decreased (-0.544425 --> -0.588871).  Saving model ...
Epoch: 12 cost time: 0.6438038349151611
Epoch: 12, Steps: 12 | Train Loss: 1.612 Vali Loss: 1.711 Vali Acc: 0.628 Test Loss: 1.711 Test Acc: 0.628
Validation loss decreased (-0.588871 --> -0.627761).  Saving model ...
Epoch: 13 cost time: 0.6853992938995361
Epoch: 13, Steps: 12 | Train Loss: 1.529 Vali Loss: 1.622 Vali Acc: 0.628 Test Loss: 1.622 Test Acc: 0.628
Validation loss decreased (-0.627761 --> -0.627762).  Saving model ...
Epoch: 14 cost time: 0.6271476745605469
Epoch: 14, Steps: 12 | Train Loss: 1.431 Vali Loss: 1.548 Vali Acc: 0.639 Test Loss: 1.548 Test Acc: 0.639
Validation loss decreased (-0.627762 --> -0.638873).  Saving model ...
Epoch: 15 cost time: 0.6307783126831055
Epoch: 15, Steps: 12 | Train Loss: 1.331 Vali Loss: 1.489 Vali Acc: 0.672 Test Loss: 1.489 Test Acc: 0.672
Validation loss decreased (-0.638873 --> -0.672207).  Saving model ...
Epoch: 16 cost time: 0.6381528377532959
Epoch: 16, Steps: 12 | Train Loss: 1.231 Vali Loss: 1.428 Vali Acc: 0.683 Test Loss: 1.428 Test Acc: 0.683
Validation loss decreased (-0.672207 --> -0.683319).  Saving model ...
Epoch: 17 cost time: 0.655919075012207
Epoch: 17, Steps: 12 | Train Loss: 1.194 Vali Loss: 1.350 Vali Acc: 0.700 Test Loss: 1.350 Test Acc: 0.700
Validation loss decreased (-0.683319 --> -0.699987).  Saving model ...
Epoch: 18 cost time: 0.6616232395172119
Epoch: 18, Steps: 12 | Train Loss: 1.107 Vali Loss: 1.309 Vali Acc: 0.689 Test Loss: 1.309 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6338839530944824
Epoch: 19, Steps: 12 | Train Loss: 1.042 Vali Loss: 1.239 Vali Acc: 0.711 Test Loss: 1.239 Test Acc: 0.711
Validation loss decreased (-0.699987 --> -0.711099).  Saving model ...
Epoch: 20 cost time: 0.7169520854949951
Epoch: 20, Steps: 12 | Train Loss: 0.948 Vali Loss: 1.188 Vali Acc: 0.733 Test Loss: 1.188 Test Acc: 0.733
Validation loss decreased (-0.711099 --> -0.733321).  Saving model ...
Epoch: 21 cost time: 0.7395169734954834
Epoch: 21, Steps: 12 | Train Loss: 0.928 Vali Loss: 1.144 Vali Acc: 0.733 Test Loss: 1.144 Test Acc: 0.733
Validation loss decreased (-0.733321 --> -0.733322).  Saving model ...
Epoch: 22 cost time: 0.6841373443603516
Epoch: 22, Steps: 12 | Train Loss: 0.860 Vali Loss: 1.101 Vali Acc: 0.739 Test Loss: 1.101 Test Acc: 0.739
Validation loss decreased (-0.733322 --> -0.738878).  Saving model ...
Epoch: 23 cost time: 0.7103726863861084
Epoch: 23, Steps: 12 | Train Loss: 0.854 Vali Loss: 1.057 Vali Acc: 0.739 Test Loss: 1.057 Test Acc: 0.739
Validation loss decreased (-0.738878 --> -0.738878).  Saving model ...
Epoch: 24 cost time: 0.6591088771820068
Epoch: 24, Steps: 12 | Train Loss: 0.847 Vali Loss: 1.007 Vali Acc: 0.744 Test Loss: 1.007 Test Acc: 0.744
Validation loss decreased (-0.738878 --> -0.744434).  Saving model ...
Epoch: 25 cost time: 0.6674425601959229
Epoch: 25, Steps: 12 | Train Loss: 0.761 Vali Loss: 0.986 Vali Acc: 0.756 Test Loss: 0.986 Test Acc: 0.756
Validation loss decreased (-0.744434 --> -0.755546).  Saving model ...
Epoch: 26 cost time: 0.7467849254608154
Epoch: 26, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.951 Vali Acc: 0.761 Test Loss: 0.951 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761102).  Saving model ...
Epoch: 27 cost time: 0.7017476558685303
Epoch: 27, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.933 Vali Acc: 0.767 Test Loss: 0.933 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766657).  Saving model ...
Epoch: 28 cost time: 0.7052960395812988
Epoch: 28, Steps: 12 | Train Loss: 0.670 Vali Loss: 0.871 Vali Acc: 0.772 Test Loss: 0.871 Test Acc: 0.772
Validation loss decreased (-0.766657 --> -0.772214).  Saving model ...
Epoch: 29 cost time: 0.6982133388519287
Epoch: 29, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.841 Vali Acc: 0.789 Test Loss: 0.841 Test Acc: 0.789
Validation loss decreased (-0.772214 --> -0.788880).  Saving model ...
Epoch: 30 cost time: 0.6793670654296875
Epoch: 30, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.834 Vali Acc: 0.778 Test Loss: 0.834 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6620445251464844
Epoch: 31, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.804 Vali Acc: 0.794 Test Loss: 0.804 Test Acc: 0.794
Validation loss decreased (-0.788880 --> -0.794436).  Saving model ...
Epoch: 32 cost time: 0.6693606376647949
Epoch: 32, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.770 Vali Acc: 0.817 Test Loss: 0.770 Test Acc: 0.817
Validation loss decreased (-0.794436 --> -0.816659).  Saving model ...
Epoch: 33 cost time: 0.6737489700317383
Epoch: 33, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.751 Vali Acc: 0.800 Test Loss: 0.751 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5754830837249756
Epoch: 34, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.742 Vali Acc: 0.811 Test Loss: 0.742 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6598827838897705
Epoch: 35, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.719 Vali Acc: 0.817 Test Loss: 0.719 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816659).  Saving model ...
Epoch: 36 cost time: 0.595247745513916
Epoch: 36, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.701 Vali Acc: 0.822 Test Loss: 0.701 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822215).  Saving model ...
Epoch: 37 cost time: 0.6368834972381592
Epoch: 37, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.672 Vali Acc: 0.817 Test Loss: 0.672 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6241669654846191
Epoch: 38, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.657 Vali Acc: 0.833 Test Loss: 0.657 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 39 cost time: 0.6557483673095703
Epoch: 39, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.630 Vali Acc: 0.828 Test Loss: 0.630 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6786050796508789
Epoch: 40, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.622 Vali Acc: 0.828 Test Loss: 0.622 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6790652275085449
Epoch: 41, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.616 Vali Acc: 0.828 Test Loss: 0.616 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7512667179107666
Epoch: 42, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.594 Vali Acc: 0.839 Test Loss: 0.594 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 43 cost time: 0.7151551246643066
Epoch: 43, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.581 Vali Acc: 0.833 Test Loss: 0.581 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7024931907653809
Epoch: 44, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.572 Vali Acc: 0.844 Test Loss: 0.572 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 45 cost time: 0.7290894985198975
Epoch: 45, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.555 Vali Acc: 0.833 Test Loss: 0.555 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.72890305519104
Epoch: 46, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.545 Vali Acc: 0.833 Test Loss: 0.545 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7946517467498779
Epoch: 47, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.526 Vali Acc: 0.839 Test Loss: 0.526 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7053163051605225
Epoch: 48, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.526 Vali Acc: 0.839 Test Loss: 0.526 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7158045768737793
Epoch: 49, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.520 Vali Acc: 0.856 Test Loss: 0.520 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 50 cost time: 0.7265393733978271
Epoch: 50, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_ModernTCN_UEA_ftM_sl45_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 13295
model size : 0.07MB
