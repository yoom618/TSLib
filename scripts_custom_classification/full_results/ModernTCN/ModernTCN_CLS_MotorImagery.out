Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.180800676345825
Epoch: 1, Steps: 18 | Train Loss: 0.764 Vali Loss: 0.732 Vali Acc: 0.490 Test Loss: 0.732 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 7.714879035949707
Epoch: 2, Steps: 18 | Train Loss: 0.503 Vali Loss: 0.765 Vali Acc: 0.570 Test Loss: 0.765 Test Acc: 0.570
Validation loss decreased (-0.489993 --> -0.569992).  Saving model ...
Epoch: 3 cost time: 7.891176700592041
Epoch: 3, Steps: 18 | Train Loss: 0.288 Vali Loss: 1.242 Vali Acc: 0.470 Test Loss: 1.242 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.000442743301392
Epoch: 4, Steps: 18 | Train Loss: 0.172 Vali Loss: 1.013 Vali Acc: 0.530 Test Loss: 1.013 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.0240325927734375
Epoch: 5, Steps: 18 | Train Loss: 0.095 Vali Loss: 1.528 Vali Acc: 0.480 Test Loss: 1.528 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.839287281036377
Epoch: 6, Steps: 18 | Train Loss: 0.046 Vali Loss: 1.961 Vali Acc: 0.500 Test Loss: 1.961 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.40938925743103
Epoch: 7, Steps: 18 | Train Loss: 0.038 Vali Loss: 1.603 Vali Acc: 0.450 Test Loss: 1.603 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 10.126871824264526
Epoch: 8, Steps: 18 | Train Loss: 0.025 Vali Loss: 2.164 Vali Acc: 0.460 Test Loss: 2.164 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 10.971389293670654
Epoch: 9, Steps: 18 | Train Loss: 0.098 Vali Loss: 2.049 Vali Acc: 0.430 Test Loss: 2.049 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 11.107778072357178
Epoch: 10, Steps: 18 | Train Loss: 0.039 Vali Loss: 1.875 Vali Acc: 0.540 Test Loss: 1.875 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 10.869568347930908
Epoch: 11, Steps: 18 | Train Loss: 0.048 Vali Loss: 2.003 Vali Acc: 0.430 Test Loss: 2.003 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 10.784388065338135
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 2.328 Vali Acc: 0.450 Test Loss: 2.328 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 19160322
model size : 73.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.995860576629639
Epoch: 1, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 8.544455289840698
Epoch: 2, Steps: 18 | Train Loss: 0.572 Vali Loss: 0.850 Vali Acc: 0.500 Test Loss: 0.850 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.224216938018799
Epoch: 3, Steps: 18 | Train Loss: 0.459 Vali Loss: 0.751 Vali Acc: 0.540 Test Loss: 0.751 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 8.07640552520752
Epoch: 4, Steps: 18 | Train Loss: 0.314 Vali Loss: 0.766 Vali Acc: 0.510 Test Loss: 0.766 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.314830780029297
Epoch: 5, Steps: 18 | Train Loss: 0.209 Vali Loss: 0.992 Vali Acc: 0.560 Test Loss: 0.992 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559990).  Saving model ...
Epoch: 6 cost time: 8.273054361343384
Epoch: 6, Steps: 18 | Train Loss: 0.118 Vali Loss: 1.083 Vali Acc: 0.470 Test Loss: 1.083 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.254002571105957
Epoch: 7, Steps: 18 | Train Loss: 0.054 Vali Loss: 1.092 Vali Acc: 0.500 Test Loss: 1.092 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.214167594909668
Epoch: 8, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.233 Vali Acc: 0.500 Test Loss: 1.233 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.481664180755615
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.322 Vali Acc: 0.510 Test Loss: 1.322 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.215121269226074
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.362 Vali Acc: 0.480 Test Loss: 1.362 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.171008110046387
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.425 Vali Acc: 0.480 Test Loss: 1.425 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 8.038973808288574
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.411 Vali Acc: 0.500 Test Loss: 1.411 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.395669221878052
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.395 Vali Acc: 0.500 Test Loss: 1.395 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 8.198488712310791
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.419 Vali Acc: 0.490 Test Loss: 1.419 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 8.280731201171875
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.437 Vali Acc: 0.500 Test Loss: 1.437 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 18998882
model size : 72.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.50841498374939
Epoch: 1, Steps: 18 | Train Loss: 0.745 Vali Loss: 0.730 Vali Acc: 0.590 Test Loss: 0.730 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 7.8833982944488525
Epoch: 2, Steps: 18 | Train Loss: 0.644 Vali Loss: 0.687 Vali Acc: 0.570 Test Loss: 0.687 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.913939952850342
Epoch: 3, Steps: 18 | Train Loss: 0.521 Vali Loss: 0.735 Vali Acc: 0.520 Test Loss: 0.735 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.871496915817261
Epoch: 4, Steps: 18 | Train Loss: 0.386 Vali Loss: 0.770 Vali Acc: 0.450 Test Loss: 0.770 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.894645690917969
Epoch: 5, Steps: 18 | Train Loss: 0.246 Vali Loss: 0.752 Vali Acc: 0.560 Test Loss: 0.752 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.945518493652344
Epoch: 6, Steps: 18 | Train Loss: 0.148 Vali Loss: 0.801 Vali Acc: 0.510 Test Loss: 0.801 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.782006502151489
Epoch: 7, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.891 Vali Acc: 0.490 Test Loss: 0.891 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.927421808242798
Epoch: 8, Steps: 18 | Train Loss: 0.030 Vali Loss: 1.060 Vali Acc: 0.480 Test Loss: 1.060 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.196054935455322
Epoch: 9, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.042 Vali Acc: 0.470 Test Loss: 1.042 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 8.32424545288086
Epoch: 10, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.264 Vali Acc: 0.500 Test Loss: 1.264 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 8.254371881484985
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.156 Vali Acc: 0.470 Test Loss: 1.156 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 18952130
model size : 72.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.87390923500061
Epoch: 1, Steps: 18 | Train Loss: 0.695 Vali Loss: 0.738 Vali Acc: 0.420 Test Loss: 0.738 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 7.3919079303741455
Epoch: 2, Steps: 18 | Train Loss: 0.634 Vali Loss: 0.721 Vali Acc: 0.530 Test Loss: 0.721 Test Acc: 0.530
Validation loss decreased (-0.419993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 7.614069223403931
Epoch: 3, Steps: 18 | Train Loss: 0.502 Vali Loss: 0.787 Vali Acc: 0.540 Test Loss: 0.787 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 7.671156644821167
Epoch: 4, Steps: 18 | Train Loss: 0.433 Vali Loss: 0.782 Vali Acc: 0.470 Test Loss: 0.782 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.591860294342041
Epoch: 5, Steps: 18 | Train Loss: 0.288 Vali Loss: 0.798 Vali Acc: 0.540 Test Loss: 0.798 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.7728354930877686
Epoch: 6, Steps: 18 | Train Loss: 0.178 Vali Loss: 0.831 Vali Acc: 0.490 Test Loss: 0.831 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.099950075149536
Epoch: 7, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.979 Vali Acc: 0.520 Test Loss: 0.979 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.303464412689209
Epoch: 8, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.925 Vali Acc: 0.500 Test Loss: 0.925 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.260982990264893
Epoch: 9, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.962 Vali Acc: 0.500 Test Loss: 0.962 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.69743537902832
Epoch: 10, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.993 Vali Acc: 0.520 Test Loss: 0.993 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 7.185116767883301
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.055 Vali Acc: 0.490 Test Loss: 1.055 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.373892784118652
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.124 Vali Acc: 0.520 Test Loss: 1.124 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.463651895523071
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.133 Vali Acc: 0.520 Test Loss: 1.133 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 18921762
model size : 72.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.814616680145264
Epoch: 1, Steps: 18 | Train Loss: 0.715 Vali Loss: 0.702 Vali Acc: 0.510 Test Loss: 0.702 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 6.820002794265747
Epoch: 2, Steps: 18 | Train Loss: 0.636 Vali Loss: 0.732 Vali Acc: 0.550 Test Loss: 0.732 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 6.779339790344238
Epoch: 3, Steps: 18 | Train Loss: 0.537 Vali Loss: 0.706 Vali Acc: 0.460 Test Loss: 0.706 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.368697166442871
Epoch: 4, Steps: 18 | Train Loss: 0.436 Vali Loss: 0.781 Vali Acc: 0.480 Test Loss: 0.781 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.59486722946167
Epoch: 5, Steps: 18 | Train Loss: 0.335 Vali Loss: 0.757 Vali Acc: 0.510 Test Loss: 0.757 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.815219163894653
Epoch: 6, Steps: 18 | Train Loss: 0.235 Vali Loss: 0.790 Vali Acc: 0.520 Test Loss: 0.790 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.553332805633545
Epoch: 7, Steps: 18 | Train Loss: 0.153 Vali Loss: 0.803 Vali Acc: 0.480 Test Loss: 0.803 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.8566014766693115
Epoch: 8, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.947 Vali Acc: 0.510 Test Loss: 0.947 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.564660310745239
Epoch: 9, Steps: 18 | Train Loss: 0.040 Vali Loss: 1.182 Vali Acc: 0.510 Test Loss: 1.182 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.8731935024261475
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.100 Vali Acc: 0.540 Test Loss: 1.100 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.627920627593994
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.097 Vali Acc: 0.490 Test Loss: 1.097 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.850650310516357
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.154 Vali Acc: 0.560 Test Loss: 1.154 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559988).  Saving model ...
Epoch: 13 cost time: 6.43386697769165
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.156 Vali Acc: 0.550 Test Loss: 1.156 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.495875120162964
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.199 Vali Acc: 0.540 Test Loss: 1.199 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.653141498565674
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.185 Vali Acc: 0.550 Test Loss: 1.185 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.863089323043823
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.213 Vali Acc: 0.540 Test Loss: 1.213 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.705792427062988
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.220 Vali Acc: 0.540 Test Loss: 1.220 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.776549816131592
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.232 Vali Acc: 0.550 Test Loss: 1.232 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.576110124588013
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.274 Vali Acc: 0.510 Test Loss: 1.274 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.566353797912598
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.278 Vali Acc: 0.530 Test Loss: 1.278 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.353022813796997
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.279 Vali Acc: 0.540 Test Loss: 1.279 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.634438514709473
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.316 Vali Acc: 0.520 Test Loss: 1.316 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 18910178
model size : 72.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.688368082046509
Epoch: 1, Steps: 18 | Train Loss: 0.712 Vali Loss: 0.701 Vali Acc: 0.490 Test Loss: 0.701 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 6.718438386917114
Epoch: 2, Steps: 18 | Train Loss: 0.645 Vali Loss: 0.712 Vali Acc: 0.540 Test Loss: 0.712 Test Acc: 0.540
Validation loss decreased (-0.489993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 6.888298988342285
Epoch: 3, Steps: 18 | Train Loss: 0.555 Vali Loss: 0.728 Vali Acc: 0.490 Test Loss: 0.728 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.499444484710693
Epoch: 4, Steps: 18 | Train Loss: 0.464 Vali Loss: 0.735 Vali Acc: 0.530 Test Loss: 0.735 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.74782919883728
Epoch: 5, Steps: 18 | Train Loss: 0.402 Vali Loss: 0.761 Vali Acc: 0.570 Test Loss: 0.761 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569992).  Saving model ...
Epoch: 6 cost time: 6.625867128372192
Epoch: 6, Steps: 18 | Train Loss: 0.296 Vali Loss: 0.756 Vali Acc: 0.490 Test Loss: 0.756 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.775273561477661
Epoch: 7, Steps: 18 | Train Loss: 0.215 Vali Loss: 0.829 Vali Acc: 0.510 Test Loss: 0.829 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.771745443344116
Epoch: 8, Steps: 18 | Train Loss: 0.118 Vali Loss: 0.866 Vali Acc: 0.500 Test Loss: 0.866 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.362835645675659
Epoch: 9, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.915 Vali Acc: 0.520 Test Loss: 0.915 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.663753986358643
Epoch: 10, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.973 Vali Acc: 0.510 Test Loss: 0.973 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.372350454330444
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.025 Vali Acc: 0.540 Test Loss: 1.025 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.3756349086761475
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.098 Vali Acc: 0.480 Test Loss: 1.098 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.218985557556152
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.149 Vali Acc: 0.480 Test Loss: 1.149 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.3042380809783936
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.579917907714844
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.221 Vali Acc: 0.490 Test Loss: 1.221 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 18898594
model size : 72.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.507664203643799
Epoch: 1, Steps: 18 | Train Loss: 0.720 Vali Loss: 0.685 Vali Acc: 0.570 Test Loss: 0.685 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 5.70527458190918
Epoch: 2, Steps: 18 | Train Loss: 0.654 Vali Loss: 0.720 Vali Acc: 0.550 Test Loss: 0.720 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.892977714538574
Epoch: 3, Steps: 18 | Train Loss: 0.589 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.434864521026611
Epoch: 4, Steps: 18 | Train Loss: 0.508 Vali Loss: 0.738 Vali Acc: 0.570 Test Loss: 0.738 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.973154067993164
Epoch: 5, Steps: 18 | Train Loss: 0.443 Vali Loss: 0.726 Vali Acc: 0.530 Test Loss: 0.726 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.916188955307007
Epoch: 6, Steps: 18 | Train Loss: 0.341 Vali Loss: 0.803 Vali Acc: 0.550 Test Loss: 0.803 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.852322816848755
Epoch: 7, Steps: 18 | Train Loss: 0.260 Vali Loss: 0.819 Vali Acc: 0.520 Test Loss: 0.819 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.919998407363892
Epoch: 8, Steps: 18 | Train Loss: 0.186 Vali Loss: 0.900 Vali Acc: 0.500 Test Loss: 0.900 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.834121227264404
Epoch: 9, Steps: 18 | Train Loss: 0.128 Vali Loss: 0.953 Vali Acc: 0.560 Test Loss: 0.953 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.555408716201782
Epoch: 10, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.927 Vali Acc: 0.520 Test Loss: 0.927 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.745530366897583
Epoch: 11, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.005 Vali Acc: 0.530 Test Loss: 1.005 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 18887010
model size : 72.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.3841073513031
Epoch: 1, Steps: 18 | Train Loss: 0.758 Vali Loss: 0.748 Vali Acc: 0.550 Test Loss: 0.748 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 12.529216289520264
Epoch: 2, Steps: 18 | Train Loss: 0.549 Vali Loss: 0.755 Vali Acc: 0.540 Test Loss: 0.755 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.379303455352783
Epoch: 3, Steps: 18 | Train Loss: 0.288 Vali Loss: 0.996 Vali Acc: 0.430 Test Loss: 0.996 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.40446662902832
Epoch: 4, Steps: 18 | Train Loss: 0.125 Vali Loss: 1.007 Vali Acc: 0.450 Test Loss: 1.007 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.624382734298706
Epoch: 5, Steps: 18 | Train Loss: 0.053 Vali Loss: 1.250 Vali Acc: 0.530 Test Loss: 1.250 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 10.596590280532837
Epoch: 6, Steps: 18 | Train Loss: 0.048 Vali Loss: 1.677 Vali Acc: 0.480 Test Loss: 1.677 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.30542278289795
Epoch: 7, Steps: 18 | Train Loss: 0.041 Vali Loss: 1.846 Vali Acc: 0.440 Test Loss: 1.846 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 11.697441101074219
Epoch: 8, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.634 Vali Acc: 0.480 Test Loss: 1.634 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 11.41586422920227
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.786 Vali Acc: 0.500 Test Loss: 1.786 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 12.091517448425293
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.950 Vali Acc: 0.430 Test Loss: 1.950 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 10.135667562484741
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 2.574 Vali Acc: 0.440 Test Loss: 2.574 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 19102978
model size : 73.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.073785543441772
Epoch: 1, Steps: 18 | Train Loss: 0.720 Vali Loss: 0.792 Vali Acc: 0.480 Test Loss: 0.792 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 7.6460676193237305
Epoch: 2, Steps: 18 | Train Loss: 0.715 Vali Loss: 0.793 Vali Acc: 0.540 Test Loss: 0.793 Test Acc: 0.540
Validation loss decreased (-0.479992 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 7.637507200241089
Epoch: 3, Steps: 18 | Train Loss: 0.468 Vali Loss: 0.912 Vali Acc: 0.460 Test Loss: 0.912 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.956193923950195
Epoch: 4, Steps: 18 | Train Loss: 0.375 Vali Loss: 0.988 Vali Acc: 0.540 Test Loss: 0.988 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.33162784576416
Epoch: 5, Steps: 18 | Train Loss: 0.249 Vali Loss: 0.915 Vali Acc: 0.480 Test Loss: 0.915 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.449865818023682
Epoch: 6, Steps: 18 | Train Loss: 0.170 Vali Loss: 0.941 Vali Acc: 0.560 Test Loss: 0.941 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559991).  Saving model ...
Epoch: 7 cost time: 7.3573527336120605
Epoch: 7, Steps: 18 | Train Loss: 0.053 Vali Loss: 1.100 Vali Acc: 0.510 Test Loss: 1.100 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.2780022621154785
Epoch: 8, Steps: 18 | Train Loss: 0.089 Vali Loss: 1.071 Vali Acc: 0.530 Test Loss: 1.071 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.533446311950684
Epoch: 9, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.356 Vali Acc: 0.490 Test Loss: 1.356 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.246639251708984
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.300 Vali Acc: 0.500 Test Loss: 1.300 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.332195520401001
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.275 Vali Acc: 0.520 Test Loss: 1.275 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.124978303909302
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.320 Vali Acc: 0.540 Test Loss: 1.320 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.370020866394043
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.330 Vali Acc: 0.530 Test Loss: 1.330 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.302302598953247
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.336 Vali Acc: 0.530 Test Loss: 1.336 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.482960224151611
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.343 Vali Acc: 0.540 Test Loss: 1.343 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.204530715942383
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.383 Vali Acc: 0.520 Test Loss: 1.383 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 18941538
model size : 72.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.529163360595703
Epoch: 1, Steps: 18 | Train Loss: 0.709 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 7.125267505645752
Epoch: 2, Steps: 18 | Train Loss: 0.638 Vali Loss: 0.788 Vali Acc: 0.580 Test Loss: 0.788 Test Acc: 0.580
Validation loss decreased (-0.499993 --> -0.579992).  Saving model ...
Epoch: 3 cost time: 7.479950666427612
Epoch: 3, Steps: 18 | Train Loss: 0.467 Vali Loss: 0.837 Vali Acc: 0.520 Test Loss: 0.837 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.357351779937744
Epoch: 4, Steps: 18 | Train Loss: 0.375 Vali Loss: 0.778 Vali Acc: 0.570 Test Loss: 0.778 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.165692567825317
Epoch: 5, Steps: 18 | Train Loss: 0.283 Vali Loss: 0.799 Vali Acc: 0.520 Test Loss: 0.799 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.510373830795288
Epoch: 6, Steps: 18 | Train Loss: 0.152 Vali Loss: 0.906 Vali Acc: 0.450 Test Loss: 0.906 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.242968797683716
Epoch: 7, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.936 Vali Acc: 0.490 Test Loss: 0.936 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.138817071914673
Epoch: 8, Steps: 18 | Train Loss: 0.027 Vali Loss: 1.054 Vali Acc: 0.490 Test Loss: 1.054 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.382807970046997
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.009 Vali Acc: 0.510 Test Loss: 1.009 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.19682502746582
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.983 Vali Acc: 0.470 Test Loss: 0.983 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.203530550003052
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.071 Vali Acc: 0.450 Test Loss: 1.071 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.5437116622924805
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.154 Vali Acc: 0.490 Test Loss: 1.154 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 18894786
model size : 72.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.140617847442627
Epoch: 1, Steps: 18 | Train Loss: 0.731 Vali Loss: 0.721 Vali Acc: 0.460 Test Loss: 0.721 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 6.733435392379761
Epoch: 2, Steps: 18 | Train Loss: 0.646 Vali Loss: 0.851 Vali Acc: 0.580 Test Loss: 0.851 Test Acc: 0.580
Validation loss decreased (-0.459993 --> -0.579991).  Saving model ...
Epoch: 3 cost time: 6.62986421585083
Epoch: 3, Steps: 18 | Train Loss: 0.545 Vali Loss: 0.742 Vali Acc: 0.520 Test Loss: 0.742 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.011046886444092
Epoch: 4, Steps: 18 | Train Loss: 0.447 Vali Loss: 0.752 Vali Acc: 0.560 Test Loss: 0.752 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.95167350769043
Epoch: 5, Steps: 18 | Train Loss: 0.298 Vali Loss: 0.734 Vali Acc: 0.540 Test Loss: 0.734 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.79766583442688
Epoch: 6, Steps: 18 | Train Loss: 0.191 Vali Loss: 0.847 Vali Acc: 0.540 Test Loss: 0.847 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.825282096862793
Epoch: 7, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.908 Vali Acc: 0.500 Test Loss: 0.908 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.740816354751587
Epoch: 8, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.982 Vali Acc: 0.530 Test Loss: 0.982 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.683892488479614
Epoch: 9, Steps: 18 | Train Loss: 0.028 Vali Loss: 1.043 Vali Acc: 0.490 Test Loss: 1.043 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.027971029281616
Epoch: 10, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.017 Vali Acc: 0.540 Test Loss: 1.017 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.7875871658325195
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.124 Vali Acc: 0.510 Test Loss: 1.124 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.814580202102661
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.123 Vali Acc: 0.500 Test Loss: 1.123 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 18864418
model size : 72.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.165658950805664
Epoch: 1, Steps: 18 | Train Loss: 0.700 Vali Loss: 0.716 Vali Acc: 0.490 Test Loss: 0.716 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 6.181681394577026
Epoch: 2, Steps: 18 | Train Loss: 0.638 Vali Loss: 0.725 Vali Acc: 0.490 Test Loss: 0.725 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.925759553909302
Epoch: 3, Steps: 18 | Train Loss: 0.500 Vali Loss: 0.719 Vali Acc: 0.540 Test Loss: 0.719 Test Acc: 0.540
Validation loss decreased (-0.489993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 5.685817718505859
Epoch: 4, Steps: 18 | Train Loss: 0.465 Vali Loss: 0.695 Vali Acc: 0.540 Test Loss: 0.695 Test Acc: 0.540
Validation loss decreased (-0.539993 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 5.947905778884888
Epoch: 5, Steps: 18 | Train Loss: 0.352 Vali Loss: 0.755 Vali Acc: 0.540 Test Loss: 0.755 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.654677391052246
Epoch: 6, Steps: 18 | Train Loss: 0.246 Vali Loss: 0.791 Vali Acc: 0.530 Test Loss: 0.791 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.816015243530273
Epoch: 7, Steps: 18 | Train Loss: 0.135 Vali Loss: 0.980 Vali Acc: 0.520 Test Loss: 0.980 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.771540403366089
Epoch: 8, Steps: 18 | Train Loss: 0.111 Vali Loss: 1.035 Vali Acc: 0.530 Test Loss: 1.035 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.1550681591033936
Epoch: 9, Steps: 18 | Train Loss: 0.057 Vali Loss: 1.019 Vali Acc: 0.510 Test Loss: 1.019 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.867856502532959
Epoch: 10, Steps: 18 | Train Loss: 0.031 Vali Loss: 1.044 Vali Acc: 0.490 Test Loss: 1.044 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.93036413192749
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.056 Vali Acc: 0.500 Test Loss: 1.056 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.770178318023682
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.069 Vali Acc: 0.500 Test Loss: 1.069 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.798803806304932
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.098 Vali Acc: 0.510 Test Loss: 1.098 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.853863954544067
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.141 Vali Acc: 0.490 Test Loss: 1.141 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 18852834
model size : 72.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.898626089096069
Epoch: 1, Steps: 18 | Train Loss: 0.701 Vali Loss: 0.727 Vali Acc: 0.430 Test Loss: 0.727 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 6.002994060516357
Epoch: 2, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.716 Vali Acc: 0.580 Test Loss: 0.716 Test Acc: 0.580
Validation loss decreased (-0.429993 --> -0.579993).  Saving model ...
Epoch: 3 cost time: 6.601552963256836
Epoch: 3, Steps: 18 | Train Loss: 0.562 Vali Loss: 0.738 Vali Acc: 0.530 Test Loss: 0.738 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.356093883514404
Epoch: 4, Steps: 18 | Train Loss: 0.467 Vali Loss: 0.761 Vali Acc: 0.510 Test Loss: 0.761 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.160310745239258
Epoch: 5, Steps: 18 | Train Loss: 0.370 Vali Loss: 0.745 Vali Acc: 0.540 Test Loss: 0.745 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.342077016830444
Epoch: 6, Steps: 18 | Train Loss: 0.288 Vali Loss: 0.771 Vali Acc: 0.490 Test Loss: 0.771 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.149453163146973
Epoch: 7, Steps: 18 | Train Loss: 0.188 Vali Loss: 0.845 Vali Acc: 0.470 Test Loss: 0.845 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.36641526222229
Epoch: 8, Steps: 18 | Train Loss: 0.115 Vali Loss: 0.923 Vali Acc: 0.540 Test Loss: 0.923 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.245646715164185
Epoch: 9, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.917 Vali Acc: 0.560 Test Loss: 0.917 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.8510260581970215
Epoch: 10, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.989 Vali Acc: 0.490 Test Loss: 0.989 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.629631519317627
Epoch: 11, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.468907594680786
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.124 Vali Acc: 0.510 Test Loss: 1.124 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 18841250
model size : 72.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.091583490371704
Epoch: 1, Steps: 18 | Train Loss: 0.716 Vali Loss: 0.699 Vali Acc: 0.480 Test Loss: 0.699 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 5.975250959396362
Epoch: 2, Steps: 18 | Train Loss: 0.646 Vali Loss: 0.726 Vali Acc: 0.510 Test Loss: 0.726 Test Acc: 0.510
Validation loss decreased (-0.479993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 5.62294602394104
Epoch: 3, Steps: 18 | Train Loss: 0.576 Vali Loss: 0.701 Vali Acc: 0.530 Test Loss: 0.701 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 5.932270050048828
Epoch: 4, Steps: 18 | Train Loss: 0.512 Vali Loss: 0.717 Vali Acc: 0.470 Test Loss: 0.717 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.703742027282715
Epoch: 5, Steps: 18 | Train Loss: 0.409 Vali Loss: 0.751 Vali Acc: 0.550 Test Loss: 0.751 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 5.868922233581543
Epoch: 6, Steps: 18 | Train Loss: 0.327 Vali Loss: 0.756 Vali Acc: 0.490 Test Loss: 0.756 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.855884313583374
Epoch: 7, Steps: 18 | Train Loss: 0.234 Vali Loss: 0.776 Vali Acc: 0.510 Test Loss: 0.776 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.855551481246948
Epoch: 8, Steps: 18 | Train Loss: 0.159 Vali Loss: 0.921 Vali Acc: 0.580 Test Loss: 0.921 Test Acc: 0.580
Validation loss decreased (-0.549992 --> -0.579991).  Saving model ...
Epoch: 9 cost time: 5.9975738525390625
Epoch: 9, Steps: 18 | Train Loss: 0.099 Vali Loss: 0.937 Vali Acc: 0.520 Test Loss: 0.937 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.880794286727905
Epoch: 10, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.999 Vali Acc: 0.480 Test Loss: 0.999 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.158872842788696
Epoch: 11, Steps: 18 | Train Loss: 0.032 Vali Loss: 1.183 Vali Acc: 0.440 Test Loss: 1.183 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.832163095474243
Epoch: 12, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.058 Vali Acc: 0.520 Test Loss: 1.058 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.973060131072998
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.251 Vali Acc: 0.480 Test Loss: 1.251 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.2033772468566895
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.184 Vali Acc: 0.540 Test Loss: 1.184 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.224412679672241
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.392 Vali Acc: 0.460 Test Loss: 1.392 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.150729656219482
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.409 Vali Acc: 0.520 Test Loss: 1.409 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.105821371078491
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.432 Vali Acc: 0.520 Test Loss: 1.432 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.146033048629761
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.436 Vali Acc: 0.510 Test Loss: 1.436 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 18829666
model size : 72.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 32.90106749534607
Epoch: 1, Steps: 18 | Train Loss: 1.207 Vali Loss: 1.161 Vali Acc: 0.490 Test Loss: 1.161 Test Acc: 0.490
Validation loss decreased (inf --> -0.489988).  Saving model ...
Epoch: 2 cost time: 32.633179903030396
Epoch: 2, Steps: 18 | Train Loss: 0.988 Vali Loss: 1.620 Vali Acc: 0.390 Test Loss: 1.620 Test Acc: 0.390
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 31.115180253982544
Epoch: 3, Steps: 18 | Train Loss: 0.910 Vali Loss: 2.356 Vali Acc: 0.390 Test Loss: 2.356 Test Acc: 0.390
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 31.99617028236389
Epoch: 4, Steps: 18 | Train Loss: 0.717 Vali Loss: 1.408 Vali Acc: 0.510 Test Loss: 1.408 Test Acc: 0.510
Validation loss decreased (-0.489988 --> -0.509986).  Saving model ...
Epoch: 5 cost time: 33.47027254104614
Epoch: 5, Steps: 18 | Train Loss: 0.323 Vali Loss: 2.940 Vali Acc: 0.460 Test Loss: 2.940 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 31.847956895828247
Epoch: 6, Steps: 18 | Train Loss: 0.244 Vali Loss: 1.827 Vali Acc: 0.460 Test Loss: 1.827 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 31.790308952331543
Epoch: 7, Steps: 18 | Train Loss: 0.273 Vali Loss: 2.563 Vali Acc: 0.620 Test Loss: 2.563 Test Acc: 0.620
Validation loss decreased (-0.509986 --> -0.619974).  Saving model ...
Epoch: 8 cost time: 32.460811138153076
Epoch: 8, Steps: 18 | Train Loss: 0.343 Vali Loss: 4.796 Vali Acc: 0.460 Test Loss: 4.796 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 32.869616746902466
Epoch: 9, Steps: 18 | Train Loss: 0.162 Vali Loss: 3.770 Vali Acc: 0.500 Test Loss: 3.770 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 31.658426523208618
Epoch: 10, Steps: 18 | Train Loss: 0.272 Vali Loss: 3.787 Vali Acc: 0.530 Test Loss: 3.787 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 31.323771953582764
Epoch: 11, Steps: 18 | Train Loss: 0.199 Vali Loss: 3.446 Vali Acc: 0.520 Test Loss: 3.446 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 32.088284492492676
Epoch: 12, Steps: 18 | Train Loss: 0.263 Vali Loss: 3.686 Vali Acc: 0.540 Test Loss: 3.686 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 30.92894959449768
Epoch: 13, Steps: 18 | Train Loss: 0.236 Vali Loss: 3.442 Vali Acc: 0.510 Test Loss: 3.442 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 30.897507667541504
Epoch: 14, Steps: 18 | Train Loss: 0.136 Vali Loss: 5.658 Vali Acc: 0.540 Test Loss: 5.658 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 32.56933808326721
Epoch: 15, Steps: 18 | Train Loss: 0.367 Vali Loss: 4.747 Vali Acc: 0.440 Test Loss: 4.747 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 31.86129665374756
Epoch: 16, Steps: 18 | Train Loss: 0.145 Vali Loss: 5.465 Vali Acc: 0.420 Test Loss: 5.465 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 31.85380268096924
Epoch: 17, Steps: 18 | Train Loss: 0.239 Vali Loss: 6.815 Vali Acc: 0.410 Test Loss: 6.815 Test Acc: 0.410
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 56667138
model size : 216.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.10846781730652
Epoch: 1, Steps: 18 | Train Loss: 0.756 Vali Loss: 0.727 Vali Acc: 0.500 Test Loss: 0.727 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 19.68967890739441
Epoch: 2, Steps: 18 | Train Loss: 0.703 Vali Loss: 0.846 Vali Acc: 0.540 Test Loss: 0.846 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 19.23447299003601
Epoch: 3, Steps: 18 | Train Loss: 0.543 Vali Loss: 1.004 Vali Acc: 0.500 Test Loss: 1.004 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.694067001342773
Epoch: 4, Steps: 18 | Train Loss: 0.250 Vali Loss: 1.101 Vali Acc: 0.500 Test Loss: 1.101 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 19.40979504585266
Epoch: 5, Steps: 18 | Train Loss: 0.149 Vali Loss: 1.914 Vali Acc: 0.510 Test Loss: 1.914 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 19.557566165924072
Epoch: 6, Steps: 18 | Train Loss: 0.140 Vali Loss: 1.554 Vali Acc: 0.520 Test Loss: 1.554 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 19.27476453781128
Epoch: 7, Steps: 18 | Train Loss: 0.201 Vali Loss: 3.554 Vali Acc: 0.440 Test Loss: 3.554 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 19.798200130462646
Epoch: 8, Steps: 18 | Train Loss: 0.310 Vali Loss: 2.592 Vali Acc: 0.530 Test Loss: 2.592 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 18.889414072036743
Epoch: 9, Steps: 18 | Train Loss: 0.110 Vali Loss: 2.904 Vali Acc: 0.440 Test Loss: 2.904 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 19.742419719696045
Epoch: 10, Steps: 18 | Train Loss: 0.220 Vali Loss: 2.361 Vali Acc: 0.490 Test Loss: 2.361 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 18.656965732574463
Epoch: 11, Steps: 18 | Train Loss: 0.134 Vali Loss: 2.553 Vali Acc: 0.480 Test Loss: 2.553 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 18.470596313476562
Epoch: 12, Steps: 18 | Train Loss: 0.050 Vali Loss: 3.032 Vali Acc: 0.530 Test Loss: 3.032 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 56054146
model size : 214.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.197063446044922
Epoch: 1, Steps: 18 | Train Loss: 0.856 Vali Loss: 0.954 Vali Acc: 0.560 Test Loss: 0.954 Test Acc: 0.560
Validation loss decreased (inf --> -0.559990).  Saving model ...
Epoch: 2 cost time: 15.26468539237976
Epoch: 2, Steps: 18 | Train Loss: 0.739 Vali Loss: 0.993 Vali Acc: 0.590 Test Loss: 0.993 Test Acc: 0.590
Validation loss decreased (-0.559990 --> -0.589990).  Saving model ...
Epoch: 3 cost time: 15.937479257583618
Epoch: 3, Steps: 18 | Train Loss: 0.489 Vali Loss: 0.912 Vali Acc: 0.490 Test Loss: 0.912 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.242061376571655
Epoch: 4, Steps: 18 | Train Loss: 0.257 Vali Loss: 0.968 Vali Acc: 0.490 Test Loss: 0.968 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 16.103286743164062
Epoch: 5, Steps: 18 | Train Loss: 0.161 Vali Loss: 1.458 Vali Acc: 0.520 Test Loss: 1.458 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 16.320249795913696
Epoch: 6, Steps: 18 | Train Loss: 0.192 Vali Loss: 1.167 Vali Acc: 0.520 Test Loss: 1.167 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 16.141849756240845
Epoch: 7, Steps: 18 | Train Loss: 0.110 Vali Loss: 1.834 Vali Acc: 0.480 Test Loss: 1.834 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 14.634218215942383
Epoch: 8, Steps: 18 | Train Loss: 0.091 Vali Loss: 1.940 Vali Acc: 0.450 Test Loss: 1.940 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 16.148416757583618
Epoch: 9, Steps: 18 | Train Loss: 0.200 Vali Loss: 2.129 Vali Acc: 0.490 Test Loss: 2.129 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 16.12380361557007
Epoch: 10, Steps: 18 | Train Loss: 0.279 Vali Loss: 2.758 Vali Acc: 0.410 Test Loss: 2.758 Test Acc: 0.410
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 16.142017126083374
Epoch: 11, Steps: 18 | Train Loss: 0.147 Vali Loss: 2.220 Vali Acc: 0.480 Test Loss: 2.220 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 16.01796579360962
Epoch: 12, Steps: 18 | Train Loss: 0.215 Vali Loss: 2.496 Vali Acc: 0.530 Test Loss: 2.496 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 55834370
model size : 213.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.606606721878052
Epoch: 1, Steps: 18 | Train Loss: 0.828 Vali Loss: 1.088 Vali Acc: 0.560 Test Loss: 1.088 Test Acc: 0.560
Validation loss decreased (inf --> -0.559989).  Saving model ...
Epoch: 2 cost time: 13.62937617301941
Epoch: 2, Steps: 18 | Train Loss: 0.639 Vali Loss: 1.063 Vali Acc: 0.630 Test Loss: 1.063 Test Acc: 0.630
Validation loss decreased (-0.559989 --> -0.629989).  Saving model ...
Epoch: 3 cost time: 13.716872215270996
Epoch: 3, Steps: 18 | Train Loss: 0.490 Vali Loss: 0.808 Vali Acc: 0.490 Test Loss: 0.808 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.890551090240479
Epoch: 4, Steps: 18 | Train Loss: 0.340 Vali Loss: 0.990 Vali Acc: 0.520 Test Loss: 0.990 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.881418466567993
Epoch: 5, Steps: 18 | Train Loss: 0.192 Vali Loss: 1.295 Vali Acc: 0.500 Test Loss: 1.295 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 13.150788068771362
Epoch: 6, Steps: 18 | Train Loss: 0.139 Vali Loss: 1.180 Vali Acc: 0.530 Test Loss: 1.180 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 13.564491033554077
Epoch: 7, Steps: 18 | Train Loss: 0.098 Vali Loss: 1.920 Vali Acc: 0.480 Test Loss: 1.920 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 13.23963475227356
Epoch: 8, Steps: 18 | Train Loss: 0.135 Vali Loss: 1.341 Vali Acc: 0.550 Test Loss: 1.341 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 13.351292848587036
Epoch: 9, Steps: 18 | Train Loss: 0.164 Vali Loss: 2.220 Vali Acc: 0.540 Test Loss: 2.220 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 13.478164672851562
Epoch: 10, Steps: 18 | Train Loss: 0.133 Vali Loss: 1.920 Vali Acc: 0.560 Test Loss: 1.920 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 13.4753098487854
Epoch: 11, Steps: 18 | Train Loss: 0.056 Vali Loss: 2.104 Vali Acc: 0.560 Test Loss: 2.104 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 13.605477809906006
Epoch: 12, Steps: 18 | Train Loss: 0.158 Vali Loss: 2.359 Vali Acc: 0.510 Test Loss: 2.359 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 55745666
model size : 213.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.414571523666382
Epoch: 1, Steps: 18 | Train Loss: 0.751 Vali Loss: 0.817 Vali Acc: 0.540 Test Loss: 0.817 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 12.71307635307312
Epoch: 2, Steps: 18 | Train Loss: 0.599 Vali Loss: 0.792 Vali Acc: 0.500 Test Loss: 0.792 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.366858720779419
Epoch: 3, Steps: 18 | Train Loss: 0.476 Vali Loss: 1.090 Vali Acc: 0.650 Test Loss: 1.090 Test Acc: 0.650
Validation loss decreased (-0.539992 --> -0.649989).  Saving model ...
Epoch: 4 cost time: 9.252208709716797
Epoch: 4, Steps: 18 | Train Loss: 0.374 Vali Loss: 0.971 Vali Acc: 0.560 Test Loss: 0.971 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.813863754272461
Epoch: 5, Steps: 18 | Train Loss: 0.269 Vali Loss: 0.948 Vali Acc: 0.490 Test Loss: 0.948 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.080192804336548
Epoch: 6, Steps: 18 | Train Loss: 0.148 Vali Loss: 1.048 Vali Acc: 0.520 Test Loss: 1.048 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.051875352859497
Epoch: 7, Steps: 18 | Train Loss: 0.165 Vali Loss: 1.586 Vali Acc: 0.450 Test Loss: 1.586 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.498245239257812
Epoch: 8, Steps: 18 | Train Loss: 0.112 Vali Loss: 1.597 Vali Acc: 0.550 Test Loss: 1.597 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.878646850585938
Epoch: 9, Steps: 18 | Train Loss: 0.264 Vali Loss: 1.596 Vali Acc: 0.530 Test Loss: 1.596 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 12.73361587524414
Epoch: 10, Steps: 18 | Train Loss: 0.146 Vali Loss: 1.346 Vali Acc: 0.520 Test Loss: 1.346 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 13.114392518997192
Epoch: 11, Steps: 18 | Train Loss: 0.032 Vali Loss: 1.758 Vali Acc: 0.440 Test Loss: 1.758 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 13.117679119110107
Epoch: 12, Steps: 18 | Train Loss: 0.037 Vali Loss: 2.470 Vali Acc: 0.460 Test Loss: 2.470 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 13.017142057418823
Epoch: 13, Steps: 18 | Train Loss: 0.039 Vali Loss: 1.874 Vali Acc: 0.510 Test Loss: 1.874 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 55666562
model size : 212.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.952760219573975
Epoch: 1, Steps: 18 | Train Loss: 0.732 Vali Loss: 0.797 Vali Acc: 0.410 Test Loss: 0.797 Test Acc: 0.410
Validation loss decreased (inf --> -0.409992).  Saving model ...
Epoch: 2 cost time: 11.627573728561401
Epoch: 2, Steps: 18 | Train Loss: 0.644 Vali Loss: 0.760 Vali Acc: 0.560 Test Loss: 0.760 Test Acc: 0.560
Validation loss decreased (-0.409992 --> -0.559992).  Saving model ...
Epoch: 3 cost time: 10.014235019683838
Epoch: 3, Steps: 18 | Train Loss: 0.459 Vali Loss: 0.741 Vali Acc: 0.500 Test Loss: 0.741 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.751209020614624
Epoch: 4, Steps: 18 | Train Loss: 0.327 Vali Loss: 0.833 Vali Acc: 0.480 Test Loss: 0.833 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.233259677886963
Epoch: 5, Steps: 18 | Train Loss: 0.188 Vali Loss: 0.914 Vali Acc: 0.480 Test Loss: 0.914 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.655070304870605
Epoch: 6, Steps: 18 | Train Loss: 0.132 Vali Loss: 1.140 Vali Acc: 0.510 Test Loss: 1.140 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 12.110467672348022
Epoch: 7, Steps: 18 | Train Loss: 0.068 Vali Loss: 1.256 Vali Acc: 0.480 Test Loss: 1.256 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.682229995727539
Epoch: 8, Steps: 18 | Train Loss: 0.075 Vali Loss: 1.309 Vali Acc: 0.530 Test Loss: 1.309 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 11.834221363067627
Epoch: 9, Steps: 18 | Train Loss: 0.053 Vali Loss: 1.299 Vali Acc: 0.460 Test Loss: 1.299 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 11.847913265228271
Epoch: 10, Steps: 18 | Train Loss: 0.071 Vali Loss: 1.380 Vali Acc: 0.470 Test Loss: 1.380 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 11.483425378799438
Epoch: 11, Steps: 18 | Train Loss: 0.062 Vali Loss: 1.618 Vali Acc: 0.470 Test Loss: 1.618 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 11.75082540512085
Epoch: 12, Steps: 18 | Train Loss: 0.032 Vali Loss: 1.564 Vali Acc: 0.520 Test Loss: 1.564 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 55620226
model size : 212.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.724571704864502
Epoch: 1, Steps: 18 | Train Loss: 0.717 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 10.83384394645691
Epoch: 2, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.822 Vali Acc: 0.440 Test Loss: 0.822 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.964359283447266
Epoch: 3, Steps: 18 | Train Loss: 0.572 Vali Loss: 0.747 Vali Acc: 0.520 Test Loss: 0.747 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.090542554855347
Epoch: 4, Steps: 18 | Train Loss: 0.468 Vali Loss: 0.733 Vali Acc: 0.520 Test Loss: 0.733 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.763433694839478
Epoch: 5, Steps: 18 | Train Loss: 0.318 Vali Loss: 1.159 Vali Acc: 0.540 Test Loss: 1.159 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539988).  Saving model ...
Epoch: 6 cost time: 9.099241018295288
Epoch: 6, Steps: 18 | Train Loss: 0.200 Vali Loss: 0.936 Vali Acc: 0.510 Test Loss: 0.936 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.267986536026001
Epoch: 7, Steps: 18 | Train Loss: 0.169 Vali Loss: 0.863 Vali Acc: 0.470 Test Loss: 0.863 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.244903326034546
Epoch: 8, Steps: 18 | Train Loss: 0.084 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.820340156555176
Epoch: 9, Steps: 18 | Train Loss: 0.068 Vali Loss: 1.294 Vali Acc: 0.540 Test Loss: 1.294 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.667199850082397
Epoch: 10, Steps: 18 | Train Loss: 0.055 Vali Loss: 1.684 Vali Acc: 0.530 Test Loss: 1.684 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.823736190795898
Epoch: 11, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.298 Vali Acc: 0.530 Test Loss: 1.298 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.255164623260498
Epoch: 12, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.386 Vali Acc: 0.490 Test Loss: 1.386 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.607311964035034
Epoch: 13, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.591 Vali Acc: 0.570 Test Loss: 1.591 Test Acc: 0.570
Validation loss decreased (-0.539988 --> -0.569984).  Saving model ...
Epoch: 14 cost time: 9.440324306488037
Epoch: 14, Steps: 18 | Train Loss: 0.024 Vali Loss: 2.011 Vali Acc: 0.480 Test Loss: 2.011 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.449831485748291
Epoch: 15, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.614 Vali Acc: 0.520 Test Loss: 1.614 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.848961591720581
Epoch: 16, Steps: 18 | Train Loss: 0.061 Vali Loss: 2.630 Vali Acc: 0.460 Test Loss: 2.630 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 11.541484355926514
Epoch: 17, Steps: 18 | Train Loss: 0.152 Vali Loss: 3.067 Vali Acc: 0.460 Test Loss: 3.067 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 9.120641469955444
Epoch: 18, Steps: 18 | Train Loss: 0.134 Vali Loss: 2.437 Vali Acc: 0.540 Test Loss: 2.437 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 9.300452709197998
Epoch: 19, Steps: 18 | Train Loss: 0.203 Vali Loss: 2.502 Vali Acc: 0.580 Test Loss: 2.502 Test Acc: 0.580
Validation loss decreased (-0.569984 --> -0.579975).  Saving model ...
Epoch: 20 cost time: 9.29251766204834
Epoch: 20, Steps: 18 | Train Loss: 0.643 Vali Loss: 2.511 Vali Acc: 0.550 Test Loss: 2.511 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 9.626601934432983
Epoch: 21, Steps: 18 | Train Loss: 0.287 Vali Loss: 2.310 Vali Acc: 0.570 Test Loss: 2.310 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 9.406188726425171
Epoch: 22, Steps: 18 | Train Loss: 0.181 Vali Loss: 2.496 Vali Acc: 0.560 Test Loss: 2.496 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 10.168969869613647
Epoch: 23, Steps: 18 | Train Loss: 0.195 Vali Loss: 2.433 Vali Acc: 0.500 Test Loss: 2.433 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 11.225425004959106
Epoch: 24, Steps: 18 | Train Loss: 0.077 Vali Loss: 2.667 Vali Acc: 0.530 Test Loss: 2.667 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 9.394378185272217
Epoch: 25, Steps: 18 | Train Loss: 0.160 Vali Loss: 4.249 Vali Acc: 0.560 Test Loss: 4.249 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 9.666615009307861
Epoch: 26, Steps: 18 | Train Loss: 0.140 Vali Loss: 4.027 Vali Acc: 0.580 Test Loss: 4.027 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 9.274439334869385
Epoch: 27, Steps: 18 | Train Loss: 0.060 Vali Loss: 3.208 Vali Acc: 0.480 Test Loss: 3.208 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 9.273396968841553
Epoch: 28, Steps: 18 | Train Loss: 0.216 Vali Loss: 3.896 Vali Acc: 0.520 Test Loss: 3.896 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 9.483709573745728
Epoch: 29, Steps: 18 | Train Loss: 0.149 Vali Loss: 3.929 Vali Acc: 0.570 Test Loss: 3.929 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 55606658
model size : 212.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.426072835922241
Epoch: 1, Steps: 18 | Train Loss: 0.738 Vali Loss: 0.880 Vali Acc: 0.540 Test Loss: 0.880 Test Acc: 0.540
Validation loss decreased (inf --> -0.539991).  Saving model ...
Epoch: 2 cost time: 14.034626960754395
Epoch: 2, Steps: 18 | Train Loss: 0.521 Vali Loss: 0.833 Vali Acc: 0.610 Test Loss: 0.833 Test Acc: 0.610
Validation loss decreased (-0.539991 --> -0.609992).  Saving model ...
Epoch: 3 cost time: 13.557637691497803
Epoch: 3, Steps: 18 | Train Loss: 0.327 Vali Loss: 1.109 Vali Acc: 0.570 Test Loss: 1.109 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.810669660568237
Epoch: 4, Steps: 18 | Train Loss: 0.386 Vali Loss: 1.247 Vali Acc: 0.580 Test Loss: 1.247 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.025556325912476
Epoch: 5, Steps: 18 | Train Loss: 0.312 Vali Loss: 1.351 Vali Acc: 0.470 Test Loss: 1.351 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.911134004592896
Epoch: 6, Steps: 18 | Train Loss: 0.114 Vali Loss: 2.065 Vali Acc: 0.530 Test Loss: 2.065 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 14.675262451171875
Epoch: 7, Steps: 18 | Train Loss: 0.125 Vali Loss: 2.745 Vali Acc: 0.480 Test Loss: 2.745 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 14.708756446838379
Epoch: 8, Steps: 18 | Train Loss: 0.207 Vali Loss: 2.490 Vali Acc: 0.480 Test Loss: 2.490 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 14.870875358581543
Epoch: 9, Steps: 18 | Train Loss: 0.159 Vali Loss: 2.291 Vali Acc: 0.570 Test Loss: 2.291 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 14.914685249328613
Epoch: 10, Steps: 18 | Train Loss: 0.039 Vali Loss: 2.676 Vali Acc: 0.490 Test Loss: 2.676 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 14.61979603767395
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 2.244 Vali Acc: 0.520 Test Loss: 2.244 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 14.299767017364502
Epoch: 12, Steps: 18 | Train Loss: 0.014 Vali Loss: 3.067 Vali Acc: 0.470 Test Loss: 3.067 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 17831426
model size : 68.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.319104194641113
Epoch: 1, Steps: 18 | Train Loss: 0.746 Vali Loss: 0.740 Vali Acc: 0.450 Test Loss: 0.740 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 10.47446894645691
Epoch: 2, Steps: 18 | Train Loss: 0.591 Vali Loss: 0.812 Vali Acc: 0.470 Test Loss: 0.812 Test Acc: 0.470
Validation loss decreased (-0.449993 --> -0.469992).  Saving model ...
Epoch: 3 cost time: 11.185280323028564
Epoch: 3, Steps: 18 | Train Loss: 0.450 Vali Loss: 0.867 Vali Acc: 0.510 Test Loss: 0.867 Test Acc: 0.510
Validation loss decreased (-0.469992 --> -0.509991).  Saving model ...
Epoch: 4 cost time: 9.499460697174072
Epoch: 4, Steps: 18 | Train Loss: 0.285 Vali Loss: 1.152 Vali Acc: 0.440 Test Loss: 1.152 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.454521656036377
Epoch: 5, Steps: 18 | Train Loss: 0.154 Vali Loss: 0.978 Vali Acc: 0.590 Test Loss: 0.978 Test Acc: 0.590
Validation loss decreased (-0.509991 --> -0.589990).  Saving model ...
Epoch: 6 cost time: 8.909682273864746
Epoch: 6, Steps: 18 | Train Loss: 0.177 Vali Loss: 1.172 Vali Acc: 0.540 Test Loss: 1.172 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.022871971130371
Epoch: 7, Steps: 18 | Train Loss: 0.078 Vali Loss: 2.016 Vali Acc: 0.450 Test Loss: 2.016 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.358777046203613
Epoch: 8, Steps: 18 | Train Loss: 0.100 Vali Loss: 2.032 Vali Acc: 0.470 Test Loss: 2.032 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.709651708602905
Epoch: 9, Steps: 18 | Train Loss: 0.055 Vali Loss: 1.882 Vali Acc: 0.550 Test Loss: 1.882 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.372439861297607
Epoch: 10, Steps: 18 | Train Loss: 0.008 Vali Loss: 2.045 Vali Acc: 0.530 Test Loss: 2.045 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.053523540496826
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 2.681 Vali Acc: 0.470 Test Loss: 2.681 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.621985673904419
Epoch: 12, Steps: 18 | Train Loss: 0.021 Vali Loss: 2.130 Vali Acc: 0.550 Test Loss: 2.130 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.514566898345947
Epoch: 13, Steps: 18 | Train Loss: 0.011 Vali Loss: 3.797 Vali Acc: 0.490 Test Loss: 3.797 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.324912309646606
Epoch: 14, Steps: 18 | Train Loss: 0.061 Vali Loss: 2.396 Vali Acc: 0.510 Test Loss: 2.396 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.17244267463684
Epoch: 15, Steps: 18 | Train Loss: 0.034 Vali Loss: 1.929 Vali Acc: 0.480 Test Loss: 1.929 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 17524930
model size : 67.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.589808940887451
Epoch: 1, Steps: 18 | Train Loss: 0.729 Vali Loss: 0.737 Vali Acc: 0.460 Test Loss: 0.737 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 9.798571586608887
Epoch: 2, Steps: 18 | Train Loss: 0.657 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
Validation loss decreased (-0.459993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 9.237088918685913
Epoch: 3, Steps: 18 | Train Loss: 0.567 Vali Loss: 0.795 Vali Acc: 0.550 Test Loss: 0.795 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 9.901669025421143
Epoch: 4, Steps: 18 | Train Loss: 0.390 Vali Loss: 0.765 Vali Acc: 0.490 Test Loss: 0.765 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.941726922988892
Epoch: 5, Steps: 18 | Train Loss: 0.229 Vali Loss: 0.758 Vali Acc: 0.560 Test Loss: 0.758 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 6 cost time: 9.848278284072876
Epoch: 6, Steps: 18 | Train Loss: 0.142 Vali Loss: 1.170 Vali Acc: 0.460 Test Loss: 1.170 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.439406633377075
Epoch: 7, Steps: 18 | Train Loss: 0.067 Vali Loss: 1.167 Vali Acc: 0.480 Test Loss: 1.167 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.248106241226196
Epoch: 8, Steps: 18 | Train Loss: 0.028 Vali Loss: 1.459 Vali Acc: 0.430 Test Loss: 1.459 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.348631143569946
Epoch: 9, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.582 Vali Acc: 0.430 Test Loss: 1.582 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.68890643119812
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.587 Vali Acc: 0.450 Test Loss: 1.587 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.295130491256714
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.467 Vali Acc: 0.430 Test Loss: 1.467 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.709707975387573
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.505 Vali Acc: 0.430 Test Loss: 1.505 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.234296083450317
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.608 Vali Acc: 0.480 Test Loss: 1.608 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.573286771774292
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.595 Vali Acc: 0.450 Test Loss: 1.595 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 8.989840984344482
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.603 Vali Acc: 0.450 Test Loss: 1.603 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 17415042
model size : 66.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.077527523040771
Epoch: 1, Steps: 18 | Train Loss: 0.738 Vali Loss: 0.727 Vali Acc: 0.550 Test Loss: 0.727 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 7.36877179145813
Epoch: 2, Steps: 18 | Train Loss: 0.603 Vali Loss: 0.789 Vali Acc: 0.480 Test Loss: 0.789 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.1807146072387695
Epoch: 3, Steps: 18 | Train Loss: 0.468 Vali Loss: 0.788 Vali Acc: 0.550 Test Loss: 0.788 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.56633734703064
Epoch: 4, Steps: 18 | Train Loss: 0.365 Vali Loss: 0.829 Vali Acc: 0.570 Test Loss: 0.829 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 5 cost time: 7.428198575973511
Epoch: 5, Steps: 18 | Train Loss: 0.226 Vali Loss: 0.926 Vali Acc: 0.430 Test Loss: 0.926 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.679564952850342
Epoch: 6, Steps: 18 | Train Loss: 0.128 Vali Loss: 1.170 Vali Acc: 0.540 Test Loss: 1.170 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.61119818687439
Epoch: 7, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.992 Vali Acc: 0.490 Test Loss: 0.992 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.646844148635864
Epoch: 8, Steps: 18 | Train Loss: 0.034 Vali Loss: 1.255 Vali Acc: 0.510 Test Loss: 1.255 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.756375789642334
Epoch: 9, Steps: 18 | Train Loss: 0.039 Vali Loss: 1.742 Vali Acc: 0.470 Test Loss: 1.742 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.820357799530029
Epoch: 10, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.581 Vali Acc: 0.500 Test Loss: 1.581 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.314344644546509
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.423 Vali Acc: 0.510 Test Loss: 1.423 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.3021509647369385
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.463 Vali Acc: 0.490 Test Loss: 1.463 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.061890840530396
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.601 Vali Acc: 0.500 Test Loss: 1.601 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.507342576980591
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.567 Vali Acc: 0.510 Test Loss: 1.567 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 17370690
model size : 66.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.59247636795044
Epoch: 1, Steps: 18 | Train Loss: 0.708 Vali Loss: 0.729 Vali Acc: 0.470 Test Loss: 0.729 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 7.790744066238403
Epoch: 2, Steps: 18 | Train Loss: 0.642 Vali Loss: 0.788 Vali Acc: 0.590 Test Loss: 0.788 Test Acc: 0.590
Validation loss decreased (-0.469993 --> -0.589992).  Saving model ...
Epoch: 3 cost time: 7.613814830780029
Epoch: 3, Steps: 18 | Train Loss: 0.517 Vali Loss: 0.765 Vali Acc: 0.480 Test Loss: 0.765 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.95183801651001
Epoch: 4, Steps: 18 | Train Loss: 0.426 Vali Loss: 0.820 Vali Acc: 0.510 Test Loss: 0.820 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.304154634475708
Epoch: 5, Steps: 18 | Train Loss: 0.324 Vali Loss: 0.932 Vali Acc: 0.520 Test Loss: 0.932 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.277827739715576
Epoch: 6, Steps: 18 | Train Loss: 0.252 Vali Loss: 0.994 Vali Acc: 0.520 Test Loss: 0.994 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.2530517578125
Epoch: 7, Steps: 18 | Train Loss: 0.189 Vali Loss: 0.875 Vali Acc: 0.530 Test Loss: 0.875 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.96725058555603
Epoch: 8, Steps: 18 | Train Loss: 0.144 Vali Loss: 0.929 Vali Acc: 0.490 Test Loss: 0.929 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.06404185295105
Epoch: 9, Steps: 18 | Train Loss: 0.091 Vali Loss: 1.026 Vali Acc: 0.510 Test Loss: 1.026 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.398629903793335
Epoch: 10, Steps: 18 | Train Loss: 0.055 Vali Loss: 1.135 Vali Acc: 0.510 Test Loss: 1.135 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.668349981307983
Epoch: 11, Steps: 18 | Train Loss: 0.034 Vali Loss: 1.214 Vali Acc: 0.470 Test Loss: 1.214 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.700534343719482
Epoch: 12, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.797 Vali Acc: 0.500 Test Loss: 1.797 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 17331138
model size : 66.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.673459529876709
Epoch: 1, Steps: 18 | Train Loss: 0.752 Vali Loss: 0.739 Vali Acc: 0.590 Test Loss: 0.739 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 6.846320390701294
Epoch: 2, Steps: 18 | Train Loss: 0.645 Vali Loss: 0.718 Vali Acc: 0.470 Test Loss: 0.718 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.547183513641357
Epoch: 3, Steps: 18 | Train Loss: 0.581 Vali Loss: 0.766 Vali Acc: 0.520 Test Loss: 0.766 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.093933820724487
Epoch: 4, Steps: 18 | Train Loss: 0.456 Vali Loss: 0.774 Vali Acc: 0.520 Test Loss: 0.774 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.195603132247925
Epoch: 5, Steps: 18 | Train Loss: 0.347 Vali Loss: 0.761 Vali Acc: 0.540 Test Loss: 0.761 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.044052600860596
Epoch: 6, Steps: 18 | Train Loss: 0.258 Vali Loss: 0.818 Vali Acc: 0.540 Test Loss: 0.818 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.086344242095947
Epoch: 7, Steps: 18 | Train Loss: 0.191 Vali Loss: 0.935 Vali Acc: 0.520 Test Loss: 0.935 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.5593202114105225
Epoch: 8, Steps: 18 | Train Loss: 0.124 Vali Loss: 0.966 Vali Acc: 0.530 Test Loss: 0.966 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.678793668746948
Epoch: 9, Steps: 18 | Train Loss: 0.085 Vali Loss: 1.310 Vali Acc: 0.510 Test Loss: 1.310 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.123987197875977
Epoch: 10, Steps: 18 | Train Loss: 0.080 Vali Loss: 0.959 Vali Acc: 0.550 Test Loss: 0.959 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.760999917984009
Epoch: 11, Steps: 18 | Train Loss: 0.037 Vali Loss: 1.200 Vali Acc: 0.540 Test Loss: 1.200 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 17307970
model size : 66.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.949822425842285
Epoch: 1, Steps: 18 | Train Loss: 0.717 Vali Loss: 0.737 Vali Acc: 0.620 Test Loss: 0.737 Test Acc: 0.620
Validation loss decreased (inf --> -0.619993).  Saving model ...
Epoch: 2 cost time: 6.491178035736084
Epoch: 2, Steps: 18 | Train Loss: 0.663 Vali Loss: 0.720 Vali Acc: 0.580 Test Loss: 0.720 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.830723285675049
Epoch: 3, Steps: 18 | Train Loss: 0.603 Vali Loss: 0.708 Vali Acc: 0.520 Test Loss: 0.708 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.032998561859131
Epoch: 4, Steps: 18 | Train Loss: 0.491 Vali Loss: 0.726 Vali Acc: 0.570 Test Loss: 0.726 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.7118239402771
Epoch: 5, Steps: 18 | Train Loss: 0.374 Vali Loss: 0.726 Vali Acc: 0.520 Test Loss: 0.726 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.18786358833313
Epoch: 6, Steps: 18 | Train Loss: 0.282 Vali Loss: 0.786 Vali Acc: 0.520 Test Loss: 0.786 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.340539932250977
Epoch: 7, Steps: 18 | Train Loss: 0.221 Vali Loss: 0.804 Vali Acc: 0.570 Test Loss: 0.804 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.6907830238342285
Epoch: 8, Steps: 18 | Train Loss: 0.125 Vali Loss: 0.799 Vali Acc: 0.550 Test Loss: 0.799 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.442586660385132
Epoch: 9, Steps: 18 | Train Loss: 0.110 Vali Loss: 0.988 Vali Acc: 0.550 Test Loss: 0.988 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.914590835571289
Epoch: 10, Steps: 18 | Train Loss: 0.044 Vali Loss: 1.002 Vali Acc: 0.530 Test Loss: 1.002 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.843555688858032
Epoch: 11, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.992 Vali Acc: 0.510 Test Loss: 0.992 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 17301186
model size : 66.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.368036031723022
Epoch: 1, Steps: 18 | Train Loss: 0.778 Vali Loss: 0.759 Vali Acc: 0.550 Test Loss: 0.759 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 7.017589330673218
Epoch: 2, Steps: 18 | Train Loss: 0.592 Vali Loss: 0.755 Vali Acc: 0.570 Test Loss: 0.755 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569992).  Saving model ...
Epoch: 3 cost time: 6.794974088668823
Epoch: 3, Steps: 18 | Train Loss: 0.367 Vali Loss: 0.915 Vali Acc: 0.460 Test Loss: 0.915 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.036626577377319
Epoch: 4, Steps: 18 | Train Loss: 0.210 Vali Loss: 0.904 Vali Acc: 0.440 Test Loss: 0.904 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.270941972732544
Epoch: 5, Steps: 18 | Train Loss: 0.168 Vali Loss: 0.842 Vali Acc: 0.500 Test Loss: 0.842 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.332765340805054
Epoch: 6, Steps: 18 | Train Loss: 0.063 Vali Loss: 1.224 Vali Acc: 0.460 Test Loss: 1.224 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.057155132293701
Epoch: 7, Steps: 18 | Train Loss: 0.043 Vali Loss: 1.594 Vali Acc: 0.450 Test Loss: 1.594 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.9349281787872314
Epoch: 8, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.343 Vali Acc: 0.460 Test Loss: 1.343 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.105887651443481
Epoch: 9, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.396 Vali Acc: 0.490 Test Loss: 1.396 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.2098846435546875
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.605 Vali Acc: 0.440 Test Loss: 1.605 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.243906736373901
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.867 Vali Acc: 0.460 Test Loss: 1.867 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.91636323928833
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.795 Vali Acc: 0.510 Test Loss: 1.795 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 6290178
model size : 24.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.020884037017822
Epoch: 1, Steps: 18 | Train Loss: 0.739 Vali Loss: 0.727 Vali Acc: 0.490 Test Loss: 0.727 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 5.058429718017578
Epoch: 2, Steps: 18 | Train Loss: 0.710 Vali Loss: 0.921 Vali Acc: 0.430 Test Loss: 0.921 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.432719945907593
Epoch: 3, Steps: 18 | Train Loss: 0.597 Vali Loss: 0.842 Vali Acc: 0.550 Test Loss: 0.842 Test Acc: 0.550
Validation loss decreased (-0.489993 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 4.146200895309448
Epoch: 4, Steps: 18 | Train Loss: 0.411 Vali Loss: 0.768 Vali Acc: 0.570 Test Loss: 0.768 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569992).  Saving model ...
Epoch: 5 cost time: 4.431015729904175
Epoch: 5, Steps: 18 | Train Loss: 0.265 Vali Loss: 0.961 Vali Acc: 0.480 Test Loss: 0.961 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.391716241836548
Epoch: 6, Steps: 18 | Train Loss: 0.179 Vali Loss: 0.964 Vali Acc: 0.500 Test Loss: 0.964 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.420431137084961
Epoch: 7, Steps: 18 | Train Loss: 0.069 Vali Loss: 1.100 Vali Acc: 0.440 Test Loss: 1.100 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.378441095352173
Epoch: 8, Steps: 18 | Train Loss: 0.040 Vali Loss: 1.241 Vali Acc: 0.510 Test Loss: 1.241 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.027323007583618
Epoch: 9, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.267 Vali Acc: 0.470 Test Loss: 1.267 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.045259952545166
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.333 Vali Acc: 0.490 Test Loss: 1.333 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.294789791107178
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.358 Vali Acc: 0.490 Test Loss: 1.358 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.239252805709839
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.373 Vali Acc: 0.470 Test Loss: 1.373 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.177575588226318
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.405 Vali Acc: 0.480 Test Loss: 1.405 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.194140672683716
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.423 Vali Acc: 0.470 Test Loss: 1.423 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 6136930
model size : 23.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.690243721008301
Epoch: 1, Steps: 18 | Train Loss: 0.720 Vali Loss: 0.751 Vali Acc: 0.430 Test Loss: 0.751 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 4.27675199508667
Epoch: 2, Steps: 18 | Train Loss: 0.678 Vali Loss: 0.778 Vali Acc: 0.430 Test Loss: 0.778 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.527028799057007
Epoch: 3, Steps: 18 | Train Loss: 0.551 Vali Loss: 0.747 Vali Acc: 0.480 Test Loss: 0.747 Test Acc: 0.480
Validation loss decreased (-0.429992 --> -0.479993).  Saving model ...
Epoch: 4 cost time: 4.5916595458984375
Epoch: 4, Steps: 18 | Train Loss: 0.422 Vali Loss: 0.772 Vali Acc: 0.490 Test Loss: 0.772 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489992).  Saving model ...
Epoch: 5 cost time: 3.3474347591400146
Epoch: 5, Steps: 18 | Train Loss: 0.304 Vali Loss: 0.760 Vali Acc: 0.510 Test Loss: 0.760 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509992).  Saving model ...
Epoch: 6 cost time: 4.568166971206665
Epoch: 6, Steps: 18 | Train Loss: 0.227 Vali Loss: 0.836 Vali Acc: 0.470 Test Loss: 0.836 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.680969953536987
Epoch: 7, Steps: 18 | Train Loss: 0.151 Vali Loss: 0.891 Vali Acc: 0.430 Test Loss: 0.891 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.720847845077515
Epoch: 8, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.945 Vali Acc: 0.510 Test Loss: 0.945 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.455350637435913
Epoch: 9, Steps: 18 | Train Loss: 0.046 Vali Loss: 1.045 Vali Acc: 0.480 Test Loss: 1.045 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.690536737442017
Epoch: 10, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.139 Vali Acc: 0.490 Test Loss: 1.139 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.8954246044158936
Epoch: 11, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.106 Vali Acc: 0.490 Test Loss: 1.106 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.615249872207642
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.169 Vali Acc: 0.490 Test Loss: 1.169 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.687425136566162
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.191 Vali Acc: 0.470 Test Loss: 1.191 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.674494981765747
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.5059850215911865
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 6081986
model size : 23.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.448648691177368
Epoch: 1, Steps: 18 | Train Loss: 0.719 Vali Loss: 0.698 Vali Acc: 0.420 Test Loss: 0.698 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 4.38221001625061
Epoch: 2, Steps: 18 | Train Loss: 0.691 Vali Loss: 0.729 Vali Acc: 0.440 Test Loss: 0.729 Test Acc: 0.440
Validation loss decreased (-0.419993 --> -0.439993).  Saving model ...
Epoch: 3 cost time: 4.2880353927612305
Epoch: 3, Steps: 18 | Train Loss: 0.594 Vali Loss: 0.735 Vali Acc: 0.540 Test Loss: 0.735 Test Acc: 0.540
Validation loss decreased (-0.439993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 3.8890650272369385
Epoch: 4, Steps: 18 | Train Loss: 0.468 Vali Loss: 0.776 Vali Acc: 0.520 Test Loss: 0.776 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.176476955413818
Epoch: 5, Steps: 18 | Train Loss: 0.336 Vali Loss: 0.743 Vali Acc: 0.560 Test Loss: 0.743 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 6 cost time: 4.344322919845581
Epoch: 6, Steps: 18 | Train Loss: 0.224 Vali Loss: 0.824 Vali Acc: 0.560 Test Loss: 0.824 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.298684597015381
Epoch: 7, Steps: 18 | Train Loss: 0.162 Vali Loss: 0.799 Vali Acc: 0.510 Test Loss: 0.799 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.135287046432495
Epoch: 8, Steps: 18 | Train Loss: 0.108 Vali Loss: 1.016 Vali Acc: 0.490 Test Loss: 1.016 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.528406143188477
Epoch: 9, Steps: 18 | Train Loss: 0.072 Vali Loss: 1.001 Vali Acc: 0.510 Test Loss: 1.001 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.144506454467773
Epoch: 10, Steps: 18 | Train Loss: 0.036 Vali Loss: 1.138 Vali Acc: 0.520 Test Loss: 1.138 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.248605251312256
Epoch: 11, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.152 Vali Acc: 0.530 Test Loss: 1.152 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.2312726974487305
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.141 Vali Acc: 0.510 Test Loss: 1.141 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.347960710525513
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.174 Vali Acc: 0.510 Test Loss: 1.174 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.238372087478638
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.226 Vali Acc: 0.500 Test Loss: 1.226 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.037425994873047
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.217 Vali Acc: 0.510 Test Loss: 1.217 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 6059810
model size : 23.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.457504987716675
Epoch: 1, Steps: 18 | Train Loss: 0.706 Vali Loss: 0.728 Vali Acc: 0.430 Test Loss: 0.728 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 3.8856735229492188
Epoch: 2, Steps: 18 | Train Loss: 0.679 Vali Loss: 0.719 Vali Acc: 0.430 Test Loss: 0.719 Test Acc: 0.430
Validation loss decreased (-0.429993 --> -0.429993).  Saving model ...
Epoch: 3 cost time: 3.840816020965576
Epoch: 3, Steps: 18 | Train Loss: 0.581 Vali Loss: 0.734 Vali Acc: 0.490 Test Loss: 0.734 Test Acc: 0.490
Validation loss decreased (-0.429993 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 4.037461996078491
Epoch: 4, Steps: 18 | Train Loss: 0.524 Vali Loss: 0.740 Vali Acc: 0.490 Test Loss: 0.740 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.03747820854187
Epoch: 5, Steps: 18 | Train Loss: 0.433 Vali Loss: 0.757 Vali Acc: 0.480 Test Loss: 0.757 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.2038164138793945
Epoch: 6, Steps: 18 | Train Loss: 0.352 Vali Loss: 0.849 Vali Acc: 0.530 Test Loss: 0.849 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529992).  Saving model ...
Epoch: 7 cost time: 4.1070685386657715
Epoch: 7, Steps: 18 | Train Loss: 0.272 Vali Loss: 0.792 Vali Acc: 0.500 Test Loss: 0.792 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.329113006591797
Epoch: 8, Steps: 18 | Train Loss: 0.174 Vali Loss: 0.826 Vali Acc: 0.480 Test Loss: 0.826 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.219755172729492
Epoch: 9, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.893 Vali Acc: 0.500 Test Loss: 0.893 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.192533016204834
Epoch: 10, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.988 Vali Acc: 0.500 Test Loss: 0.988 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.163416624069214
Epoch: 11, Steps: 18 | Train Loss: 0.042 Vali Loss: 1.014 Vali Acc: 0.490 Test Loss: 1.014 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.408460378646851
Epoch: 12, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.034 Vali Acc: 0.520 Test Loss: 1.034 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.170116186141968
Epoch: 13, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.110 Vali Acc: 0.500 Test Loss: 1.110 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.152904748916626
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.116 Vali Acc: 0.480 Test Loss: 1.116 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.423558473587036
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.140 Vali Acc: 0.470 Test Loss: 1.140 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.928119659423828
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.178 Vali Acc: 0.490 Test Loss: 1.178 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 6040034
model size : 23.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.185081958770752
Epoch: 1, Steps: 18 | Train Loss: 0.724 Vali Loss: 0.691 Vali Acc: 0.520 Test Loss: 0.691 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 3.945225954055786
Epoch: 2, Steps: 18 | Train Loss: 0.712 Vali Loss: 0.718 Vali Acc: 0.600 Test Loss: 0.718 Test Acc: 0.600
Validation loss decreased (-0.519993 --> -0.599993).  Saving model ...
Epoch: 3 cost time: 4.320453643798828
Epoch: 3, Steps: 18 | Train Loss: 0.622 Vali Loss: 0.716 Vali Acc: 0.580 Test Loss: 0.716 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.277136325836182
Epoch: 4, Steps: 18 | Train Loss: 0.550 Vali Loss: 0.719 Vali Acc: 0.540 Test Loss: 0.719 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.93701434135437
Epoch: 5, Steps: 18 | Train Loss: 0.451 Vali Loss: 0.729 Vali Acc: 0.550 Test Loss: 0.729 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.991377830505371
Epoch: 6, Steps: 18 | Train Loss: 0.390 Vali Loss: 0.726 Vali Acc: 0.530 Test Loss: 0.726 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.9362504482269287
Epoch: 7, Steps: 18 | Train Loss: 0.312 Vali Loss: 0.737 Vali Acc: 0.530 Test Loss: 0.737 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.283077239990234
Epoch: 8, Steps: 18 | Train Loss: 0.231 Vali Loss: 0.813 Vali Acc: 0.520 Test Loss: 0.813 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.981105327606201
Epoch: 9, Steps: 18 | Train Loss: 0.171 Vali Loss: 0.861 Vali Acc: 0.460 Test Loss: 0.861 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.10248875617981
Epoch: 10, Steps: 18 | Train Loss: 0.112 Vali Loss: 0.840 Vali Acc: 0.450 Test Loss: 0.840 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.245851039886475
Epoch: 11, Steps: 18 | Train Loss: 0.075 Vali Loss: 0.910 Vali Acc: 0.500 Test Loss: 0.910 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.587653636932373
Epoch: 12, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.951 Vali Acc: 0.480 Test Loss: 0.951 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 6028450
model size : 23.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.73892617225647
Epoch: 1, Steps: 18 | Train Loss: 0.711 Vali Loss: 0.699 Vali Acc: 0.470 Test Loss: 0.699 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 3.2775466442108154
Epoch: 2, Steps: 18 | Train Loss: 0.681 Vali Loss: 0.761 Vali Acc: 0.530 Test Loss: 0.761 Test Acc: 0.530
Validation loss decreased (-0.469993 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 3.8604543209075928
Epoch: 3, Steps: 18 | Train Loss: 0.605 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1389358043670654
Epoch: 4, Steps: 18 | Train Loss: 0.548 Vali Loss: 0.767 Vali Acc: 0.590 Test Loss: 0.767 Test Acc: 0.590
Validation loss decreased (-0.529992 --> -0.589992).  Saving model ...
Epoch: 5 cost time: 3.142643690109253
Epoch: 5, Steps: 18 | Train Loss: 0.479 Vali Loss: 0.740 Vali Acc: 0.510 Test Loss: 0.740 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.139106273651123
Epoch: 6, Steps: 18 | Train Loss: 0.408 Vali Loss: 0.709 Vali Acc: 0.490 Test Loss: 0.709 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.3275253772735596
Epoch: 7, Steps: 18 | Train Loss: 0.324 Vali Loss: 0.833 Vali Acc: 0.520 Test Loss: 0.833 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.272016763687134
Epoch: 8, Steps: 18 | Train Loss: 0.276 Vali Loss: 0.888 Vali Acc: 0.580 Test Loss: 0.888 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.237527370452881
Epoch: 9, Steps: 18 | Train Loss: 0.219 Vali Loss: 0.784 Vali Acc: 0.470 Test Loss: 0.784 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.174469470977783
Epoch: 10, Steps: 18 | Train Loss: 0.146 Vali Loss: 0.830 Vali Acc: 0.470 Test Loss: 0.830 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.471508264541626
Epoch: 11, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.832 Vali Acc: 0.560 Test Loss: 0.832 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.204446792602539
Epoch: 12, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.870 Vali Acc: 0.500 Test Loss: 0.870 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.212554693222046
Epoch: 13, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.865 Vali Acc: 0.500 Test Loss: 0.865 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.3912296295166016
Epoch: 14, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.982 Vali Acc: 0.530 Test Loss: 0.982 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 6025058
model size : 23.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 32.788373708724976
Epoch: 1, Steps: 18 | Train Loss: 0.814 Vali Loss: 0.822 Vali Acc: 0.600 Test Loss: 0.822 Test Acc: 0.600
Validation loss decreased (inf --> -0.599992).  Saving model ...
Epoch: 2 cost time: 31.46462321281433
Epoch: 2, Steps: 18 | Train Loss: 0.720 Vali Loss: 1.329 Vali Acc: 0.430 Test Loss: 1.329 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 31.48171639442444
Epoch: 3, Steps: 18 | Train Loss: 0.455 Vali Loss: 1.791 Vali Acc: 0.450 Test Loss: 1.791 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 31.19704818725586
Epoch: 4, Steps: 18 | Train Loss: 0.267 Vali Loss: 2.043 Vali Acc: 0.480 Test Loss: 2.043 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 31.44197678565979
Epoch: 5, Steps: 18 | Train Loss: 0.338 Vali Loss: 3.340 Vali Acc: 0.500 Test Loss: 3.340 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 31.407933473587036
Epoch: 6, Steps: 18 | Train Loss: 0.446 Vali Loss: 2.528 Vali Acc: 0.550 Test Loss: 2.528 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 31.380481481552124
Epoch: 7, Steps: 18 | Train Loss: 0.184 Vali Loss: 3.648 Vali Acc: 0.510 Test Loss: 3.648 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 31.567525625228882
Epoch: 8, Steps: 18 | Train Loss: 0.158 Vali Loss: 4.452 Vali Acc: 0.420 Test Loss: 4.452 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 30.8521728515625
Epoch: 9, Steps: 18 | Train Loss: 0.061 Vali Loss: 3.163 Vali Acc: 0.530 Test Loss: 3.163 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 30.993333101272583
Epoch: 10, Steps: 18 | Train Loss: 0.314 Vali Loss: 3.669 Vali Acc: 0.490 Test Loss: 3.669 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 31.060869932174683
Epoch: 11, Steps: 18 | Train Loss: 0.202 Vali Loss: 4.079 Vali Acc: 0.520 Test Loss: 4.079 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 56568834
model size : 216.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.937357425689697
Epoch: 1, Steps: 18 | Train Loss: 0.888 Vali Loss: 0.763 Vali Acc: 0.550 Test Loss: 0.763 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 18.933698892593384
Epoch: 2, Steps: 18 | Train Loss: 0.579 Vali Loss: 0.950 Vali Acc: 0.520 Test Loss: 0.950 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.018463611602783
Epoch: 3, Steps: 18 | Train Loss: 0.502 Vali Loss: 1.068 Vali Acc: 0.530 Test Loss: 1.068 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 18.87663197517395
Epoch: 4, Steps: 18 | Train Loss: 0.237 Vali Loss: 1.310 Vali Acc: 0.500 Test Loss: 1.310 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 18.826682567596436
Epoch: 5, Steps: 18 | Train Loss: 0.190 Vali Loss: 1.442 Vali Acc: 0.490 Test Loss: 1.442 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 18.632678508758545
Epoch: 6, Steps: 18 | Train Loss: 0.357 Vali Loss: 1.923 Vali Acc: 0.440 Test Loss: 1.923 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 18.75099492073059
Epoch: 7, Steps: 18 | Train Loss: 0.231 Vali Loss: 2.139 Vali Acc: 0.480 Test Loss: 2.139 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 18.553024291992188
Epoch: 8, Steps: 18 | Train Loss: 0.108 Vali Loss: 3.460 Vali Acc: 0.440 Test Loss: 3.460 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 18.594268321990967
Epoch: 9, Steps: 18 | Train Loss: 0.220 Vali Loss: 2.558 Vali Acc: 0.470 Test Loss: 2.558 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 18.709838390350342
Epoch: 10, Steps: 18 | Train Loss: 0.079 Vali Loss: 3.203 Vali Acc: 0.460 Test Loss: 3.203 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 18.43397092819214
Epoch: 11, Steps: 18 | Train Loss: 0.084 Vali Loss: 2.916 Vali Acc: 0.530 Test Loss: 2.916 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 55955842
model size : 213.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.361587524414062
Epoch: 1, Steps: 18 | Train Loss: 0.783 Vali Loss: 1.034 Vali Acc: 0.590 Test Loss: 1.034 Test Acc: 0.590
Validation loss decreased (inf --> -0.589990).  Saving model ...
Epoch: 2 cost time: 15.282668352127075
Epoch: 2, Steps: 18 | Train Loss: 0.634 Vali Loss: 0.852 Vali Acc: 0.550 Test Loss: 0.852 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.20787286758423
Epoch: 3, Steps: 18 | Train Loss: 0.491 Vali Loss: 1.200 Vali Acc: 0.510 Test Loss: 1.200 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.772757291793823
Epoch: 4, Steps: 18 | Train Loss: 0.323 Vali Loss: 1.036 Vali Acc: 0.510 Test Loss: 1.036 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 15.535651922225952
Epoch: 5, Steps: 18 | Train Loss: 0.241 Vali Loss: 1.295 Vali Acc: 0.430 Test Loss: 1.295 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 15.7977774143219
Epoch: 6, Steps: 18 | Train Loss: 0.129 Vali Loss: 1.588 Vali Acc: 0.490 Test Loss: 1.588 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 15.929246664047241
Epoch: 7, Steps: 18 | Train Loss: 0.120 Vali Loss: 1.763 Vali Acc: 0.510 Test Loss: 1.763 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 15.626971244812012
Epoch: 8, Steps: 18 | Train Loss: 0.077 Vali Loss: 2.685 Vali Acc: 0.550 Test Loss: 2.685 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 15.53001070022583
Epoch: 9, Steps: 18 | Train Loss: 0.121 Vali Loss: 1.883 Vali Acc: 0.480 Test Loss: 1.883 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 16.171630382537842
Epoch: 10, Steps: 18 | Train Loss: 0.323 Vali Loss: 3.206 Vali Acc: 0.530 Test Loss: 3.206 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 16.363736152648926
Epoch: 11, Steps: 18 | Train Loss: 0.168 Vali Loss: 2.727 Vali Acc: 0.430 Test Loss: 2.727 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 55736066
model size : 213.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.018022775650024
Epoch: 1, Steps: 18 | Train Loss: 0.764 Vali Loss: 0.731 Vali Acc: 0.570 Test Loss: 0.731 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 14.016464233398438
Epoch: 2, Steps: 18 | Train Loss: 0.593 Vali Loss: 0.904 Vali Acc: 0.460 Test Loss: 0.904 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.164095163345337
Epoch: 3, Steps: 18 | Train Loss: 0.536 Vali Loss: 1.032 Vali Acc: 0.500 Test Loss: 1.032 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.735004425048828
Epoch: 4, Steps: 18 | Train Loss: 0.338 Vali Loss: 1.100 Vali Acc: 0.580 Test Loss: 1.100 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579989).  Saving model ...
Epoch: 5 cost time: 13.596235752105713
Epoch: 5, Steps: 18 | Train Loss: 0.197 Vali Loss: 1.013 Vali Acc: 0.500 Test Loss: 1.013 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.813469171524048
Epoch: 6, Steps: 18 | Train Loss: 0.114 Vali Loss: 1.341 Vali Acc: 0.440 Test Loss: 1.341 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 14.077773809432983
Epoch: 7, Steps: 18 | Train Loss: 0.075 Vali Loss: 1.394 Vali Acc: 0.460 Test Loss: 1.394 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.296091318130493
Epoch: 8, Steps: 18 | Train Loss: 0.073 Vali Loss: 1.516 Vali Acc: 0.510 Test Loss: 1.516 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 13.834253311157227
Epoch: 9, Steps: 18 | Train Loss: 0.039 Vali Loss: 2.551 Vali Acc: 0.470 Test Loss: 2.551 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 13.558934688568115
Epoch: 10, Steps: 18 | Train Loss: 0.117 Vali Loss: 1.861 Vali Acc: 0.450 Test Loss: 1.861 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 14.082040071487427
Epoch: 11, Steps: 18 | Train Loss: 0.116 Vali Loss: 3.942 Vali Acc: 0.480 Test Loss: 3.942 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 13.52883005142212
Epoch: 12, Steps: 18 | Train Loss: 0.414 Vali Loss: 2.512 Vali Acc: 0.460 Test Loss: 2.512 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 13.869855165481567
Epoch: 13, Steps: 18 | Train Loss: 0.162 Vali Loss: 2.971 Vali Acc: 0.470 Test Loss: 2.971 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 13.58500337600708
Epoch: 14, Steps: 18 | Train Loss: 0.126 Vali Loss: 2.682 Vali Acc: 0.490 Test Loss: 2.682 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 55647362
model size : 212.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.92301607131958
Epoch: 1, Steps: 18 | Train Loss: 0.746 Vali Loss: 0.734 Vali Acc: 0.540 Test Loss: 0.734 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 13.050941944122314
Epoch: 2, Steps: 18 | Train Loss: 0.584 Vali Loss: 0.706 Vali Acc: 0.460 Test Loss: 0.706 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.129936695098877
Epoch: 3, Steps: 18 | Train Loss: 0.560 Vali Loss: 0.876 Vali Acc: 0.520 Test Loss: 0.876 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.52087926864624
Epoch: 4, Steps: 18 | Train Loss: 0.414 Vali Loss: 0.933 Vali Acc: 0.610 Test Loss: 0.933 Test Acc: 0.610
Validation loss decreased (-0.539993 --> -0.609991).  Saving model ...
Epoch: 5 cost time: 12.328911781311035
Epoch: 5, Steps: 18 | Train Loss: 0.281 Vali Loss: 0.843 Vali Acc: 0.520 Test Loss: 0.843 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.006546020507812
Epoch: 6, Steps: 18 | Train Loss: 0.230 Vali Loss: 1.012 Vali Acc: 0.540 Test Loss: 1.012 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.370377779006958
Epoch: 7, Steps: 18 | Train Loss: 0.098 Vali Loss: 1.358 Vali Acc: 0.530 Test Loss: 1.358 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 12.626281023025513
Epoch: 8, Steps: 18 | Train Loss: 0.089 Vali Loss: 1.303 Vali Acc: 0.540 Test Loss: 1.303 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 13.671615362167358
Epoch: 9, Steps: 18 | Train Loss: 0.058 Vali Loss: 1.271 Vali Acc: 0.520 Test Loss: 1.271 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.86882209777832
Epoch: 10, Steps: 18 | Train Loss: 0.027 Vali Loss: 1.253 Vali Acc: 0.580 Test Loss: 1.253 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 13.535475015640259
Epoch: 11, Steps: 18 | Train Loss: 0.071 Vali Loss: 1.268 Vali Acc: 0.550 Test Loss: 1.268 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 13.41707444190979
Epoch: 12, Steps: 18 | Train Loss: 0.060 Vali Loss: 1.600 Vali Acc: 0.490 Test Loss: 1.600 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 13.344967126846313
Epoch: 13, Steps: 18 | Train Loss: 0.111 Vali Loss: 1.946 Vali Acc: 0.480 Test Loss: 1.946 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 13.152539253234863
Epoch: 14, Steps: 18 | Train Loss: 0.040 Vali Loss: 2.242 Vali Acc: 0.510 Test Loss: 2.242 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 55568258
model size : 212.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.637375116348267
Epoch: 1, Steps: 18 | Train Loss: 0.761 Vali Loss: 0.823 Vali Acc: 0.510 Test Loss: 0.823 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 12.025845527648926
Epoch: 2, Steps: 18 | Train Loss: 0.634 Vali Loss: 0.739 Vali Acc: 0.530 Test Loss: 0.739 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 12.332226753234863
Epoch: 3, Steps: 18 | Train Loss: 0.478 Vali Loss: 0.864 Vali Acc: 0.510 Test Loss: 0.864 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.42976975440979
Epoch: 4, Steps: 18 | Train Loss: 0.299 Vali Loss: 0.831 Vali Acc: 0.550 Test Loss: 0.831 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549992).  Saving model ...
Epoch: 5 cost time: 12.230032920837402
Epoch: 5, Steps: 18 | Train Loss: 0.259 Vali Loss: 0.930 Vali Acc: 0.480 Test Loss: 0.930 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.149940013885498
Epoch: 6, Steps: 18 | Train Loss: 0.159 Vali Loss: 0.951 Vali Acc: 0.520 Test Loss: 0.951 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.353848934173584
Epoch: 7, Steps: 18 | Train Loss: 0.090 Vali Loss: 1.305 Vali Acc: 0.460 Test Loss: 1.305 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 12.070842027664185
Epoch: 8, Steps: 18 | Train Loss: 0.079 Vali Loss: 1.176 Vali Acc: 0.510 Test Loss: 1.176 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 12.280534744262695
Epoch: 9, Steps: 18 | Train Loss: 0.038 Vali Loss: 1.194 Vali Acc: 0.560 Test Loss: 1.194 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559988).  Saving model ...
Epoch: 10 cost time: 13.04429578781128
Epoch: 10, Steps: 18 | Train Loss: 0.029 Vali Loss: 1.303 Vali Acc: 0.520 Test Loss: 1.303 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.976945638656616
Epoch: 11, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.240 Vali Acc: 0.560 Test Loss: 1.240 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 12.523961544036865
Epoch: 12, Steps: 18 | Train Loss: 0.030 Vali Loss: 1.370 Vali Acc: 0.520 Test Loss: 1.370 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 12.508569240570068
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.464 Vali Acc: 0.500 Test Loss: 1.464 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 11.986140489578247
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.368 Vali Acc: 0.510 Test Loss: 1.368 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 12.912275075912476
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.476 Vali Acc: 0.510 Test Loss: 1.476 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 12.219651460647583
Epoch: 16, Steps: 18 | Train Loss: 0.027 Vali Loss: 2.342 Vali Acc: 0.530 Test Loss: 2.342 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 11.34044599533081
Epoch: 17, Steps: 18 | Train Loss: 0.017 Vali Loss: 2.417 Vali Acc: 0.490 Test Loss: 2.417 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 13.09606122970581
Epoch: 18, Steps: 18 | Train Loss: 0.008 Vali Loss: 2.115 Vali Acc: 0.470 Test Loss: 2.115 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 12.083520412445068
Epoch: 19, Steps: 18 | Train Loss: 0.088 Vali Loss: 2.373 Vali Acc: 0.510 Test Loss: 2.373 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 55521922
model size : 212.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.742078304290771
Epoch: 1, Steps: 18 | Train Loss: 0.752 Vali Loss: 0.826 Vali Acc: 0.430 Test Loss: 0.826 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 11.225478172302246
Epoch: 2, Steps: 18 | Train Loss: 0.689 Vali Loss: 0.851 Vali Acc: 0.600 Test Loss: 0.851 Test Acc: 0.600
Validation loss decreased (-0.429992 --> -0.599991).  Saving model ...
Epoch: 3 cost time: 11.794573068618774
Epoch: 3, Steps: 18 | Train Loss: 0.536 Vali Loss: 0.895 Vali Acc: 0.530 Test Loss: 0.895 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.674406290054321
Epoch: 4, Steps: 18 | Train Loss: 0.406 Vali Loss: 0.748 Vali Acc: 0.520 Test Loss: 0.748 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.40348744392395
Epoch: 5, Steps: 18 | Train Loss: 0.314 Vali Loss: 0.785 Vali Acc: 0.520 Test Loss: 0.785 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.785644054412842
Epoch: 6, Steps: 18 | Train Loss: 0.201 Vali Loss: 1.115 Vali Acc: 0.470 Test Loss: 1.115 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 9.406590223312378
Epoch: 7, Steps: 18 | Train Loss: 0.159 Vali Loss: 1.112 Vali Acc: 0.510 Test Loss: 1.112 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 9.45997405052185
Epoch: 8, Steps: 18 | Train Loss: 0.067 Vali Loss: 1.262 Vali Acc: 0.510 Test Loss: 1.262 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 10.677814245223999
Epoch: 9, Steps: 18 | Train Loss: 0.057 Vali Loss: 1.379 Vali Acc: 0.490 Test Loss: 1.379 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 12.140698909759521
Epoch: 10, Steps: 18 | Train Loss: 0.043 Vali Loss: 1.282 Vali Acc: 0.490 Test Loss: 1.282 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 9.957861423492432
Epoch: 11, Steps: 18 | Train Loss: 0.036 Vali Loss: 1.310 Vali Acc: 0.510 Test Loss: 1.310 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 9.324811935424805
Epoch: 12, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.486 Vali Acc: 0.470 Test Loss: 1.486 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 55508354
model size : 212.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.908703088760376
Epoch: 1, Steps: 18 | Train Loss: 0.812 Vali Loss: 0.827 Vali Acc: 0.560 Test Loss: 0.827 Test Acc: 0.560
Validation loss decreased (inf --> -0.559992).  Saving model ...
Epoch: 2 cost time: 14.572781801223755
Epoch: 2, Steps: 18 | Train Loss: 0.718 Vali Loss: 1.060 Vali Acc: 0.560 Test Loss: 1.060 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.8880033493042
Epoch: 3, Steps: 18 | Train Loss: 0.523 Vali Loss: 0.968 Vali Acc: 0.550 Test Loss: 0.968 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.030102014541626
Epoch: 4, Steps: 18 | Train Loss: 0.318 Vali Loss: 1.192 Vali Acc: 0.570 Test Loss: 1.192 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569988).  Saving model ...
Epoch: 5 cost time: 14.514605522155762
Epoch: 5, Steps: 18 | Train Loss: 0.237 Vali Loss: 1.349 Vali Acc: 0.460 Test Loss: 1.349 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.98724102973938
Epoch: 6, Steps: 18 | Train Loss: 0.124 Vali Loss: 2.557 Vali Acc: 0.430 Test Loss: 2.557 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.874088764190674
Epoch: 7, Steps: 18 | Train Loss: 0.114 Vali Loss: 1.956 Vali Acc: 0.510 Test Loss: 1.956 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 14.42137598991394
Epoch: 8, Steps: 18 | Train Loss: 0.103 Vali Loss: 1.768 Vali Acc: 0.580 Test Loss: 1.768 Test Acc: 0.580
Validation loss decreased (-0.569988 --> -0.579982).  Saving model ...
Epoch: 9 cost time: 14.542913675308228
Epoch: 9, Steps: 18 | Train Loss: 0.029 Vali Loss: 1.941 Vali Acc: 0.500 Test Loss: 1.941 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 13.840971231460571
Epoch: 10, Steps: 18 | Train Loss: 0.015 Vali Loss: 2.146 Vali Acc: 0.510 Test Loss: 2.146 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 14.165743589401245
Epoch: 11, Steps: 18 | Train Loss: 0.020 Vali Loss: 2.194 Vali Acc: 0.530 Test Loss: 2.194 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 14.494925022125244
Epoch: 12, Steps: 18 | Train Loss: 0.019 Vali Loss: 2.087 Vali Acc: 0.480 Test Loss: 2.087 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 13.884082794189453
Epoch: 13, Steps: 18 | Train Loss: 0.022 Vali Loss: 2.229 Vali Acc: 0.550 Test Loss: 2.229 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 14.063362121582031
Epoch: 14, Steps: 18 | Train Loss: 0.046 Vali Loss: 2.420 Vali Acc: 0.570 Test Loss: 2.420 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 14.42637300491333
Epoch: 15, Steps: 18 | Train Loss: 0.017 Vali Loss: 3.009 Vali Acc: 0.550 Test Loss: 3.009 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 14.126376628875732
Epoch: 16, Steps: 18 | Train Loss: 0.065 Vali Loss: 2.588 Vali Acc: 0.580 Test Loss: 2.588 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 13.962428092956543
Epoch: 17, Steps: 18 | Train Loss: 0.107 Vali Loss: 4.995 Vali Acc: 0.460 Test Loss: 4.995 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 14.316792726516724
Epoch: 18, Steps: 18 | Train Loss: 0.081 Vali Loss: 2.948 Vali Acc: 0.510 Test Loss: 2.948 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 17782274
model size : 68.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.37242841720581
Epoch: 1, Steps: 18 | Train Loss: 0.725 Vali Loss: 0.879 Vali Acc: 0.600 Test Loss: 0.879 Test Acc: 0.600
Validation loss decreased (inf --> -0.599991).  Saving model ...
Epoch: 2 cost time: 9.386548280715942
Epoch: 2, Steps: 18 | Train Loss: 0.611 Vali Loss: 0.719 Vali Acc: 0.580 Test Loss: 0.719 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.221950054168701
Epoch: 3, Steps: 18 | Train Loss: 0.439 Vali Loss: 1.120 Vali Acc: 0.570 Test Loss: 1.120 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.939786195755005
Epoch: 4, Steps: 18 | Train Loss: 0.297 Vali Loss: 1.032 Vali Acc: 0.480 Test Loss: 1.032 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.653743028640747
Epoch: 5, Steps: 18 | Train Loss: 0.367 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.179801940917969
Epoch: 6, Steps: 18 | Train Loss: 0.110 Vali Loss: 1.519 Vali Acc: 0.460 Test Loss: 1.519 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.75586462020874
Epoch: 7, Steps: 18 | Train Loss: 0.073 Vali Loss: 1.557 Vali Acc: 0.490 Test Loss: 1.557 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.575688600540161
Epoch: 8, Steps: 18 | Train Loss: 0.040 Vali Loss: 1.330 Vali Acc: 0.560 Test Loss: 1.330 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 9.203205347061157
Epoch: 9, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.929 Vali Acc: 0.410 Test Loss: 1.929 Test Acc: 0.410
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 9.547718524932861
Epoch: 10, Steps: 18 | Train Loss: 0.104 Vali Loss: 1.923 Vali Acc: 0.510 Test Loss: 1.923 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 8.975120782852173
Epoch: 11, Steps: 18 | Train Loss: 0.053 Vali Loss: 2.680 Vali Acc: 0.460 Test Loss: 2.680 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 17475778
model size : 66.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.175010919570923
Epoch: 1, Steps: 18 | Train Loss: 0.754 Vali Loss: 0.813 Vali Acc: 0.440 Test Loss: 0.813 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 8.75211501121521
Epoch: 2, Steps: 18 | Train Loss: 0.722 Vali Loss: 0.867 Vali Acc: 0.470 Test Loss: 0.867 Test Acc: 0.470
Validation loss decreased (-0.439992 --> -0.469991).  Saving model ...
Epoch: 3 cost time: 8.745422124862671
Epoch: 3, Steps: 18 | Train Loss: 0.494 Vali Loss: 0.754 Vali Acc: 0.530 Test Loss: 0.754 Test Acc: 0.530
Validation loss decreased (-0.469991 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 8.93323278427124
Epoch: 4, Steps: 18 | Train Loss: 0.314 Vali Loss: 0.937 Vali Acc: 0.460 Test Loss: 0.937 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.04106330871582
Epoch: 5, Steps: 18 | Train Loss: 0.252 Vali Loss: 0.897 Vali Acc: 0.500 Test Loss: 0.897 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.933415174484253
Epoch: 6, Steps: 18 | Train Loss: 0.150 Vali Loss: 1.263 Vali Acc: 0.500 Test Loss: 1.263 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.138208150863647
Epoch: 7, Steps: 18 | Train Loss: 0.087 Vali Loss: 1.131 Vali Acc: 0.510 Test Loss: 1.131 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.868170499801636
Epoch: 8, Steps: 18 | Train Loss: 0.054 Vali Loss: 1.279 Vali Acc: 0.520 Test Loss: 1.279 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.742326498031616
Epoch: 9, Steps: 18 | Train Loss: 0.044 Vali Loss: 1.518 Vali Acc: 0.470 Test Loss: 1.518 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.85970664024353
Epoch: 10, Steps: 18 | Train Loss: 0.024 Vali Loss: 1.736 Vali Acc: 0.540 Test Loss: 1.736 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539983).  Saving model ...
Epoch: 11 cost time: 8.57779312133789
Epoch: 11, Steps: 18 | Train Loss: 0.028 Vali Loss: 1.778 Vali Acc: 0.460 Test Loss: 1.778 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.92957067489624
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.733 Vali Acc: 0.480 Test Loss: 1.733 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.696325302124023
Epoch: 13, Steps: 18 | Train Loss: 0.031 Vali Loss: 1.819 Vali Acc: 0.460 Test Loss: 1.819 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.916001796722412
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.748 Vali Acc: 0.460 Test Loss: 1.748 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 8.832873106002808
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.878 Vali Acc: 0.480 Test Loss: 1.878 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 8.949146032333374
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.022 Vali Acc: 0.470 Test Loss: 2.022 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 8.6839439868927
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.026 Vali Acc: 0.470 Test Loss: 2.026 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 9.0935959815979
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.028 Vali Acc: 0.470 Test Loss: 2.028 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 8.70267629623413
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.046 Vali Acc: 0.470 Test Loss: 2.046 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 8.53783392906189
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.056 Vali Acc: 0.460 Test Loss: 2.056 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 17365890
model size : 66.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.362318515777588
Epoch: 1, Steps: 18 | Train Loss: 0.745 Vali Loss: 0.718 Vali Acc: 0.620 Test Loss: 0.718 Test Acc: 0.620
Validation loss decreased (inf --> -0.619993).  Saving model ...
Epoch: 2 cost time: 7.410700082778931
Epoch: 2, Steps: 18 | Train Loss: 0.666 Vali Loss: 0.739 Vali Acc: 0.460 Test Loss: 0.739 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.355426788330078
Epoch: 3, Steps: 18 | Train Loss: 0.500 Vali Loss: 0.796 Vali Acc: 0.510 Test Loss: 0.796 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.147907257080078
Epoch: 4, Steps: 18 | Train Loss: 0.348 Vali Loss: 0.850 Vali Acc: 0.600 Test Loss: 0.850 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.2165210247039795
Epoch: 5, Steps: 18 | Train Loss: 0.244 Vali Loss: 0.746 Vali Acc: 0.510 Test Loss: 0.746 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.243752717971802
Epoch: 6, Steps: 18 | Train Loss: 0.154 Vali Loss: 0.894 Vali Acc: 0.480 Test Loss: 0.894 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.497462749481201
Epoch: 7, Steps: 18 | Train Loss: 0.069 Vali Loss: 1.253 Vali Acc: 0.540 Test Loss: 1.253 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.3342907428741455
Epoch: 8, Steps: 18 | Train Loss: 0.050 Vali Loss: 1.294 Vali Acc: 0.490 Test Loss: 1.294 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.221456289291382
Epoch: 9, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.232 Vali Acc: 0.520 Test Loss: 1.232 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.575814962387085
Epoch: 10, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.331 Vali Acc: 0.540 Test Loss: 1.331 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.33227801322937
Epoch: 11, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.293 Vali Acc: 0.480 Test Loss: 1.293 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 17321538
model size : 66.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.95207142829895
Epoch: 1, Steps: 18 | Train Loss: 0.714 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 7.672517538070679
Epoch: 2, Steps: 18 | Train Loss: 0.646 Vali Loss: 0.784 Vali Acc: 0.560 Test Loss: 0.784 Test Acc: 0.560
Validation loss decreased (-0.499993 --> -0.559992).  Saving model ...
Epoch: 3 cost time: 6.95267391204834
Epoch: 3, Steps: 18 | Train Loss: 0.488 Vali Loss: 0.732 Vali Acc: 0.550 Test Loss: 0.732 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.343243837356567
Epoch: 4, Steps: 18 | Train Loss: 0.396 Vali Loss: 0.734 Vali Acc: 0.490 Test Loss: 0.734 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.913064956665039
Epoch: 5, Steps: 18 | Train Loss: 0.266 Vali Loss: 0.794 Vali Acc: 0.530 Test Loss: 0.794 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.949317216873169
Epoch: 6, Steps: 18 | Train Loss: 0.185 Vali Loss: 0.950 Vali Acc: 0.480 Test Loss: 0.950 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.0077965259552
Epoch: 7, Steps: 18 | Train Loss: 0.110 Vali Loss: 0.979 Vali Acc: 0.460 Test Loss: 0.979 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.7232325077056885
Epoch: 8, Steps: 18 | Train Loss: 0.053 Vali Loss: 1.058 Vali Acc: 0.430 Test Loss: 1.058 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.2235002517700195
Epoch: 9, Steps: 18 | Train Loss: 0.038 Vali Loss: 1.159 Vali Acc: 0.500 Test Loss: 1.159 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.700372695922852
Epoch: 10, Steps: 18 | Train Loss: 0.062 Vali Loss: 1.248 Vali Acc: 0.480 Test Loss: 1.248 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.308285236358643
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.446 Vali Acc: 0.480 Test Loss: 1.446 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.203114748001099
Epoch: 12, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.464 Vali Acc: 0.520 Test Loss: 1.464 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 17281986
model size : 66.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.6596739292144775
Epoch: 1, Steps: 18 | Train Loss: 0.732 Vali Loss: 0.708 Vali Acc: 0.420 Test Loss: 0.708 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 6.65220308303833
Epoch: 2, Steps: 18 | Train Loss: 0.647 Vali Loss: 0.784 Vali Acc: 0.530 Test Loss: 0.784 Test Acc: 0.530
Validation loss decreased (-0.419993 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 6.4118828773498535
Epoch: 3, Steps: 18 | Train Loss: 0.575 Vali Loss: 0.813 Vali Acc: 0.540 Test Loss: 0.813 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 6.3622071743011475
Epoch: 4, Steps: 18 | Train Loss: 0.531 Vali Loss: 0.826 Vali Acc: 0.590 Test Loss: 0.826 Test Acc: 0.590
Validation loss decreased (-0.539992 --> -0.589992).  Saving model ...
Epoch: 5 cost time: 6.677804470062256
Epoch: 5, Steps: 18 | Train Loss: 0.389 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.473487138748169
Epoch: 6, Steps: 18 | Train Loss: 0.290 Vali Loss: 0.812 Vali Acc: 0.520 Test Loss: 0.812 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.499350070953369
Epoch: 7, Steps: 18 | Train Loss: 0.197 Vali Loss: 0.823 Vali Acc: 0.560 Test Loss: 0.823 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.502500772476196
Epoch: 8, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.893 Vali Acc: 0.520 Test Loss: 0.893 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.679696083068848
Epoch: 9, Steps: 18 | Train Loss: 0.065 Vali Loss: 1.047 Vali Acc: 0.520 Test Loss: 1.047 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.799511909484863
Epoch: 10, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.986 Vali Acc: 0.490 Test Loss: 0.986 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.337503671646118
Epoch: 11, Steps: 18 | Train Loss: 0.027 Vali Loss: 1.234 Vali Acc: 0.510 Test Loss: 1.234 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.1883580684661865
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.344 Vali Acc: 0.480 Test Loss: 1.344 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.7465996742248535
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.306 Vali Acc: 0.490 Test Loss: 1.306 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.490228891372681
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.321 Vali Acc: 0.470 Test Loss: 1.321 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 17258818
model size : 66.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.372937917709351
Epoch: 1, Steps: 18 | Train Loss: 0.718 Vali Loss: 0.712 Vali Acc: 0.550 Test Loss: 0.712 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 5.469666481018066
Epoch: 2, Steps: 18 | Train Loss: 0.644 Vali Loss: 0.712 Vali Acc: 0.510 Test Loss: 0.712 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.5092339515686035
Epoch: 3, Steps: 18 | Train Loss: 0.551 Vali Loss: 0.710 Vali Acc: 0.450 Test Loss: 0.710 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.491282224655151
Epoch: 4, Steps: 18 | Train Loss: 0.494 Vali Loss: 0.727 Vali Acc: 0.480 Test Loss: 0.727 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.886494159698486
Epoch: 5, Steps: 18 | Train Loss: 0.373 Vali Loss: 0.733 Vali Acc: 0.550 Test Loss: 0.733 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.912976503372192
Epoch: 6, Steps: 18 | Train Loss: 0.319 Vali Loss: 0.846 Vali Acc: 0.500 Test Loss: 0.846 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.913921356201172
Epoch: 7, Steps: 18 | Train Loss: 0.213 Vali Loss: 0.787 Vali Acc: 0.510 Test Loss: 0.787 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.313150882720947
Epoch: 8, Steps: 18 | Train Loss: 0.139 Vali Loss: 0.804 Vali Acc: 0.490 Test Loss: 0.804 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.264935493469238
Epoch: 9, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.850 Vali Acc: 0.570 Test Loss: 0.850 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 10 cost time: 5.6583051681518555
Epoch: 10, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.888 Vali Acc: 0.540 Test Loss: 0.888 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.8539934158325195
Epoch: 11, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.040 Vali Acc: 0.500 Test Loss: 1.040 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.0812342166900635
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.160 Vali Acc: 0.500 Test Loss: 1.160 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.925439834594727
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.098 Vali Acc: 0.470 Test Loss: 1.098 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.0104453563690186
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.244 Vali Acc: 0.500 Test Loss: 1.244 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.483827114105225
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.226 Vali Acc: 0.450 Test Loss: 1.226 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.428777456283569
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.226 Vali Acc: 0.470 Test Loss: 1.226 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.602218151092529
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.279 Vali Acc: 0.480 Test Loss: 1.279 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.021580457687378
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.294 Vali Acc: 0.480 Test Loss: 1.294 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.044623374938965
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.263 Vali Acc: 0.490 Test Loss: 1.263 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 17252034
model size : 66.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.028473377227783
Epoch: 1, Steps: 18 | Train Loss: 0.722 Vali Loss: 0.848 Vali Acc: 0.590 Test Loss: 0.848 Test Acc: 0.590
Validation loss decreased (inf --> -0.589992).  Saving model ...
Epoch: 2 cost time: 6.070553779602051
Epoch: 2, Steps: 18 | Train Loss: 0.610 Vali Loss: 1.226 Vali Acc: 0.630 Test Loss: 1.226 Test Acc: 0.630
Validation loss decreased (-0.589992 --> -0.629988).  Saving model ...
Epoch: 3 cost time: 5.546682357788086
Epoch: 3, Steps: 18 | Train Loss: 0.571 Vali Loss: 1.063 Vali Acc: 0.490 Test Loss: 1.063 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.659673690795898
Epoch: 4, Steps: 18 | Train Loss: 0.418 Vali Loss: 1.019 Vali Acc: 0.490 Test Loss: 1.019 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.810252666473389
Epoch: 5, Steps: 18 | Train Loss: 0.248 Vali Loss: 1.183 Vali Acc: 0.420 Test Loss: 1.183 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.54157280921936
Epoch: 6, Steps: 18 | Train Loss: 0.141 Vali Loss: 1.578 Vali Acc: 0.420 Test Loss: 1.578 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.960902214050293
Epoch: 7, Steps: 18 | Train Loss: 0.058 Vali Loss: 1.259 Vali Acc: 0.540 Test Loss: 1.259 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.849065780639648
Epoch: 8, Steps: 18 | Train Loss: 0.034 Vali Loss: 1.843 Vali Acc: 0.460 Test Loss: 1.843 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.4039716720581055
Epoch: 9, Steps: 18 | Train Loss: 0.032 Vali Loss: 1.934 Vali Acc: 0.480 Test Loss: 1.934 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.857563734054565
Epoch: 10, Steps: 18 | Train Loss: 0.020 Vali Loss: 2.143 Vali Acc: 0.490 Test Loss: 2.143 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.898860692977905
Epoch: 11, Steps: 18 | Train Loss: 0.036 Vali Loss: 2.718 Vali Acc: 0.440 Test Loss: 2.718 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.07082462310791
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 3.119 Vali Acc: 0.470 Test Loss: 3.119 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 6265602
model size : 24.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.510331869125366
Epoch: 1, Steps: 18 | Train Loss: 0.736 Vali Loss: 0.845 Vali Acc: 0.480 Test Loss: 0.845 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 5.137824296951294
Epoch: 2, Steps: 18 | Train Loss: 0.690 Vali Loss: 0.858 Vali Acc: 0.490 Test Loss: 0.858 Test Acc: 0.490
Validation loss decreased (-0.479992 --> -0.489991).  Saving model ...
Epoch: 3 cost time: 5.2098588943481445
Epoch: 3, Steps: 18 | Train Loss: 0.574 Vali Loss: 1.079 Vali Acc: 0.640 Test Loss: 1.079 Test Acc: 0.640
Validation loss decreased (-0.489991 --> -0.639989).  Saving model ...
Epoch: 4 cost time: 3.951066493988037
Epoch: 4, Steps: 18 | Train Loss: 0.413 Vali Loss: 0.812 Vali Acc: 0.480 Test Loss: 0.812 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.690821647644043
Epoch: 5, Steps: 18 | Train Loss: 0.246 Vali Loss: 0.915 Vali Acc: 0.570 Test Loss: 0.915 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.9650232791900635
Epoch: 6, Steps: 18 | Train Loss: 0.175 Vali Loss: 0.911 Vali Acc: 0.470 Test Loss: 0.911 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6469504833221436
Epoch: 7, Steps: 18 | Train Loss: 0.085 Vali Loss: 1.199 Vali Acc: 0.480 Test Loss: 1.199 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.698410272598267
Epoch: 8, Steps: 18 | Train Loss: 0.073 Vali Loss: 1.184 Vali Acc: 0.470 Test Loss: 1.184 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.603154897689819
Epoch: 9, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.237 Vali Acc: 0.500 Test Loss: 1.237 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.224403381347656
Epoch: 10, Steps: 18 | Train Loss: 0.030 Vali Loss: 1.301 Vali Acc: 0.470 Test Loss: 1.301 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.9332079887390137
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.465 Vali Acc: 0.450 Test Loss: 1.465 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.178955793380737
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.565 Vali Acc: 0.460 Test Loss: 1.565 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.9259867668151855
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.630 Vali Acc: 0.480 Test Loss: 1.630 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 6112354
model size : 23.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.069700241088867
Epoch: 1, Steps: 18 | Train Loss: 0.733 Vali Loss: 0.775 Vali Acc: 0.560 Test Loss: 0.775 Test Acc: 0.560
Validation loss decreased (inf --> -0.559992).  Saving model ...
Epoch: 2 cost time: 4.695113182067871
Epoch: 2, Steps: 18 | Train Loss: 0.639 Vali Loss: 0.773 Vali Acc: 0.470 Test Loss: 0.773 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.604691743850708
Epoch: 3, Steps: 18 | Train Loss: 0.566 Vali Loss: 0.836 Vali Acc: 0.610 Test Loss: 0.836 Test Acc: 0.610
Validation loss decreased (-0.559992 --> -0.609992).  Saving model ...
Epoch: 4 cost time: 4.582216262817383
Epoch: 4, Steps: 18 | Train Loss: 0.468 Vali Loss: 0.767 Vali Acc: 0.530 Test Loss: 0.767 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.271285772323608
Epoch: 5, Steps: 18 | Train Loss: 0.434 Vali Loss: 0.794 Vali Acc: 0.500 Test Loss: 0.794 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.766879320144653
Epoch: 6, Steps: 18 | Train Loss: 0.279 Vali Loss: 0.834 Vali Acc: 0.560 Test Loss: 0.834 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.554213285446167
Epoch: 7, Steps: 18 | Train Loss: 0.157 Vali Loss: 0.825 Vali Acc: 0.520 Test Loss: 0.825 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.626146554946899
Epoch: 8, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.876 Vali Acc: 0.480 Test Loss: 0.876 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.254521131515503
Epoch: 9, Steps: 18 | Train Loss: 0.068 Vali Loss: 1.209 Vali Acc: 0.520 Test Loss: 1.209 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.628211498260498
Epoch: 10, Steps: 18 | Train Loss: 0.031 Vali Loss: 1.098 Vali Acc: 0.520 Test Loss: 1.098 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.653566837310791
Epoch: 11, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.189 Vali Acc: 0.510 Test Loss: 1.189 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.33378267288208
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.208 Vali Acc: 0.540 Test Loss: 1.208 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.795193672180176
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.188 Vali Acc: 0.520 Test Loss: 1.188 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 6057410
model size : 23.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.4790143966674805
Epoch: 1, Steps: 18 | Train Loss: 0.732 Vali Loss: 0.730 Vali Acc: 0.430 Test Loss: 0.730 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 4.27598237991333
Epoch: 2, Steps: 18 | Train Loss: 0.660 Vali Loss: 0.739 Vali Acc: 0.550 Test Loss: 0.739 Test Acc: 0.550
Validation loss decreased (-0.429993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 4.185528755187988
Epoch: 3, Steps: 18 | Train Loss: 0.588 Vali Loss: 0.744 Vali Acc: 0.560 Test Loss: 0.744 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 3.981214761734009
Epoch: 4, Steps: 18 | Train Loss: 0.468 Vali Loss: 0.761 Vali Acc: 0.540 Test Loss: 0.761 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.067731857299805
Epoch: 5, Steps: 18 | Train Loss: 0.357 Vali Loss: 0.724 Vali Acc: 0.550 Test Loss: 0.724 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.394888877868652
Epoch: 6, Steps: 18 | Train Loss: 0.272 Vali Loss: 0.760 Vali Acc: 0.520 Test Loss: 0.760 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.272623538970947
Epoch: 7, Steps: 18 | Train Loss: 0.183 Vali Loss: 0.864 Vali Acc: 0.570 Test Loss: 0.864 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569991).  Saving model ...
Epoch: 8 cost time: 4.519800424575806
Epoch: 8, Steps: 18 | Train Loss: 0.129 Vali Loss: 0.906 Vali Acc: 0.510 Test Loss: 0.906 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.018903017044067
Epoch: 9, Steps: 18 | Train Loss: 0.068 Vali Loss: 1.004 Vali Acc: 0.510 Test Loss: 1.004 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.044226408004761
Epoch: 10, Steps: 18 | Train Loss: 0.033 Vali Loss: 1.116 Vali Acc: 0.530 Test Loss: 1.116 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.3804848194122314
Epoch: 11, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.935 Vali Acc: 0.550 Test Loss: 0.935 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.0205230712890625
Epoch: 12, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.152 Vali Acc: 0.510 Test Loss: 1.152 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.081159830093384
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.133 Vali Acc: 0.510 Test Loss: 1.133 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.138540029525757
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.175 Vali Acc: 0.540 Test Loss: 1.175 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.126305341720581
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.156 Vali Acc: 0.520 Test Loss: 1.156 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.9300382137298584
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.185 Vali Acc: 0.520 Test Loss: 1.185 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.408677339553833
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.224 Vali Acc: 0.510 Test Loss: 1.224 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 6035234
model size : 23.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.0198609828948975
Epoch: 1, Steps: 18 | Train Loss: 0.717 Vali Loss: 0.711 Vali Acc: 0.450 Test Loss: 0.711 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 3.5753376483917236
Epoch: 2, Steps: 18 | Train Loss: 0.646 Vali Loss: 0.732 Vali Acc: 0.480 Test Loss: 0.732 Test Acc: 0.480
Validation loss decreased (-0.449993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 3.652108907699585
Epoch: 3, Steps: 18 | Train Loss: 0.575 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 3.5821571350097656
Epoch: 4, Steps: 18 | Train Loss: 0.531 Vali Loss: 0.869 Vali Acc: 0.500 Test Loss: 0.869 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6786887645721436
Epoch: 5, Steps: 18 | Train Loss: 0.471 Vali Loss: 0.742 Vali Acc: 0.550 Test Loss: 0.742 Test Acc: 0.550
Validation loss decreased (-0.499993 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 3.888669013977051
Epoch: 6, Steps: 18 | Train Loss: 0.359 Vali Loss: 0.739 Vali Acc: 0.550 Test Loss: 0.739 Test Acc: 0.550
Validation loss decreased (-0.549993 --> -0.549993).  Saving model ...
Epoch: 7 cost time: 3.540313482284546
Epoch: 7, Steps: 18 | Train Loss: 0.275 Vali Loss: 0.794 Vali Acc: 0.520 Test Loss: 0.794 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9162397384643555
Epoch: 8, Steps: 18 | Train Loss: 0.193 Vali Loss: 0.834 Vali Acc: 0.540 Test Loss: 0.834 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.909351110458374
Epoch: 9, Steps: 18 | Train Loss: 0.123 Vali Loss: 0.871 Vali Acc: 0.500 Test Loss: 0.871 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.781813859939575
Epoch: 10, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.894 Vali Acc: 0.530 Test Loss: 0.894 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.7388572692871094
Epoch: 11, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.910 Vali Acc: 0.490 Test Loss: 0.910 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.750777006149292
Epoch: 12, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.952 Vali Acc: 0.490 Test Loss: 0.952 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.8249475955963135
Epoch: 13, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.133 Vali Acc: 0.500 Test Loss: 1.133 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.8425450325012207
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.092 Vali Acc: 0.480 Test Loss: 1.092 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.8684487342834473
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.074 Vali Acc: 0.490 Test Loss: 1.074 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.6607120037078857
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.084 Vali Acc: 0.510 Test Loss: 1.084 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 6015458
model size : 23.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.96073579788208
Epoch: 1, Steps: 18 | Train Loss: 0.709 Vali Loss: 0.761 Vali Acc: 0.500 Test Loss: 0.761 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 3.5670297145843506
Epoch: 2, Steps: 18 | Train Loss: 0.686 Vali Loss: 0.804 Vali Acc: 0.460 Test Loss: 0.804 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.483046770095825
Epoch: 3, Steps: 18 | Train Loss: 0.622 Vali Loss: 0.712 Vali Acc: 0.540 Test Loss: 0.712 Test Acc: 0.540
Validation loss decreased (-0.499992 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 3.754589319229126
Epoch: 4, Steps: 18 | Train Loss: 0.530 Vali Loss: 0.790 Vali Acc: 0.540 Test Loss: 0.790 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6977195739746094
Epoch: 5, Steps: 18 | Train Loss: 0.453 Vali Loss: 0.725 Vali Acc: 0.490 Test Loss: 0.725 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.6143829822540283
Epoch: 6, Steps: 18 | Train Loss: 0.355 Vali Loss: 0.762 Vali Acc: 0.520 Test Loss: 0.762 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.323688507080078
Epoch: 7, Steps: 18 | Train Loss: 0.318 Vali Loss: 0.755 Vali Acc: 0.510 Test Loss: 0.755 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.189272165298462
Epoch: 8, Steps: 18 | Train Loss: 0.225 Vali Loss: 0.816 Vali Acc: 0.510 Test Loss: 0.816 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.291938066482544
Epoch: 9, Steps: 18 | Train Loss: 0.187 Vali Loss: 0.849 Vali Acc: 0.520 Test Loss: 0.849 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.557304859161377
Epoch: 10, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.798 Vali Acc: 0.500 Test Loss: 0.798 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.7234902381896973
Epoch: 11, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.929 Vali Acc: 0.500 Test Loss: 0.929 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.3789327144622803
Epoch: 12, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.948 Vali Acc: 0.510 Test Loss: 0.948 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.601161003112793
Epoch: 13, Steps: 18 | Train Loss: 0.027 Vali Loss: 1.014 Vali Acc: 0.500 Test Loss: 1.014 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 6003874
model size : 23.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.354799509048462
Epoch: 1, Steps: 18 | Train Loss: 0.735 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 3.571340560913086
Epoch: 2, Steps: 18 | Train Loss: 0.675 Vali Loss: 0.743 Vali Acc: 0.600 Test Loss: 0.743 Test Acc: 0.600
Validation loss decreased (-0.499993 --> -0.599993).  Saving model ...
Epoch: 3 cost time: 3.969702959060669
Epoch: 3, Steps: 18 | Train Loss: 0.614 Vali Loss: 0.725 Vali Acc: 0.560 Test Loss: 0.725 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8250889778137207
Epoch: 4, Steps: 18 | Train Loss: 0.563 Vali Loss: 0.751 Vali Acc: 0.570 Test Loss: 0.751 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.760596752166748
Epoch: 5, Steps: 18 | Train Loss: 0.486 Vali Loss: 0.773 Vali Acc: 0.620 Test Loss: 0.773 Test Acc: 0.620
Validation loss decreased (-0.599993 --> -0.619992).  Saving model ...
Epoch: 6 cost time: 2.661332368850708
Epoch: 6, Steps: 18 | Train Loss: 0.416 Vali Loss: 0.738 Vali Acc: 0.560 Test Loss: 0.738 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.786452531814575
Epoch: 7, Steps: 18 | Train Loss: 0.348 Vali Loss: 0.789 Vali Acc: 0.550 Test Loss: 0.789 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.067800760269165
Epoch: 8, Steps: 18 | Train Loss: 0.276 Vali Loss: 0.747 Vali Acc: 0.550 Test Loss: 0.747 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.6115989685058594
Epoch: 9, Steps: 18 | Train Loss: 0.209 Vali Loss: 0.808 Vali Acc: 0.500 Test Loss: 0.808 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.8972978591918945
Epoch: 10, Steps: 18 | Train Loss: 0.153 Vali Loss: 0.819 Vali Acc: 0.530 Test Loss: 0.819 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.799077033996582
Epoch: 11, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.851 Vali Acc: 0.460 Test Loss: 0.851 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.5734975337982178
Epoch: 12, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.874 Vali Acc: 0.500 Test Loss: 0.874 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.546774387359619
Epoch: 13, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.909 Vali Acc: 0.530 Test Loss: 0.909 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.8300297260284424
Epoch: 14, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.000 Vali Acc: 0.510 Test Loss: 1.000 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.980123519897461
Epoch: 15, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.991 Vali Acc: 0.520 Test Loss: 0.991 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 6000482
model size : 23.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 29.70205307006836
Epoch: 1, Steps: 18 | Train Loss: 3.715 Vali Loss: 2.210 Vali Acc: 0.550 Test Loss: 2.210 Test Acc: 0.550
Validation loss decreased (inf --> -0.549978).  Saving model ...
Epoch: 2 cost time: 28.61746048927307
Epoch: 2, Steps: 18 | Train Loss: 3.290 Vali Loss: 4.464 Vali Acc: 0.440 Test Loss: 4.464 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 28.704060077667236
Epoch: 3, Steps: 18 | Train Loss: 4.740 Vali Loss: 7.093 Vali Acc: 0.510 Test Loss: 7.093 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 28.38994598388672
Epoch: 4, Steps: 18 | Train Loss: 3.510 Vali Loss: 8.092 Vali Acc: 0.560 Test Loss: 8.092 Test Acc: 0.560
Validation loss decreased (-0.549978 --> -0.559919).  Saving model ...
Epoch: 5 cost time: 28.070651054382324
Epoch: 5, Steps: 18 | Train Loss: 2.472 Vali Loss: 11.464 Vali Acc: 0.560 Test Loss: 11.464 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 28.422858476638794
Epoch: 6, Steps: 18 | Train Loss: 1.921 Vali Loss: 22.898 Vali Acc: 0.500 Test Loss: 22.898 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 27.746532678604126
Epoch: 7, Steps: 18 | Train Loss: 1.946 Vali Loss: 16.797 Vali Acc: 0.480 Test Loss: 16.797 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 27.75373101234436
Epoch: 8, Steps: 18 | Train Loss: 1.419 Vali Loss: 13.720 Vali Acc: 0.530 Test Loss: 13.720 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 27.991056203842163
Epoch: 9, Steps: 18 | Train Loss: 1.585 Vali Loss: 15.548 Vali Acc: 0.530 Test Loss: 15.548 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 28.176724910736084
Epoch: 10, Steps: 18 | Train Loss: 0.557 Vali Loss: 8.060 Vali Acc: 0.540 Test Loss: 8.060 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 27.742026805877686
Epoch: 11, Steps: 18 | Train Loss: 0.239 Vali Loss: 7.484 Vali Acc: 0.480 Test Loss: 7.484 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 27.859758853912354
Epoch: 12, Steps: 18 | Train Loss: 0.268 Vali Loss: 8.785 Vali Acc: 0.520 Test Loss: 8.785 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 27.52569580078125
Epoch: 13, Steps: 18 | Train Loss: 0.203 Vali Loss: 9.417 Vali Acc: 0.530 Test Loss: 9.417 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 27.116490602493286
Epoch: 14, Steps: 18 | Train Loss: 0.428 Vali Loss: 11.123 Vali Acc: 0.540 Test Loss: 11.123 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 45043714
model size : 172.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.15303373336792
Epoch: 1, Steps: 18 | Train Loss: 2.212 Vali Loss: 1.952 Vali Acc: 0.430 Test Loss: 1.952 Test Acc: 0.430
Validation loss decreased (inf --> -0.429980).  Saving model ...
Epoch: 2 cost time: 17.006634950637817
Epoch: 2, Steps: 18 | Train Loss: 2.497 Vali Loss: 3.394 Vali Acc: 0.510 Test Loss: 3.394 Test Acc: 0.510
Validation loss decreased (-0.429980 --> -0.509966).  Saving model ...
Epoch: 3 cost time: 16.790428638458252
Epoch: 3, Steps: 18 | Train Loss: 2.489 Vali Loss: 2.738 Vali Acc: 0.460 Test Loss: 2.738 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.037359476089478
Epoch: 4, Steps: 18 | Train Loss: 1.907 Vali Loss: 7.659 Vali Acc: 0.390 Test Loss: 7.659 Test Acc: 0.390
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 16.99072265625
Epoch: 5, Steps: 18 | Train Loss: 1.940 Vali Loss: 9.663 Vali Acc: 0.390 Test Loss: 9.663 Test Acc: 0.390
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 16.870238304138184
Epoch: 6, Steps: 18 | Train Loss: 1.918 Vali Loss: 8.545 Vali Acc: 0.550 Test Loss: 8.545 Test Acc: 0.550
Validation loss decreased (-0.509966 --> -0.549915).  Saving model ...
Epoch: 7 cost time: 16.87074565887451
Epoch: 7, Steps: 18 | Train Loss: 1.330 Vali Loss: 9.184 Vali Acc: 0.530 Test Loss: 9.184 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.785762071609497
Epoch: 8, Steps: 18 | Train Loss: 0.707 Vali Loss: 8.091 Vali Acc: 0.450 Test Loss: 8.091 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 17.10504388809204
Epoch: 9, Steps: 18 | Train Loss: 0.804 Vali Loss: 7.510 Vali Acc: 0.560 Test Loss: 7.510 Test Acc: 0.560
Validation loss decreased (-0.549915 --> -0.559925).  Saving model ...
Epoch: 10 cost time: 17.182756900787354
Epoch: 10, Steps: 18 | Train Loss: 0.825 Vali Loss: 5.652 Vali Acc: 0.540 Test Loss: 5.652 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 17.20777988433838
Epoch: 11, Steps: 18 | Train Loss: 0.478 Vali Loss: 8.137 Vali Acc: 0.480 Test Loss: 8.137 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 17.204174518585205
Epoch: 12, Steps: 18 | Train Loss: 0.481 Vali Loss: 7.484 Vali Acc: 0.530 Test Loss: 7.484 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 17.00409197807312
Epoch: 13, Steps: 18 | Train Loss: 0.239 Vali Loss: 6.510 Vali Acc: 0.580 Test Loss: 6.510 Test Acc: 0.580
Validation loss decreased (-0.559925 --> -0.579935).  Saving model ...
Epoch: 14 cost time: 17.000372171401978
Epoch: 14, Steps: 18 | Train Loss: 1.028 Vali Loss: 8.327 Vali Acc: 0.500 Test Loss: 8.327 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 16.756439208984375
Epoch: 15, Steps: 18 | Train Loss: 1.126 Vali Loss: 9.907 Vali Acc: 0.470 Test Loss: 9.907 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 17.197985887527466
Epoch: 16, Steps: 18 | Train Loss: 0.219 Vali Loss: 8.910 Vali Acc: 0.460 Test Loss: 8.910 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 17.20994544029236
Epoch: 17, Steps: 18 | Train Loss: 0.440 Vali Loss: 7.246 Vali Acc: 0.580 Test Loss: 7.246 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 17.180743932724
Epoch: 18, Steps: 18 | Train Loss: 0.440 Vali Loss: 12.185 Vali Acc: 0.450 Test Loss: 12.185 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 17.114999532699585
Epoch: 19, Steps: 18 | Train Loss: 0.657 Vali Loss: 12.207 Vali Acc: 0.460 Test Loss: 12.207 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 16.97438383102417
Epoch: 20, Steps: 18 | Train Loss: 0.468 Vali Loss: 13.363 Vali Acc: 0.540 Test Loss: 13.363 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 16.751408338546753
Epoch: 21, Steps: 18 | Train Loss: 0.340 Vali Loss: 8.382 Vali Acc: 0.510 Test Loss: 8.382 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 16.887911558151245
Epoch: 22, Steps: 18 | Train Loss: 0.268 Vali Loss: 9.289 Vali Acc: 0.510 Test Loss: 9.289 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 17.147194147109985
Epoch: 23, Steps: 18 | Train Loss: 0.330 Vali Loss: 10.406 Vali Acc: 0.490 Test Loss: 10.406 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 43817730
model size : 167.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.314592123031616
Epoch: 1, Steps: 18 | Train Loss: 1.026 Vali Loss: 1.082 Vali Acc: 0.530 Test Loss: 1.082 Test Acc: 0.530
Validation loss decreased (inf --> -0.529989).  Saving model ...
Epoch: 2 cost time: 11.282426834106445
Epoch: 2, Steps: 18 | Train Loss: 0.885 Vali Loss: 2.988 Vali Acc: 0.620 Test Loss: 2.988 Test Acc: 0.620
Validation loss decreased (-0.529989 --> -0.619970).  Saving model ...
Epoch: 3 cost time: 12.318167686462402
Epoch: 3, Steps: 18 | Train Loss: 0.936 Vali Loss: 1.181 Vali Acc: 0.570 Test Loss: 1.181 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.934017419815063
Epoch: 4, Steps: 18 | Train Loss: 1.178 Vali Loss: 5.507 Vali Acc: 0.520 Test Loss: 5.507 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.888461351394653
Epoch: 5, Steps: 18 | Train Loss: 1.277 Vali Loss: 4.094 Vali Acc: 0.470 Test Loss: 4.094 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.169897556304932
Epoch: 6, Steps: 18 | Train Loss: 0.730 Vali Loss: 4.645 Vali Acc: 0.480 Test Loss: 4.645 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 11.800319194793701
Epoch: 7, Steps: 18 | Train Loss: 0.549 Vali Loss: 6.359 Vali Acc: 0.530 Test Loss: 6.359 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.702009201049805
Epoch: 8, Steps: 18 | Train Loss: 0.886 Vali Loss: 5.015 Vali Acc: 0.530 Test Loss: 5.015 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 12.083740234375
Epoch: 9, Steps: 18 | Train Loss: 0.823 Vali Loss: 5.076 Vali Acc: 0.530 Test Loss: 5.076 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 12.140979051589966
Epoch: 10, Steps: 18 | Train Loss: 0.632 Vali Loss: 5.287 Vali Acc: 0.470 Test Loss: 5.287 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 12.08055591583252
Epoch: 11, Steps: 18 | Train Loss: 0.826 Vali Loss: 7.677 Vali Acc: 0.510 Test Loss: 7.677 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 11.715570449829102
Epoch: 12, Steps: 18 | Train Loss: 1.158 Vali Loss: 7.648 Vali Acc: 0.460 Test Loss: 7.648 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 43378178
model size : 165.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.144712209701538
Epoch: 1, Steps: 18 | Train Loss: 1.095 Vali Loss: 1.036 Vali Acc: 0.540 Test Loss: 1.036 Test Acc: 0.540
Validation loss decreased (inf --> -0.539990).  Saving model ...
Epoch: 2 cost time: 11.03251838684082
Epoch: 2, Steps: 18 | Train Loss: 1.858 Vali Loss: 1.239 Vali Acc: 0.480 Test Loss: 1.239 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.707856893539429
Epoch: 3, Steps: 18 | Train Loss: 0.842 Vali Loss: 1.951 Vali Acc: 0.670 Test Loss: 1.951 Test Acc: 0.670
Validation loss decreased (-0.539990 --> -0.669980).  Saving model ...
Epoch: 4 cost time: 10.890848159790039
Epoch: 4, Steps: 18 | Train Loss: 0.550 Vali Loss: 2.056 Vali Acc: 0.460 Test Loss: 2.056 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.920202732086182
Epoch: 5, Steps: 18 | Train Loss: 0.816 Vali Loss: 3.350 Vali Acc: 0.480 Test Loss: 3.350 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.039333820343018
Epoch: 6, Steps: 18 | Train Loss: 1.352 Vali Loss: 4.722 Vali Acc: 0.490 Test Loss: 4.722 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.939134120941162
Epoch: 7, Steps: 18 | Train Loss: 0.650 Vali Loss: 5.606 Vali Acc: 0.510 Test Loss: 5.606 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.865898370742798
Epoch: 8, Steps: 18 | Train Loss: 1.418 Vali Loss: 5.665 Vali Acc: 0.500 Test Loss: 5.665 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 11.01763105392456
Epoch: 9, Steps: 18 | Train Loss: 1.188 Vali Loss: 4.199 Vali Acc: 0.440 Test Loss: 4.199 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 10.931816339492798
Epoch: 10, Steps: 18 | Train Loss: 0.259 Vali Loss: 3.382 Vali Acc: 0.480 Test Loss: 3.382 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 11.156457424163818
Epoch: 11, Steps: 18 | Train Loss: 1.028 Vali Loss: 8.064 Vali Acc: 0.450 Test Loss: 8.064 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 10.690233945846558
Epoch: 12, Steps: 18 | Train Loss: 0.656 Vali Loss: 6.331 Vali Acc: 0.530 Test Loss: 6.331 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 10.811100959777832
Epoch: 13, Steps: 18 | Train Loss: 1.250 Vali Loss: 4.717 Vali Acc: 0.540 Test Loss: 4.717 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.67
model parameter : 43200770
model size : 165.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.050806760787964
Epoch: 1, Steps: 18 | Train Loss: 0.885 Vali Loss: 1.287 Vali Acc: 0.580 Test Loss: 1.287 Test Acc: 0.580
Validation loss decreased (inf --> -0.579987).  Saving model ...
Epoch: 2 cost time: 10.216116905212402
Epoch: 2, Steps: 18 | Train Loss: 1.332 Vali Loss: 1.103 Vali Acc: 0.560 Test Loss: 1.103 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.106472492218018
Epoch: 3, Steps: 18 | Train Loss: 0.910 Vali Loss: 2.208 Vali Acc: 0.610 Test Loss: 2.208 Test Acc: 0.610
Validation loss decreased (-0.579987 --> -0.609978).  Saving model ...
Epoch: 4 cost time: 10.422057867050171
Epoch: 4, Steps: 18 | Train Loss: 0.592 Vali Loss: 1.483 Vali Acc: 0.490 Test Loss: 1.483 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.185193538665771
Epoch: 5, Steps: 18 | Train Loss: 0.899 Vali Loss: 2.462 Vali Acc: 0.450 Test Loss: 2.462 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.262109518051147
Epoch: 6, Steps: 18 | Train Loss: 1.023 Vali Loss: 2.221 Vali Acc: 0.460 Test Loss: 2.221 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.381054878234863
Epoch: 7, Steps: 18 | Train Loss: 0.585 Vali Loss: 3.098 Vali Acc: 0.470 Test Loss: 3.098 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.071765422821045
Epoch: 8, Steps: 18 | Train Loss: 0.676 Vali Loss: 3.166 Vali Acc: 0.480 Test Loss: 3.166 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 10.25655460357666
Epoch: 9, Steps: 18 | Train Loss: 0.599 Vali Loss: 3.138 Vali Acc: 0.500 Test Loss: 3.138 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 10.282633304595947
Epoch: 10, Steps: 18 | Train Loss: 0.620 Vali Loss: 5.843 Vali Acc: 0.540 Test Loss: 5.843 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 10.567126035690308
Epoch: 11, Steps: 18 | Train Loss: 1.056 Vali Loss: 3.674 Vali Acc: 0.580 Test Loss: 3.674 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 10.290516376495361
Epoch: 12, Steps: 18 | Train Loss: 0.285 Vali Loss: 3.034 Vali Acc: 0.520 Test Loss: 3.034 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 10.285151958465576
Epoch: 13, Steps: 18 | Train Loss: 0.548 Vali Loss: 5.331 Vali Acc: 0.500 Test Loss: 5.331 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 43009794
model size : 164.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.767441511154175
Epoch: 1, Steps: 18 | Train Loss: 0.927 Vali Loss: 1.095 Vali Acc: 0.650 Test Loss: 1.095 Test Acc: 0.650
Validation loss decreased (inf --> -0.649989).  Saving model ...
Epoch: 2 cost time: 9.51747465133667
Epoch: 2, Steps: 18 | Train Loss: 0.726 Vali Loss: 1.442 Vali Acc: 0.570 Test Loss: 1.442 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.728928089141846
Epoch: 3, Steps: 18 | Train Loss: 0.724 Vali Loss: 1.685 Vali Acc: 0.500 Test Loss: 1.685 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.419452667236328
Epoch: 4, Steps: 18 | Train Loss: 0.558 Vali Loss: 1.510 Vali Acc: 0.580 Test Loss: 1.510 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.181494235992432
Epoch: 5, Steps: 18 | Train Loss: 0.307 Vali Loss: 1.547 Vali Acc: 0.540 Test Loss: 1.547 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.721324682235718
Epoch: 6, Steps: 18 | Train Loss: 0.422 Vali Loss: 1.864 Vali Acc: 0.600 Test Loss: 1.864 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.332045555114746
Epoch: 7, Steps: 18 | Train Loss: 0.658 Vali Loss: 1.933 Vali Acc: 0.550 Test Loss: 1.933 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.427882194519043
Epoch: 8, Steps: 18 | Train Loss: 0.290 Vali Loss: 2.000 Vali Acc: 0.560 Test Loss: 2.000 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 9.340548515319824
Epoch: 9, Steps: 18 | Train Loss: 0.328 Vali Loss: 2.477 Vali Acc: 0.520 Test Loss: 2.477 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 9.37177062034607
Epoch: 10, Steps: 18 | Train Loss: 0.484 Vali Loss: 2.111 Vali Acc: 0.550 Test Loss: 2.111 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 9.375641345977783
Epoch: 11, Steps: 18 | Train Loss: 0.327 Vali Loss: 3.058 Vali Acc: 0.470 Test Loss: 3.058 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 42949890
model size : 164.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.294588565826416
Epoch: 1, Steps: 18 | Train Loss: 0.855 Vali Loss: 0.797 Vali Acc: 0.570 Test Loss: 0.797 Test Acc: 0.570
Validation loss decreased (inf --> -0.569992).  Saving model ...
Epoch: 2 cost time: 8.256661891937256
Epoch: 2, Steps: 18 | Train Loss: 0.718 Vali Loss: 0.874 Vali Acc: 0.530 Test Loss: 0.874 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.029026508331299
Epoch: 3, Steps: 18 | Train Loss: 0.580 Vali Loss: 1.205 Vali Acc: 0.550 Test Loss: 1.205 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.226232528686523
Epoch: 4, Steps: 18 | Train Loss: 0.578 Vali Loss: 0.990 Vali Acc: 0.510 Test Loss: 0.990 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.008788347244263
Epoch: 5, Steps: 18 | Train Loss: 0.394 Vali Loss: 1.358 Vali Acc: 0.590 Test Loss: 1.358 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589986).  Saving model ...
Epoch: 6 cost time: 8.297342777252197
Epoch: 6, Steps: 18 | Train Loss: 0.285 Vali Loss: 1.455 Vali Acc: 0.520 Test Loss: 1.455 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.999937295913696
Epoch: 7, Steps: 18 | Train Loss: 0.147 Vali Loss: 1.411 Vali Acc: 0.510 Test Loss: 1.411 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.143890619277954
Epoch: 8, Steps: 18 | Train Loss: 0.200 Vali Loss: 1.503 Vali Acc: 0.560 Test Loss: 1.503 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.424691677093506
Epoch: 9, Steps: 18 | Train Loss: 0.164 Vali Loss: 1.634 Vali Acc: 0.560 Test Loss: 1.634 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.081079721450806
Epoch: 10, Steps: 18 | Train Loss: 0.276 Vali Loss: 2.233 Vali Acc: 0.570 Test Loss: 2.233 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.096482992172241
Epoch: 11, Steps: 18 | Train Loss: 0.347 Vali Loss: 2.449 Vali Acc: 0.490 Test Loss: 2.449 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 8.268168449401855
Epoch: 12, Steps: 18 | Train Loss: 0.486 Vali Loss: 2.284 Vali Acc: 0.540 Test Loss: 2.284 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.101021766662598
Epoch: 13, Steps: 18 | Train Loss: 0.459 Vali Loss: 2.436 Vali Acc: 0.430 Test Loss: 2.436 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 8.204096555709839
Epoch: 14, Steps: 18 | Train Loss: 0.395 Vali Loss: 2.494 Vali Acc: 0.500 Test Loss: 2.494 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 8.005517959594727
Epoch: 15, Steps: 18 | Train Loss: 0.593 Vali Loss: 1.864 Vali Acc: 0.460 Test Loss: 1.864 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 42922754
model size : 164.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.495861291885376
Epoch: 1, Steps: 18 | Train Loss: 2.193 Vali Loss: 4.565 Vali Acc: 0.600 Test Loss: 4.565 Test Acc: 0.600
Validation loss decreased (inf --> -0.599954).  Saving model ...
Epoch: 2 cost time: 17.696248769760132
Epoch: 2, Steps: 18 | Train Loss: 2.385 Vali Loss: 1.655 Vali Acc: 0.520 Test Loss: 1.655 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.130489349365234
Epoch: 3, Steps: 18 | Train Loss: 1.577 Vali Loss: 3.471 Vali Acc: 0.610 Test Loss: 3.471 Test Acc: 0.610
Validation loss decreased (-0.599954 --> -0.609965).  Saving model ...
Epoch: 4 cost time: 16.962274312973022
Epoch: 4, Steps: 18 | Train Loss: 1.699 Vali Loss: 5.657 Vali Acc: 0.440 Test Loss: 5.657 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.64746594429016
Epoch: 5, Steps: 18 | Train Loss: 1.330 Vali Loss: 5.145 Vali Acc: 0.540 Test Loss: 5.145 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.703237295150757
Epoch: 6, Steps: 18 | Train Loss: 1.195 Vali Loss: 4.310 Vali Acc: 0.450 Test Loss: 4.310 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 16.892852067947388
Epoch: 7, Steps: 18 | Train Loss: 0.772 Vali Loss: 8.051 Vali Acc: 0.540 Test Loss: 8.051 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 16.816617965698242
Epoch: 8, Steps: 18 | Train Loss: 1.132 Vali Loss: 8.546 Vali Acc: 0.520 Test Loss: 8.546 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 17.44825267791748
Epoch: 9, Steps: 18 | Train Loss: 0.852 Vali Loss: 6.648 Vali Acc: 0.570 Test Loss: 6.648 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 17.7458815574646
Epoch: 10, Steps: 18 | Train Loss: 0.640 Vali Loss: 9.700 Vali Acc: 0.450 Test Loss: 9.700 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 17.151401042938232
Epoch: 11, Steps: 18 | Train Loss: 0.406 Vali Loss: 8.641 Vali Acc: 0.520 Test Loss: 8.641 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 16.819223403930664
Epoch: 12, Steps: 18 | Train Loss: 0.130 Vali Loss: 5.665 Vali Acc: 0.600 Test Loss: 5.665 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 17.2076678276062
Epoch: 13, Steps: 18 | Train Loss: 0.027 Vali Loss: 8.819 Vali Acc: 0.500 Test Loss: 8.819 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 14133250
model size : 54.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.879485607147217
Epoch: 1, Steps: 18 | Train Loss: 0.983 Vali Loss: 1.726 Vali Acc: 0.600 Test Loss: 1.726 Test Acc: 0.600
Validation loss decreased (inf --> -0.599983).  Saving model ...
Epoch: 2 cost time: 8.59264063835144
Epoch: 2, Steps: 18 | Train Loss: 0.852 Vali Loss: 0.899 Vali Acc: 0.530 Test Loss: 0.899 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.988708019256592
Epoch: 3, Steps: 18 | Train Loss: 0.578 Vali Loss: 1.474 Vali Acc: 0.510 Test Loss: 1.474 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.622081518173218
Epoch: 4, Steps: 18 | Train Loss: 0.408 Vali Loss: 1.868 Vali Acc: 0.560 Test Loss: 1.868 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.94822907447815
Epoch: 5, Steps: 18 | Train Loss: 0.829 Vali Loss: 2.272 Vali Acc: 0.510 Test Loss: 2.272 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.767160177230835
Epoch: 6, Steps: 18 | Train Loss: 0.456 Vali Loss: 3.824 Vali Acc: 0.460 Test Loss: 3.824 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.565691947937012
Epoch: 7, Steps: 18 | Train Loss: 0.946 Vali Loss: 2.629 Vali Acc: 0.470 Test Loss: 2.629 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 8.695175409317017
Epoch: 8, Steps: 18 | Train Loss: 0.862 Vali Loss: 6.399 Vali Acc: 0.470 Test Loss: 6.399 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.525003433227539
Epoch: 9, Steps: 18 | Train Loss: 1.328 Vali Loss: 4.958 Vali Acc: 0.520 Test Loss: 4.958 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 8.454388856887817
Epoch: 10, Steps: 18 | Train Loss: 0.198 Vali Loss: 6.506 Vali Acc: 0.580 Test Loss: 6.506 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 8.539489507675171
Epoch: 11, Steps: 18 | Train Loss: 0.449 Vali Loss: 7.930 Vali Acc: 0.540 Test Loss: 7.930 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 13520258
model size : 51.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.322653532028198
Epoch: 1, Steps: 18 | Train Loss: 0.893 Vali Loss: 1.165 Vali Acc: 0.530 Test Loss: 1.165 Test Acc: 0.530
Validation loss decreased (inf --> -0.529988).  Saving model ...
Epoch: 2 cost time: 7.118906021118164
Epoch: 2, Steps: 18 | Train Loss: 0.656 Vali Loss: 0.874 Vali Acc: 0.480 Test Loss: 0.874 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.956928253173828
Epoch: 3, Steps: 18 | Train Loss: 0.512 Vali Loss: 1.159 Vali Acc: 0.520 Test Loss: 1.159 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.891789197921753
Epoch: 4, Steps: 18 | Train Loss: 0.549 Vali Loss: 1.365 Vali Acc: 0.560 Test Loss: 1.365 Test Acc: 0.560
Validation loss decreased (-0.529988 --> -0.559986).  Saving model ...
Epoch: 5 cost time: 7.130613327026367
Epoch: 5, Steps: 18 | Train Loss: 0.816 Vali Loss: 1.895 Vali Acc: 0.500 Test Loss: 1.895 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.0069451332092285
Epoch: 6, Steps: 18 | Train Loss: 0.546 Vali Loss: 2.067 Vali Acc: 0.490 Test Loss: 2.067 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.148235321044922
Epoch: 7, Steps: 18 | Train Loss: 0.315 Vali Loss: 3.183 Vali Acc: 0.470 Test Loss: 3.183 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.045140266418457
Epoch: 8, Steps: 18 | Train Loss: 0.164 Vali Loss: 3.247 Vali Acc: 0.450 Test Loss: 3.247 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.097302198410034
Epoch: 9, Steps: 18 | Train Loss: 0.139 Vali Loss: 3.907 Vali Acc: 0.510 Test Loss: 3.907 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.450157403945923
Epoch: 10, Steps: 18 | Train Loss: 0.308 Vali Loss: 3.863 Vali Acc: 0.450 Test Loss: 3.863 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.200898885726929
Epoch: 11, Steps: 18 | Train Loss: 0.290 Vali Loss: 4.091 Vali Acc: 0.510 Test Loss: 4.091 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.812765121459961
Epoch: 12, Steps: 18 | Train Loss: 0.646 Vali Loss: 5.023 Vali Acc: 0.440 Test Loss: 5.023 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.990040302276611
Epoch: 13, Steps: 18 | Train Loss: 0.259 Vali Loss: 4.041 Vali Acc: 0.480 Test Loss: 4.041 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.783350229263306
Epoch: 14, Steps: 18 | Train Loss: 0.412 Vali Loss: 2.996 Vali Acc: 0.490 Test Loss: 2.996 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 13300482
model size : 50.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.722809553146362
Epoch: 1, Steps: 18 | Train Loss: 0.979 Vali Loss: 1.212 Vali Acc: 0.550 Test Loss: 1.212 Test Acc: 0.550
Validation loss decreased (inf --> -0.549988).  Saving model ...
Epoch: 2 cost time: 5.9928014278411865
Epoch: 2, Steps: 18 | Train Loss: 0.651 Vali Loss: 1.136 Vali Acc: 0.520 Test Loss: 1.136 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.803698778152466
Epoch: 3, Steps: 18 | Train Loss: 0.587 Vali Loss: 1.320 Vali Acc: 0.480 Test Loss: 1.320 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.291601896286011
Epoch: 4, Steps: 18 | Train Loss: 0.837 Vali Loss: 1.300 Vali Acc: 0.530 Test Loss: 1.300 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.473278045654297
Epoch: 5, Steps: 18 | Train Loss: 0.531 Vali Loss: 1.462 Vali Acc: 0.550 Test Loss: 1.462 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.359821081161499
Epoch: 6, Steps: 18 | Train Loss: 0.320 Vali Loss: 2.507 Vali Acc: 0.500 Test Loss: 2.507 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.43797492980957
Epoch: 7, Steps: 18 | Train Loss: 0.442 Vali Loss: 1.965 Vali Acc: 0.460 Test Loss: 1.965 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.8632285594940186
Epoch: 8, Steps: 18 | Train Loss: 0.214 Vali Loss: 2.551 Vali Acc: 0.490 Test Loss: 2.551 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.09576678276062
Epoch: 9, Steps: 18 | Train Loss: 0.193 Vali Loss: 2.805 Vali Acc: 0.440 Test Loss: 2.805 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.814216136932373
Epoch: 10, Steps: 18 | Train Loss: 0.141 Vali Loss: 2.433 Vali Acc: 0.530 Test Loss: 2.433 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.234337091445923
Epoch: 11, Steps: 18 | Train Loss: 0.217 Vali Loss: 2.675 Vali Acc: 0.540 Test Loss: 2.675 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 13211778
model size : 50.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.545846700668335
Epoch: 1, Steps: 18 | Train Loss: 0.792 Vali Loss: 0.874 Vali Acc: 0.460 Test Loss: 0.874 Test Acc: 0.460
Validation loss decreased (inf --> -0.459991).  Saving model ...
Epoch: 2 cost time: 5.251507759094238
Epoch: 2, Steps: 18 | Train Loss: 0.614 Vali Loss: 0.707 Vali Acc: 0.570 Test Loss: 0.707 Test Acc: 0.570
Validation loss decreased (-0.459991 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 5.0548012256622314
Epoch: 3, Steps: 18 | Train Loss: 0.537 Vali Loss: 1.566 Vali Acc: 0.560 Test Loss: 1.566 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.314939022064209
Epoch: 4, Steps: 18 | Train Loss: 0.483 Vali Loss: 1.018 Vali Acc: 0.530 Test Loss: 1.018 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.105555772781372
Epoch: 5, Steps: 18 | Train Loss: 0.372 Vali Loss: 1.394 Vali Acc: 0.530 Test Loss: 1.394 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.109134912490845
Epoch: 6, Steps: 18 | Train Loss: 0.395 Vali Loss: 1.503 Vali Acc: 0.460 Test Loss: 1.503 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.794828653335571
Epoch: 7, Steps: 18 | Train Loss: 0.410 Vali Loss: 1.468 Vali Acc: 0.490 Test Loss: 1.468 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.091015100479126
Epoch: 8, Steps: 18 | Train Loss: 0.399 Vali Loss: 1.618 Vali Acc: 0.510 Test Loss: 1.618 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.1628406047821045
Epoch: 9, Steps: 18 | Train Loss: 0.159 Vali Loss: 1.801 Vali Acc: 0.530 Test Loss: 1.801 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.04402232170105
Epoch: 10, Steps: 18 | Train Loss: 0.284 Vali Loss: 1.846 Vali Acc: 0.470 Test Loss: 1.846 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.275238752365112
Epoch: 11, Steps: 18 | Train Loss: 0.151 Vali Loss: 1.932 Vali Acc: 0.480 Test Loss: 1.932 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.925809144973755
Epoch: 12, Steps: 18 | Train Loss: 0.398 Vali Loss: 2.576 Vali Acc: 0.520 Test Loss: 2.576 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 13116290
model size : 50.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.82896614074707
Epoch: 1, Steps: 18 | Train Loss: 0.755 Vali Loss: 0.809 Vali Acc: 0.490 Test Loss: 0.809 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 4.338878154754639
Epoch: 2, Steps: 18 | Train Loss: 0.580 Vali Loss: 0.818 Vali Acc: 0.520 Test Loss: 0.818 Test Acc: 0.520
Validation loss decreased (-0.489992 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 4.546254396438599
Epoch: 3, Steps: 18 | Train Loss: 0.502 Vali Loss: 0.907 Vali Acc: 0.510 Test Loss: 0.907 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.2411463260650635
Epoch: 4, Steps: 18 | Train Loss: 0.373 Vali Loss: 1.148 Vali Acc: 0.490 Test Loss: 1.148 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.845678091049194
Epoch: 5, Steps: 18 | Train Loss: 0.247 Vali Loss: 0.833 Vali Acc: 0.500 Test Loss: 0.833 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.616085052490234
Epoch: 6, Steps: 18 | Train Loss: 0.167 Vali Loss: 1.271 Vali Acc: 0.520 Test Loss: 1.271 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.5826826095581055
Epoch: 7, Steps: 18 | Train Loss: 0.185 Vali Loss: 1.073 Vali Acc: 0.540 Test Loss: 1.073 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539989).  Saving model ...
Epoch: 8 cost time: 4.550112247467041
Epoch: 8, Steps: 18 | Train Loss: 0.115 Vali Loss: 1.337 Vali Acc: 0.450 Test Loss: 1.337 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.5440638065338135
Epoch: 9, Steps: 18 | Train Loss: 0.087 Vali Loss: 1.074 Vali Acc: 0.500 Test Loss: 1.074 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.668206453323364
Epoch: 10, Steps: 18 | Train Loss: 0.163 Vali Loss: 2.587 Vali Acc: 0.540 Test Loss: 2.587 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.388096570968628
Epoch: 11, Steps: 18 | Train Loss: 0.325 Vali Loss: 1.129 Vali Acc: 0.510 Test Loss: 1.129 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.504992246627808
Epoch: 12, Steps: 18 | Train Loss: 0.181 Vali Loss: 1.319 Vali Acc: 0.490 Test Loss: 1.319 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.582505226135254
Epoch: 13, Steps: 18 | Train Loss: 0.313 Vali Loss: 2.204 Vali Acc: 0.490 Test Loss: 2.204 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.597097158432007
Epoch: 14, Steps: 18 | Train Loss: 0.355 Vali Loss: 2.165 Vali Acc: 0.490 Test Loss: 2.165 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.677374601364136
Epoch: 15, Steps: 18 | Train Loss: 0.383 Vali Loss: 1.946 Vali Acc: 0.530 Test Loss: 1.946 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.5105299949646
Epoch: 16, Steps: 18 | Train Loss: 0.152 Vali Loss: 2.630 Vali Acc: 0.520 Test Loss: 2.630 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.424142122268677
Epoch: 17, Steps: 18 | Train Loss: 0.131 Vali Loss: 1.720 Vali Acc: 0.500 Test Loss: 1.720 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 13086338
model size : 50.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.377904891967773
Epoch: 1, Steps: 18 | Train Loss: 0.767 Vali Loss: 0.731 Vali Acc: 0.460 Test Loss: 0.731 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 3.884340763092041
Epoch: 2, Steps: 18 | Train Loss: 0.629 Vali Loss: 0.891 Vali Acc: 0.510 Test Loss: 0.891 Test Acc: 0.510
Validation loss decreased (-0.459993 --> -0.509991).  Saving model ...
Epoch: 3 cost time: 3.9441885948181152
Epoch: 3, Steps: 18 | Train Loss: 0.558 Vali Loss: 0.830 Vali Acc: 0.550 Test Loss: 0.830 Test Acc: 0.550
Validation loss decreased (-0.509991 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 3.8248469829559326
Epoch: 4, Steps: 18 | Train Loss: 0.463 Vali Loss: 0.778 Vali Acc: 0.500 Test Loss: 0.778 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.820065498352051
Epoch: 5, Steps: 18 | Train Loss: 0.407 Vali Loss: 0.917 Vali Acc: 0.550 Test Loss: 0.917 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.618807315826416
Epoch: 6, Steps: 18 | Train Loss: 0.271 Vali Loss: 0.848 Vali Acc: 0.490 Test Loss: 0.848 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6205294132232666
Epoch: 7, Steps: 18 | Train Loss: 0.299 Vali Loss: 0.961 Vali Acc: 0.520 Test Loss: 0.961 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.9811558723449707
Epoch: 8, Steps: 18 | Train Loss: 0.241 Vali Loss: 1.308 Vali Acc: 0.490 Test Loss: 1.308 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.824103832244873
Epoch: 9, Steps: 18 | Train Loss: 0.195 Vali Loss: 1.231 Vali Acc: 0.650 Test Loss: 1.231 Test Acc: 0.650
Validation loss decreased (-0.549992 --> -0.649988).  Saving model ...
Epoch: 10 cost time: 3.9781954288482666
Epoch: 10, Steps: 18 | Train Loss: 0.201 Vali Loss: 1.241 Vali Acc: 0.490 Test Loss: 1.241 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.893368721008301
Epoch: 11, Steps: 18 | Train Loss: 0.144 Vali Loss: 1.117 Vali Acc: 0.540 Test Loss: 1.117 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.785478115081787
Epoch: 12, Steps: 18 | Train Loss: 0.119 Vali Loss: 1.319 Vali Acc: 0.450 Test Loss: 1.319 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.971653699874878
Epoch: 13, Steps: 18 | Train Loss: 0.163 Vali Loss: 1.361 Vali Acc: 0.530 Test Loss: 1.361 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.7804038524627686
Epoch: 14, Steps: 18 | Train Loss: 0.166 Vali Loss: 1.923 Vali Acc: 0.550 Test Loss: 1.923 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.873561143875122
Epoch: 15, Steps: 18 | Train Loss: 0.263 Vali Loss: 1.227 Vali Acc: 0.540 Test Loss: 1.227 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.95186710357666
Epoch: 16, Steps: 18 | Train Loss: 0.121 Vali Loss: 1.661 Vali Acc: 0.510 Test Loss: 1.661 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.86851167678833
Epoch: 17, Steps: 18 | Train Loss: 0.080 Vali Loss: 1.442 Vali Acc: 0.540 Test Loss: 1.442 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.9091873168945312
Epoch: 18, Steps: 18 | Train Loss: 0.062 Vali Loss: 1.525 Vali Acc: 0.490 Test Loss: 1.525 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.8239989280700684
Epoch: 19, Steps: 18 | Train Loss: 0.203 Vali Loss: 2.862 Vali Acc: 0.510 Test Loss: 2.862 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 13072770
model size : 50.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.115866661071777
Epoch: 1, Steps: 18 | Train Loss: 1.048 Vali Loss: 1.349 Vali Acc: 0.430 Test Loss: 1.349 Test Acc: 0.430
Validation loss decreased (inf --> -0.429987).  Saving model ...
Epoch: 2 cost time: 6.799459457397461
Epoch: 2, Steps: 18 | Train Loss: 0.929 Vali Loss: 1.358 Vali Acc: 0.520 Test Loss: 1.358 Test Acc: 0.520
Validation loss decreased (-0.429987 --> -0.519986).  Saving model ...
Epoch: 3 cost time: 6.264837980270386
Epoch: 3, Steps: 18 | Train Loss: 0.900 Vali Loss: 1.713 Vali Acc: 0.590 Test Loss: 1.713 Test Acc: 0.590
Validation loss decreased (-0.519986 --> -0.589983).  Saving model ...
Epoch: 4 cost time: 6.125413656234741
Epoch: 4, Steps: 18 | Train Loss: 0.556 Vali Loss: 2.240 Vali Acc: 0.530 Test Loss: 2.240 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.709902286529541
Epoch: 5, Steps: 18 | Train Loss: 0.494 Vali Loss: 2.677 Vali Acc: 0.450 Test Loss: 2.677 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.2004172801971436
Epoch: 6, Steps: 18 | Train Loss: 0.539 Vali Loss: 3.779 Vali Acc: 0.480 Test Loss: 3.779 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.344618320465088
Epoch: 7, Steps: 18 | Train Loss: 0.725 Vali Loss: 4.318 Vali Acc: 0.480 Test Loss: 4.318 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.595436096191406
Epoch: 8, Steps: 18 | Train Loss: 0.174 Vali Loss: 4.092 Vali Acc: 0.460 Test Loss: 4.092 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.823055267333984
Epoch: 9, Steps: 18 | Train Loss: 0.228 Vali Loss: 5.231 Vali Acc: 0.470 Test Loss: 5.231 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.041729211807251
Epoch: 10, Steps: 18 | Train Loss: 0.304 Vali Loss: 7.499 Vali Acc: 0.480 Test Loss: 7.499 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.496658086776733
Epoch: 11, Steps: 18 | Train Loss: 0.426 Vali Loss: 4.992 Vali Acc: 0.500 Test Loss: 4.992 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.445411443710327
Epoch: 12, Steps: 18 | Train Loss: 0.260 Vali Loss: 7.752 Vali Acc: 0.430 Test Loss: 7.752 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.696119785308838
Epoch: 13, Steps: 18 | Train Loss: 0.162 Vali Loss: 4.879 Vali Acc: 0.520 Test Loss: 4.879 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 4969474
model size : 19.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.88705849647522
Epoch: 1, Steps: 18 | Train Loss: 1.087 Vali Loss: 1.252 Vali Acc: 0.420 Test Loss: 1.252 Test Acc: 0.420
Validation loss decreased (inf --> -0.419987).  Saving model ...
Epoch: 2 cost time: 4.7600555419921875
Epoch: 2, Steps: 18 | Train Loss: 0.781 Vali Loss: 0.979 Vali Acc: 0.600 Test Loss: 0.979 Test Acc: 0.600
Validation loss decreased (-0.419987 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 4.278647184371948
Epoch: 3, Steps: 18 | Train Loss: 0.618 Vali Loss: 1.251 Vali Acc: 0.490 Test Loss: 1.251 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.002317905426025
Epoch: 4, Steps: 18 | Train Loss: 0.525 Vali Loss: 0.877 Vali Acc: 0.520 Test Loss: 0.877 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.276090383529663
Epoch: 5, Steps: 18 | Train Loss: 0.606 Vali Loss: 1.315 Vali Acc: 0.520 Test Loss: 1.315 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.156367778778076
Epoch: 6, Steps: 18 | Train Loss: 0.330 Vali Loss: 2.113 Vali Acc: 0.500 Test Loss: 2.113 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.167439222335815
Epoch: 7, Steps: 18 | Train Loss: 0.259 Vali Loss: 2.435 Vali Acc: 0.500 Test Loss: 2.435 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.491475820541382
Epoch: 8, Steps: 18 | Train Loss: 0.277 Vali Loss: 2.709 Vali Acc: 0.510 Test Loss: 2.709 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.705477714538574
Epoch: 9, Steps: 18 | Train Loss: 0.216 Vali Loss: 2.799 Vali Acc: 0.510 Test Loss: 2.799 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.507254123687744
Epoch: 10, Steps: 18 | Train Loss: 0.115 Vali Loss: 3.049 Vali Acc: 0.540 Test Loss: 3.049 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.090283393859863
Epoch: 11, Steps: 18 | Train Loss: 0.092 Vali Loss: 3.246 Vali Acc: 0.510 Test Loss: 3.246 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.4761974811553955
Epoch: 12, Steps: 18 | Train Loss: 0.135 Vali Loss: 3.040 Vali Acc: 0.540 Test Loss: 3.040 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 4662978
model size : 17.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.323955774307251
Epoch: 1, Steps: 18 | Train Loss: 0.783 Vali Loss: 0.818 Vali Acc: 0.510 Test Loss: 0.818 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 4.138067245483398
Epoch: 2, Steps: 18 | Train Loss: 0.572 Vali Loss: 0.762 Vali Acc: 0.570 Test Loss: 0.762 Test Acc: 0.570
Validation loss decreased (-0.509992 --> -0.569992).  Saving model ...
Epoch: 3 cost time: 4.046512603759766
Epoch: 3, Steps: 18 | Train Loss: 0.413 Vali Loss: 0.978 Vali Acc: 0.520 Test Loss: 0.978 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9342362880706787
Epoch: 4, Steps: 18 | Train Loss: 0.407 Vali Loss: 0.914 Vali Acc: 0.490 Test Loss: 0.914 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.032747745513916
Epoch: 5, Steps: 18 | Train Loss: 0.374 Vali Loss: 1.058 Vali Acc: 0.510 Test Loss: 1.058 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.171517848968506
Epoch: 6, Steps: 18 | Train Loss: 0.147 Vali Loss: 1.620 Vali Acc: 0.490 Test Loss: 1.620 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.203341245651245
Epoch: 7, Steps: 18 | Train Loss: 0.103 Vali Loss: 1.127 Vali Acc: 0.510 Test Loss: 1.127 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.252575159072876
Epoch: 8, Steps: 18 | Train Loss: 0.123 Vali Loss: 1.937 Vali Acc: 0.440 Test Loss: 1.937 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.9660825729370117
Epoch: 9, Steps: 18 | Train Loss: 0.088 Vali Loss: 1.653 Vali Acc: 0.430 Test Loss: 1.653 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.306804180145264
Epoch: 10, Steps: 18 | Train Loss: 0.087 Vali Loss: 2.124 Vali Acc: 0.470 Test Loss: 2.124 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.240229368209839
Epoch: 11, Steps: 18 | Train Loss: 0.066 Vali Loss: 1.495 Vali Acc: 0.440 Test Loss: 1.495 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.8815784454345703
Epoch: 12, Steps: 18 | Train Loss: 0.042 Vali Loss: 1.950 Vali Acc: 0.450 Test Loss: 1.950 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 4553090
model size : 17.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.375041246414185
Epoch: 1, Steps: 18 | Train Loss: 0.759 Vali Loss: 0.766 Vali Acc: 0.560 Test Loss: 0.766 Test Acc: 0.560
Validation loss decreased (inf --> -0.559992).  Saving model ...
Epoch: 2 cost time: 3.4789798259735107
Epoch: 2, Steps: 18 | Train Loss: 0.616 Vali Loss: 0.888 Vali Acc: 0.600 Test Loss: 0.888 Test Acc: 0.600
Validation loss decreased (-0.559992 --> -0.599991).  Saving model ...
Epoch: 3 cost time: 3.340160369873047
Epoch: 3, Steps: 18 | Train Loss: 0.449 Vali Loss: 0.852 Vali Acc: 0.610 Test Loss: 0.852 Test Acc: 0.610
Validation loss decreased (-0.599991 --> -0.609991).  Saving model ...
Epoch: 4 cost time: 2.843186140060425
Epoch: 4, Steps: 18 | Train Loss: 0.403 Vali Loss: 0.942 Vali Acc: 0.500 Test Loss: 0.942 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.015833616256714
Epoch: 5, Steps: 18 | Train Loss: 0.225 Vali Loss: 1.383 Vali Acc: 0.520 Test Loss: 1.383 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.734389543533325
Epoch: 6, Steps: 18 | Train Loss: 0.205 Vali Loss: 1.088 Vali Acc: 0.600 Test Loss: 1.088 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.896902084350586
Epoch: 7, Steps: 18 | Train Loss: 0.159 Vali Loss: 1.103 Vali Acc: 0.570 Test Loss: 1.103 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0136237144470215
Epoch: 8, Steps: 18 | Train Loss: 0.076 Vali Loss: 2.027 Vali Acc: 0.500 Test Loss: 2.027 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.1635582447052
Epoch: 9, Steps: 18 | Train Loss: 0.116 Vali Loss: 1.431 Vali Acc: 0.480 Test Loss: 1.431 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.9933109283447266
Epoch: 10, Steps: 18 | Train Loss: 0.199 Vali Loss: 1.823 Vali Acc: 0.620 Test Loss: 1.823 Test Acc: 0.620
Validation loss decreased (-0.609991 --> -0.619982).  Saving model ...
Epoch: 11 cost time: 2.721043825149536
Epoch: 11, Steps: 18 | Train Loss: 0.191 Vali Loss: 1.793 Vali Acc: 0.570 Test Loss: 1.793 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1029915809631348
Epoch: 12, Steps: 18 | Train Loss: 0.108 Vali Loss: 2.045 Vali Acc: 0.530 Test Loss: 2.045 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6661577224731445
Epoch: 13, Steps: 18 | Train Loss: 0.112 Vali Loss: 1.985 Vali Acc: 0.600 Test Loss: 1.985 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.700582981109619
Epoch: 14, Steps: 18 | Train Loss: 0.049 Vali Loss: 2.409 Vali Acc: 0.520 Test Loss: 2.409 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.3138303756713867
Epoch: 15, Steps: 18 | Train Loss: 0.203 Vali Loss: 1.440 Vali Acc: 0.580 Test Loss: 1.440 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.423095464706421
Epoch: 16, Steps: 18 | Train Loss: 0.079 Vali Loss: 2.086 Vali Acc: 0.560 Test Loss: 2.086 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.0181100368499756
Epoch: 17, Steps: 18 | Train Loss: 0.113 Vali Loss: 1.476 Vali Acc: 0.530 Test Loss: 1.476 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.81752347946167
Epoch: 18, Steps: 18 | Train Loss: 0.057 Vali Loss: 2.638 Vali Acc: 0.480 Test Loss: 2.638 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.0328946113586426
Epoch: 19, Steps: 18 | Train Loss: 0.041 Vali Loss: 2.407 Vali Acc: 0.490 Test Loss: 2.407 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.79643177986145
Epoch: 20, Steps: 18 | Train Loss: 0.052 Vali Loss: 2.308 Vali Acc: 0.570 Test Loss: 2.308 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 4508738
model size : 17.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.7088704109191895
Epoch: 1, Steps: 18 | Train Loss: 0.776 Vali Loss: 0.738 Vali Acc: 0.440 Test Loss: 0.738 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 3.537907600402832
Epoch: 2, Steps: 18 | Train Loss: 0.695 Vali Loss: 0.737 Vali Acc: 0.550 Test Loss: 0.737 Test Acc: 0.550
Validation loss decreased (-0.439993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 3.459981679916382
Epoch: 3, Steps: 18 | Train Loss: 0.570 Vali Loss: 0.826 Vali Acc: 0.510 Test Loss: 0.826 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.277731418609619
Epoch: 4, Steps: 18 | Train Loss: 0.410 Vali Loss: 0.751 Vali Acc: 0.520 Test Loss: 0.751 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.443739652633667
Epoch: 5, Steps: 18 | Train Loss: 0.293 Vali Loss: 0.829 Vali Acc: 0.480 Test Loss: 0.829 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.4455347061157227
Epoch: 6, Steps: 18 | Train Loss: 0.194 Vali Loss: 1.026 Vali Acc: 0.510 Test Loss: 1.026 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.405508518218994
Epoch: 7, Steps: 18 | Train Loss: 0.127 Vali Loss: 1.037 Vali Acc: 0.490 Test Loss: 1.037 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.3484840393066406
Epoch: 8, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.973 Vali Acc: 0.510 Test Loss: 0.973 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.4489684104919434
Epoch: 9, Steps: 18 | Train Loss: 0.079 Vali Loss: 1.213 Vali Acc: 0.470 Test Loss: 1.213 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.3700268268585205
Epoch: 10, Steps: 18 | Train Loss: 0.075 Vali Loss: 1.296 Vali Acc: 0.470 Test Loss: 1.296 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.513869524002075
Epoch: 11, Steps: 18 | Train Loss: 0.036 Vali Loss: 1.251 Vali Acc: 0.460 Test Loss: 1.251 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.4172441959381104
Epoch: 12, Steps: 18 | Train Loss: 0.025 Vali Loss: 2.055 Vali Acc: 0.460 Test Loss: 2.055 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 4460994
model size : 17.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.729212760925293
Epoch: 1, Steps: 18 | Train Loss: 0.763 Vali Loss: 0.747 Vali Acc: 0.490 Test Loss: 0.747 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 3.2190730571746826
Epoch: 2, Steps: 18 | Train Loss: 0.695 Vali Loss: 0.854 Vali Acc: 0.540 Test Loss: 0.854 Test Acc: 0.540
Validation loss decreased (-0.489993 --> -0.539991).  Saving model ...
Epoch: 3 cost time: 3.230029821395874
Epoch: 3, Steps: 18 | Train Loss: 0.546 Vali Loss: 0.901 Vali Acc: 0.510 Test Loss: 0.901 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.374913215637207
Epoch: 4, Steps: 18 | Train Loss: 0.440 Vali Loss: 0.766 Vali Acc: 0.480 Test Loss: 0.766 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.5624825954437256
Epoch: 5, Steps: 18 | Train Loss: 0.314 Vali Loss: 0.875 Vali Acc: 0.620 Test Loss: 0.875 Test Acc: 0.620
Validation loss decreased (-0.539991 --> -0.619991).  Saving model ...
Epoch: 6 cost time: 3.3462271690368652
Epoch: 6, Steps: 18 | Train Loss: 0.225 Vali Loss: 0.778 Vali Acc: 0.540 Test Loss: 0.778 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.258241891860962
Epoch: 7, Steps: 18 | Train Loss: 0.174 Vali Loss: 1.050 Vali Acc: 0.450 Test Loss: 1.050 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.3349575996398926
Epoch: 8, Steps: 18 | Train Loss: 0.115 Vali Loss: 0.968 Vali Acc: 0.510 Test Loss: 0.968 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.2149181365966797
Epoch: 9, Steps: 18 | Train Loss: 0.101 Vali Loss: 1.103 Vali Acc: 0.500 Test Loss: 1.103 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.428605079650879
Epoch: 10, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.985 Vali Acc: 0.480 Test Loss: 0.985 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.232680559158325
Epoch: 11, Steps: 18 | Train Loss: 0.053 Vali Loss: 1.022 Vali Acc: 0.500 Test Loss: 1.022 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.500131368637085
Epoch: 12, Steps: 18 | Train Loss: 0.028 Vali Loss: 1.010 Vali Acc: 0.510 Test Loss: 1.010 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.5104079246520996
Epoch: 13, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.080 Vali Acc: 0.500 Test Loss: 1.080 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.5196521282196045
Epoch: 14, Steps: 18 | Train Loss: 0.043 Vali Loss: 1.206 Vali Acc: 0.450 Test Loss: 1.206 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.313692092895508
Epoch: 15, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.340 Vali Acc: 0.520 Test Loss: 1.340 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 4446018
model size : 17.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.322137355804443
Epoch: 1, Steps: 18 | Train Loss: 0.738 Vali Loss: 0.843 Vali Acc: 0.570 Test Loss: 0.843 Test Acc: 0.570
Validation loss decreased (inf --> -0.569992).  Saving model ...
Epoch: 2 cost time: 3.3115952014923096
Epoch: 2, Steps: 18 | Train Loss: 0.686 Vali Loss: 0.793 Vali Acc: 0.460 Test Loss: 0.793 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3993115425109863
Epoch: 3, Steps: 18 | Train Loss: 0.521 Vali Loss: 0.832 Vali Acc: 0.490 Test Loss: 0.832 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.816025733947754
Epoch: 4, Steps: 18 | Train Loss: 0.400 Vali Loss: 0.809 Vali Acc: 0.520 Test Loss: 0.809 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7365238666534424
Epoch: 5, Steps: 18 | Train Loss: 0.492 Vali Loss: 0.819 Vali Acc: 0.510 Test Loss: 0.819 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.892791509628296
Epoch: 6, Steps: 18 | Train Loss: 0.273 Vali Loss: 0.800 Vali Acc: 0.540 Test Loss: 0.800 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.7021987438201904
Epoch: 7, Steps: 18 | Train Loss: 0.220 Vali Loss: 0.847 Vali Acc: 0.560 Test Loss: 0.847 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.0563149452209473
Epoch: 8, Steps: 18 | Train Loss: 0.209 Vali Loss: 0.868 Vali Acc: 0.500 Test Loss: 0.868 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.352531909942627
Epoch: 9, Steps: 18 | Train Loss: 0.128 Vali Loss: 0.935 Vali Acc: 0.500 Test Loss: 0.935 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.133578062057495
Epoch: 10, Steps: 18 | Train Loss: 0.167 Vali Loss: 0.903 Vali Acc: 0.540 Test Loss: 0.903 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.921137809753418
Epoch: 11, Steps: 18 | Train Loss: 0.109 Vali Loss: 0.932 Vali Acc: 0.500 Test Loss: 0.932 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 4439234
model size : 17.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.0988733768463135
Epoch: 1, Steps: 18 | Train Loss: 0.910 Vali Loss: 1.210 Vali Acc: 0.500 Test Loss: 1.210 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 2.717325210571289
Epoch: 2, Steps: 18 | Train Loss: 0.962 Vali Loss: 1.093 Vali Acc: 0.500 Test Loss: 1.093 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 3 cost time: 2.8399622440338135
Epoch: 3, Steps: 18 | Train Loss: 0.648 Vali Loss: 1.673 Vali Acc: 0.440 Test Loss: 1.673 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.730574369430542
Epoch: 4, Steps: 18 | Train Loss: 0.320 Vali Loss: 2.255 Vali Acc: 0.520 Test Loss: 2.255 Test Acc: 0.520
Validation loss decreased (-0.499989 --> -0.519977).  Saving model ...
Epoch: 5 cost time: 2.734426498413086
Epoch: 5, Steps: 18 | Train Loss: 0.444 Vali Loss: 2.913 Vali Acc: 0.420 Test Loss: 2.913 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.730477809906006
Epoch: 6, Steps: 18 | Train Loss: 0.485 Vali Loss: 2.294 Vali Acc: 0.430 Test Loss: 2.294 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8065855503082275
Epoch: 7, Steps: 18 | Train Loss: 0.338 Vali Loss: 2.411 Vali Acc: 0.430 Test Loss: 2.411 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7345492839813232
Epoch: 8, Steps: 18 | Train Loss: 0.158 Vali Loss: 3.058 Vali Acc: 0.430 Test Loss: 3.058 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.6623213291168213
Epoch: 9, Steps: 18 | Train Loss: 0.115 Vali Loss: 2.769 Vali Acc: 0.510 Test Loss: 2.769 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.4576056003570557
Epoch: 10, Steps: 18 | Train Loss: 0.059 Vali Loss: 1.866 Vali Acc: 0.540 Test Loss: 1.866 Test Acc: 0.540
Validation loss decreased (-0.519977 --> -0.539981).  Saving model ...
Epoch: 11 cost time: 2.752279043197632
Epoch: 11, Steps: 18 | Train Loss: 0.039 Vali Loss: 3.718 Vali Acc: 0.550 Test Loss: 3.718 Test Acc: 0.550
Validation loss decreased (-0.539981 --> -0.549963).  Saving model ...
Epoch: 12 cost time: 2.7707901000976562
Epoch: 12, Steps: 18 | Train Loss: 0.084 Vali Loss: 3.466 Vali Acc: 0.450 Test Loss: 3.466 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6881601810455322
Epoch: 13, Steps: 18 | Train Loss: 0.166 Vali Loss: 3.758 Vali Acc: 0.480 Test Loss: 3.758 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6813786029815674
Epoch: 14, Steps: 18 | Train Loss: 0.064 Vali Loss: 3.387 Vali Acc: 0.460 Test Loss: 3.387 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.7996749877929688
Epoch: 15, Steps: 18 | Train Loss: 0.224 Vali Loss: 3.050 Vali Acc: 0.520 Test Loss: 3.050 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.798581600189209
Epoch: 16, Steps: 18 | Train Loss: 0.115 Vali Loss: 4.070 Vali Acc: 0.480 Test Loss: 4.070 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.693467140197754
Epoch: 17, Steps: 18 | Train Loss: 0.028 Vali Loss: 3.919 Vali Acc: 0.450 Test Loss: 3.919 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.707087516784668
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 3.488 Vali Acc: 0.530 Test Loss: 3.488 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.7338807582855225
Epoch: 19, Steps: 18 | Train Loss: 0.006 Vali Loss: 2.003 Vali Acc: 0.640 Test Loss: 2.003 Test Acc: 0.640
Validation loss decreased (-0.549963 --> -0.639980).  Saving model ...
Epoch: 20 cost time: 2.8204493522644043
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 3.230 Vali Acc: 0.550 Test Loss: 3.230 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.6408815383911133
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 3.668 Vali Acc: 0.510 Test Loss: 3.668 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.7679600715637207
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 3.617 Vali Acc: 0.510 Test Loss: 3.617 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.7956066131591797
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 3.556 Vali Acc: 0.510 Test Loss: 3.556 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.6711716651916504
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 3.559 Vali Acc: 0.520 Test Loss: 3.559 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.7432241439819336
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 3.576 Vali Acc: 0.510 Test Loss: 3.576 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.7907466888427734
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 3.501 Vali Acc: 0.500 Test Loss: 3.501 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.8451411724090576
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 3.501 Vali Acc: 0.500 Test Loss: 3.501 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.771959066390991
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 3.485 Vali Acc: 0.500 Test Loss: 3.485 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.8852734565734863
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 3.487 Vali Acc: 0.500 Test Loss: 3.487 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 1960450
model size : 7.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.754729747772217
Epoch: 1, Steps: 18 | Train Loss: 0.817 Vali Loss: 0.932 Vali Acc: 0.560 Test Loss: 0.932 Test Acc: 0.560
Validation loss decreased (inf --> -0.559991).  Saving model ...
Epoch: 2 cost time: 2.5079665184020996
Epoch: 2, Steps: 18 | Train Loss: 0.657 Vali Loss: 0.911 Vali Acc: 0.540 Test Loss: 0.911 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3809356689453125
Epoch: 3, Steps: 18 | Train Loss: 0.579 Vali Loss: 0.901 Vali Acc: 0.490 Test Loss: 0.901 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3898282051086426
Epoch: 4, Steps: 18 | Train Loss: 0.375 Vali Loss: 0.901 Vali Acc: 0.530 Test Loss: 0.901 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4154839515686035
Epoch: 5, Steps: 18 | Train Loss: 0.311 Vali Loss: 0.845 Vali Acc: 0.520 Test Loss: 0.845 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.478186845779419
Epoch: 6, Steps: 18 | Train Loss: 0.168 Vali Loss: 1.424 Vali Acc: 0.480 Test Loss: 1.424 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.278468132019043
Epoch: 7, Steps: 18 | Train Loss: 0.178 Vali Loss: 1.011 Vali Acc: 0.570 Test Loss: 1.011 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569990).  Saving model ...
Epoch: 8 cost time: 2.4197213649749756
Epoch: 8, Steps: 18 | Train Loss: 0.259 Vali Loss: 1.453 Vali Acc: 0.600 Test Loss: 1.453 Test Acc: 0.600
Validation loss decreased (-0.569990 --> -0.599985).  Saving model ...
Epoch: 9 cost time: 2.377542495727539
Epoch: 9, Steps: 18 | Train Loss: 0.089 Vali Loss: 1.410 Vali Acc: 0.520 Test Loss: 1.410 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3534228801727295
Epoch: 10, Steps: 18 | Train Loss: 0.095 Vali Loss: 2.053 Vali Acc: 0.490 Test Loss: 2.053 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.285294771194458
Epoch: 11, Steps: 18 | Train Loss: 0.042 Vali Loss: 2.140 Vali Acc: 0.450 Test Loss: 2.140 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.559401273727417
Epoch: 12, Steps: 18 | Train Loss: 0.050 Vali Loss: 1.943 Vali Acc: 0.530 Test Loss: 1.943 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.247924566268921
Epoch: 13, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.467 Vali Acc: 0.550 Test Loss: 1.467 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.313185214996338
Epoch: 14, Steps: 18 | Train Loss: 0.011 Vali Loss: 2.236 Vali Acc: 0.470 Test Loss: 2.236 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.321028232574463
Epoch: 15, Steps: 18 | Train Loss: 0.011 Vali Loss: 2.174 Vali Acc: 0.490 Test Loss: 2.174 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.4575858116149902
Epoch: 16, Steps: 18 | Train Loss: 0.043 Vali Loss: 1.878 Vali Acc: 0.490 Test Loss: 1.878 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.5202860832214355
Epoch: 17, Steps: 18 | Train Loss: 0.023 Vali Loss: 2.242 Vali Acc: 0.510 Test Loss: 2.242 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.273677349090576
Epoch: 18, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.940 Vali Acc: 0.450 Test Loss: 1.940 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1807202
model size : 6.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.2664718627929688
Epoch: 1, Steps: 18 | Train Loss: 0.744 Vali Loss: 0.809 Vali Acc: 0.450 Test Loss: 0.809 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 1.7545301914215088
Epoch: 2, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.711 Vali Acc: 0.460 Test Loss: 0.711 Test Acc: 0.460
Validation loss decreased (-0.449992 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 1.7651803493499756
Epoch: 3, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.784 Vali Acc: 0.550 Test Loss: 0.784 Test Acc: 0.550
Validation loss decreased (-0.459993 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 1.8337624073028564
Epoch: 4, Steps: 18 | Train Loss: 0.379 Vali Loss: 0.843 Vali Acc: 0.570 Test Loss: 0.843 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569992).  Saving model ...
Epoch: 5 cost time: 1.8992490768432617
Epoch: 5, Steps: 18 | Train Loss: 0.329 Vali Loss: 0.862 Vali Acc: 0.510 Test Loss: 0.862 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7633287906646729
Epoch: 6, Steps: 18 | Train Loss: 0.259 Vali Loss: 0.812 Vali Acc: 0.530 Test Loss: 0.812 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7399554252624512
Epoch: 7, Steps: 18 | Train Loss: 0.168 Vali Loss: 0.991 Vali Acc: 0.450 Test Loss: 0.991 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7576487064361572
Epoch: 8, Steps: 18 | Train Loss: 0.080 Vali Loss: 1.086 Vali Acc: 0.460 Test Loss: 1.086 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.947141408920288
Epoch: 9, Steps: 18 | Train Loss: 0.042 Vali Loss: 1.022 Vali Acc: 0.510 Test Loss: 1.022 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.777693271636963
Epoch: 10, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.975 Vali Acc: 0.490 Test Loss: 0.975 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7897019386291504
Epoch: 11, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.185 Vali Acc: 0.490 Test Loss: 1.185 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7337172031402588
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.365 Vali Acc: 0.470 Test Loss: 1.365 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7212321758270264
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.258 Vali Acc: 0.470 Test Loss: 1.258 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8222894668579102
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.318 Vali Acc: 0.460 Test Loss: 1.318 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1752258
model size : 6.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.215402126312256
Epoch: 1, Steps: 18 | Train Loss: 0.765 Vali Loss: 0.777 Vali Acc: 0.430 Test Loss: 0.777 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 1.8926169872283936
Epoch: 2, Steps: 18 | Train Loss: 0.709 Vali Loss: 0.823 Vali Acc: 0.480 Test Loss: 0.823 Test Acc: 0.480
Validation loss decreased (-0.429992 --> -0.479992).  Saving model ...
Epoch: 3 cost time: 1.7684824466705322
Epoch: 3, Steps: 18 | Train Loss: 0.571 Vali Loss: 0.764 Vali Acc: 0.530 Test Loss: 0.764 Test Acc: 0.530
Validation loss decreased (-0.479992 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 1.8873305320739746
Epoch: 4, Steps: 18 | Train Loss: 0.382 Vali Loss: 0.803 Vali Acc: 0.540 Test Loss: 0.803 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 1.7870814800262451
Epoch: 5, Steps: 18 | Train Loss: 0.274 Vali Loss: 0.943 Vali Acc: 0.510 Test Loss: 0.943 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.864945411682129
Epoch: 6, Steps: 18 | Train Loss: 0.186 Vali Loss: 0.818 Vali Acc: 0.570 Test Loss: 0.818 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569992).  Saving model ...
Epoch: 7 cost time: 1.8940043449401855
Epoch: 7, Steps: 18 | Train Loss: 0.107 Vali Loss: 1.029 Vali Acc: 0.550 Test Loss: 1.029 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7958216667175293
Epoch: 8, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.972 Vali Acc: 0.520 Test Loss: 0.972 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9452013969421387
Epoch: 9, Steps: 18 | Train Loss: 0.029 Vali Loss: 1.009 Vali Acc: 0.520 Test Loss: 1.009 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7482976913452148
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.099 Vali Acc: 0.530 Test Loss: 1.099 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7760539054870605
Epoch: 11, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.059 Vali Acc: 0.550 Test Loss: 1.059 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8002064228057861
Epoch: 12, Steps: 18 | Train Loss: 0.024 Vali Loss: 1.197 Vali Acc: 0.510 Test Loss: 1.197 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7857840061187744
Epoch: 13, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.113 Vali Acc: 0.520 Test Loss: 1.113 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8539516925811768
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.143 Vali Acc: 0.490 Test Loss: 1.143 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7870240211486816
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.040 Vali Acc: 0.520 Test Loss: 1.040 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8868818283081055
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.194 Vali Acc: 0.490 Test Loss: 1.194 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1730082
model size : 6.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.7527809143066406
Epoch: 1, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.775 Vali Acc: 0.410 Test Loss: 0.775 Test Acc: 0.410
Validation loss decreased (inf --> -0.409992).  Saving model ...
Epoch: 2 cost time: 1.6087455749511719
Epoch: 2, Steps: 18 | Train Loss: 0.711 Vali Loss: 0.886 Vali Acc: 0.460 Test Loss: 0.886 Test Acc: 0.460
Validation loss decreased (-0.409992 --> -0.459991).  Saving model ...
Epoch: 3 cost time: 1.6402556896209717
Epoch: 3, Steps: 18 | Train Loss: 0.616 Vali Loss: 0.738 Vali Acc: 0.490 Test Loss: 0.738 Test Acc: 0.490
Validation loss decreased (-0.459991 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 1.5878345966339111
Epoch: 4, Steps: 18 | Train Loss: 0.517 Vali Loss: 0.865 Vali Acc: 0.460 Test Loss: 0.865 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.590092420578003
Epoch: 5, Steps: 18 | Train Loss: 0.382 Vali Loss: 0.800 Vali Acc: 0.530 Test Loss: 0.800 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 1.5738563537597656
Epoch: 6, Steps: 18 | Train Loss: 0.280 Vali Loss: 0.800 Vali Acc: 0.510 Test Loss: 0.800 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5406315326690674
Epoch: 7, Steps: 18 | Train Loss: 0.201 Vali Loss: 0.822 Vali Acc: 0.470 Test Loss: 0.822 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.606827735900879
Epoch: 8, Steps: 18 | Train Loss: 0.160 Vali Loss: 0.789 Vali Acc: 0.490 Test Loss: 0.789 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6728901863098145
Epoch: 9, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.829 Vali Acc: 0.540 Test Loss: 0.829 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 10 cost time: 1.5906591415405273
Epoch: 10, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.938 Vali Acc: 0.470 Test Loss: 0.938 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5517492294311523
Epoch: 11, Steps: 18 | Train Loss: 0.059 Vali Loss: 1.104 Vali Acc: 0.500 Test Loss: 1.104 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6244797706604004
Epoch: 12, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.993 Vali Acc: 0.480 Test Loss: 0.993 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6932401657104492
Epoch: 13, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.109 Vali Acc: 0.440 Test Loss: 1.109 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.642554759979248
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.108 Vali Acc: 0.480 Test Loss: 1.108 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.540635108947754
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.192 Vali Acc: 0.480 Test Loss: 1.192 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.626849889755249
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.188 Vali Acc: 0.470 Test Loss: 1.188 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6119775772094727
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.195 Vali Acc: 0.460 Test Loss: 1.195 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5716660022735596
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.224 Vali Acc: 0.470 Test Loss: 1.224 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.632187843322754
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.203 Vali Acc: 0.480 Test Loss: 1.203 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 1706210
model size : 6.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.84438157081604
Epoch: 1, Steps: 18 | Train Loss: 0.724 Vali Loss: 0.692 Vali Acc: 0.480 Test Loss: 0.692 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.4529485702514648
Epoch: 2, Steps: 18 | Train Loss: 0.643 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.5064656734466553
Epoch: 3, Steps: 18 | Train Loss: 0.553 Vali Loss: 0.706 Vali Acc: 0.490 Test Loss: 0.706 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4961538314819336
Epoch: 4, Steps: 18 | Train Loss: 0.504 Vali Loss: 0.757 Vali Acc: 0.470 Test Loss: 0.757 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6512107849121094
Epoch: 5, Steps: 18 | Train Loss: 0.382 Vali Loss: 0.734 Vali Acc: 0.510 Test Loss: 0.734 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 6 cost time: 1.5486664772033691
Epoch: 6, Steps: 18 | Train Loss: 0.295 Vali Loss: 0.768 Vali Acc: 0.460 Test Loss: 0.768 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5379798412322998
Epoch: 7, Steps: 18 | Train Loss: 0.237 Vali Loss: 0.810 Vali Acc: 0.500 Test Loss: 0.810 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6214103698730469
Epoch: 8, Steps: 18 | Train Loss: 0.222 Vali Loss: 0.775 Vali Acc: 0.530 Test Loss: 0.775 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529992).  Saving model ...
Epoch: 9 cost time: 1.5619285106658936
Epoch: 9, Steps: 18 | Train Loss: 0.160 Vali Loss: 0.865 Vali Acc: 0.500 Test Loss: 0.865 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4922430515289307
Epoch: 10, Steps: 18 | Train Loss: 0.148 Vali Loss: 0.744 Vali Acc: 0.540 Test Loss: 0.744 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539993).  Saving model ...
Epoch: 11 cost time: 1.5887675285339355
Epoch: 11, Steps: 18 | Train Loss: 0.091 Vali Loss: 0.979 Vali Acc: 0.510 Test Loss: 0.979 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5660631656646729
Epoch: 12, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.941 Vali Acc: 0.500 Test Loss: 0.941 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5148541927337646
Epoch: 13, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.948 Vali Acc: 0.520 Test Loss: 0.948 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5064599514007568
Epoch: 14, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.940 Vali Acc: 0.530 Test Loss: 0.940 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6510920524597168
Epoch: 15, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.891 Vali Acc: 0.540 Test Loss: 0.891 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5246977806091309
Epoch: 16, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.914 Vali Acc: 0.460 Test Loss: 0.914 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5056507587432861
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.021 Vali Acc: 0.500 Test Loss: 1.021 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.543180227279663
Epoch: 18, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.026 Vali Acc: 0.490 Test Loss: 1.026 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.503727912902832
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.024 Vali Acc: 0.520 Test Loss: 1.024 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5265741348266602
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.056 Vali Acc: 0.510 Test Loss: 1.056 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 1698722
model size : 6.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.797537326812744
Epoch: 1, Steps: 18 | Train Loss: 0.733 Vali Loss: 0.737 Vali Acc: 0.410 Test Loss: 0.737 Test Acc: 0.410
Validation loss decreased (inf --> -0.409993).  Saving model ...
Epoch: 2 cost time: 1.5700738430023193
Epoch: 2, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.804 Vali Acc: 0.460 Test Loss: 0.804 Test Acc: 0.460
Validation loss decreased (-0.409993 --> -0.459992).  Saving model ...
Epoch: 3 cost time: 1.5939269065856934
Epoch: 3, Steps: 18 | Train Loss: 0.617 Vali Loss: 0.718 Vali Acc: 0.530 Test Loss: 0.718 Test Acc: 0.530
Validation loss decreased (-0.459992 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 1.6037235260009766
Epoch: 4, Steps: 18 | Train Loss: 0.520 Vali Loss: 0.721 Vali Acc: 0.520 Test Loss: 0.721 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5534095764160156
Epoch: 5, Steps: 18 | Train Loss: 0.447 Vali Loss: 0.718 Vali Acc: 0.520 Test Loss: 0.718 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.604935884475708
Epoch: 6, Steps: 18 | Train Loss: 0.379 Vali Loss: 0.700 Vali Acc: 0.580 Test Loss: 0.700 Test Acc: 0.580
Validation loss decreased (-0.529993 --> -0.579993).  Saving model ...
Epoch: 7 cost time: 1.5405821800231934
Epoch: 7, Steps: 18 | Train Loss: 0.299 Vali Loss: 0.760 Vali Acc: 0.500 Test Loss: 0.760 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5416131019592285
Epoch: 8, Steps: 18 | Train Loss: 0.252 Vali Loss: 0.739 Vali Acc: 0.540 Test Loss: 0.739 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6199884414672852
Epoch: 9, Steps: 18 | Train Loss: 0.183 Vali Loss: 0.830 Vali Acc: 0.520 Test Loss: 0.830 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5745809078216553
Epoch: 10, Steps: 18 | Train Loss: 0.143 Vali Loss: 0.895 Vali Acc: 0.570 Test Loss: 0.895 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5896830558776855
Epoch: 11, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.873 Vali Acc: 0.530 Test Loss: 0.873 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5142221450805664
Epoch: 12, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.833 Vali Acc: 0.550 Test Loss: 0.833 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.583040475845337
Epoch: 13, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.852 Vali Acc: 0.490 Test Loss: 0.852 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6156234741210938
Epoch: 14, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.932 Vali Acc: 0.500 Test Loss: 0.932 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5592365264892578
Epoch: 15, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.920 Vali Acc: 0.530 Test Loss: 0.920 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4735491275787354
Epoch: 16, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.933 Vali Acc: 0.550 Test Loss: 0.933 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1695330
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.935007095336914
Epoch: 1, Steps: 18 | Train Loss: 0.762 Vali Loss: 0.771 Vali Acc: 0.490 Test Loss: 0.771 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 4.812228441238403
Epoch: 2, Steps: 18 | Train Loss: 0.658 Vali Loss: 0.974 Vali Acc: 0.400 Test Loss: 0.974 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.880497932434082
Epoch: 3, Steps: 18 | Train Loss: 0.437 Vali Loss: 1.055 Vali Acc: 0.520 Test Loss: 1.055 Test Acc: 0.520
Validation loss decreased (-0.489992 --> -0.519989).  Saving model ...
Epoch: 4 cost time: 4.7970476150512695
Epoch: 4, Steps: 18 | Train Loss: 0.216 Vali Loss: 0.964 Vali Acc: 0.440 Test Loss: 0.964 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.875893831253052
Epoch: 5, Steps: 18 | Train Loss: 0.089 Vali Loss: 1.011 Vali Acc: 0.460 Test Loss: 1.011 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.766999244689941
Epoch: 6, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.363 Vali Acc: 0.480 Test Loss: 1.363 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.912201881408691
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.631 Vali Acc: 0.460 Test Loss: 1.631 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.850797653198242
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.566 Vali Acc: 0.470 Test Loss: 1.566 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.856491565704346
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.794 Vali Acc: 0.480 Test Loss: 1.794 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.921658277511597
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.784 Vali Acc: 0.470 Test Loss: 1.784 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.8594651222229
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.687 Vali Acc: 0.490 Test Loss: 1.687 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.839650869369507
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.782 Vali Acc: 0.460 Test Loss: 1.782 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.0100507736206055
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.818 Vali Acc: 0.470 Test Loss: 1.818 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 9927938
model size : 38.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.856930255889893
Epoch: 1, Steps: 18 | Train Loss: 0.735 Vali Loss: 0.759 Vali Acc: 0.570 Test Loss: 0.759 Test Acc: 0.570
Validation loss decreased (inf --> -0.569992).  Saving model ...
Epoch: 2 cost time: 4.434964179992676
Epoch: 2, Steps: 18 | Train Loss: 0.675 Vali Loss: 0.740 Vali Acc: 0.520 Test Loss: 0.740 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.711345672607422
Epoch: 3, Steps: 18 | Train Loss: 0.487 Vali Loss: 0.788 Vali Acc: 0.570 Test Loss: 0.788 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.5084850788116455
Epoch: 4, Steps: 18 | Train Loss: 0.319 Vali Loss: 0.802 Vali Acc: 0.530 Test Loss: 0.802 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.687442302703857
Epoch: 5, Steps: 18 | Train Loss: 0.179 Vali Loss: 1.085 Vali Acc: 0.490 Test Loss: 1.085 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.562279462814331
Epoch: 6, Steps: 18 | Train Loss: 0.107 Vali Loss: 1.247 Vali Acc: 0.540 Test Loss: 1.247 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.5437211990356445
Epoch: 7, Steps: 18 | Train Loss: 0.072 Vali Loss: 1.132 Vali Acc: 0.510 Test Loss: 1.132 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.527631759643555
Epoch: 8, Steps: 18 | Train Loss: 0.038 Vali Loss: 1.311 Vali Acc: 0.530 Test Loss: 1.311 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.591382265090942
Epoch: 9, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.347 Vali Acc: 0.520 Test Loss: 1.347 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.473355293273926
Epoch: 10, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.418 Vali Acc: 0.530 Test Loss: 1.418 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.507975816726685
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.389 Vali Acc: 0.520 Test Loss: 1.389 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9766498
model size : 37.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.066110610961914
Epoch: 1, Steps: 18 | Train Loss: 0.739 Vali Loss: 0.780 Vali Acc: 0.410 Test Loss: 0.780 Test Acc: 0.410
Validation loss decreased (inf --> -0.409992).  Saving model ...
Epoch: 2 cost time: 4.935487270355225
Epoch: 2, Steps: 18 | Train Loss: 0.652 Vali Loss: 0.763 Vali Acc: 0.460 Test Loss: 0.763 Test Acc: 0.460
Validation loss decreased (-0.409992 --> -0.459992).  Saving model ...
Epoch: 3 cost time: 4.843724012374878
Epoch: 3, Steps: 18 | Train Loss: 0.550 Vali Loss: 0.804 Vali Acc: 0.490 Test Loss: 0.804 Test Acc: 0.490
Validation loss decreased (-0.459992 --> -0.489992).  Saving model ...
Epoch: 4 cost time: 4.759093999862671
Epoch: 4, Steps: 18 | Train Loss: 0.391 Vali Loss: 0.770 Vali Acc: 0.500 Test Loss: 0.770 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499992).  Saving model ...
Epoch: 5 cost time: 4.859526634216309
Epoch: 5, Steps: 18 | Train Loss: 0.288 Vali Loss: 0.824 Vali Acc: 0.520 Test Loss: 0.824 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519992).  Saving model ...
Epoch: 6 cost time: 4.774090528488159
Epoch: 6, Steps: 18 | Train Loss: 0.184 Vali Loss: 0.873 Vali Acc: 0.550 Test Loss: 0.873 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549991).  Saving model ...
Epoch: 7 cost time: 4.87799596786499
Epoch: 7, Steps: 18 | Train Loss: 0.092 Vali Loss: 1.018 Vali Acc: 0.560 Test Loss: 1.018 Test Acc: 0.560
Validation loss decreased (-0.549991 --> -0.559990).  Saving model ...
Epoch: 8 cost time: 4.829449415206909
Epoch: 8, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.939 Vali Acc: 0.490 Test Loss: 0.939 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.908909320831299
Epoch: 9, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.924 Vali Acc: 0.490 Test Loss: 0.924 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.488306522369385
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.995 Vali Acc: 0.520 Test Loss: 0.995 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.681748390197754
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.049 Vali Acc: 0.480 Test Loss: 1.049 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.873917579650879
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.135 Vali Acc: 0.490 Test Loss: 1.135 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.998185873031616
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.117 Vali Acc: 0.470 Test Loss: 1.117 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.803857088088989
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.135 Vali Acc: 0.490 Test Loss: 1.135 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.764639854431152
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.130 Vali Acc: 0.490 Test Loss: 1.130 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.767681837081909
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.149 Vali Acc: 0.490 Test Loss: 1.149 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.786741495132446
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.146 Vali Acc: 0.490 Test Loss: 1.146 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 9719746
model size : 37.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.881558179855347
Epoch: 1, Steps: 18 | Train Loss: 0.732 Vali Loss: 0.704 Vali Acc: 0.610 Test Loss: 0.704 Test Acc: 0.610
Validation loss decreased (inf --> -0.609993).  Saving model ...
Epoch: 2 cost time: 4.485742807388306
Epoch: 2, Steps: 18 | Train Loss: 0.655 Vali Loss: 0.715 Vali Acc: 0.490 Test Loss: 0.715 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.76741099357605
Epoch: 3, Steps: 18 | Train Loss: 0.537 Vali Loss: 0.758 Vali Acc: 0.500 Test Loss: 0.758 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.6825761795043945
Epoch: 4, Steps: 18 | Train Loss: 0.403 Vali Loss: 0.908 Vali Acc: 0.570 Test Loss: 0.908 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.701417446136475
Epoch: 5, Steps: 18 | Train Loss: 0.359 Vali Loss: 0.738 Vali Acc: 0.480 Test Loss: 0.738 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.607033729553223
Epoch: 6, Steps: 18 | Train Loss: 0.245 Vali Loss: 0.821 Vali Acc: 0.490 Test Loss: 0.821 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.827038049697876
Epoch: 7, Steps: 18 | Train Loss: 0.152 Vali Loss: 0.857 Vali Acc: 0.530 Test Loss: 0.857 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.6295166015625
Epoch: 8, Steps: 18 | Train Loss: 0.094 Vali Loss: 1.055 Vali Acc: 0.530 Test Loss: 1.055 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.655635356903076
Epoch: 9, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.921 Vali Acc: 0.500 Test Loss: 0.921 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.650109767913818
Epoch: 10, Steps: 18 | Train Loss: 0.030 Vali Loss: 1.069 Vali Acc: 0.480 Test Loss: 1.069 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.556564569473267
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.024 Vali Acc: 0.510 Test Loss: 1.024 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 9689378
model size : 37.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.817131280899048
Epoch: 1, Steps: 18 | Train Loss: 0.705 Vali Loss: 0.715 Vali Acc: 0.460 Test Loss: 0.715 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 4.168073654174805
Epoch: 2, Steps: 18 | Train Loss: 0.640 Vali Loss: 0.751 Vali Acc: 0.520 Test Loss: 0.751 Test Acc: 0.520
Validation loss decreased (-0.459993 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 4.479572296142578
Epoch: 3, Steps: 18 | Train Loss: 0.560 Vali Loss: 0.742 Vali Acc: 0.570 Test Loss: 0.742 Test Acc: 0.570
Validation loss decreased (-0.519992 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 4.10695219039917
Epoch: 4, Steps: 18 | Train Loss: 0.445 Vali Loss: 0.736 Vali Acc: 0.530 Test Loss: 0.736 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.477748394012451
Epoch: 5, Steps: 18 | Train Loss: 0.361 Vali Loss: 0.777 Vali Acc: 0.530 Test Loss: 0.777 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.668281078338623
Epoch: 6, Steps: 18 | Train Loss: 0.283 Vali Loss: 0.826 Vali Acc: 0.540 Test Loss: 0.826 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.343345880508423
Epoch: 7, Steps: 18 | Train Loss: 0.241 Vali Loss: 0.838 Vali Acc: 0.550 Test Loss: 0.838 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.483063697814941
Epoch: 8, Steps: 18 | Train Loss: 0.152 Vali Loss: 0.929 Vali Acc: 0.520 Test Loss: 0.929 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.212697982788086
Epoch: 9, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.929 Vali Acc: 0.510 Test Loss: 0.929 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.504670858383179
Epoch: 10, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.915 Vali Acc: 0.460 Test Loss: 0.915 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.161503076553345
Epoch: 11, Steps: 18 | Train Loss: 0.024 Vali Loss: 1.034 Vali Acc: 0.500 Test Loss: 1.034 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.503360033035278
Epoch: 12, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.009 Vali Acc: 0.500 Test Loss: 1.009 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.405889511108398
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.033 Vali Acc: 0.470 Test Loss: 1.033 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9677794
model size : 37.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.809755325317383
Epoch: 1, Steps: 18 | Train Loss: 0.703 Vali Loss: 0.719 Vali Acc: 0.440 Test Loss: 0.719 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 4.88739800453186
Epoch: 2, Steps: 18 | Train Loss: 0.645 Vali Loss: 0.761 Vali Acc: 0.590 Test Loss: 0.761 Test Acc: 0.590
Validation loss decreased (-0.439993 --> -0.589992).  Saving model ...
Epoch: 3 cost time: 4.737354278564453
Epoch: 3, Steps: 18 | Train Loss: 0.576 Vali Loss: 0.730 Vali Acc: 0.510 Test Loss: 0.730 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.733712196350098
Epoch: 4, Steps: 18 | Train Loss: 0.479 Vali Loss: 0.748 Vali Acc: 0.460 Test Loss: 0.748 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.403424501419067
Epoch: 5, Steps: 18 | Train Loss: 0.376 Vali Loss: 0.758 Vali Acc: 0.520 Test Loss: 0.758 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.831283092498779
Epoch: 6, Steps: 18 | Train Loss: 0.306 Vali Loss: 0.759 Vali Acc: 0.490 Test Loss: 0.759 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.8192808628082275
Epoch: 7, Steps: 18 | Train Loss: 0.215 Vali Loss: 0.800 Vali Acc: 0.480 Test Loss: 0.800 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.766095161437988
Epoch: 8, Steps: 18 | Train Loss: 0.133 Vali Loss: 0.911 Vali Acc: 0.490 Test Loss: 0.911 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.6551008224487305
Epoch: 9, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.906 Vali Acc: 0.460 Test Loss: 0.906 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.985536813735962
Epoch: 10, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.947 Vali Acc: 0.480 Test Loss: 0.947 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.611445903778076
Epoch: 11, Steps: 18 | Train Loss: 0.030 Vali Loss: 1.063 Vali Acc: 0.470 Test Loss: 1.063 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.828211069107056
Epoch: 12, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.106 Vali Acc: 0.480 Test Loss: 1.106 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9666210
model size : 37.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.954348087310791
Epoch: 1, Steps: 18 | Train Loss: 0.711 Vali Loss: 0.700 Vali Acc: 0.430 Test Loss: 0.700 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 3.6856863498687744
Epoch: 2, Steps: 18 | Train Loss: 0.648 Vali Loss: 0.703 Vali Acc: 0.490 Test Loss: 0.703 Test Acc: 0.490
Validation loss decreased (-0.429993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 3.5961077213287354
Epoch: 3, Steps: 18 | Train Loss: 0.582 Vali Loss: 0.699 Vali Acc: 0.480 Test Loss: 0.699 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7198944091796875
Epoch: 4, Steps: 18 | Train Loss: 0.508 Vali Loss: 0.755 Vali Acc: 0.550 Test Loss: 0.755 Test Acc: 0.550
Validation loss decreased (-0.489993 --> -0.549992).  Saving model ...
Epoch: 5 cost time: 3.6312012672424316
Epoch: 5, Steps: 18 | Train Loss: 0.460 Vali Loss: 0.736 Vali Acc: 0.470 Test Loss: 0.736 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.6845688819885254
Epoch: 6, Steps: 18 | Train Loss: 0.357 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.6858816146850586
Epoch: 7, Steps: 18 | Train Loss: 0.283 Vali Loss: 0.749 Vali Acc: 0.490 Test Loss: 0.749 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.520228862762451
Epoch: 8, Steps: 18 | Train Loss: 0.210 Vali Loss: 0.806 Vali Acc: 0.470 Test Loss: 0.806 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.756373167037964
Epoch: 9, Steps: 18 | Train Loss: 0.141 Vali Loss: 0.902 Vali Acc: 0.470 Test Loss: 0.902 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.6473751068115234
Epoch: 10, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.904 Vali Acc: 0.530 Test Loss: 0.904 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.8017418384552
Epoch: 11, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.994 Vali Acc: 0.500 Test Loss: 0.994 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.588468551635742
Epoch: 12, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.998 Vali Acc: 0.490 Test Loss: 0.998 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.5744423866271973
Epoch: 13, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.082 Vali Acc: 0.510 Test Loss: 1.082 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.695815324783325
Epoch: 14, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.184 Vali Acc: 0.490 Test Loss: 1.184 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 9654626
model size : 37.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.37085223197937
Epoch: 1, Steps: 18 | Train Loss: 0.716 Vali Loss: 0.694 Vali Acc: 0.470 Test Loss: 0.694 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 4.933725595474243
Epoch: 2, Steps: 18 | Train Loss: 0.489 Vali Loss: 0.809 Vali Acc: 0.510 Test Loss: 0.809 Test Acc: 0.510
Validation loss decreased (-0.469993 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 5.421634674072266
Epoch: 3, Steps: 18 | Train Loss: 0.237 Vali Loss: 0.861 Vali Acc: 0.470 Test Loss: 0.861 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.68178915977478
Epoch: 4, Steps: 18 | Train Loss: 0.111 Vali Loss: 1.193 Vali Acc: 0.440 Test Loss: 1.193 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.752612590789795
Epoch: 5, Steps: 18 | Train Loss: 0.068 Vali Loss: 1.681 Vali Acc: 0.520 Test Loss: 1.681 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519983).  Saving model ...
Epoch: 6 cost time: 4.539604425430298
Epoch: 6, Steps: 18 | Train Loss: 0.063 Vali Loss: 1.468 Vali Acc: 0.480 Test Loss: 1.468 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.956727743148804
Epoch: 7, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.405 Vali Acc: 0.550 Test Loss: 1.405 Test Acc: 0.550
Validation loss decreased (-0.519983 --> -0.549986).  Saving model ...
Epoch: 8 cost time: 4.951566696166992
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.213 Vali Acc: 0.490 Test Loss: 1.213 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.123508930206299
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.386 Vali Acc: 0.470 Test Loss: 1.386 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.221240282058716
Epoch: 10, Steps: 18 | Train Loss: 0.011 Vali Loss: 2.045 Vali Acc: 0.500 Test Loss: 2.045 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.7082672119140625
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.923 Vali Acc: 0.450 Test Loss: 1.923 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.75428318977356
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 2.929 Vali Acc: 0.440 Test Loss: 2.929 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.798021554946899
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 2.054 Vali Acc: 0.480 Test Loss: 2.054 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.99568772315979
Epoch: 14, Steps: 18 | Train Loss: 0.043 Vali Loss: 2.591 Vali Acc: 0.490 Test Loss: 2.591 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.915428638458252
Epoch: 15, Steps: 18 | Train Loss: 0.061 Vali Loss: 1.771 Vali Acc: 0.590 Test Loss: 1.771 Test Acc: 0.590
Validation loss decreased (-0.549986 --> -0.589982).  Saving model ...
Epoch: 16 cost time: 5.172024488449097
Epoch: 16, Steps: 18 | Train Loss: 0.011 Vali Loss: 2.482 Vali Acc: 0.460 Test Loss: 2.482 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.230204343795776
Epoch: 17, Steps: 18 | Train Loss: 0.014 Vali Loss: 2.788 Vali Acc: 0.530 Test Loss: 2.788 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.744173765182495
Epoch: 18, Steps: 18 | Train Loss: 0.213 Vali Loss: 3.997 Vali Acc: 0.460 Test Loss: 3.997 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.823362588882446
Epoch: 19, Steps: 18 | Train Loss: 0.117 Vali Loss: 2.125 Vali Acc: 0.500 Test Loss: 2.125 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.9006288051605225
Epoch: 20, Steps: 18 | Train Loss: 0.141 Vali Loss: 3.022 Vali Acc: 0.530 Test Loss: 3.022 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.730874538421631
Epoch: 21, Steps: 18 | Train Loss: 0.032 Vali Loss: 3.828 Vali Acc: 0.460 Test Loss: 3.828 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.114043712615967
Epoch: 22, Steps: 18 | Train Loss: 0.037 Vali Loss: 4.662 Vali Acc: 0.440 Test Loss: 4.662 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.1381707191467285
Epoch: 23, Steps: 18 | Train Loss: 0.100 Vali Loss: 5.277 Vali Acc: 0.480 Test Loss: 5.277 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.592331171035767
Epoch: 24, Steps: 18 | Train Loss: 0.013 Vali Loss: 3.897 Vali Acc: 0.480 Test Loss: 3.897 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.378886461257935
Epoch: 25, Steps: 18 | Train Loss: 0.011 Vali Loss: 5.736 Vali Acc: 0.440 Test Loss: 5.736 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9870594
model size : 37.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.174639701843262
Epoch: 1, Steps: 18 | Train Loss: 0.730 Vali Loss: 0.727 Vali Acc: 0.490 Test Loss: 0.727 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 4.8836281299591064
Epoch: 2, Steps: 18 | Train Loss: 0.628 Vali Loss: 0.768 Vali Acc: 0.520 Test Loss: 0.768 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 4.639692544937134
Epoch: 3, Steps: 18 | Train Loss: 0.521 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.742243528366089
Epoch: 4, Steps: 18 | Train Loss: 0.363 Vali Loss: 0.856 Vali Acc: 0.520 Test Loss: 0.856 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.590137243270874
Epoch: 5, Steps: 18 | Train Loss: 0.241 Vali Loss: 0.866 Vali Acc: 0.530 Test Loss: 0.866 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529991).  Saving model ...
Epoch: 6 cost time: 4.5511791706085205
Epoch: 6, Steps: 18 | Train Loss: 0.178 Vali Loss: 0.971 Vali Acc: 0.520 Test Loss: 0.971 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.670716047286987
Epoch: 7, Steps: 18 | Train Loss: 0.065 Vali Loss: 1.224 Vali Acc: 0.480 Test Loss: 1.224 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.662705421447754
Epoch: 8, Steps: 18 | Train Loss: 0.034 Vali Loss: 1.259 Vali Acc: 0.480 Test Loss: 1.259 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.497937202453613
Epoch: 9, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.325 Vali Acc: 0.570 Test Loss: 1.325 Test Acc: 0.570
Validation loss decreased (-0.529991 --> -0.569987).  Saving model ...
Epoch: 10 cost time: 4.624016284942627
Epoch: 10, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.371 Vali Acc: 0.530 Test Loss: 1.371 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.633650302886963
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.550 Vali Acc: 0.520 Test Loss: 1.550 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.593396186828613
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.642 Vali Acc: 0.500 Test Loss: 1.642 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.749419212341309
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.580 Vali Acc: 0.500 Test Loss: 1.580 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.610789060592651
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.580 Vali Acc: 0.480 Test Loss: 1.580 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.7862608432769775
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.578 Vali Acc: 0.510 Test Loss: 1.578 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.655593395233154
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.590 Vali Acc: 0.500 Test Loss: 1.590 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.713082313537598
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.598 Vali Acc: 0.500 Test Loss: 1.598 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.633182764053345
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.612 Vali Acc: 0.510 Test Loss: 1.612 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.686457633972168
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.610 Vali Acc: 0.500 Test Loss: 1.610 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9709154
model size : 37.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.71444034576416
Epoch: 1, Steps: 18 | Train Loss: 0.731 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 4.875460863113403
Epoch: 2, Steps: 18 | Train Loss: 0.658 Vali Loss: 0.742 Vali Acc: 0.490 Test Loss: 0.742 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.110075950622559
Epoch: 3, Steps: 18 | Train Loss: 0.520 Vali Loss: 0.743 Vali Acc: 0.520 Test Loss: 0.743 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 5.0058581829071045
Epoch: 4, Steps: 18 | Train Loss: 0.430 Vali Loss: 0.801 Vali Acc: 0.470 Test Loss: 0.801 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.080545663833618
Epoch: 5, Steps: 18 | Train Loss: 0.295 Vali Loss: 0.790 Vali Acc: 0.550 Test Loss: 0.790 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 4.866963863372803
Epoch: 6, Steps: 18 | Train Loss: 0.191 Vali Loss: 0.845 Vali Acc: 0.500 Test Loss: 0.845 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.055263996124268
Epoch: 7, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.947 Vali Acc: 0.520 Test Loss: 0.947 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.123793125152588
Epoch: 8, Steps: 18 | Train Loss: 0.047 Vali Loss: 1.008 Vali Acc: 0.480 Test Loss: 1.008 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.0507659912109375
Epoch: 9, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.135 Vali Acc: 0.470 Test Loss: 1.135 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.982619285583496
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.033 Vali Acc: 0.470 Test Loss: 1.033 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.0962677001953125
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.103 Vali Acc: 0.470 Test Loss: 1.103 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.93027400970459
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.115 Vali Acc: 0.460 Test Loss: 1.115 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.966187953948975
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.150 Vali Acc: 0.460 Test Loss: 1.150 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.91862940788269
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.164 Vali Acc: 0.480 Test Loss: 1.164 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.278242349624634
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.170 Vali Acc: 0.480 Test Loss: 1.170 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 9662402
model size : 37.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.124122619628906
Epoch: 1, Steps: 18 | Train Loss: 0.721 Vali Loss: 0.707 Vali Acc: 0.530 Test Loss: 0.707 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 4.469959259033203
Epoch: 2, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.757 Vali Acc: 0.480 Test Loss: 0.757 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.608819484710693
Epoch: 3, Steps: 18 | Train Loss: 0.551 Vali Loss: 0.792 Vali Acc: 0.560 Test Loss: 0.792 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559992).  Saving model ...
Epoch: 4 cost time: 4.422924041748047
Epoch: 4, Steps: 18 | Train Loss: 0.400 Vali Loss: 0.749 Vali Acc: 0.490 Test Loss: 0.749 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.7954323291778564
Epoch: 5, Steps: 18 | Train Loss: 0.309 Vali Loss: 0.762 Vali Acc: 0.510 Test Loss: 0.762 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.386468172073364
Epoch: 6, Steps: 18 | Train Loss: 0.211 Vali Loss: 0.872 Vali Acc: 0.490 Test Loss: 0.872 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.84316873550415
Epoch: 7, Steps: 18 | Train Loss: 0.141 Vali Loss: 0.892 Vali Acc: 0.550 Test Loss: 0.892 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.600595712661743
Epoch: 8, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.953 Vali Acc: 0.480 Test Loss: 0.953 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.673438310623169
Epoch: 9, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.080 Vali Acc: 0.530 Test Loss: 1.080 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.65331768989563
Epoch: 10, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.998 Vali Acc: 0.500 Test Loss: 0.998 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.4474897384643555
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.055 Vali Acc: 0.450 Test Loss: 1.055 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.422824144363403
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.052 Vali Acc: 0.500 Test Loss: 1.052 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.336416721343994
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.067 Vali Acc: 0.470 Test Loss: 1.067 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 9632034
model size : 37.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.385724067687988
Epoch: 1, Steps: 18 | Train Loss: 0.734 Vali Loss: 0.694 Vali Acc: 0.530 Test Loss: 0.694 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 4.11092734336853
Epoch: 2, Steps: 18 | Train Loss: 0.625 Vali Loss: 0.721 Vali Acc: 0.540 Test Loss: 0.721 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 4.523992538452148
Epoch: 3, Steps: 18 | Train Loss: 0.546 Vali Loss: 0.700 Vali Acc: 0.590 Test Loss: 0.700 Test Acc: 0.590
Validation loss decreased (-0.539993 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 4.291156530380249
Epoch: 4, Steps: 18 | Train Loss: 0.461 Vali Loss: 0.747 Vali Acc: 0.540 Test Loss: 0.747 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.0243589878082275
Epoch: 5, Steps: 18 | Train Loss: 0.364 Vali Loss: 0.753 Vali Acc: 0.500 Test Loss: 0.753 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.994384288787842
Epoch: 6, Steps: 18 | Train Loss: 0.258 Vali Loss: 0.785 Vali Acc: 0.510 Test Loss: 0.785 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.216696739196777
Epoch: 7, Steps: 18 | Train Loss: 0.175 Vali Loss: 0.873 Vali Acc: 0.480 Test Loss: 0.873 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.523407936096191
Epoch: 8, Steps: 18 | Train Loss: 0.123 Vali Loss: 0.825 Vali Acc: 0.550 Test Loss: 0.825 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.27057957649231
Epoch: 9, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.994 Vali Acc: 0.510 Test Loss: 0.994 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.203691244125366
Epoch: 10, Steps: 18 | Train Loss: 0.036 Vali Loss: 1.040 Vali Acc: 0.530 Test Loss: 1.040 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.21320366859436
Epoch: 11, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.998 Vali Acc: 0.530 Test Loss: 0.998 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.317989349365234
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.000 Vali Acc: 0.550 Test Loss: 1.000 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.449404716491699
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.001 Vali Acc: 0.550 Test Loss: 1.001 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9620450
model size : 36.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.666601657867432
Epoch: 1, Steps: 18 | Train Loss: 0.728 Vali Loss: 0.705 Vali Acc: 0.470 Test Loss: 0.705 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 4.178955793380737
Epoch: 2, Steps: 18 | Train Loss: 0.663 Vali Loss: 0.720 Vali Acc: 0.460 Test Loss: 0.720 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.368488073348999
Epoch: 3, Steps: 18 | Train Loss: 0.566 Vali Loss: 0.705 Vali Acc: 0.480 Test Loss: 0.705 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479993).  Saving model ...
Epoch: 4 cost time: 4.180368661880493
Epoch: 4, Steps: 18 | Train Loss: 0.472 Vali Loss: 0.750 Vali Acc: 0.500 Test Loss: 0.750 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 5 cost time: 4.5006914138793945
Epoch: 5, Steps: 18 | Train Loss: 0.402 Vali Loss: 0.749 Vali Acc: 0.460 Test Loss: 0.749 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.527525424957275
Epoch: 6, Steps: 18 | Train Loss: 0.307 Vali Loss: 0.740 Vali Acc: 0.470 Test Loss: 0.740 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.333787202835083
Epoch: 7, Steps: 18 | Train Loss: 0.227 Vali Loss: 0.769 Vali Acc: 0.490 Test Loss: 0.769 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.212893009185791
Epoch: 8, Steps: 18 | Train Loss: 0.143 Vali Loss: 0.840 Vali Acc: 0.450 Test Loss: 0.840 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.270670652389526
Epoch: 9, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.945 Vali Acc: 0.480 Test Loss: 0.945 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.913459539413452
Epoch: 10, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.941 Vali Acc: 0.480 Test Loss: 0.941 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.069231986999512
Epoch: 11, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.008 Vali Acc: 0.490 Test Loss: 1.008 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.172168731689453
Epoch: 12, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.071 Vali Acc: 0.460 Test Loss: 1.071 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.287781238555908
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.045 Vali Acc: 0.480 Test Loss: 1.045 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.360609292984009
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.109 Vali Acc: 0.440 Test Loss: 1.109 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 9608866
model size : 36.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.585907697677612
Epoch: 1, Steps: 18 | Train Loss: 0.715 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 3.5028514862060547
Epoch: 2, Steps: 18 | Train Loss: 0.663 Vali Loss: 0.757 Vali Acc: 0.460 Test Loss: 0.757 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4853549003601074
Epoch: 3, Steps: 18 | Train Loss: 0.602 Vali Loss: 0.701 Vali Acc: 0.540 Test Loss: 0.701 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 3.5028862953186035
Epoch: 4, Steps: 18 | Train Loss: 0.521 Vali Loss: 0.718 Vali Acc: 0.510 Test Loss: 0.718 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.506831407546997
Epoch: 5, Steps: 18 | Train Loss: 0.432 Vali Loss: 0.705 Vali Acc: 0.510 Test Loss: 0.705 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.433077573776245
Epoch: 6, Steps: 18 | Train Loss: 0.363 Vali Loss: 0.738 Vali Acc: 0.510 Test Loss: 0.738 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6032047271728516
Epoch: 7, Steps: 18 | Train Loss: 0.282 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.505466938018799
Epoch: 8, Steps: 18 | Train Loss: 0.204 Vali Loss: 0.795 Vali Acc: 0.470 Test Loss: 0.795 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.4395546913146973
Epoch: 9, Steps: 18 | Train Loss: 0.141 Vali Loss: 0.841 Vali Acc: 0.440 Test Loss: 0.841 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.49088716506958
Epoch: 10, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.876 Vali Acc: 0.480 Test Loss: 0.876 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.386362314224243
Epoch: 11, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.919 Vali Acc: 0.490 Test Loss: 0.919 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.565227746963501
Epoch: 12, Steps: 18 | Train Loss: 0.029 Vali Loss: 1.037 Vali Acc: 0.500 Test Loss: 1.037 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.507502317428589
Epoch: 13, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.043 Vali Acc: 0.460 Test Loss: 1.043 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 9597282
model size : 36.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 16.02648162841797
Epoch: 1, Steps: 18 | Train Loss: 1.262 Vali Loss: 0.802 Vali Acc: 0.490 Test Loss: 0.802 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 14.803972482681274
Epoch: 2, Steps: 18 | Train Loss: 0.657 Vali Loss: 1.782 Vali Acc: 0.560 Test Loss: 1.782 Test Acc: 0.560
Validation loss decreased (-0.489992 --> -0.559982).  Saving model ...
Epoch: 3 cost time: 14.863189220428467
Epoch: 3, Steps: 18 | Train Loss: 0.677 Vali Loss: 1.629 Vali Acc: 0.530 Test Loss: 1.629 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.824359655380249
Epoch: 4, Steps: 18 | Train Loss: 0.433 Vali Loss: 1.337 Vali Acc: 0.510 Test Loss: 1.337 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.902632236480713
Epoch: 5, Steps: 18 | Train Loss: 0.359 Vali Loss: 2.316 Vali Acc: 0.430 Test Loss: 2.316 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 14.783933877944946
Epoch: 6, Steps: 18 | Train Loss: 0.288 Vali Loss: 3.681 Vali Acc: 0.530 Test Loss: 3.681 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 14.681007385253906
Epoch: 7, Steps: 18 | Train Loss: 0.212 Vali Loss: 3.001 Vali Acc: 0.530 Test Loss: 3.001 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 14.82905888557434
Epoch: 8, Steps: 18 | Train Loss: 0.095 Vali Loss: 2.779 Vali Acc: 0.560 Test Loss: 2.779 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 15.006647825241089
Epoch: 9, Steps: 18 | Train Loss: 0.587 Vali Loss: 3.061 Vali Acc: 0.510 Test Loss: 3.061 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 14.760953187942505
Epoch: 10, Steps: 18 | Train Loss: 0.148 Vali Loss: 2.576 Vali Acc: 0.560 Test Loss: 2.576 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 14.96155047416687
Epoch: 11, Steps: 18 | Train Loss: 0.109 Vali Loss: 5.701 Vali Acc: 0.450 Test Loss: 5.701 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 15.029166221618652
Epoch: 12, Steps: 18 | Train Loss: 0.141 Vali Loss: 4.225 Vali Acc: 0.440 Test Loss: 4.225 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 29305858
model size : 112.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.02672266960144
Epoch: 1, Steps: 18 | Train Loss: 0.816 Vali Loss: 1.232 Vali Acc: 0.530 Test Loss: 1.232 Test Acc: 0.530
Validation loss decreased (inf --> -0.529988).  Saving model ...
Epoch: 2 cost time: 8.84213399887085
Epoch: 2, Steps: 18 | Train Loss: 0.746 Vali Loss: 0.862 Vali Acc: 0.590 Test Loss: 0.862 Test Acc: 0.590
Validation loss decreased (-0.529988 --> -0.589991).  Saving model ...
Epoch: 3 cost time: 8.744609594345093
Epoch: 3, Steps: 18 | Train Loss: 0.510 Vali Loss: 1.156 Vali Acc: 0.510 Test Loss: 1.156 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.014304876327515
Epoch: 4, Steps: 18 | Train Loss: 0.358 Vali Loss: 1.236 Vali Acc: 0.410 Test Loss: 1.236 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.984410524368286
Epoch: 5, Steps: 18 | Train Loss: 0.191 Vali Loss: 1.524 Vali Acc: 0.620 Test Loss: 1.524 Test Acc: 0.620
Validation loss decreased (-0.589991 --> -0.619985).  Saving model ...
Epoch: 6 cost time: 9.012479782104492
Epoch: 6, Steps: 18 | Train Loss: 0.175 Vali Loss: 1.882 Vali Acc: 0.490 Test Loss: 1.882 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.429059267044067
Epoch: 7, Steps: 18 | Train Loss: 0.139 Vali Loss: 2.230 Vali Acc: 0.480 Test Loss: 2.230 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.953289985656738
Epoch: 8, Steps: 18 | Train Loss: 0.139 Vali Loss: 1.859 Vali Acc: 0.590 Test Loss: 1.859 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.439809322357178
Epoch: 9, Steps: 18 | Train Loss: 0.038 Vali Loss: 2.060 Vali Acc: 0.610 Test Loss: 2.060 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.768374919891357
Epoch: 10, Steps: 18 | Train Loss: 0.033 Vali Loss: 2.623 Vali Acc: 0.480 Test Loss: 2.623 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.328262329101562
Epoch: 11, Steps: 18 | Train Loss: 0.100 Vali Loss: 2.166 Vali Acc: 0.500 Test Loss: 2.166 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.513852596282959
Epoch: 12, Steps: 18 | Train Loss: 0.318 Vali Loss: 2.515 Vali Acc: 0.520 Test Loss: 2.515 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.448630809783936
Epoch: 13, Steps: 18 | Train Loss: 0.186 Vali Loss: 3.951 Vali Acc: 0.490 Test Loss: 3.951 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.385658740997314
Epoch: 14, Steps: 18 | Train Loss: 0.069 Vali Loss: 5.614 Vali Acc: 0.470 Test Loss: 5.614 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.817067384719849
Epoch: 15, Steps: 18 | Train Loss: 0.200 Vali Loss: 5.208 Vali Acc: 0.530 Test Loss: 5.208 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 28692866
model size : 109.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.531689405441284
Epoch: 1, Steps: 18 | Train Loss: 0.770 Vali Loss: 0.769 Vali Acc: 0.470 Test Loss: 0.769 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 10.215075731277466
Epoch: 2, Steps: 18 | Train Loss: 0.764 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
Validation loss decreased (-0.469992 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 10.68310260772705
Epoch: 3, Steps: 18 | Train Loss: 0.501 Vali Loss: 1.011 Vali Acc: 0.530 Test Loss: 1.011 Test Acc: 0.530
Validation loss decreased (-0.489992 --> -0.529990).  Saving model ...
Epoch: 4 cost time: 10.044936656951904
Epoch: 4, Steps: 18 | Train Loss: 0.317 Vali Loss: 1.088 Vali Acc: 0.490 Test Loss: 1.088 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.205769538879395
Epoch: 5, Steps: 18 | Train Loss: 0.157 Vali Loss: 1.115 Vali Acc: 0.560 Test Loss: 1.115 Test Acc: 0.560
Validation loss decreased (-0.529990 --> -0.559989).  Saving model ...
Epoch: 6 cost time: 10.621588468551636
Epoch: 6, Steps: 18 | Train Loss: 0.148 Vali Loss: 1.341 Vali Acc: 0.510 Test Loss: 1.341 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.015580654144287
Epoch: 7, Steps: 18 | Train Loss: 0.114 Vali Loss: 1.506 Vali Acc: 0.500 Test Loss: 1.506 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.398544549942017
Epoch: 8, Steps: 18 | Train Loss: 0.038 Vali Loss: 1.432 Vali Acc: 0.500 Test Loss: 1.432 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.858546495437622
Epoch: 9, Steps: 18 | Train Loss: 0.069 Vali Loss: 2.057 Vali Acc: 0.510 Test Loss: 2.057 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.028571844100952
Epoch: 10, Steps: 18 | Train Loss: 0.231 Vali Loss: 1.843 Vali Acc: 0.460 Test Loss: 1.843 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.321804761886597
Epoch: 11, Steps: 18 | Train Loss: 0.163 Vali Loss: 2.117 Vali Acc: 0.490 Test Loss: 2.117 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.681162595748901
Epoch: 12, Steps: 18 | Train Loss: 0.100 Vali Loss: 2.449 Vali Acc: 0.570 Test Loss: 2.449 Test Acc: 0.570
Validation loss decreased (-0.559989 --> -0.569976).  Saving model ...
Epoch: 13 cost time: 10.160451650619507
Epoch: 13, Steps: 18 | Train Loss: 0.163 Vali Loss: 3.488 Vali Acc: 0.470 Test Loss: 3.488 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.72293496131897
Epoch: 14, Steps: 18 | Train Loss: 0.190 Vali Loss: 3.925 Vali Acc: 0.450 Test Loss: 3.925 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.452061653137207
Epoch: 15, Steps: 18 | Train Loss: 0.303 Vali Loss: 4.064 Vali Acc: 0.460 Test Loss: 4.064 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 10.281521081924438
Epoch: 16, Steps: 18 | Train Loss: 0.125 Vali Loss: 4.808 Vali Acc: 0.430 Test Loss: 4.808 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 10.731271505355835
Epoch: 17, Steps: 18 | Train Loss: 0.223 Vali Loss: 3.466 Vali Acc: 0.520 Test Loss: 3.466 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 10.392676830291748
Epoch: 18, Steps: 18 | Train Loss: 0.239 Vali Loss: 2.696 Vali Acc: 0.510 Test Loss: 2.696 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 10.22273302078247
Epoch: 19, Steps: 18 | Train Loss: 0.073 Vali Loss: 2.782 Vali Acc: 0.530 Test Loss: 2.782 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 10.834807634353638
Epoch: 20, Steps: 18 | Train Loss: 0.075 Vali Loss: 5.406 Vali Acc: 0.460 Test Loss: 5.406 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 10.239763736724854
Epoch: 21, Steps: 18 | Train Loss: 0.035 Vali Loss: 5.529 Vali Acc: 0.450 Test Loss: 5.529 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 10.422139167785645
Epoch: 22, Steps: 18 | Train Loss: 0.042 Vali Loss: 5.711 Vali Acc: 0.430 Test Loss: 5.711 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 28473090
model size : 109.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.082484245300293
Epoch: 1, Steps: 18 | Train Loss: 0.790 Vali Loss: 0.870 Vali Acc: 0.600 Test Loss: 0.870 Test Acc: 0.600
Validation loss decreased (inf --> -0.599991).  Saving model ...
Epoch: 2 cost time: 8.048489809036255
Epoch: 2, Steps: 18 | Train Loss: 0.701 Vali Loss: 1.018 Vali Acc: 0.510 Test Loss: 1.018 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.845102071762085
Epoch: 3, Steps: 18 | Train Loss: 0.449 Vali Loss: 0.950 Vali Acc: 0.520 Test Loss: 0.950 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.975144863128662
Epoch: 4, Steps: 18 | Train Loss: 0.323 Vali Loss: 1.149 Vali Acc: 0.540 Test Loss: 1.149 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.08485198020935
Epoch: 5, Steps: 18 | Train Loss: 0.293 Vali Loss: 1.224 Vali Acc: 0.590 Test Loss: 1.224 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.084786176681519
Epoch: 6, Steps: 18 | Train Loss: 0.186 Vali Loss: 1.112 Vali Acc: 0.520 Test Loss: 1.112 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.508475065231323
Epoch: 7, Steps: 18 | Train Loss: 0.109 Vali Loss: 1.420 Vali Acc: 0.510 Test Loss: 1.420 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 8.120296478271484
Epoch: 8, Steps: 18 | Train Loss: 0.127 Vali Loss: 1.428 Vali Acc: 0.520 Test Loss: 1.428 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.682711839675903
Epoch: 9, Steps: 18 | Train Loss: 0.058 Vali Loss: 2.388 Vali Acc: 0.530 Test Loss: 2.388 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 8.391289710998535
Epoch: 10, Steps: 18 | Train Loss: 0.058 Vali Loss: 2.085 Vali Acc: 0.480 Test Loss: 2.085 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 8.590046882629395
Epoch: 11, Steps: 18 | Train Loss: 0.148 Vali Loss: 2.553 Vali Acc: 0.460 Test Loss: 2.553 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 28384386
model size : 108.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.559515476226807
Epoch: 1, Steps: 18 | Train Loss: 0.776 Vali Loss: 0.757 Vali Acc: 0.480 Test Loss: 0.757 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 7.90464973449707
Epoch: 2, Steps: 18 | Train Loss: 0.653 Vali Loss: 0.763 Vali Acc: 0.520 Test Loss: 0.763 Test Acc: 0.520
Validation loss decreased (-0.479992 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 8.561575889587402
Epoch: 3, Steps: 18 | Train Loss: 0.527 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 7.908623218536377
Epoch: 4, Steps: 18 | Train Loss: 0.354 Vali Loss: 0.957 Vali Acc: 0.480 Test Loss: 0.957 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.240484476089478
Epoch: 5, Steps: 18 | Train Loss: 0.223 Vali Loss: 0.872 Vali Acc: 0.480 Test Loss: 0.872 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.950993537902832
Epoch: 6, Steps: 18 | Train Loss: 0.169 Vali Loss: 0.898 Vali Acc: 0.530 Test Loss: 0.898 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529991).  Saving model ...
Epoch: 7 cost time: 8.149394273757935
Epoch: 7, Steps: 18 | Train Loss: 0.121 Vali Loss: 1.248 Vali Acc: 0.500 Test Loss: 1.248 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.039836406707764
Epoch: 8, Steps: 18 | Train Loss: 0.067 Vali Loss: 1.269 Vali Acc: 0.510 Test Loss: 1.269 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.07119083404541
Epoch: 9, Steps: 18 | Train Loss: 0.065 Vali Loss: 1.625 Vali Acc: 0.560 Test Loss: 1.625 Test Acc: 0.560
Validation loss decreased (-0.529991 --> -0.559984).  Saving model ...
Epoch: 10 cost time: 8.142662048339844
Epoch: 10, Steps: 18 | Train Loss: 0.179 Vali Loss: 1.469 Vali Acc: 0.460 Test Loss: 1.469 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.119929790496826
Epoch: 11, Steps: 18 | Train Loss: 0.085 Vali Loss: 1.796 Vali Acc: 0.480 Test Loss: 1.796 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.970800161361694
Epoch: 12, Steps: 18 | Train Loss: 0.064 Vali Loss: 1.933 Vali Acc: 0.520 Test Loss: 1.933 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.07250189781189
Epoch: 13, Steps: 18 | Train Loss: 0.192 Vali Loss: 1.511 Vali Acc: 0.510 Test Loss: 1.511 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.921463489532471
Epoch: 14, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.646 Vali Acc: 0.470 Test Loss: 1.646 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.043209314346313
Epoch: 15, Steps: 18 | Train Loss: 0.105 Vali Loss: 2.756 Vali Acc: 0.470 Test Loss: 2.756 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 8.073714017868042
Epoch: 16, Steps: 18 | Train Loss: 0.066 Vali Loss: 2.866 Vali Acc: 0.500 Test Loss: 2.866 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.789842128753662
Epoch: 17, Steps: 18 | Train Loss: 0.056 Vali Loss: 2.502 Vali Acc: 0.490 Test Loss: 2.502 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 8.350102186203003
Epoch: 18, Steps: 18 | Train Loss: 0.293 Vali Loss: 2.343 Vali Acc: 0.490 Test Loss: 2.343 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.656102895736694
Epoch: 19, Steps: 18 | Train Loss: 0.147 Vali Loss: 3.205 Vali Acc: 0.500 Test Loss: 3.205 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 28305282
model size : 108.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.37911319732666
Epoch: 1, Steps: 18 | Train Loss: 0.748 Vali Loss: 0.759 Vali Acc: 0.460 Test Loss: 0.759 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 7.855956792831421
Epoch: 2, Steps: 18 | Train Loss: 0.611 Vali Loss: 0.727 Vali Acc: 0.570 Test Loss: 0.727 Test Acc: 0.570
Validation loss decreased (-0.459992 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 8.403784275054932
Epoch: 3, Steps: 18 | Train Loss: 0.488 Vali Loss: 0.774 Vali Acc: 0.480 Test Loss: 0.774 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.5500102043151855
Epoch: 4, Steps: 18 | Train Loss: 0.367 Vali Loss: 0.865 Vali Acc: 0.500 Test Loss: 0.865 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.622519254684448
Epoch: 5, Steps: 18 | Train Loss: 0.261 Vali Loss: 0.870 Vali Acc: 0.510 Test Loss: 0.870 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.597604513168335
Epoch: 6, Steps: 18 | Train Loss: 0.184 Vali Loss: 1.075 Vali Acc: 0.570 Test Loss: 1.075 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.139721632003784
Epoch: 7, Steps: 18 | Train Loss: 0.081 Vali Loss: 1.160 Vali Acc: 0.540 Test Loss: 1.160 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.834782838821411
Epoch: 8, Steps: 18 | Train Loss: 0.068 Vali Loss: 1.236 Vali Acc: 0.520 Test Loss: 1.236 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.277270317077637
Epoch: 9, Steps: 18 | Train Loss: 0.077 Vali Loss: 1.346 Vali Acc: 0.520 Test Loss: 1.346 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.78580117225647
Epoch: 10, Steps: 18 | Train Loss: 0.057 Vali Loss: 1.418 Vali Acc: 0.470 Test Loss: 1.418 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 8.485745906829834
Epoch: 11, Steps: 18 | Train Loss: 0.050 Vali Loss: 1.857 Vali Acc: 0.540 Test Loss: 1.857 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.750610828399658
Epoch: 12, Steps: 18 | Train Loss: 0.071 Vali Loss: 1.439 Vali Acc: 0.480 Test Loss: 1.439 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 28258946
model size : 108.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.0090577602386475
Epoch: 1, Steps: 18 | Train Loss: 0.742 Vali Loss: 0.757 Vali Acc: 0.420 Test Loss: 0.757 Test Acc: 0.420
Validation loss decreased (inf --> -0.419992).  Saving model ...
Epoch: 2 cost time: 5.482558727264404
Epoch: 2, Steps: 18 | Train Loss: 0.728 Vali Loss: 0.852 Vali Acc: 0.510 Test Loss: 0.852 Test Acc: 0.510
Validation loss decreased (-0.419992 --> -0.509991).  Saving model ...
Epoch: 3 cost time: 5.630576133728027
Epoch: 3, Steps: 18 | Train Loss: 0.566 Vali Loss: 0.807 Vali Acc: 0.480 Test Loss: 0.807 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.975766181945801
Epoch: 4, Steps: 18 | Train Loss: 0.462 Vali Loss: 0.854 Vali Acc: 0.510 Test Loss: 0.854 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.62393045425415
Epoch: 5, Steps: 18 | Train Loss: 0.294 Vali Loss: 0.826 Vali Acc: 0.540 Test Loss: 0.826 Test Acc: 0.540
Validation loss decreased (-0.509991 --> -0.539992).  Saving model ...
Epoch: 6 cost time: 5.6442248821258545
Epoch: 6, Steps: 18 | Train Loss: 0.234 Vali Loss: 0.952 Vali Acc: 0.500 Test Loss: 0.952 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.740025758743286
Epoch: 7, Steps: 18 | Train Loss: 0.218 Vali Loss: 0.976 Vali Acc: 0.550 Test Loss: 0.976 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549990).  Saving model ...
Epoch: 8 cost time: 5.341880798339844
Epoch: 8, Steps: 18 | Train Loss: 0.139 Vali Loss: 1.340 Vali Acc: 0.540 Test Loss: 1.340 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.5881524085998535
Epoch: 9, Steps: 18 | Train Loss: 0.191 Vali Loss: 1.678 Vali Acc: 0.520 Test Loss: 1.678 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.593838453292847
Epoch: 10, Steps: 18 | Train Loss: 0.156 Vali Loss: 1.238 Vali Acc: 0.480 Test Loss: 1.238 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.497689723968506
Epoch: 11, Steps: 18 | Train Loss: 0.043 Vali Loss: 1.296 Vali Acc: 0.490 Test Loss: 1.296 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.780358791351318
Epoch: 12, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.370 Vali Acc: 0.520 Test Loss: 1.370 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.566759347915649
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.426 Vali Acc: 0.510 Test Loss: 1.426 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.339232921600342
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.505 Vali Acc: 0.520 Test Loss: 1.505 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.966911792755127
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.467 Vali Acc: 0.490 Test Loss: 1.467 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.405631065368652
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.579 Vali Acc: 0.480 Test Loss: 1.579 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.266727685928345
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.562 Vali Acc: 0.490 Test Loss: 1.562 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 28245378
model size : 108.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.696438312530518
Epoch: 1, Steps: 18 | Train Loss: 0.843 Vali Loss: 0.793 Vali Acc: 0.490 Test Loss: 0.793 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 7.527541637420654
Epoch: 2, Steps: 18 | Train Loss: 0.706 Vali Loss: 0.943 Vali Acc: 0.500 Test Loss: 0.943 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499991).  Saving model ...
Epoch: 3 cost time: 7.323815822601318
Epoch: 3, Steps: 18 | Train Loss: 0.689 Vali Loss: 1.403 Vali Acc: 0.540 Test Loss: 1.403 Test Acc: 0.540
Validation loss decreased (-0.499991 --> -0.539986).  Saving model ...
Epoch: 4 cost time: 6.682936429977417
Epoch: 4, Steps: 18 | Train Loss: 0.459 Vali Loss: 1.004 Vali Acc: 0.530 Test Loss: 1.004 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.467615604400635
Epoch: 5, Steps: 18 | Train Loss: 0.240 Vali Loss: 1.423 Vali Acc: 0.500 Test Loss: 1.423 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.670156478881836
Epoch: 6, Steps: 18 | Train Loss: 0.199 Vali Loss: 1.800 Vali Acc: 0.490 Test Loss: 1.800 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.78345251083374
Epoch: 7, Steps: 18 | Train Loss: 0.251 Vali Loss: 2.860 Vali Acc: 0.410 Test Loss: 2.860 Test Acc: 0.410
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.031598091125488
Epoch: 8, Steps: 18 | Train Loss: 0.056 Vali Loss: 1.819 Vali Acc: 0.470 Test Loss: 1.819 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.907198667526245
Epoch: 9, Steps: 18 | Train Loss: 0.021 Vali Loss: 2.039 Vali Acc: 0.480 Test Loss: 2.039 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.001744508743286
Epoch: 10, Steps: 18 | Train Loss: 0.029 Vali Loss: 1.969 Vali Acc: 0.520 Test Loss: 1.969 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.743310451507568
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 2.127 Vali Acc: 0.490 Test Loss: 2.127 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.380914688110352
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 3.650 Vali Acc: 0.430 Test Loss: 3.650 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.799259185791016
Epoch: 13, Steps: 18 | Train Loss: 0.019 Vali Loss: 2.110 Vali Acc: 0.510 Test Loss: 2.110 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 9393666
model size : 36.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.85303807258606
Epoch: 1, Steps: 18 | Train Loss: 0.755 Vali Loss: 0.817 Vali Acc: 0.440 Test Loss: 0.817 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 4.669093370437622
Epoch: 2, Steps: 18 | Train Loss: 0.667 Vali Loss: 0.963 Vali Acc: 0.570 Test Loss: 0.963 Test Acc: 0.570
Validation loss decreased (-0.439992 --> -0.569990).  Saving model ...
Epoch: 3 cost time: 4.67444372177124
Epoch: 3, Steps: 18 | Train Loss: 0.515 Vali Loss: 0.885 Vali Acc: 0.500 Test Loss: 0.885 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.423041820526123
Epoch: 4, Steps: 18 | Train Loss: 0.359 Vali Loss: 0.939 Vali Acc: 0.490 Test Loss: 0.939 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.157020330429077
Epoch: 5, Steps: 18 | Train Loss: 0.189 Vali Loss: 1.100 Vali Acc: 0.520 Test Loss: 1.100 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.5089685916900635
Epoch: 6, Steps: 18 | Train Loss: 0.114 Vali Loss: 1.473 Vali Acc: 0.520 Test Loss: 1.473 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.71472430229187
Epoch: 7, Steps: 18 | Train Loss: 0.039 Vali Loss: 1.607 Vali Acc: 0.470 Test Loss: 1.607 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.356765985488892
Epoch: 8, Steps: 18 | Train Loss: 0.054 Vali Loss: 1.844 Vali Acc: 0.440 Test Loss: 1.844 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.2636778354644775
Epoch: 9, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.646 Vali Acc: 0.540 Test Loss: 1.646 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.769298791885376
Epoch: 10, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.620 Vali Acc: 0.530 Test Loss: 1.620 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.29191255569458
Epoch: 11, Steps: 18 | Train Loss: 0.015 Vali Loss: 2.436 Vali Acc: 0.490 Test Loss: 2.436 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.357041120529175
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 2.045 Vali Acc: 0.490 Test Loss: 2.045 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9087170
model size : 34.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.763175964355469
Epoch: 1, Steps: 18 | Train Loss: 0.782 Vali Loss: 0.750 Vali Acc: 0.440 Test Loss: 0.750 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 5.191482305526733
Epoch: 2, Steps: 18 | Train Loss: 0.698 Vali Loss: 0.735 Vali Acc: 0.550 Test Loss: 0.735 Test Acc: 0.550
Validation loss decreased (-0.439992 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 5.638093948364258
Epoch: 3, Steps: 18 | Train Loss: 0.527 Vali Loss: 0.856 Vali Acc: 0.530 Test Loss: 0.856 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.52382230758667
Epoch: 4, Steps: 18 | Train Loss: 0.377 Vali Loss: 0.818 Vali Acc: 0.540 Test Loss: 0.818 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.234735488891602
Epoch: 5, Steps: 18 | Train Loss: 0.273 Vali Loss: 1.010 Vali Acc: 0.480 Test Loss: 1.010 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.356173992156982
Epoch: 6, Steps: 18 | Train Loss: 0.151 Vali Loss: 1.033 Vali Acc: 0.530 Test Loss: 1.033 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.196500062942505
Epoch: 7, Steps: 18 | Train Loss: 0.077 Vali Loss: 1.228 Vali Acc: 0.490 Test Loss: 1.228 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.404346942901611
Epoch: 8, Steps: 18 | Train Loss: 0.034 Vali Loss: 1.240 Vali Acc: 0.520 Test Loss: 1.240 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.177335023880005
Epoch: 9, Steps: 18 | Train Loss: 0.048 Vali Loss: 1.491 Vali Acc: 0.490 Test Loss: 1.491 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.146417856216431
Epoch: 10, Steps: 18 | Train Loss: 0.033 Vali Loss: 1.591 Vali Acc: 0.540 Test Loss: 1.591 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.636295795440674
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.595 Vali Acc: 0.480 Test Loss: 1.595 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.331830978393555
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.748 Vali Acc: 0.490 Test Loss: 1.748 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 8977282
model size : 34.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.878387451171875
Epoch: 1, Steps: 18 | Train Loss: 0.752 Vali Loss: 0.712 Vali Acc: 0.590 Test Loss: 0.712 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 4.703320503234863
Epoch: 2, Steps: 18 | Train Loss: 0.625 Vali Loss: 0.737 Vali Acc: 0.530 Test Loss: 0.737 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.465486526489258
Epoch: 3, Steps: 18 | Train Loss: 0.501 Vali Loss: 0.803 Vali Acc: 0.460 Test Loss: 0.803 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.46807861328125
Epoch: 4, Steps: 18 | Train Loss: 0.395 Vali Loss: 0.798 Vali Acc: 0.520 Test Loss: 0.798 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.604291677474976
Epoch: 5, Steps: 18 | Train Loss: 0.248 Vali Loss: 0.893 Vali Acc: 0.480 Test Loss: 0.893 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.497786521911621
Epoch: 6, Steps: 18 | Train Loss: 0.140 Vali Loss: 1.098 Vali Acc: 0.470 Test Loss: 1.098 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.407992601394653
Epoch: 7, Steps: 18 | Train Loss: 0.093 Vali Loss: 1.097 Vali Acc: 0.470 Test Loss: 1.097 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.214424133300781
Epoch: 8, Steps: 18 | Train Loss: 0.047 Vali Loss: 1.160 Vali Acc: 0.470 Test Loss: 1.160 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.029101848602295
Epoch: 9, Steps: 18 | Train Loss: 0.032 Vali Loss: 1.242 Vali Acc: 0.510 Test Loss: 1.242 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.402458667755127
Epoch: 10, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.261 Vali Acc: 0.490 Test Loss: 1.261 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.672231674194336
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.379 Vali Acc: 0.480 Test Loss: 1.379 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 8932930
model size : 34.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.260993242263794
Epoch: 1, Steps: 18 | Train Loss: 0.719 Vali Loss: 0.747 Vali Acc: 0.490 Test Loss: 0.747 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 4.754528999328613
Epoch: 2, Steps: 18 | Train Loss: 0.678 Vali Loss: 0.830 Vali Acc: 0.530 Test Loss: 0.830 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 4.966541051864624
Epoch: 3, Steps: 18 | Train Loss: 0.537 Vali Loss: 0.761 Vali Acc: 0.500 Test Loss: 0.761 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.6602842807769775
Epoch: 4, Steps: 18 | Train Loss: 0.401 Vali Loss: 0.851 Vali Acc: 0.530 Test Loss: 0.851 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.608400821685791
Epoch: 5, Steps: 18 | Train Loss: 0.310 Vali Loss: 0.893 Vali Acc: 0.510 Test Loss: 0.893 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.869365692138672
Epoch: 6, Steps: 18 | Train Loss: 0.222 Vali Loss: 0.862 Vali Acc: 0.490 Test Loss: 0.862 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.549411296844482
Epoch: 7, Steps: 18 | Train Loss: 0.186 Vali Loss: 1.009 Vali Acc: 0.460 Test Loss: 1.009 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.799778938293457
Epoch: 8, Steps: 18 | Train Loss: 0.124 Vali Loss: 1.010 Vali Acc: 0.510 Test Loss: 1.010 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.525644302368164
Epoch: 9, Steps: 18 | Train Loss: 0.060 Vali Loss: 1.191 Vali Acc: 0.480 Test Loss: 1.191 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.558942556381226
Epoch: 10, Steps: 18 | Train Loss: 0.034 Vali Loss: 1.075 Vali Acc: 0.510 Test Loss: 1.075 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.860421895980835
Epoch: 11, Steps: 18 | Train Loss: 0.029 Vali Loss: 1.186 Vali Acc: 0.540 Test Loss: 1.186 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539988).  Saving model ...
Epoch: 12 cost time: 4.6258087158203125
Epoch: 12, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.299 Vali Acc: 0.460 Test Loss: 1.299 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.882181882858276
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.333 Vali Acc: 0.480 Test Loss: 1.333 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.779922962188721
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.340 Vali Acc: 0.470 Test Loss: 1.340 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.901504993438721
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.352 Vali Acc: 0.460 Test Loss: 1.352 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.776614427566528
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.380 Vali Acc: 0.480 Test Loss: 1.380 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.592731952667236
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.403 Vali Acc: 0.490 Test Loss: 1.403 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.669474124908447
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.419 Vali Acc: 0.470 Test Loss: 1.419 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.6755311489105225
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.440 Vali Acc: 0.450 Test Loss: 1.440 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.542862415313721
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.451 Vali Acc: 0.450 Test Loss: 1.451 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.923959732055664
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.447 Vali Acc: 0.450 Test Loss: 1.447 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 8893378
model size : 34.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.777836084365845
Epoch: 1, Steps: 18 | Train Loss: 0.725 Vali Loss: 0.725 Vali Acc: 0.410 Test Loss: 0.725 Test Acc: 0.410
Validation loss decreased (inf --> -0.409993).  Saving model ...
Epoch: 2 cost time: 4.626017808914185
Epoch: 2, Steps: 18 | Train Loss: 0.661 Vali Loss: 0.709 Vali Acc: 0.480 Test Loss: 0.709 Test Acc: 0.480
Validation loss decreased (-0.409993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 4.604984283447266
Epoch: 3, Steps: 18 | Train Loss: 0.570 Vali Loss: 0.747 Vali Acc: 0.480 Test Loss: 0.747 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.603606462478638
Epoch: 4, Steps: 18 | Train Loss: 0.466 Vali Loss: 0.733 Vali Acc: 0.580 Test Loss: 0.733 Test Acc: 0.580
Validation loss decreased (-0.479993 --> -0.579993).  Saving model ...
Epoch: 5 cost time: 4.477320194244385
Epoch: 5, Steps: 18 | Train Loss: 0.367 Vali Loss: 0.771 Vali Acc: 0.500 Test Loss: 0.771 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.544676780700684
Epoch: 6, Steps: 18 | Train Loss: 0.243 Vali Loss: 0.778 Vali Acc: 0.590 Test Loss: 0.778 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589992).  Saving model ...
Epoch: 7 cost time: 4.678534507751465
Epoch: 7, Steps: 18 | Train Loss: 0.168 Vali Loss: 1.069 Vali Acc: 0.510 Test Loss: 1.069 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.333592653274536
Epoch: 8, Steps: 18 | Train Loss: 0.112 Vali Loss: 1.046 Vali Acc: 0.570 Test Loss: 1.046 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.500179290771484
Epoch: 9, Steps: 18 | Train Loss: 0.095 Vali Loss: 0.847 Vali Acc: 0.520 Test Loss: 0.847 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.401768684387207
Epoch: 10, Steps: 18 | Train Loss: 0.041 Vali Loss: 1.007 Vali Acc: 0.520 Test Loss: 1.007 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.5695178508758545
Epoch: 11, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.037 Vali Acc: 0.490 Test Loss: 1.037 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.589653015136719
Epoch: 12, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.268 Vali Acc: 0.540 Test Loss: 1.268 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.6050825119018555
Epoch: 13, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.153 Vali Acc: 0.520 Test Loss: 1.153 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.59296727180481
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.179 Vali Acc: 0.490 Test Loss: 1.179 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.770687580108643
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.191 Vali Acc: 0.490 Test Loss: 1.191 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.470010280609131
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 8870210
model size : 34.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.842225551605225
Epoch: 1, Steps: 18 | Train Loss: 0.711 Vali Loss: 0.723 Vali Acc: 0.600 Test Loss: 0.723 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 3.302924871444702
Epoch: 2, Steps: 18 | Train Loss: 0.692 Vali Loss: 0.734 Vali Acc: 0.540 Test Loss: 0.734 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5634663105010986
Epoch: 3, Steps: 18 | Train Loss: 0.593 Vali Loss: 0.712 Vali Acc: 0.520 Test Loss: 0.712 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.311492681503296
Epoch: 4, Steps: 18 | Train Loss: 0.484 Vali Loss: 0.971 Vali Acc: 0.570 Test Loss: 0.971 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.3409314155578613
Epoch: 5, Steps: 18 | Train Loss: 0.440 Vali Loss: 0.716 Vali Acc: 0.560 Test Loss: 0.716 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.190577268600464
Epoch: 6, Steps: 18 | Train Loss: 0.337 Vali Loss: 0.738 Vali Acc: 0.530 Test Loss: 0.738 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.008626699447632
Epoch: 7, Steps: 18 | Train Loss: 0.270 Vali Loss: 0.834 Vali Acc: 0.500 Test Loss: 0.834 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.2677290439605713
Epoch: 8, Steps: 18 | Train Loss: 0.206 Vali Loss: 0.934 Vali Acc: 0.540 Test Loss: 0.934 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.650254249572754
Epoch: 9, Steps: 18 | Train Loss: 0.196 Vali Loss: 0.838 Vali Acc: 0.520 Test Loss: 0.838 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.510603189468384
Epoch: 10, Steps: 18 | Train Loss: 0.101 Vali Loss: 1.198 Vali Acc: 0.570 Test Loss: 1.198 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.3173179626464844
Epoch: 11, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.986 Vali Acc: 0.500 Test Loss: 0.986 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 8863426
model size : 34.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.23761510848999
Epoch: 1, Steps: 18 | Train Loss: 0.797 Vali Loss: 0.797 Vali Acc: 0.600 Test Loss: 0.797 Test Acc: 0.600
Validation loss decreased (inf --> -0.599992).  Saving model ...
Epoch: 2 cost time: 2.968759775161743
Epoch: 2, Steps: 18 | Train Loss: 0.619 Vali Loss: 0.806 Vali Acc: 0.480 Test Loss: 0.806 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8655385971069336
Epoch: 3, Steps: 18 | Train Loss: 0.427 Vali Loss: 0.801 Vali Acc: 0.500 Test Loss: 0.801 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.1529150009155273
Epoch: 4, Steps: 18 | Train Loss: 0.226 Vali Loss: 1.023 Vali Acc: 0.510 Test Loss: 1.023 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8786792755126953
Epoch: 5, Steps: 18 | Train Loss: 0.143 Vali Loss: 1.174 Vali Acc: 0.490 Test Loss: 1.174 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.839078903198242
Epoch: 6, Steps: 18 | Train Loss: 0.122 Vali Loss: 1.825 Vali Acc: 0.460 Test Loss: 1.825 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.8789966106414795
Epoch: 7, Steps: 18 | Train Loss: 0.066 Vali Loss: 1.339 Vali Acc: 0.490 Test Loss: 1.339 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.0492491722106934
Epoch: 8, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.648 Vali Acc: 0.530 Test Loss: 1.648 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.1159255504608154
Epoch: 9, Steps: 18 | Train Loss: 0.032 Vali Loss: 1.710 Vali Acc: 0.420 Test Loss: 1.710 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.9553654193878174
Epoch: 10, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.795 Vali Acc: 0.480 Test Loss: 1.795 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.8793721199035645
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.783 Vali Acc: 0.450 Test Loss: 1.783 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 3382018
model size : 13.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.8046059608459473
Epoch: 1, Steps: 18 | Train Loss: 0.753 Vali Loss: 0.816 Vali Acc: 0.500 Test Loss: 0.816 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.7183916568756104
Epoch: 2, Steps: 18 | Train Loss: 0.685 Vali Loss: 0.902 Vali Acc: 0.530 Test Loss: 0.902 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529991).  Saving model ...
Epoch: 3 cost time: 2.5616798400878906
Epoch: 3, Steps: 18 | Train Loss: 0.586 Vali Loss: 0.753 Vali Acc: 0.570 Test Loss: 0.753 Test Acc: 0.570
Validation loss decreased (-0.529991 --> -0.569992).  Saving model ...
Epoch: 4 cost time: 2.307006597518921
Epoch: 4, Steps: 18 | Train Loss: 0.394 Vali Loss: 0.783 Vali Acc: 0.540 Test Loss: 0.783 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4937074184417725
Epoch: 5, Steps: 18 | Train Loss: 0.244 Vali Loss: 1.096 Vali Acc: 0.570 Test Loss: 1.096 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.448129653930664
Epoch: 6, Steps: 18 | Train Loss: 0.160 Vali Loss: 1.298 Vali Acc: 0.500 Test Loss: 1.298 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4188292026519775
Epoch: 7, Steps: 18 | Train Loss: 0.085 Vali Loss: 1.219 Vali Acc: 0.470 Test Loss: 1.219 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.403590679168701
Epoch: 8, Steps: 18 | Train Loss: 0.049 Vali Loss: 1.315 Vali Acc: 0.450 Test Loss: 1.315 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.4951722621917725
Epoch: 9, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.351 Vali Acc: 0.430 Test Loss: 1.351 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.5748445987701416
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.400 Vali Acc: 0.450 Test Loss: 1.400 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.384140968322754
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.392 Vali Acc: 0.450 Test Loss: 1.392 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.218662977218628
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.424 Vali Acc: 0.460 Test Loss: 1.424 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.378542900085449
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.440 Vali Acc: 0.470 Test Loss: 1.440 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3228770
model size : 12.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.216013431549072
Epoch: 1, Steps: 18 | Train Loss: 0.731 Vali Loss: 0.703 Vali Acc: 0.540 Test Loss: 0.703 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 3.02237868309021
Epoch: 2, Steps: 18 | Train Loss: 0.653 Vali Loss: 0.722 Vali Acc: 0.540 Test Loss: 0.722 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1441469192504883
Epoch: 3, Steps: 18 | Train Loss: 0.628 Vali Loss: 0.743 Vali Acc: 0.480 Test Loss: 0.743 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.9438328742980957
Epoch: 4, Steps: 18 | Train Loss: 0.441 Vali Loss: 0.723 Vali Acc: 0.550 Test Loss: 0.723 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 2.8781933784484863
Epoch: 5, Steps: 18 | Train Loss: 0.379 Vali Loss: 0.768 Vali Acc: 0.540 Test Loss: 0.768 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.04905366897583
Epoch: 6, Steps: 18 | Train Loss: 0.236 Vali Loss: 0.811 Vali Acc: 0.500 Test Loss: 0.811 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.168539047241211
Epoch: 7, Steps: 18 | Train Loss: 0.159 Vali Loss: 0.887 Vali Acc: 0.480 Test Loss: 0.887 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.056849718093872
Epoch: 8, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.901 Vali Acc: 0.530 Test Loss: 0.901 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.0134084224700928
Epoch: 9, Steps: 18 | Train Loss: 0.049 Vali Loss: 1.182 Vali Acc: 0.500 Test Loss: 1.182 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.955984115600586
Epoch: 10, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.082 Vali Acc: 0.520 Test Loss: 1.082 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.2462966442108154
Epoch: 11, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.153 Vali Acc: 0.500 Test Loss: 1.153 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.140946626663208
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.177 Vali Acc: 0.520 Test Loss: 1.177 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.121906042098999
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.248 Vali Acc: 0.510 Test Loss: 1.248 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.006094455718994
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.210 Vali Acc: 0.510 Test Loss: 1.210 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 3173826
model size : 12.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.104133129119873
Epoch: 1, Steps: 18 | Train Loss: 0.746 Vali Loss: 0.713 Vali Acc: 0.580 Test Loss: 0.713 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 2.9334867000579834
Epoch: 2, Steps: 18 | Train Loss: 0.686 Vali Loss: 0.762 Vali Acc: 0.510 Test Loss: 0.762 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8102169036865234
Epoch: 3, Steps: 18 | Train Loss: 0.587 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6854233741760254
Epoch: 4, Steps: 18 | Train Loss: 0.459 Vali Loss: 0.728 Vali Acc: 0.510 Test Loss: 0.728 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8124725818634033
Epoch: 5, Steps: 18 | Train Loss: 0.360 Vali Loss: 0.864 Vali Acc: 0.560 Test Loss: 0.864 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.868838310241699
Epoch: 6, Steps: 18 | Train Loss: 0.249 Vali Loss: 0.789 Vali Acc: 0.580 Test Loss: 0.789 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.8129100799560547
Epoch: 7, Steps: 18 | Train Loss: 0.163 Vali Loss: 0.793 Vali Acc: 0.520 Test Loss: 0.793 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.7009332180023193
Epoch: 8, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.921 Vali Acc: 0.560 Test Loss: 0.921 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.816770315170288
Epoch: 9, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.985 Vali Acc: 0.470 Test Loss: 0.985 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.7912700176239014
Epoch: 10, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.984 Vali Acc: 0.530 Test Loss: 0.984 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.8892276287078857
Epoch: 11, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.028 Vali Acc: 0.510 Test Loss: 1.028 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 3151650
model size : 12.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.301590442657471
Epoch: 1, Steps: 18 | Train Loss: 0.724 Vali Loss: 0.704 Vali Acc: 0.520 Test Loss: 0.704 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.921004056930542
Epoch: 2, Steps: 18 | Train Loss: 0.692 Vali Loss: 0.723 Vali Acc: 0.520 Test Loss: 0.723 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1600518226623535
Epoch: 3, Steps: 18 | Train Loss: 0.590 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.1062803268432617
Epoch: 4, Steps: 18 | Train Loss: 0.499 Vali Loss: 0.744 Vali Acc: 0.590 Test Loss: 0.744 Test Acc: 0.590
Validation loss decreased (-0.519993 --> -0.589993).  Saving model ...
Epoch: 5 cost time: 3.0474205017089844
Epoch: 5, Steps: 18 | Train Loss: 0.426 Vali Loss: 0.707 Vali Acc: 0.520 Test Loss: 0.707 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0516772270202637
Epoch: 6, Steps: 18 | Train Loss: 0.354 Vali Loss: 0.770 Vali Acc: 0.510 Test Loss: 0.770 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9396636486053467
Epoch: 7, Steps: 18 | Train Loss: 0.271 Vali Loss: 0.797 Vali Acc: 0.510 Test Loss: 0.797 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.9857935905456543
Epoch: 8, Steps: 18 | Train Loss: 0.185 Vali Loss: 0.836 Vali Acc: 0.460 Test Loss: 0.836 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.04927396774292
Epoch: 9, Steps: 18 | Train Loss: 0.116 Vali Loss: 0.853 Vali Acc: 0.500 Test Loss: 0.853 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.9599382877349854
Epoch: 10, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.885 Vali Acc: 0.500 Test Loss: 0.885 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.067681312561035
Epoch: 11, Steps: 18 | Train Loss: 0.060 Vali Loss: 1.011 Vali Acc: 0.500 Test Loss: 1.011 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.0459766387939453
Epoch: 12, Steps: 18 | Train Loss: 0.043 Vali Loss: 1.071 Vali Acc: 0.470 Test Loss: 1.071 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.030764579772949
Epoch: 13, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.086 Vali Acc: 0.490 Test Loss: 1.086 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.851921319961548
Epoch: 14, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.071 Vali Acc: 0.490 Test Loss: 1.071 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3131874
model size : 12.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.280149221420288
Epoch: 1, Steps: 18 | Train Loss: 0.720 Vali Loss: 0.724 Vali Acc: 0.550 Test Loss: 0.724 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.903850793838501
Epoch: 2, Steps: 18 | Train Loss: 0.669 Vali Loss: 0.747 Vali Acc: 0.580 Test Loss: 0.747 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579993).  Saving model ...
Epoch: 3 cost time: 2.7362494468688965
Epoch: 3, Steps: 18 | Train Loss: 0.608 Vali Loss: 0.716 Vali Acc: 0.530 Test Loss: 0.716 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.890786647796631
Epoch: 4, Steps: 18 | Train Loss: 0.558 Vali Loss: 0.723 Vali Acc: 0.550 Test Loss: 0.723 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5130021572113037
Epoch: 5, Steps: 18 | Train Loss: 0.461 Vali Loss: 0.767 Vali Acc: 0.490 Test Loss: 0.767 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.004041910171509
Epoch: 6, Steps: 18 | Train Loss: 0.395 Vali Loss: 0.758 Vali Acc: 0.560 Test Loss: 0.758 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.91814923286438
Epoch: 7, Steps: 18 | Train Loss: 0.376 Vali Loss: 0.718 Vali Acc: 0.540 Test Loss: 0.718 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.8365373611450195
Epoch: 8, Steps: 18 | Train Loss: 0.289 Vali Loss: 0.920 Vali Acc: 0.550 Test Loss: 0.920 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.8801279067993164
Epoch: 9, Steps: 18 | Train Loss: 0.227 Vali Loss: 0.850 Vali Acc: 0.510 Test Loss: 0.850 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.906691312789917
Epoch: 10, Steps: 18 | Train Loss: 0.154 Vali Loss: 0.889 Vali Acc: 0.500 Test Loss: 0.889 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.939591646194458
Epoch: 11, Steps: 18 | Train Loss: 0.096 Vali Loss: 0.876 Vali Acc: 0.550 Test Loss: 0.876 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.892645835876465
Epoch: 12, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.905 Vali Acc: 0.540 Test Loss: 0.905 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 3120290
model size : 12.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.6586639881134033
Epoch: 1, Steps: 18 | Train Loss: 0.710 Vali Loss: 0.738 Vali Acc: 0.420 Test Loss: 0.738 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 2.1935672760009766
Epoch: 2, Steps: 18 | Train Loss: 0.664 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
Validation loss decreased (-0.419993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 2.1394248008728027
Epoch: 3, Steps: 18 | Train Loss: 0.609 Vali Loss: 0.726 Vali Acc: 0.480 Test Loss: 0.726 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.040700912475586
Epoch: 4, Steps: 18 | Train Loss: 0.560 Vali Loss: 0.722 Vali Acc: 0.520 Test Loss: 0.722 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 5 cost time: 2.0874836444854736
Epoch: 5, Steps: 18 | Train Loss: 0.521 Vali Loss: 0.744 Vali Acc: 0.580 Test Loss: 0.744 Test Acc: 0.580
Validation loss decreased (-0.519993 --> -0.579993).  Saving model ...
Epoch: 6 cost time: 2.007970094680786
Epoch: 6, Steps: 18 | Train Loss: 0.441 Vali Loss: 0.816 Vali Acc: 0.540 Test Loss: 0.816 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2041308879852295
Epoch: 7, Steps: 18 | Train Loss: 0.387 Vali Loss: 0.722 Vali Acc: 0.520 Test Loss: 0.722 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1165108680725098
Epoch: 8, Steps: 18 | Train Loss: 0.329 Vali Loss: 0.871 Vali Acc: 0.500 Test Loss: 0.871 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.197403907775879
Epoch: 9, Steps: 18 | Train Loss: 0.253 Vali Loss: 0.813 Vali Acc: 0.490 Test Loss: 0.813 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0302720069885254
Epoch: 10, Steps: 18 | Train Loss: 0.193 Vali Loss: 0.904 Vali Acc: 0.540 Test Loss: 0.904 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0652458667755127
Epoch: 11, Steps: 18 | Train Loss: 0.144 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.1570425033569336
Epoch: 12, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.853 Vali Acc: 0.520 Test Loss: 0.853 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.1209990978240967
Epoch: 13, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.879 Vali Acc: 0.530 Test Loss: 0.879 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.082594633102417
Epoch: 14, Steps: 18 | Train Loss: 0.044 Vali Loss: 1.061 Vali Acc: 0.560 Test Loss: 1.061 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.2684872150421143
Epoch: 15, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.974 Vali Acc: 0.520 Test Loss: 0.974 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 3116898
model size : 12.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.463457822799683
Epoch: 1, Steps: 18 | Train Loss: 1.271 Vali Loss: 1.189 Vali Acc: 0.500 Test Loss: 1.189 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 16.285474061965942
Epoch: 2, Steps: 18 | Train Loss: 1.052 Vali Loss: 0.838 Vali Acc: 0.600 Test Loss: 0.838 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599992).  Saving model ...
Epoch: 3 cost time: 16.564700841903687
Epoch: 3, Steps: 18 | Train Loss: 0.690 Vali Loss: 1.768 Vali Acc: 0.490 Test Loss: 1.768 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.519285440444946
Epoch: 4, Steps: 18 | Train Loss: 0.326 Vali Loss: 1.839 Vali Acc: 0.450 Test Loss: 1.839 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 16.5757098197937
Epoch: 5, Steps: 18 | Train Loss: 0.243 Vali Loss: 3.217 Vali Acc: 0.440 Test Loss: 3.217 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 16.383938312530518
Epoch: 6, Steps: 18 | Train Loss: 0.237 Vali Loss: 2.735 Vali Acc: 0.440 Test Loss: 2.735 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 16.48392653465271
Epoch: 7, Steps: 18 | Train Loss: 0.149 Vali Loss: 3.552 Vali Acc: 0.450 Test Loss: 3.552 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 16.341649770736694
Epoch: 8, Steps: 18 | Train Loss: 0.267 Vali Loss: 4.165 Vali Acc: 0.440 Test Loss: 4.165 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 16.52849578857422
Epoch: 9, Steps: 18 | Train Loss: 0.134 Vali Loss: 3.562 Vali Acc: 0.460 Test Loss: 3.562 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 16.250566959381104
Epoch: 10, Steps: 18 | Train Loss: 0.163 Vali Loss: 3.450 Vali Acc: 0.480 Test Loss: 3.450 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 16.371593236923218
Epoch: 11, Steps: 18 | Train Loss: 0.112 Vali Loss: 5.374 Vali Acc: 0.410 Test Loss: 5.374 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 16.052212953567505
Epoch: 12, Steps: 18 | Train Loss: 0.138 Vali Loss: 4.723 Vali Acc: 0.440 Test Loss: 4.723 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 29207554
model size : 111.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.990105152130127
Epoch: 1, Steps: 18 | Train Loss: 0.817 Vali Loss: 0.989 Vali Acc: 0.430 Test Loss: 0.989 Test Acc: 0.430
Validation loss decreased (inf --> -0.429990).  Saving model ...
Epoch: 2 cost time: 9.430272102355957
Epoch: 2, Steps: 18 | Train Loss: 0.666 Vali Loss: 0.786 Vali Acc: 0.520 Test Loss: 0.786 Test Acc: 0.520
Validation loss decreased (-0.429990 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 9.888959407806396
Epoch: 3, Steps: 18 | Train Loss: 0.474 Vali Loss: 1.121 Vali Acc: 0.520 Test Loss: 1.121 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.410628318786621
Epoch: 4, Steps: 18 | Train Loss: 0.309 Vali Loss: 1.307 Vali Acc: 0.490 Test Loss: 1.307 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.682753086090088
Epoch: 5, Steps: 18 | Train Loss: 0.206 Vali Loss: 1.665 Vali Acc: 0.470 Test Loss: 1.665 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.7001051902771
Epoch: 6, Steps: 18 | Train Loss: 0.131 Vali Loss: 1.784 Vali Acc: 0.530 Test Loss: 1.784 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529982).  Saving model ...
Epoch: 7 cost time: 9.281193971633911
Epoch: 7, Steps: 18 | Train Loss: 0.163 Vali Loss: 2.057 Vali Acc: 0.390 Test Loss: 2.057 Test Acc: 0.390
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.877147197723389
Epoch: 8, Steps: 18 | Train Loss: 0.070 Vali Loss: 2.820 Vali Acc: 0.470 Test Loss: 2.820 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.34333848953247
Epoch: 9, Steps: 18 | Train Loss: 0.378 Vali Loss: 3.384 Vali Acc: 0.510 Test Loss: 3.384 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.391735553741455
Epoch: 10, Steps: 18 | Train Loss: 0.140 Vali Loss: 4.435 Vali Acc: 0.450 Test Loss: 4.435 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.509454488754272
Epoch: 11, Steps: 18 | Train Loss: 0.195 Vali Loss: 3.029 Vali Acc: 0.520 Test Loss: 3.029 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.791862726211548
Epoch: 12, Steps: 18 | Train Loss: 0.100 Vali Loss: 5.068 Vali Acc: 0.480 Test Loss: 5.068 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.499249458312988
Epoch: 13, Steps: 18 | Train Loss: 0.487 Vali Loss: 2.772 Vali Acc: 0.550 Test Loss: 2.772 Test Acc: 0.550
Validation loss decreased (-0.529982 --> -0.549972).  Saving model ...
Epoch: 14 cost time: 9.83968210220337
Epoch: 14, Steps: 18 | Train Loss: 0.194 Vali Loss: 3.386 Vali Acc: 0.540 Test Loss: 3.386 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.374243974685669
Epoch: 15, Steps: 18 | Train Loss: 0.259 Vali Loss: 4.910 Vali Acc: 0.460 Test Loss: 4.910 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.660415649414062
Epoch: 16, Steps: 18 | Train Loss: 0.115 Vali Loss: 4.260 Vali Acc: 0.460 Test Loss: 4.260 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 9.627077341079712
Epoch: 17, Steps: 18 | Train Loss: 0.139 Vali Loss: 5.747 Vali Acc: 0.460 Test Loss: 5.747 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 9.309771060943604
Epoch: 18, Steps: 18 | Train Loss: 0.350 Vali Loss: 6.982 Vali Acc: 0.460 Test Loss: 6.982 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 9.627457618713379
Epoch: 19, Steps: 18 | Train Loss: 0.153 Vali Loss: 6.339 Vali Acc: 0.490 Test Loss: 6.339 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 9.563694477081299
Epoch: 20, Steps: 18 | Train Loss: 0.075 Vali Loss: 7.498 Vali Acc: 0.470 Test Loss: 7.498 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 9.307329416275024
Epoch: 21, Steps: 18 | Train Loss: 0.140 Vali Loss: 7.494 Vali Acc: 0.400 Test Loss: 7.494 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 9.552935361862183
Epoch: 22, Steps: 18 | Train Loss: 0.102 Vali Loss: 7.625 Vali Acc: 0.410 Test Loss: 7.625 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 9.620744228363037
Epoch: 23, Steps: 18 | Train Loss: 0.145 Vali Loss: 8.202 Vali Acc: 0.480 Test Loss: 8.202 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 28594562
model size : 109.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.879015684127808
Epoch: 1, Steps: 18 | Train Loss: 0.795 Vali Loss: 0.784 Vali Acc: 0.540 Test Loss: 0.784 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 9.576279640197754
Epoch: 2, Steps: 18 | Train Loss: 0.616 Vali Loss: 0.795 Vali Acc: 0.520 Test Loss: 0.795 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.089820623397827
Epoch: 3, Steps: 18 | Train Loss: 0.723 Vali Loss: 1.121 Vali Acc: 0.550 Test Loss: 1.121 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549989).  Saving model ...
Epoch: 4 cost time: 9.82906460762024
Epoch: 4, Steps: 18 | Train Loss: 0.390 Vali Loss: 1.667 Vali Acc: 0.450 Test Loss: 1.667 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.47643232345581
Epoch: 5, Steps: 18 | Train Loss: 0.391 Vali Loss: 1.992 Vali Acc: 0.420 Test Loss: 1.992 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.235346794128418
Epoch: 6, Steps: 18 | Train Loss: 0.336 Vali Loss: 1.195 Vali Acc: 0.520 Test Loss: 1.195 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.02583932876587
Epoch: 7, Steps: 18 | Train Loss: 0.200 Vali Loss: 1.355 Vali Acc: 0.500 Test Loss: 1.355 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.647961378097534
Epoch: 8, Steps: 18 | Train Loss: 0.129 Vali Loss: 1.534 Vali Acc: 0.480 Test Loss: 1.534 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 9.609105348587036
Epoch: 9, Steps: 18 | Train Loss: 0.060 Vali Loss: 1.717 Vali Acc: 0.430 Test Loss: 1.717 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 9.914415836334229
Epoch: 10, Steps: 18 | Train Loss: 0.130 Vali Loss: 2.511 Vali Acc: 0.480 Test Loss: 2.511 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 9.69524359703064
Epoch: 11, Steps: 18 | Train Loss: 0.093 Vali Loss: 2.737 Vali Acc: 0.450 Test Loss: 2.737 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 9.727506875991821
Epoch: 12, Steps: 18 | Train Loss: 0.118 Vali Loss: 2.145 Vali Acc: 0.490 Test Loss: 2.145 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 9.876899003982544
Epoch: 13, Steps: 18 | Train Loss: 0.095 Vali Loss: 2.797 Vali Acc: 0.460 Test Loss: 2.797 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 28374786
model size : 108.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.975332975387573
Epoch: 1, Steps: 18 | Train Loss: 0.748 Vali Loss: 0.772 Vali Acc: 0.590 Test Loss: 0.772 Test Acc: 0.590
Validation loss decreased (inf --> -0.589992).  Saving model ...
Epoch: 2 cost time: 7.520414352416992
Epoch: 2, Steps: 18 | Train Loss: 0.595 Vali Loss: 0.944 Vali Acc: 0.540 Test Loss: 0.944 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.925291538238525
Epoch: 3, Steps: 18 | Train Loss: 0.512 Vali Loss: 1.116 Vali Acc: 0.560 Test Loss: 1.116 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.563802480697632
Epoch: 4, Steps: 18 | Train Loss: 0.311 Vali Loss: 1.062 Vali Acc: 0.470 Test Loss: 1.062 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.683691501617432
Epoch: 5, Steps: 18 | Train Loss: 0.292 Vali Loss: 1.133 Vali Acc: 0.510 Test Loss: 1.133 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.532827377319336
Epoch: 6, Steps: 18 | Train Loss: 0.152 Vali Loss: 1.151 Vali Acc: 0.500 Test Loss: 1.151 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.704050302505493
Epoch: 7, Steps: 18 | Train Loss: 0.070 Vali Loss: 1.946 Vali Acc: 0.480 Test Loss: 1.946 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.6011247634887695
Epoch: 8, Steps: 18 | Train Loss: 0.090 Vali Loss: 1.941 Vali Acc: 0.490 Test Loss: 1.941 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.6296000480651855
Epoch: 9, Steps: 18 | Train Loss: 0.151 Vali Loss: 1.659 Vali Acc: 0.490 Test Loss: 1.659 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.752717733383179
Epoch: 10, Steps: 18 | Train Loss: 0.034 Vali Loss: 2.530 Vali Acc: 0.480 Test Loss: 2.530 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.662917375564575
Epoch: 11, Steps: 18 | Train Loss: 0.028 Vali Loss: 2.928 Vali Acc: 0.490 Test Loss: 2.928 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 28286082
model size : 108.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.874730348587036
Epoch: 1, Steps: 18 | Train Loss: 0.767 Vali Loss: 1.023 Vali Acc: 0.590 Test Loss: 1.023 Test Acc: 0.590
Validation loss decreased (inf --> -0.589990).  Saving model ...
Epoch: 2 cost time: 7.587209224700928
Epoch: 2, Steps: 18 | Train Loss: 0.750 Vali Loss: 0.727 Vali Acc: 0.490 Test Loss: 0.727 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.759507894515991
Epoch: 3, Steps: 18 | Train Loss: 0.491 Vali Loss: 0.807 Vali Acc: 0.510 Test Loss: 0.807 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.662995100021362
Epoch: 4, Steps: 18 | Train Loss: 0.323 Vali Loss: 0.771 Vali Acc: 0.480 Test Loss: 0.771 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.813276767730713
Epoch: 5, Steps: 18 | Train Loss: 0.216 Vali Loss: 0.909 Vali Acc: 0.470 Test Loss: 0.909 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.037279605865479
Epoch: 6, Steps: 18 | Train Loss: 0.151 Vali Loss: 1.058 Vali Acc: 0.430 Test Loss: 1.058 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.732727766036987
Epoch: 7, Steps: 18 | Train Loss: 0.100 Vali Loss: 1.253 Vali Acc: 0.470 Test Loss: 1.253 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 8.049587488174438
Epoch: 8, Steps: 18 | Train Loss: 0.129 Vali Loss: 1.436 Vali Acc: 0.490 Test Loss: 1.436 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.687696218490601
Epoch: 9, Steps: 18 | Train Loss: 0.067 Vali Loss: 1.344 Vali Acc: 0.520 Test Loss: 1.344 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.4871506690979
Epoch: 10, Steps: 18 | Train Loss: 0.147 Vali Loss: 1.677 Vali Acc: 0.430 Test Loss: 1.677 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.887933015823364
Epoch: 11, Steps: 18 | Train Loss: 0.057 Vali Loss: 2.842 Vali Acc: 0.540 Test Loss: 2.842 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 28206978
model size : 108.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.923759460449219
Epoch: 1, Steps: 18 | Train Loss: 0.719 Vali Loss: 0.737 Vali Acc: 0.550 Test Loss: 0.737 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 7.910773515701294
Epoch: 2, Steps: 18 | Train Loss: 0.691 Vali Loss: 0.905 Vali Acc: 0.620 Test Loss: 0.905 Test Acc: 0.620
Validation loss decreased (-0.549993 --> -0.619991).  Saving model ...
Epoch: 3 cost time: 7.417391538619995
Epoch: 3, Steps: 18 | Train Loss: 0.545 Vali Loss: 0.928 Vali Acc: 0.540 Test Loss: 0.928 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.8778533935546875
Epoch: 4, Steps: 18 | Train Loss: 0.448 Vali Loss: 0.911 Vali Acc: 0.530 Test Loss: 0.911 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.712218761444092
Epoch: 5, Steps: 18 | Train Loss: 0.299 Vali Loss: 0.973 Vali Acc: 0.490 Test Loss: 0.973 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.8088109493255615
Epoch: 6, Steps: 18 | Train Loss: 0.233 Vali Loss: 0.831 Vali Acc: 0.520 Test Loss: 0.831 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.807863235473633
Epoch: 7, Steps: 18 | Train Loss: 0.128 Vali Loss: 1.142 Vali Acc: 0.580 Test Loss: 1.142 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.423949718475342
Epoch: 8, Steps: 18 | Train Loss: 0.098 Vali Loss: 1.038 Vali Acc: 0.550 Test Loss: 1.038 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.805989980697632
Epoch: 9, Steps: 18 | Train Loss: 0.085 Vali Loss: 1.040 Vali Acc: 0.560 Test Loss: 1.040 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.793379783630371
Epoch: 10, Steps: 18 | Train Loss: 0.105 Vali Loss: 1.361 Vali Acc: 0.550 Test Loss: 1.361 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.710894584655762
Epoch: 11, Steps: 18 | Train Loss: 0.047 Vali Loss: 1.174 Vali Acc: 0.530 Test Loss: 1.174 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.658118724822998
Epoch: 12, Steps: 18 | Train Loss: 0.027 Vali Loss: 1.122 Vali Acc: 0.530 Test Loss: 1.122 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 28160642
model size : 107.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.3600616455078125
Epoch: 1, Steps: 18 | Train Loss: 0.730 Vali Loss: 0.786 Vali Acc: 0.440 Test Loss: 0.786 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 5.1259448528289795
Epoch: 2, Steps: 18 | Train Loss: 0.672 Vali Loss: 0.746 Vali Acc: 0.460 Test Loss: 0.746 Test Acc: 0.460
Validation loss decreased (-0.439992 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 5.356775283813477
Epoch: 3, Steps: 18 | Train Loss: 0.536 Vali Loss: 0.746 Vali Acc: 0.570 Test Loss: 0.746 Test Acc: 0.570
Validation loss decreased (-0.459993 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 5.124087333679199
Epoch: 4, Steps: 18 | Train Loss: 0.441 Vali Loss: 0.813 Vali Acc: 0.450 Test Loss: 0.813 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.357392072677612
Epoch: 5, Steps: 18 | Train Loss: 0.337 Vali Loss: 0.756 Vali Acc: 0.510 Test Loss: 0.756 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.187092542648315
Epoch: 6, Steps: 18 | Train Loss: 0.228 Vali Loss: 0.881 Vali Acc: 0.540 Test Loss: 0.881 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.000563621520996
Epoch: 7, Steps: 18 | Train Loss: 0.146 Vali Loss: 0.947 Vali Acc: 0.510 Test Loss: 0.947 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.446507692337036
Epoch: 8, Steps: 18 | Train Loss: 0.124 Vali Loss: 1.106 Vali Acc: 0.480 Test Loss: 1.106 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.858222961425781
Epoch: 9, Steps: 18 | Train Loss: 0.053 Vali Loss: 1.019 Vali Acc: 0.540 Test Loss: 1.019 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.90076470375061
Epoch: 10, Steps: 18 | Train Loss: 0.027 Vali Loss: 1.614 Vali Acc: 0.560 Test Loss: 1.614 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.5250959396362305
Epoch: 11, Steps: 18 | Train Loss: 0.024 Vali Loss: 1.397 Vali Acc: 0.550 Test Loss: 1.397 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.911234378814697
Epoch: 12, Steps: 18 | Train Loss: 0.034 Vali Loss: 1.392 Vali Acc: 0.510 Test Loss: 1.392 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.205593109130859
Epoch: 13, Steps: 18 | Train Loss: 0.037 Vali Loss: 1.285 Vali Acc: 0.500 Test Loss: 1.285 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 28147074
model size : 107.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.9912168979644775
Epoch: 1, Steps: 18 | Train Loss: 0.820 Vali Loss: 0.875 Vali Acc: 0.590 Test Loss: 0.875 Test Acc: 0.590
Validation loss decreased (inf --> -0.589991).  Saving model ...
Epoch: 2 cost time: 7.2925636768341064
Epoch: 2, Steps: 18 | Train Loss: 0.536 Vali Loss: 1.096 Vali Acc: 0.610 Test Loss: 1.096 Test Acc: 0.610
Validation loss decreased (-0.589991 --> -0.609989).  Saving model ...
Epoch: 3 cost time: 6.2078423500061035
Epoch: 3, Steps: 18 | Train Loss: 0.473 Vali Loss: 1.227 Vali Acc: 0.580 Test Loss: 1.227 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.403616666793823
Epoch: 4, Steps: 18 | Train Loss: 0.341 Vali Loss: 1.152 Vali Acc: 0.450 Test Loss: 1.152 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.989981412887573
Epoch: 5, Steps: 18 | Train Loss: 0.139 Vali Loss: 1.444 Vali Acc: 0.440 Test Loss: 1.444 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.296275854110718
Epoch: 6, Steps: 18 | Train Loss: 0.112 Vali Loss: 1.531 Vali Acc: 0.570 Test Loss: 1.531 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.028481960296631
Epoch: 7, Steps: 18 | Train Loss: 0.054 Vali Loss: 2.192 Vali Acc: 0.480 Test Loss: 2.192 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.61171555519104
Epoch: 8, Steps: 18 | Train Loss: 0.051 Vali Loss: 1.861 Vali Acc: 0.460 Test Loss: 1.861 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.511397123336792
Epoch: 9, Steps: 18 | Train Loss: 0.044 Vali Loss: 2.348 Vali Acc: 0.540 Test Loss: 2.348 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.208553075790405
Epoch: 10, Steps: 18 | Train Loss: 0.048 Vali Loss: 2.093 Vali Acc: 0.580 Test Loss: 2.093 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.8709094524383545
Epoch: 11, Steps: 18 | Train Loss: 0.117 Vali Loss: 4.798 Vali Acc: 0.470 Test Loss: 4.798 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.886426687240601
Epoch: 12, Steps: 18 | Train Loss: 0.085 Vali Loss: 3.537 Vali Acc: 0.500 Test Loss: 3.537 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 9344514
model size : 35.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.467445611953735
Epoch: 1, Steps: 18 | Train Loss: 0.776 Vali Loss: 0.919 Vali Acc: 0.570 Test Loss: 0.919 Test Acc: 0.570
Validation loss decreased (inf --> -0.569991).  Saving model ...
Epoch: 2 cost time: 4.162860870361328
Epoch: 2, Steps: 18 | Train Loss: 0.697 Vali Loss: 0.810 Vali Acc: 0.480 Test Loss: 0.810 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.926182746887207
Epoch: 3, Steps: 18 | Train Loss: 0.507 Vali Loss: 0.961 Vali Acc: 0.550 Test Loss: 0.961 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.062056064605713
Epoch: 4, Steps: 18 | Train Loss: 0.312 Vali Loss: 1.116 Vali Acc: 0.450 Test Loss: 1.116 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.264609098434448
Epoch: 5, Steps: 18 | Train Loss: 0.260 Vali Loss: 1.294 Vali Acc: 0.480 Test Loss: 1.294 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.284148216247559
Epoch: 6, Steps: 18 | Train Loss: 0.133 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.265735864639282
Epoch: 7, Steps: 18 | Train Loss: 0.133 Vali Loss: 1.185 Vali Acc: 0.530 Test Loss: 1.185 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.385906219482422
Epoch: 8, Steps: 18 | Train Loss: 0.107 Vali Loss: 2.132 Vali Acc: 0.430 Test Loss: 2.132 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.513023138046265
Epoch: 9, Steps: 18 | Train Loss: 0.037 Vali Loss: 2.240 Vali Acc: 0.480 Test Loss: 2.240 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.385453224182129
Epoch: 10, Steps: 18 | Train Loss: 0.027 Vali Loss: 2.311 Vali Acc: 0.430 Test Loss: 2.311 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.253310680389404
Epoch: 11, Steps: 18 | Train Loss: 0.021 Vali Loss: 2.049 Vali Acc: 0.530 Test Loss: 2.049 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9038018
model size : 34.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.588437557220459
Epoch: 1, Steps: 18 | Train Loss: 0.742 Vali Loss: 0.857 Vali Acc: 0.610 Test Loss: 0.857 Test Acc: 0.610
Validation loss decreased (inf --> -0.609991).  Saving model ...
Epoch: 2 cost time: 5.369444131851196
Epoch: 2, Steps: 18 | Train Loss: 0.667 Vali Loss: 0.798 Vali Acc: 0.450 Test Loss: 0.798 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.459731340408325
Epoch: 3, Steps: 18 | Train Loss: 0.464 Vali Loss: 0.804 Vali Acc: 0.530 Test Loss: 0.804 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.529009103775024
Epoch: 4, Steps: 18 | Train Loss: 0.336 Vali Loss: 0.929 Vali Acc: 0.500 Test Loss: 0.929 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.291921854019165
Epoch: 5, Steps: 18 | Train Loss: 0.215 Vali Loss: 1.018 Vali Acc: 0.520 Test Loss: 1.018 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.405454874038696
Epoch: 6, Steps: 18 | Train Loss: 0.136 Vali Loss: 0.983 Vali Acc: 0.500 Test Loss: 0.983 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.437877893447876
Epoch: 7, Steps: 18 | Train Loss: 0.080 Vali Loss: 1.052 Vali Acc: 0.510 Test Loss: 1.052 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.346543550491333
Epoch: 8, Steps: 18 | Train Loss: 0.040 Vali Loss: 1.167 Vali Acc: 0.470 Test Loss: 1.167 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.603151082992554
Epoch: 9, Steps: 18 | Train Loss: 0.034 Vali Loss: 1.714 Vali Acc: 0.440 Test Loss: 1.714 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.300142526626587
Epoch: 10, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.292 Vali Acc: 0.510 Test Loss: 1.292 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.6471617221832275
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.469 Vali Acc: 0.490 Test Loss: 1.469 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 8928130
model size : 34.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.513735294342041
Epoch: 1, Steps: 18 | Train Loss: 0.724 Vali Loss: 0.731 Vali Acc: 0.470 Test Loss: 0.731 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 4.747993230819702
Epoch: 2, Steps: 18 | Train Loss: 0.616 Vali Loss: 0.756 Vali Acc: 0.560 Test Loss: 0.756 Test Acc: 0.560
Validation loss decreased (-0.469993 --> -0.559992).  Saving model ...
Epoch: 3 cost time: 4.494580268859863
Epoch: 3, Steps: 18 | Train Loss: 0.460 Vali Loss: 0.743 Vali Acc: 0.560 Test Loss: 0.743 Test Acc: 0.560
Validation loss decreased (-0.559992 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 4.727159023284912
Epoch: 4, Steps: 18 | Train Loss: 0.345 Vali Loss: 0.900 Vali Acc: 0.540 Test Loss: 0.900 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.565455198287964
Epoch: 5, Steps: 18 | Train Loss: 0.253 Vali Loss: 0.904 Vali Acc: 0.560 Test Loss: 0.904 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.566664457321167
Epoch: 6, Steps: 18 | Train Loss: 0.143 Vali Loss: 0.961 Vali Acc: 0.530 Test Loss: 0.961 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.781108856201172
Epoch: 7, Steps: 18 | Train Loss: 0.066 Vali Loss: 1.230 Vali Acc: 0.550 Test Loss: 1.230 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.698941707611084
Epoch: 8, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.983 Vali Acc: 0.580 Test Loss: 0.983 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579990).  Saving model ...
Epoch: 9 cost time: 4.67158317565918
Epoch: 9, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.998 Vali Acc: 0.530 Test Loss: 0.998 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.706563472747803
Epoch: 10, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.640 Vali Acc: 0.500 Test Loss: 1.640 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.637079954147339
Epoch: 11, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.254 Vali Acc: 0.490 Test Loss: 1.254 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.916808366775513
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.369 Vali Acc: 0.500 Test Loss: 1.369 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.810990810394287
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.620 Vali Acc: 0.530 Test Loss: 1.620 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.80501914024353
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.677 Vali Acc: 0.490 Test Loss: 1.677 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.786420583724976
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.665 Vali Acc: 0.490 Test Loss: 1.665 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.7759690284729
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.740 Vali Acc: 0.490 Test Loss: 1.740 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.872772693634033
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.713 Vali Acc: 0.470 Test Loss: 1.713 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.622030258178711
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.736 Vali Acc: 0.480 Test Loss: 1.736 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 8883778
model size : 34.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.713109970092773
Epoch: 1, Steps: 18 | Train Loss: 0.728 Vali Loss: 0.728 Vali Acc: 0.540 Test Loss: 0.728 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 3.3206429481506348
Epoch: 2, Steps: 18 | Train Loss: 0.635 Vali Loss: 0.768 Vali Acc: 0.490 Test Loss: 0.768 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7364017963409424
Epoch: 3, Steps: 18 | Train Loss: 0.531 Vali Loss: 0.728 Vali Acc: 0.490 Test Loss: 0.728 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.667231798171997
Epoch: 4, Steps: 18 | Train Loss: 0.367 Vali Loss: 0.822 Vali Acc: 0.500 Test Loss: 0.822 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.472395181655884
Epoch: 5, Steps: 18 | Train Loss: 0.277 Vali Loss: 0.819 Vali Acc: 0.480 Test Loss: 0.819 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.734349489212036
Epoch: 6, Steps: 18 | Train Loss: 0.164 Vali Loss: 0.917 Vali Acc: 0.510 Test Loss: 0.917 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.698992967605591
Epoch: 7, Steps: 18 | Train Loss: 0.117 Vali Loss: 1.208 Vali Acc: 0.480 Test Loss: 1.208 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.852059841156006
Epoch: 8, Steps: 18 | Train Loss: 0.077 Vali Loss: 0.930 Vali Acc: 0.460 Test Loss: 0.930 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.580667734146118
Epoch: 9, Steps: 18 | Train Loss: 0.062 Vali Loss: 1.179 Vali Acc: 0.490 Test Loss: 1.179 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.918093919754028
Epoch: 10, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.212 Vali Acc: 0.470 Test Loss: 1.212 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.55587100982666
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.289 Vali Acc: 0.480 Test Loss: 1.289 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 8844226
model size : 33.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.666302680969238
Epoch: 1, Steps: 18 | Train Loss: 0.717 Vali Loss: 0.723 Vali Acc: 0.460 Test Loss: 0.723 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 4.548754453659058
Epoch: 2, Steps: 18 | Train Loss: 0.662 Vali Loss: 0.761 Vali Acc: 0.490 Test Loss: 0.761 Test Acc: 0.490
Validation loss decreased (-0.459993 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 4.606279134750366
Epoch: 3, Steps: 18 | Train Loss: 0.574 Vali Loss: 0.779 Vali Acc: 0.560 Test Loss: 0.779 Test Acc: 0.560
Validation loss decreased (-0.489992 --> -0.559992).  Saving model ...
Epoch: 4 cost time: 4.23909592628479
Epoch: 4, Steps: 18 | Train Loss: 0.459 Vali Loss: 0.799 Vali Acc: 0.500 Test Loss: 0.799 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.585293769836426
Epoch: 5, Steps: 18 | Train Loss: 0.378 Vali Loss: 0.839 Vali Acc: 0.500 Test Loss: 0.839 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.5893731117248535
Epoch: 6, Steps: 18 | Train Loss: 0.297 Vali Loss: 0.785 Vali Acc: 0.540 Test Loss: 0.785 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.34175443649292
Epoch: 7, Steps: 18 | Train Loss: 0.227 Vali Loss: 0.842 Vali Acc: 0.440 Test Loss: 0.842 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.91966986656189
Epoch: 8, Steps: 18 | Train Loss: 0.165 Vali Loss: 0.833 Vali Acc: 0.490 Test Loss: 0.833 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.640161514282227
Epoch: 9, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.957 Vali Acc: 0.490 Test Loss: 0.957 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.54607629776001
Epoch: 10, Steps: 18 | Train Loss: 0.057 Vali Loss: 1.013 Vali Acc: 0.520 Test Loss: 1.013 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.619101047515869
Epoch: 11, Steps: 18 | Train Loss: 0.028 Vali Loss: 1.043 Vali Acc: 0.510 Test Loss: 1.043 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.294059991836548
Epoch: 12, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.178 Vali Acc: 0.450 Test Loss: 1.178 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.843432903289795
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.237 Vali Acc: 0.480 Test Loss: 1.237 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 8821058
model size : 33.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.888846158981323
Epoch: 1, Steps: 18 | Train Loss: 0.696 Vali Loss: 0.713 Vali Acc: 0.510 Test Loss: 0.713 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 3.413670301437378
Epoch: 2, Steps: 18 | Train Loss: 0.652 Vali Loss: 0.776 Vali Acc: 0.520 Test Loss: 0.776 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 3.402628183364868
Epoch: 3, Steps: 18 | Train Loss: 0.569 Vali Loss: 0.759 Vali Acc: 0.550 Test Loss: 0.759 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 3.11604380607605
Epoch: 4, Steps: 18 | Train Loss: 0.471 Vali Loss: 0.768 Vali Acc: 0.570 Test Loss: 0.768 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569992).  Saving model ...
Epoch: 5 cost time: 3.5113227367401123
Epoch: 5, Steps: 18 | Train Loss: 0.402 Vali Loss: 0.938 Vali Acc: 0.580 Test Loss: 0.938 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579991).  Saving model ...
Epoch: 6 cost time: 3.6887686252593994
Epoch: 6, Steps: 18 | Train Loss: 0.348 Vali Loss: 0.929 Vali Acc: 0.470 Test Loss: 0.929 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4806454181671143
Epoch: 7, Steps: 18 | Train Loss: 0.256 Vali Loss: 0.853 Vali Acc: 0.450 Test Loss: 0.853 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.4535319805145264
Epoch: 8, Steps: 18 | Train Loss: 0.180 Vali Loss: 0.835 Vali Acc: 0.490 Test Loss: 0.835 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.488184690475464
Epoch: 9, Steps: 18 | Train Loss: 0.113 Vali Loss: 0.944 Vali Acc: 0.480 Test Loss: 0.944 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.622035264968872
Epoch: 10, Steps: 18 | Train Loss: 0.076 Vali Loss: 1.045 Vali Acc: 0.480 Test Loss: 1.045 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.8182899951934814
Epoch: 11, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.952 Vali Acc: 0.480 Test Loss: 0.952 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.5207204818725586
Epoch: 12, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.012 Vali Acc: 0.510 Test Loss: 1.012 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.402402400970459
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.143 Vali Acc: 0.460 Test Loss: 1.143 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.377277374267578
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.133 Vali Acc: 0.480 Test Loss: 1.133 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.441622734069824
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.125 Vali Acc: 0.520 Test Loss: 1.125 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 8814274
model size : 33.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.409308910369873
Epoch: 1, Steps: 18 | Train Loss: 0.753 Vali Loss: 0.836 Vali Acc: 0.610 Test Loss: 0.836 Test Acc: 0.610
Validation loss decreased (inf --> -0.609992).  Saving model ...
Epoch: 2 cost time: 3.8414697647094727
Epoch: 2, Steps: 18 | Train Loss: 0.558 Vali Loss: 0.781 Vali Acc: 0.660 Test Loss: 0.781 Test Acc: 0.660
Validation loss decreased (-0.609992 --> -0.659992).  Saving model ...
Epoch: 3 cost time: 3.104606866836548
Epoch: 3, Steps: 18 | Train Loss: 0.381 Vali Loss: 0.905 Vali Acc: 0.500 Test Loss: 0.905 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.896402597427368
Epoch: 4, Steps: 18 | Train Loss: 0.235 Vali Loss: 1.177 Vali Acc: 0.580 Test Loss: 1.177 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3199191093444824
Epoch: 5, Steps: 18 | Train Loss: 0.214 Vali Loss: 1.318 Vali Acc: 0.480 Test Loss: 1.318 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.059818744659424
Epoch: 6, Steps: 18 | Train Loss: 0.078 Vali Loss: 1.238 Vali Acc: 0.520 Test Loss: 1.238 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.986823081970215
Epoch: 7, Steps: 18 | Train Loss: 0.028 Vali Loss: 1.375 Vali Acc: 0.510 Test Loss: 1.375 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.1128976345062256
Epoch: 8, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.553 Vali Acc: 0.490 Test Loss: 1.553 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.4322097301483154
Epoch: 9, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.675 Vali Acc: 0.540 Test Loss: 1.675 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.0855185985565186
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 2.117 Vali Acc: 0.520 Test Loss: 2.117 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.9627389907836914
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.913 Vali Acc: 0.480 Test Loss: 1.913 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.938265800476074
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.488 Vali Acc: 0.540 Test Loss: 1.488 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 3357442
model size : 12.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.9791367053985596
Epoch: 1, Steps: 18 | Train Loss: 0.730 Vali Loss: 0.771 Vali Acc: 0.540 Test Loss: 0.771 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 2.5825753211975098
Epoch: 2, Steps: 18 | Train Loss: 0.688 Vali Loss: 0.797 Vali Acc: 0.540 Test Loss: 0.797 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4879415035247803
Epoch: 3, Steps: 18 | Train Loss: 0.542 Vali Loss: 0.733 Vali Acc: 0.550 Test Loss: 0.733 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 2.4105889797210693
Epoch: 4, Steps: 18 | Train Loss: 0.378 Vali Loss: 0.827 Vali Acc: 0.510 Test Loss: 0.827 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.477722406387329
Epoch: 5, Steps: 18 | Train Loss: 0.391 Vali Loss: 0.865 Vali Acc: 0.450 Test Loss: 0.865 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.555659532546997
Epoch: 6, Steps: 18 | Train Loss: 0.199 Vali Loss: 1.016 Vali Acc: 0.520 Test Loss: 1.016 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.551272392272949
Epoch: 7, Steps: 18 | Train Loss: 0.108 Vali Loss: 1.111 Vali Acc: 0.480 Test Loss: 1.111 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.4634745121002197
Epoch: 8, Steps: 18 | Train Loss: 0.089 Vali Loss: 1.163 Vali Acc: 0.490 Test Loss: 1.163 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.6537413597106934
Epoch: 9, Steps: 18 | Train Loss: 0.035 Vali Loss: 1.277 Vali Acc: 0.490 Test Loss: 1.277 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.7302465438842773
Epoch: 10, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.402 Vali Acc: 0.470 Test Loss: 1.402 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.373284101486206
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.413 Vali Acc: 0.450 Test Loss: 1.413 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.5317654609680176
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.466 Vali Acc: 0.450 Test Loss: 1.466 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.498373508453369
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.536 Vali Acc: 0.440 Test Loss: 1.536 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 3204194
model size : 12.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.206868886947632
Epoch: 1, Steps: 18 | Train Loss: 0.713 Vali Loss: 0.729 Vali Acc: 0.470 Test Loss: 0.729 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 2.982490062713623
Epoch: 2, Steps: 18 | Train Loss: 0.646 Vali Loss: 0.811 Vali Acc: 0.470 Test Loss: 0.811 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9045188426971436
Epoch: 3, Steps: 18 | Train Loss: 0.556 Vali Loss: 0.693 Vali Acc: 0.560 Test Loss: 0.693 Test Acc: 0.560
Validation loss decreased (-0.469993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 3.03277325630188
Epoch: 4, Steps: 18 | Train Loss: 0.497 Vali Loss: 0.723 Vali Acc: 0.540 Test Loss: 0.723 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.146089553833008
Epoch: 5, Steps: 18 | Train Loss: 0.347 Vali Loss: 0.965 Vali Acc: 0.510 Test Loss: 0.965 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9328105449676514
Epoch: 6, Steps: 18 | Train Loss: 0.241 Vali Loss: 0.841 Vali Acc: 0.500 Test Loss: 0.841 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.0745363235473633
Epoch: 7, Steps: 18 | Train Loss: 0.147 Vali Loss: 0.929 Vali Acc: 0.480 Test Loss: 0.929 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.7509257793426514
Epoch: 8, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.986 Vali Acc: 0.460 Test Loss: 0.986 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.211688756942749
Epoch: 9, Steps: 18 | Train Loss: 0.047 Vali Loss: 1.115 Vali Acc: 0.490 Test Loss: 1.115 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.010446786880493
Epoch: 10, Steps: 18 | Train Loss: 0.029 Vali Loss: 1.296 Vali Acc: 0.520 Test Loss: 1.296 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.9633877277374268
Epoch: 11, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.287 Vali Acc: 0.490 Test Loss: 1.287 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.90618896484375
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.266 Vali Acc: 0.460 Test Loss: 1.266 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.119396924972534
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.242 Vali Acc: 0.480 Test Loss: 1.242 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 3149250
model size : 12.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.958054304122925
Epoch: 1, Steps: 18 | Train Loss: 0.712 Vali Loss: 0.722 Vali Acc: 0.450 Test Loss: 0.722 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 2.6756043434143066
Epoch: 2, Steps: 18 | Train Loss: 0.644 Vali Loss: 0.756 Vali Acc: 0.510 Test Loss: 0.756 Test Acc: 0.510
Validation loss decreased (-0.449993 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 2.7245359420776367
Epoch: 3, Steps: 18 | Train Loss: 0.572 Vali Loss: 0.731 Vali Acc: 0.520 Test Loss: 0.731 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 2.5586910247802734
Epoch: 4, Steps: 18 | Train Loss: 0.458 Vali Loss: 0.798 Vali Acc: 0.540 Test Loss: 0.798 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 2.6152875423431396
Epoch: 5, Steps: 18 | Train Loss: 0.353 Vali Loss: 0.823 Vali Acc: 0.540 Test Loss: 0.823 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.548855781555176
Epoch: 6, Steps: 18 | Train Loss: 0.265 Vali Loss: 0.801 Vali Acc: 0.520 Test Loss: 0.801 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8531405925750732
Epoch: 7, Steps: 18 | Train Loss: 0.168 Vali Loss: 0.818 Vali Acc: 0.510 Test Loss: 0.818 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.706049680709839
Epoch: 8, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.914 Vali Acc: 0.500 Test Loss: 0.914 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.5654096603393555
Epoch: 9, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.879 Vali Acc: 0.560 Test Loss: 0.879 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559991).  Saving model ...
Epoch: 10 cost time: 2.785426378250122
Epoch: 10, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.969 Vali Acc: 0.550 Test Loss: 0.969 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7100863456726074
Epoch: 11, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.123 Vali Acc: 0.500 Test Loss: 1.123 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.634669780731201
Epoch: 12, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.088 Vali Acc: 0.500 Test Loss: 1.088 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.678375482559204
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.077 Vali Acc: 0.540 Test Loss: 1.077 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.5885112285614014
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.122 Vali Acc: 0.550 Test Loss: 1.122 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.8147852420806885
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.154 Vali Acc: 0.520 Test Loss: 1.154 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.7566590309143066
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.156 Vali Acc: 0.510 Test Loss: 1.156 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.5773990154266357
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.162 Vali Acc: 0.530 Test Loss: 1.162 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.678018569946289
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.191 Vali Acc: 0.520 Test Loss: 1.191 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.7074851989746094
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.194 Vali Acc: 0.520 Test Loss: 1.194 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 3127074
model size : 12.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.112552165985107
Epoch: 1, Steps: 18 | Train Loss: 0.716 Vali Loss: 0.717 Vali Acc: 0.420 Test Loss: 0.717 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 2.7456443309783936
Epoch: 2, Steps: 18 | Train Loss: 0.658 Vali Loss: 0.718 Vali Acc: 0.480 Test Loss: 0.718 Test Acc: 0.480
Validation loss decreased (-0.419993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 2.7777223587036133
Epoch: 3, Steps: 18 | Train Loss: 0.582 Vali Loss: 0.720 Vali Acc: 0.530 Test Loss: 0.720 Test Acc: 0.530
Validation loss decreased (-0.479993 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 2.670102119445801
Epoch: 4, Steps: 18 | Train Loss: 0.496 Vali Loss: 0.731 Vali Acc: 0.550 Test Loss: 0.731 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 2.846492290496826
Epoch: 5, Steps: 18 | Train Loss: 0.432 Vali Loss: 0.739 Vali Acc: 0.580 Test Loss: 0.739 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579993).  Saving model ...
Epoch: 6 cost time: 2.806389808654785
Epoch: 6, Steps: 18 | Train Loss: 0.352 Vali Loss: 0.795 Vali Acc: 0.590 Test Loss: 0.795 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589992).  Saving model ...
Epoch: 7 cost time: 2.780045986175537
Epoch: 7, Steps: 18 | Train Loss: 0.251 Vali Loss: 0.754 Vali Acc: 0.540 Test Loss: 0.754 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8690905570983887
Epoch: 8, Steps: 18 | Train Loss: 0.182 Vali Loss: 0.854 Vali Acc: 0.550 Test Loss: 0.854 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6398422718048096
Epoch: 9, Steps: 18 | Train Loss: 0.135 Vali Loss: 0.878 Vali Acc: 0.490 Test Loss: 0.878 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7731945514678955
Epoch: 10, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.951 Vali Acc: 0.550 Test Loss: 0.951 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.715623140335083
Epoch: 11, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.953 Vali Acc: 0.560 Test Loss: 0.953 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.750936508178711
Epoch: 12, Steps: 18 | Train Loss: 0.045 Vali Loss: 1.058 Vali Acc: 0.530 Test Loss: 1.058 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.74237060546875
Epoch: 13, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.021 Vali Acc: 0.480 Test Loss: 1.021 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.6875720024108887
Epoch: 14, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.100 Vali Acc: 0.500 Test Loss: 1.100 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.7217018604278564
Epoch: 15, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.130 Vali Acc: 0.490 Test Loss: 1.130 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.7011029720306396
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.189 Vali Acc: 0.490 Test Loss: 1.189 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3107298
model size : 11.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.991616725921631
Epoch: 1, Steps: 18 | Train Loss: 0.706 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.7450225353240967
Epoch: 2, Steps: 18 | Train Loss: 0.666 Vali Loss: 0.718 Vali Acc: 0.470 Test Loss: 0.718 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7122890949249268
Epoch: 3, Steps: 18 | Train Loss: 0.600 Vali Loss: 0.786 Vali Acc: 0.540 Test Loss: 0.786 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 2.73803973197937
Epoch: 4, Steps: 18 | Train Loss: 0.547 Vali Loss: 0.745 Vali Acc: 0.520 Test Loss: 0.745 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6552720069885254
Epoch: 5, Steps: 18 | Train Loss: 0.470 Vali Loss: 0.724 Vali Acc: 0.530 Test Loss: 0.724 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.661179780960083
Epoch: 6, Steps: 18 | Train Loss: 0.396 Vali Loss: 0.697 Vali Acc: 0.520 Test Loss: 0.697 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.7419302463531494
Epoch: 7, Steps: 18 | Train Loss: 0.336 Vali Loss: 0.733 Vali Acc: 0.530 Test Loss: 0.733 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.7418324947357178
Epoch: 8, Steps: 18 | Train Loss: 0.284 Vali Loss: 0.769 Vali Acc: 0.470 Test Loss: 0.769 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.7417495250701904
Epoch: 9, Steps: 18 | Train Loss: 0.188 Vali Loss: 0.806 Vali Acc: 0.480 Test Loss: 0.806 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.683454990386963
Epoch: 10, Steps: 18 | Train Loss: 0.145 Vali Loss: 0.875 Vali Acc: 0.470 Test Loss: 0.875 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.768601179122925
Epoch: 11, Steps: 18 | Train Loss: 0.121 Vali Loss: 0.840 Vali Acc: 0.480 Test Loss: 0.840 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.586456775665283
Epoch: 12, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.918 Vali Acc: 0.500 Test Loss: 0.918 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.599539279937744
Epoch: 13, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.992 Vali Acc: 0.470 Test Loss: 0.992 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 3095714
model size : 11.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.2183477878570557
Epoch: 1, Steps: 18 | Train Loss: 0.721 Vali Loss: 0.705 Vali Acc: 0.430 Test Loss: 0.705 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 2.079160213470459
Epoch: 2, Steps: 18 | Train Loss: 0.687 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
Validation loss decreased (-0.429993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.988203763961792
Epoch: 3, Steps: 18 | Train Loss: 0.606 Vali Loss: 0.723 Vali Acc: 0.570 Test Loss: 0.723 Test Acc: 0.570
Validation loss decreased (-0.499993 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 1.943253993988037
Epoch: 4, Steps: 18 | Train Loss: 0.539 Vali Loss: 0.746 Vali Acc: 0.510 Test Loss: 0.746 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.960813045501709
Epoch: 5, Steps: 18 | Train Loss: 0.463 Vali Loss: 0.776 Vali Acc: 0.560 Test Loss: 0.776 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0587830543518066
Epoch: 6, Steps: 18 | Train Loss: 0.400 Vali Loss: 0.715 Vali Acc: 0.490 Test Loss: 0.715 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.080038547515869
Epoch: 7, Steps: 18 | Train Loss: 0.334 Vali Loss: 0.739 Vali Acc: 0.490 Test Loss: 0.739 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0193076133728027
Epoch: 8, Steps: 18 | Train Loss: 0.261 Vali Loss: 0.825 Vali Acc: 0.480 Test Loss: 0.825 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0343737602233887
Epoch: 9, Steps: 18 | Train Loss: 0.206 Vali Loss: 0.774 Vali Acc: 0.500 Test Loss: 0.774 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9405808448791504
Epoch: 10, Steps: 18 | Train Loss: 0.158 Vali Loss: 0.812 Vali Acc: 0.500 Test Loss: 0.812 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9762325286865234
Epoch: 11, Steps: 18 | Train Loss: 0.114 Vali Loss: 0.874 Vali Acc: 0.510 Test Loss: 0.874 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.06337308883667
Epoch: 12, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.897 Vali Acc: 0.500 Test Loss: 0.897 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.0263822078704834
Epoch: 13, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.991 Vali Acc: 0.510 Test Loss: 0.991 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3092322
model size : 11.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.5703227519989
Epoch: 1, Steps: 18 | Train Loss: 2.470 Vali Loss: 1.185 Vali Acc: 0.500 Test Loss: 1.185 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 16.912161111831665
Epoch: 2, Steps: 18 | Train Loss: 3.361 Vali Loss: 3.553 Vali Acc: 0.490 Test Loss: 3.553 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.0858097076416
Epoch: 3, Steps: 18 | Train Loss: 3.116 Vali Loss: 4.831 Vali Acc: 0.500 Test Loss: 4.831 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.063459873199463
Epoch: 4, Steps: 18 | Train Loss: 3.313 Vali Loss: 12.578 Vali Acc: 0.520 Test Loss: 12.578 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519874).  Saving model ...
Epoch: 5 cost time: 17.1586012840271
Epoch: 5, Steps: 18 | Train Loss: 2.043 Vali Loss: 8.266 Vali Acc: 0.440 Test Loss: 8.266 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 17.317662477493286
Epoch: 6, Steps: 18 | Train Loss: 1.868 Vali Loss: 11.767 Vali Acc: 0.480 Test Loss: 11.767 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 16.70328187942505
Epoch: 7, Steps: 18 | Train Loss: 2.095 Vali Loss: 11.842 Vali Acc: 0.460 Test Loss: 11.842 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 17.26063323020935
Epoch: 8, Steps: 18 | Train Loss: 2.384 Vali Loss: 33.778 Vali Acc: 0.510 Test Loss: 33.778 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 17.243455410003662
Epoch: 9, Steps: 18 | Train Loss: 4.588 Vali Loss: 23.494 Vali Acc: 0.570 Test Loss: 23.494 Test Acc: 0.570
Validation loss decreased (-0.519874 --> -0.569765).  Saving model ...
Epoch: 10 cost time: 16.932950258255005
Epoch: 10, Steps: 18 | Train Loss: 2.326 Vali Loss: 17.270 Vali Acc: 0.480 Test Loss: 17.270 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 17.10240077972412
Epoch: 11, Steps: 18 | Train Loss: 0.988 Vali Loss: 13.207 Vali Acc: 0.490 Test Loss: 13.207 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 17.155964136123657
Epoch: 12, Steps: 18 | Train Loss: 0.385 Vali Loss: 16.214 Vali Acc: 0.520 Test Loss: 16.214 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 16.97555685043335
Epoch: 13, Steps: 18 | Train Loss: 0.882 Vali Loss: 18.831 Vali Acc: 0.520 Test Loss: 18.831 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 17.044124126434326
Epoch: 14, Steps: 18 | Train Loss: 0.451 Vali Loss: 10.763 Vali Acc: 0.580 Test Loss: 10.763 Test Acc: 0.580
Validation loss decreased (-0.569765 --> -0.579892).  Saving model ...
Epoch: 15 cost time: 17.501626014709473
Epoch: 15, Steps: 18 | Train Loss: 0.433 Vali Loss: 11.708 Vali Acc: 0.520 Test Loss: 11.708 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 17.38457489013672
Epoch: 16, Steps: 18 | Train Loss: 0.245 Vali Loss: 22.707 Vali Acc: 0.570 Test Loss: 22.707 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 17.26450514793396
Epoch: 17, Steps: 18 | Train Loss: 0.564 Vali Loss: 18.598 Vali Acc: 0.430 Test Loss: 18.598 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 17.26207709312439
Epoch: 18, Steps: 18 | Train Loss: 0.353 Vali Loss: 22.149 Vali Acc: 0.450 Test Loss: 22.149 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 17.486692667007446
Epoch: 19, Steps: 18 | Train Loss: 0.805 Vali Loss: 21.368 Vali Acc: 0.430 Test Loss: 21.368 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 17.32944893836975
Epoch: 20, Steps: 18 | Train Loss: 0.413 Vali Loss: 25.327 Vali Acc: 0.510 Test Loss: 25.327 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 17.531611919403076
Epoch: 21, Steps: 18 | Train Loss: 0.124 Vali Loss: 20.880 Vali Acc: 0.460 Test Loss: 20.880 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 17.316610097885132
Epoch: 22, Steps: 18 | Train Loss: 0.242 Vali Loss: 17.675 Vali Acc: 0.480 Test Loss: 17.675 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 17.499432802200317
Epoch: 23, Steps: 18 | Train Loss: 0.180 Vali Loss: 17.802 Vali Acc: 0.540 Test Loss: 17.802 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 15.902600049972534
Epoch: 24, Steps: 18 | Train Loss: 0.102 Vali Loss: 24.679 Vali Acc: 0.460 Test Loss: 24.679 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 24006658
model size : 91.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.714124202728271
Epoch: 1, Steps: 18 | Train Loss: 1.259 Vali Loss: 3.323 Vali Acc: 0.620 Test Loss: 3.323 Test Acc: 0.620
Validation loss decreased (inf --> -0.619967).  Saving model ...
Epoch: 2 cost time: 9.642153263092041
Epoch: 2, Steps: 18 | Train Loss: 1.315 Vali Loss: 1.976 Vali Acc: 0.540 Test Loss: 1.976 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.538925886154175
Epoch: 3, Steps: 18 | Train Loss: 1.332 Vali Loss: 4.481 Vali Acc: 0.480 Test Loss: 4.481 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.212571620941162
Epoch: 4, Steps: 18 | Train Loss: 2.140 Vali Loss: 3.993 Vali Acc: 0.460 Test Loss: 3.993 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.66117238998413
Epoch: 5, Steps: 18 | Train Loss: 1.385 Vali Loss: 3.913 Vali Acc: 0.460 Test Loss: 3.913 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.616201639175415
Epoch: 6, Steps: 18 | Train Loss: 1.621 Vali Loss: 6.168 Vali Acc: 0.550 Test Loss: 6.168 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.447570562362671
Epoch: 7, Steps: 18 | Train Loss: 3.329 Vali Loss: 10.167 Vali Acc: 0.480 Test Loss: 10.167 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.291818857192993
Epoch: 8, Steps: 18 | Train Loss: 2.977 Vali Loss: 6.631 Vali Acc: 0.490 Test Loss: 6.631 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 9.528641939163208
Epoch: 9, Steps: 18 | Train Loss: 0.809 Vali Loss: 11.658 Vali Acc: 0.530 Test Loss: 11.658 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 9.66633129119873
Epoch: 10, Steps: 18 | Train Loss: 0.927 Vali Loss: 9.813 Vali Acc: 0.590 Test Loss: 9.813 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 9.535605192184448
Epoch: 11, Steps: 18 | Train Loss: 1.311 Vali Loss: 10.953 Vali Acc: 0.560 Test Loss: 10.953 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 22780674
model size : 87.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.521899938583374
Epoch: 1, Steps: 18 | Train Loss: 1.093 Vali Loss: 1.138 Vali Acc: 0.600 Test Loss: 1.138 Test Acc: 0.600
Validation loss decreased (inf --> -0.599989).  Saving model ...
Epoch: 2 cost time: 7.938862085342407
Epoch: 2, Steps: 18 | Train Loss: 1.351 Vali Loss: 1.581 Vali Acc: 0.490 Test Loss: 1.581 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.099769115447998
Epoch: 3, Steps: 18 | Train Loss: 1.011 Vali Loss: 3.729 Vali Acc: 0.630 Test Loss: 3.729 Test Acc: 0.630
Validation loss decreased (-0.599989 --> -0.629963).  Saving model ...
Epoch: 4 cost time: 7.989139080047607
Epoch: 4, Steps: 18 | Train Loss: 1.305 Vali Loss: 2.613 Vali Acc: 0.490 Test Loss: 2.613 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.7721662521362305
Epoch: 5, Steps: 18 | Train Loss: 0.995 Vali Loss: 8.258 Vali Acc: 0.500 Test Loss: 8.258 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.915256977081299
Epoch: 6, Steps: 18 | Train Loss: 0.993 Vali Loss: 2.999 Vali Acc: 0.540 Test Loss: 2.999 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.355076551437378
Epoch: 7, Steps: 18 | Train Loss: 0.796 Vali Loss: 3.752 Vali Acc: 0.480 Test Loss: 3.752 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.838997840881348
Epoch: 8, Steps: 18 | Train Loss: 0.622 Vali Loss: 7.539 Vali Acc: 0.500 Test Loss: 7.539 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.974690675735474
Epoch: 9, Steps: 18 | Train Loss: 1.452 Vali Loss: 6.427 Vali Acc: 0.540 Test Loss: 6.427 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.113789319992065
Epoch: 10, Steps: 18 | Train Loss: 1.019 Vali Loss: 4.580 Vali Acc: 0.550 Test Loss: 4.580 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 7.926995754241943
Epoch: 11, Steps: 18 | Train Loss: 1.238 Vali Loss: 6.259 Vali Acc: 0.580 Test Loss: 6.259 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 8.156552791595459
Epoch: 12, Steps: 18 | Train Loss: 0.768 Vali Loss: 4.298 Vali Acc: 0.550 Test Loss: 4.298 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.806216478347778
Epoch: 13, Steps: 18 | Train Loss: 0.915 Vali Loss: 10.468 Vali Acc: 0.560 Test Loss: 10.468 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 22341122
model size : 85.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.412760496139526
Epoch: 1, Steps: 18 | Train Loss: 0.982 Vali Loss: 1.617 Vali Acc: 0.610 Test Loss: 1.617 Test Acc: 0.610
Validation loss decreased (inf --> -0.609984).  Saving model ...
Epoch: 2 cost time: 4.994729518890381
Epoch: 2, Steps: 18 | Train Loss: 1.261 Vali Loss: 1.236 Vali Acc: 0.470 Test Loss: 1.236 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.209781646728516
Epoch: 3, Steps: 18 | Train Loss: 1.223 Vali Loss: 2.429 Vali Acc: 0.470 Test Loss: 2.429 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.193305492401123
Epoch: 4, Steps: 18 | Train Loss: 1.896 Vali Loss: 2.454 Vali Acc: 0.530 Test Loss: 2.454 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.3006041049957275
Epoch: 5, Steps: 18 | Train Loss: 1.095 Vali Loss: 2.726 Vali Acc: 0.500 Test Loss: 2.726 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.148823022842407
Epoch: 6, Steps: 18 | Train Loss: 0.990 Vali Loss: 4.216 Vali Acc: 0.490 Test Loss: 4.216 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.145576238632202
Epoch: 7, Steps: 18 | Train Loss: 1.095 Vali Loss: 5.430 Vali Acc: 0.520 Test Loss: 5.430 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.573666572570801
Epoch: 8, Steps: 18 | Train Loss: 1.285 Vali Loss: 4.417 Vali Acc: 0.450 Test Loss: 4.417 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.250780820846558
Epoch: 9, Steps: 18 | Train Loss: 1.064 Vali Loss: 5.231 Vali Acc: 0.440 Test Loss: 5.231 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.394266128540039
Epoch: 10, Steps: 18 | Train Loss: 0.540 Vali Loss: 5.448 Vali Acc: 0.430 Test Loss: 5.448 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.328250408172607
Epoch: 11, Steps: 18 | Train Loss: 1.514 Vali Loss: 6.075 Vali Acc: 0.500 Test Loss: 6.075 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 22163714
model size : 84.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.164392232894897
Epoch: 1, Steps: 18 | Train Loss: 0.914 Vali Loss: 1.002 Vali Acc: 0.600 Test Loss: 1.002 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 6.40299391746521
Epoch: 2, Steps: 18 | Train Loss: 0.698 Vali Loss: 0.847 Vali Acc: 0.550 Test Loss: 0.847 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.666490316390991
Epoch: 3, Steps: 18 | Train Loss: 0.683 Vali Loss: 2.711 Vali Acc: 0.580 Test Loss: 2.711 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.589869022369385
Epoch: 4, Steps: 18 | Train Loss: 0.680 Vali Loss: 1.627 Vali Acc: 0.550 Test Loss: 1.627 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.634453773498535
Epoch: 5, Steps: 18 | Train Loss: 0.516 Vali Loss: 1.379 Vali Acc: 0.530 Test Loss: 1.379 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.588675022125244
Epoch: 6, Steps: 18 | Train Loss: 0.578 Vali Loss: 2.067 Vali Acc: 0.540 Test Loss: 2.067 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.462599992752075
Epoch: 7, Steps: 18 | Train Loss: 0.738 Vali Loss: 4.240 Vali Acc: 0.580 Test Loss: 4.240 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.577657461166382
Epoch: 8, Steps: 18 | Train Loss: 1.062 Vali Loss: 2.309 Vali Acc: 0.490 Test Loss: 2.309 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.5614259243011475
Epoch: 9, Steps: 18 | Train Loss: 0.485 Vali Loss: 3.992 Vali Acc: 0.450 Test Loss: 3.992 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.761840581893921
Epoch: 10, Steps: 18 | Train Loss: 0.407 Vali Loss: 3.966 Vali Acc: 0.520 Test Loss: 3.966 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.475765228271484
Epoch: 11, Steps: 18 | Train Loss: 0.230 Vali Loss: 5.639 Vali Acc: 0.480 Test Loss: 5.639 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 21972738
model size : 84.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.20356822013855
Epoch: 1, Steps: 18 | Train Loss: 0.819 Vali Loss: 1.240 Vali Acc: 0.530 Test Loss: 1.240 Test Acc: 0.530
Validation loss decreased (inf --> -0.529988).  Saving model ...
Epoch: 2 cost time: 6.225208759307861
Epoch: 2, Steps: 18 | Train Loss: 0.960 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.726277589797974
Epoch: 3, Steps: 18 | Train Loss: 0.646 Vali Loss: 2.056 Vali Acc: 0.600 Test Loss: 2.056 Test Acc: 0.600
Validation loss decreased (-0.529988 --> -0.599979).  Saving model ...
Epoch: 4 cost time: 6.3165600299835205
Epoch: 4, Steps: 18 | Train Loss: 0.504 Vali Loss: 2.558 Vali Acc: 0.550 Test Loss: 2.558 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.642706632614136
Epoch: 5, Steps: 18 | Train Loss: 0.336 Vali Loss: 1.172 Vali Acc: 0.500 Test Loss: 1.172 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.026029109954834
Epoch: 6, Steps: 18 | Train Loss: 0.399 Vali Loss: 2.073 Vali Acc: 0.520 Test Loss: 2.073 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.9865758419036865
Epoch: 7, Steps: 18 | Train Loss: 0.281 Vali Loss: 1.983 Vali Acc: 0.540 Test Loss: 1.983 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.888157844543457
Epoch: 8, Steps: 18 | Train Loss: 0.313 Vali Loss: 3.531 Vali Acc: 0.510 Test Loss: 3.531 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.268473148345947
Epoch: 9, Steps: 18 | Train Loss: 0.511 Vali Loss: 2.268 Vali Acc: 0.530 Test Loss: 2.268 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.937623500823975
Epoch: 10, Steps: 18 | Train Loss: 0.478 Vali Loss: 3.120 Vali Acc: 0.480 Test Loss: 3.120 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.335222244262695
Epoch: 11, Steps: 18 | Train Loss: 0.587 Vali Loss: 2.543 Vali Acc: 0.450 Test Loss: 2.543 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.928479909896851
Epoch: 12, Steps: 18 | Train Loss: 0.714 Vali Loss: 3.394 Vali Acc: 0.470 Test Loss: 3.394 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.125382423400879
Epoch: 13, Steps: 18 | Train Loss: 0.523 Vali Loss: 3.778 Vali Acc: 0.540 Test Loss: 3.778 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 21912834
model size : 83.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.758984088897705
Epoch: 1, Steps: 18 | Train Loss: 0.843 Vali Loss: 0.767 Vali Acc: 0.430 Test Loss: 0.767 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 4.294855833053589
Epoch: 2, Steps: 18 | Train Loss: 0.722 Vali Loss: 1.260 Vali Acc: 0.570 Test Loss: 1.260 Test Acc: 0.570
Validation loss decreased (-0.429992 --> -0.569987).  Saving model ...
Epoch: 3 cost time: 4.73693585395813
Epoch: 3, Steps: 18 | Train Loss: 0.484 Vali Loss: 0.866 Vali Acc: 0.560 Test Loss: 0.866 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.407440900802612
Epoch: 4, Steps: 18 | Train Loss: 0.409 Vali Loss: 1.067 Vali Acc: 0.540 Test Loss: 1.067 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.479293346405029
Epoch: 5, Steps: 18 | Train Loss: 0.488 Vali Loss: 0.854 Vali Acc: 0.560 Test Loss: 0.854 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.465764999389648
Epoch: 6, Steps: 18 | Train Loss: 0.337 Vali Loss: 1.865 Vali Acc: 0.500 Test Loss: 1.865 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.437153339385986
Epoch: 7, Steps: 18 | Train Loss: 0.430 Vali Loss: 1.872 Vali Acc: 0.560 Test Loss: 1.872 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.504726409912109
Epoch: 8, Steps: 18 | Train Loss: 0.282 Vali Loss: 1.560 Vali Acc: 0.530 Test Loss: 1.560 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.383772611618042
Epoch: 9, Steps: 18 | Train Loss: 0.255 Vali Loss: 1.597 Vali Acc: 0.490 Test Loss: 1.597 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.616727352142334
Epoch: 10, Steps: 18 | Train Loss: 0.244 Vali Loss: 1.917 Vali Acc: 0.460 Test Loss: 1.917 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.503439903259277
Epoch: 11, Steps: 18 | Train Loss: 0.340 Vali Loss: 4.580 Vali Acc: 0.520 Test Loss: 4.580 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.469728708267212
Epoch: 12, Steps: 18 | Train Loss: 0.332 Vali Loss: 1.634 Vali Acc: 0.560 Test Loss: 1.634 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 21885698
model size : 83.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.816254138946533
Epoch: 1, Steps: 18 | Train Loss: 1.008 Vali Loss: 1.717 Vali Acc: 0.630 Test Loss: 1.717 Test Acc: 0.630
Validation loss decreased (inf --> -0.629983).  Saving model ...
Epoch: 2 cost time: 7.434330701828003
Epoch: 2, Steps: 18 | Train Loss: 1.707 Vali Loss: 2.391 Vali Acc: 0.510 Test Loss: 2.391 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.412396192550659
Epoch: 3, Steps: 18 | Train Loss: 1.794 Vali Loss: 8.731 Vali Acc: 0.580 Test Loss: 8.731 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.582360744476318
Epoch: 4, Steps: 18 | Train Loss: 2.492 Vali Loss: 6.029 Vali Acc: 0.520 Test Loss: 6.029 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.435451507568359
Epoch: 5, Steps: 18 | Train Loss: 1.925 Vali Loss: 9.694 Vali Acc: 0.440 Test Loss: 9.694 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.314069032669067
Epoch: 6, Steps: 18 | Train Loss: 2.059 Vali Loss: 10.087 Vali Acc: 0.490 Test Loss: 10.087 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.529901027679443
Epoch: 7, Steps: 18 | Train Loss: 1.785 Vali Loss: 6.852 Vali Acc: 0.430 Test Loss: 6.852 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.483169794082642
Epoch: 8, Steps: 18 | Train Loss: 0.888 Vali Loss: 8.137 Vali Acc: 0.430 Test Loss: 8.137 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.469838380813599
Epoch: 9, Steps: 18 | Train Loss: 0.677 Vali Loss: 14.631 Vali Acc: 0.470 Test Loss: 14.631 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.434962272644043
Epoch: 10, Steps: 18 | Train Loss: 0.596 Vali Loss: 10.033 Vali Acc: 0.480 Test Loss: 10.033 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.3584372997283936
Epoch: 11, Steps: 18 | Train Loss: 0.813 Vali Loss: 10.707 Vali Acc: 0.520 Test Loss: 10.707 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 7809026
model size : 29.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.026982307434082
Epoch: 1, Steps: 18 | Train Loss: 1.215 Vali Loss: 0.898 Vali Acc: 0.530 Test Loss: 0.898 Test Acc: 0.530
Validation loss decreased (inf --> -0.529991).  Saving model ...
Epoch: 2 cost time: 4.926272630691528
Epoch: 2, Steps: 18 | Train Loss: 0.895 Vali Loss: 1.281 Vali Acc: 0.610 Test Loss: 1.281 Test Acc: 0.610
Validation loss decreased (-0.529991 --> -0.609987).  Saving model ...
Epoch: 3 cost time: 4.768747329711914
Epoch: 3, Steps: 18 | Train Loss: 0.835 Vali Loss: 1.428 Vali Acc: 0.490 Test Loss: 1.428 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.772211074829102
Epoch: 4, Steps: 18 | Train Loss: 1.060 Vali Loss: 2.659 Vali Acc: 0.460 Test Loss: 2.659 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.020627021789551
Epoch: 5, Steps: 18 | Train Loss: 0.450 Vali Loss: 3.136 Vali Acc: 0.480 Test Loss: 3.136 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.6953535079956055
Epoch: 6, Steps: 18 | Train Loss: 1.103 Vali Loss: 2.263 Vali Acc: 0.500 Test Loss: 2.263 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.74701452255249
Epoch: 7, Steps: 18 | Train Loss: 0.996 Vali Loss: 4.486 Vali Acc: 0.520 Test Loss: 4.486 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.816472291946411
Epoch: 8, Steps: 18 | Train Loss: 1.486 Vali Loss: 3.953 Vali Acc: 0.480 Test Loss: 3.953 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.757640361785889
Epoch: 9, Steps: 18 | Train Loss: 0.784 Vali Loss: 9.223 Vali Acc: 0.500 Test Loss: 9.223 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.855509519577026
Epoch: 10, Steps: 18 | Train Loss: 1.209 Vali Loss: 4.853 Vali Acc: 0.470 Test Loss: 4.853 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.706965923309326
Epoch: 11, Steps: 18 | Train Loss: 0.832 Vali Loss: 6.212 Vali Acc: 0.480 Test Loss: 6.212 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.851292371749878
Epoch: 12, Steps: 18 | Train Loss: 0.568 Vali Loss: 8.296 Vali Acc: 0.510 Test Loss: 8.296 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 7196034
model size : 27.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.468125104904175
Epoch: 1, Steps: 18 | Train Loss: 0.936 Vali Loss: 1.224 Vali Acc: 0.430 Test Loss: 1.224 Test Acc: 0.430
Validation loss decreased (inf --> -0.429988).  Saving model ...
Epoch: 2 cost time: 4.456470251083374
Epoch: 2, Steps: 18 | Train Loss: 1.181 Vali Loss: 1.954 Vali Acc: 0.450 Test Loss: 1.954 Test Acc: 0.450
Validation loss decreased (-0.429988 --> -0.449980).  Saving model ...
Epoch: 3 cost time: 4.312808990478516
Epoch: 3, Steps: 18 | Train Loss: 0.659 Vali Loss: 1.347 Vali Acc: 0.510 Test Loss: 1.347 Test Acc: 0.510
Validation loss decreased (-0.449980 --> -0.509987).  Saving model ...
Epoch: 4 cost time: 4.261059761047363
Epoch: 4, Steps: 18 | Train Loss: 0.840 Vali Loss: 1.979 Vali Acc: 0.430 Test Loss: 1.979 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.179845333099365
Epoch: 5, Steps: 18 | Train Loss: 0.435 Vali Loss: 2.747 Vali Acc: 0.420 Test Loss: 2.747 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.03996729850769
Epoch: 6, Steps: 18 | Train Loss: 0.464 Vali Loss: 2.776 Vali Acc: 0.420 Test Loss: 2.776 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.2979044914245605
Epoch: 7, Steps: 18 | Train Loss: 0.511 Vali Loss: 2.934 Vali Acc: 0.490 Test Loss: 2.934 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.177426338195801
Epoch: 8, Steps: 18 | Train Loss: 0.178 Vali Loss: 2.586 Vali Acc: 0.420 Test Loss: 2.586 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.140324354171753
Epoch: 9, Steps: 18 | Train Loss: 0.207 Vali Loss: 2.108 Vali Acc: 0.520 Test Loss: 2.108 Test Acc: 0.520
Validation loss decreased (-0.509987 --> -0.519979).  Saving model ...
Epoch: 10 cost time: 4.154000520706177
Epoch: 10, Steps: 18 | Train Loss: 0.348 Vali Loss: 3.971 Vali Acc: 0.500 Test Loss: 3.971 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.1898088455200195
Epoch: 11, Steps: 18 | Train Loss: 0.699 Vali Loss: 3.084 Vali Acc: 0.480 Test Loss: 3.084 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.073307514190674
Epoch: 12, Steps: 18 | Train Loss: 0.418 Vali Loss: 5.191 Vali Acc: 0.500 Test Loss: 5.191 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.253763914108276
Epoch: 13, Steps: 18 | Train Loss: 0.233 Vali Loss: 4.576 Vali Acc: 0.450 Test Loss: 4.576 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.148390769958496
Epoch: 14, Steps: 18 | Train Loss: 0.351 Vali Loss: 3.916 Vali Acc: 0.440 Test Loss: 3.916 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.159070730209351
Epoch: 15, Steps: 18 | Train Loss: 0.560 Vali Loss: 7.438 Vali Acc: 0.510 Test Loss: 7.438 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.118070363998413
Epoch: 16, Steps: 18 | Train Loss: 0.409 Vali Loss: 3.984 Vali Acc: 0.550 Test Loss: 3.984 Test Acc: 0.550
Validation loss decreased (-0.519979 --> -0.549960).  Saving model ...
Epoch: 17 cost time: 4.425804138183594
Epoch: 17, Steps: 18 | Train Loss: 0.299 Vali Loss: 3.454 Vali Acc: 0.480 Test Loss: 3.454 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.102160453796387
Epoch: 18, Steps: 18 | Train Loss: 0.203 Vali Loss: 5.489 Vali Acc: 0.540 Test Loss: 5.489 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.249122142791748
Epoch: 19, Steps: 18 | Train Loss: 0.195 Vali Loss: 5.626 Vali Acc: 0.490 Test Loss: 5.626 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.308043718338013
Epoch: 20, Steps: 18 | Train Loss: 0.124 Vali Loss: 3.370 Vali Acc: 0.540 Test Loss: 3.370 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.0787513256073
Epoch: 21, Steps: 18 | Train Loss: 0.091 Vali Loss: 5.714 Vali Acc: 0.500 Test Loss: 5.714 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.092305421829224
Epoch: 22, Steps: 18 | Train Loss: 0.329 Vali Loss: 6.108 Vali Acc: 0.540 Test Loss: 6.108 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.3434295654296875
Epoch: 23, Steps: 18 | Train Loss: 0.551 Vali Loss: 6.371 Vali Acc: 0.450 Test Loss: 6.371 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.197784423828125
Epoch: 24, Steps: 18 | Train Loss: 0.274 Vali Loss: 5.022 Vali Acc: 0.520 Test Loss: 5.022 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.248510360717773
Epoch: 25, Steps: 18 | Train Loss: 0.246 Vali Loss: 9.048 Vali Acc: 0.520 Test Loss: 9.048 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.194852113723755
Epoch: 26, Steps: 18 | Train Loss: 0.230 Vali Loss: 5.451 Vali Acc: 0.470 Test Loss: 5.451 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 6976258
model size : 26.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.9150922298431396
Epoch: 1, Steps: 18 | Train Loss: 0.879 Vali Loss: 0.981 Vali Acc: 0.450 Test Loss: 0.981 Test Acc: 0.450
Validation loss decreased (inf --> -0.449990).  Saving model ...
Epoch: 2 cost time: 2.729177713394165
Epoch: 2, Steps: 18 | Train Loss: 0.645 Vali Loss: 1.159 Vali Acc: 0.470 Test Loss: 1.159 Test Acc: 0.470
Validation loss decreased (-0.449990 --> -0.469988).  Saving model ...
Epoch: 3 cost time: 2.8692378997802734
Epoch: 3, Steps: 18 | Train Loss: 0.482 Vali Loss: 1.028 Vali Acc: 0.450 Test Loss: 1.028 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8016247749328613
Epoch: 4, Steps: 18 | Train Loss: 0.316 Vali Loss: 1.513 Vali Acc: 0.550 Test Loss: 1.513 Test Acc: 0.550
Validation loss decreased (-0.469988 --> -0.549985).  Saving model ...
Epoch: 5 cost time: 2.841031312942505
Epoch: 5, Steps: 18 | Train Loss: 0.586 Vali Loss: 1.390 Vali Acc: 0.470 Test Loss: 1.390 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7795207500457764
Epoch: 6, Steps: 18 | Train Loss: 0.347 Vali Loss: 2.366 Vali Acc: 0.600 Test Loss: 2.366 Test Acc: 0.600
Validation loss decreased (-0.549985 --> -0.599976).  Saving model ...
Epoch: 7 cost time: 2.9080488681793213
Epoch: 7, Steps: 18 | Train Loss: 0.372 Vali Loss: 1.843 Vali Acc: 0.540 Test Loss: 1.843 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7309606075286865
Epoch: 8, Steps: 18 | Train Loss: 0.314 Vali Loss: 2.926 Vali Acc: 0.540 Test Loss: 2.926 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.751688241958618
Epoch: 9, Steps: 18 | Train Loss: 0.155 Vali Loss: 2.851 Vali Acc: 0.600 Test Loss: 2.851 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.939408540725708
Epoch: 10, Steps: 18 | Train Loss: 0.443 Vali Loss: 2.179 Vali Acc: 0.490 Test Loss: 2.179 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.0589730739593506
Epoch: 11, Steps: 18 | Train Loss: 0.473 Vali Loss: 3.041 Vali Acc: 0.520 Test Loss: 3.041 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.798279285430908
Epoch: 12, Steps: 18 | Train Loss: 0.874 Vali Loss: 3.109 Vali Acc: 0.470 Test Loss: 3.109 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7663724422454834
Epoch: 13, Steps: 18 | Train Loss: 0.550 Vali Loss: 5.602 Vali Acc: 0.480 Test Loss: 5.602 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.826810121536255
Epoch: 14, Steps: 18 | Train Loss: 0.341 Vali Loss: 4.696 Vali Acc: 0.500 Test Loss: 4.696 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.8049964904785156
Epoch: 15, Steps: 18 | Train Loss: 0.282 Vali Loss: 2.171 Vali Acc: 0.540 Test Loss: 2.171 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.7083935737609863
Epoch: 16, Steps: 18 | Train Loss: 0.317 Vali Loss: 3.737 Vali Acc: 0.470 Test Loss: 3.737 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 6887554
model size : 26.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.629436492919922
Epoch: 1, Steps: 18 | Train Loss: 0.789 Vali Loss: 0.910 Vali Acc: 0.490 Test Loss: 0.910 Test Acc: 0.490
Validation loss decreased (inf --> -0.489991).  Saving model ...
Epoch: 2 cost time: 3.3194632530212402
Epoch: 2, Steps: 18 | Train Loss: 0.743 Vali Loss: 0.718 Vali Acc: 0.510 Test Loss: 0.718 Test Acc: 0.510
Validation loss decreased (-0.489991 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 3.482966184616089
Epoch: 3, Steps: 18 | Train Loss: 0.501 Vali Loss: 1.232 Vali Acc: 0.540 Test Loss: 1.232 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539988).  Saving model ...
Epoch: 4 cost time: 3.438697099685669
Epoch: 4, Steps: 18 | Train Loss: 0.502 Vali Loss: 1.264 Vali Acc: 0.490 Test Loss: 1.264 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.39424467086792
Epoch: 5, Steps: 18 | Train Loss: 0.254 Vali Loss: 1.468 Vali Acc: 0.530 Test Loss: 1.468 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.39157772064209
Epoch: 6, Steps: 18 | Train Loss: 0.273 Vali Loss: 1.162 Vali Acc: 0.500 Test Loss: 1.162 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.463507652282715
Epoch: 7, Steps: 18 | Train Loss: 0.211 Vali Loss: 1.872 Vali Acc: 0.510 Test Loss: 1.872 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.3610541820526123
Epoch: 8, Steps: 18 | Train Loss: 0.170 Vali Loss: 1.647 Vali Acc: 0.560 Test Loss: 1.647 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559984).  Saving model ...
Epoch: 9 cost time: 3.395263433456421
Epoch: 9, Steps: 18 | Train Loss: 0.333 Vali Loss: 2.568 Vali Acc: 0.550 Test Loss: 2.568 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4273927211761475
Epoch: 10, Steps: 18 | Train Loss: 0.143 Vali Loss: 2.034 Vali Acc: 0.570 Test Loss: 2.034 Test Acc: 0.570
Validation loss decreased (-0.559984 --> -0.569980).  Saving model ...
Epoch: 11 cost time: 3.3649697303771973
Epoch: 11, Steps: 18 | Train Loss: 0.401 Vali Loss: 2.083 Vali Acc: 0.460 Test Loss: 2.083 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.418717861175537
Epoch: 12, Steps: 18 | Train Loss: 0.139 Vali Loss: 2.173 Vali Acc: 0.450 Test Loss: 2.173 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.440836191177368
Epoch: 13, Steps: 18 | Train Loss: 0.197 Vali Loss: 2.032 Vali Acc: 0.500 Test Loss: 2.032 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.3789751529693604
Epoch: 14, Steps: 18 | Train Loss: 0.142 Vali Loss: 2.183 Vali Acc: 0.490 Test Loss: 2.183 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.372246265411377
Epoch: 15, Steps: 18 | Train Loss: 0.158 Vali Loss: 2.777 Vali Acc: 0.500 Test Loss: 2.777 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.3739891052246094
Epoch: 16, Steps: 18 | Train Loss: 0.069 Vali Loss: 1.830 Vali Acc: 0.510 Test Loss: 1.830 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.447059392929077
Epoch: 17, Steps: 18 | Train Loss: 0.073 Vali Loss: 1.685 Vali Acc: 0.530 Test Loss: 1.685 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.2388503551483154
Epoch: 18, Steps: 18 | Train Loss: 0.220 Vali Loss: 2.480 Vali Acc: 0.550 Test Loss: 2.480 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.556215763092041
Epoch: 19, Steps: 18 | Train Loss: 0.104 Vali Loss: 2.047 Vali Acc: 0.560 Test Loss: 2.047 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.3274807929992676
Epoch: 20, Steps: 18 | Train Loss: 0.038 Vali Loss: 3.454 Vali Acc: 0.490 Test Loss: 3.454 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 6792066
model size : 26.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.265472650527954
Epoch: 1, Steps: 18 | Train Loss: 0.806 Vali Loss: 1.025 Vali Acc: 0.580 Test Loss: 1.025 Test Acc: 0.580
Validation loss decreased (inf --> -0.579990).  Saving model ...
Epoch: 2 cost time: 3.2055721282958984
Epoch: 2, Steps: 18 | Train Loss: 0.733 Vali Loss: 1.272 Vali Acc: 0.550 Test Loss: 1.272 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1633970737457275
Epoch: 3, Steps: 18 | Train Loss: 0.539 Vali Loss: 0.811 Vali Acc: 0.460 Test Loss: 0.811 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.2007668018341064
Epoch: 4, Steps: 18 | Train Loss: 0.458 Vali Loss: 1.038 Vali Acc: 0.480 Test Loss: 1.038 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.0376734733581543
Epoch: 5, Steps: 18 | Train Loss: 0.452 Vali Loss: 1.007 Vali Acc: 0.460 Test Loss: 1.007 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.0460610389709473
Epoch: 6, Steps: 18 | Train Loss: 0.258 Vali Loss: 0.791 Vali Acc: 0.510 Test Loss: 0.791 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.1670124530792236
Epoch: 7, Steps: 18 | Train Loss: 0.131 Vali Loss: 1.689 Vali Acc: 0.520 Test Loss: 1.689 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.0022196769714355
Epoch: 8, Steps: 18 | Train Loss: 0.134 Vali Loss: 1.744 Vali Acc: 0.540 Test Loss: 1.744 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.0834109783172607
Epoch: 9, Steps: 18 | Train Loss: 0.171 Vali Loss: 1.711 Vali Acc: 0.540 Test Loss: 1.711 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.982335329055786
Epoch: 10, Steps: 18 | Train Loss: 0.089 Vali Loss: 1.696 Vali Acc: 0.530 Test Loss: 1.696 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.0515289306640625
Epoch: 11, Steps: 18 | Train Loss: 0.129 Vali Loss: 2.170 Vali Acc: 0.540 Test Loss: 2.170 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 6762114
model size : 25.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.474518060684204
Epoch: 1, Steps: 18 | Train Loss: 0.768 Vali Loss: 0.734 Vali Acc: 0.410 Test Loss: 0.734 Test Acc: 0.410
Validation loss decreased (inf --> -0.409993).  Saving model ...
Epoch: 2 cost time: 2.3060994148254395
Epoch: 2, Steps: 18 | Train Loss: 0.645 Vali Loss: 0.721 Vali Acc: 0.540 Test Loss: 0.721 Test Acc: 0.540
Validation loss decreased (-0.409993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 2.2729668617248535
Epoch: 3, Steps: 18 | Train Loss: 0.553 Vali Loss: 0.773 Vali Acc: 0.500 Test Loss: 0.773 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.288888454437256
Epoch: 4, Steps: 18 | Train Loss: 0.428 Vali Loss: 0.764 Vali Acc: 0.530 Test Loss: 0.764 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3966305255889893
Epoch: 5, Steps: 18 | Train Loss: 0.292 Vali Loss: 0.917 Vali Acc: 0.540 Test Loss: 0.917 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.301516056060791
Epoch: 6, Steps: 18 | Train Loss: 0.207 Vali Loss: 0.768 Vali Acc: 0.600 Test Loss: 0.768 Test Acc: 0.600
Validation loss decreased (-0.539993 --> -0.599992).  Saving model ...
Epoch: 7 cost time: 2.2788350582122803
Epoch: 7, Steps: 18 | Train Loss: 0.135 Vali Loss: 1.098 Vali Acc: 0.530 Test Loss: 1.098 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.252847671508789
Epoch: 8, Steps: 18 | Train Loss: 0.128 Vali Loss: 0.920 Vali Acc: 0.570 Test Loss: 0.920 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3533921241760254
Epoch: 9, Steps: 18 | Train Loss: 0.110 Vali Loss: 1.028 Vali Acc: 0.570 Test Loss: 1.028 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.278325319290161
Epoch: 10, Steps: 18 | Train Loss: 0.251 Vali Loss: 2.067 Vali Acc: 0.560 Test Loss: 2.067 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.3550965785980225
Epoch: 11, Steps: 18 | Train Loss: 0.208 Vali Loss: 2.641 Vali Acc: 0.570 Test Loss: 2.641 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2770886421203613
Epoch: 12, Steps: 18 | Train Loss: 0.192 Vali Loss: 1.157 Vali Acc: 0.540 Test Loss: 1.157 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.2958059310913086
Epoch: 13, Steps: 18 | Train Loss: 0.069 Vali Loss: 1.363 Vali Acc: 0.560 Test Loss: 1.363 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.2922937870025635
Epoch: 14, Steps: 18 | Train Loss: 0.099 Vali Loss: 1.297 Vali Acc: 0.560 Test Loss: 1.297 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.305647373199463
Epoch: 15, Steps: 18 | Train Loss: 0.252 Vali Loss: 1.828 Vali Acc: 0.480 Test Loss: 1.828 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.3714356422424316
Epoch: 16, Steps: 18 | Train Loss: 0.094 Vali Loss: 1.108 Vali Acc: 0.530 Test Loss: 1.108 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 6748546
model size : 25.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.0318989753723145
Epoch: 1, Steps: 18 | Train Loss: 0.824 Vali Loss: 1.550 Vali Acc: 0.510 Test Loss: 1.550 Test Acc: 0.510
Validation loss decreased (inf --> -0.509984).  Saving model ...
Epoch: 2 cost time: 3.478214979171753
Epoch: 2, Steps: 18 | Train Loss: 1.142 Vali Loss: 1.708 Vali Acc: 0.520 Test Loss: 1.708 Test Acc: 0.520
Validation loss decreased (-0.509984 --> -0.519983).  Saving model ...
Epoch: 3 cost time: 2.9733810424804688
Epoch: 3, Steps: 18 | Train Loss: 0.777 Vali Loss: 1.304 Vali Acc: 0.580 Test Loss: 1.304 Test Acc: 0.580
Validation loss decreased (-0.519983 --> -0.579987).  Saving model ...
Epoch: 4 cost time: 2.812739133834839
Epoch: 4, Steps: 18 | Train Loss: 0.742 Vali Loss: 4.639 Vali Acc: 0.570 Test Loss: 4.639 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.759124755859375
Epoch: 5, Steps: 18 | Train Loss: 0.507 Vali Loss: 3.238 Vali Acc: 0.520 Test Loss: 3.238 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.5642452239990234
Epoch: 6, Steps: 18 | Train Loss: 1.025 Vali Loss: 5.090 Vali Acc: 0.480 Test Loss: 5.090 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.9322168827056885
Epoch: 7, Steps: 18 | Train Loss: 0.672 Vali Loss: 7.556 Vali Acc: 0.510 Test Loss: 7.556 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.755497455596924
Epoch: 8, Steps: 18 | Train Loss: 0.535 Vali Loss: 5.904 Vali Acc: 0.530 Test Loss: 5.904 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.8240926265716553
Epoch: 9, Steps: 18 | Train Loss: 0.207 Vali Loss: 5.039 Vali Acc: 0.460 Test Loss: 5.039 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.8844189643859863
Epoch: 10, Steps: 18 | Train Loss: 0.408 Vali Loss: 5.099 Vali Acc: 0.540 Test Loss: 5.099 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.820768117904663
Epoch: 11, Steps: 18 | Train Loss: 0.622 Vali Loss: 4.101 Vali Acc: 0.530 Test Loss: 4.101 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.0034286975860596
Epoch: 12, Steps: 18 | Train Loss: 0.222 Vali Loss: 5.030 Vali Acc: 0.550 Test Loss: 5.030 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.1008265018463135
Epoch: 13, Steps: 18 | Train Loss: 0.109 Vali Loss: 4.879 Vali Acc: 0.530 Test Loss: 4.879 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2855938
model size : 10.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.27380108833313
Epoch: 1, Steps: 18 | Train Loss: 0.908 Vali Loss: 1.377 Vali Acc: 0.530 Test Loss: 1.377 Test Acc: 0.530
Validation loss decreased (inf --> -0.529986).  Saving model ...
Epoch: 2 cost time: 2.4050750732421875
Epoch: 2, Steps: 18 | Train Loss: 0.874 Vali Loss: 1.938 Vali Acc: 0.530 Test Loss: 1.938 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.198955535888672
Epoch: 3, Steps: 18 | Train Loss: 0.792 Vali Loss: 1.437 Vali Acc: 0.610 Test Loss: 1.437 Test Acc: 0.610
Validation loss decreased (-0.529986 --> -0.609986).  Saving model ...
Epoch: 4 cost time: 2.056751251220703
Epoch: 4, Steps: 18 | Train Loss: 0.466 Vali Loss: 1.035 Vali Acc: 0.520 Test Loss: 1.035 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2599828243255615
Epoch: 5, Steps: 18 | Train Loss: 0.211 Vali Loss: 1.267 Vali Acc: 0.540 Test Loss: 1.267 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9094109535217285
Epoch: 6, Steps: 18 | Train Loss: 0.165 Vali Loss: 1.157 Vali Acc: 0.540 Test Loss: 1.157 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9557979106903076
Epoch: 7, Steps: 18 | Train Loss: 0.511 Vali Loss: 1.781 Vali Acc: 0.450 Test Loss: 1.781 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.106109380722046
Epoch: 8, Steps: 18 | Train Loss: 0.517 Vali Loss: 2.481 Vali Acc: 0.450 Test Loss: 2.481 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.309919595718384
Epoch: 9, Steps: 18 | Train Loss: 0.154 Vali Loss: 3.244 Vali Acc: 0.500 Test Loss: 3.244 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.145552635192871
Epoch: 10, Steps: 18 | Train Loss: 0.285 Vali Loss: 2.338 Vali Acc: 0.480 Test Loss: 2.338 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.0151405334472656
Epoch: 11, Steps: 18 | Train Loss: 0.115 Vali Loss: 4.388 Vali Acc: 0.440 Test Loss: 4.388 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.173271894454956
Epoch: 12, Steps: 18 | Train Loss: 0.193 Vali Loss: 3.665 Vali Acc: 0.430 Test Loss: 3.665 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8420355319976807
Epoch: 13, Steps: 18 | Train Loss: 0.232 Vali Loss: 3.239 Vali Acc: 0.480 Test Loss: 3.239 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2549442
model size : 9.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.717418909072876
Epoch: 1, Steps: 18 | Train Loss: 0.803 Vali Loss: 0.871 Vali Acc: 0.580 Test Loss: 0.871 Test Acc: 0.580
Validation loss decreased (inf --> -0.579991).  Saving model ...
Epoch: 2 cost time: 2.5702290534973145
Epoch: 2, Steps: 18 | Train Loss: 0.792 Vali Loss: 0.862 Vali Acc: 0.580 Test Loss: 0.862 Test Acc: 0.580
Validation loss decreased (-0.579991 --> -0.579991).  Saving model ...
Epoch: 3 cost time: 2.4899048805236816
Epoch: 3, Steps: 18 | Train Loss: 0.493 Vali Loss: 0.736 Vali Acc: 0.570 Test Loss: 0.736 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.618534564971924
Epoch: 4, Steps: 18 | Train Loss: 0.345 Vali Loss: 1.019 Vali Acc: 0.510 Test Loss: 1.019 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3628592491149902
Epoch: 5, Steps: 18 | Train Loss: 0.196 Vali Loss: 1.418 Vali Acc: 0.620 Test Loss: 1.418 Test Acc: 0.620
Validation loss decreased (-0.579991 --> -0.619986).  Saving model ...
Epoch: 6 cost time: 2.4923346042633057
Epoch: 6, Steps: 18 | Train Loss: 0.189 Vali Loss: 1.335 Vali Acc: 0.490 Test Loss: 1.335 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7279977798461914
Epoch: 7, Steps: 18 | Train Loss: 0.105 Vali Loss: 2.098 Vali Acc: 0.570 Test Loss: 2.098 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6364710330963135
Epoch: 8, Steps: 18 | Train Loss: 0.293 Vali Loss: 1.109 Vali Acc: 0.570 Test Loss: 1.109 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.624523401260376
Epoch: 9, Steps: 18 | Train Loss: 0.125 Vali Loss: 1.607 Vali Acc: 0.510 Test Loss: 1.607 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.523984909057617
Epoch: 10, Steps: 18 | Train Loss: 0.083 Vali Loss: 1.236 Vali Acc: 0.590 Test Loss: 1.236 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.6812031269073486
Epoch: 11, Steps: 18 | Train Loss: 0.095 Vali Loss: 1.831 Vali Acc: 0.580 Test Loss: 1.831 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.6316871643066406
Epoch: 12, Steps: 18 | Train Loss: 0.143 Vali Loss: 1.920 Vali Acc: 0.510 Test Loss: 1.920 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.5284423828125
Epoch: 13, Steps: 18 | Train Loss: 0.105 Vali Loss: 2.379 Vali Acc: 0.470 Test Loss: 2.379 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.479318141937256
Epoch: 14, Steps: 18 | Train Loss: 0.049 Vali Loss: 2.001 Vali Acc: 0.510 Test Loss: 2.001 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.53757643699646
Epoch: 15, Steps: 18 | Train Loss: 0.070 Vali Loss: 2.134 Vali Acc: 0.500 Test Loss: 2.134 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 2439554
model size : 9.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.459284543991089
Epoch: 1, Steps: 18 | Train Loss: 0.776 Vali Loss: 1.009 Vali Acc: 0.580 Test Loss: 1.009 Test Acc: 0.580
Validation loss decreased (inf --> -0.579990).  Saving model ...
Epoch: 2 cost time: 2.289942741394043
Epoch: 2, Steps: 18 | Train Loss: 0.812 Vali Loss: 1.264 Vali Acc: 0.540 Test Loss: 1.264 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0949840545654297
Epoch: 3, Steps: 18 | Train Loss: 0.702 Vali Loss: 1.106 Vali Acc: 0.620 Test Loss: 1.106 Test Acc: 0.620
Validation loss decreased (-0.579990 --> -0.619989).  Saving model ...
Epoch: 4 cost time: 1.9749038219451904
Epoch: 4, Steps: 18 | Train Loss: 0.435 Vali Loss: 0.841 Vali Acc: 0.510 Test Loss: 0.841 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2335221767425537
Epoch: 5, Steps: 18 | Train Loss: 0.341 Vali Loss: 1.038 Vali Acc: 0.560 Test Loss: 1.038 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1441473960876465
Epoch: 6, Steps: 18 | Train Loss: 0.145 Vali Loss: 1.325 Vali Acc: 0.560 Test Loss: 1.325 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0862252712249756
Epoch: 7, Steps: 18 | Train Loss: 0.146 Vali Loss: 1.242 Vali Acc: 0.510 Test Loss: 1.242 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1438307762145996
Epoch: 8, Steps: 18 | Train Loss: 0.123 Vali Loss: 1.117 Vali Acc: 0.530 Test Loss: 1.117 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.135768413543701
Epoch: 9, Steps: 18 | Train Loss: 0.100 Vali Loss: 1.349 Vali Acc: 0.520 Test Loss: 1.349 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.163546323776245
Epoch: 10, Steps: 18 | Train Loss: 0.072 Vali Loss: 1.349 Vali Acc: 0.520 Test Loss: 1.349 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.039635419845581
Epoch: 11, Steps: 18 | Train Loss: 0.041 Vali Loss: 1.608 Vali Acc: 0.490 Test Loss: 1.608 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.109239339828491
Epoch: 12, Steps: 18 | Train Loss: 0.102 Vali Loss: 1.771 Vali Acc: 0.560 Test Loss: 1.771 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8753690719604492
Epoch: 13, Steps: 18 | Train Loss: 0.074 Vali Loss: 2.501 Vali Acc: 0.460 Test Loss: 2.501 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 2395202
model size : 9.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.941230297088623
Epoch: 1, Steps: 18 | Train Loss: 0.763 Vali Loss: 0.709 Vali Acc: 0.560 Test Loss: 0.709 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.5134499073028564
Epoch: 2, Steps: 18 | Train Loss: 0.676 Vali Loss: 0.969 Vali Acc: 0.600 Test Loss: 0.969 Test Acc: 0.600
Validation loss decreased (-0.559993 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 2.51043963432312
Epoch: 3, Steps: 18 | Train Loss: 0.562 Vali Loss: 0.964 Vali Acc: 0.620 Test Loss: 0.964 Test Acc: 0.620
Validation loss decreased (-0.599990 --> -0.619990).  Saving model ...
Epoch: 4 cost time: 2.577526569366455
Epoch: 4, Steps: 18 | Train Loss: 0.384 Vali Loss: 0.784 Vali Acc: 0.570 Test Loss: 0.784 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.548642158508301
Epoch: 5, Steps: 18 | Train Loss: 0.367 Vali Loss: 0.942 Vali Acc: 0.450 Test Loss: 0.942 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.478569984436035
Epoch: 6, Steps: 18 | Train Loss: 0.228 Vali Loss: 0.837 Vali Acc: 0.540 Test Loss: 0.837 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.517124891281128
Epoch: 7, Steps: 18 | Train Loss: 0.209 Vali Loss: 0.990 Vali Acc: 0.560 Test Loss: 0.990 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.683734655380249
Epoch: 8, Steps: 18 | Train Loss: 0.151 Vali Loss: 1.128 Vali Acc: 0.460 Test Loss: 1.128 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.3723390102386475
Epoch: 9, Steps: 18 | Train Loss: 0.109 Vali Loss: 1.232 Vali Acc: 0.570 Test Loss: 1.232 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.4928064346313477
Epoch: 10, Steps: 18 | Train Loss: 0.059 Vali Loss: 1.181 Vali Acc: 0.520 Test Loss: 1.181 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.9063560962677
Epoch: 11, Steps: 18 | Train Loss: 0.045 Vali Loss: 1.214 Vali Acc: 0.480 Test Loss: 1.214 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.4319143295288086
Epoch: 12, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.204 Vali Acc: 0.510 Test Loss: 1.204 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.4888720512390137
Epoch: 13, Steps: 18 | Train Loss: 0.037 Vali Loss: 1.369 Vali Acc: 0.490 Test Loss: 1.369 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 2347458
model size : 9.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.443714141845703
Epoch: 1, Steps: 18 | Train Loss: 0.832 Vali Loss: 0.717 Vali Acc: 0.490 Test Loss: 0.717 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.2497007846832275
Epoch: 2, Steps: 18 | Train Loss: 0.688 Vali Loss: 1.141 Vali Acc: 0.520 Test Loss: 1.141 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519989).  Saving model ...
Epoch: 3 cost time: 2.2889208793640137
Epoch: 3, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.764 Vali Acc: 0.490 Test Loss: 0.764 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.490678310394287
Epoch: 4, Steps: 18 | Train Loss: 0.501 Vali Loss: 0.783 Vali Acc: 0.510 Test Loss: 0.783 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.303799629211426
Epoch: 5, Steps: 18 | Train Loss: 0.378 Vali Loss: 0.813 Vali Acc: 0.540 Test Loss: 0.813 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539992).  Saving model ...
Epoch: 6 cost time: 2.4102468490600586
Epoch: 6, Steps: 18 | Train Loss: 0.264 Vali Loss: 0.902 Vali Acc: 0.450 Test Loss: 0.902 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.206681728363037
Epoch: 7, Steps: 18 | Train Loss: 0.192 Vali Loss: 1.074 Vali Acc: 0.530 Test Loss: 1.074 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.399420976638794
Epoch: 8, Steps: 18 | Train Loss: 0.142 Vali Loss: 0.953 Vali Acc: 0.500 Test Loss: 0.953 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.369945764541626
Epoch: 9, Steps: 18 | Train Loss: 0.100 Vali Loss: 1.031 Vali Acc: 0.500 Test Loss: 1.031 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.358050584793091
Epoch: 10, Steps: 18 | Train Loss: 0.090 Vali Loss: 1.346 Vali Acc: 0.510 Test Loss: 1.346 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.271005868911743
Epoch: 11, Steps: 18 | Train Loss: 0.061 Vali Loss: 1.093 Vali Acc: 0.460 Test Loss: 1.093 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.505160093307495
Epoch: 12, Steps: 18 | Train Loss: 0.027 Vali Loss: 1.042 Vali Acc: 0.500 Test Loss: 1.042 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.336249589920044
Epoch: 13, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.326 Vali Acc: 0.480 Test Loss: 1.326 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.4170119762420654
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.502 Vali Acc: 0.510 Test Loss: 1.502 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.5812184810638428
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.413 Vali Acc: 0.480 Test Loss: 1.413 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 2332482
model size : 8.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.9502930641174316
Epoch: 1, Steps: 18 | Train Loss: 0.772 Vali Loss: 0.767 Vali Acc: 0.440 Test Loss: 0.767 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 1.7416517734527588
Epoch: 2, Steps: 18 | Train Loss: 0.648 Vali Loss: 0.725 Vali Acc: 0.460 Test Loss: 0.725 Test Acc: 0.460
Validation loss decreased (-0.439992 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 1.6883859634399414
Epoch: 3, Steps: 18 | Train Loss: 0.541 Vali Loss: 0.757 Vali Acc: 0.530 Test Loss: 0.757 Test Acc: 0.530
Validation loss decreased (-0.459993 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 1.6691877841949463
Epoch: 4, Steps: 18 | Train Loss: 0.475 Vali Loss: 0.826 Vali Acc: 0.580 Test Loss: 0.826 Test Acc: 0.580
Validation loss decreased (-0.529992 --> -0.579992).  Saving model ...
Epoch: 5 cost time: 1.58451247215271
Epoch: 5, Steps: 18 | Train Loss: 0.355 Vali Loss: 0.883 Vali Acc: 0.560 Test Loss: 0.883 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5015110969543457
Epoch: 6, Steps: 18 | Train Loss: 0.288 Vali Loss: 0.814 Vali Acc: 0.500 Test Loss: 0.814 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.584240436553955
Epoch: 7, Steps: 18 | Train Loss: 0.205 Vali Loss: 0.980 Vali Acc: 0.560 Test Loss: 0.980 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7231619358062744
Epoch: 8, Steps: 18 | Train Loss: 0.173 Vali Loss: 0.811 Vali Acc: 0.510 Test Loss: 0.811 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9175145626068115
Epoch: 9, Steps: 18 | Train Loss: 0.125 Vali Loss: 0.819 Vali Acc: 0.550 Test Loss: 0.819 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.762364149093628
Epoch: 10, Steps: 18 | Train Loss: 0.100 Vali Loss: 0.849 Vali Acc: 0.570 Test Loss: 0.849 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6453509330749512
Epoch: 11, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.892 Vali Acc: 0.600 Test Loss: 0.892 Test Acc: 0.600
Validation loss decreased (-0.579992 --> -0.599991).  Saving model ...
Epoch: 12 cost time: 1.5934762954711914
Epoch: 12, Steps: 18 | Train Loss: 0.097 Vali Loss: 1.048 Vali Acc: 0.530 Test Loss: 1.048 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5753862857818604
Epoch: 13, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.869 Vali Acc: 0.490 Test Loss: 0.869 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7664556503295898
Epoch: 14, Steps: 18 | Train Loss: 0.052 Vali Loss: 1.112 Vali Acc: 0.550 Test Loss: 1.112 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6839430332183838
Epoch: 15, Steps: 18 | Train Loss: 0.036 Vali Loss: 1.053 Vali Acc: 0.480 Test Loss: 1.053 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7561068534851074
Epoch: 16, Steps: 18 | Train Loss: 0.037 Vali Loss: 1.427 Vali Acc: 0.470 Test Loss: 1.427 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6899454593658447
Epoch: 17, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.120 Vali Acc: 0.460 Test Loss: 1.120 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6409852504730225
Epoch: 18, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.366 Vali Acc: 0.520 Test Loss: 1.366 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6498041152954102
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.183 Vali Acc: 0.480 Test Loss: 1.183 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.583845615386963
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.192 Vali Acc: 0.510 Test Loss: 1.192 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7427406311035156
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.279 Vali Acc: 0.470 Test Loss: 1.279 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 2325698
model size : 8.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.0135929584503174
Epoch: 1, Steps: 18 | Train Loss: 0.931 Vali Loss: 0.907 Vali Acc: 0.440 Test Loss: 0.907 Test Acc: 0.440
Validation loss decreased (inf --> -0.439991).  Saving model ...
Epoch: 2 cost time: 1.7895517349243164
Epoch: 2, Steps: 18 | Train Loss: 0.688 Vali Loss: 0.711 Vali Acc: 0.530 Test Loss: 0.711 Test Acc: 0.530
Validation loss decreased (-0.439991 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.722646713256836
Epoch: 3, Steps: 18 | Train Loss: 0.563 Vali Loss: 1.041 Vali Acc: 0.540 Test Loss: 1.041 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539990).  Saving model ...
Epoch: 4 cost time: 1.8910369873046875
Epoch: 4, Steps: 18 | Train Loss: 0.412 Vali Loss: 1.646 Vali Acc: 0.490 Test Loss: 1.646 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8339338302612305
Epoch: 5, Steps: 18 | Train Loss: 0.345 Vali Loss: 2.374 Vali Acc: 0.470 Test Loss: 2.374 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.755817174911499
Epoch: 6, Steps: 18 | Train Loss: 0.453 Vali Loss: 3.120 Vali Acc: 0.430 Test Loss: 3.120 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9214966297149658
Epoch: 7, Steps: 18 | Train Loss: 0.216 Vali Loss: 2.271 Vali Acc: 0.470 Test Loss: 2.271 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8535125255584717
Epoch: 8, Steps: 18 | Train Loss: 0.233 Vali Loss: 3.351 Vali Acc: 0.500 Test Loss: 3.351 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9636366367340088
Epoch: 9, Steps: 18 | Train Loss: 0.223 Vali Loss: 2.633 Vali Acc: 0.460 Test Loss: 2.633 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.796257734298706
Epoch: 10, Steps: 18 | Train Loss: 0.118 Vali Loss: 2.900 Vali Acc: 0.490 Test Loss: 2.900 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.853996753692627
Epoch: 11, Steps: 18 | Train Loss: 0.126 Vali Loss: 4.731 Vali Acc: 0.550 Test Loss: 4.731 Test Acc: 0.550
Validation loss decreased (-0.539990 --> -0.549953).  Saving model ...
Epoch: 12 cost time: 1.834468126296997
Epoch: 12, Steps: 18 | Train Loss: 0.290 Vali Loss: 4.475 Vali Acc: 0.460 Test Loss: 4.475 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8752334117889404
Epoch: 13, Steps: 18 | Train Loss: 0.015 Vali Loss: 3.734 Vali Acc: 0.450 Test Loss: 3.734 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.816892385482788
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 4.096 Vali Acc: 0.450 Test Loss: 4.096 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.978025197982788
Epoch: 15, Steps: 18 | Train Loss: 0.009 Vali Loss: 4.441 Vali Acc: 0.480 Test Loss: 4.441 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8438572883605957
Epoch: 16, Steps: 18 | Train Loss: 0.135 Vali Loss: 3.522 Vali Acc: 0.520 Test Loss: 3.522 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7735800743103027
Epoch: 17, Steps: 18 | Train Loss: 0.096 Vali Loss: 2.558 Vali Acc: 0.610 Test Loss: 2.558 Test Acc: 0.610
Validation loss decreased (-0.549953 --> -0.609974).  Saving model ...
Epoch: 18 cost time: 1.7786803245544434
Epoch: 18, Steps: 18 | Train Loss: 0.061 Vali Loss: 4.084 Vali Acc: 0.480 Test Loss: 4.084 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.886582374572754
Epoch: 19, Steps: 18 | Train Loss: 0.170 Vali Loss: 4.931 Vali Acc: 0.500 Test Loss: 4.931 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8536713123321533
Epoch: 20, Steps: 18 | Train Loss: 0.138 Vali Loss: 3.341 Vali Acc: 0.500 Test Loss: 3.341 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.827838659286499
Epoch: 21, Steps: 18 | Train Loss: 0.070 Vali Loss: 5.094 Vali Acc: 0.520 Test Loss: 5.094 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8133885860443115
Epoch: 22, Steps: 18 | Train Loss: 0.013 Vali Loss: 3.933 Vali Acc: 0.560 Test Loss: 3.933 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9819247722625732
Epoch: 23, Steps: 18 | Train Loss: 0.027 Vali Loss: 3.964 Vali Acc: 0.560 Test Loss: 3.964 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.69097900390625
Epoch: 24, Steps: 18 | Train Loss: 0.041 Vali Loss: 4.274 Vali Acc: 0.500 Test Loss: 4.274 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8071680068969727
Epoch: 25, Steps: 18 | Train Loss: 0.011 Vali Loss: 5.200 Vali Acc: 0.470 Test Loss: 5.200 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7801556587219238
Epoch: 26, Steps: 18 | Train Loss: 0.023 Vali Loss: 6.272 Vali Acc: 0.510 Test Loss: 6.272 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.8614251613616943
Epoch: 27, Steps: 18 | Train Loss: 0.056 Vali Loss: 3.883 Vali Acc: 0.550 Test Loss: 3.883 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1165826
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.7717952728271484
Epoch: 1, Steps: 18 | Train Loss: 0.794 Vali Loss: 0.753 Vali Acc: 0.470 Test Loss: 0.753 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 1.606940746307373
Epoch: 2, Steps: 18 | Train Loss: 0.732 Vali Loss: 0.764 Vali Acc: 0.520 Test Loss: 0.764 Test Acc: 0.520
Validation loss decreased (-0.469992 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 1.5660216808319092
Epoch: 3, Steps: 18 | Train Loss: 0.675 Vali Loss: 1.002 Vali Acc: 0.500 Test Loss: 1.002 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.456756830215454
Epoch: 4, Steps: 18 | Train Loss: 0.618 Vali Loss: 0.832 Vali Acc: 0.500 Test Loss: 0.832 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5711669921875
Epoch: 5, Steps: 18 | Train Loss: 0.317 Vali Loss: 1.763 Vali Acc: 0.500 Test Loss: 1.763 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5631358623504639
Epoch: 6, Steps: 18 | Train Loss: 0.310 Vali Loss: 1.125 Vali Acc: 0.520 Test Loss: 1.125 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.418907880783081
Epoch: 7, Steps: 18 | Train Loss: 0.181 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.530773401260376
Epoch: 8, Steps: 18 | Train Loss: 0.146 Vali Loss: 1.158 Vali Acc: 0.490 Test Loss: 1.158 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4759435653686523
Epoch: 9, Steps: 18 | Train Loss: 0.074 Vali Loss: 1.517 Vali Acc: 0.510 Test Loss: 1.517 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.477975606918335
Epoch: 10, Steps: 18 | Train Loss: 0.042 Vali Loss: 1.908 Vali Acc: 0.490 Test Loss: 1.908 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4082238674163818
Epoch: 11, Steps: 18 | Train Loss: 0.032 Vali Loss: 1.199 Vali Acc: 0.520 Test Loss: 1.199 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4050049781799316
Epoch: 12, Steps: 18 | Train Loss: 0.055 Vali Loss: 2.468 Vali Acc: 0.540 Test Loss: 2.468 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539975).  Saving model ...
Epoch: 13 cost time: 1.4422860145568848
Epoch: 13, Steps: 18 | Train Loss: 0.043 Vali Loss: 1.807 Vali Acc: 0.520 Test Loss: 1.807 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6496589183807373
Epoch: 14, Steps: 18 | Train Loss: 0.038 Vali Loss: 2.498 Vali Acc: 0.440 Test Loss: 2.498 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.645491123199463
Epoch: 15, Steps: 18 | Train Loss: 0.043 Vali Loss: 2.345 Vali Acc: 0.510 Test Loss: 2.345 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6266908645629883
Epoch: 16, Steps: 18 | Train Loss: 0.033 Vali Loss: 2.002 Vali Acc: 0.520 Test Loss: 2.002 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5026450157165527
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 2.256 Vali Acc: 0.480 Test Loss: 2.256 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5357356071472168
Epoch: 18, Steps: 18 | Train Loss: 0.026 Vali Loss: 2.144 Vali Acc: 0.480 Test Loss: 2.144 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5134625434875488
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 2.066 Vali Acc: 0.480 Test Loss: 2.066 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4755356311798096
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.024 Vali Acc: 0.500 Test Loss: 2.024 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.5035336017608643
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.048 Vali Acc: 0.470 Test Loss: 2.048 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4225385189056396
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.132 Vali Acc: 0.460 Test Loss: 2.132 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 1012578
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.8544397354125977
Epoch: 1, Steps: 18 | Train Loss: 0.749 Vali Loss: 0.939 Vali Acc: 0.550 Test Loss: 0.939 Test Acc: 0.550
Validation loss decreased (inf --> -0.549991).  Saving model ...
Epoch: 2 cost time: 1.6141512393951416
Epoch: 2, Steps: 18 | Train Loss: 0.643 Vali Loss: 0.842 Vali Acc: 0.590 Test Loss: 0.842 Test Acc: 0.590
Validation loss decreased (-0.549991 --> -0.589992).  Saving model ...
Epoch: 3 cost time: 1.686382532119751
Epoch: 3, Steps: 18 | Train Loss: 0.499 Vali Loss: 0.740 Vali Acc: 0.480 Test Loss: 0.740 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6210484504699707
Epoch: 4, Steps: 18 | Train Loss: 0.425 Vali Loss: 0.811 Vali Acc: 0.560 Test Loss: 0.811 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5598740577697754
Epoch: 5, Steps: 18 | Train Loss: 0.282 Vali Loss: 1.108 Vali Acc: 0.520 Test Loss: 1.108 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6760177612304688
Epoch: 6, Steps: 18 | Train Loss: 0.244 Vali Loss: 1.011 Vali Acc: 0.540 Test Loss: 1.011 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.594151258468628
Epoch: 7, Steps: 18 | Train Loss: 0.152 Vali Loss: 1.374 Vali Acc: 0.440 Test Loss: 1.374 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6514904499053955
Epoch: 8, Steps: 18 | Train Loss: 0.135 Vali Loss: 1.250 Vali Acc: 0.480 Test Loss: 1.250 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6089484691619873
Epoch: 9, Steps: 18 | Train Loss: 0.071 Vali Loss: 1.122 Vali Acc: 0.480 Test Loss: 1.122 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5664615631103516
Epoch: 10, Steps: 18 | Train Loss: 0.036 Vali Loss: 1.255 Vali Acc: 0.430 Test Loss: 1.255 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6321399211883545
Epoch: 11, Steps: 18 | Train Loss: 0.028 Vali Loss: 1.542 Vali Acc: 0.430 Test Loss: 1.542 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.633026123046875
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.465 Vali Acc: 0.480 Test Loss: 1.465 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 957634
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.7050299644470215
Epoch: 1, Steps: 18 | Train Loss: 0.765 Vali Loss: 0.844 Vali Acc: 0.530 Test Loss: 0.844 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 1.3825314044952393
Epoch: 2, Steps: 18 | Train Loss: 0.707 Vali Loss: 0.765 Vali Acc: 0.510 Test Loss: 0.765 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.338876724243164
Epoch: 3, Steps: 18 | Train Loss: 0.591 Vali Loss: 0.690 Vali Acc: 0.540 Test Loss: 0.690 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 1.5517408847808838
Epoch: 4, Steps: 18 | Train Loss: 0.425 Vali Loss: 0.716 Vali Acc: 0.570 Test Loss: 0.716 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 5 cost time: 1.458404779434204
Epoch: 5, Steps: 18 | Train Loss: 0.361 Vali Loss: 0.743 Vali Acc: 0.560 Test Loss: 0.743 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3551135063171387
Epoch: 6, Steps: 18 | Train Loss: 0.207 Vali Loss: 0.885 Vali Acc: 0.490 Test Loss: 0.885 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.371779441833496
Epoch: 7, Steps: 18 | Train Loss: 0.123 Vali Loss: 0.806 Vali Acc: 0.550 Test Loss: 0.806 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4141108989715576
Epoch: 8, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.901 Vali Acc: 0.530 Test Loss: 0.901 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.378464937210083
Epoch: 9, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.924 Vali Acc: 0.560 Test Loss: 0.924 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3890266418457031
Epoch: 10, Steps: 18 | Train Loss: 0.031 Vali Loss: 1.019 Vali Acc: 0.500 Test Loss: 1.019 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3499767780303955
Epoch: 11, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.040 Vali Acc: 0.510 Test Loss: 1.040 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4144742488861084
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.083 Vali Acc: 0.520 Test Loss: 1.083 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4452087879180908
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.176 Vali Acc: 0.530 Test Loss: 1.176 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5093107223510742
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.188 Vali Acc: 0.520 Test Loss: 1.188 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 935458
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.804722547531128
Epoch: 1, Steps: 18 | Train Loss: 0.749 Vali Loss: 0.773 Vali Acc: 0.600 Test Loss: 0.773 Test Acc: 0.600
Validation loss decreased (inf --> -0.599992).  Saving model ...
Epoch: 2 cost time: 1.5631890296936035
Epoch: 2, Steps: 18 | Train Loss: 0.692 Vali Loss: 0.898 Vali Acc: 0.520 Test Loss: 0.898 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3996262550354004
Epoch: 3, Steps: 18 | Train Loss: 0.577 Vali Loss: 0.737 Vali Acc: 0.490 Test Loss: 0.737 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4591093063354492
Epoch: 4, Steps: 18 | Train Loss: 0.464 Vali Loss: 0.706 Vali Acc: 0.510 Test Loss: 0.706 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5813477039337158
Epoch: 5, Steps: 18 | Train Loss: 0.423 Vali Loss: 0.880 Vali Acc: 0.470 Test Loss: 0.880 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6025681495666504
Epoch: 6, Steps: 18 | Train Loss: 0.330 Vali Loss: 0.787 Vali Acc: 0.480 Test Loss: 0.787 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.525965929031372
Epoch: 7, Steps: 18 | Train Loss: 0.209 Vali Loss: 0.877 Vali Acc: 0.480 Test Loss: 0.877 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4096338748931885
Epoch: 8, Steps: 18 | Train Loss: 0.174 Vali Loss: 0.912 Vali Acc: 0.480 Test Loss: 0.912 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.447953224182129
Epoch: 9, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.971 Vali Acc: 0.510 Test Loss: 0.971 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.600412368774414
Epoch: 10, Steps: 18 | Train Loss: 0.067 Vali Loss: 1.060 Vali Acc: 0.480 Test Loss: 1.060 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.594959020614624
Epoch: 11, Steps: 18 | Train Loss: 0.055 Vali Loss: 1.082 Vali Acc: 0.490 Test Loss: 1.082 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 911586
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.7345566749572754
Epoch: 1, Steps: 18 | Train Loss: 0.705 Vali Loss: 0.730 Vali Acc: 0.530 Test Loss: 0.730 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.5584766864776611
Epoch: 2, Steps: 18 | Train Loss: 0.667 Vali Loss: 0.789 Vali Acc: 0.550 Test Loss: 0.789 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 1.5490612983703613
Epoch: 3, Steps: 18 | Train Loss: 0.571 Vali Loss: 0.723 Vali Acc: 0.490 Test Loss: 0.723 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4394996166229248
Epoch: 4, Steps: 18 | Train Loss: 0.481 Vali Loss: 0.747 Vali Acc: 0.550 Test Loss: 0.747 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 1.5777413845062256
Epoch: 5, Steps: 18 | Train Loss: 0.379 Vali Loss: 0.777 Vali Acc: 0.510 Test Loss: 0.777 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4119315147399902
Epoch: 6, Steps: 18 | Train Loss: 0.313 Vali Loss: 0.742 Vali Acc: 0.510 Test Loss: 0.742 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5979695320129395
Epoch: 7, Steps: 18 | Train Loss: 0.236 Vali Loss: 0.779 Vali Acc: 0.500 Test Loss: 0.779 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.495964765548706
Epoch: 8, Steps: 18 | Train Loss: 0.184 Vali Loss: 0.786 Vali Acc: 0.470 Test Loss: 0.786 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5890264511108398
Epoch: 9, Steps: 18 | Train Loss: 0.160 Vali Loss: 0.761 Vali Acc: 0.480 Test Loss: 0.761 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5880279541015625
Epoch: 10, Steps: 18 | Train Loss: 0.158 Vali Loss: 1.105 Vali Acc: 0.520 Test Loss: 1.105 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.506972312927246
Epoch: 11, Steps: 18 | Train Loss: 0.116 Vali Loss: 0.883 Vali Acc: 0.490 Test Loss: 0.883 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5301873683929443
Epoch: 12, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.867 Vali Acc: 0.530 Test Loss: 0.867 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4502463340759277
Epoch: 13, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.957 Vali Acc: 0.510 Test Loss: 0.957 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4764580726623535
Epoch: 14, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.985 Vali Acc: 0.490 Test Loss: 0.985 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 904098
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.5990371704101562
Epoch: 1, Steps: 18 | Train Loss: 0.744 Vali Loss: 0.770 Vali Acc: 0.390 Test Loss: 0.770 Test Acc: 0.390
Validation loss decreased (inf --> -0.389992).  Saving model ...
Epoch: 2 cost time: 1.3654556274414062
Epoch: 2, Steps: 18 | Train Loss: 0.653 Vali Loss: 0.766 Vali Acc: 0.470 Test Loss: 0.766 Test Acc: 0.470
Validation loss decreased (-0.389992 --> -0.469992).  Saving model ...
Epoch: 3 cost time: 1.3932249546051025
Epoch: 3, Steps: 18 | Train Loss: 0.580 Vali Loss: 0.785 Vali Acc: 0.490 Test Loss: 0.785 Test Acc: 0.490
Validation loss decreased (-0.469992 --> -0.489992).  Saving model ...
Epoch: 4 cost time: 1.461155891418457
Epoch: 4, Steps: 18 | Train Loss: 0.550 Vali Loss: 0.766 Vali Acc: 0.450 Test Loss: 0.766 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3930163383483887
Epoch: 5, Steps: 18 | Train Loss: 0.486 Vali Loss: 0.755 Vali Acc: 0.510 Test Loss: 0.755 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509992).  Saving model ...
Epoch: 6 cost time: 1.347444772720337
Epoch: 6, Steps: 18 | Train Loss: 0.391 Vali Loss: 0.702 Vali Acc: 0.530 Test Loss: 0.702 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529993).  Saving model ...
Epoch: 7 cost time: 1.385547161102295
Epoch: 7, Steps: 18 | Train Loss: 0.311 Vali Loss: 0.709 Vali Acc: 0.530 Test Loss: 0.709 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3405356407165527
Epoch: 8, Steps: 18 | Train Loss: 0.248 Vali Loss: 0.705 Vali Acc: 0.540 Test Loss: 0.705 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 9 cost time: 1.2844722270965576
Epoch: 9, Steps: 18 | Train Loss: 0.189 Vali Loss: 0.815 Vali Acc: 0.530 Test Loss: 0.815 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3151235580444336
Epoch: 10, Steps: 18 | Train Loss: 0.141 Vali Loss: 0.798 Vali Acc: 0.530 Test Loss: 0.798 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2994511127471924
Epoch: 11, Steps: 18 | Train Loss: 0.109 Vali Loss: 0.778 Vali Acc: 0.540 Test Loss: 0.778 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.355496883392334
Epoch: 12, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.842 Vali Acc: 0.550 Test Loss: 0.842 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 13 cost time: 1.3650975227355957
Epoch: 13, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.916 Vali Acc: 0.510 Test Loss: 0.916 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2819554805755615
Epoch: 14, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.840 Vali Acc: 0.560 Test Loss: 0.840 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 15 cost time: 1.330061912536621
Epoch: 15, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.867 Vali Acc: 0.510 Test Loss: 0.867 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2921674251556396
Epoch: 16, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.948 Vali Acc: 0.500 Test Loss: 0.948 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3317203521728516
Epoch: 17, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.015 Vali Acc: 0.510 Test Loss: 1.015 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3118319511413574
Epoch: 18, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.030 Vali Acc: 0.490 Test Loss: 1.030 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.310547113418579
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.993 Vali Acc: 0.500 Test Loss: 0.993 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2897186279296875
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.046 Vali Acc: 0.520 Test Loss: 1.046 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.346165418624878
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.026 Vali Acc: 0.520 Test Loss: 1.026 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3211302757263184
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.060 Vali Acc: 0.480 Test Loss: 1.060 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.383119821548462
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.031 Vali Acc: 0.480 Test Loss: 1.031 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3177695274353027
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.062 Vali Acc: 0.480 Test Loss: 1.062 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 900706
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.006711006164551
Epoch: 1, Steps: 18 | Train Loss: 0.832 Vali Loss: 0.868 Vali Acc: 0.480 Test Loss: 0.868 Test Acc: 0.480
Validation loss decreased (inf --> -0.479991).  Saving model ...
Epoch: 2 cost time: 4.529350996017456
Epoch: 2, Steps: 18 | Train Loss: 0.531 Vali Loss: 0.877 Vali Acc: 0.640 Test Loss: 0.877 Test Acc: 0.640
Validation loss decreased (-0.479991 --> -0.639991).  Saving model ...
Epoch: 3 cost time: 4.557614803314209
Epoch: 3, Steps: 18 | Train Loss: 0.333 Vali Loss: 0.829 Vali Acc: 0.570 Test Loss: 0.829 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.349920988082886
Epoch: 4, Steps: 18 | Train Loss: 0.225 Vali Loss: 1.163 Vali Acc: 0.490 Test Loss: 1.163 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.728553056716919
Epoch: 5, Steps: 18 | Train Loss: 0.123 Vali Loss: 1.417 Vali Acc: 0.530 Test Loss: 1.417 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.520187616348267
Epoch: 6, Steps: 18 | Train Loss: 0.066 Vali Loss: 1.408 Vali Acc: 0.450 Test Loss: 1.408 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.538083791732788
Epoch: 7, Steps: 18 | Train Loss: 0.065 Vali Loss: 1.632 Vali Acc: 0.480 Test Loss: 1.632 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.4637603759765625
Epoch: 8, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.466 Vali Acc: 0.470 Test Loss: 1.466 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.413559436798096
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.382 Vali Acc: 0.540 Test Loss: 1.382 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.4035420417785645
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.697 Vali Acc: 0.550 Test Loss: 1.697 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.159039497375488
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.616 Vali Acc: 0.530 Test Loss: 1.616 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.5596582889556885
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.904 Vali Acc: 0.510 Test Loss: 1.904 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 5311746
model size : 20.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.923003673553467
Epoch: 1, Steps: 18 | Train Loss: 0.729 Vali Loss: 0.734 Vali Acc: 0.550 Test Loss: 0.734 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 4.7084009647369385
Epoch: 2, Steps: 18 | Train Loss: 0.632 Vali Loss: 0.778 Vali Acc: 0.530 Test Loss: 0.778 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.554375648498535
Epoch: 3, Steps: 18 | Train Loss: 0.495 Vali Loss: 0.819 Vali Acc: 0.540 Test Loss: 0.819 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.7276611328125
Epoch: 4, Steps: 18 | Train Loss: 0.365 Vali Loss: 0.880 Vali Acc: 0.530 Test Loss: 0.880 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.523326635360718
Epoch: 5, Steps: 18 | Train Loss: 0.238 Vali Loss: 0.831 Vali Acc: 0.500 Test Loss: 0.831 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.631962776184082
Epoch: 6, Steps: 18 | Train Loss: 0.179 Vali Loss: 1.266 Vali Acc: 0.590 Test Loss: 1.266 Test Acc: 0.590
Validation loss decreased (-0.549993 --> -0.589987).  Saving model ...
Epoch: 7 cost time: 4.481779098510742
Epoch: 7, Steps: 18 | Train Loss: 0.107 Vali Loss: 1.139 Vali Acc: 0.470 Test Loss: 1.139 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.782984733581543
Epoch: 8, Steps: 18 | Train Loss: 0.038 Vali Loss: 1.280 Vali Acc: 0.480 Test Loss: 1.280 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.634817600250244
Epoch: 9, Steps: 18 | Train Loss: 0.035 Vali Loss: 1.595 Vali Acc: 0.530 Test Loss: 1.595 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.528081655502319
Epoch: 10, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.312 Vali Acc: 0.500 Test Loss: 1.312 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.64946436882019
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.324 Vali Acc: 0.530 Test Loss: 1.324 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.564889907836914
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.502 Vali Acc: 0.510 Test Loss: 1.502 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.566112518310547
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.617 Vali Acc: 0.470 Test Loss: 1.617 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.59272575378418
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.589 Vali Acc: 0.540 Test Loss: 1.589 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.513503789901733
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.600 Vali Acc: 0.500 Test Loss: 1.600 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.62940788269043
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.609 Vali Acc: 0.490 Test Loss: 1.609 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 5150306
model size : 19.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.184035062789917
Epoch: 1, Steps: 18 | Train Loss: 0.712 Vali Loss: 0.753 Vali Acc: 0.500 Test Loss: 0.753 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 5.039653301239014
Epoch: 2, Steps: 18 | Train Loss: 0.630 Vali Loss: 0.789 Vali Acc: 0.540 Test Loss: 0.789 Test Acc: 0.540
Validation loss decreased (-0.499992 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 5.216612339019775
Epoch: 3, Steps: 18 | Train Loss: 0.521 Vali Loss: 0.732 Vali Acc: 0.480 Test Loss: 0.732 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.985262393951416
Epoch: 4, Steps: 18 | Train Loss: 0.456 Vali Loss: 0.810 Vali Acc: 0.430 Test Loss: 0.810 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.939939498901367
Epoch: 5, Steps: 18 | Train Loss: 0.323 Vali Loss: 0.766 Vali Acc: 0.450 Test Loss: 0.766 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.1755287647247314
Epoch: 6, Steps: 18 | Train Loss: 0.217 Vali Loss: 0.787 Vali Acc: 0.550 Test Loss: 0.787 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 7 cost time: 5.13245701789856
Epoch: 7, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.967 Vali Acc: 0.560 Test Loss: 0.967 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559990).  Saving model ...
Epoch: 8 cost time: 5.222797870635986
Epoch: 8, Steps: 18 | Train Loss: 0.095 Vali Loss: 1.005 Vali Acc: 0.510 Test Loss: 1.005 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.256502389907837
Epoch: 9, Steps: 18 | Train Loss: 0.033 Vali Loss: 1.012 Vali Acc: 0.470 Test Loss: 1.012 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.05109977722168
Epoch: 10, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.131 Vali Acc: 0.510 Test Loss: 1.131 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.382941722869873
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.067 Vali Acc: 0.510 Test Loss: 1.067 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.9586803913116455
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.081 Vali Acc: 0.520 Test Loss: 1.081 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.389324426651001
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.077 Vali Acc: 0.490 Test Loss: 1.077 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.84474515914917
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.095 Vali Acc: 0.490 Test Loss: 1.095 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.479874134063721
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.116 Vali Acc: 0.480 Test Loss: 1.116 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.028896331787109
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.137 Vali Acc: 0.480 Test Loss: 1.137 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.450368165969849
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.144 Vali Acc: 0.480 Test Loss: 1.144 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 5103554
model size : 19.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.575027704238892
Epoch: 1, Steps: 18 | Train Loss: 0.724 Vali Loss: 0.734 Vali Acc: 0.490 Test Loss: 0.734 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 4.921923875808716
Epoch: 2, Steps: 18 | Train Loss: 0.649 Vali Loss: 0.802 Vali Acc: 0.560 Test Loss: 0.802 Test Acc: 0.560
Validation loss decreased (-0.489993 --> -0.559992).  Saving model ...
Epoch: 3 cost time: 5.1544482707977295
Epoch: 3, Steps: 18 | Train Loss: 0.544 Vali Loss: 0.768 Vali Acc: 0.470 Test Loss: 0.768 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.341223239898682
Epoch: 4, Steps: 18 | Train Loss: 0.419 Vali Loss: 0.862 Vali Acc: 0.530 Test Loss: 0.862 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.057825565338135
Epoch: 5, Steps: 18 | Train Loss: 0.347 Vali Loss: 0.745 Vali Acc: 0.520 Test Loss: 0.745 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.840871334075928
Epoch: 6, Steps: 18 | Train Loss: 0.218 Vali Loss: 0.826 Vali Acc: 0.500 Test Loss: 0.826 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.741511106491089
Epoch: 7, Steps: 18 | Train Loss: 0.136 Vali Loss: 0.882 Vali Acc: 0.540 Test Loss: 0.882 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.9633002281188965
Epoch: 8, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.901 Vali Acc: 0.480 Test Loss: 0.901 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.850276708602905
Epoch: 9, Steps: 18 | Train Loss: 0.048 Vali Loss: 1.005 Vali Acc: 0.520 Test Loss: 1.005 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.918776273727417
Epoch: 10, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.085 Vali Acc: 0.520 Test Loss: 1.085 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.978291273117065
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.099 Vali Acc: 0.490 Test Loss: 1.099 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.91852068901062
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.113 Vali Acc: 0.490 Test Loss: 1.113 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 5073186
model size : 19.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.2795569896698
Epoch: 1, Steps: 18 | Train Loss: 0.746 Vali Loss: 0.704 Vali Acc: 0.510 Test Loss: 0.704 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 3.9445934295654297
Epoch: 2, Steps: 18 | Train Loss: 0.667 Vali Loss: 0.717 Vali Acc: 0.480 Test Loss: 0.717 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.176520109176636
Epoch: 3, Steps: 18 | Train Loss: 0.561 Vali Loss: 0.712 Vali Acc: 0.470 Test Loss: 0.712 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.7555742263793945
Epoch: 4, Steps: 18 | Train Loss: 0.448 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.9700686931610107
Epoch: 5, Steps: 18 | Train Loss: 0.398 Vali Loss: 0.752 Vali Acc: 0.460 Test Loss: 0.752 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.048436164855957
Epoch: 6, Steps: 18 | Train Loss: 0.317 Vali Loss: 0.875 Vali Acc: 0.530 Test Loss: 0.875 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529991).  Saving model ...
Epoch: 7 cost time: 3.968536853790283
Epoch: 7, Steps: 18 | Train Loss: 0.228 Vali Loss: 0.766 Vali Acc: 0.520 Test Loss: 0.766 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.0575690269470215
Epoch: 8, Steps: 18 | Train Loss: 0.151 Vali Loss: 0.838 Vali Acc: 0.520 Test Loss: 0.838 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.17158579826355
Epoch: 9, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.926 Vali Acc: 0.510 Test Loss: 0.926 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.9894697666168213
Epoch: 10, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.886 Vali Acc: 0.500 Test Loss: 0.886 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.967362642288208
Epoch: 11, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.966 Vali Acc: 0.520 Test Loss: 0.966 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.948451042175293
Epoch: 12, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.006 Vali Acc: 0.540 Test Loss: 1.006 Test Acc: 0.540
Validation loss decreased (-0.529991 --> -0.539990).  Saving model ...
Epoch: 13 cost time: 3.97941255569458
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.103 Vali Acc: 0.530 Test Loss: 1.103 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.9646506309509277
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.104 Vali Acc: 0.530 Test Loss: 1.104 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.9924156665802
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.125 Vali Acc: 0.530 Test Loss: 1.125 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.491652727127075
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.129 Vali Acc: 0.550 Test Loss: 1.129 Test Acc: 0.550
Validation loss decreased (-0.539990 --> -0.549989).  Saving model ...
Epoch: 17 cost time: 4.1878297328948975
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.170 Vali Acc: 0.540 Test Loss: 1.170 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.874983072280884
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.176 Vali Acc: 0.540 Test Loss: 1.176 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.970984935760498
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.191 Vali Acc: 0.530 Test Loss: 1.191 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.7794535160064697
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.189 Vali Acc: 0.530 Test Loss: 1.189 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.17938494682312
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.204 Vali Acc: 0.530 Test Loss: 1.204 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.070154905319214
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.230 Vali Acc: 0.540 Test Loss: 1.230 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.144396543502808
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.237 Vali Acc: 0.540 Test Loss: 1.237 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.10402774810791
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.250 Vali Acc: 0.550 Test Loss: 1.250 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.788360357284546
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.261 Vali Acc: 0.540 Test Loss: 1.261 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.263419151306152
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.277 Vali Acc: 0.540 Test Loss: 1.277 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 5061602
model size : 19.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.8563501834869385
Epoch: 1, Steps: 18 | Train Loss: 0.720 Vali Loss: 0.701 Vali Acc: 0.460 Test Loss: 0.701 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 4.397448301315308
Epoch: 2, Steps: 18 | Train Loss: 0.666 Vali Loss: 0.720 Vali Acc: 0.450 Test Loss: 0.720 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.706577777862549
Epoch: 3, Steps: 18 | Train Loss: 0.580 Vali Loss: 0.728 Vali Acc: 0.480 Test Loss: 0.728 Test Acc: 0.480
Validation loss decreased (-0.459993 --> -0.479993).  Saving model ...
Epoch: 4 cost time: 4.694624662399292
Epoch: 4, Steps: 18 | Train Loss: 0.509 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 5 cost time: 4.555873394012451
Epoch: 5, Steps: 18 | Train Loss: 0.443 Vali Loss: 0.721 Vali Acc: 0.530 Test Loss: 0.721 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 5.022497177124023
Epoch: 6, Steps: 18 | Train Loss: 0.360 Vali Loss: 0.730 Vali Acc: 0.540 Test Loss: 0.730 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 7 cost time: 4.66513466835022
Epoch: 7, Steps: 18 | Train Loss: 0.283 Vali Loss: 0.871 Vali Acc: 0.520 Test Loss: 0.871 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.768064260482788
Epoch: 8, Steps: 18 | Train Loss: 0.290 Vali Loss: 0.891 Vali Acc: 0.560 Test Loss: 0.891 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559991).  Saving model ...
Epoch: 9 cost time: 4.509749174118042
Epoch: 9, Steps: 18 | Train Loss: 0.204 Vali Loss: 0.927 Vali Acc: 0.470 Test Loss: 0.927 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.697242498397827
Epoch: 10, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.842 Vali Acc: 0.470 Test Loss: 0.842 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.635204792022705
Epoch: 11, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.909 Vali Acc: 0.460 Test Loss: 0.909 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.8505775928497314
Epoch: 12, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.957 Vali Acc: 0.510 Test Loss: 0.957 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.809317588806152
Epoch: 13, Steps: 18 | Train Loss: 0.029 Vali Loss: 1.039 Vali Acc: 0.480 Test Loss: 1.039 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.521340370178223
Epoch: 14, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.134 Vali Acc: 0.480 Test Loss: 1.134 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.075881481170654
Epoch: 15, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.155 Vali Acc: 0.460 Test Loss: 1.155 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.64327073097229
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.174 Vali Acc: 0.440 Test Loss: 1.174 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.931313991546631
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.190 Vali Acc: 0.480 Test Loss: 1.190 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.748585939407349
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.227 Vali Acc: 0.480 Test Loss: 1.227 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 5050018
model size : 19.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.061980247497559
Epoch: 1, Steps: 18 | Train Loss: 0.708 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 3.77789044380188
Epoch: 2, Steps: 18 | Train Loss: 0.647 Vali Loss: 0.733 Vali Acc: 0.490 Test Loss: 0.733 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6940276622772217
Epoch: 3, Steps: 18 | Train Loss: 0.628 Vali Loss: 0.731 Vali Acc: 0.540 Test Loss: 0.731 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 3.754718780517578
Epoch: 4, Steps: 18 | Train Loss: 0.547 Vali Loss: 0.713 Vali Acc: 0.550 Test Loss: 0.713 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 3.763477325439453
Epoch: 5, Steps: 18 | Train Loss: 0.479 Vali Loss: 0.741 Vali Acc: 0.490 Test Loss: 0.741 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.6323511600494385
Epoch: 6, Steps: 18 | Train Loss: 0.420 Vali Loss: 0.735 Vali Acc: 0.500 Test Loss: 0.735 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.884296178817749
Epoch: 7, Steps: 18 | Train Loss: 0.353 Vali Loss: 0.771 Vali Acc: 0.480 Test Loss: 0.771 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.7599496841430664
Epoch: 8, Steps: 18 | Train Loss: 0.288 Vali Loss: 0.830 Vali Acc: 0.550 Test Loss: 0.830 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.762014150619507
Epoch: 9, Steps: 18 | Train Loss: 0.221 Vali Loss: 0.816 Vali Acc: 0.510 Test Loss: 0.816 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.585177183151245
Epoch: 10, Steps: 18 | Train Loss: 0.194 Vali Loss: 0.873 Vali Acc: 0.470 Test Loss: 0.873 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.9672465324401855
Epoch: 11, Steps: 18 | Train Loss: 0.115 Vali Loss: 0.886 Vali Acc: 0.510 Test Loss: 0.886 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.678210735321045
Epoch: 12, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.934 Vali Acc: 0.460 Test Loss: 0.934 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.5420897006988525
Epoch: 13, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.998 Vali Acc: 0.460 Test Loss: 0.998 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.8395729064941406
Epoch: 14, Steps: 18 | Train Loss: 0.029 Vali Loss: 1.080 Vali Acc: 0.460 Test Loss: 1.080 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 5038434
model size : 19.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.328284502029419
Epoch: 1, Steps: 18 | Train Loss: 0.779 Vali Loss: 0.740 Vali Acc: 0.470 Test Loss: 0.740 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 4.940182447433472
Epoch: 2, Steps: 18 | Train Loss: 0.662 Vali Loss: 0.868 Vali Acc: 0.530 Test Loss: 0.868 Test Acc: 0.530
Validation loss decreased (-0.469993 --> -0.529991).  Saving model ...
Epoch: 3 cost time: 4.554070949554443
Epoch: 3, Steps: 18 | Train Loss: 0.352 Vali Loss: 1.022 Vali Acc: 0.550 Test Loss: 1.022 Test Acc: 0.550
Validation loss decreased (-0.529991 --> -0.549990).  Saving model ...
Epoch: 4 cost time: 4.402232646942139
Epoch: 4, Steps: 18 | Train Loss: 0.201 Vali Loss: 1.366 Vali Acc: 0.450 Test Loss: 1.366 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.527277708053589
Epoch: 5, Steps: 18 | Train Loss: 0.130 Vali Loss: 1.287 Vali Acc: 0.530 Test Loss: 1.287 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.557135105133057
Epoch: 6, Steps: 18 | Train Loss: 0.054 Vali Loss: 2.100 Vali Acc: 0.430 Test Loss: 2.100 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.290793180465698
Epoch: 7, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.377 Vali Acc: 0.520 Test Loss: 1.377 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.97468900680542
Epoch: 8, Steps: 18 | Train Loss: 0.035 Vali Loss: 1.985 Vali Acc: 0.520 Test Loss: 1.985 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.918999910354614
Epoch: 9, Steps: 18 | Train Loss: 0.038 Vali Loss: 1.610 Vali Acc: 0.490 Test Loss: 1.610 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.896996736526489
Epoch: 10, Steps: 18 | Train Loss: 0.031 Vali Loss: 2.393 Vali Acc: 0.500 Test Loss: 2.393 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.488543748855591
Epoch: 11, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.639 Vali Acc: 0.510 Test Loss: 1.639 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.489940643310547
Epoch: 12, Steps: 18 | Train Loss: 0.043 Vali Loss: 1.498 Vali Acc: 0.490 Test Loss: 1.498 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.340083599090576
Epoch: 13, Steps: 18 | Train Loss: 0.029 Vali Loss: 2.228 Vali Acc: 0.500 Test Loss: 2.228 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 5254402
model size : 20.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.7857325077056885
Epoch: 1, Steps: 18 | Train Loss: 0.758 Vali Loss: 0.742 Vali Acc: 0.480 Test Loss: 0.742 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 4.639559268951416
Epoch: 2, Steps: 18 | Train Loss: 0.689 Vali Loss: 0.813 Vali Acc: 0.520 Test Loss: 0.813 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 4.298989772796631
Epoch: 3, Steps: 18 | Train Loss: 0.517 Vali Loss: 0.808 Vali Acc: 0.550 Test Loss: 0.808 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 4.679374694824219
Epoch: 4, Steps: 18 | Train Loss: 0.376 Vali Loss: 0.807 Vali Acc: 0.460 Test Loss: 0.807 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.679230451583862
Epoch: 5, Steps: 18 | Train Loss: 0.229 Vali Loss: 0.967 Vali Acc: 0.550 Test Loss: 0.967 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.685309648513794
Epoch: 6, Steps: 18 | Train Loss: 0.160 Vali Loss: 1.110 Vali Acc: 0.450 Test Loss: 1.110 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.369242429733276
Epoch: 7, Steps: 18 | Train Loss: 0.066 Vali Loss: 1.173 Vali Acc: 0.550 Test Loss: 1.173 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.639554977416992
Epoch: 8, Steps: 18 | Train Loss: 0.035 Vali Loss: 1.264 Vali Acc: 0.480 Test Loss: 1.264 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.471309661865234
Epoch: 9, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.349 Vali Acc: 0.440 Test Loss: 1.349 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.913571119308472
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.6482625007629395
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.176 Vali Acc: 0.520 Test Loss: 1.176 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.607917547225952
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.242 Vali Acc: 0.520 Test Loss: 1.242 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.564848899841309
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.293 Vali Acc: 0.520 Test Loss: 1.293 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 5092962
model size : 19.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.6245880126953125
Epoch: 1, Steps: 18 | Train Loss: 0.715 Vali Loss: 0.725 Vali Acc: 0.460 Test Loss: 0.725 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 5.383540868759155
Epoch: 2, Steps: 18 | Train Loss: 0.623 Vali Loss: 0.711 Vali Acc: 0.570 Test Loss: 0.711 Test Acc: 0.570
Validation loss decreased (-0.459993 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 5.49862265586853
Epoch: 3, Steps: 18 | Train Loss: 0.518 Vali Loss: 0.816 Vali Acc: 0.540 Test Loss: 0.816 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.882789850234985
Epoch: 4, Steps: 18 | Train Loss: 0.451 Vali Loss: 0.788 Vali Acc: 0.470 Test Loss: 0.788 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.597437143325806
Epoch: 5, Steps: 18 | Train Loss: 0.294 Vali Loss: 0.750 Vali Acc: 0.530 Test Loss: 0.750 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.4693779945373535
Epoch: 6, Steps: 18 | Train Loss: 0.171 Vali Loss: 0.814 Vali Acc: 0.480 Test Loss: 0.814 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.373139381408691
Epoch: 7, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.920 Vali Acc: 0.480 Test Loss: 0.920 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.341643571853638
Epoch: 8, Steps: 18 | Train Loss: 0.044 Vali Loss: 1.166 Vali Acc: 0.440 Test Loss: 1.166 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.21002197265625
Epoch: 9, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.097 Vali Acc: 0.520 Test Loss: 1.097 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.335313081741333
Epoch: 10, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.064 Vali Acc: 0.490 Test Loss: 1.064 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.297339677810669
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.104 Vali Acc: 0.500 Test Loss: 1.104 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.423194169998169
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.116 Vali Acc: 0.490 Test Loss: 1.116 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 5046210
model size : 19.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.4582178592681885
Epoch: 1, Steps: 18 | Train Loss: 0.716 Vali Loss: 0.733 Vali Acc: 0.440 Test Loss: 0.733 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 5.376800060272217
Epoch: 2, Steps: 18 | Train Loss: 0.679 Vali Loss: 0.744 Vali Acc: 0.540 Test Loss: 0.744 Test Acc: 0.540
Validation loss decreased (-0.439993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 5.31464147567749
Epoch: 3, Steps: 18 | Train Loss: 0.577 Vali Loss: 0.764 Vali Acc: 0.480 Test Loss: 0.764 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.227609634399414
Epoch: 4, Steps: 18 | Train Loss: 0.485 Vali Loss: 0.837 Vali Acc: 0.540 Test Loss: 0.837 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.226414680480957
Epoch: 5, Steps: 18 | Train Loss: 0.356 Vali Loss: 0.813 Vali Acc: 0.490 Test Loss: 0.813 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.241287708282471
Epoch: 6, Steps: 18 | Train Loss: 0.251 Vali Loss: 0.827 Vali Acc: 0.480 Test Loss: 0.827 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.245362281799316
Epoch: 7, Steps: 18 | Train Loss: 0.155 Vali Loss: 0.797 Vali Acc: 0.530 Test Loss: 0.797 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.979487895965576
Epoch: 8, Steps: 18 | Train Loss: 0.097 Vali Loss: 0.927 Vali Acc: 0.510 Test Loss: 0.927 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.359192609786987
Epoch: 9, Steps: 18 | Train Loss: 0.048 Vali Loss: 1.043 Vali Acc: 0.530 Test Loss: 1.043 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.133776664733887
Epoch: 10, Steps: 18 | Train Loss: 0.041 Vali Loss: 1.078 Vali Acc: 0.540 Test Loss: 1.078 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.1520490646362305
Epoch: 11, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.125 Vali Acc: 0.500 Test Loss: 1.125 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.138376474380493
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.181 Vali Acc: 0.490 Test Loss: 1.181 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 5015842
model size : 19.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.35246205329895
Epoch: 1, Steps: 18 | Train Loss: 0.704 Vali Loss: 0.732 Vali Acc: 0.400 Test Loss: 0.732 Test Acc: 0.400
Validation loss decreased (inf --> -0.399993).  Saving model ...
Epoch: 2 cost time: 4.235443592071533
Epoch: 2, Steps: 18 | Train Loss: 0.659 Vali Loss: 0.743 Vali Acc: 0.480 Test Loss: 0.743 Test Acc: 0.480
Validation loss decreased (-0.399993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 4.511505603790283
Epoch: 3, Steps: 18 | Train Loss: 0.565 Vali Loss: 0.753 Vali Acc: 0.530 Test Loss: 0.753 Test Acc: 0.530
Validation loss decreased (-0.479993 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 3.741250991821289
Epoch: 4, Steps: 18 | Train Loss: 0.474 Vali Loss: 0.757 Vali Acc: 0.540 Test Loss: 0.757 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 4.16212010383606
Epoch: 5, Steps: 18 | Train Loss: 0.389 Vali Loss: 0.823 Vali Acc: 0.460 Test Loss: 0.823 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.832101583480835
Epoch: 6, Steps: 18 | Train Loss: 0.294 Vali Loss: 0.821 Vali Acc: 0.510 Test Loss: 0.821 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.8309037685394287
Epoch: 7, Steps: 18 | Train Loss: 0.210 Vali Loss: 0.899 Vali Acc: 0.530 Test Loss: 0.899 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.850525379180908
Epoch: 8, Steps: 18 | Train Loss: 0.148 Vali Loss: 0.895 Vali Acc: 0.530 Test Loss: 0.895 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.834049940109253
Epoch: 9, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.963 Vali Acc: 0.490 Test Loss: 0.963 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.489103078842163
Epoch: 10, Steps: 18 | Train Loss: 0.049 Vali Loss: 1.044 Vali Acc: 0.530 Test Loss: 1.044 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.8524107933044434
Epoch: 11, Steps: 18 | Train Loss: 0.028 Vali Loss: 1.040 Vali Acc: 0.510 Test Loss: 1.040 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.810631275177002
Epoch: 12, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.125 Vali Acc: 0.490 Test Loss: 1.125 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.9426259994506836
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.063 Vali Acc: 0.520 Test Loss: 1.063 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.957818031311035
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.159 Vali Acc: 0.520 Test Loss: 1.159 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 5004258
model size : 19.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.062322378158569
Epoch: 1, Steps: 18 | Train Loss: 0.716 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 4.327334642410278
Epoch: 2, Steps: 18 | Train Loss: 0.668 Vali Loss: 0.713 Vali Acc: 0.470 Test Loss: 0.713 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.939641237258911
Epoch: 3, Steps: 18 | Train Loss: 0.595 Vali Loss: 0.748 Vali Acc: 0.570 Test Loss: 0.748 Test Acc: 0.570
Validation loss decreased (-0.499993 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 4.600501298904419
Epoch: 4, Steps: 18 | Train Loss: 0.505 Vali Loss: 0.738 Vali Acc: 0.480 Test Loss: 0.738 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.424915552139282
Epoch: 5, Steps: 18 | Train Loss: 0.407 Vali Loss: 0.781 Vali Acc: 0.460 Test Loss: 0.781 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.401029109954834
Epoch: 6, Steps: 18 | Train Loss: 0.320 Vali Loss: 0.786 Vali Acc: 0.490 Test Loss: 0.786 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.554476976394653
Epoch: 7, Steps: 18 | Train Loss: 0.257 Vali Loss: 0.814 Vali Acc: 0.490 Test Loss: 0.814 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.880509853363037
Epoch: 8, Steps: 18 | Train Loss: 0.182 Vali Loss: 0.892 Vali Acc: 0.430 Test Loss: 0.892 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.681384563446045
Epoch: 9, Steps: 18 | Train Loss: 0.138 Vali Loss: 0.898 Vali Acc: 0.470 Test Loss: 0.898 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.547225475311279
Epoch: 10, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.916 Vali Acc: 0.480 Test Loss: 0.916 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.434598207473755
Epoch: 11, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.969 Vali Acc: 0.490 Test Loss: 0.969 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.4958815574646
Epoch: 12, Steps: 18 | Train Loss: 0.034 Vali Loss: 1.001 Vali Acc: 0.490 Test Loss: 1.001 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.500884771347046
Epoch: 13, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.969 Vali Acc: 0.490 Test Loss: 0.969 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 4992674
model size : 19.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.280919075012207
Epoch: 1, Steps: 18 | Train Loss: 0.717 Vali Loss: 0.699 Vali Acc: 0.480 Test Loss: 0.699 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 4.098320245742798
Epoch: 2, Steps: 18 | Train Loss: 0.661 Vali Loss: 0.717 Vali Acc: 0.510 Test Loss: 0.717 Test Acc: 0.510
Validation loss decreased (-0.479993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 4.006983280181885
Epoch: 3, Steps: 18 | Train Loss: 0.599 Vali Loss: 0.713 Vali Acc: 0.520 Test Loss: 0.713 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 3.7196269035339355
Epoch: 4, Steps: 18 | Train Loss: 0.529 Vali Loss: 0.722 Vali Acc: 0.520 Test Loss: 0.722 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.08474326133728
Epoch: 5, Steps: 18 | Train Loss: 0.456 Vali Loss: 0.713 Vali Acc: 0.550 Test Loss: 0.713 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 4.092635869979858
Epoch: 6, Steps: 18 | Train Loss: 0.385 Vali Loss: 0.749 Vali Acc: 0.450 Test Loss: 0.749 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.968766450881958
Epoch: 7, Steps: 18 | Train Loss: 0.294 Vali Loss: 0.772 Vali Acc: 0.510 Test Loss: 0.772 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.971963405609131
Epoch: 8, Steps: 18 | Train Loss: 0.243 Vali Loss: 0.778 Vali Acc: 0.500 Test Loss: 0.778 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.174001455307007
Epoch: 9, Steps: 18 | Train Loss: 0.145 Vali Loss: 0.827 Vali Acc: 0.490 Test Loss: 0.827 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.9036026000976562
Epoch: 10, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.851 Vali Acc: 0.470 Test Loss: 0.851 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.363769292831421
Epoch: 11, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.930 Vali Acc: 0.480 Test Loss: 0.930 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.979569435119629
Epoch: 12, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.911 Vali Acc: 0.490 Test Loss: 0.911 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.043557167053223
Epoch: 13, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.977 Vali Acc: 0.460 Test Loss: 0.977 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.9762392044067383
Epoch: 14, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.089 Vali Acc: 0.490 Test Loss: 1.089 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.019662380218506
Epoch: 15, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.033 Vali Acc: 0.480 Test Loss: 1.033 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 4981090
model size : 19.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.243263959884644
Epoch: 1, Steps: 18 | Train Loss: 0.897 Vali Loss: 0.826 Vali Acc: 0.550 Test Loss: 0.826 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 11.780107498168945
Epoch: 2, Steps: 18 | Train Loss: 0.823 Vali Loss: 1.042 Vali Acc: 0.530 Test Loss: 1.042 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.867673873901367
Epoch: 3, Steps: 18 | Train Loss: 0.604 Vali Loss: 1.808 Vali Acc: 0.490 Test Loss: 1.808 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.971458196640015
Epoch: 4, Steps: 18 | Train Loss: 0.464 Vali Loss: 1.454 Vali Acc: 0.490 Test Loss: 1.454 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.214965581893921
Epoch: 5, Steps: 18 | Train Loss: 0.389 Vali Loss: 1.751 Vali Acc: 0.500 Test Loss: 1.751 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.61836862564087
Epoch: 6, Steps: 18 | Train Loss: 0.363 Vali Loss: 2.876 Vali Acc: 0.430 Test Loss: 2.876 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 11.398465394973755
Epoch: 7, Steps: 18 | Train Loss: 0.247 Vali Loss: 2.317 Vali Acc: 0.500 Test Loss: 2.317 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 11.81645679473877
Epoch: 8, Steps: 18 | Train Loss: 0.311 Vali Loss: 3.450 Vali Acc: 0.500 Test Loss: 3.450 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 11.805375099182129
Epoch: 9, Steps: 18 | Train Loss: 0.222 Vali Loss: 3.180 Vali Acc: 0.480 Test Loss: 3.180 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 11.366724014282227
Epoch: 10, Steps: 18 | Train Loss: 0.097 Vali Loss: 3.272 Vali Acc: 0.530 Test Loss: 3.272 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 11.52193021774292
Epoch: 11, Steps: 18 | Train Loss: 0.057 Vali Loss: 4.295 Vali Acc: 0.460 Test Loss: 4.295 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 15625218
model size : 60.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.104102611541748
Epoch: 1, Steps: 18 | Train Loss: 0.834 Vali Loss: 1.194 Vali Acc: 0.470 Test Loss: 1.194 Test Acc: 0.470
Validation loss decreased (inf --> -0.469988).  Saving model ...
Epoch: 2 cost time: 7.125750303268433
Epoch: 2, Steps: 18 | Train Loss: 0.694 Vali Loss: 1.642 Vali Acc: 0.530 Test Loss: 1.642 Test Acc: 0.530
Validation loss decreased (-0.469988 --> -0.529984).  Saving model ...
Epoch: 3 cost time: 7.176614284515381
Epoch: 3, Steps: 18 | Train Loss: 0.513 Vali Loss: 1.215 Vali Acc: 0.470 Test Loss: 1.215 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.564151048660278
Epoch: 4, Steps: 18 | Train Loss: 0.314 Vali Loss: 1.177 Vali Acc: 0.570 Test Loss: 1.177 Test Acc: 0.570
Validation loss decreased (-0.529984 --> -0.569988).  Saving model ...
Epoch: 5 cost time: 6.655500173568726
Epoch: 5, Steps: 18 | Train Loss: 0.328 Vali Loss: 1.626 Vali Acc: 0.510 Test Loss: 1.626 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.582855463027954
Epoch: 6, Steps: 18 | Train Loss: 0.233 Vali Loss: 1.275 Vali Acc: 0.560 Test Loss: 1.275 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.688575983047485
Epoch: 7, Steps: 18 | Train Loss: 0.199 Vali Loss: 1.503 Vali Acc: 0.550 Test Loss: 1.503 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.544563293457031
Epoch: 8, Steps: 18 | Train Loss: 0.124 Vali Loss: 2.327 Vali Acc: 0.490 Test Loss: 2.327 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.820475101470947
Epoch: 9, Steps: 18 | Train Loss: 0.050 Vali Loss: 3.005 Vali Acc: 0.480 Test Loss: 3.005 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.70814847946167
Epoch: 10, Steps: 18 | Train Loss: 0.112 Vali Loss: 2.731 Vali Acc: 0.530 Test Loss: 2.731 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.5104851722717285
Epoch: 11, Steps: 18 | Train Loss: 0.114 Vali Loss: 3.564 Vali Acc: 0.470 Test Loss: 3.564 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.86410665512085
Epoch: 12, Steps: 18 | Train Loss: 0.146 Vali Loss: 3.482 Vali Acc: 0.460 Test Loss: 3.482 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.614420175552368
Epoch: 13, Steps: 18 | Train Loss: 0.133 Vali Loss: 3.310 Vali Acc: 0.490 Test Loss: 3.310 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.793069839477539
Epoch: 14, Steps: 18 | Train Loss: 0.078 Vali Loss: 3.079 Vali Acc: 0.440 Test Loss: 3.079 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 15012226
model size : 57.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.550150394439697
Epoch: 1, Steps: 18 | Train Loss: 0.761 Vali Loss: 0.973 Vali Acc: 0.440 Test Loss: 0.973 Test Acc: 0.440
Validation loss decreased (inf --> -0.439990).  Saving model ...
Epoch: 2 cost time: 8.725006580352783
Epoch: 2, Steps: 18 | Train Loss: 0.764 Vali Loss: 0.985 Vali Acc: 0.580 Test Loss: 0.985 Test Acc: 0.580
Validation loss decreased (-0.439990 --> -0.579990).  Saving model ...
Epoch: 3 cost time: 9.037043809890747
Epoch: 3, Steps: 18 | Train Loss: 0.517 Vali Loss: 1.247 Vali Acc: 0.630 Test Loss: 1.247 Test Acc: 0.630
Validation loss decreased (-0.579990 --> -0.629988).  Saving model ...
Epoch: 4 cost time: 9.065037965774536
Epoch: 4, Steps: 18 | Train Loss: 0.349 Vali Loss: 1.338 Vali Acc: 0.490 Test Loss: 1.338 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.838918685913086
Epoch: 5, Steps: 18 | Train Loss: 0.288 Vali Loss: 1.336 Vali Acc: 0.490 Test Loss: 1.336 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.945605993270874
Epoch: 6, Steps: 18 | Train Loss: 0.123 Vali Loss: 1.651 Vali Acc: 0.510 Test Loss: 1.651 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.949085235595703
Epoch: 7, Steps: 18 | Train Loss: 0.092 Vali Loss: 1.536 Vali Acc: 0.540 Test Loss: 1.536 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.956301927566528
Epoch: 8, Steps: 18 | Train Loss: 0.119 Vali Loss: 1.851 Vali Acc: 0.560 Test Loss: 1.851 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.997145175933838
Epoch: 9, Steps: 18 | Train Loss: 0.128 Vali Loss: 1.541 Vali Acc: 0.630 Test Loss: 1.541 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 9.083664417266846
Epoch: 10, Steps: 18 | Train Loss: 0.077 Vali Loss: 2.146 Vali Acc: 0.570 Test Loss: 2.146 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.527703762054443
Epoch: 11, Steps: 18 | Train Loss: 0.180 Vali Loss: 3.200 Vali Acc: 0.540 Test Loss: 3.200 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 9.345399856567383
Epoch: 12, Steps: 18 | Train Loss: 0.106 Vali Loss: 2.605 Vali Acc: 0.480 Test Loss: 2.605 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 8.93193793296814
Epoch: 13, Steps: 18 | Train Loss: 0.046 Vali Loss: 2.835 Vali Acc: 0.420 Test Loss: 2.835 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 14792450
model size : 56.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.824453115463257
Epoch: 1, Steps: 18 | Train Loss: 0.785 Vali Loss: 0.752 Vali Acc: 0.550 Test Loss: 0.752 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 7.328543663024902
Epoch: 2, Steps: 18 | Train Loss: 0.598 Vali Loss: 0.816 Vali Acc: 0.530 Test Loss: 0.816 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.43233847618103
Epoch: 3, Steps: 18 | Train Loss: 0.477 Vali Loss: 0.939 Vali Acc: 0.490 Test Loss: 0.939 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.496577501296997
Epoch: 4, Steps: 18 | Train Loss: 0.392 Vali Loss: 1.022 Vali Acc: 0.540 Test Loss: 1.022 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.649376630783081
Epoch: 5, Steps: 18 | Train Loss: 0.286 Vali Loss: 1.394 Vali Acc: 0.430 Test Loss: 1.394 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.666762828826904
Epoch: 6, Steps: 18 | Train Loss: 0.210 Vali Loss: 1.324 Vali Acc: 0.460 Test Loss: 1.324 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.570648908615112
Epoch: 7, Steps: 18 | Train Loss: 0.102 Vali Loss: 1.505 Vali Acc: 0.490 Test Loss: 1.505 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.572621822357178
Epoch: 8, Steps: 18 | Train Loss: 0.091 Vali Loss: 1.601 Vali Acc: 0.470 Test Loss: 1.601 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.757569789886475
Epoch: 9, Steps: 18 | Train Loss: 0.083 Vali Loss: 1.953 Vali Acc: 0.560 Test Loss: 1.953 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559980).  Saving model ...
Epoch: 10 cost time: 8.025071620941162
Epoch: 10, Steps: 18 | Train Loss: 0.142 Vali Loss: 1.939 Vali Acc: 0.470 Test Loss: 1.939 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.369660139083862
Epoch: 11, Steps: 18 | Train Loss: 0.028 Vali Loss: 1.808 Vali Acc: 0.490 Test Loss: 1.808 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.759808301925659
Epoch: 12, Steps: 18 | Train Loss: 0.044 Vali Loss: 2.650 Vali Acc: 0.420 Test Loss: 2.650 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.55631685256958
Epoch: 13, Steps: 18 | Train Loss: 0.019 Vali Loss: 2.505 Vali Acc: 0.540 Test Loss: 2.505 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.8417956829071045
Epoch: 14, Steps: 18 | Train Loss: 0.068 Vali Loss: 2.172 Vali Acc: 0.540 Test Loss: 2.172 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.75835657119751
Epoch: 15, Steps: 18 | Train Loss: 0.105 Vali Loss: 2.796 Vali Acc: 0.460 Test Loss: 2.796 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.70275092124939
Epoch: 16, Steps: 18 | Train Loss: 0.051 Vali Loss: 3.031 Vali Acc: 0.480 Test Loss: 3.031 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.487412691116333
Epoch: 17, Steps: 18 | Train Loss: 0.279 Vali Loss: 3.226 Vali Acc: 0.530 Test Loss: 3.226 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.47779107093811
Epoch: 18, Steps: 18 | Train Loss: 0.172 Vali Loss: 3.212 Vali Acc: 0.460 Test Loss: 3.212 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.297283172607422
Epoch: 19, Steps: 18 | Train Loss: 0.065 Vali Loss: 2.593 Vali Acc: 0.440 Test Loss: 2.593 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 14703746
model size : 56.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.503283977508545
Epoch: 1, Steps: 18 | Train Loss: 0.739 Vali Loss: 0.776 Vali Acc: 0.540 Test Loss: 0.776 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 8.521098136901855
Epoch: 2, Steps: 18 | Train Loss: 0.597 Vali Loss: 0.691 Vali Acc: 0.530 Test Loss: 0.691 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.481609344482422
Epoch: 3, Steps: 18 | Train Loss: 0.509 Vali Loss: 0.839 Vali Acc: 0.530 Test Loss: 0.839 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.580051898956299
Epoch: 4, Steps: 18 | Train Loss: 0.363 Vali Loss: 0.825 Vali Acc: 0.590 Test Loss: 0.825 Test Acc: 0.590
Validation loss decreased (-0.539992 --> -0.589992).  Saving model ...
Epoch: 5 cost time: 7.955835580825806
Epoch: 5, Steps: 18 | Train Loss: 0.244 Vali Loss: 0.807 Vali Acc: 0.530 Test Loss: 0.807 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.767004013061523
Epoch: 6, Steps: 18 | Train Loss: 0.185 Vali Loss: 1.172 Vali Acc: 0.490 Test Loss: 1.172 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.679157495498657
Epoch: 7, Steps: 18 | Train Loss: 0.117 Vali Loss: 1.233 Vali Acc: 0.550 Test Loss: 1.233 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.488165616989136
Epoch: 8, Steps: 18 | Train Loss: 0.128 Vali Loss: 1.381 Vali Acc: 0.520 Test Loss: 1.381 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.508541822433472
Epoch: 9, Steps: 18 | Train Loss: 0.232 Vali Loss: 1.777 Vali Acc: 0.550 Test Loss: 1.777 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.66702914237976
Epoch: 10, Steps: 18 | Train Loss: 0.152 Vali Loss: 1.788 Vali Acc: 0.540 Test Loss: 1.788 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.782186269760132
Epoch: 11, Steps: 18 | Train Loss: 0.150 Vali Loss: 1.558 Vali Acc: 0.480 Test Loss: 1.558 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.712201356887817
Epoch: 12, Steps: 18 | Train Loss: 0.068 Vali Loss: 1.858 Vali Acc: 0.490 Test Loss: 1.858 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.661260604858398
Epoch: 13, Steps: 18 | Train Loss: 0.086 Vali Loss: 1.950 Vali Acc: 0.520 Test Loss: 1.950 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 8.847384452819824
Epoch: 14, Steps: 18 | Train Loss: 0.169 Vali Loss: 2.159 Vali Acc: 0.540 Test Loss: 2.159 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 14624642
model size : 56.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.179384708404541
Epoch: 1, Steps: 18 | Train Loss: 0.752 Vali Loss: 0.722 Vali Acc: 0.420 Test Loss: 0.722 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 7.7419493198394775
Epoch: 2, Steps: 18 | Train Loss: 0.656 Vali Loss: 0.739 Vali Acc: 0.550 Test Loss: 0.739 Test Acc: 0.550
Validation loss decreased (-0.419993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 7.8790199756622314
Epoch: 3, Steps: 18 | Train Loss: 0.535 Vali Loss: 0.797 Vali Acc: 0.500 Test Loss: 0.797 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.892161846160889
Epoch: 4, Steps: 18 | Train Loss: 0.358 Vali Loss: 0.849 Vali Acc: 0.590 Test Loss: 0.849 Test Acc: 0.590
Validation loss decreased (-0.549993 --> -0.589992).  Saving model ...
Epoch: 5 cost time: 7.943511009216309
Epoch: 5, Steps: 18 | Train Loss: 0.272 Vali Loss: 0.811 Vali Acc: 0.540 Test Loss: 0.811 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.760883092880249
Epoch: 6, Steps: 18 | Train Loss: 0.157 Vali Loss: 1.039 Vali Acc: 0.480 Test Loss: 1.039 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.804576873779297
Epoch: 7, Steps: 18 | Train Loss: 0.135 Vali Loss: 1.535 Vali Acc: 0.530 Test Loss: 1.535 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.600001573562622
Epoch: 8, Steps: 18 | Train Loss: 0.144 Vali Loss: 1.088 Vali Acc: 0.540 Test Loss: 1.088 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.088870286941528
Epoch: 9, Steps: 18 | Train Loss: 0.076 Vali Loss: 1.121 Vali Acc: 0.480 Test Loss: 1.121 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.720197677612305
Epoch: 10, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.663107872009277
Epoch: 11, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.497 Vali Acc: 0.550 Test Loss: 1.497 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.587334156036377
Epoch: 12, Steps: 18 | Train Loss: 0.024 Vali Loss: 1.472 Vali Acc: 0.490 Test Loss: 1.472 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.6876585483551025
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.538 Vali Acc: 0.500 Test Loss: 1.538 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.661495923995972
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.534 Vali Acc: 0.460 Test Loss: 1.534 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 14578306
model size : 56.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.997393846511841
Epoch: 1, Steps: 18 | Train Loss: 0.729 Vali Loss: 0.768 Vali Acc: 0.440 Test Loss: 0.768 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 4.957472085952759
Epoch: 2, Steps: 18 | Train Loss: 0.653 Vali Loss: 0.760 Vali Acc: 0.460 Test Loss: 0.760 Test Acc: 0.460
Validation loss decreased (-0.439992 --> -0.459992).  Saving model ...
Epoch: 3 cost time: 5.130619287490845
Epoch: 3, Steps: 18 | Train Loss: 0.538 Vali Loss: 0.811 Vali Acc: 0.480 Test Loss: 0.811 Test Acc: 0.480
Validation loss decreased (-0.459992 --> -0.479992).  Saving model ...
Epoch: 4 cost time: 4.618489742279053
Epoch: 4, Steps: 18 | Train Loss: 0.397 Vali Loss: 0.785 Vali Acc: 0.470 Test Loss: 0.785 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.540091514587402
Epoch: 5, Steps: 18 | Train Loss: 0.291 Vali Loss: 0.823 Vali Acc: 0.570 Test Loss: 0.823 Test Acc: 0.570
Validation loss decreased (-0.479992 --> -0.569992).  Saving model ...
Epoch: 6 cost time: 5.072098255157471
Epoch: 6, Steps: 18 | Train Loss: 0.225 Vali Loss: 0.892 Vali Acc: 0.510 Test Loss: 0.892 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.0871336460113525
Epoch: 7, Steps: 18 | Train Loss: 0.128 Vali Loss: 0.959 Vali Acc: 0.460 Test Loss: 0.959 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.096648693084717
Epoch: 8, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.989 Vali Acc: 0.490 Test Loss: 0.989 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.955133676528931
Epoch: 9, Steps: 18 | Train Loss: 0.055 Vali Loss: 1.245 Vali Acc: 0.500 Test Loss: 1.245 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.390591859817505
Epoch: 10, Steps: 18 | Train Loss: 0.031 Vali Loss: 1.187 Vali Acc: 0.520 Test Loss: 1.187 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.84717583656311
Epoch: 11, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.196 Vali Acc: 0.530 Test Loss: 1.196 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.845710754394531
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.672 Vali Acc: 0.480 Test Loss: 1.672 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.935070514678955
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.344 Vali Acc: 0.520 Test Loss: 1.344 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.887606859207153
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.564 Vali Acc: 0.470 Test Loss: 1.564 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.288054466247559
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.523 Vali Acc: 0.480 Test Loss: 1.523 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 14564738
model size : 55.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.2313456535339355
Epoch: 1, Steps: 18 | Train Loss: 0.772 Vali Loss: 0.845 Vali Acc: 0.470 Test Loss: 0.845 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 6.018437147140503
Epoch: 2, Steps: 18 | Train Loss: 0.649 Vali Loss: 1.113 Vali Acc: 0.480 Test Loss: 1.113 Test Acc: 0.480
Validation loss decreased (-0.469992 --> -0.479989).  Saving model ...
Epoch: 3 cost time: 5.289708375930786
Epoch: 3, Steps: 18 | Train Loss: 0.440 Vali Loss: 1.332 Vali Acc: 0.450 Test Loss: 1.332 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.222798109054565
Epoch: 4, Steps: 18 | Train Loss: 0.445 Vali Loss: 1.384 Vali Acc: 0.490 Test Loss: 1.384 Test Acc: 0.490
Validation loss decreased (-0.479989 --> -0.489986).  Saving model ...
Epoch: 5 cost time: 5.837212324142456
Epoch: 5, Steps: 18 | Train Loss: 0.145 Vali Loss: 2.141 Vali Acc: 0.480 Test Loss: 2.141 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.353566884994507
Epoch: 6, Steps: 18 | Train Loss: 0.107 Vali Loss: 1.914 Vali Acc: 0.430 Test Loss: 1.914 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.100265264511108
Epoch: 7, Steps: 18 | Train Loss: 0.110 Vali Loss: 2.212 Vali Acc: 0.470 Test Loss: 2.212 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.979809045791626
Epoch: 8, Steps: 18 | Train Loss: 0.091 Vali Loss: 3.444 Vali Acc: 0.430 Test Loss: 3.444 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.887810468673706
Epoch: 9, Steps: 18 | Train Loss: 0.156 Vali Loss: 3.119 Vali Acc: 0.500 Test Loss: 3.119 Test Acc: 0.500
Validation loss decreased (-0.489986 --> -0.499969).  Saving model ...
Epoch: 10 cost time: 5.137136936187744
Epoch: 10, Steps: 18 | Train Loss: 0.054 Vali Loss: 2.976 Vali Acc: 0.510 Test Loss: 2.976 Test Acc: 0.510
Validation loss decreased (-0.499969 --> -0.509970).  Saving model ...
Epoch: 11 cost time: 5.183522939682007
Epoch: 11, Steps: 18 | Train Loss: 0.083 Vali Loss: 3.100 Vali Acc: 0.480 Test Loss: 3.100 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.489073991775513
Epoch: 12, Steps: 18 | Train Loss: 0.068 Vali Loss: 3.534 Vali Acc: 0.450 Test Loss: 3.534 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.224753379821777
Epoch: 13, Steps: 18 | Train Loss: 0.052 Vali Loss: 2.822 Vali Acc: 0.520 Test Loss: 2.822 Test Acc: 0.520
Validation loss decreased (-0.509970 --> -0.519972).  Saving model ...
Epoch: 14 cost time: 5.050947189331055
Epoch: 14, Steps: 18 | Train Loss: 0.040 Vali Loss: 3.912 Vali Acc: 0.490 Test Loss: 3.912 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.725265741348267
Epoch: 15, Steps: 18 | Train Loss: 0.092 Vali Loss: 4.445 Vali Acc: 0.480 Test Loss: 4.445 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.7692482471466064
Epoch: 16, Steps: 18 | Train Loss: 0.113 Vali Loss: 4.752 Vali Acc: 0.520 Test Loss: 4.752 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.077926397323608
Epoch: 17, Steps: 18 | Train Loss: 0.095 Vali Loss: 4.309 Vali Acc: 0.510 Test Loss: 4.309 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.995145320892334
Epoch: 18, Steps: 18 | Train Loss: 0.105 Vali Loss: 4.434 Vali Acc: 0.460 Test Loss: 4.434 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.5575127601623535
Epoch: 19, Steps: 18 | Train Loss: 0.087 Vali Loss: 6.081 Vali Acc: 0.480 Test Loss: 6.081 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.183474063873291
Epoch: 20, Steps: 18 | Train Loss: 0.053 Vali Loss: 5.997 Vali Acc: 0.440 Test Loss: 5.997 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.082985877990723
Epoch: 21, Steps: 18 | Train Loss: 0.025 Vali Loss: 6.499 Vali Acc: 0.440 Test Loss: 6.499 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.75779914855957
Epoch: 22, Steps: 18 | Train Loss: 0.020 Vali Loss: 6.751 Vali Acc: 0.450 Test Loss: 6.751 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.765742540359497
Epoch: 23, Steps: 18 | Train Loss: 0.114 Vali Loss: 5.015 Vali Acc: 0.530 Test Loss: 5.015 Test Acc: 0.530
Validation loss decreased (-0.519972 --> -0.529950).  Saving model ...
Epoch: 24 cost time: 5.133283376693726
Epoch: 24, Steps: 18 | Train Loss: 0.078 Vali Loss: 5.238 Vali Acc: 0.550 Test Loss: 5.238 Test Acc: 0.550
Validation loss decreased (-0.529950 --> -0.549948).  Saving model ...
Epoch: 25 cost time: 4.155901670455933
Epoch: 25, Steps: 18 | Train Loss: 0.013 Vali Loss: 4.744 Vali Acc: 0.550 Test Loss: 4.744 Test Acc: 0.550
Validation loss decreased (-0.549948 --> -0.549953).  Saving model ...
Epoch: 26 cost time: 5.4788079261779785
Epoch: 26, Steps: 18 | Train Loss: 0.201 Vali Loss: 6.179 Vali Acc: 0.530 Test Loss: 6.179 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.435060501098633
Epoch: 27, Steps: 18 | Train Loss: 0.081 Vali Loss: 7.163 Vali Acc: 0.560 Test Loss: 7.163 Test Acc: 0.560
Validation loss decreased (-0.549953 --> -0.559928).  Saving model ...
Epoch: 28 cost time: 5.1359333992004395
Epoch: 28, Steps: 18 | Train Loss: 0.032 Vali Loss: 6.858 Vali Acc: 0.470 Test Loss: 6.858 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.8347203731536865
Epoch: 29, Steps: 18 | Train Loss: 0.164 Vali Loss: 9.291 Vali Acc: 0.470 Test Loss: 9.291 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.145426273345947
Epoch: 30, Steps: 18 | Train Loss: 0.199 Vali Loss: 7.769 Vali Acc: 0.500 Test Loss: 7.769 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 5.207119941711426
Epoch: 31, Steps: 18 | Train Loss: 0.135 Vali Loss: 9.617 Vali Acc: 0.480 Test Loss: 9.617 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 5.247159957885742
Epoch: 32, Steps: 18 | Train Loss: 0.014 Vali Loss: 9.500 Vali Acc: 0.520 Test Loss: 9.500 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 5.7192957401275635
Epoch: 33, Steps: 18 | Train Loss: 0.026 Vali Loss: 8.171 Vali Acc: 0.570 Test Loss: 8.171 Test Acc: 0.570
Validation loss decreased (-0.559928 --> -0.569918).  Saving model ...
Epoch: 34 cost time: 5.277886629104614
Epoch: 34, Steps: 18 | Train Loss: 0.039 Vali Loss: 11.120 Vali Acc: 0.500 Test Loss: 11.120 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 4.985136985778809
Epoch: 35, Steps: 18 | Train Loss: 0.061 Vali Loss: 10.442 Vali Acc: 0.440 Test Loss: 10.442 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 5.602580308914185
Epoch: 36, Steps: 18 | Train Loss: 0.028 Vali Loss: 13.725 Vali Acc: 0.450 Test Loss: 13.725 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 6.36690354347229
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 14.947 Vali Acc: 0.470 Test Loss: 14.947 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 5.150623083114624
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 12.781 Vali Acc: 0.460 Test Loss: 12.781 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 5.1090381145477295
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 12.400 Vali Acc: 0.490 Test Loss: 12.400 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 5.736915111541748
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 13.238 Vali Acc: 0.480 Test Loss: 13.238 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 5.120605945587158
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 13.005 Vali Acc: 0.490 Test Loss: 13.005 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 5.043532371520996
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 13.293 Vali Acc: 0.480 Test Loss: 13.293 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 5.587808609008789
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 13.353 Vali Acc: 0.480 Test Loss: 13.353 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 5174786
model size : 19.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.869408130645752
Epoch: 1, Steps: 18 | Train Loss: 0.729 Vali Loss: 0.744 Vali Acc: 0.460 Test Loss: 0.744 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 4.153031587600708
Epoch: 2, Steps: 18 | Train Loss: 0.604 Vali Loss: 1.031 Vali Acc: 0.420 Test Loss: 1.031 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.938394069671631
Epoch: 3, Steps: 18 | Train Loss: 0.582 Vali Loss: 0.863 Vali Acc: 0.480 Test Loss: 0.863 Test Acc: 0.480
Validation loss decreased (-0.459993 --> -0.479991).  Saving model ...
Epoch: 4 cost time: 3.873340129852295
Epoch: 4, Steps: 18 | Train Loss: 0.386 Vali Loss: 0.951 Vali Acc: 0.470 Test Loss: 0.951 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.571723222732544
Epoch: 5, Steps: 18 | Train Loss: 0.239 Vali Loss: 1.242 Vali Acc: 0.450 Test Loss: 1.242 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.9213032722473145
Epoch: 6, Steps: 18 | Train Loss: 0.106 Vali Loss: 1.373 Vali Acc: 0.490 Test Loss: 1.373 Test Acc: 0.490
Validation loss decreased (-0.479991 --> -0.489986).  Saving model ...
Epoch: 7 cost time: 3.887484550476074
Epoch: 7, Steps: 18 | Train Loss: 0.056 Vali Loss: 1.744 Vali Acc: 0.460 Test Loss: 1.744 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8465211391448975
Epoch: 8, Steps: 18 | Train Loss: 0.046 Vali Loss: 2.051 Vali Acc: 0.430 Test Loss: 2.051 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.8670995235443115
Epoch: 9, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.584 Vali Acc: 0.450 Test Loss: 1.584 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.808567762374878
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.771 Vali Acc: 0.490 Test Loss: 1.771 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.7176361083984375
Epoch: 11, Steps: 18 | Train Loss: 0.015 Vali Loss: 2.263 Vali Acc: 0.460 Test Loss: 2.263 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.790987253189087
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 2.078 Vali Acc: 0.530 Test Loss: 2.078 Test Acc: 0.530
Validation loss decreased (-0.489986 --> -0.529979).  Saving model ...
Epoch: 13 cost time: 3.749419689178467
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.884 Vali Acc: 0.540 Test Loss: 1.884 Test Acc: 0.540
Validation loss decreased (-0.529979 --> -0.539981).  Saving model ...
Epoch: 14 cost time: 3.775761365890503
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 2.509 Vali Acc: 0.520 Test Loss: 2.509 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.81164288520813
Epoch: 15, Steps: 18 | Train Loss: 0.024 Vali Loss: 2.644 Vali Acc: 0.480 Test Loss: 2.644 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.8353006839752197
Epoch: 16, Steps: 18 | Train Loss: 0.083 Vali Loss: 2.533 Vali Acc: 0.520 Test Loss: 2.533 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.8001785278320312
Epoch: 17, Steps: 18 | Train Loss: 0.102 Vali Loss: 3.949 Vali Acc: 0.470 Test Loss: 3.949 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.6941001415252686
Epoch: 18, Steps: 18 | Train Loss: 0.455 Vali Loss: 1.966 Vali Acc: 0.510 Test Loss: 1.966 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.936518430709839
Epoch: 19, Steps: 18 | Train Loss: 0.090 Vali Loss: 2.878 Vali Acc: 0.480 Test Loss: 2.878 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.7966959476470947
Epoch: 20, Steps: 18 | Train Loss: 0.124 Vali Loss: 3.475 Vali Acc: 0.430 Test Loss: 3.475 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.860018730163574
Epoch: 21, Steps: 18 | Train Loss: 0.119 Vali Loss: 4.385 Vali Acc: 0.420 Test Loss: 4.385 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.873903512954712
Epoch: 22, Steps: 18 | Train Loss: 0.063 Vali Loss: 4.194 Vali Acc: 0.430 Test Loss: 4.194 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.092807054519653
Epoch: 23, Steps: 18 | Train Loss: 0.033 Vali Loss: 3.511 Vali Acc: 0.460 Test Loss: 3.511 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 4868290
model size : 18.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.230109214782715
Epoch: 1, Steps: 18 | Train Loss: 0.794 Vali Loss: 0.749 Vali Acc: 0.470 Test Loss: 0.749 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 5.4965009689331055
Epoch: 2, Steps: 18 | Train Loss: 0.647 Vali Loss: 0.812 Vali Acc: 0.450 Test Loss: 0.812 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.528481960296631
Epoch: 3, Steps: 18 | Train Loss: 0.536 Vali Loss: 0.793 Vali Acc: 0.520 Test Loss: 0.793 Test Acc: 0.520
Validation loss decreased (-0.469993 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 5.102524280548096
Epoch: 4, Steps: 18 | Train Loss: 0.404 Vali Loss: 0.865 Vali Acc: 0.510 Test Loss: 0.865 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.111826658248901
Epoch: 5, Steps: 18 | Train Loss: 0.275 Vali Loss: 1.041 Vali Acc: 0.470 Test Loss: 1.041 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.048384189605713
Epoch: 6, Steps: 18 | Train Loss: 0.198 Vali Loss: 1.045 Vali Acc: 0.490 Test Loss: 1.045 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.9362359046936035
Epoch: 7, Steps: 18 | Train Loss: 0.086 Vali Loss: 1.086 Vali Acc: 0.530 Test Loss: 1.086 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529989).  Saving model ...
Epoch: 8 cost time: 5.148688316345215
Epoch: 8, Steps: 18 | Train Loss: 0.042 Vali Loss: 1.434 Vali Acc: 0.510 Test Loss: 1.434 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.113030195236206
Epoch: 9, Steps: 18 | Train Loss: 0.034 Vali Loss: 1.563 Vali Acc: 0.430 Test Loss: 1.563 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.020437717437744
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.817 Vali Acc: 0.490 Test Loss: 1.817 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.1487812995910645
Epoch: 11, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.675 Vali Acc: 0.460 Test Loss: 1.675 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.227685928344727
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.881 Vali Acc: 0.450 Test Loss: 1.881 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.932439565658569
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 2.175 Vali Acc: 0.450 Test Loss: 2.175 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.147766351699829
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.050 Vali Acc: 0.430 Test Loss: 2.050 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.063604116439819
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.046 Vali Acc: 0.480 Test Loss: 2.046 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.05937647819519
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.988 Vali Acc: 0.450 Test Loss: 1.988 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.842429876327515
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.987 Vali Acc: 0.450 Test Loss: 1.987 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 4758402
model size : 18.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.6328284740448
Epoch: 1, Steps: 18 | Train Loss: 0.729 Vali Loss: 0.729 Vali Acc: 0.450 Test Loss: 0.729 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 4.038505554199219
Epoch: 2, Steps: 18 | Train Loss: 0.633 Vali Loss: 0.794 Vali Acc: 0.540 Test Loss: 0.794 Test Acc: 0.540
Validation loss decreased (-0.449993 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 4.08972430229187
Epoch: 3, Steps: 18 | Train Loss: 0.529 Vali Loss: 0.723 Vali Acc: 0.510 Test Loss: 0.723 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.320201635360718
Epoch: 4, Steps: 18 | Train Loss: 0.384 Vali Loss: 0.881 Vali Acc: 0.580 Test Loss: 0.881 Test Acc: 0.580
Validation loss decreased (-0.539992 --> -0.579991).  Saving model ...
Epoch: 5 cost time: 4.116047620773315
Epoch: 5, Steps: 18 | Train Loss: 0.255 Vali Loss: 0.936 Vali Acc: 0.490 Test Loss: 0.936 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.089765548706055
Epoch: 6, Steps: 18 | Train Loss: 0.155 Vali Loss: 0.943 Vali Acc: 0.550 Test Loss: 0.943 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.977722644805908
Epoch: 7, Steps: 18 | Train Loss: 0.086 Vali Loss: 1.077 Vali Acc: 0.510 Test Loss: 1.077 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.386487245559692
Epoch: 8, Steps: 18 | Train Loss: 0.055 Vali Loss: 1.230 Vali Acc: 0.480 Test Loss: 1.230 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.6647043228149414
Epoch: 9, Steps: 18 | Train Loss: 0.048 Vali Loss: 1.396 Vali Acc: 0.460 Test Loss: 1.396 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.181639909744263
Epoch: 10, Steps: 18 | Train Loss: 0.043 Vali Loss: 1.419 Vali Acc: 0.530 Test Loss: 1.419 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.188600540161133
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.506 Vali Acc: 0.490 Test Loss: 1.506 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.28893256187439
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.449 Vali Acc: 0.470 Test Loss: 1.449 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.182464599609375
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.549 Vali Acc: 0.460 Test Loss: 1.549 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.155876874923706
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.512 Vali Acc: 0.480 Test Loss: 1.512 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 4714050
model size : 18.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.019205570220947
Epoch: 1, Steps: 18 | Train Loss: 0.737 Vali Loss: 0.691 Vali Acc: 0.460 Test Loss: 0.691 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 5.065128564834595
Epoch: 2, Steps: 18 | Train Loss: 0.635 Vali Loss: 0.737 Vali Acc: 0.550 Test Loss: 0.737 Test Acc: 0.550
Validation loss decreased (-0.459993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 4.808501243591309
Epoch: 3, Steps: 18 | Train Loss: 0.541 Vali Loss: 0.715 Vali Acc: 0.520 Test Loss: 0.715 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.859779596328735
Epoch: 4, Steps: 18 | Train Loss: 0.421 Vali Loss: 0.811 Vali Acc: 0.500 Test Loss: 0.811 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.836819648742676
Epoch: 5, Steps: 18 | Train Loss: 0.350 Vali Loss: 0.860 Vali Acc: 0.550 Test Loss: 0.860 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.0385212898254395
Epoch: 6, Steps: 18 | Train Loss: 0.282 Vali Loss: 0.934 Vali Acc: 0.500 Test Loss: 0.934 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.996054410934448
Epoch: 7, Steps: 18 | Train Loss: 0.196 Vali Loss: 0.954 Vali Acc: 0.500 Test Loss: 0.954 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.878398418426514
Epoch: 8, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.994 Vali Acc: 0.500 Test Loss: 0.994 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.88735294342041
Epoch: 9, Steps: 18 | Train Loss: 0.068 Vali Loss: 1.058 Vali Acc: 0.460 Test Loss: 1.058 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.056346893310547
Epoch: 10, Steps: 18 | Train Loss: 0.038 Vali Loss: 1.143 Vali Acc: 0.480 Test Loss: 1.143 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.047369718551636
Epoch: 11, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.167 Vali Acc: 0.480 Test Loss: 1.167 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.108221054077148
Epoch: 12, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.488 Vali Acc: 0.460 Test Loss: 1.488 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 4674498
model size : 18.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.474218368530273
Epoch: 1, Steps: 18 | Train Loss: 0.707 Vali Loss: 0.753 Vali Acc: 0.490 Test Loss: 0.753 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 4.686304330825806
Epoch: 2, Steps: 18 | Train Loss: 0.648 Vali Loss: 0.737 Vali Acc: 0.440 Test Loss: 0.737 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.457602262496948
Epoch: 3, Steps: 18 | Train Loss: 0.576 Vali Loss: 0.816 Vali Acc: 0.600 Test Loss: 0.816 Test Acc: 0.600
Validation loss decreased (-0.489992 --> -0.599992).  Saving model ...
Epoch: 4 cost time: 4.535972356796265
Epoch: 4, Steps: 18 | Train Loss: 0.509 Vali Loss: 0.812 Vali Acc: 0.610 Test Loss: 0.812 Test Acc: 0.610
Validation loss decreased (-0.599992 --> -0.609992).  Saving model ...
Epoch: 5 cost time: 4.148066520690918
Epoch: 5, Steps: 18 | Train Loss: 0.422 Vali Loss: 0.850 Vali Acc: 0.520 Test Loss: 0.850 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.625194072723389
Epoch: 6, Steps: 18 | Train Loss: 0.330 Vali Loss: 0.842 Vali Acc: 0.550 Test Loss: 0.842 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.5093159675598145
Epoch: 7, Steps: 18 | Train Loss: 0.254 Vali Loss: 0.958 Vali Acc: 0.510 Test Loss: 0.958 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.532142400741577
Epoch: 8, Steps: 18 | Train Loss: 0.253 Vali Loss: 0.784 Vali Acc: 0.520 Test Loss: 0.784 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.9029295444488525
Epoch: 9, Steps: 18 | Train Loss: 0.122 Vali Loss: 0.815 Vali Acc: 0.460 Test Loss: 0.815 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.377192497253418
Epoch: 10, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.901 Vali Acc: 0.530 Test Loss: 0.901 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.417431354522705
Epoch: 11, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.970 Vali Acc: 0.520 Test Loss: 0.970 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.28468656539917
Epoch: 12, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.173 Vali Acc: 0.500 Test Loss: 1.173 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.413956165313721
Epoch: 13, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.082 Vali Acc: 0.490 Test Loss: 1.082 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.1354820728302
Epoch: 14, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.126 Vali Acc: 0.490 Test Loss: 1.126 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 4651330
model size : 17.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.016038417816162
Epoch: 1, Steps: 18 | Train Loss: 0.725 Vali Loss: 0.715 Vali Acc: 0.580 Test Loss: 0.715 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 3.056779146194458
Epoch: 2, Steps: 18 | Train Loss: 0.649 Vali Loss: 0.759 Vali Acc: 0.530 Test Loss: 0.759 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2089381217956543
Epoch: 3, Steps: 18 | Train Loss: 0.564 Vali Loss: 0.737 Vali Acc: 0.480 Test Loss: 0.737 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6237564086914062
Epoch: 4, Steps: 18 | Train Loss: 0.482 Vali Loss: 0.738 Vali Acc: 0.470 Test Loss: 0.738 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.652428388595581
Epoch: 5, Steps: 18 | Train Loss: 0.425 Vali Loss: 0.808 Vali Acc: 0.580 Test Loss: 0.808 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.7169902324676514
Epoch: 6, Steps: 18 | Train Loss: 0.312 Vali Loss: 0.770 Vali Acc: 0.520 Test Loss: 0.770 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.672924041748047
Epoch: 7, Steps: 18 | Train Loss: 0.250 Vali Loss: 0.845 Vali Acc: 0.520 Test Loss: 0.845 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.5927207469940186
Epoch: 8, Steps: 18 | Train Loss: 0.175 Vali Loss: 0.876 Vali Acc: 0.500 Test Loss: 0.876 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.9455697536468506
Epoch: 9, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.884 Vali Acc: 0.530 Test Loss: 0.884 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.1392462253570557
Epoch: 10, Steps: 18 | Train Loss: 0.072 Vali Loss: 1.122 Vali Acc: 0.510 Test Loss: 1.122 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.7139434814453125
Epoch: 11, Steps: 18 | Train Loss: 0.048 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 4644546
model size : 17.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.02451491355896
Epoch: 1, Steps: 18 | Train Loss: 0.778 Vali Loss: 0.945 Vali Acc: 0.510 Test Loss: 0.945 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 2.5425970554351807
Epoch: 2, Steps: 18 | Train Loss: 0.654 Vali Loss: 0.792 Vali Acc: 0.540 Test Loss: 0.792 Test Acc: 0.540
Validation loss decreased (-0.509991 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 2.5091564655303955
Epoch: 3, Steps: 18 | Train Loss: 0.419 Vali Loss: 0.808 Vali Acc: 0.510 Test Loss: 0.808 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6196703910827637
Epoch: 4, Steps: 18 | Train Loss: 0.226 Vali Loss: 0.975 Vali Acc: 0.460 Test Loss: 0.975 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.7432868480682373
Epoch: 5, Steps: 18 | Train Loss: 0.218 Vali Loss: 1.124 Vali Acc: 0.500 Test Loss: 1.124 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6578123569488525
Epoch: 6, Steps: 18 | Train Loss: 0.128 Vali Loss: 1.384 Vali Acc: 0.440 Test Loss: 1.384 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.7794768810272217
Epoch: 7, Steps: 18 | Train Loss: 0.085 Vali Loss: 1.929 Vali Acc: 0.450 Test Loss: 1.929 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.7431111335754395
Epoch: 8, Steps: 18 | Train Loss: 0.064 Vali Loss: 1.938 Vali Acc: 0.520 Test Loss: 1.938 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.532193183898926
Epoch: 9, Steps: 18 | Train Loss: 0.039 Vali Loss: 1.464 Vali Acc: 0.480 Test Loss: 1.464 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.67075252532959
Epoch: 10, Steps: 18 | Train Loss: 0.022 Vali Loss: 2.108 Vali Acc: 0.470 Test Loss: 2.108 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.7754876613616943
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.981 Vali Acc: 0.480 Test Loss: 1.981 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.5482468605041504
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.532 Vali Acc: 0.510 Test Loss: 1.532 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 1927938
model size : 7.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.535212516784668
Epoch: 1, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.725 Vali Acc: 0.530 Test Loss: 0.725 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 2.232422351837158
Epoch: 2, Steps: 18 | Train Loss: 0.674 Vali Loss: 0.695 Vali Acc: 0.530 Test Loss: 0.695 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 2.2706832885742188
Epoch: 3, Steps: 18 | Train Loss: 0.567 Vali Loss: 0.727 Vali Acc: 0.550 Test Loss: 0.727 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 2.0961337089538574
Epoch: 4, Steps: 18 | Train Loss: 0.473 Vali Loss: 0.720 Vali Acc: 0.470 Test Loss: 0.720 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2979915142059326
Epoch: 5, Steps: 18 | Train Loss: 0.313 Vali Loss: 0.920 Vali Acc: 0.500 Test Loss: 0.920 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2584245204925537
Epoch: 6, Steps: 18 | Train Loss: 0.167 Vali Loss: 0.937 Vali Acc: 0.470 Test Loss: 0.937 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2759101390838623
Epoch: 7, Steps: 18 | Train Loss: 0.100 Vali Loss: 1.097 Vali Acc: 0.550 Test Loss: 1.097 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2964541912078857
Epoch: 8, Steps: 18 | Train Loss: 0.053 Vali Loss: 1.286 Vali Acc: 0.490 Test Loss: 1.286 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.281193733215332
Epoch: 9, Steps: 18 | Train Loss: 0.032 Vali Loss: 1.354 Vali Acc: 0.530 Test Loss: 1.354 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.2516024112701416
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.339 Vali Acc: 0.490 Test Loss: 1.339 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.115109443664551
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.468 Vali Acc: 0.450 Test Loss: 1.468 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.424135208129883
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.717 Vali Acc: 0.450 Test Loss: 1.717 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.347456932067871
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.650 Vali Acc: 0.460 Test Loss: 1.650 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1774690
model size : 6.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.406375169754028
Epoch: 1, Steps: 18 | Train Loss: 0.749 Vali Loss: 0.728 Vali Acc: 0.520 Test Loss: 0.728 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.8747453689575195
Epoch: 2, Steps: 18 | Train Loss: 0.645 Vali Loss: 0.791 Vali Acc: 0.550 Test Loss: 0.791 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 2.97483229637146
Epoch: 3, Steps: 18 | Train Loss: 0.625 Vali Loss: 0.710 Vali Acc: 0.520 Test Loss: 0.710 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.944880485534668
Epoch: 4, Steps: 18 | Train Loss: 0.481 Vali Loss: 0.710 Vali Acc: 0.490 Test Loss: 0.710 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.8623666763305664
Epoch: 5, Steps: 18 | Train Loss: 0.352 Vali Loss: 0.750 Vali Acc: 0.500 Test Loss: 0.750 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.8437352180480957
Epoch: 6, Steps: 18 | Train Loss: 0.237 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.877082586288452
Epoch: 7, Steps: 18 | Train Loss: 0.140 Vali Loss: 0.835 Vali Acc: 0.490 Test Loss: 0.835 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.7862744331359863
Epoch: 8, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.989 Vali Acc: 0.490 Test Loss: 0.989 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.981173515319824
Epoch: 9, Steps: 18 | Train Loss: 0.043 Vali Loss: 1.069 Vali Acc: 0.540 Test Loss: 1.069 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.923412799835205
Epoch: 10, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.057 Vali Acc: 0.490 Test Loss: 1.057 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.907376766204834
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.265 Vali Acc: 0.530 Test Loss: 1.265 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.827399492263794
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.167 Vali Acc: 0.460 Test Loss: 1.167 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1719746
model size : 6.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.067841529846191
Epoch: 1, Steps: 18 | Train Loss: 0.726 Vali Loss: 0.741 Vali Acc: 0.510 Test Loss: 0.741 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.8224127292633057
Epoch: 2, Steps: 18 | Train Loss: 0.642 Vali Loss: 0.767 Vali Acc: 0.460 Test Loss: 0.767 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6518466472625732
Epoch: 3, Steps: 18 | Train Loss: 0.607 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.939945697784424
Epoch: 4, Steps: 18 | Train Loss: 0.464 Vali Loss: 0.828 Vali Acc: 0.560 Test Loss: 0.828 Test Acc: 0.560
Validation loss decreased (-0.509993 --> -0.559992).  Saving model ...
Epoch: 5 cost time: 2.918029546737671
Epoch: 5, Steps: 18 | Train Loss: 0.370 Vali Loss: 0.729 Vali Acc: 0.540 Test Loss: 0.729 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9938952922821045
Epoch: 6, Steps: 18 | Train Loss: 0.257 Vali Loss: 0.810 Vali Acc: 0.540 Test Loss: 0.810 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.904425859451294
Epoch: 7, Steps: 18 | Train Loss: 0.202 Vali Loss: 0.982 Vali Acc: 0.510 Test Loss: 0.982 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.9251596927642822
Epoch: 8, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.842 Vali Acc: 0.530 Test Loss: 0.842 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.026136636734009
Epoch: 9, Steps: 18 | Train Loss: 0.094 Vali Loss: 1.088 Vali Acc: 0.540 Test Loss: 1.088 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.8914060592651367
Epoch: 10, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.949 Vali Acc: 0.540 Test Loss: 0.949 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.236201047897339
Epoch: 11, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.971 Vali Acc: 0.500 Test Loss: 0.971 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.073667287826538
Epoch: 12, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.042 Vali Acc: 0.540 Test Loss: 1.042 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.0860979557037354
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.094 Vali Acc: 0.520 Test Loss: 1.094 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.1846835613250732
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.120 Vali Acc: 0.540 Test Loss: 1.120 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1697570
model size : 6.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.114104747772217
Epoch: 1, Steps: 18 | Train Loss: 0.705 Vali Loss: 0.737 Vali Acc: 0.550 Test Loss: 0.737 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.949685573577881
Epoch: 2, Steps: 18 | Train Loss: 0.667 Vali Loss: 0.746 Vali Acc: 0.470 Test Loss: 0.746 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.860779285430908
Epoch: 3, Steps: 18 | Train Loss: 0.609 Vali Loss: 0.736 Vali Acc: 0.570 Test Loss: 0.736 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 3.0038869380950928
Epoch: 4, Steps: 18 | Train Loss: 0.525 Vali Loss: 0.772 Vali Acc: 0.590 Test Loss: 0.772 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589992).  Saving model ...
Epoch: 5 cost time: 2.9635860919952393
Epoch: 5, Steps: 18 | Train Loss: 0.447 Vali Loss: 0.729 Vali Acc: 0.540 Test Loss: 0.729 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8995213508605957
Epoch: 6, Steps: 18 | Train Loss: 0.378 Vali Loss: 0.767 Vali Acc: 0.520 Test Loss: 0.767 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8267734050750732
Epoch: 7, Steps: 18 | Train Loss: 0.269 Vali Loss: 0.808 Vali Acc: 0.540 Test Loss: 0.808 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.813737154006958
Epoch: 8, Steps: 18 | Train Loss: 0.208 Vali Loss: 0.874 Vali Acc: 0.500 Test Loss: 0.874 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.9216127395629883
Epoch: 9, Steps: 18 | Train Loss: 0.145 Vali Loss: 0.862 Vali Acc: 0.530 Test Loss: 0.862 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.7064778804779053
Epoch: 10, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.901 Vali Acc: 0.480 Test Loss: 0.901 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.848363161087036
Epoch: 11, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.935 Vali Acc: 0.500 Test Loss: 0.935 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.7981460094451904
Epoch: 12, Steps: 18 | Train Loss: 0.035 Vali Loss: 1.090 Vali Acc: 0.520 Test Loss: 1.090 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.7046215534210205
Epoch: 13, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.061 Vali Acc: 0.500 Test Loss: 1.061 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.961338520050049
Epoch: 14, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.090 Vali Acc: 0.480 Test Loss: 1.090 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1677794
model size : 6.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.310407400131226
Epoch: 1, Steps: 18 | Train Loss: 0.715 Vali Loss: 0.712 Vali Acc: 0.460 Test Loss: 0.712 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 2.7825815677642822
Epoch: 2, Steps: 18 | Train Loss: 0.664 Vali Loss: 0.778 Vali Acc: 0.450 Test Loss: 0.778 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6766695976257324
Epoch: 3, Steps: 18 | Train Loss: 0.626 Vali Loss: 0.763 Vali Acc: 0.520 Test Loss: 0.763 Test Acc: 0.520
Validation loss decreased (-0.459993 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 2.7546133995056152
Epoch: 4, Steps: 18 | Train Loss: 0.537 Vali Loss: 0.710 Vali Acc: 0.540 Test Loss: 0.710 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 2.8906400203704834
Epoch: 5, Steps: 18 | Train Loss: 0.480 Vali Loss: 0.747 Vali Acc: 0.530 Test Loss: 0.747 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.675241231918335
Epoch: 6, Steps: 18 | Train Loss: 0.417 Vali Loss: 0.731 Vali Acc: 0.470 Test Loss: 0.731 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.851102113723755
Epoch: 7, Steps: 18 | Train Loss: 0.346 Vali Loss: 0.745 Vali Acc: 0.520 Test Loss: 0.745 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.850458860397339
Epoch: 8, Steps: 18 | Train Loss: 0.273 Vali Loss: 0.791 Vali Acc: 0.480 Test Loss: 0.791 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.824021577835083
Epoch: 9, Steps: 18 | Train Loss: 0.217 Vali Loss: 0.780 Vali Acc: 0.550 Test Loss: 0.780 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 10 cost time: 2.7815279960632324
Epoch: 10, Steps: 18 | Train Loss: 0.162 Vali Loss: 0.767 Vali Acc: 0.510 Test Loss: 0.767 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7887067794799805
Epoch: 11, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.823 Vali Acc: 0.490 Test Loss: 0.823 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.832092523574829
Epoch: 12, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.910 Vali Acc: 0.530 Test Loss: 0.910 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.433501958847046
Epoch: 13, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.994 Vali Acc: 0.510 Test Loss: 0.994 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.7765750885009766
Epoch: 14, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.988 Vali Acc: 0.520 Test Loss: 0.988 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.7666823863983154
Epoch: 15, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.985 Vali Acc: 0.480 Test Loss: 0.985 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.7029335498809814
Epoch: 16, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.029 Vali Acc: 0.510 Test Loss: 1.029 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.8402962684631348
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.095 Vali Acc: 0.510 Test Loss: 1.095 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.755605697631836
Epoch: 18, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.039 Vali Acc: 0.520 Test Loss: 1.039 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.9315316677093506
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.034 Vali Acc: 0.500 Test Loss: 1.034 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1666210
model size : 6.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.9703264236450195
Epoch: 1, Steps: 18 | Train Loss: 0.714 Vali Loss: 0.705 Vali Acc: 0.460 Test Loss: 0.705 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.7583045959472656
Epoch: 2, Steps: 18 | Train Loss: 0.668 Vali Loss: 0.749 Vali Acc: 0.540 Test Loss: 0.749 Test Acc: 0.540
Validation loss decreased (-0.459993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 1.798323154449463
Epoch: 3, Steps: 18 | Train Loss: 0.630 Vali Loss: 0.728 Vali Acc: 0.480 Test Loss: 0.728 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8350298404693604
Epoch: 4, Steps: 18 | Train Loss: 0.575 Vali Loss: 0.722 Vali Acc: 0.530 Test Loss: 0.722 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.769165277481079
Epoch: 5, Steps: 18 | Train Loss: 0.511 Vali Loss: 0.736 Vali Acc: 0.520 Test Loss: 0.736 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7859721183776855
Epoch: 6, Steps: 18 | Train Loss: 0.439 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7469468116760254
Epoch: 7, Steps: 18 | Train Loss: 0.372 Vali Loss: 0.719 Vali Acc: 0.510 Test Loss: 0.719 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.811396598815918
Epoch: 8, Steps: 18 | Train Loss: 0.321 Vali Loss: 0.745 Vali Acc: 0.520 Test Loss: 0.745 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6207568645477295
Epoch: 9, Steps: 18 | Train Loss: 0.249 Vali Loss: 0.785 Vali Acc: 0.500 Test Loss: 0.785 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7045364379882812
Epoch: 10, Steps: 18 | Train Loss: 0.202 Vali Loss: 0.823 Vali Acc: 0.500 Test Loss: 0.823 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6900973320007324
Epoch: 11, Steps: 18 | Train Loss: 0.161 Vali Loss: 0.879 Vali Acc: 0.510 Test Loss: 0.879 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8248345851898193
Epoch: 12, Steps: 18 | Train Loss: 0.115 Vali Loss: 1.022 Vali Acc: 0.560 Test Loss: 1.022 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559990).  Saving model ...
Epoch: 13 cost time: 1.7440545558929443
Epoch: 13, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.916 Vali Acc: 0.530 Test Loss: 0.916 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7010681629180908
Epoch: 14, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.902 Vali Acc: 0.520 Test Loss: 0.902 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7144317626953125
Epoch: 15, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.904 Vali Acc: 0.530 Test Loss: 0.904 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8202528953552246
Epoch: 16, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.937 Vali Acc: 0.490 Test Loss: 0.937 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6689627170562744
Epoch: 17, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.010 Vali Acc: 0.550 Test Loss: 1.010 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.642179250717163
Epoch: 18, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.991 Vali Acc: 0.530 Test Loss: 0.991 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.809981346130371
Epoch: 19, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.055 Vali Acc: 0.570 Test Loss: 1.055 Test Acc: 0.570
Validation loss decreased (-0.559990 --> -0.569989).  Saving model ...
Epoch: 20 cost time: 1.7477803230285645
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.112 Vali Acc: 0.540 Test Loss: 1.112 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7220261096954346
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.060 Vali Acc: 0.520 Test Loss: 1.060 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8253505229949951
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.082 Vali Acc: 0.500 Test Loss: 1.082 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7085943222045898
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.105 Vali Acc: 0.480 Test Loss: 1.105 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6748406887054443
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.121 Vali Acc: 0.530 Test Loss: 1.121 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6357421875
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.129 Vali Acc: 0.520 Test Loss: 1.129 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.87088942527771
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.121 Vali Acc: 0.510 Test Loss: 1.121 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8284008502960205
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.181 Vali Acc: 0.520 Test Loss: 1.181 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.799187421798706
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.172 Vali Acc: 0.510 Test Loss: 1.172 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.7028372287750244
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1662818
model size : 6.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.00675344467163
Epoch: 1, Steps: 18 | Train Loss: 1.071 Vali Loss: 1.326 Vali Acc: 0.460 Test Loss: 1.326 Test Acc: 0.460
Validation loss decreased (inf --> -0.459987).  Saving model ...
Epoch: 2 cost time: 11.887781620025635
Epoch: 2, Steps: 18 | Train Loss: 0.724 Vali Loss: 1.139 Vali Acc: 0.510 Test Loss: 1.139 Test Acc: 0.510
Validation loss decreased (-0.459987 --> -0.509989).  Saving model ...
Epoch: 3 cost time: 11.703030109405518
Epoch: 3, Steps: 18 | Train Loss: 0.402 Vali Loss: 1.342 Vali Acc: 0.530 Test Loss: 1.342 Test Acc: 0.530
Validation loss decreased (-0.509989 --> -0.529987).  Saving model ...
Epoch: 4 cost time: 11.479466915130615
Epoch: 4, Steps: 18 | Train Loss: 0.272 Vali Loss: 2.565 Vali Acc: 0.470 Test Loss: 2.565 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.540619850158691
Epoch: 5, Steps: 18 | Train Loss: 0.412 Vali Loss: 2.368 Vali Acc: 0.550 Test Loss: 2.368 Test Acc: 0.550
Validation loss decreased (-0.529987 --> -0.549976).  Saving model ...
Epoch: 6 cost time: 11.299132585525513
Epoch: 6, Steps: 18 | Train Loss: 0.360 Vali Loss: 2.674 Vali Acc: 0.550 Test Loss: 2.674 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.297126293182373
Epoch: 7, Steps: 18 | Train Loss: 0.227 Vali Loss: 3.971 Vali Acc: 0.480 Test Loss: 3.971 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.247034549713135
Epoch: 8, Steps: 18 | Train Loss: 0.275 Vali Loss: 4.655 Vali Acc: 0.480 Test Loss: 4.655 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.118569612503052
Epoch: 9, Steps: 18 | Train Loss: 0.195 Vali Loss: 5.754 Vali Acc: 0.470 Test Loss: 5.754 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.542218685150146
Epoch: 10, Steps: 18 | Train Loss: 0.343 Vali Loss: 4.038 Vali Acc: 0.560 Test Loss: 4.038 Test Acc: 0.560
Validation loss decreased (-0.549976 --> -0.559960).  Saving model ...
Epoch: 11 cost time: 11.387338876724243
Epoch: 11, Steps: 18 | Train Loss: 0.337 Vali Loss: 4.557 Vali Acc: 0.460 Test Loss: 4.557 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.971305131912231
Epoch: 12, Steps: 18 | Train Loss: 0.086 Vali Loss: 4.303 Vali Acc: 0.520 Test Loss: 4.303 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 11.600935935974121
Epoch: 13, Steps: 18 | Train Loss: 0.219 Vali Loss: 6.365 Vali Acc: 0.450 Test Loss: 6.365 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 11.65817666053772
Epoch: 14, Steps: 18 | Train Loss: 0.176 Vali Loss: 7.320 Vali Acc: 0.420 Test Loss: 7.320 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 11.966378211975098
Epoch: 15, Steps: 18 | Train Loss: 0.136 Vali Loss: 4.512 Vali Acc: 0.470 Test Loss: 4.512 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 12.111555814743042
Epoch: 16, Steps: 18 | Train Loss: 0.209 Vali Loss: 5.543 Vali Acc: 0.460 Test Loss: 5.543 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 11.350951433181763
Epoch: 17, Steps: 18 | Train Loss: 0.085 Vali Loss: 7.333 Vali Acc: 0.500 Test Loss: 7.333 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 11.453868865966797
Epoch: 18, Steps: 18 | Train Loss: 0.114 Vali Loss: 7.466 Vali Acc: 0.470 Test Loss: 7.466 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 11.945608615875244
Epoch: 19, Steps: 18 | Train Loss: 0.171 Vali Loss: 10.812 Vali Acc: 0.410 Test Loss: 10.812 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 11.744611263275146
Epoch: 20, Steps: 18 | Train Loss: 0.253 Vali Loss: 9.636 Vali Acc: 0.470 Test Loss: 9.636 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 15526914
model size : 59.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.13017201423645
Epoch: 1, Steps: 18 | Train Loss: 0.832 Vali Loss: 0.983 Vali Acc: 0.630 Test Loss: 0.983 Test Acc: 0.630
Validation loss decreased (inf --> -0.629990).  Saving model ...
Epoch: 2 cost time: 6.711406946182251
Epoch: 2, Steps: 18 | Train Loss: 0.583 Vali Loss: 0.915 Vali Acc: 0.540 Test Loss: 0.915 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.47270393371582
Epoch: 3, Steps: 18 | Train Loss: 0.392 Vali Loss: 0.991 Vali Acc: 0.500 Test Loss: 0.991 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.515191316604614
Epoch: 4, Steps: 18 | Train Loss: 0.510 Vali Loss: 1.239 Vali Acc: 0.520 Test Loss: 1.239 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.516951322555542
Epoch: 5, Steps: 18 | Train Loss: 0.198 Vali Loss: 1.781 Vali Acc: 0.500 Test Loss: 1.781 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.421976327896118
Epoch: 6, Steps: 18 | Train Loss: 0.304 Vali Loss: 1.959 Vali Acc: 0.540 Test Loss: 1.959 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.509209156036377
Epoch: 7, Steps: 18 | Train Loss: 0.355 Vali Loss: 1.660 Vali Acc: 0.560 Test Loss: 1.660 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.723529577255249
Epoch: 8, Steps: 18 | Train Loss: 0.124 Vali Loss: 2.657 Vali Acc: 0.500 Test Loss: 2.657 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.7941365242004395
Epoch: 9, Steps: 18 | Train Loss: 0.176 Vali Loss: 3.417 Vali Acc: 0.480 Test Loss: 3.417 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.902527809143066
Epoch: 10, Steps: 18 | Train Loss: 0.056 Vali Loss: 3.566 Vali Acc: 0.450 Test Loss: 3.566 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.2891364097595215
Epoch: 11, Steps: 18 | Train Loss: 0.060 Vali Loss: 5.215 Vali Acc: 0.500 Test Loss: 5.215 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 14913922
model size : 57.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.784600257873535
Epoch: 1, Steps: 18 | Train Loss: 0.806 Vali Loss: 0.901 Vali Acc: 0.530 Test Loss: 0.901 Test Acc: 0.530
Validation loss decreased (inf --> -0.529991).  Saving model ...
Epoch: 2 cost time: 9.447790622711182
Epoch: 2, Steps: 18 | Train Loss: 0.634 Vali Loss: 0.846 Vali Acc: 0.520 Test Loss: 0.846 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.543933629989624
Epoch: 3, Steps: 18 | Train Loss: 0.485 Vali Loss: 0.919 Vali Acc: 0.500 Test Loss: 0.919 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.798548936843872
Epoch: 4, Steps: 18 | Train Loss: 0.350 Vali Loss: 1.343 Vali Acc: 0.440 Test Loss: 1.343 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.361265420913696
Epoch: 5, Steps: 18 | Train Loss: 0.181 Vali Loss: 1.207 Vali Acc: 0.490 Test Loss: 1.207 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.219954252243042
Epoch: 6, Steps: 18 | Train Loss: 0.123 Vali Loss: 1.932 Vali Acc: 0.490 Test Loss: 1.932 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.466037511825562
Epoch: 7, Steps: 18 | Train Loss: 0.184 Vali Loss: 1.707 Vali Acc: 0.480 Test Loss: 1.707 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.267707586288452
Epoch: 8, Steps: 18 | Train Loss: 0.146 Vali Loss: 1.956 Vali Acc: 0.560 Test Loss: 1.956 Test Acc: 0.560
Validation loss decreased (-0.529991 --> -0.559980).  Saving model ...
Epoch: 9 cost time: 9.260947942733765
Epoch: 9, Steps: 18 | Train Loss: 0.136 Vali Loss: 1.892 Vali Acc: 0.500 Test Loss: 1.892 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.315609216690063
Epoch: 10, Steps: 18 | Train Loss: 0.160 Vali Loss: 2.433 Vali Acc: 0.510 Test Loss: 2.433 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.362571716308594
Epoch: 11, Steps: 18 | Train Loss: 0.108 Vali Loss: 3.813 Vali Acc: 0.530 Test Loss: 3.813 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.090090274810791
Epoch: 12, Steps: 18 | Train Loss: 0.066 Vali Loss: 2.634 Vali Acc: 0.470 Test Loss: 2.634 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.234990119934082
Epoch: 13, Steps: 18 | Train Loss: 0.085 Vali Loss: 3.304 Vali Acc: 0.420 Test Loss: 3.304 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.413434028625488
Epoch: 14, Steps: 18 | Train Loss: 0.137 Vali Loss: 4.750 Vali Acc: 0.460 Test Loss: 4.750 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 8.869746923446655
Epoch: 15, Steps: 18 | Train Loss: 0.532 Vali Loss: 2.549 Vali Acc: 0.540 Test Loss: 2.549 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.04108715057373
Epoch: 16, Steps: 18 | Train Loss: 0.039 Vali Loss: 3.368 Vali Acc: 0.480 Test Loss: 3.368 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 9.043872594833374
Epoch: 17, Steps: 18 | Train Loss: 0.063 Vali Loss: 2.985 Vali Acc: 0.550 Test Loss: 2.985 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 9.077618837356567
Epoch: 18, Steps: 18 | Train Loss: 0.030 Vali Loss: 3.096 Vali Acc: 0.550 Test Loss: 3.096 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 14694146
model size : 56.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.89265489578247
Epoch: 1, Steps: 18 | Train Loss: 0.734 Vali Loss: 0.911 Vali Acc: 0.600 Test Loss: 0.911 Test Acc: 0.600
Validation loss decreased (inf --> -0.599991).  Saving model ...
Epoch: 2 cost time: 7.5456223487854
Epoch: 2, Steps: 18 | Train Loss: 0.584 Vali Loss: 0.827 Vali Acc: 0.490 Test Loss: 0.827 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.069098234176636
Epoch: 3, Steps: 18 | Train Loss: 0.394 Vali Loss: 0.846 Vali Acc: 0.490 Test Loss: 0.846 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.859659671783447
Epoch: 4, Steps: 18 | Train Loss: 0.315 Vali Loss: 0.874 Vali Acc: 0.500 Test Loss: 0.874 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.932402610778809
Epoch: 5, Steps: 18 | Train Loss: 0.189 Vali Loss: 1.035 Vali Acc: 0.530 Test Loss: 1.035 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.984577655792236
Epoch: 6, Steps: 18 | Train Loss: 0.124 Vali Loss: 1.363 Vali Acc: 0.530 Test Loss: 1.363 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.924620151519775
Epoch: 7, Steps: 18 | Train Loss: 0.096 Vali Loss: 1.827 Vali Acc: 0.590 Test Loss: 1.827 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.911705732345581
Epoch: 8, Steps: 18 | Train Loss: 0.093 Vali Loss: 1.891 Vali Acc: 0.490 Test Loss: 1.891 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.876138687133789
Epoch: 9, Steps: 18 | Train Loss: 0.102 Vali Loss: 1.569 Vali Acc: 0.520 Test Loss: 1.569 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.809178590774536
Epoch: 10, Steps: 18 | Train Loss: 0.063 Vali Loss: 2.345 Vali Acc: 0.480 Test Loss: 2.345 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.934693336486816
Epoch: 11, Steps: 18 | Train Loss: 0.095 Vali Loss: 1.941 Vali Acc: 0.570 Test Loss: 1.941 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 14605442
model size : 56.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.639150142669678
Epoch: 1, Steps: 18 | Train Loss: 0.770 Vali Loss: 0.743 Vali Acc: 0.480 Test Loss: 0.743 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 7.803447961807251
Epoch: 2, Steps: 18 | Train Loss: 0.691 Vali Loss: 0.780 Vali Acc: 0.600 Test Loss: 0.780 Test Acc: 0.600
Validation loss decreased (-0.479993 --> -0.599992).  Saving model ...
Epoch: 3 cost time: 7.892754316329956
Epoch: 3, Steps: 18 | Train Loss: 0.496 Vali Loss: 0.752 Vali Acc: 0.490 Test Loss: 0.752 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.660163164138794
Epoch: 4, Steps: 18 | Train Loss: 0.316 Vali Loss: 0.872 Vali Acc: 0.530 Test Loss: 0.872 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.783548831939697
Epoch: 5, Steps: 18 | Train Loss: 0.232 Vali Loss: 0.832 Vali Acc: 0.480 Test Loss: 0.832 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.5276477336883545
Epoch: 6, Steps: 18 | Train Loss: 0.142 Vali Loss: 1.008 Vali Acc: 0.470 Test Loss: 1.008 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.790439128875732
Epoch: 7, Steps: 18 | Train Loss: 0.123 Vali Loss: 1.143 Vali Acc: 0.560 Test Loss: 1.143 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.74018669128418
Epoch: 8, Steps: 18 | Train Loss: 0.079 Vali Loss: 1.630 Vali Acc: 0.470 Test Loss: 1.630 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.804511785507202
Epoch: 9, Steps: 18 | Train Loss: 0.150 Vali Loss: 2.176 Vali Acc: 0.510 Test Loss: 2.176 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.624319791793823
Epoch: 10, Steps: 18 | Train Loss: 0.096 Vali Loss: 1.360 Vali Acc: 0.470 Test Loss: 1.360 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.721060037612915
Epoch: 11, Steps: 18 | Train Loss: 0.052 Vali Loss: 1.748 Vali Acc: 0.470 Test Loss: 1.748 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.656089544296265
Epoch: 12, Steps: 18 | Train Loss: 0.035 Vali Loss: 1.779 Vali Acc: 0.460 Test Loss: 1.779 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 14526338
model size : 55.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.443983793258667
Epoch: 1, Steps: 18 | Train Loss: 0.791 Vali Loss: 0.786 Vali Acc: 0.600 Test Loss: 0.786 Test Acc: 0.600
Validation loss decreased (inf --> -0.599992).  Saving model ...
Epoch: 2 cost time: 7.133725166320801
Epoch: 2, Steps: 18 | Train Loss: 0.609 Vali Loss: 0.930 Vali Acc: 0.490 Test Loss: 0.930 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.4958086013793945
Epoch: 3, Steps: 18 | Train Loss: 0.545 Vali Loss: 0.926 Vali Acc: 0.490 Test Loss: 0.926 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.609438896179199
Epoch: 4, Steps: 18 | Train Loss: 0.413 Vali Loss: 0.989 Vali Acc: 0.510 Test Loss: 0.989 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.5762481689453125
Epoch: 5, Steps: 18 | Train Loss: 0.283 Vali Loss: 0.889 Vali Acc: 0.470 Test Loss: 0.889 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.397819995880127
Epoch: 6, Steps: 18 | Train Loss: 0.178 Vali Loss: 1.062 Vali Acc: 0.530 Test Loss: 1.062 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.399794340133667
Epoch: 7, Steps: 18 | Train Loss: 0.136 Vali Loss: 1.139 Vali Acc: 0.520 Test Loss: 1.139 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.577150583267212
Epoch: 8, Steps: 18 | Train Loss: 0.097 Vali Loss: 1.285 Vali Acc: 0.470 Test Loss: 1.285 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.580700159072876
Epoch: 9, Steps: 18 | Train Loss: 0.074 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.839259147644043
Epoch: 10, Steps: 18 | Train Loss: 0.044 Vali Loss: 1.219 Vali Acc: 0.490 Test Loss: 1.219 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.408232688903809
Epoch: 11, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.223 Vali Acc: 0.490 Test Loss: 1.223 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 14480002
model size : 55.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.0174171924591064
Epoch: 1, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.801 Vali Acc: 0.560 Test Loss: 0.801 Test Acc: 0.560
Validation loss decreased (inf --> -0.559992).  Saving model ...
Epoch: 2 cost time: 4.795478105545044
Epoch: 2, Steps: 18 | Train Loss: 0.682 Vali Loss: 0.769 Vali Acc: 0.460 Test Loss: 0.769 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.057171821594238
Epoch: 3, Steps: 18 | Train Loss: 0.547 Vali Loss: 0.807 Vali Acc: 0.460 Test Loss: 0.807 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.599172830581665
Epoch: 4, Steps: 18 | Train Loss: 0.417 Vali Loss: 0.747 Vali Acc: 0.540 Test Loss: 0.747 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.838995695114136
Epoch: 5, Steps: 18 | Train Loss: 0.314 Vali Loss: 0.982 Vali Acc: 0.550 Test Loss: 0.982 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.2409706115722656
Epoch: 6, Steps: 18 | Train Loss: 0.258 Vali Loss: 0.934 Vali Acc: 0.500 Test Loss: 0.934 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.994405508041382
Epoch: 7, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.852 Vali Acc: 0.560 Test Loss: 0.852 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.791766166687012
Epoch: 8, Steps: 18 | Train Loss: 0.124 Vali Loss: 1.008 Vali Acc: 0.550 Test Loss: 1.008 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.171425819396973
Epoch: 9, Steps: 18 | Train Loss: 0.056 Vali Loss: 1.109 Vali Acc: 0.550 Test Loss: 1.109 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.90280556678772
Epoch: 10, Steps: 18 | Train Loss: 0.037 Vali Loss: 1.415 Vali Acc: 0.520 Test Loss: 1.415 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.635285377502441
Epoch: 11, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.256 Vali Acc: 0.520 Test Loss: 1.256 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 14466434
model size : 55.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.761792182922363
Epoch: 1, Steps: 18 | Train Loss: 0.807 Vali Loss: 0.873 Vali Acc: 0.540 Test Loss: 0.873 Test Acc: 0.540
Validation loss decreased (inf --> -0.539991).  Saving model ...
Epoch: 2 cost time: 5.508017301559448
Epoch: 2, Steps: 18 | Train Loss: 0.633 Vali Loss: 0.847 Vali Acc: 0.560 Test Loss: 0.847 Test Acc: 0.560
Validation loss decreased (-0.539991 --> -0.559992).  Saving model ...
Epoch: 3 cost time: 4.913011074066162
Epoch: 3, Steps: 18 | Train Loss: 0.469 Vali Loss: 1.207 Vali Acc: 0.430 Test Loss: 1.207 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.009725570678711
Epoch: 4, Steps: 18 | Train Loss: 0.281 Vali Loss: 1.218 Vali Acc: 0.490 Test Loss: 1.218 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.180917263031006
Epoch: 5, Steps: 18 | Train Loss: 0.170 Vali Loss: 1.583 Vali Acc: 0.460 Test Loss: 1.583 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.056983947753906
Epoch: 6, Steps: 18 | Train Loss: 0.156 Vali Loss: 1.515 Vali Acc: 0.460 Test Loss: 1.515 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.5081751346588135
Epoch: 7, Steps: 18 | Train Loss: 0.076 Vali Loss: 1.673 Vali Acc: 0.470 Test Loss: 1.673 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.742542505264282
Epoch: 8, Steps: 18 | Train Loss: 0.100 Vali Loss: 3.170 Vali Acc: 0.450 Test Loss: 3.170 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.5184571743011475
Epoch: 9, Steps: 18 | Train Loss: 0.114 Vali Loss: 2.071 Vali Acc: 0.500 Test Loss: 2.071 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.058809757232666
Epoch: 10, Steps: 18 | Train Loss: 0.096 Vali Loss: 2.151 Vali Acc: 0.490 Test Loss: 2.151 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.016630411148071
Epoch: 11, Steps: 18 | Train Loss: 0.050 Vali Loss: 2.968 Vali Acc: 0.480 Test Loss: 2.968 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.464156627655029
Epoch: 12, Steps: 18 | Train Loss: 0.017 Vali Loss: 2.637 Vali Acc: 0.530 Test Loss: 2.637 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 5125634
model size : 19.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.897677898406982
Epoch: 1, Steps: 18 | Train Loss: 0.780 Vali Loss: 0.818 Vali Acc: 0.480 Test Loss: 0.818 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 3.845961332321167
Epoch: 2, Steps: 18 | Train Loss: 0.596 Vali Loss: 0.774 Vali Acc: 0.550 Test Loss: 0.774 Test Acc: 0.550
Validation loss decreased (-0.479992 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 3.8151278495788574
Epoch: 3, Steps: 18 | Train Loss: 0.491 Vali Loss: 0.962 Vali Acc: 0.580 Test Loss: 0.962 Test Acc: 0.580
Validation loss decreased (-0.549992 --> -0.579990).  Saving model ...
Epoch: 4 cost time: 3.6157569885253906
Epoch: 4, Steps: 18 | Train Loss: 0.281 Vali Loss: 0.943 Vali Acc: 0.480 Test Loss: 0.943 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6317591667175293
Epoch: 5, Steps: 18 | Train Loss: 0.241 Vali Loss: 1.197 Vali Acc: 0.540 Test Loss: 1.197 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.7075002193450928
Epoch: 6, Steps: 18 | Train Loss: 0.167 Vali Loss: 1.661 Vali Acc: 0.440 Test Loss: 1.661 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6765363216400146
Epoch: 7, Steps: 18 | Train Loss: 0.134 Vali Loss: 1.478 Vali Acc: 0.490 Test Loss: 1.478 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.6401331424713135
Epoch: 8, Steps: 18 | Train Loss: 0.061 Vali Loss: 1.392 Vali Acc: 0.480 Test Loss: 1.392 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.818251132965088
Epoch: 9, Steps: 18 | Train Loss: 0.055 Vali Loss: 2.068 Vali Acc: 0.470 Test Loss: 2.068 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.8043112754821777
Epoch: 10, Steps: 18 | Train Loss: 0.024 Vali Loss: 1.876 Vali Acc: 0.510 Test Loss: 1.876 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.4831042289733887
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 2.195 Vali Acc: 0.540 Test Loss: 2.195 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.814338207244873
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 2.237 Vali Acc: 0.540 Test Loss: 2.237 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.4951469898223877
Epoch: 13, Steps: 18 | Train Loss: 0.022 Vali Loss: 2.303 Vali Acc: 0.540 Test Loss: 2.303 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 4819138
model size : 18.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.517685174942017
Epoch: 1, Steps: 18 | Train Loss: 0.735 Vali Loss: 0.747 Vali Acc: 0.430 Test Loss: 0.747 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 5.102045059204102
Epoch: 2, Steps: 18 | Train Loss: 0.606 Vali Loss: 0.767 Vali Acc: 0.550 Test Loss: 0.767 Test Acc: 0.550
Validation loss decreased (-0.429993 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 5.3637731075286865
Epoch: 3, Steps: 18 | Train Loss: 0.448 Vali Loss: 0.829 Vali Acc: 0.520 Test Loss: 0.829 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.92315673828125
Epoch: 4, Steps: 18 | Train Loss: 0.325 Vali Loss: 0.819 Vali Acc: 0.550 Test Loss: 0.819 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.1690123081207275
Epoch: 5, Steps: 18 | Train Loss: 0.217 Vali Loss: 1.308 Vali Acc: 0.570 Test Loss: 1.308 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569987).  Saving model ...
Epoch: 6 cost time: 5.1927995681762695
Epoch: 6, Steps: 18 | Train Loss: 0.204 Vali Loss: 1.061 Vali Acc: 0.510 Test Loss: 1.061 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.914561748504639
Epoch: 7, Steps: 18 | Train Loss: 0.111 Vali Loss: 1.089 Vali Acc: 0.490 Test Loss: 1.089 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.100367307662964
Epoch: 8, Steps: 18 | Train Loss: 0.093 Vali Loss: 1.177 Vali Acc: 0.490 Test Loss: 1.177 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.070567607879639
Epoch: 9, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.341 Vali Acc: 0.470 Test Loss: 1.341 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.99359655380249
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.310 Vali Acc: 0.480 Test Loss: 1.310 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.064847707748413
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.484 Vali Acc: 0.500 Test Loss: 1.484 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.1772377490997314
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.830 Vali Acc: 0.470 Test Loss: 1.830 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.987067699432373
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.678 Vali Acc: 0.530 Test Loss: 1.678 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.184125661849976
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.654 Vali Acc: 0.510 Test Loss: 1.654 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.0877721309661865
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.669 Vali Acc: 0.530 Test Loss: 1.669 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 4709250
model size : 18.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.756879806518555
Epoch: 1, Steps: 18 | Train Loss: 0.722 Vali Loss: 0.727 Vali Acc: 0.600 Test Loss: 0.727 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 4.106846570968628
Epoch: 2, Steps: 18 | Train Loss: 0.633 Vali Loss: 0.794 Vali Acc: 0.490 Test Loss: 0.794 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.109715700149536
Epoch: 3, Steps: 18 | Train Loss: 0.498 Vali Loss: 0.805 Vali Acc: 0.530 Test Loss: 0.805 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.203518867492676
Epoch: 4, Steps: 18 | Train Loss: 0.340 Vali Loss: 0.768 Vali Acc: 0.550 Test Loss: 0.768 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.140350341796875
Epoch: 5, Steps: 18 | Train Loss: 0.227 Vali Loss: 1.172 Vali Acc: 0.540 Test Loss: 1.172 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.222347259521484
Epoch: 6, Steps: 18 | Train Loss: 0.141 Vali Loss: 0.818 Vali Acc: 0.560 Test Loss: 0.818 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.208118915557861
Epoch: 7, Steps: 18 | Train Loss: 0.097 Vali Loss: 1.189 Vali Acc: 0.470 Test Loss: 1.189 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.156517505645752
Epoch: 8, Steps: 18 | Train Loss: 0.046 Vali Loss: 1.177 Vali Acc: 0.530 Test Loss: 1.177 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.109797716140747
Epoch: 9, Steps: 18 | Train Loss: 0.027 Vali Loss: 1.296 Vali Acc: 0.480 Test Loss: 1.296 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.178334474563599
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.309 Vali Acc: 0.490 Test Loss: 1.309 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.178850412368774
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.319 Vali Acc: 0.500 Test Loss: 1.319 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 4664898
model size : 18.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.988065481185913
Epoch: 1, Steps: 18 | Train Loss: 0.713 Vali Loss: 0.741 Vali Acc: 0.460 Test Loss: 0.741 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 4.718948602676392
Epoch: 2, Steps: 18 | Train Loss: 0.618 Vali Loss: 0.746 Vali Acc: 0.440 Test Loss: 0.746 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.007530212402344
Epoch: 3, Steps: 18 | Train Loss: 0.542 Vali Loss: 0.790 Vali Acc: 0.460 Test Loss: 0.790 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.671602487564087
Epoch: 4, Steps: 18 | Train Loss: 0.439 Vali Loss: 0.799 Vali Acc: 0.530 Test Loss: 0.799 Test Acc: 0.530
Validation loss decreased (-0.459993 --> -0.529992).  Saving model ...
Epoch: 5 cost time: 4.800588846206665
Epoch: 5, Steps: 18 | Train Loss: 0.326 Vali Loss: 0.848 Vali Acc: 0.430 Test Loss: 0.848 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.850767135620117
Epoch: 6, Steps: 18 | Train Loss: 0.276 Vali Loss: 1.070 Vali Acc: 0.560 Test Loss: 1.070 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559989).  Saving model ...
Epoch: 7 cost time: 4.872797012329102
Epoch: 7, Steps: 18 | Train Loss: 0.149 Vali Loss: 0.945 Vali Acc: 0.540 Test Loss: 0.945 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.929814100265503
Epoch: 8, Steps: 18 | Train Loss: 0.132 Vali Loss: 1.104 Vali Acc: 0.460 Test Loss: 1.104 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.861491680145264
Epoch: 9, Steps: 18 | Train Loss: 0.056 Vali Loss: 1.207 Vali Acc: 0.490 Test Loss: 1.207 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.053866863250732
Epoch: 10, Steps: 18 | Train Loss: 0.044 Vali Loss: 1.200 Vali Acc: 0.510 Test Loss: 1.200 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.807498931884766
Epoch: 11, Steps: 18 | Train Loss: 0.036 Vali Loss: 1.207 Vali Acc: 0.470 Test Loss: 1.207 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.949946403503418
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.299 Vali Acc: 0.480 Test Loss: 1.299 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.801740646362305
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.324 Vali Acc: 0.490 Test Loss: 1.324 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.839879512786865
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.392 Vali Acc: 0.460 Test Loss: 1.392 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.868279933929443
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.411 Vali Acc: 0.490 Test Loss: 1.411 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.019454002380371
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.417 Vali Acc: 0.470 Test Loss: 1.417 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 4625346
model size : 17.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.917402982711792
Epoch: 1, Steps: 18 | Train Loss: 0.719 Vali Loss: 0.712 Vali Acc: 0.470 Test Loss: 0.712 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 4.6182849407196045
Epoch: 2, Steps: 18 | Train Loss: 0.649 Vali Loss: 0.843 Vali Acc: 0.510 Test Loss: 0.843 Test Acc: 0.510
Validation loss decreased (-0.469993 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 4.626950263977051
Epoch: 3, Steps: 18 | Train Loss: 0.588 Vali Loss: 0.753 Vali Acc: 0.460 Test Loss: 0.753 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.673797369003296
Epoch: 4, Steps: 18 | Train Loss: 0.480 Vali Loss: 0.727 Vali Acc: 0.540 Test Loss: 0.727 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 4.462010383605957
Epoch: 5, Steps: 18 | Train Loss: 0.354 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.659729242324829
Epoch: 6, Steps: 18 | Train Loss: 0.260 Vali Loss: 0.885 Vali Acc: 0.530 Test Loss: 0.885 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.7000572681427
Epoch: 7, Steps: 18 | Train Loss: 0.177 Vali Loss: 0.866 Vali Acc: 0.530 Test Loss: 0.866 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.703688144683838
Epoch: 8, Steps: 18 | Train Loss: 0.113 Vali Loss: 0.896 Vali Acc: 0.510 Test Loss: 0.896 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.870156288146973
Epoch: 9, Steps: 18 | Train Loss: 0.088 Vali Loss: 1.106 Vali Acc: 0.480 Test Loss: 1.106 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.853384494781494
Epoch: 10, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.978 Vali Acc: 0.460 Test Loss: 0.978 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.671765089035034
Epoch: 11, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.013 Vali Acc: 0.520 Test Loss: 1.013 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.805861234664917
Epoch: 12, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.103 Vali Acc: 0.500 Test Loss: 1.103 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.435343265533447
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.110 Vali Acc: 0.490 Test Loss: 1.110 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.459380865097046
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.120 Vali Acc: 0.480 Test Loss: 1.120 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 4602178
model size : 17.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.31154465675354
Epoch: 1, Steps: 18 | Train Loss: 0.706 Vali Loss: 0.762 Vali Acc: 0.530 Test Loss: 0.762 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 3.3005781173706055
Epoch: 2, Steps: 18 | Train Loss: 0.684 Vali Loss: 0.725 Vali Acc: 0.470 Test Loss: 0.725 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1589574813842773
Epoch: 3, Steps: 18 | Train Loss: 0.618 Vali Loss: 0.721 Vali Acc: 0.530 Test Loss: 0.721 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 2.633636474609375
Epoch: 4, Steps: 18 | Train Loss: 0.506 Vali Loss: 0.783 Vali Acc: 0.500 Test Loss: 0.783 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6375925540924072
Epoch: 5, Steps: 18 | Train Loss: 0.443 Vali Loss: 0.794 Vali Acc: 0.480 Test Loss: 0.794 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.660008192062378
Epoch: 6, Steps: 18 | Train Loss: 0.336 Vali Loss: 0.860 Vali Acc: 0.550 Test Loss: 0.860 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549991).  Saving model ...
Epoch: 7 cost time: 2.714198112487793
Epoch: 7, Steps: 18 | Train Loss: 0.263 Vali Loss: 0.778 Vali Acc: 0.540 Test Loss: 0.778 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7957701683044434
Epoch: 8, Steps: 18 | Train Loss: 0.201 Vali Loss: 0.801 Vali Acc: 0.550 Test Loss: 0.801 Test Acc: 0.550
Validation loss decreased (-0.549991 --> -0.549992).  Saving model ...
Epoch: 9 cost time: 3.1319098472595215
Epoch: 9, Steps: 18 | Train Loss: 0.135 Vali Loss: 0.916 Vali Acc: 0.520 Test Loss: 0.916 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2949280738830566
Epoch: 10, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.935 Vali Acc: 0.480 Test Loss: 0.935 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4038374423980713
Epoch: 11, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.979 Vali Acc: 0.460 Test Loss: 0.979 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5399153232574463
Epoch: 12, Steps: 18 | Train Loss: 0.039 Vali Loss: 1.022 Vali Acc: 0.510 Test Loss: 1.022 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.7552807331085205
Epoch: 13, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.081 Vali Acc: 0.510 Test Loss: 1.081 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.601954460144043
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.118 Vali Acc: 0.500 Test Loss: 1.118 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.708271026611328
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.125 Vali Acc: 0.510 Test Loss: 1.125 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.2172701358795166
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.173 Vali Acc: 0.490 Test Loss: 1.173 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.2235591411590576
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.203 Vali Acc: 0.490 Test Loss: 1.203 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.6948771476745605
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.208 Vali Acc: 0.490 Test Loss: 1.208 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 4595394
model size : 17.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.9081077575683594
Epoch: 1, Steps: 18 | Train Loss: 0.802 Vali Loss: 0.760 Vali Acc: 0.500 Test Loss: 0.760 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.4870805740356445
Epoch: 2, Steps: 18 | Train Loss: 0.619 Vali Loss: 0.753 Vali Acc: 0.550 Test Loss: 0.753 Test Acc: 0.550
Validation loss decreased (-0.499992 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 2.615084409713745
Epoch: 3, Steps: 18 | Train Loss: 0.424 Vali Loss: 0.876 Vali Acc: 0.630 Test Loss: 0.876 Test Acc: 0.630
Validation loss decreased (-0.549992 --> -0.629991).  Saving model ...
Epoch: 4 cost time: 2.6045773029327393
Epoch: 4, Steps: 18 | Train Loss: 0.332 Vali Loss: 1.105 Vali Acc: 0.530 Test Loss: 1.105 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.49790358543396
Epoch: 5, Steps: 18 | Train Loss: 0.197 Vali Loss: 1.049 Vali Acc: 0.540 Test Loss: 1.049 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6863715648651123
Epoch: 6, Steps: 18 | Train Loss: 0.084 Vali Loss: 1.550 Vali Acc: 0.500 Test Loss: 1.550 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.6203911304473877
Epoch: 7, Steps: 18 | Train Loss: 0.041 Vali Loss: 1.869 Vali Acc: 0.430 Test Loss: 1.869 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.559521436691284
Epoch: 8, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.860 Vali Acc: 0.450 Test Loss: 1.860 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.5528740882873535
Epoch: 9, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.755 Vali Acc: 0.520 Test Loss: 1.755 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.604062080383301
Epoch: 10, Steps: 18 | Train Loss: 0.013 Vali Loss: 2.137 Vali Acc: 0.490 Test Loss: 2.137 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.6525535583496094
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 2.425 Vali Acc: 0.430 Test Loss: 2.425 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.6131629943847656
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 2.615 Vali Acc: 0.460 Test Loss: 2.615 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.5553510189056396
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 2.404 Vali Acc: 0.430 Test Loss: 2.404 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 1903362
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.698909282684326
Epoch: 1, Steps: 18 | Train Loss: 0.763 Vali Loss: 0.816 Vali Acc: 0.600 Test Loss: 0.816 Test Acc: 0.600
Validation loss decreased (inf --> -0.599992).  Saving model ...
Epoch: 2 cost time: 1.9957177639007568
Epoch: 2, Steps: 18 | Train Loss: 0.702 Vali Loss: 0.904 Vali Acc: 0.430 Test Loss: 0.904 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.163252592086792
Epoch: 3, Steps: 18 | Train Loss: 0.564 Vali Loss: 0.888 Vali Acc: 0.590 Test Loss: 0.888 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.150696039199829
Epoch: 4, Steps: 18 | Train Loss: 0.409 Vali Loss: 0.762 Vali Acc: 0.480 Test Loss: 0.762 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1284420490264893
Epoch: 5, Steps: 18 | Train Loss: 0.271 Vali Loss: 0.875 Vali Acc: 0.520 Test Loss: 0.875 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.189276933670044
Epoch: 6, Steps: 18 | Train Loss: 0.153 Vali Loss: 0.922 Vali Acc: 0.480 Test Loss: 0.922 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.304598808288574
Epoch: 7, Steps: 18 | Train Loss: 0.089 Vali Loss: 1.226 Vali Acc: 0.480 Test Loss: 1.226 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.221493721008301
Epoch: 8, Steps: 18 | Train Loss: 0.037 Vali Loss: 1.259 Vali Acc: 0.550 Test Loss: 1.259 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.1977343559265137
Epoch: 9, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.212 Vali Acc: 0.510 Test Loss: 1.212 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.206031322479248
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.477 Vali Acc: 0.500 Test Loss: 1.477 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.096501588821411
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.425 Vali Acc: 0.500 Test Loss: 1.425 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1750114
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.2213499546051025
Epoch: 1, Steps: 18 | Train Loss: 0.773 Vali Loss: 0.768 Vali Acc: 0.490 Test Loss: 0.768 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.773829936981201
Epoch: 2, Steps: 18 | Train Loss: 0.639 Vali Loss: 0.922 Vali Acc: 0.610 Test Loss: 0.922 Test Acc: 0.610
Validation loss decreased (-0.489992 --> -0.609991).  Saving model ...
Epoch: 3 cost time: 2.800365447998047
Epoch: 3, Steps: 18 | Train Loss: 0.590 Vali Loss: 0.745 Vali Acc: 0.510 Test Loss: 0.745 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.82906436920166
Epoch: 4, Steps: 18 | Train Loss: 0.484 Vali Loss: 0.842 Vali Acc: 0.530 Test Loss: 0.842 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.8636908531188965
Epoch: 5, Steps: 18 | Train Loss: 0.354 Vali Loss: 0.846 Vali Acc: 0.560 Test Loss: 0.846 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.9696967601776123
Epoch: 6, Steps: 18 | Train Loss: 0.254 Vali Loss: 0.853 Vali Acc: 0.510 Test Loss: 0.853 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.8173534870147705
Epoch: 7, Steps: 18 | Train Loss: 0.157 Vali Loss: 0.944 Vali Acc: 0.550 Test Loss: 0.944 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.771275520324707
Epoch: 8, Steps: 18 | Train Loss: 0.122 Vali Loss: 1.101 Vali Acc: 0.510 Test Loss: 1.101 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.79587721824646
Epoch: 9, Steps: 18 | Train Loss: 0.074 Vali Loss: 1.013 Vali Acc: 0.510 Test Loss: 1.013 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.6728403568267822
Epoch: 10, Steps: 18 | Train Loss: 0.047 Vali Loss: 1.176 Vali Acc: 0.470 Test Loss: 1.176 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.8762433528900146
Epoch: 11, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.196 Vali Acc: 0.480 Test Loss: 1.196 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.886107921600342
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.159 Vali Acc: 0.470 Test Loss: 1.159 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1695170
model size : 6.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.115750312805176
Epoch: 1, Steps: 18 | Train Loss: 0.726 Vali Loss: 0.764 Vali Acc: 0.440 Test Loss: 0.764 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 2.7581992149353027
Epoch: 2, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.801 Vali Acc: 0.610 Test Loss: 0.801 Test Acc: 0.610
Validation loss decreased (-0.439992 --> -0.609992).  Saving model ...
Epoch: 3 cost time: 2.7942733764648438
Epoch: 3, Steps: 18 | Train Loss: 0.555 Vali Loss: 0.737 Vali Acc: 0.480 Test Loss: 0.737 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7701289653778076
Epoch: 4, Steps: 18 | Train Loss: 0.434 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.859381914138794
Epoch: 5, Steps: 18 | Train Loss: 0.334 Vali Loss: 0.818 Vali Acc: 0.530 Test Loss: 0.818 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.7763540744781494
Epoch: 6, Steps: 18 | Train Loss: 0.236 Vali Loss: 0.791 Vali Acc: 0.520 Test Loss: 0.791 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.8461196422576904
Epoch: 7, Steps: 18 | Train Loss: 0.163 Vali Loss: 0.788 Vali Acc: 0.550 Test Loss: 0.788 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.7877697944641113
Epoch: 8, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.852 Vali Acc: 0.560 Test Loss: 0.852 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.7228078842163086
Epoch: 9, Steps: 18 | Train Loss: 0.064 Vali Loss: 1.027 Vali Acc: 0.540 Test Loss: 1.027 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.682513952255249
Epoch: 10, Steps: 18 | Train Loss: 0.031 Vali Loss: 1.000 Vali Acc: 0.540 Test Loss: 1.000 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.7291924953460693
Epoch: 11, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.094 Vali Acc: 0.520 Test Loss: 1.094 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.7947399616241455
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.202 Vali Acc: 0.510 Test Loss: 1.202 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1672994
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.4626646041870117
Epoch: 1, Steps: 18 | Train Loss: 0.715 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.420419216156006
Epoch: 2, Steps: 18 | Train Loss: 0.655 Vali Loss: 0.733 Vali Acc: 0.430 Test Loss: 0.733 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.382678985595703
Epoch: 3, Steps: 18 | Train Loss: 0.577 Vali Loss: 0.715 Vali Acc: 0.550 Test Loss: 0.715 Test Acc: 0.550
Validation loss decreased (-0.499993 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 2.58097767829895
Epoch: 4, Steps: 18 | Train Loss: 0.507 Vali Loss: 0.762 Vali Acc: 0.550 Test Loss: 0.762 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.55641508102417
Epoch: 5, Steps: 18 | Train Loss: 0.445 Vali Loss: 0.765 Vali Acc: 0.510 Test Loss: 0.765 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.534208059310913
Epoch: 6, Steps: 18 | Train Loss: 0.359 Vali Loss: 0.719 Vali Acc: 0.550 Test Loss: 0.719 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5639660358428955
Epoch: 7, Steps: 18 | Train Loss: 0.301 Vali Loss: 0.724 Vali Acc: 0.550 Test Loss: 0.724 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.644094944000244
Epoch: 8, Steps: 18 | Train Loss: 0.202 Vali Loss: 0.819 Vali Acc: 0.510 Test Loss: 0.819 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.468132972717285
Epoch: 9, Steps: 18 | Train Loss: 0.157 Vali Loss: 0.881 Vali Acc: 0.530 Test Loss: 0.881 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.4764821529388428
Epoch: 10, Steps: 18 | Train Loss: 0.115 Vali Loss: 0.979 Vali Acc: 0.560 Test Loss: 0.979 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559990).  Saving model ...
Epoch: 11 cost time: 2.5023536682128906
Epoch: 11, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.991 Vali Acc: 0.520 Test Loss: 0.991 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.570061445236206
Epoch: 12, Steps: 18 | Train Loss: 0.042 Vali Loss: 1.015 Vali Acc: 0.480 Test Loss: 1.015 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5965631008148193
Epoch: 13, Steps: 18 | Train Loss: 0.032 Vali Loss: 1.010 Vali Acc: 0.480 Test Loss: 1.010 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.5698812007904053
Epoch: 14, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.015 Vali Acc: 0.480 Test Loss: 1.015 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.563596487045288
Epoch: 15, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.126 Vali Acc: 0.480 Test Loss: 1.126 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.662001132965088
Epoch: 16, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.157 Vali Acc: 0.480 Test Loss: 1.157 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.39573335647583
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.158 Vali Acc: 0.460 Test Loss: 1.158 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.6051063537597656
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.164 Vali Acc: 0.490 Test Loss: 1.164 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.636176824569702
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.498767375946045
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.222 Vali Acc: 0.490 Test Loss: 1.222 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1653218
model size : 6.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.088903903961182
Epoch: 1, Steps: 18 | Train Loss: 0.715 Vali Loss: 0.701 Vali Acc: 0.640 Test Loss: 0.701 Test Acc: 0.640
Validation loss decreased (inf --> -0.639993).  Saving model ...
Epoch: 2 cost time: 2.680894613265991
Epoch: 2, Steps: 18 | Train Loss: 0.672 Vali Loss: 0.737 Vali Acc: 0.560 Test Loss: 0.737 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6098296642303467
Epoch: 3, Steps: 18 | Train Loss: 0.620 Vali Loss: 0.710 Vali Acc: 0.590 Test Loss: 0.710 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6357176303863525
Epoch: 4, Steps: 18 | Train Loss: 0.536 Vali Loss: 0.743 Vali Acc: 0.540 Test Loss: 0.743 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7372841835021973
Epoch: 5, Steps: 18 | Train Loss: 0.477 Vali Loss: 0.744 Vali Acc: 0.530 Test Loss: 0.744 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5438573360443115
Epoch: 6, Steps: 18 | Train Loss: 0.434 Vali Loss: 0.834 Vali Acc: 0.530 Test Loss: 0.834 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.625911235809326
Epoch: 7, Steps: 18 | Train Loss: 0.364 Vali Loss: 0.769 Vali Acc: 0.540 Test Loss: 0.769 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.654919147491455
Epoch: 8, Steps: 18 | Train Loss: 0.298 Vali Loss: 0.759 Vali Acc: 0.530 Test Loss: 0.759 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.716707468032837
Epoch: 9, Steps: 18 | Train Loss: 0.241 Vali Loss: 0.846 Vali Acc: 0.510 Test Loss: 0.846 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.475186824798584
Epoch: 10, Steps: 18 | Train Loss: 0.178 Vali Loss: 0.781 Vali Acc: 0.540 Test Loss: 0.781 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.7909750938415527
Epoch: 11, Steps: 18 | Train Loss: 0.114 Vali Loss: 0.803 Vali Acc: 0.550 Test Loss: 0.803 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 1641634
model size : 6.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.0715277194976807
Epoch: 1, Steps: 18 | Train Loss: 0.701 Vali Loss: 0.708 Vali Acc: 0.450 Test Loss: 0.708 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.855710744857788
Epoch: 2, Steps: 18 | Train Loss: 0.655 Vali Loss: 0.757 Vali Acc: 0.460 Test Loss: 0.757 Test Acc: 0.460
Validation loss decreased (-0.449993 --> -0.459992).  Saving model ...
Epoch: 3 cost time: 1.7551722526550293
Epoch: 3, Steps: 18 | Train Loss: 0.615 Vali Loss: 0.719 Vali Acc: 0.480 Test Loss: 0.719 Test Acc: 0.480
Validation loss decreased (-0.459992 --> -0.479993).  Saving model ...
Epoch: 4 cost time: 1.7622857093811035
Epoch: 4, Steps: 18 | Train Loss: 0.554 Vali Loss: 0.714 Vali Acc: 0.560 Test Loss: 0.714 Test Acc: 0.560
Validation loss decreased (-0.479993 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 1.8379013538360596
Epoch: 5, Steps: 18 | Train Loss: 0.498 Vali Loss: 0.713 Vali Acc: 0.560 Test Loss: 0.713 Test Acc: 0.560
Validation loss decreased (-0.559993 --> -0.559993).  Saving model ...
Epoch: 6 cost time: 1.8433542251586914
Epoch: 6, Steps: 18 | Train Loss: 0.422 Vali Loss: 0.724 Vali Acc: 0.510 Test Loss: 0.724 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8374569416046143
Epoch: 7, Steps: 18 | Train Loss: 0.360 Vali Loss: 0.790 Vali Acc: 0.530 Test Loss: 0.790 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7823410034179688
Epoch: 8, Steps: 18 | Train Loss: 0.312 Vali Loss: 0.763 Vali Acc: 0.490 Test Loss: 0.763 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8197009563446045
Epoch: 9, Steps: 18 | Train Loss: 0.258 Vali Loss: 0.753 Vali Acc: 0.540 Test Loss: 0.753 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7473320960998535
Epoch: 10, Steps: 18 | Train Loss: 0.185 Vali Loss: 0.782 Vali Acc: 0.480 Test Loss: 0.782 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6299645900726318
Epoch: 11, Steps: 18 | Train Loss: 0.138 Vali Loss: 0.831 Vali Acc: 0.510 Test Loss: 0.831 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7743372917175293
Epoch: 12, Steps: 18 | Train Loss: 0.124 Vali Loss: 0.827 Vali Acc: 0.540 Test Loss: 0.827 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.843858003616333
Epoch: 13, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.869 Vali Acc: 0.530 Test Loss: 0.869 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8707118034362793
Epoch: 14, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.924 Vali Acc: 0.570 Test Loss: 0.924 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569991).  Saving model ...
Epoch: 15 cost time: 1.880913496017456
Epoch: 15, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.925 Vali Acc: 0.530 Test Loss: 0.925 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9313035011291504
Epoch: 16, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.928 Vali Acc: 0.480 Test Loss: 0.928 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7906999588012695
Epoch: 17, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.992 Vali Acc: 0.530 Test Loss: 0.992 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8011975288391113
Epoch: 18, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.967 Vali Acc: 0.540 Test Loss: 0.967 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.839818000793457
Epoch: 19, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.001 Vali Acc: 0.490 Test Loss: 1.001 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7652435302734375
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.066 Vali Acc: 0.540 Test Loss: 1.066 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9248077869415283
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.050 Vali Acc: 0.510 Test Loss: 1.050 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7375643253326416
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.041 Vali Acc: 0.490 Test Loss: 1.041 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7194795608520508
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.065 Vali Acc: 0.510 Test Loss: 1.065 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.822925329208374
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.083 Vali Acc: 0.520 Test Loss: 1.083 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1638242
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.525282859802246
Epoch: 1, Steps: 18 | Train Loss: 2.480 Vali Loss: 3.838 Vali Acc: 0.530 Test Loss: 3.838 Test Acc: 0.530
Validation loss decreased (inf --> -0.529962).  Saving model ...
Epoch: 2 cost time: 10.174020767211914
Epoch: 2, Steps: 18 | Train Loss: 2.638 Vali Loss: 3.611 Vali Acc: 0.520 Test Loss: 3.611 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.408559560775757
Epoch: 3, Steps: 18 | Train Loss: 2.225 Vali Loss: 5.185 Vali Acc: 0.510 Test Loss: 5.185 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.390231609344482
Epoch: 4, Steps: 18 | Train Loss: 2.828 Vali Loss: 13.051 Vali Acc: 0.550 Test Loss: 13.051 Test Acc: 0.550
Validation loss decreased (-0.529962 --> -0.549869).  Saving model ...
Epoch: 5 cost time: 10.29992938041687
Epoch: 5, Steps: 18 | Train Loss: 3.342 Vali Loss: 6.676 Vali Acc: 0.550 Test Loss: 6.676 Test Acc: 0.550
Validation loss decreased (-0.549869 --> -0.549933).  Saving model ...
Epoch: 6 cost time: 10.455401420593262
Epoch: 6, Steps: 18 | Train Loss: 1.888 Vali Loss: 18.561 Vali Acc: 0.470 Test Loss: 18.561 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.493897676467896
Epoch: 7, Steps: 18 | Train Loss: 1.644 Vali Loss: 13.672 Vali Acc: 0.540 Test Loss: 13.672 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.367847442626953
Epoch: 8, Steps: 18 | Train Loss: 2.671 Vali Loss: 26.328 Vali Acc: 0.470 Test Loss: 26.328 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.427761554718018
Epoch: 9, Steps: 18 | Train Loss: 2.335 Vali Loss: 12.852 Vali Acc: 0.520 Test Loss: 12.852 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.53685998916626
Epoch: 10, Steps: 18 | Train Loss: 0.919 Vali Loss: 19.523 Vali Acc: 0.570 Test Loss: 19.523 Test Acc: 0.570
Validation loss decreased (-0.549933 --> -0.569805).  Saving model ...
Epoch: 11 cost time: 10.528764724731445
Epoch: 11, Steps: 18 | Train Loss: 0.972 Vali Loss: 20.044 Vali Acc: 0.540 Test Loss: 20.044 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.490181922912598
Epoch: 12, Steps: 18 | Train Loss: 2.014 Vali Loss: 23.068 Vali Acc: 0.480 Test Loss: 23.068 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.359600067138672
Epoch: 13, Steps: 18 | Train Loss: 3.116 Vali Loss: 25.871 Vali Acc: 0.500 Test Loss: 25.871 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.251629829406738
Epoch: 14, Steps: 18 | Train Loss: 0.665 Vali Loss: 27.432 Vali Acc: 0.480 Test Loss: 27.432 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 9.627357244491577
Epoch: 15, Steps: 18 | Train Loss: 1.055 Vali Loss: 26.482 Vali Acc: 0.460 Test Loss: 26.482 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.537215948104858
Epoch: 16, Steps: 18 | Train Loss: 0.948 Vali Loss: 20.546 Vali Acc: 0.570 Test Loss: 20.546 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 10.393980026245117
Epoch: 17, Steps: 18 | Train Loss: 0.430 Vali Loss: 28.439 Vali Acc: 0.500 Test Loss: 28.439 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.360712766647339
Epoch: 18, Steps: 18 | Train Loss: 1.222 Vali Loss: 28.490 Vali Acc: 0.450 Test Loss: 28.490 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 9.958207130432129
Epoch: 19, Steps: 18 | Train Loss: 0.562 Vali Loss: 27.820 Vali Acc: 0.460 Test Loss: 27.820 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 10.504223108291626
Epoch: 20, Steps: 18 | Train Loss: 0.380 Vali Loss: 25.408 Vali Acc: 0.490 Test Loss: 25.408 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 13488130
model size : 51.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.142464876174927
Epoch: 1, Steps: 18 | Train Loss: 2.264 Vali Loss: 2.126 Vali Acc: 0.540 Test Loss: 2.126 Test Acc: 0.540
Validation loss decreased (inf --> -0.539979).  Saving model ...
Epoch: 2 cost time: 6.890150308609009
Epoch: 2, Steps: 18 | Train Loss: 1.816 Vali Loss: 1.895 Vali Acc: 0.390 Test Loss: 1.895 Test Acc: 0.390
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.915034294128418
Epoch: 3, Steps: 18 | Train Loss: 1.431 Vali Loss: 4.847 Vali Acc: 0.440 Test Loss: 4.847 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.928805112838745
Epoch: 4, Steps: 18 | Train Loss: 2.503 Vali Loss: 6.798 Vali Acc: 0.450 Test Loss: 6.798 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.120743036270142
Epoch: 5, Steps: 18 | Train Loss: 2.721 Vali Loss: 8.026 Vali Acc: 0.440 Test Loss: 8.026 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.56853461265564
Epoch: 6, Steps: 18 | Train Loss: 4.275 Vali Loss: 6.534 Vali Acc: 0.460 Test Loss: 6.534 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.125034809112549
Epoch: 7, Steps: 18 | Train Loss: 1.287 Vali Loss: 7.769 Vali Acc: 0.490 Test Loss: 7.769 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.8562188148498535
Epoch: 8, Steps: 18 | Train Loss: 1.188 Vali Loss: 11.016 Vali Acc: 0.490 Test Loss: 11.016 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.869823694229126
Epoch: 9, Steps: 18 | Train Loss: 1.155 Vali Loss: 11.386 Vali Acc: 0.490 Test Loss: 11.386 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.02008843421936
Epoch: 10, Steps: 18 | Train Loss: 0.502 Vali Loss: 11.547 Vali Acc: 0.470 Test Loss: 11.547 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.042794704437256
Epoch: 11, Steps: 18 | Train Loss: 0.913 Vali Loss: 10.938 Vali Acc: 0.470 Test Loss: 10.938 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 12262146
model size : 47.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.772899866104126
Epoch: 1, Steps: 18 | Train Loss: 1.486 Vali Loss: 1.094 Vali Acc: 0.560 Test Loss: 1.094 Test Acc: 0.560
Validation loss decreased (inf --> -0.559989).  Saving model ...
Epoch: 2 cost time: 7.348297357559204
Epoch: 2, Steps: 18 | Train Loss: 1.614 Vali Loss: 2.615 Vali Acc: 0.610 Test Loss: 2.615 Test Acc: 0.610
Validation loss decreased (-0.559989 --> -0.609974).  Saving model ...
Epoch: 3 cost time: 7.228634357452393
Epoch: 3, Steps: 18 | Train Loss: 1.456 Vali Loss: 5.831 Vali Acc: 0.570 Test Loss: 5.831 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.27135443687439
Epoch: 4, Steps: 18 | Train Loss: 1.662 Vali Loss: 5.611 Vali Acc: 0.550 Test Loss: 5.611 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.089759349822998
Epoch: 5, Steps: 18 | Train Loss: 1.346 Vali Loss: 3.294 Vali Acc: 0.510 Test Loss: 3.294 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.085104465484619
Epoch: 6, Steps: 18 | Train Loss: 1.156 Vali Loss: 3.188 Vali Acc: 0.530 Test Loss: 3.188 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.307733774185181
Epoch: 7, Steps: 18 | Train Loss: 0.995 Vali Loss: 7.660 Vali Acc: 0.520 Test Loss: 7.660 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.214854717254639
Epoch: 8, Steps: 18 | Train Loss: 1.665 Vali Loss: 8.572 Vali Acc: 0.570 Test Loss: 8.572 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.208052635192871
Epoch: 9, Steps: 18 | Train Loss: 1.249 Vali Loss: 4.780 Vali Acc: 0.530 Test Loss: 4.780 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.341050624847412
Epoch: 10, Steps: 18 | Train Loss: 0.763 Vali Loss: 7.014 Vali Acc: 0.480 Test Loss: 7.014 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.281969308853149
Epoch: 11, Steps: 18 | Train Loss: 0.454 Vali Loss: 5.592 Vali Acc: 0.550 Test Loss: 5.592 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.288498640060425
Epoch: 12, Steps: 18 | Train Loss: 0.483 Vali Loss: 6.008 Vali Acc: 0.490 Test Loss: 6.008 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 11822594
model size : 45.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.7841503620147705
Epoch: 1, Steps: 18 | Train Loss: 1.245 Vali Loss: 1.320 Vali Acc: 0.500 Test Loss: 1.320 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 3.7591614723205566
Epoch: 2, Steps: 18 | Train Loss: 0.976 Vali Loss: 0.847 Vali Acc: 0.560 Test Loss: 0.847 Test Acc: 0.560
Validation loss decreased (-0.499987 --> -0.559992).  Saving model ...
Epoch: 3 cost time: 3.5919597148895264
Epoch: 3, Steps: 18 | Train Loss: 0.646 Vali Loss: 1.845 Vali Acc: 0.490 Test Loss: 1.845 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7694623470306396
Epoch: 4, Steps: 18 | Train Loss: 1.043 Vali Loss: 2.107 Vali Acc: 0.540 Test Loss: 2.107 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.717255115509033
Epoch: 5, Steps: 18 | Train Loss: 0.688 Vali Loss: 3.711 Vali Acc: 0.570 Test Loss: 3.711 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569963).  Saving model ...
Epoch: 6 cost time: 3.8213725090026855
Epoch: 6, Steps: 18 | Train Loss: 0.848 Vali Loss: 3.209 Vali Acc: 0.510 Test Loss: 3.209 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.613538980484009
Epoch: 7, Steps: 18 | Train Loss: 0.486 Vali Loss: 7.097 Vali Acc: 0.600 Test Loss: 7.097 Test Acc: 0.600
Validation loss decreased (-0.569963 --> -0.599929).  Saving model ...
Epoch: 8 cost time: 3.8433570861816406
Epoch: 8, Steps: 18 | Train Loss: 1.616 Vali Loss: 7.051 Vali Acc: 0.550 Test Loss: 7.051 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.842050313949585
Epoch: 9, Steps: 18 | Train Loss: 0.562 Vali Loss: 3.943 Vali Acc: 0.490 Test Loss: 3.943 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.884089231491089
Epoch: 10, Steps: 18 | Train Loss: 0.377 Vali Loss: 4.070 Vali Acc: 0.550 Test Loss: 4.070 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.804887533187866
Epoch: 11, Steps: 18 | Train Loss: 1.060 Vali Loss: 4.360 Vali Acc: 0.510 Test Loss: 4.360 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.785163402557373
Epoch: 12, Steps: 18 | Train Loss: 0.697 Vali Loss: 7.125 Vali Acc: 0.520 Test Loss: 7.125 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.908229351043701
Epoch: 13, Steps: 18 | Train Loss: 0.747 Vali Loss: 5.773 Vali Acc: 0.510 Test Loss: 5.773 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.7285208702087402
Epoch: 14, Steps: 18 | Train Loss: 0.866 Vali Loss: 4.878 Vali Acc: 0.490 Test Loss: 4.878 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.9595377445220947
Epoch: 15, Steps: 18 | Train Loss: 0.675 Vali Loss: 4.810 Vali Acc: 0.490 Test Loss: 4.810 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.8089003562927246
Epoch: 16, Steps: 18 | Train Loss: 0.609 Vali Loss: 6.854 Vali Acc: 0.490 Test Loss: 6.854 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.7883455753326416
Epoch: 17, Steps: 18 | Train Loss: 1.954 Vali Loss: 9.411 Vali Acc: 0.470 Test Loss: 9.411 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 11645186
model size : 44.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.2182347774505615
Epoch: 1, Steps: 18 | Train Loss: 0.830 Vali Loss: 0.812 Vali Acc: 0.540 Test Loss: 0.812 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 6.182982444763184
Epoch: 2, Steps: 18 | Train Loss: 0.874 Vali Loss: 0.741 Vali Acc: 0.480 Test Loss: 0.741 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.971812963485718
Epoch: 3, Steps: 18 | Train Loss: 0.741 Vali Loss: 1.793 Vali Acc: 0.500 Test Loss: 1.793 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.202396869659424
Epoch: 4, Steps: 18 | Train Loss: 0.644 Vali Loss: 2.033 Vali Acc: 0.530 Test Loss: 2.033 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.901459217071533
Epoch: 5, Steps: 18 | Train Loss: 0.618 Vali Loss: 1.973 Vali Acc: 0.470 Test Loss: 1.973 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.946961879730225
Epoch: 6, Steps: 18 | Train Loss: 0.382 Vali Loss: 1.548 Vali Acc: 0.540 Test Loss: 1.548 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.897644519805908
Epoch: 7, Steps: 18 | Train Loss: 0.585 Vali Loss: 1.764 Vali Acc: 0.500 Test Loss: 1.764 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.9760377407073975
Epoch: 8, Steps: 18 | Train Loss: 0.994 Vali Loss: 2.500 Vali Acc: 0.490 Test Loss: 2.500 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.878369092941284
Epoch: 9, Steps: 18 | Train Loss: 1.018 Vali Loss: 3.062 Vali Acc: 0.560 Test Loss: 3.062 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559969).  Saving model ...
Epoch: 10 cost time: 5.857770919799805
Epoch: 10, Steps: 18 | Train Loss: 0.466 Vali Loss: 2.779 Vali Acc: 0.500 Test Loss: 2.779 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.03765869140625
Epoch: 11, Steps: 18 | Train Loss: 0.495 Vali Loss: 3.725 Vali Acc: 0.530 Test Loss: 3.725 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.3600897789001465
Epoch: 12, Steps: 18 | Train Loss: 0.370 Vali Loss: 2.478 Vali Acc: 0.570 Test Loss: 2.478 Test Acc: 0.570
Validation loss decreased (-0.559969 --> -0.569975).  Saving model ...
Epoch: 13 cost time: 6.10402774810791
Epoch: 13, Steps: 18 | Train Loss: 0.897 Vali Loss: 2.993 Vali Acc: 0.500 Test Loss: 2.993 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.724632501602173
Epoch: 14, Steps: 18 | Train Loss: 1.368 Vali Loss: 4.070 Vali Acc: 0.480 Test Loss: 4.070 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.106149911880493
Epoch: 15, Steps: 18 | Train Loss: 0.957 Vali Loss: 2.953 Vali Acc: 0.450 Test Loss: 2.953 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.118142604827881
Epoch: 16, Steps: 18 | Train Loss: 0.403 Vali Loss: 3.791 Vali Acc: 0.520 Test Loss: 3.791 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.916314363479614
Epoch: 17, Steps: 18 | Train Loss: 0.481 Vali Loss: 3.721 Vali Acc: 0.550 Test Loss: 3.721 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.019810914993286
Epoch: 18, Steps: 18 | Train Loss: 0.537 Vali Loss: 3.684 Vali Acc: 0.540 Test Loss: 3.684 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.064366102218628
Epoch: 19, Steps: 18 | Train Loss: 0.558 Vali Loss: 6.799 Vali Acc: 0.480 Test Loss: 6.799 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.976635932922363
Epoch: 20, Steps: 18 | Train Loss: 0.827 Vali Loss: 4.901 Vali Acc: 0.510 Test Loss: 4.901 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.17936372756958
Epoch: 21, Steps: 18 | Train Loss: 0.731 Vali Loss: 7.111 Vali Acc: 0.520 Test Loss: 7.111 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.839293718338013
Epoch: 22, Steps: 18 | Train Loss: 0.773 Vali Loss: 6.125 Vali Acc: 0.480 Test Loss: 6.125 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 11454210
model size : 43.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.352948188781738
Epoch: 1, Steps: 18 | Train Loss: 0.803 Vali Loss: 1.079 Vali Acc: 0.570 Test Loss: 1.079 Test Acc: 0.570
Validation loss decreased (inf --> -0.569989).  Saving model ...
Epoch: 2 cost time: 5.1398820877075195
Epoch: 2, Steps: 18 | Train Loss: 0.797 Vali Loss: 0.792 Vali Acc: 0.510 Test Loss: 0.792 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.159957647323608
Epoch: 3, Steps: 18 | Train Loss: 0.689 Vali Loss: 1.126 Vali Acc: 0.590 Test Loss: 1.126 Test Acc: 0.590
Validation loss decreased (-0.569989 --> -0.589989).  Saving model ...
Epoch: 4 cost time: 5.2399396896362305
Epoch: 4, Steps: 18 | Train Loss: 0.494 Vali Loss: 0.938 Vali Acc: 0.550 Test Loss: 0.938 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.218138217926025
Epoch: 5, Steps: 18 | Train Loss: 0.366 Vali Loss: 3.168 Vali Acc: 0.510 Test Loss: 3.168 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.103978872299194
Epoch: 6, Steps: 18 | Train Loss: 0.303 Vali Loss: 1.663 Vali Acc: 0.440 Test Loss: 1.663 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.122117519378662
Epoch: 7, Steps: 18 | Train Loss: 0.414 Vali Loss: 2.143 Vali Acc: 0.470 Test Loss: 2.143 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.2845282554626465
Epoch: 8, Steps: 18 | Train Loss: 0.714 Vali Loss: 4.038 Vali Acc: 0.500 Test Loss: 4.038 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.215191125869751
Epoch: 9, Steps: 18 | Train Loss: 0.582 Vali Loss: 2.012 Vali Acc: 0.520 Test Loss: 2.012 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.218717336654663
Epoch: 10, Steps: 18 | Train Loss: 0.489 Vali Loss: 3.193 Vali Acc: 0.540 Test Loss: 3.193 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.265085935592651
Epoch: 11, Steps: 18 | Train Loss: 0.269 Vali Loss: 2.035 Vali Acc: 0.480 Test Loss: 2.035 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.988276243209839
Epoch: 12, Steps: 18 | Train Loss: 0.601 Vali Loss: 2.320 Vali Acc: 0.580 Test Loss: 2.320 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.318126201629639
Epoch: 13, Steps: 18 | Train Loss: 0.440 Vali Loss: 3.535 Vali Acc: 0.500 Test Loss: 3.535 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 11394306
model size : 43.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.3266167640686035
Epoch: 1, Steps: 18 | Train Loss: 0.802 Vali Loss: 0.817 Vali Acc: 0.620 Test Loss: 0.817 Test Acc: 0.620
Validation loss decreased (inf --> -0.619992).  Saving model ...
Epoch: 2 cost time: 3.0640130043029785
Epoch: 2, Steps: 18 | Train Loss: 0.724 Vali Loss: 1.128 Vali Acc: 0.560 Test Loss: 1.128 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.390655279159546
Epoch: 3, Steps: 18 | Train Loss: 0.715 Vali Loss: 1.701 Vali Acc: 0.510 Test Loss: 1.701 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.3529348373413086
Epoch: 4, Steps: 18 | Train Loss: 0.825 Vali Loss: 1.003 Vali Acc: 0.540 Test Loss: 1.003 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.2017552852630615
Epoch: 5, Steps: 18 | Train Loss: 0.398 Vali Loss: 0.913 Vali Acc: 0.560 Test Loss: 0.913 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.275773048400879
Epoch: 6, Steps: 18 | Train Loss: 0.342 Vali Loss: 1.540 Vali Acc: 0.500 Test Loss: 1.540 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.2582881450653076
Epoch: 7, Steps: 18 | Train Loss: 0.293 Vali Loss: 1.712 Vali Acc: 0.540 Test Loss: 1.712 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.1931583881378174
Epoch: 8, Steps: 18 | Train Loss: 0.361 Vali Loss: 1.637 Vali Acc: 0.480 Test Loss: 1.637 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.510226249694824
Epoch: 9, Steps: 18 | Train Loss: 0.416 Vali Loss: 2.043 Vali Acc: 0.520 Test Loss: 2.043 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.4382851123809814
Epoch: 10, Steps: 18 | Train Loss: 0.243 Vali Loss: 1.321 Vali Acc: 0.550 Test Loss: 1.321 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.118922710418701
Epoch: 11, Steps: 18 | Train Loss: 0.288 Vali Loss: 1.867 Vali Acc: 0.490 Test Loss: 1.867 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 11367170
model size : 43.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.351840019226074
Epoch: 1, Steps: 18 | Train Loss: 1.344 Vali Loss: 0.819 Vali Acc: 0.520 Test Loss: 0.819 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 6.312593460083008
Epoch: 2, Steps: 18 | Train Loss: 2.144 Vali Loss: 3.836 Vali Acc: 0.610 Test Loss: 3.836 Test Acc: 0.610
Validation loss decreased (-0.519992 --> -0.609962).  Saving model ...
Epoch: 3 cost time: 5.710509777069092
Epoch: 3, Steps: 18 | Train Loss: 1.715 Vali Loss: 5.113 Vali Acc: 0.450 Test Loss: 5.113 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.870716333389282
Epoch: 4, Steps: 18 | Train Loss: 3.538 Vali Loss: 7.231 Vali Acc: 0.520 Test Loss: 7.231 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.273531913757324
Epoch: 5, Steps: 18 | Train Loss: 3.059 Vali Loss: 10.963 Vali Acc: 0.480 Test Loss: 10.963 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.195403814315796
Epoch: 6, Steps: 18 | Train Loss: 1.894 Vali Loss: 7.654 Vali Acc: 0.490 Test Loss: 7.654 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.827104091644287
Epoch: 7, Steps: 18 | Train Loss: 1.939 Vali Loss: 4.432 Vali Acc: 0.500 Test Loss: 4.432 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.873948812484741
Epoch: 8, Steps: 18 | Train Loss: 1.585 Vali Loss: 9.180 Vali Acc: 0.490 Test Loss: 9.180 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.252124547958374
Epoch: 9, Steps: 18 | Train Loss: 0.792 Vali Loss: 8.884 Vali Acc: 0.500 Test Loss: 8.884 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.9219970703125
Epoch: 10, Steps: 18 | Train Loss: 1.189 Vali Loss: 17.341 Vali Acc: 0.440 Test Loss: 17.341 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.80210018157959
Epoch: 11, Steps: 18 | Train Loss: 0.717 Vali Loss: 16.903 Vali Acc: 0.430 Test Loss: 16.903 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.633306980133057
Epoch: 12, Steps: 18 | Train Loss: 1.140 Vali Loss: 11.962 Vali Acc: 0.490 Test Loss: 11.962 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 4646914
model size : 17.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.269311189651489
Epoch: 1, Steps: 18 | Train Loss: 0.906 Vali Loss: 1.083 Vali Acc: 0.520 Test Loss: 1.083 Test Acc: 0.520
Validation loss decreased (inf --> -0.519989).  Saving model ...
Epoch: 2 cost time: 4.156563758850098
Epoch: 2, Steps: 18 | Train Loss: 0.637 Vali Loss: 1.301 Vali Acc: 0.540 Test Loss: 1.301 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539987).  Saving model ...
Epoch: 3 cost time: 3.8378493785858154
Epoch: 3, Steps: 18 | Train Loss: 0.541 Vali Loss: 1.488 Vali Acc: 0.480 Test Loss: 1.488 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9104626178741455
Epoch: 4, Steps: 18 | Train Loss: 0.814 Vali Loss: 2.297 Vali Acc: 0.450 Test Loss: 2.297 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.14904260635376
Epoch: 5, Steps: 18 | Train Loss: 0.604 Vali Loss: 3.649 Vali Acc: 0.500 Test Loss: 3.649 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.9050824642181396
Epoch: 6, Steps: 18 | Train Loss: 0.739 Vali Loss: 2.009 Vali Acc: 0.570 Test Loss: 2.009 Test Acc: 0.570
Validation loss decreased (-0.539987 --> -0.569980).  Saving model ...
Epoch: 7 cost time: 3.7658209800720215
Epoch: 7, Steps: 18 | Train Loss: 0.504 Vali Loss: 6.031 Vali Acc: 0.540 Test Loss: 6.031 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.116253137588501
Epoch: 8, Steps: 18 | Train Loss: 0.397 Vali Loss: 4.928 Vali Acc: 0.470 Test Loss: 4.928 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.8709487915039062
Epoch: 9, Steps: 18 | Train Loss: 0.498 Vali Loss: 8.160 Vali Acc: 0.490 Test Loss: 8.160 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.984884262084961
Epoch: 10, Steps: 18 | Train Loss: 0.710 Vali Loss: 6.788 Vali Acc: 0.570 Test Loss: 6.788 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.8691654205322266
Epoch: 11, Steps: 18 | Train Loss: 0.399 Vali Loss: 5.731 Vali Acc: 0.500 Test Loss: 5.731 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.127857685089111
Epoch: 12, Steps: 18 | Train Loss: 0.409 Vali Loss: 6.470 Vali Acc: 0.440 Test Loss: 6.470 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.011309862136841
Epoch: 13, Steps: 18 | Train Loss: 0.576 Vali Loss: 6.291 Vali Acc: 0.510 Test Loss: 6.291 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.8104095458984375
Epoch: 14, Steps: 18 | Train Loss: 0.592 Vali Loss: 9.929 Vali Acc: 0.500 Test Loss: 9.929 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.313860893249512
Epoch: 15, Steps: 18 | Train Loss: 0.413 Vali Loss: 6.659 Vali Acc: 0.510 Test Loss: 6.659 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.9547102451324463
Epoch: 16, Steps: 18 | Train Loss: 0.321 Vali Loss: 8.988 Vali Acc: 0.480 Test Loss: 8.988 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 4033922
model size : 15.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.558011054992676
Epoch: 1, Steps: 18 | Train Loss: 1.176 Vali Loss: 1.040 Vali Acc: 0.450 Test Loss: 1.040 Test Acc: 0.450
Validation loss decreased (inf --> -0.449990).  Saving model ...
Epoch: 2 cost time: 4.328775405883789
Epoch: 2, Steps: 18 | Train Loss: 0.964 Vali Loss: 1.803 Vali Acc: 0.620 Test Loss: 1.803 Test Acc: 0.620
Validation loss decreased (-0.449990 --> -0.619982).  Saving model ...
Epoch: 3 cost time: 4.106050729751587
Epoch: 3, Steps: 18 | Train Loss: 0.896 Vali Loss: 1.432 Vali Acc: 0.470 Test Loss: 1.432 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.493995904922485
Epoch: 4, Steps: 18 | Train Loss: 0.691 Vali Loss: 2.171 Vali Acc: 0.560 Test Loss: 2.171 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.272049427032471
Epoch: 5, Steps: 18 | Train Loss: 0.538 Vali Loss: 3.239 Vali Acc: 0.450 Test Loss: 3.239 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.381297588348389
Epoch: 6, Steps: 18 | Train Loss: 0.566 Vali Loss: 2.145 Vali Acc: 0.430 Test Loss: 2.145 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.060150623321533
Epoch: 7, Steps: 18 | Train Loss: 0.351 Vali Loss: 1.957 Vali Acc: 0.400 Test Loss: 1.957 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.246216773986816
Epoch: 8, Steps: 18 | Train Loss: 0.313 Vali Loss: 2.886 Vali Acc: 0.490 Test Loss: 2.886 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.284495115280151
Epoch: 9, Steps: 18 | Train Loss: 0.481 Vali Loss: 2.385 Vali Acc: 0.470 Test Loss: 2.385 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.304122686386108
Epoch: 10, Steps: 18 | Train Loss: 0.489 Vali Loss: 2.789 Vali Acc: 0.410 Test Loss: 2.789 Test Acc: 0.410
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.337329864501953
Epoch: 11, Steps: 18 | Train Loss: 0.305 Vali Loss: 3.341 Vali Acc: 0.480 Test Loss: 3.341 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.21533203125
Epoch: 12, Steps: 18 | Train Loss: 0.129 Vali Loss: 2.903 Vali Acc: 0.490 Test Loss: 2.903 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 3814146
model size : 14.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.569422006607056
Epoch: 1, Steps: 18 | Train Loss: 0.818 Vali Loss: 0.908 Vali Acc: 0.500 Test Loss: 0.908 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 3.5170676708221436
Epoch: 2, Steps: 18 | Train Loss: 0.708 Vali Loss: 0.864 Vali Acc: 0.520 Test Loss: 0.864 Test Acc: 0.520
Validation loss decreased (-0.499991 --> -0.519991).  Saving model ...
Epoch: 3 cost time: 3.3133065700531006
Epoch: 3, Steps: 18 | Train Loss: 0.478 Vali Loss: 1.159 Vali Acc: 0.550 Test Loss: 1.159 Test Acc: 0.550
Validation loss decreased (-0.519991 --> -0.549988).  Saving model ...
Epoch: 4 cost time: 3.164559841156006
Epoch: 4, Steps: 18 | Train Loss: 0.537 Vali Loss: 1.411 Vali Acc: 0.590 Test Loss: 1.411 Test Acc: 0.590
Validation loss decreased (-0.549988 --> -0.589986).  Saving model ...
Epoch: 5 cost time: 3.285280227661133
Epoch: 5, Steps: 18 | Train Loss: 0.372 Vali Loss: 1.967 Vali Acc: 0.500 Test Loss: 1.967 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0034890174865723
Epoch: 6, Steps: 18 | Train Loss: 0.309 Vali Loss: 2.936 Vali Acc: 0.510 Test Loss: 2.936 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1297996044158936
Epoch: 7, Steps: 18 | Train Loss: 0.349 Vali Loss: 2.219 Vali Acc: 0.490 Test Loss: 2.219 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.3078951835632324
Epoch: 8, Steps: 18 | Train Loss: 0.327 Vali Loss: 3.440 Vali Acc: 0.480 Test Loss: 3.440 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.5040011405944824
Epoch: 9, Steps: 18 | Train Loss: 0.169 Vali Loss: 2.679 Vali Acc: 0.510 Test Loss: 2.679 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.6318461894989014
Epoch: 10, Steps: 18 | Train Loss: 0.177 Vali Loss: 2.327 Vali Acc: 0.480 Test Loss: 2.327 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.0546021461486816
Epoch: 11, Steps: 18 | Train Loss: 0.196 Vali Loss: 2.333 Vali Acc: 0.490 Test Loss: 2.333 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.982529878616333
Epoch: 12, Steps: 18 | Train Loss: 0.287 Vali Loss: 4.836 Vali Acc: 0.480 Test Loss: 4.836 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.0404722690582275
Epoch: 13, Steps: 18 | Train Loss: 1.035 Vali Loss: 3.223 Vali Acc: 0.450 Test Loss: 3.223 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.078674554824829
Epoch: 14, Steps: 18 | Train Loss: 0.201 Vali Loss: 3.380 Vali Acc: 0.510 Test Loss: 3.380 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3725442
model size : 14.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.0357983112335205
Epoch: 1, Steps: 18 | Train Loss: 0.820 Vali Loss: 0.971 Vali Acc: 0.570 Test Loss: 0.971 Test Acc: 0.570
Validation loss decreased (inf --> -0.569990).  Saving model ...
Epoch: 2 cost time: 3.87341046333313
Epoch: 2, Steps: 18 | Train Loss: 0.679 Vali Loss: 1.165 Vali Acc: 0.490 Test Loss: 1.165 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.880382537841797
Epoch: 3, Steps: 18 | Train Loss: 0.614 Vali Loss: 1.056 Vali Acc: 0.510 Test Loss: 1.056 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.721310615539551
Epoch: 4, Steps: 18 | Train Loss: 0.379 Vali Loss: 1.531 Vali Acc: 0.480 Test Loss: 1.531 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.551769971847534
Epoch: 5, Steps: 18 | Train Loss: 0.510 Vali Loss: 1.183 Vali Acc: 0.540 Test Loss: 1.183 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.9796769618988037
Epoch: 6, Steps: 18 | Train Loss: 0.410 Vali Loss: 1.549 Vali Acc: 0.550 Test Loss: 1.549 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.844048023223877
Epoch: 7, Steps: 18 | Train Loss: 0.204 Vali Loss: 1.409 Vali Acc: 0.470 Test Loss: 1.409 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.8705086708068848
Epoch: 8, Steps: 18 | Train Loss: 0.440 Vali Loss: 1.607 Vali Acc: 0.490 Test Loss: 1.607 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.6059019565582275
Epoch: 9, Steps: 18 | Train Loss: 0.288 Vali Loss: 2.253 Vali Acc: 0.470 Test Loss: 2.253 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.8300278186798096
Epoch: 10, Steps: 18 | Train Loss: 0.163 Vali Loss: 2.146 Vali Acc: 0.390 Test Loss: 2.146 Test Acc: 0.390
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.068880319595337
Epoch: 11, Steps: 18 | Train Loss: 0.518 Vali Loss: 3.133 Vali Acc: 0.450 Test Loss: 3.133 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3629954
model size : 13.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.022249460220337
Epoch: 1, Steps: 18 | Train Loss: 0.768 Vali Loss: 1.000 Vali Acc: 0.570 Test Loss: 1.000 Test Acc: 0.570
Validation loss decreased (inf --> -0.569990).  Saving model ...
Epoch: 2 cost time: 3.7573304176330566
Epoch: 2, Steps: 18 | Train Loss: 0.709 Vali Loss: 1.087 Vali Acc: 0.500 Test Loss: 1.087 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6212494373321533
Epoch: 3, Steps: 18 | Train Loss: 0.566 Vali Loss: 1.506 Vali Acc: 0.600 Test Loss: 1.506 Test Acc: 0.600
Validation loss decreased (-0.569990 --> -0.599985).  Saving model ...
Epoch: 4 cost time: 3.5091497898101807
Epoch: 4, Steps: 18 | Train Loss: 0.457 Vali Loss: 0.910 Vali Acc: 0.510 Test Loss: 0.910 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.614218235015869
Epoch: 5, Steps: 18 | Train Loss: 0.450 Vali Loss: 1.802 Vali Acc: 0.580 Test Loss: 1.802 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.6469967365264893
Epoch: 6, Steps: 18 | Train Loss: 0.365 Vali Loss: 1.003 Vali Acc: 0.550 Test Loss: 1.003 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.608558416366577
Epoch: 7, Steps: 18 | Train Loss: 0.426 Vali Loss: 1.731 Vali Acc: 0.600 Test Loss: 1.731 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.6128828525543213
Epoch: 8, Steps: 18 | Train Loss: 0.164 Vali Loss: 1.179 Vali Acc: 0.570 Test Loss: 1.179 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.598198890686035
Epoch: 9, Steps: 18 | Train Loss: 0.081 Vali Loss: 1.320 Vali Acc: 0.550 Test Loss: 1.320 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.375072956085205
Epoch: 10, Steps: 18 | Train Loss: 0.137 Vali Loss: 1.451 Vali Acc: 0.570 Test Loss: 1.451 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.788748025894165
Epoch: 11, Steps: 18 | Train Loss: 0.119 Vali Loss: 1.431 Vali Acc: 0.550 Test Loss: 1.431 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.653315782546997
Epoch: 12, Steps: 18 | Train Loss: 0.285 Vali Loss: 2.062 Vali Acc: 0.530 Test Loss: 2.062 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.6301982402801514
Epoch: 13, Steps: 18 | Train Loss: 0.318 Vali Loss: 2.692 Vali Acc: 0.550 Test Loss: 2.692 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 3600002
model size : 13.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.020418882369995
Epoch: 1, Steps: 18 | Train Loss: 0.785 Vali Loss: 0.685 Vali Acc: 0.580 Test Loss: 0.685 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 2.9540045261383057
Epoch: 2, Steps: 18 | Train Loss: 0.667 Vali Loss: 0.764 Vali Acc: 0.490 Test Loss: 0.764 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0374560356140137
Epoch: 3, Steps: 18 | Train Loss: 0.568 Vali Loss: 0.787 Vali Acc: 0.470 Test Loss: 0.787 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1774685382843018
Epoch: 4, Steps: 18 | Train Loss: 0.374 Vali Loss: 1.047 Vali Acc: 0.500 Test Loss: 1.047 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.777462959289551
Epoch: 5, Steps: 18 | Train Loss: 0.304 Vali Loss: 0.872 Vali Acc: 0.570 Test Loss: 0.872 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.6107168197631836
Epoch: 6, Steps: 18 | Train Loss: 0.254 Vali Loss: 1.177 Vali Acc: 0.520 Test Loss: 1.177 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.8125433921813965
Epoch: 7, Steps: 18 | Train Loss: 0.190 Vali Loss: 1.112 Vali Acc: 0.460 Test Loss: 1.112 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.860245704650879
Epoch: 8, Steps: 18 | Train Loss: 0.125 Vali Loss: 0.848 Vali Acc: 0.550 Test Loss: 0.848 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.0910911560058594
Epoch: 9, Steps: 18 | Train Loss: 0.204 Vali Loss: 1.123 Vali Acc: 0.580 Test Loss: 1.123 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.144885301589966
Epoch: 10, Steps: 18 | Train Loss: 0.203 Vali Loss: 1.723 Vali Acc: 0.550 Test Loss: 1.723 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.689150810241699
Epoch: 11, Steps: 18 | Train Loss: 0.204 Vali Loss: 1.440 Vali Acc: 0.520 Test Loss: 1.440 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 3586434
model size : 13.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.6047894954681396
Epoch: 1, Steps: 18 | Train Loss: 0.894 Vali Loss: 0.872 Vali Acc: 0.510 Test Loss: 0.872 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 2.5438811779022217
Epoch: 2, Steps: 18 | Train Loss: 0.651 Vali Loss: 1.412 Vali Acc: 0.490 Test Loss: 1.412 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3870129585266113
Epoch: 3, Steps: 18 | Train Loss: 0.860 Vali Loss: 1.048 Vali Acc: 0.540 Test Loss: 1.048 Test Acc: 0.540
Validation loss decreased (-0.509991 --> -0.539990).  Saving model ...
Epoch: 4 cost time: 2.321930408477783
Epoch: 4, Steps: 18 | Train Loss: 0.757 Vali Loss: 2.345 Vali Acc: 0.450 Test Loss: 2.345 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4240472316741943
Epoch: 5, Steps: 18 | Train Loss: 0.605 Vali Loss: 2.870 Vali Acc: 0.460 Test Loss: 2.870 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5037856101989746
Epoch: 6, Steps: 18 | Train Loss: 0.559 Vali Loss: 3.085 Vali Acc: 0.490 Test Loss: 3.085 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.300807237625122
Epoch: 7, Steps: 18 | Train Loss: 0.809 Vali Loss: 3.796 Vali Acc: 0.590 Test Loss: 3.796 Test Acc: 0.590
Validation loss decreased (-0.539990 --> -0.589962).  Saving model ...
Epoch: 8 cost time: 2.2957913875579834
Epoch: 8, Steps: 18 | Train Loss: 0.183 Vali Loss: 5.067 Vali Acc: 0.470 Test Loss: 5.067 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.321068525314331
Epoch: 9, Steps: 18 | Train Loss: 0.274 Vali Loss: 5.204 Vali Acc: 0.450 Test Loss: 5.204 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.581733226776123
Epoch: 10, Steps: 18 | Train Loss: 0.447 Vali Loss: 9.124 Vali Acc: 0.450 Test Loss: 9.124 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.345858573913574
Epoch: 11, Steps: 18 | Train Loss: 0.592 Vali Loss: 8.190 Vali Acc: 0.440 Test Loss: 8.190 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3528800010681152
Epoch: 12, Steps: 18 | Train Loss: 0.819 Vali Loss: 7.094 Vali Acc: 0.450 Test Loss: 7.094 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4103970527648926
Epoch: 13, Steps: 18 | Train Loss: 0.164 Vali Loss: 7.915 Vali Acc: 0.450 Test Loss: 7.915 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.6325228214263916
Epoch: 14, Steps: 18 | Train Loss: 0.143 Vali Loss: 6.937 Vali Acc: 0.450 Test Loss: 6.937 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.3014132976531982
Epoch: 15, Steps: 18 | Train Loss: 0.343 Vali Loss: 10.551 Vali Acc: 0.410 Test Loss: 10.551 Test Acc: 0.410
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.289639949798584
Epoch: 16, Steps: 18 | Train Loss: 0.481 Vali Loss: 15.557 Vali Acc: 0.460 Test Loss: 15.557 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.372574806213379
Epoch: 17, Steps: 18 | Train Loss: 1.071 Vali Loss: 12.564 Vali Acc: 0.490 Test Loss: 12.564 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1799170
model size : 6.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.1054952144622803
Epoch: 1, Steps: 18 | Train Loss: 0.986 Vali Loss: 0.766 Vali Acc: 0.530 Test Loss: 0.766 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 2.090132474899292
Epoch: 2, Steps: 18 | Train Loss: 0.696 Vali Loss: 1.005 Vali Acc: 0.480 Test Loss: 1.005 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9078764915466309
Epoch: 3, Steps: 18 | Train Loss: 0.838 Vali Loss: 1.275 Vali Acc: 0.470 Test Loss: 1.275 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9018235206604004
Epoch: 4, Steps: 18 | Train Loss: 0.691 Vali Loss: 1.261 Vali Acc: 0.480 Test Loss: 1.261 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0198776721954346
Epoch: 5, Steps: 18 | Train Loss: 0.307 Vali Loss: 1.063 Vali Acc: 0.560 Test Loss: 1.063 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559989).  Saving model ...
Epoch: 6 cost time: 1.7647464275360107
Epoch: 6, Steps: 18 | Train Loss: 0.194 Vali Loss: 1.669 Vali Acc: 0.510 Test Loss: 1.669 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8536913394927979
Epoch: 7, Steps: 18 | Train Loss: 0.201 Vali Loss: 1.769 Vali Acc: 0.510 Test Loss: 1.769 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0549404621124268
Epoch: 8, Steps: 18 | Train Loss: 0.293 Vali Loss: 2.411 Vali Acc: 0.490 Test Loss: 2.411 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.489405870437622
Epoch: 9, Steps: 18 | Train Loss: 0.178 Vali Loss: 2.483 Vali Acc: 0.420 Test Loss: 2.483 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7982425689697266
Epoch: 10, Steps: 18 | Train Loss: 0.146 Vali Loss: 1.975 Vali Acc: 0.480 Test Loss: 1.975 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9089152812957764
Epoch: 11, Steps: 18 | Train Loss: 0.120 Vali Loss: 1.731 Vali Acc: 0.580 Test Loss: 1.731 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579983).  Saving model ...
Epoch: 12 cost time: 2.123605489730835
Epoch: 12, Steps: 18 | Train Loss: 0.206 Vali Loss: 3.866 Vali Acc: 0.560 Test Loss: 3.866 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9194574356079102
Epoch: 13, Steps: 18 | Train Loss: 0.107 Vali Loss: 2.214 Vali Acc: 0.480 Test Loss: 2.214 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8819100856781006
Epoch: 14, Steps: 18 | Train Loss: 0.111 Vali Loss: 2.628 Vali Acc: 0.470 Test Loss: 2.628 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9182710647583008
Epoch: 15, Steps: 18 | Train Loss: 0.050 Vali Loss: 3.242 Vali Acc: 0.500 Test Loss: 3.242 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.109527587890625
Epoch: 16, Steps: 18 | Train Loss: 0.196 Vali Loss: 3.308 Vali Acc: 0.550 Test Loss: 3.308 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9043800830841064
Epoch: 17, Steps: 18 | Train Loss: 0.107 Vali Loss: 5.587 Vali Acc: 0.480 Test Loss: 5.587 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8172428607940674
Epoch: 18, Steps: 18 | Train Loss: 0.093 Vali Loss: 2.960 Vali Acc: 0.490 Test Loss: 2.960 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.1882550716400146
Epoch: 19, Steps: 18 | Train Loss: 0.331 Vali Loss: 4.830 Vali Acc: 0.470 Test Loss: 4.830 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8224618434906006
Epoch: 20, Steps: 18 | Train Loss: 0.125 Vali Loss: 5.222 Vali Acc: 0.580 Test Loss: 5.222 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8715815544128418
Epoch: 21, Steps: 18 | Train Loss: 0.600 Vali Loss: 5.617 Vali Acc: 0.430 Test Loss: 5.617 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1492674
model size : 5.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.6622097492218018
Epoch: 1, Steps: 18 | Train Loss: 0.837 Vali Loss: 0.840 Vali Acc: 0.590 Test Loss: 0.840 Test Acc: 0.590
Validation loss decreased (inf --> -0.589992).  Saving model ...
Epoch: 2 cost time: 2.6043145656585693
Epoch: 2, Steps: 18 | Train Loss: 0.614 Vali Loss: 0.973 Vali Acc: 0.470 Test Loss: 0.973 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.585263967514038
Epoch: 3, Steps: 18 | Train Loss: 0.471 Vali Loss: 0.989 Vali Acc: 0.580 Test Loss: 0.989 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.682042121887207
Epoch: 4, Steps: 18 | Train Loss: 0.367 Vali Loss: 1.248 Vali Acc: 0.560 Test Loss: 1.248 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5014240741729736
Epoch: 5, Steps: 18 | Train Loss: 0.322 Vali Loss: 1.562 Vali Acc: 0.480 Test Loss: 1.562 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.648376941680908
Epoch: 6, Steps: 18 | Train Loss: 0.216 Vali Loss: 1.567 Vali Acc: 0.560 Test Loss: 1.567 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5890371799468994
Epoch: 7, Steps: 18 | Train Loss: 0.174 Vali Loss: 1.559 Vali Acc: 0.510 Test Loss: 1.559 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.587737560272217
Epoch: 8, Steps: 18 | Train Loss: 0.317 Vali Loss: 1.688 Vali Acc: 0.520 Test Loss: 1.688 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.565319061279297
Epoch: 9, Steps: 18 | Train Loss: 0.171 Vali Loss: 2.105 Vali Acc: 0.480 Test Loss: 2.105 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.5775606632232666
Epoch: 10, Steps: 18 | Train Loss: 0.124 Vali Loss: 2.125 Vali Acc: 0.440 Test Loss: 2.125 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.5323691368103027
Epoch: 11, Steps: 18 | Train Loss: 0.054 Vali Loss: 1.931 Vali Acc: 0.500 Test Loss: 1.931 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1382786
model size : 5.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.912447452545166
Epoch: 1, Steps: 18 | Train Loss: 0.754 Vali Loss: 0.711 Vali Acc: 0.530 Test Loss: 0.711 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.839034080505371
Epoch: 2, Steps: 18 | Train Loss: 0.645 Vali Loss: 1.032 Vali Acc: 0.570 Test Loss: 1.032 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569990).  Saving model ...
Epoch: 3 cost time: 1.922109842300415
Epoch: 3, Steps: 18 | Train Loss: 0.463 Vali Loss: 0.777 Vali Acc: 0.540 Test Loss: 0.777 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7267956733703613
Epoch: 4, Steps: 18 | Train Loss: 0.327 Vali Loss: 0.926 Vali Acc: 0.550 Test Loss: 0.926 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7649409770965576
Epoch: 5, Steps: 18 | Train Loss: 0.208 Vali Loss: 0.944 Vali Acc: 0.530 Test Loss: 0.944 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7686481475830078
Epoch: 6, Steps: 18 | Train Loss: 0.160 Vali Loss: 1.421 Vali Acc: 0.520 Test Loss: 1.421 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7941234111785889
Epoch: 7, Steps: 18 | Train Loss: 0.099 Vali Loss: 0.929 Vali Acc: 0.560 Test Loss: 0.929 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.818535566329956
Epoch: 8, Steps: 18 | Train Loss: 0.144 Vali Loss: 1.522 Vali Acc: 0.550 Test Loss: 1.522 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.737811803817749
Epoch: 9, Steps: 18 | Train Loss: 0.063 Vali Loss: 1.404 Vali Acc: 0.560 Test Loss: 1.404 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6761910915374756
Epoch: 10, Steps: 18 | Train Loss: 0.104 Vali Loss: 1.694 Vali Acc: 0.510 Test Loss: 1.694 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6459672451019287
Epoch: 11, Steps: 18 | Train Loss: 0.105 Vali Loss: 1.331 Vali Acc: 0.590 Test Loss: 1.331 Test Acc: 0.590
Validation loss decreased (-0.569990 --> -0.589987).  Saving model ...
Epoch: 12 cost time: 1.730710506439209
Epoch: 12, Steps: 18 | Train Loss: 0.089 Vali Loss: 1.835 Vali Acc: 0.540 Test Loss: 1.835 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8095943927764893
Epoch: 13, Steps: 18 | Train Loss: 0.034 Vali Loss: 2.157 Vali Acc: 0.540 Test Loss: 2.157 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8711533546447754
Epoch: 14, Steps: 18 | Train Loss: 0.171 Vali Loss: 1.558 Vali Acc: 0.560 Test Loss: 1.558 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8222928047180176
Epoch: 15, Steps: 18 | Train Loss: 0.217 Vali Loss: 1.569 Vali Acc: 0.510 Test Loss: 1.569 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8305339813232422
Epoch: 16, Steps: 18 | Train Loss: 0.048 Vali Loss: 1.676 Vali Acc: 0.450 Test Loss: 1.676 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.791938304901123
Epoch: 17, Steps: 18 | Train Loss: 0.053 Vali Loss: 2.387 Vali Acc: 0.500 Test Loss: 2.387 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.766798973083496
Epoch: 18, Steps: 18 | Train Loss: 0.020 Vali Loss: 2.304 Vali Acc: 0.490 Test Loss: 2.304 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7285058498382568
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 2.301 Vali Acc: 0.500 Test Loss: 2.301 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7739508152008057
Epoch: 20, Steps: 18 | Train Loss: 0.005 Vali Loss: 2.421 Vali Acc: 0.510 Test Loss: 2.421 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7871143817901611
Epoch: 21, Steps: 18 | Train Loss: 0.050 Vali Loss: 2.368 Vali Acc: 0.510 Test Loss: 2.368 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1338434
model size : 5.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.5661206245422363
Epoch: 1, Steps: 18 | Train Loss: 0.757 Vali Loss: 0.790 Vali Acc: 0.560 Test Loss: 0.790 Test Acc: 0.560
Validation loss decreased (inf --> -0.559992).  Saving model ...
Epoch: 2 cost time: 2.343108892440796
Epoch: 2, Steps: 18 | Train Loss: 0.700 Vali Loss: 0.834 Vali Acc: 0.430 Test Loss: 0.834 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.19643497467041
Epoch: 3, Steps: 18 | Train Loss: 0.644 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.401768207550049
Epoch: 4, Steps: 18 | Train Loss: 0.468 Vali Loss: 0.790 Vali Acc: 0.470 Test Loss: 0.790 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.506303548812866
Epoch: 5, Steps: 18 | Train Loss: 0.419 Vali Loss: 0.943 Vali Acc: 0.500 Test Loss: 0.943 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.353315591812134
Epoch: 6, Steps: 18 | Train Loss: 0.494 Vali Loss: 0.854 Vali Acc: 0.490 Test Loss: 0.854 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.379728078842163
Epoch: 7, Steps: 18 | Train Loss: 0.356 Vali Loss: 0.908 Vali Acc: 0.440 Test Loss: 0.908 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.376242160797119
Epoch: 8, Steps: 18 | Train Loss: 0.156 Vali Loss: 1.070 Vali Acc: 0.550 Test Loss: 1.070 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.275747060775757
Epoch: 9, Steps: 18 | Train Loss: 0.191 Vali Loss: 1.223 Vali Acc: 0.510 Test Loss: 1.223 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.3340187072753906
Epoch: 10, Steps: 18 | Train Loss: 0.094 Vali Loss: 1.679 Vali Acc: 0.460 Test Loss: 1.679 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.3835325241088867
Epoch: 11, Steps: 18 | Train Loss: 0.124 Vali Loss: 1.289 Vali Acc: 0.490 Test Loss: 1.289 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1290690
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.5198428630828857
Epoch: 1, Steps: 18 | Train Loss: 0.745 Vali Loss: 0.941 Vali Acc: 0.570 Test Loss: 0.941 Test Acc: 0.570
Validation loss decreased (inf --> -0.569991).  Saving model ...
Epoch: 2 cost time: 2.453418016433716
Epoch: 2, Steps: 18 | Train Loss: 0.707 Vali Loss: 0.829 Vali Acc: 0.660 Test Loss: 0.829 Test Acc: 0.660
Validation loss decreased (-0.569991 --> -0.659992).  Saving model ...
Epoch: 3 cost time: 2.4680323600769043
Epoch: 3, Steps: 18 | Train Loss: 0.594 Vali Loss: 0.904 Vali Acc: 0.590 Test Loss: 0.904 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4181418418884277
Epoch: 4, Steps: 18 | Train Loss: 0.536 Vali Loss: 0.779 Vali Acc: 0.600 Test Loss: 0.779 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.33018159866333
Epoch: 5, Steps: 18 | Train Loss: 0.400 Vali Loss: 0.985 Vali Acc: 0.560 Test Loss: 0.985 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.43534779548645
Epoch: 6, Steps: 18 | Train Loss: 0.316 Vali Loss: 0.845 Vali Acc: 0.470 Test Loss: 0.845 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.3398962020874023
Epoch: 7, Steps: 18 | Train Loss: 0.287 Vali Loss: 1.024 Vali Acc: 0.530 Test Loss: 1.024 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.4500951766967773
Epoch: 8, Steps: 18 | Train Loss: 0.207 Vali Loss: 1.011 Vali Acc: 0.550 Test Loss: 1.011 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.323044776916504
Epoch: 9, Steps: 18 | Train Loss: 0.142 Vali Loss: 1.120 Vali Acc: 0.460 Test Loss: 1.120 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.381768226623535
Epoch: 10, Steps: 18 | Train Loss: 0.143 Vali Loss: 0.926 Vali Acc: 0.520 Test Loss: 0.926 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.2597479820251465
Epoch: 11, Steps: 18 | Train Loss: 0.055 Vali Loss: 1.160 Vali Acc: 0.530 Test Loss: 1.160 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.2812039852142334
Epoch: 12, Steps: 18 | Train Loss: 0.058 Vali Loss: 1.301 Vali Acc: 0.510 Test Loss: 1.301 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 1275714
model size : 4.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.47483491897583
Epoch: 1, Steps: 18 | Train Loss: 0.719 Vali Loss: 0.755 Vali Acc: 0.530 Test Loss: 0.755 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 1.5032196044921875
Epoch: 2, Steps: 18 | Train Loss: 0.682 Vali Loss: 0.819 Vali Acc: 0.460 Test Loss: 0.819 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3987867832183838
Epoch: 3, Steps: 18 | Train Loss: 0.535 Vali Loss: 0.715 Vali Acc: 0.490 Test Loss: 0.715 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4044313430786133
Epoch: 4, Steps: 18 | Train Loss: 0.431 Vali Loss: 0.719 Vali Acc: 0.580 Test Loss: 0.719 Test Acc: 0.580
Validation loss decreased (-0.529992 --> -0.579993).  Saving model ...
Epoch: 5 cost time: 1.479952335357666
Epoch: 5, Steps: 18 | Train Loss: 0.361 Vali Loss: 0.804 Vali Acc: 0.500 Test Loss: 0.804 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6390373706817627
Epoch: 6, Steps: 18 | Train Loss: 0.244 Vali Loss: 0.715 Vali Acc: 0.550 Test Loss: 0.715 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4775915145874023
Epoch: 7, Steps: 18 | Train Loss: 0.186 Vali Loss: 0.786 Vali Acc: 0.560 Test Loss: 0.786 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5711536407470703
Epoch: 8, Steps: 18 | Train Loss: 0.153 Vali Loss: 0.796 Vali Acc: 0.510 Test Loss: 0.796 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4924168586730957
Epoch: 9, Steps: 18 | Train Loss: 0.166 Vali Loss: 0.932 Vali Acc: 0.500 Test Loss: 0.932 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3988187313079834
Epoch: 10, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.881 Vali Acc: 0.550 Test Loss: 0.881 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3628978729248047
Epoch: 11, Steps: 18 | Train Loss: 0.061 Vali Loss: 1.022 Vali Acc: 0.550 Test Loss: 1.022 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4431493282318115
Epoch: 12, Steps: 18 | Train Loss: 0.052 Vali Loss: 1.149 Vali Acc: 0.500 Test Loss: 1.149 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5326251983642578
Epoch: 13, Steps: 18 | Train Loss: 0.039 Vali Loss: 1.040 Vali Acc: 0.510 Test Loss: 1.040 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4897971153259277
Epoch: 14, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.027 Vali Acc: 0.520 Test Loss: 1.027 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1268930
model size : 4.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.8891820907592773
Epoch: 1, Steps: 18 | Train Loss: 0.967 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 1.6291208267211914
Epoch: 2, Steps: 18 | Train Loss: 0.658 Vali Loss: 0.800 Vali Acc: 0.540 Test Loss: 0.800 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7240967750549316
Epoch: 3, Steps: 18 | Train Loss: 0.599 Vali Loss: 1.960 Vali Acc: 0.550 Test Loss: 1.960 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6718509197235107
Epoch: 4, Steps: 18 | Train Loss: 0.361 Vali Loss: 1.246 Vali Acc: 0.540 Test Loss: 1.246 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6798186302185059
Epoch: 5, Steps: 18 | Train Loss: 0.317 Vali Loss: 1.812 Vali Acc: 0.500 Test Loss: 1.812 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5010437965393066
Epoch: 6, Steps: 18 | Train Loss: 0.558 Vali Loss: 1.787 Vali Acc: 0.490 Test Loss: 1.787 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7120184898376465
Epoch: 7, Steps: 18 | Train Loss: 0.517 Vali Loss: 2.847 Vali Acc: 0.460 Test Loss: 2.847 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.689208984375
Epoch: 8, Steps: 18 | Train Loss: 0.171 Vali Loss: 2.083 Vali Acc: 0.520 Test Loss: 2.083 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.626885175704956
Epoch: 9, Steps: 18 | Train Loss: 0.157 Vali Loss: 2.918 Vali Acc: 0.450 Test Loss: 2.918 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6974549293518066
Epoch: 10, Steps: 18 | Train Loss: 0.126 Vali Loss: 3.701 Vali Acc: 0.440 Test Loss: 3.701 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7530004978179932
Epoch: 11, Steps: 18 | Train Loss: 0.059 Vali Loss: 2.914 Vali Acc: 0.540 Test Loss: 2.914 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps75_str38_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 768514
model size : 2.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.5865530967712402
Epoch: 1, Steps: 18 | Train Loss: 0.801 Vali Loss: 1.028 Vali Acc: 0.530 Test Loss: 1.028 Test Acc: 0.530
Validation loss decreased (inf --> -0.529990).  Saving model ...
Epoch: 2 cost time: 1.4473705291748047
Epoch: 2, Steps: 18 | Train Loss: 0.791 Vali Loss: 0.889 Vali Acc: 0.580 Test Loss: 0.889 Test Acc: 0.580
Validation loss decreased (-0.529990 --> -0.579991).  Saving model ...
Epoch: 3 cost time: 1.3711678981781006
Epoch: 3, Steps: 18 | Train Loss: 0.590 Vali Loss: 0.946 Vali Acc: 0.470 Test Loss: 0.946 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5174307823181152
Epoch: 4, Steps: 18 | Train Loss: 0.458 Vali Loss: 0.899 Vali Acc: 0.550 Test Loss: 0.899 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3949246406555176
Epoch: 5, Steps: 18 | Train Loss: 0.313 Vali Loss: 1.124 Vali Acc: 0.480 Test Loss: 1.124 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5311992168426514
Epoch: 6, Steps: 18 | Train Loss: 0.199 Vali Loss: 1.086 Vali Acc: 0.480 Test Loss: 1.086 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5063414573669434
Epoch: 7, Steps: 18 | Train Loss: 0.095 Vali Loss: 1.193 Vali Acc: 0.520 Test Loss: 1.193 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4243128299713135
Epoch: 8, Steps: 18 | Train Loss: 0.066 Vali Loss: 1.229 Vali Acc: 0.490 Test Loss: 1.229 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4884605407714844
Epoch: 9, Steps: 18 | Train Loss: 0.087 Vali Loss: 1.699 Vali Acc: 0.450 Test Loss: 1.699 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.47788405418396
Epoch: 10, Steps: 18 | Train Loss: 0.048 Vali Loss: 1.586 Vali Acc: 0.470 Test Loss: 1.586 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4411790370941162
Epoch: 11, Steps: 18 | Train Loss: 0.048 Vali Loss: 1.231 Vali Acc: 0.540 Test Loss: 1.231 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4848756790161133
Epoch: 12, Steps: 18 | Train Loss: 0.038 Vali Loss: 1.834 Vali Acc: 0.470 Test Loss: 1.834 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps150_str75_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 615266
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.329482078552246
Epoch: 1, Steps: 18 | Train Loss: 0.757 Vali Loss: 0.769 Vali Acc: 0.470 Test Loss: 0.769 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 1.2929449081420898
Epoch: 2, Steps: 18 | Train Loss: 0.664 Vali Loss: 0.874 Vali Acc: 0.520 Test Loss: 0.874 Test Acc: 0.520
Validation loss decreased (-0.469992 --> -0.519991).  Saving model ...
Epoch: 3 cost time: 1.2557032108306885
Epoch: 3, Steps: 18 | Train Loss: 0.645 Vali Loss: 0.776 Vali Acc: 0.550 Test Loss: 0.776 Test Acc: 0.550
Validation loss decreased (-0.519991 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 1.2558069229125977
Epoch: 4, Steps: 18 | Train Loss: 0.459 Vali Loss: 0.766 Vali Acc: 0.520 Test Loss: 0.766 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2765436172485352
Epoch: 5, Steps: 18 | Train Loss: 0.318 Vali Loss: 0.823 Vali Acc: 0.520 Test Loss: 0.823 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2740466594696045
Epoch: 6, Steps: 18 | Train Loss: 0.193 Vali Loss: 0.857 Vali Acc: 0.550 Test Loss: 0.857 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3019273281097412
Epoch: 7, Steps: 18 | Train Loss: 0.203 Vali Loss: 0.947 Vali Acc: 0.560 Test Loss: 0.947 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559991).  Saving model ...
Epoch: 8 cost time: 1.225393295288086
Epoch: 8, Steps: 18 | Train Loss: 0.164 Vali Loss: 1.061 Vali Acc: 0.490 Test Loss: 1.061 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3422021865844727
Epoch: 9, Steps: 18 | Train Loss: 0.122 Vali Loss: 1.055 Vali Acc: 0.490 Test Loss: 1.055 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3208611011505127
Epoch: 10, Steps: 18 | Train Loss: 0.049 Vali Loss: 1.151 Vali Acc: 0.460 Test Loss: 1.151 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2976319789886475
Epoch: 11, Steps: 18 | Train Loss: 0.044 Vali Loss: 1.269 Vali Acc: 0.490 Test Loss: 1.269 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.30820894241333
Epoch: 12, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.129 Vali Acc: 0.540 Test Loss: 1.129 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2932517528533936
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.271 Vali Acc: 0.500 Test Loss: 1.271 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2859563827514648
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.288 Vali Acc: 0.500 Test Loss: 1.288 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3623793125152588
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.280 Vali Acc: 0.500 Test Loss: 1.280 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2732172012329102
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.403 Vali Acc: 0.460 Test Loss: 1.403 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3494207859039307
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.384 Vali Acc: 0.480 Test Loss: 1.384 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps225_str113_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 560322
model size : 2.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.5219969749450684
Epoch: 1, Steps: 18 | Train Loss: 0.791 Vali Loss: 0.774 Vali Acc: 0.450 Test Loss: 0.774 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 1.3026039600372314
Epoch: 2, Steps: 18 | Train Loss: 0.651 Vali Loss: 0.738 Vali Acc: 0.430 Test Loss: 0.738 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3681635856628418
Epoch: 3, Steps: 18 | Train Loss: 0.576 Vali Loss: 0.834 Vali Acc: 0.530 Test Loss: 0.834 Test Acc: 0.530
Validation loss decreased (-0.449992 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 1.3779246807098389
Epoch: 4, Steps: 18 | Train Loss: 0.406 Vali Loss: 0.938 Vali Acc: 0.570 Test Loss: 0.938 Test Acc: 0.570
Validation loss decreased (-0.529992 --> -0.569991).  Saving model ...
Epoch: 5 cost time: 1.2634289264678955
Epoch: 5, Steps: 18 | Train Loss: 0.301 Vali Loss: 0.810 Vali Acc: 0.520 Test Loss: 0.810 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3654587268829346
Epoch: 6, Steps: 18 | Train Loss: 0.171 Vali Loss: 0.790 Vali Acc: 0.560 Test Loss: 0.790 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2841038703918457
Epoch: 7, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.911 Vali Acc: 0.530 Test Loss: 0.911 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.334395170211792
Epoch: 8, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.881 Vali Acc: 0.560 Test Loss: 0.881 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3324010372161865
Epoch: 9, Steps: 18 | Train Loss: 0.048 Vali Loss: 1.112 Vali Acc: 0.560 Test Loss: 1.112 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3047893047332764
Epoch: 10, Steps: 18 | Train Loss: 0.034 Vali Loss: 1.239 Vali Acc: 0.480 Test Loss: 1.239 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3089509010314941
Epoch: 11, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.150 Vali Acc: 0.510 Test Loss: 1.150 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2683544158935547
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.979 Vali Acc: 0.500 Test Loss: 0.979 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.328538417816162
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.157 Vali Acc: 0.490 Test Loss: 1.157 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2884960174560547
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.095 Vali Acc: 0.470 Test Loss: 1.095 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 538146
model size : 2.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.32676362991333
Epoch: 1, Steps: 18 | Train Loss: 0.718 Vali Loss: 0.748 Vali Acc: 0.420 Test Loss: 0.748 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 1.3121275901794434
Epoch: 2, Steps: 18 | Train Loss: 0.723 Vali Loss: 0.909 Vali Acc: 0.460 Test Loss: 0.909 Test Acc: 0.460
Validation loss decreased (-0.419993 --> -0.459991).  Saving model ...
Epoch: 3 cost time: 1.4251587390899658
Epoch: 3, Steps: 18 | Train Loss: 0.651 Vali Loss: 0.757 Vali Acc: 0.520 Test Loss: 0.757 Test Acc: 0.520
Validation loss decreased (-0.459991 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 1.2628612518310547
Epoch: 4, Steps: 18 | Train Loss: 0.477 Vali Loss: 0.731 Vali Acc: 0.540 Test Loss: 0.731 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 1.209176778793335
Epoch: 5, Steps: 18 | Train Loss: 0.354 Vali Loss: 0.735 Vali Acc: 0.560 Test Loss: 0.735 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 6 cost time: 1.3265211582183838
Epoch: 6, Steps: 18 | Train Loss: 0.279 Vali Loss: 0.834 Vali Acc: 0.540 Test Loss: 0.834 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3064165115356445
Epoch: 7, Steps: 18 | Train Loss: 0.193 Vali Loss: 0.824 Vali Acc: 0.540 Test Loss: 0.824 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2682995796203613
Epoch: 8, Steps: 18 | Train Loss: 0.133 Vali Loss: 0.999 Vali Acc: 0.500 Test Loss: 0.999 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.234365701675415
Epoch: 9, Steps: 18 | Train Loss: 0.111 Vali Loss: 0.835 Vali Acc: 0.500 Test Loss: 0.835 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3376123905181885
Epoch: 10, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.977 Vali Acc: 0.510 Test Loss: 0.977 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2283711433410645
Epoch: 11, Steps: 18 | Train Loss: 0.065 Vali Loss: 1.005 Vali Acc: 0.430 Test Loss: 1.005 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.018484354019165
Epoch: 12, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.966 Vali Acc: 0.490 Test Loss: 0.966 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1367123126983643
Epoch: 13, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.215 Vali Acc: 0.440 Test Loss: 1.215 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0354766845703125
Epoch: 14, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.150 Vali Acc: 0.530 Test Loss: 1.150 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0147418975830078
Epoch: 15, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.153 Vali Acc: 0.470 Test Loss: 1.153 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps450_str225_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 514274
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.390376567840576
Epoch: 1, Steps: 18 | Train Loss: 0.731 Vali Loss: 0.878 Vali Acc: 0.530 Test Loss: 0.878 Test Acc: 0.530
Validation loss decreased (inf --> -0.529991).  Saving model ...
Epoch: 2 cost time: 1.2992351055145264
Epoch: 2, Steps: 18 | Train Loss: 0.696 Vali Loss: 0.776 Vali Acc: 0.450 Test Loss: 0.776 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3745231628417969
Epoch: 3, Steps: 18 | Train Loss: 0.625 Vali Loss: 0.763 Vali Acc: 0.530 Test Loss: 0.763 Test Acc: 0.530
Validation loss decreased (-0.529991 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 1.2285475730895996
Epoch: 4, Steps: 18 | Train Loss: 0.506 Vali Loss: 0.731 Vali Acc: 0.470 Test Loss: 0.731 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2868363857269287
Epoch: 5, Steps: 18 | Train Loss: 0.403 Vali Loss: 0.711 Vali Acc: 0.550 Test Loss: 0.711 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 1.256302833557129
Epoch: 6, Steps: 18 | Train Loss: 0.292 Vali Loss: 0.854 Vali Acc: 0.570 Test Loss: 0.854 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569991).  Saving model ...
Epoch: 7 cost time: 1.3143446445465088
Epoch: 7, Steps: 18 | Train Loss: 0.240 Vali Loss: 0.856 Vali Acc: 0.460 Test Loss: 0.856 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2379701137542725
Epoch: 8, Steps: 18 | Train Loss: 0.168 Vali Loss: 0.822 Vali Acc: 0.460 Test Loss: 0.822 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2516582012176514
Epoch: 9, Steps: 18 | Train Loss: 0.166 Vali Loss: 0.790 Vali Acc: 0.480 Test Loss: 0.790 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.258946418762207
Epoch: 10, Steps: 18 | Train Loss: 0.122 Vali Loss: 0.869 Vali Acc: 0.550 Test Loss: 0.869 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2337918281555176
Epoch: 11, Steps: 18 | Train Loss: 0.121 Vali Loss: 0.910 Vali Acc: 0.470 Test Loss: 0.910 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3341882228851318
Epoch: 12, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.953 Vali Acc: 0.500 Test Loss: 0.953 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2724826335906982
Epoch: 13, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.940 Vali Acc: 0.510 Test Loss: 0.940 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2206363677978516
Epoch: 14, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.889 Vali Acc: 0.500 Test Loss: 0.889 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.378453016281128
Epoch: 15, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.013 Vali Acc: 0.510 Test Loss: 1.013 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2377831935882568
Epoch: 16, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.069 Vali Acc: 0.470 Test Loss: 1.069 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps600_str300_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 506786
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.539041757583618
Epoch: 1, Steps: 18 | Train Loss: 0.749 Vali Loss: 0.741 Vali Acc: 0.410 Test Loss: 0.741 Test Acc: 0.410
Validation loss decreased (inf --> -0.409993).  Saving model ...
Epoch: 2 cost time: 1.2757530212402344
Epoch: 2, Steps: 18 | Train Loss: 0.678 Vali Loss: 0.759 Vali Acc: 0.540 Test Loss: 0.759 Test Acc: 0.540
Validation loss decreased (-0.409993 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 1.1423826217651367
Epoch: 3, Steps: 18 | Train Loss: 0.590 Vali Loss: 0.713 Vali Acc: 0.590 Test Loss: 0.713 Test Acc: 0.590
Validation loss decreased (-0.539992 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 1.1583402156829834
Epoch: 4, Steps: 18 | Train Loss: 0.501 Vali Loss: 0.756 Vali Acc: 0.530 Test Loss: 0.756 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2170722484588623
Epoch: 5, Steps: 18 | Train Loss: 0.465 Vali Loss: 0.766 Vali Acc: 0.500 Test Loss: 0.766 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2322039604187012
Epoch: 6, Steps: 18 | Train Loss: 0.467 Vali Loss: 0.706 Vali Acc: 0.560 Test Loss: 0.706 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.143427848815918
Epoch: 7, Steps: 18 | Train Loss: 0.328 Vali Loss: 0.773 Vali Acc: 0.560 Test Loss: 0.773 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.159517765045166
Epoch: 8, Steps: 18 | Train Loss: 0.251 Vali Loss: 0.738 Vali Acc: 0.570 Test Loss: 0.738 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2168011665344238
Epoch: 9, Steps: 18 | Train Loss: 0.216 Vali Loss: 0.740 Vali Acc: 0.590 Test Loss: 0.740 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1634037494659424
Epoch: 10, Steps: 18 | Train Loss: 0.164 Vali Loss: 0.761 Vali Acc: 0.520 Test Loss: 0.761 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2138166427612305
Epoch: 11, Steps: 18 | Train Loss: 0.155 Vali Loss: 0.901 Vali Acc: 0.490 Test Loss: 0.901 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2439589500427246
Epoch: 12, Steps: 18 | Train Loss: 0.106 Vali Loss: 0.839 Vali Acc: 0.550 Test Loss: 0.839 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2079062461853027
Epoch: 13, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.861 Vali Acc: 0.490 Test Loss: 0.861 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ModernTCN_UEA_ftM_sl3000_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps750_str375_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 503394
model size : 1.97MB
