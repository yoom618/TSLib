Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.093111038208008
Epoch: 1, Steps: 9 | Train Loss: 1.400 Vali Loss: 1.383 Vali Acc: 0.319 Test Loss: 1.383 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 0.8708724975585938
Epoch: 2, Steps: 9 | Train Loss: 1.279 Vali Loss: 1.288 Vali Acc: 0.543 Test Loss: 1.288 Test Acc: 0.543
Validation loss decreased (-0.318827 --> -0.543465).  Saving model ...
Epoch: 3 cost time: 0.809114933013916
Epoch: 3, Steps: 9 | Train Loss: 1.080 Vali Loss: 1.118 Vali Acc: 0.761 Test Loss: 1.118 Test Acc: 0.761
Validation loss decreased (-0.543465 --> -0.760858).  Saving model ...
Epoch: 4 cost time: 0.7841439247131348
Epoch: 4, Steps: 9 | Train Loss: 0.899 Vali Loss: 0.913 Vali Acc: 0.783 Test Loss: 0.913 Test Acc: 0.783
Validation loss decreased (-0.760858 --> -0.782600).  Saving model ...
Epoch: 5 cost time: 0.8506054878234863
Epoch: 5, Steps: 9 | Train Loss: 0.683 Vali Loss: 0.716 Vali Acc: 0.870 Test Loss: 0.716 Test Acc: 0.870
Validation loss decreased (-0.782600 --> -0.869558).  Saving model ...
Epoch: 6 cost time: 0.82755446434021
Epoch: 6, Steps: 9 | Train Loss: 0.489 Vali Loss: 0.543 Vali Acc: 0.877 Test Loss: 0.543 Test Acc: 0.877
Validation loss decreased (-0.869558 --> -0.876806).  Saving model ...
Epoch: 7 cost time: 0.8454978466033936
Epoch: 7, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.418 Vali Acc: 0.899 Test Loss: 0.418 Test Acc: 0.899
Validation loss decreased (-0.876806 --> -0.898547).  Saving model ...
Epoch: 8 cost time: 0.7342672348022461
Epoch: 8, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.345 Vali Acc: 0.906 Test Loss: 0.345 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 9 cost time: 0.7803173065185547
Epoch: 9, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.304 Vali Acc: 0.906 Test Loss: 0.304 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 10 cost time: 0.7746937274932861
Epoch: 10, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.279 Vali Acc: 0.935 Test Loss: 0.279 Test Acc: 0.935
Validation loss decreased (-0.905794 --> -0.934780).  Saving model ...
Epoch: 11 cost time: 0.801884651184082
Epoch: 11, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.260 Vali Acc: 0.920 Test Loss: 0.260 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8848457336425781
Epoch: 12, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.242 Vali Acc: 0.935 Test Loss: 0.242 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 13 cost time: 0.9528310298919678
Epoch: 13, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.227 Vali Acc: 0.942 Test Loss: 0.227 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 14 cost time: 0.7986342906951904
Epoch: 14, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7631204128265381
Epoch: 15, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.200 Vali Acc: 0.942 Test Loss: 0.200 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 16 cost time: 0.7653217315673828
Epoch: 16, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.204 Vali Acc: 0.942 Test Loss: 0.204 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8067340850830078
Epoch: 17, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.198 Vali Acc: 0.942 Test Loss: 0.198 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 18 cost time: 0.7267382144927979
Epoch: 18, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.201 Vali Acc: 0.942 Test Loss: 0.201 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7352464199066162
Epoch: 19, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.205 Vali Acc: 0.942 Test Loss: 0.205 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8527359962463379
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7637248039245605
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.199 Vali Acc: 0.928 Test Loss: 0.199 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8410153388977051
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.935 Test Loss: 0.198 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7824923992156982
Epoch: 23, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7485074996948242
Epoch: 24, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.186 Vali Acc: 0.935 Test Loss: 0.186 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7780790328979492
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.200 Vali Acc: 0.935 Test Loss: 0.200 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8094954490661621
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.191 Vali Acc: 0.942 Test Loss: 0.191 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 27 cost time: 0.7959408760070801
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.942 Test Loss: 0.194 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8050491809844971
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.189 Vali Acc: 0.942 Test Loss: 0.189 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 29 cost time: 0.7840580940246582
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.191 Vali Acc: 0.942 Test Loss: 0.191 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8567922115325928
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.935 Test Loss: 0.188 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7432155609130859
Epoch: 31, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7990069389343262
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.935 Test Loss: 0.192 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7972829341888428
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.935 Test Loss: 0.191 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8038389682769775
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.935 Test Loss: 0.192 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9270567893981934
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.935 Test Loss: 0.199 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.824885368347168
Epoch: 36, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.8054714202880859
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.935 Test Loss: 0.201 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.7650876045227051
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 601444
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.232837438583374
Epoch: 1, Steps: 9 | Train Loss: 1.382 Vali Loss: 1.371 Vali Acc: 0.355 Test Loss: 1.371 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 0.7380928993225098
Epoch: 2, Steps: 9 | Train Loss: 1.324 Vali Loss: 1.308 Vali Acc: 0.428 Test Loss: 1.308 Test Acc: 0.428
Validation loss decreased (-0.355059 --> -0.427523).  Saving model ...
Epoch: 3 cost time: 0.7017574310302734
Epoch: 3, Steps: 9 | Train Loss: 1.206 Vali Loss: 1.206 Vali Acc: 0.587 Test Loss: 1.206 Test Acc: 0.587
Validation loss decreased (-0.427523 --> -0.586944).  Saving model ...
Epoch: 4 cost time: 0.7601330280303955
Epoch: 4, Steps: 9 | Train Loss: 1.070 Vali Loss: 1.084 Vali Acc: 0.768 Test Loss: 1.084 Test Acc: 0.768
Validation loss decreased (-0.586944 --> -0.768105).  Saving model ...
Epoch: 5 cost time: 0.7772352695465088
Epoch: 5, Steps: 9 | Train Loss: 0.919 Vali Loss: 0.944 Vali Acc: 0.819 Test Loss: 0.944 Test Acc: 0.819
Validation loss decreased (-0.768105 --> -0.818831).  Saving model ...
Epoch: 6 cost time: 0.7365479469299316
Epoch: 6, Steps: 9 | Train Loss: 0.772 Vali Loss: 0.809 Vali Acc: 0.819 Test Loss: 0.809 Test Acc: 0.819
Validation loss decreased (-0.818831 --> -0.818832).  Saving model ...
Epoch: 7 cost time: 0.7838430404663086
Epoch: 7, Steps: 9 | Train Loss: 0.630 Vali Loss: 0.678 Vali Acc: 0.826 Test Loss: 0.678 Test Acc: 0.826
Validation loss decreased (-0.818832 --> -0.826080).  Saving model ...
Epoch: 8 cost time: 0.7904763221740723
Epoch: 8, Steps: 9 | Train Loss: 0.484 Vali Loss: 0.567 Vali Acc: 0.877 Test Loss: 0.567 Test Acc: 0.877
Validation loss decreased (-0.826080 --> -0.876806).  Saving model ...
Epoch: 9 cost time: 0.8377466201782227
Epoch: 9, Steps: 9 | Train Loss: 0.390 Vali Loss: 0.487 Vali Acc: 0.891 Test Loss: 0.487 Test Acc: 0.891
Validation loss decreased (-0.876806 --> -0.891299).  Saving model ...
Epoch: 10 cost time: 0.741161584854126
Epoch: 10, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.410 Vali Acc: 0.877 Test Loss: 0.410 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8044869899749756
Epoch: 11, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.357 Vali Acc: 0.884 Test Loss: 0.357 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8076443672180176
Epoch: 12, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.319 Vali Acc: 0.913 Test Loss: 0.319 Test Acc: 0.913
Validation loss decreased (-0.891299 --> -0.913040).  Saving model ...
Epoch: 13 cost time: 0.7644238471984863
Epoch: 13, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.301 Vali Acc: 0.928 Test Loss: 0.301 Test Acc: 0.928
Validation loss decreased (-0.913040 --> -0.927533).  Saving model ...
Epoch: 14 cost time: 0.7511725425720215
Epoch: 14, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.287 Vali Acc: 0.920 Test Loss: 0.287 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7700049877166748
Epoch: 15, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.264 Vali Acc: 0.928 Test Loss: 0.264 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927534).  Saving model ...
Epoch: 16 cost time: 0.7571947574615479
Epoch: 16, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.249 Vali Acc: 0.942 Test Loss: 0.249 Test Acc: 0.942
Validation loss decreased (-0.927534 --> -0.942026).  Saving model ...
Epoch: 17 cost time: 0.8079319000244141
Epoch: 17, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.252 Vali Acc: 0.942 Test Loss: 0.252 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7591049671173096
Epoch: 18, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.237 Vali Acc: 0.928 Test Loss: 0.237 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7832951545715332
Epoch: 19, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7986745834350586
Epoch: 20, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.219 Vali Acc: 0.928 Test Loss: 0.219 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.856731653213501
Epoch: 21, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.217 Vali Acc: 0.935 Test Loss: 0.217 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7259836196899414
Epoch: 22, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.218 Vali Acc: 0.920 Test Loss: 0.218 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6985840797424316
Epoch: 23, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.223 Vali Acc: 0.920 Test Loss: 0.223 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.810173511505127
Epoch: 24, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.231 Vali Acc: 0.913 Test Loss: 0.231 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8299438953399658
Epoch: 25, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.233 Vali Acc: 0.913 Test Loss: 0.233 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7516226768493652
Epoch: 26, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.229 Vali Acc: 0.913 Test Loss: 0.229 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 589316
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.259627342224121
Epoch: 1, Steps: 9 | Train Loss: 1.364 Vali Loss: 1.358 Vali Acc: 0.290 Test Loss: 1.358 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 0.7156264781951904
Epoch: 2, Steps: 9 | Train Loss: 1.299 Vali Loss: 1.307 Vali Acc: 0.449 Test Loss: 1.307 Test Acc: 0.449
Validation loss decreased (-0.289841 --> -0.449262).  Saving model ...
Epoch: 3 cost time: 0.7713010311126709
Epoch: 3, Steps: 9 | Train Loss: 1.204 Vali Loss: 1.220 Vali Acc: 0.587 Test Loss: 1.220 Test Acc: 0.587
Validation loss decreased (-0.449262 --> -0.586944).  Saving model ...
Epoch: 4 cost time: 0.7375595569610596
Epoch: 4, Steps: 9 | Train Loss: 1.071 Vali Loss: 1.108 Vali Acc: 0.652 Test Loss: 1.108 Test Acc: 0.652
Validation loss decreased (-0.586944 --> -0.652163).  Saving model ...
Epoch: 5 cost time: 0.7537136077880859
Epoch: 5, Steps: 9 | Train Loss: 0.958 Vali Loss: 0.990 Vali Acc: 0.696 Test Loss: 0.990 Test Acc: 0.696
Validation loss decreased (-0.652163 --> -0.695642).  Saving model ...
Epoch: 6 cost time: 0.7343511581420898
Epoch: 6, Steps: 9 | Train Loss: 0.809 Vali Loss: 0.886 Vali Acc: 0.717 Test Loss: 0.886 Test Acc: 0.717
Validation loss decreased (-0.695642 --> -0.717382).  Saving model ...
Epoch: 7 cost time: 0.7678699493408203
Epoch: 7, Steps: 9 | Train Loss: 0.682 Vali Loss: 0.786 Vali Acc: 0.754 Test Loss: 0.786 Test Acc: 0.754
Validation loss decreased (-0.717382 --> -0.753615).  Saving model ...
Epoch: 8 cost time: 0.7143416404724121
Epoch: 8, Steps: 9 | Train Loss: 0.581 Vali Loss: 0.683 Vali Acc: 0.804 Test Loss: 0.683 Test Acc: 0.804
Validation loss decreased (-0.753615 --> -0.804341).  Saving model ...
Epoch: 9 cost time: 0.7147245407104492
Epoch: 9, Steps: 9 | Train Loss: 0.451 Vali Loss: 0.599 Vali Acc: 0.826 Test Loss: 0.599 Test Acc: 0.826
Validation loss decreased (-0.804341 --> -0.826081).  Saving model ...
Epoch: 10 cost time: 0.75311279296875
Epoch: 10, Steps: 9 | Train Loss: 0.365 Vali Loss: 0.524 Vali Acc: 0.855 Test Loss: 0.524 Test Acc: 0.855
Validation loss decreased (-0.826081 --> -0.855067).  Saving model ...
Epoch: 11 cost time: 0.7340188026428223
Epoch: 11, Steps: 9 | Train Loss: 0.299 Vali Loss: 0.472 Vali Acc: 0.862 Test Loss: 0.472 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 12 cost time: 0.7447524070739746
Epoch: 12, Steps: 9 | Train Loss: 0.232 Vali Loss: 0.437 Vali Acc: 0.862 Test Loss: 0.437 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 13 cost time: 0.7066366672515869
Epoch: 13, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.416 Vali Acc: 0.841 Test Loss: 0.416 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7754719257354736
Epoch: 14, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.383 Vali Acc: 0.862 Test Loss: 0.383 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 15 cost time: 0.7308800220489502
Epoch: 15, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.355 Vali Acc: 0.862 Test Loss: 0.355 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 16 cost time: 0.7697277069091797
Epoch: 16, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.349 Vali Acc: 0.862 Test Loss: 0.349 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 17 cost time: 0.6909780502319336
Epoch: 17, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.347 Vali Acc: 0.862 Test Loss: 0.347 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 18 cost time: 0.7648355960845947
Epoch: 18, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.342 Vali Acc: 0.877 Test Loss: 0.342 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 19 cost time: 0.6927967071533203
Epoch: 19, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.318 Vali Acc: 0.877 Test Loss: 0.318 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 20 cost time: 0.7378132343292236
Epoch: 20, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.302 Vali Acc: 0.877 Test Loss: 0.302 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876809).  Saving model ...
Epoch: 21 cost time: 0.8020238876342773
Epoch: 21, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.288 Vali Acc: 0.877 Test Loss: 0.288 Test Acc: 0.877
Validation loss decreased (-0.876809 --> -0.876809).  Saving model ...
Epoch: 22 cost time: 0.7468080520629883
Epoch: 22, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.278 Vali Acc: 0.906 Test Loss: 0.278 Test Acc: 0.906
Validation loss decreased (-0.876809 --> -0.905794).  Saving model ...
Epoch: 23 cost time: 0.7462148666381836
Epoch: 23, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.288 Vali Acc: 0.891 Test Loss: 0.288 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7664830684661865
Epoch: 24, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.295 Vali Acc: 0.884 Test Loss: 0.295 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7286524772644043
Epoch: 25, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.299 Vali Acc: 0.891 Test Loss: 0.299 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7061212062835693
Epoch: 26, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.290 Vali Acc: 0.884 Test Loss: 0.290 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6848800182342529
Epoch: 27, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.240 Vali Acc: 0.913 Test Loss: 0.240 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 28 cost time: 0.8192753791809082
Epoch: 28, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.225 Vali Acc: 0.935 Test Loss: 0.225 Test Acc: 0.935
Validation loss decreased (-0.913041 --> -0.934780).  Saving model ...
Epoch: 29 cost time: 0.741013765335083
Epoch: 29, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.243 Vali Acc: 0.920 Test Loss: 0.243 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6828510761260986
Epoch: 30, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.271 Vali Acc: 0.899 Test Loss: 0.271 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.773585319519043
Epoch: 31, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.293 Vali Acc: 0.899 Test Loss: 0.293 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7234029769897461
Epoch: 32, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.288 Vali Acc: 0.899 Test Loss: 0.288 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7774159908294678
Epoch: 33, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.253 Vali Acc: 0.913 Test Loss: 0.253 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.754580020904541
Epoch: 34, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.241 Vali Acc: 0.913 Test Loss: 0.241 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7693204879760742
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.226 Vali Acc: 0.928 Test Loss: 0.226 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.7703428268432617
Epoch: 36, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.935 Test Loss: 0.223 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 37 cost time: 0.7606556415557861
Epoch: 37, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.238 Vali Acc: 0.920 Test Loss: 0.238 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7839574813842773
Epoch: 38, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.257 Vali Acc: 0.913 Test Loss: 0.257 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7095808982849121
Epoch: 39, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.258 Vali Acc: 0.899 Test Loss: 0.258 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6493449211120605
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.262 Vali Acc: 0.899 Test Loss: 0.262 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.768094539642334
Epoch: 41, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.258 Vali Acc: 0.899 Test Loss: 0.258 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7470545768737793
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.264 Vali Acc: 0.899 Test Loss: 0.264 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.7661635875701904
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.263 Vali Acc: 0.899 Test Loss: 0.263 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.7700526714324951
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.267 Vali Acc: 0.899 Test Loss: 0.267 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8064618110656738
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.7120695114135742
Epoch: 46, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.913 Test Loss: 0.266 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 586404
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1272149085998535
Epoch: 1, Steps: 9 | Train Loss: 1.397 Vali Loss: 1.379 Vali Acc: 0.290 Test Loss: 1.379 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 0.7397377490997314
Epoch: 2, Steps: 9 | Train Loss: 1.340 Vali Loss: 1.349 Vali Acc: 0.333 Test Loss: 1.349 Test Acc: 0.333
Validation loss decreased (-0.289841 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 0.6618413925170898
Epoch: 3, Steps: 9 | Train Loss: 1.275 Vali Loss: 1.292 Vali Acc: 0.457 Test Loss: 1.292 Test Acc: 0.457
Validation loss decreased (-0.333320 --> -0.456509).  Saving model ...
Epoch: 4 cost time: 0.6937766075134277
Epoch: 4, Steps: 9 | Train Loss: 1.176 Vali Loss: 1.218 Vali Acc: 0.580 Test Loss: 1.218 Test Acc: 0.580
Validation loss decreased (-0.456509 --> -0.579698).  Saving model ...
Epoch: 5 cost time: 0.7925384044647217
Epoch: 5, Steps: 9 | Train Loss: 1.076 Vali Loss: 1.133 Vali Acc: 0.681 Test Loss: 1.133 Test Acc: 0.681
Validation loss decreased (-0.579698 --> -0.681148).  Saving model ...
Epoch: 6 cost time: 0.7167220115661621
Epoch: 6, Steps: 9 | Train Loss: 0.964 Vali Loss: 1.045 Vali Acc: 0.732 Test Loss: 1.045 Test Acc: 0.732
Validation loss decreased (-0.681148 --> -0.731874).  Saving model ...
Epoch: 7 cost time: 0.8029215335845947
Epoch: 7, Steps: 9 | Train Loss: 0.850 Vali Loss: 0.948 Vali Acc: 0.783 Test Loss: 0.948 Test Acc: 0.783
Validation loss decreased (-0.731874 --> -0.782599).  Saving model ...
Epoch: 8 cost time: 0.7927432060241699
Epoch: 8, Steps: 9 | Train Loss: 0.732 Vali Loss: 0.848 Vali Acc: 0.804 Test Loss: 0.848 Test Acc: 0.804
Validation loss decreased (-0.782599 --> -0.804339).  Saving model ...
Epoch: 9 cost time: 0.7871692180633545
Epoch: 9, Steps: 9 | Train Loss: 0.613 Vali Loss: 0.757 Vali Acc: 0.812 Test Loss: 0.757 Test Acc: 0.812
Validation loss decreased (-0.804339 --> -0.811587).  Saving model ...
Epoch: 10 cost time: 0.7481544017791748
Epoch: 10, Steps: 9 | Train Loss: 0.507 Vali Loss: 0.673 Vali Acc: 0.819 Test Loss: 0.673 Test Acc: 0.819
Validation loss decreased (-0.811587 --> -0.818834).  Saving model ...
Epoch: 11 cost time: 0.7608332633972168
Epoch: 11, Steps: 9 | Train Loss: 0.418 Vali Loss: 0.600 Vali Acc: 0.826 Test Loss: 0.600 Test Acc: 0.826
Validation loss decreased (-0.818834 --> -0.826081).  Saving model ...
Epoch: 12 cost time: 0.726348876953125
Epoch: 12, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.539 Vali Acc: 0.826 Test Loss: 0.539 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826082).  Saving model ...
Epoch: 13 cost time: 0.7552764415740967
Epoch: 13, Steps: 9 | Train Loss: 0.289 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 14 cost time: 0.7358739376068115
Epoch: 14, Steps: 9 | Train Loss: 0.239 Vali Loss: 0.440 Vali Acc: 0.862 Test Loss: 0.440 Test Acc: 0.862
Validation loss decreased (-0.840575 --> -0.862314).  Saving model ...
Epoch: 15 cost time: 0.772144079208374
Epoch: 15, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.433 Vali Acc: 0.855 Test Loss: 0.433 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6991367340087891
Epoch: 16, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.400 Vali Acc: 0.862 Test Loss: 0.400 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 17 cost time: 0.7029240131378174
Epoch: 17, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.373 Vali Acc: 0.870 Test Loss: 0.373 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 18 cost time: 0.7295589447021484
Epoch: 18, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.370 Vali Acc: 0.870 Test Loss: 0.370 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869562).  Saving model ...
Epoch: 19 cost time: 0.8145403861999512
Epoch: 19, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.387 Vali Acc: 0.862 Test Loss: 0.387 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7760989665985107
Epoch: 20, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.343 Vali Acc: 0.870 Test Loss: 0.343 Test Acc: 0.870
Validation loss decreased (-0.869562 --> -0.869562).  Saving model ...
Epoch: 21 cost time: 0.7897598743438721
Epoch: 21, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.326 Vali Acc: 0.891 Test Loss: 0.326 Test Acc: 0.891
Validation loss decreased (-0.869562 --> -0.891301).  Saving model ...
Epoch: 22 cost time: 0.715322732925415
Epoch: 22, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.332 Vali Acc: 0.877 Test Loss: 0.332 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7500016689300537
Epoch: 23, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.337 Vali Acc: 0.899 Test Loss: 0.337 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 24 cost time: 0.6849808692932129
Epoch: 24, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.325 Vali Acc: 0.899 Test Loss: 0.325 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 25 cost time: 0.7278258800506592
Epoch: 25, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.340 Vali Acc: 0.877 Test Loss: 0.340 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6574358940124512
Epoch: 26, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.323 Vali Acc: 0.877 Test Loss: 0.323 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6930487155914307
Epoch: 27, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.328 Vali Acc: 0.884 Test Loss: 0.328 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7968578338623047
Epoch: 28, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.329 Vali Acc: 0.884 Test Loss: 0.329 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7339298725128174
Epoch: 29, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.327 Vali Acc: 0.891 Test Loss: 0.327 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7282929420471191
Epoch: 30, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.304 Vali Acc: 0.891 Test Loss: 0.304 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7519736289978027
Epoch: 31, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.297 Vali Acc: 0.899 Test Loss: 0.297 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898548).  Saving model ...
Epoch: 32 cost time: 0.7569613456726074
Epoch: 32, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.288 Vali Acc: 0.899 Test Loss: 0.288 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 33 cost time: 0.6910696029663086
Epoch: 33, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.299 Vali Acc: 0.899 Test Loss: 0.299 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7765133380889893
Epoch: 34, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.301 Vali Acc: 0.899 Test Loss: 0.301 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7869133949279785
Epoch: 35, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.300 Vali Acc: 0.891 Test Loss: 0.300 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8175251483917236
Epoch: 36, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.297 Vali Acc: 0.891 Test Loss: 0.297 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.717047929763794
Epoch: 37, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.295 Vali Acc: 0.891 Test Loss: 0.295 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7489454746246338
Epoch: 38, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.310 Vali Acc: 0.891 Test Loss: 0.310 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.7666196823120117
Epoch: 39, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.308 Vali Acc: 0.891 Test Loss: 0.308 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8399684429168701
Epoch: 40, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.301 Vali Acc: 0.891 Test Loss: 0.301 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.8147933483123779
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.295 Vali Acc: 0.891 Test Loss: 0.295 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.7952380180358887
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.310 Vali Acc: 0.891 Test Loss: 0.310 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 583492
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.2747137546539307
Epoch: 1, Steps: 9 | Train Loss: 1.371 Vali Loss: 1.367 Vali Acc: 0.254 Test Loss: 1.367 Test Acc: 0.254
Validation loss decreased (inf --> -0.253610).  Saving model ...
Epoch: 2 cost time: 0.8531501293182373
Epoch: 2, Steps: 9 | Train Loss: 1.344 Vali Loss: 1.336 Vali Acc: 0.333 Test Loss: 1.336 Test Acc: 0.333
Validation loss decreased (-0.253610 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 0.7929821014404297
Epoch: 3, Steps: 9 | Train Loss: 1.287 Vali Loss: 1.284 Vali Acc: 0.384 Test Loss: 1.284 Test Acc: 0.384
Validation loss decreased (-0.333320 --> -0.384045).  Saving model ...
Epoch: 4 cost time: 0.7626912593841553
Epoch: 4, Steps: 9 | Train Loss: 1.194 Vali Loss: 1.219 Vali Acc: 0.464 Test Loss: 1.219 Test Acc: 0.464
Validation loss decreased (-0.384045 --> -0.463756).  Saving model ...
Epoch: 5 cost time: 0.7509551048278809
Epoch: 5, Steps: 9 | Train Loss: 1.116 Vali Loss: 1.148 Vali Acc: 0.543 Test Loss: 1.148 Test Acc: 0.543
Validation loss decreased (-0.463756 --> -0.543467).  Saving model ...
Epoch: 6 cost time: 0.7108702659606934
Epoch: 6, Steps: 9 | Train Loss: 1.023 Vali Loss: 1.067 Vali Acc: 0.580 Test Loss: 1.067 Test Acc: 0.580
Validation loss decreased (-0.543467 --> -0.579699).  Saving model ...
Epoch: 7 cost time: 0.7279672622680664
Epoch: 7, Steps: 9 | Train Loss: 0.925 Vali Loss: 0.988 Vali Acc: 0.638 Test Loss: 0.988 Test Acc: 0.638
Validation loss decreased (-0.579699 --> -0.637671).  Saving model ...
Epoch: 8 cost time: 0.7471213340759277
Epoch: 8, Steps: 9 | Train Loss: 0.844 Vali Loss: 0.908 Vali Acc: 0.696 Test Loss: 0.908 Test Acc: 0.696
Validation loss decreased (-0.637671 --> -0.695643).  Saving model ...
Epoch: 9 cost time: 0.8134679794311523
Epoch: 9, Steps: 9 | Train Loss: 0.756 Vali Loss: 0.841 Vali Acc: 0.717 Test Loss: 0.841 Test Acc: 0.717
Validation loss decreased (-0.695643 --> -0.717383).  Saving model ...
Epoch: 10 cost time: 0.7737369537353516
Epoch: 10, Steps: 9 | Train Loss: 0.636 Vali Loss: 0.772 Vali Acc: 0.746 Test Loss: 0.772 Test Acc: 0.746
Validation loss decreased (-0.717383 --> -0.746369).  Saving model ...
Epoch: 11 cost time: 0.7642884254455566
Epoch: 11, Steps: 9 | Train Loss: 0.534 Vali Loss: 0.716 Vali Acc: 0.783 Test Loss: 0.716 Test Acc: 0.783
Validation loss decreased (-0.746369 --> -0.782602).  Saving model ...
Epoch: 12 cost time: 0.7128214836120605
Epoch: 12, Steps: 9 | Train Loss: 0.480 Vali Loss: 0.670 Vali Acc: 0.797 Test Loss: 0.670 Test Acc: 0.797
Validation loss decreased (-0.782602 --> -0.797095).  Saving model ...
Epoch: 13 cost time: 0.663198709487915
Epoch: 13, Steps: 9 | Train Loss: 0.394 Vali Loss: 0.618 Vali Acc: 0.804 Test Loss: 0.618 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804342).  Saving model ...
Epoch: 14 cost time: 0.72670578956604
Epoch: 14, Steps: 9 | Train Loss: 0.358 Vali Loss: 0.587 Vali Acc: 0.804 Test Loss: 0.587 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 15 cost time: 0.6609785556793213
Epoch: 15, Steps: 9 | Train Loss: 0.295 Vali Loss: 0.560 Vali Acc: 0.819 Test Loss: 0.560 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818835).  Saving model ...
Epoch: 16 cost time: 0.6727113723754883
Epoch: 16, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.534 Vali Acc: 0.826 Test Loss: 0.534 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 17 cost time: 0.6954119205474854
Epoch: 17, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.500 Vali Acc: 0.826 Test Loss: 0.500 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 18 cost time: 0.7202353477478027
Epoch: 18, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.501 Vali Acc: 0.833 Test Loss: 0.501 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 19 cost time: 0.7428350448608398
Epoch: 19, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.472 Vali Acc: 0.841 Test Loss: 0.472 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 20 cost time: 0.734520435333252
Epoch: 20, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.478 Vali Acc: 0.833 Test Loss: 0.478 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7690491676330566
Epoch: 21, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.451 Vali Acc: 0.833 Test Loss: 0.451 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7590606212615967
Epoch: 22, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.438 Vali Acc: 0.841 Test Loss: 0.438 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 23 cost time: 0.6877312660217285
Epoch: 23, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.424 Vali Acc: 0.841 Test Loss: 0.424 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 24 cost time: 0.7241384983062744
Epoch: 24, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.442 Vali Acc: 0.848 Test Loss: 0.442 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 25 cost time: 0.6950874328613281
Epoch: 25, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.465 Vali Acc: 0.841 Test Loss: 0.465 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7332699298858643
Epoch: 26, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7144536972045898
Epoch: 27, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.427 Vali Acc: 0.848 Test Loss: 0.427 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 28 cost time: 0.7250850200653076
Epoch: 28, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.418 Vali Acc: 0.848 Test Loss: 0.418 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 29 cost time: 0.7209956645965576
Epoch: 29, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.420 Vali Acc: 0.848 Test Loss: 0.420 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6822724342346191
Epoch: 30, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.457 Vali Acc: 0.826 Test Loss: 0.457 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7709333896636963
Epoch: 31, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.475 Vali Acc: 0.833 Test Loss: 0.475 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.724003791809082
Epoch: 32, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.427 Vali Acc: 0.848 Test Loss: 0.427 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6944611072540283
Epoch: 33, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.442 Vali Acc: 0.855 Test Loss: 0.442 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 34 cost time: 0.719693660736084
Epoch: 34, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.412 Vali Acc: 0.855 Test Loss: 0.412 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 35 cost time: 0.73372483253479
Epoch: 35, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.437 Vali Acc: 0.855 Test Loss: 0.437 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7117288112640381
Epoch: 36, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.478 Vali Acc: 0.841 Test Loss: 0.478 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7404909133911133
Epoch: 37, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.463 Vali Acc: 0.848 Test Loss: 0.463 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7445876598358154
Epoch: 38, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.452 Vali Acc: 0.848 Test Loss: 0.452 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7283422946929932
Epoch: 39, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.440 Vali Acc: 0.855 Test Loss: 0.440 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7023541927337646
Epoch: 40, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.443 Vali Acc: 0.855 Test Loss: 0.443 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7247660160064697
Epoch: 41, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.437 Vali Acc: 0.848 Test Loss: 0.437 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7450542449951172
Epoch: 42, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.435 Vali Acc: 0.848 Test Loss: 0.435 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7460103034973145
Epoch: 43, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.521 Vali Acc: 0.833 Test Loss: 0.521 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.7154707908630371
Epoch: 44, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.568 Vali Acc: 0.819 Test Loss: 0.568 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 580740
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.306323528289795
Epoch: 1, Steps: 9 | Train Loss: 1.413 Vali Loss: 1.372 Vali Acc: 0.333 Test Loss: 1.372 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.6882064342498779
Epoch: 2, Steps: 9 | Train Loss: 1.372 Vali Loss: 1.346 Vali Acc: 0.391 Test Loss: 1.346 Test Acc: 0.391
Validation loss decreased (-0.333320 --> -0.391291).  Saving model ...
Epoch: 3 cost time: 0.7189390659332275
Epoch: 3, Steps: 9 | Train Loss: 1.303 Vali Loss: 1.297 Vali Acc: 0.500 Test Loss: 1.297 Test Acc: 0.500
Validation loss decreased (-0.391291 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.714057207107544
Epoch: 4, Steps: 9 | Train Loss: 1.226 Vali Loss: 1.234 Vali Acc: 0.580 Test Loss: 1.234 Test Acc: 0.580
Validation loss decreased (-0.499987 --> -0.579698).  Saving model ...
Epoch: 5 cost time: 0.690098762512207
Epoch: 5, Steps: 9 | Train Loss: 1.129 Vali Loss: 1.164 Vali Acc: 0.652 Test Loss: 1.164 Test Acc: 0.652
Validation loss decreased (-0.579698 --> -0.652162).  Saving model ...
Epoch: 6 cost time: 0.6813957691192627
Epoch: 6, Steps: 9 | Train Loss: 1.042 Vali Loss: 1.090 Vali Acc: 0.696 Test Loss: 1.090 Test Acc: 0.696
Validation loss decreased (-0.652162 --> -0.695641).  Saving model ...
Epoch: 7 cost time: 0.7266368865966797
Epoch: 7, Steps: 9 | Train Loss: 0.955 Vali Loss: 1.009 Vali Acc: 0.696 Test Loss: 1.009 Test Acc: 0.696
Validation loss decreased (-0.695641 --> -0.695642).  Saving model ...
Epoch: 8 cost time: 0.6805970668792725
Epoch: 8, Steps: 9 | Train Loss: 0.860 Vali Loss: 0.930 Vali Acc: 0.746 Test Loss: 0.930 Test Acc: 0.746
Validation loss decreased (-0.695642 --> -0.746368).  Saving model ...
Epoch: 9 cost time: 0.7379813194274902
Epoch: 9, Steps: 9 | Train Loss: 0.752 Vali Loss: 0.851 Vali Acc: 0.790 Test Loss: 0.851 Test Acc: 0.790
Validation loss decreased (-0.746368 --> -0.789847).  Saving model ...
Epoch: 10 cost time: 0.7302048206329346
Epoch: 10, Steps: 9 | Train Loss: 0.662 Vali Loss: 0.778 Vali Acc: 0.768 Test Loss: 0.778 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7264015674591064
Epoch: 11, Steps: 9 | Train Loss: 0.594 Vali Loss: 0.722 Vali Acc: 0.775 Test Loss: 0.722 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7579562664031982
Epoch: 12, Steps: 9 | Train Loss: 0.481 Vali Loss: 0.665 Vali Acc: 0.804 Test Loss: 0.665 Test Acc: 0.804
Validation loss decreased (-0.789847 --> -0.804341).  Saving model ...
Epoch: 13 cost time: 0.7067763805389404
Epoch: 13, Steps: 9 | Train Loss: 0.422 Vali Loss: 0.609 Vali Acc: 0.826 Test Loss: 0.609 Test Acc: 0.826
Validation loss decreased (-0.804341 --> -0.826081).  Saving model ...
Epoch: 14 cost time: 0.7026786804199219
Epoch: 14, Steps: 9 | Train Loss: 0.353 Vali Loss: 0.562 Vali Acc: 0.812 Test Loss: 0.562 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6546945571899414
Epoch: 15, Steps: 9 | Train Loss: 0.302 Vali Loss: 0.535 Vali Acc: 0.826 Test Loss: 0.535 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826082).  Saving model ...
Epoch: 16 cost time: 0.7349131107330322
Epoch: 16, Steps: 9 | Train Loss: 0.252 Vali Loss: 0.509 Vali Acc: 0.841 Test Loss: 0.509 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 17 cost time: 0.6718509197235107
Epoch: 17, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.467 Vali Acc: 0.848 Test Loss: 0.467 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 18 cost time: 0.6914749145507812
Epoch: 18, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.453 Vali Acc: 0.855 Test Loss: 0.453 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 19 cost time: 0.6928348541259766
Epoch: 19, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.437 Vali Acc: 0.855 Test Loss: 0.437 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 20 cost time: 0.7022950649261475
Epoch: 20, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.434 Vali Acc: 0.848 Test Loss: 0.434 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7329249382019043
Epoch: 21, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.417 Vali Acc: 0.855 Test Loss: 0.417 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 22 cost time: 0.7067582607269287
Epoch: 22, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.410 Vali Acc: 0.855 Test Loss: 0.410 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 23 cost time: 0.705481767654419
Epoch: 23, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.395 Vali Acc: 0.855 Test Loss: 0.395 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855069).  Saving model ...
Epoch: 24 cost time: 0.691502571105957
Epoch: 24, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.409 Vali Acc: 0.855 Test Loss: 0.409 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6865031719207764
Epoch: 25, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.421 Vali Acc: 0.848 Test Loss: 0.421 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6752867698669434
Epoch: 26, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.411 Vali Acc: 0.870 Test Loss: 0.411 Test Acc: 0.870
Validation loss decreased (-0.855069 --> -0.869561).  Saving model ...
Epoch: 27 cost time: 0.7194423675537109
Epoch: 27, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.409 Vali Acc: 0.848 Test Loss: 0.409 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6642394065856934
Epoch: 28, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.399 Vali Acc: 0.870 Test Loss: 0.399 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 29 cost time: 0.6993889808654785
Epoch: 29, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.388 Vali Acc: 0.877 Test Loss: 0.388 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 30 cost time: 0.6660983562469482
Epoch: 30, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7766368389129639
Epoch: 31, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.407 Vali Acc: 0.870 Test Loss: 0.407 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7156555652618408
Epoch: 32, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.408 Vali Acc: 0.870 Test Loss: 0.408 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6749987602233887
Epoch: 33, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.413 Vali Acc: 0.870 Test Loss: 0.413 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7181193828582764
Epoch: 34, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.404 Vali Acc: 0.862 Test Loss: 0.404 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7115640640258789
Epoch: 35, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.401 Vali Acc: 0.862 Test Loss: 0.401 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7115967273712158
Epoch: 36, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.370 Vali Acc: 0.877 Test Loss: 0.370 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 37 cost time: 0.724818229675293
Epoch: 37, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.371 Vali Acc: 0.891 Test Loss: 0.371 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 38 cost time: 0.7122857570648193
Epoch: 38, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.380 Vali Acc: 0.877 Test Loss: 0.380 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7838165760040283
Epoch: 39, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.383 Vali Acc: 0.870 Test Loss: 0.383 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8020455837249756
Epoch: 40, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.403 Vali Acc: 0.855 Test Loss: 0.403 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.912632942199707
Epoch: 41, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.424 Vali Acc: 0.855 Test Loss: 0.424 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7066802978515625
Epoch: 42, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.428 Vali Acc: 0.870 Test Loss: 0.428 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6956634521484375
Epoch: 43, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.411 Vali Acc: 0.877 Test Loss: 0.411 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.7289371490478516
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.426 Vali Acc: 0.870 Test Loss: 0.426 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.6590292453765869
Epoch: 45, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.435 Vali Acc: 0.877 Test Loss: 0.435 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.6891238689422607
Epoch: 46, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.436 Vali Acc: 0.891 Test Loss: 0.436 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.7209272384643555
Epoch: 47, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.435 Vali Acc: 0.891 Test Loss: 0.435 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 581092
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.186462163925171
Epoch: 1, Steps: 9 | Train Loss: 1.367 Vali Loss: 1.370 Vali Acc: 0.304 Test Loss: 1.370 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 0.7780814170837402
Epoch: 2, Steps: 9 | Train Loss: 1.332 Vali Loss: 1.348 Vali Acc: 0.362 Test Loss: 1.348 Test Acc: 0.362
Validation loss decreased (-0.304334 --> -0.362305).  Saving model ...
Epoch: 3 cost time: 0.6851565837860107
Epoch: 3, Steps: 9 | Train Loss: 1.295 Vali Loss: 1.306 Vali Acc: 0.413 Test Loss: 1.306 Test Acc: 0.413
Validation loss decreased (-0.362305 --> -0.413030).  Saving model ...
Epoch: 4 cost time: 0.7558708190917969
Epoch: 4, Steps: 9 | Train Loss: 1.193 Vali Loss: 1.252 Vali Acc: 0.449 Test Loss: 1.252 Test Acc: 0.449
Validation loss decreased (-0.413030 --> -0.449263).  Saving model ...
Epoch: 5 cost time: 0.7129733562469482
Epoch: 5, Steps: 9 | Train Loss: 1.124 Vali Loss: 1.192 Vali Acc: 0.493 Test Loss: 1.192 Test Acc: 0.493
Validation loss decreased (-0.449263 --> -0.492742).  Saving model ...
Epoch: 6 cost time: 0.7367215156555176
Epoch: 6, Steps: 9 | Train Loss: 1.045 Vali Loss: 1.123 Vali Acc: 0.551 Test Loss: 1.123 Test Acc: 0.551
Validation loss decreased (-0.492742 --> -0.550713).  Saving model ...
Epoch: 7 cost time: 0.7236340045928955
Epoch: 7, Steps: 9 | Train Loss: 0.964 Vali Loss: 1.061 Vali Acc: 0.601 Test Loss: 1.061 Test Acc: 0.601
Validation loss decreased (-0.550713 --> -0.601439).  Saving model ...
Epoch: 8 cost time: 0.7436330318450928
Epoch: 8, Steps: 9 | Train Loss: 0.877 Vali Loss: 1.002 Vali Acc: 0.659 Test Loss: 1.002 Test Acc: 0.659
Validation loss decreased (-0.601439 --> -0.659410).  Saving model ...
Epoch: 9 cost time: 0.7401869297027588
Epoch: 9, Steps: 9 | Train Loss: 0.793 Vali Loss: 0.938 Vali Acc: 0.667 Test Loss: 0.938 Test Acc: 0.667
Validation loss decreased (-0.659410 --> -0.666657).  Saving model ...
Epoch: 10 cost time: 0.7108747959136963
Epoch: 10, Steps: 9 | Train Loss: 0.709 Vali Loss: 0.876 Vali Acc: 0.688 Test Loss: 0.876 Test Acc: 0.688
Validation loss decreased (-0.666657 --> -0.688397).  Saving model ...
Epoch: 11 cost time: 0.7249407768249512
Epoch: 11, Steps: 9 | Train Loss: 0.646 Vali Loss: 0.823 Vali Acc: 0.717 Test Loss: 0.823 Test Acc: 0.717
Validation loss decreased (-0.688397 --> -0.717383).  Saving model ...
Epoch: 12 cost time: 0.6938378810882568
Epoch: 12, Steps: 9 | Train Loss: 0.563 Vali Loss: 0.771 Vali Acc: 0.739 Test Loss: 0.771 Test Acc: 0.739
Validation loss decreased (-0.717383 --> -0.739123).  Saving model ...
Epoch: 13 cost time: 0.8125481605529785
Epoch: 13, Steps: 9 | Train Loss: 0.488 Vali Loss: 0.715 Vali Acc: 0.761 Test Loss: 0.715 Test Acc: 0.761
Validation loss decreased (-0.739123 --> -0.760862).  Saving model ...
Epoch: 14 cost time: 0.8019537925720215
Epoch: 14, Steps: 9 | Train Loss: 0.424 Vali Loss: 0.687 Vali Acc: 0.761 Test Loss: 0.687 Test Acc: 0.761
Validation loss decreased (-0.760862 --> -0.760863).  Saving model ...
Epoch: 15 cost time: 0.7420647144317627
Epoch: 15, Steps: 9 | Train Loss: 0.357 Vali Loss: 0.659 Vali Acc: 0.775 Test Loss: 0.659 Test Acc: 0.775
Validation loss decreased (-0.760863 --> -0.775356).  Saving model ...
Epoch: 16 cost time: 0.7342710494995117
Epoch: 16, Steps: 9 | Train Loss: 0.313 Vali Loss: 0.628 Vali Acc: 0.790 Test Loss: 0.628 Test Acc: 0.790
Validation loss decreased (-0.775356 --> -0.789849).  Saving model ...
Epoch: 17 cost time: 0.7434906959533691
Epoch: 17, Steps: 9 | Train Loss: 0.281 Vali Loss: 0.599 Vali Acc: 0.790 Test Loss: 0.599 Test Acc: 0.790
Validation loss decreased (-0.789849 --> -0.789849).  Saving model ...
Epoch: 18 cost time: 0.7521343231201172
Epoch: 18, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.592 Vali Acc: 0.790 Test Loss: 0.592 Test Acc: 0.790
Validation loss decreased (-0.789849 --> -0.789849).  Saving model ...
Epoch: 19 cost time: 0.8122177124023438
Epoch: 19, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.586 Vali Acc: 0.804 Test Loss: 0.586 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804342).  Saving model ...
Epoch: 20 cost time: 0.7572183609008789
Epoch: 20, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.557 Vali Acc: 0.797 Test Loss: 0.557 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.775146484375
Epoch: 21, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.561 Vali Acc: 0.804 Test Loss: 0.561 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 22 cost time: 0.8039708137512207
Epoch: 22, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.544 Vali Acc: 0.797 Test Loss: 0.544 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.718299388885498
Epoch: 23, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.558 Vali Acc: 0.797 Test Loss: 0.558 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7140817642211914
Epoch: 24, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.563 Vali Acc: 0.804 Test Loss: 0.563 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8116254806518555
Epoch: 25, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.578 Vali Acc: 0.797 Test Loss: 0.578 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7513904571533203
Epoch: 26, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.609 Vali Acc: 0.797 Test Loss: 0.609 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7612113952636719
Epoch: 27, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.597 Vali Acc: 0.797 Test Loss: 0.597 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7238695621490479
Epoch: 28, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.589 Vali Acc: 0.804 Test Loss: 0.589 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.787879228591919
Epoch: 29, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.591 Vali Acc: 0.804 Test Loss: 0.591 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7756597995758057
Epoch: 30, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.584 Vali Acc: 0.797 Test Loss: 0.584 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.682349681854248
Epoch: 31, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.588 Vali Acc: 0.768 Test Loss: 0.588 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8043478260869565
model parameter : 579876
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0716891288757324
Epoch: 1, Steps: 9 | Train Loss: 1.371 Vali Loss: 1.356 Vali Acc: 0.341 Test Loss: 1.356 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 0.8120293617248535
Epoch: 2, Steps: 9 | Train Loss: 1.246 Vali Loss: 1.262 Vali Acc: 0.543 Test Loss: 1.262 Test Acc: 0.543
Validation loss decreased (-0.340566 --> -0.543466).  Saving model ...
Epoch: 3 cost time: 0.7310657501220703
Epoch: 3, Steps: 9 | Train Loss: 1.084 Vali Loss: 1.101 Vali Acc: 0.739 Test Loss: 1.101 Test Acc: 0.739
Validation loss decreased (-0.543466 --> -0.739119).  Saving model ...
Epoch: 4 cost time: 0.7966814041137695
Epoch: 4, Steps: 9 | Train Loss: 0.892 Vali Loss: 0.916 Vali Acc: 0.790 Test Loss: 0.916 Test Acc: 0.790
Validation loss decreased (-0.739119 --> -0.789846).  Saving model ...
Epoch: 5 cost time: 0.7488930225372314
Epoch: 5, Steps: 9 | Train Loss: 0.690 Vali Loss: 0.727 Vali Acc: 0.826 Test Loss: 0.727 Test Acc: 0.826
Validation loss decreased (-0.789846 --> -0.826080).  Saving model ...
Epoch: 6 cost time: 0.8202648162841797
Epoch: 6, Steps: 9 | Train Loss: 0.500 Vali Loss: 0.565 Vali Acc: 0.870 Test Loss: 0.565 Test Acc: 0.870
Validation loss decreased (-0.826080 --> -0.869560).  Saving model ...
Epoch: 7 cost time: 0.8299214839935303
Epoch: 7, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.437 Vali Acc: 0.891 Test Loss: 0.437 Test Acc: 0.891
Validation loss decreased (-0.869560 --> -0.891300).  Saving model ...
Epoch: 8 cost time: 0.8711600303649902
Epoch: 8, Steps: 9 | Train Loss: 0.228 Vali Loss: 0.346 Vali Acc: 0.913 Test Loss: 0.346 Test Acc: 0.913
Validation loss decreased (-0.891300 --> -0.913040).  Saving model ...
Epoch: 9 cost time: 0.8482155799865723
Epoch: 9, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.288 Vali Acc: 0.920 Test Loss: 0.288 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 10 cost time: 0.8035809993743896
Epoch: 10, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.257 Vali Acc: 0.935 Test Loss: 0.257 Test Acc: 0.935
Validation loss decreased (-0.920287 --> -0.934780).  Saving model ...
Epoch: 11 cost time: 0.8692405223846436
Epoch: 11, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.243 Vali Acc: 0.928 Test Loss: 0.243 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8567252159118652
Epoch: 12, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.230 Vali Acc: 0.935 Test Loss: 0.230 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 13 cost time: 0.9765915870666504
Epoch: 13, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.211 Vali Acc: 0.942 Test Loss: 0.211 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 14 cost time: 0.8523972034454346
Epoch: 14, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.205 Vali Acc: 0.942 Test Loss: 0.205 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 15 cost time: 0.8327116966247559
Epoch: 15, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.209 Vali Acc: 0.928 Test Loss: 0.209 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9333236217498779
Epoch: 16, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7808372974395752
Epoch: 17, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.196 Vali Acc: 0.935 Test Loss: 0.196 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7975561618804932
Epoch: 18, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.185 Vali Acc: 0.935 Test Loss: 0.185 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8932278156280518
Epoch: 19, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.190 Vali Acc: 0.935 Test Loss: 0.190 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7981209754943848
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8149368762969971
Epoch: 21, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.172 Vali Acc: 0.935 Test Loss: 0.172 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.800560712814331
Epoch: 22, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949274).  Saving model ...
Epoch: 23 cost time: 0.822730302810669
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.169 Vali Acc: 0.942 Test Loss: 0.169 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8854765892028809
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.177 Vali Acc: 0.928 Test Loss: 0.177 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9086074829101562
Epoch: 25, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.190 Vali Acc: 0.935 Test Loss: 0.190 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8885853290557861
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.182 Vali Acc: 0.942 Test Loss: 0.182 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8765857219696045
Epoch: 27, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.180 Vali Acc: 0.935 Test Loss: 0.180 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8715999126434326
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.935 Test Loss: 0.182 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9057717323303223
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.935 Test Loss: 0.175 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7756893634796143
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.928 Test Loss: 0.177 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.784470796585083
Epoch: 31, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.928 Test Loss: 0.182 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8658614158630371
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.928 Test Loss: 0.191 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 598756
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1861517429351807
Epoch: 1, Steps: 9 | Train Loss: 1.390 Vali Loss: 1.358 Vali Acc: 0.413 Test Loss: 1.358 Test Acc: 0.413
Validation loss decreased (inf --> -0.413030).  Saving model ...
Epoch: 2 cost time: 0.749234676361084
Epoch: 2, Steps: 9 | Train Loss: 1.308 Vali Loss: 1.301 Vali Acc: 0.543 Test Loss: 1.301 Test Acc: 0.543
Validation loss decreased (-0.413030 --> -0.543465).  Saving model ...
Epoch: 3 cost time: 0.7631895542144775
Epoch: 3, Steps: 9 | Train Loss: 1.197 Vali Loss: 1.201 Vali Acc: 0.674 Test Loss: 1.201 Test Acc: 0.674
Validation loss decreased (-0.543465 --> -0.673901).  Saving model ...
Epoch: 4 cost time: 0.7530562877655029
Epoch: 4, Steps: 9 | Train Loss: 1.081 Vali Loss: 1.087 Vali Acc: 0.768 Test Loss: 1.087 Test Acc: 0.768
Validation loss decreased (-0.673901 --> -0.768105).  Saving model ...
Epoch: 5 cost time: 0.8066267967224121
Epoch: 5, Steps: 9 | Train Loss: 0.932 Vali Loss: 0.955 Vali Acc: 0.833 Test Loss: 0.955 Test Acc: 0.833
Validation loss decreased (-0.768105 --> -0.833324).  Saving model ...
Epoch: 6 cost time: 0.7601301670074463
Epoch: 6, Steps: 9 | Train Loss: 0.804 Vali Loss: 0.813 Vali Acc: 0.848 Test Loss: 0.813 Test Acc: 0.848
Validation loss decreased (-0.833324 --> -0.847818).  Saving model ...
Epoch: 7 cost time: 0.8169777393341064
Epoch: 7, Steps: 9 | Train Loss: 0.636 Vali Loss: 0.681 Vali Acc: 0.855 Test Loss: 0.681 Test Acc: 0.855
Validation loss decreased (-0.847818 --> -0.855066).  Saving model ...
Epoch: 8 cost time: 0.7652888298034668
Epoch: 8, Steps: 9 | Train Loss: 0.503 Vali Loss: 0.564 Vali Acc: 0.870 Test Loss: 0.564 Test Acc: 0.870
Validation loss decreased (-0.855066 --> -0.869560).  Saving model ...
Epoch: 9 cost time: 0.7680408954620361
Epoch: 9, Steps: 9 | Train Loss: 0.390 Vali Loss: 0.474 Vali Acc: 0.884 Test Loss: 0.474 Test Acc: 0.884
Validation loss decreased (-0.869560 --> -0.884053).  Saving model ...
Epoch: 10 cost time: 0.7662773132324219
Epoch: 10, Steps: 9 | Train Loss: 0.297 Vali Loss: 0.407 Vali Acc: 0.891 Test Loss: 0.407 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891300).  Saving model ...
Epoch: 11 cost time: 0.7536571025848389
Epoch: 11, Steps: 9 | Train Loss: 0.205 Vali Loss: 0.340 Vali Acc: 0.913 Test Loss: 0.340 Test Acc: 0.913
Validation loss decreased (-0.891300 --> -0.913040).  Saving model ...
Epoch: 12 cost time: 0.8265106678009033
Epoch: 12, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.303 Vali Acc: 0.920 Test Loss: 0.303 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 13 cost time: 0.8203322887420654
Epoch: 13, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.281 Vali Acc: 0.935 Test Loss: 0.281 Test Acc: 0.935
Validation loss decreased (-0.920287 --> -0.934780).  Saving model ...
Epoch: 14 cost time: 0.719393253326416
Epoch: 14, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.274 Vali Acc: 0.942 Test Loss: 0.274 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942026).  Saving model ...
Epoch: 15 cost time: 0.8296618461608887
Epoch: 15, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.250 Vali Acc: 0.942 Test Loss: 0.250 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 16 cost time: 0.8438730239868164
Epoch: 16, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.250 Vali Acc: 0.942 Test Loss: 0.250 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7072739601135254
Epoch: 17, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.241 Vali Acc: 0.942 Test Loss: 0.241 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 18 cost time: 0.8138875961303711
Epoch: 18, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.233 Vali Acc: 0.942 Test Loss: 0.233 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 19 cost time: 0.8361287117004395
Epoch: 19, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.224 Vali Acc: 0.942 Test Loss: 0.224 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 20 cost time: 0.8216288089752197
Epoch: 20, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.219 Vali Acc: 0.942 Test Loss: 0.219 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 21 cost time: 0.7421329021453857
Epoch: 21, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.217 Vali Acc: 0.935 Test Loss: 0.217 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8362216949462891
Epoch: 22, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.212 Vali Acc: 0.942 Test Loss: 0.212 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 23 cost time: 0.9216301441192627
Epoch: 23, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.912883996963501
Epoch: 24, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.214 Vali Acc: 0.942 Test Loss: 0.214 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8876838684082031
Epoch: 25, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.203 Vali Acc: 0.942 Test Loss: 0.203 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 26 cost time: 0.8042247295379639
Epoch: 26, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.198 Vali Acc: 0.935 Test Loss: 0.198 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7652525901794434
Epoch: 27, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8590350151062012
Epoch: 28, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9291965961456299
Epoch: 29, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.196 Vali Acc: 0.942 Test Loss: 0.196 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 30 cost time: 0.8801906108856201
Epoch: 30, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.178 Vali Acc: 0.935 Test Loss: 0.178 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8549396991729736
Epoch: 31, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.177 Vali Acc: 0.935 Test Loss: 0.177 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9531891345977783
Epoch: 32, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.169 Vali Acc: 0.935 Test Loss: 0.169 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9277942180633545
Epoch: 33, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.174 Vali Acc: 0.935 Test Loss: 0.174 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8754010200500488
Epoch: 34, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.935 Test Loss: 0.174 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7687938213348389
Epoch: 35, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.179 Vali Acc: 0.935 Test Loss: 0.179 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7249658107757568
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.163 Vali Acc: 0.935 Test Loss: 0.163 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9036059379577637
Epoch: 37, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.159 Vali Acc: 0.942 Test Loss: 0.159 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 38 cost time: 0.8971965312957764
Epoch: 38, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.935 Test Loss: 0.174 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8815650939941406
Epoch: 39, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.935 Test Loss: 0.165 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.897303581237793
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.173 Vali Acc: 0.935 Test Loss: 0.173 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8398830890655518
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.158 Vali Acc: 0.942 Test Loss: 0.158 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 42 cost time: 0.9236981868743896
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949274).  Saving model ...
Epoch: 43 cost time: 0.8798646926879883
Epoch: 43, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.942 Test Loss: 0.166 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9076664447784424
Epoch: 44, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.210 Vali Acc: 0.920 Test Loss: 0.210 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8006584644317627
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.920 Test Loss: 0.229 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8306481838226318
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.935 Test Loss: 0.177 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.9034311771392822
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
Validation loss decreased (-0.949274 --> -0.956520).  Saving model ...
Epoch: 48 cost time: 0.7801063060760498
Epoch: 48, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
Validation loss decreased (-0.956520 --> -0.956520).  Saving model ...
Epoch: 49 cost time: 0.7719299793243408
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9536962509155273
Epoch: 50, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.935 Test Loss: 0.176 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9565217391304348
model parameter : 586628
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8933861255645752
Epoch: 1, Steps: 9 | Train Loss: 1.399 Vali Loss: 1.377 Vali Acc: 0.297 Test Loss: 1.377 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 0.7339823246002197
Epoch: 2, Steps: 9 | Train Loss: 1.317 Vali Loss: 1.318 Vali Acc: 0.464 Test Loss: 1.318 Test Acc: 0.464
Validation loss decreased (-0.297088 --> -0.463755).  Saving model ...
Epoch: 3 cost time: 0.7774686813354492
Epoch: 3, Steps: 9 | Train Loss: 1.206 Vali Loss: 1.219 Vali Acc: 0.609 Test Loss: 1.219 Test Acc: 0.609
Validation loss decreased (-0.463755 --> -0.608683).  Saving model ...
Epoch: 4 cost time: 0.7374765872955322
Epoch: 4, Steps: 9 | Train Loss: 1.098 Vali Loss: 1.099 Vali Acc: 0.703 Test Loss: 1.099 Test Acc: 0.703
Validation loss decreased (-0.608683 --> -0.702888).  Saving model ...
Epoch: 5 cost time: 0.7575352191925049
Epoch: 5, Steps: 9 | Train Loss: 0.953 Vali Loss: 0.976 Vali Acc: 0.754 Test Loss: 0.976 Test Acc: 0.754
Validation loss decreased (-0.702888 --> -0.753613).  Saving model ...
Epoch: 6 cost time: 0.7458083629608154
Epoch: 6, Steps: 9 | Train Loss: 0.822 Vali Loss: 0.860 Vali Acc: 0.790 Test Loss: 0.860 Test Acc: 0.790
Validation loss decreased (-0.753613 --> -0.789846).  Saving model ...
Epoch: 7 cost time: 0.7811048030853271
Epoch: 7, Steps: 9 | Train Loss: 0.679 Vali Loss: 0.750 Vali Acc: 0.797 Test Loss: 0.750 Test Acc: 0.797
Validation loss decreased (-0.789846 --> -0.797094).  Saving model ...
Epoch: 8 cost time: 0.8192856311798096
Epoch: 8, Steps: 9 | Train Loss: 0.566 Vali Loss: 0.656 Vali Acc: 0.812 Test Loss: 0.656 Test Acc: 0.812
Validation loss decreased (-0.797094 --> -0.811588).  Saving model ...
Epoch: 9 cost time: 0.7656455039978027
Epoch: 9, Steps: 9 | Train Loss: 0.451 Vali Loss: 0.578 Vali Acc: 0.841 Test Loss: 0.578 Test Acc: 0.841
Validation loss decreased (-0.811588 --> -0.840574).  Saving model ...
Epoch: 10 cost time: 0.7775945663452148
Epoch: 10, Steps: 9 | Train Loss: 0.362 Vali Loss: 0.518 Vali Acc: 0.855 Test Loss: 0.518 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855067).  Saving model ...
Epoch: 11 cost time: 0.7767391204833984
Epoch: 11, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.466 Vali Acc: 0.884 Test Loss: 0.466 Test Acc: 0.884
Validation loss decreased (-0.855067 --> -0.884053).  Saving model ...
Epoch: 12 cost time: 0.8094267845153809
Epoch: 12, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.416 Vali Acc: 0.891 Test Loss: 0.416 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891300).  Saving model ...
Epoch: 13 cost time: 0.7244341373443604
Epoch: 13, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.383 Vali Acc: 0.891 Test Loss: 0.383 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891301).  Saving model ...
Epoch: 14 cost time: 0.7699828147888184
Epoch: 14, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.374 Vali Acc: 0.899 Test Loss: 0.374 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 15 cost time: 0.7004075050354004
Epoch: 15, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.351 Vali Acc: 0.899 Test Loss: 0.351 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 16 cost time: 0.8231308460235596
Epoch: 16, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.337 Vali Acc: 0.899 Test Loss: 0.337 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 17 cost time: 0.7614986896514893
Epoch: 17, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.321 Vali Acc: 0.899 Test Loss: 0.321 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898548).  Saving model ...
Epoch: 18 cost time: 0.7547979354858398
Epoch: 18, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.323 Vali Acc: 0.906 Test Loss: 0.323 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 19 cost time: 0.7286937236785889
Epoch: 19, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.324 Vali Acc: 0.899 Test Loss: 0.324 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7738335132598877
Epoch: 20, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.313 Vali Acc: 0.899 Test Loss: 0.313 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7269861698150635
Epoch: 21, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.290 Vali Acc: 0.906 Test Loss: 0.290 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 22 cost time: 0.7522072792053223
Epoch: 22, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.279 Vali Acc: 0.906 Test Loss: 0.279 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 23 cost time: 0.7626943588256836
Epoch: 23, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.307 Vali Acc: 0.906 Test Loss: 0.307 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7608742713928223
Epoch: 24, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.301 Vali Acc: 0.913 Test Loss: 0.301 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 25 cost time: 0.763146162033081
Epoch: 25, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.285 Vali Acc: 0.913 Test Loss: 0.285 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913041).  Saving model ...
Epoch: 26 cost time: 0.7556159496307373
Epoch: 26, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.277 Vali Acc: 0.913 Test Loss: 0.277 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 27 cost time: 0.7486324310302734
Epoch: 27, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.284 Vali Acc: 0.899 Test Loss: 0.284 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7991397380828857
Epoch: 28, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.286 Vali Acc: 0.906 Test Loss: 0.286 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8005523681640625
Epoch: 29, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.292 Vali Acc: 0.913 Test Loss: 0.292 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8089621067047119
Epoch: 30, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.274 Vali Acc: 0.913 Test Loss: 0.274 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 31 cost time: 0.7632460594177246
Epoch: 31, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.275 Vali Acc: 0.913 Test Loss: 0.275 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7866528034210205
Epoch: 32, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.264 Vali Acc: 0.913 Test Loss: 0.264 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 33 cost time: 0.7466719150543213
Epoch: 33, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7727930545806885
Epoch: 34, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7282280921936035
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.226 Vali Acc: 0.920 Test Loss: 0.226 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920288).  Saving model ...
Epoch: 36 cost time: 0.8022899627685547
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.221 Vali Acc: 0.920 Test Loss: 0.221 Test Acc: 0.920
Validation loss decreased (-0.920288 --> -0.920288).  Saving model ...
Epoch: 37 cost time: 0.7862870693206787
Epoch: 37, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.246 Vali Acc: 0.913 Test Loss: 0.246 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7985467910766602
Epoch: 38, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.251 Vali Acc: 0.913 Test Loss: 0.251 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7276556491851807
Epoch: 39, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.260 Vali Acc: 0.913 Test Loss: 0.260 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7761144638061523
Epoch: 40, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.261 Vali Acc: 0.913 Test Loss: 0.261 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8493125438690186
Epoch: 41, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.269 Vali Acc: 0.913 Test Loss: 0.269 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7884566783905029
Epoch: 42, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.266 Vali Acc: 0.913 Test Loss: 0.266 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.7092232704162598
Epoch: 43, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.234 Vali Acc: 0.920 Test Loss: 0.234 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.7944257259368896
Epoch: 44, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.236 Vali Acc: 0.920 Test Loss: 0.236 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.7405774593353271
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.831383228302002
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.270 Vali Acc: 0.913 Test Loss: 0.270 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 583716
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1226236820220947
Epoch: 1, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.398 Vali Acc: 0.268 Test Loss: 1.398 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 0.7184419631958008
Epoch: 2, Steps: 9 | Train Loss: 1.358 Vali Loss: 1.375 Vali Acc: 0.297 Test Loss: 1.375 Test Acc: 0.297
Validation loss decreased (-0.268102 --> -0.297088).  Saving model ...
Epoch: 3 cost time: 0.8156008720397949
Epoch: 3, Steps: 9 | Train Loss: 1.285 Vali Loss: 1.323 Vali Acc: 0.377 Test Loss: 1.323 Test Acc: 0.377
Validation loss decreased (-0.297088 --> -0.376798).  Saving model ...
Epoch: 4 cost time: 0.7740821838378906
Epoch: 4, Steps: 9 | Train Loss: 1.184 Vali Loss: 1.252 Vali Acc: 0.486 Test Loss: 1.252 Test Acc: 0.486
Validation loss decreased (-0.376798 --> -0.485495).  Saving model ...
Epoch: 5 cost time: 0.8300018310546875
Epoch: 5, Steps: 9 | Train Loss: 1.099 Vali Loss: 1.166 Vali Acc: 0.594 Test Loss: 1.166 Test Acc: 0.594
Validation loss decreased (-0.485495 --> -0.594191).  Saving model ...
Epoch: 6 cost time: 0.7462639808654785
Epoch: 6, Steps: 9 | Train Loss: 0.997 Vali Loss: 1.083 Vali Acc: 0.703 Test Loss: 1.083 Test Acc: 0.703
Validation loss decreased (-0.594191 --> -0.702888).  Saving model ...
Epoch: 7 cost time: 0.7942755222320557
Epoch: 7, Steps: 9 | Train Loss: 0.870 Vali Loss: 0.991 Vali Acc: 0.732 Test Loss: 0.991 Test Acc: 0.732
Validation loss decreased (-0.702888 --> -0.731874).  Saving model ...
Epoch: 8 cost time: 0.8141834735870361
Epoch: 8, Steps: 9 | Train Loss: 0.753 Vali Loss: 0.894 Vali Acc: 0.746 Test Loss: 0.894 Test Acc: 0.746
Validation loss decreased (-0.731874 --> -0.746368).  Saving model ...
Epoch: 9 cost time: 0.8009202480316162
Epoch: 9, Steps: 9 | Train Loss: 0.631 Vali Loss: 0.794 Vali Acc: 0.783 Test Loss: 0.794 Test Acc: 0.783
Validation loss decreased (-0.746368 --> -0.782601).  Saving model ...
Epoch: 10 cost time: 0.7892699241638184
Epoch: 10, Steps: 9 | Train Loss: 0.535 Vali Loss: 0.720 Vali Acc: 0.775 Test Loss: 0.720 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8566133975982666
Epoch: 11, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.635 Vali Acc: 0.790 Test Loss: 0.635 Test Acc: 0.790
Validation loss decreased (-0.782601 --> -0.789849).  Saving model ...
Epoch: 12 cost time: 0.7786822319030762
Epoch: 12, Steps: 9 | Train Loss: 0.362 Vali Loss: 0.580 Vali Acc: 0.819 Test Loss: 0.580 Test Acc: 0.819
Validation loss decreased (-0.789849 --> -0.818835).  Saving model ...
Epoch: 13 cost time: 0.8298952579498291
Epoch: 13, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.533 Vali Acc: 0.826 Test Loss: 0.533 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 14 cost time: 0.8306381702423096
Epoch: 14, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 15 cost time: 0.7519345283508301
Epoch: 15, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.470 Vali Acc: 0.848 Test Loss: 0.470 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 16 cost time: 0.7877712249755859
Epoch: 16, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.455 Vali Acc: 0.841 Test Loss: 0.455 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.835517406463623
Epoch: 17, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.434 Vali Acc: 0.848 Test Loss: 0.434 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 18 cost time: 0.839972734451294
Epoch: 18, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.430 Vali Acc: 0.841 Test Loss: 0.430 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8297669887542725
Epoch: 19, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.402 Vali Acc: 0.841 Test Loss: 0.402 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8554010391235352
Epoch: 20, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.398 Vali Acc: 0.855 Test Loss: 0.398 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 21 cost time: 0.8593082427978516
Epoch: 21, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.391 Vali Acc: 0.848 Test Loss: 0.391 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8450961112976074
Epoch: 22, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.383 Vali Acc: 0.848 Test Loss: 0.383 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8710541725158691
Epoch: 23, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.376 Vali Acc: 0.862 Test Loss: 0.376 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 24 cost time: 0.8462567329406738
Epoch: 24, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.353 Vali Acc: 0.862 Test Loss: 0.353 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 25 cost time: 0.8243722915649414
Epoch: 25, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.377 Vali Acc: 0.855 Test Loss: 0.377 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9063189029693604
Epoch: 26, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.360 Vali Acc: 0.862 Test Loss: 0.360 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8392825126647949
Epoch: 27, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.374 Vali Acc: 0.855 Test Loss: 0.374 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8065454959869385
Epoch: 28, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.387 Vali Acc: 0.848 Test Loss: 0.387 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7934083938598633
Epoch: 29, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.365 Vali Acc: 0.862 Test Loss: 0.365 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8010909557342529
Epoch: 30, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.351 Vali Acc: 0.877 Test Loss: 0.351 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 31 cost time: 0.8457868099212646
Epoch: 31, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.330 Vali Acc: 0.870 Test Loss: 0.330 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8648076057434082
Epoch: 32, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.321 Vali Acc: 0.877 Test Loss: 0.321 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 33 cost time: 0.8096117973327637
Epoch: 33, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.332 Vali Acc: 0.870 Test Loss: 0.332 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8312990665435791
Epoch: 34, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.340 Vali Acc: 0.862 Test Loss: 0.340 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6481733322143555
Epoch: 35, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.387 Vali Acc: 0.870 Test Loss: 0.387 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8754117488861084
Epoch: 36, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.385 Vali Acc: 0.884 Test Loss: 0.385 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 37 cost time: 0.8977546691894531
Epoch: 37, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.364 Vali Acc: 0.891 Test Loss: 0.364 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 38 cost time: 0.9055502414703369
Epoch: 38, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.361 Vali Acc: 0.891 Test Loss: 0.361 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 39 cost time: 0.854517936706543
Epoch: 39, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.364 Vali Acc: 0.884 Test Loss: 0.364 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8491218090057373
Epoch: 40, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.348 Vali Acc: 0.884 Test Loss: 0.348 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8194172382354736
Epoch: 41, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.341 Vali Acc: 0.884 Test Loss: 0.341 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.869149923324585
Epoch: 42, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.338 Vali Acc: 0.877 Test Loss: 0.338 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.8488385677337646
Epoch: 43, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.311 Vali Acc: 0.877 Test Loss: 0.311 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8109638690948486
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.329 Vali Acc: 0.877 Test Loss: 0.329 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.8957014083862305
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.320 Vali Acc: 0.877 Test Loss: 0.320 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.812741756439209
Epoch: 46, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.346 Vali Acc: 0.877 Test Loss: 0.346 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.7827355861663818
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.360 Vali Acc: 0.884 Test Loss: 0.360 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.8141229152679443
Epoch: 48, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.346 Vali Acc: 0.884 Test Loss: 0.346 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 580804
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.060492753982544
Epoch: 1, Steps: 9 | Train Loss: 1.398 Vali Loss: 1.361 Vali Acc: 0.304 Test Loss: 1.361 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 0.748105525970459
Epoch: 2, Steps: 9 | Train Loss: 1.362 Vali Loss: 1.328 Vali Acc: 0.341 Test Loss: 1.328 Test Acc: 0.341
Validation loss decreased (-0.304334 --> -0.340566).  Saving model ...
Epoch: 3 cost time: 0.7261924743652344
Epoch: 3, Steps: 9 | Train Loss: 1.295 Vali Loss: 1.271 Vali Acc: 0.399 Test Loss: 1.271 Test Acc: 0.399
Validation loss decreased (-0.340566 --> -0.398538).  Saving model ...
Epoch: 4 cost time: 0.7162652015686035
Epoch: 4, Steps: 9 | Train Loss: 1.228 Vali Loss: 1.199 Vali Acc: 0.529 Test Loss: 1.199 Test Acc: 0.529
Validation loss decreased (-0.398538 --> -0.528974).  Saving model ...
Epoch: 5 cost time: 0.6832270622253418
Epoch: 5, Steps: 9 | Train Loss: 1.124 Vali Loss: 1.130 Vali Acc: 0.572 Test Loss: 1.130 Test Acc: 0.572
Validation loss decreased (-0.528974 --> -0.572452).  Saving model ...
Epoch: 6 cost time: 0.758974552154541
Epoch: 6, Steps: 9 | Train Loss: 1.046 Vali Loss: 1.055 Vali Acc: 0.616 Test Loss: 1.055 Test Acc: 0.616
Validation loss decreased (-0.572452 --> -0.615931).  Saving model ...
Epoch: 7 cost time: 0.713371753692627
Epoch: 7, Steps: 9 | Train Loss: 0.935 Vali Loss: 0.977 Vali Acc: 0.667 Test Loss: 0.977 Test Acc: 0.667
Validation loss decreased (-0.615931 --> -0.666657).  Saving model ...
Epoch: 8 cost time: 0.8068320751190186
Epoch: 8, Steps: 9 | Train Loss: 0.848 Vali Loss: 0.893 Vali Acc: 0.688 Test Loss: 0.893 Test Acc: 0.688
Validation loss decreased (-0.666657 --> -0.688397).  Saving model ...
Epoch: 9 cost time: 0.745058536529541
Epoch: 9, Steps: 9 | Train Loss: 0.756 Vali Loss: 0.810 Vali Acc: 0.746 Test Loss: 0.810 Test Acc: 0.746
Validation loss decreased (-0.688397 --> -0.746369).  Saving model ...
Epoch: 10 cost time: 0.6912283897399902
Epoch: 10, Steps: 9 | Train Loss: 0.666 Vali Loss: 0.748 Vali Acc: 0.790 Test Loss: 0.748 Test Acc: 0.790
Validation loss decreased (-0.746369 --> -0.789848).  Saving model ...
Epoch: 11 cost time: 0.7942261695861816
Epoch: 11, Steps: 9 | Train Loss: 0.550 Vali Loss: 0.678 Vali Acc: 0.819 Test Loss: 0.678 Test Acc: 0.819
Validation loss decreased (-0.789848 --> -0.818834).  Saving model ...
Epoch: 12 cost time: 0.7435705661773682
Epoch: 12, Steps: 9 | Train Loss: 0.509 Vali Loss: 0.623 Vali Acc: 0.826 Test Loss: 0.623 Test Acc: 0.826
Validation loss decreased (-0.818834 --> -0.826081).  Saving model ...
Epoch: 13 cost time: 0.7489991188049316
Epoch: 13, Steps: 9 | Train Loss: 0.409 Vali Loss: 0.568 Vali Acc: 0.841 Test Loss: 0.568 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 14 cost time: 0.7693135738372803
Epoch: 14, Steps: 9 | Train Loss: 0.350 Vali Loss: 0.541 Vali Acc: 0.841 Test Loss: 0.541 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 15 cost time: 0.7383954524993896
Epoch: 15, Steps: 9 | Train Loss: 0.303 Vali Loss: 0.500 Vali Acc: 0.848 Test Loss: 0.500 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 16 cost time: 0.7867095470428467
Epoch: 16, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.473 Vali Acc: 0.862 Test Loss: 0.473 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 17 cost time: 0.7064812183380127
Epoch: 17, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.438 Vali Acc: 0.877 Test Loss: 0.438 Test Acc: 0.877
Validation loss decreased (-0.862314 --> -0.876807).  Saving model ...
Epoch: 18 cost time: 0.7530715465545654
Epoch: 18, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.420 Vali Acc: 0.870 Test Loss: 0.420 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8253519535064697
Epoch: 19, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.398 Vali Acc: 0.870 Test Loss: 0.398 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8428554534912109
Epoch: 20, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.390 Vali Acc: 0.877 Test Loss: 0.390 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876808).  Saving model ...
Epoch: 21 cost time: 0.7308485507965088
Epoch: 21, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.373 Vali Acc: 0.870 Test Loss: 0.373 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.76413893699646
Epoch: 22, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.375 Vali Acc: 0.870 Test Loss: 0.375 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7865400314331055
Epoch: 23, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.379 Vali Acc: 0.870 Test Loss: 0.379 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7198202610015869
Epoch: 24, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.324 Vali Acc: 0.884 Test Loss: 0.324 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 25 cost time: 0.7191319465637207
Epoch: 25, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.330 Vali Acc: 0.870 Test Loss: 0.330 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.788792610168457
Epoch: 26, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.326 Vali Acc: 0.870 Test Loss: 0.326 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7927370071411133
Epoch: 27, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.332 Vali Acc: 0.870 Test Loss: 0.332 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8029160499572754
Epoch: 28, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.337 Vali Acc: 0.877 Test Loss: 0.337 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7560145854949951
Epoch: 29, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.349 Vali Acc: 0.884 Test Loss: 0.349 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7186291217803955
Epoch: 30, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.338 Vali Acc: 0.877 Test Loss: 0.338 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7111213207244873
Epoch: 31, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.362 Vali Acc: 0.870 Test Loss: 0.362 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6986758708953857
Epoch: 32, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.309 Vali Acc: 0.877 Test Loss: 0.309 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7581994533538818
Epoch: 33, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.334 Vali Acc: 0.884 Test Loss: 0.334 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7544815540313721
Epoch: 34, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 578052
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.097409725189209
Epoch: 1, Steps: 9 | Train Loss: 1.423 Vali Loss: 1.405 Vali Acc: 0.145 Test Loss: 1.405 Test Acc: 0.145
Validation loss decreased (inf --> -0.144913).  Saving model ...
Epoch: 2 cost time: 0.7458469867706299
Epoch: 2, Steps: 9 | Train Loss: 1.396 Vali Loss: 1.387 Vali Acc: 0.261 Test Loss: 1.387 Test Acc: 0.261
Validation loss decreased (-0.144913 --> -0.260856).  Saving model ...
Epoch: 3 cost time: 0.7615296840667725
Epoch: 3, Steps: 9 | Train Loss: 1.329 Vali Loss: 1.340 Vali Acc: 0.370 Test Loss: 1.340 Test Acc: 0.370
Validation loss decreased (-0.260856 --> -0.369552).  Saving model ...
Epoch: 4 cost time: 0.791903018951416
Epoch: 4, Steps: 9 | Train Loss: 1.245 Vali Loss: 1.280 Vali Acc: 0.449 Test Loss: 1.280 Test Acc: 0.449
Validation loss decreased (-0.369552 --> -0.449263).  Saving model ...
Epoch: 5 cost time: 0.7589542865753174
Epoch: 5, Steps: 9 | Train Loss: 1.171 Vali Loss: 1.207 Vali Acc: 0.572 Test Loss: 1.207 Test Acc: 0.572
Validation loss decreased (-0.449263 --> -0.572452).  Saving model ...
Epoch: 6 cost time: 0.7792439460754395
Epoch: 6, Steps: 9 | Train Loss: 1.095 Vali Loss: 1.134 Vali Acc: 0.638 Test Loss: 1.134 Test Acc: 0.638
Validation loss decreased (-0.572452 --> -0.637670).  Saving model ...
Epoch: 7 cost time: 0.8447396755218506
Epoch: 7, Steps: 9 | Train Loss: 0.988 Vali Loss: 1.054 Vali Acc: 0.696 Test Loss: 1.054 Test Acc: 0.696
Validation loss decreased (-0.637670 --> -0.695642).  Saving model ...
Epoch: 8 cost time: 0.8885288238525391
Epoch: 8, Steps: 9 | Train Loss: 0.886 Vali Loss: 0.976 Vali Acc: 0.732 Test Loss: 0.976 Test Acc: 0.732
Validation loss decreased (-0.695642 --> -0.731874).  Saving model ...
Epoch: 9 cost time: 0.771104097366333
Epoch: 9, Steps: 9 | Train Loss: 0.798 Vali Loss: 0.887 Vali Acc: 0.761 Test Loss: 0.887 Test Acc: 0.761
Validation loss decreased (-0.731874 --> -0.760861).  Saving model ...
Epoch: 10 cost time: 0.7329115867614746
Epoch: 10, Steps: 9 | Train Loss: 0.708 Vali Loss: 0.806 Vali Acc: 0.797 Test Loss: 0.806 Test Acc: 0.797
Validation loss decreased (-0.760861 --> -0.797093).  Saving model ...
Epoch: 11 cost time: 0.7042205333709717
Epoch: 11, Steps: 9 | Train Loss: 0.607 Vali Loss: 0.734 Vali Acc: 0.797 Test Loss: 0.734 Test Acc: 0.797
Validation loss decreased (-0.797093 --> -0.797094).  Saving model ...
Epoch: 12 cost time: 0.8763265609741211
Epoch: 12, Steps: 9 | Train Loss: 0.525 Vali Loss: 0.678 Vali Acc: 0.797 Test Loss: 0.678 Test Acc: 0.797
Validation loss decreased (-0.797094 --> -0.797095).  Saving model ...
Epoch: 13 cost time: 0.8425400257110596
Epoch: 13, Steps: 9 | Train Loss: 0.476 Vali Loss: 0.630 Vali Acc: 0.812 Test Loss: 0.630 Test Acc: 0.812
Validation loss decreased (-0.797095 --> -0.811588).  Saving model ...
Epoch: 14 cost time: 0.8036041259765625
Epoch: 14, Steps: 9 | Train Loss: 0.363 Vali Loss: 0.579 Vali Acc: 0.833 Test Loss: 0.579 Test Acc: 0.833
Validation loss decreased (-0.811588 --> -0.833328).  Saving model ...
Epoch: 15 cost time: 0.80586838722229
Epoch: 15, Steps: 9 | Train Loss: 0.304 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 16 cost time: 0.7699623107910156
Epoch: 16, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.515 Vali Acc: 0.848 Test Loss: 0.515 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847821).  Saving model ...
Epoch: 17 cost time: 0.7458138465881348
Epoch: 17, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.474 Vali Acc: 0.848 Test Loss: 0.474 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 18 cost time: 0.7675068378448486
Epoch: 18, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.451 Vali Acc: 0.862 Test Loss: 0.451 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 19 cost time: 0.8832187652587891
Epoch: 19, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.444 Vali Acc: 0.862 Test Loss: 0.444 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 20 cost time: 0.7270157337188721
Epoch: 20, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.429 Vali Acc: 0.862 Test Loss: 0.429 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 21 cost time: 0.7751226425170898
Epoch: 21, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.421 Vali Acc: 0.855 Test Loss: 0.421 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7640988826751709
Epoch: 22, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.406 Vali Acc: 0.862 Test Loss: 0.406 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 23 cost time: 0.7666208744049072
Epoch: 23, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.407 Vali Acc: 0.870 Test Loss: 0.407 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 24 cost time: 0.7560346126556396
Epoch: 24, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.385 Vali Acc: 0.891 Test Loss: 0.385 Test Acc: 0.891
Validation loss decreased (-0.869561 --> -0.891300).  Saving model ...
Epoch: 25 cost time: 0.8229308128356934
Epoch: 25, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.393 Vali Acc: 0.877 Test Loss: 0.393 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7890770435333252
Epoch: 26, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.388 Vali Acc: 0.870 Test Loss: 0.388 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.773756742477417
Epoch: 27, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.402 Vali Acc: 0.870 Test Loss: 0.402 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7377922534942627
Epoch: 28, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.392 Vali Acc: 0.891 Test Loss: 0.392 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7341010570526123
Epoch: 29, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.408 Vali Acc: 0.877 Test Loss: 0.408 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.806999921798706
Epoch: 30, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.398 Vali Acc: 0.884 Test Loss: 0.398 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8877575397491455
Epoch: 31, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.416 Vali Acc: 0.891 Test Loss: 0.416 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7254512310028076
Epoch: 32, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.420 Vali Acc: 0.891 Test Loss: 0.420 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8648407459259033
Epoch: 33, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.421 Vali Acc: 0.891 Test Loss: 0.421 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7678670883178711
Epoch: 34, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.424 Vali Acc: 0.884 Test Loss: 0.424 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 578404
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.2109005451202393
Epoch: 1, Steps: 9 | Train Loss: 1.455 Vali Loss: 1.406 Vali Acc: 0.217 Test Loss: 1.406 Test Acc: 0.217
Validation loss decreased (inf --> -0.217377).  Saving model ...
Epoch: 2 cost time: 0.7660579681396484
Epoch: 2, Steps: 9 | Train Loss: 1.413 Vali Loss: 1.395 Vali Acc: 0.304 Test Loss: 1.395 Test Acc: 0.304
Validation loss decreased (-0.217377 --> -0.304334).  Saving model ...
Epoch: 3 cost time: 0.7687010765075684
Epoch: 3, Steps: 9 | Train Loss: 1.351 Vali Loss: 1.362 Vali Acc: 0.384 Test Loss: 1.362 Test Acc: 0.384
Validation loss decreased (-0.304334 --> -0.384044).  Saving model ...
Epoch: 4 cost time: 0.7577304840087891
Epoch: 4, Steps: 9 | Train Loss: 1.282 Vali Loss: 1.309 Vali Acc: 0.500 Test Loss: 1.309 Test Acc: 0.500
Validation loss decreased (-0.384044 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 0.7481136322021484
Epoch: 5, Steps: 9 | Train Loss: 1.210 Vali Loss: 1.248 Vali Acc: 0.630 Test Loss: 1.248 Test Acc: 0.630
Validation loss decreased (-0.499987 --> -0.630422).  Saving model ...
Epoch: 6 cost time: 0.7718050479888916
Epoch: 6, Steps: 9 | Train Loss: 1.111 Vali Loss: 1.176 Vali Acc: 0.717 Test Loss: 1.176 Test Acc: 0.717
Validation loss decreased (-0.630422 --> -0.717380).  Saving model ...
Epoch: 7 cost time: 0.7166848182678223
Epoch: 7, Steps: 9 | Train Loss: 1.027 Vali Loss: 1.106 Vali Acc: 0.710 Test Loss: 1.106 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7165758609771729
Epoch: 8, Steps: 9 | Train Loss: 0.947 Vali Loss: 1.023 Vali Acc: 0.732 Test Loss: 1.023 Test Acc: 0.732
Validation loss decreased (-0.717380 --> -0.731874).  Saving model ...
Epoch: 9 cost time: 0.7414195537567139
Epoch: 9, Steps: 9 | Train Loss: 0.846 Vali Loss: 0.950 Vali Acc: 0.710 Test Loss: 0.950 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7412929534912109
Epoch: 10, Steps: 9 | Train Loss: 0.753 Vali Loss: 0.881 Vali Acc: 0.732 Test Loss: 0.881 Test Acc: 0.732
Validation loss decreased (-0.731874 --> -0.731875).  Saving model ...
Epoch: 11 cost time: 0.739797830581665
Epoch: 11, Steps: 9 | Train Loss: 0.684 Vali Loss: 0.817 Vali Acc: 0.732 Test Loss: 0.817 Test Acc: 0.732
Validation loss decreased (-0.731875 --> -0.731876).  Saving model ...
Epoch: 12 cost time: 0.7576031684875488
Epoch: 12, Steps: 9 | Train Loss: 0.593 Vali Loss: 0.753 Vali Acc: 0.761 Test Loss: 0.753 Test Acc: 0.761
Validation loss decreased (-0.731876 --> -0.760862).  Saving model ...
Epoch: 13 cost time: 0.7360634803771973
Epoch: 13, Steps: 9 | Train Loss: 0.496 Vali Loss: 0.713 Vali Acc: 0.746 Test Loss: 0.713 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7589223384857178
Epoch: 14, Steps: 9 | Train Loss: 0.469 Vali Loss: 0.662 Vali Acc: 0.768 Test Loss: 0.662 Test Acc: 0.768
Validation loss decreased (-0.760862 --> -0.768109).  Saving model ...
Epoch: 15 cost time: 0.8417022228240967
Epoch: 15, Steps: 9 | Train Loss: 0.373 Vali Loss: 0.641 Vali Acc: 0.790 Test Loss: 0.641 Test Acc: 0.790
Validation loss decreased (-0.768109 --> -0.789849).  Saving model ...
Epoch: 16 cost time: 0.7641043663024902
Epoch: 16, Steps: 9 | Train Loss: 0.299 Vali Loss: 0.604 Vali Acc: 0.797 Test Loss: 0.604 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797095).  Saving model ...
Epoch: 17 cost time: 0.7943861484527588
Epoch: 17, Steps: 9 | Train Loss: 0.266 Vali Loss: 0.569 Vali Acc: 0.804 Test Loss: 0.569 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804342).  Saving model ...
Epoch: 18 cost time: 0.7038733959197998
Epoch: 18, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.545 Vali Acc: 0.812 Test Loss: 0.545 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811589).  Saving model ...
Epoch: 19 cost time: 0.764805793762207
Epoch: 19, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.515 Vali Acc: 0.826 Test Loss: 0.515 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826082).  Saving model ...
Epoch: 20 cost time: 0.7764794826507568
Epoch: 20, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.491 Vali Acc: 0.819 Test Loss: 0.491 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.811215877532959
Epoch: 21, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.478 Vali Acc: 0.819 Test Loss: 0.478 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7309298515319824
Epoch: 22, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.493 Vali Acc: 0.819 Test Loss: 0.493 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8066508769989014
Epoch: 23, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.498 Vali Acc: 0.804 Test Loss: 0.498 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8109180927276611
Epoch: 24, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.491 Vali Acc: 0.819 Test Loss: 0.491 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7126574516296387
Epoch: 25, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.481 Vali Acc: 0.833 Test Loss: 0.481 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 26 cost time: 0.8608672618865967
Epoch: 26, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.475 Vali Acc: 0.833 Test Loss: 0.475 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 27 cost time: 0.7403521537780762
Epoch: 27, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.506 Vali Acc: 0.826 Test Loss: 0.506 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.727449893951416
Epoch: 28, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.503 Vali Acc: 0.833 Test Loss: 0.503 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8476457595825195
Epoch: 29, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.487 Vali Acc: 0.826 Test Loss: 0.487 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7617025375366211
Epoch: 30, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.472 Vali Acc: 0.804 Test Loss: 0.472 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7942235469818115
Epoch: 31, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.510 Vali Acc: 0.826 Test Loss: 0.510 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8162603378295898
Epoch: 32, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.546 Vali Acc: 0.812 Test Loss: 0.546 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7638180255889893
Epoch: 33, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.546 Vali Acc: 0.819 Test Loss: 0.546 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7892923355102539
Epoch: 34, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.513 Vali Acc: 0.812 Test Loss: 0.513 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.7560858726501465
Epoch: 35, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.533 Vali Acc: 0.812 Test Loss: 0.533 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.6802120208740234
Epoch: 36, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.546 Vali Acc: 0.804 Test Loss: 0.546 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 577188
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.3136496543884277
Epoch: 1, Steps: 9 | Train Loss: 1.346 Vali Loss: 1.246 Vali Acc: 0.623 Test Loss: 1.246 Test Acc: 0.623
Validation loss decreased (inf --> -0.623176).  Saving model ...
Epoch: 2 cost time: 1.1118268966674805
Epoch: 2, Steps: 9 | Train Loss: 0.968 Vali Loss: 0.904 Vali Acc: 0.790 Test Loss: 0.904 Test Acc: 0.790
Validation loss decreased (-0.623176 --> -0.789846).  Saving model ...
Epoch: 3 cost time: 1.0267853736877441
Epoch: 3, Steps: 9 | Train Loss: 0.557 Vali Loss: 0.586 Vali Acc: 0.891 Test Loss: 0.586 Test Acc: 0.891
Validation loss decreased (-0.789846 --> -0.891298).  Saving model ...
Epoch: 4 cost time: 0.9881753921508789
Epoch: 4, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.345 Vali Acc: 0.913 Test Loss: 0.345 Test Acc: 0.913
Validation loss decreased (-0.891298 --> -0.913040).  Saving model ...
Epoch: 5 cost time: 0.9603304862976074
Epoch: 5, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.232 Vali Acc: 0.942 Test Loss: 0.232 Test Acc: 0.942
Validation loss decreased (-0.913040 --> -0.942027).  Saving model ...
Epoch: 6 cost time: 0.9998106956481934
Epoch: 6, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.217 Vali Acc: 0.913 Test Loss: 0.217 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0749108791351318
Epoch: 7, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.224 Vali Acc: 0.920 Test Loss: 0.224 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0687365531921387
Epoch: 8, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.225 Vali Acc: 0.942 Test Loss: 0.225 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 9 cost time: 1.0217256546020508
Epoch: 9, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0812911987304688
Epoch: 10, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0521459579467773
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0052917003631592
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0220389366149902
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0430867671966553
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0311992168426514
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.935 Test Loss: 0.198 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.959766149520874
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.935 Test Loss: 0.171 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0414717197418213
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.935 Test Loss: 0.170 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0982565879821777
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.935 Test Loss: 0.175 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 2203012
model size : 8.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.3736519813537598
Epoch: 1, Steps: 9 | Train Loss: 1.340 Vali Loss: 1.330 Vali Acc: 0.384 Test Loss: 1.330 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 0.8315999507904053
Epoch: 2, Steps: 9 | Train Loss: 1.115 Vali Loss: 1.118 Vali Acc: 0.638 Test Loss: 1.118 Test Acc: 0.638
Validation loss decreased (-0.384045 --> -0.637670).  Saving model ...
Epoch: 3 cost time: 0.878105640411377
Epoch: 3, Steps: 9 | Train Loss: 0.792 Vali Loss: 0.843 Vali Acc: 0.812 Test Loss: 0.843 Test Acc: 0.812
Validation loss decreased (-0.637670 --> -0.811586).  Saving model ...
Epoch: 4 cost time: 0.8911166191101074
Epoch: 4, Steps: 9 | Train Loss: 0.511 Vali Loss: 0.586 Vali Acc: 0.862 Test Loss: 0.586 Test Acc: 0.862
Validation loss decreased (-0.811586 --> -0.862313).  Saving model ...
Epoch: 5 cost time: 0.9291062355041504
Epoch: 5, Steps: 9 | Train Loss: 0.348 Vali Loss: 0.437 Vali Acc: 0.877 Test Loss: 0.437 Test Acc: 0.877
Validation loss decreased (-0.862313 --> -0.876807).  Saving model ...
Epoch: 6 cost time: 0.9153709411621094
Epoch: 6, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.312 Vali Acc: 0.928 Test Loss: 0.312 Test Acc: 0.928
Validation loss decreased (-0.876807 --> -0.927533).  Saving model ...
Epoch: 7 cost time: 0.9202790260314941
Epoch: 7, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.279 Vali Acc: 0.899 Test Loss: 0.279 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9134190082550049
Epoch: 8, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.248 Vali Acc: 0.928 Test Loss: 0.248 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927534).  Saving model ...
Epoch: 9 cost time: 0.8967034816741943
Epoch: 9, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.244 Vali Acc: 0.920 Test Loss: 0.244 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8736124038696289
Epoch: 10, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.269 Vali Acc: 0.928 Test Loss: 0.269 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.885045051574707
Epoch: 11, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.889768123626709
Epoch: 12, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.259 Vali Acc: 0.913 Test Loss: 0.259 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9326586723327637
Epoch: 13, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.233 Vali Acc: 0.928 Test Loss: 0.233 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 14 cost time: 0.9729471206665039
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.227 Vali Acc: 0.913 Test Loss: 0.227 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9220099449157715
Epoch: 15, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.226 Vali Acc: 0.913 Test Loss: 0.226 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9235725402832031
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.230 Vali Acc: 0.935 Test Loss: 0.230 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 17 cost time: 0.8921670913696289
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.237 Vali Acc: 0.935 Test Loss: 0.237 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9051613807678223
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.238 Vali Acc: 0.928 Test Loss: 0.238 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9299502372741699
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.242 Vali Acc: 0.920 Test Loss: 0.242 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9263706207275391
Epoch: 20, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.228 Vali Acc: 0.920 Test Loss: 0.228 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9556970596313477
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.935 Test Loss: 0.218 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 22 cost time: 0.8942770957946777
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934781).  Saving model ...
Epoch: 23 cost time: 0.8914310932159424
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9214596748352051
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.935 Test Loss: 0.228 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7976076602935791
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.928 Test Loss: 0.235 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9449079036712646
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9141762256622314
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.928 Test Loss: 0.218 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8699314594268799
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.928 Test Loss: 0.221 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9013426303863525
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.928 Test Loss: 0.223 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.900874137878418
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.928 Test Loss: 0.229 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.0852265357971191
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.928 Test Loss: 0.232 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9668662548065186
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.928 Test Loss: 0.219 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 2151428
model size : 8.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.366631269454956
Epoch: 1, Steps: 9 | Train Loss: 1.387 Vali Loss: 1.328 Vali Acc: 0.341 Test Loss: 1.328 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 1.1218748092651367
Epoch: 2, Steps: 9 | Train Loss: 1.183 Vali Loss: 1.153 Vali Acc: 0.522 Test Loss: 1.153 Test Acc: 0.522
Validation loss decreased (-0.340566 --> -0.521728).  Saving model ...
Epoch: 3 cost time: 1.0151512622833252
Epoch: 3, Steps: 9 | Train Loss: 0.905 Vali Loss: 0.927 Vali Acc: 0.797 Test Loss: 0.927 Test Acc: 0.797
Validation loss decreased (-0.521728 --> -0.797092).  Saving model ...
Epoch: 4 cost time: 1.0268795490264893
Epoch: 4, Steps: 9 | Train Loss: 0.640 Vali Loss: 0.703 Vali Acc: 0.826 Test Loss: 0.703 Test Acc: 0.826
Validation loss decreased (-0.797092 --> -0.826080).  Saving model ...
Epoch: 5 cost time: 0.9505312442779541
Epoch: 5, Steps: 9 | Train Loss: 0.412 Vali Loss: 0.516 Vali Acc: 0.884 Test Loss: 0.516 Test Acc: 0.884
Validation loss decreased (-0.826080 --> -0.884053).  Saving model ...
Epoch: 6 cost time: 1.0136981010437012
Epoch: 6, Steps: 9 | Train Loss: 0.254 Vali Loss: 0.381 Vali Acc: 0.913 Test Loss: 0.381 Test Acc: 0.913
Validation loss decreased (-0.884053 --> -0.913040).  Saving model ...
Epoch: 7 cost time: 1.0053126811981201
Epoch: 7, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.324 Vali Acc: 0.891 Test Loss: 0.324 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9714305400848389
Epoch: 8, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.027531623840332
Epoch: 9, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.266 Vali Acc: 0.906 Test Loss: 0.266 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0424659252166748
Epoch: 10, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.248 Vali Acc: 0.913 Test Loss: 0.248 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913041).  Saving model ...
Epoch: 11 cost time: 1.0866973400115967
Epoch: 11, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.242 Vali Acc: 0.913 Test Loss: 0.242 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 12 cost time: 1.1139450073242188
Epoch: 12, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.256 Vali Acc: 0.913 Test Loss: 0.256 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.047750473022461
Epoch: 13, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.248 Vali Acc: 0.906 Test Loss: 0.248 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9771430492401123
Epoch: 14, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.257 Vali Acc: 0.913 Test Loss: 0.257 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1065948009490967
Epoch: 15, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.244 Vali Acc: 0.913 Test Loss: 0.244 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0536935329437256
Epoch: 16, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.237 Vali Acc: 0.913 Test Loss: 0.237 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 17 cost time: 1.0511384010314941
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.236 Vali Acc: 0.913 Test Loss: 0.236 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 18 cost time: 1.2471928596496582
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.239 Vali Acc: 0.913 Test Loss: 0.239 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9747977256774902
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.247 Vali Acc: 0.913 Test Loss: 0.247 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0042693614959717
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.906 Test Loss: 0.234 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8712339401245117
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.249 Vali Acc: 0.906 Test Loss: 0.249 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0043675899505615
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.906 Test Loss: 0.261 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9416975975036621
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.267 Vali Acc: 0.913 Test Loss: 0.267 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.918311595916748
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.913 Test Loss: 0.259 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.3251144886016846
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.250 Vali Acc: 0.913 Test Loss: 0.250 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9996485710144043
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.913 Test Loss: 0.251 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.149068832397461
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.913 Test Loss: 0.250 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 2139780
model size : 8.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.7842936515808105
Epoch: 1, Steps: 9 | Train Loss: 1.348 Vali Loss: 1.288 Vali Acc: 0.536 Test Loss: 1.288 Test Acc: 0.536
Validation loss decreased (inf --> -0.536219).  Saving model ...
Epoch: 2 cost time: 1.2215752601623535
Epoch: 2, Steps: 9 | Train Loss: 1.185 Vali Loss: 1.145 Vali Acc: 0.587 Test Loss: 1.145 Test Acc: 0.587
Validation loss decreased (-0.536219 --> -0.586945).  Saving model ...
Epoch: 3 cost time: 1.02592134475708
Epoch: 3, Steps: 9 | Train Loss: 0.968 Vali Loss: 0.966 Vali Acc: 0.688 Test Loss: 0.966 Test Acc: 0.688
Validation loss decreased (-0.586945 --> -0.688396).  Saving model ...
Epoch: 4 cost time: 0.9519436359405518
Epoch: 4, Steps: 9 | Train Loss: 0.732 Vali Loss: 0.766 Vali Acc: 0.819 Test Loss: 0.766 Test Acc: 0.819
Validation loss decreased (-0.688396 --> -0.818833).  Saving model ...
Epoch: 5 cost time: 0.9534363746643066
Epoch: 5, Steps: 9 | Train Loss: 0.517 Vali Loss: 0.594 Vali Acc: 0.848 Test Loss: 0.594 Test Acc: 0.848
Validation loss decreased (-0.818833 --> -0.847820).  Saving model ...
Epoch: 6 cost time: 0.959043025970459
Epoch: 6, Steps: 9 | Train Loss: 0.336 Vali Loss: 0.447 Vali Acc: 0.913 Test Loss: 0.447 Test Acc: 0.913
Validation loss decreased (-0.847820 --> -0.913039).  Saving model ...
Epoch: 7 cost time: 0.9532639980316162
Epoch: 7, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.378 Vali Acc: 0.906 Test Loss: 0.378 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9343414306640625
Epoch: 8, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.328 Vali Acc: 0.906 Test Loss: 0.328 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8491425514221191
Epoch: 9, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.300 Vali Acc: 0.899 Test Loss: 0.300 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2134268283843994
Epoch: 10, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.286 Vali Acc: 0.920 Test Loss: 0.286 Test Acc: 0.920
Validation loss decreased (-0.913039 --> -0.920287).  Saving model ...
Epoch: 11 cost time: 1.2229716777801514
Epoch: 11, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.266 Vali Acc: 0.913 Test Loss: 0.266 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3162217140197754
Epoch: 12, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.274 Vali Acc: 0.899 Test Loss: 0.274 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1405997276306152
Epoch: 13, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.263 Vali Acc: 0.906 Test Loss: 0.263 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9824986457824707
Epoch: 14, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.273 Vali Acc: 0.899 Test Loss: 0.273 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9541032314300537
Epoch: 15, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.273 Vali Acc: 0.899 Test Loss: 0.273 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9504737854003906
Epoch: 16, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.277 Vali Acc: 0.891 Test Loss: 0.277 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9617972373962402
Epoch: 17, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0096840858459473
Epoch: 18, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.256 Vali Acc: 0.913 Test Loss: 0.256 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9769432544708252
Epoch: 19, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.275 Vali Acc: 0.906 Test Loss: 0.275 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1991114616394043
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.270 Vali Acc: 0.913 Test Loss: 0.270 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 2128132
model size : 8.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.210310459136963
Epoch: 1, Steps: 9 | Train Loss: 1.371 Vali Loss: 1.336 Vali Acc: 0.333 Test Loss: 1.336 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 1.0979466438293457
Epoch: 2, Steps: 9 | Train Loss: 1.245 Vali Loss: 1.226 Vali Acc: 0.522 Test Loss: 1.226 Test Acc: 0.522
Validation loss decreased (-0.333320 --> -0.521727).  Saving model ...
Epoch: 3 cost time: 1.2301440238952637
Epoch: 3, Steps: 9 | Train Loss: 1.061 Vali Loss: 1.057 Vali Acc: 0.623 Test Loss: 1.057 Test Acc: 0.623
Validation loss decreased (-0.521727 --> -0.623178).  Saving model ...
Epoch: 4 cost time: 1.2106246948242188
Epoch: 4, Steps: 9 | Train Loss: 0.858 Vali Loss: 0.882 Vali Acc: 0.739 Test Loss: 0.882 Test Acc: 0.739
Validation loss decreased (-0.623178 --> -0.739122).  Saving model ...
Epoch: 5 cost time: 1.2240982055664062
Epoch: 5, Steps: 9 | Train Loss: 0.646 Vali Loss: 0.725 Vali Acc: 0.790 Test Loss: 0.725 Test Acc: 0.790
Validation loss decreased (-0.739122 --> -0.789848).  Saving model ...
Epoch: 6 cost time: 1.2515044212341309
Epoch: 6, Steps: 9 | Train Loss: 0.509 Vali Loss: 0.615 Vali Acc: 0.804 Test Loss: 0.615 Test Acc: 0.804
Validation loss decreased (-0.789848 --> -0.804342).  Saving model ...
Epoch: 7 cost time: 1.0310580730438232
Epoch: 7, Steps: 9 | Train Loss: 0.361 Vali Loss: 0.515 Vali Acc: 0.862 Test Loss: 0.515 Test Acc: 0.862
Validation loss decreased (-0.804342 --> -0.862314).  Saving model ...
Epoch: 8 cost time: 0.9048113822937012
Epoch: 8, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.452 Vali Acc: 0.862 Test Loss: 0.452 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 9 cost time: 0.986189603805542
Epoch: 9, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.409 Vali Acc: 0.870 Test Loss: 0.409 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 10 cost time: 0.9046001434326172
Epoch: 10, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.408 Vali Acc: 0.848 Test Loss: 0.408 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9957535266876221
Epoch: 11, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.384 Vali Acc: 0.841 Test Loss: 0.384 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9993762969970703
Epoch: 12, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.352 Vali Acc: 0.877 Test Loss: 0.352 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 13 cost time: 1.197648048400879
Epoch: 13, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.359 Vali Acc: 0.884 Test Loss: 0.359 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 14 cost time: 1.2113237380981445
Epoch: 14, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.380 Vali Acc: 0.877 Test Loss: 0.380 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.092054843902588
Epoch: 15, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.338 Vali Acc: 0.862 Test Loss: 0.338 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1942927837371826
Epoch: 16, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.328 Vali Acc: 0.877 Test Loss: 0.328 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9522881507873535
Epoch: 17, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.319 Vali Acc: 0.884 Test Loss: 0.319 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884055).  Saving model ...
Epoch: 18 cost time: 0.9745442867279053
Epoch: 18, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.347 Vali Acc: 0.855 Test Loss: 0.347 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7607791423797607
Epoch: 19, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.356 Vali Acc: 0.855 Test Loss: 0.356 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9183602333068848
Epoch: 20, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.342 Vali Acc: 0.870 Test Loss: 0.342 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0711631774902344
Epoch: 21, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.311 Vali Acc: 0.899 Test Loss: 0.311 Test Acc: 0.899
Validation loss decreased (-0.884055 --> -0.898548).  Saving model ...
Epoch: 22 cost time: 1.038487195968628
Epoch: 22, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.339 Vali Acc: 0.884 Test Loss: 0.339 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0836358070373535
Epoch: 23, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.333 Vali Acc: 0.884 Test Loss: 0.333 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9732451438903809
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.333 Vali Acc: 0.884 Test Loss: 0.333 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0135126113891602
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.345 Vali Acc: 0.884 Test Loss: 0.345 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.949819803237915
Epoch: 26, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.334 Vali Acc: 0.884 Test Loss: 0.334 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1457998752593994
Epoch: 27, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.347 Vali Acc: 0.884 Test Loss: 0.347 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0320186614990234
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.369 Vali Acc: 0.862 Test Loss: 0.369 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1840033531188965
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.362 Vali Acc: 0.870 Test Loss: 0.362 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1246519088745117
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.343 Vali Acc: 0.877 Test Loss: 0.343 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9980776309967041
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.343 Vali Acc: 0.884 Test Loss: 0.343 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 2120196
model size : 8.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.24906325340271
Epoch: 1, Steps: 9 | Train Loss: 1.387 Vali Loss: 1.371 Vali Acc: 0.370 Test Loss: 1.371 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 0.9936106204986572
Epoch: 2, Steps: 9 | Train Loss: 1.272 Vali Loss: 1.269 Vali Acc: 0.543 Test Loss: 1.269 Test Acc: 0.543
Validation loss decreased (-0.369552 --> -0.543466).  Saving model ...
Epoch: 3 cost time: 1.0413475036621094
Epoch: 3, Steps: 9 | Train Loss: 1.101 Vali Loss: 1.119 Vali Acc: 0.688 Test Loss: 1.119 Test Acc: 0.688
Validation loss decreased (-0.543466 --> -0.688395).  Saving model ...
Epoch: 4 cost time: 1.0485880374908447
Epoch: 4, Steps: 9 | Train Loss: 0.923 Vali Loss: 0.968 Vali Acc: 0.732 Test Loss: 0.968 Test Acc: 0.732
Validation loss decreased (-0.688395 --> -0.731874).  Saving model ...
Epoch: 5 cost time: 0.9069492816925049
Epoch: 5, Steps: 9 | Train Loss: 0.711 Vali Loss: 0.817 Vali Acc: 0.775 Test Loss: 0.817 Test Acc: 0.775
Validation loss decreased (-0.731874 --> -0.775354).  Saving model ...
Epoch: 6 cost time: 1.164473056793213
Epoch: 6, Steps: 9 | Train Loss: 0.546 Vali Loss: 0.686 Vali Acc: 0.775 Test Loss: 0.686 Test Acc: 0.775
Validation loss decreased (-0.775354 --> -0.775355).  Saving model ...
Epoch: 7 cost time: 1.2097291946411133
Epoch: 7, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.612 Vali Acc: 0.797 Test Loss: 0.612 Test Acc: 0.797
Validation loss decreased (-0.775355 --> -0.797095).  Saving model ...
Epoch: 8 cost time: 1.1073846817016602
Epoch: 8, Steps: 9 | Train Loss: 0.304 Vali Loss: 0.551 Vali Acc: 0.797 Test Loss: 0.551 Test Acc: 0.797
Validation loss decreased (-0.797095 --> -0.797096).  Saving model ...
Epoch: 9 cost time: 1.1571545600891113
Epoch: 9, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.505 Vali Acc: 0.833 Test Loss: 0.505 Test Acc: 0.833
Validation loss decreased (-0.797096 --> -0.833328).  Saving model ...
Epoch: 10 cost time: 1.1249287128448486
Epoch: 10, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.455 Vali Acc: 0.833 Test Loss: 0.455 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 11 cost time: 0.988286018371582
Epoch: 11, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.445 Vali Acc: 0.833 Test Loss: 0.445 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 0.9814226627349854
Epoch: 12, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.428 Vali Acc: 0.841 Test Loss: 0.428 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 13 cost time: 0.996774435043335
Epoch: 13, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.412 Vali Acc: 0.848 Test Loss: 0.412 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 14 cost time: 1.0714123249053955
Epoch: 14, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.418 Vali Acc: 0.841 Test Loss: 0.418 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9562559127807617
Epoch: 15, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.403 Vali Acc: 0.841 Test Loss: 0.403 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0381934642791748
Epoch: 16, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.385 Vali Acc: 0.877 Test Loss: 0.385 Test Acc: 0.877
Validation loss decreased (-0.847822 --> -0.876808).  Saving model ...
Epoch: 17 cost time: 1.1206843852996826
Epoch: 17, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.368 Vali Acc: 0.870 Test Loss: 0.368 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0401787757873535
Epoch: 18, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.387 Vali Acc: 0.862 Test Loss: 0.387 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.994783878326416
Epoch: 19, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.353 Vali Acc: 0.870 Test Loss: 0.353 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.973114013671875
Epoch: 20, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.349 Vali Acc: 0.870 Test Loss: 0.349 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0588734149932861
Epoch: 21, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.349 Vali Acc: 0.877 Test Loss: 0.349 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 22 cost time: 1.0219612121582031
Epoch: 22, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.364 Vali Acc: 0.884 Test Loss: 0.364 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 23 cost time: 1.041182279586792
Epoch: 23, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.382 Vali Acc: 0.870 Test Loss: 0.382 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9872922897338867
Epoch: 24, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.389 Vali Acc: 0.862 Test Loss: 0.389 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0375099182128906
Epoch: 25, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.389 Vali Acc: 0.870 Test Loss: 0.389 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0794460773468018
Epoch: 26, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.388 Vali Acc: 0.870 Test Loss: 0.388 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1237237453460693
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.386 Vali Acc: 0.870 Test Loss: 0.386 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1860923767089844
Epoch: 28, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.375 Vali Acc: 0.870 Test Loss: 0.375 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9713873863220215
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.373 Vali Acc: 0.862 Test Loss: 0.373 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0098528861999512
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.362 Vali Acc: 0.877 Test Loss: 0.362 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9104022979736328
Epoch: 31, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.378 Vali Acc: 0.870 Test Loss: 0.378 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9884810447692871
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.380 Vali Acc: 0.870 Test Loss: 0.380 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 2118532
model size : 8.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.2726500034332275
Epoch: 1, Steps: 9 | Train Loss: 1.389 Vali Loss: 1.353 Vali Acc: 0.283 Test Loss: 1.353 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 0.9124636650085449
Epoch: 2, Steps: 9 | Train Loss: 1.300 Vali Loss: 1.264 Vali Acc: 0.522 Test Loss: 1.264 Test Acc: 0.522
Validation loss decreased (-0.282595 --> -0.521726).  Saving model ...
Epoch: 3 cost time: 0.9305970668792725
Epoch: 3, Steps: 9 | Train Loss: 1.148 Vali Loss: 1.135 Vali Acc: 0.667 Test Loss: 1.135 Test Acc: 0.667
Validation loss decreased (-0.521726 --> -0.666655).  Saving model ...
Epoch: 4 cost time: 0.9036879539489746
Epoch: 4, Steps: 9 | Train Loss: 0.969 Vali Loss: 0.995 Vali Acc: 0.710 Test Loss: 0.995 Test Acc: 0.710
Validation loss decreased (-0.666655 --> -0.710135).  Saving model ...
Epoch: 5 cost time: 0.9467067718505859
Epoch: 5, Steps: 9 | Train Loss: 0.791 Vali Loss: 0.856 Vali Acc: 0.761 Test Loss: 0.856 Test Acc: 0.761
Validation loss decreased (-0.710135 --> -0.760861).  Saving model ...
Epoch: 6 cost time: 0.8599119186401367
Epoch: 6, Steps: 9 | Train Loss: 0.640 Vali Loss: 0.728 Vali Acc: 0.783 Test Loss: 0.728 Test Acc: 0.783
Validation loss decreased (-0.760861 --> -0.782601).  Saving model ...
Epoch: 7 cost time: 0.9695277214050293
Epoch: 7, Steps: 9 | Train Loss: 0.509 Vali Loss: 0.636 Vali Acc: 0.826 Test Loss: 0.636 Test Acc: 0.826
Validation loss decreased (-0.782601 --> -0.826081).  Saving model ...
Epoch: 8 cost time: 0.9040515422821045
Epoch: 8, Steps: 9 | Train Loss: 0.386 Vali Loss: 0.562 Vali Acc: 0.841 Test Loss: 0.562 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 9 cost time: 0.8112592697143555
Epoch: 9, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.513 Vali Acc: 0.826 Test Loss: 0.513 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8571093082427979
Epoch: 10, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.488 Vali Acc: 0.833 Test Loss: 0.488 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9061851501464844
Epoch: 11, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.445 Vali Acc: 0.841 Test Loss: 0.445 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 12 cost time: 0.844449520111084
Epoch: 12, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.441 Vali Acc: 0.841 Test Loss: 0.441 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 13 cost time: 0.9672181606292725
Epoch: 13, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.433 Vali Acc: 0.848 Test Loss: 0.433 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 14 cost time: 0.9507207870483398
Epoch: 14, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.434 Vali Acc: 0.841 Test Loss: 0.434 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8395707607269287
Epoch: 15, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.416 Vali Acc: 0.841 Test Loss: 0.416 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8922133445739746
Epoch: 16, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.423 Vali Acc: 0.848 Test Loss: 0.423 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 17 cost time: 0.8919293880462646
Epoch: 17, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.423 Vali Acc: 0.841 Test Loss: 0.423 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9004614353179932
Epoch: 18, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.403 Vali Acc: 0.841 Test Loss: 0.403 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0044729709625244
Epoch: 19, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.407 Vali Acc: 0.841 Test Loss: 0.407 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9096910953521729
Epoch: 20, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.426 Vali Acc: 0.826 Test Loss: 0.426 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9642980098724365
Epoch: 21, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.417 Vali Acc: 0.841 Test Loss: 0.417 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9359688758850098
Epoch: 22, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.420 Vali Acc: 0.848 Test Loss: 0.420 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 23 cost time: 0.9786660671234131
Epoch: 23, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.437 Vali Acc: 0.841 Test Loss: 0.437 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9758291244506836
Epoch: 24, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.446 Vali Acc: 0.848 Test Loss: 0.446 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9612095355987549
Epoch: 25, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.450 Vali Acc: 0.848 Test Loss: 0.450 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8696434497833252
Epoch: 26, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.451 Vali Acc: 0.848 Test Loss: 0.451 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8627979755401611
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.440 Vali Acc: 0.848 Test Loss: 0.440 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.860642671585083
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.450 Vali Acc: 0.848 Test Loss: 0.450 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9112575054168701
Epoch: 29, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.450 Vali Acc: 0.848 Test Loss: 0.450 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.867748498916626
Epoch: 30, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.448 Vali Acc: 0.848 Test Loss: 0.448 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8497395515441895
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.439 Vali Acc: 0.848 Test Loss: 0.439 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9152002334594727
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.429 Vali Acc: 0.848 Test Loss: 0.429 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 2116740
model size : 8.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.132312059402466
Epoch: 1, Steps: 9 | Train Loss: 1.391 Vali Loss: 1.300 Vali Acc: 0.341 Test Loss: 1.300 Test Acc: 0.341
Validation loss decreased (inf --> -0.340567).  Saving model ...
Epoch: 2 cost time: 0.9098389148712158
Epoch: 2, Steps: 9 | Train Loss: 1.153 Vali Loss: 1.089 Vali Acc: 0.630 Test Loss: 1.089 Test Acc: 0.630
Validation loss decreased (-0.340567 --> -0.630424).  Saving model ...
Epoch: 3 cost time: 0.9061651229858398
Epoch: 3, Steps: 9 | Train Loss: 0.878 Vali Loss: 0.842 Vali Acc: 0.804 Test Loss: 0.842 Test Acc: 0.804
Validation loss decreased (-0.630424 --> -0.804339).  Saving model ...
Epoch: 4 cost time: 0.8621971607208252
Epoch: 4, Steps: 9 | Train Loss: 0.602 Vali Loss: 0.606 Vali Acc: 0.884 Test Loss: 0.606 Test Acc: 0.884
Validation loss decreased (-0.804339 --> -0.884052).  Saving model ...
Epoch: 5 cost time: 1.0111713409423828
Epoch: 5, Steps: 9 | Train Loss: 0.348 Vali Loss: 0.419 Vali Acc: 0.899 Test Loss: 0.419 Test Acc: 0.899
Validation loss decreased (-0.884052 --> -0.898547).  Saving model ...
Epoch: 6 cost time: 0.9057908058166504
Epoch: 6, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.302 Vali Acc: 0.935 Test Loss: 0.302 Test Acc: 0.935
Validation loss decreased (-0.898547 --> -0.934780).  Saving model ...
Epoch: 7 cost time: 0.863398551940918
Epoch: 7, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.271 Vali Acc: 0.899 Test Loss: 0.271 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8214840888977051
Epoch: 8, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.233 Vali Acc: 0.928 Test Loss: 0.233 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8265438079833984
Epoch: 9, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.221 Vali Acc: 0.920 Test Loss: 0.221 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8195347785949707
Epoch: 10, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.226 Vali Acc: 0.913 Test Loss: 0.226 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8076741695404053
Epoch: 11, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.225 Vali Acc: 0.920 Test Loss: 0.225 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.839500904083252
Epoch: 12, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.214 Vali Acc: 0.920 Test Loss: 0.214 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7713780403137207
Epoch: 13, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.219 Vali Acc: 0.920 Test Loss: 0.219 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8456583023071289
Epoch: 14, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.219 Vali Acc: 0.920 Test Loss: 0.219 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.833566427230835
Epoch: 15, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.212 Vali Acc: 0.920 Test Loss: 0.212 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0154523849487305
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.206 Vali Acc: 0.920 Test Loss: 0.206 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 593604
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.299703359603882
Epoch: 1, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.353 Vali Acc: 0.348 Test Loss: 1.353 Test Acc: 0.348
Validation loss decreased (inf --> -0.347813).  Saving model ...
Epoch: 2 cost time: 0.8369426727294922
Epoch: 2, Steps: 9 | Train Loss: 1.276 Vali Loss: 1.238 Vali Acc: 0.522 Test Loss: 1.238 Test Acc: 0.522
Validation loss decreased (-0.347813 --> -0.521727).  Saving model ...
Epoch: 3 cost time: 0.8111190795898438
Epoch: 3, Steps: 9 | Train Loss: 1.091 Vali Loss: 1.071 Vali Acc: 0.616 Test Loss: 1.071 Test Acc: 0.616
Validation loss decreased (-0.521727 --> -0.615931).  Saving model ...
Epoch: 4 cost time: 0.8272557258605957
Epoch: 4, Steps: 9 | Train Loss: 0.881 Vali Loss: 0.892 Vali Acc: 0.725 Test Loss: 0.892 Test Acc: 0.725
Validation loss decreased (-0.615931 --> -0.724629).  Saving model ...
Epoch: 5 cost time: 0.7711539268493652
Epoch: 5, Steps: 9 | Train Loss: 0.671 Vali Loss: 0.712 Vali Acc: 0.848 Test Loss: 0.712 Test Acc: 0.848
Validation loss decreased (-0.724629 --> -0.847819).  Saving model ...
Epoch: 6 cost time: 0.7619621753692627
Epoch: 6, Steps: 9 | Train Loss: 0.478 Vali Loss: 0.566 Vali Acc: 0.862 Test Loss: 0.566 Test Acc: 0.862
Validation loss decreased (-0.847819 --> -0.862313).  Saving model ...
Epoch: 7 cost time: 0.8108291625976562
Epoch: 7, Steps: 9 | Train Loss: 0.313 Vali Loss: 0.438 Vali Acc: 0.891 Test Loss: 0.438 Test Acc: 0.891
Validation loss decreased (-0.862313 --> -0.891300).  Saving model ...
Epoch: 8 cost time: 0.8763070106506348
Epoch: 8, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.353 Vali Acc: 0.906 Test Loss: 0.353 Test Acc: 0.906
Validation loss decreased (-0.891300 --> -0.905794).  Saving model ...
Epoch: 9 cost time: 0.8374485969543457
Epoch: 9, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.317 Vali Acc: 0.913 Test Loss: 0.317 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 10 cost time: 0.8675010204315186
Epoch: 10, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.289 Vali Acc: 0.913 Test Loss: 0.289 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913041).  Saving model ...
Epoch: 11 cost time: 0.8901233673095703
Epoch: 11, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.262 Vali Acc: 0.906 Test Loss: 0.262 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8003079891204834
Epoch: 12, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.248 Vali Acc: 0.920 Test Loss: 0.248 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 13 cost time: 0.8161532878875732
Epoch: 13, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.249 Vali Acc: 0.928 Test Loss: 0.249 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 14 cost time: 0.8747835159301758
Epoch: 14, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.250 Vali Acc: 0.920 Test Loss: 0.250 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8410799503326416
Epoch: 15, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.246 Vali Acc: 0.920 Test Loss: 0.246 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7543694972991943
Epoch: 16, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.258 Vali Acc: 0.920 Test Loss: 0.258 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.757606029510498
Epoch: 17, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.235 Vali Acc: 0.928 Test Loss: 0.235 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 18 cost time: 0.8217141628265381
Epoch: 18, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 19 cost time: 0.739673376083374
Epoch: 19, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.216 Vali Acc: 0.935 Test Loss: 0.216 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 20 cost time: 0.7429563999176025
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.215 Vali Acc: 0.928 Test Loss: 0.215 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7672569751739502
Epoch: 21, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.216 Vali Acc: 0.928 Test Loss: 0.216 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7328019142150879
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.227 Vali Acc: 0.920 Test Loss: 0.227 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.763953685760498
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.920 Test Loss: 0.217 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8553647994995117
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.218 Vali Acc: 0.928 Test Loss: 0.218 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7386126518249512
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.218 Vali Acc: 0.928 Test Loss: 0.218 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7751865386962891
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.728600025177002
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7418124675750732
Epoch: 28, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.226 Vali Acc: 0.928 Test Loss: 0.226 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7045164108276367
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 567812
model size : 2.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1783268451690674
Epoch: 1, Steps: 9 | Train Loss: 1.408 Vali Loss: 1.359 Vali Acc: 0.319 Test Loss: 1.359 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 0.8038027286529541
Epoch: 2, Steps: 9 | Train Loss: 1.281 Vali Loss: 1.258 Vali Acc: 0.514 Test Loss: 1.258 Test Acc: 0.514
Validation loss decreased (-0.318827 --> -0.514480).  Saving model ...
Epoch: 3 cost time: 0.8135025501251221
Epoch: 3, Steps: 9 | Train Loss: 1.115 Vali Loss: 1.116 Vali Acc: 0.681 Test Loss: 1.116 Test Acc: 0.681
Validation loss decreased (-0.514480 --> -0.681148).  Saving model ...
Epoch: 4 cost time: 0.8030309677124023
Epoch: 4, Steps: 9 | Train Loss: 0.950 Vali Loss: 0.961 Vali Acc: 0.725 Test Loss: 0.961 Test Acc: 0.725
Validation loss decreased (-0.681148 --> -0.724628).  Saving model ...
Epoch: 5 cost time: 0.7893021106719971
Epoch: 5, Steps: 9 | Train Loss: 0.780 Vali Loss: 0.798 Vali Acc: 0.790 Test Loss: 0.798 Test Acc: 0.790
Validation loss decreased (-0.724628 --> -0.789847).  Saving model ...
Epoch: 6 cost time: 0.744652509689331
Epoch: 6, Steps: 9 | Train Loss: 0.606 Vali Loss: 0.650 Vali Acc: 0.833 Test Loss: 0.650 Test Acc: 0.833
Validation loss decreased (-0.789847 --> -0.833327).  Saving model ...
Epoch: 7 cost time: 0.8596735000610352
Epoch: 7, Steps: 9 | Train Loss: 0.441 Vali Loss: 0.536 Vali Acc: 0.877 Test Loss: 0.536 Test Acc: 0.877
Validation loss decreased (-0.833327 --> -0.876806).  Saving model ...
Epoch: 8 cost time: 0.781893253326416
Epoch: 8, Steps: 9 | Train Loss: 0.306 Vali Loss: 0.435 Vali Acc: 0.906 Test Loss: 0.435 Test Acc: 0.906
Validation loss decreased (-0.876806 --> -0.905793).  Saving model ...
Epoch: 9 cost time: 0.7562508583068848
Epoch: 9, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.376 Vali Acc: 0.913 Test Loss: 0.376 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913040).  Saving model ...
Epoch: 10 cost time: 1.0283236503601074
Epoch: 10, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.340 Vali Acc: 0.920 Test Loss: 0.340 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920286).  Saving model ...
Epoch: 11 cost time: 0.9634244441986084
Epoch: 11, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.321 Vali Acc: 0.928 Test Loss: 0.321 Test Acc: 0.928
Validation loss decreased (-0.920286 --> -0.927533).  Saving model ...
Epoch: 12 cost time: 0.9107749462127686
Epoch: 12, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.296 Vali Acc: 0.913 Test Loss: 0.296 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8417272567749023
Epoch: 13, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.282 Vali Acc: 0.913 Test Loss: 0.282 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8093209266662598
Epoch: 14, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.273 Vali Acc: 0.913 Test Loss: 0.273 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8570976257324219
Epoch: 15, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.257 Vali Acc: 0.920 Test Loss: 0.257 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8655714988708496
Epoch: 16, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.248 Vali Acc: 0.928 Test Loss: 0.248 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927534).  Saving model ...
Epoch: 17 cost time: 0.8401219844818115
Epoch: 17, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.249 Vali Acc: 0.906 Test Loss: 0.249 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8404443264007568
Epoch: 18, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.245 Vali Acc: 0.906 Test Loss: 0.245 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9339406490325928
Epoch: 19, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.263 Vali Acc: 0.906 Test Loss: 0.263 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8592259883880615
Epoch: 20, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8260118961334229
Epoch: 21, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.249 Vali Acc: 0.920 Test Loss: 0.249 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8892421722412109
Epoch: 22, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.250 Vali Acc: 0.920 Test Loss: 0.250 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7962586879730225
Epoch: 23, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.245 Vali Acc: 0.913 Test Loss: 0.245 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7775042057037354
Epoch: 24, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.244 Vali Acc: 0.906 Test Loss: 0.244 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8164775371551514
Epoch: 25, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.243 Vali Acc: 0.906 Test Loss: 0.243 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8690192699432373
Epoch: 26, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.250 Vali Acc: 0.913 Test Loss: 0.250 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 561988
model size : 2.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1791603565216064
Epoch: 1, Steps: 9 | Train Loss: 1.370 Vali Loss: 1.336 Vali Acc: 0.283 Test Loss: 1.336 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 0.7576096057891846
Epoch: 2, Steps: 9 | Train Loss: 1.281 Vali Loss: 1.258 Vali Acc: 0.522 Test Loss: 1.258 Test Acc: 0.522
Validation loss decreased (-0.282595 --> -0.521727).  Saving model ...
Epoch: 3 cost time: 0.7005524635314941
Epoch: 3, Steps: 9 | Train Loss: 1.179 Vali Loss: 1.150 Vali Acc: 0.638 Test Loss: 1.150 Test Acc: 0.638
Validation loss decreased (-0.521727 --> -0.637670).  Saving model ...
Epoch: 4 cost time: 0.7445757389068604
Epoch: 4, Steps: 9 | Train Loss: 1.025 Vali Loss: 1.024 Vali Acc: 0.710 Test Loss: 1.024 Test Acc: 0.710
Validation loss decreased (-0.637670 --> -0.710135).  Saving model ...
Epoch: 5 cost time: 0.7304630279541016
Epoch: 5, Steps: 9 | Train Loss: 0.881 Vali Loss: 0.886 Vali Acc: 0.775 Test Loss: 0.886 Test Acc: 0.775
Validation loss decreased (-0.710135 --> -0.775353).  Saving model ...
Epoch: 6 cost time: 0.7413318157196045
Epoch: 6, Steps: 9 | Train Loss: 0.725 Vali Loss: 0.756 Vali Acc: 0.819 Test Loss: 0.756 Test Acc: 0.819
Validation loss decreased (-0.775353 --> -0.818833).  Saving model ...
Epoch: 7 cost time: 0.7726433277130127
Epoch: 7, Steps: 9 | Train Loss: 0.602 Vali Loss: 0.641 Vali Acc: 0.848 Test Loss: 0.641 Test Acc: 0.848
Validation loss decreased (-0.818833 --> -0.847820).  Saving model ...
Epoch: 8 cost time: 0.835747480392456
Epoch: 8, Steps: 9 | Train Loss: 0.444 Vali Loss: 0.552 Vali Acc: 0.891 Test Loss: 0.552 Test Acc: 0.891
Validation loss decreased (-0.847820 --> -0.891299).  Saving model ...
Epoch: 9 cost time: 0.7926490306854248
Epoch: 9, Steps: 9 | Train Loss: 0.349 Vali Loss: 0.477 Vali Acc: 0.928 Test Loss: 0.477 Test Acc: 0.928
Validation loss decreased (-0.891299 --> -0.927531).  Saving model ...
Epoch: 10 cost time: 0.7365615367889404
Epoch: 10, Steps: 9 | Train Loss: 0.281 Vali Loss: 0.422 Vali Acc: 0.913 Test Loss: 0.422 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7424595355987549
Epoch: 11, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.373 Vali Acc: 0.920 Test Loss: 0.373 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7377450466156006
Epoch: 12, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.332 Vali Acc: 0.928 Test Loss: 0.332 Test Acc: 0.928
Validation loss decreased (-0.927531 --> -0.927533).  Saving model ...
Epoch: 13 cost time: 0.7180514335632324
Epoch: 13, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.322 Vali Acc: 0.913 Test Loss: 0.322 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.686542272567749
Epoch: 14, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.304 Vali Acc: 0.920 Test Loss: 0.304 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7777919769287109
Epoch: 15, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.300 Vali Acc: 0.913 Test Loss: 0.300 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8435633182525635
Epoch: 16, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.289 Vali Acc: 0.920 Test Loss: 0.289 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8071858882904053
Epoch: 17, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.284 Vali Acc: 0.920 Test Loss: 0.284 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6519062519073486
Epoch: 18, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.281 Vali Acc: 0.935 Test Loss: 0.281 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934780).  Saving model ...
Epoch: 19 cost time: 0.7037830352783203
Epoch: 19, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.265 Vali Acc: 0.928 Test Loss: 0.265 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7417299747467041
Epoch: 20, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.259 Vali Acc: 0.920 Test Loss: 0.259 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6859395503997803
Epoch: 21, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.257 Vali Acc: 0.935 Test Loss: 0.257 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 22 cost time: 0.7587599754333496
Epoch: 22, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.261 Vali Acc: 0.928 Test Loss: 0.261 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7476804256439209
Epoch: 23, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.272 Vali Acc: 0.913 Test Loss: 0.272 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6903076171875
Epoch: 24, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.265 Vali Acc: 0.928 Test Loss: 0.265 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7414848804473877
Epoch: 25, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.260 Vali Acc: 0.935 Test Loss: 0.260 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6998498439788818
Epoch: 26, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.263 Vali Acc: 0.928 Test Loss: 0.263 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6916003227233887
Epoch: 27, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.256 Vali Acc: 0.935 Test Loss: 0.256 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 28 cost time: 0.6747205257415771
Epoch: 28, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.256 Vali Acc: 0.920 Test Loss: 0.256 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6975226402282715
Epoch: 29, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.256 Vali Acc: 0.928 Test Loss: 0.256 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7538373470306396
Epoch: 30, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.253 Vali Acc: 0.928 Test Loss: 0.253 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6490600109100342
Epoch: 31, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.258 Vali Acc: 0.928 Test Loss: 0.258 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7866542339324951
Epoch: 32, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.251 Vali Acc: 0.935 Test Loss: 0.251 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 33 cost time: 0.7667696475982666
Epoch: 33, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.261 Vali Acc: 0.935 Test Loss: 0.261 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9225223064422607
Epoch: 34, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.255 Vali Acc: 0.935 Test Loss: 0.255 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8266751766204834
Epoch: 35, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.250 Vali Acc: 0.935 Test Loss: 0.250 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 36 cost time: 0.8190734386444092
Epoch: 36, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.254 Vali Acc: 0.935 Test Loss: 0.254 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7747001647949219
Epoch: 37, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.264 Vali Acc: 0.935 Test Loss: 0.264 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6862518787384033
Epoch: 38, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.271 Vali Acc: 0.920 Test Loss: 0.271 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8062570095062256
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.928 Test Loss: 0.265 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7307069301605225
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.935 Test Loss: 0.257 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8229281902313232
Epoch: 41, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.252 Vali Acc: 0.928 Test Loss: 0.252 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7624173164367676
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.259 Vali Acc: 0.928 Test Loss: 0.259 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7641885280609131
Epoch: 43, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.258 Vali Acc: 0.928 Test Loss: 0.258 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.7230777740478516
Epoch: 44, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.258 Vali Acc: 0.920 Test Loss: 0.258 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.6666443347930908
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.264 Vali Acc: 0.913 Test Loss: 0.264 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 556164
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.31168794631958
Epoch: 1, Steps: 9 | Train Loss: 1.356 Vali Loss: 1.336 Vali Acc: 0.507 Test Loss: 1.336 Test Acc: 0.507
Validation loss decreased (inf --> -0.507233).  Saving model ...
Epoch: 2 cost time: 0.8286705017089844
Epoch: 2, Steps: 9 | Train Loss: 1.296 Vali Loss: 1.280 Vali Acc: 0.580 Test Loss: 1.280 Test Acc: 0.580
Validation loss decreased (-0.507233 --> -0.579697).  Saving model ...
Epoch: 3 cost time: 0.7891800403594971
Epoch: 3, Steps: 9 | Train Loss: 1.208 Vali Loss: 1.199 Vali Acc: 0.645 Test Loss: 1.199 Test Acc: 0.645
Validation loss decreased (-0.579697 --> -0.644916).  Saving model ...
Epoch: 4 cost time: 0.7494513988494873
Epoch: 4, Steps: 9 | Train Loss: 1.099 Vali Loss: 1.111 Vali Acc: 0.688 Test Loss: 1.111 Test Acc: 0.688
Validation loss decreased (-0.644916 --> -0.688395).  Saving model ...
Epoch: 5 cost time: 0.7309343814849854
Epoch: 5, Steps: 9 | Train Loss: 0.983 Vali Loss: 1.015 Vali Acc: 0.710 Test Loss: 1.015 Test Acc: 0.710
Validation loss decreased (-0.688395 --> -0.710135).  Saving model ...
Epoch: 6 cost time: 0.7063307762145996
Epoch: 6, Steps: 9 | Train Loss: 0.856 Vali Loss: 0.928 Vali Acc: 0.761 Test Loss: 0.928 Test Acc: 0.761
Validation loss decreased (-0.710135 --> -0.760860).  Saving model ...
Epoch: 7 cost time: 0.9078338146209717
Epoch: 7, Steps: 9 | Train Loss: 0.751 Vali Loss: 0.830 Vali Acc: 0.790 Test Loss: 0.830 Test Acc: 0.790
Validation loss decreased (-0.760860 --> -0.789847).  Saving model ...
Epoch: 8 cost time: 0.7148561477661133
Epoch: 8, Steps: 9 | Train Loss: 0.617 Vali Loss: 0.744 Vali Acc: 0.819 Test Loss: 0.744 Test Acc: 0.819
Validation loss decreased (-0.789847 --> -0.818833).  Saving model ...
Epoch: 9 cost time: 0.8341145515441895
Epoch: 9, Steps: 9 | Train Loss: 0.505 Vali Loss: 0.661 Vali Acc: 0.848 Test Loss: 0.661 Test Acc: 0.848
Validation loss decreased (-0.818833 --> -0.847819).  Saving model ...
Epoch: 10 cost time: 0.8725976943969727
Epoch: 10, Steps: 9 | Train Loss: 0.427 Vali Loss: 0.599 Vali Acc: 0.826 Test Loss: 0.599 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8262288570404053
Epoch: 11, Steps: 9 | Train Loss: 0.336 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8112804889678955
Epoch: 12, Steps: 9 | Train Loss: 0.287 Vali Loss: 0.498 Vali Acc: 0.848 Test Loss: 0.498 Test Acc: 0.848
Validation loss decreased (-0.847819 --> -0.847821).  Saving model ...
Epoch: 13 cost time: 0.7951521873474121
Epoch: 13, Steps: 9 | Train Loss: 0.248 Vali Loss: 0.455 Vali Acc: 0.891 Test Loss: 0.455 Test Acc: 0.891
Validation loss decreased (-0.847821 --> -0.891300).  Saving model ...
Epoch: 14 cost time: 0.8454086780548096
Epoch: 14, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.427 Vali Acc: 0.884 Test Loss: 0.427 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7818312644958496
Epoch: 15, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.411 Vali Acc: 0.891 Test Loss: 0.411 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 16 cost time: 0.8320999145507812
Epoch: 16, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.386 Vali Acc: 0.891 Test Loss: 0.386 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 17 cost time: 0.8276960849761963
Epoch: 17, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.373 Vali Acc: 0.899 Test Loss: 0.373 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 18 cost time: 0.7528820037841797
Epoch: 18, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.353 Vali Acc: 0.899 Test Loss: 0.353 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 19 cost time: 0.7981643676757812
Epoch: 19, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.349 Vali Acc: 0.899 Test Loss: 0.349 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 20 cost time: 0.8127236366271973
Epoch: 20, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.345 Vali Acc: 0.891 Test Loss: 0.345 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8188626766204834
Epoch: 21, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.339 Vali Acc: 0.891 Test Loss: 0.339 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8293981552124023
Epoch: 22, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.344 Vali Acc: 0.891 Test Loss: 0.344 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8486416339874268
Epoch: 23, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.342 Vali Acc: 0.891 Test Loss: 0.342 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.785590410232544
Epoch: 24, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.339 Vali Acc: 0.891 Test Loss: 0.339 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7216188907623291
Epoch: 25, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.321 Vali Acc: 0.899 Test Loss: 0.321 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898548).  Saving model ...
Epoch: 26 cost time: 0.8467612266540527
Epoch: 26, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.306 Vali Acc: 0.906 Test Loss: 0.306 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 27 cost time: 0.7357931137084961
Epoch: 27, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.298 Vali Acc: 0.913 Test Loss: 0.298 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 28 cost time: 0.698361873626709
Epoch: 28, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.310 Vali Acc: 0.906 Test Loss: 0.310 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7351853847503662
Epoch: 29, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.309 Vali Acc: 0.899 Test Loss: 0.309 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8802495002746582
Epoch: 30, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.319 Vali Acc: 0.891 Test Loss: 0.319 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7981200218200684
Epoch: 31, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.316 Vali Acc: 0.906 Test Loss: 0.316 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.799595832824707
Epoch: 32, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.297 Vali Acc: 0.906 Test Loss: 0.297 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.851980447769165
Epoch: 33, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.306 Vali Acc: 0.899 Test Loss: 0.306 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8249337673187256
Epoch: 34, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.322 Vali Acc: 0.899 Test Loss: 0.322 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7967424392700195
Epoch: 35, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.307 Vali Acc: 0.906 Test Loss: 0.307 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7741618156433105
Epoch: 36, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.307 Vali Acc: 0.899 Test Loss: 0.307 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.7521107196807861
Epoch: 37, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.303 Vali Acc: 0.899 Test Loss: 0.303 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 552196
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1904804706573486
Epoch: 1, Steps: 9 | Train Loss: 1.348 Vali Loss: 1.359 Vali Acc: 0.283 Test Loss: 1.359 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 0.8029704093933105
Epoch: 2, Steps: 9 | Train Loss: 1.285 Vali Loss: 1.300 Vali Acc: 0.377 Test Loss: 1.300 Test Acc: 0.377
Validation loss decreased (-0.282595 --> -0.376799).  Saving model ...
Epoch: 3 cost time: 0.7501003742218018
Epoch: 3, Steps: 9 | Train Loss: 1.208 Vali Loss: 1.212 Vali Acc: 0.486 Test Loss: 1.212 Test Acc: 0.486
Validation loss decreased (-0.376799 --> -0.485495).  Saving model ...
Epoch: 4 cost time: 0.7354555130004883
Epoch: 4, Steps: 9 | Train Loss: 1.107 Vali Loss: 1.122 Vali Acc: 0.543 Test Loss: 1.122 Test Acc: 0.543
Validation loss decreased (-0.485495 --> -0.543467).  Saving model ...
Epoch: 5 cost time: 0.8138637542724609
Epoch: 5, Steps: 9 | Train Loss: 0.981 Vali Loss: 1.020 Vali Acc: 0.587 Test Loss: 1.020 Test Acc: 0.587
Validation loss decreased (-0.543467 --> -0.586946).  Saving model ...
Epoch: 6 cost time: 0.6697759628295898
Epoch: 6, Steps: 9 | Train Loss: 0.865 Vali Loss: 0.931 Vali Acc: 0.681 Test Loss: 0.931 Test Acc: 0.681
Validation loss decreased (-0.586946 --> -0.681150).  Saving model ...
Epoch: 7 cost time: 0.7526183128356934
Epoch: 7, Steps: 9 | Train Loss: 0.754 Vali Loss: 0.844 Vali Acc: 0.739 Test Loss: 0.844 Test Acc: 0.739
Validation loss decreased (-0.681150 --> -0.739122).  Saving model ...
Epoch: 8 cost time: 0.6992673873901367
Epoch: 8, Steps: 9 | Train Loss: 0.649 Vali Loss: 0.771 Vali Acc: 0.761 Test Loss: 0.771 Test Acc: 0.761
Validation loss decreased (-0.739122 --> -0.760862).  Saving model ...
Epoch: 9 cost time: 0.7727811336517334
Epoch: 9, Steps: 9 | Train Loss: 0.525 Vali Loss: 0.687 Vali Acc: 0.804 Test Loss: 0.687 Test Acc: 0.804
Validation loss decreased (-0.760862 --> -0.804341).  Saving model ...
Epoch: 10 cost time: 0.7058663368225098
Epoch: 10, Steps: 9 | Train Loss: 0.478 Vali Loss: 0.629 Vali Acc: 0.812 Test Loss: 0.629 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811588).  Saving model ...
Epoch: 11 cost time: 0.7181696891784668
Epoch: 11, Steps: 9 | Train Loss: 0.382 Vali Loss: 0.567 Vali Acc: 0.841 Test Loss: 0.567 Test Acc: 0.841
Validation loss decreased (-0.811588 --> -0.840574).  Saving model ...
Epoch: 12 cost time: 0.7622926235198975
Epoch: 12, Steps: 9 | Train Loss: 0.325 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 13 cost time: 0.73419189453125
Epoch: 13, Steps: 9 | Train Loss: 0.286 Vali Loss: 0.497 Vali Acc: 0.855 Test Loss: 0.497 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855067).  Saving model ...
Epoch: 14 cost time: 0.7244656085968018
Epoch: 14, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.474 Vali Acc: 0.855 Test Loss: 0.474 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855068).  Saving model ...
Epoch: 15 cost time: 0.7582437992095947
Epoch: 15, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.455 Vali Acc: 0.848 Test Loss: 0.455 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7154018878936768
Epoch: 16, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 17 cost time: 0.7804248332977295
Epoch: 17, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.426 Vali Acc: 0.862 Test Loss: 0.426 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 18 cost time: 0.7325384616851807
Epoch: 18, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.404 Vali Acc: 0.841 Test Loss: 0.404 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7824051380157471
Epoch: 19, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.394 Vali Acc: 0.855 Test Loss: 0.394 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7151782512664795
Epoch: 20, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.384 Vali Acc: 0.870 Test Loss: 0.384 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 21 cost time: 0.7402150630950928
Epoch: 21, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.373 Vali Acc: 0.870 Test Loss: 0.373 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 22 cost time: 0.7177519798278809
Epoch: 22, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.363 Vali Acc: 0.870 Test Loss: 0.363 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869562).  Saving model ...
Epoch: 23 cost time: 0.6555008888244629
Epoch: 23, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.371 Vali Acc: 0.877 Test Loss: 0.371 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 24 cost time: 0.6816504001617432
Epoch: 24, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.377 Vali Acc: 0.877 Test Loss: 0.377 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7205374240875244
Epoch: 25, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.362 Vali Acc: 0.870 Test Loss: 0.362 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7661163806915283
Epoch: 26, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.348 Vali Acc: 0.862 Test Loss: 0.348 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7038519382476807
Epoch: 27, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.352 Vali Acc: 0.870 Test Loss: 0.352 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6978788375854492
Epoch: 28, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.350 Vali Acc: 0.877 Test Loss: 0.350 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 29 cost time: 0.7066655158996582
Epoch: 29, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.344 Vali Acc: 0.884 Test Loss: 0.344 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 30 cost time: 0.7594873905181885
Epoch: 30, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.357 Vali Acc: 0.884 Test Loss: 0.357 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.757007360458374
Epoch: 31, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.364 Vali Acc: 0.884 Test Loss: 0.364 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7049643993377686
Epoch: 32, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.356 Vali Acc: 0.884 Test Loss: 0.356 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7668073177337646
Epoch: 33, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.341 Vali Acc: 0.884 Test Loss: 0.341 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 34 cost time: 0.7363438606262207
Epoch: 34, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.320 Vali Acc: 0.891 Test Loss: 0.320 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 35 cost time: 0.7784533500671387
Epoch: 35, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.342 Vali Acc: 0.884 Test Loss: 0.342 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7123866081237793
Epoch: 36, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.346 Vali Acc: 0.877 Test Loss: 0.346 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7828953266143799
Epoch: 37, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.347 Vali Acc: 0.877 Test Loss: 0.347 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7782666683197021
Epoch: 38, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.358 Vali Acc: 0.870 Test Loss: 0.358 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7080738544464111
Epoch: 39, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.350 Vali Acc: 0.877 Test Loss: 0.350 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6988065242767334
Epoch: 40, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.349 Vali Acc: 0.862 Test Loss: 0.349 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7885923385620117
Epoch: 41, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.349 Vali Acc: 0.877 Test Loss: 0.349 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7456865310668945
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.345 Vali Acc: 0.877 Test Loss: 0.345 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7206459045410156
Epoch: 43, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.353 Vali Acc: 0.877 Test Loss: 0.353 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.7051305770874023
Epoch: 44, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.309 Vali Acc: 0.891 Test Loss: 0.309 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 45 cost time: 0.7946767807006836
Epoch: 45, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.294 Vali Acc: 0.899 Test Loss: 0.294 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 46 cost time: 0.8397552967071533
Epoch: 46, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.281 Vali Acc: 0.899 Test Loss: 0.281 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 47 cost time: 0.7421987056732178
Epoch: 47, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.283 Vali Acc: 0.899 Test Loss: 0.283 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7072124481201172
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.301 Vali Acc: 0.891 Test Loss: 0.301 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.792255163192749
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.312 Vali Acc: 0.891 Test Loss: 0.312 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.766993522644043
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.328 Vali Acc: 0.891 Test Loss: 0.328 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 551364
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0024194717407227
Epoch: 1, Steps: 9 | Train Loss: 1.379 Vali Loss: 1.354 Vali Acc: 0.319 Test Loss: 1.354 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 0.7537825107574463
Epoch: 2, Steps: 9 | Train Loss: 1.334 Vali Loss: 1.314 Vali Acc: 0.406 Test Loss: 1.314 Test Acc: 0.406
Validation loss decreased (-0.318827 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 0.6580410003662109
Epoch: 3, Steps: 9 | Train Loss: 1.282 Vali Loss: 1.255 Vali Acc: 0.471 Test Loss: 1.255 Test Acc: 0.471
Validation loss decreased (-0.405784 --> -0.471002).  Saving model ...
Epoch: 4 cost time: 0.7150468826293945
Epoch: 4, Steps: 9 | Train Loss: 1.197 Vali Loss: 1.184 Vali Acc: 0.543 Test Loss: 1.184 Test Acc: 0.543
Validation loss decreased (-0.471002 --> -0.543466).  Saving model ...
Epoch: 5 cost time: 0.6530003547668457
Epoch: 5, Steps: 9 | Train Loss: 1.091 Vali Loss: 1.103 Vali Acc: 0.601 Test Loss: 1.103 Test Acc: 0.601
Validation loss decreased (-0.543466 --> -0.601438).  Saving model ...
Epoch: 6 cost time: 0.7098066806793213
Epoch: 6, Steps: 9 | Train Loss: 0.989 Vali Loss: 1.023 Vali Acc: 0.652 Test Loss: 1.023 Test Acc: 0.652
Validation loss decreased (-0.601438 --> -0.652164).  Saving model ...
Epoch: 7 cost time: 0.69598388671875
Epoch: 7, Steps: 9 | Train Loss: 0.876 Vali Loss: 0.942 Vali Acc: 0.710 Test Loss: 0.942 Test Acc: 0.710
Validation loss decreased (-0.652164 --> -0.710136).  Saving model ...
Epoch: 8 cost time: 0.7261927127838135
Epoch: 8, Steps: 9 | Train Loss: 0.785 Vali Loss: 0.861 Vali Acc: 0.717 Test Loss: 0.861 Test Acc: 0.717
Validation loss decreased (-0.710136 --> -0.717383).  Saving model ...
Epoch: 9 cost time: 0.7439591884613037
Epoch: 9, Steps: 9 | Train Loss: 0.682 Vali Loss: 0.785 Vali Acc: 0.775 Test Loss: 0.785 Test Acc: 0.775
Validation loss decreased (-0.717383 --> -0.775354).  Saving model ...
Epoch: 10 cost time: 0.7000377178192139
Epoch: 10, Steps: 9 | Train Loss: 0.576 Vali Loss: 0.708 Vali Acc: 0.804 Test Loss: 0.708 Test Acc: 0.804
Validation loss decreased (-0.775354 --> -0.804341).  Saving model ...
Epoch: 11 cost time: 0.7412686347961426
Epoch: 11, Steps: 9 | Train Loss: 0.480 Vali Loss: 0.649 Vali Acc: 0.804 Test Loss: 0.649 Test Acc: 0.804
Validation loss decreased (-0.804341 --> -0.804341).  Saving model ...
Epoch: 12 cost time: 0.6735095977783203
Epoch: 12, Steps: 9 | Train Loss: 0.411 Vali Loss: 0.601 Vali Acc: 0.819 Test Loss: 0.601 Test Acc: 0.819
Validation loss decreased (-0.804341 --> -0.818835).  Saving model ...
Epoch: 13 cost time: 0.6419539451599121
Epoch: 13, Steps: 9 | Train Loss: 0.361 Vali Loss: 0.558 Vali Acc: 0.826 Test Loss: 0.558 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 14 cost time: 0.6095535755157471
Epoch: 14, Steps: 9 | Train Loss: 0.291 Vali Loss: 0.527 Vali Acc: 0.819 Test Loss: 0.527 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6905245780944824
Epoch: 15, Steps: 9 | Train Loss: 0.258 Vali Loss: 0.499 Vali Acc: 0.819 Test Loss: 0.499 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.665919303894043
Epoch: 16, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.472 Vali Acc: 0.826 Test Loss: 0.472 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826082).  Saving model ...
Epoch: 17 cost time: 0.7231676578521729
Epoch: 17, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.448 Vali Acc: 0.819 Test Loss: 0.448 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7268760204315186
Epoch: 18, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.434 Vali Acc: 0.841 Test Loss: 0.434 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 19 cost time: 0.6967828273773193
Epoch: 19, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.417 Vali Acc: 0.841 Test Loss: 0.417 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840576).  Saving model ...
Epoch: 20 cost time: 0.753619909286499
Epoch: 20, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.425 Vali Acc: 0.826 Test Loss: 0.425 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7449500560760498
Epoch: 21, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.398 Vali Acc: 0.848 Test Loss: 0.398 Test Acc: 0.848
Validation loss decreased (-0.840576 --> -0.847822).  Saving model ...
Epoch: 22 cost time: 0.7166554927825928
Epoch: 22, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.387 Vali Acc: 0.862 Test Loss: 0.387 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 23 cost time: 0.7506499290466309
Epoch: 23, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.379 Vali Acc: 0.855 Test Loss: 0.379 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7182602882385254
Epoch: 24, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.377 Vali Acc: 0.841 Test Loss: 0.377 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7216832637786865
Epoch: 25, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.383 Vali Acc: 0.841 Test Loss: 0.383 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7192745208740234
Epoch: 26, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.385 Vali Acc: 0.848 Test Loss: 0.385 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7397699356079102
Epoch: 27, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.386 Vali Acc: 0.848 Test Loss: 0.386 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7783858776092529
Epoch: 28, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.386 Vali Acc: 0.855 Test Loss: 0.386 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7828013896942139
Epoch: 29, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.374 Vali Acc: 0.848 Test Loss: 0.374 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7232835292816162
Epoch: 30, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.378 Vali Acc: 0.841 Test Loss: 0.378 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7303094863891602
Epoch: 31, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.381 Vali Acc: 0.848 Test Loss: 0.381 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7418088912963867
Epoch: 32, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.377 Vali Acc: 0.848 Test Loss: 0.377 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 550468
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0031540393829346
Epoch: 1, Steps: 9 | Train Loss: 1.337 Vali Loss: 1.337 Vali Acc: 0.362 Test Loss: 1.337 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 0.721477746963501
Epoch: 2, Steps: 9 | Train Loss: 1.198 Vali Loss: 1.218 Vali Acc: 0.565 Test Loss: 1.218 Test Acc: 0.565
Validation loss decreased (-0.362305 --> -0.565205).  Saving model ...
Epoch: 3 cost time: 0.7701447010040283
Epoch: 3, Steps: 9 | Train Loss: 1.045 Vali Loss: 1.048 Vali Acc: 0.710 Test Loss: 1.048 Test Acc: 0.710
Validation loss decreased (-0.565205 --> -0.710134).  Saving model ...
Epoch: 4 cost time: 0.6665942668914795
Epoch: 4, Steps: 9 | Train Loss: 0.841 Vali Loss: 0.873 Vali Acc: 0.797 Test Loss: 0.873 Test Acc: 0.797
Validation loss decreased (-0.710134 --> -0.797093).  Saving model ...
Epoch: 5 cost time: 0.7661459445953369
Epoch: 5, Steps: 9 | Train Loss: 0.657 Vali Loss: 0.716 Vali Acc: 0.819 Test Loss: 0.716 Test Acc: 0.819
Validation loss decreased (-0.797093 --> -0.818833).  Saving model ...
Epoch: 6 cost time: 0.7327179908752441
Epoch: 6, Steps: 9 | Train Loss: 0.468 Vali Loss: 0.569 Vali Acc: 0.891 Test Loss: 0.569 Test Acc: 0.891
Validation loss decreased (-0.818833 --> -0.891299).  Saving model ...
Epoch: 7 cost time: 0.6471335887908936
Epoch: 7, Steps: 9 | Train Loss: 0.337 Vali Loss: 0.453 Vali Acc: 0.877 Test Loss: 0.453 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6471066474914551
Epoch: 8, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.380 Vali Acc: 0.906 Test Loss: 0.380 Test Acc: 0.906
Validation loss decreased (-0.891299 --> -0.905793).  Saving model ...
Epoch: 9 cost time: 0.6585965156555176
Epoch: 9, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.329 Vali Acc: 0.928 Test Loss: 0.329 Test Acc: 0.928
Validation loss decreased (-0.905793 --> -0.927533).  Saving model ...
Epoch: 10 cost time: 0.6694543361663818
Epoch: 10, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.300 Vali Acc: 0.920 Test Loss: 0.300 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.671799898147583
Epoch: 11, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.273 Vali Acc: 0.928 Test Loss: 0.273 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927534).  Saving model ...
Epoch: 12 cost time: 0.718865156173706
Epoch: 12, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.255 Vali Acc: 0.913 Test Loss: 0.255 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6724989414215088
Epoch: 13, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.251 Vali Acc: 0.913 Test Loss: 0.251 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8460893630981445
Epoch: 14, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.241 Vali Acc: 0.913 Test Loss: 0.241 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7124700546264648
Epoch: 15, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.227 Vali Acc: 0.920 Test Loss: 0.227 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7143661975860596
Epoch: 16, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.219 Vali Acc: 0.920 Test Loss: 0.219 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7184195518493652
Epoch: 17, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934781).  Saving model ...
Epoch: 18 cost time: 0.7574462890625
Epoch: 18, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.198 Vali Acc: 0.935 Test Loss: 0.198 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 19 cost time: 0.766913652420044
Epoch: 19, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7492649555206299
Epoch: 20, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.730787992477417
Epoch: 21, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.207 Vali Acc: 0.928 Test Loss: 0.207 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7373852729797363
Epoch: 22, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.193 Vali Acc: 0.928 Test Loss: 0.193 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8139686584472656
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.187 Vali Acc: 0.928 Test Loss: 0.187 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7460577487945557
Epoch: 24, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.183 Vali Acc: 0.928 Test Loss: 0.183 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7822279930114746
Epoch: 25, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.188 Vali Acc: 0.935 Test Loss: 0.188 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 26 cost time: 0.7710857391357422
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.183 Vali Acc: 0.935 Test Loss: 0.183 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 27 cost time: 0.7207703590393066
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.183 Vali Acc: 0.935 Test Loss: 0.183 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 28 cost time: 0.7377262115478516
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.184 Vali Acc: 0.935 Test Loss: 0.184 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7286086082458496
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.935 Test Loss: 0.188 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.685492992401123
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.935 Test Loss: 0.186 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7247910499572754
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.935 Test Loss: 0.183 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7252171039581299
Epoch: 32, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.935 Test Loss: 0.182 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 33 cost time: 0.8303444385528564
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.935 Test Loss: 0.178 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 34 cost time: 0.7467484474182129
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.935 Test Loss: 0.172 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 35 cost time: 0.7393553256988525
Epoch: 35, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.935 Test Loss: 0.178 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7398512363433838
Epoch: 36, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.198 Vali Acc: 0.935 Test Loss: 0.198 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6887176036834717
Epoch: 37, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.928 Test Loss: 0.199 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6560373306274414
Epoch: 38, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8358049392700195
Epoch: 39, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7074267864227295
Epoch: 40, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.765937089920044
Epoch: 41, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.935 Test Loss: 0.185 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7186875343322754
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.935 Test Loss: 0.176 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.8056135177612305
Epoch: 43, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.935 Test Loss: 0.175 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.8038790225982666
Epoch: 44, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.942 Test Loss: 0.173 Test Acc: 0.942
Validation loss decreased (-0.934781 --> -0.942027).  Saving model ...
Epoch: 45 cost time: 0.652024507522583
Epoch: 45, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.942 Test Loss: 0.171 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 46 cost time: 0.7298994064331055
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.942 Test Loss: 0.174 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.73870849609375
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.942 Test Loss: 0.177 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7233965396881104
Epoch: 48, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.942 Test Loss: 0.178 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7463200092315674
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.942 Test Loss: 0.174 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.7788922786712646
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.942 Test Loss: 0.173 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 169828
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.00319766998291
Epoch: 1, Steps: 9 | Train Loss: 1.383 Vali Loss: 1.366 Vali Acc: 0.333 Test Loss: 1.366 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.7591469287872314
Epoch: 2, Steps: 9 | Train Loss: 1.324 Vali Loss: 1.308 Vali Acc: 0.464 Test Loss: 1.308 Test Acc: 0.464
Validation loss decreased (-0.333320 --> -0.463755).  Saving model ...
Epoch: 3 cost time: 0.7338366508483887
Epoch: 3, Steps: 9 | Train Loss: 1.223 Vali Loss: 1.221 Vali Acc: 0.594 Test Loss: 1.221 Test Acc: 0.594
Validation loss decreased (-0.463755 --> -0.594191).  Saving model ...
Epoch: 4 cost time: 0.6786091327667236
Epoch: 4, Steps: 9 | Train Loss: 1.109 Vali Loss: 1.114 Vali Acc: 0.674 Test Loss: 1.114 Test Acc: 0.674
Validation loss decreased (-0.594191 --> -0.673902).  Saving model ...
Epoch: 5 cost time: 0.6676545143127441
Epoch: 5, Steps: 9 | Train Loss: 1.013 Vali Loss: 0.991 Vali Acc: 0.732 Test Loss: 0.991 Test Acc: 0.732
Validation loss decreased (-0.673902 --> -0.731874).  Saving model ...
Epoch: 6 cost time: 0.698878288269043
Epoch: 6, Steps: 9 | Train Loss: 0.848 Vali Loss: 0.880 Vali Acc: 0.804 Test Loss: 0.880 Test Acc: 0.804
Validation loss decreased (-0.731874 --> -0.804339).  Saving model ...
Epoch: 7 cost time: 0.6869218349456787
Epoch: 7, Steps: 9 | Train Loss: 0.721 Vali Loss: 0.772 Vali Acc: 0.826 Test Loss: 0.772 Test Acc: 0.826
Validation loss decreased (-0.804339 --> -0.826079).  Saving model ...
Epoch: 8 cost time: 0.7397572994232178
Epoch: 8, Steps: 9 | Train Loss: 0.592 Vali Loss: 0.669 Vali Acc: 0.812 Test Loss: 0.669 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7373406887054443
Epoch: 9, Steps: 9 | Train Loss: 0.495 Vali Loss: 0.580 Vali Acc: 0.855 Test Loss: 0.580 Test Acc: 0.855
Validation loss decreased (-0.826079 --> -0.855067).  Saving model ...
Epoch: 10 cost time: 0.7061934471130371
Epoch: 10, Steps: 9 | Train Loss: 0.391 Vali Loss: 0.506 Vali Acc: 0.877 Test Loss: 0.506 Test Acc: 0.877
Validation loss decreased (-0.855067 --> -0.876807).  Saving model ...
Epoch: 11 cost time: 0.7224140167236328
Epoch: 11, Steps: 9 | Train Loss: 0.316 Vali Loss: 0.441 Vali Acc: 0.891 Test Loss: 0.441 Test Acc: 0.891
Validation loss decreased (-0.876807 --> -0.891300).  Saving model ...
Epoch: 12 cost time: 0.689335823059082
Epoch: 12, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.399 Vali Acc: 0.891 Test Loss: 0.399 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 13 cost time: 0.6890389919281006
Epoch: 13, Steps: 9 | Train Loss: 0.205 Vali Loss: 0.361 Vali Acc: 0.891 Test Loss: 0.361 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891301).  Saving model ...
Epoch: 14 cost time: 0.7343676090240479
Epoch: 14, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.327 Vali Acc: 0.913 Test Loss: 0.327 Test Acc: 0.913
Validation loss decreased (-0.891301 --> -0.913040).  Saving model ...
Epoch: 15 cost time: 0.7026104927062988
Epoch: 15, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.304 Vali Acc: 0.899 Test Loss: 0.304 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6788947582244873
Epoch: 16, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.294 Vali Acc: 0.906 Test Loss: 0.294 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7590105533599854
Epoch: 17, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.268 Vali Acc: 0.920 Test Loss: 0.268 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 18 cost time: 0.8406476974487305
Epoch: 18, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.262 Vali Acc: 0.928 Test Loss: 0.262 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 19 cost time: 0.7429754734039307
Epoch: 19, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.260 Vali Acc: 0.935 Test Loss: 0.260 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 20 cost time: 0.7133173942565918
Epoch: 20, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.245 Vali Acc: 0.928 Test Loss: 0.245 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7058713436126709
Epoch: 21, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.244 Vali Acc: 0.920 Test Loss: 0.244 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6278083324432373
Epoch: 22, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.241 Vali Acc: 0.920 Test Loss: 0.241 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6548233032226562
Epoch: 23, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.233 Vali Acc: 0.928 Test Loss: 0.233 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6907103061676025
Epoch: 24, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6482198238372803
Epoch: 25, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.588085412979126
Epoch: 26, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.223 Vali Acc: 0.920 Test Loss: 0.223 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5771205425262451
Epoch: 27, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.225 Vali Acc: 0.920 Test Loss: 0.225 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5308976173400879
Epoch: 28, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.210 Vali Acc: 0.920 Test Loss: 0.210 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5808134078979492
Epoch: 29, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.205 Vali Acc: 0.920 Test Loss: 0.205 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 156932
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8800570964813232
Epoch: 1, Steps: 9 | Train Loss: 1.410 Vali Loss: 1.372 Vali Acc: 0.326 Test Loss: 1.372 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 0.6349642276763916
Epoch: 2, Steps: 9 | Train Loss: 1.349 Vali Loss: 1.327 Vali Acc: 0.362 Test Loss: 1.327 Test Acc: 0.362
Validation loss decreased (-0.326073 --> -0.362306).  Saving model ...
Epoch: 3 cost time: 0.6610286235809326
Epoch: 3, Steps: 9 | Train Loss: 1.256 Vali Loss: 1.258 Vali Acc: 0.442 Test Loss: 1.258 Test Acc: 0.442
Validation loss decreased (-0.362306 --> -0.442016).  Saving model ...
Epoch: 4 cost time: 0.6685805320739746
Epoch: 4, Steps: 9 | Train Loss: 1.169 Vali Loss: 1.169 Vali Acc: 0.522 Test Loss: 1.169 Test Acc: 0.522
Validation loss decreased (-0.442016 --> -0.521727).  Saving model ...
Epoch: 5 cost time: 0.6765222549438477
Epoch: 5, Steps: 9 | Train Loss: 1.053 Vali Loss: 1.080 Vali Acc: 0.572 Test Loss: 1.080 Test Acc: 0.572
Validation loss decreased (-0.521727 --> -0.572453).  Saving model ...
Epoch: 6 cost time: 0.6812798976898193
Epoch: 6, Steps: 9 | Train Loss: 0.922 Vali Loss: 0.985 Vali Acc: 0.645 Test Loss: 0.985 Test Acc: 0.645
Validation loss decreased (-0.572453 --> -0.644918).  Saving model ...
Epoch: 7 cost time: 0.6550452709197998
Epoch: 7, Steps: 9 | Train Loss: 0.800 Vali Loss: 0.893 Vali Acc: 0.732 Test Loss: 0.893 Test Acc: 0.732
Validation loss decreased (-0.644918 --> -0.731875).  Saving model ...
Epoch: 8 cost time: 0.6744980812072754
Epoch: 8, Steps: 9 | Train Loss: 0.715 Vali Loss: 0.792 Vali Acc: 0.761 Test Loss: 0.792 Test Acc: 0.761
Validation loss decreased (-0.731875 --> -0.760862).  Saving model ...
Epoch: 9 cost time: 0.6830728054046631
Epoch: 9, Steps: 9 | Train Loss: 0.587 Vali Loss: 0.718 Vali Acc: 0.790 Test Loss: 0.718 Test Acc: 0.790
Validation loss decreased (-0.760862 --> -0.789848).  Saving model ...
Epoch: 10 cost time: 0.6560924053192139
Epoch: 10, Steps: 9 | Train Loss: 0.484 Vali Loss: 0.629 Vali Acc: 0.833 Test Loss: 0.629 Test Acc: 0.833
Validation loss decreased (-0.789848 --> -0.833327).  Saving model ...
Epoch: 11 cost time: 0.6221160888671875
Epoch: 11, Steps: 9 | Train Loss: 0.408 Vali Loss: 0.561 Vali Acc: 0.848 Test Loss: 0.561 Test Acc: 0.848
Validation loss decreased (-0.833327 --> -0.847820).  Saving model ...
Epoch: 12 cost time: 0.6563692092895508
Epoch: 12, Steps: 9 | Train Loss: 0.341 Vali Loss: 0.484 Vali Acc: 0.870 Test Loss: 0.484 Test Acc: 0.870
Validation loss decreased (-0.847820 --> -0.869560).  Saving model ...
Epoch: 13 cost time: 0.620866060256958
Epoch: 13, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.445 Vali Acc: 0.870 Test Loss: 0.445 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869561).  Saving model ...
Epoch: 14 cost time: 0.6162853240966797
Epoch: 14, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.410 Vali Acc: 0.877 Test Loss: 0.410 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 15 cost time: 0.6707766056060791
Epoch: 15, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.385 Vali Acc: 0.891 Test Loss: 0.385 Test Acc: 0.891
Validation loss decreased (-0.876807 --> -0.891301).  Saving model ...
Epoch: 16 cost time: 0.6310672760009766
Epoch: 16, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.367 Vali Acc: 0.891 Test Loss: 0.367 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 17 cost time: 0.6481473445892334
Epoch: 17, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.333 Vali Acc: 0.899 Test Loss: 0.333 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 18 cost time: 0.6971735954284668
Epoch: 18, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.314 Vali Acc: 0.899 Test Loss: 0.314 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898548).  Saving model ...
Epoch: 19 cost time: 0.676011323928833
Epoch: 19, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.305 Vali Acc: 0.899 Test Loss: 0.305 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 20 cost time: 0.7188081741333008
Epoch: 20, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.297 Vali Acc: 0.906 Test Loss: 0.297 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 21 cost time: 0.6304855346679688
Epoch: 21, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.270 Vali Acc: 0.913 Test Loss: 0.270 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 22 cost time: 0.6319518089294434
Epoch: 22, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6391823291778564
Epoch: 23, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.257 Vali Acc: 0.913 Test Loss: 0.257 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 24 cost time: 0.6501598358154297
Epoch: 24, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.258 Vali Acc: 0.920 Test Loss: 0.258 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 25 cost time: 0.6775591373443604
Epoch: 25, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.253 Vali Acc: 0.920 Test Loss: 0.253 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 26 cost time: 0.6499378681182861
Epoch: 26, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.246 Vali Acc: 0.913 Test Loss: 0.246 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6070959568023682
Epoch: 27, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.247 Vali Acc: 0.920 Test Loss: 0.247 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 28 cost time: 0.7184736728668213
Epoch: 28, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.245 Vali Acc: 0.913 Test Loss: 0.245 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6684055328369141
Epoch: 29, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.243 Vali Acc: 0.913 Test Loss: 0.243 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6113395690917969
Epoch: 30, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.235 Vali Acc: 0.913 Test Loss: 0.235 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.688140869140625
Epoch: 31, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.243 Vali Acc: 0.913 Test Loss: 0.243 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6951448917388916
Epoch: 32, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.222 Vali Acc: 0.920 Test Loss: 0.222 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920288).  Saving model ...
Epoch: 33 cost time: 0.687640905380249
Epoch: 33, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.219 Vali Acc: 0.920 Test Loss: 0.219 Test Acc: 0.920
Validation loss decreased (-0.920288 --> -0.920288).  Saving model ...
Epoch: 34 cost time: 0.7192013263702393
Epoch: 34, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.220 Vali Acc: 0.920 Test Loss: 0.220 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7057335376739502
Epoch: 35, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.221 Vali Acc: 0.920 Test Loss: 0.221 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7970900535583496
Epoch: 36, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.228 Vali Acc: 0.920 Test Loss: 0.228 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6882824897766113
Epoch: 37, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.227 Vali Acc: 0.920 Test Loss: 0.227 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7225730419158936
Epoch: 38, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.230 Vali Acc: 0.920 Test Loss: 0.230 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.6734280586242676
Epoch: 39, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.216 Vali Acc: 0.920 Test Loss: 0.216 Test Acc: 0.920
Validation loss decreased (-0.920288 --> -0.920288).  Saving model ...
Epoch: 40 cost time: 0.6596012115478516
Epoch: 40, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.207 Vali Acc: 0.920 Test Loss: 0.207 Test Acc: 0.920
Validation loss decreased (-0.920288 --> -0.920288).  Saving model ...
Epoch: 41 cost time: 0.695777177810669
Epoch: 41, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.218 Vali Acc: 0.920 Test Loss: 0.218 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7019369602203369
Epoch: 42, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.214 Vali Acc: 0.920 Test Loss: 0.214 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6626906394958496
Epoch: 43, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.216 Vali Acc: 0.920 Test Loss: 0.216 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.640160322189331
Epoch: 44, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.218 Vali Acc: 0.928 Test Loss: 0.218 Test Acc: 0.928
Validation loss decreased (-0.920288 --> -0.927534).  Saving model ...
Epoch: 45 cost time: 0.6532924175262451
Epoch: 45, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 46 cost time: 0.6535234451293945
Epoch: 46, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 47 cost time: 0.7023975849151611
Epoch: 47, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 48 cost time: 0.6882796287536621
Epoch: 48, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.65692138671875
Epoch: 49, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.206 Vali Acc: 0.928 Test Loss: 0.206 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.731999397277832
Epoch: 50, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.196 Vali Acc: 0.928 Test Loss: 0.196 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 154020
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.136246919631958
Epoch: 1, Steps: 9 | Train Loss: 1.442 Vali Loss: 1.391 Vali Acc: 0.225 Test Loss: 1.391 Test Acc: 0.225
Validation loss decreased (inf --> -0.224624).  Saving model ...
Epoch: 2 cost time: 0.6646730899810791
Epoch: 2, Steps: 9 | Train Loss: 1.406 Vali Loss: 1.362 Vali Acc: 0.297 Test Loss: 1.362 Test Acc: 0.297
Validation loss decreased (-0.224624 --> -0.297088).  Saving model ...
Epoch: 3 cost time: 0.7071058750152588
Epoch: 3, Steps: 9 | Train Loss: 1.343 Vali Loss: 1.313 Vali Acc: 0.377 Test Loss: 1.313 Test Acc: 0.377
Validation loss decreased (-0.297088 --> -0.376798).  Saving model ...
Epoch: 4 cost time: 0.6595654487609863
Epoch: 4, Steps: 9 | Train Loss: 1.277 Vali Loss: 1.246 Vali Acc: 0.449 Test Loss: 1.246 Test Acc: 0.449
Validation loss decreased (-0.376798 --> -0.449263).  Saving model ...
Epoch: 5 cost time: 0.6658017635345459
Epoch: 5, Steps: 9 | Train Loss: 1.178 Vali Loss: 1.177 Vali Acc: 0.514 Test Loss: 1.177 Test Acc: 0.514
Validation loss decreased (-0.449263 --> -0.514481).  Saving model ...
Epoch: 6 cost time: 0.6487290859222412
Epoch: 6, Steps: 9 | Train Loss: 1.080 Vali Loss: 1.105 Vali Acc: 0.659 Test Loss: 1.105 Test Acc: 0.659
Validation loss decreased (-0.514481 --> -0.659409).  Saving model ...
Epoch: 7 cost time: 0.6241397857666016
Epoch: 7, Steps: 9 | Train Loss: 0.997 Vali Loss: 1.031 Vali Acc: 0.725 Test Loss: 1.031 Test Acc: 0.725
Validation loss decreased (-0.659409 --> -0.724627).  Saving model ...
Epoch: 8 cost time: 0.6380066871643066
Epoch: 8, Steps: 9 | Train Loss: 0.895 Vali Loss: 0.951 Vali Acc: 0.732 Test Loss: 0.951 Test Acc: 0.732
Validation loss decreased (-0.724627 --> -0.731875).  Saving model ...
Epoch: 9 cost time: 0.6415426731109619
Epoch: 9, Steps: 9 | Train Loss: 0.796 Vali Loss: 0.870 Vali Acc: 0.761 Test Loss: 0.870 Test Acc: 0.761
Validation loss decreased (-0.731875 --> -0.760861).  Saving model ...
Epoch: 10 cost time: 0.6406328678131104
Epoch: 10, Steps: 9 | Train Loss: 0.716 Vali Loss: 0.793 Vali Acc: 0.790 Test Loss: 0.793 Test Acc: 0.790
Validation loss decreased (-0.760861 --> -0.789847).  Saving model ...
Epoch: 11 cost time: 0.608048677444458
Epoch: 11, Steps: 9 | Train Loss: 0.621 Vali Loss: 0.727 Vali Acc: 0.804 Test Loss: 0.727 Test Acc: 0.804
Validation loss decreased (-0.789847 --> -0.804341).  Saving model ...
Epoch: 12 cost time: 0.6693723201751709
Epoch: 12, Steps: 9 | Train Loss: 0.528 Vali Loss: 0.669 Vali Acc: 0.826 Test Loss: 0.669 Test Acc: 0.826
Validation loss decreased (-0.804341 --> -0.826080).  Saving model ...
Epoch: 13 cost time: 0.6550471782684326
Epoch: 13, Steps: 9 | Train Loss: 0.453 Vali Loss: 0.613 Vali Acc: 0.841 Test Loss: 0.613 Test Acc: 0.841
Validation loss decreased (-0.826080 --> -0.840574).  Saving model ...
Epoch: 14 cost time: 0.6230161190032959
Epoch: 14, Steps: 9 | Train Loss: 0.401 Vali Loss: 0.563 Vali Acc: 0.855 Test Loss: 0.563 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855067).  Saving model ...
Epoch: 15 cost time: 0.6337573528289795
Epoch: 15, Steps: 9 | Train Loss: 0.343 Vali Loss: 0.529 Vali Acc: 0.855 Test Loss: 0.529 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 16 cost time: 0.6566922664642334
Epoch: 16, Steps: 9 | Train Loss: 0.299 Vali Loss: 0.485 Vali Acc: 0.877 Test Loss: 0.485 Test Acc: 0.877
Validation loss decreased (-0.855067 --> -0.876807).  Saving model ...
Epoch: 17 cost time: 0.6917135715484619
Epoch: 17, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.448 Vali Acc: 0.877 Test Loss: 0.448 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 18 cost time: 0.634005069732666
Epoch: 18, Steps: 9 | Train Loss: 0.210 Vali Loss: 0.415 Vali Acc: 0.891 Test Loss: 0.415 Test Acc: 0.891
Validation loss decreased (-0.876807 --> -0.891300).  Saving model ...
Epoch: 19 cost time: 0.6170754432678223
Epoch: 19, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.391 Vali Acc: 0.891 Test Loss: 0.391 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 20 cost time: 0.6486947536468506
Epoch: 20, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.377 Vali Acc: 0.884 Test Loss: 0.377 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6656816005706787
Epoch: 21, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.350 Vali Acc: 0.884 Test Loss: 0.350 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7056779861450195
Epoch: 22, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.351 Vali Acc: 0.884 Test Loss: 0.351 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.644059419631958
Epoch: 23, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.338 Vali Acc: 0.891 Test Loss: 0.338 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891301).  Saving model ...
Epoch: 24 cost time: 0.5764293670654297
Epoch: 24, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.327 Vali Acc: 0.891 Test Loss: 0.327 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 25 cost time: 0.6301078796386719
Epoch: 25, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.332 Vali Acc: 0.899 Test Loss: 0.332 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 26 cost time: 0.6275851726531982
Epoch: 26, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.309 Vali Acc: 0.891 Test Loss: 0.309 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6240713596343994
Epoch: 27, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.301 Vali Acc: 0.891 Test Loss: 0.301 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5804166793823242
Epoch: 28, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.310 Vali Acc: 0.884 Test Loss: 0.310 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6534240245819092
Epoch: 29, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.314 Vali Acc: 0.884 Test Loss: 0.314 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7026796340942383
Epoch: 30, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.313 Vali Acc: 0.884 Test Loss: 0.313 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6490771770477295
Epoch: 31, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.303 Vali Acc: 0.891 Test Loss: 0.303 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6101326942443848
Epoch: 32, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.290 Vali Acc: 0.891 Test Loss: 0.290 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6250715255737305
Epoch: 33, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.290 Vali Acc: 0.891 Test Loss: 0.290 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6039896011352539
Epoch: 34, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.290 Vali Acc: 0.891 Test Loss: 0.290 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6262481212615967
Epoch: 35, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.284 Vali Acc: 0.891 Test Loss: 0.284 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 151108
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.06103515625
Epoch: 1, Steps: 9 | Train Loss: 1.402 Vali Loss: 1.402 Vali Acc: 0.239 Test Loss: 1.402 Test Acc: 0.239
Validation loss decreased (inf --> -0.239116).  Saving model ...
Epoch: 2 cost time: 0.694678544998169
Epoch: 2, Steps: 9 | Train Loss: 1.372 Vali Loss: 1.376 Vali Acc: 0.297 Test Loss: 1.376 Test Acc: 0.297
Validation loss decreased (-0.239116 --> -0.297088).  Saving model ...
Epoch: 3 cost time: 0.6764590740203857
Epoch: 3, Steps: 9 | Train Loss: 1.320 Vali Loss: 1.333 Vali Acc: 0.406 Test Loss: 1.333 Test Acc: 0.406
Validation loss decreased (-0.297088 --> -0.405784).  Saving model ...
Epoch: 4 cost time: 0.6488041877746582
Epoch: 4, Steps: 9 | Train Loss: 1.281 Vali Loss: 1.280 Vali Acc: 0.514 Test Loss: 1.280 Test Acc: 0.514
Validation loss decreased (-0.405784 --> -0.514480).  Saving model ...
Epoch: 5 cost time: 0.647331714630127
Epoch: 5, Steps: 9 | Train Loss: 1.206 Vali Loss: 1.222 Vali Acc: 0.551 Test Loss: 1.222 Test Acc: 0.551
Validation loss decreased (-0.514480 --> -0.550712).  Saving model ...
Epoch: 6 cost time: 0.6289670467376709
Epoch: 6, Steps: 9 | Train Loss: 1.115 Vali Loss: 1.161 Vali Acc: 0.580 Test Loss: 1.161 Test Acc: 0.580
Validation loss decreased (-0.550712 --> -0.579699).  Saving model ...
Epoch: 7 cost time: 0.6546728610992432
Epoch: 7, Steps: 9 | Train Loss: 1.060 Vali Loss: 1.101 Vali Acc: 0.601 Test Loss: 1.101 Test Acc: 0.601
Validation loss decreased (-0.579699 --> -0.601438).  Saving model ...
Epoch: 8 cost time: 0.6990361213684082
Epoch: 8, Steps: 9 | Train Loss: 0.970 Vali Loss: 1.030 Vali Acc: 0.638 Test Loss: 1.030 Test Acc: 0.638
Validation loss decreased (-0.601438 --> -0.637671).  Saving model ...
Epoch: 9 cost time: 0.6735677719116211
Epoch: 9, Steps: 9 | Train Loss: 0.884 Vali Loss: 0.958 Vali Acc: 0.688 Test Loss: 0.958 Test Acc: 0.688
Validation loss decreased (-0.637671 --> -0.688396).  Saving model ...
Epoch: 10 cost time: 0.7069172859191895
Epoch: 10, Steps: 9 | Train Loss: 0.810 Vali Loss: 0.891 Vali Acc: 0.717 Test Loss: 0.891 Test Acc: 0.717
Validation loss decreased (-0.688396 --> -0.717382).  Saving model ...
Epoch: 11 cost time: 0.6919872760772705
Epoch: 11, Steps: 9 | Train Loss: 0.729 Vali Loss: 0.827 Vali Acc: 0.761 Test Loss: 0.827 Test Acc: 0.761
Validation loss decreased (-0.717382 --> -0.760861).  Saving model ...
Epoch: 12 cost time: 0.6524755954742432
Epoch: 12, Steps: 9 | Train Loss: 0.657 Vali Loss: 0.760 Vali Acc: 0.790 Test Loss: 0.760 Test Acc: 0.790
Validation loss decreased (-0.760861 --> -0.789847).  Saving model ...
Epoch: 13 cost time: 0.7000277042388916
Epoch: 13, Steps: 9 | Train Loss: 0.582 Vali Loss: 0.703 Vali Acc: 0.797 Test Loss: 0.703 Test Acc: 0.797
Validation loss decreased (-0.789847 --> -0.797094).  Saving model ...
Epoch: 14 cost time: 0.7143702507019043
Epoch: 14, Steps: 9 | Train Loss: 0.510 Vali Loss: 0.656 Vali Acc: 0.826 Test Loss: 0.656 Test Acc: 0.826
Validation loss decreased (-0.797094 --> -0.826080).  Saving model ...
Epoch: 15 cost time: 0.7071127891540527
Epoch: 15, Steps: 9 | Train Loss: 0.473 Vali Loss: 0.608 Vali Acc: 0.826 Test Loss: 0.608 Test Acc: 0.826
Validation loss decreased (-0.826080 --> -0.826081).  Saving model ...
Epoch: 16 cost time: 0.693692684173584
Epoch: 16, Steps: 9 | Train Loss: 0.430 Vali Loss: 0.560 Vali Acc: 0.841 Test Loss: 0.560 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 17 cost time: 0.7382681369781494
Epoch: 17, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.532 Vali Acc: 0.841 Test Loss: 0.532 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 18 cost time: 0.6723649501800537
Epoch: 18, Steps: 9 | Train Loss: 0.314 Vali Loss: 0.498 Vali Acc: 0.848 Test Loss: 0.498 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 19 cost time: 0.6597919464111328
Epoch: 19, Steps: 9 | Train Loss: 0.283 Vali Loss: 0.482 Vali Acc: 0.848 Test Loss: 0.482 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 20 cost time: 0.6636574268341064
Epoch: 20, Steps: 9 | Train Loss: 0.257 Vali Loss: 0.457 Vali Acc: 0.862 Test Loss: 0.457 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 21 cost time: 0.6972596645355225
Epoch: 21, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.438 Vali Acc: 0.862 Test Loss: 0.438 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 22 cost time: 0.6512336730957031
Epoch: 22, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.424 Vali Acc: 0.862 Test Loss: 0.424 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 23 cost time: 0.6010763645172119
Epoch: 23, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.413 Vali Acc: 0.862 Test Loss: 0.413 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 24 cost time: 0.6733534336090088
Epoch: 24, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.391 Vali Acc: 0.862 Test Loss: 0.391 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 25 cost time: 0.6934871673583984
Epoch: 25, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.382 Vali Acc: 0.855 Test Loss: 0.382 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6751143932342529
Epoch: 26, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.374 Vali Acc: 0.855 Test Loss: 0.374 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6766819953918457
Epoch: 27, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.362 Vali Acc: 0.870 Test Loss: 0.362 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 28 cost time: 0.6560873985290527
Epoch: 28, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.367 Vali Acc: 0.877 Test Loss: 0.367 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 29 cost time: 0.6545870304107666
Epoch: 29, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.361 Vali Acc: 0.877 Test Loss: 0.361 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 30 cost time: 0.6439785957336426
Epoch: 30, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.367 Vali Acc: 0.870 Test Loss: 0.367 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6718065738677979
Epoch: 31, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.378 Vali Acc: 0.870 Test Loss: 0.378 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7072663307189941
Epoch: 32, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.355 Vali Acc: 0.870 Test Loss: 0.355 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7107334136962891
Epoch: 33, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.335 Vali Acc: 0.870 Test Loss: 0.335 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.679774284362793
Epoch: 34, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.337 Vali Acc: 0.877 Test Loss: 0.337 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 35 cost time: 0.6447093486785889
Epoch: 35, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.343 Vali Acc: 0.877 Test Loss: 0.343 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6786959171295166
Epoch: 36, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.338 Vali Acc: 0.877 Test Loss: 0.338 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6699235439300537
Epoch: 37, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.323 Vali Acc: 0.884 Test Loss: 0.323 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 38 cost time: 0.6287071704864502
Epoch: 38, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.322 Vali Acc: 0.877 Test Loss: 0.322 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6190557479858398
Epoch: 39, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.336 Vali Acc: 0.884 Test Loss: 0.336 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6690943241119385
Epoch: 40, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.321 Vali Acc: 0.891 Test Loss: 0.321 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 41 cost time: 0.7213325500488281
Epoch: 41, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.333 Vali Acc: 0.891 Test Loss: 0.333 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.636796236038208
Epoch: 42, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.331 Vali Acc: 0.884 Test Loss: 0.331 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6375269889831543
Epoch: 43, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.324 Vali Acc: 0.891 Test Loss: 0.324 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5880825519561768
Epoch: 44, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.334 Vali Acc: 0.891 Test Loss: 0.334 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7161209583282471
Epoch: 45, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.347 Vali Acc: 0.899 Test Loss: 0.347 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 46 cost time: 0.6994504928588867
Epoch: 46, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.342 Vali Acc: 0.899 Test Loss: 0.342 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 47 cost time: 0.7298164367675781
Epoch: 47, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.320 Vali Acc: 0.899 Test Loss: 0.320 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898548).  Saving model ...
Epoch: 48 cost time: 0.6526124477386475
Epoch: 48, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.303 Vali Acc: 0.906 Test Loss: 0.303 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 49 cost time: 0.6385095119476318
Epoch: 49, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.309 Vali Acc: 0.906 Test Loss: 0.309 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.6303262710571289
Epoch: 50, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.345 Vali Acc: 0.884 Test Loss: 0.345 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 149124
model size : 0.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8548779487609863
Epoch: 1, Steps: 9 | Train Loss: 1.386 Vali Loss: 1.377 Vali Acc: 0.239 Test Loss: 1.377 Test Acc: 0.239
Validation loss decreased (inf --> -0.239117).  Saving model ...
Epoch: 2 cost time: 0.5962748527526855
Epoch: 2, Steps: 9 | Train Loss: 1.360 Vali Loss: 1.354 Vali Acc: 0.297 Test Loss: 1.354 Test Acc: 0.297
Validation loss decreased (-0.239117 --> -0.297088).  Saving model ...
Epoch: 3 cost time: 0.6305093765258789
Epoch: 3, Steps: 9 | Train Loss: 1.318 Vali Loss: 1.316 Vali Acc: 0.377 Test Loss: 1.316 Test Acc: 0.377
Validation loss decreased (-0.297088 --> -0.376798).  Saving model ...
Epoch: 4 cost time: 0.5988690853118896
Epoch: 4, Steps: 9 | Train Loss: 1.244 Vali Loss: 1.274 Vali Acc: 0.457 Test Loss: 1.274 Test Acc: 0.457
Validation loss decreased (-0.376798 --> -0.456509).  Saving model ...
Epoch: 5 cost time: 0.5997564792633057
Epoch: 5, Steps: 9 | Train Loss: 1.203 Vali Loss: 1.225 Vali Acc: 0.572 Test Loss: 1.225 Test Acc: 0.572
Validation loss decreased (-0.456509 --> -0.572452).  Saving model ...
Epoch: 6 cost time: 0.6776461601257324
Epoch: 6, Steps: 9 | Train Loss: 1.145 Vali Loss: 1.169 Vali Acc: 0.587 Test Loss: 1.169 Test Acc: 0.587
Validation loss decreased (-0.572452 --> -0.586945).  Saving model ...
Epoch: 7 cost time: 0.6808836460113525
Epoch: 7, Steps: 9 | Train Loss: 1.066 Vali Loss: 1.110 Vali Acc: 0.638 Test Loss: 1.110 Test Acc: 0.638
Validation loss decreased (-0.586945 --> -0.637670).  Saving model ...
Epoch: 8 cost time: 0.6349048614501953
Epoch: 8, Steps: 9 | Train Loss: 1.005 Vali Loss: 1.046 Vali Acc: 0.696 Test Loss: 1.046 Test Acc: 0.696
Validation loss decreased (-0.637670 --> -0.695642).  Saving model ...
Epoch: 9 cost time: 0.6865229606628418
Epoch: 9, Steps: 9 | Train Loss: 0.926 Vali Loss: 0.987 Vali Acc: 0.739 Test Loss: 0.987 Test Acc: 0.739
Validation loss decreased (-0.695642 --> -0.739121).  Saving model ...
Epoch: 10 cost time: 0.622100830078125
Epoch: 10, Steps: 9 | Train Loss: 0.851 Vali Loss: 0.919 Vali Acc: 0.783 Test Loss: 0.919 Test Acc: 0.783
Validation loss decreased (-0.739121 --> -0.782600).  Saving model ...
Epoch: 11 cost time: 0.6935627460479736
Epoch: 11, Steps: 9 | Train Loss: 0.782 Vali Loss: 0.860 Vali Acc: 0.790 Test Loss: 0.860 Test Acc: 0.790
Validation loss decreased (-0.782600 --> -0.789846).  Saving model ...
Epoch: 12 cost time: 0.6422290802001953
Epoch: 12, Steps: 9 | Train Loss: 0.703 Vali Loss: 0.788 Vali Acc: 0.804 Test Loss: 0.788 Test Acc: 0.804
Validation loss decreased (-0.789846 --> -0.804340).  Saving model ...
Epoch: 13 cost time: 0.6434078216552734
Epoch: 13, Steps: 9 | Train Loss: 0.621 Vali Loss: 0.724 Vali Acc: 0.804 Test Loss: 0.724 Test Acc: 0.804
Validation loss decreased (-0.804340 --> -0.804341).  Saving model ...
Epoch: 14 cost time: 0.6588761806488037
Epoch: 14, Steps: 9 | Train Loss: 0.554 Vali Loss: 0.683 Vali Acc: 0.812 Test Loss: 0.683 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811587).  Saving model ...
Epoch: 15 cost time: 0.6738183498382568
Epoch: 15, Steps: 9 | Train Loss: 0.502 Vali Loss: 0.645 Vali Acc: 0.833 Test Loss: 0.645 Test Acc: 0.833
Validation loss decreased (-0.811587 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 0.6243278980255127
Epoch: 16, Steps: 9 | Train Loss: 0.446 Vali Loss: 0.608 Vali Acc: 0.848 Test Loss: 0.608 Test Acc: 0.848
Validation loss decreased (-0.833327 --> -0.847820).  Saving model ...
Epoch: 17 cost time: 0.6851084232330322
Epoch: 17, Steps: 9 | Train Loss: 0.407 Vali Loss: 0.568 Vali Acc: 0.877 Test Loss: 0.568 Test Acc: 0.877
Validation loss decreased (-0.847820 --> -0.876806).  Saving model ...
Epoch: 18 cost time: 0.6934750080108643
Epoch: 18, Steps: 9 | Train Loss: 0.379 Vali Loss: 0.538 Vali Acc: 0.877 Test Loss: 0.538 Test Acc: 0.877
Validation loss decreased (-0.876806 --> -0.876806).  Saving model ...
Epoch: 19 cost time: 0.668281078338623
Epoch: 19, Steps: 9 | Train Loss: 0.313 Vali Loss: 0.508 Vali Acc: 0.891 Test Loss: 0.508 Test Acc: 0.891
Validation loss decreased (-0.876806 --> -0.891299).  Saving model ...
Epoch: 20 cost time: 0.6279380321502686
Epoch: 20, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.485 Vali Acc: 0.884 Test Loss: 0.485 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5660159587860107
Epoch: 21, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.466 Vali Acc: 0.891 Test Loss: 0.466 Test Acc: 0.891
Validation loss decreased (-0.891299 --> -0.891300).  Saving model ...
Epoch: 22 cost time: 0.645545244216919
Epoch: 22, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.447 Vali Acc: 0.899 Test Loss: 0.447 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898546).  Saving model ...
Epoch: 23 cost time: 0.652756929397583
Epoch: 23, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.432 Vali Acc: 0.899 Test Loss: 0.432 Test Acc: 0.899
Validation loss decreased (-0.898546 --> -0.898546).  Saving model ...
Epoch: 24 cost time: 0.7178099155426025
Epoch: 24, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.410 Vali Acc: 0.891 Test Loss: 0.410 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.642047643661499
Epoch: 25, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.398 Vali Acc: 0.891 Test Loss: 0.398 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.670264720916748
Epoch: 26, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.381 Vali Acc: 0.891 Test Loss: 0.381 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6336092948913574
Epoch: 27, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.371 Vali Acc: 0.891 Test Loss: 0.371 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6580202579498291
Epoch: 28, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.357 Vali Acc: 0.899 Test Loss: 0.357 Test Acc: 0.899
Validation loss decreased (-0.898546 --> -0.898547).  Saving model ...
Epoch: 29 cost time: 0.6390087604522705
Epoch: 29, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.343 Vali Acc: 0.899 Test Loss: 0.343 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 30 cost time: 0.6741414070129395
Epoch: 30, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.330 Vali Acc: 0.899 Test Loss: 0.330 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 31 cost time: 0.6220910549163818
Epoch: 31, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.328 Vali Acc: 0.899 Test Loss: 0.328 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 32 cost time: 0.6802842617034912
Epoch: 32, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.329 Vali Acc: 0.891 Test Loss: 0.329 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6564357280731201
Epoch: 33, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.329 Vali Acc: 0.891 Test Loss: 0.329 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6481053829193115
Epoch: 34, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.325 Vali Acc: 0.899 Test Loss: 0.325 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 35 cost time: 0.6632332801818848
Epoch: 35, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.329 Vali Acc: 0.891 Test Loss: 0.329 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6861882209777832
Epoch: 36, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.313 Vali Acc: 0.899 Test Loss: 0.313 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898548).  Saving model ...
Epoch: 37 cost time: 0.6946718692779541
Epoch: 37, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.313 Vali Acc: 0.906 Test Loss: 0.313 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 38 cost time: 0.5800614356994629
Epoch: 38, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.309 Vali Acc: 0.906 Test Loss: 0.309 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 39 cost time: 0.691896915435791
Epoch: 39, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.311 Vali Acc: 0.906 Test Loss: 0.311 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5825719833374023
Epoch: 40, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.320 Vali Acc: 0.899 Test Loss: 0.320 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.562952995300293
Epoch: 41, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.285 Vali Acc: 0.906 Test Loss: 0.285 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 42 cost time: 0.6978228092193604
Epoch: 42, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 43 cost time: 0.6635122299194336
Epoch: 43, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.275 Vali Acc: 0.920 Test Loss: 0.275 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920287).  Saving model ...
Epoch: 44 cost time: 0.6434249877929688
Epoch: 44, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.288 Vali Acc: 0.906 Test Loss: 0.288 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7251272201538086
Epoch: 45, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6528894901275635
Epoch: 46, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.290 Vali Acc: 0.906 Test Loss: 0.290 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6973626613616943
Epoch: 47, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.312 Vali Acc: 0.899 Test Loss: 0.312 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6288611888885498
Epoch: 48, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.293 Vali Acc: 0.899 Test Loss: 0.293 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.6270387172698975
Epoch: 49, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.294 Vali Acc: 0.913 Test Loss: 0.294 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.6354866027832031
Epoch: 50, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.289 Vali Acc: 0.920 Test Loss: 0.289 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 148708
model size : 0.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0598816871643066
Epoch: 1, Steps: 9 | Train Loss: 1.421 Vali Loss: 1.381 Vali Acc: 0.384 Test Loss: 1.381 Test Acc: 0.384
Validation loss decreased (inf --> -0.384044).  Saving model ...
Epoch: 2 cost time: 0.633333683013916
Epoch: 2, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.361 Vali Acc: 0.399 Test Loss: 1.361 Test Acc: 0.399
Validation loss decreased (-0.384044 --> -0.398537).  Saving model ...
Epoch: 3 cost time: 0.6624524593353271
Epoch: 3, Steps: 9 | Train Loss: 1.343 Vali Loss: 1.328 Vali Acc: 0.457 Test Loss: 1.328 Test Acc: 0.457
Validation loss decreased (-0.398537 --> -0.456508).  Saving model ...
Epoch: 4 cost time: 0.644024133682251
Epoch: 4, Steps: 9 | Train Loss: 1.300 Vali Loss: 1.279 Vali Acc: 0.522 Test Loss: 1.279 Test Acc: 0.522
Validation loss decreased (-0.456508 --> -0.521726).  Saving model ...
Epoch: 5 cost time: 0.6629595756530762
Epoch: 5, Steps: 9 | Train Loss: 1.229 Vali Loss: 1.226 Vali Acc: 0.609 Test Loss: 1.226 Test Acc: 0.609
Validation loss decreased (-0.521726 --> -0.608683).  Saving model ...
Epoch: 6 cost time: 0.6476573944091797
Epoch: 6, Steps: 9 | Train Loss: 1.159 Vali Loss: 1.170 Vali Acc: 0.623 Test Loss: 1.170 Test Acc: 0.623
Validation loss decreased (-0.608683 --> -0.623177).  Saving model ...
Epoch: 7 cost time: 0.652777910232544
Epoch: 7, Steps: 9 | Train Loss: 1.085 Vali Loss: 1.110 Vali Acc: 0.696 Test Loss: 1.110 Test Acc: 0.696
Validation loss decreased (-0.623177 --> -0.695641).  Saving model ...
Epoch: 8 cost time: 0.6679739952087402
Epoch: 8, Steps: 9 | Train Loss: 1.016 Vali Loss: 1.041 Vali Acc: 0.688 Test Loss: 1.041 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6334702968597412
Epoch: 9, Steps: 9 | Train Loss: 0.942 Vali Loss: 0.978 Vali Acc: 0.688 Test Loss: 0.978 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7138233184814453
Epoch: 10, Steps: 9 | Train Loss: 0.873 Vali Loss: 0.921 Vali Acc: 0.688 Test Loss: 0.921 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6239914894104004
Epoch: 11, Steps: 9 | Train Loss: 0.790 Vali Loss: 0.866 Vali Acc: 0.710 Test Loss: 0.866 Test Acc: 0.710
Validation loss decreased (-0.695641 --> -0.710136).  Saving model ...
Epoch: 12 cost time: 0.6707191467285156
Epoch: 12, Steps: 9 | Train Loss: 0.717 Vali Loss: 0.812 Vali Acc: 0.725 Test Loss: 0.812 Test Acc: 0.725
Validation loss decreased (-0.710136 --> -0.724630).  Saving model ...
Epoch: 13 cost time: 0.7369916439056396
Epoch: 13, Steps: 9 | Train Loss: 0.670 Vali Loss: 0.759 Vali Acc: 0.739 Test Loss: 0.759 Test Acc: 0.739
Validation loss decreased (-0.724630 --> -0.739123).  Saving model ...
Epoch: 14 cost time: 0.6490259170532227
Epoch: 14, Steps: 9 | Train Loss: 0.594 Vali Loss: 0.727 Vali Acc: 0.739 Test Loss: 0.727 Test Acc: 0.739
Validation loss decreased (-0.739123 --> -0.739123).  Saving model ...
Epoch: 15 cost time: 0.7596826553344727
Epoch: 15, Steps: 9 | Train Loss: 0.544 Vali Loss: 0.694 Vali Acc: 0.746 Test Loss: 0.694 Test Acc: 0.746
Validation loss decreased (-0.739123 --> -0.746370).  Saving model ...
Epoch: 16 cost time: 0.6776409149169922
Epoch: 16, Steps: 9 | Train Loss: 0.482 Vali Loss: 0.664 Vali Acc: 0.754 Test Loss: 0.664 Test Acc: 0.754
Validation loss decreased (-0.746370 --> -0.753617).  Saving model ...
Epoch: 17 cost time: 0.7149636745452881
Epoch: 17, Steps: 9 | Train Loss: 0.460 Vali Loss: 0.644 Vali Acc: 0.775 Test Loss: 0.644 Test Acc: 0.775
Validation loss decreased (-0.753617 --> -0.775356).  Saving model ...
Epoch: 18 cost time: 0.6470379829406738
Epoch: 18, Steps: 9 | Train Loss: 0.386 Vali Loss: 0.605 Vali Acc: 0.804 Test Loss: 0.605 Test Acc: 0.804
Validation loss decreased (-0.775356 --> -0.804342).  Saving model ...
Epoch: 19 cost time: 0.612004280090332
Epoch: 19, Steps: 9 | Train Loss: 0.374 Vali Loss: 0.590 Vali Acc: 0.804 Test Loss: 0.590 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 20 cost time: 0.6377441883087158
Epoch: 20, Steps: 9 | Train Loss: 0.336 Vali Loss: 0.573 Vali Acc: 0.819 Test Loss: 0.573 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818835).  Saving model ...
Epoch: 21 cost time: 0.6112134456634521
Epoch: 21, Steps: 9 | Train Loss: 0.324 Vali Loss: 0.542 Vali Acc: 0.819 Test Loss: 0.542 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 22 cost time: 0.6915497779846191
Epoch: 22, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.542 Vali Acc: 0.790 Test Loss: 0.542 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6644723415374756
Epoch: 23, Steps: 9 | Train Loss: 0.263 Vali Loss: 0.518 Vali Acc: 0.804 Test Loss: 0.518 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7019212245941162
Epoch: 24, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.507 Vali Acc: 0.804 Test Loss: 0.507 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7445008754730225
Epoch: 25, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.489 Vali Acc: 0.804 Test Loss: 0.489 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7026517391204834
Epoch: 26, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.466 Vali Acc: 0.826 Test Loss: 0.466 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 27 cost time: 0.5950641632080078
Epoch: 27, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.462 Vali Acc: 0.833 Test Loss: 0.462 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 28 cost time: 0.6833910942077637
Epoch: 28, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.448 Vali Acc: 0.833 Test Loss: 0.448 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 29 cost time: 0.6410963535308838
Epoch: 29, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.458 Vali Acc: 0.826 Test Loss: 0.458 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6469850540161133
Epoch: 30, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.456 Vali Acc: 0.826 Test Loss: 0.456 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6541612148284912
Epoch: 31, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.453 Vali Acc: 0.826 Test Loss: 0.453 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6292226314544678
Epoch: 32, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.437 Vali Acc: 0.819 Test Loss: 0.437 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6444377899169922
Epoch: 33, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.436 Vali Acc: 0.826 Test Loss: 0.436 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.695852518081665
Epoch: 34, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.443 Vali Acc: 0.826 Test Loss: 0.443 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7071812152862549
Epoch: 35, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.441 Vali Acc: 0.826 Test Loss: 0.441 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6271586418151855
Epoch: 36, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.430 Vali Acc: 0.826 Test Loss: 0.430 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6919207572937012
Epoch: 37, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.449 Vali Acc: 0.819 Test Loss: 0.449 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.6754307746887207
Epoch: 38, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.420 Vali Acc: 0.833 Test Loss: 0.420 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 39 cost time: 0.6311540603637695
Epoch: 39, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.401 Vali Acc: 0.841 Test Loss: 0.401 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840576).  Saving model ...
Epoch: 40 cost time: 0.656029462814331
Epoch: 40, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.374 Vali Acc: 0.862 Test Loss: 0.374 Test Acc: 0.862
Validation loss decreased (-0.840576 --> -0.862315).  Saving model ...
Epoch: 41 cost time: 0.6136219501495361
Epoch: 41, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.369 Vali Acc: 0.862 Test Loss: 0.369 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 42 cost time: 0.6654214859008789
Epoch: 42, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.401 Vali Acc: 0.848 Test Loss: 0.401 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5621590614318848
Epoch: 43, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.424 Vali Acc: 0.841 Test Loss: 0.424 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6947081089019775
Epoch: 44, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.428 Vali Acc: 0.841 Test Loss: 0.428 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5634517669677734
Epoch: 45, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.448 Vali Acc: 0.841 Test Loss: 0.448 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.5603373050689697
Epoch: 46, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.456 Vali Acc: 0.826 Test Loss: 0.456 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.6883163452148438
Epoch: 47, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.444 Vali Acc: 0.833 Test Loss: 0.444 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.6995179653167725
Epoch: 48, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.443 Vali Acc: 0.833 Test Loss: 0.443 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.6482052803039551
Epoch: 49, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.392 Vali Acc: 0.862 Test Loss: 0.392 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.769035816192627
Epoch: 50, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.377 Vali Acc: 0.862 Test Loss: 0.377 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 148260
model size : 0.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.6609623432159424
Epoch: 1, Steps: 9 | Train Loss: 1.315 Vali Loss: 1.235 Vali Acc: 0.486 Test Loss: 1.235 Test Acc: 0.486
Validation loss decreased (inf --> -0.485495).  Saving model ...
Epoch: 2 cost time: 1.309124231338501
Epoch: 2, Steps: 9 | Train Loss: 0.967 Vali Loss: 0.916 Vali Acc: 0.790 Test Loss: 0.916 Test Acc: 0.790
Validation loss decreased (-0.485495 --> -0.789846).  Saving model ...
Epoch: 3 cost time: 1.2331619262695312
Epoch: 3, Steps: 9 | Train Loss: 0.558 Vali Loss: 0.576 Vali Acc: 0.833 Test Loss: 0.576 Test Acc: 0.833
Validation loss decreased (-0.789846 --> -0.833328).  Saving model ...
Epoch: 4 cost time: 1.332432508468628
Epoch: 4, Steps: 9 | Train Loss: 0.255 Vali Loss: 0.328 Vali Acc: 0.928 Test Loss: 0.328 Test Acc: 0.928
Validation loss decreased (-0.833328 --> -0.927533).  Saving model ...
Epoch: 5 cost time: 1.151763916015625
Epoch: 5, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.236 Vali Acc: 0.935 Test Loss: 0.236 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934780).  Saving model ...
Epoch: 6 cost time: 1.0962769985198975
Epoch: 6, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.184 Vali Acc: 0.942 Test Loss: 0.184 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 7 cost time: 1.1405980587005615
Epoch: 7, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.192 Vali Acc: 0.928 Test Loss: 0.192 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0570487976074219
Epoch: 8, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.205 Vali Acc: 0.928 Test Loss: 0.205 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.174715518951416
Epoch: 9, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.928 Test Loss: 0.206 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1834008693695068
Epoch: 10, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.920 Test Loss: 0.214 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.170487880706787
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.920 Test Loss: 0.222 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1929576396942139
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.920 Test Loss: 0.221 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3480091094970703
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.920 Test Loss: 0.214 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2231383323669434
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.928 Test Loss: 0.209 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.218123197555542
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.928 Test Loss: 0.213 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2034926414489746
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.920 Test Loss: 0.222 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 2198404
model size : 8.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.2545762062072754
Epoch: 1, Steps: 9 | Train Loss: 1.366 Vali Loss: 1.301 Vali Acc: 0.399 Test Loss: 1.301 Test Acc: 0.399
Validation loss decreased (inf --> -0.398538).  Saving model ...
Epoch: 2 cost time: 0.9767379760742188
Epoch: 2, Steps: 9 | Train Loss: 1.139 Vali Loss: 1.096 Vali Acc: 0.703 Test Loss: 1.096 Test Acc: 0.703
Validation loss decreased (-0.398538 --> -0.702888).  Saving model ...
Epoch: 3 cost time: 0.9619758129119873
Epoch: 3, Steps: 9 | Train Loss: 0.844 Vali Loss: 0.825 Vali Acc: 0.804 Test Loss: 0.825 Test Acc: 0.804
Validation loss decreased (-0.702888 --> -0.804340).  Saving model ...
Epoch: 4 cost time: 0.9424788951873779
Epoch: 4, Steps: 9 | Train Loss: 0.551 Vali Loss: 0.604 Vali Acc: 0.862 Test Loss: 0.604 Test Acc: 0.862
Validation loss decreased (-0.804340 --> -0.862313).  Saving model ...
Epoch: 5 cost time: 0.9978725910186768
Epoch: 5, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.427 Vali Acc: 0.891 Test Loss: 0.427 Test Acc: 0.891
Validation loss decreased (-0.862313 --> -0.891300).  Saving model ...
Epoch: 6 cost time: 1.0902438163757324
Epoch: 6, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.311 Vali Acc: 0.913 Test Loss: 0.311 Test Acc: 0.913
Validation loss decreased (-0.891300 --> -0.913040).  Saving model ...
Epoch: 7 cost time: 0.9913685321807861
Epoch: 7, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.264 Vali Acc: 0.920 Test Loss: 0.264 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 8 cost time: 0.975456953048706
Epoch: 8, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.233 Vali Acc: 0.913 Test Loss: 0.233 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0170891284942627
Epoch: 9, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.228 Vali Acc: 0.913 Test Loss: 0.228 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.030785083770752
Epoch: 10, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.246 Vali Acc: 0.906 Test Loss: 0.246 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0087270736694336
Epoch: 11, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.244 Vali Acc: 0.913 Test Loss: 0.244 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0748412609100342
Epoch: 12, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.207 Vali Acc: 0.920 Test Loss: 0.207 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920288).  Saving model ...
Epoch: 13 cost time: 1.0295543670654297
Epoch: 13, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.928 Test Loss: 0.200 Test Acc: 0.928
Validation loss decreased (-0.920288 --> -0.927534).  Saving model ...
Epoch: 14 cost time: 1.0476484298706055
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.078620433807373
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 16 cost time: 1.0341496467590332
Epoch: 16, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.928 Test Loss: 0.200 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0469884872436523
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0484557151794434
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.913 Test Loss: 0.212 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1256999969482422
Epoch: 19, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.207 Vali Acc: 0.906 Test Loss: 0.207 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9956855773925781
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.928 Test Loss: 0.207 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9582903385162354
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.906 Test Loss: 0.214 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9813668727874756
Epoch: 22, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.216 Vali Acc: 0.913 Test Loss: 0.216 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9625439643859863
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.949 Test Loss: 0.129 Test Acc: 0.949
Validation loss decreased (-0.927534 --> -0.949274).  Saving model ...
Epoch: 24 cost time: 1.0054378509521484
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
Validation loss decreased (-0.949274 --> -0.956521).  Saving model ...
Epoch: 25 cost time: 0.9884781837463379
Epoch: 25, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.134 Vali Acc: 0.942 Test Loss: 0.134 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.064680814743042
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.957 Test Loss: 0.205 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.043961763381958
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.957 Test Loss: 0.219 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.053985357284546
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.949 Test Loss: 0.208 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1353521347045898
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.935 Test Loss: 0.200 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0894558429718018
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.928 Test Loss: 0.207 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.055138349533081
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1691532135009766
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.935 Test Loss: 0.199 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0899162292480469
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0108287334442139
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9565217391304348
model parameter : 2146820
model size : 8.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.3120758533477783
Epoch: 1, Steps: 9 | Train Loss: 1.335 Vali Loss: 1.277 Vali Acc: 0.464 Test Loss: 1.277 Test Acc: 0.464
Validation loss decreased (inf --> -0.463755).  Saving model ...
Epoch: 2 cost time: 1.1061978340148926
Epoch: 2, Steps: 9 | Train Loss: 1.140 Vali Loss: 1.110 Vali Acc: 0.616 Test Loss: 1.110 Test Acc: 0.616
Validation loss decreased (-0.463755 --> -0.615931).  Saving model ...
Epoch: 3 cost time: 1.0174274444580078
Epoch: 3, Steps: 9 | Train Loss: 0.888 Vali Loss: 0.893 Vali Acc: 0.746 Test Loss: 0.893 Test Acc: 0.746
Validation loss decreased (-0.615931 --> -0.746368).  Saving model ...
Epoch: 4 cost time: 1.0841314792633057
Epoch: 4, Steps: 9 | Train Loss: 0.629 Vali Loss: 0.687 Vali Acc: 0.862 Test Loss: 0.687 Test Acc: 0.862
Validation loss decreased (-0.746368 --> -0.862312).  Saving model ...
Epoch: 5 cost time: 0.9586951732635498
Epoch: 5, Steps: 9 | Train Loss: 0.398 Vali Loss: 0.498 Vali Acc: 0.899 Test Loss: 0.498 Test Acc: 0.899
Validation loss decreased (-0.862312 --> -0.898546).  Saving model ...
Epoch: 6 cost time: 1.0595333576202393
Epoch: 6, Steps: 9 | Train Loss: 0.250 Vali Loss: 0.380 Vali Acc: 0.928 Test Loss: 0.380 Test Acc: 0.928
Validation loss decreased (-0.898546 --> -0.927532).  Saving model ...
Epoch: 7 cost time: 1.1688735485076904
Epoch: 7, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.308 Vali Acc: 0.935 Test Loss: 0.308 Test Acc: 0.935
Validation loss decreased (-0.927532 --> -0.934780).  Saving model ...
Epoch: 8 cost time: 1.0185422897338867
Epoch: 8, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.275 Vali Acc: 0.920 Test Loss: 0.275 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.011936902999878
Epoch: 9, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.273 Vali Acc: 0.899 Test Loss: 0.273 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0931649208068848
Epoch: 10, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.243 Vali Acc: 0.928 Test Loss: 0.243 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.188671350479126
Epoch: 11, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.257 Vali Acc: 0.913 Test Loss: 0.257 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1007020473480225
Epoch: 12, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.261 Vali Acc: 0.906 Test Loss: 0.261 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.114713430404663
Epoch: 13, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1453075408935547
Epoch: 14, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.236 Vali Acc: 0.913 Test Loss: 0.236 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1453897953033447
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.238 Vali Acc: 0.906 Test Loss: 0.238 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1808428764343262
Epoch: 16, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.260 Vali Acc: 0.899 Test Loss: 0.260 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.062032699584961
Epoch: 17, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.261 Vali Acc: 0.906 Test Loss: 0.261 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 2135172
model size : 8.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.306652545928955
Epoch: 1, Steps: 9 | Train Loss: 1.408 Vali Loss: 1.354 Vali Acc: 0.319 Test Loss: 1.354 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 1.0259113311767578
Epoch: 2, Steps: 9 | Train Loss: 1.249 Vali Loss: 1.209 Vali Acc: 0.522 Test Loss: 1.209 Test Acc: 0.522
Validation loss decreased (-0.318827 --> -0.521727).  Saving model ...
Epoch: 3 cost time: 1.0790436267852783
Epoch: 3, Steps: 9 | Train Loss: 1.017 Vali Loss: 1.020 Vali Acc: 0.616 Test Loss: 1.020 Test Acc: 0.616
Validation loss decreased (-0.521727 --> -0.615932).  Saving model ...
Epoch: 4 cost time: 0.9544034004211426
Epoch: 4, Steps: 9 | Train Loss: 0.773 Vali Loss: 0.825 Vali Acc: 0.768 Test Loss: 0.825 Test Acc: 0.768
Validation loss decreased (-0.615932 --> -0.768108).  Saving model ...
Epoch: 5 cost time: 0.9674277305603027
Epoch: 5, Steps: 9 | Train Loss: 0.561 Vali Loss: 0.634 Vali Acc: 0.848 Test Loss: 0.634 Test Acc: 0.848
Validation loss decreased (-0.768108 --> -0.847820).  Saving model ...
Epoch: 6 cost time: 0.9829394817352295
Epoch: 6, Steps: 9 | Train Loss: 0.362 Vali Loss: 0.491 Vali Acc: 0.877 Test Loss: 0.491 Test Acc: 0.877
Validation loss decreased (-0.847820 --> -0.876807).  Saving model ...
Epoch: 7 cost time: 1.0269780158996582
Epoch: 7, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.398 Vali Acc: 0.913 Test Loss: 0.398 Test Acc: 0.913
Validation loss decreased (-0.876807 --> -0.913039).  Saving model ...
Epoch: 8 cost time: 0.9764745235443115
Epoch: 8, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.346 Vali Acc: 0.899 Test Loss: 0.346 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9484491348266602
Epoch: 9, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.339 Vali Acc: 0.884 Test Loss: 0.339 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.005171775817871
Epoch: 10, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.295 Vali Acc: 0.906 Test Loss: 0.295 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.048656940460205
Epoch: 11, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.276 Vali Acc: 0.928 Test Loss: 0.276 Test Acc: 0.928
Validation loss decreased (-0.913039 --> -0.927533).  Saving model ...
Epoch: 12 cost time: 0.9123859405517578
Epoch: 12, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.285 Vali Acc: 0.913 Test Loss: 0.285 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.930419921875
Epoch: 13, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.294 Vali Acc: 0.906 Test Loss: 0.294 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9125044345855713
Epoch: 14, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.279 Vali Acc: 0.906 Test Loss: 0.279 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.921440601348877
Epoch: 15, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.285 Vali Acc: 0.913 Test Loss: 0.285 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8741028308868408
Epoch: 16, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.276 Vali Acc: 0.913 Test Loss: 0.276 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9128131866455078
Epoch: 17, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.286 Vali Acc: 0.913 Test Loss: 0.286 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8278419971466064
Epoch: 18, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.290 Vali Acc: 0.906 Test Loss: 0.290 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8732779026031494
Epoch: 19, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.275 Vali Acc: 0.913 Test Loss: 0.275 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9049375057220459
Epoch: 20, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.261 Vali Acc: 0.920 Test Loss: 0.261 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9628641605377197
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.281 Vali Acc: 0.913 Test Loss: 0.281 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 2123524
model size : 8.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.408167600631714
Epoch: 1, Steps: 9 | Train Loss: 1.412 Vali Loss: 1.383 Vali Acc: 0.232 Test Loss: 1.383 Test Acc: 0.232
Validation loss decreased (inf --> -0.231870).  Saving model ...
Epoch: 2 cost time: 1.170736312866211
Epoch: 2, Steps: 9 | Train Loss: 1.265 Vali Loss: 1.263 Vali Acc: 0.587 Test Loss: 1.263 Test Acc: 0.587
Validation loss decreased (-0.231870 --> -0.586944).  Saving model ...
Epoch: 3 cost time: 1.1132335662841797
Epoch: 3, Steps: 9 | Train Loss: 1.075 Vali Loss: 1.091 Vali Acc: 0.667 Test Loss: 1.091 Test Acc: 0.667
Validation loss decreased (-0.586944 --> -0.666656).  Saving model ...
Epoch: 4 cost time: 1.017829179763794
Epoch: 4, Steps: 9 | Train Loss: 0.870 Vali Loss: 0.911 Vali Acc: 0.717 Test Loss: 0.911 Test Acc: 0.717
Validation loss decreased (-0.666656 --> -0.717382).  Saving model ...
Epoch: 5 cost time: 1.056931495666504
Epoch: 5, Steps: 9 | Train Loss: 0.678 Vali Loss: 0.739 Vali Acc: 0.775 Test Loss: 0.739 Test Acc: 0.775
Validation loss decreased (-0.717382 --> -0.775355).  Saving model ...
Epoch: 6 cost time: 0.9729139804840088
Epoch: 6, Steps: 9 | Train Loss: 0.492 Vali Loss: 0.620 Vali Acc: 0.812 Test Loss: 0.620 Test Acc: 0.812
Validation loss decreased (-0.775355 --> -0.811588).  Saving model ...
Epoch: 7 cost time: 0.943504810333252
Epoch: 7, Steps: 9 | Train Loss: 0.353 Vali Loss: 0.535 Vali Acc: 0.833 Test Loss: 0.535 Test Acc: 0.833
Validation loss decreased (-0.811588 --> -0.833328).  Saving model ...
Epoch: 8 cost time: 0.954566240310669
Epoch: 8, Steps: 9 | Train Loss: 0.250 Vali Loss: 0.449 Vali Acc: 0.848 Test Loss: 0.449 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847822).  Saving model ...
Epoch: 9 cost time: 1.001878261566162
Epoch: 9, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.404 Vali Acc: 0.855 Test Loss: 0.404 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 10 cost time: 1.0226705074310303
Epoch: 10, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.382 Vali Acc: 0.862 Test Loss: 0.382 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 11 cost time: 0.9091057777404785
Epoch: 11, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.387 Vali Acc: 0.870 Test Loss: 0.387 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 12 cost time: 1.006883144378662
Epoch: 12, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.362 Vali Acc: 0.870 Test Loss: 0.362 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869562).  Saving model ...
Epoch: 13 cost time: 1.0315842628479004
Epoch: 13, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.361 Vali Acc: 0.862 Test Loss: 0.361 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0362308025360107
Epoch: 14, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.354 Vali Acc: 0.884 Test Loss: 0.354 Test Acc: 0.884
Validation loss decreased (-0.869562 --> -0.884054).  Saving model ...
Epoch: 15 cost time: 1.0984687805175781
Epoch: 15, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.341 Vali Acc: 0.891 Test Loss: 0.341 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 16 cost time: 1.0558595657348633
Epoch: 16, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.344 Vali Acc: 0.884 Test Loss: 0.344 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1047701835632324
Epoch: 17, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.341 Vali Acc: 0.877 Test Loss: 0.341 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0692472457885742
Epoch: 18, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.322 Vali Acc: 0.899 Test Loss: 0.322 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 19 cost time: 1.0836153030395508
Epoch: 19, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.317 Vali Acc: 0.891 Test Loss: 0.317 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1845102310180664
Epoch: 20, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.321 Vali Acc: 0.891 Test Loss: 0.321 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9974722862243652
Epoch: 21, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.327 Vali Acc: 0.899 Test Loss: 0.327 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9903297424316406
Epoch: 22, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.335 Vali Acc: 0.891 Test Loss: 0.335 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0039384365081787
Epoch: 23, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.290 Vali Acc: 0.913 Test Loss: 0.290 Test Acc: 0.913
Validation loss decreased (-0.898548 --> -0.913041).  Saving model ...
Epoch: 24 cost time: 1.0293552875518799
Epoch: 24, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.285 Vali Acc: 0.913 Test Loss: 0.285 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 25 cost time: 1.0767080783843994
Epoch: 25, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.287 Vali Acc: 0.906 Test Loss: 0.287 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0117464065551758
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0251541137695312
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.318 Vali Acc: 0.906 Test Loss: 0.318 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.001847267150879
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.304 Vali Acc: 0.906 Test Loss: 0.304 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0459482669830322
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.304 Vali Acc: 0.913 Test Loss: 0.304 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0479528903961182
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.327 Vali Acc: 0.906 Test Loss: 0.327 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2259576320648193
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.324 Vali Acc: 0.906 Test Loss: 0.324 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1327919960021973
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.325 Vali Acc: 0.906 Test Loss: 0.325 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0126609802246094
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.334 Vali Acc: 0.899 Test Loss: 0.334 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.1765081882476807
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.334 Vali Acc: 0.906 Test Loss: 0.334 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 2115588
model size : 8.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.410609483718872
Epoch: 1, Steps: 9 | Train Loss: 1.391 Vali Loss: 1.367 Vali Acc: 0.275 Test Loss: 1.367 Test Acc: 0.275
Validation loss decreased (inf --> -0.275349).  Saving model ...
Epoch: 2 cost time: 1.0097391605377197
Epoch: 2, Steps: 9 | Train Loss: 1.298 Vali Loss: 1.265 Vali Acc: 0.500 Test Loss: 1.265 Test Acc: 0.500
Validation loss decreased (-0.275349 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 1.0425217151641846
Epoch: 3, Steps: 9 | Train Loss: 1.104 Vali Loss: 1.116 Vali Acc: 0.616 Test Loss: 1.116 Test Acc: 0.616
Validation loss decreased (-0.499987 --> -0.615931).  Saving model ...
Epoch: 4 cost time: 1.0387377738952637
Epoch: 4, Steps: 9 | Train Loss: 0.912 Vali Loss: 0.954 Vali Acc: 0.688 Test Loss: 0.954 Test Acc: 0.688
Validation loss decreased (-0.615931 --> -0.688396).  Saving model ...
Epoch: 5 cost time: 0.9830112457275391
Epoch: 5, Steps: 9 | Train Loss: 0.732 Vali Loss: 0.799 Vali Acc: 0.768 Test Loss: 0.799 Test Acc: 0.768
Validation loss decreased (-0.688396 --> -0.768108).  Saving model ...
Epoch: 6 cost time: 0.8761608600616455
Epoch: 6, Steps: 9 | Train Loss: 0.541 Vali Loss: 0.681 Vali Acc: 0.797 Test Loss: 0.681 Test Acc: 0.797
Validation loss decreased (-0.768108 --> -0.797095).  Saving model ...
Epoch: 7 cost time: 1.0662357807159424
Epoch: 7, Steps: 9 | Train Loss: 0.399 Vali Loss: 0.575 Vali Acc: 0.841 Test Loss: 0.575 Test Acc: 0.841
Validation loss decreased (-0.797095 --> -0.840574).  Saving model ...
Epoch: 8 cost time: 1.0989346504211426
Epoch: 8, Steps: 9 | Train Loss: 0.287 Vali Loss: 0.519 Vali Acc: 0.841 Test Loss: 0.519 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 9 cost time: 1.0759005546569824
Epoch: 9, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.474 Vali Acc: 0.841 Test Loss: 0.474 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 10 cost time: 1.0018513202667236
Epoch: 10, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.429 Vali Acc: 0.841 Test Loss: 0.429 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 11 cost time: 1.0928881168365479
Epoch: 11, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.436 Vali Acc: 0.848 Test Loss: 0.436 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 12 cost time: 1.0368576049804688
Epoch: 12, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.405 Vali Acc: 0.848 Test Loss: 0.405 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 13 cost time: 1.045888900756836
Epoch: 13, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.394 Vali Acc: 0.848 Test Loss: 0.394 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 14 cost time: 0.9894933700561523
Epoch: 14, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.388 Vali Acc: 0.848 Test Loss: 0.388 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 15 cost time: 1.074916124343872
Epoch: 15, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.398 Vali Acc: 0.870 Test Loss: 0.398 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869561).  Saving model ...
Epoch: 16 cost time: 0.9753146171569824
Epoch: 16, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.360 Vali Acc: 0.862 Test Loss: 0.360 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9823622703552246
Epoch: 17, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.366 Vali Acc: 0.870 Test Loss: 0.366 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869562).  Saving model ...
Epoch: 18 cost time: 1.0144011974334717
Epoch: 18, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.356 Vali Acc: 0.870 Test Loss: 0.356 Test Acc: 0.870
Validation loss decreased (-0.869562 --> -0.869562).  Saving model ...
Epoch: 19 cost time: 1.033094882965088
Epoch: 19, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.375 Vali Acc: 0.870 Test Loss: 0.375 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9705259799957275
Epoch: 20, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0428972244262695
Epoch: 21, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.388 Vali Acc: 0.870 Test Loss: 0.388 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9597091674804688
Epoch: 22, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.366 Vali Acc: 0.877 Test Loss: 0.366 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 23 cost time: 0.9361429214477539
Epoch: 23, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.366 Vali Acc: 0.870 Test Loss: 0.366 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0329885482788086
Epoch: 24, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.391 Vali Acc: 0.862 Test Loss: 0.391 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9040427207946777
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.335 Vali Acc: 0.891 Test Loss: 0.335 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 26 cost time: 1.0863707065582275
Epoch: 26, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.338 Vali Acc: 0.891 Test Loss: 0.338 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0575134754180908
Epoch: 27, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.366 Vali Acc: 0.862 Test Loss: 0.366 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0635275840759277
Epoch: 28, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.358 Vali Acc: 0.877 Test Loss: 0.358 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9969482421875
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.367 Vali Acc: 0.877 Test Loss: 0.367 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.043384075164795
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.375 Vali Acc: 0.870 Test Loss: 0.375 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1166267395019531
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.371 Vali Acc: 0.877 Test Loss: 0.371 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.068387508392334
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.375 Vali Acc: 0.877 Test Loss: 0.375 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1112782955169678
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.386 Vali Acc: 0.870 Test Loss: 0.386 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.1500918865203857
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.407 Vali Acc: 0.870 Test Loss: 0.407 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.0604031085968018
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.408 Vali Acc: 0.870 Test Loss: 0.408 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 2113924
model size : 8.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.302224636077881
Epoch: 1, Steps: 9 | Train Loss: 1.398 Vali Loss: 1.352 Vali Acc: 0.319 Test Loss: 1.352 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 0.9599010944366455
Epoch: 2, Steps: 9 | Train Loss: 1.292 Vali Loss: 1.266 Vali Acc: 0.457 Test Loss: 1.266 Test Acc: 0.457
Validation loss decreased (-0.318827 --> -0.456509).  Saving model ...
Epoch: 3 cost time: 0.9376542568206787
Epoch: 3, Steps: 9 | Train Loss: 1.130 Vali Loss: 1.137 Vali Acc: 0.572 Test Loss: 1.137 Test Acc: 0.572
Validation loss decreased (-0.456509 --> -0.572452).  Saving model ...
Epoch: 4 cost time: 0.9443178176879883
Epoch: 4, Steps: 9 | Train Loss: 0.960 Vali Loss: 0.990 Vali Acc: 0.674 Test Loss: 0.990 Test Acc: 0.674
Validation loss decreased (-0.572452 --> -0.673903).  Saving model ...
Epoch: 5 cost time: 0.9266130924224854
Epoch: 5, Steps: 9 | Train Loss: 0.786 Vali Loss: 0.847 Vali Acc: 0.783 Test Loss: 0.847 Test Acc: 0.783
Validation loss decreased (-0.673903 --> -0.782600).  Saving model ...
Epoch: 6 cost time: 0.9276537895202637
Epoch: 6, Steps: 9 | Train Loss: 0.616 Vali Loss: 0.720 Vali Acc: 0.797 Test Loss: 0.720 Test Acc: 0.797
Validation loss decreased (-0.782600 --> -0.797094).  Saving model ...
Epoch: 7 cost time: 0.9887144565582275
Epoch: 7, Steps: 9 | Train Loss: 0.480 Vali Loss: 0.623 Vali Acc: 0.826 Test Loss: 0.623 Test Acc: 0.826
Validation loss decreased (-0.797094 --> -0.826081).  Saving model ...
Epoch: 8 cost time: 0.9952082633972168
Epoch: 8, Steps: 9 | Train Loss: 0.388 Vali Loss: 0.558 Vali Acc: 0.841 Test Loss: 0.558 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 9 cost time: 0.9584169387817383
Epoch: 9, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.493 Vali Acc: 0.855 Test Loss: 0.493 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855068).  Saving model ...
Epoch: 10 cost time: 0.9569981098175049
Epoch: 10, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.454 Vali Acc: 0.848 Test Loss: 0.454 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9703776836395264
Epoch: 11, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.431 Vali Acc: 0.848 Test Loss: 0.431 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.920881986618042
Epoch: 12, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.440 Vali Acc: 0.841 Test Loss: 0.440 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9531829357147217
Epoch: 13, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.414 Vali Acc: 0.833 Test Loss: 0.414 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9335336685180664
Epoch: 14, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.403 Vali Acc: 0.833 Test Loss: 0.403 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8561995029449463
Epoch: 15, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.389 Vali Acc: 0.841 Test Loss: 0.389 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8883867263793945
Epoch: 16, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.368 Vali Acc: 0.848 Test Loss: 0.368 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8609054088592529
Epoch: 17, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.396 Vali Acc: 0.848 Test Loss: 0.396 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8846876621246338
Epoch: 18, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.395 Vali Acc: 0.841 Test Loss: 0.395 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8906261920928955
Epoch: 19, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.392 Vali Acc: 0.848 Test Loss: 0.392 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 2112132
model size : 8.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.3751041889190674
Epoch: 1, Steps: 9 | Train Loss: 1.361 Vali Loss: 1.317 Vali Acc: 0.391 Test Loss: 1.317 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 0.9176671504974365
Epoch: 2, Steps: 9 | Train Loss: 1.152 Vali Loss: 1.116 Vali Acc: 0.580 Test Loss: 1.116 Test Acc: 0.580
Validation loss decreased (-0.391291 --> -0.579699).  Saving model ...
Epoch: 3 cost time: 0.8741118907928467
Epoch: 3, Steps: 9 | Train Loss: 0.844 Vali Loss: 0.877 Vali Acc: 0.775 Test Loss: 0.877 Test Acc: 0.775
Validation loss decreased (-0.579699 --> -0.775354).  Saving model ...
Epoch: 4 cost time: 0.8979001045227051
Epoch: 4, Steps: 9 | Train Loss: 0.564 Vali Loss: 0.642 Vali Acc: 0.833 Test Loss: 0.642 Test Acc: 0.833
Validation loss decreased (-0.775354 --> -0.833327).  Saving model ...
Epoch: 5 cost time: 0.8931179046630859
Epoch: 5, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.448 Vali Acc: 0.877 Test Loss: 0.448 Test Acc: 0.877
Validation loss decreased (-0.833327 --> -0.876807).  Saving model ...
Epoch: 6 cost time: 0.9592108726501465
Epoch: 6, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.329 Vali Acc: 0.913 Test Loss: 0.329 Test Acc: 0.913
Validation loss decreased (-0.876807 --> -0.913040).  Saving model ...
Epoch: 7 cost time: 0.752272367477417
Epoch: 7, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.269 Vali Acc: 0.920 Test Loss: 0.269 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 8 cost time: 0.8851361274719238
Epoch: 8, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.248 Vali Acc: 0.913 Test Loss: 0.248 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7787947654724121
Epoch: 9, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.232 Vali Acc: 0.920 Test Loss: 0.232 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920288).  Saving model ...
Epoch: 10 cost time: 0.8629512786865234
Epoch: 10, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.239 Vali Acc: 0.920 Test Loss: 0.239 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.692511796951294
Epoch: 11, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.239 Vali Acc: 0.920 Test Loss: 0.239 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8056471347808838
Epoch: 12, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.215 Vali Acc: 0.928 Test Loss: 0.215 Test Acc: 0.928
Validation loss decreased (-0.920288 --> -0.927534).  Saving model ...
Epoch: 13 cost time: 0.7835605144500732
Epoch: 13, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.210 Vali Acc: 0.920 Test Loss: 0.210 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8172621726989746
Epoch: 14, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.240 Vali Acc: 0.920 Test Loss: 0.240 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.816788911819458
Epoch: 15, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.219 Vali Acc: 0.920 Test Loss: 0.219 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.884993314743042
Epoch: 16, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.208 Vali Acc: 0.920 Test Loss: 0.208 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9119763374328613
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.920 Test Loss: 0.212 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8881247043609619
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.920 Test Loss: 0.217 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9241156578063965
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.920 Test Loss: 0.213 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9259593486785889
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.208 Vali Acc: 0.920 Test Loss: 0.208 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.91335129737854
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.920 Test Loss: 0.214 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.893439531326294
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.920 Test Loss: 0.213 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 591300
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.182976484298706
Epoch: 1, Steps: 9 | Train Loss: 1.320 Vali Loss: 1.303 Vali Acc: 0.449 Test Loss: 1.303 Test Acc: 0.449
Validation loss decreased (inf --> -0.449262).  Saving model ...
Epoch: 2 cost time: 0.6961984634399414
Epoch: 2, Steps: 9 | Train Loss: 1.212 Vali Loss: 1.192 Vali Acc: 0.514 Test Loss: 1.192 Test Acc: 0.514
Validation loss decreased (-0.449262 --> -0.514481).  Saving model ...
Epoch: 3 cost time: 0.7179560661315918
Epoch: 3, Steps: 9 | Train Loss: 1.030 Vali Loss: 1.042 Vali Acc: 0.616 Test Loss: 1.042 Test Acc: 0.616
Validation loss decreased (-0.514481 --> -0.615932).  Saving model ...
Epoch: 4 cost time: 0.7696762084960938
Epoch: 4, Steps: 9 | Train Loss: 0.856 Vali Loss: 0.879 Vali Acc: 0.710 Test Loss: 0.879 Test Acc: 0.710
Validation loss decreased (-0.615932 --> -0.710136).  Saving model ...
Epoch: 5 cost time: 0.7767946720123291
Epoch: 5, Steps: 9 | Train Loss: 0.669 Vali Loss: 0.708 Vali Acc: 0.775 Test Loss: 0.708 Test Acc: 0.775
Validation loss decreased (-0.710136 --> -0.775355).  Saving model ...
Epoch: 6 cost time: 0.7246308326721191
Epoch: 6, Steps: 9 | Train Loss: 0.491 Vali Loss: 0.559 Vali Acc: 0.862 Test Loss: 0.559 Test Acc: 0.862
Validation loss decreased (-0.775355 --> -0.862313).  Saving model ...
Epoch: 7 cost time: 0.724632978439331
Epoch: 7, Steps: 9 | Train Loss: 0.325 Vali Loss: 0.443 Vali Acc: 0.913 Test Loss: 0.443 Test Acc: 0.913
Validation loss decreased (-0.862313 --> -0.913039).  Saving model ...
Epoch: 8 cost time: 0.7343389987945557
Epoch: 8, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.372 Vali Acc: 0.891 Test Loss: 0.372 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8150835037231445
Epoch: 9, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.332 Vali Acc: 0.920 Test Loss: 0.332 Test Acc: 0.920
Validation loss decreased (-0.913039 --> -0.920287).  Saving model ...
Epoch: 10 cost time: 0.8406813144683838
Epoch: 10, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.297 Vali Acc: 0.920 Test Loss: 0.297 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 11 cost time: 0.80379319190979
Epoch: 11, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.277 Vali Acc: 0.913 Test Loss: 0.277 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8135123252868652
Epoch: 12, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.250 Vali Acc: 0.935 Test Loss: 0.250 Test Acc: 0.935
Validation loss decreased (-0.920287 --> -0.934780).  Saving model ...
Epoch: 13 cost time: 0.795090913772583
Epoch: 13, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.251 Vali Acc: 0.935 Test Loss: 0.251 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.775951623916626
Epoch: 14, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.238 Vali Acc: 0.928 Test Loss: 0.238 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7947177886962891
Epoch: 15, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8150773048400879
Epoch: 16, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7778341770172119
Epoch: 17, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.246 Vali Acc: 0.920 Test Loss: 0.246 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8157806396484375
Epoch: 18, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.250 Vali Acc: 0.920 Test Loss: 0.250 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7757108211517334
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.236 Vali Acc: 0.920 Test Loss: 0.236 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7742547988891602
Epoch: 20, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.226 Vali Acc: 0.928 Test Loss: 0.226 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.794910192489624
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.213 Vali Acc: 0.928 Test Loss: 0.213 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7609291076660156
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 565508
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1003098487854004
Epoch: 1, Steps: 9 | Train Loss: 1.461 Vali Loss: 1.388 Vali Acc: 0.275 Test Loss: 1.388 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 0.8205118179321289
Epoch: 2, Steps: 9 | Train Loss: 1.323 Vali Loss: 1.287 Vali Acc: 0.514 Test Loss: 1.287 Test Acc: 0.514
Validation loss decreased (-0.275348 --> -0.514480).  Saving model ...
Epoch: 3 cost time: 0.8147921562194824
Epoch: 3, Steps: 9 | Train Loss: 1.159 Vali Loss: 1.143 Vali Acc: 0.681 Test Loss: 1.143 Test Acc: 0.681
Validation loss decreased (-0.514480 --> -0.681148).  Saving model ...
Epoch: 4 cost time: 0.8338198661804199
Epoch: 4, Steps: 9 | Train Loss: 0.980 Vali Loss: 0.989 Vali Acc: 0.710 Test Loss: 0.989 Test Acc: 0.710
Validation loss decreased (-0.681148 --> -0.710135).  Saving model ...
Epoch: 5 cost time: 0.7840964794158936
Epoch: 5, Steps: 9 | Train Loss: 0.807 Vali Loss: 0.830 Vali Acc: 0.790 Test Loss: 0.830 Test Acc: 0.790
Validation loss decreased (-0.710135 --> -0.789847).  Saving model ...
Epoch: 6 cost time: 0.8096857070922852
Epoch: 6, Steps: 9 | Train Loss: 0.632 Vali Loss: 0.671 Vali Acc: 0.862 Test Loss: 0.671 Test Acc: 0.862
Validation loss decreased (-0.789847 --> -0.862312).  Saving model ...
Epoch: 7 cost time: 0.7924532890319824
Epoch: 7, Steps: 9 | Train Loss: 0.474 Vali Loss: 0.541 Vali Acc: 0.899 Test Loss: 0.541 Test Acc: 0.899
Validation loss decreased (-0.862312 --> -0.898545).  Saving model ...
Epoch: 8 cost time: 0.7728362083435059
Epoch: 8, Steps: 9 | Train Loss: 0.342 Vali Loss: 0.442 Vali Acc: 0.928 Test Loss: 0.442 Test Acc: 0.928
Validation loss decreased (-0.898545 --> -0.927532).  Saving model ...
Epoch: 9 cost time: 0.7204577922821045
Epoch: 9, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.382 Vali Acc: 0.935 Test Loss: 0.382 Test Acc: 0.935
Validation loss decreased (-0.927532 --> -0.934779).  Saving model ...
Epoch: 10 cost time: 0.8777868747711182
Epoch: 10, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.336 Vali Acc: 0.928 Test Loss: 0.336 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.795557975769043
Epoch: 11, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.302 Vali Acc: 0.913 Test Loss: 0.302 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7844438552856445
Epoch: 12, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.277 Vali Acc: 0.928 Test Loss: 0.277 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9294698238372803
Epoch: 13, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.256 Vali Acc: 0.928 Test Loss: 0.256 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7209892272949219
Epoch: 14, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.257 Vali Acc: 0.928 Test Loss: 0.257 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7847044467926025
Epoch: 15, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.256 Vali Acc: 0.920 Test Loss: 0.256 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7440879344940186
Epoch: 16, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.242 Vali Acc: 0.913 Test Loss: 0.242 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.746757984161377
Epoch: 17, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.228 Vali Acc: 0.913 Test Loss: 0.228 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7332336902618408
Epoch: 18, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.231 Vali Acc: 0.913 Test Loss: 0.231 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7350537776947021
Epoch: 19, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.240 Vali Acc: 0.913 Test Loss: 0.240 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 559684
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1155507564544678
Epoch: 1, Steps: 9 | Train Loss: 1.378 Vali Loss: 1.359 Vali Acc: 0.319 Test Loss: 1.359 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 0.7736101150512695
Epoch: 2, Steps: 9 | Train Loss: 1.315 Vali Loss: 1.296 Vali Acc: 0.420 Test Loss: 1.296 Test Acc: 0.420
Validation loss decreased (-0.318827 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 0.7626607418060303
Epoch: 3, Steps: 9 | Train Loss: 1.194 Vali Loss: 1.196 Vali Acc: 0.478 Test Loss: 1.196 Test Acc: 0.478
Validation loss decreased (-0.420277 --> -0.478249).  Saving model ...
Epoch: 4 cost time: 0.7837822437286377
Epoch: 4, Steps: 9 | Train Loss: 1.048 Vali Loss: 1.080 Vali Acc: 0.536 Test Loss: 1.080 Test Acc: 0.536
Validation loss decreased (-0.478249 --> -0.536221).  Saving model ...
Epoch: 5 cost time: 0.794184684753418
Epoch: 5, Steps: 9 | Train Loss: 0.924 Vali Loss: 0.959 Vali Acc: 0.638 Test Loss: 0.959 Test Acc: 0.638
Validation loss decreased (-0.536221 --> -0.637672).  Saving model ...
Epoch: 6 cost time: 0.8241968154907227
Epoch: 6, Steps: 9 | Train Loss: 0.763 Vali Loss: 0.833 Vali Acc: 0.754 Test Loss: 0.833 Test Acc: 0.754
Validation loss decreased (-0.637672 --> -0.753615).  Saving model ...
Epoch: 7 cost time: 0.8133184909820557
Epoch: 7, Steps: 9 | Train Loss: 0.624 Vali Loss: 0.725 Vali Acc: 0.819 Test Loss: 0.725 Test Acc: 0.819
Validation loss decreased (-0.753615 --> -0.818833).  Saving model ...
Epoch: 8 cost time: 0.7793159484863281
Epoch: 8, Steps: 9 | Train Loss: 0.488 Vali Loss: 0.619 Vali Acc: 0.848 Test Loss: 0.619 Test Acc: 0.848
Validation loss decreased (-0.818833 --> -0.847820).  Saving model ...
Epoch: 9 cost time: 0.827730655670166
Epoch: 9, Steps: 9 | Train Loss: 0.392 Vali Loss: 0.538 Vali Acc: 0.855 Test Loss: 0.538 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855067).  Saving model ...
Epoch: 10 cost time: 0.6932649612426758
Epoch: 10, Steps: 9 | Train Loss: 0.299 Vali Loss: 0.476 Vali Acc: 0.870 Test Loss: 0.476 Test Acc: 0.870
Validation loss decreased (-0.855067 --> -0.869560).  Saving model ...
Epoch: 11 cost time: 0.803389310836792
Epoch: 11, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.426 Vali Acc: 0.891 Test Loss: 0.426 Test Acc: 0.891
Validation loss decreased (-0.869560 --> -0.891300).  Saving model ...
Epoch: 12 cost time: 0.767296552658081
Epoch: 12, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.392 Vali Acc: 0.884 Test Loss: 0.392 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8543868064880371
Epoch: 13, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.372 Vali Acc: 0.891 Test Loss: 0.372 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891301).  Saving model ...
Epoch: 14 cost time: 0.8668739795684814
Epoch: 14, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.342 Vali Acc: 0.891 Test Loss: 0.342 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 15 cost time: 0.7890458106994629
Epoch: 15, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.332 Vali Acc: 0.891 Test Loss: 0.332 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 16 cost time: 0.7753641605377197
Epoch: 16, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.313 Vali Acc: 0.906 Test Loss: 0.313 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 17 cost time: 0.784282922744751
Epoch: 17, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.321 Vali Acc: 0.899 Test Loss: 0.321 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8074662685394287
Epoch: 18, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.335 Vali Acc: 0.891 Test Loss: 0.335 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8176441192626953
Epoch: 19, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.321 Vali Acc: 0.899 Test Loss: 0.321 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7992935180664062
Epoch: 20, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.306 Vali Acc: 0.899 Test Loss: 0.306 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7912042140960693
Epoch: 21, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.287 Vali Acc: 0.913 Test Loss: 0.287 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 22 cost time: 0.84543776512146
Epoch: 22, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.284 Vali Acc: 0.913 Test Loss: 0.284 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 23 cost time: 0.8050284385681152
Epoch: 23, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.288 Vali Acc: 0.913 Test Loss: 0.288 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8162579536437988
Epoch: 24, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.272 Vali Acc: 0.920 Test Loss: 0.272 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 25 cost time: 0.840308666229248
Epoch: 25, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.274 Vali Acc: 0.920 Test Loss: 0.274 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.847435712814331
Epoch: 26, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.792694091796875
Epoch: 27, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.275 Vali Acc: 0.913 Test Loss: 0.275 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8186802864074707
Epoch: 28, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.269 Vali Acc: 0.920 Test Loss: 0.269 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 29 cost time: 0.8077771663665771
Epoch: 29, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.272 Vali Acc: 0.920 Test Loss: 0.272 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8006000518798828
Epoch: 30, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.279 Vali Acc: 0.913 Test Loss: 0.279 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7457807064056396
Epoch: 31, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.276 Vali Acc: 0.906 Test Loss: 0.276 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8132236003875732
Epoch: 32, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.272 Vali Acc: 0.920 Test Loss: 0.272 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8204843997955322
Epoch: 33, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.267 Vali Acc: 0.913 Test Loss: 0.267 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7661693096160889
Epoch: 34, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.263 Vali Acc: 0.920 Test Loss: 0.263 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 35 cost time: 0.7429637908935547
Epoch: 35, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.272 Vali Acc: 0.920 Test Loss: 0.272 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8298578262329102
Epoch: 36, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.284 Vali Acc: 0.891 Test Loss: 0.284 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8173177242279053
Epoch: 37, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.302 Vali Acc: 0.884 Test Loss: 0.302 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8159902095794678
Epoch: 38, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.239 Vali Acc: 0.913 Test Loss: 0.239 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7166893482208252
Epoch: 39, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.223 Vali Acc: 0.928 Test Loss: 0.223 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 40 cost time: 0.7994542121887207
Epoch: 40, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.225 Vali Acc: 0.920 Test Loss: 0.225 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8024547100067139
Epoch: 41, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.920 Test Loss: 0.239 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7356266975402832
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.920 Test Loss: 0.245 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.805370569229126
Epoch: 43, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.913 Test Loss: 0.253 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8283801078796387
Epoch: 44, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.266 Vali Acc: 0.906 Test Loss: 0.266 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.7703688144683838
Epoch: 45, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.920 Test Loss: 0.267 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8196802139282227
Epoch: 46, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.913 Test Loss: 0.270 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.8073217868804932
Epoch: 47, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.273 Vali Acc: 0.913 Test Loss: 0.273 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.7995753288269043
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.268 Vali Acc: 0.920 Test Loss: 0.268 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.7996518611907959
Epoch: 49, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.273 Vali Acc: 0.920 Test Loss: 0.273 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 553860
model size : 2.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.2459652423858643
Epoch: 1, Steps: 9 | Train Loss: 1.388 Vali Loss: 1.360 Vali Acc: 0.341 Test Loss: 1.360 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 0.8383228778839111
Epoch: 2, Steps: 9 | Train Loss: 1.327 Vali Loss: 1.306 Vali Acc: 0.399 Test Loss: 1.306 Test Acc: 0.399
Validation loss decreased (-0.340566 --> -0.398538).  Saving model ...
Epoch: 3 cost time: 0.7646567821502686
Epoch: 3, Steps: 9 | Train Loss: 1.241 Vali Loss: 1.224 Vali Acc: 0.507 Test Loss: 1.224 Test Acc: 0.507
Validation loss decreased (-0.398538 --> -0.507234).  Saving model ...
Epoch: 4 cost time: 0.7236263751983643
Epoch: 4, Steps: 9 | Train Loss: 1.126 Vali Loss: 1.126 Vali Acc: 0.638 Test Loss: 1.126 Test Acc: 0.638
Validation loss decreased (-0.507234 --> -0.637670).  Saving model ...
Epoch: 5 cost time: 0.8511919975280762
Epoch: 5, Steps: 9 | Train Loss: 0.999 Vali Loss: 1.028 Vali Acc: 0.681 Test Loss: 1.028 Test Acc: 0.681
Validation loss decreased (-0.637670 --> -0.681149).  Saving model ...
Epoch: 6 cost time: 0.7965478897094727
Epoch: 6, Steps: 9 | Train Loss: 0.883 Vali Loss: 0.922 Vali Acc: 0.725 Test Loss: 0.922 Test Acc: 0.725
Validation loss decreased (-0.681149 --> -0.724628).  Saving model ...
Epoch: 7 cost time: 0.8903741836547852
Epoch: 7, Steps: 9 | Train Loss: 0.779 Vali Loss: 0.823 Vali Acc: 0.754 Test Loss: 0.823 Test Acc: 0.754
Validation loss decreased (-0.724628 --> -0.753615).  Saving model ...
Epoch: 8 cost time: 0.8288166522979736
Epoch: 8, Steps: 9 | Train Loss: 0.639 Vali Loss: 0.734 Vali Acc: 0.790 Test Loss: 0.734 Test Acc: 0.790
Validation loss decreased (-0.753615 --> -0.789848).  Saving model ...
Epoch: 9 cost time: 0.8915727138519287
Epoch: 9, Steps: 9 | Train Loss: 0.551 Vali Loss: 0.652 Vali Acc: 0.833 Test Loss: 0.652 Test Acc: 0.833
Validation loss decreased (-0.789848 --> -0.833327).  Saving model ...
Epoch: 10 cost time: 0.908649206161499
Epoch: 10, Steps: 9 | Train Loss: 0.452 Vali Loss: 0.576 Vali Acc: 0.841 Test Loss: 0.576 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840574).  Saving model ...
Epoch: 11 cost time: 0.9031534194946289
Epoch: 11, Steps: 9 | Train Loss: 0.361 Vali Loss: 0.515 Vali Acc: 0.862 Test Loss: 0.515 Test Acc: 0.862
Validation loss decreased (-0.840574 --> -0.862314).  Saving model ...
Epoch: 12 cost time: 0.9761905670166016
Epoch: 12, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.476 Vali Acc: 0.855 Test Loss: 0.476 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9204034805297852
Epoch: 13, Steps: 9 | Train Loss: 0.262 Vali Loss: 0.430 Vali Acc: 0.862 Test Loss: 0.430 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 14 cost time: 0.9219141006469727
Epoch: 14, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.412 Vali Acc: 0.870 Test Loss: 0.412 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 15 cost time: 0.9322655200958252
Epoch: 15, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.382 Vali Acc: 0.877 Test Loss: 0.382 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 16 cost time: 0.9142117500305176
Epoch: 16, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.373 Vali Acc: 0.862 Test Loss: 0.373 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8396012783050537
Epoch: 17, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.353 Vali Acc: 0.891 Test Loss: 0.353 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 18 cost time: 0.8811793327331543
Epoch: 18, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.337 Vali Acc: 0.884 Test Loss: 0.337 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9500524997711182
Epoch: 19, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.328 Vali Acc: 0.906 Test Loss: 0.328 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 20 cost time: 0.9208962917327881
Epoch: 20, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.315 Vali Acc: 0.906 Test Loss: 0.315 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 21 cost time: 0.8546092510223389
Epoch: 21, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.312 Vali Acc: 0.899 Test Loss: 0.312 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8860740661621094
Epoch: 22, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.317 Vali Acc: 0.906 Test Loss: 0.317 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8617653846740723
Epoch: 23, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.310 Vali Acc: 0.906 Test Loss: 0.310 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 24 cost time: 1.0132052898406982
Epoch: 24, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.317 Vali Acc: 0.899 Test Loss: 0.317 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.878476619720459
Epoch: 25, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.306 Vali Acc: 0.906 Test Loss: 0.306 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 26 cost time: 0.9122238159179688
Epoch: 26, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.307 Vali Acc: 0.906 Test Loss: 0.307 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9226772785186768
Epoch: 27, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.299 Vali Acc: 0.913 Test Loss: 0.299 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 28 cost time: 0.898127555847168
Epoch: 28, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.299 Vali Acc: 0.913 Test Loss: 0.299 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 29 cost time: 0.8758769035339355
Epoch: 29, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.291 Vali Acc: 0.920 Test Loss: 0.291 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 30 cost time: 0.8969249725341797
Epoch: 30, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.255 Vali Acc: 0.920 Test Loss: 0.255 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 31 cost time: 0.9518337249755859
Epoch: 31, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.246 Vali Acc: 0.920 Test Loss: 0.246 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 32 cost time: 0.847041130065918
Epoch: 32, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.245 Vali Acc: 0.928 Test Loss: 0.245 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 33 cost time: 0.9095776081085205
Epoch: 33, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.250 Vali Acc: 0.928 Test Loss: 0.250 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.912550687789917
Epoch: 34, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.272 Vali Acc: 0.928 Test Loss: 0.272 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9140760898590088
Epoch: 35, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.292 Vali Acc: 0.913 Test Loss: 0.292 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9450478553771973
Epoch: 36, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.285 Vali Acc: 0.920 Test Loss: 0.285 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8270053863525391
Epoch: 37, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.289 Vali Acc: 0.920 Test Loss: 0.289 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9184830188751221
Epoch: 38, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.284 Vali Acc: 0.928 Test Loss: 0.284 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9483523368835449
Epoch: 39, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.280 Vali Acc: 0.928 Test Loss: 0.280 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8555514812469482
Epoch: 40, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.272 Vali Acc: 0.928 Test Loss: 0.272 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.8861682415008545
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.265 Vali Acc: 0.928 Test Loss: 0.265 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.8893251419067383
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.271 Vali Acc: 0.928 Test Loss: 0.271 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 549892
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0837645530700684
Epoch: 1, Steps: 9 | Train Loss: 1.400 Vali Loss: 1.363 Vali Acc: 0.391 Test Loss: 1.363 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 0.7273585796356201
Epoch: 2, Steps: 9 | Train Loss: 1.324 Vali Loss: 1.307 Vali Acc: 0.457 Test Loss: 1.307 Test Acc: 0.457
Validation loss decreased (-0.391291 --> -0.456509).  Saving model ...
Epoch: 3 cost time: 0.7394297122955322
Epoch: 3, Steps: 9 | Train Loss: 1.229 Vali Loss: 1.222 Vali Acc: 0.616 Test Loss: 1.222 Test Acc: 0.616
Validation loss decreased (-0.456509 --> -0.615930).  Saving model ...
Epoch: 4 cost time: 0.7366197109222412
Epoch: 4, Steps: 9 | Train Loss: 1.121 Vali Loss: 1.120 Vali Acc: 0.667 Test Loss: 1.120 Test Acc: 0.667
Validation loss decreased (-0.615930 --> -0.666655).  Saving model ...
Epoch: 5 cost time: 0.7737078666687012
Epoch: 5, Steps: 9 | Train Loss: 0.999 Vali Loss: 1.016 Vali Acc: 0.739 Test Loss: 1.016 Test Acc: 0.739
Validation loss decreased (-0.666655 --> -0.739120).  Saving model ...
Epoch: 6 cost time: 0.7552821636199951
Epoch: 6, Steps: 9 | Train Loss: 0.876 Vali Loss: 0.921 Vali Acc: 0.754 Test Loss: 0.921 Test Acc: 0.754
Validation loss decreased (-0.739120 --> -0.753614).  Saving model ...
Epoch: 7 cost time: 0.7382214069366455
Epoch: 7, Steps: 9 | Train Loss: 0.740 Vali Loss: 0.826 Vali Acc: 0.783 Test Loss: 0.826 Test Acc: 0.783
Validation loss decreased (-0.753614 --> -0.782600).  Saving model ...
Epoch: 8 cost time: 0.6884679794311523
Epoch: 8, Steps: 9 | Train Loss: 0.632 Vali Loss: 0.737 Vali Acc: 0.768 Test Loss: 0.737 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6866285800933838
Epoch: 9, Steps: 9 | Train Loss: 0.543 Vali Loss: 0.666 Vali Acc: 0.783 Test Loss: 0.666 Test Acc: 0.783
Validation loss decreased (-0.782600 --> -0.782602).  Saving model ...
Epoch: 10 cost time: 0.7386248111724854
Epoch: 10, Steps: 9 | Train Loss: 0.448 Vali Loss: 0.618 Vali Acc: 0.819 Test Loss: 0.618 Test Acc: 0.819
Validation loss decreased (-0.782602 --> -0.818834).  Saving model ...
Epoch: 11 cost time: 0.7009775638580322
Epoch: 11, Steps: 9 | Train Loss: 0.376 Vali Loss: 0.569 Vali Acc: 0.826 Test Loss: 0.569 Test Acc: 0.826
Validation loss decreased (-0.818834 --> -0.826081).  Saving model ...
Epoch: 12 cost time: 0.7092490196228027
Epoch: 12, Steps: 9 | Train Loss: 0.312 Vali Loss: 0.531 Vali Acc: 0.848 Test Loss: 0.531 Test Acc: 0.848
Validation loss decreased (-0.826081 --> -0.847821).  Saving model ...
Epoch: 13 cost time: 0.6130783557891846
Epoch: 13, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.499 Vali Acc: 0.848 Test Loss: 0.499 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 14 cost time: 0.6475355625152588
Epoch: 14, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.457 Vali Acc: 0.862 Test Loss: 0.457 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 15 cost time: 0.6498849391937256
Epoch: 15, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.436 Vali Acc: 0.870 Test Loss: 0.436 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 16 cost time: 0.6606950759887695
Epoch: 16, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.430 Vali Acc: 0.870 Test Loss: 0.430 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 17 cost time: 0.6004102230072021
Epoch: 17, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.406 Vali Acc: 0.870 Test Loss: 0.406 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 18 cost time: 0.6846888065338135
Epoch: 18, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.411 Vali Acc: 0.877 Test Loss: 0.411 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 19 cost time: 0.7402808666229248
Epoch: 19, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.414 Vali Acc: 0.877 Test Loss: 0.414 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7340242862701416
Epoch: 20, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.382 Vali Acc: 0.906 Test Loss: 0.382 Test Acc: 0.906
Validation loss decreased (-0.876807 --> -0.905793).  Saving model ...
Epoch: 21 cost time: 0.7359879016876221
Epoch: 21, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.366 Vali Acc: 0.877 Test Loss: 0.366 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7281374931335449
Epoch: 22, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.362 Vali Acc: 0.877 Test Loss: 0.362 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.750267505645752
Epoch: 23, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.364 Vali Acc: 0.899 Test Loss: 0.364 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6882972717285156
Epoch: 24, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.363 Vali Acc: 0.899 Test Loss: 0.363 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7459361553192139
Epoch: 25, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.391 Vali Acc: 0.891 Test Loss: 0.391 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.709195613861084
Epoch: 26, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.380 Vali Acc: 0.891 Test Loss: 0.380 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7011284828186035
Epoch: 27, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.366 Vali Acc: 0.899 Test Loss: 0.366 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7223415374755859
Epoch: 28, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.349 Vali Acc: 0.899 Test Loss: 0.349 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6974396705627441
Epoch: 29, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.347 Vali Acc: 0.899 Test Loss: 0.347 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6889150142669678
Epoch: 30, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.374 Vali Acc: 0.899 Test Loss: 0.374 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 549060
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0335874557495117
Epoch: 1, Steps: 9 | Train Loss: 1.380 Vali Loss: 1.362 Vali Acc: 0.319 Test Loss: 1.362 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 0.8325092792510986
Epoch: 2, Steps: 9 | Train Loss: 1.325 Vali Loss: 1.320 Vali Acc: 0.406 Test Loss: 1.320 Test Acc: 0.406
Validation loss decreased (-0.318827 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 0.7487883567810059
Epoch: 3, Steps: 9 | Train Loss: 1.234 Vali Loss: 1.253 Vali Acc: 0.500 Test Loss: 1.253 Test Acc: 0.500
Validation loss decreased (-0.405784 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.7998826503753662
Epoch: 4, Steps: 9 | Train Loss: 1.148 Vali Loss: 1.172 Vali Acc: 0.558 Test Loss: 1.172 Test Acc: 0.558
Validation loss decreased (-0.499987 --> -0.557959).  Saving model ...
Epoch: 5 cost time: 0.8038730621337891
Epoch: 5, Steps: 9 | Train Loss: 1.046 Vali Loss: 1.089 Vali Acc: 0.609 Test Loss: 1.089 Test Acc: 0.609
Validation loss decreased (-0.557959 --> -0.608685).  Saving model ...
Epoch: 6 cost time: 0.7695717811584473
Epoch: 6, Steps: 9 | Train Loss: 0.951 Vali Loss: 1.001 Vali Acc: 0.674 Test Loss: 1.001 Test Acc: 0.674
Validation loss decreased (-0.608685 --> -0.673903).  Saving model ...
Epoch: 7 cost time: 0.8118054866790771
Epoch: 7, Steps: 9 | Train Loss: 0.840 Vali Loss: 0.917 Vali Acc: 0.739 Test Loss: 0.917 Test Acc: 0.739
Validation loss decreased (-0.673903 --> -0.739121).  Saving model ...
Epoch: 8 cost time: 0.7953333854675293
Epoch: 8, Steps: 9 | Train Loss: 0.758 Vali Loss: 0.837 Vali Acc: 0.739 Test Loss: 0.837 Test Acc: 0.739
Validation loss decreased (-0.739121 --> -0.739122).  Saving model ...
Epoch: 9 cost time: 0.6956069469451904
Epoch: 9, Steps: 9 | Train Loss: 0.679 Vali Loss: 0.760 Vali Acc: 0.768 Test Loss: 0.760 Test Acc: 0.768
Validation loss decreased (-0.739122 --> -0.768108).  Saving model ...
Epoch: 10 cost time: 0.7547070980072021
Epoch: 10, Steps: 9 | Train Loss: 0.557 Vali Loss: 0.701 Vali Acc: 0.790 Test Loss: 0.701 Test Acc: 0.790
Validation loss decreased (-0.768108 --> -0.789848).  Saving model ...
Epoch: 11 cost time: 0.7440447807312012
Epoch: 11, Steps: 9 | Train Loss: 0.474 Vali Loss: 0.645 Vali Acc: 0.819 Test Loss: 0.645 Test Acc: 0.819
Validation loss decreased (-0.789848 --> -0.818834).  Saving model ...
Epoch: 12 cost time: 0.7325708866119385
Epoch: 12, Steps: 9 | Train Loss: 0.425 Vali Loss: 0.596 Vali Acc: 0.819 Test Loss: 0.596 Test Acc: 0.819
Validation loss decreased (-0.818834 --> -0.818835).  Saving model ...
Epoch: 13 cost time: 0.7323815822601318
Epoch: 13, Steps: 9 | Train Loss: 0.358 Vali Loss: 0.563 Vali Acc: 0.819 Test Loss: 0.563 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 14 cost time: 0.7377235889434814
Epoch: 14, Steps: 9 | Train Loss: 0.301 Vali Loss: 0.539 Vali Acc: 0.812 Test Loss: 0.539 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7761924266815186
Epoch: 15, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.506 Vali Acc: 0.833 Test Loss: 0.506 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 16 cost time: 0.7730951309204102
Epoch: 16, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.476 Vali Acc: 0.833 Test Loss: 0.476 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 17 cost time: 0.7641253471374512
Epoch: 17, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.460 Vali Acc: 0.833 Test Loss: 0.460 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 18 cost time: 0.7982089519500732
Epoch: 18, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.442 Vali Acc: 0.833 Test Loss: 0.442 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 19 cost time: 0.6783874034881592
Epoch: 19, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.431 Vali Acc: 0.833 Test Loss: 0.431 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 20 cost time: 0.7252693176269531
Epoch: 20, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.413 Vali Acc: 0.841 Test Loss: 0.413 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840576).  Saving model ...
Epoch: 21 cost time: 0.7234039306640625
Epoch: 21, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.404 Vali Acc: 0.841 Test Loss: 0.404 Test Acc: 0.841
Validation loss decreased (-0.840576 --> -0.840576).  Saving model ...
Epoch: 22 cost time: 0.6919424533843994
Epoch: 22, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.414 Vali Acc: 0.833 Test Loss: 0.414 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6724908351898193
Epoch: 23, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.393 Vali Acc: 0.841 Test Loss: 0.393 Test Acc: 0.841
Validation loss decreased (-0.840576 --> -0.840576).  Saving model ...
Epoch: 24 cost time: 0.6628568172454834
Epoch: 24, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.390 Vali Acc: 0.841 Test Loss: 0.390 Test Acc: 0.841
Validation loss decreased (-0.840576 --> -0.840576).  Saving model ...
Epoch: 25 cost time: 0.6801581382751465
Epoch: 25, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.388 Vali Acc: 0.841 Test Loss: 0.388 Test Acc: 0.841
Validation loss decreased (-0.840576 --> -0.840576).  Saving model ...
Epoch: 26 cost time: 0.747626543045044
Epoch: 26, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.370 Vali Acc: 0.848 Test Loss: 0.370 Test Acc: 0.848
Validation loss decreased (-0.840576 --> -0.847822).  Saving model ...
Epoch: 27 cost time: 0.7335245609283447
Epoch: 27, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.367 Vali Acc: 0.855 Test Loss: 0.367 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 28 cost time: 0.7580671310424805
Epoch: 28, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.376 Vali Acc: 0.848 Test Loss: 0.376 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7486848831176758
Epoch: 29, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.379 Vali Acc: 0.855 Test Loss: 0.379 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8703305721282959
Epoch: 30, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.357 Vali Acc: 0.855 Test Loss: 0.357 Test Acc: 0.855
Validation loss decreased (-0.855069 --> -0.855069).  Saving model ...
Epoch: 31 cost time: 0.8216521739959717
Epoch: 31, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.356 Vali Acc: 0.862 Test Loss: 0.356 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 32 cost time: 0.8291022777557373
Epoch: 32, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.364 Vali Acc: 0.862 Test Loss: 0.364 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.750218391418457
Epoch: 33, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.366 Vali Acc: 0.855 Test Loss: 0.366 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7603182792663574
Epoch: 34, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.381 Vali Acc: 0.855 Test Loss: 0.381 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8189136981964111
Epoch: 35, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.385 Vali Acc: 0.862 Test Loss: 0.385 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7514629364013672
Epoch: 36, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.387 Vali Acc: 0.862 Test Loss: 0.387 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6935279369354248
Epoch: 37, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.397 Vali Acc: 0.862 Test Loss: 0.397 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.6868181228637695
Epoch: 38, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.407 Vali Acc: 0.862 Test Loss: 0.407 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7151992321014404
Epoch: 39, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.389 Vali Acc: 0.862 Test Loss: 0.389 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.7717721462249756
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.363 Vali Acc: 0.862 Test Loss: 0.363 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.8278157711029053
Epoch: 41, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.350 Vali Acc: 0.877 Test Loss: 0.350 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 42 cost time: 0.7593622207641602
Epoch: 42, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.340 Vali Acc: 0.870 Test Loss: 0.340 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.825695276260376
Epoch: 43, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.347 Vali Acc: 0.870 Test Loss: 0.347 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8005785942077637
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.347 Vali Acc: 0.870 Test Loss: 0.347 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.770719051361084
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.354 Vali Acc: 0.862 Test Loss: 0.354 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.7657203674316406
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.361 Vali Acc: 0.862 Test Loss: 0.361 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.7192573547363281
Epoch: 47, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.377 Vali Acc: 0.862 Test Loss: 0.377 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.7341227531433105
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.369 Vali Acc: 0.862 Test Loss: 0.369 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.7613394260406494
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.369 Vali Acc: 0.870 Test Loss: 0.369 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.8390212059020996
Epoch: 50, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.338 Vali Acc: 0.870 Test Loss: 0.338 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 548164
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.08107328414917
Epoch: 1, Steps: 9 | Train Loss: 1.351 Vali Loss: 1.332 Vali Acc: 0.377 Test Loss: 1.332 Test Acc: 0.377
Validation loss decreased (inf --> -0.376798).  Saving model ...
Epoch: 2 cost time: 0.7589702606201172
Epoch: 2, Steps: 9 | Train Loss: 1.229 Vali Loss: 1.204 Vali Acc: 0.543 Test Loss: 1.204 Test Acc: 0.543
Validation loss decreased (-0.376798 --> -0.543466).  Saving model ...
Epoch: 3 cost time: 0.7760813236236572
Epoch: 3, Steps: 9 | Train Loss: 1.054 Vali Loss: 1.033 Vali Acc: 0.667 Test Loss: 1.033 Test Acc: 0.667
Validation loss decreased (-0.543466 --> -0.666656).  Saving model ...
Epoch: 4 cost time: 0.7834038734436035
Epoch: 4, Steps: 9 | Train Loss: 0.841 Vali Loss: 0.870 Vali Acc: 0.783 Test Loss: 0.870 Test Acc: 0.783
Validation loss decreased (-0.666656 --> -0.782600).  Saving model ...
Epoch: 5 cost time: 0.6819522380828857
Epoch: 5, Steps: 9 | Train Loss: 0.662 Vali Loss: 0.717 Vali Acc: 0.783 Test Loss: 0.717 Test Acc: 0.783
Validation loss decreased (-0.782600 --> -0.782602).  Saving model ...
Epoch: 6 cost time: 0.7290370464324951
Epoch: 6, Steps: 9 | Train Loss: 0.473 Vali Loss: 0.573 Vali Acc: 0.833 Test Loss: 0.573 Test Acc: 0.833
Validation loss decreased (-0.782602 --> -0.833328).  Saving model ...
Epoch: 7 cost time: 0.7315754890441895
Epoch: 7, Steps: 9 | Train Loss: 0.346 Vali Loss: 0.473 Vali Acc: 0.855 Test Loss: 0.473 Test Acc: 0.855
Validation loss decreased (-0.833328 --> -0.855068).  Saving model ...
Epoch: 8 cost time: 0.7123949527740479
Epoch: 8, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.394 Vali Acc: 0.899 Test Loss: 0.394 Test Acc: 0.899
Validation loss decreased (-0.855068 --> -0.898547).  Saving model ...
Epoch: 9 cost time: 0.7087047100067139
Epoch: 9, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.319 Vali Acc: 0.920 Test Loss: 0.319 Test Acc: 0.920
Validation loss decreased (-0.898547 --> -0.920287).  Saving model ...
Epoch: 10 cost time: 0.7042191028594971
Epoch: 10, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.283 Vali Acc: 0.920 Test Loss: 0.283 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 11 cost time: 0.7287027835845947
Epoch: 11, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.280 Vali Acc: 0.928 Test Loss: 0.280 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927533).  Saving model ...
Epoch: 12 cost time: 0.7185759544372559
Epoch: 12, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.272 Vali Acc: 0.920 Test Loss: 0.272 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6581594944000244
Epoch: 13, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.249 Vali Acc: 0.928 Test Loss: 0.249 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927534).  Saving model ...
Epoch: 14 cost time: 0.7472167015075684
Epoch: 14, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.233 Vali Acc: 0.935 Test Loss: 0.233 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 15 cost time: 0.7193903923034668
Epoch: 15, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.230 Vali Acc: 0.935 Test Loss: 0.230 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 16 cost time: 0.6873691082000732
Epoch: 16, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.221 Vali Acc: 0.942 Test Loss: 0.221 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 17 cost time: 0.7710268497467041
Epoch: 17, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.214 Vali Acc: 0.942 Test Loss: 0.214 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 18 cost time: 0.7570421695709229
Epoch: 18, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.206 Vali Acc: 0.949 Test Loss: 0.206 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949273).  Saving model ...
Epoch: 19 cost time: 0.7490105628967285
Epoch: 19, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.209 Vali Acc: 0.942 Test Loss: 0.209 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7927849292755127
Epoch: 20, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.206 Vali Acc: 0.942 Test Loss: 0.206 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7424709796905518
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.198 Vali Acc: 0.942 Test Loss: 0.198 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6311731338500977
Epoch: 22, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.192 Vali Acc: 0.942 Test Loss: 0.192 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6928281784057617
Epoch: 23, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.193 Vali Acc: 0.942 Test Loss: 0.193 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8087060451507568
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.191 Vali Acc: 0.942 Test Loss: 0.191 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7198729515075684
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.187 Vali Acc: 0.942 Test Loss: 0.187 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7532296180725098
Epoch: 26, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.181 Vali Acc: 0.942 Test Loss: 0.181 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7502572536468506
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949274).  Saving model ...
Epoch: 28 cost time: 0.7276861667633057
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.184 Vali Acc: 0.949 Test Loss: 0.184 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6906948089599609
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6914827823638916
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7304513454437256
Epoch: 31, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.194 Vali Acc: 0.942 Test Loss: 0.194 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7826581001281738
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.935 Test Loss: 0.194 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7317173480987549
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.935 Test Loss: 0.192 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7265546321868896
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.935 Test Loss: 0.186 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7685115337371826
Epoch: 35, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.198 Vali Acc: 0.942 Test Loss: 0.198 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.737316370010376
Epoch: 36, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.942 Test Loss: 0.194 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.7301757335662842
Epoch: 37, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.942 Test Loss: 0.188 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 168676
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1045033931732178
Epoch: 1, Steps: 9 | Train Loss: 1.406 Vali Loss: 1.355 Vali Acc: 0.304 Test Loss: 1.355 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 0.7220394611358643
Epoch: 2, Steps: 9 | Train Loss: 1.332 Vali Loss: 1.294 Vali Acc: 0.413 Test Loss: 1.294 Test Acc: 0.413
Validation loss decreased (-0.304334 --> -0.413031).  Saving model ...
Epoch: 3 cost time: 0.7557098865509033
Epoch: 3, Steps: 9 | Train Loss: 1.231 Vali Loss: 1.200 Vali Acc: 0.500 Test Loss: 1.200 Test Acc: 0.500
Validation loss decreased (-0.413031 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.7507414817810059
Epoch: 4, Steps: 9 | Train Loss: 1.121 Vali Loss: 1.093 Vali Acc: 0.594 Test Loss: 1.093 Test Acc: 0.594
Validation loss decreased (-0.499988 --> -0.594192).  Saving model ...
Epoch: 5 cost time: 0.7761054039001465
Epoch: 5, Steps: 9 | Train Loss: 1.004 Vali Loss: 0.980 Vali Acc: 0.645 Test Loss: 0.980 Test Acc: 0.645
Validation loss decreased (-0.594192 --> -0.644918).  Saving model ...
Epoch: 6 cost time: 0.7183835506439209
Epoch: 6, Steps: 9 | Train Loss: 0.847 Vali Loss: 0.871 Vali Acc: 0.768 Test Loss: 0.871 Test Acc: 0.768
Validation loss decreased (-0.644918 --> -0.768107).  Saving model ...
Epoch: 7 cost time: 0.7903213500976562
Epoch: 7, Steps: 9 | Train Loss: 0.730 Vali Loss: 0.761 Vali Acc: 0.812 Test Loss: 0.761 Test Acc: 0.812
Validation loss decreased (-0.768107 --> -0.811587).  Saving model ...
Epoch: 8 cost time: 0.7493917942047119
Epoch: 8, Steps: 9 | Train Loss: 0.615 Vali Loss: 0.658 Vali Acc: 0.848 Test Loss: 0.658 Test Acc: 0.848
Validation loss decreased (-0.811587 --> -0.847820).  Saving model ...
Epoch: 9 cost time: 0.8127048015594482
Epoch: 9, Steps: 9 | Train Loss: 0.487 Vali Loss: 0.566 Vali Acc: 0.870 Test Loss: 0.566 Test Acc: 0.870
Validation loss decreased (-0.847820 --> -0.869560).  Saving model ...
Epoch: 10 cost time: 0.7140836715698242
Epoch: 10, Steps: 9 | Train Loss: 0.407 Vali Loss: 0.492 Vali Acc: 0.913 Test Loss: 0.492 Test Acc: 0.913
Validation loss decreased (-0.869560 --> -0.913039).  Saving model ...
Epoch: 11 cost time: 0.7234320640563965
Epoch: 11, Steps: 9 | Train Loss: 0.325 Vali Loss: 0.427 Vali Acc: 0.913 Test Loss: 0.427 Test Acc: 0.913
Validation loss decreased (-0.913039 --> -0.913039).  Saving model ...
Epoch: 12 cost time: 0.7537412643432617
Epoch: 12, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.377 Vali Acc: 0.920 Test Loss: 0.377 Test Acc: 0.920
Validation loss decreased (-0.913039 --> -0.920286).  Saving model ...
Epoch: 13 cost time: 0.7177181243896484
Epoch: 13, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.340 Vali Acc: 0.920 Test Loss: 0.340 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 14 cost time: 0.6509721279144287
Epoch: 14, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.318 Vali Acc: 0.920 Test Loss: 0.318 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920287).  Saving model ...
Epoch: 15 cost time: 0.6404879093170166
Epoch: 15, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.285 Vali Acc: 0.935 Test Loss: 0.285 Test Acc: 0.935
Validation loss decreased (-0.920287 --> -0.934780).  Saving model ...
Epoch: 16 cost time: 0.6893374919891357
Epoch: 16, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.273 Vali Acc: 0.942 Test Loss: 0.273 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942026).  Saving model ...
Epoch: 17 cost time: 0.6451430320739746
Epoch: 17, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.257 Vali Acc: 0.935 Test Loss: 0.257 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6481447219848633
Epoch: 18, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.251 Vali Acc: 0.928 Test Loss: 0.251 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6252083778381348
Epoch: 19, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.244 Vali Acc: 0.920 Test Loss: 0.244 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7503190040588379
Epoch: 20, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.236 Vali Acc: 0.935 Test Loss: 0.236 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7083659172058105
Epoch: 21, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.223 Vali Acc: 0.935 Test Loss: 0.223 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7368273735046387
Epoch: 22, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.219 Vali Acc: 0.935 Test Loss: 0.219 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7837576866149902
Epoch: 23, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7513020038604736
Epoch: 24, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.219 Vali Acc: 0.935 Test Loss: 0.219 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7858927249908447
Epoch: 25, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7082479000091553
Epoch: 26, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 155780
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.017517566680908
Epoch: 1, Steps: 9 | Train Loss: 1.443 Vali Loss: 1.402 Vali Acc: 0.304 Test Loss: 1.402 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 0.6347718238830566
Epoch: 2, Steps: 9 | Train Loss: 1.388 Vali Loss: 1.363 Vali Acc: 0.384 Test Loss: 1.363 Test Acc: 0.384
Validation loss decreased (-0.304334 --> -0.384044).  Saving model ...
Epoch: 3 cost time: 0.7228460311889648
Epoch: 3, Steps: 9 | Train Loss: 1.305 Vali Loss: 1.298 Vali Acc: 0.449 Test Loss: 1.298 Test Acc: 0.449
Validation loss decreased (-0.384044 --> -0.449262).  Saving model ...
Epoch: 4 cost time: 0.6997828483581543
Epoch: 4, Steps: 9 | Train Loss: 1.209 Vali Loss: 1.210 Vali Acc: 0.500 Test Loss: 1.210 Test Acc: 0.500
Validation loss decreased (-0.449262 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.8111445903778076
Epoch: 5, Steps: 9 | Train Loss: 1.075 Vali Loss: 1.123 Vali Acc: 0.551 Test Loss: 1.123 Test Acc: 0.551
Validation loss decreased (-0.499988 --> -0.550713).  Saving model ...
Epoch: 6 cost time: 0.7127869129180908
Epoch: 6, Steps: 9 | Train Loss: 0.979 Vali Loss: 1.026 Vali Acc: 0.609 Test Loss: 1.026 Test Acc: 0.609
Validation loss decreased (-0.550713 --> -0.608685).  Saving model ...
Epoch: 7 cost time: 0.7799389362335205
Epoch: 7, Steps: 9 | Train Loss: 0.854 Vali Loss: 0.927 Vali Acc: 0.667 Test Loss: 0.927 Test Acc: 0.667
Validation loss decreased (-0.608685 --> -0.666657).  Saving model ...
Epoch: 8 cost time: 0.8304705619812012
Epoch: 8, Steps: 9 | Train Loss: 0.729 Vali Loss: 0.833 Vali Acc: 0.768 Test Loss: 0.833 Test Acc: 0.768
Validation loss decreased (-0.666657 --> -0.768108).  Saving model ...
Epoch: 9 cost time: 0.8093023300170898
Epoch: 9, Steps: 9 | Train Loss: 0.609 Vali Loss: 0.734 Vali Acc: 0.826 Test Loss: 0.734 Test Acc: 0.826
Validation loss decreased (-0.768108 --> -0.826080).  Saving model ...
Epoch: 10 cost time: 0.7909364700317383
Epoch: 10, Steps: 9 | Train Loss: 0.513 Vali Loss: 0.652 Vali Acc: 0.855 Test Loss: 0.652 Test Acc: 0.855
Validation loss decreased (-0.826080 --> -0.855066).  Saving model ...
Epoch: 11 cost time: 0.721837043762207
Epoch: 11, Steps: 9 | Train Loss: 0.428 Vali Loss: 0.583 Vali Acc: 0.870 Test Loss: 0.583 Test Acc: 0.870
Validation loss decreased (-0.855066 --> -0.869559).  Saving model ...
Epoch: 12 cost time: 0.6249427795410156
Epoch: 12, Steps: 9 | Train Loss: 0.343 Vali Loss: 0.523 Vali Acc: 0.891 Test Loss: 0.523 Test Acc: 0.891
Validation loss decreased (-0.869559 --> -0.891299).  Saving model ...
Epoch: 13 cost time: 0.7272579669952393
Epoch: 13, Steps: 9 | Train Loss: 0.290 Vali Loss: 0.462 Vali Acc: 0.891 Test Loss: 0.462 Test Acc: 0.891
Validation loss decreased (-0.891299 --> -0.891300).  Saving model ...
Epoch: 14 cost time: 0.6719448566436768
Epoch: 14, Steps: 9 | Train Loss: 0.235 Vali Loss: 0.419 Vali Acc: 0.877 Test Loss: 0.419 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8276591300964355
Epoch: 15, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.395 Vali Acc: 0.891 Test Loss: 0.395 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 16 cost time: 0.8603243827819824
Epoch: 16, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.370 Vali Acc: 0.884 Test Loss: 0.370 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.857619047164917
Epoch: 17, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.346 Vali Acc: 0.877 Test Loss: 0.346 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7279913425445557
Epoch: 18, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.329 Vali Acc: 0.891 Test Loss: 0.329 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891301).  Saving model ...
Epoch: 19 cost time: 0.7682161331176758
Epoch: 19, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.324 Vali Acc: 0.899 Test Loss: 0.324 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 20 cost time: 0.7043826580047607
Epoch: 20, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.314 Vali Acc: 0.891 Test Loss: 0.314 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6894183158874512
Epoch: 21, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 22 cost time: 0.6868226528167725
Epoch: 22, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.282 Vali Acc: 0.913 Test Loss: 0.282 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 23 cost time: 0.6708974838256836
Epoch: 23, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.279 Vali Acc: 0.913 Test Loss: 0.279 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 24 cost time: 0.6760013103485107
Epoch: 24, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.273 Vali Acc: 0.913 Test Loss: 0.273 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 25 cost time: 0.6759684085845947
Epoch: 25, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.271 Vali Acc: 0.906 Test Loss: 0.271 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7268011569976807
Epoch: 26, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.267 Vali Acc: 0.906 Test Loss: 0.267 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6831059455871582
Epoch: 27, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.259 Vali Acc: 0.913 Test Loss: 0.259 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 28 cost time: 0.690993070602417
Epoch: 28, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.253 Vali Acc: 0.913 Test Loss: 0.253 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 29 cost time: 0.6807265281677246
Epoch: 29, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.246 Vali Acc: 0.913 Test Loss: 0.246 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 30 cost time: 0.7510130405426025
Epoch: 30, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.245 Vali Acc: 0.913 Test Loss: 0.245 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 31 cost time: 0.7069234848022461
Epoch: 31, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.246 Vali Acc: 0.906 Test Loss: 0.246 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.729773998260498
Epoch: 32, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.242 Vali Acc: 0.920 Test Loss: 0.242 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 33 cost time: 0.7456529140472412
Epoch: 33, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.236 Vali Acc: 0.920 Test Loss: 0.236 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 34 cost time: 0.8129353523254395
Epoch: 34, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.229 Vali Acc: 0.928 Test Loss: 0.229 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 35 cost time: 0.7228233814239502
Epoch: 35, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.230 Vali Acc: 0.920 Test Loss: 0.230 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7277207374572754
Epoch: 36, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.231 Vali Acc: 0.920 Test Loss: 0.231 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7248361110687256
Epoch: 37, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.244 Vali Acc: 0.913 Test Loss: 0.244 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7723121643066406
Epoch: 38, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.234 Vali Acc: 0.920 Test Loss: 0.234 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.726311206817627
Epoch: 39, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.220 Vali Acc: 0.920 Test Loss: 0.220 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6442108154296875
Epoch: 40, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 41 cost time: 0.6444888114929199
Epoch: 41, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7094380855560303
Epoch: 42, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7938730716705322
Epoch: 43, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.920 Test Loss: 0.212 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6785488128662109
Epoch: 44, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.920 Test Loss: 0.212 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7590396404266357
Epoch: 45, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.222 Vali Acc: 0.920 Test Loss: 0.222 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.7092289924621582
Epoch: 46, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.227 Vali Acc: 0.920 Test Loss: 0.227 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.7905497550964355
Epoch: 47, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.213 Vali Acc: 0.920 Test Loss: 0.213 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.7205016613006592
Epoch: 48, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.920 Test Loss: 0.210 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.7586355209350586
Epoch: 49, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.920 Test Loss: 0.210 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.7087485790252686
Epoch: 50, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.212 Vali Acc: 0.920 Test Loss: 0.212 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 152868
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1643590927124023
Epoch: 1, Steps: 9 | Train Loss: 1.460 Vali Loss: 1.415 Vali Acc: 0.246 Test Loss: 1.415 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 0.7125458717346191
Epoch: 2, Steps: 9 | Train Loss: 1.402 Vali Loss: 1.390 Vali Acc: 0.290 Test Loss: 1.390 Test Acc: 0.290
Validation loss decreased (-0.246363 --> -0.289841).  Saving model ...
Epoch: 3 cost time: 0.6961691379547119
Epoch: 3, Steps: 9 | Train Loss: 1.342 Vali Loss: 1.338 Vali Acc: 0.341 Test Loss: 1.338 Test Acc: 0.341
Validation loss decreased (-0.289841 --> -0.340566).  Saving model ...
Epoch: 4 cost time: 0.7399101257324219
Epoch: 4, Steps: 9 | Train Loss: 1.257 Vali Loss: 1.270 Vali Acc: 0.464 Test Loss: 1.270 Test Acc: 0.464
Validation loss decreased (-0.340566 --> -0.463755).  Saving model ...
Epoch: 5 cost time: 0.7817649841308594
Epoch: 5, Steps: 9 | Train Loss: 1.166 Vali Loss: 1.191 Vali Acc: 0.587 Test Loss: 1.191 Test Acc: 0.587
Validation loss decreased (-0.463755 --> -0.586945).  Saving model ...
Epoch: 6 cost time: 0.6746490001678467
Epoch: 6, Steps: 9 | Train Loss: 1.097 Vali Loss: 1.108 Vali Acc: 0.609 Test Loss: 1.108 Test Acc: 0.609
Validation loss decreased (-0.586945 --> -0.608685).  Saving model ...
Epoch: 7 cost time: 0.7311668395996094
Epoch: 7, Steps: 9 | Train Loss: 0.977 Vali Loss: 1.025 Vali Acc: 0.688 Test Loss: 1.025 Test Acc: 0.688
Validation loss decreased (-0.608685 --> -0.688396).  Saving model ...
Epoch: 8 cost time: 0.6965000629425049
Epoch: 8, Steps: 9 | Train Loss: 0.883 Vali Loss: 0.940 Vali Acc: 0.739 Test Loss: 0.940 Test Acc: 0.739
Validation loss decreased (-0.688396 --> -0.739121).  Saving model ...
Epoch: 9 cost time: 0.7260656356811523
Epoch: 9, Steps: 9 | Train Loss: 0.799 Vali Loss: 0.857 Vali Acc: 0.768 Test Loss: 0.857 Test Acc: 0.768
Validation loss decreased (-0.739121 --> -0.768107).  Saving model ...
Epoch: 10 cost time: 0.7182862758636475
Epoch: 10, Steps: 9 | Train Loss: 0.679 Vali Loss: 0.784 Vali Acc: 0.783 Test Loss: 0.784 Test Acc: 0.783
Validation loss decreased (-0.768107 --> -0.782601).  Saving model ...
Epoch: 11 cost time: 0.7129726409912109
Epoch: 11, Steps: 9 | Train Loss: 0.594 Vali Loss: 0.713 Vali Acc: 0.804 Test Loss: 0.713 Test Acc: 0.804
Validation loss decreased (-0.782601 --> -0.804341).  Saving model ...
Epoch: 12 cost time: 0.7066593170166016
Epoch: 12, Steps: 9 | Train Loss: 0.519 Vali Loss: 0.652 Vali Acc: 0.812 Test Loss: 0.652 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811588).  Saving model ...
Epoch: 13 cost time: 0.6956772804260254
Epoch: 13, Steps: 9 | Train Loss: 0.436 Vali Loss: 0.593 Vali Acc: 0.848 Test Loss: 0.593 Test Acc: 0.848
Validation loss decreased (-0.811588 --> -0.847820).  Saving model ...
Epoch: 14 cost time: 0.731081485748291
Epoch: 14, Steps: 9 | Train Loss: 0.386 Vali Loss: 0.553 Vali Acc: 0.855 Test Loss: 0.553 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855067).  Saving model ...
Epoch: 15 cost time: 0.7289917469024658
Epoch: 15, Steps: 9 | Train Loss: 0.366 Vali Loss: 0.514 Vali Acc: 0.870 Test Loss: 0.514 Test Acc: 0.870
Validation loss decreased (-0.855067 --> -0.869560).  Saving model ...
Epoch: 16 cost time: 0.7101070880889893
Epoch: 16, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.478 Vali Acc: 0.877 Test Loss: 0.478 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876807).  Saving model ...
Epoch: 17 cost time: 0.6881752014160156
Epoch: 17, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.455 Vali Acc: 0.884 Test Loss: 0.455 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884053).  Saving model ...
Epoch: 18 cost time: 0.6192092895507812
Epoch: 18, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.428 Vali Acc: 0.884 Test Loss: 0.428 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884054).  Saving model ...
Epoch: 19 cost time: 0.6579890251159668
Epoch: 19, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.388 Vali Acc: 0.891 Test Loss: 0.388 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 20 cost time: 0.6542162895202637
Epoch: 20, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.368 Vali Acc: 0.899 Test Loss: 0.368 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 21 cost time: 0.632836103439331
Epoch: 21, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.359 Vali Acc: 0.899 Test Loss: 0.359 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 22 cost time: 0.6579990386962891
Epoch: 22, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.362 Vali Acc: 0.891 Test Loss: 0.362 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6451642513275146
Epoch: 23, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.349 Vali Acc: 0.891 Test Loss: 0.349 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6781673431396484
Epoch: 24, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.334 Vali Acc: 0.906 Test Loss: 0.334 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 25 cost time: 0.7912397384643555
Epoch: 25, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.324 Vali Acc: 0.899 Test Loss: 0.324 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6719536781311035
Epoch: 26, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.314 Vali Acc: 0.891 Test Loss: 0.314 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6399648189544678
Epoch: 27, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.304 Vali Acc: 0.906 Test Loss: 0.304 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 28 cost time: 0.7656581401824951
Epoch: 28, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.291 Vali Acc: 0.920 Test Loss: 0.291 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920287).  Saving model ...
Epoch: 29 cost time: 0.7694723606109619
Epoch: 29, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.293 Vali Acc: 0.920 Test Loss: 0.293 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.658698320388794
Epoch: 30, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.279 Vali Acc: 0.920 Test Loss: 0.279 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 31 cost time: 0.7062597274780273
Epoch: 31, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.275 Vali Acc: 0.920 Test Loss: 0.275 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 32 cost time: 0.7088277339935303
Epoch: 32, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.267 Vali Acc: 0.920 Test Loss: 0.267 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 33 cost time: 0.6988012790679932
Epoch: 33, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.280 Vali Acc: 0.913 Test Loss: 0.280 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7058064937591553
Epoch: 34, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6834156513214111
Epoch: 35, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.272 Vali Acc: 0.906 Test Loss: 0.272 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.737952470779419
Epoch: 36, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.270 Vali Acc: 0.913 Test Loss: 0.270 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6836230754852295
Epoch: 37, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.272 Vali Acc: 0.906 Test Loss: 0.272 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7561783790588379
Epoch: 38, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.272 Vali Acc: 0.906 Test Loss: 0.272 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.7157385349273682
Epoch: 39, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.7432701587677002
Epoch: 40, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.7656252384185791
Epoch: 41, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.276 Vali Acc: 0.906 Test Loss: 0.276 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.6811158657073975
Epoch: 42, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.253 Vali Acc: 0.906 Test Loss: 0.253 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 149956
model size : 0.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.966796636581421
Epoch: 1, Steps: 9 | Train Loss: 1.406 Vali Loss: 1.351 Vali Acc: 0.341 Test Loss: 1.351 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 0.7484478950500488
Epoch: 2, Steps: 9 | Train Loss: 1.365 Vali Loss: 1.323 Vali Acc: 0.406 Test Loss: 1.323 Test Acc: 0.406
Validation loss decreased (-0.340566 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 0.8603336811065674
Epoch: 3, Steps: 9 | Train Loss: 1.307 Vali Loss: 1.280 Vali Acc: 0.500 Test Loss: 1.280 Test Acc: 0.500
Validation loss decreased (-0.405784 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.71486496925354
Epoch: 4, Steps: 9 | Train Loss: 1.236 Vali Loss: 1.227 Vali Acc: 0.543 Test Loss: 1.227 Test Acc: 0.543
Validation loss decreased (-0.499987 --> -0.543466).  Saving model ...
Epoch: 5 cost time: 0.6990668773651123
Epoch: 5, Steps: 9 | Train Loss: 1.174 Vali Loss: 1.166 Vali Acc: 0.645 Test Loss: 1.166 Test Acc: 0.645
Validation loss decreased (-0.543466 --> -0.644916).  Saving model ...
Epoch: 6 cost time: 0.6787998676300049
Epoch: 6, Steps: 9 | Train Loss: 1.104 Vali Loss: 1.103 Vali Acc: 0.696 Test Loss: 1.103 Test Acc: 0.696
Validation loss decreased (-0.644916 --> -0.695641).  Saving model ...
Epoch: 7 cost time: 0.7435591220855713
Epoch: 7, Steps: 9 | Train Loss: 1.019 Vali Loss: 1.039 Vali Acc: 0.725 Test Loss: 1.039 Test Acc: 0.725
Validation loss decreased (-0.695641 --> -0.724627).  Saving model ...
Epoch: 8 cost time: 0.7282547950744629
Epoch: 8, Steps: 9 | Train Loss: 0.962 Vali Loss: 0.966 Vali Acc: 0.746 Test Loss: 0.966 Test Acc: 0.746
Validation loss decreased (-0.724627 --> -0.746367).  Saving model ...
Epoch: 9 cost time: 0.740736722946167
Epoch: 9, Steps: 9 | Train Loss: 0.876 Vali Loss: 0.897 Vali Acc: 0.761 Test Loss: 0.897 Test Acc: 0.761
Validation loss decreased (-0.746367 --> -0.760861).  Saving model ...
Epoch: 10 cost time: 0.7151339054107666
Epoch: 10, Steps: 9 | Train Loss: 0.788 Vali Loss: 0.830 Vali Acc: 0.783 Test Loss: 0.830 Test Acc: 0.783
Validation loss decreased (-0.760861 --> -0.782600).  Saving model ...
Epoch: 11 cost time: 0.6872808933258057
Epoch: 11, Steps: 9 | Train Loss: 0.729 Vali Loss: 0.760 Vali Acc: 0.790 Test Loss: 0.760 Test Acc: 0.790
Validation loss decreased (-0.782600 --> -0.789847).  Saving model ...
Epoch: 12 cost time: 0.7221417427062988
Epoch: 12, Steps: 9 | Train Loss: 0.629 Vali Loss: 0.710 Vali Acc: 0.797 Test Loss: 0.710 Test Acc: 0.797
Validation loss decreased (-0.789847 --> -0.797094).  Saving model ...
Epoch: 13 cost time: 0.7310776710510254
Epoch: 13, Steps: 9 | Train Loss: 0.556 Vali Loss: 0.661 Vali Acc: 0.804 Test Loss: 0.661 Test Acc: 0.804
Validation loss decreased (-0.797094 --> -0.804341).  Saving model ...
Epoch: 14 cost time: 0.7011373043060303
Epoch: 14, Steps: 9 | Train Loss: 0.492 Vali Loss: 0.611 Vali Acc: 0.819 Test Loss: 0.611 Test Acc: 0.819
Validation loss decreased (-0.804341 --> -0.818834).  Saving model ...
Epoch: 15 cost time: 0.6812036037445068
Epoch: 15, Steps: 9 | Train Loss: 0.435 Vali Loss: 0.575 Vali Acc: 0.819 Test Loss: 0.575 Test Acc: 0.819
Validation loss decreased (-0.818834 --> -0.818835).  Saving model ...
Epoch: 16 cost time: 0.7409772872924805
Epoch: 16, Steps: 9 | Train Loss: 0.380 Vali Loss: 0.544 Vali Acc: 0.826 Test Loss: 0.544 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 17 cost time: 0.6885364055633545
Epoch: 17, Steps: 9 | Train Loss: 0.337 Vali Loss: 0.518 Vali Acc: 0.841 Test Loss: 0.518 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 18 cost time: 0.7273023128509521
Epoch: 18, Steps: 9 | Train Loss: 0.290 Vali Loss: 0.485 Vali Acc: 0.855 Test Loss: 0.485 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 19 cost time: 0.7437043190002441
Epoch: 19, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.456 Vali Acc: 0.862 Test Loss: 0.456 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 20 cost time: 0.8098304271697998
Epoch: 20, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.440 Vali Acc: 0.855 Test Loss: 0.440 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6522386074066162
Epoch: 21, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.420 Vali Acc: 0.855 Test Loss: 0.420 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7392821311950684
Epoch: 22, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.391 Vali Acc: 0.870 Test Loss: 0.391 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 23 cost time: 0.688056230545044
Epoch: 23, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.383 Vali Acc: 0.870 Test Loss: 0.383 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 24 cost time: 0.637814998626709
Epoch: 24, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.372 Vali Acc: 0.870 Test Loss: 0.372 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869562).  Saving model ...
Epoch: 25 cost time: 0.745333194732666
Epoch: 25, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.363 Vali Acc: 0.870 Test Loss: 0.363 Test Acc: 0.870
Validation loss decreased (-0.869562 --> -0.869562).  Saving model ...
Epoch: 26 cost time: 0.6800863742828369
Epoch: 26, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.350 Vali Acc: 0.870 Test Loss: 0.350 Test Acc: 0.870
Validation loss decreased (-0.869562 --> -0.869562).  Saving model ...
Epoch: 27 cost time: 0.6341207027435303
Epoch: 27, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.333 Vali Acc: 0.884 Test Loss: 0.333 Test Acc: 0.884
Validation loss decreased (-0.869562 --> -0.884055).  Saving model ...
Epoch: 28 cost time: 0.6953372955322266
Epoch: 28, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.334 Vali Acc: 0.884 Test Loss: 0.334 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.739973783493042
Epoch: 29, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.322 Vali Acc: 0.884 Test Loss: 0.322 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 30 cost time: 0.6758444309234619
Epoch: 30, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.322 Vali Acc: 0.877 Test Loss: 0.322 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6937041282653809
Epoch: 31, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.321 Vali Acc: 0.877 Test Loss: 0.321 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7131545543670654
Epoch: 32, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.316 Vali Acc: 0.884 Test Loss: 0.316 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 33 cost time: 0.7227230072021484
Epoch: 33, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.301 Vali Acc: 0.899 Test Loss: 0.301 Test Acc: 0.899
Validation loss decreased (-0.884055 --> -0.898548).  Saving model ...
Epoch: 34 cost time: 0.7451479434967041
Epoch: 34, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.300 Vali Acc: 0.899 Test Loss: 0.300 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 35 cost time: 0.6364450454711914
Epoch: 35, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.308 Vali Acc: 0.899 Test Loss: 0.308 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.687598466873169
Epoch: 36, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.315 Vali Acc: 0.884 Test Loss: 0.315 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7342545986175537
Epoch: 37, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.327 Vali Acc: 0.877 Test Loss: 0.327 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.751816987991333
Epoch: 38, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.317 Vali Acc: 0.884 Test Loss: 0.317 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7732257843017578
Epoch: 39, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.325 Vali Acc: 0.891 Test Loss: 0.325 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7199604511260986
Epoch: 40, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.314 Vali Acc: 0.899 Test Loss: 0.314 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6747970581054688
Epoch: 41, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.311 Vali Acc: 0.899 Test Loss: 0.311 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.754335880279541
Epoch: 42, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.295 Vali Acc: 0.920 Test Loss: 0.295 Test Acc: 0.920
Validation loss decreased (-0.898548 --> -0.920287).  Saving model ...
Epoch: 43 cost time: 0.6880457401275635
Epoch: 43, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.293 Vali Acc: 0.913 Test Loss: 0.293 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7488329410552979
Epoch: 44, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.301 Vali Acc: 0.899 Test Loss: 0.301 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6712024211883545
Epoch: 45, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.295 Vali Acc: 0.913 Test Loss: 0.295 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.7248086929321289
Epoch: 46, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.287 Vali Acc: 0.920 Test Loss: 0.287 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 47 cost time: 0.7539055347442627
Epoch: 47, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.292 Vali Acc: 0.920 Test Loss: 0.292 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6851825714111328
Epoch: 48, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.282 Vali Acc: 0.920 Test Loss: 0.282 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 49 cost time: 0.7361404895782471
Epoch: 49, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.293 Vali Acc: 0.913 Test Loss: 0.293 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8194279670715332
Epoch: 50, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.297 Vali Acc: 0.906 Test Loss: 0.297 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 147972
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.06634521484375
Epoch: 1, Steps: 9 | Train Loss: 1.410 Vali Loss: 1.400 Vali Acc: 0.225 Test Loss: 1.400 Test Acc: 0.225
Validation loss decreased (inf --> -0.224624).  Saving model ...
Epoch: 2 cost time: 0.6956868171691895
Epoch: 2, Steps: 9 | Train Loss: 1.372 Vali Loss: 1.379 Vali Acc: 0.225 Test Loss: 1.379 Test Acc: 0.225
Validation loss decreased (-0.224624 --> -0.224624).  Saving model ...
Epoch: 3 cost time: 0.6433200836181641
Epoch: 3, Steps: 9 | Train Loss: 1.331 Vali Loss: 1.339 Vali Acc: 0.246 Test Loss: 1.339 Test Acc: 0.246
Validation loss decreased (-0.224624 --> -0.246363).  Saving model ...
Epoch: 4 cost time: 0.7017343044281006
Epoch: 4, Steps: 9 | Train Loss: 1.281 Vali Loss: 1.289 Vali Acc: 0.370 Test Loss: 1.289 Test Acc: 0.370
Validation loss decreased (-0.246363 --> -0.369552).  Saving model ...
Epoch: 5 cost time: 0.7455577850341797
Epoch: 5, Steps: 9 | Train Loss: 1.215 Vali Loss: 1.230 Vali Acc: 0.449 Test Loss: 1.230 Test Acc: 0.449
Validation loss decreased (-0.369552 --> -0.449263).  Saving model ...
Epoch: 6 cost time: 0.8134989738464355
Epoch: 6, Steps: 9 | Train Loss: 1.141 Vali Loss: 1.165 Vali Acc: 0.514 Test Loss: 1.165 Test Acc: 0.514
Validation loss decreased (-0.449263 --> -0.514481).  Saving model ...
Epoch: 7 cost time: 0.7287459373474121
Epoch: 7, Steps: 9 | Train Loss: 1.068 Vali Loss: 1.097 Vali Acc: 0.623 Test Loss: 1.097 Test Acc: 0.623
Validation loss decreased (-0.514481 --> -0.623177).  Saving model ...
Epoch: 8 cost time: 0.7419683933258057
Epoch: 8, Steps: 9 | Train Loss: 0.998 Vali Loss: 1.023 Vali Acc: 0.681 Test Loss: 1.023 Test Acc: 0.681
Validation loss decreased (-0.623177 --> -0.681149).  Saving model ...
Epoch: 9 cost time: 0.7481656074523926
Epoch: 9, Steps: 9 | Train Loss: 0.932 Vali Loss: 0.946 Vali Acc: 0.710 Test Loss: 0.946 Test Acc: 0.710
Validation loss decreased (-0.681149 --> -0.710135).  Saving model ...
Epoch: 10 cost time: 0.7318618297576904
Epoch: 10, Steps: 9 | Train Loss: 0.841 Vali Loss: 0.885 Vali Acc: 0.725 Test Loss: 0.885 Test Acc: 0.725
Validation loss decreased (-0.710135 --> -0.724629).  Saving model ...
Epoch: 11 cost time: 0.7161006927490234
Epoch: 11, Steps: 9 | Train Loss: 0.756 Vali Loss: 0.832 Vali Acc: 0.761 Test Loss: 0.832 Test Acc: 0.761
Validation loss decreased (-0.724629 --> -0.760861).  Saving model ...
Epoch: 12 cost time: 0.7742705345153809
Epoch: 12, Steps: 9 | Train Loss: 0.720 Vali Loss: 0.765 Vali Acc: 0.768 Test Loss: 0.765 Test Acc: 0.768
Validation loss decreased (-0.760861 --> -0.768108).  Saving model ...
Epoch: 13 cost time: 0.725421667098999
Epoch: 13, Steps: 9 | Train Loss: 0.628 Vali Loss: 0.718 Vali Acc: 0.790 Test Loss: 0.718 Test Acc: 0.790
Validation loss decreased (-0.768108 --> -0.789848).  Saving model ...
Epoch: 14 cost time: 0.7644133567810059
Epoch: 14, Steps: 9 | Train Loss: 0.570 Vali Loss: 0.674 Vali Acc: 0.804 Test Loss: 0.674 Test Acc: 0.804
Validation loss decreased (-0.789848 --> -0.804341).  Saving model ...
Epoch: 15 cost time: 0.7925283908843994
Epoch: 15, Steps: 9 | Train Loss: 0.505 Vali Loss: 0.637 Vali Acc: 0.804 Test Loss: 0.637 Test Acc: 0.804
Validation loss decreased (-0.804341 --> -0.804341).  Saving model ...
Epoch: 16 cost time: 0.7762501239776611
Epoch: 16, Steps: 9 | Train Loss: 0.448 Vali Loss: 0.602 Vali Acc: 0.812 Test Loss: 0.602 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811588).  Saving model ...
Epoch: 17 cost time: 0.7722973823547363
Epoch: 17, Steps: 9 | Train Loss: 0.412 Vali Loss: 0.566 Vali Acc: 0.848 Test Loss: 0.566 Test Acc: 0.848
Validation loss decreased (-0.811588 --> -0.847820).  Saving model ...
Epoch: 18 cost time: 0.7584466934204102
Epoch: 18, Steps: 9 | Train Loss: 0.368 Vali Loss: 0.542 Vali Acc: 0.855 Test Loss: 0.542 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855067).  Saving model ...
Epoch: 19 cost time: 0.769740104675293
Epoch: 19, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.517 Vali Acc: 0.848 Test Loss: 0.517 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7489790916442871
Epoch: 20, Steps: 9 | Train Loss: 0.278 Vali Loss: 0.481 Vali Acc: 0.870 Test Loss: 0.481 Test Acc: 0.870
Validation loss decreased (-0.855067 --> -0.869560).  Saving model ...
Epoch: 21 cost time: 0.7839522361755371
Epoch: 21, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.464 Vali Acc: 0.848 Test Loss: 0.464 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7507548332214355
Epoch: 22, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.450 Vali Acc: 0.855 Test Loss: 0.450 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7452940940856934
Epoch: 23, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.439 Vali Acc: 0.855 Test Loss: 0.439 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7621033191680908
Epoch: 24, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.417 Vali Acc: 0.870 Test Loss: 0.417 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869561).  Saving model ...
Epoch: 25 cost time: 0.76220703125
Epoch: 25, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.399 Vali Acc: 0.870 Test Loss: 0.399 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 26 cost time: 0.7867791652679443
Epoch: 26, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.382 Vali Acc: 0.877 Test Loss: 0.382 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 27 cost time: 0.7934067249298096
Epoch: 27, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.380 Vali Acc: 0.884 Test Loss: 0.380 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 28 cost time: 0.7992539405822754
Epoch: 28, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.388 Vali Acc: 0.877 Test Loss: 0.388 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7444977760314941
Epoch: 29, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.364 Vali Acc: 0.870 Test Loss: 0.364 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.747246265411377
Epoch: 30, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.355 Vali Acc: 0.870 Test Loss: 0.355 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7962040901184082
Epoch: 31, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.372 Vali Acc: 0.870 Test Loss: 0.372 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8112561702728271
Epoch: 32, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.353 Vali Acc: 0.877 Test Loss: 0.353 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7173261642456055
Epoch: 33, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.335 Vali Acc: 0.884 Test Loss: 0.335 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884055).  Saving model ...
Epoch: 34 cost time: 0.7695624828338623
Epoch: 34, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.335 Vali Acc: 0.884 Test Loss: 0.335 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 35 cost time: 0.7724354267120361
Epoch: 35, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.334 Vali Acc: 0.891 Test Loss: 0.334 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 36 cost time: 0.8026411533355713
Epoch: 36, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.325 Vali Acc: 0.891 Test Loss: 0.325 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 37 cost time: 0.7421374320983887
Epoch: 37, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.313 Vali Acc: 0.884 Test Loss: 0.313 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8713891506195068
Epoch: 38, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.323 Vali Acc: 0.884 Test Loss: 0.323 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7868225574493408
Epoch: 39, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.320 Vali Acc: 0.891 Test Loss: 0.320 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 40 cost time: 0.7317514419555664
Epoch: 40, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.293 Vali Acc: 0.906 Test Loss: 0.293 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 41 cost time: 0.8065977096557617
Epoch: 41, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.303 Vali Acc: 0.906 Test Loss: 0.303 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7448251247406006
Epoch: 42, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.333 Vali Acc: 0.884 Test Loss: 0.333 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7635033130645752
Epoch: 43, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.333 Vali Acc: 0.884 Test Loss: 0.333 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7739443778991699
Epoch: 44, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.331 Vali Acc: 0.884 Test Loss: 0.331 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.750028133392334
Epoch: 45, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.328 Vali Acc: 0.884 Test Loss: 0.328 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.699873685836792
Epoch: 46, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.287 Vali Acc: 0.906 Test Loss: 0.287 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 47 cost time: 0.7026634216308594
Epoch: 47, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.275 Vali Acc: 0.906 Test Loss: 0.275 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 48 cost time: 0.7228174209594727
Epoch: 48, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.294 Vali Acc: 0.899 Test Loss: 0.294 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7349066734313965
Epoch: 49, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.291 Vali Acc: 0.913 Test Loss: 0.291 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 50 cost time: 0.7923896312713623
Epoch: 50, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.290 Vali Acc: 0.913 Test Loss: 0.290 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 147556
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.243276834487915
Epoch: 1, Steps: 9 | Train Loss: 1.415 Vali Loss: 1.397 Vali Acc: 0.239 Test Loss: 1.397 Test Acc: 0.239
Validation loss decreased (inf --> -0.239116).  Saving model ...
Epoch: 2 cost time: 0.6905393600463867
Epoch: 2, Steps: 9 | Train Loss: 1.372 Vali Loss: 1.380 Vali Acc: 0.283 Test Loss: 1.380 Test Acc: 0.283
Validation loss decreased (-0.239116 --> -0.282595).  Saving model ...
Epoch: 3 cost time: 0.640855073928833
Epoch: 3, Steps: 9 | Train Loss: 1.351 Vali Loss: 1.346 Vali Acc: 0.333 Test Loss: 1.346 Test Acc: 0.333
Validation loss decreased (-0.282595 --> -0.333320).  Saving model ...
Epoch: 4 cost time: 0.6678562164306641
Epoch: 4, Steps: 9 | Train Loss: 1.285 Vali Loss: 1.301 Vali Acc: 0.413 Test Loss: 1.301 Test Acc: 0.413
Validation loss decreased (-0.333320 --> -0.413030).  Saving model ...
Epoch: 5 cost time: 0.727792501449585
Epoch: 5, Steps: 9 | Train Loss: 1.229 Vali Loss: 1.246 Vali Acc: 0.457 Test Loss: 1.246 Test Acc: 0.457
Validation loss decreased (-0.413030 --> -0.456509).  Saving model ...
Epoch: 6 cost time: 0.7102174758911133
Epoch: 6, Steps: 9 | Train Loss: 1.173 Vali Loss: 1.188 Vali Acc: 0.514 Test Loss: 1.188 Test Acc: 0.514
Validation loss decreased (-0.456509 --> -0.514481).  Saving model ...
Epoch: 7 cost time: 0.7396502494812012
Epoch: 7, Steps: 9 | Train Loss: 1.090 Vali Loss: 1.134 Vali Acc: 0.580 Test Loss: 1.134 Test Acc: 0.580
Validation loss decreased (-0.514481 --> -0.579699).  Saving model ...
Epoch: 8 cost time: 0.6847352981567383
Epoch: 8, Steps: 9 | Train Loss: 1.017 Vali Loss: 1.066 Vali Acc: 0.630 Test Loss: 1.066 Test Acc: 0.630
Validation loss decreased (-0.579699 --> -0.630424).  Saving model ...
Epoch: 9 cost time: 0.7117476463317871
Epoch: 9, Steps: 9 | Train Loss: 0.941 Vali Loss: 1.006 Vali Acc: 0.667 Test Loss: 1.006 Test Acc: 0.667
Validation loss decreased (-0.630424 --> -0.666657).  Saving model ...
Epoch: 10 cost time: 0.6753811836242676
Epoch: 10, Steps: 9 | Train Loss: 0.889 Vali Loss: 0.943 Vali Acc: 0.674 Test Loss: 0.943 Test Acc: 0.674
Validation loss decreased (-0.666657 --> -0.673904).  Saving model ...
Epoch: 11 cost time: 0.7013149261474609
Epoch: 11, Steps: 9 | Train Loss: 0.798 Vali Loss: 0.889 Vali Acc: 0.710 Test Loss: 0.889 Test Acc: 0.710
Validation loss decreased (-0.673904 --> -0.710136).  Saving model ...
Epoch: 12 cost time: 0.6983215808868408
Epoch: 12, Steps: 9 | Train Loss: 0.729 Vali Loss: 0.830 Vali Acc: 0.754 Test Loss: 0.830 Test Acc: 0.754
Validation loss decreased (-0.710136 --> -0.753615).  Saving model ...
Epoch: 13 cost time: 0.7484297752380371
Epoch: 13, Steps: 9 | Train Loss: 0.665 Vali Loss: 0.786 Vali Acc: 0.761 Test Loss: 0.786 Test Acc: 0.761
Validation loss decreased (-0.753615 --> -0.760862).  Saving model ...
Epoch: 14 cost time: 0.6187946796417236
Epoch: 14, Steps: 9 | Train Loss: 0.604 Vali Loss: 0.750 Vali Acc: 0.739 Test Loss: 0.750 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6886317729949951
Epoch: 15, Steps: 9 | Train Loss: 0.552 Vali Loss: 0.711 Vali Acc: 0.739 Test Loss: 0.711 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6939601898193359
Epoch: 16, Steps: 9 | Train Loss: 0.509 Vali Loss: 0.685 Vali Acc: 0.746 Test Loss: 0.685 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7795581817626953
Epoch: 17, Steps: 9 | Train Loss: 0.436 Vali Loss: 0.662 Vali Acc: 0.754 Test Loss: 0.662 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6620357036590576
Epoch: 18, Steps: 9 | Train Loss: 0.406 Vali Loss: 0.629 Vali Acc: 0.775 Test Loss: 0.629 Test Acc: 0.775
Validation loss decreased (-0.760862 --> -0.775356).  Saving model ...
Epoch: 19 cost time: 0.7118442058563232
Epoch: 19, Steps: 9 | Train Loss: 0.383 Vali Loss: 0.606 Vali Acc: 0.783 Test Loss: 0.606 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782603).  Saving model ...
Epoch: 20 cost time: 0.6407589912414551
Epoch: 20, Steps: 9 | Train Loss: 0.323 Vali Loss: 0.573 Vali Acc: 0.790 Test Loss: 0.573 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789849).  Saving model ...
Epoch: 21 cost time: 0.6832535266876221
Epoch: 21, Steps: 9 | Train Loss: 0.284 Vali Loss: 0.558 Vali Acc: 0.804 Test Loss: 0.558 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804342).  Saving model ...
Epoch: 22 cost time: 0.6984584331512451
Epoch: 22, Steps: 9 | Train Loss: 0.265 Vali Loss: 0.540 Vali Acc: 0.804 Test Loss: 0.540 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 23 cost time: 0.6610879898071289
Epoch: 23, Steps: 9 | Train Loss: 0.239 Vali Loss: 0.521 Vali Acc: 0.812 Test Loss: 0.521 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811589).  Saving model ...
Epoch: 24 cost time: 0.7160782814025879
Epoch: 24, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.507 Vali Acc: 0.812 Test Loss: 0.507 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 25 cost time: 0.73095703125
Epoch: 25, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.481 Vali Acc: 0.826 Test Loss: 0.481 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826082).  Saving model ...
Epoch: 26 cost time: 0.7011396884918213
Epoch: 26, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.469 Vali Acc: 0.826 Test Loss: 0.469 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 27 cost time: 0.7705144882202148
Epoch: 27, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.447 Vali Acc: 0.833 Test Loss: 0.447 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 28 cost time: 0.743934154510498
Epoch: 28, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.450 Vali Acc: 0.841 Test Loss: 0.450 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 29 cost time: 0.685154914855957
Epoch: 29, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.442 Vali Acc: 0.841 Test Loss: 0.442 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 30 cost time: 0.7550389766693115
Epoch: 30, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.438 Vali Acc: 0.841 Test Loss: 0.438 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 31 cost time: 0.7446348667144775
Epoch: 31, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.419 Vali Acc: 0.833 Test Loss: 0.419 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7382664680480957
Epoch: 32, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.402 Vali Acc: 0.848 Test Loss: 0.402 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 33 cost time: 0.7551498413085938
Epoch: 33, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.432 Vali Acc: 0.833 Test Loss: 0.432 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6806466579437256
Epoch: 34, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.434 Vali Acc: 0.841 Test Loss: 0.434 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6446201801300049
Epoch: 35, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.424 Vali Acc: 0.841 Test Loss: 0.424 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6939847469329834
Epoch: 36, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.413 Vali Acc: 0.841 Test Loss: 0.413 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.727297306060791
Epoch: 37, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.395 Vali Acc: 0.841 Test Loss: 0.395 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.6839315891265869
Epoch: 38, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.397 Vali Acc: 0.841 Test Loss: 0.397 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.7527744770050049
Epoch: 39, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.405 Vali Acc: 0.841 Test Loss: 0.405 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.7094705104827881
Epoch: 40, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.414 Vali Acc: 0.841 Test Loss: 0.414 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.7142195701599121
Epoch: 41, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.402 Vali Acc: 0.848 Test Loss: 0.402 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 42 cost time: 0.7658090591430664
Epoch: 42, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.394 Vali Acc: 0.862 Test Loss: 0.394 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 43 cost time: 0.7102127075195312
Epoch: 43, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.384 Vali Acc: 0.862 Test Loss: 0.384 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 44 cost time: 0.6628499031066895
Epoch: 44, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.380 Vali Acc: 0.862 Test Loss: 0.380 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 45 cost time: 0.6622505187988281
Epoch: 45, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.371 Vali Acc: 0.877 Test Loss: 0.371 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 46 cost time: 0.666081428527832
Epoch: 46, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.400 Vali Acc: 0.862 Test Loss: 0.400 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6374125480651855
Epoch: 47, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.380 Vali Acc: 0.862 Test Loss: 0.380 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7019438743591309
Epoch: 48, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.398 Vali Acc: 0.877 Test Loss: 0.398 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.6241550445556641
Epoch: 49, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.395 Vali Acc: 0.870 Test Loss: 0.395 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.63700270652771
Epoch: 50, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.387 Vali Acc: 0.870 Test Loss: 0.387 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 147108
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.4318249225616455
Epoch: 1, Steps: 9 | Train Loss: 1.310 Vali Loss: 1.001 Vali Acc: 0.594 Test Loss: 1.001 Test Acc: 0.594
Validation loss decreased (inf --> -0.594193).  Saving model ...
Epoch: 2 cost time: 1.2005038261413574
Epoch: 2, Steps: 9 | Train Loss: 0.506 Vali Loss: 0.493 Vali Acc: 0.848 Test Loss: 0.493 Test Acc: 0.848
Validation loss decreased (-0.594193 --> -0.847821).  Saving model ...
Epoch: 3 cost time: 1.141716480255127
Epoch: 3, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.226 Vali Acc: 0.935 Test Loss: 0.226 Test Acc: 0.935
Validation loss decreased (-0.847821 --> -0.934780).  Saving model ...
Epoch: 4 cost time: 1.1139287948608398
Epoch: 4, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
Validation loss decreased (-0.934780 --> -0.956520).  Saving model ...
Epoch: 5 cost time: 1.0900413990020752
Epoch: 5, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.209 Vali Acc: 0.928 Test Loss: 0.209 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1356632709503174
Epoch: 6, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.201 Vali Acc: 0.920 Test Loss: 0.201 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0740420818328857
Epoch: 7, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.942 Test Loss: 0.199 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1202192306518555
Epoch: 8, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.942 Test Loss: 0.195 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0367486476898193
Epoch: 9, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.942 Test Loss: 0.203 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.151453971862793
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.942 Test Loss: 0.207 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.014631986618042
Epoch: 11, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.942 Test Loss: 0.212 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0649192333221436
Epoch: 12, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.187 Vali Acc: 0.935 Test Loss: 0.187 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0517516136169434
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.964 Test Loss: 0.173 Test Acc: 0.964
Validation loss decreased (-0.956520 --> -0.963766).  Saving model ...
Epoch: 14 cost time: 1.1297359466552734
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.949 Test Loss: 0.183 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1738030910491943
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0664896965026855
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.949 Test Loss: 0.183 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.131671667098999
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.942 Test Loss: 0.182 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8835875988006592
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1205196380615234
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.949 Test Loss: 0.139 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1467254161834717
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.949 Test Loss: 0.144 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1249306201934814
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.949 Test Loss: 0.142 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1809403896331787
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2071630954742432
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9637681159420289
model parameter : 1827588
model size : 7.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.45637583732605
Epoch: 1, Steps: 9 | Train Loss: 1.356 Vali Loss: 1.163 Vali Acc: 0.442 Test Loss: 1.163 Test Acc: 0.442
Validation loss decreased (inf --> -0.442017).  Saving model ...
Epoch: 2 cost time: 0.9150254726409912
Epoch: 2, Steps: 9 | Train Loss: 0.800 Vali Loss: 0.691 Vali Acc: 0.841 Test Loss: 0.691 Test Acc: 0.841
Validation loss decreased (-0.442017 --> -0.840573).  Saving model ...
Epoch: 3 cost time: 0.9104676246643066
Epoch: 3, Steps: 9 | Train Loss: 0.302 Vali Loss: 0.374 Vali Acc: 0.920 Test Loss: 0.374 Test Acc: 0.920
Validation loss decreased (-0.840573 --> -0.920286).  Saving model ...
Epoch: 4 cost time: 0.8929252624511719
Epoch: 4, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.256 Vali Acc: 0.942 Test Loss: 0.256 Test Acc: 0.942
Validation loss decreased (-0.920286 --> -0.942026).  Saving model ...
Epoch: 5 cost time: 0.8242387771606445
Epoch: 5, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.213 Vali Acc: 0.935 Test Loss: 0.213 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9278161525726318
Epoch: 6, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9712555408477783
Epoch: 7, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.949 Test Loss: 0.198 Test Acc: 0.949
Validation loss decreased (-0.942026 --> -0.949273).  Saving model ...
Epoch: 8 cost time: 0.9451625347137451
Epoch: 8, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.201 Vali Acc: 0.949 Test Loss: 0.201 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9743719100952148
Epoch: 9, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.942 Test Loss: 0.198 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0103967189788818
Epoch: 10, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.192 Vali Acc: 0.942 Test Loss: 0.192 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9407179355621338
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.942 Test Loss: 0.186 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.970787525177002
Epoch: 12, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949274).  Saving model ...
Epoch: 13 cost time: 0.8127865791320801
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 14 cost time: 0.8054075241088867
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8984720706939697
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.942 Test Loss: 0.172 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.861518144607544
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.942 Test Loss: 0.178 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9787628650665283
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.942 Test Loss: 0.173 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.840745210647583
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.942 Test Loss: 0.199 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0201737880706787
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9946496486663818
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9974339008331299
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.943842887878418
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.935 Test Loss: 0.201 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8805575370788574
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.935 Test Loss: 0.198 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 1724420
model size : 6.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.3399548530578613
Epoch: 1, Steps: 9 | Train Loss: 1.390 Vali Loss: 1.206 Vali Acc: 0.457 Test Loss: 1.206 Test Acc: 0.457
Validation loss decreased (inf --> -0.456510).  Saving model ...
Epoch: 2 cost time: 0.9477729797363281
Epoch: 2, Steps: 9 | Train Loss: 0.867 Vali Loss: 0.764 Vali Acc: 0.826 Test Loss: 0.764 Test Acc: 0.826
Validation loss decreased (-0.456510 --> -0.826079).  Saving model ...
Epoch: 3 cost time: 1.030625820159912
Epoch: 3, Steps: 9 | Train Loss: 0.430 Vali Loss: 0.481 Vali Acc: 0.891 Test Loss: 0.481 Test Acc: 0.891
Validation loss decreased (-0.826079 --> -0.891300).  Saving model ...
Epoch: 4 cost time: 0.9446549415588379
Epoch: 4, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.298 Vali Acc: 0.949 Test Loss: 0.298 Test Acc: 0.949
Validation loss decreased (-0.891300 --> -0.949272).  Saving model ...
Epoch: 5 cost time: 1.0211491584777832
Epoch: 5, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.241 Vali Acc: 0.935 Test Loss: 0.241 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8139169216156006
Epoch: 6, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.203 Vali Acc: 0.949 Test Loss: 0.203 Test Acc: 0.949
Validation loss decreased (-0.949272 --> -0.949273).  Saving model ...
Epoch: 7 cost time: 0.9212088584899902
Epoch: 7, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.196 Vali Acc: 0.949 Test Loss: 0.196 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 8 cost time: 0.8755261898040771
Epoch: 8, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 9 cost time: 0.9229655265808105
Epoch: 9, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.195 Vali Acc: 0.942 Test Loss: 0.195 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9327390193939209
Epoch: 10, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.191 Vali Acc: 0.949 Test Loss: 0.191 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 11 cost time: 0.9526875019073486
Epoch: 11, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.190 Vali Acc: 0.942 Test Loss: 0.190 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.946723222732544
Epoch: 12, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.200 Vali Acc: 0.935 Test Loss: 0.200 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9399712085723877
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.928 Test Loss: 0.205 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9196205139160156
Epoch: 14, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9812266826629639
Epoch: 15, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.194 Vali Acc: 0.942 Test Loss: 0.194 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9614431858062744
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.208 Vali Acc: 0.949 Test Loss: 0.208 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9189696311950684
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.935 Test Loss: 0.212 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9120666980743408
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8413815498352051
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8977925777435303
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 1698052
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.4277842044830322
Epoch: 1, Steps: 9 | Train Loss: 1.301 Vali Loss: 1.170 Vali Acc: 0.594 Test Loss: 1.170 Test Acc: 0.594
Validation loss decreased (inf --> -0.594191).  Saving model ...
Epoch: 2 cost time: 0.8754160404205322
Epoch: 2, Steps: 9 | Train Loss: 0.931 Vali Loss: 0.845 Vali Acc: 0.739 Test Loss: 0.845 Test Acc: 0.739
Validation loss decreased (-0.594191 --> -0.739122).  Saving model ...
Epoch: 3 cost time: 0.8884131908416748
Epoch: 3, Steps: 9 | Train Loss: 0.546 Vali Loss: 0.592 Vali Acc: 0.862 Test Loss: 0.592 Test Acc: 0.862
Validation loss decreased (-0.739122 --> -0.862313).  Saving model ...
Epoch: 4 cost time: 0.9011805057525635
Epoch: 4, Steps: 9 | Train Loss: 0.265 Vali Loss: 0.388 Vali Acc: 0.891 Test Loss: 0.388 Test Acc: 0.891
Validation loss decreased (-0.862313 --> -0.891300).  Saving model ...
Epoch: 5 cost time: 0.903322696685791
Epoch: 5, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.293 Vali Acc: 0.906 Test Loss: 0.293 Test Acc: 0.906
Validation loss decreased (-0.891300 --> -0.905794).  Saving model ...
Epoch: 6 cost time: 0.7701241970062256
Epoch: 6, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.248 Vali Acc: 0.928 Test Loss: 0.248 Test Acc: 0.928
Validation loss decreased (-0.905794 --> -0.927534).  Saving model ...
Epoch: 7 cost time: 0.896359920501709
Epoch: 7, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.245 Vali Acc: 0.928 Test Loss: 0.245 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 8 cost time: 0.8738358020782471
Epoch: 8, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 9 cost time: 0.8391342163085938
Epoch: 9, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.227 Vali Acc: 0.935 Test Loss: 0.227 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 10 cost time: 0.909095048904419
Epoch: 10, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.218 Vali Acc: 0.935 Test Loss: 0.218 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 11 cost time: 0.8179454803466797
Epoch: 11, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.219 Vali Acc: 0.935 Test Loss: 0.219 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8846874237060547
Epoch: 12, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.217 Vali Acc: 0.935 Test Loss: 0.217 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 13 cost time: 0.910653829574585
Epoch: 13, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.219 Vali Acc: 0.935 Test Loss: 0.219 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8419270515441895
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.935 Test Loss: 0.217 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8723995685577393
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.213 Vali Acc: 0.935 Test Loss: 0.213 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 16 cost time: 0.7918124198913574
Epoch: 16, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 17 cost time: 0.7334060668945312
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934781).  Saving model ...
Epoch: 18 cost time: 0.7867040634155273
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 19 cost time: 0.8124070167541504
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8438663482666016
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.935 Test Loss: 0.217 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8243186473846436
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.935 Test Loss: 0.218 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8000469207763672
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.935 Test Loss: 0.220 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9299085140228271
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.226 Vali Acc: 0.928 Test Loss: 0.226 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.868412971496582
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.935 Test Loss: 0.227 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.81036376953125
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.935 Test Loss: 0.233 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8299531936645508
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8882949352264404
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9595947265625
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.935 Test Loss: 0.236 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 1677828
model size : 6.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1433682441711426
Epoch: 1, Steps: 9 | Train Loss: 1.273 Vali Loss: 1.212 Vali Acc: 0.493 Test Loss: 1.212 Test Acc: 0.493
Validation loss decreased (inf --> -0.492742).  Saving model ...
Epoch: 2 cost time: 0.8711786270141602
Epoch: 2, Steps: 9 | Train Loss: 1.001 Vali Loss: 0.974 Vali Acc: 0.601 Test Loss: 0.974 Test Acc: 0.601
Validation loss decreased (-0.492742 --> -0.601440).  Saving model ...
Epoch: 3 cost time: 0.8901255130767822
Epoch: 3, Steps: 9 | Train Loss: 0.732 Vali Loss: 0.728 Vali Acc: 0.790 Test Loss: 0.728 Test Acc: 0.790
Validation loss decreased (-0.601440 --> -0.789848).  Saving model ...
Epoch: 4 cost time: 0.858586311340332
Epoch: 4, Steps: 9 | Train Loss: 0.431 Vali Loss: 0.539 Vali Acc: 0.884 Test Loss: 0.539 Test Acc: 0.884
Validation loss decreased (-0.789848 --> -0.884053).  Saving model ...
Epoch: 5 cost time: 0.8791403770446777
Epoch: 5, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.395 Vali Acc: 0.935 Test Loss: 0.395 Test Acc: 0.935
Validation loss decreased (-0.884053 --> -0.934779).  Saving model ...
Epoch: 6 cost time: 0.8899309635162354
Epoch: 6, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.332 Vali Acc: 0.928 Test Loss: 0.332 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8033151626586914
Epoch: 7, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.295 Vali Acc: 0.935 Test Loss: 0.295 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934780).  Saving model ...
Epoch: 8 cost time: 0.8261597156524658
Epoch: 8, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.283 Vali Acc: 0.928 Test Loss: 0.283 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7712187767028809
Epoch: 9, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.281 Vali Acc: 0.928 Test Loss: 0.281 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.907606840133667
Epoch: 10, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.262 Vali Acc: 0.928 Test Loss: 0.262 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8390965461730957
Epoch: 11, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.238 Vali Acc: 0.942 Test Loss: 0.238 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 12 cost time: 0.8578319549560547
Epoch: 12, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.230 Vali Acc: 0.935 Test Loss: 0.230 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9104037284851074
Epoch: 13, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.226 Vali Acc: 0.928 Test Loss: 0.226 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8694424629211426
Epoch: 14, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.237 Vali Acc: 0.920 Test Loss: 0.237 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.88924241065979
Epoch: 15, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.236 Vali Acc: 0.920 Test Loss: 0.236 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0078003406524658
Epoch: 16, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9508788585662842
Epoch: 17, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.245 Vali Acc: 0.928 Test Loss: 0.245 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8975906372070312
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.224 Vali Acc: 0.928 Test Loss: 0.224 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.946469783782959
Epoch: 19, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.935 Test Loss: 0.217 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8898348808288574
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7733476161956787
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.213 Vali Acc: 0.928 Test Loss: 0.213 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 1661956
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0713179111480713
Epoch: 1, Steps: 9 | Train Loss: 1.420 Vali Loss: 1.354 Vali Acc: 0.326 Test Loss: 1.354 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 0.810197114944458
Epoch: 2, Steps: 9 | Train Loss: 1.166 Vali Loss: 1.129 Vali Acc: 0.529 Test Loss: 1.129 Test Acc: 0.529
Validation loss decreased (-0.326073 --> -0.528974).  Saving model ...
Epoch: 3 cost time: 0.768749475479126
Epoch: 3, Steps: 9 | Train Loss: 0.870 Vali Loss: 0.885 Vali Acc: 0.688 Test Loss: 0.885 Test Acc: 0.688
Validation loss decreased (-0.528974 --> -0.688397).  Saving model ...
Epoch: 4 cost time: 0.8404383659362793
Epoch: 4, Steps: 9 | Train Loss: 0.584 Vali Loss: 0.682 Vali Acc: 0.790 Test Loss: 0.682 Test Acc: 0.790
Validation loss decreased (-0.688397 --> -0.789848).  Saving model ...
Epoch: 5 cost time: 0.8015930652618408
Epoch: 5, Steps: 9 | Train Loss: 0.378 Vali Loss: 0.535 Vali Acc: 0.870 Test Loss: 0.535 Test Acc: 0.870
Validation loss decreased (-0.789848 --> -0.869560).  Saving model ...
Epoch: 6 cost time: 0.7906358242034912
Epoch: 6, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.421 Vali Acc: 0.899 Test Loss: 0.421 Test Acc: 0.899
Validation loss decreased (-0.869560 --> -0.898547).  Saving model ...
Epoch: 7 cost time: 0.7905023097991943
Epoch: 7, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.341 Vali Acc: 0.913 Test Loss: 0.341 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913040).  Saving model ...
Epoch: 8 cost time: 0.7726316452026367
Epoch: 8, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.317 Vali Acc: 0.920 Test Loss: 0.317 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 9 cost time: 0.762392520904541
Epoch: 9, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.297 Vali Acc: 0.913 Test Loss: 0.297 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7995591163635254
Epoch: 10, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.285 Vali Acc: 0.913 Test Loss: 0.285 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7511813640594482
Epoch: 11, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.264 Vali Acc: 0.928 Test Loss: 0.264 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 12 cost time: 0.867009162902832
Epoch: 12, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.252 Vali Acc: 0.928 Test Loss: 0.252 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 13 cost time: 0.7609682083129883
Epoch: 13, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.243 Vali Acc: 0.928 Test Loss: 0.243 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 14 cost time: 0.7277359962463379
Epoch: 14, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.251 Vali Acc: 0.928 Test Loss: 0.251 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7108035087585449
Epoch: 15, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.243 Vali Acc: 0.920 Test Loss: 0.243 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7978949546813965
Epoch: 16, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.240 Vali Acc: 0.920 Test Loss: 0.240 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.881331205368042
Epoch: 17, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 18 cost time: 0.7994182109832764
Epoch: 18, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.242 Vali Acc: 0.920 Test Loss: 0.242 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7923455238342285
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.230 Vali Acc: 0.935 Test Loss: 0.230 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 20 cost time: 0.8330309391021729
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 21 cost time: 0.8178462982177734
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.228 Vali Acc: 0.928 Test Loss: 0.228 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8034756183624268
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.226 Vali Acc: 0.928 Test Loss: 0.226 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.763697624206543
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.233 Vali Acc: 0.920 Test Loss: 0.233 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7394399642944336
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.247 Vali Acc: 0.920 Test Loss: 0.247 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8197028636932373
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.234 Vali Acc: 0.920 Test Loss: 0.234 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7759654521942139
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.920 Test Loss: 0.237 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7506396770477295
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.241 Vali Acc: 0.920 Test Loss: 0.241 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7290470600128174
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.928 Test Loss: 0.219 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7280762195587158
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.928 Test Loss: 0.216 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6729140281677246
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 1655556
model size : 6.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1554744243621826
Epoch: 1, Steps: 9 | Train Loss: 1.392 Vali Loss: 1.296 Vali Acc: 0.413 Test Loss: 1.296 Test Acc: 0.413
Validation loss decreased (inf --> -0.413031).  Saving model ...
Epoch: 2 cost time: 0.8141586780548096
Epoch: 2, Steps: 9 | Train Loss: 1.188 Vali Loss: 1.121 Vali Acc: 0.551 Test Loss: 1.121 Test Acc: 0.551
Validation loss decreased (-0.413031 --> -0.550713).  Saving model ...
Epoch: 3 cost time: 0.8255853652954102
Epoch: 3, Steps: 9 | Train Loss: 0.921 Vali Loss: 0.921 Vali Acc: 0.710 Test Loss: 0.921 Test Acc: 0.710
Validation loss decreased (-0.550713 --> -0.710136).  Saving model ...
Epoch: 4 cost time: 0.8408482074737549
Epoch: 4, Steps: 9 | Train Loss: 0.692 Vali Loss: 0.758 Vali Acc: 0.797 Test Loss: 0.758 Test Acc: 0.797
Validation loss decreased (-0.710136 --> -0.797094).  Saving model ...
Epoch: 5 cost time: 0.8049731254577637
Epoch: 5, Steps: 9 | Train Loss: 0.492 Vali Loss: 0.615 Vali Acc: 0.841 Test Loss: 0.615 Test Acc: 0.841
Validation loss decreased (-0.797094 --> -0.840574).  Saving model ...
Epoch: 6 cost time: 0.803471565246582
Epoch: 6, Steps: 9 | Train Loss: 0.321 Vali Loss: 0.505 Vali Acc: 0.870 Test Loss: 0.505 Test Acc: 0.870
Validation loss decreased (-0.840574 --> -0.869560).  Saving model ...
Epoch: 7 cost time: 0.8807582855224609
Epoch: 7, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.410 Vali Acc: 0.906 Test Loss: 0.410 Test Acc: 0.906
Validation loss decreased (-0.869560 --> -0.905793).  Saving model ...
Epoch: 8 cost time: 0.8082575798034668
Epoch: 8, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.363 Vali Acc: 0.913 Test Loss: 0.363 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913040).  Saving model ...
Epoch: 9 cost time: 0.9039890766143799
Epoch: 9, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.327 Vali Acc: 0.906 Test Loss: 0.327 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7697317600250244
Epoch: 10, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.327 Vali Acc: 0.906 Test Loss: 0.327 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8372507095336914
Epoch: 11, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.324 Vali Acc: 0.913 Test Loss: 0.324 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 12 cost time: 0.8330633640289307
Epoch: 12, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.298 Vali Acc: 0.920 Test Loss: 0.298 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 13 cost time: 0.9051868915557861
Epoch: 13, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.266 Vali Acc: 0.920 Test Loss: 0.266 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 14 cost time: 0.9005367755889893
Epoch: 14, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.258 Vali Acc: 0.913 Test Loss: 0.258 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8470509052276611
Epoch: 15, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.259 Vali Acc: 0.913 Test Loss: 0.259 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8762264251708984
Epoch: 16, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.262 Vali Acc: 0.920 Test Loss: 0.262 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 17 cost time: 0.8425121307373047
Epoch: 17, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.263 Vali Acc: 0.920 Test Loss: 0.263 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8110661506652832
Epoch: 18, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.266 Vali Acc: 0.920 Test Loss: 0.266 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8261008262634277
Epoch: 19, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7840287685394287
Epoch: 20, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.262 Vali Acc: 0.913 Test Loss: 0.262 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.790844202041626
Epoch: 21, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.271 Vali Acc: 0.920 Test Loss: 0.271 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7587254047393799
Epoch: 22, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.258 Vali Acc: 0.920 Test Loss: 0.258 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 23 cost time: 0.8941695690155029
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.237 Vali Acc: 0.913 Test Loss: 0.237 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7682585716247559
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.232 Vali Acc: 0.920 Test Loss: 0.232 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920288).  Saving model ...
Epoch: 25 cost time: 0.8208918571472168
Epoch: 25, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.235 Vali Acc: 0.920 Test Loss: 0.235 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7783036231994629
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.253 Vali Acc: 0.920 Test Loss: 0.253 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8164854049682617
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.247 Vali Acc: 0.913 Test Loss: 0.247 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8359754085540771
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.249 Vali Acc: 0.920 Test Loss: 0.249 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.848097562789917
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.253 Vali Acc: 0.920 Test Loss: 0.253 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8369402885437012
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.920 Test Loss: 0.248 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8194653987884521
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.253 Vali Acc: 0.920 Test Loss: 0.253 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8373773097991943
Epoch: 32, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.256 Vali Acc: 0.920 Test Loss: 0.256 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8100993633270264
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.906 Test Loss: 0.256 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8050086498260498
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.906 Test Loss: 0.253 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 1651972
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1805710792541504
Epoch: 1, Steps: 9 | Train Loss: 1.408 Vali Loss: 1.189 Vali Acc: 0.478 Test Loss: 1.189 Test Acc: 0.478
Validation loss decreased (inf --> -0.478249).  Saving model ...
Epoch: 2 cost time: 0.7967708110809326
Epoch: 2, Steps: 9 | Train Loss: 0.875 Vali Loss: 0.754 Vali Acc: 0.775 Test Loss: 0.754 Test Acc: 0.775
Validation loss decreased (-0.478249 --> -0.775355).  Saving model ...
Epoch: 3 cost time: 0.758760929107666
Epoch: 3, Steps: 9 | Train Loss: 0.392 Vali Loss: 0.471 Vali Acc: 0.870 Test Loss: 0.471 Test Acc: 0.870
Validation loss decreased (-0.775355 --> -0.869561).  Saving model ...
Epoch: 4 cost time: 0.8468964099884033
Epoch: 4, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.250 Vali Acc: 0.942 Test Loss: 0.250 Test Acc: 0.942
Validation loss decreased (-0.869561 --> -0.942026).  Saving model ...
Epoch: 5 cost time: 0.8235738277435303
Epoch: 5, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.230 Vali Acc: 0.920 Test Loss: 0.230 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.95546555519104
Epoch: 6, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8183109760284424
Epoch: 7, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.225 Vali Acc: 0.935 Test Loss: 0.225 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8412673473358154
Epoch: 8, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8474893569946289
Epoch: 9, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.942 Test Loss: 0.186 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 10 cost time: 0.8950848579406738
Epoch: 10, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.171 Vali Acc: 0.942 Test Loss: 0.171 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 11 cost time: 0.891730785369873
Epoch: 11, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.928 Test Loss: 0.205 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8595681190490723
Epoch: 12, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.227 Vali Acc: 0.913 Test Loss: 0.227 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9530298709869385
Epoch: 13, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.920 Test Loss: 0.228 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0084171295166016
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.928 Test Loss: 0.215 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8573968410491943
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.928 Test Loss: 0.206 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9391131401062012
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7708566188812256
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.928 Test Loss: 0.199 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8348574638366699
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.928 Test Loss: 0.194 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6331284046173096
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.928 Test Loss: 0.195 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.821840763092041
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.928 Test Loss: 0.188 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 520580
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.104001998901367
Epoch: 1, Steps: 9 | Train Loss: 1.360 Vali Loss: 1.230 Vali Acc: 0.507 Test Loss: 1.230 Test Acc: 0.507
Validation loss decreased (inf --> -0.507234).  Saving model ...
Epoch: 2 cost time: 0.7365410327911377
Epoch: 2, Steps: 9 | Train Loss: 0.965 Vali Loss: 0.890 Vali Acc: 0.732 Test Loss: 0.890 Test Acc: 0.732
Validation loss decreased (-0.507234 --> -0.731875).  Saving model ...
Epoch: 3 cost time: 0.7256259918212891
Epoch: 3, Steps: 9 | Train Loss: 0.595 Vali Loss: 0.600 Vali Acc: 0.819 Test Loss: 0.600 Test Acc: 0.819
Validation loss decreased (-0.731875 --> -0.818835).  Saving model ...
Epoch: 4 cost time: 0.7258987426757812
Epoch: 4, Steps: 9 | Train Loss: 0.332 Vali Loss: 0.424 Vali Acc: 0.899 Test Loss: 0.424 Test Acc: 0.899
Validation loss decreased (-0.818835 --> -0.898546).  Saving model ...
Epoch: 5 cost time: 0.7219061851501465
Epoch: 5, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.308 Vali Acc: 0.913 Test Loss: 0.308 Test Acc: 0.913
Validation loss decreased (-0.898546 --> -0.913040).  Saving model ...
Epoch: 6 cost time: 0.6104874610900879
Epoch: 6, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.265 Vali Acc: 0.935 Test Loss: 0.265 Test Acc: 0.935
Validation loss decreased (-0.913040 --> -0.934780).  Saving model ...
Epoch: 7 cost time: 0.7367427349090576
Epoch: 7, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.221 Vali Acc: 0.942 Test Loss: 0.221 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 8 cost time: 0.6401004791259766
Epoch: 8, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.216 Vali Acc: 0.935 Test Loss: 0.216 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7400264739990234
Epoch: 9, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.212 Vali Acc: 0.942 Test Loss: 0.212 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 10 cost time: 0.6425554752349854
Epoch: 10, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6803815364837646
Epoch: 11, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.195 Vali Acc: 0.942 Test Loss: 0.195 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 12 cost time: 0.7104411125183105
Epoch: 12, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.192 Vali Acc: 0.949 Test Loss: 0.192 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949273).  Saving model ...
Epoch: 13 cost time: 0.7335569858551025
Epoch: 13, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6957638263702393
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.205 Vali Acc: 0.928 Test Loss: 0.205 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7111191749572754
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6928079128265381
Epoch: 16, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.662954568862915
Epoch: 17, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.188 Vali Acc: 0.935 Test Loss: 0.188 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6584179401397705
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.186 Vali Acc: 0.935 Test Loss: 0.186 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6724128723144531
Epoch: 19, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.182 Vali Acc: 0.942 Test Loss: 0.182 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6672196388244629
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.942 Test Loss: 0.180 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7023441791534424
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.942 Test Loss: 0.181 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6945600509643555
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.942 Test Loss: 0.180 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 468996
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.130810499191284
Epoch: 1, Steps: 9 | Train Loss: 1.453 Vali Loss: 1.273 Vali Acc: 0.384 Test Loss: 1.273 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 0.7137978076934814
Epoch: 2, Steps: 9 | Train Loss: 1.160 Vali Loss: 1.026 Vali Acc: 0.543 Test Loss: 1.026 Test Acc: 0.543
Validation loss decreased (-0.384045 --> -0.543468).  Saving model ...
Epoch: 3 cost time: 0.741574764251709
Epoch: 3, Steps: 9 | Train Loss: 0.787 Vali Loss: 0.772 Vali Acc: 0.790 Test Loss: 0.772 Test Acc: 0.790
Validation loss decreased (-0.543468 --> -0.789847).  Saving model ...
Epoch: 4 cost time: 0.7132971286773682
Epoch: 4, Steps: 9 | Train Loss: 0.491 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
Validation loss decreased (-0.789847 --> -0.833328).  Saving model ...
Epoch: 5 cost time: 0.7328195571899414
Epoch: 5, Steps: 9 | Train Loss: 0.290 Vali Loss: 0.408 Vali Acc: 0.899 Test Loss: 0.408 Test Acc: 0.899
Validation loss decreased (-0.833328 --> -0.898547).  Saving model ...
Epoch: 6 cost time: 0.7717478275299072
Epoch: 6, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.330 Vali Acc: 0.899 Test Loss: 0.330 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 7 cost time: 0.7023797035217285
Epoch: 7, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.294 Vali Acc: 0.913 Test Loss: 0.294 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913041).  Saving model ...
Epoch: 8 cost time: 0.6867358684539795
Epoch: 8, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.272 Vali Acc: 0.928 Test Loss: 0.272 Test Acc: 0.928
Validation loss decreased (-0.913041 --> -0.927534).  Saving model ...
Epoch: 9 cost time: 0.7558207511901855
Epoch: 9, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.238 Vali Acc: 0.935 Test Loss: 0.238 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 10 cost time: 0.6793293952941895
Epoch: 10, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 11 cost time: 0.67724609375
Epoch: 11, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.224 Vali Acc: 0.935 Test Loss: 0.224 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 12 cost time: 0.6966431140899658
Epoch: 12, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 13 cost time: 0.6665153503417969
Epoch: 13, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.218 Vali Acc: 0.935 Test Loss: 0.218 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6662333011627197
Epoch: 14, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.217 Vali Acc: 0.928 Test Loss: 0.217 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6715409755706787
Epoch: 15, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.217 Vali Acc: 0.928 Test Loss: 0.217 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6602931022644043
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.212 Vali Acc: 0.920 Test Loss: 0.212 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8005070686340332
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934781).  Saving model ...
Epoch: 18 cost time: 0.7510030269622803
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.212 Vali Acc: 0.935 Test Loss: 0.212 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7099528312683105
Epoch: 19, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.198 Vali Acc: 0.935 Test Loss: 0.198 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 20 cost time: 0.7647364139556885
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6853148937225342
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7532455921173096
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.213 Vali Acc: 0.942 Test Loss: 0.213 Test Acc: 0.942
Validation loss decreased (-0.934781 --> -0.942027).  Saving model ...
Epoch: 23 cost time: 0.6957356929779053
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6588425636291504
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7182896137237549
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7324843406677246
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.942 Test Loss: 0.191 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 27 cost time: 0.6823508739471436
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.942 Test Loss: 0.180 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 28 cost time: 0.6484570503234863
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.942 Test Loss: 0.182 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7344677448272705
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.942 Test Loss: 0.181 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6748065948486328
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.942 Test Loss: 0.184 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6920731067657471
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.942 Test Loss: 0.181 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6567139625549316
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.942 Test Loss: 0.186 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6790523529052734
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.942 Test Loss: 0.188 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6384811401367188
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.942 Test Loss: 0.189 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7260456085205078
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.942 Test Loss: 0.187 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7139787673950195
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.942 Test Loss: 0.190 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.6750607490539551
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.942 Test Loss: 0.190 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 455812
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9605727195739746
Epoch: 1, Steps: 9 | Train Loss: 1.287 Vali Loss: 1.255 Vali Acc: 0.442 Test Loss: 1.255 Test Acc: 0.442
Validation loss decreased (inf --> -0.442016).  Saving model ...
Epoch: 2 cost time: 0.698777437210083
Epoch: 2, Steps: 9 | Train Loss: 1.081 Vali Loss: 1.049 Vali Acc: 0.565 Test Loss: 1.049 Test Acc: 0.565
Validation loss decreased (-0.442016 --> -0.565207).  Saving model ...
Epoch: 3 cost time: 0.6707286834716797
Epoch: 3, Steps: 9 | Train Loss: 0.828 Vali Loss: 0.836 Vali Acc: 0.754 Test Loss: 0.836 Test Acc: 0.754
Validation loss decreased (-0.565207 --> -0.753615).  Saving model ...
Epoch: 4 cost time: 0.7216217517852783
Epoch: 4, Steps: 9 | Train Loss: 0.575 Vali Loss: 0.646 Vali Acc: 0.826 Test Loss: 0.646 Test Acc: 0.826
Validation loss decreased (-0.753615 --> -0.826080).  Saving model ...
Epoch: 5 cost time: 0.6472945213317871
Epoch: 5, Steps: 9 | Train Loss: 0.387 Vali Loss: 0.495 Vali Acc: 0.891 Test Loss: 0.495 Test Acc: 0.891
Validation loss decreased (-0.826080 --> -0.891299).  Saving model ...
Epoch: 6 cost time: 0.6997385025024414
Epoch: 6, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.386 Vali Acc: 0.920 Test Loss: 0.386 Test Acc: 0.920
Validation loss decreased (-0.891299 --> -0.920286).  Saving model ...
Epoch: 7 cost time: 0.628138542175293
Epoch: 7, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.335 Vali Acc: 0.920 Test Loss: 0.335 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920287).  Saving model ...
Epoch: 8 cost time: 0.5842995643615723
Epoch: 8, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.293 Vali Acc: 0.935 Test Loss: 0.293 Test Acc: 0.935
Validation loss decreased (-0.920287 --> -0.934780).  Saving model ...
Epoch: 9 cost time: 0.6392800807952881
Epoch: 9, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.271 Vali Acc: 0.942 Test Loss: 0.271 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942026).  Saving model ...
Epoch: 10 cost time: 0.595848798751831
Epoch: 10, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.258 Vali Acc: 0.935 Test Loss: 0.258 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6108975410461426
Epoch: 11, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.241 Vali Acc: 0.942 Test Loss: 0.241 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 12 cost time: 0.6407325267791748
Epoch: 12, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6593480110168457
Epoch: 13, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.224 Vali Acc: 0.935 Test Loss: 0.224 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6675302982330322
Epoch: 14, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.214 Vali Acc: 0.942 Test Loss: 0.214 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 15 cost time: 0.6541249752044678
Epoch: 15, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.214 Vali Acc: 0.935 Test Loss: 0.214 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6242959499359131
Epoch: 16, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.214 Vali Acc: 0.935 Test Loss: 0.214 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6978883743286133
Epoch: 17, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.218 Vali Acc: 0.935 Test Loss: 0.218 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6897985935211182
Epoch: 18, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.221 Vali Acc: 0.942 Test Loss: 0.221 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7031834125518799
Epoch: 19, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.216 Vali Acc: 0.935 Test Loss: 0.216 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6384625434875488
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.681168794631958
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.707338809967041
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.204 Vali Acc: 0.942 Test Loss: 0.204 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 23 cost time: 0.6278476715087891
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.949 Test Loss: 0.203 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949273).  Saving model ...
Epoch: 24 cost time: 0.662804365158081
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.195 Vali Acc: 0.949 Test Loss: 0.195 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 25 cost time: 0.5979335308074951
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.949 Test Loss: 0.194 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 26 cost time: 0.6184754371643066
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.949 Test Loss: 0.191 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 27 cost time: 0.6897141933441162
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.177 Vali Acc: 0.942 Test Loss: 0.177 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6878979206085205
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.942 Test Loss: 0.179 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.623633861541748
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.942 Test Loss: 0.184 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6190564632415771
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.942 Test Loss: 0.184 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7363486289978027
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.942 Test Loss: 0.190 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6551201343536377
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6497516632080078
Epoch: 33, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.942 Test Loss: 0.185 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6467161178588867
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.942 Test Loss: 0.160 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6369917392730713
Epoch: 35, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949274).  Saving model ...
Epoch: 36 cost time: 0.6254467964172363
Epoch: 36, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.942 Test Loss: 0.169 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.663780927658081
Epoch: 37, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.942 Test Loss: 0.181 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6806061267852783
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6119515895843506
Epoch: 39, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.219 Vali Acc: 0.928 Test Loss: 0.219 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6752848625183105
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.928 Test Loss: 0.223 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.5989508628845215
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.928 Test Loss: 0.215 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6042935848236084
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.935 Test Loss: 0.185 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.6479568481445312
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.942 Test Loss: 0.177 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6257593631744385
Epoch: 44, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.942 Test Loss: 0.179 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.6405081748962402
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.942 Test Loss: 0.183 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 445700
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.99017333984375
Epoch: 1, Steps: 9 | Train Loss: 1.316 Vali Loss: 1.219 Vali Acc: 0.543 Test Loss: 1.219 Test Acc: 0.543
Validation loss decreased (inf --> -0.543466).  Saving model ...
Epoch: 2 cost time: 0.6174576282501221
Epoch: 2, Steps: 9 | Train Loss: 1.135 Vali Loss: 1.069 Vali Acc: 0.652 Test Loss: 1.069 Test Acc: 0.652
Validation loss decreased (-0.543466 --> -0.652163).  Saving model ...
Epoch: 3 cost time: 0.6197409629821777
Epoch: 3, Steps: 9 | Train Loss: 0.951 Vali Loss: 0.902 Vali Acc: 0.710 Test Loss: 0.902 Test Acc: 0.710
Validation loss decreased (-0.652163 --> -0.710136).  Saving model ...
Epoch: 4 cost time: 0.7434487342834473
Epoch: 4, Steps: 9 | Train Loss: 0.738 Vali Loss: 0.747 Vali Acc: 0.768 Test Loss: 0.747 Test Acc: 0.768
Validation loss decreased (-0.710136 --> -0.768108).  Saving model ...
Epoch: 5 cost time: 0.6323544979095459
Epoch: 5, Steps: 9 | Train Loss: 0.544 Vali Loss: 0.621 Vali Acc: 0.826 Test Loss: 0.621 Test Acc: 0.826
Validation loss decreased (-0.768108 --> -0.826081).  Saving model ...
Epoch: 6 cost time: 0.6531722545623779
Epoch: 6, Steps: 9 | Train Loss: 0.421 Vali Loss: 0.519 Vali Acc: 0.848 Test Loss: 0.519 Test Acc: 0.848
Validation loss decreased (-0.826081 --> -0.847821).  Saving model ...
Epoch: 7 cost time: 0.6167299747467041
Epoch: 7, Steps: 9 | Train Loss: 0.310 Vali Loss: 0.430 Vali Acc: 0.884 Test Loss: 0.430 Test Acc: 0.884
Validation loss decreased (-0.847821 --> -0.884054).  Saving model ...
Epoch: 8 cost time: 0.627406120300293
Epoch: 8, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.376 Vali Acc: 0.913 Test Loss: 0.376 Test Acc: 0.913
Validation loss decreased (-0.884054 --> -0.913040).  Saving model ...
Epoch: 9 cost time: 0.6601240634918213
Epoch: 9, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.339 Vali Acc: 0.899 Test Loss: 0.339 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6749942302703857
Epoch: 10, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.319 Vali Acc: 0.899 Test Loss: 0.319 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6773455142974854
Epoch: 11, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.301 Vali Acc: 0.913 Test Loss: 0.301 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 12 cost time: 0.6463723182678223
Epoch: 12, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.284 Vali Acc: 0.928 Test Loss: 0.284 Test Acc: 0.928
Validation loss decreased (-0.913040 --> -0.927533).  Saving model ...
Epoch: 13 cost time: 0.6788361072540283
Epoch: 13, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.272 Vali Acc: 0.928 Test Loss: 0.272 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927534).  Saving model ...
Epoch: 14 cost time: 0.677483320236206
Epoch: 14, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.255 Vali Acc: 0.920 Test Loss: 0.255 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7019343376159668
Epoch: 15, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.251 Vali Acc: 0.920 Test Loss: 0.251 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6590800285339355
Epoch: 16, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.234 Vali Acc: 0.928 Test Loss: 0.234 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 17 cost time: 0.7022974491119385
Epoch: 17, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.231 Vali Acc: 0.920 Test Loss: 0.231 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6779892444610596
Epoch: 18, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.231 Vali Acc: 0.928 Test Loss: 0.231 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 19 cost time: 0.6246929168701172
Epoch: 19, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.239 Vali Acc: 0.928 Test Loss: 0.239 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6037054061889648
Epoch: 20, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.233 Vali Acc: 0.935 Test Loss: 0.233 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 21 cost time: 0.6354293823242188
Epoch: 21, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6560037136077881
Epoch: 22, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6076087951660156
Epoch: 23, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6813817024230957
Epoch: 24, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6343014240264893
Epoch: 25, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934781).  Saving model ...
Epoch: 26 cost time: 0.6251661777496338
Epoch: 26, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.206 Vali Acc: 0.928 Test Loss: 0.206 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6282107830047607
Epoch: 27, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.209 Vali Acc: 0.928 Test Loss: 0.209 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.664902925491333
Epoch: 28, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.217 Vali Acc: 0.928 Test Loss: 0.217 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6578726768493652
Epoch: 29, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.217 Vali Acc: 0.928 Test Loss: 0.217 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6705508232116699
Epoch: 30, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.239 Vali Acc: 0.928 Test Loss: 0.239 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6255331039428711
Epoch: 31, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7279839515686035
Epoch: 32, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6241340637207031
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6290991306304932
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.920 Test Loss: 0.208 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6329703330993652
Epoch: 35, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.223 Vali Acc: 0.928 Test Loss: 0.223 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 437764
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0229127407073975
Epoch: 1, Steps: 9 | Train Loss: 1.362 Vali Loss: 1.325 Vali Acc: 0.312 Test Loss: 1.325 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 0.6030340194702148
Epoch: 2, Steps: 9 | Train Loss: 1.256 Vali Loss: 1.193 Vali Acc: 0.500 Test Loss: 1.193 Test Acc: 0.500
Validation loss decreased (-0.311581 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 0.6910035610198975
Epoch: 3, Steps: 9 | Train Loss: 1.044 Vali Loss: 1.032 Vali Acc: 0.594 Test Loss: 1.032 Test Acc: 0.594
Validation loss decreased (-0.499988 --> -0.594193).  Saving model ...
Epoch: 4 cost time: 0.6634705066680908
Epoch: 4, Steps: 9 | Train Loss: 0.843 Vali Loss: 0.883 Vali Acc: 0.717 Test Loss: 0.883 Test Acc: 0.717
Validation loss decreased (-0.594193 --> -0.717382).  Saving model ...
Epoch: 5 cost time: 0.6293020248413086
Epoch: 5, Steps: 9 | Train Loss: 0.685 Vali Loss: 0.750 Vali Acc: 0.804 Test Loss: 0.750 Test Acc: 0.804
Validation loss decreased (-0.717382 --> -0.804340).  Saving model ...
Epoch: 6 cost time: 0.6575050354003906
Epoch: 6, Steps: 9 | Train Loss: 0.502 Vali Loss: 0.637 Vali Acc: 0.833 Test Loss: 0.637 Test Acc: 0.833
Validation loss decreased (-0.804340 --> -0.833327).  Saving model ...
Epoch: 7 cost time: 0.6133646965026855
Epoch: 7, Steps: 9 | Train Loss: 0.388 Vali Loss: 0.557 Vali Acc: 0.855 Test Loss: 0.557 Test Acc: 0.855
Validation loss decreased (-0.833327 --> -0.855067).  Saving model ...
Epoch: 8 cost time: 0.636577844619751
Epoch: 8, Steps: 9 | Train Loss: 0.301 Vali Loss: 0.488 Vali Acc: 0.870 Test Loss: 0.488 Test Acc: 0.870
Validation loss decreased (-0.855067 --> -0.869560).  Saving model ...
Epoch: 9 cost time: 0.6231403350830078
Epoch: 9, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.429 Vali Acc: 0.899 Test Loss: 0.429 Test Acc: 0.899
Validation loss decreased (-0.869560 --> -0.898546).  Saving model ...
Epoch: 10 cost time: 0.6548871994018555
Epoch: 10, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.382 Vali Acc: 0.906 Test Loss: 0.382 Test Acc: 0.906
Validation loss decreased (-0.898546 --> -0.905793).  Saving model ...
Epoch: 11 cost time: 0.6613960266113281
Epoch: 11, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.365 Vali Acc: 0.899 Test Loss: 0.365 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6580255031585693
Epoch: 12, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.337 Vali Acc: 0.906 Test Loss: 0.337 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905794).  Saving model ...
Epoch: 13 cost time: 0.5854499340057373
Epoch: 13, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.332 Vali Acc: 0.906 Test Loss: 0.332 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 14 cost time: 0.6712825298309326
Epoch: 14, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.309 Vali Acc: 0.906 Test Loss: 0.309 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 15 cost time: 0.6030716896057129
Epoch: 15, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.298 Vali Acc: 0.906 Test Loss: 0.298 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 16 cost time: 0.6401340961456299
Epoch: 16, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.294 Vali Acc: 0.913 Test Loss: 0.294 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 17 cost time: 0.6484131813049316
Epoch: 17, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.284 Vali Acc: 0.913 Test Loss: 0.284 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 18 cost time: 0.7088754177093506
Epoch: 18, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.279 Vali Acc: 0.913 Test Loss: 0.279 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 19 cost time: 0.63570237159729
Epoch: 19, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.275 Vali Acc: 0.928 Test Loss: 0.275 Test Acc: 0.928
Validation loss decreased (-0.913041 --> -0.927533).  Saving model ...
Epoch: 20 cost time: 0.6913225650787354
Epoch: 20, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.264 Vali Acc: 0.913 Test Loss: 0.264 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.635934591293335
Epoch: 21, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.258 Vali Acc: 0.920 Test Loss: 0.258 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6556491851806641
Epoch: 22, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.262 Vali Acc: 0.928 Test Loss: 0.262 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927534).  Saving model ...
Epoch: 23 cost time: 0.6182332038879395
Epoch: 23, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.250 Vali Acc: 0.920 Test Loss: 0.250 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5590605735778809
Epoch: 24, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.237 Vali Acc: 0.920 Test Loss: 0.237 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5965559482574463
Epoch: 25, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.226 Vali Acc: 0.920 Test Loss: 0.226 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6635820865631104
Epoch: 26, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.222 Vali Acc: 0.928 Test Loss: 0.222 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 27 cost time: 0.646918535232544
Epoch: 27, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.215 Vali Acc: 0.928 Test Loss: 0.215 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 28 cost time: 0.606675386428833
Epoch: 28, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.223 Vali Acc: 0.920 Test Loss: 0.223 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6102113723754883
Epoch: 29, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.257 Vali Acc: 0.913 Test Loss: 0.257 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6393065452575684
Epoch: 30, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.240 Vali Acc: 0.920 Test Loss: 0.240 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6344747543334961
Epoch: 31, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.231 Vali Acc: 0.928 Test Loss: 0.231 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7236170768737793
Epoch: 32, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.220 Vali Acc: 0.935 Test Loss: 0.220 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 33 cost time: 0.709028959274292
Epoch: 33, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934781).  Saving model ...
Epoch: 34 cost time: 0.6241657733917236
Epoch: 34, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.205 Vali Acc: 0.928 Test Loss: 0.205 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6037290096282959
Epoch: 35, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6531012058258057
Epoch: 36, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.928 Test Loss: 0.203 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6013827323913574
Epoch: 37, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.935 Test Loss: 0.200 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 38 cost time: 0.6229314804077148
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.935 Test Loss: 0.201 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5786192417144775
Epoch: 39, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6519491672515869
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6648335456848145
Epoch: 41, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.206 Vali Acc: 0.928 Test Loss: 0.206 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6599626541137695
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.928 Test Loss: 0.200 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6021738052368164
Epoch: 43, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.7055749893188477
Epoch: 44, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.6839420795440674
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.696558952331543
Epoch: 46, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.928 Test Loss: 0.206 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.6571066379547119
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 434564
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9734792709350586
Epoch: 1, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.305 Vali Acc: 0.391 Test Loss: 1.305 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 0.6952924728393555
Epoch: 2, Steps: 9 | Train Loss: 1.239 Vali Loss: 1.193 Vali Acc: 0.500 Test Loss: 1.193 Test Acc: 0.500
Validation loss decreased (-0.391291 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 0.6435537338256836
Epoch: 3, Steps: 9 | Train Loss: 1.085 Vali Loss: 1.050 Vali Acc: 0.572 Test Loss: 1.050 Test Acc: 0.572
Validation loss decreased (-0.499988 --> -0.572453).  Saving model ...
Epoch: 4 cost time: 0.6196086406707764
Epoch: 4, Steps: 9 | Train Loss: 0.912 Vali Loss: 0.916 Vali Acc: 0.659 Test Loss: 0.916 Test Acc: 0.659
Validation loss decreased (-0.572453 --> -0.659411).  Saving model ...
Epoch: 5 cost time: 0.5914602279663086
Epoch: 5, Steps: 9 | Train Loss: 0.771 Vali Loss: 0.791 Vali Acc: 0.768 Test Loss: 0.791 Test Acc: 0.768
Validation loss decreased (-0.659411 --> -0.768108).  Saving model ...
Epoch: 6 cost time: 0.7442684173583984
Epoch: 6, Steps: 9 | Train Loss: 0.603 Vali Loss: 0.696 Vali Acc: 0.804 Test Loss: 0.696 Test Acc: 0.804
Validation loss decreased (-0.768108 --> -0.804341).  Saving model ...
Epoch: 7 cost time: 0.6683053970336914
Epoch: 7, Steps: 9 | Train Loss: 0.494 Vali Loss: 0.609 Vali Acc: 0.841 Test Loss: 0.609 Test Acc: 0.841
Validation loss decreased (-0.804341 --> -0.840574).  Saving model ...
Epoch: 8 cost time: 0.7248873710632324
Epoch: 8, Steps: 9 | Train Loss: 0.395 Vali Loss: 0.536 Vali Acc: 0.877 Test Loss: 0.536 Test Acc: 0.877
Validation loss decreased (-0.840574 --> -0.876806).  Saving model ...
Epoch: 9 cost time: 0.7763657569885254
Epoch: 9, Steps: 9 | Train Loss: 0.321 Vali Loss: 0.474 Vali Acc: 0.877 Test Loss: 0.474 Test Acc: 0.877
Validation loss decreased (-0.876806 --> -0.876807).  Saving model ...
Epoch: 10 cost time: 0.7803435325622559
Epoch: 10, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.433 Vali Acc: 0.891 Test Loss: 0.433 Test Acc: 0.891
Validation loss decreased (-0.876807 --> -0.891300).  Saving model ...
Epoch: 11 cost time: 0.6332817077636719
Epoch: 11, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.414 Vali Acc: 0.891 Test Loss: 0.414 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 12 cost time: 0.6465179920196533
Epoch: 12, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.378 Vali Acc: 0.891 Test Loss: 0.378 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891301).  Saving model ...
Epoch: 13 cost time: 0.7378394603729248
Epoch: 13, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.365 Vali Acc: 0.899 Test Loss: 0.365 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 14 cost time: 0.7396037578582764
Epoch: 14, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.343 Vali Acc: 0.899 Test Loss: 0.343 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 15 cost time: 0.6977255344390869
Epoch: 15, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.328 Vali Acc: 0.906 Test Loss: 0.328 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 16 cost time: 0.5425565242767334
Epoch: 16, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.320 Vali Acc: 0.913 Test Loss: 0.320 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 17 cost time: 0.6900851726531982
Epoch: 17, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.306 Vali Acc: 0.899 Test Loss: 0.306 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.714266300201416
Epoch: 18, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.302 Vali Acc: 0.906 Test Loss: 0.302 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6328458786010742
Epoch: 19, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.292 Vali Acc: 0.906 Test Loss: 0.292 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6462323665618896
Epoch: 20, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.278 Vali Acc: 0.913 Test Loss: 0.278 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913041).  Saving model ...
Epoch: 21 cost time: 0.6402237415313721
Epoch: 21, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.270 Vali Acc: 0.928 Test Loss: 0.270 Test Acc: 0.928
Validation loss decreased (-0.913041 --> -0.927534).  Saving model ...
Epoch: 22 cost time: 0.746030330657959
Epoch: 22, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.262 Vali Acc: 0.920 Test Loss: 0.262 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.742537260055542
Epoch: 23, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.274 Vali Acc: 0.913 Test Loss: 0.274 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7252991199493408
Epoch: 24, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.258 Vali Acc: 0.920 Test Loss: 0.258 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.721066951751709
Epoch: 25, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.258 Vali Acc: 0.920 Test Loss: 0.258 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6839182376861572
Epoch: 26, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.248 Vali Acc: 0.920 Test Loss: 0.248 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7701315879821777
Epoch: 27, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.240 Vali Acc: 0.920 Test Loss: 0.240 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7660419940948486
Epoch: 28, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.234 Vali Acc: 0.928 Test Loss: 0.234 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 29 cost time: 0.7953650951385498
Epoch: 29, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.237 Vali Acc: 0.935 Test Loss: 0.237 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 30 cost time: 0.8633651733398438
Epoch: 30, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.235 Vali Acc: 0.920 Test Loss: 0.235 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7790563106536865
Epoch: 31, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.227 Vali Acc: 0.920 Test Loss: 0.227 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7703292369842529
Epoch: 32, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.228 Vali Acc: 0.913 Test Loss: 0.228 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.808936595916748
Epoch: 33, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.232 Vali Acc: 0.920 Test Loss: 0.232 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7589225769042969
Epoch: 34, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.221 Vali Acc: 0.928 Test Loss: 0.221 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7002356052398682
Epoch: 35, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.221 Vali Acc: 0.928 Test Loss: 0.221 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7740728855133057
Epoch: 36, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.216 Vali Acc: 0.928 Test Loss: 0.216 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7870638370513916
Epoch: 37, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7431771755218506
Epoch: 38, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.243 Vali Acc: 0.906 Test Loss: 0.243 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7309079170227051
Epoch: 39, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.236 Vali Acc: 0.920 Test Loss: 0.236 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 432772
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9083521366119385
Epoch: 1, Steps: 9 | Train Loss: 1.218 Vali Loss: 1.195 Vali Acc: 0.493 Test Loss: 1.195 Test Acc: 0.493
Validation loss decreased (inf --> -0.492742).  Saving model ...
Epoch: 2 cost time: 0.6667289733886719
Epoch: 2, Steps: 9 | Train Loss: 0.895 Vali Loss: 0.874 Vali Acc: 0.638 Test Loss: 0.874 Test Acc: 0.638
Validation loss decreased (-0.492742 --> -0.637672).  Saving model ...
Epoch: 3 cost time: 0.6715545654296875
Epoch: 3, Steps: 9 | Train Loss: 0.534 Vali Loss: 0.600 Vali Acc: 0.804 Test Loss: 0.600 Test Acc: 0.804
Validation loss decreased (-0.637672 --> -0.804342).  Saving model ...
Epoch: 4 cost time: 0.6754400730133057
Epoch: 4, Steps: 9 | Train Loss: 0.297 Vali Loss: 0.401 Vali Acc: 0.899 Test Loss: 0.401 Test Acc: 0.899
Validation loss decreased (-0.804342 --> -0.898547).  Saving model ...
Epoch: 5 cost time: 0.5841159820556641
Epoch: 5, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.304 Vali Acc: 0.906 Test Loss: 0.304 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 6 cost time: 0.6269974708557129
Epoch: 6, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.249 Vali Acc: 0.928 Test Loss: 0.249 Test Acc: 0.928
Validation loss decreased (-0.905794 --> -0.927534).  Saving model ...
Epoch: 7 cost time: 0.6722886562347412
Epoch: 7, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.215 Vali Acc: 0.942 Test Loss: 0.215 Test Acc: 0.942
Validation loss decreased (-0.927534 --> -0.942027).  Saving model ...
Epoch: 8 cost time: 0.6475522518157959
Epoch: 8, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.211 Vali Acc: 0.942 Test Loss: 0.211 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 9 cost time: 0.6565907001495361
Epoch: 9, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7142841815948486
Epoch: 10, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.216 Vali Acc: 0.935 Test Loss: 0.216 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6403813362121582
Epoch: 11, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.216 Vali Acc: 0.935 Test Loss: 0.216 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6670956611633301
Epoch: 12, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.200 Vali Acc: 0.942 Test Loss: 0.200 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 13 cost time: 0.6415727138519287
Epoch: 13, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.194 Vali Acc: 0.942 Test Loss: 0.194 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 14 cost time: 0.7164516448974609
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.196 Vali Acc: 0.935 Test Loss: 0.196 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7084779739379883
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.192 Vali Acc: 0.935 Test Loss: 0.192 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6734616756439209
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.179 Vali Acc: 0.942 Test Loss: 0.179 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 17 cost time: 0.7035281658172607
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.184 Vali Acc: 0.942 Test Loss: 0.184 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6915457248687744
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6068763732910156
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.197 Vali Acc: 0.928 Test Loss: 0.197 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6445574760437012
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6520576477050781
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7154233455657959
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.935 Test Loss: 0.185 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6587481498718262
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.928 Test Loss: 0.189 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.708662748336792
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.928 Test Loss: 0.191 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.654961347579956
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.928 Test Loss: 0.194 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6905269622802734
Epoch: 26, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 161988
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9551594257354736
Epoch: 1, Steps: 9 | Train Loss: 1.413 Vali Loss: 1.328 Vali Acc: 0.326 Test Loss: 1.328 Test Acc: 0.326
Validation loss decreased (inf --> -0.326074).  Saving model ...
Epoch: 2 cost time: 0.7075695991516113
Epoch: 2, Steps: 9 | Train Loss: 1.175 Vali Loss: 1.098 Vali Acc: 0.536 Test Loss: 1.098 Test Acc: 0.536
Validation loss decreased (-0.326074 --> -0.536221).  Saving model ...
Epoch: 3 cost time: 0.5333282947540283
Epoch: 3, Steps: 9 | Train Loss: 0.891 Vali Loss: 0.858 Vali Acc: 0.703 Test Loss: 0.858 Test Acc: 0.703
Validation loss decreased (-0.536221 --> -0.702890).  Saving model ...
Epoch: 4 cost time: 0.6482996940612793
Epoch: 4, Steps: 9 | Train Loss: 0.634 Vali Loss: 0.645 Vali Acc: 0.848 Test Loss: 0.645 Test Acc: 0.848
Validation loss decreased (-0.702890 --> -0.847820).  Saving model ...
Epoch: 5 cost time: 0.5702295303344727
Epoch: 5, Steps: 9 | Train Loss: 0.413 Vali Loss: 0.484 Vali Acc: 0.928 Test Loss: 0.484 Test Acc: 0.928
Validation loss decreased (-0.847820 --> -0.927531).  Saving model ...
Epoch: 6 cost time: 0.6380753517150879
Epoch: 6, Steps: 9 | Train Loss: 0.280 Vali Loss: 0.398 Vali Acc: 0.920 Test Loss: 0.398 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6403169631958008
Epoch: 7, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.322 Vali Acc: 0.935 Test Loss: 0.322 Test Acc: 0.935
Validation loss decreased (-0.927531 --> -0.934779).  Saving model ...
Epoch: 8 cost time: 0.5113880634307861
Epoch: 8, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.287 Vali Acc: 0.949 Test Loss: 0.287 Test Acc: 0.949
Validation loss decreased (-0.934779 --> -0.949272).  Saving model ...
Epoch: 9 cost time: 0.5888264179229736
Epoch: 9, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.256 Vali Acc: 0.942 Test Loss: 0.256 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5939440727233887
Epoch: 10, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.230 Vali Acc: 0.942 Test Loss: 0.230 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5854113101959229
Epoch: 11, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.222 Vali Acc: 0.949 Test Loss: 0.222 Test Acc: 0.949
Validation loss decreased (-0.949272 --> -0.949273).  Saving model ...
Epoch: 12 cost time: 0.6220483779907227
Epoch: 12, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.220 Vali Acc: 0.949 Test Loss: 0.220 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 13 cost time: 0.725203275680542
Epoch: 13, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.214 Vali Acc: 0.949 Test Loss: 0.214 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 14 cost time: 0.6211042404174805
Epoch: 14, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.203 Vali Acc: 0.949 Test Loss: 0.203 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 15 cost time: 0.6964390277862549
Epoch: 15, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.197 Vali Acc: 0.949 Test Loss: 0.197 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 16 cost time: 0.6545760631561279
Epoch: 16, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.194 Vali Acc: 0.949 Test Loss: 0.194 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 17 cost time: 0.6627423763275146
Epoch: 17, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 18 cost time: 0.599001407623291
Epoch: 18, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.181 Vali Acc: 0.949 Test Loss: 0.181 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949274).  Saving model ...
Epoch: 19 cost time: 0.6431987285614014
Epoch: 19, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 20 cost time: 0.6328856945037842
Epoch: 20, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.181 Vali Acc: 0.949 Test Loss: 0.181 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7148983478546143
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 22 cost time: 0.608626127243042
Epoch: 22, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6301741600036621
Epoch: 23, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6427583694458008
Epoch: 24, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6341168880462646
Epoch: 25, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6276702880859375
Epoch: 26, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6737117767333984
Epoch: 27, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6197617053985596
Epoch: 28, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.584763765335083
Epoch: 29, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6534903049468994
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.949 Test Loss: 0.184 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6236543655395508
Epoch: 31, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.185 Vali Acc: 0.949 Test Loss: 0.185 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 136196
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1860339641571045
Epoch: 1, Steps: 9 | Train Loss: 1.451 Vali Loss: 1.393 Vali Acc: 0.261 Test Loss: 1.393 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 0.6038501262664795
Epoch: 2, Steps: 9 | Train Loss: 1.268 Vali Loss: 1.238 Vali Acc: 0.471 Test Loss: 1.238 Test Acc: 0.471
Validation loss decreased (-0.260856 --> -0.471002).  Saving model ...
Epoch: 3 cost time: 0.6050863265991211
Epoch: 3, Steps: 9 | Train Loss: 1.036 Vali Loss: 1.053 Vali Acc: 0.587 Test Loss: 1.053 Test Acc: 0.587
Validation loss decreased (-0.471002 --> -0.586946).  Saving model ...
Epoch: 4 cost time: 0.588407039642334
Epoch: 4, Steps: 9 | Train Loss: 0.815 Vali Loss: 0.869 Vali Acc: 0.703 Test Loss: 0.869 Test Acc: 0.703
Validation loss decreased (-0.586946 --> -0.702890).  Saving model ...
Epoch: 5 cost time: 0.5502564907073975
Epoch: 5, Steps: 9 | Train Loss: 0.618 Vali Loss: 0.706 Vali Acc: 0.833 Test Loss: 0.706 Test Acc: 0.833
Validation loss decreased (-0.702890 --> -0.833326).  Saving model ...
Epoch: 6 cost time: 0.5209856033325195
Epoch: 6, Steps: 9 | Train Loss: 0.442 Vali Loss: 0.587 Vali Acc: 0.862 Test Loss: 0.587 Test Acc: 0.862
Validation loss decreased (-0.833326 --> -0.862313).  Saving model ...
Epoch: 7 cost time: 0.6511926651000977
Epoch: 7, Steps: 9 | Train Loss: 0.328 Vali Loss: 0.483 Vali Acc: 0.891 Test Loss: 0.483 Test Acc: 0.891
Validation loss decreased (-0.862313 --> -0.891300).  Saving model ...
Epoch: 8 cost time: 0.6843516826629639
Epoch: 8, Steps: 9 | Train Loss: 0.228 Vali Loss: 0.416 Vali Acc: 0.906 Test Loss: 0.416 Test Acc: 0.906
Validation loss decreased (-0.891300 --> -0.905793).  Saving model ...
Epoch: 9 cost time: 0.6049509048461914
Epoch: 9, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.369 Vali Acc: 0.913 Test Loss: 0.369 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913040).  Saving model ...
Epoch: 10 cost time: 0.6686205863952637
Epoch: 10, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.329 Vali Acc: 0.928 Test Loss: 0.329 Test Acc: 0.928
Validation loss decreased (-0.913040 --> -0.927533).  Saving model ...
Epoch: 11 cost time: 0.5848562717437744
Epoch: 11, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.306 Vali Acc: 0.928 Test Loss: 0.306 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 12 cost time: 0.6384484767913818
Epoch: 12, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.292 Vali Acc: 0.928 Test Loss: 0.292 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 13 cost time: 0.6285474300384521
Epoch: 13, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.276 Vali Acc: 0.928 Test Loss: 0.276 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 14 cost time: 0.6917719841003418
Epoch: 14, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.268 Vali Acc: 0.935 Test Loss: 0.268 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934780).  Saving model ...
Epoch: 15 cost time: 0.6351602077484131
Epoch: 15, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.271 Vali Acc: 0.935 Test Loss: 0.271 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5690538883209229
Epoch: 16, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.263 Vali Acc: 0.928 Test Loss: 0.263 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.586780309677124
Epoch: 17, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.254 Vali Acc: 0.935 Test Loss: 0.254 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 18 cost time: 0.6179783344268799
Epoch: 18, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.240 Vali Acc: 0.935 Test Loss: 0.240 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 19 cost time: 0.6172647476196289
Epoch: 19, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.242 Vali Acc: 0.935 Test Loss: 0.242 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5709226131439209
Epoch: 20, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.243 Vali Acc: 0.935 Test Loss: 0.243 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.579272985458374
Epoch: 21, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5761516094207764
Epoch: 22, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.228 Vali Acc: 0.928 Test Loss: 0.228 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5887861251831055
Epoch: 23, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.227 Vali Acc: 0.935 Test Loss: 0.227 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 24 cost time: 0.6862897872924805
Epoch: 24, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.217 Vali Acc: 0.942 Test Loss: 0.217 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 25 cost time: 0.5890636444091797
Epoch: 25, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.228 Vali Acc: 0.935 Test Loss: 0.228 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6773817539215088
Epoch: 26, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.226 Vali Acc: 0.935 Test Loss: 0.226 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5605056285858154
Epoch: 27, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.225 Vali Acc: 0.935 Test Loss: 0.225 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5838327407836914
Epoch: 28, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.630805492401123
Epoch: 29, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.241 Vali Acc: 0.920 Test Loss: 0.241 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6301391124725342
Epoch: 30, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.216 Vali Acc: 0.935 Test Loss: 0.216 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5920047760009766
Epoch: 31, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.204 Vali Acc: 0.935 Test Loss: 0.204 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5994293689727783
Epoch: 32, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.935 Test Loss: 0.204 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6011660099029541
Epoch: 33, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.200 Vali Acc: 0.935 Test Loss: 0.200 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5347394943237305
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.200 Vali Acc: 0.942 Test Loss: 0.200 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 35 cost time: 0.53627610206604
Epoch: 35, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.942 Test Loss: 0.205 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5773508548736572
Epoch: 36, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.942 Test Loss: 0.206 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5685107707977295
Epoch: 37, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.942 Test Loss: 0.209 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.593350887298584
Epoch: 38, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5854847431182861
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7192249298095703
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5935771465301514
Epoch: 41, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.5800678730010986
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.935 Test Loss: 0.198 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5913703441619873
Epoch: 43, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.935 Test Loss: 0.201 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.5802359580993652
Epoch: 44, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 129604
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.860642433166504
Epoch: 1, Steps: 9 | Train Loss: 1.490 Vali Loss: 1.395 Vali Acc: 0.239 Test Loss: 1.395 Test Acc: 0.239
Validation loss decreased (inf --> -0.239116).  Saving model ...
Epoch: 2 cost time: 0.6366183757781982
Epoch: 2, Steps: 9 | Train Loss: 1.337 Vali Loss: 1.267 Vali Acc: 0.435 Test Loss: 1.267 Test Acc: 0.435
Validation loss decreased (-0.239116 --> -0.434770).  Saving model ...
Epoch: 3 cost time: 0.5749757289886475
Epoch: 3, Steps: 9 | Train Loss: 1.141 Vali Loss: 1.104 Vali Acc: 0.500 Test Loss: 1.104 Test Acc: 0.500
Validation loss decreased (-0.434770 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 0.6277740001678467
Epoch: 4, Steps: 9 | Train Loss: 0.940 Vali Loss: 0.955 Vali Acc: 0.652 Test Loss: 0.955 Test Acc: 0.652
Validation loss decreased (-0.499989 --> -0.652164).  Saving model ...
Epoch: 5 cost time: 0.622826337814331
Epoch: 5, Steps: 9 | Train Loss: 0.774 Vali Loss: 0.805 Vali Acc: 0.768 Test Loss: 0.805 Test Acc: 0.768
Validation loss decreased (-0.652164 --> -0.768108).  Saving model ...
Epoch: 6 cost time: 0.6121633052825928
Epoch: 6, Steps: 9 | Train Loss: 0.607 Vali Loss: 0.672 Vali Acc: 0.819 Test Loss: 0.672 Test Acc: 0.819
Validation loss decreased (-0.768108 --> -0.818834).  Saving model ...
Epoch: 7 cost time: 0.6650323867797852
Epoch: 7, Steps: 9 | Train Loss: 0.455 Vali Loss: 0.575 Vali Acc: 0.877 Test Loss: 0.575 Test Acc: 0.877
Validation loss decreased (-0.818834 --> -0.876806).  Saving model ...
Epoch: 8 cost time: 0.6039633750915527
Epoch: 8, Steps: 9 | Train Loss: 0.346 Vali Loss: 0.481 Vali Acc: 0.906 Test Loss: 0.481 Test Acc: 0.906
Validation loss decreased (-0.876806 --> -0.905792).  Saving model ...
Epoch: 9 cost time: 0.6460325717926025
Epoch: 9, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.414 Vali Acc: 0.906 Test Loss: 0.414 Test Acc: 0.906
Validation loss decreased (-0.905792 --> -0.905793).  Saving model ...
Epoch: 10 cost time: 0.5389039516448975
Epoch: 10, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.367 Vali Acc: 0.906 Test Loss: 0.367 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 11 cost time: 0.5758914947509766
Epoch: 11, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.337 Vali Acc: 0.920 Test Loss: 0.337 Test Acc: 0.920
Validation loss decreased (-0.905793 --> -0.920286).  Saving model ...
Epoch: 12 cost time: 0.5749809741973877
Epoch: 12, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.311 Vali Acc: 0.928 Test Loss: 0.311 Test Acc: 0.928
Validation loss decreased (-0.920286 --> -0.927533).  Saving model ...
Epoch: 13 cost time: 0.5686960220336914
Epoch: 13, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.290 Vali Acc: 0.920 Test Loss: 0.290 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5875139236450195
Epoch: 14, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.286 Vali Acc: 0.928 Test Loss: 0.286 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 15 cost time: 0.5900595188140869
Epoch: 15, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.273 Vali Acc: 0.928 Test Loss: 0.273 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927534).  Saving model ...
Epoch: 16 cost time: 0.5495972633361816
Epoch: 16, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.262 Vali Acc: 0.928 Test Loss: 0.262 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 17 cost time: 0.6134617328643799
Epoch: 17, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.259 Vali Acc: 0.928 Test Loss: 0.259 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 18 cost time: 0.6325709819793701
Epoch: 18, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.244 Vali Acc: 0.928 Test Loss: 0.244 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 19 cost time: 0.6210174560546875
Epoch: 19, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.237 Vali Acc: 0.935 Test Loss: 0.237 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 20 cost time: 0.6655745506286621
Epoch: 20, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.222 Vali Acc: 0.935 Test Loss: 0.222 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 21 cost time: 0.6044328212738037
Epoch: 21, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.219 Vali Acc: 0.928 Test Loss: 0.219 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6393561363220215
Epoch: 22, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.219 Vali Acc: 0.935 Test Loss: 0.219 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 23 cost time: 0.6382074356079102
Epoch: 23, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.225 Vali Acc: 0.935 Test Loss: 0.225 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6039745807647705
Epoch: 24, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 25 cost time: 0.577843427658081
Epoch: 25, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934781).  Saving model ...
Epoch: 26 cost time: 0.5889744758605957
Epoch: 26, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6252548694610596
Epoch: 27, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.199 Vali Acc: 0.935 Test Loss: 0.199 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 28 cost time: 0.6133084297180176
Epoch: 28, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5637643337249756
Epoch: 29, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5973703861236572
Epoch: 30, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.199 Vali Acc: 0.928 Test Loss: 0.199 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5646681785583496
Epoch: 31, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.205 Vali Acc: 0.928 Test Loss: 0.205 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6876623630523682
Epoch: 32, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.194 Vali Acc: 0.928 Test Loss: 0.194 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5902528762817383
Epoch: 33, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.193 Vali Acc: 0.928 Test Loss: 0.193 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6250393390655518
Epoch: 34, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.191 Vali Acc: 0.928 Test Loss: 0.191 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6406843662261963
Epoch: 35, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.189 Vali Acc: 0.928 Test Loss: 0.189 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.5888340473175049
Epoch: 36, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.195 Vali Acc: 0.928 Test Loss: 0.195 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.5921814441680908
Epoch: 37, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.196 Vali Acc: 0.928 Test Loss: 0.196 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 124548
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9978985786437988
Epoch: 1, Steps: 9 | Train Loss: 1.374 Vali Loss: 1.287 Vali Acc: 0.399 Test Loss: 1.287 Test Acc: 0.399
Validation loss decreased (inf --> -0.398538).  Saving model ...
Epoch: 2 cost time: 0.5662097930908203
Epoch: 2, Steps: 9 | Train Loss: 1.284 Vali Loss: 1.198 Vali Acc: 0.486 Test Loss: 1.198 Test Acc: 0.486
Validation loss decreased (-0.398538 --> -0.485495).  Saving model ...
Epoch: 3 cost time: 0.5824706554412842
Epoch: 3, Steps: 9 | Train Loss: 1.149 Vali Loss: 1.087 Vali Acc: 0.478 Test Loss: 1.087 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6605808734893799
Epoch: 4, Steps: 9 | Train Loss: 1.009 Vali Loss: 0.972 Vali Acc: 0.580 Test Loss: 0.972 Test Acc: 0.580
Validation loss decreased (-0.485495 --> -0.579700).  Saving model ...
Epoch: 5 cost time: 0.5641002655029297
Epoch: 5, Steps: 9 | Train Loss: 0.861 Vali Loss: 0.862 Vali Acc: 0.717 Test Loss: 0.862 Test Acc: 0.717
Validation loss decreased (-0.579700 --> -0.717383).  Saving model ...
Epoch: 6 cost time: 0.5381667613983154
Epoch: 6, Steps: 9 | Train Loss: 0.727 Vali Loss: 0.753 Vali Acc: 0.804 Test Loss: 0.753 Test Acc: 0.804
Validation loss decreased (-0.717383 --> -0.804340).  Saving model ...
Epoch: 7 cost time: 0.5712039470672607
Epoch: 7, Steps: 9 | Train Loss: 0.610 Vali Loss: 0.665 Vali Acc: 0.862 Test Loss: 0.665 Test Acc: 0.862
Validation loss decreased (-0.804340 --> -0.862312).  Saving model ...
Epoch: 8 cost time: 0.5360326766967773
Epoch: 8, Steps: 9 | Train Loss: 0.486 Vali Loss: 0.581 Vali Acc: 0.884 Test Loss: 0.581 Test Acc: 0.884
Validation loss decreased (-0.862312 --> -0.884052).  Saving model ...
Epoch: 9 cost time: 0.5535051822662354
Epoch: 9, Steps: 9 | Train Loss: 0.411 Vali Loss: 0.515 Vali Acc: 0.891 Test Loss: 0.515 Test Acc: 0.891
Validation loss decreased (-0.884052 --> -0.891299).  Saving model ...
Epoch: 10 cost time: 0.5362789630889893
Epoch: 10, Steps: 9 | Train Loss: 0.328 Vali Loss: 0.452 Vali Acc: 0.891 Test Loss: 0.452 Test Acc: 0.891
Validation loss decreased (-0.891299 --> -0.891300).  Saving model ...
Epoch: 11 cost time: 0.6257126331329346
Epoch: 11, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.422 Vali Acc: 0.899 Test Loss: 0.422 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 12 cost time: 0.5940077304840088
Epoch: 12, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.383 Vali Acc: 0.913 Test Loss: 0.383 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913040).  Saving model ...
Epoch: 13 cost time: 0.5894358158111572
Epoch: 13, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.360 Vali Acc: 0.913 Test Loss: 0.360 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 14 cost time: 0.5794525146484375
Epoch: 14, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.340 Vali Acc: 0.928 Test Loss: 0.340 Test Acc: 0.928
Validation loss decreased (-0.913040 --> -0.927533).  Saving model ...
Epoch: 15 cost time: 0.6295206546783447
Epoch: 15, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.320 Vali Acc: 0.928 Test Loss: 0.320 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 16 cost time: 0.5894010066986084
Epoch: 16, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.309 Vali Acc: 0.920 Test Loss: 0.309 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5591259002685547
Epoch: 17, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.299 Vali Acc: 0.928 Test Loss: 0.299 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 18 cost time: 0.5970568656921387
Epoch: 18, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.284 Vali Acc: 0.928 Test Loss: 0.284 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 19 cost time: 0.5798039436340332
Epoch: 19, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.270 Vali Acc: 0.928 Test Loss: 0.270 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927534).  Saving model ...
Epoch: 20 cost time: 0.5999219417572021
Epoch: 20, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.266 Vali Acc: 0.942 Test Loss: 0.266 Test Acc: 0.942
Validation loss decreased (-0.927534 --> -0.942026).  Saving model ...
Epoch: 21 cost time: 0.5474905967712402
Epoch: 21, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.260 Vali Acc: 0.949 Test Loss: 0.260 Test Acc: 0.949
Validation loss decreased (-0.942026 --> -0.949273).  Saving model ...
Epoch: 22 cost time: 0.6149780750274658
Epoch: 22, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.244 Vali Acc: 0.935 Test Loss: 0.244 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6329600811004639
Epoch: 23, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.244 Vali Acc: 0.935 Test Loss: 0.244 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.604194164276123
Epoch: 24, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.242 Vali Acc: 0.935 Test Loss: 0.242 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.597783088684082
Epoch: 25, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.236 Vali Acc: 0.942 Test Loss: 0.236 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5958776473999023
Epoch: 26, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.243 Vali Acc: 0.935 Test Loss: 0.243 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5961494445800781
Epoch: 27, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.240 Vali Acc: 0.935 Test Loss: 0.240 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5868110656738281
Epoch: 28, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.236 Vali Acc: 0.935 Test Loss: 0.236 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5743529796600342
Epoch: 29, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5666933059692383
Epoch: 30, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.207 Vali Acc: 0.942 Test Loss: 0.207 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6040797233581543
Epoch: 31, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.194 Vali Acc: 0.942 Test Loss: 0.194 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 120580
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0738258361816406
Epoch: 1, Steps: 9 | Train Loss: 1.357 Vali Loss: 1.330 Vali Acc: 0.384 Test Loss: 1.330 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 0.5769026279449463
Epoch: 2, Steps: 9 | Train Loss: 1.273 Vali Loss: 1.256 Vali Acc: 0.478 Test Loss: 1.256 Test Acc: 0.478
Validation loss decreased (-0.384045 --> -0.478248).  Saving model ...
Epoch: 3 cost time: 0.6240816116333008
Epoch: 3, Steps: 9 | Train Loss: 1.179 Vali Loss: 1.156 Vali Acc: 0.551 Test Loss: 1.156 Test Acc: 0.551
Validation loss decreased (-0.478248 --> -0.550713).  Saving model ...
Epoch: 4 cost time: 0.6005537509918213
Epoch: 4, Steps: 9 | Train Loss: 1.030 Vali Loss: 1.044 Vali Acc: 0.652 Test Loss: 1.044 Test Acc: 0.652
Validation loss decreased (-0.550713 --> -0.652163).  Saving model ...
Epoch: 5 cost time: 0.5887291431427002
Epoch: 5, Steps: 9 | Train Loss: 0.916 Vali Loss: 0.938 Vali Acc: 0.696 Test Loss: 0.938 Test Acc: 0.696
Validation loss decreased (-0.652163 --> -0.695643).  Saving model ...
Epoch: 6 cost time: 0.5884513854980469
Epoch: 6, Steps: 9 | Train Loss: 0.806 Vali Loss: 0.838 Vali Acc: 0.775 Test Loss: 0.838 Test Acc: 0.775
Validation loss decreased (-0.695643 --> -0.775354).  Saving model ...
Epoch: 7 cost time: 0.6126859188079834
Epoch: 7, Steps: 9 | Train Loss: 0.678 Vali Loss: 0.751 Vali Acc: 0.819 Test Loss: 0.751 Test Acc: 0.819
Validation loss decreased (-0.775354 --> -0.818833).  Saving model ...
Epoch: 8 cost time: 0.5674326419830322
Epoch: 8, Steps: 9 | Train Loss: 0.598 Vali Loss: 0.670 Vali Acc: 0.862 Test Loss: 0.670 Test Acc: 0.862
Validation loss decreased (-0.818833 --> -0.862312).  Saving model ...
Epoch: 9 cost time: 0.5423624515533447
Epoch: 9, Steps: 9 | Train Loss: 0.479 Vali Loss: 0.608 Vali Acc: 0.891 Test Loss: 0.608 Test Acc: 0.891
Validation loss decreased (-0.862312 --> -0.891298).  Saving model ...
Epoch: 10 cost time: 0.6717329025268555
Epoch: 10, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.547 Vali Acc: 0.891 Test Loss: 0.547 Test Acc: 0.891
Validation loss decreased (-0.891298 --> -0.891299).  Saving model ...
Epoch: 11 cost time: 0.6159927845001221
Epoch: 11, Steps: 9 | Train Loss: 0.372 Vali Loss: 0.497 Vali Acc: 0.899 Test Loss: 0.497 Test Acc: 0.899
Validation loss decreased (-0.891299 --> -0.898546).  Saving model ...
Epoch: 12 cost time: 0.60262131690979
Epoch: 12, Steps: 9 | Train Loss: 0.310 Vali Loss: 0.465 Vali Acc: 0.913 Test Loss: 0.465 Test Acc: 0.913
Validation loss decreased (-0.898546 --> -0.913039).  Saving model ...
Epoch: 13 cost time: 0.5689375400543213
Epoch: 13, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.433 Vali Acc: 0.913 Test Loss: 0.433 Test Acc: 0.913
Validation loss decreased (-0.913039 --> -0.913039).  Saving model ...
Epoch: 14 cost time: 0.5839669704437256
Epoch: 14, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.411 Vali Acc: 0.913 Test Loss: 0.411 Test Acc: 0.913
Validation loss decreased (-0.913039 --> -0.913039).  Saving model ...
Epoch: 15 cost time: 0.5586624145507812
Epoch: 15, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.390 Vali Acc: 0.913 Test Loss: 0.390 Test Acc: 0.913
Validation loss decreased (-0.913039 --> -0.913040).  Saving model ...
Epoch: 16 cost time: 0.588341474533081
Epoch: 16, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.369 Vali Acc: 0.913 Test Loss: 0.369 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 17 cost time: 0.6775872707366943
Epoch: 17, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.341 Vali Acc: 0.920 Test Loss: 0.341 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920286).  Saving model ...
Epoch: 18 cost time: 0.612938404083252
Epoch: 18, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.330 Vali Acc: 0.920 Test Loss: 0.330 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920287).  Saving model ...
Epoch: 19 cost time: 0.6017792224884033
Epoch: 19, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.325 Vali Acc: 0.920 Test Loss: 0.325 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 20 cost time: 0.6010932922363281
Epoch: 20, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.317 Vali Acc: 0.920 Test Loss: 0.317 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 21 cost time: 0.5909214019775391
Epoch: 21, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.284 Vali Acc: 0.928 Test Loss: 0.284 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927533).  Saving model ...
Epoch: 22 cost time: 0.582554817199707
Epoch: 22, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.283 Vali Acc: 0.928 Test Loss: 0.283 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 23 cost time: 0.6308190822601318
Epoch: 23, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.277 Vali Acc: 0.928 Test Loss: 0.277 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 24 cost time: 0.592836856842041
Epoch: 24, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.282 Vali Acc: 0.920 Test Loss: 0.282 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6532332897186279
Epoch: 25, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.274 Vali Acc: 0.935 Test Loss: 0.274 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934780).  Saving model ...
Epoch: 26 cost time: 0.5663871765136719
Epoch: 26, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.254 Vali Acc: 0.928 Test Loss: 0.254 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5988752841949463
Epoch: 27, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.248 Vali Acc: 0.928 Test Loss: 0.248 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5231692790985107
Epoch: 28, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.245 Vali Acc: 0.935 Test Loss: 0.245 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 29 cost time: 0.6005494594573975
Epoch: 29, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.244 Vali Acc: 0.935 Test Loss: 0.244 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 30 cost time: 0.5569944381713867
Epoch: 30, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.248 Vali Acc: 0.935 Test Loss: 0.248 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5936620235443115
Epoch: 31, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.247 Vali Acc: 0.935 Test Loss: 0.247 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5648622512817383
Epoch: 32, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.230 Vali Acc: 0.935 Test Loss: 0.230 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 33 cost time: 0.5809342861175537
Epoch: 33, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.220 Vali Acc: 0.935 Test Loss: 0.220 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 34 cost time: 0.5583453178405762
Epoch: 34, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6234352588653564
Epoch: 35, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5654597282409668
Epoch: 36, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.216 Vali Acc: 0.935 Test Loss: 0.216 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 37 cost time: 0.5901594161987305
Epoch: 37, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.222 Vali Acc: 0.935 Test Loss: 0.222 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6003038883209229
Epoch: 38, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934781).  Saving model ...
Epoch: 39 cost time: 0.5920453071594238
Epoch: 39, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 40 cost time: 0.5693695545196533
Epoch: 40, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5592784881591797
Epoch: 41, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 42 cost time: 0.6020119190216064
Epoch: 42, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 43 cost time: 0.6567850112915039
Epoch: 43, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6023950576782227
Epoch: 44, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6558196544647217
Epoch: 45, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.189 Vali Acc: 0.935 Test Loss: 0.189 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 46 cost time: 0.5999495983123779
Epoch: 46, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.190 Vali Acc: 0.935 Test Loss: 0.190 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5853347778320312
Epoch: 47, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.190 Vali Acc: 0.935 Test Loss: 0.190 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5164837837219238
Epoch: 48, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.199 Vali Acc: 0.935 Test Loss: 0.199 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5732588768005371
Epoch: 49, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.935 Test Loss: 0.204 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.5649349689483643
Epoch: 50, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 118980
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0342822074890137
Epoch: 1, Steps: 9 | Train Loss: 1.326 Vali Loss: 1.320 Vali Acc: 0.420 Test Loss: 1.320 Test Acc: 0.420
Validation loss decreased (inf --> -0.420277).  Saving model ...
Epoch: 2 cost time: 0.6507418155670166
Epoch: 2, Steps: 9 | Train Loss: 1.243 Vali Loss: 1.253 Vali Acc: 0.500 Test Loss: 1.253 Test Acc: 0.500
Validation loss decreased (-0.420277 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 0.6292526721954346
Epoch: 3, Steps: 9 | Train Loss: 1.151 Vali Loss: 1.167 Vali Acc: 0.493 Test Loss: 1.167 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.658740758895874
Epoch: 4, Steps: 9 | Train Loss: 1.080 Vali Loss: 1.076 Vali Acc: 0.522 Test Loss: 1.076 Test Acc: 0.522
Validation loss decreased (-0.499987 --> -0.521728).  Saving model ...
Epoch: 5 cost time: 0.6155211925506592
Epoch: 5, Steps: 9 | Train Loss: 0.961 Vali Loss: 0.988 Vali Acc: 0.536 Test Loss: 0.988 Test Acc: 0.536
Validation loss decreased (-0.521728 --> -0.536222).  Saving model ...
Epoch: 6 cost time: 0.6127982139587402
Epoch: 6, Steps: 9 | Train Loss: 0.867 Vali Loss: 0.909 Vali Acc: 0.616 Test Loss: 0.909 Test Acc: 0.616
Validation loss decreased (-0.536222 --> -0.615933).  Saving model ...
Epoch: 7 cost time: 0.6038177013397217
Epoch: 7, Steps: 9 | Train Loss: 0.748 Vali Loss: 0.828 Vali Acc: 0.703 Test Loss: 0.828 Test Acc: 0.703
Validation loss decreased (-0.615933 --> -0.702890).  Saving model ...
Epoch: 8 cost time: 0.601923942565918
Epoch: 8, Steps: 9 | Train Loss: 0.659 Vali Loss: 0.755 Vali Acc: 0.768 Test Loss: 0.755 Test Acc: 0.768
Validation loss decreased (-0.702890 --> -0.768108).  Saving model ...
Epoch: 9 cost time: 0.600175142288208
Epoch: 9, Steps: 9 | Train Loss: 0.594 Vali Loss: 0.691 Vali Acc: 0.819 Test Loss: 0.691 Test Acc: 0.819
Validation loss decreased (-0.768108 --> -0.818834).  Saving model ...
Epoch: 10 cost time: 0.623990535736084
Epoch: 10, Steps: 9 | Train Loss: 0.537 Vali Loss: 0.636 Vali Acc: 0.833 Test Loss: 0.636 Test Acc: 0.833
Validation loss decreased (-0.818834 --> -0.833327).  Saving model ...
Epoch: 11 cost time: 0.5660128593444824
Epoch: 11, Steps: 9 | Train Loss: 0.463 Vali Loss: 0.593 Vali Acc: 0.862 Test Loss: 0.593 Test Acc: 0.862
Validation loss decreased (-0.833327 --> -0.862313).  Saving model ...
Epoch: 12 cost time: 0.5963680744171143
Epoch: 12, Steps: 9 | Train Loss: 0.381 Vali Loss: 0.548 Vali Acc: 0.870 Test Loss: 0.548 Test Acc: 0.870
Validation loss decreased (-0.862313 --> -0.869560).  Saving model ...
Epoch: 13 cost time: 0.6319952011108398
Epoch: 13, Steps: 9 | Train Loss: 0.340 Vali Loss: 0.510 Vali Acc: 0.877 Test Loss: 0.510 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876806).  Saving model ...
Epoch: 14 cost time: 0.6265580654144287
Epoch: 14, Steps: 9 | Train Loss: 0.322 Vali Loss: 0.484 Vali Acc: 0.884 Test Loss: 0.484 Test Acc: 0.884
Validation loss decreased (-0.876806 --> -0.884053).  Saving model ...
Epoch: 15 cost time: 0.6038315296173096
Epoch: 15, Steps: 9 | Train Loss: 0.262 Vali Loss: 0.460 Vali Acc: 0.891 Test Loss: 0.460 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891300).  Saving model ...
Epoch: 16 cost time: 0.6852638721466064
Epoch: 16, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.438 Vali Acc: 0.891 Test Loss: 0.438 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 17 cost time: 0.6143662929534912
Epoch: 17, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.408 Vali Acc: 0.913 Test Loss: 0.408 Test Acc: 0.913
Validation loss decreased (-0.891300 --> -0.913039).  Saving model ...
Epoch: 18 cost time: 0.6499660015106201
Epoch: 18, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.382 Vali Acc: 0.913 Test Loss: 0.382 Test Acc: 0.913
Validation loss decreased (-0.913039 --> -0.913040).  Saving model ...
Epoch: 19 cost time: 0.6056952476501465
Epoch: 19, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.379 Vali Acc: 0.899 Test Loss: 0.379 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6322605609893799
Epoch: 20, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.376 Vali Acc: 0.899 Test Loss: 0.376 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6622118949890137
Epoch: 21, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.353 Vali Acc: 0.913 Test Loss: 0.353 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 22 cost time: 0.6859424114227295
Epoch: 22, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.339 Vali Acc: 0.906 Test Loss: 0.339 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6985411643981934
Epoch: 23, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.317 Vali Acc: 0.920 Test Loss: 0.317 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 24 cost time: 0.6994664669036865
Epoch: 24, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.326 Vali Acc: 0.913 Test Loss: 0.326 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6609737873077393
Epoch: 25, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.303 Vali Acc: 0.920 Test Loss: 0.303 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 26 cost time: 0.6212735176086426
Epoch: 26, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.301 Vali Acc: 0.920 Test Loss: 0.301 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 27 cost time: 0.6242620944976807
Epoch: 27, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.295 Vali Acc: 0.906 Test Loss: 0.295 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6373810768127441
Epoch: 28, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.292 Vali Acc: 0.913 Test Loss: 0.292 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6691343784332275
Epoch: 29, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.296 Vali Acc: 0.906 Test Loss: 0.296 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.611987829208374
Epoch: 30, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.282 Vali Acc: 0.913 Test Loss: 0.282 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7017843723297119
Epoch: 31, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.268 Vali Acc: 0.920 Test Loss: 0.268 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 32 cost time: 0.6793017387390137
Epoch: 32, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.265 Vali Acc: 0.920 Test Loss: 0.265 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 33 cost time: 0.6240184307098389
Epoch: 33, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.258 Vali Acc: 0.920 Test Loss: 0.258 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 34 cost time: 0.6494293212890625
Epoch: 34, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.251 Vali Acc: 0.920 Test Loss: 0.251 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 35 cost time: 0.6667995452880859
Epoch: 35, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.249 Vali Acc: 0.920 Test Loss: 0.249 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 36 cost time: 0.632427453994751
Epoch: 36, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.245 Vali Acc: 0.928 Test Loss: 0.245 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 37 cost time: 0.5931415557861328
Epoch: 37, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.244 Vali Acc: 0.928 Test Loss: 0.244 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 38 cost time: 0.6985805034637451
Epoch: 38, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.231 Vali Acc: 0.928 Test Loss: 0.231 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 39 cost time: 0.6913819313049316
Epoch: 39, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.252 Vali Acc: 0.935 Test Loss: 0.252 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 40 cost time: 0.6482558250427246
Epoch: 40, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.250 Vali Acc: 0.935 Test Loss: 0.250 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 41 cost time: 0.6340813636779785
Epoch: 41, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.621854305267334
Epoch: 42, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5662620067596436
Epoch: 43, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6906867027282715
Epoch: 44, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.213 Vali Acc: 0.935 Test Loss: 0.213 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 45 cost time: 0.6216366291046143
Epoch: 45, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934781).  Saving model ...
Epoch: 46 cost time: 0.6707963943481445
Epoch: 46, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6012048721313477
Epoch: 47, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.593071699142456
Epoch: 48, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.218 Vali Acc: 0.928 Test Loss: 0.218 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.6146714687347412
Epoch: 49, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.213 Vali Acc: 0.935 Test Loss: 0.213 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.6515729427337646
Epoch: 50, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 118084
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9775028228759766
Epoch: 1, Steps: 9 | Train Loss: 1.528 Vali Loss: 1.399 Vali Acc: 0.254 Test Loss: 1.399 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 0.5760219097137451
Epoch: 2, Steps: 9 | Train Loss: 1.274 Vali Loss: 1.131 Vali Acc: 0.457 Test Loss: 1.131 Test Acc: 0.457
Validation loss decreased (-0.253609 --> -0.456510).  Saving model ...
Epoch: 3 cost time: 0.6060528755187988
Epoch: 3, Steps: 9 | Train Loss: 0.926 Vali Loss: 0.865 Vali Acc: 0.674 Test Loss: 0.865 Test Acc: 0.674
Validation loss decreased (-0.456510 --> -0.673904).  Saving model ...
Epoch: 4 cost time: 0.5747630596160889
Epoch: 4, Steps: 9 | Train Loss: 0.671 Vali Loss: 0.656 Vali Acc: 0.819 Test Loss: 0.656 Test Acc: 0.819
Validation loss decreased (-0.673904 --> -0.818834).  Saving model ...
Epoch: 5 cost time: 0.6020119190216064
Epoch: 5, Steps: 9 | Train Loss: 0.460 Vali Loss: 0.510 Vali Acc: 0.891 Test Loss: 0.510 Test Acc: 0.891
Validation loss decreased (-0.818834 --> -0.891299).  Saving model ...
Epoch: 6 cost time: 0.6184613704681396
Epoch: 6, Steps: 9 | Train Loss: 0.304 Vali Loss: 0.414 Vali Acc: 0.899 Test Loss: 0.414 Test Acc: 0.899
Validation loss decreased (-0.891299 --> -0.898547).  Saving model ...
Epoch: 7 cost time: 0.5168085098266602
Epoch: 7, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.331 Vali Acc: 0.920 Test Loss: 0.331 Test Acc: 0.920
Validation loss decreased (-0.898547 --> -0.920287).  Saving model ...
Epoch: 8 cost time: 0.576214075088501
Epoch: 8, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.290 Vali Acc: 0.935 Test Loss: 0.290 Test Acc: 0.935
Validation loss decreased (-0.920287 --> -0.934780).  Saving model ...
Epoch: 9 cost time: 0.6086399555206299
Epoch: 9, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.259 Vali Acc: 0.928 Test Loss: 0.259 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5695338249206543
Epoch: 10, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.244 Vali Acc: 0.935 Test Loss: 0.244 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 11 cost time: 0.604637622833252
Epoch: 11, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.227 Vali Acc: 0.942 Test Loss: 0.227 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 12 cost time: 0.5552575588226318
Epoch: 12, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.228 Vali Acc: 0.942 Test Loss: 0.228 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5806417465209961
Epoch: 13, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.218 Vali Acc: 0.942 Test Loss: 0.218 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 14 cost time: 0.5160086154937744
Epoch: 14, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.214 Vali Acc: 0.942 Test Loss: 0.214 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 15 cost time: 0.6017823219299316
Epoch: 15, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.207 Vali Acc: 0.942 Test Loss: 0.207 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 16 cost time: 0.578885555267334
Epoch: 16, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.204 Vali Acc: 0.942 Test Loss: 0.204 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 17 cost time: 0.56475830078125
Epoch: 17, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.197 Vali Acc: 0.942 Test Loss: 0.197 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 18 cost time: 0.6519057750701904
Epoch: 18, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.192 Vali Acc: 0.942 Test Loss: 0.192 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 19 cost time: 0.6320607662200928
Epoch: 19, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.192 Vali Acc: 0.942 Test Loss: 0.192 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 20 cost time: 0.6004550457000732
Epoch: 20, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6074564456939697
Epoch: 21, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6120016574859619
Epoch: 22, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.182 Vali Acc: 0.935 Test Loss: 0.182 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6747157573699951
Epoch: 23, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.177 Vali Acc: 0.935 Test Loss: 0.177 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5884997844696045
Epoch: 24, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.177 Vali Acc: 0.935 Test Loss: 0.177 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6077480316162109
Epoch: 25, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.177 Vali Acc: 0.935 Test Loss: 0.177 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5925686359405518
Epoch: 26, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.176 Vali Acc: 0.935 Test Loss: 0.176 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6098692417144775
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.173 Vali Acc: 0.935 Test Loss: 0.173 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5925235748291016
Epoch: 28, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.168 Vali Acc: 0.935 Test Loss: 0.168 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5521955490112305
Epoch: 29, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.175 Vali Acc: 0.942 Test Loss: 0.175 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 30 cost time: 0.6173250675201416
Epoch: 30, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.176 Vali Acc: 0.942 Test Loss: 0.176 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6293931007385254
Epoch: 31, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.942 Test Loss: 0.178 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5921897888183594
Epoch: 32, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.178 Vali Acc: 0.942 Test Loss: 0.178 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6051504611968994
Epoch: 33, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.935 Test Loss: 0.178 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6504557132720947
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.942 Test Loss: 0.169 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 35 cost time: 0.6542539596557617
Epoch: 35, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.935 Test Loss: 0.166 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7038311958312988
Epoch: 36, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.935 Test Loss: 0.169 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6598916053771973
Epoch: 37, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.935 Test Loss: 0.171 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6121642589569092
Epoch: 38, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.935 Test Loss: 0.169 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6444776058197021
Epoch: 39, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.176 Vali Acc: 0.935 Test Loss: 0.176 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6057307720184326
Epoch: 40, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.928 Test Loss: 0.182 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6335265636444092
Epoch: 41, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.928 Test Loss: 0.178 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.6040465831756592
Epoch: 42, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.935 Test Loss: 0.172 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.6537799835205078
Epoch: 43, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.935 Test Loss: 0.166 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.5524630546569824
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.165 Vali Acc: 0.935 Test Loss: 0.165 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 56420
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.7384672164916992
Epoch: 1, Steps: 9 | Train Loss: 1.414 Vali Loss: 1.364 Vali Acc: 0.275 Test Loss: 1.364 Test Acc: 0.275
Validation loss decreased (inf --> -0.275349).  Saving model ...
Epoch: 2 cost time: 0.6377005577087402
Epoch: 2, Steps: 9 | Train Loss: 1.292 Vali Loss: 1.232 Vali Acc: 0.420 Test Loss: 1.232 Test Acc: 0.420
Validation loss decreased (-0.275349 --> -0.420278).  Saving model ...
Epoch: 3 cost time: 0.584212064743042
Epoch: 3, Steps: 9 | Train Loss: 1.111 Vali Loss: 1.075 Vali Acc: 0.551 Test Loss: 1.075 Test Acc: 0.551
Validation loss decreased (-0.420278 --> -0.550714).  Saving model ...
Epoch: 4 cost time: 0.6055595874786377
Epoch: 4, Steps: 9 | Train Loss: 0.939 Vali Loss: 0.921 Vali Acc: 0.667 Test Loss: 0.921 Test Acc: 0.667
Validation loss decreased (-0.550714 --> -0.666657).  Saving model ...
Epoch: 5 cost time: 0.6021411418914795
Epoch: 5, Steps: 9 | Train Loss: 0.781 Vali Loss: 0.781 Vali Acc: 0.754 Test Loss: 0.781 Test Acc: 0.754
Validation loss decreased (-0.666657 --> -0.753615).  Saving model ...
Epoch: 6 cost time: 0.6600320339202881
Epoch: 6, Steps: 9 | Train Loss: 0.594 Vali Loss: 0.677 Vali Acc: 0.826 Test Loss: 0.677 Test Acc: 0.826
Validation loss decreased (-0.753615 --> -0.826080).  Saving model ...
Epoch: 7 cost time: 0.5946567058563232
Epoch: 7, Steps: 9 | Train Loss: 0.503 Vali Loss: 0.554 Vali Acc: 0.862 Test Loss: 0.554 Test Acc: 0.862
Validation loss decreased (-0.826080 --> -0.862313).  Saving model ...
Epoch: 8 cost time: 0.6037423610687256
Epoch: 8, Steps: 9 | Train Loss: 0.368 Vali Loss: 0.484 Vali Acc: 0.891 Test Loss: 0.484 Test Acc: 0.891
Validation loss decreased (-0.862313 --> -0.891300).  Saving model ...
Epoch: 9 cost time: 0.5977029800415039
Epoch: 9, Steps: 9 | Train Loss: 0.289 Vali Loss: 0.424 Vali Acc: 0.906 Test Loss: 0.424 Test Acc: 0.906
Validation loss decreased (-0.891300 --> -0.905793).  Saving model ...
Epoch: 10 cost time: 0.6501240730285645
Epoch: 10, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.390 Vali Acc: 0.928 Test Loss: 0.390 Test Acc: 0.928
Validation loss decreased (-0.905793 --> -0.927532).  Saving model ...
Epoch: 11 cost time: 0.6205627918243408
Epoch: 11, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.352 Vali Acc: 0.935 Test Loss: 0.352 Test Acc: 0.935
Validation loss decreased (-0.927532 --> -0.934779).  Saving model ...
Epoch: 12 cost time: 0.6183013916015625
Epoch: 12, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.331 Vali Acc: 0.928 Test Loss: 0.331 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6089315414428711
Epoch: 13, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.314 Vali Acc: 0.928 Test Loss: 0.314 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5712928771972656
Epoch: 14, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.286 Vali Acc: 0.928 Test Loss: 0.286 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.635317325592041
Epoch: 15, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.272 Vali Acc: 0.935 Test Loss: 0.272 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934780).  Saving model ...
Epoch: 16 cost time: 0.6174371242523193
Epoch: 16, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.265 Vali Acc: 0.928 Test Loss: 0.265 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6078145503997803
Epoch: 17, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.257 Vali Acc: 0.942 Test Loss: 0.257 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942026).  Saving model ...
Epoch: 18 cost time: 0.6423964500427246
Epoch: 18, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.247 Vali Acc: 0.942 Test Loss: 0.247 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 19 cost time: 0.5670857429504395
Epoch: 19, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.252 Vali Acc: 0.942 Test Loss: 0.252 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.554175853729248
Epoch: 20, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.244 Vali Acc: 0.949 Test Loss: 0.244 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949273).  Saving model ...
Epoch: 21 cost time: 0.6741173267364502
Epoch: 21, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.239 Vali Acc: 0.949 Test Loss: 0.239 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 22 cost time: 0.6761524677276611
Epoch: 22, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.230 Vali Acc: 0.949 Test Loss: 0.230 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 23 cost time: 0.542609453201294
Epoch: 23, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.230 Vali Acc: 0.942 Test Loss: 0.230 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5429091453552246
Epoch: 24, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.222 Vali Acc: 0.942 Test Loss: 0.222 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5661213397979736
Epoch: 25, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.221 Vali Acc: 0.942 Test Loss: 0.221 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5929131507873535
Epoch: 26, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.213 Vali Acc: 0.949 Test Loss: 0.213 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 27 cost time: 0.610398530960083
Epoch: 27, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.208 Vali Acc: 0.942 Test Loss: 0.208 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6319475173950195
Epoch: 28, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.207 Vali Acc: 0.949 Test Loss: 0.207 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 29 cost time: 0.6662733554840088
Epoch: 29, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.215 Vali Acc: 0.949 Test Loss: 0.215 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6345880031585693
Epoch: 30, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.216 Vali Acc: 0.935 Test Loss: 0.216 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7151446342468262
Epoch: 31, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6650445461273193
Epoch: 32, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6236882209777832
Epoch: 33, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.214 Vali Acc: 0.949 Test Loss: 0.214 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5842549800872803
Epoch: 34, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.215 Vali Acc: 0.949 Test Loss: 0.215 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.621042013168335
Epoch: 35, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.216 Vali Acc: 0.949 Test Loss: 0.216 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6909112930297852
Epoch: 36, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.202 Vali Acc: 0.949 Test Loss: 0.202 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 37 cost time: 0.5926206111907959
Epoch: 37, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.196 Vali Acc: 0.935 Test Loss: 0.196 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6040563583374023
Epoch: 38, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.199 Vali Acc: 0.942 Test Loss: 0.199 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7258846759796143
Epoch: 39, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.199 Vali Acc: 0.942 Test Loss: 0.199 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6095354557037354
Epoch: 40, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.199 Vali Acc: 0.949 Test Loss: 0.199 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 41 cost time: 0.6241366863250732
Epoch: 41, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.209 Vali Acc: 0.949 Test Loss: 0.209 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6602778434753418
Epoch: 42, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6684186458587646
Epoch: 43, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.192 Vali Acc: 0.942 Test Loss: 0.192 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7410895824432373
Epoch: 44, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.189 Vali Acc: 0.942 Test Loss: 0.189 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.6726462841033936
Epoch: 45, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.197 Vali Acc: 0.942 Test Loss: 0.197 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.6353533267974854
Epoch: 46, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.195 Vali Acc: 0.942 Test Loss: 0.195 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.5829215049743652
Epoch: 47, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.5417487621307373
Epoch: 48, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.935 Test Loss: 0.204 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.6142129898071289
Epoch: 49, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.195 Vali Acc: 0.949 Test Loss: 0.195 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 50 cost time: 0.6325750350952148
Epoch: 50, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.942 Test Loss: 0.186 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 43524
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.873638391494751
Epoch: 1, Steps: 9 | Train Loss: 1.411 Vali Loss: 1.368 Vali Acc: 0.210 Test Loss: 1.368 Test Acc: 0.210
Validation loss decreased (inf --> -0.210131).  Saving model ...
Epoch: 2 cost time: 0.668612003326416
Epoch: 2, Steps: 9 | Train Loss: 1.314 Vali Loss: 1.277 Vali Acc: 0.341 Test Loss: 1.277 Test Acc: 0.341
Validation loss decreased (-0.210131 --> -0.340567).  Saving model ...
Epoch: 3 cost time: 0.5688138008117676
Epoch: 3, Steps: 9 | Train Loss: 1.170 Vali Loss: 1.154 Vali Acc: 0.493 Test Loss: 1.154 Test Acc: 0.493
Validation loss decreased (-0.340567 --> -0.492742).  Saving model ...
Epoch: 4 cost time: 0.6083211898803711
Epoch: 4, Steps: 9 | Train Loss: 1.015 Vali Loss: 1.041 Vali Acc: 0.638 Test Loss: 1.041 Test Acc: 0.638
Validation loss decreased (-0.492742 --> -0.637671).  Saving model ...
Epoch: 5 cost time: 0.6998591423034668
Epoch: 5, Steps: 9 | Train Loss: 0.897 Vali Loss: 0.933 Vali Acc: 0.681 Test Loss: 0.933 Test Acc: 0.681
Validation loss decreased (-0.637671 --> -0.681150).  Saving model ...
Epoch: 6 cost time: 0.5604584217071533
Epoch: 6, Steps: 9 | Train Loss: 0.751 Vali Loss: 0.835 Vali Acc: 0.768 Test Loss: 0.835 Test Acc: 0.768
Validation loss decreased (-0.681150 --> -0.768108).  Saving model ...
Epoch: 7 cost time: 0.6158463954925537
Epoch: 7, Steps: 9 | Train Loss: 0.626 Vali Loss: 0.733 Vali Acc: 0.797 Test Loss: 0.733 Test Acc: 0.797
Validation loss decreased (-0.768108 --> -0.797094).  Saving model ...
Epoch: 8 cost time: 0.6051232814788818
Epoch: 8, Steps: 9 | Train Loss: 0.522 Vali Loss: 0.643 Vali Acc: 0.877 Test Loss: 0.643 Test Acc: 0.877
Validation loss decreased (-0.797094 --> -0.876805).  Saving model ...
Epoch: 9 cost time: 0.5683982372283936
Epoch: 9, Steps: 9 | Train Loss: 0.416 Vali Loss: 0.563 Vali Acc: 0.891 Test Loss: 0.563 Test Acc: 0.891
Validation loss decreased (-0.876805 --> -0.891299).  Saving model ...
Epoch: 10 cost time: 0.5771911144256592
Epoch: 10, Steps: 9 | Train Loss: 0.341 Vali Loss: 0.508 Vali Acc: 0.906 Test Loss: 0.508 Test Acc: 0.906
Validation loss decreased (-0.891299 --> -0.905792).  Saving model ...
Epoch: 11 cost time: 0.6746642589569092
Epoch: 11, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.459 Vali Acc: 0.906 Test Loss: 0.459 Test Acc: 0.906
Validation loss decreased (-0.905792 --> -0.905793).  Saving model ...
Epoch: 12 cost time: 0.6266469955444336
Epoch: 12, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.415 Vali Acc: 0.913 Test Loss: 0.415 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913039).  Saving model ...
Epoch: 13 cost time: 0.6480851173400879
Epoch: 13, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.383 Vali Acc: 0.913 Test Loss: 0.383 Test Acc: 0.913
Validation loss decreased (-0.913039 --> -0.913040).  Saving model ...
Epoch: 14 cost time: 0.659942626953125
Epoch: 14, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.359 Vali Acc: 0.913 Test Loss: 0.359 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 15 cost time: 0.5971417427062988
Epoch: 15, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.336 Vali Acc: 0.913 Test Loss: 0.336 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 16 cost time: 0.5652577877044678
Epoch: 16, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.322 Vali Acc: 0.920 Test Loss: 0.322 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 17 cost time: 0.7176859378814697
Epoch: 17, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.307 Vali Acc: 0.920 Test Loss: 0.307 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 18 cost time: 0.6132431030273438
Epoch: 18, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.298 Vali Acc: 0.920 Test Loss: 0.298 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 19 cost time: 0.5847325325012207
Epoch: 19, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.280 Vali Acc: 0.920 Test Loss: 0.280 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 20 cost time: 0.6035037040710449
Epoch: 20, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.279 Vali Acc: 0.928 Test Loss: 0.279 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927533).  Saving model ...
Epoch: 21 cost time: 0.5608599185943604
Epoch: 21, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.280 Vali Acc: 0.928 Test Loss: 0.280 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5924100875854492
Epoch: 22, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.272 Vali Acc: 0.928 Test Loss: 0.272 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927534).  Saving model ...
Epoch: 23 cost time: 0.6027095317840576
Epoch: 23, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.255 Vali Acc: 0.928 Test Loss: 0.255 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 24 cost time: 0.5793113708496094
Epoch: 24, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.251 Vali Acc: 0.928 Test Loss: 0.251 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 25 cost time: 0.5474543571472168
Epoch: 25, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.252 Vali Acc: 0.928 Test Loss: 0.252 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6784107685089111
Epoch: 26, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.238 Vali Acc: 0.928 Test Loss: 0.238 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 27 cost time: 0.6739981174468994
Epoch: 27, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.233 Vali Acc: 0.928 Test Loss: 0.233 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 28 cost time: 0.5811536312103271
Epoch: 28, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.231 Vali Acc: 0.928 Test Loss: 0.231 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 29 cost time: 0.5158646106719971
Epoch: 29, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.221 Vali Acc: 0.928 Test Loss: 0.221 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 30 cost time: 0.6694200038909912
Epoch: 30, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 31 cost time: 0.6077213287353516
Epoch: 31, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.227 Vali Acc: 0.935 Test Loss: 0.227 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5872042179107666
Epoch: 32, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.224 Vali Acc: 0.935 Test Loss: 0.224 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5606100559234619
Epoch: 33, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.221 Vali Acc: 0.928 Test Loss: 0.221 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5948243141174316
Epoch: 34, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.213 Vali Acc: 0.928 Test Loss: 0.213 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5871551036834717
Epoch: 35, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 36 cost time: 0.611361026763916
Epoch: 36, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.212 Vali Acc: 0.935 Test Loss: 0.212 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6330268383026123
Epoch: 37, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5798144340515137
Epoch: 38, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.217 Vali Acc: 0.928 Test Loss: 0.217 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6006300449371338
Epoch: 39, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934781).  Saving model ...
Epoch: 40 cost time: 0.6058580875396729
Epoch: 40, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6070806980133057
Epoch: 41, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.199 Vali Acc: 0.942 Test Loss: 0.199 Test Acc: 0.942
Validation loss decreased (-0.934781 --> -0.942027).  Saving model ...
Epoch: 42 cost time: 0.6201095581054688
Epoch: 42, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6214594841003418
Epoch: 43, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5914220809936523
Epoch: 44, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.201 Vali Acc: 0.935 Test Loss: 0.201 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5579071044921875
Epoch: 45, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6010279655456543
Epoch: 46, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.200 Vali Acc: 0.935 Test Loss: 0.200 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.6098835468292236
Epoch: 47, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.200 Vali Acc: 0.935 Test Loss: 0.200 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.6023015975952148
Epoch: 48, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.197 Vali Acc: 0.942 Test Loss: 0.197 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 49 cost time: 0.6093754768371582
Epoch: 49, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.196 Vali Acc: 0.942 Test Loss: 0.196 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 50 cost time: 0.6040201187133789
Epoch: 50, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.196 Vali Acc: 0.942 Test Loss: 0.196 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 40228
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0225839614868164
Epoch: 1, Steps: 9 | Train Loss: 1.447 Vali Loss: 1.418 Vali Acc: 0.283 Test Loss: 1.418 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 0.6135191917419434
Epoch: 2, Steps: 9 | Train Loss: 1.341 Vali Loss: 1.359 Vali Acc: 0.319 Test Loss: 1.359 Test Acc: 0.319
Validation loss decreased (-0.282595 --> -0.318827).  Saving model ...
Epoch: 3 cost time: 0.5704059600830078
Epoch: 3, Steps: 9 | Train Loss: 1.233 Vali Loss: 1.264 Vali Acc: 0.457 Test Loss: 1.264 Test Acc: 0.457
Validation loss decreased (-0.318827 --> -0.456509).  Saving model ...
Epoch: 4 cost time: 0.6242337226867676
Epoch: 4, Steps: 9 | Train Loss: 1.135 Vali Loss: 1.151 Vali Acc: 0.529 Test Loss: 1.151 Test Acc: 0.529
Validation loss decreased (-0.456509 --> -0.528974).  Saving model ...
Epoch: 5 cost time: 0.6446330547332764
Epoch: 5, Steps: 9 | Train Loss: 1.005 Vali Loss: 1.042 Vali Acc: 0.601 Test Loss: 1.042 Test Acc: 0.601
Validation loss decreased (-0.528974 --> -0.601439).  Saving model ...
Epoch: 6 cost time: 0.5976295471191406
Epoch: 6, Steps: 9 | Train Loss: 0.918 Vali Loss: 0.939 Vali Acc: 0.717 Test Loss: 0.939 Test Acc: 0.717
Validation loss decreased (-0.601439 --> -0.717382).  Saving model ...
Epoch: 7 cost time: 0.5912725925445557
Epoch: 7, Steps: 9 | Train Loss: 0.783 Vali Loss: 0.846 Vali Acc: 0.768 Test Loss: 0.846 Test Acc: 0.768
Validation loss decreased (-0.717382 --> -0.768107).  Saving model ...
Epoch: 8 cost time: 0.6135842800140381
Epoch: 8, Steps: 9 | Train Loss: 0.682 Vali Loss: 0.763 Vali Acc: 0.819 Test Loss: 0.763 Test Acc: 0.819
Validation loss decreased (-0.768107 --> -0.818833).  Saving model ...
Epoch: 9 cost time: 0.5944595336914062
Epoch: 9, Steps: 9 | Train Loss: 0.576 Vali Loss: 0.695 Vali Acc: 0.848 Test Loss: 0.695 Test Acc: 0.848
Validation loss decreased (-0.818833 --> -0.847819).  Saving model ...
Epoch: 10 cost time: 0.6146013736724854
Epoch: 10, Steps: 9 | Train Loss: 0.496 Vali Loss: 0.628 Vali Acc: 0.862 Test Loss: 0.628 Test Acc: 0.862
Validation loss decreased (-0.847819 --> -0.862313).  Saving model ...
Epoch: 11 cost time: 0.5558271408081055
Epoch: 11, Steps: 9 | Train Loss: 0.425 Vali Loss: 0.583 Vali Acc: 0.877 Test Loss: 0.583 Test Acc: 0.877
Validation loss decreased (-0.862313 --> -0.876806).  Saving model ...
Epoch: 12 cost time: 0.5997321605682373
Epoch: 12, Steps: 9 | Train Loss: 0.359 Vali Loss: 0.527 Vali Acc: 0.884 Test Loss: 0.527 Test Acc: 0.884
Validation loss decreased (-0.876806 --> -0.884053).  Saving model ...
Epoch: 13 cost time: 0.5610182285308838
Epoch: 13, Steps: 9 | Train Loss: 0.294 Vali Loss: 0.481 Vali Acc: 0.906 Test Loss: 0.481 Test Acc: 0.906
Validation loss decreased (-0.884053 --> -0.905792).  Saving model ...
Epoch: 14 cost time: 0.609246015548706
Epoch: 14, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.451 Vali Acc: 0.906 Test Loss: 0.451 Test Acc: 0.906
Validation loss decreased (-0.905792 --> -0.905793).  Saving model ...
Epoch: 15 cost time: 0.5893230438232422
Epoch: 15, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.425 Vali Acc: 0.906 Test Loss: 0.425 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 16 cost time: 0.5852367877960205
Epoch: 16, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.392 Vali Acc: 0.906 Test Loss: 0.392 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 17 cost time: 0.6652767658233643
Epoch: 17, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.374 Vali Acc: 0.906 Test Loss: 0.374 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 18 cost time: 0.5144128799438477
Epoch: 18, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.360 Vali Acc: 0.913 Test Loss: 0.360 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913040).  Saving model ...
Epoch: 19 cost time: 0.6075198650360107
Epoch: 19, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.339 Vali Acc: 0.913 Test Loss: 0.339 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 20 cost time: 0.6463100910186768
Epoch: 20, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.329 Vali Acc: 0.913 Test Loss: 0.329 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 21 cost time: 0.6652753353118896
Epoch: 21, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.323 Vali Acc: 0.920 Test Loss: 0.323 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 22 cost time: 0.6773865222930908
Epoch: 22, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.307 Vali Acc: 0.913 Test Loss: 0.307 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6233389377593994
Epoch: 23, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.294 Vali Acc: 0.913 Test Loss: 0.294 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6650271415710449
Epoch: 24, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.300 Vali Acc: 0.913 Test Loss: 0.300 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6723275184631348
Epoch: 25, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.286 Vali Acc: 0.913 Test Loss: 0.286 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6281089782714844
Epoch: 26, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.274 Vali Acc: 0.920 Test Loss: 0.274 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 27 cost time: 0.6431312561035156
Epoch: 27, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.264 Vali Acc: 0.920 Test Loss: 0.264 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 28 cost time: 0.6061618328094482
Epoch: 28, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.267 Vali Acc: 0.920 Test Loss: 0.267 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6296143531799316
Epoch: 29, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.258 Vali Acc: 0.920 Test Loss: 0.258 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 30 cost time: 0.637300968170166
Epoch: 30, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.260 Vali Acc: 0.920 Test Loss: 0.260 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6794083118438721
Epoch: 31, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.253 Vali Acc: 0.920 Test Loss: 0.253 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 32 cost time: 0.6445155143737793
Epoch: 32, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.248 Vali Acc: 0.920 Test Loss: 0.248 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 33 cost time: 0.6314935684204102
Epoch: 33, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.245 Vali Acc: 0.920 Test Loss: 0.245 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 34 cost time: 0.6874003410339355
Epoch: 34, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.237 Vali Acc: 0.920 Test Loss: 0.237 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 35 cost time: 0.5948243141174316
Epoch: 35, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.234 Vali Acc: 0.920 Test Loss: 0.234 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920288).  Saving model ...
Epoch: 36 cost time: 0.5908608436584473
Epoch: 36, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.232 Vali Acc: 0.920 Test Loss: 0.232 Test Acc: 0.920
Validation loss decreased (-0.920288 --> -0.920288).  Saving model ...
Epoch: 37 cost time: 0.6093733310699463
Epoch: 37, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.217 Vali Acc: 0.920 Test Loss: 0.217 Test Acc: 0.920
Validation loss decreased (-0.920288 --> -0.920288).  Saving model ...
Epoch: 38 cost time: 0.586555004119873
Epoch: 38, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.213 Vali Acc: 0.920 Test Loss: 0.213 Test Acc: 0.920
Validation loss decreased (-0.920288 --> -0.920288).  Saving model ...
Epoch: 39 cost time: 0.5624642372131348
Epoch: 39, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.205 Vali Acc: 0.920 Test Loss: 0.205 Test Acc: 0.920
Validation loss decreased (-0.920288 --> -0.920288).  Saving model ...
Epoch: 40 cost time: 0.6196315288543701
Epoch: 40, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.207 Vali Acc: 0.920 Test Loss: 0.207 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5844385623931885
Epoch: 41, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.207 Vali Acc: 0.928 Test Loss: 0.207 Test Acc: 0.928
Validation loss decreased (-0.920288 --> -0.927534).  Saving model ...
Epoch: 42 cost time: 0.6102252006530762
Epoch: 42, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.212 Vali Acc: 0.920 Test Loss: 0.212 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6199612617492676
Epoch: 43, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.220 Vali Acc: 0.920 Test Loss: 0.220 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6645185947418213
Epoch: 44, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.211 Vali Acc: 0.920 Test Loss: 0.211 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6521923542022705
Epoch: 45, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.207 Vali Acc: 0.920 Test Loss: 0.207 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6333625316619873
Epoch: 46, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.204 Vali Acc: 0.920 Test Loss: 0.204 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.6282839775085449
Epoch: 47, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.197 Vali Acc: 0.920 Test Loss: 0.197 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.6482536792755127
Epoch: 48, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.195 Vali Acc: 0.920 Test Loss: 0.195 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.6592798233032227
Epoch: 49, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.197 Vali Acc: 0.920 Test Loss: 0.197 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.6440126895904541
Epoch: 50, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.190 Vali Acc: 0.920 Test Loss: 0.190 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 37700
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9208755493164062
Epoch: 1, Steps: 9 | Train Loss: 1.416 Vali Loss: 1.389 Vali Acc: 0.210 Test Loss: 1.389 Test Acc: 0.210
Validation loss decreased (inf --> -0.210131).  Saving model ...
Epoch: 2 cost time: 0.6615619659423828
Epoch: 2, Steps: 9 | Train Loss: 1.352 Vali Loss: 1.350 Vali Acc: 0.275 Test Loss: 1.350 Test Acc: 0.275
Validation loss decreased (-0.210131 --> -0.275349).  Saving model ...
Epoch: 3 cost time: 0.5818846225738525
Epoch: 3, Steps: 9 | Train Loss: 1.276 Vali Loss: 1.284 Vali Acc: 0.370 Test Loss: 1.284 Test Acc: 0.370
Validation loss decreased (-0.275349 --> -0.369552).  Saving model ...
Epoch: 4 cost time: 0.5981884002685547
Epoch: 4, Steps: 9 | Train Loss: 1.202 Vali Loss: 1.205 Vali Acc: 0.442 Test Loss: 1.205 Test Acc: 0.442
Validation loss decreased (-0.369552 --> -0.442017).  Saving model ...
Epoch: 5 cost time: 0.6212785243988037
Epoch: 5, Steps: 9 | Train Loss: 1.104 Vali Loss: 1.124 Vali Acc: 0.507 Test Loss: 1.124 Test Acc: 0.507
Validation loss decreased (-0.442017 --> -0.507235).  Saving model ...
Epoch: 6 cost time: 0.6437070369720459
Epoch: 6, Steps: 9 | Train Loss: 1.004 Vali Loss: 1.048 Vali Acc: 0.543 Test Loss: 1.048 Test Acc: 0.543
Validation loss decreased (-0.507235 --> -0.543468).  Saving model ...
Epoch: 7 cost time: 0.5786809921264648
Epoch: 7, Steps: 9 | Train Loss: 0.929 Vali Loss: 0.972 Vali Acc: 0.616 Test Loss: 0.972 Test Acc: 0.616
Validation loss decreased (-0.543468 --> -0.615932).  Saving model ...
Epoch: 8 cost time: 0.5958678722381592
Epoch: 8, Steps: 9 | Train Loss: 0.822 Vali Loss: 0.904 Vali Acc: 0.681 Test Loss: 0.904 Test Acc: 0.681
Validation loss decreased (-0.615932 --> -0.681150).  Saving model ...
Epoch: 9 cost time: 0.6181178092956543
Epoch: 9, Steps: 9 | Train Loss: 0.742 Vali Loss: 0.833 Vali Acc: 0.761 Test Loss: 0.833 Test Acc: 0.761
Validation loss decreased (-0.681150 --> -0.760861).  Saving model ...
Epoch: 10 cost time: 0.5775690078735352
Epoch: 10, Steps: 9 | Train Loss: 0.671 Vali Loss: 0.768 Vali Acc: 0.804 Test Loss: 0.768 Test Acc: 0.804
Validation loss decreased (-0.760861 --> -0.804340).  Saving model ...
Epoch: 11 cost time: 0.5761604309082031
Epoch: 11, Steps: 9 | Train Loss: 0.587 Vali Loss: 0.709 Vali Acc: 0.819 Test Loss: 0.709 Test Acc: 0.819
Validation loss decreased (-0.804340 --> -0.818833).  Saving model ...
Epoch: 12 cost time: 0.581432580947876
Epoch: 12, Steps: 9 | Train Loss: 0.513 Vali Loss: 0.661 Vali Acc: 0.833 Test Loss: 0.661 Test Acc: 0.833
Validation loss decreased (-0.818833 --> -0.833327).  Saving model ...
Epoch: 13 cost time: 0.5669817924499512
Epoch: 13, Steps: 9 | Train Loss: 0.482 Vali Loss: 0.617 Vali Acc: 0.841 Test Loss: 0.617 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840574).  Saving model ...
Epoch: 14 cost time: 0.5722801685333252
Epoch: 14, Steps: 9 | Train Loss: 0.436 Vali Loss: 0.571 Vali Acc: 0.877 Test Loss: 0.571 Test Acc: 0.877
Validation loss decreased (-0.840574 --> -0.876806).  Saving model ...
Epoch: 15 cost time: 0.650202751159668
Epoch: 15, Steps: 9 | Train Loss: 0.392 Vali Loss: 0.547 Vali Acc: 0.877 Test Loss: 0.547 Test Acc: 0.877
Validation loss decreased (-0.876806 --> -0.876806).  Saving model ...
Epoch: 16 cost time: 0.673485279083252
Epoch: 16, Steps: 9 | Train Loss: 0.355 Vali Loss: 0.513 Vali Acc: 0.884 Test Loss: 0.513 Test Acc: 0.884
Validation loss decreased (-0.876806 --> -0.884053).  Saving model ...
Epoch: 17 cost time: 0.6481211185455322
Epoch: 17, Steps: 9 | Train Loss: 0.301 Vali Loss: 0.483 Vali Acc: 0.891 Test Loss: 0.483 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891300).  Saving model ...
Epoch: 18 cost time: 0.5827169418334961
Epoch: 18, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.464 Vali Acc: 0.891 Test Loss: 0.464 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 19 cost time: 0.6240742206573486
Epoch: 19, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.445 Vali Acc: 0.899 Test Loss: 0.445 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898546).  Saving model ...
Epoch: 20 cost time: 0.6545684337615967
Epoch: 20, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.420 Vali Acc: 0.906 Test Loss: 0.420 Test Acc: 0.906
Validation loss decreased (-0.898546 --> -0.905793).  Saving model ...
Epoch: 21 cost time: 0.5839576721191406
Epoch: 21, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.402 Vali Acc: 0.906 Test Loss: 0.402 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 22 cost time: 0.5730845928192139
Epoch: 22, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.396 Vali Acc: 0.920 Test Loss: 0.396 Test Acc: 0.920
Validation loss decreased (-0.905793 --> -0.920286).  Saving model ...
Epoch: 23 cost time: 0.6730432510375977
Epoch: 23, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.379 Vali Acc: 0.920 Test Loss: 0.379 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 24 cost time: 0.573117733001709
Epoch: 24, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.366 Vali Acc: 0.920 Test Loss: 0.366 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 25 cost time: 0.5833621025085449
Epoch: 25, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.351 Vali Acc: 0.928 Test Loss: 0.351 Test Acc: 0.928
Validation loss decreased (-0.920286 --> -0.927533).  Saving model ...
Epoch: 26 cost time: 0.6143417358398438
Epoch: 26, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.336 Vali Acc: 0.935 Test Loss: 0.336 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934779).  Saving model ...
Epoch: 27 cost time: 0.6549990177154541
Epoch: 27, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.317 Vali Acc: 0.928 Test Loss: 0.317 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.576143741607666
Epoch: 28, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.314 Vali Acc: 0.935 Test Loss: 0.314 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934779).  Saving model ...
Epoch: 29 cost time: 0.5811362266540527
Epoch: 29, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.312 Vali Acc: 0.935 Test Loss: 0.312 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934779).  Saving model ...
Epoch: 30 cost time: 0.6524491310119629
Epoch: 30, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.309 Vali Acc: 0.935 Test Loss: 0.309 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934780).  Saving model ...
Epoch: 31 cost time: 0.6196944713592529
Epoch: 31, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.300 Vali Acc: 0.935 Test Loss: 0.300 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 32 cost time: 0.6193323135375977
Epoch: 32, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.300 Vali Acc: 0.942 Test Loss: 0.300 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942026).  Saving model ...
Epoch: 33 cost time: 0.6025662422180176
Epoch: 33, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.288 Vali Acc: 0.942 Test Loss: 0.288 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 34 cost time: 0.5861458778381348
Epoch: 34, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.287 Vali Acc: 0.942 Test Loss: 0.287 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 35 cost time: 0.5886344909667969
Epoch: 35, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.278 Vali Acc: 0.942 Test Loss: 0.278 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 36 cost time: 0.6609892845153809
Epoch: 36, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.269 Vali Acc: 0.935 Test Loss: 0.269 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6218488216400146
Epoch: 37, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.266 Vali Acc: 0.942 Test Loss: 0.266 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 38 cost time: 0.5982282161712646
Epoch: 38, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.253 Vali Acc: 0.942 Test Loss: 0.253 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 39 cost time: 0.6141979694366455
Epoch: 39, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.254 Vali Acc: 0.942 Test Loss: 0.254 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6172854900360107
Epoch: 40, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.264 Vali Acc: 0.942 Test Loss: 0.264 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5775279998779297
Epoch: 41, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.255 Vali Acc: 0.942 Test Loss: 0.255 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5484895706176758
Epoch: 42, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.251 Vali Acc: 0.942 Test Loss: 0.251 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 43 cost time: 0.5644745826721191
Epoch: 43, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.239 Vali Acc: 0.935 Test Loss: 0.239 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5863919258117676
Epoch: 44, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.234 Vali Acc: 0.942 Test Loss: 0.234 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 45 cost time: 0.5757343769073486
Epoch: 45, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.250 Vali Acc: 0.942 Test Loss: 0.250 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5788040161132812
Epoch: 46, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.237 Vali Acc: 0.935 Test Loss: 0.237 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5912575721740723
Epoch: 47, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.240 Vali Acc: 0.935 Test Loss: 0.240 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.6184103488922119
Epoch: 48, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.5877892971038818
Epoch: 49, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.218 Vali Acc: 0.935 Test Loss: 0.218 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.5351629257202148
Epoch: 50, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.219 Vali Acc: 0.935 Test Loss: 0.219 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 35716
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0005149841308594
Epoch: 1, Steps: 9 | Train Loss: 1.459 Vali Loss: 1.403 Vali Acc: 0.210 Test Loss: 1.403 Test Acc: 0.210
Validation loss decreased (inf --> -0.210131).  Saving model ...
Epoch: 2 cost time: 0.5750048160552979
Epoch: 2, Steps: 9 | Train Loss: 1.415 Vali Loss: 1.377 Vali Acc: 0.210 Test Loss: 1.377 Test Acc: 0.210
Validation loss decreased (-0.210131 --> -0.210131).  Saving model ...
Epoch: 3 cost time: 0.5705277919769287
Epoch: 3, Steps: 9 | Train Loss: 1.334 Vali Loss: 1.329 Vali Acc: 0.261 Test Loss: 1.329 Test Acc: 0.261
Validation loss decreased (-0.210131 --> -0.260856).  Saving model ...
Epoch: 4 cost time: 0.5512301921844482
Epoch: 4, Steps: 9 | Train Loss: 1.277 Vali Loss: 1.269 Vali Acc: 0.362 Test Loss: 1.269 Test Acc: 0.362
Validation loss decreased (-0.260856 --> -0.362306).  Saving model ...
Epoch: 5 cost time: 0.5495965480804443
Epoch: 5, Steps: 9 | Train Loss: 1.183 Vali Loss: 1.204 Vali Acc: 0.457 Test Loss: 1.204 Test Acc: 0.457
Validation loss decreased (-0.362306 --> -0.456510).  Saving model ...
Epoch: 6 cost time: 0.5309674739837646
Epoch: 6, Steps: 9 | Train Loss: 1.131 Vali Loss: 1.143 Vali Acc: 0.529 Test Loss: 1.143 Test Acc: 0.529
Validation loss decreased (-0.456510 --> -0.528974).  Saving model ...
Epoch: 7 cost time: 0.5345230102539062
Epoch: 7, Steps: 9 | Train Loss: 1.033 Vali Loss: 1.074 Vali Acc: 0.594 Test Loss: 1.074 Test Acc: 0.594
Validation loss decreased (-0.528974 --> -0.594192).  Saving model ...
Epoch: 8 cost time: 0.5837759971618652
Epoch: 8, Steps: 9 | Train Loss: 0.947 Vali Loss: 1.007 Vali Acc: 0.630 Test Loss: 1.007 Test Acc: 0.630
Validation loss decreased (-0.594192 --> -0.630425).  Saving model ...
Epoch: 9 cost time: 0.5701930522918701
Epoch: 9, Steps: 9 | Train Loss: 0.876 Vali Loss: 0.948 Vali Acc: 0.710 Test Loss: 0.948 Test Acc: 0.710
Validation loss decreased (-0.630425 --> -0.710135).  Saving model ...
Epoch: 10 cost time: 0.6016106605529785
Epoch: 10, Steps: 9 | Train Loss: 0.790 Vali Loss: 0.881 Vali Acc: 0.732 Test Loss: 0.881 Test Acc: 0.732
Validation loss decreased (-0.710135 --> -0.731875).  Saving model ...
Epoch: 11 cost time: 0.5762810707092285
Epoch: 11, Steps: 9 | Train Loss: 0.731 Vali Loss: 0.821 Vali Acc: 0.761 Test Loss: 0.821 Test Acc: 0.761
Validation loss decreased (-0.731875 --> -0.760861).  Saving model ...
Epoch: 12 cost time: 0.5871202945709229
Epoch: 12, Steps: 9 | Train Loss: 0.660 Vali Loss: 0.772 Vali Acc: 0.790 Test Loss: 0.772 Test Acc: 0.790
Validation loss decreased (-0.760861 --> -0.789847).  Saving model ...
Epoch: 13 cost time: 0.5655875205993652
Epoch: 13, Steps: 9 | Train Loss: 0.599 Vali Loss: 0.721 Vali Acc: 0.826 Test Loss: 0.721 Test Acc: 0.826
Validation loss decreased (-0.789847 --> -0.826080).  Saving model ...
Epoch: 14 cost time: 0.5977458953857422
Epoch: 14, Steps: 9 | Train Loss: 0.529 Vali Loss: 0.687 Vali Acc: 0.841 Test Loss: 0.687 Test Acc: 0.841
Validation loss decreased (-0.826080 --> -0.840573).  Saving model ...
Epoch: 15 cost time: 0.5779421329498291
Epoch: 15, Steps: 9 | Train Loss: 0.495 Vali Loss: 0.648 Vali Acc: 0.841 Test Loss: 0.648 Test Acc: 0.841
Validation loss decreased (-0.840573 --> -0.840573).  Saving model ...
Epoch: 16 cost time: 0.5961520671844482
Epoch: 16, Steps: 9 | Train Loss: 0.461 Vali Loss: 0.609 Vali Acc: 0.848 Test Loss: 0.609 Test Acc: 0.848
Validation loss decreased (-0.840573 --> -0.847820).  Saving model ...
Epoch: 17 cost time: 0.5341529846191406
Epoch: 17, Steps: 9 | Train Loss: 0.409 Vali Loss: 0.572 Vali Acc: 0.848 Test Loss: 0.572 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847820).  Saving model ...
Epoch: 18 cost time: 0.5850033760070801
Epoch: 18, Steps: 9 | Train Loss: 0.375 Vali Loss: 0.538 Vali Acc: 0.862 Test Loss: 0.538 Test Acc: 0.862
Validation loss decreased (-0.847820 --> -0.862313).  Saving model ...
Epoch: 19 cost time: 0.5665340423583984
Epoch: 19, Steps: 9 | Train Loss: 0.323 Vali Loss: 0.514 Vali Acc: 0.862 Test Loss: 0.514 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862314).  Saving model ...
Epoch: 20 cost time: 0.559307336807251
Epoch: 20, Steps: 9 | Train Loss: 0.297 Vali Loss: 0.494 Vali Acc: 0.870 Test Loss: 0.494 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 21 cost time: 0.6005547046661377
Epoch: 21, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.466 Vali Acc: 0.884 Test Loss: 0.466 Test Acc: 0.884
Validation loss decreased (-0.869560 --> -0.884053).  Saving model ...
Epoch: 22 cost time: 0.5935704708099365
Epoch: 22, Steps: 9 | Train Loss: 0.270 Vali Loss: 0.460 Vali Acc: 0.884 Test Loss: 0.460 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 23 cost time: 0.6231081485748291
Epoch: 23, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.443 Vali Acc: 0.877 Test Loss: 0.443 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5900256633758545
Epoch: 24, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.420 Vali Acc: 0.877 Test Loss: 0.420 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5670933723449707
Epoch: 25, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.408 Vali Acc: 0.877 Test Loss: 0.408 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6106054782867432
Epoch: 26, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.397 Vali Acc: 0.891 Test Loss: 0.397 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891300).  Saving model ...
Epoch: 27 cost time: 0.6171557903289795
Epoch: 27, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.376 Vali Acc: 0.884 Test Loss: 0.376 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.557166576385498
Epoch: 28, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.364 Vali Acc: 0.891 Test Loss: 0.364 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891301).  Saving model ...
Epoch: 29 cost time: 0.550553560256958
Epoch: 29, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.364 Vali Acc: 0.899 Test Loss: 0.364 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 30 cost time: 0.6114447116851807
Epoch: 30, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.353 Vali Acc: 0.891 Test Loss: 0.353 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.529998779296875
Epoch: 31, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.339 Vali Acc: 0.891 Test Loss: 0.339 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5760231018066406
Epoch: 32, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.331 Vali Acc: 0.891 Test Loss: 0.331 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5841374397277832
Epoch: 33, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.321 Vali Acc: 0.891 Test Loss: 0.321 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5669019222259521
Epoch: 34, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.314 Vali Acc: 0.891 Test Loss: 0.314 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5804483890533447
Epoch: 35, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.303 Vali Acc: 0.899 Test Loss: 0.303 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898548).  Saving model ...
Epoch: 36 cost time: 0.6021959781646729
Epoch: 36, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.301 Vali Acc: 0.884 Test Loss: 0.301 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5854983329772949
Epoch: 37, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.288 Vali Acc: 0.899 Test Loss: 0.288 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 38 cost time: 0.6233453750610352
Epoch: 38, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.285 Vali Acc: 0.920 Test Loss: 0.285 Test Acc: 0.920
Validation loss decreased (-0.898548 --> -0.920287).  Saving model ...
Epoch: 39 cost time: 0.6163475513458252
Epoch: 39, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.284 Vali Acc: 0.899 Test Loss: 0.284 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6924941539764404
Epoch: 40, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.262 Vali Acc: 0.906 Test Loss: 0.262 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.659142255783081
Epoch: 41, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.257 Vali Acc: 0.928 Test Loss: 0.257 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 42 cost time: 0.6032061576843262
Epoch: 42, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.250 Vali Acc: 0.928 Test Loss: 0.250 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 43 cost time: 0.5874049663543701
Epoch: 43, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.251 Vali Acc: 0.928 Test Loss: 0.251 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6069912910461426
Epoch: 44, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.245 Vali Acc: 0.928 Test Loss: 0.245 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 45 cost time: 0.5433595180511475
Epoch: 45, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.243 Vali Acc: 0.928 Test Loss: 0.243 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 46 cost time: 0.6920850276947021
Epoch: 46, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.234 Vali Acc: 0.928 Test Loss: 0.234 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 47 cost time: 0.6229057312011719
Epoch: 47, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.224 Vali Acc: 0.928 Test Loss: 0.224 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 48 cost time: 0.6148364543914795
Epoch: 48, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.226 Vali Acc: 0.935 Test Loss: 0.226 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 49 cost time: 0.5348806381225586
Epoch: 49, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5817430019378662
Epoch: 50, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 34916
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8792595863342285
Epoch: 1, Steps: 9 | Train Loss: 1.389 Vali Loss: 1.431 Vali Acc: 0.203 Test Loss: 1.431 Test Acc: 0.203
Validation loss decreased (inf --> -0.202884).  Saving model ...
Epoch: 2 cost time: 0.6831374168395996
Epoch: 2, Steps: 9 | Train Loss: 1.345 Vali Loss: 1.408 Vali Acc: 0.275 Test Loss: 1.408 Test Acc: 0.275
Validation loss decreased (-0.202884 --> -0.275348).  Saving model ...
Epoch: 3 cost time: 0.5954544544219971
Epoch: 3, Steps: 9 | Train Loss: 1.320 Vali Loss: 1.367 Vali Acc: 0.297 Test Loss: 1.367 Test Acc: 0.297
Validation loss decreased (-0.275348 --> -0.297088).  Saving model ...
Epoch: 4 cost time: 0.6155242919921875
Epoch: 4, Steps: 9 | Train Loss: 1.234 Vali Loss: 1.315 Vali Acc: 0.348 Test Loss: 1.315 Test Acc: 0.348
Validation loss decreased (-0.297088 --> -0.347813).  Saving model ...
Epoch: 5 cost time: 0.564460277557373
Epoch: 5, Steps: 9 | Train Loss: 1.166 Vali Loss: 1.260 Vali Acc: 0.413 Test Loss: 1.260 Test Acc: 0.413
Validation loss decreased (-0.347813 --> -0.413031).  Saving model ...
Epoch: 6 cost time: 0.6111810207366943
Epoch: 6, Steps: 9 | Train Loss: 1.133 Vali Loss: 1.203 Vali Acc: 0.457 Test Loss: 1.203 Test Acc: 0.457
Validation loss decreased (-0.413031 --> -0.456510).  Saving model ...
Epoch: 7 cost time: 0.5927302837371826
Epoch: 7, Steps: 9 | Train Loss: 1.072 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
Validation loss decreased (-0.456510 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 0.6893277168273926
Epoch: 8, Steps: 9 | Train Loss: 0.967 Vali Loss: 1.093 Vali Acc: 0.536 Test Loss: 1.093 Test Acc: 0.536
Validation loss decreased (-0.499989 --> -0.536221).  Saving model ...
Epoch: 9 cost time: 0.567317008972168
Epoch: 9, Steps: 9 | Train Loss: 0.902 Vali Loss: 1.040 Vali Acc: 0.565 Test Loss: 1.040 Test Acc: 0.565
Validation loss decreased (-0.536221 --> -0.565207).  Saving model ...
Epoch: 10 cost time: 0.6835629940032959
Epoch: 10, Steps: 9 | Train Loss: 0.859 Vali Loss: 0.988 Vali Acc: 0.609 Test Loss: 0.988 Test Acc: 0.609
Validation loss decreased (-0.565207 --> -0.608686).  Saving model ...
Epoch: 11 cost time: 0.5638537406921387
Epoch: 11, Steps: 9 | Train Loss: 0.788 Vali Loss: 0.940 Vali Acc: 0.645 Test Loss: 0.940 Test Acc: 0.645
Validation loss decreased (-0.608686 --> -0.644918).  Saving model ...
Epoch: 12 cost time: 0.60137939453125
Epoch: 12, Steps: 9 | Train Loss: 0.740 Vali Loss: 0.888 Vali Acc: 0.696 Test Loss: 0.888 Test Acc: 0.696
Validation loss decreased (-0.644918 --> -0.695643).  Saving model ...
Epoch: 13 cost time: 0.5926108360290527
Epoch: 13, Steps: 9 | Train Loss: 0.665 Vali Loss: 0.846 Vali Acc: 0.725 Test Loss: 0.846 Test Acc: 0.725
Validation loss decreased (-0.695643 --> -0.724629).  Saving model ...
Epoch: 14 cost time: 0.6642115116119385
Epoch: 14, Steps: 9 | Train Loss: 0.645 Vali Loss: 0.808 Vali Acc: 0.717 Test Loss: 0.808 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5761022567749023
Epoch: 15, Steps: 9 | Train Loss: 0.588 Vali Loss: 0.767 Vali Acc: 0.739 Test Loss: 0.767 Test Acc: 0.739
Validation loss decreased (-0.724629 --> -0.739123).  Saving model ...
Epoch: 16 cost time: 0.5583038330078125
Epoch: 16, Steps: 9 | Train Loss: 0.529 Vali Loss: 0.736 Vali Acc: 0.754 Test Loss: 0.736 Test Acc: 0.754
Validation loss decreased (-0.739123 --> -0.753616).  Saving model ...
Epoch: 17 cost time: 0.6005005836486816
Epoch: 17, Steps: 9 | Train Loss: 0.486 Vali Loss: 0.703 Vali Acc: 0.761 Test Loss: 0.703 Test Acc: 0.761
Validation loss decreased (-0.753616 --> -0.760863).  Saving model ...
Epoch: 18 cost time: 0.6076254844665527
Epoch: 18, Steps: 9 | Train Loss: 0.457 Vali Loss: 0.672 Vali Acc: 0.783 Test Loss: 0.672 Test Acc: 0.783
Validation loss decreased (-0.760863 --> -0.782602).  Saving model ...
Epoch: 19 cost time: 0.5759212970733643
Epoch: 19, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.639 Vali Acc: 0.797 Test Loss: 0.639 Test Acc: 0.797
Validation loss decreased (-0.782602 --> -0.797095).  Saving model ...
Epoch: 20 cost time: 0.5728809833526611
Epoch: 20, Steps: 9 | Train Loss: 0.391 Vali Loss: 0.622 Vali Acc: 0.819 Test Loss: 0.622 Test Acc: 0.819
Validation loss decreased (-0.797095 --> -0.818834).  Saving model ...
Epoch: 21 cost time: 0.6082007884979248
Epoch: 21, Steps: 9 | Train Loss: 0.353 Vali Loss: 0.589 Vali Acc: 0.833 Test Loss: 0.589 Test Acc: 0.833
Validation loss decreased (-0.818834 --> -0.833327).  Saving model ...
Epoch: 22 cost time: 0.6042814254760742
Epoch: 22, Steps: 9 | Train Loss: 0.332 Vali Loss: 0.567 Vali Acc: 0.841 Test Loss: 0.567 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840574).  Saving model ...
Epoch: 23 cost time: 0.5663378238677979
Epoch: 23, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.552 Vali Acc: 0.833 Test Loss: 0.552 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5712931156158447
Epoch: 24, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 25 cost time: 0.5314176082611084
Epoch: 25, Steps: 9 | Train Loss: 0.305 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 26 cost time: 0.5699143409729004
Epoch: 26, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.504 Vali Acc: 0.848 Test Loss: 0.504 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 27 cost time: 0.5548491477966309
Epoch: 27, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.490 Vali Acc: 0.862 Test Loss: 0.490 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 28 cost time: 0.6158030033111572
Epoch: 28, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.466 Vali Acc: 0.855 Test Loss: 0.466 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6365091800689697
Epoch: 29, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.452 Vali Acc: 0.862 Test Loss: 0.452 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 30 cost time: 0.5778274536132812
Epoch: 30, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.435 Vali Acc: 0.862 Test Loss: 0.435 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 31 cost time: 0.640233039855957
Epoch: 31, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.413 Vali Acc: 0.884 Test Loss: 0.413 Test Acc: 0.884
Validation loss decreased (-0.862314 --> -0.884054).  Saving model ...
Epoch: 32 cost time: 0.5656030178070068
Epoch: 32, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.407 Vali Acc: 0.884 Test Loss: 0.407 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 33 cost time: 0.6740951538085938
Epoch: 33, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.415 Vali Acc: 0.884 Test Loss: 0.415 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6702227592468262
Epoch: 34, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.404 Vali Acc: 0.877 Test Loss: 0.404 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6244821548461914
Epoch: 35, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.394 Vali Acc: 0.891 Test Loss: 0.394 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 36 cost time: 0.6208887100219727
Epoch: 36, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.374 Vali Acc: 0.891 Test Loss: 0.374 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891301).  Saving model ...
Epoch: 37 cost time: 0.6159868240356445
Epoch: 37, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.350 Vali Acc: 0.891 Test Loss: 0.350 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 38 cost time: 0.6586606502532959
Epoch: 38, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.342 Vali Acc: 0.899 Test Loss: 0.342 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 39 cost time: 0.650444746017456
Epoch: 39, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.328 Vali Acc: 0.906 Test Loss: 0.328 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 40 cost time: 0.5529611110687256
Epoch: 40, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.323 Vali Acc: 0.913 Test Loss: 0.323 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 41 cost time: 0.6809952259063721
Epoch: 41, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.322 Vali Acc: 0.906 Test Loss: 0.322 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6086673736572266
Epoch: 42, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.315 Vali Acc: 0.906 Test Loss: 0.315 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5677652359008789
Epoch: 43, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.311 Vali Acc: 0.906 Test Loss: 0.311 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6187267303466797
Epoch: 44, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.309 Vali Acc: 0.906 Test Loss: 0.309 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.5839266777038574
Epoch: 45, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.276 Vali Acc: 0.928 Test Loss: 0.276 Test Acc: 0.928
Validation loss decreased (-0.913040 --> -0.927533).  Saving model ...
Epoch: 46 cost time: 0.5903398990631104
Epoch: 46, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.280 Vali Acc: 0.928 Test Loss: 0.280 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5884015560150146
Epoch: 47, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.254 Vali Acc: 0.935 Test Loss: 0.254 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934780).  Saving model ...
Epoch: 48 cost time: 0.6483345031738281
Epoch: 48, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.257 Vali Acc: 0.928 Test Loss: 0.257 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5708906650543213
Epoch: 49, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.263 Vali Acc: 0.920 Test Loss: 0.263 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6360502243041992
Epoch: 50, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.264 Vali Acc: 0.913 Test Loss: 0.264 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 34468
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0876080989837646
Epoch: 1, Steps: 9 | Train Loss: 1.427 Vali Loss: 1.372 Vali Acc: 0.254 Test Loss: 1.372 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 0.6770274639129639
Epoch: 2, Steps: 9 | Train Loss: 1.319 Vali Loss: 1.290 Vali Acc: 0.507 Test Loss: 1.290 Test Acc: 0.507
Validation loss decreased (-0.253609 --> -0.507233).  Saving model ...
Epoch: 3 cost time: 0.6960546970367432
Epoch: 3, Steps: 9 | Train Loss: 1.155 Vali Loss: 1.150 Vali Acc: 0.681 Test Loss: 1.150 Test Acc: 0.681
Validation loss decreased (-0.507233 --> -0.681148).  Saving model ...
Epoch: 4 cost time: 0.7235345840454102
Epoch: 4, Steps: 9 | Train Loss: 0.968 Vali Loss: 0.967 Vali Acc: 0.775 Test Loss: 0.967 Test Acc: 0.775
Validation loss decreased (-0.681148 --> -0.775353).  Saving model ...
Epoch: 5 cost time: 0.6886711120605469
Epoch: 5, Steps: 9 | Train Loss: 0.749 Vali Loss: 0.776 Vali Acc: 0.855 Test Loss: 0.776 Test Acc: 0.855
Validation loss decreased (-0.775353 --> -0.855065).  Saving model ...
Epoch: 6 cost time: 0.7138705253601074
Epoch: 6, Steps: 9 | Train Loss: 0.568 Vali Loss: 0.603 Vali Acc: 0.862 Test Loss: 0.603 Test Acc: 0.862
Validation loss decreased (-0.855065 --> -0.862313).  Saving model ...
Epoch: 7 cost time: 0.728994607925415
Epoch: 7, Steps: 9 | Train Loss: 0.392 Vali Loss: 0.461 Vali Acc: 0.884 Test Loss: 0.461 Test Acc: 0.884
Validation loss decreased (-0.862313 --> -0.884053).  Saving model ...
Epoch: 8 cost time: 0.6682388782501221
Epoch: 8, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.361 Vali Acc: 0.906 Test Loss: 0.361 Test Acc: 0.906
Validation loss decreased (-0.884053 --> -0.905793).  Saving model ...
Epoch: 9 cost time: 0.7122516632080078
Epoch: 9, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.298 Vali Acc: 0.906 Test Loss: 0.298 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905794).  Saving model ...
Epoch: 10 cost time: 0.751788854598999
Epoch: 10, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.275 Vali Acc: 0.899 Test Loss: 0.275 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6880500316619873
Epoch: 11, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.241 Vali Acc: 0.942 Test Loss: 0.241 Test Acc: 0.942
Validation loss decreased (-0.905794 --> -0.942027).  Saving model ...
Epoch: 12 cost time: 0.6332781314849854
Epoch: 12, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.223 Vali Acc: 0.949 Test Loss: 0.223 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949273).  Saving model ...
Epoch: 13 cost time: 0.6516537666320801
Epoch: 13, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.226 Vali Acc: 0.942 Test Loss: 0.226 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6745510101318359
Epoch: 14, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.219 Vali Acc: 0.928 Test Loss: 0.219 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6408360004425049
Epoch: 15, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6815268993377686
Epoch: 16, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.195 Vali Acc: 0.949 Test Loss: 0.195 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 17 cost time: 0.6964716911315918
Epoch: 17, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.206 Vali Acc: 0.942 Test Loss: 0.206 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7277865409851074
Epoch: 18, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.210 Vali Acc: 0.942 Test Loss: 0.210 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7186427116394043
Epoch: 19, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.185 Vali Acc: 0.942 Test Loss: 0.185 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7095563411712646
Epoch: 20, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.182 Vali Acc: 0.942 Test Loss: 0.182 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7153720855712891
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.189 Vali Acc: 0.942 Test Loss: 0.189 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.689429521560669
Epoch: 22, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.192 Vali Acc: 0.942 Test Loss: 0.192 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7445352077484131
Epoch: 23, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.205 Vali Acc: 0.913 Test Loss: 0.205 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7593405246734619
Epoch: 24, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.202 Vali Acc: 0.913 Test Loss: 0.202 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6799483299255371
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6894221305847168
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.942 Test Loss: 0.185 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 332644
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.25431489944458
Epoch: 1, Steps: 9 | Train Loss: 1.396 Vali Loss: 1.366 Vali Acc: 0.391 Test Loss: 1.366 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 0.7389326095581055
Epoch: 2, Steps: 9 | Train Loss: 1.315 Vali Loss: 1.310 Vali Acc: 0.536 Test Loss: 1.310 Test Acc: 0.536
Validation loss decreased (-0.391291 --> -0.536219).  Saving model ...
Epoch: 3 cost time: 0.7819914817810059
Epoch: 3, Steps: 9 | Train Loss: 1.209 Vali Loss: 1.217 Vali Acc: 0.667 Test Loss: 1.217 Test Acc: 0.667
Validation loss decreased (-0.536219 --> -0.666654).  Saving model ...
Epoch: 4 cost time: 0.7050108909606934
Epoch: 4, Steps: 9 | Train Loss: 1.090 Vali Loss: 1.100 Vali Acc: 0.732 Test Loss: 1.100 Test Acc: 0.732
Validation loss decreased (-0.666654 --> -0.731873).  Saving model ...
Epoch: 5 cost time: 0.7494466304779053
Epoch: 5, Steps: 9 | Train Loss: 0.942 Vali Loss: 0.964 Vali Acc: 0.790 Test Loss: 0.964 Test Acc: 0.790
Validation loss decreased (-0.731873 --> -0.789845).  Saving model ...
Epoch: 6 cost time: 0.7710566520690918
Epoch: 6, Steps: 9 | Train Loss: 0.803 Vali Loss: 0.816 Vali Acc: 0.812 Test Loss: 0.816 Test Acc: 0.812
Validation loss decreased (-0.789845 --> -0.811586).  Saving model ...
Epoch: 7 cost time: 0.6905214786529541
Epoch: 7, Steps: 9 | Train Loss: 0.656 Vali Loss: 0.699 Vali Acc: 0.833 Test Loss: 0.699 Test Acc: 0.833
Validation loss decreased (-0.811586 --> -0.833326).  Saving model ...
Epoch: 8 cost time: 0.7777845859527588
Epoch: 8, Steps: 9 | Train Loss: 0.520 Vali Loss: 0.578 Vali Acc: 0.877 Test Loss: 0.578 Test Acc: 0.877
Validation loss decreased (-0.833326 --> -0.876806).  Saving model ...
Epoch: 9 cost time: 0.8020257949829102
Epoch: 9, Steps: 9 | Train Loss: 0.399 Vali Loss: 0.486 Vali Acc: 0.913 Test Loss: 0.486 Test Acc: 0.913
Validation loss decreased (-0.876806 --> -0.913039).  Saving model ...
Epoch: 10 cost time: 0.6884932518005371
Epoch: 10, Steps: 9 | Train Loss: 0.312 Vali Loss: 0.413 Vali Acc: 0.913 Test Loss: 0.413 Test Acc: 0.913
Validation loss decreased (-0.913039 --> -0.913039).  Saving model ...
Epoch: 11 cost time: 0.6903400421142578
Epoch: 11, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.361 Vali Acc: 0.920 Test Loss: 0.361 Test Acc: 0.920
Validation loss decreased (-0.913039 --> -0.920286).  Saving model ...
Epoch: 12 cost time: 0.7177784442901611
Epoch: 12, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.322 Vali Acc: 0.920 Test Loss: 0.322 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920287).  Saving model ...
Epoch: 13 cost time: 0.7456080913543701
Epoch: 13, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.283 Vali Acc: 0.928 Test Loss: 0.283 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927533).  Saving model ...
Epoch: 14 cost time: 0.7023756504058838
Epoch: 14, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.268 Vali Acc: 0.935 Test Loss: 0.268 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934780).  Saving model ...
Epoch: 15 cost time: 0.6668779850006104
Epoch: 15, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.257 Vali Acc: 0.942 Test Loss: 0.257 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942026).  Saving model ...
Epoch: 16 cost time: 0.6782639026641846
Epoch: 16, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.240 Vali Acc: 0.942 Test Loss: 0.240 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 17 cost time: 0.6915426254272461
Epoch: 17, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.234 Vali Acc: 0.942 Test Loss: 0.234 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 18 cost time: 0.6994554996490479
Epoch: 18, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.229 Vali Acc: 0.942 Test Loss: 0.229 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 19 cost time: 0.7603275775909424
Epoch: 19, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.217 Vali Acc: 0.942 Test Loss: 0.217 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 20 cost time: 0.7127933502197266
Epoch: 20, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.216 Vali Acc: 0.942 Test Loss: 0.216 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 21 cost time: 0.7345266342163086
Epoch: 21, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.210 Vali Acc: 0.942 Test Loss: 0.210 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 22 cost time: 0.7184014320373535
Epoch: 22, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.208 Vali Acc: 0.942 Test Loss: 0.208 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 23 cost time: 0.7295253276824951
Epoch: 23, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.213 Vali Acc: 0.935 Test Loss: 0.213 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7123422622680664
Epoch: 24, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.214 Vali Acc: 0.935 Test Loss: 0.214 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7861473560333252
Epoch: 25, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7545931339263916
Epoch: 26, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6909711360931396
Epoch: 27, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.191 Vali Acc: 0.942 Test Loss: 0.191 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 28 cost time: 0.7111101150512695
Epoch: 28, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.194 Vali Acc: 0.935 Test Loss: 0.194 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7679920196533203
Epoch: 29, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7528624534606934
Epoch: 30, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.224 Vali Acc: 0.935 Test Loss: 0.224 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7744021415710449
Epoch: 31, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.232 Vali Acc: 0.928 Test Loss: 0.232 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7173635959625244
Epoch: 32, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.191 Vali Acc: 0.935 Test Loss: 0.191 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7289958000183105
Epoch: 33, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.179 Vali Acc: 0.942 Test Loss: 0.179 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 34 cost time: 0.8015487194061279
Epoch: 34, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.183 Vali Acc: 0.935 Test Loss: 0.183 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7391617298126221
Epoch: 35, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.187 Vali Acc: 0.942 Test Loss: 0.187 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7519760131835938
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.942 Test Loss: 0.185 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8024992942810059
Epoch: 37, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.191 Vali Acc: 0.935 Test Loss: 0.191 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7842459678649902
Epoch: 38, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.7809934616088867
Epoch: 39, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.176 Vali Acc: 0.942 Test Loss: 0.176 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 40 cost time: 0.7130775451660156
Epoch: 40, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.165 Vali Acc: 0.935 Test Loss: 0.165 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6963012218475342
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.942 Test Loss: 0.169 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 42 cost time: 0.7712557315826416
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.942 Test Loss: 0.176 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6966276168823242
Epoch: 43, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.181 Vali Acc: 0.935 Test Loss: 0.181 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6976802349090576
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.935 Test Loss: 0.191 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7278773784637451
Epoch: 45, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.184 Vali Acc: 0.935 Test Loss: 0.184 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6802577972412109
Epoch: 46, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.942 Test Loss: 0.188 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.7147414684295654
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.942 Test Loss: 0.174 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.7663185596466064
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.942 Test Loss: 0.180 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.7637550830841064
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.942 Test Loss: 0.189 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.7957956790924072
Epoch: 50, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.942 Test Loss: 0.186 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 320516
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.085829257965088
Epoch: 1, Steps: 9 | Train Loss: 1.416 Vali Loss: 1.398 Vali Acc: 0.232 Test Loss: 1.398 Test Acc: 0.232
Validation loss decreased (inf --> -0.231870).  Saving model ...
Epoch: 2 cost time: 0.8243746757507324
Epoch: 2, Steps: 9 | Train Loss: 1.341 Vali Loss: 1.359 Vali Acc: 0.297 Test Loss: 1.359 Test Acc: 0.297
Validation loss decreased (-0.231870 --> -0.297088).  Saving model ...
Epoch: 3 cost time: 0.8000712394714355
Epoch: 3, Steps: 9 | Train Loss: 1.259 Vali Loss: 1.281 Vali Acc: 0.478 Test Loss: 1.281 Test Acc: 0.478
Validation loss decreased (-0.297088 --> -0.478248).  Saving model ...
Epoch: 4 cost time: 0.6969232559204102
Epoch: 4, Steps: 9 | Train Loss: 1.147 Vali Loss: 1.187 Vali Acc: 0.659 Test Loss: 1.187 Test Acc: 0.659
Validation loss decreased (-0.478248 --> -0.659408).  Saving model ...
Epoch: 5 cost time: 0.758580207824707
Epoch: 5, Steps: 9 | Train Loss: 1.036 Vali Loss: 1.078 Vali Acc: 0.732 Test Loss: 1.078 Test Acc: 0.732
Validation loss decreased (-0.659408 --> -0.731873).  Saving model ...
Epoch: 6 cost time: 0.7550606727600098
Epoch: 6, Steps: 9 | Train Loss: 0.907 Vali Loss: 0.963 Vali Acc: 0.754 Test Loss: 0.963 Test Acc: 0.754
Validation loss decreased (-0.731873 --> -0.753614).  Saving model ...
Epoch: 7 cost time: 0.7546899318695068
Epoch: 7, Steps: 9 | Train Loss: 0.755 Vali Loss: 0.844 Vali Acc: 0.739 Test Loss: 0.844 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8138551712036133
Epoch: 8, Steps: 9 | Train Loss: 0.625 Vali Loss: 0.736 Vali Acc: 0.783 Test Loss: 0.736 Test Acc: 0.783
Validation loss decreased (-0.753614 --> -0.782601).  Saving model ...
Epoch: 9 cost time: 0.7564630508422852
Epoch: 9, Steps: 9 | Train Loss: 0.528 Vali Loss: 0.639 Vali Acc: 0.841 Test Loss: 0.639 Test Acc: 0.841
Validation loss decreased (-0.782601 --> -0.840573).  Saving model ...
Epoch: 10 cost time: 0.6649899482727051
Epoch: 10, Steps: 9 | Train Loss: 0.400 Vali Loss: 0.563 Vali Acc: 0.862 Test Loss: 0.563 Test Acc: 0.862
Validation loss decreased (-0.840573 --> -0.862313).  Saving model ...
Epoch: 11 cost time: 0.7340116500854492
Epoch: 11, Steps: 9 | Train Loss: 0.326 Vali Loss: 0.495 Vali Acc: 0.870 Test Loss: 0.495 Test Acc: 0.870
Validation loss decreased (-0.862313 --> -0.869560).  Saving model ...
Epoch: 12 cost time: 0.783043622970581
Epoch: 12, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.448 Vali Acc: 0.877 Test Loss: 0.448 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876807).  Saving model ...
Epoch: 13 cost time: 0.7350244522094727
Epoch: 13, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.408 Vali Acc: 0.884 Test Loss: 0.408 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 14 cost time: 0.8090782165527344
Epoch: 14, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.381 Vali Acc: 0.884 Test Loss: 0.381 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 15 cost time: 0.7082164287567139
Epoch: 15, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.357 Vali Acc: 0.899 Test Loss: 0.357 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 16 cost time: 0.7558307647705078
Epoch: 16, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.344 Vali Acc: 0.906 Test Loss: 0.344 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 17 cost time: 0.7294096946716309
Epoch: 17, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.337 Vali Acc: 0.899 Test Loss: 0.337 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7386395931243896
Epoch: 18, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.327 Vali Acc: 0.899 Test Loss: 0.327 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7265627384185791
Epoch: 19, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.297 Vali Acc: 0.906 Test Loss: 0.297 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 20 cost time: 0.7372245788574219
Epoch: 20, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.298 Vali Acc: 0.913 Test Loss: 0.298 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 21 cost time: 0.790252685546875
Epoch: 21, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.310 Vali Acc: 0.913 Test Loss: 0.310 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7283389568328857
Epoch: 22, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.313 Vali Acc: 0.899 Test Loss: 0.313 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7889387607574463
Epoch: 23, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.278 Vali Acc: 0.928 Test Loss: 0.278 Test Acc: 0.928
Validation loss decreased (-0.913041 --> -0.927533).  Saving model ...
Epoch: 24 cost time: 0.8273482322692871
Epoch: 24, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.273 Vali Acc: 0.920 Test Loss: 0.273 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7615201473236084
Epoch: 25, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.273 Vali Acc: 0.920 Test Loss: 0.273 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7031781673431396
Epoch: 26, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.283 Vali Acc: 0.928 Test Loss: 0.283 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7903010845184326
Epoch: 27, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.280 Vali Acc: 0.928 Test Loss: 0.280 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7998533248901367
Epoch: 28, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.280 Vali Acc: 0.920 Test Loss: 0.280 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8220298290252686
Epoch: 29, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.279 Vali Acc: 0.920 Test Loss: 0.279 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8036375045776367
Epoch: 30, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.289 Vali Acc: 0.913 Test Loss: 0.289 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8011033535003662
Epoch: 31, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.271 Vali Acc: 0.913 Test Loss: 0.271 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7569165229797363
Epoch: 32, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.263 Vali Acc: 0.920 Test Loss: 0.263 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7574863433837891
Epoch: 33, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.271 Vali Acc: 0.913 Test Loss: 0.271 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 317604
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1339550018310547
Epoch: 1, Steps: 9 | Train Loss: 1.440 Vali Loss: 1.401 Vali Acc: 0.232 Test Loss: 1.401 Test Acc: 0.232
Validation loss decreased (inf --> -0.231870).  Saving model ...
Epoch: 2 cost time: 0.8476400375366211
Epoch: 2, Steps: 9 | Train Loss: 1.394 Vali Loss: 1.375 Vali Acc: 0.239 Test Loss: 1.375 Test Acc: 0.239
Validation loss decreased (-0.231870 --> -0.239117).  Saving model ...
Epoch: 3 cost time: 0.7837560176849365
Epoch: 3, Steps: 9 | Train Loss: 1.329 Vali Loss: 1.322 Vali Acc: 0.312 Test Loss: 1.322 Test Acc: 0.312
Validation loss decreased (-0.239117 --> -0.311581).  Saving model ...
Epoch: 4 cost time: 0.7730567455291748
Epoch: 4, Steps: 9 | Train Loss: 1.250 Vali Loss: 1.252 Vali Acc: 0.522 Test Loss: 1.252 Test Acc: 0.522
Validation loss decreased (-0.311581 --> -0.521727).  Saving model ...
Epoch: 5 cost time: 0.7550806999206543
Epoch: 5, Steps: 9 | Train Loss: 1.128 Vali Loss: 1.175 Vali Acc: 0.609 Test Loss: 1.175 Test Acc: 0.609
Validation loss decreased (-0.521727 --> -0.608684).  Saving model ...
Epoch: 6 cost time: 0.7272851467132568
Epoch: 6, Steps: 9 | Train Loss: 1.049 Vali Loss: 1.082 Vali Acc: 0.710 Test Loss: 1.082 Test Acc: 0.710
Validation loss decreased (-0.608684 --> -0.710134).  Saving model ...
Epoch: 7 cost time: 0.7575893402099609
Epoch: 7, Steps: 9 | Train Loss: 0.926 Vali Loss: 0.985 Vali Acc: 0.725 Test Loss: 0.985 Test Acc: 0.725
Validation loss decreased (-0.710134 --> -0.724628).  Saving model ...
Epoch: 8 cost time: 0.7833003997802734
Epoch: 8, Steps: 9 | Train Loss: 0.822 Vali Loss: 0.891 Vali Acc: 0.739 Test Loss: 0.891 Test Acc: 0.739
Validation loss decreased (-0.724628 --> -0.739122).  Saving model ...
Epoch: 9 cost time: 0.778435230255127
Epoch: 9, Steps: 9 | Train Loss: 0.700 Vali Loss: 0.807 Vali Acc: 0.739 Test Loss: 0.807 Test Acc: 0.739
Validation loss decreased (-0.739122 --> -0.739122).  Saving model ...
Epoch: 10 cost time: 0.771899938583374
Epoch: 10, Steps: 9 | Train Loss: 0.591 Vali Loss: 0.729 Vali Acc: 0.739 Test Loss: 0.729 Test Acc: 0.739
Validation loss decreased (-0.739122 --> -0.739123).  Saving model ...
Epoch: 11 cost time: 0.742081880569458
Epoch: 11, Steps: 9 | Train Loss: 0.497 Vali Loss: 0.650 Vali Acc: 0.746 Test Loss: 0.650 Test Acc: 0.746
Validation loss decreased (-0.739123 --> -0.746370).  Saving model ...
Epoch: 12 cost time: 0.7524368762969971
Epoch: 12, Steps: 9 | Train Loss: 0.439 Vali Loss: 0.583 Vali Acc: 0.804 Test Loss: 0.583 Test Acc: 0.804
Validation loss decreased (-0.746370 --> -0.804342).  Saving model ...
Epoch: 13 cost time: 0.7283036708831787
Epoch: 13, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.532 Vali Acc: 0.833 Test Loss: 0.532 Test Acc: 0.833
Validation loss decreased (-0.804342 --> -0.833328).  Saving model ...
Epoch: 14 cost time: 0.7480759620666504
Epoch: 14, Steps: 9 | Train Loss: 0.294 Vali Loss: 0.483 Vali Acc: 0.862 Test Loss: 0.483 Test Acc: 0.862
Validation loss decreased (-0.833328 --> -0.862314).  Saving model ...
Epoch: 15 cost time: 0.7238385677337646
Epoch: 15, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.459 Vali Acc: 0.862 Test Loss: 0.459 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 16 cost time: 0.7623801231384277
Epoch: 16, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.425 Vali Acc: 0.862 Test Loss: 0.425 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 17 cost time: 0.7877633571624756
Epoch: 17, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.411 Vali Acc: 0.870 Test Loss: 0.411 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 18 cost time: 0.7059636116027832
Epoch: 18, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.381 Vali Acc: 0.877 Test Loss: 0.381 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 19 cost time: 0.7391314506530762
Epoch: 19, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.376 Vali Acc: 0.855 Test Loss: 0.376 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7107236385345459
Epoch: 20, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.365 Vali Acc: 0.870 Test Loss: 0.365 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.729680061340332
Epoch: 21, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.353 Vali Acc: 0.884 Test Loss: 0.353 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 22 cost time: 0.7846758365631104
Epoch: 22, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.345 Vali Acc: 0.877 Test Loss: 0.345 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7672386169433594
Epoch: 23, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.356 Vali Acc: 0.877 Test Loss: 0.356 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7687630653381348
Epoch: 24, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.355 Vali Acc: 0.877 Test Loss: 0.355 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7249910831451416
Epoch: 25, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.343 Vali Acc: 0.877 Test Loss: 0.343 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7309107780456543
Epoch: 26, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.334 Vali Acc: 0.884 Test Loss: 0.334 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884055).  Saving model ...
Epoch: 27 cost time: 0.7520902156829834
Epoch: 27, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.330 Vali Acc: 0.891 Test Loss: 0.330 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 28 cost time: 0.7521176338195801
Epoch: 28, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.343 Vali Acc: 0.891 Test Loss: 0.343 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7237465381622314
Epoch: 29, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.343 Vali Acc: 0.884 Test Loss: 0.343 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7805078029632568
Epoch: 30, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.347 Vali Acc: 0.891 Test Loss: 0.347 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7477807998657227
Epoch: 31, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.342 Vali Acc: 0.891 Test Loss: 0.342 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6720869541168213
Epoch: 32, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.331 Vali Acc: 0.899 Test Loss: 0.331 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 33 cost time: 0.8272411823272705
Epoch: 33, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.327 Vali Acc: 0.891 Test Loss: 0.327 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7788515090942383
Epoch: 34, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.329 Vali Acc: 0.899 Test Loss: 0.329 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 35 cost time: 0.7405593395233154
Epoch: 35, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.338 Vali Acc: 0.899 Test Loss: 0.338 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8052618503570557
Epoch: 36, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.347 Vali Acc: 0.899 Test Loss: 0.347 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8601784706115723
Epoch: 37, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.344 Vali Acc: 0.891 Test Loss: 0.344 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7531096935272217
Epoch: 38, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.339 Vali Acc: 0.899 Test Loss: 0.339 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7662715911865234
Epoch: 39, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.340 Vali Acc: 0.891 Test Loss: 0.340 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7391355037689209
Epoch: 40, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.344 Vali Acc: 0.891 Test Loss: 0.344 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7713191509246826
Epoch: 41, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.356 Vali Acc: 0.884 Test Loss: 0.356 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.774505615234375
Epoch: 42, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.341 Vali Acc: 0.899 Test Loss: 0.341 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7219314575195312
Epoch: 43, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.332 Vali Acc: 0.906 Test Loss: 0.332 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 44 cost time: 0.7572927474975586
Epoch: 44, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.330 Vali Acc: 0.899 Test Loss: 0.330 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7436103820800781
Epoch: 45, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.332 Vali Acc: 0.899 Test Loss: 0.332 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.789292573928833
Epoch: 46, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.333 Vali Acc: 0.899 Test Loss: 0.333 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.7277524471282959
Epoch: 47, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.336 Vali Acc: 0.899 Test Loss: 0.336 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.7894554138183594
Epoch: 48, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.327 Vali Acc: 0.899 Test Loss: 0.327 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.7429976463317871
Epoch: 49, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.331 Vali Acc: 0.891 Test Loss: 0.331 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.767730712890625
Epoch: 50, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.336 Vali Acc: 0.891 Test Loss: 0.336 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 314692
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0988385677337646
Epoch: 1, Steps: 9 | Train Loss: 1.399 Vali Loss: 1.385 Vali Acc: 0.312 Test Loss: 1.385 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 0.6990225315093994
Epoch: 2, Steps: 9 | Train Loss: 1.357 Vali Loss: 1.356 Vali Acc: 0.319 Test Loss: 1.356 Test Acc: 0.319
Validation loss decreased (-0.311580 --> -0.318827).  Saving model ...
Epoch: 3 cost time: 0.7727835178375244
Epoch: 3, Steps: 9 | Train Loss: 1.302 Vali Loss: 1.306 Vali Acc: 0.370 Test Loss: 1.306 Test Acc: 0.370
Validation loss decreased (-0.318827 --> -0.369552).  Saving model ...
Epoch: 4 cost time: 0.6631250381469727
Epoch: 4, Steps: 9 | Train Loss: 1.240 Vali Loss: 1.245 Vali Acc: 0.478 Test Loss: 1.245 Test Acc: 0.478
Validation loss decreased (-0.369552 --> -0.478248).  Saving model ...
Epoch: 5 cost time: 0.7185993194580078
Epoch: 5, Steps: 9 | Train Loss: 1.162 Vali Loss: 1.177 Vali Acc: 0.565 Test Loss: 1.177 Test Acc: 0.565
Validation loss decreased (-0.478248 --> -0.565206).  Saving model ...
Epoch: 6 cost time: 0.6695525646209717
Epoch: 6, Steps: 9 | Train Loss: 1.066 Vali Loss: 1.111 Vali Acc: 0.688 Test Loss: 1.111 Test Acc: 0.688
Validation loss decreased (-0.565206 --> -0.688395).  Saving model ...
Epoch: 7 cost time: 0.7018077373504639
Epoch: 7, Steps: 9 | Train Loss: 0.992 Vali Loss: 1.035 Vali Acc: 0.725 Test Loss: 1.035 Test Acc: 0.725
Validation loss decreased (-0.688395 --> -0.724627).  Saving model ...
Epoch: 8 cost time: 0.7071597576141357
Epoch: 8, Steps: 9 | Train Loss: 0.901 Vali Loss: 0.961 Vali Acc: 0.710 Test Loss: 0.961 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6738166809082031
Epoch: 9, Steps: 9 | Train Loss: 0.817 Vali Loss: 0.885 Vali Acc: 0.732 Test Loss: 0.885 Test Acc: 0.732
Validation loss decreased (-0.724627 --> -0.731875).  Saving model ...
Epoch: 10 cost time: 0.6992411613464355
Epoch: 10, Steps: 9 | Train Loss: 0.716 Vali Loss: 0.817 Vali Acc: 0.761 Test Loss: 0.817 Test Acc: 0.761
Validation loss decreased (-0.731875 --> -0.760861).  Saving model ...
Epoch: 11 cost time: 0.6679379940032959
Epoch: 11, Steps: 9 | Train Loss: 0.634 Vali Loss: 0.750 Vali Acc: 0.775 Test Loss: 0.750 Test Acc: 0.775
Validation loss decreased (-0.760861 --> -0.775355).  Saving model ...
Epoch: 12 cost time: 0.6776185035705566
Epoch: 12, Steps: 9 | Train Loss: 0.551 Vali Loss: 0.692 Vali Acc: 0.775 Test Loss: 0.692 Test Acc: 0.775
Validation loss decreased (-0.775355 --> -0.775355).  Saving model ...
Epoch: 13 cost time: 0.7146682739257812
Epoch: 13, Steps: 9 | Train Loss: 0.485 Vali Loss: 0.639 Vali Acc: 0.775 Test Loss: 0.639 Test Acc: 0.775
Validation loss decreased (-0.775355 --> -0.775356).  Saving model ...
Epoch: 14 cost time: 0.7037649154663086
Epoch: 14, Steps: 9 | Train Loss: 0.420 Vali Loss: 0.591 Vali Acc: 0.797 Test Loss: 0.591 Test Acc: 0.797
Validation loss decreased (-0.775356 --> -0.797096).  Saving model ...
Epoch: 15 cost time: 0.7239344120025635
Epoch: 15, Steps: 9 | Train Loss: 0.354 Vali Loss: 0.558 Vali Acc: 0.812 Test Loss: 0.558 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811589).  Saving model ...
Epoch: 16 cost time: 0.6828670501708984
Epoch: 16, Steps: 9 | Train Loss: 0.325 Vali Loss: 0.538 Vali Acc: 0.804 Test Loss: 0.538 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7022626399993896
Epoch: 17, Steps: 9 | Train Loss: 0.275 Vali Loss: 0.502 Vali Acc: 0.804 Test Loss: 0.502 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7941944599151611
Epoch: 18, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.485 Vali Acc: 0.812 Test Loss: 0.485 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 19 cost time: 0.6949963569641113
Epoch: 19, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.462 Vali Acc: 0.812 Test Loss: 0.462 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811590).  Saving model ...
Epoch: 20 cost time: 0.7511186599731445
Epoch: 20, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.446 Vali Acc: 0.826 Test Loss: 0.446 Test Acc: 0.826
Validation loss decreased (-0.811590 --> -0.826083).  Saving model ...
Epoch: 21 cost time: 0.6883976459503174
Epoch: 21, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.444 Vali Acc: 0.826 Test Loss: 0.444 Test Acc: 0.826
Validation loss decreased (-0.826083 --> -0.826083).  Saving model ...
Epoch: 22 cost time: 0.6814322471618652
Epoch: 22, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.449 Vali Acc: 0.819 Test Loss: 0.449 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7129509449005127
Epoch: 23, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.427 Vali Acc: 0.826 Test Loss: 0.427 Test Acc: 0.826
Validation loss decreased (-0.826083 --> -0.826083).  Saving model ...
Epoch: 24 cost time: 0.774174690246582
Epoch: 24, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.410 Vali Acc: 0.833 Test Loss: 0.410 Test Acc: 0.833
Validation loss decreased (-0.826083 --> -0.833329).  Saving model ...
Epoch: 25 cost time: 0.7732994556427002
Epoch: 25, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.408 Vali Acc: 0.848 Test Loss: 0.408 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 26 cost time: 0.7088611125946045
Epoch: 26, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.407 Vali Acc: 0.841 Test Loss: 0.407 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.716510534286499
Epoch: 27, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.412 Vali Acc: 0.833 Test Loss: 0.412 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7335615158081055
Epoch: 28, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.405 Vali Acc: 0.841 Test Loss: 0.405 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6925456523895264
Epoch: 29, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.405 Vali Acc: 0.848 Test Loss: 0.405 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 30 cost time: 0.7174179553985596
Epoch: 30, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.416 Vali Acc: 0.833 Test Loss: 0.416 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7852866649627686
Epoch: 31, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.408 Vali Acc: 0.833 Test Loss: 0.408 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7068684101104736
Epoch: 32, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.404 Vali Acc: 0.848 Test Loss: 0.404 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 33 cost time: 0.7251641750335693
Epoch: 33, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.422 Vali Acc: 0.826 Test Loss: 0.422 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7174184322357178
Epoch: 34, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.409 Vali Acc: 0.848 Test Loss: 0.409 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.676999568939209
Epoch: 35, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.391 Vali Acc: 0.862 Test Loss: 0.391 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 36 cost time: 0.663240909576416
Epoch: 36, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.390 Vali Acc: 0.862 Test Loss: 0.390 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 37 cost time: 0.6865675449371338
Epoch: 37, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.395 Vali Acc: 0.862 Test Loss: 0.395 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6823132038116455
Epoch: 38, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.419 Vali Acc: 0.833 Test Loss: 0.419 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6650094985961914
Epoch: 39, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.423 Vali Acc: 0.841 Test Loss: 0.423 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6925506591796875
Epoch: 40, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.414 Vali Acc: 0.855 Test Loss: 0.414 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7027606964111328
Epoch: 41, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.444 Vali Acc: 0.848 Test Loss: 0.444 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6948459148406982
Epoch: 42, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.425 Vali Acc: 0.855 Test Loss: 0.425 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.7254042625427246
Epoch: 43, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.404 Vali Acc: 0.862 Test Loss: 0.404 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6614866256713867
Epoch: 44, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.372 Vali Acc: 0.862 Test Loss: 0.372 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 45 cost time: 0.674778938293457
Epoch: 45, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.363 Vali Acc: 0.870 Test Loss: 0.363 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 46 cost time: 0.7294902801513672
Epoch: 46, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.394 Vali Acc: 0.862 Test Loss: 0.394 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7121593952178955
Epoch: 47, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.409 Vali Acc: 0.862 Test Loss: 0.409 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7724404335021973
Epoch: 48, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.431 Vali Acc: 0.855 Test Loss: 0.431 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.6811830997467041
Epoch: 49, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.459 Vali Acc: 0.848 Test Loss: 0.459 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.6987051963806152
Epoch: 50, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.447 Vali Acc: 0.862 Test Loss: 0.447 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 311940
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0398409366607666
Epoch: 1, Steps: 9 | Train Loss: 1.428 Vali Loss: 1.389 Vali Acc: 0.210 Test Loss: 1.389 Test Acc: 0.210
Validation loss decreased (inf --> -0.210131).  Saving model ...
Epoch: 2 cost time: 0.7034008502960205
Epoch: 2, Steps: 9 | Train Loss: 1.395 Vali Loss: 1.370 Vali Acc: 0.232 Test Loss: 1.370 Test Acc: 0.232
Validation loss decreased (-0.210131 --> -0.231870).  Saving model ...
Epoch: 3 cost time: 0.6671128273010254
Epoch: 3, Steps: 9 | Train Loss: 1.322 Vali Loss: 1.330 Vali Acc: 0.304 Test Loss: 1.330 Test Acc: 0.304
Validation loss decreased (-0.231870 --> -0.304335).  Saving model ...
Epoch: 4 cost time: 0.6876428127288818
Epoch: 4, Steps: 9 | Train Loss: 1.254 Vali Loss: 1.275 Vali Acc: 0.399 Test Loss: 1.275 Test Acc: 0.399
Validation loss decreased (-0.304335 --> -0.398538).  Saving model ...
Epoch: 5 cost time: 0.7735822200775146
Epoch: 5, Steps: 9 | Train Loss: 1.175 Vali Loss: 1.215 Vali Acc: 0.522 Test Loss: 1.215 Test Acc: 0.522
Validation loss decreased (-0.398538 --> -0.521727).  Saving model ...
Epoch: 6 cost time: 0.6949903964996338
Epoch: 6, Steps: 9 | Train Loss: 1.101 Vali Loss: 1.150 Vali Acc: 0.630 Test Loss: 1.150 Test Acc: 0.630
Validation loss decreased (-0.521727 --> -0.630423).  Saving model ...
Epoch: 7 cost time: 0.7030580043792725
Epoch: 7, Steps: 9 | Train Loss: 1.013 Vali Loss: 1.082 Vali Acc: 0.696 Test Loss: 1.082 Test Acc: 0.696
Validation loss decreased (-0.630423 --> -0.695641).  Saving model ...
Epoch: 8 cost time: 0.6940131187438965
Epoch: 8, Steps: 9 | Train Loss: 0.929 Vali Loss: 1.002 Vali Acc: 0.710 Test Loss: 1.002 Test Acc: 0.710
Validation loss decreased (-0.695641 --> -0.710135).  Saving model ...
Epoch: 9 cost time: 0.7883105278015137
Epoch: 9, Steps: 9 | Train Loss: 0.845 Vali Loss: 0.931 Vali Acc: 0.761 Test Loss: 0.931 Test Acc: 0.761
Validation loss decreased (-0.710135 --> -0.760860).  Saving model ...
Epoch: 10 cost time: 0.6316509246826172
Epoch: 10, Steps: 9 | Train Loss: 0.724 Vali Loss: 0.857 Vali Acc: 0.783 Test Loss: 0.857 Test Acc: 0.783
Validation loss decreased (-0.760860 --> -0.782600).  Saving model ...
Epoch: 11 cost time: 0.712104082107544
Epoch: 11, Steps: 9 | Train Loss: 0.666 Vali Loss: 0.787 Vali Acc: 0.790 Test Loss: 0.787 Test Acc: 0.790
Validation loss decreased (-0.782600 --> -0.789847).  Saving model ...
Epoch: 12 cost time: 0.7108526229858398
Epoch: 12, Steps: 9 | Train Loss: 0.577 Vali Loss: 0.727 Vali Acc: 0.783 Test Loss: 0.727 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7066545486450195
Epoch: 13, Steps: 9 | Train Loss: 0.487 Vali Loss: 0.680 Vali Acc: 0.790 Test Loss: 0.680 Test Acc: 0.790
Validation loss decreased (-0.789847 --> -0.789848).  Saving model ...
Epoch: 14 cost time: 0.6925904750823975
Epoch: 14, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.646 Vali Acc: 0.804 Test Loss: 0.646 Test Acc: 0.804
Validation loss decreased (-0.789848 --> -0.804341).  Saving model ...
Epoch: 15 cost time: 0.6535508632659912
Epoch: 15, Steps: 9 | Train Loss: 0.377 Vali Loss: 0.607 Vali Acc: 0.797 Test Loss: 0.607 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6467833518981934
Epoch: 16, Steps: 9 | Train Loss: 0.318 Vali Loss: 0.569 Vali Acc: 0.812 Test Loss: 0.569 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811589).  Saving model ...
Epoch: 17 cost time: 0.7126767635345459
Epoch: 17, Steps: 9 | Train Loss: 0.275 Vali Loss: 0.547 Vali Acc: 0.804 Test Loss: 0.547 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7055718898773193
Epoch: 18, Steps: 9 | Train Loss: 0.258 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6250085830688477
Epoch: 19, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.525 Vali Acc: 0.797 Test Loss: 0.525 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.633202314376831
Epoch: 20, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.503 Vali Acc: 0.804 Test Loss: 0.503 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6567413806915283
Epoch: 21, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.480 Vali Acc: 0.819 Test Loss: 0.480 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 22 cost time: 0.5980219841003418
Epoch: 22, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.464 Vali Acc: 0.819 Test Loss: 0.464 Test Acc: 0.819
Validation loss decreased (-0.818836 --> -0.818836).  Saving model ...
Epoch: 23 cost time: 0.6035985946655273
Epoch: 23, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.450 Vali Acc: 0.812 Test Loss: 0.450 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6943223476409912
Epoch: 24, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.457 Vali Acc: 0.804 Test Loss: 0.457 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7300927639007568
Epoch: 25, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.474 Vali Acc: 0.812 Test Loss: 0.474 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7281999588012695
Epoch: 26, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.466 Vali Acc: 0.812 Test Loss: 0.466 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.739840030670166
Epoch: 27, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.466 Vali Acc: 0.797 Test Loss: 0.466 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6924295425415039
Epoch: 28, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.473 Vali Acc: 0.812 Test Loss: 0.473 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6920242309570312
Epoch: 29, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.487 Vali Acc: 0.812 Test Loss: 0.487 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6965618133544922
Epoch: 30, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.458 Vali Acc: 0.819 Test Loss: 0.458 Test Acc: 0.819
Validation loss decreased (-0.818836 --> -0.818836).  Saving model ...
Epoch: 31 cost time: 0.7586545944213867
Epoch: 31, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.438 Vali Acc: 0.812 Test Loss: 0.438 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7016491889953613
Epoch: 32, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.461 Vali Acc: 0.819 Test Loss: 0.461 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.742631196975708
Epoch: 33, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.484 Vali Acc: 0.804 Test Loss: 0.484 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.836376428604126
Epoch: 34, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.485 Vali Acc: 0.804 Test Loss: 0.485 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7832455635070801
Epoch: 35, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.485 Vali Acc: 0.804 Test Loss: 0.485 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7439591884613037
Epoch: 36, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.482 Vali Acc: 0.804 Test Loss: 0.482 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7538883686065674
Epoch: 37, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.491 Vali Acc: 0.812 Test Loss: 0.491 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7299895286560059
Epoch: 38, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.465 Vali Acc: 0.826 Test Loss: 0.465 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 39 cost time: 0.7068450450897217
Epoch: 39, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.459 Vali Acc: 0.833 Test Loss: 0.459 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 40 cost time: 0.7339076995849609
Epoch: 40, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.470 Vali Acc: 0.848 Test Loss: 0.470 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847821).  Saving model ...
Epoch: 41 cost time: 0.7838840484619141
Epoch: 41, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.502 Vali Acc: 0.826 Test Loss: 0.502 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7060723304748535
Epoch: 42, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.524 Vali Acc: 0.819 Test Loss: 0.524 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7499752044677734
Epoch: 43, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.504 Vali Acc: 0.826 Test Loss: 0.504 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7477288246154785
Epoch: 44, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.526 Vali Acc: 0.812 Test Loss: 0.526 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7123115062713623
Epoch: 45, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.528 Vali Acc: 0.819 Test Loss: 0.528 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.7056732177734375
Epoch: 46, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.520 Vali Acc: 0.812 Test Loss: 0.520 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.6938774585723877
Epoch: 47, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.517 Vali Acc: 0.826 Test Loss: 0.517 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.7628359794616699
Epoch: 48, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.518 Vali Acc: 0.826 Test Loss: 0.518 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.7767667770385742
Epoch: 49, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.494 Vali Acc: 0.833 Test Loss: 0.494 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.7119669914245605
Epoch: 50, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.512 Vali Acc: 0.833 Test Loss: 0.512 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 312292
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.10286283493042
Epoch: 1, Steps: 9 | Train Loss: 1.358 Vali Loss: 1.364 Vali Acc: 0.333 Test Loss: 1.364 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.7570602893829346
Epoch: 2, Steps: 9 | Train Loss: 1.327 Vali Loss: 1.339 Vali Acc: 0.362 Test Loss: 1.339 Test Acc: 0.362
Validation loss decreased (-0.333320 --> -0.362305).  Saving model ...
Epoch: 3 cost time: 0.7152564525604248
Epoch: 3, Steps: 9 | Train Loss: 1.286 Vali Loss: 1.299 Vali Acc: 0.399 Test Loss: 1.299 Test Acc: 0.399
Validation loss decreased (-0.362305 --> -0.398538).  Saving model ...
Epoch: 4 cost time: 0.7849061489105225
Epoch: 4, Steps: 9 | Train Loss: 1.221 Vali Loss: 1.250 Vali Acc: 0.493 Test Loss: 1.250 Test Acc: 0.493
Validation loss decreased (-0.398538 --> -0.492741).  Saving model ...
Epoch: 5 cost time: 0.7491004467010498
Epoch: 5, Steps: 9 | Train Loss: 1.163 Vali Loss: 1.200 Vali Acc: 0.587 Test Loss: 1.200 Test Acc: 0.587
Validation loss decreased (-0.492741 --> -0.586945).  Saving model ...
Epoch: 6 cost time: 0.7728490829467773
Epoch: 6, Steps: 9 | Train Loss: 1.095 Vali Loss: 1.145 Vali Acc: 0.674 Test Loss: 1.145 Test Acc: 0.674
Validation loss decreased (-0.586945 --> -0.673902).  Saving model ...
Epoch: 7 cost time: 0.7980983257293701
Epoch: 7, Steps: 9 | Train Loss: 1.020 Vali Loss: 1.092 Vali Acc: 0.710 Test Loss: 1.092 Test Acc: 0.710
Validation loss decreased (-0.673902 --> -0.710134).  Saving model ...
Epoch: 8 cost time: 0.7429494857788086
Epoch: 8, Steps: 9 | Train Loss: 0.925 Vali Loss: 1.025 Vali Acc: 0.725 Test Loss: 1.025 Test Acc: 0.725
Validation loss decreased (-0.710134 --> -0.724627).  Saving model ...
Epoch: 9 cost time: 0.7405502796173096
Epoch: 9, Steps: 9 | Train Loss: 0.854 Vali Loss: 0.964 Vali Acc: 0.725 Test Loss: 0.964 Test Acc: 0.725
Validation loss decreased (-0.724627 --> -0.724628).  Saving model ...
Epoch: 10 cost time: 0.8427159786224365
Epoch: 10, Steps: 9 | Train Loss: 0.775 Vali Loss: 0.898 Vali Acc: 0.754 Test Loss: 0.898 Test Acc: 0.754
Validation loss decreased (-0.724628 --> -0.753614).  Saving model ...
Epoch: 11 cost time: 0.757915735244751
Epoch: 11, Steps: 9 | Train Loss: 0.684 Vali Loss: 0.841 Vali Acc: 0.768 Test Loss: 0.841 Test Acc: 0.768
Validation loss decreased (-0.753614 --> -0.768108).  Saving model ...
Epoch: 12 cost time: 0.7284188270568848
Epoch: 12, Steps: 9 | Train Loss: 0.611 Vali Loss: 0.788 Vali Acc: 0.754 Test Loss: 0.788 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7347800731658936
Epoch: 13, Steps: 9 | Train Loss: 0.542 Vali Loss: 0.744 Vali Acc: 0.775 Test Loss: 0.744 Test Acc: 0.775
Validation loss decreased (-0.768108 --> -0.775355).  Saving model ...
Epoch: 14 cost time: 0.772479772567749
Epoch: 14, Steps: 9 | Train Loss: 0.485 Vali Loss: 0.699 Vali Acc: 0.783 Test Loss: 0.699 Test Acc: 0.783
Validation loss decreased (-0.775355 --> -0.782602).  Saving model ...
Epoch: 15 cost time: 0.7767269611358643
Epoch: 15, Steps: 9 | Train Loss: 0.431 Vali Loss: 0.671 Vali Acc: 0.790 Test Loss: 0.671 Test Acc: 0.790
Validation loss decreased (-0.782602 --> -0.789848).  Saving model ...
Epoch: 16 cost time: 0.7568564414978027
Epoch: 16, Steps: 9 | Train Loss: 0.377 Vali Loss: 0.634 Vali Acc: 0.797 Test Loss: 0.634 Test Acc: 0.797
Validation loss decreased (-0.789848 --> -0.797095).  Saving model ...
Epoch: 17 cost time: 0.763298511505127
Epoch: 17, Steps: 9 | Train Loss: 0.312 Vali Loss: 0.609 Vali Acc: 0.812 Test Loss: 0.609 Test Acc: 0.812
Validation loss decreased (-0.797095 --> -0.811588).  Saving model ...
Epoch: 18 cost time: 0.8177511692047119
Epoch: 18, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.593 Vali Acc: 0.797 Test Loss: 0.593 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7258293628692627
Epoch: 19, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.564 Vali Acc: 0.812 Test Loss: 0.564 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811589).  Saving model ...
Epoch: 20 cost time: 0.816533088684082
Epoch: 20, Steps: 9 | Train Loss: 0.227 Vali Loss: 0.550 Vali Acc: 0.812 Test Loss: 0.550 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 21 cost time: 0.7312030792236328
Epoch: 21, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.537 Vali Acc: 0.804 Test Loss: 0.537 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7096767425537109
Epoch: 22, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.512 Vali Acc: 0.819 Test Loss: 0.512 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 23 cost time: 0.7080891132354736
Epoch: 23, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.512 Vali Acc: 0.804 Test Loss: 0.512 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6950325965881348
Epoch: 24, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.505 Vali Acc: 0.804 Test Loss: 0.505 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.743983268737793
Epoch: 25, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.511 Vali Acc: 0.804 Test Loss: 0.511 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7491199970245361
Epoch: 26, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.525 Vali Acc: 0.804 Test Loss: 0.525 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7331216335296631
Epoch: 27, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.510 Vali Acc: 0.797 Test Loss: 0.510 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8291740417480469
Epoch: 28, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.504 Vali Acc: 0.812 Test Loss: 0.504 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7710728645324707
Epoch: 29, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.521 Vali Acc: 0.812 Test Loss: 0.521 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7613575458526611
Epoch: 30, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.529 Vali Acc: 0.812 Test Loss: 0.529 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.740516185760498
Epoch: 31, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.561 Vali Acc: 0.797 Test Loss: 0.561 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7036533355712891
Epoch: 32, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.563 Vali Acc: 0.812 Test Loss: 0.563 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 311076
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.039210557937622
Epoch: 1, Steps: 9 | Train Loss: 1.406 Vali Loss: 1.380 Vali Acc: 0.283 Test Loss: 1.380 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 0.7724769115447998
Epoch: 2, Steps: 9 | Train Loss: 1.293 Vali Loss: 1.293 Vali Acc: 0.536 Test Loss: 1.293 Test Acc: 0.536
Validation loss decreased (-0.282595 --> -0.536219).  Saving model ...
Epoch: 3 cost time: 0.7065985202789307
Epoch: 3, Steps: 9 | Train Loss: 1.136 Vali Loss: 1.146 Vali Acc: 0.681 Test Loss: 1.146 Test Acc: 0.681
Validation loss decreased (-0.536219 --> -0.681148).  Saving model ...
Epoch: 4 cost time: 0.7394099235534668
Epoch: 4, Steps: 9 | Train Loss: 0.964 Vali Loss: 0.966 Vali Acc: 0.739 Test Loss: 0.966 Test Acc: 0.739
Validation loss decreased (-0.681148 --> -0.739121).  Saving model ...
Epoch: 5 cost time: 0.6927063465118408
Epoch: 5, Steps: 9 | Train Loss: 0.763 Vali Loss: 0.787 Vali Acc: 0.841 Test Loss: 0.787 Test Acc: 0.841
Validation loss decreased (-0.739121 --> -0.840572).  Saving model ...
Epoch: 6 cost time: 0.7801592350006104
Epoch: 6, Steps: 9 | Train Loss: 0.570 Vali Loss: 0.628 Vali Acc: 0.812 Test Loss: 0.628 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7146403789520264
Epoch: 7, Steps: 9 | Train Loss: 0.407 Vali Loss: 0.468 Vali Acc: 0.906 Test Loss: 0.468 Test Acc: 0.906
Validation loss decreased (-0.840572 --> -0.905792).  Saving model ...
Epoch: 8 cost time: 0.7138574123382568
Epoch: 8, Steps: 9 | Train Loss: 0.289 Vali Loss: 0.365 Vali Acc: 0.913 Test Loss: 0.365 Test Acc: 0.913
Validation loss decreased (-0.905792 --> -0.913040).  Saving model ...
Epoch: 9 cost time: 0.709125280380249
Epoch: 9, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.307 Vali Acc: 0.920 Test Loss: 0.307 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 10 cost time: 0.7013518810272217
Epoch: 10, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.262 Vali Acc: 0.928 Test Loss: 0.262 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 11 cost time: 0.7247250080108643
Epoch: 11, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.252 Vali Acc: 0.935 Test Loss: 0.252 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 12 cost time: 0.7111151218414307
Epoch: 12, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 13 cost time: 0.6935324668884277
Epoch: 13, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.222 Vali Acc: 0.928 Test Loss: 0.222 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6540584564208984
Epoch: 14, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.225 Vali Acc: 0.920 Test Loss: 0.225 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7140688896179199
Epoch: 15, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.223 Vali Acc: 0.920 Test Loss: 0.223 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.716904878616333
Epoch: 16, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.215 Vali Acc: 0.942 Test Loss: 0.215 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 17 cost time: 0.6867623329162598
Epoch: 17, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7033641338348389
Epoch: 18, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.195 Vali Acc: 0.928 Test Loss: 0.195 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6819734573364258
Epoch: 19, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.183 Vali Acc: 0.935 Test Loss: 0.183 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7104496955871582
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.187 Vali Acc: 0.935 Test Loss: 0.187 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6546599864959717
Epoch: 21, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.186 Vali Acc: 0.942 Test Loss: 0.186 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 22 cost time: 0.7075505256652832
Epoch: 22, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.191 Vali Acc: 0.942 Test Loss: 0.191 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7418556213378906
Epoch: 23, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.194 Vali Acc: 0.942 Test Loss: 0.194 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6742184162139893
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.197 Vali Acc: 0.920 Test Loss: 0.197 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7259166240692139
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.202 Vali Acc: 0.920 Test Loss: 0.202 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7328414916992188
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.920 Test Loss: 0.204 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7060141563415527
Epoch: 27, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.194 Vali Acc: 0.935 Test Loss: 0.194 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7078571319580078
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.777031421661377
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.920 Test Loss: 0.204 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7259838581085205
Epoch: 30, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.213 Vali Acc: 0.920 Test Loss: 0.213 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7065582275390625
Epoch: 31, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 329956
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.135904312133789
Epoch: 1, Steps: 9 | Train Loss: 1.418 Vali Loss: 1.392 Vali Acc: 0.246 Test Loss: 1.392 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 0.7411162853240967
Epoch: 2, Steps: 9 | Train Loss: 1.351 Vali Loss: 1.347 Vali Acc: 0.341 Test Loss: 1.347 Test Acc: 0.341
Validation loss decreased (-0.246363 --> -0.340566).  Saving model ...
Epoch: 3 cost time: 0.76894211769104
Epoch: 3, Steps: 9 | Train Loss: 1.252 Vali Loss: 1.260 Vali Acc: 0.674 Test Loss: 1.260 Test Acc: 0.674
Validation loss decreased (-0.340566 --> -0.673900).  Saving model ...
Epoch: 4 cost time: 0.7365522384643555
Epoch: 4, Steps: 9 | Train Loss: 1.131 Vali Loss: 1.143 Vali Acc: 0.746 Test Loss: 1.143 Test Acc: 0.746
Validation loss decreased (-0.673900 --> -0.746365).  Saving model ...
Epoch: 5 cost time: 0.7498557567596436
Epoch: 5, Steps: 9 | Train Loss: 0.985 Vali Loss: 1.010 Vali Acc: 0.790 Test Loss: 1.010 Test Acc: 0.790
Validation loss decreased (-0.746365 --> -0.789845).  Saving model ...
Epoch: 6 cost time: 0.7090742588043213
Epoch: 6, Steps: 9 | Train Loss: 0.840 Vali Loss: 0.877 Vali Acc: 0.783 Test Loss: 0.877 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8286497592926025
Epoch: 7, Steps: 9 | Train Loss: 0.694 Vali Loss: 0.737 Vali Acc: 0.812 Test Loss: 0.737 Test Acc: 0.812
Validation loss decreased (-0.789845 --> -0.811587).  Saving model ...
Epoch: 8 cost time: 0.7095260620117188
Epoch: 8, Steps: 9 | Train Loss: 0.554 Vali Loss: 0.613 Vali Acc: 0.870 Test Loss: 0.613 Test Acc: 0.870
Validation loss decreased (-0.811587 --> -0.869559).  Saving model ...
Epoch: 9 cost time: 0.7047607898712158
Epoch: 9, Steps: 9 | Train Loss: 0.447 Vali Loss: 0.501 Vali Acc: 0.862 Test Loss: 0.501 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6728866100311279
Epoch: 10, Steps: 9 | Train Loss: 0.341 Vali Loss: 0.439 Vali Acc: 0.862 Test Loss: 0.439 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7227997779846191
Epoch: 11, Steps: 9 | Train Loss: 0.250 Vali Loss: 0.388 Vali Acc: 0.870 Test Loss: 0.388 Test Acc: 0.870
Validation loss decreased (-0.869559 --> -0.869561).  Saving model ...
Epoch: 12 cost time: 0.7561275959014893
Epoch: 12, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.331 Vali Acc: 0.899 Test Loss: 0.331 Test Acc: 0.899
Validation loss decreased (-0.869561 --> -0.898547).  Saving model ...
Epoch: 13 cost time: 0.69205641746521
Epoch: 13, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.296 Vali Acc: 0.928 Test Loss: 0.296 Test Acc: 0.928
Validation loss decreased (-0.898547 --> -0.927533).  Saving model ...
Epoch: 14 cost time: 0.7173194885253906
Epoch: 14, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.288 Vali Acc: 0.906 Test Loss: 0.288 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6755862236022949
Epoch: 15, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.275 Vali Acc: 0.906 Test Loss: 0.275 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7077598571777344
Epoch: 16, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.260 Vali Acc: 0.928 Test Loss: 0.260 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927534).  Saving model ...
Epoch: 17 cost time: 0.6810340881347656
Epoch: 17, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.247 Vali Acc: 0.935 Test Loss: 0.247 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 18 cost time: 0.7205979824066162
Epoch: 18, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.242 Vali Acc: 0.920 Test Loss: 0.242 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7676882743835449
Epoch: 19, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.244 Vali Acc: 0.928 Test Loss: 0.244 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7016425132751465
Epoch: 20, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.254 Vali Acc: 0.928 Test Loss: 0.254 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7855675220489502
Epoch: 21, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.249 Vali Acc: 0.920 Test Loss: 0.249 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7918508052825928
Epoch: 22, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.244 Vali Acc: 0.920 Test Loss: 0.244 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7425901889801025
Epoch: 23, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.232 Vali Acc: 0.920 Test Loss: 0.232 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7185139656066895
Epoch: 24, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.240 Vali Acc: 0.920 Test Loss: 0.240 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7580506801605225
Epoch: 25, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.231 Vali Acc: 0.920 Test Loss: 0.231 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7507057189941406
Epoch: 26, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.238 Vali Acc: 0.928 Test Loss: 0.238 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7692995071411133
Epoch: 27, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.240 Vali Acc: 0.928 Test Loss: 0.240 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 317828
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.293560266494751
Epoch: 1, Steps: 9 | Train Loss: 1.358 Vali Loss: 1.352 Vali Acc: 0.326 Test Loss: 1.352 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 0.6969606876373291
Epoch: 2, Steps: 9 | Train Loss: 1.294 Vali Loss: 1.303 Vali Acc: 0.543 Test Loss: 1.303 Test Acc: 0.543
Validation loss decreased (-0.326073 --> -0.543465).  Saving model ...
Epoch: 3 cost time: 0.6931915283203125
Epoch: 3, Steps: 9 | Train Loss: 1.199 Vali Loss: 1.223 Vali Acc: 0.681 Test Loss: 1.223 Test Acc: 0.681
Validation loss decreased (-0.543465 --> -0.681147).  Saving model ...
Epoch: 4 cost time: 0.717609167098999
Epoch: 4, Steps: 9 | Train Loss: 1.114 Vali Loss: 1.126 Vali Acc: 0.768 Test Loss: 1.126 Test Acc: 0.768
Validation loss decreased (-0.681147 --> -0.768105).  Saving model ...
Epoch: 5 cost time: 0.7402365207672119
Epoch: 5, Steps: 9 | Train Loss: 0.994 Vali Loss: 1.015 Vali Acc: 0.775 Test Loss: 1.015 Test Acc: 0.775
Validation loss decreased (-0.768105 --> -0.775352).  Saving model ...
Epoch: 6 cost time: 0.7162859439849854
Epoch: 6, Steps: 9 | Train Loss: 0.862 Vali Loss: 0.905 Vali Acc: 0.775 Test Loss: 0.905 Test Acc: 0.775
Validation loss decreased (-0.775352 --> -0.775353).  Saving model ...
Epoch: 7 cost time: 0.7067527770996094
Epoch: 7, Steps: 9 | Train Loss: 0.730 Vali Loss: 0.798 Vali Acc: 0.790 Test Loss: 0.798 Test Acc: 0.790
Validation loss decreased (-0.775353 --> -0.789847).  Saving model ...
Epoch: 8 cost time: 0.768080472946167
Epoch: 8, Steps: 9 | Train Loss: 0.621 Vali Loss: 0.701 Vali Acc: 0.812 Test Loss: 0.701 Test Acc: 0.812
Validation loss decreased (-0.789847 --> -0.811587).  Saving model ...
Epoch: 9 cost time: 0.7718803882598877
Epoch: 9, Steps: 9 | Train Loss: 0.510 Vali Loss: 0.613 Vali Acc: 0.826 Test Loss: 0.613 Test Acc: 0.826
Validation loss decreased (-0.811587 --> -0.826081).  Saving model ...
Epoch: 10 cost time: 0.7170889377593994
Epoch: 10, Steps: 9 | Train Loss: 0.411 Vali Loss: 0.539 Vali Acc: 0.855 Test Loss: 0.539 Test Acc: 0.855
Validation loss decreased (-0.826081 --> -0.855067).  Saving model ...
Epoch: 11 cost time: 0.7756271362304688
Epoch: 11, Steps: 9 | Train Loss: 0.328 Vali Loss: 0.486 Vali Acc: 0.870 Test Loss: 0.486 Test Acc: 0.870
Validation loss decreased (-0.855067 --> -0.869560).  Saving model ...
Epoch: 12 cost time: 0.7157607078552246
Epoch: 12, Steps: 9 | Train Loss: 0.286 Vali Loss: 0.446 Vali Acc: 0.884 Test Loss: 0.446 Test Acc: 0.884
Validation loss decreased (-0.869560 --> -0.884054).  Saving model ...
Epoch: 13 cost time: 0.6645994186401367
Epoch: 13, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.428 Vali Acc: 0.870 Test Loss: 0.428 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7047336101531982
Epoch: 14, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.386 Vali Acc: 0.899 Test Loss: 0.386 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 15 cost time: 0.7123849391937256
Epoch: 15, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.355 Vali Acc: 0.899 Test Loss: 0.355 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 16 cost time: 0.6854767799377441
Epoch: 16, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.343 Vali Acc: 0.891 Test Loss: 0.343 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7815237045288086
Epoch: 17, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.330 Vali Acc: 0.884 Test Loss: 0.330 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7340881824493408
Epoch: 18, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.305 Vali Acc: 0.899 Test Loss: 0.305 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898548).  Saving model ...
Epoch: 19 cost time: 0.7475192546844482
Epoch: 19, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.306 Vali Acc: 0.891 Test Loss: 0.306 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7942943572998047
Epoch: 20, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.298 Vali Acc: 0.891 Test Loss: 0.298 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7613654136657715
Epoch: 21, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.300 Vali Acc: 0.899 Test Loss: 0.300 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 22 cost time: 0.8116486072540283
Epoch: 22, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.297 Vali Acc: 0.891 Test Loss: 0.297 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.783350944519043
Epoch: 23, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.288 Vali Acc: 0.891 Test Loss: 0.288 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7710425853729248
Epoch: 24, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.269 Vali Acc: 0.899 Test Loss: 0.269 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 25 cost time: 0.8710720539093018
Epoch: 25, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.268 Vali Acc: 0.899 Test Loss: 0.268 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 26 cost time: 0.7953972816467285
Epoch: 26, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.281 Vali Acc: 0.899 Test Loss: 0.281 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8145458698272705
Epoch: 27, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.281 Vali Acc: 0.899 Test Loss: 0.281 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7412691116333008
Epoch: 28, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.283 Vali Acc: 0.891 Test Loss: 0.283 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7169692516326904
Epoch: 29, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.273 Vali Acc: 0.899 Test Loss: 0.273 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7803616523742676
Epoch: 30, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.265 Vali Acc: 0.899 Test Loss: 0.265 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 31 cost time: 0.7968795299530029
Epoch: 31, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.272 Vali Acc: 0.899 Test Loss: 0.272 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7630331516265869
Epoch: 32, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.276 Vali Acc: 0.899 Test Loss: 0.276 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7832489013671875
Epoch: 33, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.278 Vali Acc: 0.899 Test Loss: 0.278 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7963542938232422
Epoch: 34, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.275 Vali Acc: 0.899 Test Loss: 0.275 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.750011682510376
Epoch: 35, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.279 Vali Acc: 0.899 Test Loss: 0.279 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7947988510131836
Epoch: 36, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.268 Vali Acc: 0.899 Test Loss: 0.268 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7267155647277832
Epoch: 37, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.241 Vali Acc: 0.920 Test Loss: 0.241 Test Acc: 0.920
Validation loss decreased (-0.898548 --> -0.920287).  Saving model ...
Epoch: 38 cost time: 0.7059311866760254
Epoch: 38, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.252 Vali Acc: 0.913 Test Loss: 0.252 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8058056831359863
Epoch: 39, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8340740203857422
Epoch: 40, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.258 Vali Acc: 0.899 Test Loss: 0.258 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7820382118225098
Epoch: 41, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7380499839782715
Epoch: 42, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7790927886962891
Epoch: 43, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8419787883758545
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.7359914779663086
Epoch: 45, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.7219126224517822
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.250 Vali Acc: 0.906 Test Loss: 0.250 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.7772252559661865
Epoch: 47, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.259 Vali Acc: 0.906 Test Loss: 0.259 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 314916
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.3504626750946045
Epoch: 1, Steps: 9 | Train Loss: 1.384 Vali Loss: 1.374 Vali Acc: 0.355 Test Loss: 1.374 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 0.8153812885284424
Epoch: 2, Steps: 9 | Train Loss: 1.332 Vali Loss: 1.334 Vali Acc: 0.377 Test Loss: 1.334 Test Acc: 0.377
Validation loss decreased (-0.355059 --> -0.376798).  Saving model ...
Epoch: 3 cost time: 0.8193638324737549
Epoch: 3, Steps: 9 | Train Loss: 1.278 Vali Loss: 1.272 Vali Acc: 0.493 Test Loss: 1.272 Test Acc: 0.493
Validation loss decreased (-0.376798 --> -0.492741).  Saving model ...
Epoch: 4 cost time: 0.7667536735534668
Epoch: 4, Steps: 9 | Train Loss: 1.177 Vali Loss: 1.199 Vali Acc: 0.572 Test Loss: 1.199 Test Acc: 0.572
Validation loss decreased (-0.492741 --> -0.572452).  Saving model ...
Epoch: 5 cost time: 0.7155647277832031
Epoch: 5, Steps: 9 | Train Loss: 1.077 Vali Loss: 1.118 Vali Acc: 0.667 Test Loss: 1.118 Test Acc: 0.667
Validation loss decreased (-0.572452 --> -0.666655).  Saving model ...
Epoch: 6 cost time: 0.7633366584777832
Epoch: 6, Steps: 9 | Train Loss: 0.974 Vali Loss: 1.033 Vali Acc: 0.732 Test Loss: 1.033 Test Acc: 0.732
Validation loss decreased (-0.666655 --> -0.731874).  Saving model ...
Epoch: 7 cost time: 0.8327920436859131
Epoch: 7, Steps: 9 | Train Loss: 0.877 Vali Loss: 0.943 Vali Acc: 0.768 Test Loss: 0.943 Test Acc: 0.768
Validation loss decreased (-0.731874 --> -0.768107).  Saving model ...
Epoch: 8 cost time: 0.7920253276824951
Epoch: 8, Steps: 9 | Train Loss: 0.772 Vali Loss: 0.850 Vali Acc: 0.783 Test Loss: 0.850 Test Acc: 0.783
Validation loss decreased (-0.768107 --> -0.782600).  Saving model ...
Epoch: 9 cost time: 0.7565672397613525
Epoch: 9, Steps: 9 | Train Loss: 0.636 Vali Loss: 0.763 Vali Acc: 0.775 Test Loss: 0.763 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7817225456237793
Epoch: 10, Steps: 9 | Train Loss: 0.553 Vali Loss: 0.686 Vali Acc: 0.797 Test Loss: 0.686 Test Acc: 0.797
Validation loss decreased (-0.782600 --> -0.797095).  Saving model ...
Epoch: 11 cost time: 0.7559518814086914
Epoch: 11, Steps: 9 | Train Loss: 0.473 Vali Loss: 0.611 Vali Acc: 0.812 Test Loss: 0.611 Test Acc: 0.812
Validation loss decreased (-0.797095 --> -0.811588).  Saving model ...
Epoch: 12 cost time: 0.7644751071929932
Epoch: 12, Steps: 9 | Train Loss: 0.373 Vali Loss: 0.555 Vali Acc: 0.848 Test Loss: 0.555 Test Acc: 0.848
Validation loss decreased (-0.811588 --> -0.847821).  Saving model ...
Epoch: 13 cost time: 0.7845263481140137
Epoch: 13, Steps: 9 | Train Loss: 0.307 Vali Loss: 0.517 Vali Acc: 0.848 Test Loss: 0.517 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 14 cost time: 0.7527234554290771
Epoch: 14, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.487 Vali Acc: 0.855 Test Loss: 0.487 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 15 cost time: 0.7320384979248047
Epoch: 15, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.447 Vali Acc: 0.862 Test Loss: 0.447 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 16 cost time: 0.8370587825775146
Epoch: 16, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.414 Vali Acc: 0.884 Test Loss: 0.414 Test Acc: 0.884
Validation loss decreased (-0.862314 --> -0.884054).  Saving model ...
Epoch: 17 cost time: 0.748537540435791
Epoch: 17, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.394 Vali Acc: 0.884 Test Loss: 0.394 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 18 cost time: 0.7601184844970703
Epoch: 18, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.388 Vali Acc: 0.899 Test Loss: 0.388 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 19 cost time: 0.7994906902313232
Epoch: 19, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.375 Vali Acc: 0.899 Test Loss: 0.375 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 20 cost time: 0.7466652393341064
Epoch: 20, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.355 Vali Acc: 0.899 Test Loss: 0.355 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 21 cost time: 0.7706398963928223
Epoch: 21, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.347 Vali Acc: 0.899 Test Loss: 0.347 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 22 cost time: 0.8172433376312256
Epoch: 22, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.355 Vali Acc: 0.891 Test Loss: 0.355 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.840386152267456
Epoch: 23, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.345 Vali Acc: 0.906 Test Loss: 0.345 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 24 cost time: 0.7413716316223145
Epoch: 24, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.349 Vali Acc: 0.899 Test Loss: 0.349 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7158284187316895
Epoch: 25, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.362 Vali Acc: 0.891 Test Loss: 0.362 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7377448081970215
Epoch: 26, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.360 Vali Acc: 0.891 Test Loss: 0.360 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.753591775894165
Epoch: 27, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.339 Vali Acc: 0.891 Test Loss: 0.339 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8617258071899414
Epoch: 28, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.334 Vali Acc: 0.891 Test Loss: 0.334 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8339552879333496
Epoch: 29, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.332 Vali Acc: 0.891 Test Loss: 0.332 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7220196723937988
Epoch: 30, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.344 Vali Acc: 0.899 Test Loss: 0.344 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7845587730407715
Epoch: 31, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.343 Vali Acc: 0.891 Test Loss: 0.343 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.778087854385376
Epoch: 32, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.326 Vali Acc: 0.891 Test Loss: 0.326 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7090342044830322
Epoch: 33, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.313 Vali Acc: 0.891 Test Loss: 0.313 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 312004
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9718806743621826
Epoch: 1, Steps: 9 | Train Loss: 1.445 Vali Loss: 1.384 Vali Acc: 0.239 Test Loss: 1.384 Test Acc: 0.239
Validation loss decreased (inf --> -0.239117).  Saving model ...
Epoch: 2 cost time: 0.8219397068023682
Epoch: 2, Steps: 9 | Train Loss: 1.386 Vali Loss: 1.352 Vali Acc: 0.435 Test Loss: 1.352 Test Acc: 0.435
Validation loss decreased (-0.239117 --> -0.434769).  Saving model ...
Epoch: 3 cost time: 0.7399601936340332
Epoch: 3, Steps: 9 | Train Loss: 1.334 Vali Loss: 1.296 Vali Acc: 0.580 Test Loss: 1.296 Test Acc: 0.580
Validation loss decreased (-0.434769 --> -0.579697).  Saving model ...
Epoch: 4 cost time: 0.6751036643981934
Epoch: 4, Steps: 9 | Train Loss: 1.252 Vali Loss: 1.228 Vali Acc: 0.674 Test Loss: 1.228 Test Acc: 0.674
Validation loss decreased (-0.579697 --> -0.673901).  Saving model ...
Epoch: 5 cost time: 0.6664612293243408
Epoch: 5, Steps: 9 | Train Loss: 1.170 Vali Loss: 1.157 Vali Acc: 0.761 Test Loss: 1.157 Test Acc: 0.761
Validation loss decreased (-0.673901 --> -0.760858).  Saving model ...
Epoch: 6 cost time: 0.7380211353302002
Epoch: 6, Steps: 9 | Train Loss: 1.086 Vali Loss: 1.075 Vali Acc: 0.812 Test Loss: 1.075 Test Acc: 0.812
Validation loss decreased (-0.760858 --> -0.811583).  Saving model ...
Epoch: 7 cost time: 0.6676609516143799
Epoch: 7, Steps: 9 | Train Loss: 0.990 Vali Loss: 0.993 Vali Acc: 0.819 Test Loss: 0.993 Test Acc: 0.819
Validation loss decreased (-0.811583 --> -0.818831).  Saving model ...
Epoch: 8 cost time: 0.6884737014770508
Epoch: 8, Steps: 9 | Train Loss: 0.911 Vali Loss: 0.913 Vali Acc: 0.804 Test Loss: 0.913 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6986842155456543
Epoch: 9, Steps: 9 | Train Loss: 0.820 Vali Loss: 0.835 Vali Acc: 0.826 Test Loss: 0.835 Test Acc: 0.826
Validation loss decreased (-0.818831 --> -0.826079).  Saving model ...
Epoch: 10 cost time: 0.72074294090271
Epoch: 10, Steps: 9 | Train Loss: 0.726 Vali Loss: 0.765 Vali Acc: 0.841 Test Loss: 0.765 Test Acc: 0.841
Validation loss decreased (-0.826079 --> -0.840572).  Saving model ...
Epoch: 11 cost time: 0.6968801021575928
Epoch: 11, Steps: 9 | Train Loss: 0.629 Vali Loss: 0.705 Vali Acc: 0.841 Test Loss: 0.705 Test Acc: 0.841
Validation loss decreased (-0.840572 --> -0.840573).  Saving model ...
Epoch: 12 cost time: 0.6325654983520508
Epoch: 12, Steps: 9 | Train Loss: 0.565 Vali Loss: 0.649 Vali Acc: 0.848 Test Loss: 0.649 Test Acc: 0.848
Validation loss decreased (-0.840573 --> -0.847820).  Saving model ...
Epoch: 13 cost time: 0.7063765525817871
Epoch: 13, Steps: 9 | Train Loss: 0.486 Vali Loss: 0.606 Vali Acc: 0.848 Test Loss: 0.606 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847820).  Saving model ...
Epoch: 14 cost time: 0.7543582916259766
Epoch: 14, Steps: 9 | Train Loss: 0.424 Vali Loss: 0.558 Vali Acc: 0.841 Test Loss: 0.558 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7138490676879883
Epoch: 15, Steps: 9 | Train Loss: 0.384 Vali Loss: 0.523 Vali Acc: 0.841 Test Loss: 0.523 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6785874366760254
Epoch: 16, Steps: 9 | Train Loss: 0.334 Vali Loss: 0.485 Vali Acc: 0.841 Test Loss: 0.485 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7530856132507324
Epoch: 17, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.470 Vali Acc: 0.841 Test Loss: 0.470 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6603279113769531
Epoch: 18, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.444 Vali Acc: 0.848 Test Loss: 0.444 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847822).  Saving model ...
Epoch: 19 cost time: 0.7271146774291992
Epoch: 19, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.438 Vali Acc: 0.848 Test Loss: 0.438 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 20 cost time: 0.7173516750335693
Epoch: 20, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.436 Vali Acc: 0.848 Test Loss: 0.436 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 21 cost time: 0.7189483642578125
Epoch: 21, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.422 Vali Acc: 0.841 Test Loss: 0.422 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.793694019317627
Epoch: 22, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.399 Vali Acc: 0.841 Test Loss: 0.399 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6707899570465088
Epoch: 23, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.371 Vali Acc: 0.841 Test Loss: 0.371 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7275087833404541
Epoch: 24, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.380 Vali Acc: 0.833 Test Loss: 0.380 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7143993377685547
Epoch: 25, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.403 Vali Acc: 0.833 Test Loss: 0.403 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.711195707321167
Epoch: 26, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.380 Vali Acc: 0.826 Test Loss: 0.380 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6748208999633789
Epoch: 27, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.377 Vali Acc: 0.833 Test Loss: 0.377 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7240004539489746
Epoch: 28, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.367 Vali Acc: 0.848 Test Loss: 0.367 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 29 cost time: 0.7130844593048096
Epoch: 29, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.362 Vali Acc: 0.848 Test Loss: 0.362 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 30 cost time: 0.6554429531097412
Epoch: 30, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.385 Vali Acc: 0.833 Test Loss: 0.385 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6968038082122803
Epoch: 31, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.371 Vali Acc: 0.833 Test Loss: 0.371 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.732121467590332
Epoch: 32, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.338 Vali Acc: 0.862 Test Loss: 0.338 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 33 cost time: 0.652393102645874
Epoch: 33, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.384 Vali Acc: 0.855 Test Loss: 0.384 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7100977897644043
Epoch: 34, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.356 Vali Acc: 0.841 Test Loss: 0.356 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7058825492858887
Epoch: 35, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.343 Vali Acc: 0.848 Test Loss: 0.343 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6938657760620117
Epoch: 36, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.373 Vali Acc: 0.848 Test Loss: 0.373 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6949858665466309
Epoch: 37, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.375 Vali Acc: 0.848 Test Loss: 0.375 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.6897053718566895
Epoch: 38, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.359 Vali Acc: 0.848 Test Loss: 0.359 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6614155769348145
Epoch: 39, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.382 Vali Acc: 0.862 Test Loss: 0.382 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.7135083675384521
Epoch: 40, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.379 Vali Acc: 0.855 Test Loss: 0.379 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.6900193691253662
Epoch: 41, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.381 Vali Acc: 0.855 Test Loss: 0.381 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.6764564514160156
Epoch: 42, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.355 Vali Acc: 0.862 Test Loss: 0.355 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 309252
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.110818862915039
Epoch: 1, Steps: 9 | Train Loss: 1.422 Vali Loss: 1.381 Vali Acc: 0.319 Test Loss: 1.381 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 0.7223141193389893
Epoch: 2, Steps: 9 | Train Loss: 1.382 Vali Loss: 1.354 Vali Acc: 0.384 Test Loss: 1.354 Test Acc: 0.384
Validation loss decreased (-0.318827 --> -0.384044).  Saving model ...
Epoch: 3 cost time: 0.6551978588104248
Epoch: 3, Steps: 9 | Train Loss: 1.324 Vali Loss: 1.308 Vali Acc: 0.442 Test Loss: 1.308 Test Acc: 0.442
Validation loss decreased (-0.384044 --> -0.442016).  Saving model ...
Epoch: 4 cost time: 0.6584267616271973
Epoch: 4, Steps: 9 | Train Loss: 1.262 Vali Loss: 1.247 Vali Acc: 0.543 Test Loss: 1.247 Test Acc: 0.543
Validation loss decreased (-0.442016 --> -0.543466).  Saving model ...
Epoch: 5 cost time: 0.7647225856781006
Epoch: 5, Steps: 9 | Train Loss: 1.176 Vali Loss: 1.182 Vali Acc: 0.638 Test Loss: 1.182 Test Acc: 0.638
Validation loss decreased (-0.543466 --> -0.637669).  Saving model ...
Epoch: 6 cost time: 0.7989938259124756
Epoch: 6, Steps: 9 | Train Loss: 1.087 Vali Loss: 1.113 Vali Acc: 0.681 Test Loss: 1.113 Test Acc: 0.681
Validation loss decreased (-0.637669 --> -0.681148).  Saving model ...
Epoch: 7 cost time: 0.7336678504943848
Epoch: 7, Steps: 9 | Train Loss: 1.014 Vali Loss: 1.041 Vali Acc: 0.739 Test Loss: 1.041 Test Acc: 0.739
Validation loss decreased (-0.681148 --> -0.739120).  Saving model ...
Epoch: 8 cost time: 0.7349607944488525
Epoch: 8, Steps: 9 | Train Loss: 0.916 Vali Loss: 0.973 Vali Acc: 0.739 Test Loss: 0.973 Test Acc: 0.739
Validation loss decreased (-0.739120 --> -0.739121).  Saving model ...
Epoch: 9 cost time: 0.7027606964111328
Epoch: 9, Steps: 9 | Train Loss: 0.830 Vali Loss: 0.903 Vali Acc: 0.739 Test Loss: 0.903 Test Acc: 0.739
Validation loss decreased (-0.739121 --> -0.739121).  Saving model ...
Epoch: 10 cost time: 0.677363395690918
Epoch: 10, Steps: 9 | Train Loss: 0.741 Vali Loss: 0.834 Vali Acc: 0.746 Test Loss: 0.834 Test Acc: 0.746
Validation loss decreased (-0.739121 --> -0.746368).  Saving model ...
Epoch: 11 cost time: 0.7108557224273682
Epoch: 11, Steps: 9 | Train Loss: 0.661 Vali Loss: 0.780 Vali Acc: 0.754 Test Loss: 0.780 Test Acc: 0.754
Validation loss decreased (-0.746368 --> -0.753615).  Saving model ...
Epoch: 12 cost time: 0.7665314674377441
Epoch: 12, Steps: 9 | Train Loss: 0.569 Vali Loss: 0.719 Vali Acc: 0.783 Test Loss: 0.719 Test Acc: 0.783
Validation loss decreased (-0.753615 --> -0.782602).  Saving model ...
Epoch: 13 cost time: 0.7145671844482422
Epoch: 13, Steps: 9 | Train Loss: 0.480 Vali Loss: 0.675 Vali Acc: 0.783 Test Loss: 0.675 Test Acc: 0.783
Validation loss decreased (-0.782602 --> -0.782602).  Saving model ...
Epoch: 14 cost time: 0.7072012424468994
Epoch: 14, Steps: 9 | Train Loss: 0.412 Vali Loss: 0.633 Vali Acc: 0.797 Test Loss: 0.633 Test Acc: 0.797
Validation loss decreased (-0.782602 --> -0.797095).  Saving model ...
Epoch: 15 cost time: 0.7093348503112793
Epoch: 15, Steps: 9 | Train Loss: 0.354 Vali Loss: 0.597 Vali Acc: 0.804 Test Loss: 0.597 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804342).  Saving model ...
Epoch: 16 cost time: 0.7462518215179443
Epoch: 16, Steps: 9 | Train Loss: 0.315 Vali Loss: 0.569 Vali Acc: 0.804 Test Loss: 0.569 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 17 cost time: 0.7798733711242676
Epoch: 17, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.564 Vali Acc: 0.797 Test Loss: 0.564 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.718106746673584
Epoch: 18, Steps: 9 | Train Loss: 0.239 Vali Loss: 0.526 Vali Acc: 0.819 Test Loss: 0.526 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818835).  Saving model ...
Epoch: 19 cost time: 0.7337515354156494
Epoch: 19, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.511 Vali Acc: 0.819 Test Loss: 0.511 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 20 cost time: 0.7300980091094971
Epoch: 20, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
Validation loss decreased (-0.818835 --> -0.840575).  Saving model ...
Epoch: 21 cost time: 0.677105188369751
Epoch: 21, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.499 Vali Acc: 0.819 Test Loss: 0.499 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.748831033706665
Epoch: 22, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.480 Vali Acc: 0.833 Test Loss: 0.480 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7624452114105225
Epoch: 23, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.447 Vali Acc: 0.841 Test Loss: 0.447 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 24 cost time: 0.6898918151855469
Epoch: 24, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.444 Vali Acc: 0.841 Test Loss: 0.444 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 25 cost time: 0.7381629943847656
Epoch: 25, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.439 Vali Acc: 0.848 Test Loss: 0.439 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 26 cost time: 0.7048313617706299
Epoch: 26, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.440 Vali Acc: 0.855 Test Loss: 0.440 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 27 cost time: 0.8441336154937744
Epoch: 27, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.451 Vali Acc: 0.848 Test Loss: 0.451 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8159999847412109
Epoch: 28, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.457 Vali Acc: 0.855 Test Loss: 0.457 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7687819004058838
Epoch: 29, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.462 Vali Acc: 0.848 Test Loss: 0.462 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7762253284454346
Epoch: 30, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7828059196472168
Epoch: 31, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.430 Vali Acc: 0.848 Test Loss: 0.430 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6852433681488037
Epoch: 32, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.450 Vali Acc: 0.848 Test Loss: 0.450 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7216403484344482
Epoch: 33, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.470 Vali Acc: 0.848 Test Loss: 0.470 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7585363388061523
Epoch: 34, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.462 Vali Acc: 0.848 Test Loss: 0.462 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8682870864868164
Epoch: 35, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.461 Vali Acc: 0.848 Test Loss: 0.461 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.7809462547302246
Epoch: 36, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 37 cost time: 0.7416675090789795
Epoch: 37, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.446 Vali Acc: 0.833 Test Loss: 0.446 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7792398929595947
Epoch: 38, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.459 Vali Acc: 0.833 Test Loss: 0.459 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7647907733917236
Epoch: 39, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.469 Vali Acc: 0.833 Test Loss: 0.469 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7471415996551514
Epoch: 40, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.474 Vali Acc: 0.841 Test Loss: 0.474 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8589344024658203
Epoch: 41, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.476 Vali Acc: 0.841 Test Loss: 0.476 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7621848583221436
Epoch: 42, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.459 Vali Acc: 0.841 Test Loss: 0.459 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.7855727672576904
Epoch: 43, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.465 Vali Acc: 0.833 Test Loss: 0.465 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.7840409278869629
Epoch: 44, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.457 Vali Acc: 0.833 Test Loss: 0.457 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.7974534034729004
Epoch: 45, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.462 Vali Acc: 0.826 Test Loss: 0.462 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.8114383220672607
Epoch: 46, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.462 Vali Acc: 0.826 Test Loss: 0.462 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 309604
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0420210361480713
Epoch: 1, Steps: 9 | Train Loss: 1.410 Vali Loss: 1.394 Vali Acc: 0.304 Test Loss: 1.394 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 0.7578589916229248
Epoch: 2, Steps: 9 | Train Loss: 1.370 Vali Loss: 1.370 Vali Acc: 0.326 Test Loss: 1.370 Test Acc: 0.326
Validation loss decreased (-0.304334 --> -0.326073).  Saving model ...
Epoch: 3 cost time: 0.7307426929473877
Epoch: 3, Steps: 9 | Train Loss: 1.329 Vali Loss: 1.325 Vali Acc: 0.377 Test Loss: 1.325 Test Acc: 0.377
Validation loss decreased (-0.326073 --> -0.376798).  Saving model ...
Epoch: 4 cost time: 0.7593159675598145
Epoch: 4, Steps: 9 | Train Loss: 1.261 Vali Loss: 1.269 Vali Acc: 0.442 Test Loss: 1.269 Test Acc: 0.442
Validation loss decreased (-0.376798 --> -0.442016).  Saving model ...
Epoch: 5 cost time: 0.7483043670654297
Epoch: 5, Steps: 9 | Train Loss: 1.190 Vali Loss: 1.208 Vali Acc: 0.522 Test Loss: 1.208 Test Acc: 0.522
Validation loss decreased (-0.442016 --> -0.521727).  Saving model ...
Epoch: 6 cost time: 0.7724967002868652
Epoch: 6, Steps: 9 | Train Loss: 1.100 Vali Loss: 1.151 Vali Acc: 0.587 Test Loss: 1.151 Test Acc: 0.587
Validation loss decreased (-0.521727 --> -0.586945).  Saving model ...
Epoch: 7 cost time: 0.7074203491210938
Epoch: 7, Steps: 9 | Train Loss: 1.029 Vali Loss: 1.086 Vali Acc: 0.616 Test Loss: 1.086 Test Acc: 0.616
Validation loss decreased (-0.586945 --> -0.615931).  Saving model ...
Epoch: 8 cost time: 0.7619833946228027
Epoch: 8, Steps: 9 | Train Loss: 0.940 Vali Loss: 1.018 Vali Acc: 0.674 Test Loss: 1.018 Test Acc: 0.674
Validation loss decreased (-0.615931 --> -0.673903).  Saving model ...
Epoch: 9 cost time: 0.6493422985076904
Epoch: 9, Steps: 9 | Train Loss: 0.854 Vali Loss: 0.949 Vali Acc: 0.674 Test Loss: 0.949 Test Acc: 0.674
Validation loss decreased (-0.673903 --> -0.673904).  Saving model ...
Epoch: 10 cost time: 0.7355453968048096
Epoch: 10, Steps: 9 | Train Loss: 0.774 Vali Loss: 0.893 Vali Acc: 0.703 Test Loss: 0.893 Test Acc: 0.703
Validation loss decreased (-0.673904 --> -0.702890).  Saving model ...
Epoch: 11 cost time: 0.7048685550689697
Epoch: 11, Steps: 9 | Train Loss: 0.673 Vali Loss: 0.838 Vali Acc: 0.710 Test Loss: 0.838 Test Acc: 0.710
Validation loss decreased (-0.702890 --> -0.710137).  Saving model ...
Epoch: 12 cost time: 0.6961164474487305
Epoch: 12, Steps: 9 | Train Loss: 0.605 Vali Loss: 0.790 Vali Acc: 0.725 Test Loss: 0.790 Test Acc: 0.725
Validation loss decreased (-0.710137 --> -0.724630).  Saving model ...
Epoch: 13 cost time: 0.7282578945159912
Epoch: 13, Steps: 9 | Train Loss: 0.547 Vali Loss: 0.739 Vali Acc: 0.739 Test Loss: 0.739 Test Acc: 0.739
Validation loss decreased (-0.724630 --> -0.739123).  Saving model ...
Epoch: 14 cost time: 0.7665054798126221
Epoch: 14, Steps: 9 | Train Loss: 0.504 Vali Loss: 0.702 Vali Acc: 0.746 Test Loss: 0.702 Test Acc: 0.746
Validation loss decreased (-0.739123 --> -0.746370).  Saving model ...
Epoch: 15 cost time: 0.7388429641723633
Epoch: 15, Steps: 9 | Train Loss: 0.414 Vali Loss: 0.671 Vali Acc: 0.761 Test Loss: 0.671 Test Acc: 0.761
Validation loss decreased (-0.746370 --> -0.760863).  Saving model ...
Epoch: 16 cost time: 0.8093845844268799
Epoch: 16, Steps: 9 | Train Loss: 0.359 Vali Loss: 0.639 Vali Acc: 0.783 Test Loss: 0.639 Test Acc: 0.783
Validation loss decreased (-0.760863 --> -0.782602).  Saving model ...
Epoch: 17 cost time: 0.6715364456176758
Epoch: 17, Steps: 9 | Train Loss: 0.339 Vali Loss: 0.617 Vali Acc: 0.775 Test Loss: 0.617 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7260756492614746
Epoch: 18, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.596 Vali Acc: 0.775 Test Loss: 0.596 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6872332096099854
Epoch: 19, Steps: 9 | Train Loss: 0.262 Vali Loss: 0.585 Vali Acc: 0.790 Test Loss: 0.585 Test Acc: 0.790
Validation loss decreased (-0.782602 --> -0.789849).  Saving model ...
Epoch: 20 cost time: 0.6941006183624268
Epoch: 20, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.569 Vali Acc: 0.790 Test Loss: 0.569 Test Acc: 0.790
Validation loss decreased (-0.789849 --> -0.789849).  Saving model ...
Epoch: 21 cost time: 0.683147668838501
Epoch: 21, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.528 Vali Acc: 0.804 Test Loss: 0.528 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804343).  Saving model ...
Epoch: 22 cost time: 0.7727549076080322
Epoch: 22, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.531 Vali Acc: 0.797 Test Loss: 0.531 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7923135757446289
Epoch: 23, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.538 Vali Acc: 0.783 Test Loss: 0.538 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7723805904388428
Epoch: 24, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7175092697143555
Epoch: 25, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.528 Vali Acc: 0.783 Test Loss: 0.528 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7578122615814209
Epoch: 26, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.526 Vali Acc: 0.783 Test Loss: 0.526 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7406458854675293
Epoch: 27, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.492 Vali Acc: 0.790 Test Loss: 0.492 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7689297199249268
Epoch: 28, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.496 Vali Acc: 0.783 Test Loss: 0.496 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.730410099029541
Epoch: 29, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.500 Vali Acc: 0.783 Test Loss: 0.500 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6942539215087891
Epoch: 30, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.550 Vali Acc: 0.783 Test Loss: 0.550 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.740351676940918
Epoch: 31, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.538 Vali Acc: 0.783 Test Loss: 0.538 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8043478260869565
model parameter : 308388
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.249736785888672
Epoch: 1, Steps: 9 | Train Loss: 1.341 Vali Loss: 1.263 Vali Acc: 0.543 Test Loss: 1.263 Test Acc: 0.543
Validation loss decreased (inf --> -0.543466).  Saving model ...
Epoch: 2 cost time: 1.016080379486084
Epoch: 2, Steps: 9 | Train Loss: 1.020 Vali Loss: 0.947 Vali Acc: 0.783 Test Loss: 0.947 Test Acc: 0.783
Validation loss decreased (-0.543466 --> -0.782599).  Saving model ...
Epoch: 3 cost time: 0.9180464744567871
Epoch: 3, Steps: 9 | Train Loss: 0.583 Vali Loss: 0.622 Vali Acc: 0.833 Test Loss: 0.622 Test Acc: 0.833
Validation loss decreased (-0.782599 --> -0.833327).  Saving model ...
Epoch: 4 cost time: 0.8973979949951172
Epoch: 4, Steps: 9 | Train Loss: 0.306 Vali Loss: 0.372 Vali Acc: 0.899 Test Loss: 0.372 Test Acc: 0.899
Validation loss decreased (-0.833327 --> -0.898547).  Saving model ...
Epoch: 5 cost time: 0.8499369621276855
Epoch: 5, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.261 Vali Acc: 0.913 Test Loss: 0.261 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913041).  Saving model ...
Epoch: 6 cost time: 0.9220438003540039
Epoch: 6, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.244 Vali Acc: 0.920 Test Loss: 0.244 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 7 cost time: 0.9638292789459229
Epoch: 7, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9450864791870117
Epoch: 8, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.227 Vali Acc: 0.920 Test Loss: 0.227 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920288).  Saving model ...
Epoch: 9 cost time: 0.9251511096954346
Epoch: 9, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.213 Vali Acc: 0.935 Test Loss: 0.213 Test Acc: 0.935
Validation loss decreased (-0.920288 --> -0.934780).  Saving model ...
Epoch: 10 cost time: 0.9470338821411133
Epoch: 10, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.928 Test Loss: 0.223 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9471635818481445
Epoch: 11, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.219 Vali Acc: 0.920 Test Loss: 0.219 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8156235218048096
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.920 Test Loss: 0.221 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8469345569610596
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.920 Test Loss: 0.226 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9178519248962402
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.920 Test Loss: 0.230 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9365172386169434
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.920 Test Loss: 0.236 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8805544376373291
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.920 Test Loss: 0.242 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9491603374481201
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.920 Test Loss: 0.231 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8544785976409912
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.920 Test Loss: 0.242 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8863422870635986
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.920 Test Loss: 0.252 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 1201540
model size : 4.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.217766284942627
Epoch: 1, Steps: 9 | Train Loss: 1.395 Vali Loss: 1.328 Vali Acc: 0.442 Test Loss: 1.328 Test Acc: 0.442
Validation loss decreased (inf --> -0.442016).  Saving model ...
Epoch: 2 cost time: 0.7483577728271484
Epoch: 2, Steps: 9 | Train Loss: 1.150 Vali Loss: 1.111 Vali Acc: 0.746 Test Loss: 1.111 Test Acc: 0.746
Validation loss decreased (-0.442016 --> -0.746366).  Saving model ...
Epoch: 3 cost time: 0.7920126914978027
Epoch: 3, Steps: 9 | Train Loss: 0.852 Vali Loss: 0.861 Vali Acc: 0.833 Test Loss: 0.861 Test Acc: 0.833
Validation loss decreased (-0.746366 --> -0.833325).  Saving model ...
Epoch: 4 cost time: 0.7688870429992676
Epoch: 4, Steps: 9 | Train Loss: 0.565 Vali Loss: 0.601 Vali Acc: 0.877 Test Loss: 0.601 Test Acc: 0.877
Validation loss decreased (-0.833325 --> -0.876806).  Saving model ...
Epoch: 5 cost time: 0.7708690166473389
Epoch: 5, Steps: 9 | Train Loss: 0.311 Vali Loss: 0.435 Vali Acc: 0.877 Test Loss: 0.435 Test Acc: 0.877
Validation loss decreased (-0.876806 --> -0.876807).  Saving model ...
Epoch: 6 cost time: 0.8051736354827881
Epoch: 6, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.309 Vali Acc: 0.920 Test Loss: 0.309 Test Acc: 0.920
Validation loss decreased (-0.876807 --> -0.920287).  Saving model ...
Epoch: 7 cost time: 0.8090834617614746
Epoch: 7, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.247 Vali Acc: 0.935 Test Loss: 0.247 Test Acc: 0.935
Validation loss decreased (-0.920287 --> -0.934780).  Saving model ...
Epoch: 8 cost time: 0.7900924682617188
Epoch: 8, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.216 Vali Acc: 0.942 Test Loss: 0.216 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 9 cost time: 0.7841362953186035
Epoch: 9, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.222 Vali Acc: 0.942 Test Loss: 0.222 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7884054183959961
Epoch: 10, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.250 Vali Acc: 0.928 Test Loss: 0.250 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7630271911621094
Epoch: 11, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.249 Vali Acc: 0.920 Test Loss: 0.249 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.66058349609375
Epoch: 12, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.241 Vali Acc: 0.920 Test Loss: 0.241 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7340610027313232
Epoch: 13, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.217 Vali Acc: 0.913 Test Loss: 0.217 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8103234767913818
Epoch: 14, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.193 Vali Acc: 0.942 Test Loss: 0.193 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 15 cost time: 0.8145081996917725
Epoch: 15, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.205 Vali Acc: 0.942 Test Loss: 0.205 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7230343818664551
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.228 Vali Acc: 0.928 Test Loss: 0.228 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8340044021606445
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.235 Vali Acc: 0.920 Test Loss: 0.235 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8320975303649902
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.830146074295044
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.935 Test Loss: 0.198 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8165044784545898
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.920 Test Loss: 0.197 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8264424800872803
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.913 Test Loss: 0.211 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8293564319610596
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.920 Test Loss: 0.219 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8175668716430664
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.920 Test Loss: 0.229 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7541122436523438
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.928 Test Loss: 0.218 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 1149956
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.297278642654419
Epoch: 1, Steps: 9 | Train Loss: 1.389 Vali Loss: 1.325 Vali Acc: 0.370 Test Loss: 1.325 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 0.8118257522583008
Epoch: 2, Steps: 9 | Train Loss: 1.201 Vali Loss: 1.154 Vali Acc: 0.725 Test Loss: 1.154 Test Acc: 0.725
Validation loss decreased (-0.369552 --> -0.724626).  Saving model ...
Epoch: 3 cost time: 0.7933783531188965
Epoch: 3, Steps: 9 | Train Loss: 0.942 Vali Loss: 0.918 Vali Acc: 0.855 Test Loss: 0.918 Test Acc: 0.855
Validation loss decreased (-0.724626 --> -0.855063).  Saving model ...
Epoch: 4 cost time: 0.7929089069366455
Epoch: 4, Steps: 9 | Train Loss: 0.665 Vali Loss: 0.710 Vali Acc: 0.826 Test Loss: 0.710 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8633360862731934
Epoch: 5, Steps: 9 | Train Loss: 0.421 Vali Loss: 0.519 Vali Acc: 0.877 Test Loss: 0.519 Test Acc: 0.877
Validation loss decreased (-0.855063 --> -0.876806).  Saving model ...
Epoch: 6 cost time: 0.877504825592041
Epoch: 6, Steps: 9 | Train Loss: 0.252 Vali Loss: 0.392 Vali Acc: 0.913 Test Loss: 0.392 Test Acc: 0.913
Validation loss decreased (-0.876806 --> -0.913040).  Saving model ...
Epoch: 7 cost time: 0.8019382953643799
Epoch: 7, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.314 Vali Acc: 0.913 Test Loss: 0.314 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 8 cost time: 0.8610217571258545
Epoch: 8, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.280 Vali Acc: 0.906 Test Loss: 0.280 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8438520431518555
Epoch: 9, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.266 Vali Acc: 0.906 Test Loss: 0.266 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8250036239624023
Epoch: 10, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.280 Vali Acc: 0.913 Test Loss: 0.280 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913041).  Saving model ...
Epoch: 11 cost time: 0.8717904090881348
Epoch: 11, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.285 Vali Acc: 0.913 Test Loss: 0.285 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7843539714813232
Epoch: 12, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.292 Vali Acc: 0.913 Test Loss: 0.292 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8254702091217041
Epoch: 13, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.281 Vali Acc: 0.899 Test Loss: 0.281 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8257722854614258
Epoch: 14, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.266 Vali Acc: 0.906 Test Loss: 0.266 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8371734619140625
Epoch: 15, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.247 Vali Acc: 0.899 Test Loss: 0.247 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8085713386535645
Epoch: 16, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.262 Vali Acc: 0.899 Test Loss: 0.262 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8354756832122803
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.262 Vali Acc: 0.899 Test Loss: 0.262 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8931896686553955
Epoch: 18, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.253 Vali Acc: 0.899 Test Loss: 0.253 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8805654048919678
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.250 Vali Acc: 0.899 Test Loss: 0.250 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8491067886352539
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.261 Vali Acc: 0.899 Test Loss: 0.261 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 1138308
model size : 4.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.175295114517212
Epoch: 1, Steps: 9 | Train Loss: 1.389 Vali Loss: 1.351 Vali Acc: 0.319 Test Loss: 1.351 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 0.7077395915985107
Epoch: 2, Steps: 9 | Train Loss: 1.228 Vali Loss: 1.215 Vali Acc: 0.522 Test Loss: 1.215 Test Acc: 0.522
Validation loss decreased (-0.318827 --> -0.521727).  Saving model ...
Epoch: 3 cost time: 0.7569973468780518
Epoch: 3, Steps: 9 | Train Loss: 1.016 Vali Loss: 1.030 Vali Acc: 0.717 Test Loss: 1.030 Test Acc: 0.717
Validation loss decreased (-0.521727 --> -0.717381).  Saving model ...
Epoch: 4 cost time: 0.7911908626556396
Epoch: 4, Steps: 9 | Train Loss: 0.777 Vali Loss: 0.831 Vali Acc: 0.812 Test Loss: 0.831 Test Acc: 0.812
Validation loss decreased (-0.717381 --> -0.811586).  Saving model ...
Epoch: 5 cost time: 0.8569116592407227
Epoch: 5, Steps: 9 | Train Loss: 0.588 Vali Loss: 0.639 Vali Acc: 0.855 Test Loss: 0.639 Test Acc: 0.855
Validation loss decreased (-0.811586 --> -0.855066).  Saving model ...
Epoch: 6 cost time: 0.8540248870849609
Epoch: 6, Steps: 9 | Train Loss: 0.389 Vali Loss: 0.508 Vali Acc: 0.899 Test Loss: 0.508 Test Acc: 0.899
Validation loss decreased (-0.855066 --> -0.898546).  Saving model ...
Epoch: 7 cost time: 0.7967603206634521
Epoch: 7, Steps: 9 | Train Loss: 0.270 Vali Loss: 0.407 Vali Acc: 0.913 Test Loss: 0.407 Test Acc: 0.913
Validation loss decreased (-0.898546 --> -0.913039).  Saving model ...
Epoch: 8 cost time: 0.7634682655334473
Epoch: 8, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.333 Vali Acc: 0.906 Test Loss: 0.333 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7795238494873047
Epoch: 9, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.292 Vali Acc: 0.920 Test Loss: 0.292 Test Acc: 0.920
Validation loss decreased (-0.913039 --> -0.920287).  Saving model ...
Epoch: 10 cost time: 0.8045868873596191
Epoch: 10, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.297 Vali Acc: 0.913 Test Loss: 0.297 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6969637870788574
Epoch: 11, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.291 Vali Acc: 0.906 Test Loss: 0.291 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7453806400299072
Epoch: 12, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.293 Vali Acc: 0.906 Test Loss: 0.293 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7711591720581055
Epoch: 13, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6816258430480957
Epoch: 14, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.285 Vali Acc: 0.906 Test Loss: 0.285 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8372664451599121
Epoch: 15, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.286 Vali Acc: 0.913 Test Loss: 0.286 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7693262100219727
Epoch: 16, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.280 Vali Acc: 0.899 Test Loss: 0.280 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7965741157531738
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.273 Vali Acc: 0.899 Test Loss: 0.273 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7869555950164795
Epoch: 18, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.269 Vali Acc: 0.906 Test Loss: 0.269 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7622568607330322
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 1126660
model size : 4.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.218674659729004
Epoch: 1, Steps: 9 | Train Loss: 1.383 Vali Loss: 1.329 Vali Acc: 0.362 Test Loss: 1.329 Test Acc: 0.362
Validation loss decreased (inf --> -0.362306).  Saving model ...
Epoch: 2 cost time: 0.8662395477294922
Epoch: 2, Steps: 9 | Train Loss: 1.266 Vali Loss: 1.197 Vali Acc: 0.688 Test Loss: 1.197 Test Acc: 0.688
Validation loss decreased (-0.362306 --> -0.688394).  Saving model ...
Epoch: 3 cost time: 0.7237887382507324
Epoch: 3, Steps: 9 | Train Loss: 1.058 Vali Loss: 1.037 Vali Acc: 0.746 Test Loss: 1.037 Test Acc: 0.746
Validation loss decreased (-0.688394 --> -0.746366).  Saving model ...
Epoch: 4 cost time: 0.8357727527618408
Epoch: 4, Steps: 9 | Train Loss: 0.860 Vali Loss: 0.868 Vali Acc: 0.775 Test Loss: 0.868 Test Acc: 0.775
Validation loss decreased (-0.746366 --> -0.775354).  Saving model ...
Epoch: 5 cost time: 0.8228819370269775
Epoch: 5, Steps: 9 | Train Loss: 0.665 Vali Loss: 0.709 Vali Acc: 0.797 Test Loss: 0.709 Test Acc: 0.797
Validation loss decreased (-0.775354 --> -0.797094).  Saving model ...
Epoch: 6 cost time: 0.8763246536254883
Epoch: 6, Steps: 9 | Train Loss: 0.489 Vali Loss: 0.580 Vali Acc: 0.848 Test Loss: 0.580 Test Acc: 0.848
Validation loss decreased (-0.797094 --> -0.847820).  Saving model ...
Epoch: 7 cost time: 0.8104777336120605
Epoch: 7, Steps: 9 | Train Loss: 0.368 Vali Loss: 0.487 Vali Acc: 0.877 Test Loss: 0.487 Test Acc: 0.877
Validation loss decreased (-0.847820 --> -0.876807).  Saving model ...
Epoch: 8 cost time: 0.8083064556121826
Epoch: 8, Steps: 9 | Train Loss: 0.289 Vali Loss: 0.445 Vali Acc: 0.855 Test Loss: 0.445 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7525298595428467
Epoch: 9, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.389 Vali Acc: 0.877 Test Loss: 0.389 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876808).  Saving model ...
Epoch: 10 cost time: 0.7941441535949707
Epoch: 10, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.368 Vali Acc: 0.891 Test Loss: 0.368 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 11 cost time: 0.8670082092285156
Epoch: 11, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.357 Vali Acc: 0.870 Test Loss: 0.357 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8123795986175537
Epoch: 12, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.350 Vali Acc: 0.870 Test Loss: 0.350 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8409571647644043
Epoch: 13, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.337 Vali Acc: 0.884 Test Loss: 0.337 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8201005458831787
Epoch: 14, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.339 Vali Acc: 0.877 Test Loss: 0.339 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.787827730178833
Epoch: 15, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.313 Vali Acc: 0.884 Test Loss: 0.313 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8910729885101318
Epoch: 16, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.305 Vali Acc: 0.913 Test Loss: 0.305 Test Acc: 0.913
Validation loss decreased (-0.891301 --> -0.913040).  Saving model ...
Epoch: 17 cost time: 0.8152506351470947
Epoch: 17, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.299 Vali Acc: 0.913 Test Loss: 0.299 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 18 cost time: 0.7837152481079102
Epoch: 18, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.306 Vali Acc: 0.899 Test Loss: 0.306 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7946653366088867
Epoch: 19, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.312 Vali Acc: 0.899 Test Loss: 0.312 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9401814937591553
Epoch: 20, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.308 Vali Acc: 0.891 Test Loss: 0.308 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8074190616607666
Epoch: 21, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.313 Vali Acc: 0.899 Test Loss: 0.313 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8052048683166504
Epoch: 22, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.318 Vali Acc: 0.899 Test Loss: 0.318 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7761619091033936
Epoch: 23, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.314 Vali Acc: 0.906 Test Loss: 0.314 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7925915718078613
Epoch: 24, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.312 Vali Acc: 0.877 Test Loss: 0.312 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8250339031219482
Epoch: 25, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.295 Vali Acc: 0.884 Test Loss: 0.295 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7778451442718506
Epoch: 26, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.267 Vali Acc: 0.920 Test Loss: 0.267 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 27 cost time: 0.8675801753997803
Epoch: 27, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.312 Vali Acc: 0.913 Test Loss: 0.312 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7864539623260498
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.293 Vali Acc: 0.913 Test Loss: 0.293 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8402276039123535
Epoch: 29, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.303 Vali Acc: 0.906 Test Loss: 0.303 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8297266960144043
Epoch: 30, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.314 Vali Acc: 0.906 Test Loss: 0.314 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7966318130493164
Epoch: 31, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.304 Vali Acc: 0.913 Test Loss: 0.304 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7844893932342529
Epoch: 32, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.295 Vali Acc: 0.899 Test Loss: 0.295 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7834081649780273
Epoch: 33, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.286 Vali Acc: 0.899 Test Loss: 0.286 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9405262470245361
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.913 Test Loss: 0.277 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8275101184844971
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.284 Vali Acc: 0.913 Test Loss: 0.284 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9116835594177246
Epoch: 36, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.290 Vali Acc: 0.913 Test Loss: 0.290 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 1118724
model size : 4.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.180422782897949
Epoch: 1, Steps: 9 | Train Loss: 1.412 Vali Loss: 1.369 Vali Acc: 0.304 Test Loss: 1.369 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 0.8267195224761963
Epoch: 2, Steps: 9 | Train Loss: 1.274 Vali Loss: 1.266 Vali Acc: 0.551 Test Loss: 1.266 Test Acc: 0.551
Validation loss decreased (-0.304334 --> -0.550712).  Saving model ...
Epoch: 3 cost time: 0.712677001953125
Epoch: 3, Steps: 9 | Train Loss: 1.106 Vali Loss: 1.117 Vali Acc: 0.645 Test Loss: 1.117 Test Acc: 0.645
Validation loss decreased (-0.550712 --> -0.644916).  Saving model ...
Epoch: 4 cost time: 0.7901873588562012
Epoch: 4, Steps: 9 | Train Loss: 0.921 Vali Loss: 0.953 Vali Acc: 0.696 Test Loss: 0.953 Test Acc: 0.696
Validation loss decreased (-0.644916 --> -0.695643).  Saving model ...
Epoch: 5 cost time: 0.8308629989624023
Epoch: 5, Steps: 9 | Train Loss: 0.743 Vali Loss: 0.816 Vali Acc: 0.775 Test Loss: 0.816 Test Acc: 0.775
Validation loss decreased (-0.695643 --> -0.775354).  Saving model ...
Epoch: 6 cost time: 0.8329119682312012
Epoch: 6, Steps: 9 | Train Loss: 0.577 Vali Loss: 0.686 Vali Acc: 0.812 Test Loss: 0.686 Test Acc: 0.812
Validation loss decreased (-0.775354 --> -0.811587).  Saving model ...
Epoch: 7 cost time: 0.8002889156341553
Epoch: 7, Steps: 9 | Train Loss: 0.440 Vali Loss: 0.590 Vali Acc: 0.848 Test Loss: 0.590 Test Acc: 0.848
Validation loss decreased (-0.811587 --> -0.847820).  Saving model ...
Epoch: 8 cost time: 0.7572705745697021
Epoch: 8, Steps: 9 | Train Loss: 0.321 Vali Loss: 0.521 Vali Acc: 0.848 Test Loss: 0.521 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847821).  Saving model ...
Epoch: 9 cost time: 0.7938063144683838
Epoch: 9, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.472 Vali Acc: 0.841 Test Loss: 0.472 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8193361759185791
Epoch: 10, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.444 Vali Acc: 0.855 Test Loss: 0.444 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 11 cost time: 0.8101444244384766
Epoch: 11, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.427 Vali Acc: 0.848 Test Loss: 0.427 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7638003826141357
Epoch: 12, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.404 Vali Acc: 0.841 Test Loss: 0.404 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7623746395111084
Epoch: 13, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.398 Vali Acc: 0.848 Test Loss: 0.398 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.854403018951416
Epoch: 14, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.376 Vali Acc: 0.848 Test Loss: 0.376 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7915394306182861
Epoch: 15, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.373 Vali Acc: 0.870 Test Loss: 0.373 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 16 cost time: 0.7900264263153076
Epoch: 16, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.380 Vali Acc: 0.855 Test Loss: 0.380 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.79378342628479
Epoch: 17, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.361 Vali Acc: 0.877 Test Loss: 0.361 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 18 cost time: 0.798553466796875
Epoch: 18, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.360 Vali Acc: 0.877 Test Loss: 0.360 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 19 cost time: 0.806800365447998
Epoch: 19, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.378 Vali Acc: 0.870 Test Loss: 0.378 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7734718322753906
Epoch: 20, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.370 Vali Acc: 0.870 Test Loss: 0.370 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8122937679290771
Epoch: 21, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.371 Vali Acc: 0.862 Test Loss: 0.371 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8206133842468262
Epoch: 22, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.367 Vali Acc: 0.862 Test Loss: 0.367 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8016741275787354
Epoch: 23, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.354 Vali Acc: 0.877 Test Loss: 0.354 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 24 cost time: 0.8272032737731934
Epoch: 24, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.367 Vali Acc: 0.877 Test Loss: 0.367 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7568063735961914
Epoch: 25, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.386 Vali Acc: 0.855 Test Loss: 0.386 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8003613948822021
Epoch: 26, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.383 Vali Acc: 0.870 Test Loss: 0.383 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8306872844696045
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.372 Vali Acc: 0.870 Test Loss: 0.372 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7463243007659912
Epoch: 28, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.347 Vali Acc: 0.891 Test Loss: 0.347 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 29 cost time: 0.7921266555786133
Epoch: 29, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.348 Vali Acc: 0.891 Test Loss: 0.348 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.812518835067749
Epoch: 30, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.387 Vali Acc: 0.870 Test Loss: 0.387 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8413887023925781
Epoch: 31, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.397 Vali Acc: 0.870 Test Loss: 0.397 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8131074905395508
Epoch: 32, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.392 Vali Acc: 0.877 Test Loss: 0.392 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8046913146972656
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.367 Vali Acc: 0.870 Test Loss: 0.367 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8269433975219727
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.365 Vali Acc: 0.877 Test Loss: 0.365 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8276009559631348
Epoch: 35, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.354 Vali Acc: 0.891 Test Loss: 0.354 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8977909088134766
Epoch: 36, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.355 Vali Acc: 0.899 Test Loss: 0.355 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 37 cost time: 0.8814437389373779
Epoch: 37, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.390 Vali Acc: 0.877 Test Loss: 0.390 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8390247821807861
Epoch: 38, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.423 Vali Acc: 0.862 Test Loss: 0.423 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8745613098144531
Epoch: 39, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.417 Vali Acc: 0.862 Test Loss: 0.417 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8398623466491699
Epoch: 40, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.407 Vali Acc: 0.862 Test Loss: 0.407 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8605806827545166
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.398 Vali Acc: 0.862 Test Loss: 0.398 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8829119205474854
Epoch: 42, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.384 Vali Acc: 0.884 Test Loss: 0.384 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.835700511932373
Epoch: 43, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.385 Vali Acc: 0.891 Test Loss: 0.385 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8619234561920166
Epoch: 44, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.399 Vali Acc: 0.884 Test Loss: 0.399 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8475222587585449
Epoch: 45, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.414 Vali Acc: 0.877 Test Loss: 0.414 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.8403842449188232
Epoch: 46, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.403 Vali Acc: 0.891 Test Loss: 0.403 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 1117060
model size : 4.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0943384170532227
Epoch: 1, Steps: 9 | Train Loss: 1.375 Vali Loss: 1.355 Vali Acc: 0.319 Test Loss: 1.355 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 0.7553021907806396
Epoch: 2, Steps: 9 | Train Loss: 1.276 Vali Loss: 1.269 Vali Acc: 0.449 Test Loss: 1.269 Test Acc: 0.449
Validation loss decreased (-0.318827 --> -0.449263).  Saving model ...
Epoch: 3 cost time: 0.7403607368469238
Epoch: 3, Steps: 9 | Train Loss: 1.139 Vali Loss: 1.136 Vali Acc: 0.536 Test Loss: 1.136 Test Acc: 0.536
Validation loss decreased (-0.449263 --> -0.536221).  Saving model ...
Epoch: 4 cost time: 0.7599880695343018
Epoch: 4, Steps: 9 | Train Loss: 0.973 Vali Loss: 0.994 Vali Acc: 0.659 Test Loss: 0.994 Test Acc: 0.659
Validation loss decreased (-0.536221 --> -0.659410).  Saving model ...
Epoch: 5 cost time: 0.7177891731262207
Epoch: 5, Steps: 9 | Train Loss: 0.785 Vali Loss: 0.850 Vali Acc: 0.703 Test Loss: 0.850 Test Acc: 0.703
Validation loss decreased (-0.659410 --> -0.702890).  Saving model ...
Epoch: 6 cost time: 0.775620698928833
Epoch: 6, Steps: 9 | Train Loss: 0.630 Vali Loss: 0.734 Vali Acc: 0.746 Test Loss: 0.734 Test Acc: 0.746
Validation loss decreased (-0.702890 --> -0.746369).  Saving model ...
Epoch: 7 cost time: 0.8025100231170654
Epoch: 7, Steps: 9 | Train Loss: 0.502 Vali Loss: 0.643 Vali Acc: 0.768 Test Loss: 0.643 Test Acc: 0.768
Validation loss decreased (-0.746369 --> -0.768110).  Saving model ...
Epoch: 8 cost time: 0.8095078468322754
Epoch: 8, Steps: 9 | Train Loss: 0.378 Vali Loss: 0.579 Vali Acc: 0.783 Test Loss: 0.579 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782603).  Saving model ...
Epoch: 9 cost time: 0.7841193675994873
Epoch: 9, Steps: 9 | Train Loss: 0.290 Vali Loss: 0.530 Vali Acc: 0.804 Test Loss: 0.530 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804343).  Saving model ...
Epoch: 10 cost time: 0.7589099407196045
Epoch: 10, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.488 Vali Acc: 0.833 Test Loss: 0.488 Test Acc: 0.833
Validation loss decreased (-0.804343 --> -0.833328).  Saving model ...
Epoch: 11 cost time: 0.8010730743408203
Epoch: 11, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.461 Vali Acc: 0.826 Test Loss: 0.461 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7905242443084717
Epoch: 12, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.444 Vali Acc: 0.826 Test Loss: 0.444 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8340766429901123
Epoch: 13, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.420 Vali Acc: 0.826 Test Loss: 0.420 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8094284534454346
Epoch: 14, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.420 Vali Acc: 0.826 Test Loss: 0.420 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7836289405822754
Epoch: 15, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.397 Vali Acc: 0.848 Test Loss: 0.397 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847822).  Saving model ...
Epoch: 16 cost time: 0.7179641723632812
Epoch: 16, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.379 Vali Acc: 0.848 Test Loss: 0.379 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 17 cost time: 0.7986936569213867
Epoch: 17, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.377 Vali Acc: 0.826 Test Loss: 0.377 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.780073881149292
Epoch: 18, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.409 Vali Acc: 0.826 Test Loss: 0.409 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7622675895690918
Epoch: 19, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.428 Vali Acc: 0.848 Test Loss: 0.428 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8535366058349609
Epoch: 20, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.412 Vali Acc: 0.848 Test Loss: 0.412 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8080472946166992
Epoch: 21, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.409 Vali Acc: 0.848 Test Loss: 0.409 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8101553916931152
Epoch: 22, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.398 Vali Acc: 0.855 Test Loss: 0.398 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 23 cost time: 0.7849764823913574
Epoch: 23, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.400 Vali Acc: 0.855 Test Loss: 0.400 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7801177501678467
Epoch: 24, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.398 Vali Acc: 0.855 Test Loss: 0.398 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 25 cost time: 0.8070478439331055
Epoch: 25, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.393 Vali Acc: 0.841 Test Loss: 0.393 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.766249418258667
Epoch: 26, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.422 Vali Acc: 0.833 Test Loss: 0.422 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8983914852142334
Epoch: 27, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.442 Vali Acc: 0.848 Test Loss: 0.442 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7925195693969727
Epoch: 28, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.433 Vali Acc: 0.848 Test Loss: 0.433 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7468323707580566
Epoch: 29, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.380 Vali Acc: 0.855 Test Loss: 0.380 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855069).  Saving model ...
Epoch: 30 cost time: 0.7439901828765869
Epoch: 30, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.374 Vali Acc: 0.862 Test Loss: 0.374 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 31 cost time: 0.776472806930542
Epoch: 31, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.402 Vali Acc: 0.855 Test Loss: 0.402 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7684366703033447
Epoch: 32, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.419 Vali Acc: 0.855 Test Loss: 0.419 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8087410926818848
Epoch: 33, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.416 Vali Acc: 0.848 Test Loss: 0.416 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7769997119903564
Epoch: 34, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.420 Vali Acc: 0.841 Test Loss: 0.420 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.826068639755249
Epoch: 35, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.442 Vali Acc: 0.826 Test Loss: 0.442 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7989768981933594
Epoch: 36, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.448 Vali Acc: 0.833 Test Loss: 0.448 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7778158187866211
Epoch: 37, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.449 Vali Acc: 0.833 Test Loss: 0.449 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7823741436004639
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.450 Vali Acc: 0.855 Test Loss: 0.450 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7487835884094238
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.448 Vali Acc: 0.855 Test Loss: 0.448 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7773892879486084
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.450 Vali Acc: 0.855 Test Loss: 0.450 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1115268
model size : 4.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9922513961791992
Epoch: 1, Steps: 9 | Train Loss: 1.332 Vali Loss: 1.296 Vali Acc: 0.377 Test Loss: 1.296 Test Acc: 0.377
Validation loss decreased (inf --> -0.376799).  Saving model ...
Epoch: 2 cost time: 0.7417111396789551
Epoch: 2, Steps: 9 | Train Loss: 1.141 Vali Loss: 1.102 Vali Acc: 0.703 Test Loss: 1.102 Test Acc: 0.703
Validation loss decreased (-0.376799 --> -0.702888).  Saving model ...
Epoch: 3 cost time: 0.6279692649841309
Epoch: 3, Steps: 9 | Train Loss: 0.862 Vali Loss: 0.856 Vali Acc: 0.819 Test Loss: 0.856 Test Acc: 0.819
Validation loss decreased (-0.702888 --> -0.818832).  Saving model ...
Epoch: 4 cost time: 0.7049241065979004
Epoch: 4, Steps: 9 | Train Loss: 0.600 Vali Loss: 0.630 Vali Acc: 0.855 Test Loss: 0.630 Test Acc: 0.855
Validation loss decreased (-0.818832 --> -0.855066).  Saving model ...
Epoch: 5 cost time: 0.6277906894683838
Epoch: 5, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.434 Vali Acc: 0.899 Test Loss: 0.434 Test Acc: 0.899
Validation loss decreased (-0.855066 --> -0.898546).  Saving model ...
Epoch: 6 cost time: 0.6338198184967041
Epoch: 6, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.308 Vali Acc: 0.942 Test Loss: 0.308 Test Acc: 0.942
Validation loss decreased (-0.898546 --> -0.942026).  Saving model ...
Epoch: 7 cost time: 0.6317164897918701
Epoch: 7, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.252 Vali Acc: 0.928 Test Loss: 0.252 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6861388683319092
Epoch: 8, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.244 Vali Acc: 0.928 Test Loss: 0.244 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7515227794647217
Epoch: 9, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.222 Vali Acc: 0.942 Test Loss: 0.222 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 10 cost time: 0.6689720153808594
Epoch: 10, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.220 Vali Acc: 0.935 Test Loss: 0.220 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6613602638244629
Epoch: 11, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.219 Vali Acc: 0.928 Test Loss: 0.219 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.673609733581543
Epoch: 12, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.191 Vali Acc: 0.942 Test Loss: 0.191 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 13 cost time: 0.6503894329071045
Epoch: 13, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.187 Vali Acc: 0.942 Test Loss: 0.187 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 14 cost time: 0.6452105045318604
Epoch: 14, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.200 Vali Acc: 0.942 Test Loss: 0.200 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6391685009002686
Epoch: 15, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.204 Vali Acc: 0.935 Test Loss: 0.204 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.730170488357544
Epoch: 16, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.215 Vali Acc: 0.928 Test Loss: 0.215 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6854720115661621
Epoch: 17, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.204 Vali Acc: 0.935 Test Loss: 0.204 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6968584060668945
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7509517669677734
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.928 Test Loss: 0.194 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6545388698577881
Epoch: 20, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6383199691772461
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.928 Test Loss: 0.209 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6681094169616699
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.213 Vali Acc: 0.935 Test Loss: 0.213 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6763806343078613
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.928 Test Loss: 0.213 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 338628
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0194106101989746
Epoch: 1, Steps: 9 | Train Loss: 1.367 Vali Loss: 1.345 Vali Acc: 0.391 Test Loss: 1.345 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 0.6585288047790527
Epoch: 2, Steps: 9 | Train Loss: 1.244 Vali Loss: 1.228 Vali Acc: 0.580 Test Loss: 1.228 Test Acc: 0.580
Validation loss decreased (-0.391291 --> -0.579698).  Saving model ...
Epoch: 3 cost time: 0.6844098567962646
Epoch: 3, Steps: 9 | Train Loss: 1.070 Vali Loss: 1.061 Vali Acc: 0.717 Test Loss: 1.061 Test Acc: 0.717
Validation loss decreased (-0.579698 --> -0.717381).  Saving model ...
Epoch: 4 cost time: 0.6413164138793945
Epoch: 4, Steps: 9 | Train Loss: 0.857 Vali Loss: 0.887 Vali Acc: 0.819 Test Loss: 0.887 Test Acc: 0.819
Validation loss decreased (-0.717381 --> -0.818832).  Saving model ...
Epoch: 5 cost time: 0.655109167098999
Epoch: 5, Steps: 9 | Train Loss: 0.644 Vali Loss: 0.719 Vali Acc: 0.855 Test Loss: 0.719 Test Acc: 0.855
Validation loss decreased (-0.818832 --> -0.855065).  Saving model ...
Epoch: 6 cost time: 0.6753590106964111
Epoch: 6, Steps: 9 | Train Loss: 0.474 Vali Loss: 0.559 Vali Acc: 0.848 Test Loss: 0.559 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6968457698822021
Epoch: 7, Steps: 9 | Train Loss: 0.325 Vali Loss: 0.441 Vali Acc: 0.884 Test Loss: 0.441 Test Acc: 0.884
Validation loss decreased (-0.855065 --> -0.884054).  Saving model ...
Epoch: 8 cost time: 0.7193012237548828
Epoch: 8, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.369 Vali Acc: 0.884 Test Loss: 0.369 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 9 cost time: 0.6940352916717529
Epoch: 9, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.322 Vali Acc: 0.913 Test Loss: 0.322 Test Acc: 0.913
Validation loss decreased (-0.884054 --> -0.913040).  Saving model ...
Epoch: 10 cost time: 0.7514431476593018
Epoch: 10, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.287 Vali Acc: 0.920 Test Loss: 0.287 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 11 cost time: 0.6931345462799072
Epoch: 11, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.277 Vali Acc: 0.920 Test Loss: 0.277 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 12 cost time: 0.6963646411895752
Epoch: 12, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.258 Vali Acc: 0.920 Test Loss: 0.258 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 13 cost time: 0.6674597263336182
Epoch: 13, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.248 Vali Acc: 0.928 Test Loss: 0.248 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 14 cost time: 0.6994166374206543
Epoch: 14, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.253 Vali Acc: 0.928 Test Loss: 0.253 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.692270040512085
Epoch: 15, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.256 Vali Acc: 0.928 Test Loss: 0.256 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6815459728240967
Epoch: 16, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.252 Vali Acc: 0.928 Test Loss: 0.252 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6801090240478516
Epoch: 17, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.242 Vali Acc: 0.920 Test Loss: 0.242 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7303028106689453
Epoch: 18, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.229 Vali Acc: 0.920 Test Loss: 0.229 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6812260150909424
Epoch: 19, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.226 Vali Acc: 0.920 Test Loss: 0.226 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6906938552856445
Epoch: 20, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.226 Vali Acc: 0.920 Test Loss: 0.226 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7141845226287842
Epoch: 21, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.233 Vali Acc: 0.920 Test Loss: 0.233 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7182543277740479
Epoch: 22, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.242 Vali Acc: 0.920 Test Loss: 0.242 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6888701915740967
Epoch: 23, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.222 Vali Acc: 0.920 Test Loss: 0.222 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 312836
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.025475025177002
Epoch: 1, Steps: 9 | Train Loss: 1.357 Vali Loss: 1.334 Vali Acc: 0.384 Test Loss: 1.334 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 0.6855819225311279
Epoch: 2, Steps: 9 | Train Loss: 1.254 Vali Loss: 1.249 Vali Acc: 0.514 Test Loss: 1.249 Test Acc: 0.514
Validation loss decreased (-0.384045 --> -0.514480).  Saving model ...
Epoch: 3 cost time: 0.6777560710906982
Epoch: 3, Steps: 9 | Train Loss: 1.126 Vali Loss: 1.119 Vali Acc: 0.732 Test Loss: 1.119 Test Acc: 0.732
Validation loss decreased (-0.514480 --> -0.731873).  Saving model ...
Epoch: 4 cost time: 0.7162580490112305
Epoch: 4, Steps: 9 | Train Loss: 0.970 Vali Loss: 0.978 Vali Acc: 0.746 Test Loss: 0.978 Test Acc: 0.746
Validation loss decreased (-0.731873 --> -0.746367).  Saving model ...
Epoch: 5 cost time: 0.6760833263397217
Epoch: 5, Steps: 9 | Train Loss: 0.788 Vali Loss: 0.821 Vali Acc: 0.848 Test Loss: 0.821 Test Acc: 0.848
Validation loss decreased (-0.746367 --> -0.847818).  Saving model ...
Epoch: 6 cost time: 0.6205410957336426
Epoch: 6, Steps: 9 | Train Loss: 0.634 Vali Loss: 0.691 Vali Acc: 0.841 Test Loss: 0.691 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7453005313873291
Epoch: 7, Steps: 9 | Train Loss: 0.465 Vali Loss: 0.558 Vali Acc: 0.884 Test Loss: 0.558 Test Acc: 0.884
Validation loss decreased (-0.847818 --> -0.884052).  Saving model ...
Epoch: 8 cost time: 0.8539400100708008
Epoch: 8, Steps: 9 | Train Loss: 0.349 Vali Loss: 0.454 Vali Acc: 0.899 Test Loss: 0.454 Test Acc: 0.899
Validation loss decreased (-0.884052 --> -0.898546).  Saving model ...
Epoch: 9 cost time: 0.7187049388885498
Epoch: 9, Steps: 9 | Train Loss: 0.273 Vali Loss: 0.399 Vali Acc: 0.884 Test Loss: 0.399 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6815006732940674
Epoch: 10, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.350 Vali Acc: 0.899 Test Loss: 0.350 Test Acc: 0.899
Validation loss decreased (-0.898546 --> -0.898547).  Saving model ...
Epoch: 11 cost time: 0.6923928260803223
Epoch: 11, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.321 Vali Acc: 0.913 Test Loss: 0.321 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913040).  Saving model ...
Epoch: 12 cost time: 0.7670156955718994
Epoch: 12, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.319 Vali Acc: 0.891 Test Loss: 0.319 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7081558704376221
Epoch: 13, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.287 Vali Acc: 0.899 Test Loss: 0.287 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6775791645050049
Epoch: 14, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.269 Vali Acc: 0.920 Test Loss: 0.269 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 15 cost time: 0.6666455268859863
Epoch: 15, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.261 Vali Acc: 0.899 Test Loss: 0.261 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7002801895141602
Epoch: 16, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.263 Vali Acc: 0.899 Test Loss: 0.263 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6985712051391602
Epoch: 17, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.248 Vali Acc: 0.906 Test Loss: 0.248 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6900191307067871
Epoch: 18, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.247 Vali Acc: 0.899 Test Loss: 0.247 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7433075904846191
Epoch: 19, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.255 Vali Acc: 0.906 Test Loss: 0.255 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7171399593353271
Epoch: 20, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.259 Vali Acc: 0.906 Test Loss: 0.259 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6323583126068115
Epoch: 21, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.254 Vali Acc: 0.906 Test Loss: 0.254 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7870819568634033
Epoch: 22, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.253 Vali Acc: 0.906 Test Loss: 0.253 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.740351676940918
Epoch: 23, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6823911666870117
Epoch: 24, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.255 Vali Acc: 0.906 Test Loss: 0.255 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 307012
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.784858226776123
Epoch: 1, Steps: 9 | Train Loss: 1.387 Vali Loss: 1.361 Vali Acc: 0.471 Test Loss: 1.361 Test Acc: 0.471
Validation loss decreased (inf --> -0.471001).  Saving model ...
Epoch: 2 cost time: 0.6878273487091064
Epoch: 2, Steps: 9 | Train Loss: 1.311 Vali Loss: 1.289 Vali Acc: 0.551 Test Loss: 1.289 Test Acc: 0.551
Validation loss decreased (-0.471001 --> -0.550712).  Saving model ...
Epoch: 3 cost time: 0.7081453800201416
Epoch: 3, Steps: 9 | Train Loss: 1.194 Vali Loss: 1.185 Vali Acc: 0.688 Test Loss: 1.185 Test Acc: 0.688
Validation loss decreased (-0.550712 --> -0.688394).  Saving model ...
Epoch: 4 cost time: 0.7362115383148193
Epoch: 4, Steps: 9 | Train Loss: 1.057 Vali Loss: 1.065 Vali Acc: 0.768 Test Loss: 1.065 Test Acc: 0.768
Validation loss decreased (-0.688394 --> -0.768105).  Saving model ...
Epoch: 5 cost time: 0.6837959289550781
Epoch: 5, Steps: 9 | Train Loss: 0.905 Vali Loss: 0.944 Vali Acc: 0.812 Test Loss: 0.944 Test Acc: 0.812
Validation loss decreased (-0.768105 --> -0.811585).  Saving model ...
Epoch: 6 cost time: 0.7111597061157227
Epoch: 6, Steps: 9 | Train Loss: 0.759 Vali Loss: 0.821 Vali Acc: 0.833 Test Loss: 0.821 Test Acc: 0.833
Validation loss decreased (-0.811585 --> -0.833325).  Saving model ...
Epoch: 7 cost time: 0.7054712772369385
Epoch: 7, Steps: 9 | Train Loss: 0.609 Vali Loss: 0.702 Vali Acc: 0.862 Test Loss: 0.702 Test Acc: 0.862
Validation loss decreased (-0.833325 --> -0.862312).  Saving model ...
Epoch: 8 cost time: 0.7342128753662109
Epoch: 8, Steps: 9 | Train Loss: 0.472 Vali Loss: 0.600 Vali Acc: 0.870 Test Loss: 0.600 Test Acc: 0.870
Validation loss decreased (-0.862312 --> -0.869559).  Saving model ...
Epoch: 9 cost time: 0.7514505386352539
Epoch: 9, Steps: 9 | Train Loss: 0.369 Vali Loss: 0.514 Vali Acc: 0.884 Test Loss: 0.514 Test Acc: 0.884
Validation loss decreased (-0.869559 --> -0.884053).  Saving model ...
Epoch: 10 cost time: 0.7666974067687988
Epoch: 10, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.448 Vali Acc: 0.884 Test Loss: 0.448 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 11 cost time: 0.6989667415618896
Epoch: 11, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.423 Vali Acc: 0.884 Test Loss: 0.423 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884054).  Saving model ...
Epoch: 12 cost time: 0.7411370277404785
Epoch: 12, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.381 Vali Acc: 0.899 Test Loss: 0.381 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 13 cost time: 0.6960234642028809
Epoch: 13, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.363 Vali Acc: 0.877 Test Loss: 0.363 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6829793453216553
Epoch: 14, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.349 Vali Acc: 0.884 Test Loss: 0.349 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7009809017181396
Epoch: 15, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.331 Vali Acc: 0.906 Test Loss: 0.331 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 16 cost time: 0.7275753021240234
Epoch: 16, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.325 Vali Acc: 0.913 Test Loss: 0.325 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 17 cost time: 0.7466545104980469
Epoch: 17, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.311 Vali Acc: 0.906 Test Loss: 0.311 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7043187618255615
Epoch: 18, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.319 Vali Acc: 0.913 Test Loss: 0.319 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 19 cost time: 0.7022125720977783
Epoch: 19, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.318 Vali Acc: 0.899 Test Loss: 0.318 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6572091579437256
Epoch: 20, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.313 Vali Acc: 0.891 Test Loss: 0.313 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7332367897033691
Epoch: 21, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.303 Vali Acc: 0.906 Test Loss: 0.303 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6985626220703125
Epoch: 22, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7443485260009766
Epoch: 23, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.300 Vali Acc: 0.899 Test Loss: 0.300 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7540063858032227
Epoch: 24, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.305 Vali Acc: 0.899 Test Loss: 0.305 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6477601528167725
Epoch: 25, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.302 Vali Acc: 0.906 Test Loss: 0.302 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.698357105255127
Epoch: 26, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.302 Vali Acc: 0.906 Test Loss: 0.302 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6785886287689209
Epoch: 27, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.298 Vali Acc: 0.891 Test Loss: 0.298 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6719074249267578
Epoch: 28, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.303 Vali Acc: 0.899 Test Loss: 0.303 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 301188
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0393059253692627
Epoch: 1, Steps: 9 | Train Loss: 1.405 Vali Loss: 1.369 Vali Acc: 0.246 Test Loss: 1.369 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 0.805539608001709
Epoch: 2, Steps: 9 | Train Loss: 1.358 Vali Loss: 1.322 Vali Acc: 0.370 Test Loss: 1.322 Test Acc: 0.370
Validation loss decreased (-0.246363 --> -0.369552).  Saving model ...
Epoch: 3 cost time: 0.713996410369873
Epoch: 3, Steps: 9 | Train Loss: 1.271 Vali Loss: 1.252 Vali Acc: 0.493 Test Loss: 1.252 Test Acc: 0.493
Validation loss decreased (-0.369552 --> -0.492741).  Saving model ...
Epoch: 4 cost time: 0.7403194904327393
Epoch: 4, Steps: 9 | Train Loss: 1.164 Vali Loss: 1.163 Vali Acc: 0.601 Test Loss: 1.163 Test Acc: 0.601
Validation loss decreased (-0.492741 --> -0.601438).  Saving model ...
Epoch: 5 cost time: 0.6985104084014893
Epoch: 5, Steps: 9 | Train Loss: 1.063 Vali Loss: 1.064 Vali Acc: 0.688 Test Loss: 1.064 Test Acc: 0.688
Validation loss decreased (-0.601438 --> -0.688395).  Saving model ...
Epoch: 6 cost time: 0.6894423961639404
Epoch: 6, Steps: 9 | Train Loss: 0.918 Vali Loss: 0.959 Vali Acc: 0.768 Test Loss: 0.959 Test Acc: 0.768
Validation loss decreased (-0.688395 --> -0.768106).  Saving model ...
Epoch: 7 cost time: 0.6695787906646729
Epoch: 7, Steps: 9 | Train Loss: 0.807 Vali Loss: 0.869 Vali Acc: 0.812 Test Loss: 0.869 Test Acc: 0.812
Validation loss decreased (-0.768106 --> -0.811586).  Saving model ...
Epoch: 8 cost time: 0.6052162647247314
Epoch: 8, Steps: 9 | Train Loss: 0.701 Vali Loss: 0.773 Vali Acc: 0.819 Test Loss: 0.773 Test Acc: 0.819
Validation loss decreased (-0.811586 --> -0.818833).  Saving model ...
Epoch: 9 cost time: 0.7492468357086182
Epoch: 9, Steps: 9 | Train Loss: 0.577 Vali Loss: 0.693 Vali Acc: 0.826 Test Loss: 0.693 Test Acc: 0.826
Validation loss decreased (-0.818833 --> -0.826080).  Saving model ...
Epoch: 10 cost time: 0.6300950050354004
Epoch: 10, Steps: 9 | Train Loss: 0.476 Vali Loss: 0.633 Vali Acc: 0.833 Test Loss: 0.633 Test Acc: 0.833
Validation loss decreased (-0.826080 --> -0.833327).  Saving model ...
Epoch: 11 cost time: 0.6845660209655762
Epoch: 11, Steps: 9 | Train Loss: 0.412 Vali Loss: 0.565 Vali Acc: 0.841 Test Loss: 0.565 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840574).  Saving model ...
Epoch: 12 cost time: 0.6848294734954834
Epoch: 12, Steps: 9 | Train Loss: 0.312 Vali Loss: 0.518 Vali Acc: 0.848 Test Loss: 0.518 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 13 cost time: 0.689267635345459
Epoch: 13, Steps: 9 | Train Loss: 0.273 Vali Loss: 0.497 Vali Acc: 0.855 Test Loss: 0.497 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 14 cost time: 0.715195894241333
Epoch: 14, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.466 Vali Acc: 0.855 Test Loss: 0.466 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855068).  Saving model ...
Epoch: 15 cost time: 0.695549726486206
Epoch: 15, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.441 Vali Acc: 0.855 Test Loss: 0.441 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 16 cost time: 0.6704745292663574
Epoch: 16, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.409 Vali Acc: 0.862 Test Loss: 0.409 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 17 cost time: 0.6518070697784424
Epoch: 17, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.390 Vali Acc: 0.862 Test Loss: 0.390 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 18 cost time: 0.6549437046051025
Epoch: 18, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.381 Vali Acc: 0.870 Test Loss: 0.381 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 19 cost time: 0.6330158710479736
Epoch: 19, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.385 Vali Acc: 0.870 Test Loss: 0.385 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6752703189849854
Epoch: 20, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.381 Vali Acc: 0.877 Test Loss: 0.381 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 21 cost time: 0.7219405174255371
Epoch: 21, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.371 Vali Acc: 0.877 Test Loss: 0.371 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 22 cost time: 0.6377992630004883
Epoch: 22, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.354 Vali Acc: 0.877 Test Loss: 0.354 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 23 cost time: 0.7042520046234131
Epoch: 23, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.354 Vali Acc: 0.877 Test Loss: 0.354 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 24 cost time: 0.6523234844207764
Epoch: 24, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.359 Vali Acc: 0.884 Test Loss: 0.359 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 25 cost time: 0.6558029651641846
Epoch: 25, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.346 Vali Acc: 0.899 Test Loss: 0.346 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 26 cost time: 0.6403095722198486
Epoch: 26, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.332 Vali Acc: 0.899 Test Loss: 0.332 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 27 cost time: 0.6362767219543457
Epoch: 27, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.329 Vali Acc: 0.899 Test Loss: 0.329 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 28 cost time: 0.7015883922576904
Epoch: 28, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.332 Vali Acc: 0.899 Test Loss: 0.332 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.666363000869751
Epoch: 29, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.341 Vali Acc: 0.899 Test Loss: 0.341 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6870546340942383
Epoch: 30, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.329 Vali Acc: 0.899 Test Loss: 0.329 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6596453189849854
Epoch: 31, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.327 Vali Acc: 0.906 Test Loss: 0.327 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 32 cost time: 0.7880852222442627
Epoch: 32, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.331 Vali Acc: 0.913 Test Loss: 0.331 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 33 cost time: 0.6398599147796631
Epoch: 33, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.353 Vali Acc: 0.899 Test Loss: 0.353 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6724579334259033
Epoch: 34, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.337 Vali Acc: 0.913 Test Loss: 0.337 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6732735633850098
Epoch: 35, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.335 Vali Acc: 0.913 Test Loss: 0.335 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6528887748718262
Epoch: 36, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.325 Vali Acc: 0.913 Test Loss: 0.325 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 37 cost time: 0.7110912799835205
Epoch: 37, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.324 Vali Acc: 0.913 Test Loss: 0.324 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 38 cost time: 0.7034578323364258
Epoch: 38, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.338 Vali Acc: 0.906 Test Loss: 0.338 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6549041271209717
Epoch: 39, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.343 Vali Acc: 0.906 Test Loss: 0.343 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7403502464294434
Epoch: 40, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.349 Vali Acc: 0.906 Test Loss: 0.349 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6737384796142578
Epoch: 41, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.336 Vali Acc: 0.913 Test Loss: 0.336 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6090381145477295
Epoch: 42, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.350 Vali Acc: 0.906 Test Loss: 0.350 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6734254360198975
Epoch: 43, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.349 Vali Acc: 0.906 Test Loss: 0.349 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6971986293792725
Epoch: 44, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.361 Vali Acc: 0.899 Test Loss: 0.361 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.6302452087402344
Epoch: 45, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.345 Vali Acc: 0.899 Test Loss: 0.345 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.6467788219451904
Epoch: 46, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.331 Vali Acc: 0.906 Test Loss: 0.331 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.7536165714263916
Epoch: 47, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.334 Vali Acc: 0.906 Test Loss: 0.334 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 297220
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0353171825408936
Epoch: 1, Steps: 9 | Train Loss: 1.394 Vali Loss: 1.365 Vali Acc: 0.268 Test Loss: 1.365 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 0.6379203796386719
Epoch: 2, Steps: 9 | Train Loss: 1.326 Vali Loss: 1.310 Vali Acc: 0.377 Test Loss: 1.310 Test Acc: 0.377
Validation loss decreased (-0.268102 --> -0.376798).  Saving model ...
Epoch: 3 cost time: 0.6710472106933594
Epoch: 3, Steps: 9 | Train Loss: 1.233 Vali Loss: 1.222 Vali Acc: 0.493 Test Loss: 1.222 Test Acc: 0.493
Validation loss decreased (-0.376798 --> -0.492741).  Saving model ...
Epoch: 4 cost time: 0.671123743057251
Epoch: 4, Steps: 9 | Train Loss: 1.138 Vali Loss: 1.128 Vali Acc: 0.565 Test Loss: 1.128 Test Acc: 0.565
Validation loss decreased (-0.492741 --> -0.565206).  Saving model ...
Epoch: 5 cost time: 0.7087488174438477
Epoch: 5, Steps: 9 | Train Loss: 1.003 Vali Loss: 1.031 Vali Acc: 0.645 Test Loss: 1.031 Test Acc: 0.645
Validation loss decreased (-0.565206 --> -0.644917).  Saving model ...
Epoch: 6 cost time: 0.6715891361236572
Epoch: 6, Steps: 9 | Train Loss: 0.894 Vali Loss: 0.942 Vali Acc: 0.696 Test Loss: 0.942 Test Acc: 0.696
Validation loss decreased (-0.644917 --> -0.695643).  Saving model ...
Epoch: 7 cost time: 0.737321138381958
Epoch: 7, Steps: 9 | Train Loss: 0.778 Vali Loss: 0.854 Vali Acc: 0.732 Test Loss: 0.854 Test Acc: 0.732
Validation loss decreased (-0.695643 --> -0.731876).  Saving model ...
Epoch: 8 cost time: 0.6643404960632324
Epoch: 8, Steps: 9 | Train Loss: 0.687 Vali Loss: 0.777 Vali Acc: 0.768 Test Loss: 0.777 Test Acc: 0.768
Validation loss decreased (-0.731876 --> -0.768108).  Saving model ...
Epoch: 9 cost time: 0.6539196968078613
Epoch: 9, Steps: 9 | Train Loss: 0.578 Vali Loss: 0.699 Vali Acc: 0.797 Test Loss: 0.699 Test Acc: 0.797
Validation loss decreased (-0.768108 --> -0.797094).  Saving model ...
Epoch: 10 cost time: 0.6634941101074219
Epoch: 10, Steps: 9 | Train Loss: 0.490 Vali Loss: 0.641 Vali Acc: 0.797 Test Loss: 0.641 Test Acc: 0.797
Validation loss decreased (-0.797094 --> -0.797095).  Saving model ...
Epoch: 11 cost time: 0.6363472938537598
Epoch: 11, Steps: 9 | Train Loss: 0.424 Vali Loss: 0.591 Vali Acc: 0.819 Test Loss: 0.591 Test Acc: 0.819
Validation loss decreased (-0.797095 --> -0.818835).  Saving model ...
Epoch: 12 cost time: 0.6376364231109619
Epoch: 12, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.562 Vali Acc: 0.841 Test Loss: 0.562 Test Acc: 0.841
Validation loss decreased (-0.818835 --> -0.840574).  Saving model ...
Epoch: 13 cost time: 0.6803839206695557
Epoch: 13, Steps: 9 | Train Loss: 0.313 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 14 cost time: 0.638918399810791
Epoch: 14, Steps: 9 | Train Loss: 0.257 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 15 cost time: 0.6808023452758789
Epoch: 15, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.475 Vali Acc: 0.841 Test Loss: 0.475 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 16 cost time: 0.6529514789581299
Epoch: 16, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.433 Vali Acc: 0.841 Test Loss: 0.433 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 17 cost time: 0.6119751930236816
Epoch: 17, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.422 Vali Acc: 0.855 Test Loss: 0.422 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 18 cost time: 0.6344659328460693
Epoch: 18, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.423 Vali Acc: 0.855 Test Loss: 0.423 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6678354740142822
Epoch: 19, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.410 Vali Acc: 0.855 Test Loss: 0.410 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 20 cost time: 0.6731622219085693
Epoch: 20, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.390 Vali Acc: 0.855 Test Loss: 0.390 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855069).  Saving model ...
Epoch: 21 cost time: 0.6738028526306152
Epoch: 21, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.386 Vali Acc: 0.862 Test Loss: 0.386 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 22 cost time: 0.6235487461090088
Epoch: 22, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.392 Vali Acc: 0.870 Test Loss: 0.392 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 23 cost time: 0.56180739402771
Epoch: 23, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.392 Vali Acc: 0.870 Test Loss: 0.392 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 24 cost time: 0.6077017784118652
Epoch: 24, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.377 Vali Acc: 0.870 Test Loss: 0.377 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 25 cost time: 0.5606300830841064
Epoch: 25, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.376 Vali Acc: 0.870 Test Loss: 0.376 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 26 cost time: 0.5760691165924072
Epoch: 26, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.366 Vali Acc: 0.870 Test Loss: 0.366 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869562).  Saving model ...
Epoch: 27 cost time: 0.5867691040039062
Epoch: 27, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.368 Vali Acc: 0.870 Test Loss: 0.368 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6424953937530518
Epoch: 28, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.363 Vali Acc: 0.877 Test Loss: 0.363 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 29 cost time: 0.6303815841674805
Epoch: 29, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.359 Vali Acc: 0.877 Test Loss: 0.359 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 30 cost time: 0.6964049339294434
Epoch: 30, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.360 Vali Acc: 0.870 Test Loss: 0.360 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6131448745727539
Epoch: 31, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.349 Vali Acc: 0.870 Test Loss: 0.349 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6521081924438477
Epoch: 32, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.369 Vali Acc: 0.855 Test Loss: 0.369 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.78080153465271
Epoch: 33, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.366 Vali Acc: 0.862 Test Loss: 0.366 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7169113159179688
Epoch: 34, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.375 Vali Acc: 0.862 Test Loss: 0.375 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6641314029693604
Epoch: 35, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.379 Vali Acc: 0.862 Test Loss: 0.379 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7391068935394287
Epoch: 36, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.376 Vali Acc: 0.855 Test Loss: 0.376 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.6162002086639404
Epoch: 37, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.370 Vali Acc: 0.855 Test Loss: 0.370 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6429839134216309
Epoch: 38, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.387 Vali Acc: 0.855 Test Loss: 0.387 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.6378576755523682
Epoch: 39, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.366 Vali Acc: 0.862 Test Loss: 0.366 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 296388
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0416419506073
Epoch: 1, Steps: 9 | Train Loss: 1.420 Vali Loss: 1.383 Vali Acc: 0.297 Test Loss: 1.383 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 0.6678633689880371
Epoch: 2, Steps: 9 | Train Loss: 1.358 Vali Loss: 1.347 Vali Acc: 0.348 Test Loss: 1.347 Test Acc: 0.348
Validation loss decreased (-0.297088 --> -0.347813).  Saving model ...
Epoch: 3 cost time: 0.689032793045044
Epoch: 3, Steps: 9 | Train Loss: 1.293 Vali Loss: 1.285 Vali Acc: 0.399 Test Loss: 1.285 Test Acc: 0.399
Validation loss decreased (-0.347813 --> -0.398538).  Saving model ...
Epoch: 4 cost time: 0.6669368743896484
Epoch: 4, Steps: 9 | Train Loss: 1.216 Vali Loss: 1.212 Vali Acc: 0.486 Test Loss: 1.212 Test Acc: 0.486
Validation loss decreased (-0.398538 --> -0.485495).  Saving model ...
Epoch: 5 cost time: 0.7172839641571045
Epoch: 5, Steps: 9 | Train Loss: 1.113 Vali Loss: 1.135 Vali Acc: 0.594 Test Loss: 1.135 Test Acc: 0.594
Validation loss decreased (-0.485495 --> -0.594192).  Saving model ...
Epoch: 6 cost time: 0.6844589710235596
Epoch: 6, Steps: 9 | Train Loss: 1.005 Vali Loss: 1.049 Vali Acc: 0.609 Test Loss: 1.049 Test Acc: 0.609
Validation loss decreased (-0.594192 --> -0.608685).  Saving model ...
Epoch: 7 cost time: 0.7288076877593994
Epoch: 7, Steps: 9 | Train Loss: 0.899 Vali Loss: 0.965 Vali Acc: 0.667 Test Loss: 0.965 Test Acc: 0.667
Validation loss decreased (-0.608685 --> -0.666657).  Saving model ...
Epoch: 8 cost time: 0.7228438854217529
Epoch: 8, Steps: 9 | Train Loss: 0.792 Vali Loss: 0.887 Vali Acc: 0.717 Test Loss: 0.887 Test Acc: 0.717
Validation loss decreased (-0.666657 --> -0.717382).  Saving model ...
Epoch: 9 cost time: 0.7582612037658691
Epoch: 9, Steps: 9 | Train Loss: 0.713 Vali Loss: 0.816 Vali Acc: 0.739 Test Loss: 0.816 Test Acc: 0.739
Validation loss decreased (-0.717382 --> -0.739122).  Saving model ...
Epoch: 10 cost time: 0.7688970565795898
Epoch: 10, Steps: 9 | Train Loss: 0.599 Vali Loss: 0.747 Vali Acc: 0.761 Test Loss: 0.747 Test Acc: 0.761
Validation loss decreased (-0.739122 --> -0.760862).  Saving model ...
Epoch: 11 cost time: 0.6139857769012451
Epoch: 11, Steps: 9 | Train Loss: 0.531 Vali Loss: 0.694 Vali Acc: 0.768 Test Loss: 0.694 Test Acc: 0.768
Validation loss decreased (-0.760862 --> -0.768109).  Saving model ...
Epoch: 12 cost time: 0.745368480682373
Epoch: 12, Steps: 9 | Train Loss: 0.451 Vali Loss: 0.648 Vali Acc: 0.775 Test Loss: 0.648 Test Acc: 0.775
Validation loss decreased (-0.768109 --> -0.775356).  Saving model ...
Epoch: 13 cost time: 0.7208766937255859
Epoch: 13, Steps: 9 | Train Loss: 0.392 Vali Loss: 0.606 Vali Acc: 0.775 Test Loss: 0.606 Test Acc: 0.775
Validation loss decreased (-0.775356 --> -0.775356).  Saving model ...
Epoch: 14 cost time: 0.750852108001709
Epoch: 14, Steps: 9 | Train Loss: 0.312 Vali Loss: 0.584 Vali Acc: 0.783 Test Loss: 0.584 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782603).  Saving model ...
Epoch: 15 cost time: 0.7387738227844238
Epoch: 15, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.547 Vali Acc: 0.797 Test Loss: 0.547 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 16 cost time: 0.734189510345459
Epoch: 16, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.512 Vali Acc: 0.804 Test Loss: 0.512 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804343).  Saving model ...
Epoch: 17 cost time: 0.7428677082061768
Epoch: 17, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.496 Vali Acc: 0.812 Test Loss: 0.496 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811589).  Saving model ...
Epoch: 18 cost time: 0.7283227443695068
Epoch: 18, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.477 Vali Acc: 0.833 Test Loss: 0.477 Test Acc: 0.833
Validation loss decreased (-0.811589 --> -0.833329).  Saving model ...
Epoch: 19 cost time: 0.7766435146331787
Epoch: 19, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.457 Vali Acc: 0.833 Test Loss: 0.457 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 20 cost time: 0.7223260402679443
Epoch: 20, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.444 Vali Acc: 0.826 Test Loss: 0.444 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6869163513183594
Epoch: 21, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.461 Vali Acc: 0.848 Test Loss: 0.461 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847821).  Saving model ...
Epoch: 22 cost time: 0.7662537097930908
Epoch: 22, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.459 Vali Acc: 0.841 Test Loss: 0.459 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7799906730651855
Epoch: 23, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.443 Vali Acc: 0.833 Test Loss: 0.443 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7113354206085205
Epoch: 24, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.418 Vali Acc: 0.833 Test Loss: 0.418 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7610020637512207
Epoch: 25, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.405 Vali Acc: 0.841 Test Loss: 0.405 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7907793521881104
Epoch: 26, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.402 Vali Acc: 0.833 Test Loss: 0.402 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7158699035644531
Epoch: 27, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.413 Vali Acc: 0.841 Test Loss: 0.413 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7197065353393555
Epoch: 28, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.395 Vali Acc: 0.855 Test Loss: 0.395 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855069).  Saving model ...
Epoch: 29 cost time: 0.714195728302002
Epoch: 29, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.390 Vali Acc: 0.848 Test Loss: 0.390 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7781982421875
Epoch: 30, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.389 Vali Acc: 0.855 Test Loss: 0.389 Test Acc: 0.855
Validation loss decreased (-0.855069 --> -0.855069).  Saving model ...
Epoch: 31 cost time: 0.7262649536132812
Epoch: 31, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.394 Vali Acc: 0.841 Test Loss: 0.394 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7147560119628906
Epoch: 32, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.408 Vali Acc: 0.855 Test Loss: 0.408 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.694136381149292
Epoch: 33, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.393 Vali Acc: 0.855 Test Loss: 0.393 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8976044654846191
Epoch: 34, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.381 Vali Acc: 0.855 Test Loss: 0.381 Test Acc: 0.855
Validation loss decreased (-0.855069 --> -0.855069).  Saving model ...
Epoch: 35 cost time: 0.7271850109100342
Epoch: 35, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.376 Vali Acc: 0.862 Test Loss: 0.376 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 36 cost time: 0.8237318992614746
Epoch: 36, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.391 Vali Acc: 0.855 Test Loss: 0.391 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7804079055786133
Epoch: 37, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.399 Vali Acc: 0.855 Test Loss: 0.399 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8090088367462158
Epoch: 38, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.396 Vali Acc: 0.855 Test Loss: 0.396 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7738494873046875
Epoch: 39, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.399 Vali Acc: 0.848 Test Loss: 0.399 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7732040882110596
Epoch: 40, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.398 Vali Acc: 0.862 Test Loss: 0.398 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7333211898803711
Epoch: 41, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.411 Vali Acc: 0.862 Test Loss: 0.411 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.8243072032928467
Epoch: 42, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.378 Vali Acc: 0.862 Test Loss: 0.378 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7940165996551514
Epoch: 43, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.370 Vali Acc: 0.862 Test Loss: 0.370 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 44 cost time: 0.7566707134246826
Epoch: 44, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.381 Vali Acc: 0.862 Test Loss: 0.381 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6951701641082764
Epoch: 45, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.383 Vali Acc: 0.862 Test Loss: 0.383 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7676348686218262
Epoch: 46, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.386 Vali Acc: 0.862 Test Loss: 0.386 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.7433614730834961
Epoch: 47, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.412 Vali Acc: 0.855 Test Loss: 0.412 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6644389629364014
Epoch: 48, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.421 Vali Acc: 0.862 Test Loss: 0.421 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.6874158382415771
Epoch: 49, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.399 Vali Acc: 0.862 Test Loss: 0.399 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.7175097465515137
Epoch: 50, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.400 Vali Acc: 0.862 Test Loss: 0.400 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 295492
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9092376232147217
Epoch: 1, Steps: 9 | Train Loss: 1.352 Vali Loss: 1.322 Vali Acc: 0.406 Test Loss: 1.322 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 0.6234166622161865
Epoch: 2, Steps: 9 | Train Loss: 1.223 Vali Loss: 1.192 Vali Acc: 0.609 Test Loss: 1.192 Test Acc: 0.609
Validation loss decreased (-0.405784 --> -0.608684).  Saving model ...
Epoch: 3 cost time: 0.5586981773376465
Epoch: 3, Steps: 9 | Train Loss: 1.039 Vali Loss: 1.032 Vali Acc: 0.725 Test Loss: 1.032 Test Acc: 0.725
Validation loss decreased (-0.608684 --> -0.724627).  Saving model ...
Epoch: 4 cost time: 0.6587049961090088
Epoch: 4, Steps: 9 | Train Loss: 0.860 Vali Loss: 0.847 Vali Acc: 0.804 Test Loss: 0.847 Test Acc: 0.804
Validation loss decreased (-0.724627 --> -0.804339).  Saving model ...
Epoch: 5 cost time: 0.6620025634765625
Epoch: 5, Steps: 9 | Train Loss: 0.662 Vali Loss: 0.678 Vali Acc: 0.891 Test Loss: 0.678 Test Acc: 0.891
Validation loss decreased (-0.804339 --> -0.891298).  Saving model ...
Epoch: 6 cost time: 0.6203300952911377
Epoch: 6, Steps: 9 | Train Loss: 0.476 Vali Loss: 0.538 Vali Acc: 0.913 Test Loss: 0.538 Test Acc: 0.913
Validation loss decreased (-0.891298 --> -0.913038).  Saving model ...
Epoch: 7 cost time: 0.6546094417572021
Epoch: 7, Steps: 9 | Train Loss: 0.326 Vali Loss: 0.436 Vali Acc: 0.899 Test Loss: 0.436 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5506742000579834
Epoch: 8, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.346 Vali Acc: 0.906 Test Loss: 0.346 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.609107494354248
Epoch: 9, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.298 Vali Acc: 0.935 Test Loss: 0.298 Test Acc: 0.935
Validation loss decreased (-0.913038 --> -0.934780).  Saving model ...
Epoch: 10 cost time: 0.5383796691894531
Epoch: 10, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.263 Vali Acc: 0.928 Test Loss: 0.263 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6343741416931152
Epoch: 11, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.243 Vali Acc: 0.928 Test Loss: 0.243 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.594214677810669
Epoch: 12, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.244 Vali Acc: 0.935 Test Loss: 0.244 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 13 cost time: 0.7051489353179932
Epoch: 13, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6645011901855469
Epoch: 14, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5878090858459473
Epoch: 15, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5980310440063477
Epoch: 16, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.196 Vali Acc: 0.928 Test Loss: 0.196 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5955162048339844
Epoch: 17, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.186 Vali Acc: 0.935 Test Loss: 0.186 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934781).  Saving model ...
Epoch: 18 cost time: 0.5526397228240967
Epoch: 18, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6130619049072266
Epoch: 19, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.201 Vali Acc: 0.935 Test Loss: 0.201 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6336894035339355
Epoch: 20, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6027359962463379
Epoch: 21, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6575272083282471
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6083710193634033
Epoch: 23, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.641185998916626
Epoch: 24, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.935 Test Loss: 0.200 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6025710105895996
Epoch: 25, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.200 Vali Acc: 0.928 Test Loss: 0.200 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.584458589553833
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.650993824005127
Epoch: 27, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 103780
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0219428539276123
Epoch: 1, Steps: 9 | Train Loss: 1.358 Vali Loss: 1.348 Vali Acc: 0.290 Test Loss: 1.348 Test Acc: 0.290
Validation loss decreased (inf --> -0.289842).  Saving model ...
Epoch: 2 cost time: 0.544985294342041
Epoch: 2, Steps: 9 | Train Loss: 1.306 Vali Loss: 1.288 Vali Acc: 0.312 Test Loss: 1.288 Test Acc: 0.312
Validation loss decreased (-0.289842 --> -0.311581).  Saving model ...
Epoch: 3 cost time: 0.6665568351745605
Epoch: 3, Steps: 9 | Train Loss: 1.212 Vali Loss: 1.199 Vali Acc: 0.478 Test Loss: 1.199 Test Acc: 0.478
Validation loss decreased (-0.311581 --> -0.478249).  Saving model ...
Epoch: 4 cost time: 0.6273305416107178
Epoch: 4, Steps: 9 | Train Loss: 1.100 Vali Loss: 1.097 Vali Acc: 0.667 Test Loss: 1.097 Test Acc: 0.667
Validation loss decreased (-0.478249 --> -0.666656).  Saving model ...
Epoch: 5 cost time: 0.5955164432525635
Epoch: 5, Steps: 9 | Train Loss: 0.967 Vali Loss: 0.985 Vali Acc: 0.783 Test Loss: 0.985 Test Acc: 0.783
Validation loss decreased (-0.666656 --> -0.782599).  Saving model ...
Epoch: 6 cost time: 0.6054270267486572
Epoch: 6, Steps: 9 | Train Loss: 0.841 Vali Loss: 0.883 Vali Acc: 0.826 Test Loss: 0.883 Test Acc: 0.826
Validation loss decreased (-0.782599 --> -0.826078).  Saving model ...
Epoch: 7 cost time: 0.5715434551239014
Epoch: 7, Steps: 9 | Train Loss: 0.704 Vali Loss: 0.770 Vali Acc: 0.841 Test Loss: 0.770 Test Acc: 0.841
Validation loss decreased (-0.826078 --> -0.840572).  Saving model ...
Epoch: 8 cost time: 0.5534005165100098
Epoch: 8, Steps: 9 | Train Loss: 0.588 Vali Loss: 0.661 Vali Acc: 0.862 Test Loss: 0.661 Test Acc: 0.862
Validation loss decreased (-0.840572 --> -0.862312).  Saving model ...
Epoch: 9 cost time: 0.5916247367858887
Epoch: 9, Steps: 9 | Train Loss: 0.481 Vali Loss: 0.577 Vali Acc: 0.862 Test Loss: 0.577 Test Acc: 0.862
Validation loss decreased (-0.862312 --> -0.862313).  Saving model ...
Epoch: 10 cost time: 0.573413610458374
Epoch: 10, Steps: 9 | Train Loss: 0.377 Vali Loss: 0.501 Vali Acc: 0.899 Test Loss: 0.501 Test Acc: 0.899
Validation loss decreased (-0.862313 --> -0.898546).  Saving model ...
Epoch: 11 cost time: 0.560448408126831
Epoch: 11, Steps: 9 | Train Loss: 0.312 Vali Loss: 0.448 Vali Acc: 0.906 Test Loss: 0.448 Test Acc: 0.906
Validation loss decreased (-0.898546 --> -0.905793).  Saving model ...
Epoch: 12 cost time: 0.6257343292236328
Epoch: 12, Steps: 9 | Train Loss: 0.249 Vali Loss: 0.397 Vali Acc: 0.906 Test Loss: 0.397 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 13 cost time: 0.7088038921356201
Epoch: 13, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.365 Vali Acc: 0.913 Test Loss: 0.365 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913040).  Saving model ...
Epoch: 14 cost time: 0.6360087394714355
Epoch: 14, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.330 Vali Acc: 0.920 Test Loss: 0.330 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 15 cost time: 0.6134302616119385
Epoch: 15, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.312 Vali Acc: 0.920 Test Loss: 0.312 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 16 cost time: 0.6195590496063232
Epoch: 16, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.297 Vali Acc: 0.913 Test Loss: 0.297 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6175551414489746
Epoch: 17, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.291 Vali Acc: 0.906 Test Loss: 0.291 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6489200592041016
Epoch: 18, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.273 Vali Acc: 0.913 Test Loss: 0.273 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5801529884338379
Epoch: 19, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.266 Vali Acc: 0.920 Test Loss: 0.266 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 20 cost time: 0.5899841785430908
Epoch: 20, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.249 Vali Acc: 0.935 Test Loss: 0.249 Test Acc: 0.935
Validation loss decreased (-0.920287 --> -0.934780).  Saving model ...
Epoch: 21 cost time: 0.5952465534210205
Epoch: 21, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.258 Vali Acc: 0.928 Test Loss: 0.258 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.609943151473999
Epoch: 22, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.252 Vali Acc: 0.920 Test Loss: 0.252 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6155753135681152
Epoch: 23, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.242 Vali Acc: 0.935 Test Loss: 0.242 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 24 cost time: 0.6174333095550537
Epoch: 24, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5828475952148438
Epoch: 25, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7519035339355469
Epoch: 26, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.598090410232544
Epoch: 27, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 28 cost time: 0.610231876373291
Epoch: 28, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.214 Vali Acc: 0.942 Test Loss: 0.214 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 29 cost time: 0.551983118057251
Epoch: 29, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.213 Vali Acc: 0.942 Test Loss: 0.213 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 30 cost time: 0.6049399375915527
Epoch: 30, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.212 Vali Acc: 0.935 Test Loss: 0.212 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6193461418151855
Epoch: 31, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.219 Vali Acc: 0.928 Test Loss: 0.219 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.620872974395752
Epoch: 32, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.213 Vali Acc: 0.920 Test Loss: 0.213 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6236734390258789
Epoch: 33, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6864349842071533
Epoch: 34, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6708598136901855
Epoch: 35, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.220 Vali Acc: 0.935 Test Loss: 0.220 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.5827491283416748
Epoch: 36, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.223 Vali Acc: 0.920 Test Loss: 0.223 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.6214876174926758
Epoch: 37, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.227 Vali Acc: 0.920 Test Loss: 0.227 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5961487293243408
Epoch: 38, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.224 Vali Acc: 0.920 Test Loss: 0.224 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.5881996154785156
Epoch: 39, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.223 Vali Acc: 0.920 Test Loss: 0.223 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 90884
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9453880786895752
Epoch: 1, Steps: 9 | Train Loss: 1.353 Vali Loss: 1.371 Vali Acc: 0.319 Test Loss: 1.371 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 0.6252963542938232
Epoch: 2, Steps: 9 | Train Loss: 1.297 Vali Loss: 1.330 Vali Acc: 0.384 Test Loss: 1.330 Test Acc: 0.384
Validation loss decreased (-0.318827 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 0.6480491161346436
Epoch: 3, Steps: 9 | Train Loss: 1.224 Vali Loss: 1.266 Vali Acc: 0.471 Test Loss: 1.266 Test Acc: 0.471
Validation loss decreased (-0.384045 --> -0.471002).  Saving model ...
Epoch: 4 cost time: 0.6218156814575195
Epoch: 4, Steps: 9 | Train Loss: 1.137 Vali Loss: 1.193 Vali Acc: 0.601 Test Loss: 1.193 Test Acc: 0.601
Validation loss decreased (-0.471002 --> -0.601437).  Saving model ...
Epoch: 5 cost time: 0.566047191619873
Epoch: 5, Steps: 9 | Train Loss: 1.048 Vali Loss: 1.110 Vali Acc: 0.688 Test Loss: 1.110 Test Acc: 0.688
Validation loss decreased (-0.601437 --> -0.688395).  Saving model ...
Epoch: 6 cost time: 0.6135575771331787
Epoch: 6, Steps: 9 | Train Loss: 0.940 Vali Loss: 1.016 Vali Acc: 0.696 Test Loss: 1.016 Test Acc: 0.696
Validation loss decreased (-0.688395 --> -0.695642).  Saving model ...
Epoch: 7 cost time: 0.6101195812225342
Epoch: 7, Steps: 9 | Train Loss: 0.836 Vali Loss: 0.918 Vali Acc: 0.746 Test Loss: 0.918 Test Acc: 0.746
Validation loss decreased (-0.695642 --> -0.746368).  Saving model ...
Epoch: 8 cost time: 0.5995888710021973
Epoch: 8, Steps: 9 | Train Loss: 0.712 Vali Loss: 0.828 Vali Acc: 0.819 Test Loss: 0.828 Test Acc: 0.819
Validation loss decreased (-0.746368 --> -0.818832).  Saving model ...
Epoch: 9 cost time: 0.6280131340026855
Epoch: 9, Steps: 9 | Train Loss: 0.610 Vali Loss: 0.733 Vali Acc: 0.841 Test Loss: 0.733 Test Acc: 0.841
Validation loss decreased (-0.818832 --> -0.840572).  Saving model ...
Epoch: 10 cost time: 0.6000082492828369
Epoch: 10, Steps: 9 | Train Loss: 0.516 Vali Loss: 0.644 Vali Acc: 0.855 Test Loss: 0.644 Test Acc: 0.855
Validation loss decreased (-0.840572 --> -0.855066).  Saving model ...
Epoch: 11 cost time: 0.5688390731811523
Epoch: 11, Steps: 9 | Train Loss: 0.416 Vali Loss: 0.560 Vali Acc: 0.884 Test Loss: 0.560 Test Acc: 0.884
Validation loss decreased (-0.855066 --> -0.884052).  Saving model ...
Epoch: 12 cost time: 0.6489970684051514
Epoch: 12, Steps: 9 | Train Loss: 0.356 Vali Loss: 0.505 Vali Acc: 0.891 Test Loss: 0.505 Test Acc: 0.891
Validation loss decreased (-0.884052 --> -0.891299).  Saving model ...
Epoch: 13 cost time: 0.6373000144958496
Epoch: 13, Steps: 9 | Train Loss: 0.293 Vali Loss: 0.443 Vali Acc: 0.899 Test Loss: 0.443 Test Acc: 0.899
Validation loss decreased (-0.891299 --> -0.898546).  Saving model ...
Epoch: 14 cost time: 0.5771188735961914
Epoch: 14, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.397 Vali Acc: 0.920 Test Loss: 0.397 Test Acc: 0.920
Validation loss decreased (-0.898546 --> -0.920286).  Saving model ...
Epoch: 15 cost time: 0.609248161315918
Epoch: 15, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.365 Vali Acc: 0.920 Test Loss: 0.365 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 16 cost time: 0.6048340797424316
Epoch: 16, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.338 Vali Acc: 0.935 Test Loss: 0.338 Test Acc: 0.935
Validation loss decreased (-0.920286 --> -0.934779).  Saving model ...
Epoch: 17 cost time: 0.7138440608978271
Epoch: 17, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.321 Vali Acc: 0.935 Test Loss: 0.321 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934779).  Saving model ...
Epoch: 18 cost time: 0.5783662796020508
Epoch: 18, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.300 Vali Acc: 0.942 Test Loss: 0.300 Test Acc: 0.942
Validation loss decreased (-0.934779 --> -0.942026).  Saving model ...
Epoch: 19 cost time: 0.6528620719909668
Epoch: 19, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.289 Vali Acc: 0.942 Test Loss: 0.289 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 20 cost time: 0.6041231155395508
Epoch: 20, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.275 Vali Acc: 0.949 Test Loss: 0.275 Test Acc: 0.949
Validation loss decreased (-0.942026 --> -0.949273).  Saving model ...
Epoch: 21 cost time: 0.6936311721801758
Epoch: 21, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.267 Vali Acc: 0.942 Test Loss: 0.267 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6351654529571533
Epoch: 22, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.258 Vali Acc: 0.949 Test Loss: 0.258 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 23 cost time: 0.6743247509002686
Epoch: 23, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.258 Vali Acc: 0.942 Test Loss: 0.258 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.741084098815918
Epoch: 24, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.249 Vali Acc: 0.928 Test Loss: 0.249 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7152655124664307
Epoch: 25, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.257 Vali Acc: 0.920 Test Loss: 0.257 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6567873954772949
Epoch: 26, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.254 Vali Acc: 0.920 Test Loss: 0.254 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.699474573135376
Epoch: 27, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.237 Vali Acc: 0.935 Test Loss: 0.237 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7220861911773682
Epoch: 28, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.226 Vali Acc: 0.942 Test Loss: 0.226 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7135457992553711
Epoch: 29, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.227 Vali Acc: 0.942 Test Loss: 0.227 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7022955417633057
Epoch: 30, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.223 Vali Acc: 0.935 Test Loss: 0.223 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7261562347412109
Epoch: 31, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8000187873840332
Epoch: 32, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.224 Vali Acc: 0.935 Test Loss: 0.224 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 87972
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8449077606201172
Epoch: 1, Steps: 9 | Train Loss: 1.408 Vali Loss: 1.370 Vali Acc: 0.268 Test Loss: 1.370 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 0.6164541244506836
Epoch: 2, Steps: 9 | Train Loss: 1.350 Vali Loss: 1.333 Vali Acc: 0.333 Test Loss: 1.333 Test Acc: 0.333
Validation loss decreased (-0.268102 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 0.6187515258789062
Epoch: 3, Steps: 9 | Train Loss: 1.283 Vali Loss: 1.276 Vali Acc: 0.486 Test Loss: 1.276 Test Acc: 0.486
Validation loss decreased (-0.333320 --> -0.485494).  Saving model ...
Epoch: 4 cost time: 0.6190829277038574
Epoch: 4, Steps: 9 | Train Loss: 1.215 Vali Loss: 1.205 Vali Acc: 0.558 Test Loss: 1.205 Test Acc: 0.558
Validation loss decreased (-0.485494 --> -0.557959).  Saving model ...
Epoch: 5 cost time: 0.63948655128479
Epoch: 5, Steps: 9 | Train Loss: 1.145 Vali Loss: 1.131 Vali Acc: 0.630 Test Loss: 1.131 Test Acc: 0.630
Validation loss decreased (-0.557959 --> -0.630423).  Saving model ...
Epoch: 6 cost time: 0.6762285232543945
Epoch: 6, Steps: 9 | Train Loss: 1.054 Vali Loss: 1.054 Vali Acc: 0.710 Test Loss: 1.054 Test Acc: 0.710
Validation loss decreased (-0.630423 --> -0.710134).  Saving model ...
Epoch: 7 cost time: 0.6474626064300537
Epoch: 7, Steps: 9 | Train Loss: 0.950 Vali Loss: 0.974 Vali Acc: 0.783 Test Loss: 0.974 Test Acc: 0.783
Validation loss decreased (-0.710134 --> -0.782599).  Saving model ...
Epoch: 8 cost time: 0.6198112964630127
Epoch: 8, Steps: 9 | Train Loss: 0.869 Vali Loss: 0.892 Vali Acc: 0.797 Test Loss: 0.892 Test Acc: 0.797
Validation loss decreased (-0.782599 --> -0.797093).  Saving model ...
Epoch: 9 cost time: 0.5957181453704834
Epoch: 9, Steps: 9 | Train Loss: 0.769 Vali Loss: 0.812 Vali Acc: 0.826 Test Loss: 0.812 Test Acc: 0.826
Validation loss decreased (-0.797093 --> -0.826079).  Saving model ...
Epoch: 10 cost time: 0.5664157867431641
Epoch: 10, Steps: 9 | Train Loss: 0.681 Vali Loss: 0.735 Vali Acc: 0.848 Test Loss: 0.735 Test Acc: 0.848
Validation loss decreased (-0.826079 --> -0.847819).  Saving model ...
Epoch: 11 cost time: 0.6310358047485352
Epoch: 11, Steps: 9 | Train Loss: 0.597 Vali Loss: 0.667 Vali Acc: 0.848 Test Loss: 0.667 Test Acc: 0.848
Validation loss decreased (-0.847819 --> -0.847819).  Saving model ...
Epoch: 12 cost time: 0.6247661113739014
Epoch: 12, Steps: 9 | Train Loss: 0.503 Vali Loss: 0.608 Vali Acc: 0.848 Test Loss: 0.608 Test Acc: 0.848
Validation loss decreased (-0.847819 --> -0.847820).  Saving model ...
Epoch: 13 cost time: 0.5799884796142578
Epoch: 13, Steps: 9 | Train Loss: 0.445 Vali Loss: 0.556 Vali Acc: 0.855 Test Loss: 0.556 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855067).  Saving model ...
Epoch: 14 cost time: 0.6309762001037598
Epoch: 14, Steps: 9 | Train Loss: 0.384 Vali Loss: 0.511 Vali Acc: 0.862 Test Loss: 0.511 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 15 cost time: 0.5843732357025146
Epoch: 15, Steps: 9 | Train Loss: 0.330 Vali Loss: 0.463 Vali Acc: 0.891 Test Loss: 0.463 Test Acc: 0.891
Validation loss decreased (-0.862314 --> -0.891300).  Saving model ...
Epoch: 16 cost time: 0.5691425800323486
Epoch: 16, Steps: 9 | Train Loss: 0.303 Vali Loss: 0.424 Vali Acc: 0.891 Test Loss: 0.424 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 17 cost time: 0.6627435684204102
Epoch: 17, Steps: 9 | Train Loss: 0.244 Vali Loss: 0.394 Vali Acc: 0.899 Test Loss: 0.394 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 18 cost time: 0.5845913887023926
Epoch: 18, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.373 Vali Acc: 0.899 Test Loss: 0.373 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 19 cost time: 0.6093146800994873
Epoch: 19, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.362 Vali Acc: 0.891 Test Loss: 0.362 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6536581516265869
Epoch: 20, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.343 Vali Acc: 0.899 Test Loss: 0.343 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 21 cost time: 0.5971498489379883
Epoch: 21, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.333 Vali Acc: 0.906 Test Loss: 0.333 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 22 cost time: 0.608565092086792
Epoch: 22, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 23 cost time: 0.6322021484375
Epoch: 23, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.295 Vali Acc: 0.906 Test Loss: 0.295 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 24 cost time: 0.5968506336212158
Epoch: 24, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.296 Vali Acc: 0.913 Test Loss: 0.296 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 25 cost time: 0.7226600646972656
Epoch: 25, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.287 Vali Acc: 0.906 Test Loss: 0.287 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6572129726409912
Epoch: 26, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.271 Vali Acc: 0.913 Test Loss: 0.271 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 27 cost time: 0.6052718162536621
Epoch: 27, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.265 Vali Acc: 0.913 Test Loss: 0.265 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 28 cost time: 0.6240313053131104
Epoch: 28, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.257 Vali Acc: 0.920 Test Loss: 0.257 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 29 cost time: 0.5970897674560547
Epoch: 29, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.254 Vali Acc: 0.913 Test Loss: 0.254 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5753862857818604
Epoch: 30, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.265 Vali Acc: 0.913 Test Loss: 0.265 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6154329776763916
Epoch: 31, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.266 Vali Acc: 0.906 Test Loss: 0.266 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6184556484222412
Epoch: 32, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.257 Vali Acc: 0.913 Test Loss: 0.257 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6557619571685791
Epoch: 33, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.249 Vali Acc: 0.920 Test Loss: 0.249 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 34 cost time: 0.6671605110168457
Epoch: 34, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.241 Vali Acc: 0.920 Test Loss: 0.241 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 35 cost time: 0.6484677791595459
Epoch: 35, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.235 Vali Acc: 0.913 Test Loss: 0.235 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6147587299346924
Epoch: 36, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.231 Vali Acc: 0.913 Test Loss: 0.231 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6569674015045166
Epoch: 37, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.231 Vali Acc: 0.920 Test Loss: 0.231 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920288).  Saving model ...
Epoch: 38 cost time: 0.5845913887023926
Epoch: 38, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.223 Vali Acc: 0.920 Test Loss: 0.223 Test Acc: 0.920
Validation loss decreased (-0.920288 --> -0.920288).  Saving model ...
Epoch: 39 cost time: 0.646038293838501
Epoch: 39, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.227 Vali Acc: 0.920 Test Loss: 0.227 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6577539443969727
Epoch: 40, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.232 Vali Acc: 0.920 Test Loss: 0.232 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5919818878173828
Epoch: 41, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.233 Vali Acc: 0.920 Test Loss: 0.233 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6306958198547363
Epoch: 42, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.234 Vali Acc: 0.920 Test Loss: 0.234 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6158421039581299
Epoch: 43, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.235 Vali Acc: 0.920 Test Loss: 0.235 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.6476774215698242
Epoch: 44, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.233 Vali Acc: 0.913 Test Loss: 0.233 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.6079399585723877
Epoch: 45, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.222 Vali Acc: 0.913 Test Loss: 0.222 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.760124921798706
Epoch: 46, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.220 Vali Acc: 0.913 Test Loss: 0.220 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.6057488918304443
Epoch: 47, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.223 Vali Acc: 0.913 Test Loss: 0.223 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.7441244125366211
Epoch: 48, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.227 Vali Acc: 0.920 Test Loss: 0.227 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 85060
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9283721446990967
Epoch: 1, Steps: 9 | Train Loss: 1.441 Vali Loss: 1.382 Vali Acc: 0.341 Test Loss: 1.382 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 0.6097559928894043
Epoch: 2, Steps: 9 | Train Loss: 1.379 Vali Loss: 1.360 Vali Acc: 0.362 Test Loss: 1.360 Test Acc: 0.362
Validation loss decreased (-0.340566 --> -0.362305).  Saving model ...
Epoch: 3 cost time: 0.6623618602752686
Epoch: 3, Steps: 9 | Train Loss: 1.335 Vali Loss: 1.317 Vali Acc: 0.428 Test Loss: 1.317 Test Acc: 0.428
Validation loss decreased (-0.362305 --> -0.427523).  Saving model ...
Epoch: 4 cost time: 0.5915675163269043
Epoch: 4, Steps: 9 | Train Loss: 1.275 Vali Loss: 1.261 Vali Acc: 0.551 Test Loss: 1.261 Test Acc: 0.551
Validation loss decreased (-0.427523 --> -0.550712).  Saving model ...
Epoch: 5 cost time: 0.6415166854858398
Epoch: 5, Steps: 9 | Train Loss: 1.207 Vali Loss: 1.199 Vali Acc: 0.601 Test Loss: 1.199 Test Acc: 0.601
Validation loss decreased (-0.550712 --> -0.601437).  Saving model ...
Epoch: 6 cost time: 0.6215686798095703
Epoch: 6, Steps: 9 | Train Loss: 1.130 Vali Loss: 1.139 Vali Acc: 0.659 Test Loss: 1.139 Test Acc: 0.659
Validation loss decreased (-0.601437 --> -0.659409).  Saving model ...
Epoch: 7 cost time: 0.6112103462219238
Epoch: 7, Steps: 9 | Train Loss: 1.064 Vali Loss: 1.081 Vali Acc: 0.688 Test Loss: 1.081 Test Acc: 0.688
Validation loss decreased (-0.659409 --> -0.688395).  Saving model ...
Epoch: 8 cost time: 0.7192988395690918
Epoch: 8, Steps: 9 | Train Loss: 1.001 Vali Loss: 1.016 Vali Acc: 0.710 Test Loss: 1.016 Test Acc: 0.710
Validation loss decreased (-0.688395 --> -0.710135).  Saving model ...
Epoch: 9 cost time: 0.5957379341125488
Epoch: 9, Steps: 9 | Train Loss: 0.906 Vali Loss: 0.956 Vali Acc: 0.703 Test Loss: 0.956 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6134698390960693
Epoch: 10, Steps: 9 | Train Loss: 0.827 Vali Loss: 0.890 Vali Acc: 0.717 Test Loss: 0.890 Test Acc: 0.717
Validation loss decreased (-0.710135 --> -0.717382).  Saving model ...
Epoch: 11 cost time: 0.5720722675323486
Epoch: 11, Steps: 9 | Train Loss: 0.743 Vali Loss: 0.824 Vali Acc: 0.739 Test Loss: 0.824 Test Acc: 0.739
Validation loss decreased (-0.717382 --> -0.739122).  Saving model ...
Epoch: 12 cost time: 0.6226119995117188
Epoch: 12, Steps: 9 | Train Loss: 0.682 Vali Loss: 0.768 Vali Acc: 0.761 Test Loss: 0.768 Test Acc: 0.761
Validation loss decreased (-0.739122 --> -0.760862).  Saving model ...
Epoch: 13 cost time: 0.608027458190918
Epoch: 13, Steps: 9 | Train Loss: 0.619 Vali Loss: 0.707 Vali Acc: 0.775 Test Loss: 0.707 Test Acc: 0.775
Validation loss decreased (-0.760862 --> -0.775355).  Saving model ...
Epoch: 14 cost time: 0.6119968891143799
Epoch: 14, Steps: 9 | Train Loss: 0.555 Vali Loss: 0.661 Vali Acc: 0.783 Test Loss: 0.661 Test Acc: 0.783
Validation loss decreased (-0.775355 --> -0.782602).  Saving model ...
Epoch: 15 cost time: 0.6898031234741211
Epoch: 15, Steps: 9 | Train Loss: 0.504 Vali Loss: 0.613 Vali Acc: 0.819 Test Loss: 0.613 Test Acc: 0.819
Validation loss decreased (-0.782602 --> -0.818834).  Saving model ...
Epoch: 16 cost time: 0.5945985317230225
Epoch: 16, Steps: 9 | Train Loss: 0.455 Vali Loss: 0.571 Vali Acc: 0.855 Test Loss: 0.571 Test Acc: 0.855
Validation loss decreased (-0.818834 --> -0.855067).  Saving model ...
Epoch: 17 cost time: 0.6167595386505127
Epoch: 17, Steps: 9 | Train Loss: 0.383 Vali Loss: 0.545 Vali Acc: 0.862 Test Loss: 0.545 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862313).  Saving model ...
Epoch: 18 cost time: 0.6858339309692383
Epoch: 18, Steps: 9 | Train Loss: 0.340 Vali Loss: 0.509 Vali Acc: 0.877 Test Loss: 0.509 Test Acc: 0.877
Validation loss decreased (-0.862313 --> -0.876807).  Saving model ...
Epoch: 19 cost time: 0.6911211013793945
Epoch: 19, Steps: 9 | Train Loss: 0.315 Vali Loss: 0.492 Vali Acc: 0.870 Test Loss: 0.492 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6468918323516846
Epoch: 20, Steps: 9 | Train Loss: 0.284 Vali Loss: 0.461 Vali Acc: 0.870 Test Loss: 0.461 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5310351848602295
Epoch: 21, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.445 Vali Acc: 0.870 Test Loss: 0.445 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5949385166168213
Epoch: 22, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.427 Vali Acc: 0.870 Test Loss: 0.427 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6170475482940674
Epoch: 23, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.414 Vali Acc: 0.877 Test Loss: 0.414 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 24 cost time: 0.593707799911499
Epoch: 24, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.404 Vali Acc: 0.870 Test Loss: 0.404 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6622145175933838
Epoch: 25, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.391 Vali Acc: 0.862 Test Loss: 0.391 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6296582221984863
Epoch: 26, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.387 Vali Acc: 0.870 Test Loss: 0.387 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6173083782196045
Epoch: 27, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.377 Vali Acc: 0.862 Test Loss: 0.377 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5867385864257812
Epoch: 28, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.368 Vali Acc: 0.855 Test Loss: 0.368 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6299388408660889
Epoch: 29, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.361 Vali Acc: 0.855 Test Loss: 0.361 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6311633586883545
Epoch: 30, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.344 Vali Acc: 0.870 Test Loss: 0.344 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6453993320465088
Epoch: 31, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.331 Vali Acc: 0.870 Test Loss: 0.331 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6007342338562012
Epoch: 32, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.336 Vali Acc: 0.870 Test Loss: 0.336 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6323897838592529
Epoch: 33, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.343 Vali Acc: 0.870 Test Loss: 0.343 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 83076
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1424617767333984
Epoch: 1, Steps: 9 | Train Loss: 1.447 Vali Loss: 1.404 Vali Acc: 0.275 Test Loss: 1.404 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 0.6989994049072266
Epoch: 2, Steps: 9 | Train Loss: 1.410 Vali Loss: 1.386 Vali Acc: 0.319 Test Loss: 1.386 Test Acc: 0.319
Validation loss decreased (-0.275348 --> -0.318827).  Saving model ...
Epoch: 3 cost time: 0.6806354522705078
Epoch: 3, Steps: 9 | Train Loss: 1.369 Vali Loss: 1.350 Vali Acc: 0.377 Test Loss: 1.350 Test Acc: 0.377
Validation loss decreased (-0.318827 --> -0.376798).  Saving model ...
Epoch: 4 cost time: 0.6183285713195801
Epoch: 4, Steps: 9 | Train Loss: 1.311 Vali Loss: 1.304 Vali Acc: 0.413 Test Loss: 1.304 Test Acc: 0.413
Validation loss decreased (-0.376798 --> -0.413030).  Saving model ...
Epoch: 5 cost time: 0.6419506072998047
Epoch: 5, Steps: 9 | Train Loss: 1.238 Vali Loss: 1.251 Vali Acc: 0.536 Test Loss: 1.251 Test Acc: 0.536
Validation loss decreased (-0.413030 --> -0.536219).  Saving model ...
Epoch: 6 cost time: 0.627021312713623
Epoch: 6, Steps: 9 | Train Loss: 1.170 Vali Loss: 1.191 Vali Acc: 0.558 Test Loss: 1.191 Test Acc: 0.558
Validation loss decreased (-0.536219 --> -0.557959).  Saving model ...
Epoch: 7 cost time: 0.6510038375854492
Epoch: 7, Steps: 9 | Train Loss: 1.115 Vali Loss: 1.129 Vali Acc: 0.594 Test Loss: 1.129 Test Acc: 0.594
Validation loss decreased (-0.557959 --> -0.594192).  Saving model ...
Epoch: 8 cost time: 0.7115237712860107
Epoch: 8, Steps: 9 | Train Loss: 1.020 Vali Loss: 1.068 Vali Acc: 0.645 Test Loss: 1.068 Test Acc: 0.645
Validation loss decreased (-0.594192 --> -0.644917).  Saving model ...
Epoch: 9 cost time: 0.5920712947845459
Epoch: 9, Steps: 9 | Train Loss: 0.963 Vali Loss: 0.996 Vali Acc: 0.674 Test Loss: 0.996 Test Acc: 0.674
Validation loss decreased (-0.644917 --> -0.673903).  Saving model ...
Epoch: 10 cost time: 0.6876146793365479
Epoch: 10, Steps: 9 | Train Loss: 0.885 Vali Loss: 0.934 Vali Acc: 0.674 Test Loss: 0.934 Test Acc: 0.674
Validation loss decreased (-0.673903 --> -0.673904).  Saving model ...
Epoch: 11 cost time: 0.6357998847961426
Epoch: 11, Steps: 9 | Train Loss: 0.813 Vali Loss: 0.859 Vali Acc: 0.688 Test Loss: 0.859 Test Acc: 0.688
Validation loss decreased (-0.673904 --> -0.688397).  Saving model ...
Epoch: 12 cost time: 0.6085081100463867
Epoch: 12, Steps: 9 | Train Loss: 0.730 Vali Loss: 0.802 Vali Acc: 0.717 Test Loss: 0.802 Test Acc: 0.717
Validation loss decreased (-0.688397 --> -0.717383).  Saving model ...
Epoch: 13 cost time: 0.6285836696624756
Epoch: 13, Steps: 9 | Train Loss: 0.685 Vali Loss: 0.751 Vali Acc: 0.725 Test Loss: 0.751 Test Acc: 0.725
Validation loss decreased (-0.717383 --> -0.724630).  Saving model ...
Epoch: 14 cost time: 0.6777040958404541
Epoch: 14, Steps: 9 | Train Loss: 0.599 Vali Loss: 0.710 Vali Acc: 0.761 Test Loss: 0.710 Test Acc: 0.761
Validation loss decreased (-0.724630 --> -0.760862).  Saving model ...
Epoch: 15 cost time: 0.6954753398895264
Epoch: 15, Steps: 9 | Train Loss: 0.542 Vali Loss: 0.674 Vali Acc: 0.783 Test Loss: 0.674 Test Acc: 0.783
Validation loss decreased (-0.760862 --> -0.782602).  Saving model ...
Epoch: 16 cost time: 0.5718135833740234
Epoch: 16, Steps: 9 | Train Loss: 0.467 Vali Loss: 0.636 Vali Acc: 0.775 Test Loss: 0.636 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6934113502502441
Epoch: 17, Steps: 9 | Train Loss: 0.429 Vali Loss: 0.598 Vali Acc: 0.804 Test Loss: 0.598 Test Acc: 0.804
Validation loss decreased (-0.782602 --> -0.804342).  Saving model ...
Epoch: 18 cost time: 0.6398453712463379
Epoch: 18, Steps: 9 | Train Loss: 0.401 Vali Loss: 0.569 Vali Acc: 0.819 Test Loss: 0.569 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818835).  Saving model ...
Epoch: 19 cost time: 0.7111866474151611
Epoch: 19, Steps: 9 | Train Loss: 0.342 Vali Loss: 0.540 Vali Acc: 0.833 Test Loss: 0.540 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 20 cost time: 0.7050814628601074
Epoch: 20, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.514 Vali Acc: 0.833 Test Loss: 0.514 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 21 cost time: 0.6589407920837402
Epoch: 21, Steps: 9 | Train Loss: 0.283 Vali Loss: 0.499 Vali Acc: 0.826 Test Loss: 0.499 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6713318824768066
Epoch: 22, Steps: 9 | Train Loss: 0.258 Vali Loss: 0.468 Vali Acc: 0.855 Test Loss: 0.468 Test Acc: 0.855
Validation loss decreased (-0.833328 --> -0.855068).  Saving model ...
Epoch: 23 cost time: 0.6082079410552979
Epoch: 23, Steps: 9 | Train Loss: 0.235 Vali Loss: 0.449 Vali Acc: 0.855 Test Loss: 0.449 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 24 cost time: 0.5859296321868896
Epoch: 24, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.427 Vali Acc: 0.862 Test Loss: 0.427 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 25 cost time: 0.6253044605255127
Epoch: 25, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.410 Vali Acc: 0.877 Test Loss: 0.410 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876807).  Saving model ...
Epoch: 26 cost time: 0.6405987739562988
Epoch: 26, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.410 Vali Acc: 0.855 Test Loss: 0.410 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5959649085998535
Epoch: 27, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.390 Vali Acc: 0.884 Test Loss: 0.390 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 28 cost time: 0.5577201843261719
Epoch: 28, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.381 Vali Acc: 0.884 Test Loss: 0.381 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 29 cost time: 0.5869648456573486
Epoch: 29, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.366 Vali Acc: 0.870 Test Loss: 0.366 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5996441841125488
Epoch: 30, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.362 Vali Acc: 0.884 Test Loss: 0.362 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 31 cost time: 0.6007680892944336
Epoch: 31, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.358 Vali Acc: 0.891 Test Loss: 0.358 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 32 cost time: 0.6555979251861572
Epoch: 32, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.350 Vali Acc: 0.891 Test Loss: 0.350 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 33 cost time: 0.6004765033721924
Epoch: 33, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.357 Vali Acc: 0.877 Test Loss: 0.357 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6952071189880371
Epoch: 34, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.358 Vali Acc: 0.877 Test Loss: 0.358 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6041872501373291
Epoch: 35, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.333 Vali Acc: 0.891 Test Loss: 0.333 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 36 cost time: 0.6095852851867676
Epoch: 36, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.324 Vali Acc: 0.906 Test Loss: 0.324 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 37 cost time: 0.6116409301757812
Epoch: 37, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.318 Vali Acc: 0.906 Test Loss: 0.318 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 38 cost time: 0.6865465641021729
Epoch: 38, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.328 Vali Acc: 0.891 Test Loss: 0.328 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6052970886230469
Epoch: 39, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.320 Vali Acc: 0.891 Test Loss: 0.320 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6174395084381104
Epoch: 40, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.315 Vali Acc: 0.891 Test Loss: 0.315 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6179463863372803
Epoch: 41, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.309 Vali Acc: 0.891 Test Loss: 0.309 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6296403408050537
Epoch: 42, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.310 Vali Acc: 0.884 Test Loss: 0.310 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.5790150165557861
Epoch: 43, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.311 Vali Acc: 0.891 Test Loss: 0.311 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6251423358917236
Epoch: 44, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.310 Vali Acc: 0.891 Test Loss: 0.310 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.6505229473114014
Epoch: 45, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.311 Vali Acc: 0.884 Test Loss: 0.311 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.6414182186126709
Epoch: 46, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.304 Vali Acc: 0.891 Test Loss: 0.304 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.6064870357513428
Epoch: 47, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.308 Vali Acc: 0.891 Test Loss: 0.308 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 82660
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1196341514587402
Epoch: 1, Steps: 9 | Train Loss: 1.445 Vali Loss: 1.389 Vali Acc: 0.362 Test Loss: 1.389 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 0.6252379417419434
Epoch: 2, Steps: 9 | Train Loss: 1.398 Vali Loss: 1.370 Vali Acc: 0.384 Test Loss: 1.370 Test Acc: 0.384
Validation loss decreased (-0.362305 --> -0.384044).  Saving model ...
Epoch: 3 cost time: 0.5885446071624756
Epoch: 3, Steps: 9 | Train Loss: 1.365 Vali Loss: 1.336 Vali Acc: 0.420 Test Loss: 1.336 Test Acc: 0.420
Validation loss decreased (-0.384044 --> -0.420276).  Saving model ...
Epoch: 4 cost time: 0.6317555904388428
Epoch: 4, Steps: 9 | Train Loss: 1.310 Vali Loss: 1.293 Vali Acc: 0.500 Test Loss: 1.293 Test Acc: 0.500
Validation loss decreased (-0.420276 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 0.5542900562286377
Epoch: 5, Steps: 9 | Train Loss: 1.263 Vali Loss: 1.245 Vali Acc: 0.580 Test Loss: 1.245 Test Acc: 0.580
Validation loss decreased (-0.499987 --> -0.579698).  Saving model ...
Epoch: 6 cost time: 0.6096320152282715
Epoch: 6, Steps: 9 | Train Loss: 1.208 Vali Loss: 1.190 Vali Acc: 0.638 Test Loss: 1.190 Test Acc: 0.638
Validation loss decreased (-0.579698 --> -0.637669).  Saving model ...
Epoch: 7 cost time: 0.6057529449462891
Epoch: 7, Steps: 9 | Train Loss: 1.115 Vali Loss: 1.133 Vali Acc: 0.674 Test Loss: 1.133 Test Acc: 0.674
Validation loss decreased (-0.637669 --> -0.673902).  Saving model ...
Epoch: 8 cost time: 0.5896861553192139
Epoch: 8, Steps: 9 | Train Loss: 1.062 Vali Loss: 1.073 Vali Acc: 0.696 Test Loss: 1.073 Test Acc: 0.696
Validation loss decreased (-0.673902 --> -0.695641).  Saving model ...
Epoch: 9 cost time: 0.6264069080352783
Epoch: 9, Steps: 9 | Train Loss: 0.996 Vali Loss: 1.017 Vali Acc: 0.732 Test Loss: 1.017 Test Acc: 0.732
Validation loss decreased (-0.695641 --> -0.731874).  Saving model ...
Epoch: 10 cost time: 0.6369025707244873
Epoch: 10, Steps: 9 | Train Loss: 0.937 Vali Loss: 0.955 Vali Acc: 0.717 Test Loss: 0.955 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5972194671630859
Epoch: 11, Steps: 9 | Train Loss: 0.868 Vali Loss: 0.900 Vali Acc: 0.746 Test Loss: 0.900 Test Acc: 0.746
Validation loss decreased (-0.731874 --> -0.746368).  Saving model ...
Epoch: 12 cost time: 0.659787654876709
Epoch: 12, Steps: 9 | Train Loss: 0.791 Vali Loss: 0.848 Vali Acc: 0.746 Test Loss: 0.848 Test Acc: 0.746
Validation loss decreased (-0.746368 --> -0.746368).  Saving model ...
Epoch: 13 cost time: 0.5770666599273682
Epoch: 13, Steps: 9 | Train Loss: 0.707 Vali Loss: 0.803 Vali Acc: 0.746 Test Loss: 0.803 Test Acc: 0.746
Validation loss decreased (-0.746368 --> -0.746369).  Saving model ...
Epoch: 14 cost time: 0.5875029563903809
Epoch: 14, Steps: 9 | Train Loss: 0.707 Vali Loss: 0.757 Vali Acc: 0.761 Test Loss: 0.757 Test Acc: 0.761
Validation loss decreased (-0.746369 --> -0.760862).  Saving model ...
Epoch: 15 cost time: 0.5573863983154297
Epoch: 15, Steps: 9 | Train Loss: 0.590 Vali Loss: 0.721 Vali Acc: 0.797 Test Loss: 0.721 Test Acc: 0.797
Validation loss decreased (-0.760862 --> -0.797094).  Saving model ...
Epoch: 16 cost time: 0.6066837310791016
Epoch: 16, Steps: 9 | Train Loss: 0.557 Vali Loss: 0.686 Vali Acc: 0.804 Test Loss: 0.686 Test Acc: 0.804
Validation loss decreased (-0.797094 --> -0.804341).  Saving model ...
Epoch: 17 cost time: 0.7074856758117676
Epoch: 17, Steps: 9 | Train Loss: 0.605 Vali Loss: 0.650 Vali Acc: 0.783 Test Loss: 0.650 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.653005838394165
Epoch: 18, Steps: 9 | Train Loss: 0.465 Vali Loss: 0.625 Vali Acc: 0.826 Test Loss: 0.625 Test Acc: 0.826
Validation loss decreased (-0.804341 --> -0.826081).  Saving model ...
Epoch: 19 cost time: 0.6134185791015625
Epoch: 19, Steps: 9 | Train Loss: 0.440 Vali Loss: 0.610 Vali Acc: 0.826 Test Loss: 0.610 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826081).  Saving model ...
Epoch: 20 cost time: 0.6331589221954346
Epoch: 20, Steps: 9 | Train Loss: 0.381 Vali Loss: 0.590 Vali Acc: 0.826 Test Loss: 0.590 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826081).  Saving model ...
Epoch: 21 cost time: 0.6385626792907715
Epoch: 21, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.558 Vali Acc: 0.819 Test Loss: 0.558 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6895298957824707
Epoch: 22, Steps: 9 | Train Loss: 0.315 Vali Loss: 0.541 Vali Acc: 0.812 Test Loss: 0.541 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.600494384765625
Epoch: 23, Steps: 9 | Train Loss: 0.298 Vali Loss: 0.525 Vali Acc: 0.826 Test Loss: 0.525 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826082).  Saving model ...
Epoch: 24 cost time: 0.6100358963012695
Epoch: 24, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.509 Vali Acc: 0.833 Test Loss: 0.509 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 25 cost time: 0.6201705932617188
Epoch: 25, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.493 Vali Acc: 0.826 Test Loss: 0.493 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6134326457977295
Epoch: 26, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.485 Vali Acc: 0.833 Test Loss: 0.485 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 27 cost time: 0.6446480751037598
Epoch: 27, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.471 Vali Acc: 0.848 Test Loss: 0.471 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847821).  Saving model ...
Epoch: 28 cost time: 0.6464121341705322
Epoch: 28, Steps: 9 | Train Loss: 0.189 Vali Loss: 0.460 Vali Acc: 0.848 Test Loss: 0.460 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 29 cost time: 0.6528379917144775
Epoch: 29, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.445 Vali Acc: 0.848 Test Loss: 0.445 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 30 cost time: 0.6052899360656738
Epoch: 30, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.437 Vali Acc: 0.848 Test Loss: 0.437 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 31 cost time: 0.6664891242980957
Epoch: 31, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.440 Vali Acc: 0.841 Test Loss: 0.440 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6174960136413574
Epoch: 32, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.429 Vali Acc: 0.855 Test Loss: 0.429 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 33 cost time: 0.5949692726135254
Epoch: 33, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.422 Vali Acc: 0.848 Test Loss: 0.422 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6716163158416748
Epoch: 34, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.411 Vali Acc: 0.855 Test Loss: 0.411 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 35 cost time: 0.6481015682220459
Epoch: 35, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.397 Vali Acc: 0.870 Test Loss: 0.397 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 36 cost time: 0.6585495471954346
Epoch: 36, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.401 Vali Acc: 0.870 Test Loss: 0.401 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6372041702270508
Epoch: 37, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.390 Vali Acc: 0.862 Test Loss: 0.390 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6081757545471191
Epoch: 38, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.393 Vali Acc: 0.855 Test Loss: 0.393 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6149699687957764
Epoch: 39, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.394 Vali Acc: 0.855 Test Loss: 0.394 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5975086688995361
Epoch: 40, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.400 Vali Acc: 0.855 Test Loss: 0.400 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6106448173522949
Epoch: 41, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.380 Vali Acc: 0.855 Test Loss: 0.380 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6379261016845703
Epoch: 42, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.383 Vali Acc: 0.855 Test Loss: 0.383 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.6842496395111084
Epoch: 43, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.379 Vali Acc: 0.855 Test Loss: 0.379 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.5963785648345947
Epoch: 44, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.389 Vali Acc: 0.862 Test Loss: 0.389 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.5670506954193115
Epoch: 45, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.370 Vali Acc: 0.862 Test Loss: 0.370 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 82212
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.129153251647949
Epoch: 1, Steps: 9 | Train Loss: 1.330 Vali Loss: 1.251 Vali Acc: 0.558 Test Loss: 1.251 Test Acc: 0.558
Validation loss decreased (inf --> -0.557959).  Saving model ...
Epoch: 2 cost time: 0.8270068168640137
Epoch: 2, Steps: 9 | Train Loss: 0.991 Vali Loss: 0.934 Vali Acc: 0.768 Test Loss: 0.934 Test Acc: 0.768
Validation loss decreased (-0.557959 --> -0.768107).  Saving model ...
Epoch: 3 cost time: 0.9166123867034912
Epoch: 3, Steps: 9 | Train Loss: 0.596 Vali Loss: 0.609 Vali Acc: 0.826 Test Loss: 0.609 Test Acc: 0.826
Validation loss decreased (-0.768107 --> -0.826081).  Saving model ...
Epoch: 4 cost time: 0.866295576095581
Epoch: 4, Steps: 9 | Train Loss: 0.273 Vali Loss: 0.344 Vali Acc: 0.920 Test Loss: 0.344 Test Acc: 0.920
Validation loss decreased (-0.826081 --> -0.920286).  Saving model ...
Epoch: 5 cost time: 0.8496935367584229
Epoch: 5, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.239 Vali Acc: 0.928 Test Loss: 0.239 Test Acc: 0.928
Validation loss decreased (-0.920286 --> -0.927534).  Saving model ...
Epoch: 6 cost time: 0.8921725749969482
Epoch: 6, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.253 Vali Acc: 0.920 Test Loss: 0.253 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9293904304504395
Epoch: 7, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.217 Vali Acc: 0.920 Test Loss: 0.217 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9227039813995361
Epoch: 8, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.194 Vali Acc: 0.928 Test Loss: 0.194 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 9 cost time: 0.8739233016967773
Epoch: 9, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.230 Vali Acc: 0.920 Test Loss: 0.230 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9201099872589111
Epoch: 10, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.255 Vali Acc: 0.920 Test Loss: 0.255 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8795633316040039
Epoch: 11, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.235 Vali Acc: 0.920 Test Loss: 0.235 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8618614673614502
Epoch: 12, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.928 Test Loss: 0.207 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8399703502655029
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.920 Test Loss: 0.196 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8153097629547119
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.928 Test Loss: 0.191 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 15 cost time: 0.8913578987121582
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.928 Test Loss: 0.186 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 16 cost time: 0.9240236282348633
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.928 Test Loss: 0.193 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.891533374786377
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.928 Test Loss: 0.184 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 18 cost time: 0.9003071784973145
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.928 Test Loss: 0.185 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9167776107788086
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934781).  Saving model ...
Epoch: 20 cost time: 0.8727712631225586
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.928 Test Loss: 0.239 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9219775199890137
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.913 Test Loss: 0.257 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.918149471282959
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.913 Test Loss: 0.249 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.939622163772583
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.920 Test Loss: 0.233 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.875274658203125
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.920 Test Loss: 0.228 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8758347034454346
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.920 Test Loss: 0.226 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8697128295898438
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.920 Test Loss: 0.226 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8884212970733643
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.913 Test Loss: 0.241 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9008312225341797
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.913 Test Loss: 0.240 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.043100118637085
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.920 Test Loss: 0.225 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 1196932
model size : 4.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.248570442199707
Epoch: 1, Steps: 9 | Train Loss: 1.350 Vali Loss: 1.294 Vali Acc: 0.507 Test Loss: 1.294 Test Acc: 0.507
Validation loss decreased (inf --> -0.507233).  Saving model ...
Epoch: 2 cost time: 0.7878515720367432
Epoch: 2, Steps: 9 | Train Loss: 1.129 Vali Loss: 1.083 Vali Acc: 0.688 Test Loss: 1.083 Test Acc: 0.688
Validation loss decreased (-0.507233 --> -0.688395).  Saving model ...
Epoch: 3 cost time: 0.7984292507171631
Epoch: 3, Steps: 9 | Train Loss: 0.853 Vali Loss: 0.818 Vali Acc: 0.797 Test Loss: 0.818 Test Acc: 0.797
Validation loss decreased (-0.688395 --> -0.797093).  Saving model ...
Epoch: 4 cost time: 0.8197195529937744
Epoch: 4, Steps: 9 | Train Loss: 0.553 Vali Loss: 0.588 Vali Acc: 0.855 Test Loss: 0.588 Test Acc: 0.855
Validation loss decreased (-0.797093 --> -0.855067).  Saving model ...
Epoch: 5 cost time: 0.8275978565216064
Epoch: 5, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.404 Vali Acc: 0.920 Test Loss: 0.404 Test Acc: 0.920
Validation loss decreased (-0.855067 --> -0.920286).  Saving model ...
Epoch: 6 cost time: 0.8266284465789795
Epoch: 6, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.325 Vali Acc: 0.891 Test Loss: 0.325 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8534228801727295
Epoch: 7, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.253 Vali Acc: 0.920 Test Loss: 0.253 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920287).  Saving model ...
Epoch: 8 cost time: 0.7861330509185791
Epoch: 8, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.237 Vali Acc: 0.928 Test Loss: 0.237 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 9 cost time: 0.8612954616546631
Epoch: 9, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.239 Vali Acc: 0.913 Test Loss: 0.239 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7826268672943115
Epoch: 10, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.219 Vali Acc: 0.920 Test Loss: 0.219 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.861968994140625
Epoch: 11, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.216 Vali Acc: 0.920 Test Loss: 0.216 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7830672264099121
Epoch: 12, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.214 Vali Acc: 0.920 Test Loss: 0.214 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8644301891326904
Epoch: 13, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.226 Vali Acc: 0.920 Test Loss: 0.226 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8071322441101074
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.227 Vali Acc: 0.913 Test Loss: 0.227 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7702775001525879
Epoch: 15, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.237 Vali Acc: 0.913 Test Loss: 0.237 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7713615894317627
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.913 Test Loss: 0.236 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8010914325714111
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.231 Vali Acc: 0.913 Test Loss: 0.231 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7843427658081055
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.913 Test Loss: 0.225 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 1145348
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.2411372661590576
Epoch: 1, Steps: 9 | Train Loss: 1.393 Vali Loss: 1.350 Vali Acc: 0.326 Test Loss: 1.350 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 0.7365849018096924
Epoch: 2, Steps: 9 | Train Loss: 1.214 Vali Loss: 1.175 Vali Acc: 0.623 Test Loss: 1.175 Test Acc: 0.623
Validation loss decreased (-0.326073 --> -0.623177).  Saving model ...
Epoch: 3 cost time: 0.7442009449005127
Epoch: 3, Steps: 9 | Train Loss: 0.943 Vali Loss: 0.942 Vali Acc: 0.746 Test Loss: 0.942 Test Acc: 0.746
Validation loss decreased (-0.623177 --> -0.746367).  Saving model ...
Epoch: 4 cost time: 0.7221288681030273
Epoch: 4, Steps: 9 | Train Loss: 0.686 Vali Loss: 0.713 Vali Acc: 0.804 Test Loss: 0.713 Test Acc: 0.804
Validation loss decreased (-0.746367 --> -0.804341).  Saving model ...
Epoch: 5 cost time: 0.8451542854309082
Epoch: 5, Steps: 9 | Train Loss: 0.440 Vali Loss: 0.527 Vali Acc: 0.884 Test Loss: 0.527 Test Acc: 0.884
Validation loss decreased (-0.804341 --> -0.884053).  Saving model ...
Epoch: 6 cost time: 0.7872292995452881
Epoch: 6, Steps: 9 | Train Loss: 0.282 Vali Loss: 0.387 Vali Acc: 0.899 Test Loss: 0.387 Test Acc: 0.899
Validation loss decreased (-0.884053 --> -0.898547).  Saving model ...
Epoch: 7 cost time: 0.7474722862243652
Epoch: 7, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.316 Vali Acc: 0.891 Test Loss: 0.316 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7770371437072754
Epoch: 8, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.277 Vali Acc: 0.920 Test Loss: 0.277 Test Acc: 0.920
Validation loss decreased (-0.898547 --> -0.920287).  Saving model ...
Epoch: 9 cost time: 0.8682284355163574
Epoch: 9, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.278 Vali Acc: 0.899 Test Loss: 0.278 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8750612735748291
Epoch: 10, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.249 Vali Acc: 0.899 Test Loss: 0.249 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8250343799591064
Epoch: 11, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.257 Vali Acc: 0.899 Test Loss: 0.257 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8400402069091797
Epoch: 12, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.268 Vali Acc: 0.906 Test Loss: 0.268 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8057904243469238
Epoch: 13, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.287 Vali Acc: 0.906 Test Loss: 0.287 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7917640209197998
Epoch: 14, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.287 Vali Acc: 0.906 Test Loss: 0.287 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7416558265686035
Epoch: 15, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.247 Vali Acc: 0.906 Test Loss: 0.247 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8622925281524658
Epoch: 16, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.920 Test Loss: 0.223 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920288).  Saving model ...
Epoch: 17 cost time: 0.8732178211212158
Epoch: 17, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.224 Vali Acc: 0.920 Test Loss: 0.224 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8628504276275635
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.235 Vali Acc: 0.906 Test Loss: 0.235 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.709648609161377
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.819765567779541
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8052575588226318
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.247 Vali Acc: 0.906 Test Loss: 0.247 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6921005249023438
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.255 Vali Acc: 0.906 Test Loss: 0.255 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7185652256011963
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.906 Test Loss: 0.254 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7092239856719971
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.906 Test Loss: 0.262 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7098538875579834
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.258 Vali Acc: 0.899 Test Loss: 0.258 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7462742328643799
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.263 Vali Acc: 0.906 Test Loss: 0.263 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 1133700
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1998825073242188
Epoch: 1, Steps: 9 | Train Loss: 1.346 Vali Loss: 1.306 Vali Acc: 0.442 Test Loss: 1.306 Test Acc: 0.442
Validation loss decreased (inf --> -0.442016).  Saving model ...
Epoch: 2 cost time: 0.8452126979827881
Epoch: 2, Steps: 9 | Train Loss: 1.202 Vali Loss: 1.167 Vali Acc: 0.623 Test Loss: 1.167 Test Acc: 0.623
Validation loss decreased (-0.442016 --> -0.623177).  Saving model ...
Epoch: 3 cost time: 0.8632955551147461
Epoch: 3, Steps: 9 | Train Loss: 1.008 Vali Loss: 0.971 Vali Acc: 0.754 Test Loss: 0.971 Test Acc: 0.754
Validation loss decreased (-0.623177 --> -0.753613).  Saving model ...
Epoch: 4 cost time: 0.7431871891021729
Epoch: 4, Steps: 9 | Train Loss: 0.778 Vali Loss: 0.773 Vali Acc: 0.848 Test Loss: 0.773 Test Acc: 0.848
Validation loss decreased (-0.753613 --> -0.847818).  Saving model ...
Epoch: 5 cost time: 0.7649731636047363
Epoch: 5, Steps: 9 | Train Loss: 0.558 Vali Loss: 0.608 Vali Acc: 0.855 Test Loss: 0.608 Test Acc: 0.855
Validation loss decreased (-0.847818 --> -0.855066).  Saving model ...
Epoch: 6 cost time: 0.8362054824829102
Epoch: 6, Steps: 9 | Train Loss: 0.377 Vali Loss: 0.481 Vali Acc: 0.891 Test Loss: 0.481 Test Acc: 0.891
Validation loss decreased (-0.855066 --> -0.891300).  Saving model ...
Epoch: 7 cost time: 0.8836145401000977
Epoch: 7, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.362 Vali Acc: 0.891 Test Loss: 0.362 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891301).  Saving model ...
Epoch: 8 cost time: 0.8842825889587402
Epoch: 8, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.325 Vali Acc: 0.899 Test Loss: 0.325 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 9 cost time: 0.803398609161377
Epoch: 9, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.308 Vali Acc: 0.899 Test Loss: 0.308 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898548).  Saving model ...
Epoch: 10 cost time: 0.8308343887329102
Epoch: 10, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.296 Vali Acc: 0.899 Test Loss: 0.296 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 11 cost time: 0.9035911560058594
Epoch: 11, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.288 Vali Acc: 0.906 Test Loss: 0.288 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 12 cost time: 0.9556350708007812
Epoch: 12, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.308 Vali Acc: 0.891 Test Loss: 0.308 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9235777854919434
Epoch: 13, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.281 Vali Acc: 0.899 Test Loss: 0.281 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9143123626708984
Epoch: 14, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.265 Vali Acc: 0.899 Test Loss: 0.265 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.855487585067749
Epoch: 15, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.270 Vali Acc: 0.899 Test Loss: 0.270 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8732779026031494
Epoch: 16, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 17 cost time: 0.9108526706695557
Epoch: 17, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.278 Vali Acc: 0.899 Test Loss: 0.278 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8939101696014404
Epoch: 18, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.296 Vali Acc: 0.906 Test Loss: 0.296 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9493141174316406
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.280 Vali Acc: 0.899 Test Loss: 0.280 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9260990619659424
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.289 Vali Acc: 0.891 Test Loss: 0.289 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9321749210357666
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.289 Vali Acc: 0.891 Test Loss: 0.289 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9219522476196289
Epoch: 22, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.292 Vali Acc: 0.891 Test Loss: 0.292 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9149513244628906
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.253 Vali Acc: 0.906 Test Loss: 0.253 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905795).  Saving model ...
Epoch: 24 cost time: 0.8929638862609863
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.249 Vali Acc: 0.906 Test Loss: 0.249 Test Acc: 0.906
Validation loss decreased (-0.905795 --> -0.905795).  Saving model ...
Epoch: 25 cost time: 0.9231650829315186
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.245 Vali Acc: 0.899 Test Loss: 0.245 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.898918867111206
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.260 Vali Acc: 0.891 Test Loss: 0.260 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9010908603668213
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.268 Vali Acc: 0.891 Test Loss: 0.268 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9194576740264893
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.291 Vali Acc: 0.899 Test Loss: 0.291 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9008195400238037
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.891 Test Loss: 0.276 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8571770191192627
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.268 Vali Acc: 0.899 Test Loss: 0.268 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.932741641998291
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.899 Test Loss: 0.274 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9783766269683838
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.899 Test Loss: 0.276 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8839914798736572
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.891 Test Loss: 0.275 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9304287433624268
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.891 Test Loss: 0.288 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 1122052
model size : 4.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.13773775100708
Epoch: 1, Steps: 9 | Train Loss: 1.380 Vali Loss: 1.354 Vali Acc: 0.413 Test Loss: 1.354 Test Acc: 0.413
Validation loss decreased (inf --> -0.413030).  Saving model ...
Epoch: 2 cost time: 0.8131084442138672
Epoch: 2, Steps: 9 | Train Loss: 1.244 Vali Loss: 1.229 Vali Acc: 0.630 Test Loss: 1.229 Test Acc: 0.630
Validation loss decreased (-0.413030 --> -0.630422).  Saving model ...
Epoch: 3 cost time: 0.8133609294891357
Epoch: 3, Steps: 9 | Train Loss: 1.066 Vali Loss: 1.055 Vali Acc: 0.703 Test Loss: 1.055 Test Acc: 0.703
Validation loss decreased (-0.630422 --> -0.702888).  Saving model ...
Epoch: 4 cost time: 0.7320148944854736
Epoch: 4, Steps: 9 | Train Loss: 0.862 Vali Loss: 0.896 Vali Acc: 0.754 Test Loss: 0.896 Test Acc: 0.754
Validation loss decreased (-0.702888 --> -0.753614).  Saving model ...
Epoch: 5 cost time: 0.8762638568878174
Epoch: 5, Steps: 9 | Train Loss: 0.691 Vali Loss: 0.738 Vali Acc: 0.797 Test Loss: 0.738 Test Acc: 0.797
Validation loss decreased (-0.753614 --> -0.797094).  Saving model ...
Epoch: 6 cost time: 0.8636338710784912
Epoch: 6, Steps: 9 | Train Loss: 0.533 Vali Loss: 0.611 Vali Acc: 0.848 Test Loss: 0.611 Test Acc: 0.848
Validation loss decreased (-0.797094 --> -0.847820).  Saving model ...
Epoch: 7 cost time: 0.8767867088317871
Epoch: 7, Steps: 9 | Train Loss: 0.377 Vali Loss: 0.530 Vali Acc: 0.841 Test Loss: 0.530 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7943544387817383
Epoch: 8, Steps: 9 | Train Loss: 0.292 Vali Loss: 0.465 Vali Acc: 0.862 Test Loss: 0.465 Test Acc: 0.862
Validation loss decreased (-0.847820 --> -0.862314).  Saving model ...
Epoch: 9 cost time: 0.8422417640686035
Epoch: 9, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.434 Vali Acc: 0.833 Test Loss: 0.434 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8113219738006592
Epoch: 10, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.410 Vali Acc: 0.833 Test Loss: 0.410 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7786610126495361
Epoch: 11, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.365 Vali Acc: 0.855 Test Loss: 0.365 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8552775382995605
Epoch: 12, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.340 Vali Acc: 0.862 Test Loss: 0.340 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 13 cost time: 0.8222062587738037
Epoch: 13, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.326 Vali Acc: 0.870 Test Loss: 0.326 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 14 cost time: 0.7170305252075195
Epoch: 14, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.347 Vali Acc: 0.848 Test Loss: 0.347 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6928310394287109
Epoch: 15, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.313 Vali Acc: 0.884 Test Loss: 0.313 Test Acc: 0.884
Validation loss decreased (-0.869562 --> -0.884055).  Saving model ...
Epoch: 16 cost time: 0.7323002815246582
Epoch: 16, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.325 Vali Acc: 0.877 Test Loss: 0.325 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8523681163787842
Epoch: 17, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.332 Vali Acc: 0.870 Test Loss: 0.332 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7487940788269043
Epoch: 18, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.341 Vali Acc: 0.870 Test Loss: 0.341 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8472096920013428
Epoch: 19, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.337 Vali Acc: 0.877 Test Loss: 0.337 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.852879524230957
Epoch: 20, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.325 Vali Acc: 0.870 Test Loss: 0.325 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7753827571868896
Epoch: 21, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.328 Vali Acc: 0.870 Test Loss: 0.328 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7968044281005859
Epoch: 22, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.333 Vali Acc: 0.891 Test Loss: 0.333 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 23 cost time: 0.8058929443359375
Epoch: 23, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.332 Vali Acc: 0.891 Test Loss: 0.332 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 24 cost time: 0.7587499618530273
Epoch: 24, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.335 Vali Acc: 0.884 Test Loss: 0.335 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7354152202606201
Epoch: 25, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.312 Vali Acc: 0.899 Test Loss: 0.312 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 26 cost time: 0.8154282569885254
Epoch: 26, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.313 Vali Acc: 0.891 Test Loss: 0.313 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7398681640625
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.323 Vali Acc: 0.891 Test Loss: 0.323 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.77203369140625
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.329 Vali Acc: 0.891 Test Loss: 0.329 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7951858043670654
Epoch: 29, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.330 Vali Acc: 0.899 Test Loss: 0.330 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7576875686645508
Epoch: 30, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.328 Vali Acc: 0.899 Test Loss: 0.328 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7604250907897949
Epoch: 31, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.317 Vali Acc: 0.899 Test Loss: 0.317 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6988730430603027
Epoch: 32, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.315 Vali Acc: 0.891 Test Loss: 0.315 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8255152702331543
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.313 Vali Acc: 0.891 Test Loss: 0.313 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7126061916351318
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.303 Vali Acc: 0.891 Test Loss: 0.303 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7545697689056396
Epoch: 35, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.303 Vali Acc: 0.899 Test Loss: 0.303 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 36 cost time: 0.7101075649261475
Epoch: 36, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.322 Vali Acc: 0.891 Test Loss: 0.322 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7551383972167969
Epoch: 37, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.315 Vali Acc: 0.899 Test Loss: 0.315 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7612569332122803
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.317 Vali Acc: 0.891 Test Loss: 0.317 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7630751132965088
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.316 Vali Acc: 0.899 Test Loss: 0.316 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8365237712860107
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.313 Vali Acc: 0.899 Test Loss: 0.313 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.753260612487793
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.328 Vali Acc: 0.891 Test Loss: 0.328 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7899081707000732
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.320 Vali Acc: 0.899 Test Loss: 0.320 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7760348320007324
Epoch: 43, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.309 Vali Acc: 0.899 Test Loss: 0.309 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.746192455291748
Epoch: 44, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.316 Vali Acc: 0.891 Test Loss: 0.316 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.794062614440918
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.318 Vali Acc: 0.891 Test Loss: 0.318 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 1114116
model size : 4.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.120833158493042
Epoch: 1, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.377 Vali Acc: 0.304 Test Loss: 1.377 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 0.7563779354095459
Epoch: 2, Steps: 9 | Train Loss: 1.270 Vali Loss: 1.275 Vali Acc: 0.551 Test Loss: 1.275 Test Acc: 0.551
Validation loss decreased (-0.304334 --> -0.550712).  Saving model ...
Epoch: 3 cost time: 0.6665940284729004
Epoch: 3, Steps: 9 | Train Loss: 1.091 Vali Loss: 1.126 Vali Acc: 0.616 Test Loss: 1.126 Test Acc: 0.616
Validation loss decreased (-0.550712 --> -0.615931).  Saving model ...
Epoch: 4 cost time: 0.7228338718414307
Epoch: 4, Steps: 9 | Train Loss: 0.924 Vali Loss: 0.978 Vali Acc: 0.674 Test Loss: 0.978 Test Acc: 0.674
Validation loss decreased (-0.615931 --> -0.673903).  Saving model ...
Epoch: 5 cost time: 0.6662254333496094
Epoch: 5, Steps: 9 | Train Loss: 0.757 Vali Loss: 0.838 Vali Acc: 0.739 Test Loss: 0.838 Test Acc: 0.739
Validation loss decreased (-0.673903 --> -0.739122).  Saving model ...
Epoch: 6 cost time: 0.7532250881195068
Epoch: 6, Steps: 9 | Train Loss: 0.577 Vali Loss: 0.713 Vali Acc: 0.775 Test Loss: 0.713 Test Acc: 0.775
Validation loss decreased (-0.739122 --> -0.775355).  Saving model ...
Epoch: 7 cost time: 0.7257914543151855
Epoch: 7, Steps: 9 | Train Loss: 0.450 Vali Loss: 0.606 Vali Acc: 0.819 Test Loss: 0.606 Test Acc: 0.819
Validation loss decreased (-0.775355 --> -0.818835).  Saving model ...
Epoch: 8 cost time: 0.6882755756378174
Epoch: 8, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.537 Vali Acc: 0.826 Test Loss: 0.537 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 9 cost time: 0.6754889488220215
Epoch: 9, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.490 Vali Acc: 0.826 Test Loss: 0.490 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 10 cost time: 0.7291522026062012
Epoch: 10, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.458 Vali Acc: 0.833 Test Loss: 0.458 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 11 cost time: 0.6780195236206055
Epoch: 11, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.444 Vali Acc: 0.833 Test Loss: 0.444 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 0.7484455108642578
Epoch: 12, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.412 Vali Acc: 0.841 Test Loss: 0.412 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840576).  Saving model ...
Epoch: 13 cost time: 0.688934326171875
Epoch: 13, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.395 Vali Acc: 0.848 Test Loss: 0.395 Test Acc: 0.848
Validation loss decreased (-0.840576 --> -0.847822).  Saving model ...
Epoch: 14 cost time: 0.6936771869659424
Epoch: 14, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.397 Vali Acc: 0.848 Test Loss: 0.397 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.653984546661377
Epoch: 15, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.419 Vali Acc: 0.848 Test Loss: 0.419 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6526763439178467
Epoch: 16, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.424 Vali Acc: 0.833 Test Loss: 0.424 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7405362129211426
Epoch: 17, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.400 Vali Acc: 0.841 Test Loss: 0.400 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.677588701248169
Epoch: 18, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.396 Vali Acc: 0.848 Test Loss: 0.396 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.721959114074707
Epoch: 19, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.386 Vali Acc: 0.855 Test Loss: 0.386 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 20 cost time: 0.7120170593261719
Epoch: 20, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.406 Vali Acc: 0.855 Test Loss: 0.406 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7327487468719482
Epoch: 21, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.421 Vali Acc: 0.848 Test Loss: 0.421 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6932299137115479
Epoch: 22, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.408 Vali Acc: 0.862 Test Loss: 0.408 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 23 cost time: 0.6844923496246338
Epoch: 23, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.379 Vali Acc: 0.870 Test Loss: 0.379 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 24 cost time: 0.6617457866668701
Epoch: 24, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.366 Vali Acc: 0.870 Test Loss: 0.366 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869562).  Saving model ...
Epoch: 25 cost time: 0.685415506362915
Epoch: 25, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.387 Vali Acc: 0.862 Test Loss: 0.387 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6960909366607666
Epoch: 26, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.409 Vali Acc: 0.855 Test Loss: 0.409 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6495211124420166
Epoch: 27, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.408 Vali Acc: 0.862 Test Loss: 0.408 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7369675636291504
Epoch: 28, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.407 Vali Acc: 0.855 Test Loss: 0.407 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6748356819152832
Epoch: 29, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.391 Vali Acc: 0.855 Test Loss: 0.391 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6863465309143066
Epoch: 30, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.411 Vali Acc: 0.855 Test Loss: 0.411 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6694130897521973
Epoch: 31, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.404 Vali Acc: 0.855 Test Loss: 0.404 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6793158054351807
Epoch: 32, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.387 Vali Acc: 0.862 Test Loss: 0.387 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7026543617248535
Epoch: 33, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.391 Vali Acc: 0.862 Test Loss: 0.391 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6558692455291748
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.401 Vali Acc: 0.870 Test Loss: 0.401 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 1112452
model size : 4.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.081867218017578
Epoch: 1, Steps: 9 | Train Loss: 1.393 Vali Loss: 1.356 Vali Acc: 0.377 Test Loss: 1.356 Test Acc: 0.377
Validation loss decreased (inf --> -0.376798).  Saving model ...
Epoch: 2 cost time: 0.726210355758667
Epoch: 2, Steps: 9 | Train Loss: 1.298 Vali Loss: 1.260 Vali Acc: 0.522 Test Loss: 1.260 Test Acc: 0.522
Validation loss decreased (-0.376798 --> -0.521727).  Saving model ...
Epoch: 3 cost time: 0.7484064102172852
Epoch: 3, Steps: 9 | Train Loss: 1.144 Vali Loss: 1.130 Vali Acc: 0.681 Test Loss: 1.130 Test Acc: 0.681
Validation loss decreased (-0.521727 --> -0.681148).  Saving model ...
Epoch: 4 cost time: 0.6628749370574951
Epoch: 4, Steps: 9 | Train Loss: 0.969 Vali Loss: 0.983 Vali Acc: 0.732 Test Loss: 0.983 Test Acc: 0.732
Validation loss decreased (-0.681148 --> -0.731874).  Saving model ...
Epoch: 5 cost time: 0.7592434883117676
Epoch: 5, Steps: 9 | Train Loss: 0.815 Vali Loss: 0.847 Vali Acc: 0.754 Test Loss: 0.847 Test Acc: 0.754
Validation loss decreased (-0.731874 --> -0.753615).  Saving model ...
Epoch: 6 cost time: 0.7311952114105225
Epoch: 6, Steps: 9 | Train Loss: 0.679 Vali Loss: 0.728 Vali Acc: 0.761 Test Loss: 0.728 Test Acc: 0.761
Validation loss decreased (-0.753615 --> -0.760862).  Saving model ...
Epoch: 7 cost time: 0.7167091369628906
Epoch: 7, Steps: 9 | Train Loss: 0.517 Vali Loss: 0.634 Vali Acc: 0.812 Test Loss: 0.634 Test Acc: 0.812
Validation loss decreased (-0.760862 --> -0.811588).  Saving model ...
Epoch: 8 cost time: 0.7208404541015625
Epoch: 8, Steps: 9 | Train Loss: 0.396 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
Validation loss decreased (-0.811588 --> -0.833328).  Saving model ...
Epoch: 9 cost time: 0.7140657901763916
Epoch: 9, Steps: 9 | Train Loss: 0.314 Vali Loss: 0.523 Vali Acc: 0.848 Test Loss: 0.523 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847821).  Saving model ...
Epoch: 10 cost time: 0.7198336124420166
Epoch: 10, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.482 Vali Acc: 0.862 Test Loss: 0.482 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 11 cost time: 0.6599860191345215
Epoch: 11, Steps: 9 | Train Loss: 0.205 Vali Loss: 0.459 Vali Acc: 0.841 Test Loss: 0.459 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7162089347839355
Epoch: 12, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.412 Vali Acc: 0.841 Test Loss: 0.412 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7229669094085693
Epoch: 13, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.405 Vali Acc: 0.841 Test Loss: 0.405 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7318630218505859
Epoch: 14, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.395 Vali Acc: 0.848 Test Loss: 0.395 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7818753719329834
Epoch: 15, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.395 Vali Acc: 0.848 Test Loss: 0.395 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7334311008453369
Epoch: 16, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.394 Vali Acc: 0.855 Test Loss: 0.394 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7338306903839111
Epoch: 17, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.391 Vali Acc: 0.841 Test Loss: 0.391 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6838231086730957
Epoch: 18, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.389 Vali Acc: 0.841 Test Loss: 0.389 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7239325046539307
Epoch: 19, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.389 Vali Acc: 0.848 Test Loss: 0.389 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7597150802612305
Epoch: 20, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.402 Vali Acc: 0.848 Test Loss: 0.402 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1110660
model size : 4.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.053607702255249
Epoch: 1, Steps: 9 | Train Loss: 1.373 Vali Loss: 1.300 Vali Acc: 0.312 Test Loss: 1.300 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 0.6830360889434814
Epoch: 2, Steps: 9 | Train Loss: 1.178 Vali Loss: 1.111 Vali Acc: 0.710 Test Loss: 1.111 Test Acc: 0.710
Validation loss decreased (-0.311581 --> -0.710134).  Saving model ...
Epoch: 3 cost time: 0.6611630916595459
Epoch: 3, Steps: 9 | Train Loss: 0.884 Vali Loss: 0.875 Vali Acc: 0.754 Test Loss: 0.875 Test Acc: 0.754
Validation loss decreased (-0.710134 --> -0.753614).  Saving model ...
Epoch: 4 cost time: 0.6170194149017334
Epoch: 4, Steps: 9 | Train Loss: 0.623 Vali Loss: 0.643 Vali Acc: 0.862 Test Loss: 0.643 Test Acc: 0.862
Validation loss decreased (-0.753614 --> -0.862312).  Saving model ...
Epoch: 5 cost time: 0.6826703548431396
Epoch: 5, Steps: 9 | Train Loss: 0.400 Vali Loss: 0.448 Vali Acc: 0.906 Test Loss: 0.448 Test Acc: 0.906
Validation loss decreased (-0.862312 --> -0.905793).  Saving model ...
Epoch: 6 cost time: 0.6424484252929688
Epoch: 6, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.336 Vali Acc: 0.906 Test Loss: 0.336 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905794).  Saving model ...
Epoch: 7 cost time: 0.6458532810211182
Epoch: 7, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.260 Vali Acc: 0.935 Test Loss: 0.260 Test Acc: 0.935
Validation loss decreased (-0.905794 --> -0.934780).  Saving model ...
Epoch: 8 cost time: 0.6841287612915039
Epoch: 8, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.241 Vali Acc: 0.935 Test Loss: 0.241 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 9 cost time: 0.6549167633056641
Epoch: 9, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.239 Vali Acc: 0.920 Test Loss: 0.239 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6354317665100098
Epoch: 10, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.223 Vali Acc: 0.935 Test Loss: 0.223 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 11 cost time: 0.6736230850219727
Epoch: 11, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.218 Vali Acc: 0.935 Test Loss: 0.218 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 12 cost time: 0.7224009037017822
Epoch: 12, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.207 Vali Acc: 0.928 Test Loss: 0.207 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7112011909484863
Epoch: 13, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.200 Vali Acc: 0.935 Test Loss: 0.200 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934781).  Saving model ...
Epoch: 14 cost time: 0.6731059551239014
Epoch: 14, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.201 Vali Acc: 0.920 Test Loss: 0.201 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7399728298187256
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6940762996673584
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.209 Vali Acc: 0.928 Test Loss: 0.209 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6568360328674316
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.206 Vali Acc: 0.928 Test Loss: 0.206 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.70168137550354
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.920 Test Loss: 0.207 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6521494388580322
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.920 Test Loss: 0.209 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.652857780456543
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.928 Test Loss: 0.197 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6513199806213379
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 22 cost time: 0.690666675567627
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.942 Test Loss: 0.187 Test Acc: 0.942
Validation loss decreased (-0.934781 --> -0.942027).  Saving model ...
Epoch: 23 cost time: 0.6782822608947754
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.949 Test Loss: 0.185 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949274).  Saving model ...
Epoch: 24 cost time: 0.731492280960083
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.942 Test Loss: 0.192 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5799784660339355
Epoch: 25, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5843946933746338
Epoch: 26, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6641998291015625
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
Validation loss decreased (-0.949274 --> -0.956520).  Saving model ...
Epoch: 28 cost time: 0.594935417175293
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.949 Test Loss: 0.180 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5972716808319092
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.942 Test Loss: 0.183 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5993914604187012
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.942 Test Loss: 0.194 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6682224273681641
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.942 Test Loss: 0.199 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6384713649749756
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6788692474365234
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.928 Test Loss: 0.207 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6819071769714355
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.928 Test Loss: 0.206 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6912674903869629
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.6946203708648682
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.6679835319519043
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.928 Test Loss: 0.207 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9565217391304348
model parameter : 336324
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0085248947143555
Epoch: 1, Steps: 9 | Train Loss: 1.416 Vali Loss: 1.344 Vali Acc: 0.261 Test Loss: 1.344 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 0.642859935760498
Epoch: 2, Steps: 9 | Train Loss: 1.301 Vali Loss: 1.241 Vali Acc: 0.536 Test Loss: 1.241 Test Acc: 0.536
Validation loss decreased (-0.260856 --> -0.536219).  Saving model ...
Epoch: 3 cost time: 0.6996290683746338
Epoch: 3, Steps: 9 | Train Loss: 1.133 Vali Loss: 1.088 Vali Acc: 0.652 Test Loss: 1.088 Test Acc: 0.652
Validation loss decreased (-0.536219 --> -0.652163).  Saving model ...
Epoch: 4 cost time: 0.6204061508178711
Epoch: 4, Steps: 9 | Train Loss: 0.921 Vali Loss: 0.920 Vali Acc: 0.797 Test Loss: 0.920 Test Acc: 0.797
Validation loss decreased (-0.652163 --> -0.797092).  Saving model ...
Epoch: 5 cost time: 0.6608223915100098
Epoch: 5, Steps: 9 | Train Loss: 0.712 Vali Loss: 0.757 Vali Acc: 0.848 Test Loss: 0.757 Test Acc: 0.848
Validation loss decreased (-0.797092 --> -0.847819).  Saving model ...
Epoch: 6 cost time: 0.629185676574707
Epoch: 6, Steps: 9 | Train Loss: 0.524 Vali Loss: 0.595 Vali Acc: 0.891 Test Loss: 0.595 Test Acc: 0.891
Validation loss decreased (-0.847819 --> -0.891298).  Saving model ...
Epoch: 7 cost time: 0.6267526149749756
Epoch: 7, Steps: 9 | Train Loss: 0.356 Vali Loss: 0.462 Vali Acc: 0.906 Test Loss: 0.462 Test Acc: 0.906
Validation loss decreased (-0.891298 --> -0.905792).  Saving model ...
Epoch: 8 cost time: 0.6709375381469727
Epoch: 8, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.369 Vali Acc: 0.920 Test Loss: 0.369 Test Acc: 0.920
Validation loss decreased (-0.905792 --> -0.920286).  Saving model ...
Epoch: 9 cost time: 0.624183177947998
Epoch: 9, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.318 Vali Acc: 0.913 Test Loss: 0.318 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6243340969085693
Epoch: 10, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.299 Vali Acc: 0.928 Test Loss: 0.299 Test Acc: 0.928
Validation loss decreased (-0.920286 --> -0.927533).  Saving model ...
Epoch: 11 cost time: 0.7777507305145264
Epoch: 11, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.274 Vali Acc: 0.920 Test Loss: 0.274 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6485602855682373
Epoch: 12, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.254 Vali Acc: 0.913 Test Loss: 0.254 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7383618354797363
Epoch: 13, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6990053653717041
Epoch: 14, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.235 Vali Acc: 0.920 Test Loss: 0.235 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.615851879119873
Epoch: 15, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.234 Vali Acc: 0.920 Test Loss: 0.234 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5914254188537598
Epoch: 16, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927534).  Saving model ...
Epoch: 17 cost time: 0.694185733795166
Epoch: 17, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.221 Vali Acc: 0.913 Test Loss: 0.221 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6364994049072266
Epoch: 18, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.222 Vali Acc: 0.913 Test Loss: 0.222 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5977108478546143
Epoch: 19, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.228 Vali Acc: 0.913 Test Loss: 0.228 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6219909191131592
Epoch: 20, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.237 Vali Acc: 0.920 Test Loss: 0.237 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6608202457427979
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.236 Vali Acc: 0.920 Test Loss: 0.236 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6486713886260986
Epoch: 22, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.230 Vali Acc: 0.913 Test Loss: 0.230 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7197613716125488
Epoch: 23, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.226 Vali Acc: 0.906 Test Loss: 0.226 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6425745487213135
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.221 Vali Acc: 0.906 Test Loss: 0.221 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6167778968811035
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.220 Vali Acc: 0.913 Test Loss: 0.220 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6463475227355957
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.218 Vali Acc: 0.913 Test Loss: 0.218 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 310532
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.988257884979248
Epoch: 1, Steps: 9 | Train Loss: 1.365 Vali Loss: 1.327 Vali Acc: 0.377 Test Loss: 1.327 Test Acc: 0.377
Validation loss decreased (inf --> -0.376798).  Saving model ...
Epoch: 2 cost time: 0.5666258335113525
Epoch: 2, Steps: 9 | Train Loss: 1.284 Vali Loss: 1.238 Vali Acc: 0.587 Test Loss: 1.238 Test Acc: 0.587
Validation loss decreased (-0.376798 --> -0.586944).  Saving model ...
Epoch: 3 cost time: 0.6325199604034424
Epoch: 3, Steps: 9 | Train Loss: 1.132 Vali Loss: 1.106 Vali Acc: 0.652 Test Loss: 1.106 Test Acc: 0.652
Validation loss decreased (-0.586944 --> -0.652163).  Saving model ...
Epoch: 4 cost time: 0.6180932521820068
Epoch: 4, Steps: 9 | Train Loss: 0.960 Vali Loss: 0.958 Vali Acc: 0.725 Test Loss: 0.958 Test Acc: 0.725
Validation loss decreased (-0.652163 --> -0.724628).  Saving model ...
Epoch: 5 cost time: 0.6143405437469482
Epoch: 5, Steps: 9 | Train Loss: 0.793 Vali Loss: 0.796 Vali Acc: 0.826 Test Loss: 0.796 Test Acc: 0.826
Validation loss decreased (-0.724628 --> -0.826079).  Saving model ...
Epoch: 6 cost time: 0.6342086791992188
Epoch: 6, Steps: 9 | Train Loss: 0.610 Vali Loss: 0.662 Vali Acc: 0.826 Test Loss: 0.662 Test Acc: 0.826
Validation loss decreased (-0.826079 --> -0.826080).  Saving model ...
Epoch: 7 cost time: 0.6469724178314209
Epoch: 7, Steps: 9 | Train Loss: 0.445 Vali Loss: 0.537 Vali Acc: 0.870 Test Loss: 0.537 Test Acc: 0.870
Validation loss decreased (-0.826080 --> -0.869560).  Saving model ...
Epoch: 8 cost time: 0.6053979396820068
Epoch: 8, Steps: 9 | Train Loss: 0.337 Vali Loss: 0.448 Vali Acc: 0.870 Test Loss: 0.448 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869561).  Saving model ...
Epoch: 9 cost time: 0.7180523872375488
Epoch: 9, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.372 Vali Acc: 0.884 Test Loss: 0.372 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 10 cost time: 0.6096909046173096
Epoch: 10, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.334 Vali Acc: 0.913 Test Loss: 0.334 Test Acc: 0.913
Validation loss decreased (-0.884054 --> -0.913040).  Saving model ...
Epoch: 11 cost time: 0.6652145385742188
Epoch: 11, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.323 Vali Acc: 0.891 Test Loss: 0.323 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6241018772125244
Epoch: 12, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.307 Vali Acc: 0.884 Test Loss: 0.307 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6225817203521729
Epoch: 13, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.308 Vali Acc: 0.884 Test Loss: 0.308 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.603416919708252
Epoch: 14, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.285 Vali Acc: 0.906 Test Loss: 0.285 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5899877548217773
Epoch: 15, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.269 Vali Acc: 0.899 Test Loss: 0.269 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6401045322418213
Epoch: 16, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6030642986297607
Epoch: 17, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.263 Vali Acc: 0.899 Test Loss: 0.263 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6729540824890137
Epoch: 18, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.261 Vali Acc: 0.906 Test Loss: 0.261 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5741088390350342
Epoch: 19, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6525969505310059
Epoch: 20, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.272 Vali Acc: 0.899 Test Loss: 0.272 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 304708
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8150973320007324
Epoch: 1, Steps: 9 | Train Loss: 1.393 Vali Loss: 1.377 Vali Acc: 0.268 Test Loss: 1.377 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 0.6420340538024902
Epoch: 2, Steps: 9 | Train Loss: 1.312 Vali Loss: 1.307 Vali Acc: 0.406 Test Loss: 1.307 Test Acc: 0.406
Validation loss decreased (-0.268102 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 0.6182765960693359
Epoch: 3, Steps: 9 | Train Loss: 1.206 Vali Loss: 1.199 Vali Acc: 0.565 Test Loss: 1.199 Test Acc: 0.565
Validation loss decreased (-0.405784 --> -0.565205).  Saving model ...
Epoch: 4 cost time: 0.6002273559570312
Epoch: 4, Steps: 9 | Train Loss: 1.061 Vali Loss: 1.076 Vali Acc: 0.710 Test Loss: 1.076 Test Acc: 0.710
Validation loss decreased (-0.565205 --> -0.710134).  Saving model ...
Epoch: 5 cost time: 0.708798885345459
Epoch: 5, Steps: 9 | Train Loss: 0.925 Vali Loss: 0.950 Vali Acc: 0.797 Test Loss: 0.950 Test Acc: 0.797
Validation loss decreased (-0.710134 --> -0.797092).  Saving model ...
Epoch: 6 cost time: 0.6238541603088379
Epoch: 6, Steps: 9 | Train Loss: 0.765 Vali Loss: 0.826 Vali Acc: 0.826 Test Loss: 0.826 Test Acc: 0.826
Validation loss decreased (-0.797092 --> -0.826079).  Saving model ...
Epoch: 7 cost time: 0.6189255714416504
Epoch: 7, Steps: 9 | Train Loss: 0.644 Vali Loss: 0.713 Vali Acc: 0.841 Test Loss: 0.713 Test Acc: 0.841
Validation loss decreased (-0.826079 --> -0.840573).  Saving model ...
Epoch: 8 cost time: 0.6147618293762207
Epoch: 8, Steps: 9 | Train Loss: 0.499 Vali Loss: 0.604 Vali Acc: 0.862 Test Loss: 0.604 Test Acc: 0.862
Validation loss decreased (-0.840573 --> -0.862313).  Saving model ...
Epoch: 9 cost time: 0.6250932216644287
Epoch: 9, Steps: 9 | Train Loss: 0.410 Vali Loss: 0.510 Vali Acc: 0.884 Test Loss: 0.510 Test Acc: 0.884
Validation loss decreased (-0.862313 --> -0.884053).  Saving model ...
Epoch: 10 cost time: 0.6504738330841064
Epoch: 10, Steps: 9 | Train Loss: 0.297 Vali Loss: 0.451 Vali Acc: 0.891 Test Loss: 0.451 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891300).  Saving model ...
Epoch: 11 cost time: 0.6291372776031494
Epoch: 11, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.404 Vali Acc: 0.906 Test Loss: 0.404 Test Acc: 0.906
Validation loss decreased (-0.891300 --> -0.905793).  Saving model ...
Epoch: 12 cost time: 0.6120028495788574
Epoch: 12, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.378 Vali Acc: 0.891 Test Loss: 0.378 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6250007152557373
Epoch: 13, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.350 Vali Acc: 0.891 Test Loss: 0.350 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.619103193283081
Epoch: 14, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.331 Vali Acc: 0.899 Test Loss: 0.331 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6281180381774902
Epoch: 15, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.322 Vali Acc: 0.906 Test Loss: 0.322 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905794).  Saving model ...
Epoch: 16 cost time: 0.6232638359069824
Epoch: 16, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.320 Vali Acc: 0.899 Test Loss: 0.320 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6217474937438965
Epoch: 17, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.311 Vali Acc: 0.899 Test Loss: 0.311 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5863604545593262
Epoch: 18, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.296 Vali Acc: 0.899 Test Loss: 0.296 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6594367027282715
Epoch: 19, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.288 Vali Acc: 0.899 Test Loss: 0.288 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.605144739151001
Epoch: 20, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.288 Vali Acc: 0.899 Test Loss: 0.288 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6454293727874756
Epoch: 21, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.288 Vali Acc: 0.899 Test Loss: 0.288 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6213736534118652
Epoch: 22, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.275 Vali Acc: 0.913 Test Loss: 0.275 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 23 cost time: 0.6124002933502197
Epoch: 23, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.271 Vali Acc: 0.913 Test Loss: 0.271 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 24 cost time: 0.6366415023803711
Epoch: 24, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.266 Vali Acc: 0.913 Test Loss: 0.266 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 25 cost time: 0.7298586368560791
Epoch: 25, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.279 Vali Acc: 0.906 Test Loss: 0.279 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6740779876708984
Epoch: 26, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.283 Vali Acc: 0.913 Test Loss: 0.283 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.617133378982544
Epoch: 27, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.277 Vali Acc: 0.913 Test Loss: 0.277 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.681377649307251
Epoch: 28, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.295 Vali Acc: 0.906 Test Loss: 0.295 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6238598823547363
Epoch: 29, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.293 Vali Acc: 0.906 Test Loss: 0.293 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6193361282348633
Epoch: 30, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.277 Vali Acc: 0.913 Test Loss: 0.277 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7074637413024902
Epoch: 31, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.285 Vali Acc: 0.906 Test Loss: 0.285 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7462100982666016
Epoch: 32, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.271 Vali Acc: 0.913 Test Loss: 0.271 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7193245887756348
Epoch: 33, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.266 Vali Acc: 0.913 Test Loss: 0.266 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6745805740356445
Epoch: 34, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.266 Vali Acc: 0.913 Test Loss: 0.266 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 298884
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8897485733032227
Epoch: 1, Steps: 9 | Train Loss: 1.407 Vali Loss: 1.380 Vali Acc: 0.362 Test Loss: 1.380 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 0.6106541156768799
Epoch: 2, Steps: 9 | Train Loss: 1.348 Vali Loss: 1.327 Vali Acc: 0.406 Test Loss: 1.327 Test Acc: 0.406
Validation loss decreased (-0.362305 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 0.5867087841033936
Epoch: 3, Steps: 9 | Train Loss: 1.251 Vali Loss: 1.245 Vali Acc: 0.558 Test Loss: 1.245 Test Acc: 0.558
Validation loss decreased (-0.405784 --> -0.557959).  Saving model ...
Epoch: 4 cost time: 0.5760374069213867
Epoch: 4, Steps: 9 | Train Loss: 1.149 Vali Loss: 1.149 Vali Acc: 0.659 Test Loss: 1.149 Test Acc: 0.659
Validation loss decreased (-0.557959 --> -0.659409).  Saving model ...
Epoch: 5 cost time: 0.6598880290985107
Epoch: 5, Steps: 9 | Train Loss: 1.033 Vali Loss: 1.049 Vali Acc: 0.688 Test Loss: 1.049 Test Acc: 0.688
Validation loss decreased (-0.659409 --> -0.688395).  Saving model ...
Epoch: 6 cost time: 0.611832857131958
Epoch: 6, Steps: 9 | Train Loss: 0.886 Vali Loss: 0.950 Vali Acc: 0.732 Test Loss: 0.950 Test Acc: 0.732
Validation loss decreased (-0.688395 --> -0.731875).  Saving model ...
Epoch: 7 cost time: 0.5970323085784912
Epoch: 7, Steps: 9 | Train Loss: 0.770 Vali Loss: 0.842 Vali Acc: 0.768 Test Loss: 0.842 Test Acc: 0.768
Validation loss decreased (-0.731875 --> -0.768108).  Saving model ...
Epoch: 8 cost time: 0.6545031070709229
Epoch: 8, Steps: 9 | Train Loss: 0.675 Vali Loss: 0.753 Vali Acc: 0.790 Test Loss: 0.753 Test Acc: 0.790
Validation loss decreased (-0.768108 --> -0.789848).  Saving model ...
Epoch: 9 cost time: 0.5952279567718506
Epoch: 9, Steps: 9 | Train Loss: 0.541 Vali Loss: 0.680 Vali Acc: 0.783 Test Loss: 0.680 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5700585842132568
Epoch: 10, Steps: 9 | Train Loss: 0.485 Vali Loss: 0.614 Vali Acc: 0.819 Test Loss: 0.614 Test Acc: 0.819
Validation loss decreased (-0.789848 --> -0.818834).  Saving model ...
Epoch: 11 cost time: 0.6463866233825684
Epoch: 11, Steps: 9 | Train Loss: 0.390 Vali Loss: 0.558 Vali Acc: 0.877 Test Loss: 0.558 Test Acc: 0.877
Validation loss decreased (-0.818834 --> -0.876806).  Saving model ...
Epoch: 12 cost time: 0.5725352764129639
Epoch: 12, Steps: 9 | Train Loss: 0.306 Vali Loss: 0.510 Vali Acc: 0.877 Test Loss: 0.510 Test Acc: 0.877
Validation loss decreased (-0.876806 --> -0.876806).  Saving model ...
Epoch: 13 cost time: 0.5687637329101562
Epoch: 13, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.463 Vali Acc: 0.870 Test Loss: 0.463 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6217160224914551
Epoch: 14, Steps: 9 | Train Loss: 0.232 Vali Loss: 0.446 Vali Acc: 0.848 Test Loss: 0.446 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.596172571182251
Epoch: 15, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.421 Vali Acc: 0.862 Test Loss: 0.421 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8007609844207764
Epoch: 16, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.396 Vali Acc: 0.855 Test Loss: 0.396 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6762316226959229
Epoch: 17, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.400 Vali Acc: 0.862 Test Loss: 0.400 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6316792964935303
Epoch: 18, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.377 Vali Acc: 0.870 Test Loss: 0.377 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6320226192474365
Epoch: 19, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.367 Vali Acc: 0.877 Test Loss: 0.367 Test Acc: 0.877
Validation loss decreased (-0.876806 --> -0.876808).  Saving model ...
Epoch: 20 cost time: 0.6438686847686768
Epoch: 20, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.369 Vali Acc: 0.870 Test Loss: 0.369 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6695992946624756
Epoch: 21, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.356 Vali Acc: 0.870 Test Loss: 0.356 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6334257125854492
Epoch: 22, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.341 Vali Acc: 0.884 Test Loss: 0.341 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 23 cost time: 0.6448132991790771
Epoch: 23, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.334 Vali Acc: 0.884 Test Loss: 0.334 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 24 cost time: 0.6560511589050293
Epoch: 24, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.329 Vali Acc: 0.891 Test Loss: 0.329 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 25 cost time: 0.7025191783905029
Epoch: 25, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.327 Vali Acc: 0.891 Test Loss: 0.327 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 26 cost time: 0.6768486499786377
Epoch: 26, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.329 Vali Acc: 0.884 Test Loss: 0.329 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6957590579986572
Epoch: 27, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.323 Vali Acc: 0.884 Test Loss: 0.323 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5951530933380127
Epoch: 28, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.321 Vali Acc: 0.891 Test Loss: 0.321 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 29 cost time: 0.6135571002960205
Epoch: 29, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.314 Vali Acc: 0.884 Test Loss: 0.314 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6150283813476562
Epoch: 30, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.322 Vali Acc: 0.891 Test Loss: 0.322 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6266763210296631
Epoch: 31, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.337 Vali Acc: 0.891 Test Loss: 0.337 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6184108257293701
Epoch: 32, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.340 Vali Acc: 0.891 Test Loss: 0.340 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6637172698974609
Epoch: 33, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.334 Vali Acc: 0.884 Test Loss: 0.334 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6758275032043457
Epoch: 34, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.327 Vali Acc: 0.884 Test Loss: 0.327 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6060197353363037
Epoch: 35, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.319 Vali Acc: 0.891 Test Loss: 0.319 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 36 cost time: 0.6668851375579834
Epoch: 36, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.309 Vali Acc: 0.891 Test Loss: 0.309 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 37 cost time: 0.6348412036895752
Epoch: 37, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.296 Vali Acc: 0.891 Test Loss: 0.296 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 38 cost time: 0.6404588222503662
Epoch: 38, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.306 Vali Acc: 0.899 Test Loss: 0.306 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 39 cost time: 0.6334490776062012
Epoch: 39, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.327 Vali Acc: 0.891 Test Loss: 0.327 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7223348617553711
Epoch: 40, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.334 Vali Acc: 0.899 Test Loss: 0.334 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6967630386352539
Epoch: 41, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.332 Vali Acc: 0.899 Test Loss: 0.332 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7093732357025146
Epoch: 42, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.320 Vali Acc: 0.906 Test Loss: 0.320 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 43 cost time: 0.6275985240936279
Epoch: 43, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.307 Vali Acc: 0.899 Test Loss: 0.307 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6347181797027588
Epoch: 44, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.333 Vali Acc: 0.906 Test Loss: 0.333 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6136500835418701
Epoch: 45, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.384 Vali Acc: 0.862 Test Loss: 0.384 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6235659122467041
Epoch: 46, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.351 Vali Acc: 0.884 Test Loss: 0.351 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6565971374511719
Epoch: 47, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.310 Vali Acc: 0.906 Test Loss: 0.310 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 48 cost time: 0.5816135406494141
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.305 Vali Acc: 0.906 Test Loss: 0.305 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 49 cost time: 0.7461633682250977
Epoch: 49, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.302 Vali Acc: 0.913 Test Loss: 0.302 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 50 cost time: 0.6507570743560791
Epoch: 50, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 294916
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9176042079925537
Epoch: 1, Steps: 9 | Train Loss: 1.375 Vali Loss: 1.336 Vali Acc: 0.449 Test Loss: 1.336 Test Acc: 0.449
Validation loss decreased (inf --> -0.449262).  Saving model ...
Epoch: 2 cost time: 0.6330320835113525
Epoch: 2, Steps: 9 | Train Loss: 1.308 Vali Loss: 1.281 Vali Acc: 0.543 Test Loss: 1.281 Test Acc: 0.543
Validation loss decreased (-0.449262 --> -0.543465).  Saving model ...
Epoch: 3 cost time: 0.6363468170166016
Epoch: 3, Steps: 9 | Train Loss: 1.208 Vali Loss: 1.199 Vali Acc: 0.609 Test Loss: 1.199 Test Acc: 0.609
Validation loss decreased (-0.543465 --> -0.608684).  Saving model ...
Epoch: 4 cost time: 0.6888401508331299
Epoch: 4, Steps: 9 | Train Loss: 1.102 Vali Loss: 1.106 Vali Acc: 0.652 Test Loss: 1.106 Test Acc: 0.652
Validation loss decreased (-0.608684 --> -0.652163).  Saving model ...
Epoch: 5 cost time: 0.6311290264129639
Epoch: 5, Steps: 9 | Train Loss: 0.995 Vali Loss: 1.004 Vali Acc: 0.674 Test Loss: 1.004 Test Acc: 0.674
Validation loss decreased (-0.652163 --> -0.673903).  Saving model ...
Epoch: 6 cost time: 0.6648612022399902
Epoch: 6, Steps: 9 | Train Loss: 0.879 Vali Loss: 0.910 Vali Acc: 0.710 Test Loss: 0.910 Test Acc: 0.710
Validation loss decreased (-0.673903 --> -0.710136).  Saving model ...
Epoch: 7 cost time: 0.6698246002197266
Epoch: 7, Steps: 9 | Train Loss: 0.768 Vali Loss: 0.832 Vali Acc: 0.754 Test Loss: 0.832 Test Acc: 0.754
Validation loss decreased (-0.710136 --> -0.753615).  Saving model ...
Epoch: 8 cost time: 0.6534607410430908
Epoch: 8, Steps: 9 | Train Loss: 0.683 Vali Loss: 0.747 Vali Acc: 0.783 Test Loss: 0.747 Test Acc: 0.783
Validation loss decreased (-0.753615 --> -0.782601).  Saving model ...
Epoch: 9 cost time: 0.6553483009338379
Epoch: 9, Steps: 9 | Train Loss: 0.562 Vali Loss: 0.685 Vali Acc: 0.797 Test Loss: 0.685 Test Acc: 0.797
Validation loss decreased (-0.782601 --> -0.797095).  Saving model ...
Epoch: 10 cost time: 0.6577000617980957
Epoch: 10, Steps: 9 | Train Loss: 0.480 Vali Loss: 0.632 Vali Acc: 0.826 Test Loss: 0.632 Test Acc: 0.826
Validation loss decreased (-0.797095 --> -0.826081).  Saving model ...
Epoch: 11 cost time: 0.6702289581298828
Epoch: 11, Steps: 9 | Train Loss: 0.416 Vali Loss: 0.584 Vali Acc: 0.833 Test Loss: 0.584 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833327).  Saving model ...
Epoch: 12 cost time: 0.6373021602630615
Epoch: 12, Steps: 9 | Train Loss: 0.342 Vali Loss: 0.558 Vali Acc: 0.826 Test Loss: 0.558 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6497218608856201
Epoch: 13, Steps: 9 | Train Loss: 0.306 Vali Loss: 0.507 Vali Acc: 0.848 Test Loss: 0.507 Test Acc: 0.848
Validation loss decreased (-0.833327 --> -0.847821).  Saving model ...
Epoch: 14 cost time: 0.6554608345031738
Epoch: 14, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.485 Vali Acc: 0.833 Test Loss: 0.485 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6710162162780762
Epoch: 15, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.465 Vali Acc: 0.841 Test Loss: 0.465 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6448338031768799
Epoch: 16, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.458 Vali Acc: 0.833 Test Loss: 0.458 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6721839904785156
Epoch: 17, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.439 Vali Acc: 0.841 Test Loss: 0.439 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6343214511871338
Epoch: 18, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.435 Vali Acc: 0.841 Test Loss: 0.435 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6487419605255127
Epoch: 19, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.418 Vali Acc: 0.848 Test Loss: 0.418 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 20 cost time: 0.657642126083374
Epoch: 20, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.409 Vali Acc: 0.848 Test Loss: 0.409 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 21 cost time: 0.6616566181182861
Epoch: 21, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.363 Vali Acc: 0.862 Test Loss: 0.363 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 22 cost time: 0.6312417984008789
Epoch: 22, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.371 Vali Acc: 0.870 Test Loss: 0.371 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 23 cost time: 0.6197795867919922
Epoch: 23, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.361 Vali Acc: 0.870 Test Loss: 0.361 Test Acc: 0.870
Validation loss decreased (-0.869562 --> -0.869562).  Saving model ...
Epoch: 24 cost time: 0.6272521018981934
Epoch: 24, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.372 Vali Acc: 0.848 Test Loss: 0.372 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6362934112548828
Epoch: 25, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.374 Vali Acc: 0.841 Test Loss: 0.374 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6713552474975586
Epoch: 26, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.376 Vali Acc: 0.855 Test Loss: 0.376 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6820089817047119
Epoch: 27, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.379 Vali Acc: 0.855 Test Loss: 0.379 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6125154495239258
Epoch: 28, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.364 Vali Acc: 0.855 Test Loss: 0.364 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6066627502441406
Epoch: 29, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.354 Vali Acc: 0.870 Test Loss: 0.354 Test Acc: 0.870
Validation loss decreased (-0.869562 --> -0.869562).  Saving model ...
Epoch: 30 cost time: 0.6246888637542725
Epoch: 30, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.358 Vali Acc: 0.870 Test Loss: 0.358 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6064589023590088
Epoch: 31, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.355 Vali Acc: 0.870 Test Loss: 0.355 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6986303329467773
Epoch: 32, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.363 Vali Acc: 0.877 Test Loss: 0.363 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 33 cost time: 0.6063907146453857
Epoch: 33, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.371 Vali Acc: 0.870 Test Loss: 0.371 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.65557861328125
Epoch: 34, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.388 Vali Acc: 0.841 Test Loss: 0.388 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6439921855926514
Epoch: 35, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.367 Vali Acc: 0.862 Test Loss: 0.367 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.67405104637146
Epoch: 36, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.359 Vali Acc: 0.870 Test Loss: 0.359 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6845118999481201
Epoch: 37, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.363 Vali Acc: 0.870 Test Loss: 0.363 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.6278870105743408
Epoch: 38, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.363 Vali Acc: 0.877 Test Loss: 0.363 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6323175430297852
Epoch: 39, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.357 Vali Acc: 0.877 Test Loss: 0.357 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 40 cost time: 0.6745688915252686
Epoch: 40, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.352 Vali Acc: 0.870 Test Loss: 0.352 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6329092979431152
Epoch: 41, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.368 Vali Acc: 0.855 Test Loss: 0.368 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7040750980377197
Epoch: 42, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.346 Vali Acc: 0.870 Test Loss: 0.346 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6142218112945557
Epoch: 43, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.341 Vali Acc: 0.877 Test Loss: 0.341 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 44 cost time: 0.6797430515289307
Epoch: 44, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.342 Vali Acc: 0.855 Test Loss: 0.342 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6805026531219482
Epoch: 45, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.325 Vali Acc: 0.877 Test Loss: 0.325 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 46 cost time: 0.7107605934143066
Epoch: 46, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.339 Vali Acc: 0.855 Test Loss: 0.339 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6918542385101318
Epoch: 47, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.348 Vali Acc: 0.862 Test Loss: 0.348 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7171230316162109
Epoch: 48, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.337 Vali Acc: 0.870 Test Loss: 0.337 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.6444990634918213
Epoch: 49, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.308 Vali Acc: 0.877 Test Loss: 0.308 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876809).  Saving model ...
Epoch: 50 cost time: 0.6787559986114502
Epoch: 50, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.319 Vali Acc: 0.877 Test Loss: 0.319 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 294084
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.113898992538452
Epoch: 1, Steps: 9 | Train Loss: 1.402 Vali Loss: 1.363 Vali Acc: 0.268 Test Loss: 1.363 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 0.5895054340362549
Epoch: 2, Steps: 9 | Train Loss: 1.344 Vali Loss: 1.330 Vali Acc: 0.326 Test Loss: 1.330 Test Acc: 0.326
Validation loss decreased (-0.268102 --> -0.326074).  Saving model ...
Epoch: 3 cost time: 0.7385179996490479
Epoch: 3, Steps: 9 | Train Loss: 1.271 Vali Loss: 1.277 Vali Acc: 0.435 Test Loss: 1.277 Test Acc: 0.435
Validation loss decreased (-0.326074 --> -0.434770).  Saving model ...
Epoch: 4 cost time: 0.6403112411499023
Epoch: 4, Steps: 9 | Train Loss: 1.201 Vali Loss: 1.209 Vali Acc: 0.565 Test Loss: 1.209 Test Acc: 0.565
Validation loss decreased (-0.434770 --> -0.565205).  Saving model ...
Epoch: 5 cost time: 0.6595866680145264
Epoch: 5, Steps: 9 | Train Loss: 1.102 Vali Loss: 1.136 Vali Acc: 0.580 Test Loss: 1.136 Test Acc: 0.580
Validation loss decreased (-0.565205 --> -0.579699).  Saving model ...
Epoch: 6 cost time: 0.6416573524475098
Epoch: 6, Steps: 9 | Train Loss: 1.007 Vali Loss: 1.053 Vali Acc: 0.645 Test Loss: 1.053 Test Acc: 0.645
Validation loss decreased (-0.579699 --> -0.644917).  Saving model ...
Epoch: 7 cost time: 0.6410839557647705
Epoch: 7, Steps: 9 | Train Loss: 0.908 Vali Loss: 0.965 Vali Acc: 0.725 Test Loss: 0.965 Test Acc: 0.725
Validation loss decreased (-0.644917 --> -0.724628).  Saving model ...
Epoch: 8 cost time: 0.6517477035522461
Epoch: 8, Steps: 9 | Train Loss: 0.803 Vali Loss: 0.880 Vali Acc: 0.746 Test Loss: 0.880 Test Acc: 0.746
Validation loss decreased (-0.724628 --> -0.746368).  Saving model ...
Epoch: 9 cost time: 0.6372151374816895
Epoch: 9, Steps: 9 | Train Loss: 0.714 Vali Loss: 0.806 Vali Acc: 0.768 Test Loss: 0.806 Test Acc: 0.768
Validation loss decreased (-0.746368 --> -0.768108).  Saving model ...
Epoch: 10 cost time: 0.628326416015625
Epoch: 10, Steps: 9 | Train Loss: 0.608 Vali Loss: 0.730 Vali Acc: 0.761 Test Loss: 0.730 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6456923484802246
Epoch: 11, Steps: 9 | Train Loss: 0.537 Vali Loss: 0.673 Vali Acc: 0.775 Test Loss: 0.673 Test Acc: 0.775
Validation loss decreased (-0.768108 --> -0.775356).  Saving model ...
Epoch: 12 cost time: 0.6543581485748291
Epoch: 12, Steps: 9 | Train Loss: 0.440 Vali Loss: 0.626 Vali Acc: 0.797 Test Loss: 0.626 Test Acc: 0.797
Validation loss decreased (-0.775356 --> -0.797095).  Saving model ...
Epoch: 13 cost time: 0.630242109298706
Epoch: 13, Steps: 9 | Train Loss: 0.391 Vali Loss: 0.574 Vali Acc: 0.819 Test Loss: 0.574 Test Acc: 0.819
Validation loss decreased (-0.797095 --> -0.818835).  Saving model ...
Epoch: 14 cost time: 0.6560447216033936
Epoch: 14, Steps: 9 | Train Loss: 0.326 Vali Loss: 0.541 Vali Acc: 0.826 Test Loss: 0.541 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 15 cost time: 0.6629090309143066
Epoch: 15, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.518 Vali Acc: 0.826 Test Loss: 0.518 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 16 cost time: 0.6634650230407715
Epoch: 16, Steps: 9 | Train Loss: 0.250 Vali Loss: 0.502 Vali Acc: 0.826 Test Loss: 0.502 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 17 cost time: 0.7074458599090576
Epoch: 17, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.472 Vali Acc: 0.826 Test Loss: 0.472 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 18 cost time: 0.7088315486907959
Epoch: 18, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.470 Vali Acc: 0.819 Test Loss: 0.470 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7657020092010498
Epoch: 19, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.455 Vali Acc: 0.819 Test Loss: 0.455 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6624572277069092
Epoch: 20, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.456 Vali Acc: 0.819 Test Loss: 0.456 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6293923854827881
Epoch: 21, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.451 Vali Acc: 0.812 Test Loss: 0.451 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.676424503326416
Epoch: 22, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.412 Vali Acc: 0.833 Test Loss: 0.412 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 23 cost time: 0.6883862018585205
Epoch: 23, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.408 Vali Acc: 0.841 Test Loss: 0.408 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840576).  Saving model ...
Epoch: 24 cost time: 0.6851003170013428
Epoch: 24, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.405 Vali Acc: 0.841 Test Loss: 0.405 Test Acc: 0.841
Validation loss decreased (-0.840576 --> -0.840576).  Saving model ...
Epoch: 25 cost time: 0.6818218231201172
Epoch: 25, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.427 Vali Acc: 0.841 Test Loss: 0.427 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7178847789764404
Epoch: 26, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.417 Vali Acc: 0.833 Test Loss: 0.417 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.700131893157959
Epoch: 27, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.405 Vali Acc: 0.826 Test Loss: 0.405 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6354978084564209
Epoch: 28, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.402 Vali Acc: 0.826 Test Loss: 0.402 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.740774393081665
Epoch: 29, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.414 Vali Acc: 0.826 Test Loss: 0.414 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6999490261077881
Epoch: 30, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.420 Vali Acc: 0.833 Test Loss: 0.420 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7662460803985596
Epoch: 31, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.437 Vali Acc: 0.826 Test Loss: 0.437 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6431851387023926
Epoch: 32, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.423 Vali Acc: 0.833 Test Loss: 0.423 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6584620475769043
Epoch: 33, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.409 Vali Acc: 0.841 Test Loss: 0.409 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6288549900054932
Epoch: 34, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.414 Vali Acc: 0.833 Test Loss: 0.414 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 293188
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8684072494506836
Epoch: 1, Steps: 9 | Train Loss: 1.409 Vali Loss: 1.371 Vali Acc: 0.268 Test Loss: 1.371 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 0.6284801959991455
Epoch: 2, Steps: 9 | Train Loss: 1.285 Vali Loss: 1.235 Vali Acc: 0.529 Test Loss: 1.235 Test Acc: 0.529
Validation loss decreased (-0.268102 --> -0.528973).  Saving model ...
Epoch: 3 cost time: 0.6378319263458252
Epoch: 3, Steps: 9 | Train Loss: 1.090 Vali Loss: 1.063 Vali Acc: 0.732 Test Loss: 1.063 Test Acc: 0.732
Validation loss decreased (-0.528973 --> -0.731873).  Saving model ...
Epoch: 4 cost time: 0.5385191440582275
Epoch: 4, Steps: 9 | Train Loss: 0.887 Vali Loss: 0.879 Vali Acc: 0.768 Test Loss: 0.879 Test Acc: 0.768
Validation loss decreased (-0.731873 --> -0.768107).  Saving model ...
Epoch: 5 cost time: 0.5795962810516357
Epoch: 5, Steps: 9 | Train Loss: 0.708 Vali Loss: 0.732 Vali Acc: 0.833 Test Loss: 0.732 Test Acc: 0.833
Validation loss decreased (-0.768107 --> -0.833326).  Saving model ...
Epoch: 6 cost time: 0.6278069019317627
Epoch: 6, Steps: 9 | Train Loss: 0.524 Vali Loss: 0.588 Vali Acc: 0.855 Test Loss: 0.588 Test Acc: 0.855
Validation loss decreased (-0.833326 --> -0.855067).  Saving model ...
Epoch: 7 cost time: 0.5916657447814941
Epoch: 7, Steps: 9 | Train Loss: 0.373 Vali Loss: 0.477 Vali Acc: 0.870 Test Loss: 0.477 Test Acc: 0.870
Validation loss decreased (-0.855067 --> -0.869560).  Saving model ...
Epoch: 8 cost time: 0.5845446586608887
Epoch: 8, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.390 Vali Acc: 0.884 Test Loss: 0.390 Test Acc: 0.884
Validation loss decreased (-0.869560 --> -0.884054).  Saving model ...
Epoch: 9 cost time: 0.6165025234222412
Epoch: 9, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.346 Vali Acc: 0.913 Test Loss: 0.346 Test Acc: 0.913
Validation loss decreased (-0.884054 --> -0.913040).  Saving model ...
Epoch: 10 cost time: 0.6766197681427002
Epoch: 10, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.319 Vali Acc: 0.913 Test Loss: 0.319 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 11 cost time: 0.6139135360717773
Epoch: 11, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.298 Vali Acc: 0.913 Test Loss: 0.298 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 12 cost time: 0.5907392501831055
Epoch: 12, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.276 Vali Acc: 0.913 Test Loss: 0.276 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913041).  Saving model ...
Epoch: 13 cost time: 0.5900461673736572
Epoch: 13, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.259 Vali Acc: 0.920 Test Loss: 0.259 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 14 cost time: 0.5737318992614746
Epoch: 14, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.256 Vali Acc: 0.906 Test Loss: 0.256 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6071407794952393
Epoch: 15, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.248 Vali Acc: 0.906 Test Loss: 0.248 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.71773362159729
Epoch: 16, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.240 Vali Acc: 0.913 Test Loss: 0.240 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5840749740600586
Epoch: 17, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 18 cost time: 0.612926721572876
Epoch: 18, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.248 Vali Acc: 0.913 Test Loss: 0.248 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6444509029388428
Epoch: 19, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.246 Vali Acc: 0.906 Test Loss: 0.246 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6480333805084229
Epoch: 20, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6153461933135986
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.220 Vali Acc: 0.913 Test Loss: 0.220 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5728268623352051
Epoch: 22, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.215 Vali Acc: 0.920 Test Loss: 0.215 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.621309757232666
Epoch: 23, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.213 Vali Acc: 0.920 Test Loss: 0.213 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6042561531066895
Epoch: 24, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.226 Vali Acc: 0.920 Test Loss: 0.226 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6453518867492676
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.221 Vali Acc: 0.920 Test Loss: 0.221 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5655927658081055
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.209 Vali Acc: 0.928 Test Loss: 0.209 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 27 cost time: 0.6855423450469971
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.216 Vali Acc: 0.920 Test Loss: 0.216 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6182246208190918
Epoch: 28, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6540441513061523
Epoch: 29, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.215 Vali Acc: 0.913 Test Loss: 0.215 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5918898582458496
Epoch: 30, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.223 Vali Acc: 0.913 Test Loss: 0.223 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6849656105041504
Epoch: 31, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.222 Vali Acc: 0.913 Test Loss: 0.222 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6202285289764404
Epoch: 32, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.920 Test Loss: 0.216 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5932190418243408
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.913 Test Loss: 0.207 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6023778915405273
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.208 Vali Acc: 0.920 Test Loss: 0.208 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6054942607879639
Epoch: 35, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.601661205291748
Epoch: 36, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 37 cost time: 0.5907790660858154
Epoch: 37, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934781).  Saving model ...
Epoch: 38 cost time: 0.5761387348175049
Epoch: 38, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.935 Test Loss: 0.199 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 39 cost time: 0.5954298973083496
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 40 cost time: 0.6736671924591064
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 41 cost time: 0.6654691696166992
Epoch: 41, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.928 Test Loss: 0.200 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5481076240539551
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.935 Test Loss: 0.201 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5879285335540771
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.935 Test Loss: 0.199 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.614640474319458
Epoch: 44, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.6951408386230469
Epoch: 45, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.6063835620880127
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.6110351085662842
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.935 Test Loss: 0.216 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.688164472579956
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.6032905578613281
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.6880178451538086
Epoch: 50, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 102628
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1112194061279297
Epoch: 1, Steps: 9 | Train Loss: 1.399 Vali Loss: 1.389 Vali Acc: 0.239 Test Loss: 1.389 Test Acc: 0.239
Validation loss decreased (inf --> -0.239117).  Saving model ...
Epoch: 2 cost time: 0.595196008682251
Epoch: 2, Steps: 9 | Train Loss: 1.348 Vali Loss: 1.339 Vali Acc: 0.312 Test Loss: 1.339 Test Acc: 0.312
Validation loss decreased (-0.239117 --> -0.311581).  Saving model ...
Epoch: 3 cost time: 0.5712153911590576
Epoch: 3, Steps: 9 | Train Loss: 1.247 Vali Loss: 1.258 Vali Acc: 0.413 Test Loss: 1.258 Test Acc: 0.413
Validation loss decreased (-0.311581 --> -0.413031).  Saving model ...
Epoch: 4 cost time: 0.5799944400787354
Epoch: 4, Steps: 9 | Train Loss: 1.137 Vali Loss: 1.154 Vali Acc: 0.529 Test Loss: 1.154 Test Acc: 0.529
Validation loss decreased (-0.413031 --> -0.528974).  Saving model ...
Epoch: 5 cost time: 0.6129508018493652
Epoch: 5, Steps: 9 | Train Loss: 1.015 Vali Loss: 1.042 Vali Acc: 0.717 Test Loss: 1.042 Test Acc: 0.717
Validation loss decreased (-0.528974 --> -0.717381).  Saving model ...
Epoch: 6 cost time: 0.5748069286346436
Epoch: 6, Steps: 9 | Train Loss: 0.900 Vali Loss: 0.933 Vali Acc: 0.804 Test Loss: 0.933 Test Acc: 0.804
Validation loss decreased (-0.717381 --> -0.804338).  Saving model ...
Epoch: 7 cost time: 0.6381471157073975
Epoch: 7, Steps: 9 | Train Loss: 0.763 Vali Loss: 0.807 Vali Acc: 0.841 Test Loss: 0.807 Test Acc: 0.841
Validation loss decreased (-0.804338 --> -0.840572).  Saving model ...
Epoch: 8 cost time: 0.6149008274078369
Epoch: 8, Steps: 9 | Train Loss: 0.642 Vali Loss: 0.687 Vali Acc: 0.855 Test Loss: 0.687 Test Acc: 0.855
Validation loss decreased (-0.840572 --> -0.855066).  Saving model ...
Epoch: 9 cost time: 0.6690139770507812
Epoch: 9, Steps: 9 | Train Loss: 0.518 Vali Loss: 0.596 Vali Acc: 0.877 Test Loss: 0.596 Test Acc: 0.877
Validation loss decreased (-0.855066 --> -0.876806).  Saving model ...
Epoch: 10 cost time: 0.6297664642333984
Epoch: 10, Steps: 9 | Train Loss: 0.445 Vali Loss: 0.508 Vali Acc: 0.913 Test Loss: 0.508 Test Acc: 0.913
Validation loss decreased (-0.876806 --> -0.913038).  Saving model ...
Epoch: 11 cost time: 0.5955946445465088
Epoch: 11, Steps: 9 | Train Loss: 0.339 Vali Loss: 0.446 Vali Acc: 0.891 Test Loss: 0.446 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6063711643218994
Epoch: 12, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.392 Vali Acc: 0.913 Test Loss: 0.392 Test Acc: 0.913
Validation loss decreased (-0.913038 --> -0.913040).  Saving model ...
Epoch: 13 cost time: 0.6000773906707764
Epoch: 13, Steps: 9 | Train Loss: 0.227 Vali Loss: 0.340 Vali Acc: 0.928 Test Loss: 0.340 Test Acc: 0.928
Validation loss decreased (-0.913040 --> -0.927533).  Saving model ...
Epoch: 14 cost time: 0.6872317790985107
Epoch: 14, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.306 Vali Acc: 0.942 Test Loss: 0.306 Test Acc: 0.942
Validation loss decreased (-0.927533 --> -0.942026).  Saving model ...
Epoch: 15 cost time: 0.7066643238067627
Epoch: 15, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.286 Vali Acc: 0.942 Test Loss: 0.286 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 16 cost time: 0.7018322944641113
Epoch: 16, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.271 Vali Acc: 0.935 Test Loss: 0.271 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6016578674316406
Epoch: 17, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.247 Vali Acc: 0.942 Test Loss: 0.247 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 18 cost time: 0.5968976020812988
Epoch: 18, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.249 Vali Acc: 0.942 Test Loss: 0.249 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7224481105804443
Epoch: 19, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.233 Vali Acc: 0.935 Test Loss: 0.233 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6141483783721924
Epoch: 20, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.227 Vali Acc: 0.935 Test Loss: 0.227 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6330773830413818
Epoch: 21, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.226 Vali Acc: 0.935 Test Loss: 0.226 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7338347434997559
Epoch: 22, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.216 Vali Acc: 0.928 Test Loss: 0.216 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6570558547973633
Epoch: 23, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.216 Vali Acc: 0.928 Test Loss: 0.216 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.713029146194458
Epoch: 24, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6646604537963867
Epoch: 25, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.194 Vali Acc: 0.942 Test Loss: 0.194 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 26 cost time: 0.648759126663208
Epoch: 26, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.195 Vali Acc: 0.942 Test Loss: 0.195 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6279990673065186
Epoch: 27, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.197 Vali Acc: 0.942 Test Loss: 0.197 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6557974815368652
Epoch: 28, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.205 Vali Acc: 0.942 Test Loss: 0.205 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6094632148742676
Epoch: 29, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.198 Vali Acc: 0.942 Test Loss: 0.198 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6387073993682861
Epoch: 30, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.193 Vali Acc: 0.942 Test Loss: 0.193 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 31 cost time: 0.6628596782684326
Epoch: 31, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.185 Vali Acc: 0.942 Test Loss: 0.185 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 32 cost time: 0.6241345405578613
Epoch: 32, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.189 Vali Acc: 0.942 Test Loss: 0.189 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5934445858001709
Epoch: 33, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.191 Vali Acc: 0.935 Test Loss: 0.191 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6109030246734619
Epoch: 34, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.184 Vali Acc: 0.942 Test Loss: 0.184 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 35 cost time: 0.6116690635681152
Epoch: 35, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.184 Vali Acc: 0.942 Test Loss: 0.184 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 36 cost time: 0.6594376564025879
Epoch: 36, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.185 Vali Acc: 0.942 Test Loss: 0.185 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6058187484741211
Epoch: 37, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.186 Vali Acc: 0.935 Test Loss: 0.186 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5859510898590088
Epoch: 38, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.188 Vali Acc: 0.942 Test Loss: 0.188 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6029753684997559
Epoch: 39, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.184 Vali Acc: 0.942 Test Loss: 0.184 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6308598518371582
Epoch: 40, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.942 Test Loss: 0.191 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6123144626617432
Epoch: 41, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.199 Vali Acc: 0.942 Test Loss: 0.199 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6017277240753174
Epoch: 42, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.192 Vali Acc: 0.942 Test Loss: 0.192 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.6070518493652344
Epoch: 43, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.198 Vali Acc: 0.942 Test Loss: 0.198 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.62103271484375
Epoch: 44, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.942 Test Loss: 0.204 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.601900577545166
Epoch: 45, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.942 Test Loss: 0.204 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 89732
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9301209449768066
Epoch: 1, Steps: 9 | Train Loss: 1.450 Vali Loss: 1.359 Vali Acc: 0.217 Test Loss: 1.359 Test Acc: 0.217
Validation loss decreased (inf --> -0.217378).  Saving model ...
Epoch: 2 cost time: 0.6218183040618896
Epoch: 2, Steps: 9 | Train Loss: 1.377 Vali Loss: 1.316 Vali Acc: 0.275 Test Loss: 1.316 Test Acc: 0.275
Validation loss decreased (-0.217378 --> -0.275349).  Saving model ...
Epoch: 3 cost time: 0.5745944976806641
Epoch: 3, Steps: 9 | Train Loss: 1.294 Vali Loss: 1.256 Vali Acc: 0.420 Test Loss: 1.256 Test Acc: 0.420
Validation loss decreased (-0.275349 --> -0.420277).  Saving model ...
Epoch: 4 cost time: 0.6021378040313721
Epoch: 4, Steps: 9 | Train Loss: 1.219 Vali Loss: 1.183 Vali Acc: 0.587 Test Loss: 1.183 Test Acc: 0.587
Validation loss decreased (-0.420277 --> -0.586945).  Saving model ...
Epoch: 5 cost time: 0.6248636245727539
Epoch: 5, Steps: 9 | Train Loss: 1.131 Vali Loss: 1.106 Vali Acc: 0.696 Test Loss: 1.106 Test Acc: 0.696
Validation loss decreased (-0.586945 --> -0.695641).  Saving model ...
Epoch: 6 cost time: 0.7053413391113281
Epoch: 6, Steps: 9 | Train Loss: 1.000 Vali Loss: 1.019 Vali Acc: 0.725 Test Loss: 1.019 Test Acc: 0.725
Validation loss decreased (-0.695641 --> -0.724627).  Saving model ...
Epoch: 7 cost time: 0.6271603107452393
Epoch: 7, Steps: 9 | Train Loss: 0.876 Vali Loss: 0.922 Vali Acc: 0.739 Test Loss: 0.922 Test Acc: 0.739
Validation loss decreased (-0.724627 --> -0.739121).  Saving model ...
Epoch: 8 cost time: 0.629509449005127
Epoch: 8, Steps: 9 | Train Loss: 0.769 Vali Loss: 0.830 Vali Acc: 0.783 Test Loss: 0.830 Test Acc: 0.783
Validation loss decreased (-0.739121 --> -0.782600).  Saving model ...
Epoch: 9 cost time: 0.6138098239898682
Epoch: 9, Steps: 9 | Train Loss: 0.632 Vali Loss: 0.738 Vali Acc: 0.841 Test Loss: 0.738 Test Acc: 0.841
Validation loss decreased (-0.782600 --> -0.840572).  Saving model ...
Epoch: 10 cost time: 0.6314091682434082
Epoch: 10, Steps: 9 | Train Loss: 0.528 Vali Loss: 0.662 Vali Acc: 0.855 Test Loss: 0.662 Test Acc: 0.855
Validation loss decreased (-0.840572 --> -0.855066).  Saving model ...
Epoch: 11 cost time: 0.5860650539398193
Epoch: 11, Steps: 9 | Train Loss: 0.430 Vali Loss: 0.572 Vali Acc: 0.877 Test Loss: 0.572 Test Acc: 0.877
Validation loss decreased (-0.855066 --> -0.876806).  Saving model ...
Epoch: 12 cost time: 0.6538307666778564
Epoch: 12, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.516 Vali Acc: 0.877 Test Loss: 0.516 Test Acc: 0.877
Validation loss decreased (-0.876806 --> -0.876806).  Saving model ...
Epoch: 13 cost time: 0.5519604682922363
Epoch: 13, Steps: 9 | Train Loss: 0.317 Vali Loss: 0.464 Vali Acc: 0.884 Test Loss: 0.464 Test Acc: 0.884
Validation loss decreased (-0.876806 --> -0.884053).  Saving model ...
Epoch: 14 cost time: 0.6263527870178223
Epoch: 14, Steps: 9 | Train Loss: 0.239 Vali Loss: 0.417 Vali Acc: 0.884 Test Loss: 0.417 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884054).  Saving model ...
Epoch: 15 cost time: 0.6259446144104004
Epoch: 15, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.381 Vali Acc: 0.899 Test Loss: 0.381 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 16 cost time: 0.6617434024810791
Epoch: 16, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.366 Vali Acc: 0.891 Test Loss: 0.366 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6240947246551514
Epoch: 17, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.345 Vali Acc: 0.913 Test Loss: 0.345 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913040).  Saving model ...
Epoch: 18 cost time: 0.6273095607757568
Epoch: 18, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.324 Vali Acc: 0.913 Test Loss: 0.324 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 19 cost time: 0.6236317157745361
Epoch: 19, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.303 Vali Acc: 0.920 Test Loss: 0.303 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 20 cost time: 0.6226015090942383
Epoch: 20, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.295 Vali Acc: 0.920 Test Loss: 0.295 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 21 cost time: 0.589045524597168
Epoch: 21, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.285 Vali Acc: 0.920 Test Loss: 0.285 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 22 cost time: 0.5662856101989746
Epoch: 22, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.284 Vali Acc: 0.920 Test Loss: 0.284 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 23 cost time: 0.6104550361633301
Epoch: 23, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.278 Vali Acc: 0.920 Test Loss: 0.278 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 24 cost time: 0.593696117401123
Epoch: 24, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.275 Vali Acc: 0.920 Test Loss: 0.275 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 25 cost time: 0.6351656913757324
Epoch: 25, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.275 Vali Acc: 0.920 Test Loss: 0.275 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 26 cost time: 0.5857551097869873
Epoch: 26, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.272 Vali Acc: 0.920 Test Loss: 0.272 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 27 cost time: 0.6288576126098633
Epoch: 27, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.261 Vali Acc: 0.920 Test Loss: 0.261 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 28 cost time: 0.6616218090057373
Epoch: 28, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.247 Vali Acc: 0.928 Test Loss: 0.247 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 29 cost time: 0.6088223457336426
Epoch: 29, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.232 Vali Acc: 0.928 Test Loss: 0.232 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 30 cost time: 0.7219288349151611
Epoch: 30, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.235 Vali Acc: 0.935 Test Loss: 0.235 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 31 cost time: 0.6314601898193359
Epoch: 31, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.241 Vali Acc: 0.928 Test Loss: 0.241 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.628687858581543
Epoch: 32, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.245 Vali Acc: 0.928 Test Loss: 0.245 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5750925540924072
Epoch: 33, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.246 Vali Acc: 0.928 Test Loss: 0.246 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6394989490509033
Epoch: 34, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.243 Vali Acc: 0.928 Test Loss: 0.243 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.712108850479126
Epoch: 35, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6898515224456787
Epoch: 36, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.229 Vali Acc: 0.935 Test Loss: 0.229 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 37 cost time: 0.5802350044250488
Epoch: 37, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.230 Vali Acc: 0.935 Test Loss: 0.230 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8163690567016602
Epoch: 38, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.233 Vali Acc: 0.935 Test Loss: 0.233 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6761384010314941
Epoch: 39, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.226 Vali Acc: 0.935 Test Loss: 0.226 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 40 cost time: 0.6072478294372559
Epoch: 40, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.229 Vali Acc: 0.928 Test Loss: 0.229 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.614079475402832
Epoch: 41, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.233 Vali Acc: 0.928 Test Loss: 0.233 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6277463436126709
Epoch: 42, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.230 Vali Acc: 0.920 Test Loss: 0.230 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7107584476470947
Epoch: 43, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.241 Vali Acc: 0.920 Test Loss: 0.241 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6469302177429199
Epoch: 44, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.225 Vali Acc: 0.920 Test Loss: 0.225 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.6635258197784424
Epoch: 45, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.227 Vali Acc: 0.935 Test Loss: 0.227 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7274906635284424
Epoch: 46, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.6959612369537354
Epoch: 47, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.241 Vali Acc: 0.935 Test Loss: 0.241 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.6451988220214844
Epoch: 48, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.243 Vali Acc: 0.935 Test Loss: 0.243 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.6256983280181885
Epoch: 49, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.928 Test Loss: 0.237 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 86820
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.118778944015503
Epoch: 1, Steps: 9 | Train Loss: 1.466 Vali Loss: 1.381 Vali Acc: 0.275 Test Loss: 1.381 Test Acc: 0.275
Validation loss decreased (inf --> -0.275349).  Saving model ...
Epoch: 2 cost time: 0.6969094276428223
Epoch: 2, Steps: 9 | Train Loss: 1.416 Vali Loss: 1.352 Vali Acc: 0.377 Test Loss: 1.352 Test Acc: 0.377
Validation loss decreased (-0.275349 --> -0.376798).  Saving model ...
Epoch: 3 cost time: 0.65738844871521
Epoch: 3, Steps: 9 | Train Loss: 1.353 Vali Loss: 1.300 Vali Acc: 0.478 Test Loss: 1.300 Test Acc: 0.478
Validation loss decreased (-0.376798 --> -0.478248).  Saving model ...
Epoch: 4 cost time: 0.633190393447876
Epoch: 4, Steps: 9 | Train Loss: 1.282 Vali Loss: 1.235 Vali Acc: 0.587 Test Loss: 1.235 Test Acc: 0.587
Validation loss decreased (-0.478248 --> -0.586944).  Saving model ...
Epoch: 5 cost time: 0.7097940444946289
Epoch: 5, Steps: 9 | Train Loss: 1.184 Vali Loss: 1.163 Vali Acc: 0.659 Test Loss: 1.163 Test Acc: 0.659
Validation loss decreased (-0.586944 --> -0.659409).  Saving model ...
Epoch: 6 cost time: 0.6188139915466309
Epoch: 6, Steps: 9 | Train Loss: 1.091 Vali Loss: 1.089 Vali Acc: 0.717 Test Loss: 1.089 Test Acc: 0.717
Validation loss decreased (-0.659409 --> -0.717380).  Saving model ...
Epoch: 7 cost time: 0.5387279987335205
Epoch: 7, Steps: 9 | Train Loss: 0.993 Vali Loss: 1.011 Vali Acc: 0.768 Test Loss: 1.011 Test Acc: 0.768
Validation loss decreased (-0.717380 --> -0.768106).  Saving model ...
Epoch: 8 cost time: 0.6836504936218262
Epoch: 8, Steps: 9 | Train Loss: 0.884 Vali Loss: 0.929 Vali Acc: 0.812 Test Loss: 0.929 Test Acc: 0.812
Validation loss decreased (-0.768106 --> -0.811585).  Saving model ...
Epoch: 9 cost time: 0.6269724369049072
Epoch: 9, Steps: 9 | Train Loss: 0.800 Vali Loss: 0.843 Vali Acc: 0.804 Test Loss: 0.843 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5956714153289795
Epoch: 10, Steps: 9 | Train Loss: 0.697 Vali Loss: 0.771 Vali Acc: 0.790 Test Loss: 0.771 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5952510833740234
Epoch: 11, Steps: 9 | Train Loss: 0.623 Vali Loss: 0.704 Vali Acc: 0.833 Test Loss: 0.704 Test Acc: 0.833
Validation loss decreased (-0.811585 --> -0.833326).  Saving model ...
Epoch: 12 cost time: 0.6111528873443604
Epoch: 12, Steps: 9 | Train Loss: 0.522 Vali Loss: 0.638 Vali Acc: 0.870 Test Loss: 0.638 Test Acc: 0.870
Validation loss decreased (-0.833326 --> -0.869559).  Saving model ...
Epoch: 13 cost time: 0.6816792488098145
Epoch: 13, Steps: 9 | Train Loss: 0.443 Vali Loss: 0.577 Vali Acc: 0.877 Test Loss: 0.577 Test Acc: 0.877
Validation loss decreased (-0.869559 --> -0.876806).  Saving model ...
Epoch: 14 cost time: 0.720660924911499
Epoch: 14, Steps: 9 | Train Loss: 0.392 Vali Loss: 0.527 Vali Acc: 0.884 Test Loss: 0.527 Test Acc: 0.884
Validation loss decreased (-0.876806 --> -0.884053).  Saving model ...
Epoch: 15 cost time: 0.5733494758605957
Epoch: 15, Steps: 9 | Train Loss: 0.335 Vali Loss: 0.490 Vali Acc: 0.870 Test Loss: 0.490 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6865897178649902
Epoch: 16, Steps: 9 | Train Loss: 0.287 Vali Loss: 0.456 Vali Acc: 0.884 Test Loss: 0.456 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 17 cost time: 0.5860748291015625
Epoch: 17, Steps: 9 | Train Loss: 0.256 Vali Loss: 0.421 Vali Acc: 0.884 Test Loss: 0.421 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884054).  Saving model ...
Epoch: 18 cost time: 0.6275897026062012
Epoch: 18, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.388 Vali Acc: 0.899 Test Loss: 0.388 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 19 cost time: 0.7219915390014648
Epoch: 19, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.364 Vali Acc: 0.891 Test Loss: 0.364 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6265237331390381
Epoch: 20, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.349 Vali Acc: 0.906 Test Loss: 0.349 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 21 cost time: 0.5984735488891602
Epoch: 21, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.342 Vali Acc: 0.906 Test Loss: 0.342 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 22 cost time: 0.665585994720459
Epoch: 22, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.335 Vali Acc: 0.899 Test Loss: 0.335 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.741401195526123
Epoch: 23, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.318 Vali Acc: 0.891 Test Loss: 0.318 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7547979354858398
Epoch: 24, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.305 Vali Acc: 0.899 Test Loss: 0.305 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.68099045753479
Epoch: 25, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.298 Vali Acc: 0.906 Test Loss: 0.298 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 26 cost time: 0.6235380172729492
Epoch: 26, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.290 Vali Acc: 0.906 Test Loss: 0.290 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 27 cost time: 0.677868127822876
Epoch: 27, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.287 Vali Acc: 0.906 Test Loss: 0.287 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 28 cost time: 0.6056492328643799
Epoch: 28, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.289 Vali Acc: 0.906 Test Loss: 0.289 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6146841049194336
Epoch: 29, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.279 Vali Acc: 0.906 Test Loss: 0.279 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 30 cost time: 0.6241111755371094
Epoch: 30, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.271 Vali Acc: 0.913 Test Loss: 0.271 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 31 cost time: 0.741779088973999
Epoch: 31, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6706695556640625
Epoch: 32, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.276 Vali Acc: 0.906 Test Loss: 0.276 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6928083896636963
Epoch: 33, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.598691463470459
Epoch: 34, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.264 Vali Acc: 0.906 Test Loss: 0.264 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6443033218383789
Epoch: 35, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.263 Vali Acc: 0.906 Test Loss: 0.263 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.61421799659729
Epoch: 36, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.262 Vali Acc: 0.906 Test Loss: 0.262 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7104387283325195
Epoch: 37, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.5515542030334473
Epoch: 38, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.5693464279174805
Epoch: 39, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.245 Vali Acc: 0.906 Test Loss: 0.245 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.6348831653594971
Epoch: 40, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.256 Vali Acc: 0.906 Test Loss: 0.256 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 83908
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.023655652999878
Epoch: 1, Steps: 9 | Train Loss: 1.387 Vali Loss: 1.377 Vali Acc: 0.297 Test Loss: 1.377 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 0.5924942493438721
Epoch: 2, Steps: 9 | Train Loss: 1.352 Vali Loss: 1.349 Vali Acc: 0.268 Test Loss: 1.349 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5836489200592041
Epoch: 3, Steps: 9 | Train Loss: 1.311 Vali Loss: 1.306 Vali Acc: 0.355 Test Loss: 1.306 Test Acc: 0.355
Validation loss decreased (-0.297088 --> -0.355059).  Saving model ...
Epoch: 4 cost time: 0.6025052070617676
Epoch: 4, Steps: 9 | Train Loss: 1.237 Vali Loss: 1.253 Vali Acc: 0.442 Test Loss: 1.253 Test Acc: 0.442
Validation loss decreased (-0.355059 --> -0.442016).  Saving model ...
Epoch: 5 cost time: 0.5772311687469482
Epoch: 5, Steps: 9 | Train Loss: 1.176 Vali Loss: 1.193 Vali Acc: 0.543 Test Loss: 1.193 Test Acc: 0.543
Validation loss decreased (-0.442016 --> -0.543466).  Saving model ...
Epoch: 6 cost time: 0.6370964050292969
Epoch: 6, Steps: 9 | Train Loss: 1.096 Vali Loss: 1.130 Vali Acc: 0.587 Test Loss: 1.130 Test Acc: 0.587
Validation loss decreased (-0.543466 --> -0.586945).  Saving model ...
Epoch: 7 cost time: 0.5977110862731934
Epoch: 7, Steps: 9 | Train Loss: 1.025 Vali Loss: 1.065 Vali Acc: 0.616 Test Loss: 1.065 Test Acc: 0.616
Validation loss decreased (-0.586945 --> -0.615931).  Saving model ...
Epoch: 8 cost time: 0.5925867557525635
Epoch: 8, Steps: 9 | Train Loss: 0.954 Vali Loss: 1.001 Vali Acc: 0.645 Test Loss: 1.001 Test Acc: 0.645
Validation loss decreased (-0.615931 --> -0.644918).  Saving model ...
Epoch: 9 cost time: 0.5530073642730713
Epoch: 9, Steps: 9 | Train Loss: 0.869 Vali Loss: 0.932 Vali Acc: 0.681 Test Loss: 0.932 Test Acc: 0.681
Validation loss decreased (-0.644918 --> -0.681150).  Saving model ...
Epoch: 10 cost time: 0.5907237529754639
Epoch: 10, Steps: 9 | Train Loss: 0.789 Vali Loss: 0.879 Vali Acc: 0.725 Test Loss: 0.879 Test Acc: 0.725
Validation loss decreased (-0.681150 --> -0.724629).  Saving model ...
Epoch: 11 cost time: 0.6055715084075928
Epoch: 11, Steps: 9 | Train Loss: 0.712 Vali Loss: 0.815 Vali Acc: 0.754 Test Loss: 0.815 Test Acc: 0.754
Validation loss decreased (-0.724629 --> -0.753615).  Saving model ...
Epoch: 12 cost time: 0.6831746101379395
Epoch: 12, Steps: 9 | Train Loss: 0.644 Vali Loss: 0.761 Vali Acc: 0.775 Test Loss: 0.761 Test Acc: 0.775
Validation loss decreased (-0.753615 --> -0.775355).  Saving model ...
Epoch: 13 cost time: 0.7156209945678711
Epoch: 13, Steps: 9 | Train Loss: 0.577 Vali Loss: 0.713 Vali Acc: 0.783 Test Loss: 0.713 Test Acc: 0.783
Validation loss decreased (-0.775355 --> -0.782602).  Saving model ...
Epoch: 14 cost time: 0.6159272193908691
Epoch: 14, Steps: 9 | Train Loss: 0.511 Vali Loss: 0.660 Vali Acc: 0.812 Test Loss: 0.660 Test Acc: 0.812
Validation loss decreased (-0.782602 --> -0.811588).  Saving model ...
Epoch: 15 cost time: 0.6798751354217529
Epoch: 15, Steps: 9 | Train Loss: 0.464 Vali Loss: 0.621 Vali Acc: 0.841 Test Loss: 0.621 Test Acc: 0.841
Validation loss decreased (-0.811588 --> -0.840573).  Saving model ...
Epoch: 16 cost time: 0.6154563426971436
Epoch: 16, Steps: 9 | Train Loss: 0.400 Vali Loss: 0.580 Vali Acc: 0.841 Test Loss: 0.580 Test Acc: 0.841
Validation loss decreased (-0.840573 --> -0.840574).  Saving model ...
Epoch: 17 cost time: 0.6727771759033203
Epoch: 17, Steps: 9 | Train Loss: 0.349 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 18 cost time: 0.6531243324279785
Epoch: 18, Steps: 9 | Train Loss: 0.323 Vali Loss: 0.521 Vali Acc: 0.855 Test Loss: 0.521 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855067).  Saving model ...
Epoch: 19 cost time: 0.6810250282287598
Epoch: 19, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.502 Vali Acc: 0.855 Test Loss: 0.502 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 20 cost time: 0.6718318462371826
Epoch: 20, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6583356857299805
Epoch: 21, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.451 Vali Acc: 0.848 Test Loss: 0.451 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6556148529052734
Epoch: 22, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.435 Vali Acc: 0.855 Test Loss: 0.435 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855068).  Saving model ...
Epoch: 23 cost time: 0.6858489513397217
Epoch: 23, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.425 Vali Acc: 0.848 Test Loss: 0.425 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6792404651641846
Epoch: 24, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.403 Vali Acc: 0.848 Test Loss: 0.403 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7180933952331543
Epoch: 25, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.404 Vali Acc: 0.870 Test Loss: 0.404 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 26 cost time: 0.6685163974761963
Epoch: 26, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.395 Vali Acc: 0.870 Test Loss: 0.395 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 27 cost time: 0.7761831283569336
Epoch: 27, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.384 Vali Acc: 0.870 Test Loss: 0.384 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 28 cost time: 0.6728367805480957
Epoch: 28, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.383 Vali Acc: 0.862 Test Loss: 0.383 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.732473611831665
Epoch: 29, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.379 Vali Acc: 0.862 Test Loss: 0.379 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6803579330444336
Epoch: 30, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.387 Vali Acc: 0.862 Test Loss: 0.387 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7201135158538818
Epoch: 31, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.361 Vali Acc: 0.855 Test Loss: 0.361 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7363288402557373
Epoch: 32, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.357 Vali Acc: 0.870 Test Loss: 0.357 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869562).  Saving model ...
Epoch: 33 cost time: 0.6799237728118896
Epoch: 33, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.345 Vali Acc: 0.870 Test Loss: 0.345 Test Acc: 0.870
Validation loss decreased (-0.869562 --> -0.869562).  Saving model ...
Epoch: 34 cost time: 0.6576006412506104
Epoch: 34, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.332 Vali Acc: 0.870 Test Loss: 0.332 Test Acc: 0.870
Validation loss decreased (-0.869562 --> -0.869562).  Saving model ...
Epoch: 35 cost time: 0.7958135604858398
Epoch: 35, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.342 Vali Acc: 0.870 Test Loss: 0.342 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.682614803314209
Epoch: 36, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.338 Vali Acc: 0.877 Test Loss: 0.338 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 37 cost time: 0.6533620357513428
Epoch: 37, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.333 Vali Acc: 0.877 Test Loss: 0.333 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 38 cost time: 0.6452579498291016
Epoch: 38, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.323 Vali Acc: 0.870 Test Loss: 0.323 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6633806228637695
Epoch: 39, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.317 Vali Acc: 0.877 Test Loss: 0.317 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 40 cost time: 0.6782779693603516
Epoch: 40, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.318 Vali Acc: 0.877 Test Loss: 0.318 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6470146179199219
Epoch: 41, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.324 Vali Acc: 0.891 Test Loss: 0.324 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 42 cost time: 0.7374722957611084
Epoch: 42, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.331 Vali Acc: 0.891 Test Loss: 0.331 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7067756652832031
Epoch: 43, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.337 Vali Acc: 0.884 Test Loss: 0.337 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7035238742828369
Epoch: 44, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.335 Vali Acc: 0.884 Test Loss: 0.335 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6809844970703125
Epoch: 45, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.332 Vali Acc: 0.877 Test Loss: 0.332 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6084632873535156
Epoch: 46, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.339 Vali Acc: 0.877 Test Loss: 0.339 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.6679387092590332
Epoch: 47, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.331 Vali Acc: 0.877 Test Loss: 0.331 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.630143404006958
Epoch: 48, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.334 Vali Acc: 0.877 Test Loss: 0.334 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.6325521469116211
Epoch: 49, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.322 Vali Acc: 0.877 Test Loss: 0.322 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.6483592987060547
Epoch: 50, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.315 Vali Acc: 0.884 Test Loss: 0.315 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 81924
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8473987579345703
Epoch: 1, Steps: 9 | Train Loss: 1.391 Vali Loss: 1.371 Vali Acc: 0.319 Test Loss: 1.371 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 0.6590826511383057
Epoch: 2, Steps: 9 | Train Loss: 1.347 Vali Loss: 1.351 Vali Acc: 0.348 Test Loss: 1.351 Test Acc: 0.348
Validation loss decreased (-0.318827 --> -0.347813).  Saving model ...
Epoch: 3 cost time: 0.551459550857544
Epoch: 3, Steps: 9 | Train Loss: 1.325 Vali Loss: 1.317 Vali Acc: 0.391 Test Loss: 1.317 Test Acc: 0.391
Validation loss decreased (-0.347813 --> -0.391291).  Saving model ...
Epoch: 4 cost time: 0.6360073089599609
Epoch: 4, Steps: 9 | Train Loss: 1.274 Vali Loss: 1.272 Vali Acc: 0.428 Test Loss: 1.272 Test Acc: 0.428
Validation loss decreased (-0.391291 --> -0.427524).  Saving model ...
Epoch: 5 cost time: 0.5446522235870361
Epoch: 5, Steps: 9 | Train Loss: 1.220 Vali Loss: 1.223 Vali Acc: 0.486 Test Loss: 1.223 Test Acc: 0.486
Validation loss decreased (-0.427524 --> -0.485495).  Saving model ...
Epoch: 6 cost time: 0.6233959197998047
Epoch: 6, Steps: 9 | Train Loss: 1.144 Vali Loss: 1.169 Vali Acc: 0.551 Test Loss: 1.169 Test Acc: 0.551
Validation loss decreased (-0.485495 --> -0.550713).  Saving model ...
Epoch: 7 cost time: 0.6186385154724121
Epoch: 7, Steps: 9 | Train Loss: 1.081 Vali Loss: 1.109 Vali Acc: 0.616 Test Loss: 1.109 Test Acc: 0.616
Validation loss decreased (-0.550713 --> -0.615931).  Saving model ...
Epoch: 8 cost time: 0.5646014213562012
Epoch: 8, Steps: 9 | Train Loss: 1.015 Vali Loss: 1.044 Vali Acc: 0.667 Test Loss: 1.044 Test Acc: 0.667
Validation loss decreased (-0.615931 --> -0.666656).  Saving model ...
Epoch: 9 cost time: 0.6390929222106934
Epoch: 9, Steps: 9 | Train Loss: 0.932 Vali Loss: 0.970 Vali Acc: 0.681 Test Loss: 0.970 Test Acc: 0.681
Validation loss decreased (-0.666656 --> -0.681150).  Saving model ...
Epoch: 10 cost time: 0.5674922466278076
Epoch: 10, Steps: 9 | Train Loss: 0.848 Vali Loss: 0.910 Vali Acc: 0.732 Test Loss: 0.910 Test Acc: 0.732
Validation loss decreased (-0.681150 --> -0.731875).  Saving model ...
Epoch: 11 cost time: 0.5986049175262451
Epoch: 11, Steps: 9 | Train Loss: 0.778 Vali Loss: 0.846 Vali Acc: 0.746 Test Loss: 0.846 Test Acc: 0.746
Validation loss decreased (-0.731875 --> -0.746368).  Saving model ...
Epoch: 12 cost time: 0.5991964340209961
Epoch: 12, Steps: 9 | Train Loss: 0.695 Vali Loss: 0.786 Vali Acc: 0.746 Test Loss: 0.786 Test Acc: 0.746
Validation loss decreased (-0.746368 --> -0.746369).  Saving model ...
Epoch: 13 cost time: 0.5751056671142578
Epoch: 13, Steps: 9 | Train Loss: 0.631 Vali Loss: 0.739 Vali Acc: 0.768 Test Loss: 0.739 Test Acc: 0.768
Validation loss decreased (-0.746369 --> -0.768109).  Saving model ...
Epoch: 14 cost time: 0.708104133605957
Epoch: 14, Steps: 9 | Train Loss: 0.579 Vali Loss: 0.684 Vali Acc: 0.790 Test Loss: 0.684 Test Acc: 0.790
Validation loss decreased (-0.768109 --> -0.789848).  Saving model ...
Epoch: 15 cost time: 0.6513631343841553
Epoch: 15, Steps: 9 | Train Loss: 0.507 Vali Loss: 0.643 Vali Acc: 0.804 Test Loss: 0.643 Test Acc: 0.804
Validation loss decreased (-0.789848 --> -0.804341).  Saving model ...
Epoch: 16 cost time: 0.6677150726318359
Epoch: 16, Steps: 9 | Train Loss: 0.452 Vali Loss: 0.611 Vali Acc: 0.819 Test Loss: 0.611 Test Acc: 0.819
Validation loss decreased (-0.804341 --> -0.818834).  Saving model ...
Epoch: 17 cost time: 0.6250100135803223
Epoch: 17, Steps: 9 | Train Loss: 0.404 Vali Loss: 0.579 Vali Acc: 0.826 Test Loss: 0.579 Test Acc: 0.826
Validation loss decreased (-0.818834 --> -0.826081).  Saving model ...
Epoch: 18 cost time: 0.6334259510040283
Epoch: 18, Steps: 9 | Train Loss: 0.381 Vali Loss: 0.548 Vali Acc: 0.841 Test Loss: 0.548 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 19 cost time: 0.6546862125396729
Epoch: 19, Steps: 9 | Train Loss: 0.309 Vali Loss: 0.517 Vali Acc: 0.848 Test Loss: 0.517 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 20 cost time: 0.5918292999267578
Epoch: 20, Steps: 9 | Train Loss: 0.294 Vali Loss: 0.496 Vali Acc: 0.848 Test Loss: 0.496 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 21 cost time: 0.670306921005249
Epoch: 21, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.479 Vali Acc: 0.848 Test Loss: 0.479 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 22 cost time: 0.6549415588378906
Epoch: 22, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.453 Vali Acc: 0.848 Test Loss: 0.453 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 23 cost time: 0.6938974857330322
Epoch: 23, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.433 Vali Acc: 0.855 Test Loss: 0.433 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 24 cost time: 0.6260991096496582
Epoch: 24, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.415 Vali Acc: 0.862 Test Loss: 0.415 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 25 cost time: 0.6014819145202637
Epoch: 25, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.394 Vali Acc: 0.870 Test Loss: 0.394 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 26 cost time: 0.6331346035003662
Epoch: 26, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.383 Vali Acc: 0.870 Test Loss: 0.383 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 27 cost time: 0.6392395496368408
Epoch: 27, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.384 Vali Acc: 0.877 Test Loss: 0.384 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 28 cost time: 0.7414650917053223
Epoch: 28, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.372 Vali Acc: 0.870 Test Loss: 0.372 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7226700782775879
Epoch: 29, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.369 Vali Acc: 0.884 Test Loss: 0.369 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 30 cost time: 0.6037125587463379
Epoch: 30, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.367 Vali Acc: 0.862 Test Loss: 0.367 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.606421947479248
Epoch: 31, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.361 Vali Acc: 0.884 Test Loss: 0.361 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 32 cost time: 0.63818359375
Epoch: 32, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.340 Vali Acc: 0.884 Test Loss: 0.340 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884055).  Saving model ...
Epoch: 33 cost time: 0.6891863346099854
Epoch: 33, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.345 Vali Acc: 0.877 Test Loss: 0.345 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6378862857818604
Epoch: 34, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.339 Vali Acc: 0.877 Test Loss: 0.339 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6303634643554688
Epoch: 35, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.335 Vali Acc: 0.884 Test Loss: 0.335 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 36 cost time: 0.7094409465789795
Epoch: 36, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.338 Vali Acc: 0.884 Test Loss: 0.338 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6701231002807617
Epoch: 37, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.319 Vali Acc: 0.899 Test Loss: 0.319 Test Acc: 0.899
Validation loss decreased (-0.884055 --> -0.898548).  Saving model ...
Epoch: 38 cost time: 0.6846725940704346
Epoch: 38, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.297 Vali Acc: 0.899 Test Loss: 0.297 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 39 cost time: 0.6533288955688477
Epoch: 39, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.305 Vali Acc: 0.891 Test Loss: 0.305 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6828651428222656
Epoch: 40, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.333 Vali Acc: 0.884 Test Loss: 0.333 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6103866100311279
Epoch: 41, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.349 Vali Acc: 0.884 Test Loss: 0.349 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6538655757904053
Epoch: 42, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.342 Vali Acc: 0.877 Test Loss: 0.342 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5947675704956055
Epoch: 43, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.338 Vali Acc: 0.877 Test Loss: 0.338 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.602996826171875
Epoch: 44, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.330 Vali Acc: 0.884 Test Loss: 0.330 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.7331817150115967
Epoch: 45, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.323 Vali Acc: 0.884 Test Loss: 0.323 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.6024870872497559
Epoch: 46, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.335 Vali Acc: 0.877 Test Loss: 0.335 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.6430306434631348
Epoch: 47, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.319 Vali Acc: 0.884 Test Loss: 0.319 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.6513481140136719
Epoch: 48, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.315 Vali Acc: 0.884 Test Loss: 0.315 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 81508
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9627056121826172
Epoch: 1, Steps: 9 | Train Loss: 1.375 Vali Loss: 1.382 Vali Acc: 0.196 Test Loss: 1.382 Test Acc: 0.196
Validation loss decreased (inf --> -0.195638).  Saving model ...
Epoch: 2 cost time: 0.5950756072998047
Epoch: 2, Steps: 9 | Train Loss: 1.354 Vali Loss: 1.364 Vali Acc: 0.232 Test Loss: 1.364 Test Acc: 0.232
Validation loss decreased (-0.195638 --> -0.231870).  Saving model ...
Epoch: 3 cost time: 0.6177895069122314
Epoch: 3, Steps: 9 | Train Loss: 1.322 Vali Loss: 1.337 Vali Acc: 0.290 Test Loss: 1.337 Test Acc: 0.290
Validation loss decreased (-0.231870 --> -0.289842).  Saving model ...
Epoch: 4 cost time: 0.6046805381774902
Epoch: 4, Steps: 9 | Train Loss: 1.297 Vali Loss: 1.302 Vali Acc: 0.333 Test Loss: 1.302 Test Acc: 0.333
Validation loss decreased (-0.289842 --> -0.333320).  Saving model ...
Epoch: 5 cost time: 0.6289677619934082
Epoch: 5, Steps: 9 | Train Loss: 1.237 Vali Loss: 1.266 Vali Acc: 0.384 Test Loss: 1.266 Test Acc: 0.384
Validation loss decreased (-0.333320 --> -0.384045).  Saving model ...
Epoch: 6 cost time: 0.6487555503845215
Epoch: 6, Steps: 9 | Train Loss: 1.189 Vali Loss: 1.227 Vali Acc: 0.471 Test Loss: 1.227 Test Acc: 0.471
Validation loss decreased (-0.384045 --> -0.471002).  Saving model ...
Epoch: 7 cost time: 0.6266460418701172
Epoch: 7, Steps: 9 | Train Loss: 1.137 Vali Loss: 1.184 Vali Acc: 0.507 Test Loss: 1.184 Test Acc: 0.507
Validation loss decreased (-0.471002 --> -0.507235).  Saving model ...
Epoch: 8 cost time: 0.5498270988464355
Epoch: 8, Steps: 9 | Train Loss: 1.077 Vali Loss: 1.143 Vali Acc: 0.572 Test Loss: 1.143 Test Acc: 0.572
Validation loss decreased (-0.507235 --> -0.572452).  Saving model ...
Epoch: 9 cost time: 0.5749921798706055
Epoch: 9, Steps: 9 | Train Loss: 1.020 Vali Loss: 1.090 Vali Acc: 0.616 Test Loss: 1.090 Test Acc: 0.616
Validation loss decreased (-0.572452 --> -0.615931).  Saving model ...
Epoch: 10 cost time: 0.5796597003936768
Epoch: 10, Steps: 9 | Train Loss: 0.960 Vali Loss: 1.036 Vali Acc: 0.645 Test Loss: 1.036 Test Acc: 0.645
Validation loss decreased (-0.615931 --> -0.644917).  Saving model ...
Epoch: 11 cost time: 0.5967986583709717
Epoch: 11, Steps: 9 | Train Loss: 0.899 Vali Loss: 0.978 Vali Acc: 0.703 Test Loss: 0.978 Test Acc: 0.703
Validation loss decreased (-0.644917 --> -0.702889).  Saving model ...
Epoch: 12 cost time: 0.6124277114868164
Epoch: 12, Steps: 9 | Train Loss: 0.838 Vali Loss: 0.918 Vali Acc: 0.775 Test Loss: 0.918 Test Acc: 0.775
Validation loss decreased (-0.702889 --> -0.775353).  Saving model ...
Epoch: 13 cost time: 0.6352024078369141
Epoch: 13, Steps: 9 | Train Loss: 0.769 Vali Loss: 0.857 Vali Acc: 0.797 Test Loss: 0.857 Test Acc: 0.797
Validation loss decreased (-0.775353 --> -0.797093).  Saving model ...
Epoch: 14 cost time: 0.6259362697601318
Epoch: 14, Steps: 9 | Train Loss: 0.691 Vali Loss: 0.800 Vali Acc: 0.804 Test Loss: 0.800 Test Acc: 0.804
Validation loss decreased (-0.797093 --> -0.804340).  Saving model ...
Epoch: 15 cost time: 0.5913538932800293
Epoch: 15, Steps: 9 | Train Loss: 0.628 Vali Loss: 0.743 Vali Acc: 0.797 Test Loss: 0.743 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6226754188537598
Epoch: 16, Steps: 9 | Train Loss: 0.558 Vali Loss: 0.696 Vali Acc: 0.826 Test Loss: 0.696 Test Acc: 0.826
Validation loss decreased (-0.804340 --> -0.826080).  Saving model ...
Epoch: 17 cost time: 0.577704906463623
Epoch: 17, Steps: 9 | Train Loss: 0.494 Vali Loss: 0.653 Vali Acc: 0.826 Test Loss: 0.653 Test Acc: 0.826
Validation loss decreased (-0.826080 --> -0.826080).  Saving model ...
Epoch: 18 cost time: 0.6079843044281006
Epoch: 18, Steps: 9 | Train Loss: 0.446 Vali Loss: 0.619 Vali Acc: 0.833 Test Loss: 0.619 Test Acc: 0.833
Validation loss decreased (-0.826080 --> -0.833327).  Saving model ...
Epoch: 19 cost time: 0.5941517353057861
Epoch: 19, Steps: 9 | Train Loss: 0.408 Vali Loss: 0.582 Vali Acc: 0.826 Test Loss: 0.582 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.592501163482666
Epoch: 20, Steps: 9 | Train Loss: 0.353 Vali Loss: 0.546 Vali Acc: 0.826 Test Loss: 0.546 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6006710529327393
Epoch: 21, Steps: 9 | Train Loss: 0.315 Vali Loss: 0.522 Vali Acc: 0.848 Test Loss: 0.522 Test Acc: 0.848
Validation loss decreased (-0.833327 --> -0.847821).  Saving model ...
Epoch: 22 cost time: 0.600588321685791
Epoch: 22, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.502 Vali Acc: 0.848 Test Loss: 0.502 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 23 cost time: 0.5913906097412109
Epoch: 23, Steps: 9 | Train Loss: 0.266 Vali Loss: 0.472 Vali Acc: 0.848 Test Loss: 0.472 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 24 cost time: 0.5632843971252441
Epoch: 24, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.461 Vali Acc: 0.841 Test Loss: 0.461 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.619683027267456
Epoch: 25, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.442 Vali Acc: 0.848 Test Loss: 0.442 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 26 cost time: 0.5521495342254639
Epoch: 26, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.444 Vali Acc: 0.848 Test Loss: 0.444 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6164846420288086
Epoch: 27, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.419 Vali Acc: 0.848 Test Loss: 0.419 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 28 cost time: 0.5837647914886475
Epoch: 28, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.409 Vali Acc: 0.855 Test Loss: 0.409 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 29 cost time: 0.6196401119232178
Epoch: 29, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.399 Vali Acc: 0.855 Test Loss: 0.399 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 30 cost time: 0.6169204711914062
Epoch: 30, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.394 Vali Acc: 0.848 Test Loss: 0.394 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5666265487670898
Epoch: 31, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.392 Vali Acc: 0.848 Test Loss: 0.392 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6102592945098877
Epoch: 32, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.387 Vali Acc: 0.841 Test Loss: 0.387 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6083345413208008
Epoch: 33, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.396 Vali Acc: 0.848 Test Loss: 0.396 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7044756412506104
Epoch: 34, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.365 Vali Acc: 0.862 Test Loss: 0.365 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 35 cost time: 0.5923006534576416
Epoch: 35, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.354 Vali Acc: 0.862 Test Loss: 0.354 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 36 cost time: 0.5746579170227051
Epoch: 36, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.356 Vali Acc: 0.862 Test Loss: 0.356 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5977270603179932
Epoch: 37, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.367 Vali Acc: 0.862 Test Loss: 0.367 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5570447444915771
Epoch: 38, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.376 Vali Acc: 0.855 Test Loss: 0.376 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.688582181930542
Epoch: 39, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.364 Vali Acc: 0.862 Test Loss: 0.364 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.663322925567627
Epoch: 40, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.355 Vali Acc: 0.862 Test Loss: 0.355 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6525158882141113
Epoch: 41, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.361 Vali Acc: 0.855 Test Loss: 0.361 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5699460506439209
Epoch: 42, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.365 Vali Acc: 0.855 Test Loss: 0.365 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.6124541759490967
Epoch: 43, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.355 Vali Acc: 0.855 Test Loss: 0.355 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6622123718261719
Epoch: 44, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.346 Vali Acc: 0.855 Test Loss: 0.346 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.5336904525756836
Epoch: 45, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.348 Vali Acc: 0.855 Test Loss: 0.348 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 81060
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.187629461288452
Epoch: 1, Steps: 9 | Train Loss: 1.241 Vali Loss: 1.008 Vali Acc: 0.565 Test Loss: 1.008 Test Acc: 0.565
Validation loss decreased (inf --> -0.565207).  Saving model ...
Epoch: 2 cost time: 0.8290894031524658
Epoch: 2, Steps: 9 | Train Loss: 0.534 Vali Loss: 0.449 Vali Acc: 0.906 Test Loss: 0.449 Test Acc: 0.906
Validation loss decreased (-0.565207 --> -0.905793).  Saving model ...
Epoch: 3 cost time: 0.7812366485595703
Epoch: 3, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.259 Vali Acc: 0.913 Test Loss: 0.259 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913041).  Saving model ...
Epoch: 4 cost time: 0.7462396621704102
Epoch: 4, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.204 Vali Acc: 0.942 Test Loss: 0.204 Test Acc: 0.942
Validation loss decreased (-0.913041 --> -0.942027).  Saving model ...
Epoch: 5 cost time: 0.7525966167449951
Epoch: 5, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.230 Vali Acc: 0.920 Test Loss: 0.230 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.852776050567627
Epoch: 6, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.942 Test Loss: 0.200 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 7 cost time: 0.8214535713195801
Epoch: 7, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.942 Test Loss: 0.187 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 8 cost time: 0.8348677158355713
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7878601551055908
Epoch: 9, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.942 Test Loss: 0.222 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8544905185699463
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.942 Test Loss: 0.222 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8872072696685791
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7947385311126709
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8816373348236084
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.839000940322876
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.935 Test Loss: 0.212 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8541655540466309
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.935 Test Loss: 0.213 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8607122898101807
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.83522629737854
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.942 Test Loss: 0.201 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 1028868
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8608825206756592
Epoch: 1, Steps: 9 | Train Loss: 1.415 Vali Loss: 1.179 Vali Acc: 0.529 Test Loss: 1.179 Test Acc: 0.529
Validation loss decreased (inf --> -0.528974).  Saving model ...
Epoch: 2 cost time: 0.6536517143249512
Epoch: 2, Steps: 9 | Train Loss: 0.837 Vali Loss: 0.703 Vali Acc: 0.732 Test Loss: 0.703 Test Acc: 0.732
Validation loss decreased (-0.528974 --> -0.731877).  Saving model ...
Epoch: 3 cost time: 0.7349734306335449
Epoch: 3, Steps: 9 | Train Loss: 0.324 Vali Loss: 0.433 Vali Acc: 0.877 Test Loss: 0.433 Test Acc: 0.877
Validation loss decreased (-0.731877 --> -0.876807).  Saving model ...
Epoch: 4 cost time: 0.6964144706726074
Epoch: 4, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.252 Vali Acc: 0.913 Test Loss: 0.252 Test Acc: 0.913
Validation loss decreased (-0.876807 --> -0.913041).  Saving model ...
Epoch: 5 cost time: 0.6988034248352051
Epoch: 5, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
Validation loss decreased (-0.913041 --> -0.956520).  Saving model ...
Epoch: 6 cost time: 0.681990385055542
Epoch: 6, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.183 Vali Acc: 0.942 Test Loss: 0.183 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7491886615753174
Epoch: 7, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.218 Vali Acc: 0.928 Test Loss: 0.218 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7652988433837891
Epoch: 8, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.220 Vali Acc: 0.935 Test Loss: 0.220 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7292859554290771
Epoch: 9, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7464883327484131
Epoch: 10, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5630712509155273
Epoch: 11, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.942 Test Loss: 0.185 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.774282693862915
Epoch: 12, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.942 Test Loss: 0.188 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7064366340637207
Epoch: 13, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.935 Test Loss: 0.194 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7030177116394043
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.935 Test Loss: 0.186 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7877180576324463
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.935 Test Loss: 0.184 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9565217391304348
model parameter : 925700
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9405455589294434
Epoch: 1, Steps: 9 | Train Loss: 1.352 Vali Loss: 1.200 Vali Acc: 0.493 Test Loss: 1.200 Test Acc: 0.493
Validation loss decreased (inf --> -0.492742).  Saving model ...
Epoch: 2 cost time: 0.6248569488525391
Epoch: 2, Steps: 9 | Train Loss: 0.883 Vali Loss: 0.767 Vali Acc: 0.739 Test Loss: 0.767 Test Acc: 0.739
Validation loss decreased (-0.492742 --> -0.739123).  Saving model ...
Epoch: 3 cost time: 0.6106765270233154
Epoch: 3, Steps: 9 | Train Loss: 0.448 Vali Loss: 0.482 Vali Acc: 0.884 Test Loss: 0.482 Test Acc: 0.884
Validation loss decreased (-0.739123 --> -0.884053).  Saving model ...
Epoch: 4 cost time: 0.6184606552124023
Epoch: 4, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.318 Vali Acc: 0.913 Test Loss: 0.318 Test Acc: 0.913
Validation loss decreased (-0.884053 --> -0.913040).  Saving model ...
Epoch: 5 cost time: 0.6789569854736328
Epoch: 5, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.220 Vali Acc: 0.949 Test Loss: 0.220 Test Acc: 0.949
Validation loss decreased (-0.913040 --> -0.949273).  Saving model ...
Epoch: 6 cost time: 0.64359450340271
Epoch: 6, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.207 Vali Acc: 0.942 Test Loss: 0.207 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.622291088104248
Epoch: 7, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.222 Vali Acc: 0.920 Test Loss: 0.222 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6031930446624756
Epoch: 8, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.229 Vali Acc: 0.920 Test Loss: 0.229 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6411471366882324
Epoch: 9, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.199 Vali Acc: 0.942 Test Loss: 0.199 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6756556034088135
Epoch: 10, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 11 cost time: 0.6498613357543945
Epoch: 11, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.190 Vali Acc: 0.949 Test Loss: 0.190 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 12 cost time: 0.6780281066894531
Epoch: 12, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.949 Test Loss: 0.194 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6573243141174316
Epoch: 13, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.928 Test Loss: 0.206 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6156728267669678
Epoch: 14, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.213 Vali Acc: 0.928 Test Loss: 0.213 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6601066589355469
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.935 Test Loss: 0.185 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6722724437713623
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949274).  Saving model ...
Epoch: 17 cost time: 0.6200573444366455
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.942 Test Loss: 0.175 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6376583576202393
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.942 Test Loss: 0.181 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6310031414031982
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.942 Test Loss: 0.183 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6108138561248779
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.942 Test Loss: 0.187 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6066360473632812
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.949 Test Loss: 0.198 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7034893035888672
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.949 Test Loss: 0.196 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5818548202514648
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.949 Test Loss: 0.188 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7793550491333008
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.680565595626831
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.949 Test Loss: 0.188 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6408565044403076
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.949 Test Loss: 0.192 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 899332
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.807176113128662
Epoch: 1, Steps: 9 | Train Loss: 1.340 Vali Loss: 1.261 Vali Acc: 0.399 Test Loss: 1.261 Test Acc: 0.399
Validation loss decreased (inf --> -0.398538).  Saving model ...
Epoch: 2 cost time: 0.5610642433166504
Epoch: 2, Steps: 9 | Train Loss: 0.974 Vali Loss: 0.909 Vali Acc: 0.667 Test Loss: 0.909 Test Acc: 0.667
Validation loss decreased (-0.398538 --> -0.666658).  Saving model ...
Epoch: 3 cost time: 0.5565037727355957
Epoch: 3, Steps: 9 | Train Loss: 0.581 Vali Loss: 0.628 Vali Acc: 0.848 Test Loss: 0.628 Test Acc: 0.848
Validation loss decreased (-0.666658 --> -0.847820).  Saving model ...
Epoch: 4 cost time: 0.5262486934661865
Epoch: 4, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.436 Vali Acc: 0.899 Test Loss: 0.436 Test Acc: 0.899
Validation loss decreased (-0.847820 --> -0.898546).  Saving model ...
Epoch: 5 cost time: 0.5089313983917236
Epoch: 5, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.301 Vali Acc: 0.913 Test Loss: 0.301 Test Acc: 0.913
Validation loss decreased (-0.898546 --> -0.913040).  Saving model ...
Epoch: 6 cost time: 0.5898323059082031
Epoch: 6, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.251 Vali Acc: 0.920 Test Loss: 0.251 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 7 cost time: 0.6294629573822021
Epoch: 7, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.273 Vali Acc: 0.928 Test Loss: 0.273 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927533).  Saving model ...
Epoch: 8 cost time: 0.5775206089019775
Epoch: 8, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.224 Vali Acc: 0.935 Test Loss: 0.224 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934780).  Saving model ...
Epoch: 9 cost time: 0.5815699100494385
Epoch: 9, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.216 Vali Acc: 0.935 Test Loss: 0.216 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 10 cost time: 0.5685954093933105
Epoch: 10, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.213 Vali Acc: 0.935 Test Loss: 0.213 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 11 cost time: 0.6249785423278809
Epoch: 11, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934781).  Saving model ...
Epoch: 12 cost time: 0.6432242393493652
Epoch: 12, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 13 cost time: 0.673724889755249
Epoch: 13, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.196 Vali Acc: 0.935 Test Loss: 0.196 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 14 cost time: 0.5924022197723389
Epoch: 14, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.186 Vali Acc: 0.942 Test Loss: 0.186 Test Acc: 0.942
Validation loss decreased (-0.934781 --> -0.942027).  Saving model ...
Epoch: 15 cost time: 0.6864767074584961
Epoch: 15, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.206 Vali Acc: 0.942 Test Loss: 0.206 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6115696430206299
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.213 Vali Acc: 0.935 Test Loss: 0.213 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.674572229385376
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.935 Test Loss: 0.213 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6719222068786621
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6449663639068604
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6482944488525391
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.935 Test Loss: 0.200 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6626429557800293
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.935 Test Loss: 0.199 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6444556713104248
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.935 Test Loss: 0.199 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6354811191558838
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.935 Test Loss: 0.204 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6264216899871826
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.935 Test Loss: 0.199 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 879108
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.919321060180664
Epoch: 1, Steps: 9 | Train Loss: 1.345 Vali Loss: 1.275 Vali Acc: 0.370 Test Loss: 1.275 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 0.732231855392456
Epoch: 2, Steps: 9 | Train Loss: 1.069 Vali Loss: 0.999 Vali Acc: 0.580 Test Loss: 0.999 Test Acc: 0.580
Validation loss decreased (-0.369552 --> -0.579700).  Saving model ...
Epoch: 3 cost time: 0.7622857093811035
Epoch: 3, Steps: 9 | Train Loss: 0.726 Vali Loss: 0.733 Vali Acc: 0.797 Test Loss: 0.733 Test Acc: 0.797
Validation loss decreased (-0.579700 --> -0.797094).  Saving model ...
Epoch: 4 cost time: 0.718031644821167
Epoch: 4, Steps: 9 | Train Loss: 0.483 Vali Loss: 0.533 Vali Acc: 0.913 Test Loss: 0.533 Test Acc: 0.913
Validation loss decreased (-0.797094 --> -0.913038).  Saving model ...
Epoch: 5 cost time: 0.8218188285827637
Epoch: 5, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.389 Vali Acc: 0.920 Test Loss: 0.389 Test Acc: 0.920
Validation loss decreased (-0.913038 --> -0.920286).  Saving model ...
Epoch: 6 cost time: 0.6653556823730469
Epoch: 6, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.319 Vali Acc: 0.920 Test Loss: 0.319 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920287).  Saving model ...
Epoch: 7 cost time: 0.7348542213439941
Epoch: 7, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.264 Vali Acc: 0.942 Test Loss: 0.264 Test Acc: 0.942
Validation loss decreased (-0.920287 --> -0.942026).  Saving model ...
Epoch: 8 cost time: 0.8013479709625244
Epoch: 8, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.250 Vali Acc: 0.935 Test Loss: 0.250 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.795928955078125
Epoch: 9, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7173395156860352
Epoch: 10, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.220 Vali Acc: 0.935 Test Loss: 0.220 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6842360496520996
Epoch: 11, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.220 Vali Acc: 0.942 Test Loss: 0.220 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 12 cost time: 0.7335317134857178
Epoch: 12, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.217 Vali Acc: 0.935 Test Loss: 0.217 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7949976921081543
Epoch: 13, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.216 Vali Acc: 0.935 Test Loss: 0.216 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.796621561050415
Epoch: 14, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.212 Vali Acc: 0.942 Test Loss: 0.212 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 15 cost time: 0.6832735538482666
Epoch: 15, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7193996906280518
Epoch: 16, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.720991849899292
Epoch: 17, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7286005020141602
Epoch: 18, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7093808650970459
Epoch: 19, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.210 Vali Acc: 0.942 Test Loss: 0.210 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 20 cost time: 0.6855909824371338
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7347772121429443
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7274019718170166
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7243654727935791
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.737917423248291
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.219 Vali Acc: 0.935 Test Loss: 0.219 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7557127475738525
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7147805690765381
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.928 Test Loss: 0.192 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7150897979736328
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.942 Test Loss: 0.188 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 28 cost time: 0.6959631443023682
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.942 Test Loss: 0.185 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 29 cost time: 0.7581479549407959
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.190 Vali Acc: 0.942 Test Loss: 0.190 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7465462684631348
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.928 Test Loss: 0.207 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.695068359375
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7070808410644531
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7138919830322266
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6628050804138184
Epoch: 34, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.935 Test Loss: 0.204 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6548497676849365
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.7166900634765625
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6895155906677246
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.920 Test Loss: 0.210 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.6659698486328125
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 863236
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1310951709747314
Epoch: 1, Steps: 9 | Train Loss: 1.373 Vali Loss: 1.325 Vali Acc: 0.283 Test Loss: 1.325 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 0.7121057510375977
Epoch: 2, Steps: 9 | Train Loss: 1.163 Vali Loss: 1.113 Vali Acc: 0.464 Test Loss: 1.113 Test Acc: 0.464
Validation loss decreased (-0.282595 --> -0.463757).  Saving model ...
Epoch: 3 cost time: 0.7539787292480469
Epoch: 3, Steps: 9 | Train Loss: 0.866 Vali Loss: 0.891 Vali Acc: 0.746 Test Loss: 0.891 Test Acc: 0.746
Validation loss decreased (-0.463757 --> -0.746368).  Saving model ...
Epoch: 4 cost time: 0.675971508026123
Epoch: 4, Steps: 9 | Train Loss: 0.636 Vali Loss: 0.680 Vali Acc: 0.804 Test Loss: 0.680 Test Acc: 0.804
Validation loss decreased (-0.746368 --> -0.804341).  Saving model ...
Epoch: 5 cost time: 0.7203021049499512
Epoch: 5, Steps: 9 | Train Loss: 0.418 Vali Loss: 0.529 Vali Acc: 0.884 Test Loss: 0.529 Test Acc: 0.884
Validation loss decreased (-0.804341 --> -0.884053).  Saving model ...
Epoch: 6 cost time: 0.6974315643310547
Epoch: 6, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.424 Vali Acc: 0.913 Test Loss: 0.424 Test Acc: 0.913
Validation loss decreased (-0.884053 --> -0.913039).  Saving model ...
Epoch: 7 cost time: 0.7059183120727539
Epoch: 7, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.348 Vali Acc: 0.920 Test Loss: 0.348 Test Acc: 0.920
Validation loss decreased (-0.913039 --> -0.920286).  Saving model ...
Epoch: 8 cost time: 0.6712069511413574
Epoch: 8, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.314 Vali Acc: 0.928 Test Loss: 0.314 Test Acc: 0.928
Validation loss decreased (-0.920286 --> -0.927533).  Saving model ...
Epoch: 9 cost time: 0.7579436302185059
Epoch: 9, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.287 Vali Acc: 0.935 Test Loss: 0.287 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934780).  Saving model ...
Epoch: 10 cost time: 0.7182629108428955
Epoch: 10, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.264 Vali Acc: 0.935 Test Loss: 0.264 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 11 cost time: 0.7677097320556641
Epoch: 11, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.253 Vali Acc: 0.942 Test Loss: 0.253 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942026).  Saving model ...
Epoch: 12 cost time: 0.6676037311553955
Epoch: 12, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.242 Vali Acc: 0.942 Test Loss: 0.242 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 13 cost time: 0.7148051261901855
Epoch: 13, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.243 Vali Acc: 0.935 Test Loss: 0.243 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7076573371887207
Epoch: 14, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.242 Vali Acc: 0.935 Test Loss: 0.242 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7303240299224854
Epoch: 15, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.225 Vali Acc: 0.942 Test Loss: 0.225 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 16 cost time: 0.727463960647583
Epoch: 16, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.236 Vali Acc: 0.913 Test Loss: 0.236 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7377562522888184
Epoch: 17, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.223 Vali Acc: 0.928 Test Loss: 0.223 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6870522499084473
Epoch: 18, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.214 Vali Acc: 0.949 Test Loss: 0.214 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949273).  Saving model ...
Epoch: 19 cost time: 0.7531793117523193
Epoch: 19, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.201 Vali Acc: 0.949 Test Loss: 0.201 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 20 cost time: 0.7775449752807617
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.196 Vali Acc: 0.949 Test Loss: 0.196 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 21 cost time: 0.784325361251831
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.949 Test Loss: 0.198 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7618014812469482
Epoch: 22, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.195 Vali Acc: 0.949 Test Loss: 0.195 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 23 cost time: 0.707467794418335
Epoch: 23, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7626724243164062
Epoch: 24, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7624177932739258
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.206 Vali Acc: 0.942 Test Loss: 0.206 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7093219757080078
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.935 Test Loss: 0.212 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6735365390777588
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.206 Vali Acc: 0.942 Test Loss: 0.206 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7220427989959717
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.942 Test Loss: 0.205 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7050654888153076
Epoch: 29, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.942 Test Loss: 0.203 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6770179271697998
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.949 Test Loss: 0.195 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 31 cost time: 0.7029714584350586
Epoch: 31, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.949 Test Loss: 0.188 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 32 cost time: 0.7037429809570312
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.949 Test Loss: 0.190 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7107608318328857
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7492167949676514
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.942 Test Loss: 0.205 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7112932205200195
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.942 Test Loss: 0.198 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.6851317882537842
Epoch: 36, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.949 Test Loss: 0.192 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.7018551826477051
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949274).  Saving model ...
Epoch: 38 cost time: 0.6947827339172363
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7054111957550049
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.949 Test Loss: 0.183 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 40 cost time: 0.6870110034942627
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.949 Test Loss: 0.185 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7480881214141846
Epoch: 41, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6997590065002441
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.942 Test Loss: 0.200 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7387261390686035
Epoch: 43, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6934216022491455
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.7252151966094971
Epoch: 45, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.928 Test Loss: 0.215 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7150008678436279
Epoch: 46, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.713611364364624
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.942 Test Loss: 0.200 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.7326807975769043
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.7492716312408447
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.942 Test Loss: 0.201 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 856836
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9879238605499268
Epoch: 1, Steps: 9 | Train Loss: 1.373 Vali Loss: 1.289 Vali Acc: 0.391 Test Loss: 1.289 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 0.6282432079315186
Epoch: 2, Steps: 9 | Train Loss: 1.179 Vali Loss: 1.106 Vali Acc: 0.536 Test Loss: 1.106 Test Acc: 0.536
Validation loss decreased (-0.391291 --> -0.536221).  Saving model ...
Epoch: 3 cost time: 0.6342649459838867
Epoch: 3, Steps: 9 | Train Loss: 0.931 Vali Loss: 0.895 Vali Acc: 0.717 Test Loss: 0.895 Test Acc: 0.717
Validation loss decreased (-0.536221 --> -0.717382).  Saving model ...
Epoch: 4 cost time: 0.6072371006011963
Epoch: 4, Steps: 9 | Train Loss: 0.694 Vali Loss: 0.712 Vali Acc: 0.812 Test Loss: 0.712 Test Acc: 0.812
Validation loss decreased (-0.717382 --> -0.811587).  Saving model ...
Epoch: 5 cost time: 0.580456018447876
Epoch: 5, Steps: 9 | Train Loss: 0.495 Vali Loss: 0.578 Vali Acc: 0.870 Test Loss: 0.578 Test Acc: 0.870
Validation loss decreased (-0.811587 --> -0.869559).  Saving model ...
Epoch: 6 cost time: 0.6855361461639404
Epoch: 6, Steps: 9 | Train Loss: 0.356 Vali Loss: 0.475 Vali Acc: 0.891 Test Loss: 0.475 Test Acc: 0.891
Validation loss decreased (-0.869559 --> -0.891300).  Saving model ...
Epoch: 7 cost time: 0.6666769981384277
Epoch: 7, Steps: 9 | Train Loss: 0.232 Vali Loss: 0.387 Vali Acc: 0.899 Test Loss: 0.387 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 8 cost time: 0.7224586009979248
Epoch: 8, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.339 Vali Acc: 0.906 Test Loss: 0.339 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 9 cost time: 0.6932084560394287
Epoch: 9, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.313 Vali Acc: 0.935 Test Loss: 0.313 Test Acc: 0.935
Validation loss decreased (-0.905794 --> -0.934779).  Saving model ...
Epoch: 10 cost time: 0.6689498424530029
Epoch: 10, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.292 Vali Acc: 0.928 Test Loss: 0.292 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7042875289916992
Epoch: 11, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.284 Vali Acc: 0.935 Test Loss: 0.284 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934780).  Saving model ...
Epoch: 12 cost time: 0.6132121086120605
Epoch: 12, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.270 Vali Acc: 0.935 Test Loss: 0.270 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 13 cost time: 0.6573517322540283
Epoch: 13, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.256 Vali Acc: 0.928 Test Loss: 0.256 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6559431552886963
Epoch: 14, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.248 Vali Acc: 0.928 Test Loss: 0.248 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6863172054290771
Epoch: 15, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.253 Vali Acc: 0.928 Test Loss: 0.253 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7559888362884521
Epoch: 16, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.243 Vali Acc: 0.935 Test Loss: 0.243 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 17 cost time: 0.6578364372253418
Epoch: 17, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.253 Vali Acc: 0.935 Test Loss: 0.253 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.753049373626709
Epoch: 18, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.251 Vali Acc: 0.928 Test Loss: 0.251 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6872541904449463
Epoch: 19, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.231 Vali Acc: 0.928 Test Loss: 0.231 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6668317317962646
Epoch: 20, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.231 Vali Acc: 0.920 Test Loss: 0.231 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6485476493835449
Epoch: 21, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.219 Vali Acc: 0.928 Test Loss: 0.219 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7591917514801025
Epoch: 22, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.213 Vali Acc: 0.942 Test Loss: 0.213 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 23 cost time: 0.6850929260253906
Epoch: 23, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.206 Vali Acc: 0.942 Test Loss: 0.206 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 24 cost time: 0.635533332824707
Epoch: 24, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.942 Test Loss: 0.210 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6539561748504639
Epoch: 25, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.216 Vali Acc: 0.935 Test Loss: 0.216 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6395039558410645
Epoch: 26, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6698288917541504
Epoch: 27, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.224 Vali Acc: 0.935 Test Loss: 0.224 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7032725811004639
Epoch: 28, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.216 Vali Acc: 0.942 Test Loss: 0.216 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7083225250244141
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.942 Test Loss: 0.212 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7264654636383057
Epoch: 30, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.211 Vali Acc: 0.942 Test Loss: 0.211 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6649696826934814
Epoch: 31, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6516032218933105
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.935 Test Loss: 0.240 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.67218017578125
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.928 Test Loss: 0.244 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 853252
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9147944450378418
Epoch: 1, Steps: 9 | Train Loss: 1.321 Vali Loss: 1.146 Vali Acc: 0.478 Test Loss: 1.146 Test Acc: 0.478
Validation loss decreased (inf --> -0.478249).  Saving model ...
Epoch: 2 cost time: 0.7189784049987793
Epoch: 2, Steps: 9 | Train Loss: 0.766 Vali Loss: 0.690 Vali Acc: 0.819 Test Loss: 0.690 Test Acc: 0.819
Validation loss decreased (-0.478249 --> -0.818834).  Saving model ...
Epoch: 3 cost time: 0.6629343032836914
Epoch: 3, Steps: 9 | Train Loss: 0.313 Vali Loss: 0.371 Vali Acc: 0.913 Test Loss: 0.371 Test Acc: 0.913
Validation loss decreased (-0.818834 --> -0.913040).  Saving model ...
Epoch: 4 cost time: 0.6405723094940186
Epoch: 4, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.258 Vali Acc: 0.935 Test Loss: 0.258 Test Acc: 0.935
Validation loss decreased (-0.913040 --> -0.934780).  Saving model ...
Epoch: 5 cost time: 0.5930678844451904
Epoch: 5, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.217 Vali Acc: 0.913 Test Loss: 0.217 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7201523780822754
Epoch: 6, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.182 Vali Acc: 0.942 Test Loss: 0.182 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 7 cost time: 0.6811940670013428
Epoch: 7, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.182 Vali Acc: 0.942 Test Loss: 0.182 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 8 cost time: 0.6522595882415771
Epoch: 8, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.935 Test Loss: 0.192 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7130658626556396
Epoch: 9, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.199 Vali Acc: 0.920 Test Loss: 0.199 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5953881740570068
Epoch: 10, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.920 Test Loss: 0.204 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.675466775894165
Epoch: 11, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.928 Test Loss: 0.194 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6567678451538086
Epoch: 12, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.928 Test Loss: 0.191 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.751929759979248
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.928 Test Loss: 0.190 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7032437324523926
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.186 Vali Acc: 0.928 Test Loss: 0.186 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6781859397888184
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.920 Test Loss: 0.207 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7031204700469971
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.920 Test Loss: 0.206 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6536548137664795
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949274).  Saving model ...
Epoch: 18 cost time: 0.6302073001861572
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.942 Test Loss: 0.169 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.671205997467041
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.928 Test Loss: 0.180 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7390155792236328
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.928 Test Loss: 0.183 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7593719959259033
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6773409843444824
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.920 Test Loss: 0.217 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6575117111206055
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6387014389038086
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.928 Test Loss: 0.197 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6258869171142578
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.928 Test Loss: 0.197 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.569807767868042
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.928 Test Loss: 0.199 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6435010433197021
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.928 Test Loss: 0.199 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 317828
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8160796165466309
Epoch: 1, Steps: 9 | Train Loss: 1.388 Vali Loss: 1.253 Vali Acc: 0.399 Test Loss: 1.253 Test Acc: 0.399
Validation loss decreased (inf --> -0.398538).  Saving model ...
Epoch: 2 cost time: 0.6728007793426514
Epoch: 2, Steps: 9 | Train Loss: 1.017 Vali Loss: 0.925 Vali Acc: 0.732 Test Loss: 0.925 Test Acc: 0.732
Validation loss decreased (-0.398538 --> -0.731875).  Saving model ...
Epoch: 3 cost time: 0.58847975730896
Epoch: 3, Steps: 9 | Train Loss: 0.616 Vali Loss: 0.629 Vali Acc: 0.819 Test Loss: 0.629 Test Acc: 0.819
Validation loss decreased (-0.731875 --> -0.818834).  Saving model ...
Epoch: 4 cost time: 0.6504819393157959
Epoch: 4, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.421 Vali Acc: 0.913 Test Loss: 0.421 Test Acc: 0.913
Validation loss decreased (-0.818834 --> -0.913039).  Saving model ...
Epoch: 5 cost time: 0.5936939716339111
Epoch: 5, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.291 Vali Acc: 0.935 Test Loss: 0.291 Test Acc: 0.935
Validation loss decreased (-0.913039 --> -0.934780).  Saving model ...
Epoch: 6 cost time: 0.5929818153381348
Epoch: 6, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.229 Vali Acc: 0.949 Test Loss: 0.229 Test Acc: 0.949
Validation loss decreased (-0.934780 --> -0.949273).  Saving model ...
Epoch: 7 cost time: 0.6746079921722412
Epoch: 7, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.207 Vali Acc: 0.949 Test Loss: 0.207 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 8 cost time: 0.6164853572845459
Epoch: 8, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.201 Vali Acc: 0.949 Test Loss: 0.201 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 9 cost time: 0.6311309337615967
Epoch: 9, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.185 Vali Acc: 0.949 Test Loss: 0.185 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949274).  Saving model ...
Epoch: 10 cost time: 0.6613724231719971
Epoch: 10, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 11 cost time: 0.602001428604126
Epoch: 11, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5952455997467041
Epoch: 12, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.645179271697998
Epoch: 13, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.185 Vali Acc: 0.949 Test Loss: 0.185 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7142205238342285
Epoch: 14, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6712806224822998
Epoch: 15, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6145114898681641
Epoch: 16, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.169 Vali Acc: 0.942 Test Loss: 0.169 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.668748140335083
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.942 Test Loss: 0.166 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6239559650421143
Epoch: 18, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.175 Vali Acc: 0.942 Test Loss: 0.175 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6491718292236328
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.187 Vali Acc: 0.942 Test Loss: 0.187 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6674809455871582
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.942 Test Loss: 0.189 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 266244
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8371868133544922
Epoch: 1, Steps: 9 | Train Loss: 1.397 Vali Loss: 1.279 Vali Acc: 0.457 Test Loss: 1.279 Test Acc: 0.457
Validation loss decreased (inf --> -0.456509).  Saving model ...
Epoch: 2 cost time: 0.6635692119598389
Epoch: 2, Steps: 9 | Train Loss: 1.080 Vali Loss: 1.009 Vali Acc: 0.623 Test Loss: 1.009 Test Acc: 0.623
Validation loss decreased (-0.456509 --> -0.623178).  Saving model ...
Epoch: 3 cost time: 0.6648857593536377
Epoch: 3, Steps: 9 | Train Loss: 0.754 Vali Loss: 0.731 Vali Acc: 0.812 Test Loss: 0.731 Test Acc: 0.812
Validation loss decreased (-0.623178 --> -0.811587).  Saving model ...
Epoch: 4 cost time: 0.5740253925323486
Epoch: 4, Steps: 9 | Train Loss: 0.452 Vali Loss: 0.525 Vali Acc: 0.891 Test Loss: 0.525 Test Acc: 0.891
Validation loss decreased (-0.811587 --> -0.891299).  Saving model ...
Epoch: 5 cost time: 0.5799674987792969
Epoch: 5, Steps: 9 | Train Loss: 0.281 Vali Loss: 0.395 Vali Acc: 0.920 Test Loss: 0.395 Test Acc: 0.920
Validation loss decreased (-0.891299 --> -0.920286).  Saving model ...
Epoch: 6 cost time: 0.6368470191955566
Epoch: 6, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.295 Vali Acc: 0.935 Test Loss: 0.295 Test Acc: 0.935
Validation loss decreased (-0.920286 --> -0.934780).  Saving model ...
Epoch: 7 cost time: 0.5861060619354248
Epoch: 7, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.260 Vali Acc: 0.942 Test Loss: 0.260 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942026).  Saving model ...
Epoch: 8 cost time: 0.6205489635467529
Epoch: 8, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.238 Vali Acc: 0.935 Test Loss: 0.238 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6811943054199219
Epoch: 9, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.230 Vali Acc: 0.942 Test Loss: 0.230 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 10 cost time: 0.6088824272155762
Epoch: 10, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.222 Vali Acc: 0.935 Test Loss: 0.222 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6811678409576416
Epoch: 11, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5632524490356445
Epoch: 12, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5910780429840088
Epoch: 13, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.190 Vali Acc: 0.935 Test Loss: 0.190 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6470696926116943
Epoch: 14, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.194 Vali Acc: 0.935 Test Loss: 0.194 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.61234450340271
Epoch: 15, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6552653312683105
Epoch: 16, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.194 Vali Acc: 0.935 Test Loss: 0.194 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5584549903869629
Epoch: 17, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.189 Vali Acc: 0.935 Test Loss: 0.189 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5861845016479492
Epoch: 18, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5878868103027344
Epoch: 19, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.191 Vali Acc: 0.935 Test Loss: 0.191 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 253060
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8784241676330566
Epoch: 1, Steps: 9 | Train Loss: 1.313 Vali Loss: 1.289 Vali Acc: 0.428 Test Loss: 1.289 Test Acc: 0.428
Validation loss decreased (inf --> -0.427523).  Saving model ...
Epoch: 2 cost time: 0.6630511283874512
Epoch: 2, Steps: 9 | Train Loss: 1.087 Vali Loss: 1.088 Vali Acc: 0.638 Test Loss: 1.088 Test Acc: 0.638
Validation loss decreased (-0.427523 --> -0.637670).  Saving model ...
Epoch: 3 cost time: 0.5602777004241943
Epoch: 3, Steps: 9 | Train Loss: 0.841 Vali Loss: 0.858 Vali Acc: 0.732 Test Loss: 0.858 Test Acc: 0.732
Validation loss decreased (-0.637670 --> -0.731875).  Saving model ...
Epoch: 4 cost time: 0.6024353504180908
Epoch: 4, Steps: 9 | Train Loss: 0.586 Vali Loss: 0.671 Vali Acc: 0.819 Test Loss: 0.671 Test Acc: 0.819
Validation loss decreased (-0.731875 --> -0.818834).  Saving model ...
Epoch: 5 cost time: 0.5614054203033447
Epoch: 5, Steps: 9 | Train Loss: 0.403 Vali Loss: 0.514 Vali Acc: 0.870 Test Loss: 0.514 Test Acc: 0.870
Validation loss decreased (-0.818834 --> -0.869560).  Saving model ...
Epoch: 6 cost time: 0.5677633285522461
Epoch: 6, Steps: 9 | Train Loss: 0.254 Vali Loss: 0.406 Vali Acc: 0.906 Test Loss: 0.406 Test Acc: 0.906
Validation loss decreased (-0.869560 --> -0.905793).  Saving model ...
Epoch: 7 cost time: 0.5671989917755127
Epoch: 7, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.336 Vali Acc: 0.928 Test Loss: 0.336 Test Acc: 0.928
Validation loss decreased (-0.905793 --> -0.927533).  Saving model ...
Epoch: 8 cost time: 0.5339095592498779
Epoch: 8, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.293 Vali Acc: 0.935 Test Loss: 0.293 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934780).  Saving model ...
Epoch: 9 cost time: 0.6498441696166992
Epoch: 9, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.271 Vali Acc: 0.935 Test Loss: 0.271 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 10 cost time: 0.6121702194213867
Epoch: 10, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.245 Vali Acc: 0.942 Test Loss: 0.245 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 11 cost time: 0.571382999420166
Epoch: 11, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.237 Vali Acc: 0.942 Test Loss: 0.237 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 12 cost time: 0.5985150337219238
Epoch: 12, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6758239269256592
Epoch: 13, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6176578998565674
Epoch: 14, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.224 Vali Acc: 0.928 Test Loss: 0.224 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6095414161682129
Epoch: 15, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.219 Vali Acc: 0.935 Test Loss: 0.219 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7063446044921875
Epoch: 16, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.217 Vali Acc: 0.928 Test Loss: 0.217 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6563172340393066
Epoch: 17, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6373648643493652
Epoch: 18, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5724916458129883
Epoch: 19, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5673344135284424
Epoch: 20, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.209 Vali Acc: 0.928 Test Loss: 0.209 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6830744743347168
Epoch: 21, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 242948
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.855760097503662
Epoch: 1, Steps: 9 | Train Loss: 1.429 Vali Loss: 1.338 Vali Acc: 0.370 Test Loss: 1.338 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 0.5751147270202637
Epoch: 2, Steps: 9 | Train Loss: 1.219 Vali Loss: 1.160 Vali Acc: 0.630 Test Loss: 1.160 Test Acc: 0.630
Validation loss decreased (-0.369552 --> -0.630423).  Saving model ...
Epoch: 3 cost time: 0.5587480068206787
Epoch: 3, Steps: 9 | Train Loss: 0.984 Vali Loss: 0.949 Vali Acc: 0.732 Test Loss: 0.949 Test Acc: 0.732
Validation loss decreased (-0.630423 --> -0.731875).  Saving model ...
Epoch: 4 cost time: 0.571307897567749
Epoch: 4, Steps: 9 | Train Loss: 0.777 Vali Loss: 0.771 Vali Acc: 0.783 Test Loss: 0.771 Test Acc: 0.783
Validation loss decreased (-0.731875 --> -0.782601).  Saving model ...
Epoch: 5 cost time: 0.5520284175872803
Epoch: 5, Steps: 9 | Train Loss: 0.561 Vali Loss: 0.640 Vali Acc: 0.848 Test Loss: 0.640 Test Acc: 0.848
Validation loss decreased (-0.782601 --> -0.847820).  Saving model ...
Epoch: 6 cost time: 0.5941956043243408
Epoch: 6, Steps: 9 | Train Loss: 0.421 Vali Loss: 0.519 Vali Acc: 0.891 Test Loss: 0.519 Test Acc: 0.891
Validation loss decreased (-0.847820 --> -0.891299).  Saving model ...
Epoch: 7 cost time: 0.5443105697631836
Epoch: 7, Steps: 9 | Train Loss: 0.309 Vali Loss: 0.433 Vali Acc: 0.906 Test Loss: 0.433 Test Acc: 0.906
Validation loss decreased (-0.891299 --> -0.905793).  Saving model ...
Epoch: 8 cost time: 0.4744393825531006
Epoch: 8, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.370 Vali Acc: 0.913 Test Loss: 0.370 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913040).  Saving model ...
Epoch: 9 cost time: 0.5444016456604004
Epoch: 9, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.330 Vali Acc: 0.928 Test Loss: 0.330 Test Acc: 0.928
Validation loss decreased (-0.913040 --> -0.927533).  Saving model ...
Epoch: 10 cost time: 0.5561163425445557
Epoch: 10, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.305 Vali Acc: 0.935 Test Loss: 0.305 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934780).  Saving model ...
Epoch: 11 cost time: 0.5569632053375244
Epoch: 11, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.304 Vali Acc: 0.928 Test Loss: 0.304 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5627870559692383
Epoch: 12, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.284 Vali Acc: 0.928 Test Loss: 0.284 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6097285747528076
Epoch: 13, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.259 Vali Acc: 0.928 Test Loss: 0.259 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5693628787994385
Epoch: 14, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.246 Vali Acc: 0.949 Test Loss: 0.246 Test Acc: 0.949
Validation loss decreased (-0.934780 --> -0.949273).  Saving model ...
Epoch: 15 cost time: 0.5608615875244141
Epoch: 15, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.242 Vali Acc: 0.949 Test Loss: 0.242 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 16 cost time: 0.5644392967224121
Epoch: 16, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.243 Vali Acc: 0.942 Test Loss: 0.243 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5865676403045654
Epoch: 17, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.241 Vali Acc: 0.942 Test Loss: 0.241 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5671226978302002
Epoch: 18, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.237 Vali Acc: 0.942 Test Loss: 0.237 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6570055484771729
Epoch: 19, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.236 Vali Acc: 0.935 Test Loss: 0.236 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5297353267669678
Epoch: 20, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.228 Vali Acc: 0.935 Test Loss: 0.228 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5842785835266113
Epoch: 21, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.220 Vali Acc: 0.942 Test Loss: 0.220 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5673725605010986
Epoch: 22, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.222 Vali Acc: 0.942 Test Loss: 0.222 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5609035491943359
Epoch: 23, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.229 Vali Acc: 0.935 Test Loss: 0.229 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5802092552185059
Epoch: 24, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.236 Vali Acc: 0.935 Test Loss: 0.236 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.575153112411499
Epoch: 25, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 235012
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9884569644927979
Epoch: 1, Steps: 9 | Train Loss: 1.515 Vali Loss: 1.369 Vali Acc: 0.355 Test Loss: 1.369 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 0.5922069549560547
Epoch: 2, Steps: 9 | Train Loss: 1.348 Vali Loss: 1.243 Vali Acc: 0.435 Test Loss: 1.243 Test Acc: 0.435
Validation loss decreased (-0.355059 --> -0.434770).  Saving model ...
Epoch: 3 cost time: 0.6008572578430176
Epoch: 3, Steps: 9 | Train Loss: 1.124 Vali Loss: 1.079 Vali Acc: 0.558 Test Loss: 1.079 Test Acc: 0.558
Validation loss decreased (-0.434770 --> -0.557960).  Saving model ...
Epoch: 4 cost time: 0.594376802444458
Epoch: 4, Steps: 9 | Train Loss: 0.906 Vali Loss: 0.923 Vali Acc: 0.667 Test Loss: 0.923 Test Acc: 0.667
Validation loss decreased (-0.557960 --> -0.666657).  Saving model ...
Epoch: 5 cost time: 0.6022152900695801
Epoch: 5, Steps: 9 | Train Loss: 0.719 Vali Loss: 0.783 Vali Acc: 0.732 Test Loss: 0.783 Test Acc: 0.732
Validation loss decreased (-0.666657 --> -0.731876).  Saving model ...
Epoch: 6 cost time: 0.6369352340698242
Epoch: 6, Steps: 9 | Train Loss: 0.585 Vali Loss: 0.661 Vali Acc: 0.790 Test Loss: 0.661 Test Acc: 0.790
Validation loss decreased (-0.731876 --> -0.789848).  Saving model ...
Epoch: 7 cost time: 0.7014949321746826
Epoch: 7, Steps: 9 | Train Loss: 0.433 Vali Loss: 0.560 Vali Acc: 0.841 Test Loss: 0.560 Test Acc: 0.841
Validation loss decreased (-0.789848 --> -0.840574).  Saving model ...
Epoch: 8 cost time: 0.6439282894134521
Epoch: 8, Steps: 9 | Train Loss: 0.339 Vali Loss: 0.488 Vali Acc: 0.870 Test Loss: 0.488 Test Acc: 0.870
Validation loss decreased (-0.840574 --> -0.869560).  Saving model ...
Epoch: 9 cost time: 0.6296212673187256
Epoch: 9, Steps: 9 | Train Loss: 0.256 Vali Loss: 0.445 Vali Acc: 0.862 Test Loss: 0.445 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7044298648834229
Epoch: 10, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.397 Vali Acc: 0.862 Test Loss: 0.397 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7063567638397217
Epoch: 11, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.361 Vali Acc: 0.877 Test Loss: 0.361 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876808).  Saving model ...
Epoch: 12 cost time: 0.598616361618042
Epoch: 12, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.340 Vali Acc: 0.877 Test Loss: 0.340 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 13 cost time: 0.5922753810882568
Epoch: 13, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.328 Vali Acc: 0.899 Test Loss: 0.328 Test Acc: 0.899
Validation loss decreased (-0.876808 --> -0.898547).  Saving model ...
Epoch: 14 cost time: 0.6432297229766846
Epoch: 14, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.317 Vali Acc: 0.906 Test Loss: 0.317 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 15 cost time: 0.576439380645752
Epoch: 15, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.309 Vali Acc: 0.906 Test Loss: 0.309 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 16 cost time: 0.587407112121582
Epoch: 16, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.291 Vali Acc: 0.906 Test Loss: 0.291 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 17 cost time: 0.6049849987030029
Epoch: 17, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.281 Vali Acc: 0.920 Test Loss: 0.281 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920287).  Saving model ...
Epoch: 18 cost time: 0.7069664001464844
Epoch: 18, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.268 Vali Acc: 0.920 Test Loss: 0.268 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 19 cost time: 0.6214599609375
Epoch: 19, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.264 Vali Acc: 0.913 Test Loss: 0.264 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6389486789703369
Epoch: 20, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.263 Vali Acc: 0.920 Test Loss: 0.263 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 21 cost time: 0.5632343292236328
Epoch: 21, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.254 Vali Acc: 0.906 Test Loss: 0.254 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6172752380371094
Epoch: 22, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.249 Vali Acc: 0.913 Test Loss: 0.249 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6535015106201172
Epoch: 23, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.245 Vali Acc: 0.913 Test Loss: 0.245 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5487663745880127
Epoch: 24, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.237 Vali Acc: 0.920 Test Loss: 0.237 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 25 cost time: 0.6170191764831543
Epoch: 25, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.235 Vali Acc: 0.920 Test Loss: 0.235 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920288).  Saving model ...
Epoch: 26 cost time: 0.6088371276855469
Epoch: 26, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.238 Vali Acc: 0.920 Test Loss: 0.238 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6399972438812256
Epoch: 27, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.233 Vali Acc: 0.920 Test Loss: 0.233 Test Acc: 0.920
Validation loss decreased (-0.920288 --> -0.920288).  Saving model ...
Epoch: 28 cost time: 0.6649572849273682
Epoch: 28, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.225 Vali Acc: 0.913 Test Loss: 0.225 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6688082218170166
Epoch: 29, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
Validation loss decreased (-0.920288 --> -0.927534).  Saving model ...
Epoch: 30 cost time: 0.6223225593566895
Epoch: 30, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.207 Vali Acc: 0.928 Test Loss: 0.207 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 31 cost time: 0.6316983699798584
Epoch: 31, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.204 Vali Acc: 0.935 Test Loss: 0.204 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934781).  Saving model ...
Epoch: 32 cost time: 0.6310040950775146
Epoch: 32, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.201 Vali Acc: 0.942 Test Loss: 0.201 Test Acc: 0.942
Validation loss decreased (-0.934781 --> -0.942027).  Saving model ...
Epoch: 33 cost time: 0.7248032093048096
Epoch: 33, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6377534866333008
Epoch: 34, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6129796504974365
Epoch: 35, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.213 Vali Acc: 0.928 Test Loss: 0.213 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6641368865966797
Epoch: 36, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6134746074676514
Epoch: 37, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5701248645782471
Epoch: 38, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.197 Vali Acc: 0.928 Test Loss: 0.197 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6735250949859619
Epoch: 39, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.197 Vali Acc: 0.920 Test Loss: 0.197 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.6439030170440674
Epoch: 40, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.202 Vali Acc: 0.920 Test Loss: 0.202 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5646679401397705
Epoch: 41, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.194 Vali Acc: 0.920 Test Loss: 0.194 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.7419116497039795
Epoch: 42, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 231812
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8418841361999512
Epoch: 1, Steps: 9 | Train Loss: 1.413 Vali Loss: 1.364 Vali Acc: 0.319 Test Loss: 1.364 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 0.5416610240936279
Epoch: 2, Steps: 9 | Train Loss: 1.287 Vali Loss: 1.253 Vali Acc: 0.449 Test Loss: 1.253 Test Acc: 0.449
Validation loss decreased (-0.318827 --> -0.449263).  Saving model ...
Epoch: 3 cost time: 0.5494418144226074
Epoch: 3, Steps: 9 | Train Loss: 1.116 Vali Loss: 1.110 Vali Acc: 0.522 Test Loss: 1.110 Test Acc: 0.522
Validation loss decreased (-0.449263 --> -0.521728).  Saving model ...
Epoch: 4 cost time: 0.5627038478851318
Epoch: 4, Steps: 9 | Train Loss: 0.940 Vali Loss: 0.971 Vali Acc: 0.580 Test Loss: 0.971 Test Acc: 0.580
Validation loss decreased (-0.521728 --> -0.579700).  Saving model ...
Epoch: 5 cost time: 0.5075891017913818
Epoch: 5, Steps: 9 | Train Loss: 0.759 Vali Loss: 0.855 Vali Acc: 0.645 Test Loss: 0.855 Test Acc: 0.645
Validation loss decreased (-0.579700 --> -0.644919).  Saving model ...
Epoch: 6 cost time: 0.5357892513275146
Epoch: 6, Steps: 9 | Train Loss: 0.620 Vali Loss: 0.761 Vali Acc: 0.732 Test Loss: 0.761 Test Acc: 0.732
Validation loss decreased (-0.644919 --> -0.731876).  Saving model ...
Epoch: 7 cost time: 0.5447571277618408
Epoch: 7, Steps: 9 | Train Loss: 0.515 Vali Loss: 0.662 Vali Acc: 0.790 Test Loss: 0.662 Test Acc: 0.790
Validation loss decreased (-0.731876 --> -0.789848).  Saving model ...
Epoch: 8 cost time: 0.5487744808197021
Epoch: 8, Steps: 9 | Train Loss: 0.397 Vali Loss: 0.573 Vali Acc: 0.812 Test Loss: 0.573 Test Acc: 0.812
Validation loss decreased (-0.789848 --> -0.811588).  Saving model ...
Epoch: 9 cost time: 0.5640785694122314
Epoch: 9, Steps: 9 | Train Loss: 0.315 Vali Loss: 0.517 Vali Acc: 0.826 Test Loss: 0.517 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826082).  Saving model ...
Epoch: 10 cost time: 0.5763256549835205
Epoch: 10, Steps: 9 | Train Loss: 0.266 Vali Loss: 0.488 Vali Acc: 0.848 Test Loss: 0.488 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847821).  Saving model ...
Epoch: 11 cost time: 0.5438957214355469
Epoch: 11, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.439 Vali Acc: 0.877 Test Loss: 0.439 Test Acc: 0.877
Validation loss decreased (-0.847821 --> -0.876807).  Saving model ...
Epoch: 12 cost time: 0.5401833057403564
Epoch: 12, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.404 Vali Acc: 0.913 Test Loss: 0.404 Test Acc: 0.913
Validation loss decreased (-0.876807 --> -0.913039).  Saving model ...
Epoch: 13 cost time: 0.5350005626678467
Epoch: 13, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.390 Vali Acc: 0.913 Test Loss: 0.390 Test Acc: 0.913
Validation loss decreased (-0.913039 --> -0.913040).  Saving model ...
Epoch: 14 cost time: 0.536334753036499
Epoch: 14, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.374 Vali Acc: 0.899 Test Loss: 0.374 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5197951793670654
Epoch: 15, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.356 Vali Acc: 0.891 Test Loss: 0.356 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.54010009765625
Epoch: 16, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.349 Vali Acc: 0.891 Test Loss: 0.349 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.566741943359375
Epoch: 17, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.336 Vali Acc: 0.913 Test Loss: 0.336 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 18 cost time: 0.5439910888671875
Epoch: 18, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.322 Vali Acc: 0.920 Test Loss: 0.322 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 19 cost time: 0.5387446880340576
Epoch: 19, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.318 Vali Acc: 0.913 Test Loss: 0.318 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5696971416473389
Epoch: 20, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.312 Vali Acc: 0.906 Test Loss: 0.312 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5847806930541992
Epoch: 21, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.304 Vali Acc: 0.899 Test Loss: 0.304 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5632040500640869
Epoch: 22, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.291 Vali Acc: 0.899 Test Loss: 0.291 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5635828971862793
Epoch: 23, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.281 Vali Acc: 0.906 Test Loss: 0.281 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5541446208953857
Epoch: 24, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.273 Vali Acc: 0.920 Test Loss: 0.273 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 25 cost time: 0.5564186573028564
Epoch: 25, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.284 Vali Acc: 0.906 Test Loss: 0.284 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5539536476135254
Epoch: 26, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.280 Vali Acc: 0.913 Test Loss: 0.280 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5747346878051758
Epoch: 27, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5425095558166504
Epoch: 28, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.282 Vali Acc: 0.906 Test Loss: 0.282 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5524134635925293
Epoch: 29, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.274 Vali Acc: 0.913 Test Loss: 0.274 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.566227912902832
Epoch: 30, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.269 Vali Acc: 0.906 Test Loss: 0.269 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5414481163024902
Epoch: 31, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.272 Vali Acc: 0.906 Test Loss: 0.272 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5332434177398682
Epoch: 32, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.263 Vali Acc: 0.906 Test Loss: 0.263 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5359828472137451
Epoch: 33, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.262 Vali Acc: 0.913 Test Loss: 0.262 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5335807800292969
Epoch: 34, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.259 Vali Acc: 0.913 Test Loss: 0.259 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 230020
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8329930305480957
Epoch: 1, Steps: 9 | Train Loss: 1.390 Vali Loss: 1.235 Vali Acc: 0.442 Test Loss: 1.235 Test Acc: 0.442
Validation loss decreased (inf --> -0.442017).  Saving model ...
Epoch: 2 cost time: 0.550586462020874
Epoch: 2, Steps: 9 | Train Loss: 1.041 Vali Loss: 0.939 Vali Acc: 0.623 Test Loss: 0.939 Test Acc: 0.623
Validation loss decreased (-0.442017 --> -0.623179).  Saving model ...
Epoch: 3 cost time: 0.5747966766357422
Epoch: 3, Steps: 9 | Train Loss: 0.638 Vali Loss: 0.667 Vali Acc: 0.746 Test Loss: 0.667 Test Acc: 0.746
Validation loss decreased (-0.623179 --> -0.746370).  Saving model ...
Epoch: 4 cost time: 0.5549616813659668
Epoch: 4, Steps: 9 | Train Loss: 0.330 Vali Loss: 0.462 Vali Acc: 0.862 Test Loss: 0.462 Test Acc: 0.862
Validation loss decreased (-0.746370 --> -0.862314).  Saving model ...
Epoch: 5 cost time: 0.5581011772155762
Epoch: 5, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.334 Vali Acc: 0.906 Test Loss: 0.334 Test Acc: 0.906
Validation loss decreased (-0.862314 --> -0.905794).  Saving model ...
Epoch: 6 cost time: 0.5697441101074219
Epoch: 6, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.260 Vali Acc: 0.920 Test Loss: 0.260 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920287).  Saving model ...
Epoch: 7 cost time: 0.5655102729797363
Epoch: 7, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.222 Vali Acc: 0.949 Test Loss: 0.222 Test Acc: 0.949
Validation loss decreased (-0.920287 --> -0.949273).  Saving model ...
Epoch: 8 cost time: 0.6430466175079346
Epoch: 8, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.212 Vali Acc: 0.935 Test Loss: 0.212 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5495274066925049
Epoch: 9, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5874848365783691
Epoch: 10, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.221 Vali Acc: 0.920 Test Loss: 0.221 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5581469535827637
Epoch: 11, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.215 Vali Acc: 0.913 Test Loss: 0.215 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6535365581512451
Epoch: 12, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6571774482727051
Epoch: 13, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.215 Vali Acc: 0.928 Test Loss: 0.215 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6099209785461426
Epoch: 14, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5641071796417236
Epoch: 15, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6321535110473633
Epoch: 16, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5646131038665771
Epoch: 17, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 109764
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8673772811889648
Epoch: 1, Steps: 9 | Train Loss: 1.368 Vali Loss: 1.318 Vali Acc: 0.312 Test Loss: 1.318 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 0.5554170608520508
Epoch: 2, Steps: 9 | Train Loss: 1.158 Vali Loss: 1.117 Vali Acc: 0.522 Test Loss: 1.117 Test Acc: 0.522
Validation loss decreased (-0.311581 --> -0.521728).  Saving model ...
Epoch: 3 cost time: 0.5623581409454346
Epoch: 3, Steps: 9 | Train Loss: 0.870 Vali Loss: 0.874 Vali Acc: 0.725 Test Loss: 0.874 Test Acc: 0.725
Validation loss decreased (-0.521728 --> -0.724629).  Saving model ...
Epoch: 4 cost time: 0.5080742835998535
Epoch: 4, Steps: 9 | Train Loss: 0.599 Vali Loss: 0.666 Vali Acc: 0.833 Test Loss: 0.666 Test Acc: 0.833
Validation loss decreased (-0.724629 --> -0.833327).  Saving model ...
Epoch: 5 cost time: 0.6149625778198242
Epoch: 5, Steps: 9 | Train Loss: 0.387 Vali Loss: 0.506 Vali Acc: 0.913 Test Loss: 0.506 Test Acc: 0.913
Validation loss decreased (-0.833327 --> -0.913038).  Saving model ...
Epoch: 6 cost time: 0.5747647285461426
Epoch: 6, Steps: 9 | Train Loss: 0.263 Vali Loss: 0.386 Vali Acc: 0.928 Test Loss: 0.386 Test Acc: 0.928
Validation loss decreased (-0.913038 --> -0.927532).  Saving model ...
Epoch: 7 cost time: 0.6186013221740723
Epoch: 7, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.323 Vali Acc: 0.942 Test Loss: 0.323 Test Acc: 0.942
Validation loss decreased (-0.927532 --> -0.942026).  Saving model ...
Epoch: 8 cost time: 0.5785925388336182
Epoch: 8, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.289 Vali Acc: 0.935 Test Loss: 0.289 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.586611270904541
Epoch: 9, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.258 Vali Acc: 0.935 Test Loss: 0.258 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6583962440490723
Epoch: 10, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.238 Vali Acc: 0.942 Test Loss: 0.238 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 11 cost time: 0.5320370197296143
Epoch: 11, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.223 Vali Acc: 0.942 Test Loss: 0.223 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 12 cost time: 0.6046431064605713
Epoch: 12, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5903513431549072
Epoch: 13, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.204 Vali Acc: 0.942 Test Loss: 0.204 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 14 cost time: 0.5580179691314697
Epoch: 14, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.197 Vali Acc: 0.949 Test Loss: 0.197 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949273).  Saving model ...
Epoch: 15 cost time: 0.6043200492858887
Epoch: 15, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.197 Vali Acc: 0.942 Test Loss: 0.197 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5675885677337646
Epoch: 16, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.198 Vali Acc: 0.935 Test Loss: 0.198 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6110174655914307
Epoch: 17, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.191 Vali Acc: 0.935 Test Loss: 0.191 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5817012786865234
Epoch: 18, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.192 Vali Acc: 0.935 Test Loss: 0.192 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.559971809387207
Epoch: 19, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.191 Vali Acc: 0.935 Test Loss: 0.191 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6250543594360352
Epoch: 20, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.181 Vali Acc: 0.942 Test Loss: 0.181 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6960363388061523
Epoch: 21, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.175 Vali Acc: 0.942 Test Loss: 0.175 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5472490787506104
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.175 Vali Acc: 0.942 Test Loss: 0.175 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5680718421936035
Epoch: 23, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.176 Vali Acc: 0.942 Test Loss: 0.176 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5754103660583496
Epoch: 24, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.174 Vali Acc: 0.942 Test Loss: 0.174 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 83972
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0551340579986572
Epoch: 1, Steps: 9 | Train Loss: 1.440 Vali Loss: 1.360 Vali Acc: 0.275 Test Loss: 1.360 Test Acc: 0.275
Validation loss decreased (inf --> -0.275349).  Saving model ...
Epoch: 2 cost time: 0.5281651020050049
Epoch: 2, Steps: 9 | Train Loss: 1.272 Vali Loss: 1.201 Vali Acc: 0.449 Test Loss: 1.201 Test Acc: 0.449
Validation loss decreased (-0.275349 --> -0.449263).  Saving model ...
Epoch: 3 cost time: 0.6114602088928223
Epoch: 3, Steps: 9 | Train Loss: 1.011 Vali Loss: 1.006 Vali Acc: 0.688 Test Loss: 1.006 Test Acc: 0.688
Validation loss decreased (-0.449263 --> -0.688396).  Saving model ...
Epoch: 4 cost time: 0.6098041534423828
Epoch: 4, Steps: 9 | Train Loss: 0.785 Vali Loss: 0.812 Vali Acc: 0.768 Test Loss: 0.812 Test Acc: 0.768
Validation loss decreased (-0.688396 --> -0.768108).  Saving model ...
Epoch: 5 cost time: 0.6152868270874023
Epoch: 5, Steps: 9 | Train Loss: 0.605 Vali Loss: 0.657 Vali Acc: 0.862 Test Loss: 0.657 Test Acc: 0.862
Validation loss decreased (-0.768108 --> -0.862312).  Saving model ...
Epoch: 6 cost time: 0.5003912448883057
Epoch: 6, Steps: 9 | Train Loss: 0.418 Vali Loss: 0.544 Vali Acc: 0.899 Test Loss: 0.544 Test Acc: 0.899
Validation loss decreased (-0.862312 --> -0.898545).  Saving model ...
Epoch: 7 cost time: 0.6176047325134277
Epoch: 7, Steps: 9 | Train Loss: 0.286 Vali Loss: 0.434 Vali Acc: 0.899 Test Loss: 0.434 Test Acc: 0.899
Validation loss decreased (-0.898545 --> -0.898546).  Saving model ...
Epoch: 8 cost time: 0.5976529121398926
Epoch: 8, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.357 Vali Acc: 0.920 Test Loss: 0.357 Test Acc: 0.920
Validation loss decreased (-0.898546 --> -0.920286).  Saving model ...
Epoch: 9 cost time: 0.5861871242523193
Epoch: 9, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.319 Vali Acc: 0.928 Test Loss: 0.319 Test Acc: 0.928
Validation loss decreased (-0.920286 --> -0.927533).  Saving model ...
Epoch: 10 cost time: 0.5694229602813721
Epoch: 10, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.295 Vali Acc: 0.942 Test Loss: 0.295 Test Acc: 0.942
Validation loss decreased (-0.927533 --> -0.942026).  Saving model ...
Epoch: 11 cost time: 0.624765157699585
Epoch: 11, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.275 Vali Acc: 0.935 Test Loss: 0.275 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5423023700714111
Epoch: 12, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.259 Vali Acc: 0.928 Test Loss: 0.259 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6366844177246094
Epoch: 13, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.246 Vali Acc: 0.935 Test Loss: 0.246 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5908668041229248
Epoch: 14, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.240 Vali Acc: 0.949 Test Loss: 0.240 Test Acc: 0.949
Validation loss decreased (-0.942026 --> -0.949273).  Saving model ...
Epoch: 15 cost time: 0.5406005382537842
Epoch: 15, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.237 Vali Acc: 0.942 Test Loss: 0.237 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5670294761657715
Epoch: 16, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.237 Vali Acc: 0.935 Test Loss: 0.237 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5689928531646729
Epoch: 17, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.233 Vali Acc: 0.935 Test Loss: 0.233 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5580272674560547
Epoch: 18, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.230 Vali Acc: 0.935 Test Loss: 0.230 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6161041259765625
Epoch: 19, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.217 Vali Acc: 0.935 Test Loss: 0.217 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5263545513153076
Epoch: 20, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.215 Vali Acc: 0.928 Test Loss: 0.215 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5775036811828613
Epoch: 21, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5441842079162598
Epoch: 22, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5951805114746094
Epoch: 23, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.202 Vali Acc: 0.942 Test Loss: 0.202 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6538898944854736
Epoch: 24, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.198 Vali Acc: 0.942 Test Loss: 0.198 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 77380
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.033156394958496
Epoch: 1, Steps: 9 | Train Loss: 1.373 Vali Loss: 1.326 Vali Acc: 0.362 Test Loss: 1.326 Test Acc: 0.362
Validation loss decreased (inf --> -0.362306).  Saving model ...
Epoch: 2 cost time: 0.645317554473877
Epoch: 2, Steps: 9 | Train Loss: 1.258 Vali Loss: 1.206 Vali Acc: 0.464 Test Loss: 1.206 Test Acc: 0.464
Validation loss decreased (-0.362306 --> -0.463756).  Saving model ...
Epoch: 3 cost time: 0.5883388519287109
Epoch: 3, Steps: 9 | Train Loss: 1.098 Vali Loss: 1.053 Vali Acc: 0.594 Test Loss: 1.053 Test Acc: 0.594
Validation loss decreased (-0.463756 --> -0.594192).  Saving model ...
Epoch: 4 cost time: 0.5847282409667969
Epoch: 4, Steps: 9 | Train Loss: 0.897 Vali Loss: 0.903 Vali Acc: 0.674 Test Loss: 0.903 Test Acc: 0.674
Validation loss decreased (-0.594192 --> -0.673904).  Saving model ...
Epoch: 5 cost time: 0.5951845645904541
Epoch: 5, Steps: 9 | Train Loss: 0.721 Vali Loss: 0.778 Vali Acc: 0.783 Test Loss: 0.778 Test Acc: 0.783
Validation loss decreased (-0.673904 --> -0.782601).  Saving model ...
Epoch: 6 cost time: 0.5466036796569824
Epoch: 6, Steps: 9 | Train Loss: 0.590 Vali Loss: 0.668 Vali Acc: 0.804 Test Loss: 0.668 Test Acc: 0.804
Validation loss decreased (-0.782601 --> -0.804341).  Saving model ...
Epoch: 7 cost time: 0.5302040576934814
Epoch: 7, Steps: 9 | Train Loss: 0.454 Vali Loss: 0.568 Vali Acc: 0.841 Test Loss: 0.568 Test Acc: 0.841
Validation loss decreased (-0.804341 --> -0.840574).  Saving model ...
Epoch: 8 cost time: 0.5552892684936523
Epoch: 8, Steps: 9 | Train Loss: 0.338 Vali Loss: 0.485 Vali Acc: 0.870 Test Loss: 0.485 Test Acc: 0.870
Validation loss decreased (-0.840574 --> -0.869560).  Saving model ...
Epoch: 9 cost time: 0.560842752456665
Epoch: 9, Steps: 9 | Train Loss: 0.262 Vali Loss: 0.409 Vali Acc: 0.891 Test Loss: 0.409 Test Acc: 0.891
Validation loss decreased (-0.869560 --> -0.891300).  Saving model ...
Epoch: 10 cost time: 0.5571444034576416
Epoch: 10, Steps: 9 | Train Loss: 0.205 Vali Loss: 0.370 Vali Acc: 0.906 Test Loss: 0.370 Test Acc: 0.906
Validation loss decreased (-0.891300 --> -0.905793).  Saving model ...
Epoch: 11 cost time: 0.6188647747039795
Epoch: 11, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.341 Vali Acc: 0.906 Test Loss: 0.341 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905794).  Saving model ...
Epoch: 12 cost time: 0.5702581405639648
Epoch: 12, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.315 Vali Acc: 0.913 Test Loss: 0.315 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 13 cost time: 0.5798101425170898
Epoch: 13, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.297 Vali Acc: 0.913 Test Loss: 0.297 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913041).  Saving model ...
Epoch: 14 cost time: 0.5750715732574463
Epoch: 14, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.283 Vali Acc: 0.920 Test Loss: 0.283 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 15 cost time: 0.545161247253418
Epoch: 15, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.270 Vali Acc: 0.920 Test Loss: 0.270 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 16 cost time: 0.5777702331542969
Epoch: 16, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.259 Vali Acc: 0.920 Test Loss: 0.259 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 17 cost time: 0.4828205108642578
Epoch: 17, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.255 Vali Acc: 0.920 Test Loss: 0.255 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 18 cost time: 0.5487415790557861
Epoch: 18, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.244 Vali Acc: 0.920 Test Loss: 0.244 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 19 cost time: 0.5408945083618164
Epoch: 19, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.242 Vali Acc: 0.920 Test Loss: 0.242 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 20 cost time: 0.6336119174957275
Epoch: 20, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 21 cost time: 0.5434384346008301
Epoch: 21, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.234 Vali Acc: 0.928 Test Loss: 0.234 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 22 cost time: 0.548668622970581
Epoch: 22, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.229 Vali Acc: 0.920 Test Loss: 0.229 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5508058071136475
Epoch: 23, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.227 Vali Acc: 0.920 Test Loss: 0.227 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5210895538330078
Epoch: 24, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.221 Vali Acc: 0.920 Test Loss: 0.221 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.4541754722595215
Epoch: 25, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.218 Vali Acc: 0.928 Test Loss: 0.218 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 26 cost time: 0.4805443286895752
Epoch: 26, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.216 Vali Acc: 0.920 Test Loss: 0.216 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4655027389526367
Epoch: 27, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.211 Vali Acc: 0.920 Test Loss: 0.211 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5363368988037109
Epoch: 28, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.208 Vali Acc: 0.920 Test Loss: 0.208 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5406184196472168
Epoch: 29, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.211 Vali Acc: 0.920 Test Loss: 0.211 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5987653732299805
Epoch: 30, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.208 Vali Acc: 0.920 Test Loss: 0.208 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6578049659729004
Epoch: 31, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 32 cost time: 0.5643513202667236
Epoch: 32, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 33 cost time: 0.6535885334014893
Epoch: 33, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.194 Vali Acc: 0.928 Test Loss: 0.194 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 34 cost time: 0.6462397575378418
Epoch: 34, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.198 Vali Acc: 0.920 Test Loss: 0.198 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5696475505828857
Epoch: 35, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.200 Vali Acc: 0.920 Test Loss: 0.200 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5996391773223877
Epoch: 36, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.199 Vali Acc: 0.935 Test Loss: 0.199 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934781).  Saving model ...
Epoch: 37 cost time: 0.5724391937255859
Epoch: 37, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6204829216003418
Epoch: 38, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.558696985244751
Epoch: 39, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6314690113067627
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.199 Vali Acc: 0.935 Test Loss: 0.199 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 41 cost time: 0.586266279220581
Epoch: 41, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5546526908874512
Epoch: 42, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5476465225219727
Epoch: 43, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5885818004608154
Epoch: 44, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.203 Vali Acc: 0.920 Test Loss: 0.203 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.5729532241821289
Epoch: 45, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.920 Test Loss: 0.200 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.6798441410064697
Epoch: 46, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.199 Vali Acc: 0.928 Test Loss: 0.199 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.525752067565918
Epoch: 47, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.200 Vali Acc: 0.935 Test Loss: 0.200 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.5624649524688721
Epoch: 48, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 49 cost time: 0.6230635643005371
Epoch: 49, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.928 Test Loss: 0.196 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5873241424560547
Epoch: 50, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.198 Vali Acc: 0.935 Test Loss: 0.198 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 72324
model size : 0.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0383598804473877
Epoch: 1, Steps: 9 | Train Loss: 1.388 Vali Loss: 1.373 Vali Acc: 0.239 Test Loss: 1.373 Test Acc: 0.239
Validation loss decreased (inf --> -0.239117).  Saving model ...
Epoch: 2 cost time: 0.6071014404296875
Epoch: 2, Steps: 9 | Train Loss: 1.281 Vali Loss: 1.276 Vali Acc: 0.413 Test Loss: 1.276 Test Acc: 0.413
Validation loss decreased (-0.239117 --> -0.413031).  Saving model ...
Epoch: 3 cost time: 0.5989162921905518
Epoch: 3, Steps: 9 | Train Loss: 1.138 Vali Loss: 1.150 Vali Acc: 0.507 Test Loss: 1.150 Test Acc: 0.507
Validation loss decreased (-0.413031 --> -0.507235).  Saving model ...
Epoch: 4 cost time: 0.6166253089904785
Epoch: 4, Steps: 9 | Train Loss: 0.994 Vali Loss: 1.015 Vali Acc: 0.601 Test Loss: 1.015 Test Acc: 0.601
Validation loss decreased (-0.507235 --> -0.601439).  Saving model ...
Epoch: 5 cost time: 0.5319821834564209
Epoch: 5, Steps: 9 | Train Loss: 0.876 Vali Loss: 0.902 Vali Acc: 0.667 Test Loss: 0.902 Test Acc: 0.667
Validation loss decreased (-0.601439 --> -0.666658).  Saving model ...
Epoch: 6 cost time: 0.5774102210998535
Epoch: 6, Steps: 9 | Train Loss: 0.722 Vali Loss: 0.797 Vali Acc: 0.783 Test Loss: 0.797 Test Acc: 0.783
Validation loss decreased (-0.666658 --> -0.782601).  Saving model ...
Epoch: 7 cost time: 0.5624186992645264
Epoch: 7, Steps: 9 | Train Loss: 0.604 Vali Loss: 0.691 Vali Acc: 0.812 Test Loss: 0.691 Test Acc: 0.812
Validation loss decreased (-0.782601 --> -0.811587).  Saving model ...
Epoch: 8 cost time: 0.5985105037689209
Epoch: 8, Steps: 9 | Train Loss: 0.492 Vali Loss: 0.600 Vali Acc: 0.877 Test Loss: 0.600 Test Acc: 0.877
Validation loss decreased (-0.811587 --> -0.876806).  Saving model ...
Epoch: 9 cost time: 0.5836336612701416
Epoch: 9, Steps: 9 | Train Loss: 0.397 Vali Loss: 0.522 Vali Acc: 0.906 Test Loss: 0.522 Test Acc: 0.906
Validation loss decreased (-0.876806 --> -0.905792).  Saving model ...
Epoch: 10 cost time: 0.6043994426727295
Epoch: 10, Steps: 9 | Train Loss: 0.326 Vali Loss: 0.487 Vali Acc: 0.906 Test Loss: 0.487 Test Acc: 0.906
Validation loss decreased (-0.905792 --> -0.905792).  Saving model ...
Epoch: 11 cost time: 0.5844810009002686
Epoch: 11, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.442 Vali Acc: 0.906 Test Loss: 0.442 Test Acc: 0.906
Validation loss decreased (-0.905792 --> -0.905793).  Saving model ...
Epoch: 12 cost time: 0.5877282619476318
Epoch: 12, Steps: 9 | Train Loss: 0.248 Vali Loss: 0.400 Vali Acc: 0.913 Test Loss: 0.400 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913039).  Saving model ...
Epoch: 13 cost time: 0.6180758476257324
Epoch: 13, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.371 Vali Acc: 0.913 Test Loss: 0.371 Test Acc: 0.913
Validation loss decreased (-0.913039 --> -0.913040).  Saving model ...
Epoch: 14 cost time: 0.5876116752624512
Epoch: 14, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.358 Vali Acc: 0.928 Test Loss: 0.358 Test Acc: 0.928
Validation loss decreased (-0.913040 --> -0.927533).  Saving model ...
Epoch: 15 cost time: 0.6367371082305908
Epoch: 15, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.333 Vali Acc: 0.920 Test Loss: 0.333 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6009800434112549
Epoch: 16, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.317 Vali Acc: 0.928 Test Loss: 0.317 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 17 cost time: 0.5840208530426025
Epoch: 17, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.307 Vali Acc: 0.935 Test Loss: 0.307 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934780).  Saving model ...
Epoch: 18 cost time: 0.5437736511230469
Epoch: 18, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.297 Vali Acc: 0.928 Test Loss: 0.297 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.559093713760376
Epoch: 19, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.285 Vali Acc: 0.935 Test Loss: 0.285 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 20 cost time: 0.595179557800293
Epoch: 20, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.277 Vali Acc: 0.942 Test Loss: 0.277 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942026).  Saving model ...
Epoch: 21 cost time: 0.6367373466491699
Epoch: 21, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.265 Vali Acc: 0.942 Test Loss: 0.265 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 22 cost time: 0.6034860610961914
Epoch: 22, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.255 Vali Acc: 0.942 Test Loss: 0.255 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 23 cost time: 0.5805187225341797
Epoch: 23, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.253 Vali Acc: 0.942 Test Loss: 0.253 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 24 cost time: 0.5507652759552002
Epoch: 24, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.241 Vali Acc: 0.942 Test Loss: 0.241 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 25 cost time: 0.5590085983276367
Epoch: 25, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.249 Vali Acc: 0.942 Test Loss: 0.249 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5976259708404541
Epoch: 26, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.251 Vali Acc: 0.942 Test Loss: 0.251 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5588738918304443
Epoch: 27, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.248 Vali Acc: 0.942 Test Loss: 0.248 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7128772735595703
Epoch: 28, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.236 Vali Acc: 0.935 Test Loss: 0.236 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5885493755340576
Epoch: 29, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.241 Vali Acc: 0.942 Test Loss: 0.241 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5993802547454834
Epoch: 30, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.234 Vali Acc: 0.942 Test Loss: 0.234 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 31 cost time: 0.5626065731048584
Epoch: 31, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.228 Vali Acc: 0.942 Test Loss: 0.228 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 32 cost time: 0.5713605880737305
Epoch: 32, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.225 Vali Acc: 0.942 Test Loss: 0.225 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 33 cost time: 0.5351042747497559
Epoch: 33, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.223 Vali Acc: 0.942 Test Loss: 0.223 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 34 cost time: 0.5761830806732178
Epoch: 34, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.216 Vali Acc: 0.949 Test Loss: 0.216 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949273).  Saving model ...
Epoch: 35 cost time: 0.5503718852996826
Epoch: 35, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.220 Vali Acc: 0.949 Test Loss: 0.220 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5732872486114502
Epoch: 36, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.218 Vali Acc: 0.949 Test Loss: 0.218 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5927700996398926
Epoch: 37, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.210 Vali Acc: 0.942 Test Loss: 0.210 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5622367858886719
Epoch: 38, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5653519630432129
Epoch: 39, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.217 Vali Acc: 0.942 Test Loss: 0.217 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5454039573669434
Epoch: 40, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.211 Vali Acc: 0.942 Test Loss: 0.211 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5967893600463867
Epoch: 41, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.207 Vali Acc: 0.942 Test Loss: 0.207 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.5901463031768799
Epoch: 42, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.207 Vali Acc: 0.942 Test Loss: 0.207 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5707540512084961
Epoch: 43, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.5627596378326416
Epoch: 44, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.205 Vali Acc: 0.942 Test Loss: 0.205 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 68356
model size : 0.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9062020778656006
Epoch: 1, Steps: 9 | Train Loss: 1.362 Vali Loss: 1.344 Vali Acc: 0.333 Test Loss: 1.344 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.5310006141662598
Epoch: 2, Steps: 9 | Train Loss: 1.268 Vali Loss: 1.267 Vali Acc: 0.442 Test Loss: 1.267 Test Acc: 0.442
Validation loss decreased (-0.333320 --> -0.442016).  Saving model ...
Epoch: 3 cost time: 0.6292357444763184
Epoch: 3, Steps: 9 | Train Loss: 1.177 Vali Loss: 1.159 Vali Acc: 0.478 Test Loss: 1.159 Test Acc: 0.478
Validation loss decreased (-0.442016 --> -0.478249).  Saving model ...
Epoch: 4 cost time: 0.5615234375
Epoch: 4, Steps: 9 | Train Loss: 1.067 Vali Loss: 1.048 Vali Acc: 0.543 Test Loss: 1.048 Test Acc: 0.543
Validation loss decreased (-0.478249 --> -0.543468).  Saving model ...
Epoch: 5 cost time: 0.5925297737121582
Epoch: 5, Steps: 9 | Train Loss: 0.960 Vali Loss: 0.941 Vali Acc: 0.616 Test Loss: 0.941 Test Acc: 0.616
Validation loss decreased (-0.543468 --> -0.615933).  Saving model ...
Epoch: 6 cost time: 0.5956676006317139
Epoch: 6, Steps: 9 | Train Loss: 0.837 Vali Loss: 0.841 Vali Acc: 0.717 Test Loss: 0.841 Test Acc: 0.717
Validation loss decreased (-0.615933 --> -0.717383).  Saving model ...
Epoch: 7 cost time: 0.5922544002532959
Epoch: 7, Steps: 9 | Train Loss: 0.706 Vali Loss: 0.753 Vali Acc: 0.790 Test Loss: 0.753 Test Acc: 0.790
Validation loss decreased (-0.717383 --> -0.789848).  Saving model ...
Epoch: 8 cost time: 0.570521354675293
Epoch: 8, Steps: 9 | Train Loss: 0.599 Vali Loss: 0.665 Vali Acc: 0.833 Test Loss: 0.665 Test Acc: 0.833
Validation loss decreased (-0.789848 --> -0.833327).  Saving model ...
Epoch: 9 cost time: 0.5564935207366943
Epoch: 9, Steps: 9 | Train Loss: 0.515 Vali Loss: 0.591 Vali Acc: 0.877 Test Loss: 0.591 Test Acc: 0.877
Validation loss decreased (-0.833327 --> -0.876806).  Saving model ...
Epoch: 10 cost time: 0.5626976490020752
Epoch: 10, Steps: 9 | Train Loss: 0.414 Vali Loss: 0.532 Vali Acc: 0.899 Test Loss: 0.532 Test Acc: 0.899
Validation loss decreased (-0.876806 --> -0.898545).  Saving model ...
Epoch: 11 cost time: 0.550142765045166
Epoch: 11, Steps: 9 | Train Loss: 0.373 Vali Loss: 0.489 Vali Acc: 0.906 Test Loss: 0.489 Test Acc: 0.906
Validation loss decreased (-0.898545 --> -0.905792).  Saving model ...
Epoch: 12 cost time: 0.5741586685180664
Epoch: 12, Steps: 9 | Train Loss: 0.318 Vali Loss: 0.449 Vali Acc: 0.913 Test Loss: 0.449 Test Acc: 0.913
Validation loss decreased (-0.905792 --> -0.913039).  Saving model ...
Epoch: 13 cost time: 0.5548999309539795
Epoch: 13, Steps: 9 | Train Loss: 0.280 Vali Loss: 0.413 Vali Acc: 0.920 Test Loss: 0.413 Test Acc: 0.920
Validation loss decreased (-0.913039 --> -0.920286).  Saving model ...
Epoch: 14 cost time: 0.5139944553375244
Epoch: 14, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.395 Vali Acc: 0.928 Test Loss: 0.395 Test Acc: 0.928
Validation loss decreased (-0.920286 --> -0.927532).  Saving model ...
Epoch: 15 cost time: 0.5588901042938232
Epoch: 15, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.364 Vali Acc: 0.928 Test Loss: 0.364 Test Acc: 0.928
Validation loss decreased (-0.927532 --> -0.927533).  Saving model ...
Epoch: 16 cost time: 0.5702016353607178
Epoch: 16, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.348 Vali Acc: 0.935 Test Loss: 0.348 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934779).  Saving model ...
Epoch: 17 cost time: 0.650367259979248
Epoch: 17, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.331 Vali Acc: 0.942 Test Loss: 0.331 Test Acc: 0.942
Validation loss decreased (-0.934779 --> -0.942026).  Saving model ...
Epoch: 18 cost time: 0.5931365489959717
Epoch: 18, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.316 Vali Acc: 0.935 Test Loss: 0.316 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6014819145202637
Epoch: 19, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.306 Vali Acc: 0.942 Test Loss: 0.306 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 20 cost time: 0.5864410400390625
Epoch: 20, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.291 Vali Acc: 0.942 Test Loss: 0.291 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 21 cost time: 0.6396911144256592
Epoch: 21, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.283 Vali Acc: 0.942 Test Loss: 0.283 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 22 cost time: 0.5366663932800293
Epoch: 22, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.271 Vali Acc: 0.942 Test Loss: 0.271 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 23 cost time: 0.6303677558898926
Epoch: 23, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.267 Vali Acc: 0.942 Test Loss: 0.267 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 24 cost time: 0.5245459079742432
Epoch: 24, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.259 Vali Acc: 0.942 Test Loss: 0.259 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 25 cost time: 0.5498859882354736
Epoch: 25, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.259 Vali Acc: 0.942 Test Loss: 0.259 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5372235774993896
Epoch: 26, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.251 Vali Acc: 0.942 Test Loss: 0.251 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 27 cost time: 0.6985275745391846
Epoch: 27, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.244 Vali Acc: 0.942 Test Loss: 0.244 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 28 cost time: 0.5533814430236816
Epoch: 28, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.236 Vali Acc: 0.942 Test Loss: 0.236 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 29 cost time: 0.5721292495727539
Epoch: 29, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.224 Vali Acc: 0.942 Test Loss: 0.224 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 30 cost time: 0.5962691307067871
Epoch: 30, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.229 Vali Acc: 0.942 Test Loss: 0.229 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5392091274261475
Epoch: 31, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.225 Vali Acc: 0.942 Test Loss: 0.225 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5951931476593018
Epoch: 32, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.228 Vali Acc: 0.942 Test Loss: 0.228 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6165215969085693
Epoch: 33, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.230 Vali Acc: 0.942 Test Loss: 0.230 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.619135856628418
Epoch: 34, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.223 Vali Acc: 0.942 Test Loss: 0.223 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 35 cost time: 0.5975339412689209
Epoch: 35, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.218 Vali Acc: 0.942 Test Loss: 0.218 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 36 cost time: 0.5964393615722656
Epoch: 36, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.210 Vali Acc: 0.942 Test Loss: 0.210 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 37 cost time: 0.5697174072265625
Epoch: 37, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6004757881164551
Epoch: 38, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6500158309936523
Epoch: 39, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.205 Vali Acc: 0.942 Test Loss: 0.205 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 40 cost time: 0.568871259689331
Epoch: 40, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.207 Vali Acc: 0.942 Test Loss: 0.207 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6291558742523193
Epoch: 41, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.206 Vali Acc: 0.942 Test Loss: 0.206 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5391724109649658
Epoch: 42, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.197 Vali Acc: 0.942 Test Loss: 0.197 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 43 cost time: 0.5454683303833008
Epoch: 43, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.191 Vali Acc: 0.942 Test Loss: 0.191 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 44 cost time: 0.6140809059143066
Epoch: 44, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.190 Vali Acc: 0.942 Test Loss: 0.190 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 45 cost time: 0.5955631732940674
Epoch: 45, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.193 Vali Acc: 0.942 Test Loss: 0.193 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.576134443283081
Epoch: 46, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.189 Vali Acc: 0.942 Test Loss: 0.189 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 47 cost time: 0.5419092178344727
Epoch: 47, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.193 Vali Acc: 0.942 Test Loss: 0.193 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5869293212890625
Epoch: 48, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.191 Vali Acc: 0.942 Test Loss: 0.191 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6306271553039551
Epoch: 49, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.192 Vali Acc: 0.942 Test Loss: 0.192 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5198638439178467
Epoch: 50, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.187 Vali Acc: 0.942 Test Loss: 0.187 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 66756
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8159384727478027
Epoch: 1, Steps: 9 | Train Loss: 1.388 Vali Loss: 1.356 Vali Acc: 0.246 Test Loss: 1.356 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 0.528458833694458
Epoch: 2, Steps: 9 | Train Loss: 1.303 Vali Loss: 1.293 Vali Acc: 0.370 Test Loss: 1.293 Test Acc: 0.370
Validation loss decreased (-0.246363 --> -0.369552).  Saving model ...
Epoch: 3 cost time: 0.5288224220275879
Epoch: 3, Steps: 9 | Train Loss: 1.221 Vali Loss: 1.209 Vali Acc: 0.478 Test Loss: 1.209 Test Acc: 0.478
Validation loss decreased (-0.369552 --> -0.478249).  Saving model ...
Epoch: 4 cost time: 0.5444245338439941
Epoch: 4, Steps: 9 | Train Loss: 1.117 Vali Loss: 1.106 Vali Acc: 0.551 Test Loss: 1.106 Test Acc: 0.551
Validation loss decreased (-0.478249 --> -0.550714).  Saving model ...
Epoch: 5 cost time: 0.5860483646392822
Epoch: 5, Steps: 9 | Train Loss: 1.008 Vali Loss: 1.006 Vali Acc: 0.652 Test Loss: 1.006 Test Acc: 0.652
Validation loss decreased (-0.550714 --> -0.652164).  Saving model ...
Epoch: 6 cost time: 0.5922112464904785
Epoch: 6, Steps: 9 | Train Loss: 0.904 Vali Loss: 0.917 Vali Acc: 0.703 Test Loss: 0.917 Test Acc: 0.703
Validation loss decreased (-0.652164 --> -0.702889).  Saving model ...
Epoch: 7 cost time: 0.5939538478851318
Epoch: 7, Steps: 9 | Train Loss: 0.804 Vali Loss: 0.839 Vali Acc: 0.732 Test Loss: 0.839 Test Acc: 0.732
Validation loss decreased (-0.702889 --> -0.731876).  Saving model ...
Epoch: 8 cost time: 0.5200400352478027
Epoch: 8, Steps: 9 | Train Loss: 0.700 Vali Loss: 0.764 Vali Acc: 0.754 Test Loss: 0.764 Test Acc: 0.754
Validation loss decreased (-0.731876 --> -0.753616).  Saving model ...
Epoch: 9 cost time: 0.5721933841705322
Epoch: 9, Steps: 9 | Train Loss: 0.613 Vali Loss: 0.701 Vali Acc: 0.768 Test Loss: 0.701 Test Acc: 0.768
Validation loss decreased (-0.753616 --> -0.768109).  Saving model ...
Epoch: 10 cost time: 0.5078623294830322
Epoch: 10, Steps: 9 | Train Loss: 0.546 Vali Loss: 0.645 Vali Acc: 0.819 Test Loss: 0.645 Test Acc: 0.819
Validation loss decreased (-0.768109 --> -0.818834).  Saving model ...
Epoch: 11 cost time: 0.523108959197998
Epoch: 11, Steps: 9 | Train Loss: 0.466 Vali Loss: 0.604 Vali Acc: 0.833 Test Loss: 0.604 Test Acc: 0.833
Validation loss decreased (-0.818834 --> -0.833327).  Saving model ...
Epoch: 12 cost time: 0.4846229553222656
Epoch: 12, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.564 Vali Acc: 0.848 Test Loss: 0.564 Test Acc: 0.848
Validation loss decreased (-0.833327 --> -0.847820).  Saving model ...
Epoch: 13 cost time: 0.5932872295379639
Epoch: 13, Steps: 9 | Train Loss: 0.381 Vali Loss: 0.516 Vali Acc: 0.862 Test Loss: 0.516 Test Acc: 0.862
Validation loss decreased (-0.847820 --> -0.862314).  Saving model ...
Epoch: 14 cost time: 0.5255320072174072
Epoch: 14, Steps: 9 | Train Loss: 0.337 Vali Loss: 0.493 Vali Acc: 0.855 Test Loss: 0.493 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5441238880157471
Epoch: 15, Steps: 9 | Train Loss: 0.300 Vali Loss: 0.465 Vali Acc: 0.862 Test Loss: 0.465 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 16 cost time: 0.5480151176452637
Epoch: 16, Steps: 9 | Train Loss: 0.262 Vali Loss: 0.441 Vali Acc: 0.884 Test Loss: 0.441 Test Acc: 0.884
Validation loss decreased (-0.862314 --> -0.884054).  Saving model ...
Epoch: 17 cost time: 0.5447428226470947
Epoch: 17, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.424 Vali Acc: 0.884 Test Loss: 0.424 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 18 cost time: 0.5811622142791748
Epoch: 18, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.403 Vali Acc: 0.891 Test Loss: 0.403 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 19 cost time: 0.5424518585205078
Epoch: 19, Steps: 9 | Train Loss: 0.189 Vali Loss: 0.379 Vali Acc: 0.899 Test Loss: 0.379 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 20 cost time: 0.5367796421051025
Epoch: 20, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.366 Vali Acc: 0.899 Test Loss: 0.366 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 21 cost time: 0.5364716053009033
Epoch: 21, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.358 Vali Acc: 0.920 Test Loss: 0.358 Test Acc: 0.920
Validation loss decreased (-0.898547 --> -0.920286).  Saving model ...
Epoch: 22 cost time: 0.5876390933990479
Epoch: 22, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.338 Vali Acc: 0.906 Test Loss: 0.338 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.55059814453125
Epoch: 23, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.330 Vali Acc: 0.928 Test Loss: 0.330 Test Acc: 0.928
Validation loss decreased (-0.920286 --> -0.927533).  Saving model ...
Epoch: 24 cost time: 0.553457498550415
Epoch: 24, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.318 Vali Acc: 0.935 Test Loss: 0.318 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934779).  Saving model ...
Epoch: 25 cost time: 0.5804989337921143
Epoch: 25, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.316 Vali Acc: 0.920 Test Loss: 0.316 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6291923522949219
Epoch: 26, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.304 Vali Acc: 0.928 Test Loss: 0.304 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5418035984039307
Epoch: 27, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.304 Vali Acc: 0.928 Test Loss: 0.304 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5091738700866699
Epoch: 28, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.304 Vali Acc: 0.928 Test Loss: 0.304 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5291659832000732
Epoch: 29, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.290 Vali Acc: 0.935 Test Loss: 0.290 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934780).  Saving model ...
Epoch: 30 cost time: 0.5447061061859131
Epoch: 30, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.283 Vali Acc: 0.935 Test Loss: 0.283 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 31 cost time: 0.5359055995941162
Epoch: 31, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.269 Vali Acc: 0.935 Test Loss: 0.269 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 32 cost time: 0.49394798278808594
Epoch: 32, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.269 Vali Acc: 0.935 Test Loss: 0.269 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.650270938873291
Epoch: 33, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.264 Vali Acc: 0.935 Test Loss: 0.264 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 34 cost time: 0.5845503807067871
Epoch: 34, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.261 Vali Acc: 0.935 Test Loss: 0.261 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 35 cost time: 0.5073144435882568
Epoch: 35, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.250 Vali Acc: 0.935 Test Loss: 0.250 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 36 cost time: 0.563624382019043
Epoch: 36, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.250 Vali Acc: 0.935 Test Loss: 0.250 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5574061870574951
Epoch: 37, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.242 Vali Acc: 0.935 Test Loss: 0.242 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 38 cost time: 0.5648362636566162
Epoch: 38, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.243 Vali Acc: 0.935 Test Loss: 0.243 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.624504566192627
Epoch: 39, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.237 Vali Acc: 0.928 Test Loss: 0.237 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5385100841522217
Epoch: 40, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.233 Vali Acc: 0.928 Test Loss: 0.233 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5562961101531982
Epoch: 41, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5543639659881592
Epoch: 42, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.5575675964355469
Epoch: 43, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.223 Vali Acc: 0.928 Test Loss: 0.223 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6005518436431885
Epoch: 44, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.223 Vali Acc: 0.928 Test Loss: 0.223 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.5876569747924805
Epoch: 45, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.223 Vali Acc: 0.928 Test Loss: 0.223 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.5266761779785156
Epoch: 46, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.5105516910552979
Epoch: 47, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.222 Vali Acc: 0.928 Test Loss: 0.222 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 65860
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.929351806640625
Epoch: 1, Steps: 9 | Train Loss: 1.349 Vali Loss: 1.296 Vali Acc: 0.370 Test Loss: 1.296 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 0.5356388092041016
Epoch: 2, Steps: 9 | Train Loss: 1.146 Vali Loss: 1.081 Vali Acc: 0.551 Test Loss: 1.081 Test Acc: 0.551
Validation loss decreased (-0.369552 --> -0.550714).  Saving model ...
Epoch: 3 cost time: 0.5666687488555908
Epoch: 3, Steps: 9 | Train Loss: 0.897 Vali Loss: 0.843 Vali Acc: 0.717 Test Loss: 0.843 Test Acc: 0.717
Validation loss decreased (-0.550714 --> -0.717383).  Saving model ...
Epoch: 4 cost time: 0.6315023899078369
Epoch: 4, Steps: 9 | Train Loss: 0.598 Vali Loss: 0.647 Vali Acc: 0.848 Test Loss: 0.647 Test Acc: 0.848
Validation loss decreased (-0.717383 --> -0.847820).  Saving model ...
Epoch: 5 cost time: 0.6909224987030029
Epoch: 5, Steps: 9 | Train Loss: 0.414 Vali Loss: 0.500 Vali Acc: 0.884 Test Loss: 0.500 Test Acc: 0.884
Validation loss decreased (-0.847820 --> -0.884053).  Saving model ...
Epoch: 6 cost time: 0.5361461639404297
Epoch: 6, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.391 Vali Acc: 0.899 Test Loss: 0.391 Test Acc: 0.899
Validation loss decreased (-0.884053 --> -0.898547).  Saving model ...
Epoch: 7 cost time: 0.5530683994293213
Epoch: 7, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.323 Vali Acc: 0.913 Test Loss: 0.323 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913040).  Saving model ...
Epoch: 8 cost time: 0.5510039329528809
Epoch: 8, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.284 Vali Acc: 0.928 Test Loss: 0.284 Test Acc: 0.928
Validation loss decreased (-0.913040 --> -0.927533).  Saving model ...
Epoch: 9 cost time: 0.537158727645874
Epoch: 9, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.259 Vali Acc: 0.935 Test Loss: 0.259 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934780).  Saving model ...
Epoch: 10 cost time: 0.5818204879760742
Epoch: 10, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.245 Vali Acc: 0.935 Test Loss: 0.245 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 11 cost time: 0.5454244613647461
Epoch: 11, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 12 cost time: 0.5273547172546387
Epoch: 12, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.225 Vali Acc: 0.935 Test Loss: 0.225 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 13 cost time: 0.5417611598968506
Epoch: 13, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 14 cost time: 0.5563328266143799
Epoch: 14, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.222 Vali Acc: 0.928 Test Loss: 0.222 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6341161727905273
Epoch: 15, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.209 Vali Acc: 0.942 Test Loss: 0.209 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 16 cost time: 0.5435690879821777
Epoch: 16, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.204 Vali Acc: 0.942 Test Loss: 0.204 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 17 cost time: 0.5539765357971191
Epoch: 17, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.199 Vali Acc: 0.942 Test Loss: 0.199 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 18 cost time: 0.6502401828765869
Epoch: 18, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.196 Vali Acc: 0.942 Test Loss: 0.196 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 19 cost time: 0.5500760078430176
Epoch: 19, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.194 Vali Acc: 0.942 Test Loss: 0.194 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 20 cost time: 0.5533771514892578
Epoch: 20, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.196 Vali Acc: 0.942 Test Loss: 0.196 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6017720699310303
Epoch: 21, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.196 Vali Acc: 0.942 Test Loss: 0.196 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5861389636993408
Epoch: 22, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.191 Vali Acc: 0.942 Test Loss: 0.191 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 23 cost time: 0.5482747554779053
Epoch: 23, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.193 Vali Acc: 0.942 Test Loss: 0.193 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5537033081054688
Epoch: 24, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.192 Vali Acc: 0.942 Test Loss: 0.192 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6119852066040039
Epoch: 25, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5513818264007568
Epoch: 26, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.194 Vali Acc: 0.935 Test Loss: 0.194 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5912292003631592
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.194 Vali Acc: 0.928 Test Loss: 0.194 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6450984477996826
Epoch: 28, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.183 Vali Acc: 0.935 Test Loss: 0.183 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5328445434570312
Epoch: 29, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.178 Vali Acc: 0.942 Test Loss: 0.178 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 30 cost time: 0.5640566349029541
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.180 Vali Acc: 0.935 Test Loss: 0.180 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5877275466918945
Epoch: 31, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.935 Test Loss: 0.185 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6392989158630371
Epoch: 32, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.185 Vali Acc: 0.928 Test Loss: 0.185 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.595036506652832
Epoch: 33, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.928 Test Loss: 0.186 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6118972301483154
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.189 Vali Acc: 0.935 Test Loss: 0.189 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5980491638183594
Epoch: 35, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.935 Test Loss: 0.185 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.588421106338501
Epoch: 36, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.942 Test Loss: 0.176 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 37 cost time: 0.5914199352264404
Epoch: 37, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.935 Test Loss: 0.179 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5500872135162354
Epoch: 38, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.935 Test Loss: 0.184 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5056231021881104
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.935 Test Loss: 0.183 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6570451259613037
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949274).  Saving model ...
Epoch: 41 cost time: 0.5452544689178467
Epoch: 41, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.942 Test Loss: 0.179 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5370168685913086
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 43 cost time: 0.5764560699462891
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.935 Test Loss: 0.183 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5447843074798584
Epoch: 44, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.942 Test Loss: 0.190 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5324769020080566
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.935 Test Loss: 0.194 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5654528141021729
Epoch: 46, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.928 Test Loss: 0.190 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.5692014694213867
Epoch: 47, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.935 Test Loss: 0.186 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.5976173877716064
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.187 Vali Acc: 0.935 Test Loss: 0.187 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.533318042755127
Epoch: 49, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.949 Test Loss: 0.180 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.5991377830505371
Epoch: 50, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.942 Test Loss: 0.176 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 42596
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0270023345947266
Epoch: 1, Steps: 9 | Train Loss: 1.304 Vali Loss: 1.298 Vali Acc: 0.348 Test Loss: 1.298 Test Acc: 0.348
Validation loss decreased (inf --> -0.347813).  Saving model ...
Epoch: 2 cost time: 0.6434781551361084
Epoch: 2, Steps: 9 | Train Loss: 1.188 Vali Loss: 1.168 Vali Acc: 0.536 Test Loss: 1.168 Test Acc: 0.536
Validation loss decreased (-0.347813 --> -0.536220).  Saving model ...
Epoch: 3 cost time: 0.526308536529541
Epoch: 3, Steps: 9 | Train Loss: 1.016 Vali Loss: 1.005 Vali Acc: 0.681 Test Loss: 1.005 Test Acc: 0.681
Validation loss decreased (-0.536220 --> -0.681149).  Saving model ...
Epoch: 4 cost time: 0.6910006999969482
Epoch: 4, Steps: 9 | Train Loss: 0.865 Vali Loss: 0.863 Vali Acc: 0.768 Test Loss: 0.863 Test Acc: 0.768
Validation loss decreased (-0.681149 --> -0.768107).  Saving model ...
Epoch: 5 cost time: 0.5923798084259033
Epoch: 5, Steps: 9 | Train Loss: 0.701 Vali Loss: 0.737 Vali Acc: 0.841 Test Loss: 0.737 Test Acc: 0.841
Validation loss decreased (-0.768107 --> -0.840572).  Saving model ...
Epoch: 6 cost time: 0.5605220794677734
Epoch: 6, Steps: 9 | Train Loss: 0.558 Vali Loss: 0.622 Vali Acc: 0.891 Test Loss: 0.622 Test Acc: 0.891
Validation loss decreased (-0.840572 --> -0.891298).  Saving model ...
Epoch: 7 cost time: 0.6376667022705078
Epoch: 7, Steps: 9 | Train Loss: 0.408 Vali Loss: 0.528 Vali Acc: 0.906 Test Loss: 0.528 Test Acc: 0.906
Validation loss decreased (-0.891298 --> -0.905792).  Saving model ...
Epoch: 8 cost time: 0.6004226207733154
Epoch: 8, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.454 Vali Acc: 0.920 Test Loss: 0.454 Test Acc: 0.920
Validation loss decreased (-0.905792 --> -0.920285).  Saving model ...
Epoch: 9 cost time: 0.5643513202667236
Epoch: 9, Steps: 9 | Train Loss: 0.256 Vali Loss: 0.395 Vali Acc: 0.920 Test Loss: 0.395 Test Acc: 0.920
Validation loss decreased (-0.920285 --> -0.920286).  Saving model ...
Epoch: 10 cost time: 0.6126887798309326
Epoch: 10, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.354 Vali Acc: 0.928 Test Loss: 0.354 Test Acc: 0.928
Validation loss decreased (-0.920286 --> -0.927533).  Saving model ...
Epoch: 11 cost time: 0.5837516784667969
Epoch: 11, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.334 Vali Acc: 0.935 Test Loss: 0.334 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934779).  Saving model ...
Epoch: 12 cost time: 0.520183801651001
Epoch: 12, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.305 Vali Acc: 0.928 Test Loss: 0.305 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6863961219787598
Epoch: 13, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.294 Vali Acc: 0.942 Test Loss: 0.294 Test Acc: 0.942
Validation loss decreased (-0.934779 --> -0.942026).  Saving model ...
Epoch: 14 cost time: 0.582604169845581
Epoch: 14, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.281 Vali Acc: 0.942 Test Loss: 0.281 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 15 cost time: 0.7114086151123047
Epoch: 15, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.264 Vali Acc: 0.935 Test Loss: 0.264 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6184754371643066
Epoch: 16, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.251 Vali Acc: 0.928 Test Loss: 0.251 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5665969848632812
Epoch: 17, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.241 Vali Acc: 0.928 Test Loss: 0.241 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5939052104949951
Epoch: 18, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.239 Vali Acc: 0.935 Test Loss: 0.239 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5520145893096924
Epoch: 19, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.224 Vali Acc: 0.935 Test Loss: 0.224 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6383700370788574
Epoch: 20, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.215 Vali Acc: 0.942 Test Loss: 0.215 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 21 cost time: 0.5943570137023926
Epoch: 21, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.220 Vali Acc: 0.942 Test Loss: 0.220 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5352473258972168
Epoch: 22, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6345803737640381
Epoch: 23, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6036865711212158
Epoch: 24, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5627059936523438
Epoch: 25, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6062057018280029
Epoch: 26, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5666964054107666
Epoch: 27, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5537445545196533
Epoch: 28, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5862138271331787
Epoch: 29, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.190 Vali Acc: 0.935 Test Loss: 0.190 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5740118026733398
Epoch: 30, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.204 Vali Acc: 0.942 Test Loss: 0.204 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 31 cost time: 0.5769996643066406
Epoch: 31, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.198 Vali Acc: 0.942 Test Loss: 0.198 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 32 cost time: 0.56691575050354
Epoch: 32, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.196 Vali Acc: 0.935 Test Loss: 0.196 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6314778327941895
Epoch: 33, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.199 Vali Acc: 0.935 Test Loss: 0.199 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6071276664733887
Epoch: 34, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5620300769805908
Epoch: 35, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.198 Vali Acc: 0.935 Test Loss: 0.198 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5575966835021973
Epoch: 36, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6209249496459961
Epoch: 37, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.4288172721862793
Epoch: 38, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.194 Vali Acc: 0.935 Test Loss: 0.194 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6610286235809326
Epoch: 39, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.189 Vali Acc: 0.935 Test Loss: 0.189 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.5329601764678955
Epoch: 40, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.189 Vali Acc: 0.935 Test Loss: 0.189 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6096911430358887
Epoch: 41, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.189 Vali Acc: 0.935 Test Loss: 0.189 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 29700
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.810863733291626
Epoch: 1, Steps: 9 | Train Loss: 1.458 Vali Loss: 1.371 Vali Acc: 0.326 Test Loss: 1.371 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 0.5294325351715088
Epoch: 2, Steps: 9 | Train Loss: 1.353 Vali Loss: 1.287 Vali Acc: 0.486 Test Loss: 1.287 Test Acc: 0.486
Validation loss decreased (-0.326073 --> -0.485494).  Saving model ...
Epoch: 3 cost time: 0.5793511867523193
Epoch: 3, Steps: 9 | Train Loss: 1.194 Vali Loss: 1.166 Vali Acc: 0.587 Test Loss: 1.166 Test Acc: 0.587
Validation loss decreased (-0.485494 --> -0.586945).  Saving model ...
Epoch: 4 cost time: 0.5089671611785889
Epoch: 4, Steps: 9 | Train Loss: 1.062 Vali Loss: 1.045 Vali Acc: 0.638 Test Loss: 1.045 Test Acc: 0.638
Validation loss decreased (-0.586945 --> -0.637671).  Saving model ...
Epoch: 5 cost time: 0.5555500984191895
Epoch: 5, Steps: 9 | Train Loss: 0.895 Vali Loss: 0.937 Vali Acc: 0.768 Test Loss: 0.937 Test Acc: 0.768
Validation loss decreased (-0.637671 --> -0.768107).  Saving model ...
Epoch: 6 cost time: 0.5720169544219971
Epoch: 6, Steps: 9 | Train Loss: 0.769 Vali Loss: 0.829 Vali Acc: 0.819 Test Loss: 0.829 Test Acc: 0.819
Validation loss decreased (-0.768107 --> -0.818832).  Saving model ...
Epoch: 7 cost time: 0.5079469680786133
Epoch: 7, Steps: 9 | Train Loss: 0.639 Vali Loss: 0.722 Vali Acc: 0.877 Test Loss: 0.722 Test Acc: 0.877
Validation loss decreased (-0.818832 --> -0.876804).  Saving model ...
Epoch: 8 cost time: 0.4963200092315674
Epoch: 8, Steps: 9 | Train Loss: 0.540 Vali Loss: 0.627 Vali Acc: 0.870 Test Loss: 0.627 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5190727710723877
Epoch: 9, Steps: 9 | Train Loss: 0.425 Vali Loss: 0.573 Vali Acc: 0.899 Test Loss: 0.573 Test Acc: 0.899
Validation loss decreased (-0.876804 --> -0.898545).  Saving model ...
Epoch: 10 cost time: 0.6197259426116943
Epoch: 10, Steps: 9 | Train Loss: 0.363 Vali Loss: 0.501 Vali Acc: 0.913 Test Loss: 0.501 Test Acc: 0.913
Validation loss decreased (-0.898545 --> -0.913038).  Saving model ...
Epoch: 11 cost time: 0.5916061401367188
Epoch: 11, Steps: 9 | Train Loss: 0.294 Vali Loss: 0.443 Vali Acc: 0.920 Test Loss: 0.443 Test Acc: 0.920
Validation loss decreased (-0.913038 --> -0.920285).  Saving model ...
Epoch: 12 cost time: 0.4946253299713135
Epoch: 12, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.409 Vali Acc: 0.928 Test Loss: 0.409 Test Acc: 0.928
Validation loss decreased (-0.920285 --> -0.927532).  Saving model ...
Epoch: 13 cost time: 0.5443830490112305
Epoch: 13, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.379 Vali Acc: 0.928 Test Loss: 0.379 Test Acc: 0.928
Validation loss decreased (-0.927532 --> -0.927532).  Saving model ...
Epoch: 14 cost time: 0.5547869205474854
Epoch: 14, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.357 Vali Acc: 0.935 Test Loss: 0.357 Test Acc: 0.935
Validation loss decreased (-0.927532 --> -0.934779).  Saving model ...
Epoch: 15 cost time: 0.5550789833068848
Epoch: 15, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.344 Vali Acc: 0.935 Test Loss: 0.344 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934779).  Saving model ...
Epoch: 16 cost time: 0.5389156341552734
Epoch: 16, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.325 Vali Acc: 0.935 Test Loss: 0.325 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934779).  Saving model ...
Epoch: 17 cost time: 0.5447814464569092
Epoch: 17, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.322 Vali Acc: 0.935 Test Loss: 0.322 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934779).  Saving model ...
Epoch: 18 cost time: 0.518268346786499
Epoch: 18, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.302 Vali Acc: 0.935 Test Loss: 0.302 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934780).  Saving model ...
Epoch: 19 cost time: 0.5624802112579346
Epoch: 19, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.285 Vali Acc: 0.935 Test Loss: 0.285 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 20 cost time: 0.5652484893798828
Epoch: 20, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.273 Vali Acc: 0.935 Test Loss: 0.273 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 21 cost time: 0.526803731918335
Epoch: 21, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.268 Vali Acc: 0.935 Test Loss: 0.268 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 22 cost time: 0.5865657329559326
Epoch: 22, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.266 Vali Acc: 0.935 Test Loss: 0.266 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 23 cost time: 0.6023855209350586
Epoch: 23, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.256 Vali Acc: 0.935 Test Loss: 0.256 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 24 cost time: 0.6126210689544678
Epoch: 24, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.252 Vali Acc: 0.942 Test Loss: 0.252 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942026).  Saving model ...
Epoch: 25 cost time: 0.5497770309448242
Epoch: 25, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.243 Vali Acc: 0.942 Test Loss: 0.243 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 26 cost time: 0.5147058963775635
Epoch: 26, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.238 Vali Acc: 0.935 Test Loss: 0.238 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.560828447341919
Epoch: 27, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.234 Vali Acc: 0.935 Test Loss: 0.234 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6016051769256592
Epoch: 28, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.240 Vali Acc: 0.935 Test Loss: 0.240 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5350415706634521
Epoch: 29, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.227 Vali Acc: 0.935 Test Loss: 0.227 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6178617477416992
Epoch: 30, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.227 Vali Acc: 0.942 Test Loss: 0.227 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 31 cost time: 0.5592691898345947
Epoch: 31, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5375187397003174
Epoch: 32, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.236 Vali Acc: 0.935 Test Loss: 0.236 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6335341930389404
Epoch: 33, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.222 Vali Acc: 0.942 Test Loss: 0.222 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 34 cost time: 0.5306155681610107
Epoch: 34, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.219 Vali Acc: 0.942 Test Loss: 0.219 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 35 cost time: 0.5676438808441162
Epoch: 35, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.522498607635498
Epoch: 36, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.215 Vali Acc: 0.942 Test Loss: 0.215 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 37 cost time: 0.5029299259185791
Epoch: 37, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.211 Vali Acc: 0.942 Test Loss: 0.211 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 38 cost time: 0.5228967666625977
Epoch: 38, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.210 Vali Acc: 0.942 Test Loss: 0.210 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 39 cost time: 0.5090930461883545
Epoch: 39, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.213 Vali Acc: 0.942 Test Loss: 0.213 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5550169944763184
Epoch: 40, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.214 Vali Acc: 0.942 Test Loss: 0.214 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.4711892604827881
Epoch: 41, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.211 Vali Acc: 0.942 Test Loss: 0.211 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5652732849121094
Epoch: 42, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.209 Vali Acc: 0.942 Test Loss: 0.209 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 43 cost time: 0.5929427146911621
Epoch: 43, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.200 Vali Acc: 0.942 Test Loss: 0.200 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 44 cost time: 0.5399842262268066
Epoch: 44, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.211 Vali Acc: 0.942 Test Loss: 0.211 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6458771228790283
Epoch: 45, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.211 Vali Acc: 0.942 Test Loss: 0.211 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5497894287109375
Epoch: 46, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.209 Vali Acc: 0.942 Test Loss: 0.209 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5541093349456787
Epoch: 47, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.201 Vali Acc: 0.942 Test Loss: 0.201 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.5360984802246094
Epoch: 48, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.196 Vali Acc: 0.942 Test Loss: 0.196 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 49 cost time: 0.6145522594451904
Epoch: 49, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.189 Vali Acc: 0.942 Test Loss: 0.189 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 50 cost time: 0.6457319259643555
Epoch: 50, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.199 Vali Acc: 0.942 Test Loss: 0.199 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 26404
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9215140342712402
Epoch: 1, Steps: 9 | Train Loss: 1.393 Vali Loss: 1.349 Vali Acc: 0.399 Test Loss: 1.349 Test Acc: 0.399
Validation loss decreased (inf --> -0.398537).  Saving model ...
Epoch: 2 cost time: 0.5877470970153809
Epoch: 2, Steps: 9 | Train Loss: 1.319 Vali Loss: 1.282 Vali Acc: 0.464 Test Loss: 1.282 Test Acc: 0.464
Validation loss decreased (-0.398537 --> -0.463755).  Saving model ...
Epoch: 3 cost time: 0.587033748626709
Epoch: 3, Steps: 9 | Train Loss: 1.210 Vali Loss: 1.181 Vali Acc: 0.558 Test Loss: 1.181 Test Acc: 0.558
Validation loss decreased (-0.463755 --> -0.557959).  Saving model ...
Epoch: 4 cost time: 0.561302900314331
Epoch: 4, Steps: 9 | Train Loss: 1.086 Vali Loss: 1.079 Vali Acc: 0.594 Test Loss: 1.079 Test Acc: 0.594
Validation loss decreased (-0.557959 --> -0.594192).  Saving model ...
Epoch: 5 cost time: 0.6438641548156738
Epoch: 5, Steps: 9 | Train Loss: 0.989 Vali Loss: 0.989 Vali Acc: 0.659 Test Loss: 0.989 Test Acc: 0.659
Validation loss decreased (-0.594192 --> -0.659410).  Saving model ...
Epoch: 6 cost time: 0.526496171951294
Epoch: 6, Steps: 9 | Train Loss: 0.863 Vali Loss: 0.894 Vali Acc: 0.732 Test Loss: 0.894 Test Acc: 0.732
Validation loss decreased (-0.659410 --> -0.731875).  Saving model ...
Epoch: 7 cost time: 0.5684034824371338
Epoch: 7, Steps: 9 | Train Loss: 0.762 Vali Loss: 0.809 Vali Acc: 0.797 Test Loss: 0.809 Test Acc: 0.797
Validation loss decreased (-0.731875 --> -0.797093).  Saving model ...
Epoch: 8 cost time: 0.5524332523345947
Epoch: 8, Steps: 9 | Train Loss: 0.671 Vali Loss: 0.730 Vali Acc: 0.848 Test Loss: 0.730 Test Acc: 0.848
Validation loss decreased (-0.797093 --> -0.847819).  Saving model ...
Epoch: 9 cost time: 0.562424898147583
Epoch: 9, Steps: 9 | Train Loss: 0.586 Vali Loss: 0.657 Vali Acc: 0.870 Test Loss: 0.657 Test Acc: 0.870
Validation loss decreased (-0.847819 --> -0.869559).  Saving model ...
Epoch: 10 cost time: 0.6002607345581055
Epoch: 10, Steps: 9 | Train Loss: 0.490 Vali Loss: 0.597 Vali Acc: 0.877 Test Loss: 0.597 Test Acc: 0.877
Validation loss decreased (-0.869559 --> -0.876806).  Saving model ...
Epoch: 11 cost time: 0.6433196067810059
Epoch: 11, Steps: 9 | Train Loss: 0.411 Vali Loss: 0.544 Vali Acc: 0.899 Test Loss: 0.544 Test Acc: 0.899
Validation loss decreased (-0.876806 --> -0.898545).  Saving model ...
Epoch: 12 cost time: 0.5312178134918213
Epoch: 12, Steps: 9 | Train Loss: 0.367 Vali Loss: 0.503 Vali Acc: 0.906 Test Loss: 0.503 Test Acc: 0.906
Validation loss decreased (-0.898545 --> -0.905792).  Saving model ...
Epoch: 13 cost time: 0.5335891246795654
Epoch: 13, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.461 Vali Acc: 0.906 Test Loss: 0.461 Test Acc: 0.906
Validation loss decreased (-0.905792 --> -0.905792).  Saving model ...
Epoch: 14 cost time: 0.505312442779541
Epoch: 14, Steps: 9 | Train Loss: 0.254 Vali Loss: 0.424 Vali Acc: 0.920 Test Loss: 0.424 Test Acc: 0.920
Validation loss decreased (-0.905792 --> -0.920286).  Saving model ...
Epoch: 15 cost time: 0.5549178123474121
Epoch: 15, Steps: 9 | Train Loss: 0.228 Vali Loss: 0.391 Vali Acc: 0.920 Test Loss: 0.391 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 16 cost time: 0.566694974899292
Epoch: 16, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.382 Vali Acc: 0.920 Test Loss: 0.382 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 17 cost time: 0.6564962863922119
Epoch: 17, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.351 Vali Acc: 0.935 Test Loss: 0.351 Test Acc: 0.935
Validation loss decreased (-0.920286 --> -0.934779).  Saving model ...
Epoch: 18 cost time: 0.5685176849365234
Epoch: 18, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.333 Vali Acc: 0.935 Test Loss: 0.333 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934779).  Saving model ...
Epoch: 19 cost time: 0.6070001125335693
Epoch: 19, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.322 Vali Acc: 0.920 Test Loss: 0.322 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5790235996246338
Epoch: 20, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.310 Vali Acc: 0.928 Test Loss: 0.310 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5675632953643799
Epoch: 21, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.297 Vali Acc: 0.928 Test Loss: 0.297 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5078682899475098
Epoch: 22, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.288 Vali Acc: 0.928 Test Loss: 0.288 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5574777126312256
Epoch: 23, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.276 Vali Acc: 0.935 Test Loss: 0.276 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934780).  Saving model ...
Epoch: 24 cost time: 0.5549590587615967
Epoch: 24, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.269 Vali Acc: 0.935 Test Loss: 0.269 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 25 cost time: 0.5549862384796143
Epoch: 25, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.260 Vali Acc: 0.935 Test Loss: 0.260 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 26 cost time: 0.5650873184204102
Epoch: 26, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.251 Vali Acc: 0.942 Test Loss: 0.251 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942026).  Saving model ...
Epoch: 27 cost time: 0.6136164665222168
Epoch: 27, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.252 Vali Acc: 0.935 Test Loss: 0.252 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5941975116729736
Epoch: 28, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.244 Vali Acc: 0.942 Test Loss: 0.244 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 29 cost time: 0.570380449295044
Epoch: 29, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.242 Vali Acc: 0.935 Test Loss: 0.242 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6044223308563232
Epoch: 30, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.228 Vali Acc: 0.942 Test Loss: 0.228 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 31 cost time: 0.5455684661865234
Epoch: 31, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5455770492553711
Epoch: 32, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.233 Vali Acc: 0.935 Test Loss: 0.233 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5849695205688477
Epoch: 33, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.231 Vali Acc: 0.942 Test Loss: 0.231 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5977513790130615
Epoch: 34, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.216 Vali Acc: 0.935 Test Loss: 0.216 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6053705215454102
Epoch: 35, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.5812809467315674
Epoch: 36, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.5804922580718994
Epoch: 37, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.5650722980499268
Epoch: 38, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.6344795227050781
Epoch: 39, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.201 Vali Acc: 0.935 Test Loss: 0.201 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.599872350692749
Epoch: 40, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.199 Vali Acc: 0.935 Test Loss: 0.199 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 23876
model size : 0.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8231549263000488
Epoch: 1, Steps: 9 | Train Loss: 1.320 Vali Loss: 1.276 Vali Acc: 0.493 Test Loss: 1.276 Test Acc: 0.493
Validation loss decreased (inf --> -0.492741).  Saving model ...
Epoch: 2 cost time: 0.5405559539794922
Epoch: 2, Steps: 9 | Train Loss: 1.282 Vali Loss: 1.230 Vali Acc: 0.486 Test Loss: 1.230 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5632262229919434
Epoch: 3, Steps: 9 | Train Loss: 1.196 Vali Loss: 1.168 Vali Acc: 0.514 Test Loss: 1.168 Test Acc: 0.514
Validation loss decreased (-0.492741 --> -0.514481).  Saving model ...
Epoch: 4 cost time: 0.5552971363067627
Epoch: 4, Steps: 9 | Train Loss: 1.122 Vali Loss: 1.088 Vali Acc: 0.623 Test Loss: 1.088 Test Acc: 0.623
Validation loss decreased (-0.514481 --> -0.623178).  Saving model ...
Epoch: 5 cost time: 0.543433427810669
Epoch: 5, Steps: 9 | Train Loss: 1.029 Vali Loss: 1.021 Vali Acc: 0.674 Test Loss: 1.021 Test Acc: 0.674
Validation loss decreased (-0.623178 --> -0.673903).  Saving model ...
Epoch: 6 cost time: 0.5532281398773193
Epoch: 6, Steps: 9 | Train Loss: 0.939 Vali Loss: 0.954 Vali Acc: 0.703 Test Loss: 0.954 Test Acc: 0.703
Validation loss decreased (-0.673903 --> -0.702889).  Saving model ...
Epoch: 7 cost time: 0.5405619144439697
Epoch: 7, Steps: 9 | Train Loss: 0.866 Vali Loss: 0.882 Vali Acc: 0.725 Test Loss: 0.882 Test Acc: 0.725
Validation loss decreased (-0.702889 --> -0.724629).  Saving model ...
Epoch: 8 cost time: 0.5718016624450684
Epoch: 8, Steps: 9 | Train Loss: 0.774 Vali Loss: 0.811 Vali Acc: 0.783 Test Loss: 0.811 Test Acc: 0.783
Validation loss decreased (-0.724629 --> -0.782601).  Saving model ...
Epoch: 9 cost time: 0.5587680339813232
Epoch: 9, Steps: 9 | Train Loss: 0.712 Vali Loss: 0.751 Vali Acc: 0.790 Test Loss: 0.751 Test Acc: 0.790
Validation loss decreased (-0.782601 --> -0.789848).  Saving model ...
Epoch: 10 cost time: 0.5580110549926758
Epoch: 10, Steps: 9 | Train Loss: 0.639 Vali Loss: 0.699 Vali Acc: 0.841 Test Loss: 0.699 Test Acc: 0.841
Validation loss decreased (-0.789848 --> -0.840573).  Saving model ...
Epoch: 11 cost time: 0.5655145645141602
Epoch: 11, Steps: 9 | Train Loss: 0.556 Vali Loss: 0.645 Vali Acc: 0.877 Test Loss: 0.645 Test Acc: 0.877
Validation loss decreased (-0.840573 --> -0.876805).  Saving model ...
Epoch: 12 cost time: 0.5171403884887695
Epoch: 12, Steps: 9 | Train Loss: 0.503 Vali Loss: 0.600 Vali Acc: 0.891 Test Loss: 0.600 Test Acc: 0.891
Validation loss decreased (-0.876805 --> -0.891298).  Saving model ...
Epoch: 13 cost time: 0.5780603885650635
Epoch: 13, Steps: 9 | Train Loss: 0.437 Vali Loss: 0.562 Vali Acc: 0.899 Test Loss: 0.562 Test Acc: 0.899
Validation loss decreased (-0.891298 --> -0.898545).  Saving model ...
Epoch: 14 cost time: 0.5938720703125
Epoch: 14, Steps: 9 | Train Loss: 0.404 Vali Loss: 0.528 Vali Acc: 0.913 Test Loss: 0.528 Test Acc: 0.913
Validation loss decreased (-0.898545 --> -0.913038).  Saving model ...
Epoch: 15 cost time: 0.5304548740386963
Epoch: 15, Steps: 9 | Train Loss: 0.362 Vali Loss: 0.486 Vali Acc: 0.920 Test Loss: 0.486 Test Acc: 0.920
Validation loss decreased (-0.913038 --> -0.920285).  Saving model ...
Epoch: 16 cost time: 0.577843189239502
Epoch: 16, Steps: 9 | Train Loss: 0.319 Vali Loss: 0.454 Vali Acc: 0.920 Test Loss: 0.454 Test Acc: 0.920
Validation loss decreased (-0.920285 --> -0.920285).  Saving model ...
Epoch: 17 cost time: 0.5766415596008301
Epoch: 17, Steps: 9 | Train Loss: 0.316 Vali Loss: 0.430 Vali Acc: 0.920 Test Loss: 0.430 Test Acc: 0.920
Validation loss decreased (-0.920285 --> -0.920286).  Saving model ...
Epoch: 18 cost time: 0.609483003616333
Epoch: 18, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.410 Vali Acc: 0.920 Test Loss: 0.410 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 19 cost time: 0.5357706546783447
Epoch: 19, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.396 Vali Acc: 0.920 Test Loss: 0.396 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 20 cost time: 0.5319869518280029
Epoch: 20, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.381 Vali Acc: 0.920 Test Loss: 0.381 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 21 cost time: 0.5641686916351318
Epoch: 21, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.359 Vali Acc: 0.928 Test Loss: 0.359 Test Acc: 0.928
Validation loss decreased (-0.920286 --> -0.927533).  Saving model ...
Epoch: 22 cost time: 0.5744757652282715
Epoch: 22, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.349 Vali Acc: 0.935 Test Loss: 0.349 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934779).  Saving model ...
Epoch: 23 cost time: 0.5265481472015381
Epoch: 23, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.338 Vali Acc: 0.949 Test Loss: 0.338 Test Acc: 0.949
Validation loss decreased (-0.934779 --> -0.949272).  Saving model ...
Epoch: 24 cost time: 0.5633189678192139
Epoch: 24, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.319 Vali Acc: 0.949 Test Loss: 0.319 Test Acc: 0.949
Validation loss decreased (-0.949272 --> -0.949272).  Saving model ...
Epoch: 25 cost time: 0.5982153415679932
Epoch: 25, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.305 Vali Acc: 0.942 Test Loss: 0.305 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5512545108795166
Epoch: 26, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.296 Vali Acc: 0.942 Test Loss: 0.296 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5461680889129639
Epoch: 27, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.290 Vali Acc: 0.949 Test Loss: 0.290 Test Acc: 0.949
Validation loss decreased (-0.949272 --> -0.949272).  Saving model ...
Epoch: 28 cost time: 0.5632102489471436
Epoch: 28, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.281 Vali Acc: 0.949 Test Loss: 0.281 Test Acc: 0.949
Validation loss decreased (-0.949272 --> -0.949273).  Saving model ...
Epoch: 29 cost time: 0.5038163661956787
Epoch: 29, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.273 Vali Acc: 0.949 Test Loss: 0.273 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 30 cost time: 0.5519325733184814
Epoch: 30, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.270 Vali Acc: 0.949 Test Loss: 0.270 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 31 cost time: 0.5606977939605713
Epoch: 31, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.256 Vali Acc: 0.949 Test Loss: 0.256 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 32 cost time: 0.5406334400177002
Epoch: 32, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.241 Vali Acc: 0.949 Test Loss: 0.241 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 33 cost time: 0.5008385181427002
Epoch: 33, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.242 Vali Acc: 0.949 Test Loss: 0.242 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5094387531280518
Epoch: 34, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.236 Vali Acc: 0.949 Test Loss: 0.236 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 35 cost time: 0.4875051975250244
Epoch: 35, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.234 Vali Acc: 0.949 Test Loss: 0.234 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 36 cost time: 0.5139923095703125
Epoch: 36, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.238 Vali Acc: 0.949 Test Loss: 0.238 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.56581711769104
Epoch: 37, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.233 Vali Acc: 0.949 Test Loss: 0.233 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 38 cost time: 0.5431034564971924
Epoch: 38, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.217 Vali Acc: 0.949 Test Loss: 0.217 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 39 cost time: 0.562462568283081
Epoch: 39, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.217 Vali Acc: 0.949 Test Loss: 0.217 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 40 cost time: 0.5369033813476562
Epoch: 40, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.214 Vali Acc: 0.949 Test Loss: 0.214 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 41 cost time: 0.5381119251251221
Epoch: 41, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.217 Vali Acc: 0.949 Test Loss: 0.217 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5619726181030273
Epoch: 42, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.208 Vali Acc: 0.949 Test Loss: 0.208 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 43 cost time: 0.5342137813568115
Epoch: 43, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.203 Vali Acc: 0.949 Test Loss: 0.203 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 44 cost time: 0.5947020053863525
Epoch: 44, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.202 Vali Acc: 0.949 Test Loss: 0.202 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 45 cost time: 0.5546026229858398
Epoch: 45, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.196 Vali Acc: 0.957 Test Loss: 0.196 Test Acc: 0.957
Validation loss decreased (-0.949273 --> -0.956520).  Saving model ...
Epoch: 46 cost time: 0.5457758903503418
Epoch: 46, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.192 Vali Acc: 0.957 Test Loss: 0.192 Test Acc: 0.957
Validation loss decreased (-0.956520 --> -0.956520).  Saving model ...
Epoch: 47 cost time: 0.5638618469238281
Epoch: 47, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.191 Vali Acc: 0.957 Test Loss: 0.191 Test Acc: 0.957
Validation loss decreased (-0.956520 --> -0.956520).  Saving model ...
Epoch: 48 cost time: 0.5967504978179932
Epoch: 48, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.195 Vali Acc: 0.957 Test Loss: 0.195 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5580413341522217
Epoch: 49, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.198 Vali Acc: 0.957 Test Loss: 0.198 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.5786423683166504
Epoch: 50, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.187 Vali Acc: 0.957 Test Loss: 0.187 Test Acc: 0.957
Validation loss decreased (-0.956520 --> -0.956520).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9565217391304348
model parameter : 21892
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0462939739227295
Epoch: 1, Steps: 9 | Train Loss: 1.392 Vali Loss: 1.365 Vali Acc: 0.355 Test Loss: 1.365 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 0.5770869255065918
Epoch: 2, Steps: 9 | Train Loss: 1.339 Vali Loss: 1.331 Vali Acc: 0.384 Test Loss: 1.331 Test Acc: 0.384
Validation loss decreased (-0.355059 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 0.6214339733123779
Epoch: 3, Steps: 9 | Train Loss: 1.280 Vali Loss: 1.280 Vali Acc: 0.428 Test Loss: 1.280 Test Acc: 0.428
Validation loss decreased (-0.384045 --> -0.427523).  Saving model ...
Epoch: 4 cost time: 0.5355048179626465
Epoch: 4, Steps: 9 | Train Loss: 1.244 Vali Loss: 1.221 Vali Acc: 0.486 Test Loss: 1.221 Test Acc: 0.486
Validation loss decreased (-0.427523 --> -0.485495).  Saving model ...
Epoch: 5 cost time: 0.5698838233947754
Epoch: 5, Steps: 9 | Train Loss: 1.150 Vali Loss: 1.161 Vali Acc: 0.536 Test Loss: 1.161 Test Acc: 0.536
Validation loss decreased (-0.485495 --> -0.536220).  Saving model ...
Epoch: 6 cost time: 0.5846371650695801
Epoch: 6, Steps: 9 | Train Loss: 1.079 Vali Loss: 1.103 Vali Acc: 0.551 Test Loss: 1.103 Test Acc: 0.551
Validation loss decreased (-0.536220 --> -0.550714).  Saving model ...
Epoch: 7 cost time: 0.5600380897521973
Epoch: 7, Steps: 9 | Train Loss: 0.997 Vali Loss: 1.041 Vali Acc: 0.580 Test Loss: 1.041 Test Acc: 0.580
Validation loss decreased (-0.550714 --> -0.579700).  Saving model ...
Epoch: 8 cost time: 0.5195906162261963
Epoch: 8, Steps: 9 | Train Loss: 0.914 Vali Loss: 0.987 Vali Acc: 0.638 Test Loss: 0.987 Test Acc: 0.638
Validation loss decreased (-0.579700 --> -0.637671).  Saving model ...
Epoch: 9 cost time: 0.5101044178009033
Epoch: 9, Steps: 9 | Train Loss: 0.882 Vali Loss: 0.927 Vali Acc: 0.652 Test Loss: 0.927 Test Acc: 0.652
Validation loss decreased (-0.637671 --> -0.652165).  Saving model ...
Epoch: 10 cost time: 0.5843102931976318
Epoch: 10, Steps: 9 | Train Loss: 0.794 Vali Loss: 0.883 Vali Acc: 0.710 Test Loss: 0.883 Test Acc: 0.710
Validation loss decreased (-0.652165 --> -0.710136).  Saving model ...
Epoch: 11 cost time: 0.528883695602417
Epoch: 11, Steps: 9 | Train Loss: 0.720 Vali Loss: 0.833 Vali Acc: 0.761 Test Loss: 0.833 Test Acc: 0.761
Validation loss decreased (-0.710136 --> -0.760861).  Saving model ...
Epoch: 12 cost time: 0.6033451557159424
Epoch: 12, Steps: 9 | Train Loss: 0.692 Vali Loss: 0.781 Vali Acc: 0.797 Test Loss: 0.781 Test Acc: 0.797
Validation loss decreased (-0.760861 --> -0.797094).  Saving model ...
Epoch: 13 cost time: 0.5726804733276367
Epoch: 13, Steps: 9 | Train Loss: 0.606 Vali Loss: 0.741 Vali Acc: 0.812 Test Loss: 0.741 Test Acc: 0.812
Validation loss decreased (-0.797094 --> -0.811587).  Saving model ...
Epoch: 14 cost time: 0.5381050109863281
Epoch: 14, Steps: 9 | Train Loss: 0.571 Vali Loss: 0.707 Vali Acc: 0.848 Test Loss: 0.707 Test Acc: 0.848
Validation loss decreased (-0.811587 --> -0.847819).  Saving model ...
Epoch: 15 cost time: 0.5568757057189941
Epoch: 15, Steps: 9 | Train Loss: 0.524 Vali Loss: 0.668 Vali Acc: 0.848 Test Loss: 0.668 Test Acc: 0.848
Validation loss decreased (-0.847819 --> -0.847819).  Saving model ...
Epoch: 16 cost time: 0.5513255596160889
Epoch: 16, Steps: 9 | Train Loss: 0.470 Vali Loss: 0.633 Vali Acc: 0.870 Test Loss: 0.633 Test Acc: 0.870
Validation loss decreased (-0.847819 --> -0.869559).  Saving model ...
Epoch: 17 cost time: 0.5284066200256348
Epoch: 17, Steps: 9 | Train Loss: 0.445 Vali Loss: 0.598 Vali Acc: 0.870 Test Loss: 0.598 Test Acc: 0.870
Validation loss decreased (-0.869559 --> -0.869559).  Saving model ...
Epoch: 18 cost time: 0.49277377128601074
Epoch: 18, Steps: 9 | Train Loss: 0.415 Vali Loss: 0.565 Vali Acc: 0.877 Test Loss: 0.565 Test Acc: 0.877
Validation loss decreased (-0.869559 --> -0.876806).  Saving model ...
Epoch: 19 cost time: 0.5310614109039307
Epoch: 19, Steps: 9 | Train Loss: 0.346 Vali Loss: 0.537 Vali Acc: 0.884 Test Loss: 0.537 Test Acc: 0.884
Validation loss decreased (-0.876806 --> -0.884053).  Saving model ...
Epoch: 20 cost time: 0.518923282623291
Epoch: 20, Steps: 9 | Train Loss: 0.344 Vali Loss: 0.531 Vali Acc: 0.877 Test Loss: 0.531 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5946459770202637
Epoch: 21, Steps: 9 | Train Loss: 0.311 Vali Loss: 0.511 Vali Acc: 0.877 Test Loss: 0.511 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.558215856552124
Epoch: 22, Steps: 9 | Train Loss: 0.283 Vali Loss: 0.492 Vali Acc: 0.884 Test Loss: 0.492 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 23 cost time: 0.520404577255249
Epoch: 23, Steps: 9 | Train Loss: 0.266 Vali Loss: 0.468 Vali Acc: 0.899 Test Loss: 0.468 Test Acc: 0.899
Validation loss decreased (-0.884053 --> -0.898546).  Saving model ...
Epoch: 24 cost time: 0.4924280643463135
Epoch: 24, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.445 Vali Acc: 0.906 Test Loss: 0.445 Test Acc: 0.906
Validation loss decreased (-0.898546 --> -0.905793).  Saving model ...
Epoch: 25 cost time: 0.541754961013794
Epoch: 25, Steps: 9 | Train Loss: 0.232 Vali Loss: 0.429 Vali Acc: 0.913 Test Loss: 0.429 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913039).  Saving model ...
Epoch: 26 cost time: 0.5453393459320068
Epoch: 26, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.412 Vali Acc: 0.920 Test Loss: 0.412 Test Acc: 0.920
Validation loss decreased (-0.913039 --> -0.920286).  Saving model ...
Epoch: 27 cost time: 0.5472114086151123
Epoch: 27, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.402 Vali Acc: 0.913 Test Loss: 0.402 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5511677265167236
Epoch: 28, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.395 Vali Acc: 0.913 Test Loss: 0.395 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5587894916534424
Epoch: 29, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.379 Vali Acc: 0.920 Test Loss: 0.379 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 30 cost time: 0.5335240364074707
Epoch: 30, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.365 Vali Acc: 0.920 Test Loss: 0.365 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 31 cost time: 0.6303582191467285
Epoch: 31, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.353 Vali Acc: 0.920 Test Loss: 0.353 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 32 cost time: 0.5071430206298828
Epoch: 32, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.341 Vali Acc: 0.913 Test Loss: 0.341 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5293145179748535
Epoch: 33, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.336 Vali Acc: 0.920 Test Loss: 0.336 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 34 cost time: 0.5625905990600586
Epoch: 34, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.334 Vali Acc: 0.935 Test Loss: 0.334 Test Acc: 0.935
Validation loss decreased (-0.920286 --> -0.934779).  Saving model ...
Epoch: 35 cost time: 0.5255105495452881
Epoch: 35, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.332 Vali Acc: 0.928 Test Loss: 0.332 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5366706848144531
Epoch: 36, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.312 Vali Acc: 0.935 Test Loss: 0.312 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934779).  Saving model ...
Epoch: 37 cost time: 0.5123195648193359
Epoch: 37, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.312 Vali Acc: 0.935 Test Loss: 0.312 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934779).  Saving model ...
Epoch: 38 cost time: 0.5472519397735596
Epoch: 38, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.304 Vali Acc: 0.935 Test Loss: 0.304 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934780).  Saving model ...
Epoch: 39 cost time: 0.5957143306732178
Epoch: 39, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.289 Vali Acc: 0.942 Test Loss: 0.289 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942026).  Saving model ...
Epoch: 40 cost time: 0.515174150466919
Epoch: 40, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.285 Vali Acc: 0.949 Test Loss: 0.285 Test Acc: 0.949
Validation loss decreased (-0.942026 --> -0.949273).  Saving model ...
Epoch: 41 cost time: 0.5447862148284912
Epoch: 41, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.298 Vali Acc: 0.942 Test Loss: 0.298 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5651099681854248
Epoch: 42, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.294 Vali Acc: 0.942 Test Loss: 0.294 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6570272445678711
Epoch: 43, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.280 Vali Acc: 0.928 Test Loss: 0.280 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5144922733306885
Epoch: 44, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.276 Vali Acc: 0.935 Test Loss: 0.276 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.5513365268707275
Epoch: 45, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.271 Vali Acc: 0.935 Test Loss: 0.271 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.5319302082061768
Epoch: 46, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.273 Vali Acc: 0.935 Test Loss: 0.273 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.5797557830810547
Epoch: 47, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.263 Vali Acc: 0.942 Test Loss: 0.263 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.5239129066467285
Epoch: 48, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.262 Vali Acc: 0.935 Test Loss: 0.262 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.5473487377166748
Epoch: 49, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.265 Vali Acc: 0.935 Test Loss: 0.265 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.5533318519592285
Epoch: 50, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.255 Vali Acc: 0.928 Test Loss: 0.255 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 21092
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.7239007949829102
Epoch: 1, Steps: 9 | Train Loss: 1.372 Vali Loss: 1.356 Vali Acc: 0.290 Test Loss: 1.356 Test Acc: 0.290
Validation loss decreased (inf --> -0.289842).  Saving model ...
Epoch: 2 cost time: 0.5256690979003906
Epoch: 2, Steps: 9 | Train Loss: 1.348 Vali Loss: 1.319 Vali Acc: 0.384 Test Loss: 1.319 Test Acc: 0.384
Validation loss decreased (-0.289842 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 0.549358606338501
Epoch: 3, Steps: 9 | Train Loss: 1.283 Vali Loss: 1.266 Vali Acc: 0.399 Test Loss: 1.266 Test Acc: 0.399
Validation loss decreased (-0.384045 --> -0.398538).  Saving model ...
Epoch: 4 cost time: 0.5117459297180176
Epoch: 4, Steps: 9 | Train Loss: 1.201 Vali Loss: 1.217 Vali Acc: 0.457 Test Loss: 1.217 Test Acc: 0.457
Validation loss decreased (-0.398538 --> -0.456510).  Saving model ...
Epoch: 5 cost time: 0.517296314239502
Epoch: 5, Steps: 9 | Train Loss: 1.145 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
Validation loss decreased (-0.456510 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.5608839988708496
Epoch: 6, Steps: 9 | Train Loss: 1.078 Vali Loss: 1.112 Vali Acc: 0.522 Test Loss: 1.112 Test Acc: 0.522
Validation loss decreased (-0.499988 --> -0.521728).  Saving model ...
Epoch: 7 cost time: 0.5554904937744141
Epoch: 7, Steps: 9 | Train Loss: 1.015 Vali Loss: 1.057 Vali Acc: 0.551 Test Loss: 1.057 Test Acc: 0.551
Validation loss decreased (-0.521728 --> -0.550714).  Saving model ...
Epoch: 8 cost time: 0.5924768447875977
Epoch: 8, Steps: 9 | Train Loss: 0.965 Vali Loss: 1.012 Vali Acc: 0.565 Test Loss: 1.012 Test Acc: 0.565
Validation loss decreased (-0.550714 --> -0.565207).  Saving model ...
Epoch: 9 cost time: 0.5382115840911865
Epoch: 9, Steps: 9 | Train Loss: 0.884 Vali Loss: 0.962 Vali Acc: 0.601 Test Loss: 0.962 Test Acc: 0.601
Validation loss decreased (-0.565207 --> -0.601440).  Saving model ...
Epoch: 10 cost time: 0.5861532688140869
Epoch: 10, Steps: 9 | Train Loss: 0.841 Vali Loss: 0.915 Vali Acc: 0.674 Test Loss: 0.915 Test Acc: 0.674
Validation loss decreased (-0.601440 --> -0.673904).  Saving model ...
Epoch: 11 cost time: 0.5233473777770996
Epoch: 11, Steps: 9 | Train Loss: 0.765 Vali Loss: 0.868 Vali Acc: 0.732 Test Loss: 0.868 Test Acc: 0.732
Validation loss decreased (-0.673904 --> -0.731875).  Saving model ...
Epoch: 12 cost time: 0.5350117683410645
Epoch: 12, Steps: 9 | Train Loss: 0.696 Vali Loss: 0.824 Vali Acc: 0.739 Test Loss: 0.824 Test Acc: 0.739
Validation loss decreased (-0.731875 --> -0.739122).  Saving model ...
Epoch: 13 cost time: 0.5972020626068115
Epoch: 13, Steps: 9 | Train Loss: 0.648 Vali Loss: 0.780 Vali Acc: 0.761 Test Loss: 0.780 Test Acc: 0.761
Validation loss decreased (-0.739122 --> -0.760862).  Saving model ...
Epoch: 14 cost time: 0.5261316299438477
Epoch: 14, Steps: 9 | Train Loss: 0.578 Vali Loss: 0.749 Vali Acc: 0.768 Test Loss: 0.749 Test Acc: 0.768
Validation loss decreased (-0.760862 --> -0.768108).  Saving model ...
Epoch: 15 cost time: 0.5207188129425049
Epoch: 15, Steps: 9 | Train Loss: 0.561 Vali Loss: 0.707 Vali Acc: 0.768 Test Loss: 0.707 Test Acc: 0.768
Validation loss decreased (-0.768108 --> -0.768109).  Saving model ...
Epoch: 16 cost time: 0.5346260070800781
Epoch: 16, Steps: 9 | Train Loss: 0.515 Vali Loss: 0.674 Vali Acc: 0.768 Test Loss: 0.674 Test Acc: 0.768
Validation loss decreased (-0.768109 --> -0.768109).  Saving model ...
Epoch: 17 cost time: 0.6379351615905762
Epoch: 17, Steps: 9 | Train Loss: 0.476 Vali Loss: 0.659 Vali Acc: 0.761 Test Loss: 0.659 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6005475521087646
Epoch: 18, Steps: 9 | Train Loss: 0.453 Vali Loss: 0.632 Vali Acc: 0.768 Test Loss: 0.632 Test Acc: 0.768
Validation loss decreased (-0.768109 --> -0.768110).  Saving model ...
Epoch: 19 cost time: 0.5971922874450684
Epoch: 19, Steps: 9 | Train Loss: 0.434 Vali Loss: 0.607 Vali Acc: 0.775 Test Loss: 0.607 Test Acc: 0.775
Validation loss decreased (-0.768110 --> -0.775356).  Saving model ...
Epoch: 20 cost time: 0.5817782878875732
Epoch: 20, Steps: 9 | Train Loss: 0.388 Vali Loss: 0.586 Vali Acc: 0.819 Test Loss: 0.586 Test Acc: 0.819
Validation loss decreased (-0.775356 --> -0.818835).  Saving model ...
Epoch: 21 cost time: 0.5646045207977295
Epoch: 21, Steps: 9 | Train Loss: 0.379 Vali Loss: 0.561 Vali Acc: 0.833 Test Loss: 0.561 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 22 cost time: 0.5361812114715576
Epoch: 22, Steps: 9 | Train Loss: 0.321 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 23 cost time: 0.5791897773742676
Epoch: 23, Steps: 9 | Train Loss: 0.309 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 24 cost time: 0.5444605350494385
Epoch: 24, Steps: 9 | Train Loss: 0.280 Vali Loss: 0.510 Vali Acc: 0.833 Test Loss: 0.510 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5922467708587646
Epoch: 25, Steps: 9 | Train Loss: 0.249 Vali Loss: 0.499 Vali Acc: 0.848 Test Loss: 0.499 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 26 cost time: 0.5580174922943115
Epoch: 26, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.487 Vali Acc: 0.848 Test Loss: 0.487 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 27 cost time: 0.6176676750183105
Epoch: 27, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.473 Vali Acc: 0.855 Test Loss: 0.473 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 28 cost time: 0.5467112064361572
Epoch: 28, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.451 Vali Acc: 0.855 Test Loss: 0.451 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 29 cost time: 0.5966610908508301
Epoch: 29, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.440 Vali Acc: 0.855 Test Loss: 0.440 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 30 cost time: 0.6027050018310547
Epoch: 30, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.430 Vali Acc: 0.862 Test Loss: 0.430 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 31 cost time: 0.5728774070739746
Epoch: 31, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.410 Vali Acc: 0.877 Test Loss: 0.410 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876807).  Saving model ...
Epoch: 32 cost time: 0.6264996528625488
Epoch: 32, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.406 Vali Acc: 0.870 Test Loss: 0.406 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5386734008789062
Epoch: 33, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.404 Vali Acc: 0.862 Test Loss: 0.404 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5442581176757812
Epoch: 34, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.398 Vali Acc: 0.862 Test Loss: 0.398 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6164016723632812
Epoch: 35, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.400 Vali Acc: 0.877 Test Loss: 0.400 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876808).  Saving model ...
Epoch: 36 cost time: 0.4878389835357666
Epoch: 36, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.385 Vali Acc: 0.877 Test Loss: 0.385 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 37 cost time: 0.5234270095825195
Epoch: 37, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.359 Vali Acc: 0.877 Test Loss: 0.359 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 38 cost time: 0.5291905403137207
Epoch: 38, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.356 Vali Acc: 0.891 Test Loss: 0.356 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 39 cost time: 0.5231621265411377
Epoch: 39, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.348 Vali Acc: 0.884 Test Loss: 0.348 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5661072731018066
Epoch: 40, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.350 Vali Acc: 0.884 Test Loss: 0.350 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5388901233673096
Epoch: 41, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.333 Vali Acc: 0.899 Test Loss: 0.333 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 42 cost time: 0.6362230777740479
Epoch: 42, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.327 Vali Acc: 0.906 Test Loss: 0.327 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 43 cost time: 0.6001379489898682
Epoch: 43, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.327 Vali Acc: 0.891 Test Loss: 0.327 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5824673175811768
Epoch: 44, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.320 Vali Acc: 0.891 Test Loss: 0.320 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.552459716796875
Epoch: 45, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.327 Vali Acc: 0.884 Test Loss: 0.327 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6388051509857178
Epoch: 46, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.321 Vali Acc: 0.884 Test Loss: 0.321 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.5209321975708008
Epoch: 47, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.320 Vali Acc: 0.891 Test Loss: 0.320 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.531456708908081
Epoch: 48, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.307 Vali Acc: 0.891 Test Loss: 0.307 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.5713503360748291
Epoch: 49, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.307 Vali Acc: 0.891 Test Loss: 0.307 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.46757054328918457
Epoch: 50, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.301 Vali Acc: 0.899 Test Loss: 0.301 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 20644
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.857574462890625
Epoch: 1, Steps: 9 | Train Loss: 1.386 Vali Loss: 1.359 Vali Acc: 0.384 Test Loss: 1.359 Test Acc: 0.384
Validation loss decreased (inf --> -0.384044).  Saving model ...
Epoch: 2 cost time: 0.7385423183441162
Epoch: 2, Steps: 9 | Train Loss: 1.309 Vali Loss: 1.280 Vali Acc: 0.442 Test Loss: 1.280 Test Acc: 0.442
Validation loss decreased (-0.384044 --> -0.442016).  Saving model ...
Epoch: 3 cost time: 0.64892578125
Epoch: 3, Steps: 9 | Train Loss: 1.158 Vali Loss: 1.146 Vali Acc: 0.703 Test Loss: 1.146 Test Acc: 0.703
Validation loss decreased (-0.442016 --> -0.702887).  Saving model ...
Epoch: 4 cost time: 0.6817653179168701
Epoch: 4, Steps: 9 | Train Loss: 1.026 Vali Loss: 0.987 Vali Acc: 0.739 Test Loss: 0.987 Test Acc: 0.739
Validation loss decreased (-0.702887 --> -0.739121).  Saving model ...
Epoch: 5 cost time: 0.7247164249420166
Epoch: 5, Steps: 9 | Train Loss: 0.822 Vali Loss: 0.829 Vali Acc: 0.819 Test Loss: 0.829 Test Acc: 0.819
Validation loss decreased (-0.739121 --> -0.818832).  Saving model ...
Epoch: 6 cost time: 0.6315677165985107
Epoch: 6, Steps: 9 | Train Loss: 0.648 Vali Loss: 0.658 Vali Acc: 0.848 Test Loss: 0.658 Test Acc: 0.848
Validation loss decreased (-0.818832 --> -0.847820).  Saving model ...
Epoch: 7 cost time: 0.6885995864868164
Epoch: 7, Steps: 9 | Train Loss: 0.480 Vali Loss: 0.512 Vali Acc: 0.877 Test Loss: 0.512 Test Acc: 0.877
Validation loss decreased (-0.847820 --> -0.876806).  Saving model ...
Epoch: 8 cost time: 0.6566555500030518
Epoch: 8, Steps: 9 | Train Loss: 0.339 Vali Loss: 0.391 Vali Acc: 0.906 Test Loss: 0.391 Test Acc: 0.906
Validation loss decreased (-0.876806 --> -0.905793).  Saving model ...
Epoch: 9 cost time: 0.7039971351623535
Epoch: 9, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.322 Vali Acc: 0.899 Test Loss: 0.322 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7142271995544434
Epoch: 10, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.273 Vali Acc: 0.935 Test Loss: 0.273 Test Acc: 0.935
Validation loss decreased (-0.905793 --> -0.934780).  Saving model ...
Epoch: 11 cost time: 0.696218729019165
Epoch: 11, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.228 Vali Acc: 0.942 Test Loss: 0.228 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 12 cost time: 0.7245926856994629
Epoch: 12, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.234 Vali Acc: 0.928 Test Loss: 0.234 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6771907806396484
Epoch: 13, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.227 Vali Acc: 0.935 Test Loss: 0.227 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6986935138702393
Epoch: 14, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.219 Vali Acc: 0.920 Test Loss: 0.219 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7032558917999268
Epoch: 15, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.211 Vali Acc: 0.920 Test Loss: 0.211 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7101497650146484
Epoch: 16, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.209 Vali Acc: 0.920 Test Loss: 0.209 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6898126602172852
Epoch: 17, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6962864398956299
Epoch: 18, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.196 Vali Acc: 0.928 Test Loss: 0.196 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6824533939361572
Epoch: 19, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.206 Vali Acc: 0.920 Test Loss: 0.206 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.658900260925293
Epoch: 20, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.200 Vali Acc: 0.928 Test Loss: 0.200 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.74642014503479
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.200 Vali Acc: 0.920 Test Loss: 0.200 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 198244
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.083763599395752
Epoch: 1, Steps: 9 | Train Loss: 1.427 Vali Loss: 1.397 Vali Acc: 0.239 Test Loss: 1.397 Test Acc: 0.239
Validation loss decreased (inf --> -0.239116).  Saving model ...
Epoch: 2 cost time: 0.7605347633361816
Epoch: 2, Steps: 9 | Train Loss: 1.364 Vali Loss: 1.360 Vali Acc: 0.399 Test Loss: 1.360 Test Acc: 0.399
Validation loss decreased (-0.239116 --> -0.398537).  Saving model ...
Epoch: 3 cost time: 0.7018749713897705
Epoch: 3, Steps: 9 | Train Loss: 1.251 Vali Loss: 1.289 Vali Acc: 0.558 Test Loss: 1.289 Test Acc: 0.558
Validation loss decreased (-0.398537 --> -0.557958).  Saving model ...
Epoch: 4 cost time: 0.6992175579071045
Epoch: 4, Steps: 9 | Train Loss: 1.175 Vali Loss: 1.190 Vali Acc: 0.667 Test Loss: 1.190 Test Acc: 0.667
Validation loss decreased (-0.557958 --> -0.666655).  Saving model ...
Epoch: 5 cost time: 0.7247991561889648
Epoch: 5, Steps: 9 | Train Loss: 1.052 Vali Loss: 1.066 Vali Acc: 0.732 Test Loss: 1.066 Test Acc: 0.732
Validation loss decreased (-0.666655 --> -0.731873).  Saving model ...
Epoch: 6 cost time: 0.6765537261962891
Epoch: 6, Steps: 9 | Train Loss: 0.905 Vali Loss: 0.929 Vali Acc: 0.768 Test Loss: 0.929 Test Acc: 0.768
Validation loss decreased (-0.731873 --> -0.768107).  Saving model ...
Epoch: 7 cost time: 0.7215316295623779
Epoch: 7, Steps: 9 | Train Loss: 0.784 Vali Loss: 0.806 Vali Acc: 0.819 Test Loss: 0.806 Test Acc: 0.819
Validation loss decreased (-0.768107 --> -0.818833).  Saving model ...
Epoch: 8 cost time: 0.7514569759368896
Epoch: 8, Steps: 9 | Train Loss: 0.638 Vali Loss: 0.692 Vali Acc: 0.855 Test Loss: 0.692 Test Acc: 0.855
Validation loss decreased (-0.818833 --> -0.855066).  Saving model ...
Epoch: 9 cost time: 0.7075648307800293
Epoch: 9, Steps: 9 | Train Loss: 0.522 Vali Loss: 0.578 Vali Acc: 0.862 Test Loss: 0.578 Test Acc: 0.862
Validation loss decreased (-0.855066 --> -0.862313).  Saving model ...
Epoch: 10 cost time: 0.8369228839874268
Epoch: 10, Steps: 9 | Train Loss: 0.401 Vali Loss: 0.486 Vali Acc: 0.891 Test Loss: 0.486 Test Acc: 0.891
Validation loss decreased (-0.862313 --> -0.891299).  Saving model ...
Epoch: 11 cost time: 0.7432510852813721
Epoch: 11, Steps: 9 | Train Loss: 0.318 Vali Loss: 0.424 Vali Acc: 0.884 Test Loss: 0.424 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6978118419647217
Epoch: 12, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.369 Vali Acc: 0.906 Test Loss: 0.369 Test Acc: 0.906
Validation loss decreased (-0.891299 --> -0.905793).  Saving model ...
Epoch: 13 cost time: 0.7355349063873291
Epoch: 13, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.326 Vali Acc: 0.920 Test Loss: 0.326 Test Acc: 0.920
Validation loss decreased (-0.905793 --> -0.920287).  Saving model ...
Epoch: 14 cost time: 0.6656026840209961
Epoch: 14, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.309 Vali Acc: 0.913 Test Loss: 0.309 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.680927038192749
Epoch: 15, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.283 Vali Acc: 0.920 Test Loss: 0.283 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 16 cost time: 0.6283607482910156
Epoch: 16, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.266 Vali Acc: 0.928 Test Loss: 0.266 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 17 cost time: 0.7285594940185547
Epoch: 17, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.262 Vali Acc: 0.928 Test Loss: 0.262 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 18 cost time: 0.6811978816986084
Epoch: 18, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.261 Vali Acc: 0.920 Test Loss: 0.261 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6755475997924805
Epoch: 19, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.254 Vali Acc: 0.920 Test Loss: 0.254 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7393515110015869
Epoch: 20, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.243 Vali Acc: 0.928 Test Loss: 0.243 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 21 cost time: 0.7026500701904297
Epoch: 21, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.252 Vali Acc: 0.920 Test Loss: 0.252 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7502720355987549
Epoch: 22, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.249 Vali Acc: 0.920 Test Loss: 0.249 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7189154624938965
Epoch: 23, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.250 Vali Acc: 0.920 Test Loss: 0.250 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.769045352935791
Epoch: 24, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.239 Vali Acc: 0.913 Test Loss: 0.239 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7090368270874023
Epoch: 25, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.240 Vali Acc: 0.906 Test Loss: 0.240 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7017583847045898
Epoch: 26, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.235 Vali Acc: 0.913 Test Loss: 0.235 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6577389240264893
Epoch: 27, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.223 Vali Acc: 0.920 Test Loss: 0.223 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7951178550720215
Epoch: 28, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.235 Vali Acc: 0.913 Test Loss: 0.235 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7213263511657715
Epoch: 29, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.249 Vali Acc: 0.906 Test Loss: 0.249 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7574048042297363
Epoch: 30, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.243 Vali Acc: 0.913 Test Loss: 0.243 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 186116
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.207876682281494
Epoch: 1, Steps: 9 | Train Loss: 1.390 Vali Loss: 1.373 Vali Acc: 0.297 Test Loss: 1.373 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 0.7810060977935791
Epoch: 2, Steps: 9 | Train Loss: 1.360 Vali Loss: 1.330 Vali Acc: 0.370 Test Loss: 1.330 Test Acc: 0.370
Validation loss decreased (-0.297088 --> -0.369552).  Saving model ...
Epoch: 3 cost time: 0.7864181995391846
Epoch: 3, Steps: 9 | Train Loss: 1.273 Vali Loss: 1.264 Vali Acc: 0.543 Test Loss: 1.264 Test Acc: 0.543
Validation loss decreased (-0.369552 --> -0.543466).  Saving model ...
Epoch: 4 cost time: 0.9487521648406982
Epoch: 4, Steps: 9 | Train Loss: 1.191 Vali Loss: 1.178 Vali Acc: 0.667 Test Loss: 1.178 Test Acc: 0.667
Validation loss decreased (-0.543466 --> -0.666655).  Saving model ...
Epoch: 5 cost time: 0.7262294292449951
Epoch: 5, Steps: 9 | Train Loss: 1.061 Vali Loss: 1.076 Vali Acc: 0.739 Test Loss: 1.076 Test Acc: 0.739
Validation loss decreased (-0.666655 --> -0.739120).  Saving model ...
Epoch: 6 cost time: 0.6768202781677246
Epoch: 6, Steps: 9 | Train Loss: 0.952 Vali Loss: 0.979 Vali Acc: 0.754 Test Loss: 0.979 Test Acc: 0.754
Validation loss decreased (-0.739120 --> -0.753613).  Saving model ...
Epoch: 7 cost time: 0.8195791244506836
Epoch: 7, Steps: 9 | Train Loss: 0.824 Vali Loss: 0.867 Vali Acc: 0.783 Test Loss: 0.867 Test Acc: 0.783
Validation loss decreased (-0.753613 --> -0.782600).  Saving model ...
Epoch: 8 cost time: 0.7819881439208984
Epoch: 8, Steps: 9 | Train Loss: 0.714 Vali Loss: 0.758 Vali Acc: 0.790 Test Loss: 0.758 Test Acc: 0.790
Validation loss decreased (-0.782600 --> -0.789847).  Saving model ...
Epoch: 9 cost time: 0.7154204845428467
Epoch: 9, Steps: 9 | Train Loss: 0.586 Vali Loss: 0.669 Vali Acc: 0.804 Test Loss: 0.669 Test Acc: 0.804
Validation loss decreased (-0.789847 --> -0.804341).  Saving model ...
Epoch: 10 cost time: 0.7171001434326172
Epoch: 10, Steps: 9 | Train Loss: 0.484 Vali Loss: 0.587 Vali Acc: 0.819 Test Loss: 0.587 Test Acc: 0.819
Validation loss decreased (-0.804341 --> -0.818835).  Saving model ...
Epoch: 11 cost time: 0.7439968585968018
Epoch: 11, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.525 Vali Acc: 0.877 Test Loss: 0.525 Test Acc: 0.877
Validation loss decreased (-0.818835 --> -0.876806).  Saving model ...
Epoch: 12 cost time: 0.7282838821411133
Epoch: 12, Steps: 9 | Train Loss: 0.349 Vali Loss: 0.472 Vali Acc: 0.891 Test Loss: 0.472 Test Acc: 0.891
Validation loss decreased (-0.876806 --> -0.891300).  Saving model ...
Epoch: 13 cost time: 0.7173166275024414
Epoch: 13, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.438 Vali Acc: 0.877 Test Loss: 0.438 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7952351570129395
Epoch: 14, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.405 Vali Acc: 0.891 Test Loss: 0.405 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 15 cost time: 0.7096238136291504
Epoch: 15, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.395 Vali Acc: 0.877 Test Loss: 0.395 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6465599536895752
Epoch: 16, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.363 Vali Acc: 0.899 Test Loss: 0.363 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 17 cost time: 0.6550536155700684
Epoch: 17, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.339 Vali Acc: 0.899 Test Loss: 0.339 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 18 cost time: 0.8192965984344482
Epoch: 18, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.325 Vali Acc: 0.891 Test Loss: 0.325 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7243537902832031
Epoch: 19, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.312 Vali Acc: 0.899 Test Loss: 0.312 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898548).  Saving model ...
Epoch: 20 cost time: 0.7202639579772949
Epoch: 20, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.302 Vali Acc: 0.899 Test Loss: 0.302 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 21 cost time: 0.9381823539733887
Epoch: 21, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.283 Vali Acc: 0.906 Test Loss: 0.283 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 22 cost time: 0.7703256607055664
Epoch: 22, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.291 Vali Acc: 0.899 Test Loss: 0.291 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7571187019348145
Epoch: 23, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.304 Vali Acc: 0.899 Test Loss: 0.304 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7509889602661133
Epoch: 24, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.310 Vali Acc: 0.891 Test Loss: 0.310 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7139301300048828
Epoch: 25, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.295 Vali Acc: 0.899 Test Loss: 0.295 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7260081768035889
Epoch: 26, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.290 Vali Acc: 0.899 Test Loss: 0.290 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.820265531539917
Epoch: 27, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.279 Vali Acc: 0.906 Test Loss: 0.279 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 28 cost time: 0.7560560703277588
Epoch: 28, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.274 Vali Acc: 0.899 Test Loss: 0.274 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7889242172241211
Epoch: 29, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.269 Vali Acc: 0.899 Test Loss: 0.269 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7377195358276367
Epoch: 30, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 31 cost time: 0.8198678493499756
Epoch: 31, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.291 Vali Acc: 0.899 Test Loss: 0.291 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7618138790130615
Epoch: 32, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.299 Vali Acc: 0.899 Test Loss: 0.299 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.958561897277832
Epoch: 33, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.283 Vali Acc: 0.899 Test Loss: 0.283 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7598156929016113
Epoch: 34, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.275 Vali Acc: 0.899 Test Loss: 0.275 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6899740695953369
Epoch: 35, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.267 Vali Acc: 0.899 Test Loss: 0.267 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7593421936035156
Epoch: 36, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.262 Vali Acc: 0.906 Test Loss: 0.262 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 37 cost time: 0.8786964416503906
Epoch: 37, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.272 Vali Acc: 0.899 Test Loss: 0.272 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7457828521728516
Epoch: 38, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.263 Vali Acc: 0.899 Test Loss: 0.263 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7724020481109619
Epoch: 39, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.270 Vali Acc: 0.899 Test Loss: 0.270 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7853584289550781
Epoch: 40, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.267 Vali Acc: 0.899 Test Loss: 0.267 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7666294574737549
Epoch: 41, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.280 Vali Acc: 0.891 Test Loss: 0.280 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7414078712463379
Epoch: 42, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.283 Vali Acc: 0.899 Test Loss: 0.283 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8303179740905762
Epoch: 43, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.279 Vali Acc: 0.899 Test Loss: 0.279 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8611600399017334
Epoch: 44, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.273 Vali Acc: 0.899 Test Loss: 0.273 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8246395587921143
Epoch: 45, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.260 Vali Acc: 0.899 Test Loss: 0.260 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.7819218635559082
Epoch: 46, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.265 Vali Acc: 0.899 Test Loss: 0.265 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 183204
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1976470947265625
Epoch: 1, Steps: 9 | Train Loss: 1.423 Vali Loss: 1.380 Vali Acc: 0.355 Test Loss: 1.380 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 0.7033853530883789
Epoch: 2, Steps: 9 | Train Loss: 1.369 Vali Loss: 1.348 Vali Acc: 0.384 Test Loss: 1.348 Test Acc: 0.384
Validation loss decreased (-0.355059 --> -0.384044).  Saving model ...
Epoch: 3 cost time: 0.6837856769561768
Epoch: 3, Steps: 9 | Train Loss: 1.294 Vali Loss: 1.295 Vali Acc: 0.543 Test Loss: 1.295 Test Acc: 0.543
Validation loss decreased (-0.384044 --> -0.543465).  Saving model ...
Epoch: 4 cost time: 0.7332487106323242
Epoch: 4, Steps: 9 | Train Loss: 1.236 Vali Loss: 1.234 Vali Acc: 0.609 Test Loss: 1.234 Test Acc: 0.609
Validation loss decreased (-0.543465 --> -0.608683).  Saving model ...
Epoch: 5 cost time: 0.7376198768615723
Epoch: 5, Steps: 9 | Train Loss: 1.132 Vali Loss: 1.164 Vali Acc: 0.652 Test Loss: 1.164 Test Acc: 0.652
Validation loss decreased (-0.608683 --> -0.652162).  Saving model ...
Epoch: 6 cost time: 0.6873478889465332
Epoch: 6, Steps: 9 | Train Loss: 1.039 Vali Loss: 1.084 Vali Acc: 0.768 Test Loss: 1.084 Test Acc: 0.768
Validation loss decreased (-0.652162 --> -0.768105).  Saving model ...
Epoch: 7 cost time: 0.6657769680023193
Epoch: 7, Steps: 9 | Train Loss: 0.968 Vali Loss: 0.994 Vali Acc: 0.812 Test Loss: 0.994 Test Acc: 0.812
Validation loss decreased (-0.768105 --> -0.811584).  Saving model ...
Epoch: 8 cost time: 0.694979190826416
Epoch: 8, Steps: 9 | Train Loss: 0.861 Vali Loss: 0.906 Vali Acc: 0.768 Test Loss: 0.906 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6910803318023682
Epoch: 9, Steps: 9 | Train Loss: 0.741 Vali Loss: 0.810 Vali Acc: 0.826 Test Loss: 0.810 Test Acc: 0.826
Validation loss decreased (-0.811584 --> -0.826079).  Saving model ...
Epoch: 10 cost time: 0.7070353031158447
Epoch: 10, Steps: 9 | Train Loss: 0.638 Vali Loss: 0.721 Vali Acc: 0.812 Test Loss: 0.721 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7864503860473633
Epoch: 11, Steps: 9 | Train Loss: 0.549 Vali Loss: 0.655 Vali Acc: 0.826 Test Loss: 0.655 Test Acc: 0.826
Validation loss decreased (-0.826079 --> -0.826080).  Saving model ...
Epoch: 12 cost time: 0.679175853729248
Epoch: 12, Steps: 9 | Train Loss: 0.470 Vali Loss: 0.595 Vali Acc: 0.826 Test Loss: 0.595 Test Acc: 0.826
Validation loss decreased (-0.826080 --> -0.826081).  Saving model ...
Epoch: 13 cost time: 0.7279188632965088
Epoch: 13, Steps: 9 | Train Loss: 0.395 Vali Loss: 0.537 Vali Acc: 0.862 Test Loss: 0.537 Test Acc: 0.862
Validation loss decreased (-0.826081 --> -0.862313).  Saving model ...
Epoch: 14 cost time: 0.7072412967681885
Epoch: 14, Steps: 9 | Train Loss: 0.325 Vali Loss: 0.492 Vali Acc: 0.855 Test Loss: 0.492 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7339189052581787
Epoch: 15, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.459 Vali Acc: 0.877 Test Loss: 0.459 Test Acc: 0.877
Validation loss decreased (-0.862313 --> -0.876807).  Saving model ...
Epoch: 16 cost time: 0.6713278293609619
Epoch: 16, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.434 Vali Acc: 0.855 Test Loss: 0.434 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7278940677642822
Epoch: 17, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.424 Vali Acc: 0.870 Test Loss: 0.424 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7215797901153564
Epoch: 18, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.398 Vali Acc: 0.870 Test Loss: 0.398 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7386431694030762
Epoch: 19, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.383 Vali Acc: 0.862 Test Loss: 0.383 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.755490779876709
Epoch: 20, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.373 Vali Acc: 0.855 Test Loss: 0.373 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.756134033203125
Epoch: 21, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.377 Vali Acc: 0.884 Test Loss: 0.377 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 22 cost time: 0.7498421669006348
Epoch: 22, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.363 Vali Acc: 0.862 Test Loss: 0.363 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.738194465637207
Epoch: 23, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.356 Vali Acc: 0.862 Test Loss: 0.356 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7012708187103271
Epoch: 24, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.343 Vali Acc: 0.891 Test Loss: 0.343 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 25 cost time: 0.6581480503082275
Epoch: 25, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.341 Vali Acc: 0.877 Test Loss: 0.341 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7248392105102539
Epoch: 26, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.339 Vali Acc: 0.891 Test Loss: 0.339 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 27 cost time: 0.6875267028808594
Epoch: 27, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.341 Vali Acc: 0.884 Test Loss: 0.341 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7366127967834473
Epoch: 28, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.338 Vali Acc: 0.884 Test Loss: 0.338 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6753518581390381
Epoch: 29, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.331 Vali Acc: 0.891 Test Loss: 0.331 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 30 cost time: 0.6644914150238037
Epoch: 30, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.328 Vali Acc: 0.891 Test Loss: 0.328 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 31 cost time: 0.6416223049163818
Epoch: 31, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.335 Vali Acc: 0.891 Test Loss: 0.335 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.722588062286377
Epoch: 32, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.343 Vali Acc: 0.884 Test Loss: 0.343 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7231597900390625
Epoch: 33, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.329 Vali Acc: 0.884 Test Loss: 0.329 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.743880033493042
Epoch: 34, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.324 Vali Acc: 0.884 Test Loss: 0.324 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7715988159179688
Epoch: 35, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.349 Vali Acc: 0.884 Test Loss: 0.349 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7309036254882812
Epoch: 36, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.360 Vali Acc: 0.884 Test Loss: 0.360 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8071212768554688
Epoch: 37, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.317 Vali Acc: 0.891 Test Loss: 0.317 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 38 cost time: 0.7319722175598145
Epoch: 38, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.308 Vali Acc: 0.891 Test Loss: 0.308 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 39 cost time: 0.7589836120605469
Epoch: 39, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.319 Vali Acc: 0.899 Test Loss: 0.319 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 40 cost time: 0.7675354480743408
Epoch: 40, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.328 Vali Acc: 0.891 Test Loss: 0.328 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7511355876922607
Epoch: 41, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.329 Vali Acc: 0.891 Test Loss: 0.329 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7811403274536133
Epoch: 42, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.334 Vali Acc: 0.891 Test Loss: 0.334 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7666735649108887
Epoch: 43, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.346 Vali Acc: 0.884 Test Loss: 0.346 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7306466102600098
Epoch: 44, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.359 Vali Acc: 0.891 Test Loss: 0.359 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.690434455871582
Epoch: 45, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.341 Vali Acc: 0.891 Test Loss: 0.341 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7311344146728516
Epoch: 46, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.339 Vali Acc: 0.899 Test Loss: 0.339 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.7721679210662842
Epoch: 47, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.337 Vali Acc: 0.899 Test Loss: 0.337 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.717853307723999
Epoch: 48, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.341 Vali Acc: 0.884 Test Loss: 0.341 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.7420222759246826
Epoch: 49, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.337 Vali Acc: 0.891 Test Loss: 0.337 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 180292
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.116926431655884
Epoch: 1, Steps: 9 | Train Loss: 1.465 Vali Loss: 1.443 Vali Acc: 0.145 Test Loss: 1.443 Test Acc: 0.145
Validation loss decreased (inf --> -0.144913).  Saving model ...
Epoch: 2 cost time: 0.7553918361663818
Epoch: 2, Steps: 9 | Train Loss: 1.437 Vali Loss: 1.432 Vali Acc: 0.159 Test Loss: 1.432 Test Acc: 0.159
Validation loss decreased (-0.144913 --> -0.159406).  Saving model ...
Epoch: 3 cost time: 0.767615795135498
Epoch: 3, Steps: 9 | Train Loss: 1.387 Vali Loss: 1.399 Vali Acc: 0.217 Test Loss: 1.399 Test Acc: 0.217
Validation loss decreased (-0.159406 --> -0.217377).  Saving model ...
Epoch: 4 cost time: 0.7519242763519287
Epoch: 4, Steps: 9 | Train Loss: 1.317 Vali Loss: 1.347 Vali Acc: 0.391 Test Loss: 1.347 Test Acc: 0.391
Validation loss decreased (-0.217377 --> -0.391291).  Saving model ...
Epoch: 5 cost time: 0.6696147918701172
Epoch: 5, Steps: 9 | Train Loss: 1.251 Vali Loss: 1.288 Vali Acc: 0.478 Test Loss: 1.288 Test Acc: 0.478
Validation loss decreased (-0.391291 --> -0.478248).  Saving model ...
Epoch: 6 cost time: 0.6954975128173828
Epoch: 6, Steps: 9 | Train Loss: 1.173 Vali Loss: 1.223 Vali Acc: 0.543 Test Loss: 1.223 Test Acc: 0.543
Validation loss decreased (-0.478248 --> -0.543466).  Saving model ...
Epoch: 7 cost time: 0.716113805770874
Epoch: 7, Steps: 9 | Train Loss: 1.074 Vali Loss: 1.149 Vali Acc: 0.652 Test Loss: 1.149 Test Acc: 0.652
Validation loss decreased (-0.543466 --> -0.652162).  Saving model ...
Epoch: 8 cost time: 0.7667276859283447
Epoch: 8, Steps: 9 | Train Loss: 1.006 Vali Loss: 1.069 Vali Acc: 0.696 Test Loss: 1.069 Test Acc: 0.696
Validation loss decreased (-0.652162 --> -0.695641).  Saving model ...
Epoch: 9 cost time: 0.6768274307250977
Epoch: 9, Steps: 9 | Train Loss: 0.919 Vali Loss: 0.985 Vali Acc: 0.710 Test Loss: 0.985 Test Acc: 0.710
Validation loss decreased (-0.695641 --> -0.710135).  Saving model ...
Epoch: 10 cost time: 0.7442572116851807
Epoch: 10, Steps: 9 | Train Loss: 0.822 Vali Loss: 0.901 Vali Acc: 0.717 Test Loss: 0.901 Test Acc: 0.717
Validation loss decreased (-0.710135 --> -0.717382).  Saving model ...
Epoch: 11 cost time: 0.727839469909668
Epoch: 11, Steps: 9 | Train Loss: 0.726 Vali Loss: 0.819 Vali Acc: 0.775 Test Loss: 0.819 Test Acc: 0.775
Validation loss decreased (-0.717382 --> -0.775354).  Saving model ...
Epoch: 12 cost time: 0.6612961292266846
Epoch: 12, Steps: 9 | Train Loss: 0.628 Vali Loss: 0.758 Vali Acc: 0.754 Test Loss: 0.758 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7743489742279053
Epoch: 13, Steps: 9 | Train Loss: 0.576 Vali Loss: 0.701 Vali Acc: 0.775 Test Loss: 0.701 Test Acc: 0.775
Validation loss decreased (-0.775354 --> -0.775355).  Saving model ...
Epoch: 14 cost time: 0.7244102954864502
Epoch: 14, Steps: 9 | Train Loss: 0.482 Vali Loss: 0.645 Vali Acc: 0.797 Test Loss: 0.645 Test Acc: 0.797
Validation loss decreased (-0.775355 --> -0.797095).  Saving model ...
Epoch: 15 cost time: 0.7742986679077148
Epoch: 15, Steps: 9 | Train Loss: 0.451 Vali Loss: 0.610 Vali Acc: 0.783 Test Loss: 0.610 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7684216499328613
Epoch: 16, Steps: 9 | Train Loss: 0.381 Vali Loss: 0.575 Vali Acc: 0.804 Test Loss: 0.575 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804342).  Saving model ...
Epoch: 17 cost time: 0.7345688343048096
Epoch: 17, Steps: 9 | Train Loss: 0.342 Vali Loss: 0.539 Vali Acc: 0.812 Test Loss: 0.539 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811589).  Saving model ...
Epoch: 18 cost time: 0.7586584091186523
Epoch: 18, Steps: 9 | Train Loss: 0.286 Vali Loss: 0.509 Vali Acc: 0.833 Test Loss: 0.509 Test Acc: 0.833
Validation loss decreased (-0.811589 --> -0.833328).  Saving model ...
Epoch: 19 cost time: 0.7678413391113281
Epoch: 19, Steps: 9 | Train Loss: 0.252 Vali Loss: 0.498 Vali Acc: 0.826 Test Loss: 0.498 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6482491493225098
Epoch: 20, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.496 Vali Acc: 0.819 Test Loss: 0.496 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6532390117645264
Epoch: 21, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.485 Vali Acc: 0.819 Test Loss: 0.485 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7286980152130127
Epoch: 22, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.459 Vali Acc: 0.833 Test Loss: 0.459 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 23 cost time: 0.6817810535430908
Epoch: 23, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.436 Vali Acc: 0.841 Test Loss: 0.436 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 24 cost time: 0.7848021984100342
Epoch: 24, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.424 Vali Acc: 0.841 Test Loss: 0.424 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 25 cost time: 0.6540331840515137
Epoch: 25, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.409 Vali Acc: 0.841 Test Loss: 0.409 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840576).  Saving model ...
Epoch: 26 cost time: 0.7116239070892334
Epoch: 26, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.411 Vali Acc: 0.848 Test Loss: 0.411 Test Acc: 0.848
Validation loss decreased (-0.840576 --> -0.847822).  Saving model ...
Epoch: 27 cost time: 0.6778833866119385
Epoch: 27, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.413 Vali Acc: 0.841 Test Loss: 0.413 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7241044044494629
Epoch: 28, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.418 Vali Acc: 0.841 Test Loss: 0.418 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7001352310180664
Epoch: 29, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.403 Vali Acc: 0.848 Test Loss: 0.403 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 30 cost time: 0.664233922958374
Epoch: 30, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.400 Vali Acc: 0.841 Test Loss: 0.400 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6925275325775146
Epoch: 31, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.393 Vali Acc: 0.848 Test Loss: 0.393 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 32 cost time: 0.6970148086547852
Epoch: 32, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.408 Vali Acc: 0.841 Test Loss: 0.408 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7507200241088867
Epoch: 33, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.411 Vali Acc: 0.833 Test Loss: 0.411 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8135948181152344
Epoch: 34, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.397 Vali Acc: 0.848 Test Loss: 0.397 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7111337184906006
Epoch: 35, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.396 Vali Acc: 0.841 Test Loss: 0.396 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.696113109588623
Epoch: 36, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.405 Vali Acc: 0.841 Test Loss: 0.405 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.750145673751831
Epoch: 37, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.376 Vali Acc: 0.855 Test Loss: 0.376 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 38 cost time: 0.6864750385284424
Epoch: 38, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.366 Vali Acc: 0.848 Test Loss: 0.366 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6285302639007568
Epoch: 39, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.388 Vali Acc: 0.848 Test Loss: 0.388 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6390764713287354
Epoch: 40, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.431 Vali Acc: 0.841 Test Loss: 0.431 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6937007904052734
Epoch: 41, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.430 Vali Acc: 0.841 Test Loss: 0.430 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6531598567962646
Epoch: 42, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.405 Vali Acc: 0.855 Test Loss: 0.405 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6296865940093994
Epoch: 43, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.396 Vali Acc: 0.855 Test Loss: 0.396 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6385149955749512
Epoch: 44, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.398 Vali Acc: 0.855 Test Loss: 0.398 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.653935432434082
Epoch: 45, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.410 Vali Acc: 0.848 Test Loss: 0.410 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.7558526992797852
Epoch: 46, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.435 Vali Acc: 0.848 Test Loss: 0.435 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.6509153842926025
Epoch: 47, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.455 Vali Acc: 0.848 Test Loss: 0.455 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 177540
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0227210521698
Epoch: 1, Steps: 9 | Train Loss: 1.414 Vali Loss: 1.382 Vali Acc: 0.355 Test Loss: 1.382 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 0.7400627136230469
Epoch: 2, Steps: 9 | Train Loss: 1.370 Vali Loss: 1.361 Vali Acc: 0.399 Test Loss: 1.361 Test Acc: 0.399
Validation loss decreased (-0.355059 --> -0.398537).  Saving model ...
Epoch: 3 cost time: 0.6901535987854004
Epoch: 3, Steps: 9 | Train Loss: 1.326 Vali Loss: 1.323 Vali Acc: 0.449 Test Loss: 1.323 Test Acc: 0.449
Validation loss decreased (-0.398537 --> -0.449262).  Saving model ...
Epoch: 4 cost time: 0.6820869445800781
Epoch: 4, Steps: 9 | Train Loss: 1.280 Vali Loss: 1.271 Vali Acc: 0.493 Test Loss: 1.271 Test Acc: 0.493
Validation loss decreased (-0.449262 --> -0.492741).  Saving model ...
Epoch: 5 cost time: 0.7178993225097656
Epoch: 5, Steps: 9 | Train Loss: 1.223 Vali Loss: 1.209 Vali Acc: 0.565 Test Loss: 1.209 Test Acc: 0.565
Validation loss decreased (-0.492741 --> -0.565205).  Saving model ...
Epoch: 6 cost time: 0.7379369735717773
Epoch: 6, Steps: 9 | Train Loss: 1.121 Vali Loss: 1.142 Vali Acc: 0.587 Test Loss: 1.142 Test Acc: 0.587
Validation loss decreased (-0.565205 --> -0.586945).  Saving model ...
Epoch: 7 cost time: 0.6540000438690186
Epoch: 7, Steps: 9 | Train Loss: 1.037 Vali Loss: 1.074 Vali Acc: 0.674 Test Loss: 1.074 Test Acc: 0.674
Validation loss decreased (-0.586945 --> -0.673902).  Saving model ...
Epoch: 8 cost time: 0.7033340930938721
Epoch: 8, Steps: 9 | Train Loss: 0.972 Vali Loss: 1.001 Vali Acc: 0.754 Test Loss: 1.001 Test Acc: 0.754
Validation loss decreased (-0.673902 --> -0.753613).  Saving model ...
Epoch: 9 cost time: 0.7762589454650879
Epoch: 9, Steps: 9 | Train Loss: 0.859 Vali Loss: 0.930 Vali Acc: 0.761 Test Loss: 0.930 Test Acc: 0.761
Validation loss decreased (-0.753613 --> -0.760860).  Saving model ...
Epoch: 10 cost time: 0.7043473720550537
Epoch: 10, Steps: 9 | Train Loss: 0.782 Vali Loss: 0.861 Vali Acc: 0.775 Test Loss: 0.861 Test Acc: 0.775
Validation loss decreased (-0.760860 --> -0.775354).  Saving model ...
Epoch: 11 cost time: 0.7138528823852539
Epoch: 11, Steps: 9 | Train Loss: 0.693 Vali Loss: 0.796 Vali Acc: 0.746 Test Loss: 0.796 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7024762630462646
Epoch: 12, Steps: 9 | Train Loss: 0.612 Vali Loss: 0.734 Vali Acc: 0.775 Test Loss: 0.734 Test Acc: 0.775
Validation loss decreased (-0.775354 --> -0.775355).  Saving model ...
Epoch: 13 cost time: 0.8657922744750977
Epoch: 13, Steps: 9 | Train Loss: 0.535 Vali Loss: 0.685 Vali Acc: 0.790 Test Loss: 0.685 Test Acc: 0.790
Validation loss decreased (-0.775355 --> -0.789848).  Saving model ...
Epoch: 14 cost time: 0.7916240692138672
Epoch: 14, Steps: 9 | Train Loss: 0.490 Vali Loss: 0.645 Vali Acc: 0.826 Test Loss: 0.645 Test Acc: 0.826
Validation loss decreased (-0.789848 --> -0.826081).  Saving model ...
Epoch: 15 cost time: 0.8326592445373535
Epoch: 15, Steps: 9 | Train Loss: 0.415 Vali Loss: 0.602 Vali Acc: 0.833 Test Loss: 0.602 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 0.7158002853393555
Epoch: 16, Steps: 9 | Train Loss: 0.346 Vali Loss: 0.559 Vali Acc: 0.826 Test Loss: 0.559 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.767892599105835
Epoch: 17, Steps: 9 | Train Loss: 0.316 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833328).  Saving model ...
Epoch: 18 cost time: 0.6911346912384033
Epoch: 18, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 19 cost time: 0.7674953937530518
Epoch: 19, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.510 Vali Acc: 0.826 Test Loss: 0.510 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7301228046417236
Epoch: 20, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.492 Vali Acc: 0.833 Test Loss: 0.492 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7673976421356201
Epoch: 21, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.472 Vali Acc: 0.841 Test Loss: 0.472 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 22 cost time: 0.8319199085235596
Epoch: 22, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.463 Vali Acc: 0.833 Test Loss: 0.463 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7003281116485596
Epoch: 23, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.459 Vali Acc: 0.833 Test Loss: 0.459 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7378978729248047
Epoch: 24, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.464 Vali Acc: 0.841 Test Loss: 0.464 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 25 cost time: 0.7946300506591797
Epoch: 25, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.463 Vali Acc: 0.833 Test Loss: 0.463 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8113431930541992
Epoch: 26, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.448 Vali Acc: 0.841 Test Loss: 0.448 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 27 cost time: 0.627016544342041
Epoch: 27, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.454 Vali Acc: 0.833 Test Loss: 0.454 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8110804557800293
Epoch: 28, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.438 Vali Acc: 0.841 Test Loss: 0.438 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 29 cost time: 0.7913494110107422
Epoch: 29, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.454 Vali Acc: 0.841 Test Loss: 0.454 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8182861804962158
Epoch: 30, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.455 Vali Acc: 0.848 Test Loss: 0.455 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 31 cost time: 0.7568438053131104
Epoch: 31, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.430 Vali Acc: 0.841 Test Loss: 0.430 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7589802742004395
Epoch: 32, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.429 Vali Acc: 0.833 Test Loss: 0.429 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8678531646728516
Epoch: 33, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.455 Vali Acc: 0.826 Test Loss: 0.455 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8396520614624023
Epoch: 34, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.469 Vali Acc: 0.848 Test Loss: 0.469 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7756984233856201
Epoch: 35, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.480 Vali Acc: 0.833 Test Loss: 0.480 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8133130073547363
Epoch: 36, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.470 Vali Acc: 0.833 Test Loss: 0.470 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7580106258392334
Epoch: 37, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.477 Vali Acc: 0.826 Test Loss: 0.477 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8030259609222412
Epoch: 38, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.455 Vali Acc: 0.833 Test Loss: 0.455 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7230713367462158
Epoch: 39, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.479 Vali Acc: 0.848 Test Loss: 0.479 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7340257167816162
Epoch: 40, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.457 Vali Acc: 0.848 Test Loss: 0.457 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 177892
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1801111698150635
Epoch: 1, Steps: 9 | Train Loss: 1.446 Vali Loss: 1.381 Vali Acc: 0.283 Test Loss: 1.381 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 0.7424225807189941
Epoch: 2, Steps: 9 | Train Loss: 1.421 Vali Loss: 1.362 Vali Acc: 0.297 Test Loss: 1.362 Test Acc: 0.297
Validation loss decreased (-0.282595 --> -0.297088).  Saving model ...
Epoch: 3 cost time: 0.7841536998748779
Epoch: 3, Steps: 9 | Train Loss: 1.369 Vali Loss: 1.331 Vali Acc: 0.348 Test Loss: 1.331 Test Acc: 0.348
Validation loss decreased (-0.297088 --> -0.347813).  Saving model ...
Epoch: 4 cost time: 0.763634204864502
Epoch: 4, Steps: 9 | Train Loss: 1.321 Vali Loss: 1.293 Vali Acc: 0.399 Test Loss: 1.293 Test Acc: 0.399
Validation loss decreased (-0.347813 --> -0.398538).  Saving model ...
Epoch: 5 cost time: 0.7639780044555664
Epoch: 5, Steps: 9 | Train Loss: 1.247 Vali Loss: 1.246 Vali Acc: 0.507 Test Loss: 1.246 Test Acc: 0.507
Validation loss decreased (-0.398538 --> -0.507234).  Saving model ...
Epoch: 6 cost time: 0.7543740272521973
Epoch: 6, Steps: 9 | Train Loss: 1.194 Vali Loss: 1.192 Vali Acc: 0.551 Test Loss: 1.192 Test Acc: 0.551
Validation loss decreased (-0.507234 --> -0.550713).  Saving model ...
Epoch: 7 cost time: 0.6998753547668457
Epoch: 7, Steps: 9 | Train Loss: 1.120 Vali Loss: 1.139 Vali Acc: 0.587 Test Loss: 1.139 Test Acc: 0.587
Validation loss decreased (-0.550713 --> -0.586945).  Saving model ...
Epoch: 8 cost time: 0.8280463218688965
Epoch: 8, Steps: 9 | Train Loss: 1.038 Vali Loss: 1.078 Vali Acc: 0.630 Test Loss: 1.078 Test Acc: 0.630
Validation loss decreased (-0.586945 --> -0.630424).  Saving model ...
Epoch: 9 cost time: 0.7320365905761719
Epoch: 9, Steps: 9 | Train Loss: 0.959 Vali Loss: 1.013 Vali Acc: 0.638 Test Loss: 1.013 Test Acc: 0.638
Validation loss decreased (-0.630424 --> -0.637671).  Saving model ...
Epoch: 10 cost time: 0.7144131660461426
Epoch: 10, Steps: 9 | Train Loss: 0.889 Vali Loss: 0.949 Vali Acc: 0.674 Test Loss: 0.949 Test Acc: 0.674
Validation loss decreased (-0.637671 --> -0.673904).  Saving model ...
Epoch: 11 cost time: 0.7476744651794434
Epoch: 11, Steps: 9 | Train Loss: 0.804 Vali Loss: 0.894 Vali Acc: 0.703 Test Loss: 0.894 Test Acc: 0.703
Validation loss decreased (-0.673904 --> -0.702890).  Saving model ...
Epoch: 12 cost time: 0.7157409191131592
Epoch: 12, Steps: 9 | Train Loss: 0.719 Vali Loss: 0.840 Vali Acc: 0.681 Test Loss: 0.840 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8142943382263184
Epoch: 13, Steps: 9 | Train Loss: 0.657 Vali Loss: 0.792 Vali Acc: 0.710 Test Loss: 0.792 Test Acc: 0.710
Validation loss decreased (-0.702890 --> -0.710137).  Saving model ...
Epoch: 14 cost time: 0.6710762977600098
Epoch: 14, Steps: 9 | Train Loss: 0.595 Vali Loss: 0.755 Vali Acc: 0.710 Test Loss: 0.755 Test Acc: 0.710
Validation loss decreased (-0.710137 --> -0.710137).  Saving model ...
Epoch: 15 cost time: 0.7098383903503418
Epoch: 15, Steps: 9 | Train Loss: 0.548 Vali Loss: 0.721 Vali Acc: 0.725 Test Loss: 0.721 Test Acc: 0.725
Validation loss decreased (-0.710137 --> -0.724630).  Saving model ...
Epoch: 16 cost time: 0.7527174949645996
Epoch: 16, Steps: 9 | Train Loss: 0.478 Vali Loss: 0.689 Vali Acc: 0.746 Test Loss: 0.689 Test Acc: 0.746
Validation loss decreased (-0.724630 --> -0.746370).  Saving model ...
Epoch: 17 cost time: 0.6865642070770264
Epoch: 17, Steps: 9 | Train Loss: 0.454 Vali Loss: 0.641 Vali Acc: 0.739 Test Loss: 0.641 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6703879833221436
Epoch: 18, Steps: 9 | Train Loss: 0.373 Vali Loss: 0.630 Vali Acc: 0.754 Test Loss: 0.630 Test Acc: 0.754
Validation loss decreased (-0.746370 --> -0.753617).  Saving model ...
Epoch: 19 cost time: 0.7495584487915039
Epoch: 19, Steps: 9 | Train Loss: 0.344 Vali Loss: 0.613 Vali Acc: 0.761 Test Loss: 0.613 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760863).  Saving model ...
Epoch: 20 cost time: 0.7335293292999268
Epoch: 20, Steps: 9 | Train Loss: 0.319 Vali Loss: 0.589 Vali Acc: 0.768 Test Loss: 0.589 Test Acc: 0.768
Validation loss decreased (-0.760863 --> -0.768110).  Saving model ...
Epoch: 21 cost time: 0.6944265365600586
Epoch: 21, Steps: 9 | Train Loss: 0.290 Vali Loss: 0.577 Vali Acc: 0.761 Test Loss: 0.577 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8044812679290771
Epoch: 22, Steps: 9 | Train Loss: 0.266 Vali Loss: 0.558 Vali Acc: 0.768 Test Loss: 0.558 Test Acc: 0.768
Validation loss decreased (-0.768110 --> -0.768110).  Saving model ...
Epoch: 23 cost time: 0.7241904735565186
Epoch: 23, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.552 Vali Acc: 0.775 Test Loss: 0.552 Test Acc: 0.775
Validation loss decreased (-0.768110 --> -0.775357).  Saving model ...
Epoch: 24 cost time: 0.7093720436096191
Epoch: 24, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.541 Vali Acc: 0.768 Test Loss: 0.541 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7437839508056641
Epoch: 25, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.541 Vali Acc: 0.768 Test Loss: 0.541 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8008685111999512
Epoch: 26, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
Validation loss decreased (-0.775357 --> -0.782604).  Saving model ...
Epoch: 27 cost time: 0.7942564487457275
Epoch: 27, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.515 Vali Acc: 0.783 Test Loss: 0.515 Test Acc: 0.783
Validation loss decreased (-0.782604 --> -0.782604).  Saving model ...
Epoch: 28 cost time: 0.8301088809967041
Epoch: 28, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.531 Vali Acc: 0.768 Test Loss: 0.531 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7472453117370605
Epoch: 29, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.520 Vali Acc: 0.790 Test Loss: 0.520 Test Acc: 0.790
Validation loss decreased (-0.782604 --> -0.789850).  Saving model ...
Epoch: 30 cost time: 0.7412769794464111
Epoch: 30, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.515 Vali Acc: 0.783 Test Loss: 0.515 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7465991973876953
Epoch: 31, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.517 Vali Acc: 0.790 Test Loss: 0.517 Test Acc: 0.790
Validation loss decreased (-0.789850 --> -0.789850).  Saving model ...
Epoch: 32 cost time: 0.7019913196563721
Epoch: 32, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.515 Vali Acc: 0.790 Test Loss: 0.515 Test Acc: 0.790
Validation loss decreased (-0.789850 --> -0.789850).  Saving model ...
Epoch: 33 cost time: 0.7613871097564697
Epoch: 33, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.517 Vali Acc: 0.797 Test Loss: 0.517 Test Acc: 0.797
Validation loss decreased (-0.789850 --> -0.797096).  Saving model ...
Epoch: 34 cost time: 0.75494384765625
Epoch: 34, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.522 Vali Acc: 0.797 Test Loss: 0.522 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6937713623046875
Epoch: 35, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.489 Vali Acc: 0.812 Test Loss: 0.489 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811589).  Saving model ...
Epoch: 36 cost time: 0.7442507743835449
Epoch: 36, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.498 Vali Acc: 0.790 Test Loss: 0.498 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7626440525054932
Epoch: 37, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.503 Vali Acc: 0.804 Test Loss: 0.503 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7856135368347168
Epoch: 38, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.507 Vali Acc: 0.804 Test Loss: 0.507 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7326440811157227
Epoch: 39, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.509 Vali Acc: 0.804 Test Loss: 0.509 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7904534339904785
Epoch: 40, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.513 Vali Acc: 0.819 Test Loss: 0.513 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 41 cost time: 0.6815037727355957
Epoch: 41, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.534 Vali Acc: 0.819 Test Loss: 0.534 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7143731117248535
Epoch: 42, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.470 Vali Acc: 0.826 Test Loss: 0.470 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 43 cost time: 0.7223684787750244
Epoch: 43, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.507 Vali Acc: 0.804 Test Loss: 0.507 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.719576358795166
Epoch: 44, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.530 Vali Acc: 0.804 Test Loss: 0.530 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6651637554168701
Epoch: 45, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.505 Vali Acc: 0.804 Test Loss: 0.505 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6836898326873779
Epoch: 46, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.514 Vali Acc: 0.790 Test Loss: 0.514 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.7159590721130371
Epoch: 47, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.547 Vali Acc: 0.797 Test Loss: 0.547 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.8084456920623779
Epoch: 48, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.553 Vali Acc: 0.812 Test Loss: 0.553 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.7933924198150635
Epoch: 49, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.576 Vali Acc: 0.804 Test Loss: 0.576 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.7317097187042236
Epoch: 50, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.502 Vali Acc: 0.812 Test Loss: 0.502 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 176676
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.13435697555542
Epoch: 1, Steps: 9 | Train Loss: 1.369 Vali Loss: 1.338 Vali Acc: 0.370 Test Loss: 1.338 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 0.712477445602417
Epoch: 2, Steps: 9 | Train Loss: 1.254 Vali Loss: 1.247 Vali Acc: 0.652 Test Loss: 1.247 Test Acc: 0.652
Validation loss decreased (-0.369552 --> -0.652161).  Saving model ...
Epoch: 3 cost time: 0.7096984386444092
Epoch: 3, Steps: 9 | Train Loss: 1.107 Vali Loss: 1.120 Vali Acc: 0.703 Test Loss: 1.120 Test Acc: 0.703
Validation loss decreased (-0.652161 --> -0.702887).  Saving model ...
Epoch: 4 cost time: 0.7726523876190186
Epoch: 4, Steps: 9 | Train Loss: 0.949 Vali Loss: 0.945 Vali Acc: 0.775 Test Loss: 0.945 Test Acc: 0.775
Validation loss decreased (-0.702887 --> -0.775353).  Saving model ...
Epoch: 5 cost time: 0.7232844829559326
Epoch: 5, Steps: 9 | Train Loss: 0.756 Vali Loss: 0.780 Vali Acc: 0.790 Test Loss: 0.780 Test Acc: 0.790
Validation loss decreased (-0.775353 --> -0.789847).  Saving model ...
Epoch: 6 cost time: 0.7440941333770752
Epoch: 6, Steps: 9 | Train Loss: 0.590 Vali Loss: 0.629 Vali Acc: 0.841 Test Loss: 0.629 Test Acc: 0.841
Validation loss decreased (-0.789847 --> -0.840573).  Saving model ...
Epoch: 7 cost time: 0.6746478080749512
Epoch: 7, Steps: 9 | Train Loss: 0.441 Vali Loss: 0.484 Vali Acc: 0.870 Test Loss: 0.484 Test Acc: 0.870
Validation loss decreased (-0.840573 --> -0.869560).  Saving model ...
Epoch: 8 cost time: 0.7660942077636719
Epoch: 8, Steps: 9 | Train Loss: 0.300 Vali Loss: 0.385 Vali Acc: 0.899 Test Loss: 0.385 Test Acc: 0.899
Validation loss decreased (-0.869560 --> -0.898547).  Saving model ...
Epoch: 9 cost time: 0.6940171718597412
Epoch: 9, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.347 Vali Acc: 0.891 Test Loss: 0.347 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.689746618270874
Epoch: 10, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.291 Vali Acc: 0.913 Test Loss: 0.291 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913041).  Saving model ...
Epoch: 11 cost time: 0.6688013076782227
Epoch: 11, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.252 Vali Acc: 0.928 Test Loss: 0.252 Test Acc: 0.928
Validation loss decreased (-0.913041 --> -0.927534).  Saving model ...
Epoch: 12 cost time: 0.75887131690979
Epoch: 12, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.242 Vali Acc: 0.913 Test Loss: 0.242 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7298018932342529
Epoch: 13, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.250 Vali Acc: 0.913 Test Loss: 0.250 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.715623140335083
Epoch: 14, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.250 Vali Acc: 0.906 Test Loss: 0.250 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7475337982177734
Epoch: 15, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.227 Vali Acc: 0.906 Test Loss: 0.227 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7766628265380859
Epoch: 16, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.206 Vali Acc: 0.928 Test Loss: 0.206 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 17 cost time: 0.6615667343139648
Epoch: 17, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.242 Vali Acc: 0.913 Test Loss: 0.242 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7810547351837158
Epoch: 18, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.231 Vali Acc: 0.913 Test Loss: 0.231 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7344131469726562
Epoch: 19, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.202 Vali Acc: 0.920 Test Loss: 0.202 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7888891696929932
Epoch: 20, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.206 Vali Acc: 0.920 Test Loss: 0.206 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7704935073852539
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.220 Vali Acc: 0.920 Test Loss: 0.220 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8021187782287598
Epoch: 22, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.225 Vali Acc: 0.913 Test Loss: 0.225 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7573604583740234
Epoch: 23, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.218 Vali Acc: 0.920 Test Loss: 0.218 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6962518692016602
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.218 Vali Acc: 0.913 Test Loss: 0.218 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.697922945022583
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.220 Vali Acc: 0.913 Test Loss: 0.220 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7443087100982666
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.913 Test Loss: 0.220 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 195556
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.031153678894043
Epoch: 1, Steps: 9 | Train Loss: 1.416 Vali Loss: 1.368 Vali Acc: 0.319 Test Loss: 1.368 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 0.656282901763916
Epoch: 2, Steps: 9 | Train Loss: 1.365 Vali Loss: 1.323 Vali Acc: 0.464 Test Loss: 1.323 Test Acc: 0.464
Validation loss decreased (-0.318827 --> -0.463755).  Saving model ...
Epoch: 3 cost time: 0.7495541572570801
Epoch: 3, Steps: 9 | Train Loss: 1.284 Vali Loss: 1.246 Vali Acc: 0.572 Test Loss: 1.246 Test Acc: 0.572
Validation loss decreased (-0.463755 --> -0.572451).  Saving model ...
Epoch: 4 cost time: 0.8358404636383057
Epoch: 4, Steps: 9 | Train Loss: 1.161 Vali Loss: 1.144 Vali Acc: 0.732 Test Loss: 1.144 Test Acc: 0.732
Validation loss decreased (-0.572451 --> -0.731873).  Saving model ...
Epoch: 5 cost time: 0.712477445602417
Epoch: 5, Steps: 9 | Train Loss: 1.049 Vali Loss: 1.029 Vali Acc: 0.797 Test Loss: 1.029 Test Acc: 0.797
Validation loss decreased (-0.731873 --> -0.797091).  Saving model ...
Epoch: 6 cost time: 0.7184069156646729
Epoch: 6, Steps: 9 | Train Loss: 0.920 Vali Loss: 0.912 Vali Acc: 0.833 Test Loss: 0.912 Test Acc: 0.833
Validation loss decreased (-0.797091 --> -0.833324).  Saving model ...
Epoch: 7 cost time: 0.7663562297821045
Epoch: 7, Steps: 9 | Train Loss: 0.775 Vali Loss: 0.785 Vali Acc: 0.833 Test Loss: 0.785 Test Acc: 0.833
Validation loss decreased (-0.833324 --> -0.833325).  Saving model ...
Epoch: 8 cost time: 0.7409665584564209
Epoch: 8, Steps: 9 | Train Loss: 0.633 Vali Loss: 0.658 Vali Acc: 0.848 Test Loss: 0.658 Test Acc: 0.848
Validation loss decreased (-0.833325 --> -0.847820).  Saving model ...
Epoch: 9 cost time: 0.7923426628112793
Epoch: 9, Steps: 9 | Train Loss: 0.516 Vali Loss: 0.566 Vali Acc: 0.848 Test Loss: 0.566 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847820).  Saving model ...
Epoch: 10 cost time: 0.7457411289215088
Epoch: 10, Steps: 9 | Train Loss: 0.380 Vali Loss: 0.473 Vali Acc: 0.877 Test Loss: 0.473 Test Acc: 0.877
Validation loss decreased (-0.847820 --> -0.876807).  Saving model ...
Epoch: 11 cost time: 0.796886682510376
Epoch: 11, Steps: 9 | Train Loss: 0.306 Vali Loss: 0.415 Vali Acc: 0.891 Test Loss: 0.415 Test Acc: 0.891
Validation loss decreased (-0.876807 --> -0.891300).  Saving model ...
Epoch: 12 cost time: 0.7773480415344238
Epoch: 12, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.374 Vali Acc: 0.891 Test Loss: 0.374 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891301).  Saving model ...
Epoch: 13 cost time: 0.7367424964904785
Epoch: 13, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.339 Vali Acc: 0.913 Test Loss: 0.339 Test Acc: 0.913
Validation loss decreased (-0.891301 --> -0.913040).  Saving model ...
Epoch: 14 cost time: 0.7647087574005127
Epoch: 14, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.317 Vali Acc: 0.899 Test Loss: 0.317 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7167336940765381
Epoch: 15, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.295 Vali Acc: 0.913 Test Loss: 0.295 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913041).  Saving model ...
Epoch: 16 cost time: 0.7469422817230225
Epoch: 16, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.284 Vali Acc: 0.928 Test Loss: 0.284 Test Acc: 0.928
Validation loss decreased (-0.913041 --> -0.927533).  Saving model ...
Epoch: 17 cost time: 0.7969634532928467
Epoch: 17, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.265 Vali Acc: 0.913 Test Loss: 0.265 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8617136478424072
Epoch: 18, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.270 Vali Acc: 0.920 Test Loss: 0.270 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.766594409942627
Epoch: 19, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.261 Vali Acc: 0.906 Test Loss: 0.261 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7609493732452393
Epoch: 20, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.259 Vali Acc: 0.928 Test Loss: 0.259 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927534).  Saving model ...
Epoch: 21 cost time: 0.7493114471435547
Epoch: 21, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.260 Vali Acc: 0.913 Test Loss: 0.260 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6655473709106445
Epoch: 22, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.259 Vali Acc: 0.913 Test Loss: 0.259 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.765437126159668
Epoch: 23, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.244 Vali Acc: 0.928 Test Loss: 0.244 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 24 cost time: 0.7784976959228516
Epoch: 24, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.253 Vali Acc: 0.899 Test Loss: 0.253 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8325741291046143
Epoch: 25, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.246 Vali Acc: 0.906 Test Loss: 0.246 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7669956684112549
Epoch: 26, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.231 Vali Acc: 0.920 Test Loss: 0.231 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7403695583343506
Epoch: 27, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.238 Vali Acc: 0.906 Test Loss: 0.238 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7303955554962158
Epoch: 28, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.228 Vali Acc: 0.913 Test Loss: 0.228 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7381527423858643
Epoch: 29, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.230 Vali Acc: 0.913 Test Loss: 0.230 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7555513381958008
Epoch: 30, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.222 Vali Acc: 0.920 Test Loss: 0.222 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6372811794281006
Epoch: 31, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.216 Vali Acc: 0.913 Test Loss: 0.216 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6193912029266357
Epoch: 32, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.223 Vali Acc: 0.913 Test Loss: 0.223 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.581078290939331
Epoch: 33, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.234 Vali Acc: 0.913 Test Loss: 0.234 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 183428
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.046473264694214
Epoch: 1, Steps: 9 | Train Loss: 1.403 Vali Loss: 1.380 Vali Acc: 0.246 Test Loss: 1.380 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 0.6779236793518066
Epoch: 2, Steps: 9 | Train Loss: 1.339 Vali Loss: 1.345 Vali Acc: 0.370 Test Loss: 1.345 Test Acc: 0.370
Validation loss decreased (-0.246363 --> -0.369552).  Saving model ...
Epoch: 3 cost time: 0.6698868274688721
Epoch: 3, Steps: 9 | Train Loss: 1.258 Vali Loss: 1.285 Vali Acc: 0.486 Test Loss: 1.285 Test Acc: 0.486
Validation loss decreased (-0.369552 --> -0.485494).  Saving model ...
Epoch: 4 cost time: 0.7286181449890137
Epoch: 4, Steps: 9 | Train Loss: 1.170 Vali Loss: 1.199 Vali Acc: 0.580 Test Loss: 1.199 Test Acc: 0.580
Validation loss decreased (-0.485494 --> -0.579698).  Saving model ...
Epoch: 5 cost time: 0.6411514282226562
Epoch: 5, Steps: 9 | Train Loss: 1.055 Vali Loss: 1.100 Vali Acc: 0.623 Test Loss: 1.100 Test Acc: 0.623
Validation loss decreased (-0.579698 --> -0.623177).  Saving model ...
Epoch: 6 cost time: 0.6095049381256104
Epoch: 6, Steps: 9 | Train Loss: 0.954 Vali Loss: 0.993 Vali Acc: 0.659 Test Loss: 0.993 Test Acc: 0.659
Validation loss decreased (-0.623177 --> -0.659410).  Saving model ...
Epoch: 7 cost time: 0.671807050704956
Epoch: 7, Steps: 9 | Train Loss: 0.810 Vali Loss: 0.892 Vali Acc: 0.688 Test Loss: 0.892 Test Acc: 0.688
Validation loss decreased (-0.659410 --> -0.688397).  Saving model ...
Epoch: 8 cost time: 0.6350252628326416
Epoch: 8, Steps: 9 | Train Loss: 0.706 Vali Loss: 0.793 Vali Acc: 0.710 Test Loss: 0.793 Test Acc: 0.710
Validation loss decreased (-0.688397 --> -0.710137).  Saving model ...
Epoch: 9 cost time: 0.671379566192627
Epoch: 9, Steps: 9 | Train Loss: 0.609 Vali Loss: 0.702 Vali Acc: 0.739 Test Loss: 0.702 Test Acc: 0.739
Validation loss decreased (-0.710137 --> -0.739123).  Saving model ...
Epoch: 10 cost time: 0.6685059070587158
Epoch: 10, Steps: 9 | Train Loss: 0.479 Vali Loss: 0.635 Vali Acc: 0.775 Test Loss: 0.635 Test Acc: 0.775
Validation loss decreased (-0.739123 --> -0.775356).  Saving model ...
Epoch: 11 cost time: 0.7098209857940674
Epoch: 11, Steps: 9 | Train Loss: 0.390 Vali Loss: 0.571 Vali Acc: 0.797 Test Loss: 0.571 Test Acc: 0.797
Validation loss decreased (-0.775356 --> -0.797096).  Saving model ...
Epoch: 12 cost time: 0.6695425510406494
Epoch: 12, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.515 Vali Acc: 0.812 Test Loss: 0.515 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811589).  Saving model ...
Epoch: 13 cost time: 0.692835807800293
Epoch: 13, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.471 Vali Acc: 0.855 Test Loss: 0.471 Test Acc: 0.855
Validation loss decreased (-0.811589 --> -0.855068).  Saving model ...
Epoch: 14 cost time: 0.6870040893554688
Epoch: 14, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.442 Vali Acc: 0.870 Test Loss: 0.442 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 15 cost time: 0.7706129550933838
Epoch: 15, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.433 Vali Acc: 0.862 Test Loss: 0.433 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7258298397064209
Epoch: 16, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.427 Vali Acc: 0.862 Test Loss: 0.427 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7168991565704346
Epoch: 17, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.384 Vali Acc: 0.877 Test Loss: 0.384 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 18 cost time: 0.6820178031921387
Epoch: 18, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.373 Vali Acc: 0.884 Test Loss: 0.373 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 19 cost time: 0.704193115234375
Epoch: 19, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.351 Vali Acc: 0.884 Test Loss: 0.351 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 20 cost time: 0.6998357772827148
Epoch: 20, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.344 Vali Acc: 0.884 Test Loss: 0.344 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884055).  Saving model ...
Epoch: 21 cost time: 0.716242790222168
Epoch: 21, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.358 Vali Acc: 0.862 Test Loss: 0.358 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6509180068969727
Epoch: 22, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.320 Vali Acc: 0.891 Test Loss: 0.320 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 23 cost time: 0.7178306579589844
Epoch: 23, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.306 Vali Acc: 0.891 Test Loss: 0.306 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 24 cost time: 0.6721315383911133
Epoch: 24, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.332 Vali Acc: 0.899 Test Loss: 0.332 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 25 cost time: 0.7088243961334229
Epoch: 25, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.334 Vali Acc: 0.884 Test Loss: 0.334 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6835520267486572
Epoch: 26, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.313 Vali Acc: 0.891 Test Loss: 0.313 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7503354549407959
Epoch: 27, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.308 Vali Acc: 0.891 Test Loss: 0.308 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7022621631622314
Epoch: 28, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.307 Vali Acc: 0.891 Test Loss: 0.307 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6558852195739746
Epoch: 29, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.308 Vali Acc: 0.899 Test Loss: 0.308 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898548).  Saving model ...
Epoch: 30 cost time: 0.6940929889678955
Epoch: 30, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.310 Vali Acc: 0.891 Test Loss: 0.310 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6980957984924316
Epoch: 31, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.306 Vali Acc: 0.891 Test Loss: 0.306 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6686835289001465
Epoch: 32, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.323 Vali Acc: 0.884 Test Loss: 0.323 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6986129283905029
Epoch: 33, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.321 Vali Acc: 0.891 Test Loss: 0.321 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6696851253509521
Epoch: 34, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.321 Vali Acc: 0.884 Test Loss: 0.321 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7033565044403076
Epoch: 35, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.317 Vali Acc: 0.899 Test Loss: 0.317 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7073476314544678
Epoch: 36, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.299 Vali Acc: 0.899 Test Loss: 0.299 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 37 cost time: 0.6956310272216797
Epoch: 37, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.301 Vali Acc: 0.899 Test Loss: 0.301 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6781609058380127
Epoch: 38, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.298 Vali Acc: 0.899 Test Loss: 0.298 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 39 cost time: 0.6583375930786133
Epoch: 39, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.305 Vali Acc: 0.899 Test Loss: 0.305 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.672950029373169
Epoch: 40, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.316 Vali Acc: 0.891 Test Loss: 0.316 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7068071365356445
Epoch: 41, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.307 Vali Acc: 0.899 Test Loss: 0.307 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8576078414916992
Epoch: 42, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.292 Vali Acc: 0.899 Test Loss: 0.292 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 43 cost time: 0.7686078548431396
Epoch: 43, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.293 Vali Acc: 0.899 Test Loss: 0.293 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.740917444229126
Epoch: 44, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.286 Vali Acc: 0.906 Test Loss: 0.286 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 45 cost time: 0.9295506477355957
Epoch: 45, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.283 Vali Acc: 0.906 Test Loss: 0.283 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 46 cost time: 0.8605561256408691
Epoch: 46, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.293 Vali Acc: 0.899 Test Loss: 0.293 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9031925201416016
Epoch: 47, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.315 Vali Acc: 0.899 Test Loss: 0.315 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.728851318359375
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.326 Vali Acc: 0.891 Test Loss: 0.326 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7442944049835205
Epoch: 49, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.308 Vali Acc: 0.899 Test Loss: 0.308 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.7842512130737305
Epoch: 50, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.312 Vali Acc: 0.899 Test Loss: 0.312 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 180516
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.035726547241211
Epoch: 1, Steps: 9 | Train Loss: 1.405 Vali Loss: 1.398 Vali Acc: 0.290 Test Loss: 1.398 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 0.760533332824707
Epoch: 2, Steps: 9 | Train Loss: 1.369 Vali Loss: 1.379 Vali Acc: 0.297 Test Loss: 1.379 Test Acc: 0.297
Validation loss decreased (-0.289841 --> -0.297088).  Saving model ...
Epoch: 3 cost time: 0.8079156875610352
Epoch: 3, Steps: 9 | Train Loss: 1.305 Vali Loss: 1.338 Vali Acc: 0.362 Test Loss: 1.338 Test Acc: 0.362
Validation loss decreased (-0.297088 --> -0.362305).  Saving model ...
Epoch: 4 cost time: 0.7029902935028076
Epoch: 4, Steps: 9 | Train Loss: 1.234 Vali Loss: 1.277 Vali Acc: 0.471 Test Loss: 1.277 Test Acc: 0.471
Validation loss decreased (-0.362305 --> -0.471002).  Saving model ...
Epoch: 5 cost time: 0.7568957805633545
Epoch: 5, Steps: 9 | Train Loss: 1.148 Vali Loss: 1.203 Vali Acc: 0.594 Test Loss: 1.203 Test Acc: 0.594
Validation loss decreased (-0.471002 --> -0.594191).  Saving model ...
Epoch: 6 cost time: 0.703808069229126
Epoch: 6, Steps: 9 | Train Loss: 1.048 Vali Loss: 1.116 Vali Acc: 0.667 Test Loss: 1.116 Test Acc: 0.667
Validation loss decreased (-0.594191 --> -0.666656).  Saving model ...
Epoch: 7 cost time: 0.6893610954284668
Epoch: 7, Steps: 9 | Train Loss: 0.953 Vali Loss: 1.024 Vali Acc: 0.717 Test Loss: 1.024 Test Acc: 0.717
Validation loss decreased (-0.666656 --> -0.717381).  Saving model ...
Epoch: 8 cost time: 0.6813812255859375
Epoch: 8, Steps: 9 | Train Loss: 0.848 Vali Loss: 0.934 Vali Acc: 0.703 Test Loss: 0.934 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.69374680519104
Epoch: 9, Steps: 9 | Train Loss: 0.750 Vali Loss: 0.842 Vali Acc: 0.725 Test Loss: 0.842 Test Acc: 0.725
Validation loss decreased (-0.717381 --> -0.724629).  Saving model ...
Epoch: 10 cost time: 0.7071521282196045
Epoch: 10, Steps: 9 | Train Loss: 0.623 Vali Loss: 0.760 Vali Acc: 0.775 Test Loss: 0.760 Test Acc: 0.775
Validation loss decreased (-0.724629 --> -0.775355).  Saving model ...
Epoch: 11 cost time: 0.7962851524353027
Epoch: 11, Steps: 9 | Train Loss: 0.547 Vali Loss: 0.694 Vali Acc: 0.761 Test Loss: 0.694 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7630081176757812
Epoch: 12, Steps: 9 | Train Loss: 0.458 Vali Loss: 0.637 Vali Acc: 0.812 Test Loss: 0.637 Test Acc: 0.812
Validation loss decreased (-0.775355 --> -0.811588).  Saving model ...
Epoch: 13 cost time: 0.7763893604278564
Epoch: 13, Steps: 9 | Train Loss: 0.383 Vali Loss: 0.586 Vali Acc: 0.826 Test Loss: 0.586 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826081).  Saving model ...
Epoch: 14 cost time: 0.8579378128051758
Epoch: 14, Steps: 9 | Train Loss: 0.324 Vali Loss: 0.541 Vali Acc: 0.841 Test Loss: 0.541 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 15 cost time: 0.7425978183746338
Epoch: 15, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.501 Vali Acc: 0.848 Test Loss: 0.501 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 16 cost time: 0.7368984222412109
Epoch: 16, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.484 Vali Acc: 0.862 Test Loss: 0.484 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 17 cost time: 0.7030012607574463
Epoch: 17, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.461 Vali Acc: 0.855 Test Loss: 0.461 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7478528022766113
Epoch: 18, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.447 Vali Acc: 0.848 Test Loss: 0.447 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8124797344207764
Epoch: 19, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.423 Vali Acc: 0.855 Test Loss: 0.423 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7114629745483398
Epoch: 20, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.412 Vali Acc: 0.870 Test Loss: 0.412 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 21 cost time: 0.8319776058197021
Epoch: 21, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.403 Vali Acc: 0.855 Test Loss: 0.403 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8520162105560303
Epoch: 22, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.403 Vali Acc: 0.855 Test Loss: 0.403 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8076462745666504
Epoch: 23, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.396 Vali Acc: 0.855 Test Loss: 0.396 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7285928726196289
Epoch: 24, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.416 Vali Acc: 0.848 Test Loss: 0.416 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7772266864776611
Epoch: 25, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.418 Vali Acc: 0.855 Test Loss: 0.418 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7251274585723877
Epoch: 26, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.395 Vali Acc: 0.862 Test Loss: 0.395 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8478271961212158
Epoch: 27, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.394 Vali Acc: 0.862 Test Loss: 0.394 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7984845638275146
Epoch: 28, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.411 Vali Acc: 0.855 Test Loss: 0.411 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7327694892883301
Epoch: 29, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.398 Vali Acc: 0.877 Test Loss: 0.398 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 30 cost time: 0.8118071556091309
Epoch: 30, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.360 Vali Acc: 0.884 Test Loss: 0.360 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 31 cost time: 0.7425479888916016
Epoch: 31, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.374 Vali Acc: 0.877 Test Loss: 0.374 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7453653812408447
Epoch: 32, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.413 Vali Acc: 0.855 Test Loss: 0.413 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7290432453155518
Epoch: 33, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.412 Vali Acc: 0.855 Test Loss: 0.412 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7829415798187256
Epoch: 34, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.388 Vali Acc: 0.862 Test Loss: 0.388 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8258728981018066
Epoch: 35, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.379 Vali Acc: 0.870 Test Loss: 0.379 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7947995662689209
Epoch: 36, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.378 Vali Acc: 0.870 Test Loss: 0.378 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8588802814483643
Epoch: 37, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.366 Vali Acc: 0.877 Test Loss: 0.366 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8172605037689209
Epoch: 38, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.386 Vali Acc: 0.877 Test Loss: 0.386 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8209879398345947
Epoch: 39, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.423 Vali Acc: 0.855 Test Loss: 0.423 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8473844528198242
Epoch: 40, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.423 Vali Acc: 0.862 Test Loss: 0.423 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 177604
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.157193899154663
Epoch: 1, Steps: 9 | Train Loss: 1.414 Vali Loss: 1.389 Vali Acc: 0.261 Test Loss: 1.389 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 0.7078015804290771
Epoch: 2, Steps: 9 | Train Loss: 1.384 Vali Loss: 1.364 Vali Acc: 0.225 Test Loss: 1.364 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6922891139984131
Epoch: 3, Steps: 9 | Train Loss: 1.312 Vali Loss: 1.323 Vali Acc: 0.348 Test Loss: 1.323 Test Acc: 0.348
Validation loss decreased (-0.260856 --> -0.347813).  Saving model ...
Epoch: 4 cost time: 0.6865153312683105
Epoch: 4, Steps: 9 | Train Loss: 1.250 Vali Loss: 1.269 Vali Acc: 0.493 Test Loss: 1.269 Test Acc: 0.493
Validation loss decreased (-0.347813 --> -0.492741).  Saving model ...
Epoch: 5 cost time: 0.6917667388916016
Epoch: 5, Steps: 9 | Train Loss: 1.172 Vali Loss: 1.207 Vali Acc: 0.609 Test Loss: 1.207 Test Acc: 0.609
Validation loss decreased (-0.492741 --> -0.608684).  Saving model ...
Epoch: 6 cost time: 0.6390886306762695
Epoch: 6, Steps: 9 | Train Loss: 1.101 Vali Loss: 1.138 Vali Acc: 0.645 Test Loss: 1.138 Test Acc: 0.645
Validation loss decreased (-0.608684 --> -0.644916).  Saving model ...
Epoch: 7 cost time: 0.7640910148620605
Epoch: 7, Steps: 9 | Train Loss: 1.013 Vali Loss: 1.067 Vali Acc: 0.681 Test Loss: 1.067 Test Acc: 0.681
Validation loss decreased (-0.644916 --> -0.681149).  Saving model ...
Epoch: 8 cost time: 0.6934893131256104
Epoch: 8, Steps: 9 | Train Loss: 0.935 Vali Loss: 0.994 Vali Acc: 0.688 Test Loss: 0.994 Test Acc: 0.688
Validation loss decreased (-0.681149 --> -0.688396).  Saving model ...
Epoch: 9 cost time: 0.7462418079376221
Epoch: 9, Steps: 9 | Train Loss: 0.856 Vali Loss: 0.922 Vali Acc: 0.739 Test Loss: 0.922 Test Acc: 0.739
Validation loss decreased (-0.688396 --> -0.739121).  Saving model ...
Epoch: 10 cost time: 0.7035601139068604
Epoch: 10, Steps: 9 | Train Loss: 0.800 Vali Loss: 0.852 Vali Acc: 0.725 Test Loss: 0.852 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6355330944061279
Epoch: 11, Steps: 9 | Train Loss: 0.708 Vali Loss: 0.790 Vali Acc: 0.739 Test Loss: 0.790 Test Acc: 0.739
Validation loss decreased (-0.739121 --> -0.739123).  Saving model ...
Epoch: 12 cost time: 0.665973424911499
Epoch: 12, Steps: 9 | Train Loss: 0.640 Vali Loss: 0.724 Vali Acc: 0.797 Test Loss: 0.724 Test Acc: 0.797
Validation loss decreased (-0.739123 --> -0.797094).  Saving model ...
Epoch: 13 cost time: 0.6752715110778809
Epoch: 13, Steps: 9 | Train Loss: 0.559 Vali Loss: 0.674 Vali Acc: 0.812 Test Loss: 0.674 Test Acc: 0.812
Validation loss decreased (-0.797094 --> -0.811587).  Saving model ...
Epoch: 14 cost time: 0.7008724212646484
Epoch: 14, Steps: 9 | Train Loss: 0.489 Vali Loss: 0.628 Vali Acc: 0.812 Test Loss: 0.628 Test Acc: 0.812
Validation loss decreased (-0.811587 --> -0.811588).  Saving model ...
Epoch: 15 cost time: 0.7366049289703369
Epoch: 15, Steps: 9 | Train Loss: 0.449 Vali Loss: 0.590 Vali Acc: 0.826 Test Loss: 0.590 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826081).  Saving model ...
Epoch: 16 cost time: 0.6350796222686768
Epoch: 16, Steps: 9 | Train Loss: 0.375 Vali Loss: 0.560 Vali Acc: 0.841 Test Loss: 0.560 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 17 cost time: 0.654918909072876
Epoch: 17, Steps: 9 | Train Loss: 0.341 Vali Loss: 0.532 Vali Acc: 0.841 Test Loss: 0.532 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 18 cost time: 0.7226471900939941
Epoch: 18, Steps: 9 | Train Loss: 0.300 Vali Loss: 0.517 Vali Acc: 0.848 Test Loss: 0.517 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 19 cost time: 0.7763247489929199
Epoch: 19, Steps: 9 | Train Loss: 0.262 Vali Loss: 0.482 Vali Acc: 0.833 Test Loss: 0.482 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7396376132965088
Epoch: 20, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.473 Vali Acc: 0.826 Test Loss: 0.473 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7547287940979004
Epoch: 21, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.454 Vali Acc: 0.826 Test Loss: 0.454 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6987438201904297
Epoch: 22, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.446 Vali Acc: 0.826 Test Loss: 0.446 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7525675296783447
Epoch: 23, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.457 Vali Acc: 0.819 Test Loss: 0.457 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7167351245880127
Epoch: 24, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.449 Vali Acc: 0.819 Test Loss: 0.449 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7186493873596191
Epoch: 25, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.412 Vali Acc: 0.826 Test Loss: 0.412 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7582309246063232
Epoch: 26, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.409 Vali Acc: 0.826 Test Loss: 0.409 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7322719097137451
Epoch: 27, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.421 Vali Acc: 0.841 Test Loss: 0.421 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7556326389312744
Epoch: 28, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.414 Vali Acc: 0.826 Test Loss: 0.414 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 174852
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.277602195739746
Epoch: 1, Steps: 9 | Train Loss: 1.456 Vali Loss: 1.399 Vali Acc: 0.196 Test Loss: 1.399 Test Acc: 0.196
Validation loss decreased (inf --> -0.195638).  Saving model ...
Epoch: 2 cost time: 0.6350929737091064
Epoch: 2, Steps: 9 | Train Loss: 1.415 Vali Loss: 1.378 Vali Acc: 0.239 Test Loss: 1.378 Test Acc: 0.239
Validation loss decreased (-0.195638 --> -0.239117).  Saving model ...
Epoch: 3 cost time: 0.7152891159057617
Epoch: 3, Steps: 9 | Train Loss: 1.396 Vali Loss: 1.341 Vali Acc: 0.348 Test Loss: 1.341 Test Acc: 0.348
Validation loss decreased (-0.239117 --> -0.347813).  Saving model ...
Epoch: 4 cost time: 0.6447064876556396
Epoch: 4, Steps: 9 | Train Loss: 1.307 Vali Loss: 1.291 Vali Acc: 0.500 Test Loss: 1.291 Test Acc: 0.500
Validation loss decreased (-0.347813 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 0.6745977401733398
Epoch: 5, Steps: 9 | Train Loss: 1.243 Vali Loss: 1.237 Vali Acc: 0.580 Test Loss: 1.237 Test Acc: 0.580
Validation loss decreased (-0.499987 --> -0.579698).  Saving model ...
Epoch: 6 cost time: 0.7043275833129883
Epoch: 6, Steps: 9 | Train Loss: 1.178 Vali Loss: 1.174 Vali Acc: 0.645 Test Loss: 1.174 Test Acc: 0.645
Validation loss decreased (-0.579698 --> -0.644916).  Saving model ...
Epoch: 7 cost time: 0.6661193370819092
Epoch: 7, Steps: 9 | Train Loss: 1.079 Vali Loss: 1.111 Vali Acc: 0.717 Test Loss: 1.111 Test Acc: 0.717
Validation loss decreased (-0.644916 --> -0.717380).  Saving model ...
Epoch: 8 cost time: 0.6453452110290527
Epoch: 8, Steps: 9 | Train Loss: 0.987 Vali Loss: 1.041 Vali Acc: 0.688 Test Loss: 1.041 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6897284984588623
Epoch: 9, Steps: 9 | Train Loss: 0.932 Vali Loss: 0.959 Vali Acc: 0.710 Test Loss: 0.959 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6945106983184814
Epoch: 10, Steps: 9 | Train Loss: 0.820 Vali Loss: 0.886 Vali Acc: 0.746 Test Loss: 0.886 Test Acc: 0.746
Validation loss decreased (-0.717380 --> -0.746368).  Saving model ...
Epoch: 11 cost time: 0.6530511379241943
Epoch: 11, Steps: 9 | Train Loss: 0.743 Vali Loss: 0.815 Vali Acc: 0.746 Test Loss: 0.815 Test Acc: 0.746
Validation loss decreased (-0.746368 --> -0.746369).  Saving model ...
Epoch: 12 cost time: 0.7134912014007568
Epoch: 12, Steps: 9 | Train Loss: 0.644 Vali Loss: 0.757 Vali Acc: 0.790 Test Loss: 0.757 Test Acc: 0.790
Validation loss decreased (-0.746369 --> -0.789847).  Saving model ...
Epoch: 13 cost time: 0.7043509483337402
Epoch: 13, Steps: 9 | Train Loss: 0.557 Vali Loss: 0.707 Vali Acc: 0.775 Test Loss: 0.707 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6852777004241943
Epoch: 14, Steps: 9 | Train Loss: 0.493 Vali Loss: 0.655 Vali Acc: 0.804 Test Loss: 0.655 Test Acc: 0.804
Validation loss decreased (-0.789847 --> -0.804341).  Saving model ...
Epoch: 15 cost time: 0.7192103862762451
Epoch: 15, Steps: 9 | Train Loss: 0.420 Vali Loss: 0.613 Vali Acc: 0.804 Test Loss: 0.613 Test Acc: 0.804
Validation loss decreased (-0.804341 --> -0.804342).  Saving model ...
Epoch: 16 cost time: 0.6631476879119873
Epoch: 16, Steps: 9 | Train Loss: 0.369 Vali Loss: 0.595 Vali Acc: 0.797 Test Loss: 0.595 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7151060104370117
Epoch: 17, Steps: 9 | Train Loss: 0.325 Vali Loss: 0.556 Vali Acc: 0.826 Test Loss: 0.556 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826081).  Saving model ...
Epoch: 18 cost time: 0.645442008972168
Epoch: 18, Steps: 9 | Train Loss: 0.266 Vali Loss: 0.534 Vali Acc: 0.826 Test Loss: 0.534 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826082).  Saving model ...
Epoch: 19 cost time: 0.6875355243682861
Epoch: 19, Steps: 9 | Train Loss: 0.232 Vali Loss: 0.518 Vali Acc: 0.833 Test Loss: 0.518 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 20 cost time: 0.6653225421905518
Epoch: 20, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.511 Vali Acc: 0.833 Test Loss: 0.511 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 21 cost time: 0.618471622467041
Epoch: 21, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.492 Vali Acc: 0.841 Test Loss: 0.492 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 22 cost time: 0.6079998016357422
Epoch: 22, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.486 Vali Acc: 0.841 Test Loss: 0.486 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 23 cost time: 0.5904977321624756
Epoch: 23, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.458 Vali Acc: 0.841 Test Loss: 0.458 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 24 cost time: 0.6772506237030029
Epoch: 24, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.447 Vali Acc: 0.841 Test Loss: 0.447 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 25 cost time: 0.6650593280792236
Epoch: 25, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.432 Vali Acc: 0.848 Test Loss: 0.432 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 26 cost time: 0.6681609153747559
Epoch: 26, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.455 Vali Acc: 0.841 Test Loss: 0.455 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6813943386077881
Epoch: 27, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.453 Vali Acc: 0.841 Test Loss: 0.453 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7080602645874023
Epoch: 28, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.453 Vali Acc: 0.833 Test Loss: 0.453 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6757781505584717
Epoch: 29, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.455 Vali Acc: 0.848 Test Loss: 0.455 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6360437870025635
Epoch: 30, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.461 Vali Acc: 0.841 Test Loss: 0.461 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.664315938949585
Epoch: 31, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.441 Vali Acc: 0.841 Test Loss: 0.441 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6911900043487549
Epoch: 32, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.451 Vali Acc: 0.833 Test Loss: 0.451 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6632826328277588
Epoch: 33, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.447 Vali Acc: 0.848 Test Loss: 0.447 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6672260761260986
Epoch: 34, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.437 Vali Acc: 0.841 Test Loss: 0.437 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6614696979522705
Epoch: 35, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.451 Vali Acc: 0.841 Test Loss: 0.451 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 175204
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.925924301147461
Epoch: 1, Steps: 9 | Train Loss: 1.407 Vali Loss: 1.358 Vali Acc: 0.435 Test Loss: 1.358 Test Acc: 0.435
Validation loss decreased (inf --> -0.434769).  Saving model ...
Epoch: 2 cost time: 0.6859056949615479
Epoch: 2, Steps: 9 | Train Loss: 1.377 Vali Loss: 1.338 Vali Acc: 0.406 Test Loss: 1.338 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7367699146270752
Epoch: 3, Steps: 9 | Train Loss: 1.334 Vali Loss: 1.305 Vali Acc: 0.486 Test Loss: 1.305 Test Acc: 0.486
Validation loss decreased (-0.434769 --> -0.485494).  Saving model ...
Epoch: 4 cost time: 0.7141783237457275
Epoch: 4, Steps: 9 | Train Loss: 1.282 Vali Loss: 1.262 Vali Acc: 0.507 Test Loss: 1.262 Test Acc: 0.507
Validation loss decreased (-0.485494 --> -0.507234).  Saving model ...
Epoch: 5 cost time: 0.6820242404937744
Epoch: 5, Steps: 9 | Train Loss: 1.217 Vali Loss: 1.217 Vali Acc: 0.536 Test Loss: 1.217 Test Acc: 0.536
Validation loss decreased (-0.507234 --> -0.536220).  Saving model ...
Epoch: 6 cost time: 0.7024362087249756
Epoch: 6, Steps: 9 | Train Loss: 1.155 Vali Loss: 1.162 Vali Acc: 0.587 Test Loss: 1.162 Test Acc: 0.587
Validation loss decreased (-0.536220 --> -0.586945).  Saving model ...
Epoch: 7 cost time: 0.7358274459838867
Epoch: 7, Steps: 9 | Train Loss: 1.085 Vali Loss: 1.107 Vali Acc: 0.645 Test Loss: 1.107 Test Acc: 0.645
Validation loss decreased (-0.586945 --> -0.644916).  Saving model ...
Epoch: 8 cost time: 0.7019064426422119
Epoch: 8, Steps: 9 | Train Loss: 1.001 Vali Loss: 1.051 Vali Acc: 0.667 Test Loss: 1.051 Test Acc: 0.667
Validation loss decreased (-0.644916 --> -0.666656).  Saving model ...
Epoch: 9 cost time: 0.6612331867218018
Epoch: 9, Steps: 9 | Train Loss: 0.924 Vali Loss: 0.985 Vali Acc: 0.681 Test Loss: 0.985 Test Acc: 0.681
Validation loss decreased (-0.666656 --> -0.681150).  Saving model ...
Epoch: 10 cost time: 0.7028565406799316
Epoch: 10, Steps: 9 | Train Loss: 0.843 Vali Loss: 0.922 Vali Acc: 0.688 Test Loss: 0.922 Test Acc: 0.688
Validation loss decreased (-0.681150 --> -0.688397).  Saving model ...
Epoch: 11 cost time: 0.68243408203125
Epoch: 11, Steps: 9 | Train Loss: 0.778 Vali Loss: 0.865 Vali Acc: 0.710 Test Loss: 0.865 Test Acc: 0.710
Validation loss decreased (-0.688397 --> -0.710136).  Saving model ...
Epoch: 12 cost time: 0.6808645725250244
Epoch: 12, Steps: 9 | Train Loss: 0.734 Vali Loss: 0.817 Vali Acc: 0.717 Test Loss: 0.817 Test Acc: 0.717
Validation loss decreased (-0.710136 --> -0.717383).  Saving model ...
Epoch: 13 cost time: 0.7895646095275879
Epoch: 13, Steps: 9 | Train Loss: 0.626 Vali Loss: 0.771 Vali Acc: 0.717 Test Loss: 0.771 Test Acc: 0.717
Validation loss decreased (-0.717383 --> -0.717384).  Saving model ...
Epoch: 14 cost time: 0.7041032314300537
Epoch: 14, Steps: 9 | Train Loss: 0.562 Vali Loss: 0.732 Vali Acc: 0.754 Test Loss: 0.732 Test Acc: 0.754
Validation loss decreased (-0.717384 --> -0.753616).  Saving model ...
Epoch: 15 cost time: 0.7215352058410645
Epoch: 15, Steps: 9 | Train Loss: 0.515 Vali Loss: 0.694 Vali Acc: 0.783 Test Loss: 0.694 Test Acc: 0.783
Validation loss decreased (-0.753616 --> -0.782602).  Saving model ...
Epoch: 16 cost time: 0.6859581470489502
Epoch: 16, Steps: 9 | Train Loss: 0.438 Vali Loss: 0.661 Vali Acc: 0.775 Test Loss: 0.661 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6853008270263672
Epoch: 17, Steps: 9 | Train Loss: 0.395 Vali Loss: 0.637 Vali Acc: 0.797 Test Loss: 0.637 Test Acc: 0.797
Validation loss decreased (-0.782602 --> -0.797095).  Saving model ...
Epoch: 18 cost time: 0.699009895324707
Epoch: 18, Steps: 9 | Train Loss: 0.351 Vali Loss: 0.629 Vali Acc: 0.775 Test Loss: 0.629 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6893064975738525
Epoch: 19, Steps: 9 | Train Loss: 0.320 Vali Loss: 0.609 Vali Acc: 0.790 Test Loss: 0.609 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7576243877410889
Epoch: 20, Steps: 9 | Train Loss: 0.297 Vali Loss: 0.574 Vali Acc: 0.812 Test Loss: 0.574 Test Acc: 0.812
Validation loss decreased (-0.797095 --> -0.811588).  Saving model ...
Epoch: 21 cost time: 0.7092788219451904
Epoch: 21, Steps: 9 | Train Loss: 0.258 Vali Loss: 0.557 Vali Acc: 0.812 Test Loss: 0.557 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811589).  Saving model ...
Epoch: 22 cost time: 0.73293137550354
Epoch: 22, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.564 Vali Acc: 0.797 Test Loss: 0.564 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7946610450744629
Epoch: 23, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.550 Vali Acc: 0.804 Test Loss: 0.550 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6954512596130371
Epoch: 24, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.543 Vali Acc: 0.804 Test Loss: 0.543 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6835002899169922
Epoch: 25, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.555 Vali Acc: 0.797 Test Loss: 0.555 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7053313255310059
Epoch: 26, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.753340482711792
Epoch: 27, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.543 Vali Acc: 0.804 Test Loss: 0.543 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6889252662658691
Epoch: 28, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.541 Vali Acc: 0.797 Test Loss: 0.541 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.751157283782959
Epoch: 29, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.550 Vali Acc: 0.790 Test Loss: 0.550 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.719099760055542
Epoch: 30, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.558 Vali Acc: 0.790 Test Loss: 0.558 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7337393760681152
Epoch: 31, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.538 Vali Acc: 0.797 Test Loss: 0.538 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 173988
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.137716054916382
Epoch: 1, Steps: 9 | Train Loss: 1.375 Vali Loss: 1.270 Vali Acc: 0.471 Test Loss: 1.270 Test Acc: 0.471
Validation loss decreased (inf --> -0.471002).  Saving model ...
Epoch: 2 cost time: 0.8276903629302979
Epoch: 2, Steps: 9 | Train Loss: 1.039 Vali Loss: 0.979 Vali Acc: 0.717 Test Loss: 0.979 Test Acc: 0.717
Validation loss decreased (-0.471002 --> -0.717382).  Saving model ...
Epoch: 3 cost time: 0.8569498062133789
Epoch: 3, Steps: 9 | Train Loss: 0.615 Vali Loss: 0.653 Vali Acc: 0.826 Test Loss: 0.653 Test Acc: 0.826
Validation loss decreased (-0.717382 --> -0.826080).  Saving model ...
Epoch: 4 cost time: 0.8306350708007812
Epoch: 4, Steps: 9 | Train Loss: 0.351 Vali Loss: 0.400 Vali Acc: 0.877 Test Loss: 0.400 Test Acc: 0.877
Validation loss decreased (-0.826080 --> -0.876808).  Saving model ...
Epoch: 5 cost time: 0.8920507431030273
Epoch: 5, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.243 Vali Acc: 0.957 Test Loss: 0.243 Test Acc: 0.957
Validation loss decreased (-0.876808 --> -0.956519).  Saving model ...
Epoch: 6 cost time: 0.8921942710876465
Epoch: 6, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.227 Vali Acc: 0.935 Test Loss: 0.227 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8116741180419922
Epoch: 7, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9065377712249756
Epoch: 8, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8818693161010742
Epoch: 9, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8411574363708496
Epoch: 10, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8115777969360352
Epoch: 11, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.220 Vali Acc: 0.920 Test Loss: 0.220 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8085451126098633
Epoch: 12, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.217 Vali Acc: 0.928 Test Loss: 0.217 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7740042209625244
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.920 Test Loss: 0.202 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7466495037078857
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.935 Test Loss: 0.181 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8198308944702148
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.935 Test Loss: 0.179 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9565217391304348
model parameter : 700804
model size : 2.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9875538349151611
Epoch: 1, Steps: 9 | Train Loss: 1.351 Vali Loss: 1.301 Vali Acc: 0.486 Test Loss: 1.301 Test Acc: 0.486
Validation loss decreased (inf --> -0.485494).  Saving model ...
Epoch: 2 cost time: 0.7103793621063232
Epoch: 2, Steps: 9 | Train Loss: 1.174 Vali Loss: 1.101 Vali Acc: 0.688 Test Loss: 1.101 Test Acc: 0.688
Validation loss decreased (-0.485494 --> -0.688395).  Saving model ...
Epoch: 3 cost time: 0.7088401317596436
Epoch: 3, Steps: 9 | Train Loss: 0.869 Vali Loss: 0.858 Vali Acc: 0.833 Test Loss: 0.858 Test Acc: 0.833
Validation loss decreased (-0.688395 --> -0.833325).  Saving model ...
Epoch: 4 cost time: 0.6943514347076416
Epoch: 4, Steps: 9 | Train Loss: 0.591 Vali Loss: 0.616 Vali Acc: 0.884 Test Loss: 0.616 Test Acc: 0.884
Validation loss decreased (-0.833325 --> -0.884052).  Saving model ...
Epoch: 5 cost time: 0.7333412170410156
Epoch: 5, Steps: 9 | Train Loss: 0.380 Vali Loss: 0.446 Vali Acc: 0.870 Test Loss: 0.446 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7555737495422363
Epoch: 6, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.309 Vali Acc: 0.920 Test Loss: 0.309 Test Acc: 0.920
Validation loss decreased (-0.884052 --> -0.920287).  Saving model ...
Epoch: 7 cost time: 0.7322025299072266
Epoch: 7, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.264 Vali Acc: 0.906 Test Loss: 0.264 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6990871429443359
Epoch: 8, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.241 Vali Acc: 0.920 Test Loss: 0.241 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 9 cost time: 0.7115111351013184
Epoch: 9, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.203 Vali Acc: 0.942 Test Loss: 0.203 Test Acc: 0.942
Validation loss decreased (-0.920287 --> -0.942027).  Saving model ...
Epoch: 10 cost time: 0.7518866062164307
Epoch: 10, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.254 Vali Acc: 0.920 Test Loss: 0.254 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7225193977355957
Epoch: 11, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.239 Vali Acc: 0.928 Test Loss: 0.239 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7553188800811768
Epoch: 12, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.221 Vali Acc: 0.928 Test Loss: 0.221 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7544848918914795
Epoch: 13, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.232 Vali Acc: 0.913 Test Loss: 0.232 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.715735673904419
Epoch: 14, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.240 Vali Acc: 0.906 Test Loss: 0.240 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7054412364959717
Epoch: 15, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.219 Vali Acc: 0.920 Test Loss: 0.219 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7133946418762207
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.920 Test Loss: 0.196 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7669558525085449
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.185 Vali Acc: 0.928 Test Loss: 0.185 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7225470542907715
Epoch: 18, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.221 Vali Acc: 0.928 Test Loss: 0.221 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7859101295471191
Epoch: 19, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.242 Vali Acc: 0.928 Test Loss: 0.242 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 649220
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.2502472400665283
Epoch: 1, Steps: 9 | Train Loss: 1.383 Vali Loss: 1.350 Vali Acc: 0.333 Test Loss: 1.350 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.8584122657775879
Epoch: 2, Steps: 9 | Train Loss: 1.204 Vali Loss: 1.189 Vali Acc: 0.580 Test Loss: 1.189 Test Acc: 0.580
Validation loss decreased (-0.333320 --> -0.579698).  Saving model ...
Epoch: 3 cost time: 0.6995944976806641
Epoch: 3, Steps: 9 | Train Loss: 0.952 Vali Loss: 0.979 Vali Acc: 0.739 Test Loss: 0.979 Test Acc: 0.739
Validation loss decreased (-0.579698 --> -0.739121).  Saving model ...
Epoch: 4 cost time: 0.7045364379882812
Epoch: 4, Steps: 9 | Train Loss: 0.708 Vali Loss: 0.755 Vali Acc: 0.812 Test Loss: 0.755 Test Acc: 0.812
Validation loss decreased (-0.739121 --> -0.811587).  Saving model ...
Epoch: 5 cost time: 0.8106591701507568
Epoch: 5, Steps: 9 | Train Loss: 0.473 Vali Loss: 0.563 Vali Acc: 0.826 Test Loss: 0.563 Test Acc: 0.826
Validation loss decreased (-0.811587 --> -0.826081).  Saving model ...
Epoch: 6 cost time: 0.7627289295196533
Epoch: 6, Steps: 9 | Train Loss: 0.296 Vali Loss: 0.430 Vali Acc: 0.899 Test Loss: 0.430 Test Acc: 0.899
Validation loss decreased (-0.826081 --> -0.898546).  Saving model ...
Epoch: 7 cost time: 0.7882828712463379
Epoch: 7, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.362 Vali Acc: 0.877 Test Loss: 0.362 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7419171333312988
Epoch: 8, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.321 Vali Acc: 0.891 Test Loss: 0.321 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7176189422607422
Epoch: 9, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.296 Vali Acc: 0.899 Test Loss: 0.296 Test Acc: 0.899
Validation loss decreased (-0.898546 --> -0.898548).  Saving model ...
Epoch: 10 cost time: 0.7255146503448486
Epoch: 10, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.312 Vali Acc: 0.884 Test Loss: 0.312 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7071473598480225
Epoch: 11, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.285 Vali Acc: 0.899 Test Loss: 0.285 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 12 cost time: 0.7534024715423584
Epoch: 12, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.275 Vali Acc: 0.906 Test Loss: 0.275 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 13 cost time: 0.7294540405273438
Epoch: 13, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.286 Vali Acc: 0.899 Test Loss: 0.286 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6655092239379883
Epoch: 14, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.299 Vali Acc: 0.891 Test Loss: 0.299 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6956679821014404
Epoch: 15, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.296 Vali Acc: 0.899 Test Loss: 0.296 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6348404884338379
Epoch: 16, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.284 Vali Acc: 0.899 Test Loss: 0.284 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7082734107971191
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.293 Vali Acc: 0.899 Test Loss: 0.293 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7436323165893555
Epoch: 18, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.302 Vali Acc: 0.899 Test Loss: 0.302 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6553592681884766
Epoch: 19, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.294 Vali Acc: 0.899 Test Loss: 0.294 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7544054985046387
Epoch: 20, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.310 Vali Acc: 0.891 Test Loss: 0.310 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7634267807006836
Epoch: 21, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.292 Vali Acc: 0.899 Test Loss: 0.292 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7627561092376709
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.906 Test Loss: 0.240 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905795).  Saving model ...
Epoch: 23 cost time: 0.7752878665924072
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.243 Vali Acc: 0.913 Test Loss: 0.243 Test Acc: 0.913
Validation loss decreased (-0.905795 --> -0.913041).  Saving model ...
Epoch: 24 cost time: 0.726555585861206
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.913 Test Loss: 0.254 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7054538726806641
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.261 Vali Acc: 0.906 Test Loss: 0.261 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6898646354675293
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.899 Test Loss: 0.259 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7254762649536133
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.899 Test Loss: 0.262 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8089823722839355
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.899 Test Loss: 0.264 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.668311357498169
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.899 Test Loss: 0.264 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7120697498321533
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.899 Test Loss: 0.273 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7443451881408691
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.899 Test Loss: 0.271 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7342820167541504
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.264 Vali Acc: 0.906 Test Loss: 0.264 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7115039825439453
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 637572
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9801185131072998
Epoch: 1, Steps: 9 | Train Loss: 1.325 Vali Loss: 1.332 Vali Acc: 0.319 Test Loss: 1.332 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 0.6946656703948975
Epoch: 2, Steps: 9 | Train Loss: 1.197 Vali Loss: 1.197 Vali Acc: 0.558 Test Loss: 1.197 Test Acc: 0.558
Validation loss decreased (-0.318827 --> -0.557959).  Saving model ...
Epoch: 3 cost time: 0.7005221843719482
Epoch: 3, Steps: 9 | Train Loss: 0.997 Vali Loss: 1.015 Vali Acc: 0.659 Test Loss: 1.015 Test Acc: 0.659
Validation loss decreased (-0.557959 --> -0.659410).  Saving model ...
Epoch: 4 cost time: 0.7382235527038574
Epoch: 4, Steps: 9 | Train Loss: 0.774 Vali Loss: 0.826 Vali Acc: 0.783 Test Loss: 0.826 Test Acc: 0.783
Validation loss decreased (-0.659410 --> -0.782600).  Saving model ...
Epoch: 5 cost time: 0.7074663639068604
Epoch: 5, Steps: 9 | Train Loss: 0.587 Vali Loss: 0.645 Vali Acc: 0.848 Test Loss: 0.645 Test Acc: 0.848
Validation loss decreased (-0.782600 --> -0.847820).  Saving model ...
Epoch: 6 cost time: 0.6878495216369629
Epoch: 6, Steps: 9 | Train Loss: 0.408 Vali Loss: 0.496 Vali Acc: 0.877 Test Loss: 0.496 Test Acc: 0.877
Validation loss decreased (-0.847820 --> -0.876807).  Saving model ...
Epoch: 7 cost time: 0.6664056777954102
Epoch: 7, Steps: 9 | Train Loss: 0.275 Vali Loss: 0.398 Vali Acc: 0.899 Test Loss: 0.398 Test Acc: 0.899
Validation loss decreased (-0.876807 --> -0.898547).  Saving model ...
Epoch: 8 cost time: 0.7109475135803223
Epoch: 8, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.342 Vali Acc: 0.891 Test Loss: 0.342 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7290103435516357
Epoch: 9, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.301 Vali Acc: 0.906 Test Loss: 0.301 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 10 cost time: 0.7221448421478271
Epoch: 10, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.276 Vali Acc: 0.906 Test Loss: 0.276 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 11 cost time: 0.6970078945159912
Epoch: 11, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.284 Vali Acc: 0.913 Test Loss: 0.284 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 12 cost time: 0.6852478981018066
Epoch: 12, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.297 Vali Acc: 0.906 Test Loss: 0.297 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.668675422668457
Epoch: 13, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.276 Vali Acc: 0.906 Test Loss: 0.276 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6787283420562744
Epoch: 14, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.248 Vali Acc: 0.899 Test Loss: 0.248 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6997189521789551
Epoch: 15, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.251 Vali Acc: 0.899 Test Loss: 0.251 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6790997982025146
Epoch: 16, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.261 Vali Acc: 0.899 Test Loss: 0.261 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6426763534545898
Epoch: 17, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.271 Vali Acc: 0.906 Test Loss: 0.271 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6770167350769043
Epoch: 18, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.284 Vali Acc: 0.899 Test Loss: 0.284 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7175548076629639
Epoch: 19, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.261 Vali Acc: 0.891 Test Loss: 0.261 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6787276268005371
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.248 Vali Acc: 0.891 Test Loss: 0.248 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6847686767578125
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.247 Vali Acc: 0.899 Test Loss: 0.247 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 625924
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.28155517578125
Epoch: 1, Steps: 9 | Train Loss: 1.403 Vali Loss: 1.360 Vali Acc: 0.167 Test Loss: 1.360 Test Acc: 0.167
Validation loss decreased (inf --> -0.166653).  Saving model ...
Epoch: 2 cost time: 0.728783369064331
Epoch: 2, Steps: 9 | Train Loss: 1.290 Vali Loss: 1.251 Vali Acc: 0.543 Test Loss: 1.251 Test Acc: 0.543
Validation loss decreased (-0.166653 --> -0.543466).  Saving model ...
Epoch: 3 cost time: 0.7502634525299072
Epoch: 3, Steps: 9 | Train Loss: 1.112 Vali Loss: 1.098 Vali Acc: 0.681 Test Loss: 1.098 Test Acc: 0.681
Validation loss decreased (-0.543466 --> -0.681148).  Saving model ...
Epoch: 4 cost time: 0.7326853275299072
Epoch: 4, Steps: 9 | Train Loss: 0.937 Vali Loss: 0.945 Vali Acc: 0.688 Test Loss: 0.945 Test Acc: 0.688
Validation loss decreased (-0.681148 --> -0.688396).  Saving model ...
Epoch: 5 cost time: 0.731579065322876
Epoch: 5, Steps: 9 | Train Loss: 0.758 Vali Loss: 0.798 Vali Acc: 0.746 Test Loss: 0.798 Test Acc: 0.746
Validation loss decreased (-0.688396 --> -0.746369).  Saving model ...
Epoch: 6 cost time: 0.8000049591064453
Epoch: 6, Steps: 9 | Train Loss: 0.593 Vali Loss: 0.655 Vali Acc: 0.812 Test Loss: 0.655 Test Acc: 0.812
Validation loss decreased (-0.746369 --> -0.811588).  Saving model ...
Epoch: 7 cost time: 0.7262873649597168
Epoch: 7, Steps: 9 | Train Loss: 0.411 Vali Loss: 0.547 Vali Acc: 0.855 Test Loss: 0.547 Test Acc: 0.855
Validation loss decreased (-0.811588 --> -0.855067).  Saving model ...
Epoch: 8 cost time: 0.7037968635559082
Epoch: 8, Steps: 9 | Train Loss: 0.303 Vali Loss: 0.463 Vali Acc: 0.877 Test Loss: 0.463 Test Acc: 0.877
Validation loss decreased (-0.855067 --> -0.876807).  Saving model ...
Epoch: 9 cost time: 0.7805933952331543
Epoch: 9, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.416 Vali Acc: 0.870 Test Loss: 0.416 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7668232917785645
Epoch: 10, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.377 Vali Acc: 0.877 Test Loss: 0.377 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876808).  Saving model ...
Epoch: 11 cost time: 0.7324414253234863
Epoch: 11, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.382 Vali Acc: 0.862 Test Loss: 0.382 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8093512058258057
Epoch: 12, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.360 Vali Acc: 0.870 Test Loss: 0.360 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7022302150726318
Epoch: 13, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.341 Vali Acc: 0.884 Test Loss: 0.341 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 14 cost time: 0.6305572986602783
Epoch: 14, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.333 Vali Acc: 0.884 Test Loss: 0.333 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 15 cost time: 0.6313793659210205
Epoch: 15, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.336 Vali Acc: 0.877 Test Loss: 0.336 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7160632610321045
Epoch: 16, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.332 Vali Acc: 0.891 Test Loss: 0.332 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 17 cost time: 0.7291359901428223
Epoch: 17, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.345 Vali Acc: 0.884 Test Loss: 0.345 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6958348751068115
Epoch: 18, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.310 Vali Acc: 0.891 Test Loss: 0.310 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 19 cost time: 0.793543815612793
Epoch: 19, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.307 Vali Acc: 0.891 Test Loss: 0.307 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 20 cost time: 0.7702617645263672
Epoch: 20, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.327 Vali Acc: 0.877 Test Loss: 0.327 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7250630855560303
Epoch: 21, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.315 Vali Acc: 0.891 Test Loss: 0.315 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7189521789550781
Epoch: 22, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.308 Vali Acc: 0.899 Test Loss: 0.308 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 23 cost time: 0.701991081237793
Epoch: 23, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.305 Vali Acc: 0.891 Test Loss: 0.305 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7740991115570068
Epoch: 24, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.304 Vali Acc: 0.899 Test Loss: 0.304 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 25 cost time: 0.7141399383544922
Epoch: 25, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.303 Vali Acc: 0.906 Test Loss: 0.303 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 26 cost time: 0.6854081153869629
Epoch: 26, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.316 Vali Acc: 0.899 Test Loss: 0.316 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7568089962005615
Epoch: 27, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.325 Vali Acc: 0.899 Test Loss: 0.325 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7773818969726562
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.331 Vali Acc: 0.891 Test Loss: 0.331 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6970744132995605
Epoch: 29, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.339 Vali Acc: 0.899 Test Loss: 0.339 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7020528316497803
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.323 Vali Acc: 0.899 Test Loss: 0.323 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7380893230438232
Epoch: 31, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.312 Vali Acc: 0.899 Test Loss: 0.312 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6798744201660156
Epoch: 32, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.272 Vali Acc: 0.906 Test Loss: 0.272 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 33 cost time: 0.7589027881622314
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.262 Vali Acc: 0.906 Test Loss: 0.262 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 34 cost time: 0.7465307712554932
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.272 Vali Acc: 0.906 Test Loss: 0.272 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6862614154815674
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.307 Vali Acc: 0.899 Test Loss: 0.307 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7363998889923096
Epoch: 36, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.318 Vali Acc: 0.899 Test Loss: 0.318 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7106027603149414
Epoch: 37, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.324 Vali Acc: 0.899 Test Loss: 0.324 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7419414520263672
Epoch: 38, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.346 Vali Acc: 0.891 Test Loss: 0.346 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.7237439155578613
Epoch: 39, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.323 Vali Acc: 0.899 Test Loss: 0.323 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7480707168579102
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.327 Vali Acc: 0.899 Test Loss: 0.327 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.7827308177947998
Epoch: 41, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.341 Vali Acc: 0.899 Test Loss: 0.341 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.7533969879150391
Epoch: 42, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.346 Vali Acc: 0.899 Test Loss: 0.346 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.749230146408081
Epoch: 43, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.339 Vali Acc: 0.899 Test Loss: 0.339 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 617988
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0262997150421143
Epoch: 1, Steps: 9 | Train Loss: 1.406 Vali Loss: 1.364 Vali Acc: 0.217 Test Loss: 1.364 Test Acc: 0.217
Validation loss decreased (inf --> -0.217378).  Saving model ...
Epoch: 2 cost time: 0.7893786430358887
Epoch: 2, Steps: 9 | Train Loss: 1.296 Vali Loss: 1.273 Vali Acc: 0.399 Test Loss: 1.273 Test Acc: 0.399
Validation loss decreased (-0.217378 --> -0.398538).  Saving model ...
Epoch: 3 cost time: 0.7288908958435059
Epoch: 3, Steps: 9 | Train Loss: 1.154 Vali Loss: 1.136 Vali Acc: 0.580 Test Loss: 1.136 Test Acc: 0.580
Validation loss decreased (-0.398538 --> -0.579699).  Saving model ...
Epoch: 4 cost time: 0.7784721851348877
Epoch: 4, Steps: 9 | Train Loss: 0.989 Vali Loss: 0.996 Vali Acc: 0.739 Test Loss: 0.996 Test Acc: 0.739
Validation loss decreased (-0.579699 --> -0.739120).  Saving model ...
Epoch: 5 cost time: 0.7625184059143066
Epoch: 5, Steps: 9 | Train Loss: 0.794 Vali Loss: 0.840 Vali Acc: 0.761 Test Loss: 0.840 Test Acc: 0.761
Validation loss decreased (-0.739120 --> -0.760861).  Saving model ...
Epoch: 6 cost time: 0.777052640914917
Epoch: 6, Steps: 9 | Train Loss: 0.635 Vali Loss: 0.708 Vali Acc: 0.797 Test Loss: 0.708 Test Acc: 0.797
Validation loss decreased (-0.760861 --> -0.797094).  Saving model ...
Epoch: 7 cost time: 0.7141246795654297
Epoch: 7, Steps: 9 | Train Loss: 0.481 Vali Loss: 0.620 Vali Acc: 0.797 Test Loss: 0.620 Test Acc: 0.797
Validation loss decreased (-0.797094 --> -0.797095).  Saving model ...
Epoch: 8 cost time: 0.7062282562255859
Epoch: 8, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.526 Vali Acc: 0.848 Test Loss: 0.526 Test Acc: 0.848
Validation loss decreased (-0.797095 --> -0.847821).  Saving model ...
Epoch: 9 cost time: 0.741919755935669
Epoch: 9, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.485 Vali Acc: 0.855 Test Loss: 0.485 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 10 cost time: 0.7434399127960205
Epoch: 10, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.443 Vali Acc: 0.841 Test Loss: 0.443 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7886464595794678
Epoch: 11, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.426 Vali Acc: 0.848 Test Loss: 0.426 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7517316341400146
Epoch: 12, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.407 Vali Acc: 0.841 Test Loss: 0.407 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7760648727416992
Epoch: 13, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.398 Vali Acc: 0.841 Test Loss: 0.398 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7110762596130371
Epoch: 14, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.397 Vali Acc: 0.877 Test Loss: 0.397 Test Acc: 0.877
Validation loss decreased (-0.855068 --> -0.876808).  Saving model ...
Epoch: 15 cost time: 0.7798037528991699
Epoch: 15, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.396 Vali Acc: 0.862 Test Loss: 0.396 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7287096977233887
Epoch: 16, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.382 Vali Acc: 0.848 Test Loss: 0.382 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7306761741638184
Epoch: 17, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.355 Vali Acc: 0.877 Test Loss: 0.355 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 18 cost time: 0.8071181774139404
Epoch: 18, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.359 Vali Acc: 0.877 Test Loss: 0.359 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6733002662658691
Epoch: 19, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.380 Vali Acc: 0.855 Test Loss: 0.380 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7433533668518066
Epoch: 20, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.398 Vali Acc: 0.870 Test Loss: 0.398 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7357828617095947
Epoch: 21, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.395 Vali Acc: 0.870 Test Loss: 0.395 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.767890453338623
Epoch: 22, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.392 Vali Acc: 0.855 Test Loss: 0.392 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7581672668457031
Epoch: 23, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.373 Vali Acc: 0.870 Test Loss: 0.373 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7521395683288574
Epoch: 24, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.368 Vali Acc: 0.862 Test Loss: 0.368 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.756584644317627
Epoch: 25, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.376 Vali Acc: 0.877 Test Loss: 0.376 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6587603092193604
Epoch: 26, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.385 Vali Acc: 0.877 Test Loss: 0.385 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.873720645904541
Epoch: 27, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.345 Vali Acc: 0.884 Test Loss: 0.345 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 28 cost time: 0.7302706241607666
Epoch: 28, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.347 Vali Acc: 0.884 Test Loss: 0.347 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7318985462188721
Epoch: 29, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.362 Vali Acc: 0.891 Test Loss: 0.362 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 30 cost time: 0.8086416721343994
Epoch: 30, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.405 Vali Acc: 0.862 Test Loss: 0.405 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7557668685913086
Epoch: 31, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.397 Vali Acc: 0.862 Test Loss: 0.397 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7773110866546631
Epoch: 32, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.377 Vali Acc: 0.870 Test Loss: 0.377 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7599668502807617
Epoch: 33, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.370 Vali Acc: 0.877 Test Loss: 0.370 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8332242965698242
Epoch: 34, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.377 Vali Acc: 0.884 Test Loss: 0.377 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7694120407104492
Epoch: 35, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.367 Vali Acc: 0.877 Test Loss: 0.367 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6939616203308105
Epoch: 36, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.364 Vali Acc: 0.877 Test Loss: 0.364 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7694401741027832
Epoch: 37, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.364 Vali Acc: 0.877 Test Loss: 0.364 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7093732357025146
Epoch: 38, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.365 Vali Acc: 0.877 Test Loss: 0.365 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7401583194732666
Epoch: 39, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.370 Vali Acc: 0.877 Test Loss: 0.370 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 616324
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0774776935577393
Epoch: 1, Steps: 9 | Train Loss: 1.427 Vali Loss: 1.381 Vali Acc: 0.254 Test Loss: 1.381 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 0.7109296321868896
Epoch: 2, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.286 Vali Acc: 0.420 Test Loss: 1.286 Test Acc: 0.420
Validation loss decreased (-0.253609 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 0.7795534133911133
Epoch: 3, Steps: 9 | Train Loss: 1.206 Vali Loss: 1.163 Vali Acc: 0.514 Test Loss: 1.163 Test Acc: 0.514
Validation loss decreased (-0.420277 --> -0.514481).  Saving model ...
Epoch: 4 cost time: 0.751610279083252
Epoch: 4, Steps: 9 | Train Loss: 1.043 Vali Loss: 1.025 Vali Acc: 0.688 Test Loss: 1.025 Test Acc: 0.688
Validation loss decreased (-0.514481 --> -0.688396).  Saving model ...
Epoch: 5 cost time: 0.812751054763794
Epoch: 5, Steps: 9 | Train Loss: 0.887 Vali Loss: 0.892 Vali Acc: 0.732 Test Loss: 0.892 Test Acc: 0.732
Validation loss decreased (-0.688396 --> -0.731875).  Saving model ...
Epoch: 6 cost time: 0.7498447895050049
Epoch: 6, Steps: 9 | Train Loss: 0.718 Vali Loss: 0.783 Vali Acc: 0.783 Test Loss: 0.783 Test Acc: 0.783
Validation loss decreased (-0.731875 --> -0.782601).  Saving model ...
Epoch: 7 cost time: 0.7289044857025146
Epoch: 7, Steps: 9 | Train Loss: 0.571 Vali Loss: 0.694 Vali Acc: 0.797 Test Loss: 0.694 Test Acc: 0.797
Validation loss decreased (-0.782601 --> -0.797095).  Saving model ...
Epoch: 8 cost time: 0.7722768783569336
Epoch: 8, Steps: 9 | Train Loss: 0.449 Vali Loss: 0.605 Vali Acc: 0.819 Test Loss: 0.605 Test Acc: 0.819
Validation loss decreased (-0.797095 --> -0.818835).  Saving model ...
Epoch: 9 cost time: 0.71659255027771
Epoch: 9, Steps: 9 | Train Loss: 0.380 Vali Loss: 0.546 Vali Acc: 0.826 Test Loss: 0.546 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 10 cost time: 0.8210930824279785
Epoch: 10, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.499 Vali Acc: 0.826 Test Loss: 0.499 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826082).  Saving model ...
Epoch: 11 cost time: 0.7558722496032715
Epoch: 11, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.471 Vali Acc: 0.841 Test Loss: 0.471 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 12 cost time: 0.8029224872589111
Epoch: 12, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.445 Vali Acc: 0.848 Test Loss: 0.445 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 13 cost time: 0.7599444389343262
Epoch: 13, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.435 Vali Acc: 0.855 Test Loss: 0.435 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 14 cost time: 0.836575984954834
Epoch: 14, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.414 Vali Acc: 0.855 Test Loss: 0.414 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 15 cost time: 0.7533962726593018
Epoch: 15, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.402 Vali Acc: 0.855 Test Loss: 0.402 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 16 cost time: 0.743915319442749
Epoch: 16, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.416 Vali Acc: 0.841 Test Loss: 0.416 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7148003578186035
Epoch: 17, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.415 Vali Acc: 0.841 Test Loss: 0.415 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7813136577606201
Epoch: 18, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.417 Vali Acc: 0.855 Test Loss: 0.417 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7356109619140625
Epoch: 19, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.404 Vali Acc: 0.848 Test Loss: 0.404 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7536764144897461
Epoch: 20, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.406 Vali Acc: 0.855 Test Loss: 0.406 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7945859432220459
Epoch: 21, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.402 Vali Acc: 0.855 Test Loss: 0.402 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 22 cost time: 0.8057177066802979
Epoch: 22, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.389 Vali Acc: 0.855 Test Loss: 0.389 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855069).  Saving model ...
Epoch: 23 cost time: 0.7324426174163818
Epoch: 23, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.387 Vali Acc: 0.862 Test Loss: 0.387 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 24 cost time: 0.5983107089996338
Epoch: 24, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.393 Vali Acc: 0.855 Test Loss: 0.393 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6856708526611328
Epoch: 25, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.398 Vali Acc: 0.862 Test Loss: 0.398 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.664147138595581
Epoch: 26, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.412 Vali Acc: 0.862 Test Loss: 0.412 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.819674015045166
Epoch: 27, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.431 Vali Acc: 0.862 Test Loss: 0.431 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8179705142974854
Epoch: 28, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.431 Vali Acc: 0.862 Test Loss: 0.431 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7231340408325195
Epoch: 29, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.431 Vali Acc: 0.862 Test Loss: 0.431 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7383425235748291
Epoch: 30, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.427 Vali Acc: 0.855 Test Loss: 0.427 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8496065139770508
Epoch: 31, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.414 Vali Acc: 0.855 Test Loss: 0.414 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7489500045776367
Epoch: 32, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.413 Vali Acc: 0.855 Test Loss: 0.413 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8148219585418701
Epoch: 33, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.419 Vali Acc: 0.862 Test Loss: 0.419 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 614532
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.088981866836548
Epoch: 1, Steps: 9 | Train Loss: 1.346 Vali Loss: 1.309 Vali Acc: 0.471 Test Loss: 1.309 Test Acc: 0.471
Validation loss decreased (inf --> -0.471001).  Saving model ...
Epoch: 2 cost time: 0.6504085063934326
Epoch: 2, Steps: 9 | Train Loss: 1.177 Vali Loss: 1.128 Vali Acc: 0.717 Test Loss: 1.128 Test Acc: 0.717
Validation loss decreased (-0.471001 --> -0.717380).  Saving model ...
Epoch: 3 cost time: 0.6398282051086426
Epoch: 3, Steps: 9 | Train Loss: 0.914 Vali Loss: 0.894 Vali Acc: 0.826 Test Loss: 0.894 Test Acc: 0.826
Validation loss decreased (-0.717380 --> -0.826078).  Saving model ...
Epoch: 4 cost time: 0.6745858192443848
Epoch: 4, Steps: 9 | Train Loss: 0.620 Vali Loss: 0.661 Vali Acc: 0.826 Test Loss: 0.661 Test Acc: 0.826
Validation loss decreased (-0.826078 --> -0.826080).  Saving model ...
Epoch: 5 cost time: 0.7012486457824707
Epoch: 5, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.482 Vali Acc: 0.855 Test Loss: 0.482 Test Acc: 0.855
Validation loss decreased (-0.826080 --> -0.855068).  Saving model ...
Epoch: 6 cost time: 0.633842945098877
Epoch: 6, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.348 Vali Acc: 0.899 Test Loss: 0.348 Test Acc: 0.899
Validation loss decreased (-0.855068 --> -0.898547).  Saving model ...
Epoch: 7 cost time: 0.6340429782867432
Epoch: 7, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.293 Vali Acc: 0.891 Test Loss: 0.293 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6948232650756836
Epoch: 8, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.267 Vali Acc: 0.913 Test Loss: 0.267 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913041).  Saving model ...
Epoch: 9 cost time: 0.6451692581176758
Epoch: 9, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.239 Vali Acc: 0.928 Test Loss: 0.239 Test Acc: 0.928
Validation loss decreased (-0.913041 --> -0.927534).  Saving model ...
Epoch: 10 cost time: 0.6430797576904297
Epoch: 10, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 11 cost time: 0.6387441158294678
Epoch: 11, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.243 Vali Acc: 0.920 Test Loss: 0.243 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6261508464813232
Epoch: 12, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.240 Vali Acc: 0.913 Test Loss: 0.240 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6447610855102539
Epoch: 13, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.223 Vali Acc: 0.920 Test Loss: 0.223 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6287198066711426
Epoch: 14, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.224 Vali Acc: 0.928 Test Loss: 0.224 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 15 cost time: 0.596613883972168
Epoch: 15, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.234 Vali Acc: 0.920 Test Loss: 0.234 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6687872409820557
Epoch: 16, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.224 Vali Acc: 0.920 Test Loss: 0.224 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6508824825286865
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.928 Test Loss: 0.218 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 18 cost time: 0.638636589050293
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.228 Vali Acc: 0.928 Test Loss: 0.228 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6948151588439941
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.920 Test Loss: 0.220 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.643470048904419
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.223 Vali Acc: 0.920 Test Loss: 0.223 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6441123485565186
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.920 Test Loss: 0.219 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6356041431427002
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.225 Vali Acc: 0.920 Test Loss: 0.225 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6353945732116699
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.913 Test Loss: 0.230 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6992518901824951
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.920 Test Loss: 0.226 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6612119674682617
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.928 Test Loss: 0.224 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6186201572418213
Epoch: 26, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.213 Vali Acc: 0.928 Test Loss: 0.213 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 27 cost time: 0.6275064945220947
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.259 Vali Acc: 0.942 Test Loss: 0.259 Test Acc: 0.942
Validation loss decreased (-0.927534 --> -0.942026).  Saving model ...
Epoch: 28 cost time: 0.6161015033721924
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.246 Vali Acc: 0.935 Test Loss: 0.246 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7165062427520752
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.920 Test Loss: 0.252 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6674594879150391
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.920 Test Loss: 0.246 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6032619476318359
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.920 Test Loss: 0.252 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6297821998596191
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.928 Test Loss: 0.248 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.650383710861206
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.928 Test Loss: 0.248 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6339335441589355
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.928 Test Loss: 0.256 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6168363094329834
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.928 Test Loss: 0.243 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.668912410736084
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.928 Test Loss: 0.232 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.7015810012817383
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.928 Test Loss: 0.224 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 211140
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0243799686431885
Epoch: 1, Steps: 9 | Train Loss: 1.390 Vali Loss: 1.379 Vali Acc: 0.326 Test Loss: 1.379 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 0.6236236095428467
Epoch: 2, Steps: 9 | Train Loss: 1.277 Vali Loss: 1.269 Vali Acc: 0.413 Test Loss: 1.269 Test Acc: 0.413
Validation loss decreased (-0.326073 --> -0.413031).  Saving model ...
Epoch: 3 cost time: 0.6170685291290283
Epoch: 3, Steps: 9 | Train Loss: 1.105 Vali Loss: 1.105 Vali Acc: 0.572 Test Loss: 1.105 Test Acc: 0.572
Validation loss decreased (-0.413031 --> -0.572453).  Saving model ...
Epoch: 4 cost time: 0.6011264324188232
Epoch: 4, Steps: 9 | Train Loss: 0.893 Vali Loss: 0.917 Vali Acc: 0.768 Test Loss: 0.917 Test Acc: 0.768
Validation loss decreased (-0.572453 --> -0.768107).  Saving model ...
Epoch: 5 cost time: 0.6454336643218994
Epoch: 5, Steps: 9 | Train Loss: 0.703 Vali Loss: 0.744 Vali Acc: 0.819 Test Loss: 0.744 Test Acc: 0.819
Validation loss decreased (-0.768107 --> -0.818833).  Saving model ...
Epoch: 6 cost time: 0.6853747367858887
Epoch: 6, Steps: 9 | Train Loss: 0.528 Vali Loss: 0.578 Vali Acc: 0.884 Test Loss: 0.578 Test Acc: 0.884
Validation loss decreased (-0.818833 --> -0.884052).  Saving model ...
Epoch: 7 cost time: 0.5941636562347412
Epoch: 7, Steps: 9 | Train Loss: 0.374 Vali Loss: 0.467 Vali Acc: 0.899 Test Loss: 0.467 Test Acc: 0.899
Validation loss decreased (-0.884052 --> -0.898546).  Saving model ...
Epoch: 8 cost time: 0.632042646408081
Epoch: 8, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.368 Vali Acc: 0.913 Test Loss: 0.368 Test Acc: 0.913
Validation loss decreased (-0.898546 --> -0.913040).  Saving model ...
Epoch: 9 cost time: 0.7012166976928711
Epoch: 9, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.333 Vali Acc: 0.920 Test Loss: 0.333 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 10 cost time: 0.5938167572021484
Epoch: 10, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.302 Vali Acc: 0.913 Test Loss: 0.302 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6445705890655518
Epoch: 11, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.273 Vali Acc: 0.920 Test Loss: 0.273 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 12 cost time: 0.5940117835998535
Epoch: 12, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.249 Vali Acc: 0.935 Test Loss: 0.249 Test Acc: 0.935
Validation loss decreased (-0.920287 --> -0.934780).  Saving model ...
Epoch: 13 cost time: 0.6015064716339111
Epoch: 13, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.240 Vali Acc: 0.935 Test Loss: 0.240 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 14 cost time: 0.6250526905059814
Epoch: 14, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.243 Vali Acc: 0.920 Test Loss: 0.243 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6019947528839111
Epoch: 15, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.245 Vali Acc: 0.920 Test Loss: 0.245 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6278731822967529
Epoch: 16, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.232 Vali Acc: 0.928 Test Loss: 0.232 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6559224128723145
Epoch: 17, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5924911499023438
Epoch: 18, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5920464992523193
Epoch: 19, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.227 Vali Acc: 0.913 Test Loss: 0.227 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6325113773345947
Epoch: 20, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.225 Vali Acc: 0.913 Test Loss: 0.225 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7009823322296143
Epoch: 21, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.235 Vali Acc: 0.913 Test Loss: 0.235 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6346776485443115
Epoch: 22, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.205 Vali Acc: 0.920 Test Loss: 0.205 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6782658100128174
Epoch: 23, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.194 Vali Acc: 0.935 Test Loss: 0.194 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934781).  Saving model ...
Epoch: 24 cost time: 0.6705193519592285
Epoch: 24, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.198 Vali Acc: 0.942 Test Loss: 0.198 Test Acc: 0.942
Validation loss decreased (-0.934781 --> -0.942027).  Saving model ...
Epoch: 25 cost time: 0.6167469024658203
Epoch: 25, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.218 Vali Acc: 0.935 Test Loss: 0.218 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6999800205230713
Epoch: 26, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5961294174194336
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.920 Test Loss: 0.206 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6000826358795166
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.935 Test Loss: 0.199 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6846957206726074
Epoch: 29, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.195 Vali Acc: 0.928 Test Loss: 0.195 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.619645357131958
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6511001586914062
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.920 Test Loss: 0.204 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7004783153533936
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.920 Test Loss: 0.210 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5918114185333252
Epoch: 33, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.195 Vali Acc: 0.928 Test Loss: 0.195 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6781542301177979
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.942 Test Loss: 0.189 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 35 cost time: 0.6393544673919678
Epoch: 35, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.928 Test Loss: 0.192 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7544839382171631
Epoch: 36, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6504228115081787
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.928 Test Loss: 0.209 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5878140926361084
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5851235389709473
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.920 Test Loss: 0.225 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6163444519042969
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.920 Test Loss: 0.233 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6377143859863281
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.920 Test Loss: 0.233 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.6372904777526855
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.920 Test Loss: 0.225 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.6601953506469727
Epoch: 43, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.920 Test Loss: 0.222 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.643547773361206
Epoch: 44, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.920 Test Loss: 0.218 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 185348
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.97454833984375
Epoch: 1, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.372 Vali Acc: 0.261 Test Loss: 1.372 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 0.6177527904510498
Epoch: 2, Steps: 9 | Train Loss: 1.269 Vali Loss: 1.287 Vali Acc: 0.391 Test Loss: 1.287 Test Acc: 0.391
Validation loss decreased (-0.260856 --> -0.391291).  Saving model ...
Epoch: 3 cost time: 0.6282858848571777
Epoch: 3, Steps: 9 | Train Loss: 1.142 Vali Loss: 1.165 Vali Acc: 0.551 Test Loss: 1.165 Test Acc: 0.551
Validation loss decreased (-0.391291 --> -0.550713).  Saving model ...
Epoch: 4 cost time: 0.6169366836547852
Epoch: 4, Steps: 9 | Train Loss: 0.987 Vali Loss: 1.015 Vali Acc: 0.710 Test Loss: 1.015 Test Acc: 0.710
Validation loss decreased (-0.550713 --> -0.710135).  Saving model ...
Epoch: 5 cost time: 0.7172300815582275
Epoch: 5, Steps: 9 | Train Loss: 0.821 Vali Loss: 0.866 Vali Acc: 0.812 Test Loss: 0.866 Test Acc: 0.812
Validation loss decreased (-0.710135 --> -0.811586).  Saving model ...
Epoch: 6 cost time: 0.6769237518310547
Epoch: 6, Steps: 9 | Train Loss: 0.649 Vali Loss: 0.721 Vali Acc: 0.870 Test Loss: 0.721 Test Acc: 0.870
Validation loss decreased (-0.811586 --> -0.869558).  Saving model ...
Epoch: 7 cost time: 0.6258494853973389
Epoch: 7, Steps: 9 | Train Loss: 0.488 Vali Loss: 0.575 Vali Acc: 0.899 Test Loss: 0.575 Test Acc: 0.899
Validation loss decreased (-0.869558 --> -0.898545).  Saving model ...
Epoch: 8 cost time: 0.6330163478851318
Epoch: 8, Steps: 9 | Train Loss: 0.377 Vali Loss: 0.464 Vali Acc: 0.906 Test Loss: 0.464 Test Acc: 0.906
Validation loss decreased (-0.898545 --> -0.905792).  Saving model ...
Epoch: 9 cost time: 0.6508100032806396
Epoch: 9, Steps: 9 | Train Loss: 0.258 Vali Loss: 0.402 Vali Acc: 0.899 Test Loss: 0.402 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6835224628448486
Epoch: 10, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.360 Vali Acc: 0.899 Test Loss: 0.360 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6491217613220215
Epoch: 11, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.332 Vali Acc: 0.906 Test Loss: 0.332 Test Acc: 0.906
Validation loss decreased (-0.905792 --> -0.905794).  Saving model ...
Epoch: 12 cost time: 0.6566612720489502
Epoch: 12, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.302 Vali Acc: 0.913 Test Loss: 0.302 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 13 cost time: 0.6737461090087891
Epoch: 13, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.275 Vali Acc: 0.920 Test Loss: 0.275 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 14 cost time: 0.6889231204986572
Epoch: 14, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.269 Vali Acc: 0.913 Test Loss: 0.269 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7018389701843262
Epoch: 15, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.258 Vali Acc: 0.913 Test Loss: 0.258 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7451696395874023
Epoch: 16, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.260 Vali Acc: 0.913 Test Loss: 0.260 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7809760570526123
Epoch: 17, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6605420112609863
Epoch: 18, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.247 Vali Acc: 0.906 Test Loss: 0.247 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6380784511566162
Epoch: 19, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.243 Vali Acc: 0.906 Test Loss: 0.243 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7353565692901611
Epoch: 20, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.256 Vali Acc: 0.906 Test Loss: 0.256 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6145145893096924
Epoch: 21, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.253 Vali Acc: 0.906 Test Loss: 0.253 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6721220016479492
Epoch: 22, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.269 Vali Acc: 0.906 Test Loss: 0.269 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6291477680206299
Epoch: 23, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.240 Vali Acc: 0.906 Test Loss: 0.240 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 179524
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8982834815979004
Epoch: 1, Steps: 9 | Train Loss: 1.350 Vali Loss: 1.330 Vali Acc: 0.391 Test Loss: 1.330 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 0.5995514392852783
Epoch: 2, Steps: 9 | Train Loss: 1.286 Vali Loss: 1.263 Vali Acc: 0.551 Test Loss: 1.263 Test Acc: 0.551
Validation loss decreased (-0.391291 --> -0.550712).  Saving model ...
Epoch: 3 cost time: 0.6140573024749756
Epoch: 3, Steps: 9 | Train Loss: 1.190 Vali Loss: 1.169 Vali Acc: 0.652 Test Loss: 1.169 Test Acc: 0.652
Validation loss decreased (-0.550712 --> -0.652162).  Saving model ...
Epoch: 4 cost time: 0.5929825305938721
Epoch: 4, Steps: 9 | Train Loss: 1.063 Vali Loss: 1.066 Vali Acc: 0.761 Test Loss: 1.066 Test Acc: 0.761
Validation loss decreased (-0.652162 --> -0.760859).  Saving model ...
Epoch: 5 cost time: 0.6376519203186035
Epoch: 5, Steps: 9 | Train Loss: 0.933 Vali Loss: 0.939 Vali Acc: 0.797 Test Loss: 0.939 Test Acc: 0.797
Validation loss decreased (-0.760859 --> -0.797092).  Saving model ...
Epoch: 6 cost time: 0.6139743328094482
Epoch: 6, Steps: 9 | Train Loss: 0.796 Vali Loss: 0.820 Vali Acc: 0.826 Test Loss: 0.820 Test Acc: 0.826
Validation loss decreased (-0.797092 --> -0.826079).  Saving model ...
Epoch: 7 cost time: 0.614647388458252
Epoch: 7, Steps: 9 | Train Loss: 0.631 Vali Loss: 0.696 Vali Acc: 0.826 Test Loss: 0.696 Test Acc: 0.826
Validation loss decreased (-0.826079 --> -0.826080).  Saving model ...
Epoch: 8 cost time: 0.615361213684082
Epoch: 8, Steps: 9 | Train Loss: 0.494 Vali Loss: 0.593 Vali Acc: 0.855 Test Loss: 0.593 Test Acc: 0.855
Validation loss decreased (-0.826080 --> -0.855067).  Saving model ...
Epoch: 9 cost time: 0.5977964401245117
Epoch: 9, Steps: 9 | Train Loss: 0.398 Vali Loss: 0.514 Vali Acc: 0.891 Test Loss: 0.514 Test Acc: 0.891
Validation loss decreased (-0.855067 --> -0.891299).  Saving model ...
Epoch: 10 cost time: 0.6021928787231445
Epoch: 10, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.453 Vali Acc: 0.884 Test Loss: 0.453 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5920684337615967
Epoch: 11, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.394 Vali Acc: 0.899 Test Loss: 0.394 Test Acc: 0.899
Validation loss decreased (-0.891299 --> -0.898547).  Saving model ...
Epoch: 12 cost time: 0.6395206451416016
Epoch: 12, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.377 Vali Acc: 0.899 Test Loss: 0.377 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 13 cost time: 0.6075136661529541
Epoch: 13, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.350 Vali Acc: 0.899 Test Loss: 0.350 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 14 cost time: 0.697685956954956
Epoch: 14, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.317 Vali Acc: 0.906 Test Loss: 0.317 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 15 cost time: 0.6230461597442627
Epoch: 15, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.305 Vali Acc: 0.920 Test Loss: 0.305 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920287).  Saving model ...
Epoch: 16 cost time: 0.7039458751678467
Epoch: 16, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.298 Vali Acc: 0.928 Test Loss: 0.298 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927533).  Saving model ...
Epoch: 17 cost time: 0.6000442504882812
Epoch: 17, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.311 Vali Acc: 0.913 Test Loss: 0.311 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6034133434295654
Epoch: 18, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.311 Vali Acc: 0.906 Test Loss: 0.311 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6138856410980225
Epoch: 19, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.300 Vali Acc: 0.899 Test Loss: 0.300 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5487935543060303
Epoch: 20, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.291 Vali Acc: 0.906 Test Loss: 0.291 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5948634147644043
Epoch: 21, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.297 Vali Acc: 0.906 Test Loss: 0.297 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.69856858253479
Epoch: 22, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.288 Vali Acc: 0.906 Test Loss: 0.288 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.683870792388916
Epoch: 23, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.279 Vali Acc: 0.906 Test Loss: 0.279 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5994663238525391
Epoch: 24, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.287 Vali Acc: 0.906 Test Loss: 0.287 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6075592041015625
Epoch: 25, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.286 Vali Acc: 0.906 Test Loss: 0.286 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5323824882507324
Epoch: 26, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.279 Vali Acc: 0.906 Test Loss: 0.279 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 173700
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.992748498916626
Epoch: 1, Steps: 9 | Train Loss: 1.387 Vali Loss: 1.383 Vali Acc: 0.217 Test Loss: 1.383 Test Acc: 0.217
Validation loss decreased (inf --> -0.217377).  Saving model ...
Epoch: 2 cost time: 0.7053897380828857
Epoch: 2, Steps: 9 | Train Loss: 1.342 Vali Loss: 1.346 Vali Acc: 0.283 Test Loss: 1.346 Test Acc: 0.283
Validation loss decreased (-0.217377 --> -0.282595).  Saving model ...
Epoch: 3 cost time: 0.7657463550567627
Epoch: 3, Steps: 9 | Train Loss: 1.260 Vali Loss: 1.283 Vali Acc: 0.399 Test Loss: 1.283 Test Acc: 0.399
Validation loss decreased (-0.282595 --> -0.398538).  Saving model ...
Epoch: 4 cost time: 0.6610174179077148
Epoch: 4, Steps: 9 | Train Loss: 1.174 Vali Loss: 1.201 Vali Acc: 0.457 Test Loss: 1.201 Test Acc: 0.457
Validation loss decreased (-0.398538 --> -0.456510).  Saving model ...
Epoch: 5 cost time: 0.6631374359130859
Epoch: 5, Steps: 9 | Train Loss: 1.069 Vali Loss: 1.107 Vali Acc: 0.580 Test Loss: 1.107 Test Acc: 0.580
Validation loss decreased (-0.456510 --> -0.579699).  Saving model ...
Epoch: 6 cost time: 0.6299872398376465
Epoch: 6, Steps: 9 | Train Loss: 0.954 Vali Loss: 1.007 Vali Acc: 0.681 Test Loss: 1.007 Test Acc: 0.681
Validation loss decreased (-0.579699 --> -0.681149).  Saving model ...
Epoch: 7 cost time: 0.6607720851898193
Epoch: 7, Steps: 9 | Train Loss: 0.830 Vali Loss: 0.903 Vali Acc: 0.754 Test Loss: 0.903 Test Acc: 0.754
Validation loss decreased (-0.681149 --> -0.753614).  Saving model ...
Epoch: 8 cost time: 0.7111155986785889
Epoch: 8, Steps: 9 | Train Loss: 0.722 Vali Loss: 0.807 Vali Acc: 0.768 Test Loss: 0.807 Test Acc: 0.768
Validation loss decreased (-0.753614 --> -0.768108).  Saving model ...
Epoch: 9 cost time: 0.6533942222595215
Epoch: 9, Steps: 9 | Train Loss: 0.601 Vali Loss: 0.711 Vali Acc: 0.797 Test Loss: 0.711 Test Acc: 0.797
Validation loss decreased (-0.768108 --> -0.797094).  Saving model ...
Epoch: 10 cost time: 0.7015366554260254
Epoch: 10, Steps: 9 | Train Loss: 0.498 Vali Loss: 0.628 Vali Acc: 0.833 Test Loss: 0.628 Test Acc: 0.833
Validation loss decreased (-0.797094 --> -0.833327).  Saving model ...
Epoch: 11 cost time: 0.7731313705444336
Epoch: 11, Steps: 9 | Train Loss: 0.414 Vali Loss: 0.571 Vali Acc: 0.862 Test Loss: 0.571 Test Acc: 0.862
Validation loss decreased (-0.833327 --> -0.862313).  Saving model ...
Epoch: 12 cost time: 0.6818809509277344
Epoch: 12, Steps: 9 | Train Loss: 0.368 Vali Loss: 0.512 Vali Acc: 0.877 Test Loss: 0.512 Test Acc: 0.877
Validation loss decreased (-0.862313 --> -0.876806).  Saving model ...
Epoch: 13 cost time: 0.664024829864502
Epoch: 13, Steps: 9 | Train Loss: 0.301 Vali Loss: 0.477 Vali Acc: 0.891 Test Loss: 0.477 Test Acc: 0.891
Validation loss decreased (-0.876806 --> -0.891300).  Saving model ...
Epoch: 14 cost time: 0.6656506061553955
Epoch: 14, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.446 Vali Acc: 0.877 Test Loss: 0.446 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6650540828704834
Epoch: 15, Steps: 9 | Train Loss: 0.228 Vali Loss: 0.421 Vali Acc: 0.870 Test Loss: 0.421 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6613290309906006
Epoch: 16, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.409 Vali Acc: 0.870 Test Loss: 0.409 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6560275554656982
Epoch: 17, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.390 Vali Acc: 0.877 Test Loss: 0.390 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.693429708480835
Epoch: 18, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.374 Vali Acc: 0.877 Test Loss: 0.374 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7087855339050293
Epoch: 19, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.377 Vali Acc: 0.870 Test Loss: 0.377 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6892697811126709
Epoch: 20, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.368 Vali Acc: 0.870 Test Loss: 0.368 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6731829643249512
Epoch: 21, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.356 Vali Acc: 0.877 Test Loss: 0.356 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7226645946502686
Epoch: 22, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.354 Vali Acc: 0.877 Test Loss: 0.354 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6796894073486328
Epoch: 23, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.353 Vali Acc: 0.870 Test Loss: 0.353 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 169732
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1348297595977783
Epoch: 1, Steps: 9 | Train Loss: 1.358 Vali Loss: 1.370 Vali Acc: 0.225 Test Loss: 1.370 Test Acc: 0.225
Validation loss decreased (inf --> -0.224624).  Saving model ...
Epoch: 2 cost time: 0.6878335475921631
Epoch: 2, Steps: 9 | Train Loss: 1.313 Vali Loss: 1.323 Vali Acc: 0.333 Test Loss: 1.323 Test Acc: 0.333
Validation loss decreased (-0.224624 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 0.5959746837615967
Epoch: 3, Steps: 9 | Train Loss: 1.245 Vali Loss: 1.251 Vali Acc: 0.449 Test Loss: 1.251 Test Acc: 0.449
Validation loss decreased (-0.333320 --> -0.449263).  Saving model ...
Epoch: 4 cost time: 0.5985987186431885
Epoch: 4, Steps: 9 | Train Loss: 1.141 Vali Loss: 1.165 Vali Acc: 0.543 Test Loss: 1.165 Test Acc: 0.543
Validation loss decreased (-0.449263 --> -0.543467).  Saving model ...
Epoch: 5 cost time: 0.6073048114776611
Epoch: 5, Steps: 9 | Train Loss: 1.044 Vali Loss: 1.077 Vali Acc: 0.652 Test Loss: 1.077 Test Acc: 0.652
Validation loss decreased (-0.543467 --> -0.652163).  Saving model ...
Epoch: 6 cost time: 0.6208021640777588
Epoch: 6, Steps: 9 | Train Loss: 0.921 Vali Loss: 0.982 Vali Acc: 0.717 Test Loss: 0.982 Test Acc: 0.717
Validation loss decreased (-0.652163 --> -0.717381).  Saving model ...
Epoch: 7 cost time: 0.6154835224151611
Epoch: 7, Steps: 9 | Train Loss: 0.810 Vali Loss: 0.891 Vali Acc: 0.725 Test Loss: 0.891 Test Acc: 0.725
Validation loss decreased (-0.717381 --> -0.724629).  Saving model ...
Epoch: 8 cost time: 0.6121366024017334
Epoch: 8, Steps: 9 | Train Loss: 0.690 Vali Loss: 0.805 Vali Acc: 0.754 Test Loss: 0.805 Test Acc: 0.754
Validation loss decreased (-0.724629 --> -0.753615).  Saving model ...
Epoch: 9 cost time: 0.6036908626556396
Epoch: 9, Steps: 9 | Train Loss: 0.610 Vali Loss: 0.726 Vali Acc: 0.783 Test Loss: 0.726 Test Acc: 0.783
Validation loss decreased (-0.753615 --> -0.782601).  Saving model ...
Epoch: 10 cost time: 0.625868558883667
Epoch: 10, Steps: 9 | Train Loss: 0.510 Vali Loss: 0.668 Vali Acc: 0.797 Test Loss: 0.668 Test Acc: 0.797
Validation loss decreased (-0.782601 --> -0.797095).  Saving model ...
Epoch: 11 cost time: 0.611107587814331
Epoch: 11, Steps: 9 | Train Loss: 0.430 Vali Loss: 0.608 Vali Acc: 0.797 Test Loss: 0.608 Test Acc: 0.797
Validation loss decreased (-0.797095 --> -0.797095).  Saving model ...
Epoch: 12 cost time: 0.5978178977966309
Epoch: 12, Steps: 9 | Train Loss: 0.354 Vali Loss: 0.554 Vali Acc: 0.819 Test Loss: 0.554 Test Acc: 0.819
Validation loss decreased (-0.797095 --> -0.818835).  Saving model ...
Epoch: 13 cost time: 0.6880407333374023
Epoch: 13, Steps: 9 | Train Loss: 0.307 Vali Loss: 0.529 Vali Acc: 0.812 Test Loss: 0.529 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7088463306427002
Epoch: 14, Steps: 9 | Train Loss: 0.270 Vali Loss: 0.498 Vali Acc: 0.819 Test Loss: 0.498 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818836).  Saving model ...
Epoch: 15 cost time: 0.6536517143249512
Epoch: 15, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.470 Vali Acc: 0.826 Test Loss: 0.470 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 16 cost time: 0.6493842601776123
Epoch: 16, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.461 Vali Acc: 0.819 Test Loss: 0.461 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7162270545959473
Epoch: 17, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.435 Vali Acc: 0.833 Test Loss: 0.435 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 18 cost time: 0.6774818897247314
Epoch: 18, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.438 Vali Acc: 0.841 Test Loss: 0.438 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 19 cost time: 0.6244792938232422
Epoch: 19, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.419 Vali Acc: 0.841 Test Loss: 0.419 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840576).  Saving model ...
Epoch: 20 cost time: 0.6458132266998291
Epoch: 20, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.396 Vali Acc: 0.855 Test Loss: 0.396 Test Acc: 0.855
Validation loss decreased (-0.840576 --> -0.855068).  Saving model ...
Epoch: 21 cost time: 0.5807094573974609
Epoch: 21, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.381 Vali Acc: 0.862 Test Loss: 0.381 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 22 cost time: 0.6371073722839355
Epoch: 22, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.389 Vali Acc: 0.855 Test Loss: 0.389 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6225616931915283
Epoch: 23, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.393 Vali Acc: 0.862 Test Loss: 0.393 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6487221717834473
Epoch: 24, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.383 Vali Acc: 0.870 Test Loss: 0.383 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 25 cost time: 0.6296994686126709
Epoch: 25, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.385 Vali Acc: 0.862 Test Loss: 0.385 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7290537357330322
Epoch: 26, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.382 Vali Acc: 0.870 Test Loss: 0.382 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 27 cost time: 0.6288163661956787
Epoch: 27, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.384 Vali Acc: 0.870 Test Loss: 0.384 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5968468189239502
Epoch: 28, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.383 Vali Acc: 0.870 Test Loss: 0.383 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6045341491699219
Epoch: 29, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.377 Vali Acc: 0.870 Test Loss: 0.377 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 30 cost time: 0.6852376461029053
Epoch: 30, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.377 Vali Acc: 0.862 Test Loss: 0.377 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5755603313446045
Epoch: 31, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.389 Vali Acc: 0.862 Test Loss: 0.389 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6143710613250732
Epoch: 32, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.387 Vali Acc: 0.870 Test Loss: 0.387 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6200158596038818
Epoch: 33, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.386 Vali Acc: 0.870 Test Loss: 0.386 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6933715343475342
Epoch: 34, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.387 Vali Acc: 0.870 Test Loss: 0.387 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6039350032806396
Epoch: 35, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.392 Vali Acc: 0.870 Test Loss: 0.392 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.623100996017456
Epoch: 36, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.379 Vali Acc: 0.870 Test Loss: 0.379 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.621819257736206
Epoch: 37, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.382 Vali Acc: 0.862 Test Loss: 0.382 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5823190212249756
Epoch: 38, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.386 Vali Acc: 0.870 Test Loss: 0.386 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.6965584754943848
Epoch: 39, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.391 Vali Acc: 0.877 Test Loss: 0.391 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 40 cost time: 0.6912672519683838
Epoch: 40, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.390 Vali Acc: 0.870 Test Loss: 0.390 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5949039459228516
Epoch: 41, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.373 Vali Acc: 0.870 Test Loss: 0.373 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6334867477416992
Epoch: 42, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.344 Vali Acc: 0.870 Test Loss: 0.344 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.620323657989502
Epoch: 43, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.340 Vali Acc: 0.870 Test Loss: 0.340 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6295754909515381
Epoch: 44, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.345 Vali Acc: 0.870 Test Loss: 0.345 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.6152260303497314
Epoch: 45, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.354 Vali Acc: 0.870 Test Loss: 0.354 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.6517398357391357
Epoch: 46, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.358 Vali Acc: 0.877 Test Loss: 0.358 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 47 cost time: 0.6279268264770508
Epoch: 47, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.355 Vali Acc: 0.877 Test Loss: 0.355 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 48 cost time: 0.6139063835144043
Epoch: 48, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.368 Vali Acc: 0.870 Test Loss: 0.368 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6043455600738525
Epoch: 49, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.387 Vali Acc: 0.870 Test Loss: 0.387 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6088435649871826
Epoch: 50, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.389 Vali Acc: 0.870 Test Loss: 0.389 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 168900
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.902648687362671
Epoch: 1, Steps: 9 | Train Loss: 1.420 Vali Loss: 1.383 Vali Acc: 0.290 Test Loss: 1.383 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 0.655057430267334
Epoch: 2, Steps: 9 | Train Loss: 1.366 Vali Loss: 1.351 Vali Acc: 0.326 Test Loss: 1.351 Test Acc: 0.326
Validation loss decreased (-0.289841 --> -0.326073).  Saving model ...
Epoch: 3 cost time: 0.6255245208740234
Epoch: 3, Steps: 9 | Train Loss: 1.308 Vali Loss: 1.301 Vali Acc: 0.442 Test Loss: 1.301 Test Acc: 0.442
Validation loss decreased (-0.326073 --> -0.442016).  Saving model ...
Epoch: 4 cost time: 0.6020724773406982
Epoch: 4, Steps: 9 | Train Loss: 1.228 Vali Loss: 1.245 Vali Acc: 0.536 Test Loss: 1.245 Test Acc: 0.536
Validation loss decreased (-0.442016 --> -0.536219).  Saving model ...
Epoch: 5 cost time: 0.6140708923339844
Epoch: 5, Steps: 9 | Train Loss: 1.146 Vali Loss: 1.171 Vali Acc: 0.652 Test Loss: 1.171 Test Acc: 0.652
Validation loss decreased (-0.536219 --> -0.652162).  Saving model ...
Epoch: 6 cost time: 0.5950438976287842
Epoch: 6, Steps: 9 | Train Loss: 1.064 Vali Loss: 1.094 Vali Acc: 0.681 Test Loss: 1.094 Test Acc: 0.681
Validation loss decreased (-0.652162 --> -0.681148).  Saving model ...
Epoch: 7 cost time: 0.6204004287719727
Epoch: 7, Steps: 9 | Train Loss: 0.951 Vali Loss: 1.004 Vali Acc: 0.725 Test Loss: 1.004 Test Acc: 0.725
Validation loss decreased (-0.681148 --> -0.724628).  Saving model ...
Epoch: 8 cost time: 0.6090826988220215
Epoch: 8, Steps: 9 | Train Loss: 0.840 Vali Loss: 0.921 Vali Acc: 0.732 Test Loss: 0.921 Test Acc: 0.732
Validation loss decreased (-0.724628 --> -0.731875).  Saving model ...
Epoch: 9 cost time: 0.6221945285797119
Epoch: 9, Steps: 9 | Train Loss: 0.744 Vali Loss: 0.840 Vali Acc: 0.732 Test Loss: 0.840 Test Acc: 0.732
Validation loss decreased (-0.731875 --> -0.731876).  Saving model ...
Epoch: 10 cost time: 0.6148533821105957
Epoch: 10, Steps: 9 | Train Loss: 0.645 Vali Loss: 0.764 Vali Acc: 0.739 Test Loss: 0.764 Test Acc: 0.739
Validation loss decreased (-0.731876 --> -0.739123).  Saving model ...
Epoch: 11 cost time: 0.5789668560028076
Epoch: 11, Steps: 9 | Train Loss: 0.568 Vali Loss: 0.696 Vali Acc: 0.746 Test Loss: 0.696 Test Acc: 0.746
Validation loss decreased (-0.739123 --> -0.746370).  Saving model ...
Epoch: 12 cost time: 0.6273849010467529
Epoch: 12, Steps: 9 | Train Loss: 0.491 Vali Loss: 0.642 Vali Acc: 0.768 Test Loss: 0.642 Test Acc: 0.768
Validation loss decreased (-0.746370 --> -0.768110).  Saving model ...
Epoch: 13 cost time: 0.5979642868041992
Epoch: 13, Steps: 9 | Train Loss: 0.407 Vali Loss: 0.600 Vali Acc: 0.790 Test Loss: 0.600 Test Acc: 0.790
Validation loss decreased (-0.768110 --> -0.789849).  Saving model ...
Epoch: 14 cost time: 0.5485279560089111
Epoch: 14, Steps: 9 | Train Loss: 0.371 Vali Loss: 0.572 Vali Acc: 0.797 Test Loss: 0.572 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797096).  Saving model ...
Epoch: 15 cost time: 0.5575098991394043
Epoch: 15, Steps: 9 | Train Loss: 0.302 Vali Loss: 0.543 Vali Acc: 0.819 Test Loss: 0.543 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818835).  Saving model ...
Epoch: 16 cost time: 0.6253135204315186
Epoch: 16, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.524 Vali Acc: 0.826 Test Loss: 0.524 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 17 cost time: 0.631760835647583
Epoch: 17, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.519 Vali Acc: 0.826 Test Loss: 0.519 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 18 cost time: 0.6323919296264648
Epoch: 18, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.491 Vali Acc: 0.826 Test Loss: 0.491 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 19 cost time: 0.6230754852294922
Epoch: 19, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.476 Vali Acc: 0.819 Test Loss: 0.476 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6149260997772217
Epoch: 20, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.473 Vali Acc: 0.826 Test Loss: 0.473 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 21 cost time: 0.6268277168273926
Epoch: 21, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.458 Vali Acc: 0.833 Test Loss: 0.458 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 22 cost time: 0.6447176933288574
Epoch: 22, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.445 Vali Acc: 0.826 Test Loss: 0.445 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5997936725616455
Epoch: 23, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.432 Vali Acc: 0.833 Test Loss: 0.432 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 24 cost time: 0.629204273223877
Epoch: 24, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.424 Vali Acc: 0.833 Test Loss: 0.424 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 25 cost time: 0.6539335250854492
Epoch: 25, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.430 Vali Acc: 0.826 Test Loss: 0.430 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.651479959487915
Epoch: 26, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.443 Vali Acc: 0.833 Test Loss: 0.443 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6725926399230957
Epoch: 27, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.446 Vali Acc: 0.841 Test Loss: 0.446 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 28 cost time: 0.6111845970153809
Epoch: 28, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.462 Vali Acc: 0.833 Test Loss: 0.462 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6155455112457275
Epoch: 29, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.432 Vali Acc: 0.841 Test Loss: 0.432 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 30 cost time: 0.6465632915496826
Epoch: 30, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.382 Vali Acc: 0.862 Test Loss: 0.382 Test Acc: 0.862
Validation loss decreased (-0.840575 --> -0.862315).  Saving model ...
Epoch: 31 cost time: 0.6739599704742432
Epoch: 31, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.372 Vali Acc: 0.862 Test Loss: 0.372 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 32 cost time: 0.638491153717041
Epoch: 32, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.364 Vali Acc: 0.862 Test Loss: 0.364 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 33 cost time: 0.6537015438079834
Epoch: 33, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.378 Vali Acc: 0.862 Test Loss: 0.378 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6829860210418701
Epoch: 34, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.405 Vali Acc: 0.848 Test Loss: 0.405 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6722676753997803
Epoch: 35, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.416 Vali Acc: 0.848 Test Loss: 0.416 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5962049961090088
Epoch: 36, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.400 Vali Acc: 0.862 Test Loss: 0.400 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6446428298950195
Epoch: 37, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.392 Vali Acc: 0.862 Test Loss: 0.392 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.6118021011352539
Epoch: 38, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.389 Vali Acc: 0.862 Test Loss: 0.389 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.663933515548706
Epoch: 39, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.405 Vali Acc: 0.855 Test Loss: 0.405 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.6853883266448975
Epoch: 40, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.401 Vali Acc: 0.862 Test Loss: 0.401 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.6651437282562256
Epoch: 41, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.412 Vali Acc: 0.855 Test Loss: 0.412 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.6890280246734619
Epoch: 42, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.412 Vali Acc: 0.855 Test Loss: 0.412 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 168004
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.078310012817383
Epoch: 1, Steps: 9 | Train Loss: 1.386 Vali Loss: 1.361 Vali Acc: 0.225 Test Loss: 1.361 Test Acc: 0.225
Validation loss decreased (inf --> -0.224624).  Saving model ...
Epoch: 2 cost time: 0.5922746658325195
Epoch: 2, Steps: 9 | Train Loss: 1.276 Vali Loss: 1.262 Vali Acc: 0.420 Test Loss: 1.262 Test Acc: 0.420
Validation loss decreased (-0.224624 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 0.5156073570251465
Epoch: 3, Steps: 9 | Train Loss: 1.116 Vali Loss: 1.116 Vali Acc: 0.638 Test Loss: 1.116 Test Acc: 0.638
Validation loss decreased (-0.420277 --> -0.637670).  Saving model ...
Epoch: 4 cost time: 0.6121306419372559
Epoch: 4, Steps: 9 | Train Loss: 0.929 Vali Loss: 0.959 Vali Acc: 0.725 Test Loss: 0.959 Test Acc: 0.725
Validation loss decreased (-0.637670 --> -0.724628).  Saving model ...
Epoch: 5 cost time: 0.5831294059753418
Epoch: 5, Steps: 9 | Train Loss: 0.752 Vali Loss: 0.808 Vali Acc: 0.761 Test Loss: 0.808 Test Acc: 0.761
Validation loss decreased (-0.724628 --> -0.760861).  Saving model ...
Epoch: 6 cost time: 0.5899839401245117
Epoch: 6, Steps: 9 | Train Loss: 0.588 Vali Loss: 0.660 Vali Acc: 0.819 Test Loss: 0.660 Test Acc: 0.819
Validation loss decreased (-0.760861 --> -0.818834).  Saving model ...
Epoch: 7 cost time: 0.643545389175415
Epoch: 7, Steps: 9 | Train Loss: 0.429 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
Validation loss decreased (-0.818834 --> -0.840574).  Saving model ...
Epoch: 8 cost time: 0.5590741634368896
Epoch: 8, Steps: 9 | Train Loss: 0.335 Vali Loss: 0.436 Vali Acc: 0.848 Test Loss: 0.436 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847822).  Saving model ...
Epoch: 9 cost time: 0.701411247253418
Epoch: 9, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.380 Vali Acc: 0.877 Test Loss: 0.380 Test Acc: 0.877
Validation loss decreased (-0.847822 --> -0.876808).  Saving model ...
Epoch: 10 cost time: 0.585869312286377
Epoch: 10, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.349 Vali Acc: 0.855 Test Loss: 0.349 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.620826244354248
Epoch: 11, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.325 Vali Acc: 0.891 Test Loss: 0.325 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 12 cost time: 0.6106643676757812
Epoch: 12, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.295 Vali Acc: 0.884 Test Loss: 0.295 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5786705017089844
Epoch: 13, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.280 Vali Acc: 0.891 Test Loss: 0.280 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891302).  Saving model ...
Epoch: 14 cost time: 0.5563831329345703
Epoch: 14, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.282 Vali Acc: 0.891 Test Loss: 0.282 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.577974796295166
Epoch: 15, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.272 Vali Acc: 0.891 Test Loss: 0.272 Test Acc: 0.891
Validation loss decreased (-0.891302 --> -0.891302).  Saving model ...
Epoch: 16 cost time: 0.6829535961151123
Epoch: 16, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.270 Vali Acc: 0.913 Test Loss: 0.270 Test Acc: 0.913
Validation loss decreased (-0.891302 --> -0.913041).  Saving model ...
Epoch: 17 cost time: 0.5820400714874268
Epoch: 17, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.269 Vali Acc: 0.899 Test Loss: 0.269 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5818712711334229
Epoch: 18, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.261 Vali Acc: 0.899 Test Loss: 0.261 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6904385089874268
Epoch: 19, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.259 Vali Acc: 0.899 Test Loss: 0.259 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6152811050415039
Epoch: 20, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.265 Vali Acc: 0.899 Test Loss: 0.265 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5607132911682129
Epoch: 21, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.259 Vali Acc: 0.899 Test Loss: 0.259 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6318399906158447
Epoch: 22, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.244 Vali Acc: 0.899 Test Loss: 0.244 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6182658672332764
Epoch: 23, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.225 Vali Acc: 0.899 Test Loss: 0.225 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6424660682678223
Epoch: 24, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.223 Vali Acc: 0.906 Test Loss: 0.223 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6278181076049805
Epoch: 25, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6540296077728271
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.232 Vali Acc: 0.906 Test Loss: 0.232 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 70756
model size : 0.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.107032060623169
Epoch: 1, Steps: 9 | Train Loss: 1.397 Vali Loss: 1.381 Vali Acc: 0.283 Test Loss: 1.381 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 0.6324117183685303
Epoch: 2, Steps: 9 | Train Loss: 1.348 Vali Loss: 1.327 Vali Acc: 0.384 Test Loss: 1.327 Test Acc: 0.384
Validation loss decreased (-0.282595 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 0.5899837017059326
Epoch: 3, Steps: 9 | Train Loss: 1.258 Vali Loss: 1.237 Vali Acc: 0.507 Test Loss: 1.237 Test Acc: 0.507
Validation loss decreased (-0.384045 --> -0.507234).  Saving model ...
Epoch: 4 cost time: 0.5624260902404785
Epoch: 4, Steps: 9 | Train Loss: 1.154 Vali Loss: 1.139 Vali Acc: 0.725 Test Loss: 1.139 Test Acc: 0.725
Validation loss decreased (-0.507234 --> -0.724626).  Saving model ...
Epoch: 5 cost time: 0.6886556148529053
Epoch: 5, Steps: 9 | Train Loss: 1.046 Vali Loss: 1.031 Vali Acc: 0.790 Test Loss: 1.031 Test Acc: 0.790
Validation loss decreased (-0.724626 --> -0.789845).  Saving model ...
Epoch: 6 cost time: 0.5881612300872803
Epoch: 6, Steps: 9 | Train Loss: 0.914 Vali Loss: 0.910 Vali Acc: 0.826 Test Loss: 0.910 Test Acc: 0.826
Validation loss decreased (-0.789845 --> -0.826078).  Saving model ...
Epoch: 7 cost time: 0.5549180507659912
Epoch: 7, Steps: 9 | Train Loss: 0.790 Vali Loss: 0.803 Vali Acc: 0.833 Test Loss: 0.803 Test Acc: 0.833
Validation loss decreased (-0.826078 --> -0.833325).  Saving model ...
Epoch: 8 cost time: 0.5796756744384766
Epoch: 8, Steps: 9 | Train Loss: 0.650 Vali Loss: 0.692 Vali Acc: 0.870 Test Loss: 0.692 Test Acc: 0.870
Validation loss decreased (-0.833325 --> -0.869558).  Saving model ...
Epoch: 9 cost time: 0.5961182117462158
Epoch: 9, Steps: 9 | Train Loss: 0.532 Vali Loss: 0.588 Vali Acc: 0.891 Test Loss: 0.588 Test Acc: 0.891
Validation loss decreased (-0.869558 --> -0.891298).  Saving model ...
Epoch: 10 cost time: 0.6374187469482422
Epoch: 10, Steps: 9 | Train Loss: 0.467 Vali Loss: 0.507 Vali Acc: 0.891 Test Loss: 0.507 Test Acc: 0.891
Validation loss decreased (-0.891298 --> -0.891299).  Saving model ...
Epoch: 11 cost time: 0.6239726543426514
Epoch: 11, Steps: 9 | Train Loss: 0.362 Vali Loss: 0.447 Vali Acc: 0.899 Test Loss: 0.447 Test Acc: 0.899
Validation loss decreased (-0.891299 --> -0.898546).  Saving model ...
Epoch: 12 cost time: 0.5745208263397217
Epoch: 12, Steps: 9 | Train Loss: 0.280 Vali Loss: 0.387 Vali Acc: 0.913 Test Loss: 0.387 Test Acc: 0.913
Validation loss decreased (-0.898546 --> -0.913040).  Saving model ...
Epoch: 13 cost time: 0.6456601619720459
Epoch: 13, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.356 Vali Acc: 0.920 Test Loss: 0.356 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920286).  Saving model ...
Epoch: 14 cost time: 0.6396307945251465
Epoch: 14, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.320 Vali Acc: 0.920 Test Loss: 0.320 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920287).  Saving model ...
Epoch: 15 cost time: 0.691441535949707
Epoch: 15, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.291 Vali Acc: 0.928 Test Loss: 0.291 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927533).  Saving model ...
Epoch: 16 cost time: 0.5608255863189697
Epoch: 16, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.272 Vali Acc: 0.928 Test Loss: 0.272 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927534).  Saving model ...
Epoch: 17 cost time: 0.5369491577148438
Epoch: 17, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.259 Vali Acc: 0.920 Test Loss: 0.259 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5711469650268555
Epoch: 18, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.242 Vali Acc: 0.920 Test Loss: 0.242 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6059832572937012
Epoch: 19, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.242 Vali Acc: 0.913 Test Loss: 0.242 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6640443801879883
Epoch: 20, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.235 Vali Acc: 0.913 Test Loss: 0.235 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6228158473968506
Epoch: 21, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.232 Vali Acc: 0.920 Test Loss: 0.232 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6339948177337646
Epoch: 22, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.224 Vali Acc: 0.920 Test Loss: 0.224 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.616044282913208
Epoch: 23, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 24 cost time: 0.647618293762207
Epoch: 24, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.198 Vali Acc: 0.935 Test Loss: 0.198 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934781).  Saving model ...
Epoch: 25 cost time: 0.6368892192840576
Epoch: 25, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.198 Vali Acc: 0.935 Test Loss: 0.198 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 26 cost time: 0.5594844818115234
Epoch: 26, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.206 Vali Acc: 0.920 Test Loss: 0.206 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5837407112121582
Epoch: 27, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.198 Vali Acc: 0.920 Test Loss: 0.198 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6179208755493164
Epoch: 28, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.178 Vali Acc: 0.928 Test Loss: 0.178 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6605768203735352
Epoch: 29, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.183 Vali Acc: 0.928 Test Loss: 0.183 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6883440017700195
Epoch: 30, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.195 Vali Acc: 0.920 Test Loss: 0.195 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6486563682556152
Epoch: 31, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.193 Vali Acc: 0.928 Test Loss: 0.193 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6425518989562988
Epoch: 32, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.191 Vali Acc: 0.928 Test Loss: 0.191 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6460130214691162
Epoch: 33, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.192 Vali Acc: 0.928 Test Loss: 0.192 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.5574092864990234
Epoch: 34, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.190 Vali Acc: 0.928 Test Loss: 0.190 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6903557777404785
Epoch: 35, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.189 Vali Acc: 0.928 Test Loss: 0.189 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 57860
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8380563259124756
Epoch: 1, Steps: 9 | Train Loss: 1.349 Vali Loss: 1.332 Vali Acc: 0.370 Test Loss: 1.332 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 0.5666670799255371
Epoch: 2, Steps: 9 | Train Loss: 1.296 Vali Loss: 1.284 Vali Acc: 0.457 Test Loss: 1.284 Test Acc: 0.457
Validation loss decreased (-0.369552 --> -0.456509).  Saving model ...
Epoch: 3 cost time: 0.6191990375518799
Epoch: 3, Steps: 9 | Train Loss: 1.226 Vali Loss: 1.216 Vali Acc: 0.522 Test Loss: 1.216 Test Acc: 0.522
Validation loss decreased (-0.456509 --> -0.521727).  Saving model ...
Epoch: 4 cost time: 0.64461350440979
Epoch: 4, Steps: 9 | Train Loss: 1.144 Vali Loss: 1.136 Vali Acc: 0.630 Test Loss: 1.136 Test Acc: 0.630
Validation loss decreased (-0.521727 --> -0.630423).  Saving model ...
Epoch: 5 cost time: 0.6260387897491455
Epoch: 5, Steps: 9 | Train Loss: 1.035 Vali Loss: 1.044 Vali Acc: 0.645 Test Loss: 1.044 Test Acc: 0.645
Validation loss decreased (-0.630423 --> -0.644917).  Saving model ...
Epoch: 6 cost time: 0.6560728549957275
Epoch: 6, Steps: 9 | Train Loss: 0.953 Vali Loss: 0.948 Vali Acc: 0.696 Test Loss: 0.948 Test Acc: 0.696
Validation loss decreased (-0.644917 --> -0.695643).  Saving model ...
Epoch: 7 cost time: 0.6058225631713867
Epoch: 7, Steps: 9 | Train Loss: 0.794 Vali Loss: 0.859 Vali Acc: 0.768 Test Loss: 0.859 Test Acc: 0.768
Validation loss decreased (-0.695643 --> -0.768107).  Saving model ...
Epoch: 8 cost time: 0.6003060340881348
Epoch: 8, Steps: 9 | Train Loss: 0.690 Vali Loss: 0.775 Vali Acc: 0.783 Test Loss: 0.775 Test Acc: 0.783
Validation loss decreased (-0.768107 --> -0.782601).  Saving model ...
Epoch: 9 cost time: 0.6013708114624023
Epoch: 9, Steps: 9 | Train Loss: 0.608 Vali Loss: 0.692 Vali Acc: 0.819 Test Loss: 0.692 Test Acc: 0.819
Validation loss decreased (-0.782601 --> -0.818834).  Saving model ...
Epoch: 10 cost time: 0.6109158992767334
Epoch: 10, Steps: 9 | Train Loss: 0.499 Vali Loss: 0.605 Vali Acc: 0.833 Test Loss: 0.605 Test Acc: 0.833
Validation loss decreased (-0.818834 --> -0.833327).  Saving model ...
Epoch: 11 cost time: 0.5905613899230957
Epoch: 11, Steps: 9 | Train Loss: 0.425 Vali Loss: 0.545 Vali Acc: 0.862 Test Loss: 0.545 Test Acc: 0.862
Validation loss decreased (-0.833327 --> -0.862313).  Saving model ...
Epoch: 12 cost time: 0.6472289562225342
Epoch: 12, Steps: 9 | Train Loss: 0.362 Vali Loss: 0.499 Vali Acc: 0.870 Test Loss: 0.499 Test Acc: 0.870
Validation loss decreased (-0.862313 --> -0.869560).  Saving model ...
Epoch: 13 cost time: 0.5452523231506348
Epoch: 13, Steps: 9 | Train Loss: 0.296 Vali Loss: 0.447 Vali Acc: 0.877 Test Loss: 0.447 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876807).  Saving model ...
Epoch: 14 cost time: 0.66330885887146
Epoch: 14, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.411 Vali Acc: 0.891 Test Loss: 0.411 Test Acc: 0.891
Validation loss decreased (-0.876807 --> -0.891300).  Saving model ...
Epoch: 15 cost time: 0.6278355121612549
Epoch: 15, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.385 Vali Acc: 0.884 Test Loss: 0.385 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6220462322235107
Epoch: 16, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.364 Vali Acc: 0.891 Test Loss: 0.364 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891301).  Saving model ...
Epoch: 17 cost time: 0.6026461124420166
Epoch: 17, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.344 Vali Acc: 0.884 Test Loss: 0.344 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5790603160858154
Epoch: 18, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.326 Vali Acc: 0.891 Test Loss: 0.326 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 19 cost time: 0.5942842960357666
Epoch: 19, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.307 Vali Acc: 0.891 Test Loss: 0.307 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 20 cost time: 0.6368653774261475
Epoch: 20, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.301 Vali Acc: 0.891 Test Loss: 0.301 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 21 cost time: 0.5821943283081055
Epoch: 21, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.302 Vali Acc: 0.891 Test Loss: 0.302 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6098001003265381
Epoch: 22, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.298 Vali Acc: 0.891 Test Loss: 0.298 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 23 cost time: 0.5609924793243408
Epoch: 23, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.266 Vali Acc: 0.899 Test Loss: 0.266 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 24 cost time: 0.5498867034912109
Epoch: 24, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.266 Vali Acc: 0.906 Test Loss: 0.266 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 25 cost time: 0.5866305828094482
Epoch: 25, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.263 Vali Acc: 0.906 Test Loss: 0.263 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 26 cost time: 0.5732800960540771
Epoch: 26, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905795).  Saving model ...
Epoch: 27 cost time: 0.6058413982391357
Epoch: 27, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.255 Vali Acc: 0.906 Test Loss: 0.255 Test Acc: 0.906
Validation loss decreased (-0.905795 --> -0.905795).  Saving model ...
Epoch: 28 cost time: 0.6865894794464111
Epoch: 28, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.249 Vali Acc: 0.913 Test Loss: 0.249 Test Acc: 0.913
Validation loss decreased (-0.905795 --> -0.913041).  Saving model ...
Epoch: 29 cost time: 0.5748372077941895
Epoch: 29, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.255 Vali Acc: 0.913 Test Loss: 0.255 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5935451984405518
Epoch: 30, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.248 Vali Acc: 0.906 Test Loss: 0.248 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5941746234893799
Epoch: 31, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.244 Vali Acc: 0.913 Test Loss: 0.244 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 32 cost time: 0.6287581920623779
Epoch: 32, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.236 Vali Acc: 0.913 Test Loss: 0.236 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 33 cost time: 0.6055171489715576
Epoch: 33, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.237 Vali Acc: 0.913 Test Loss: 0.237 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6245732307434082
Epoch: 34, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.234 Vali Acc: 0.913 Test Loss: 0.234 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 35 cost time: 0.6794052124023438
Epoch: 35, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.232 Vali Acc: 0.913 Test Loss: 0.232 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 36 cost time: 0.611159086227417
Epoch: 36, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.226 Vali Acc: 0.920 Test Loss: 0.226 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920288).  Saving model ...
Epoch: 37 cost time: 0.6121540069580078
Epoch: 37, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.227 Vali Acc: 0.920 Test Loss: 0.227 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.688478946685791
Epoch: 38, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.238 Vali Acc: 0.913 Test Loss: 0.238 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6050820350646973
Epoch: 39, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.245 Vali Acc: 0.913 Test Loss: 0.245 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6032967567443848
Epoch: 40, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.239 Vali Acc: 0.913 Test Loss: 0.239 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5872466564178467
Epoch: 41, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.245 Vali Acc: 0.913 Test Loss: 0.245 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6307103633880615
Epoch: 42, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.244 Vali Acc: 0.913 Test Loss: 0.244 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.5809032917022705
Epoch: 43, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.249 Vali Acc: 0.913 Test Loss: 0.249 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6245906352996826
Epoch: 44, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.245 Vali Acc: 0.913 Test Loss: 0.245 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.6146068572998047
Epoch: 45, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.240 Vali Acc: 0.913 Test Loss: 0.240 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.590360164642334
Epoch: 46, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.232 Vali Acc: 0.913 Test Loss: 0.232 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 54948
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1289613246917725
Epoch: 1, Steps: 9 | Train Loss: 1.411 Vali Loss: 1.386 Vali Acc: 0.239 Test Loss: 1.386 Test Acc: 0.239
Validation loss decreased (inf --> -0.239117).  Saving model ...
Epoch: 2 cost time: 0.5588147640228271
Epoch: 2, Steps: 9 | Train Loss: 1.353 Vali Loss: 1.349 Vali Acc: 0.268 Test Loss: 1.349 Test Acc: 0.268
Validation loss decreased (-0.239117 --> -0.268102).  Saving model ...
Epoch: 3 cost time: 0.7032599449157715
Epoch: 3, Steps: 9 | Train Loss: 1.307 Vali Loss: 1.296 Vali Acc: 0.362 Test Loss: 1.296 Test Acc: 0.362
Validation loss decreased (-0.268102 --> -0.362306).  Saving model ...
Epoch: 4 cost time: 0.66609787940979
Epoch: 4, Steps: 9 | Train Loss: 1.236 Vali Loss: 1.231 Vali Acc: 0.507 Test Loss: 1.231 Test Acc: 0.507
Validation loss decreased (-0.362306 --> -0.507234).  Saving model ...
Epoch: 5 cost time: 0.556126594543457
Epoch: 5, Steps: 9 | Train Loss: 1.152 Vali Loss: 1.162 Vali Acc: 0.594 Test Loss: 1.162 Test Acc: 0.594
Validation loss decreased (-0.507234 --> -0.594191).  Saving model ...
Epoch: 6 cost time: 0.5678994655609131
Epoch: 6, Steps: 9 | Train Loss: 1.074 Vali Loss: 1.086 Vali Acc: 0.681 Test Loss: 1.086 Test Acc: 0.681
Validation loss decreased (-0.594191 --> -0.681149).  Saving model ...
Epoch: 7 cost time: 0.5405256748199463
Epoch: 7, Steps: 9 | Train Loss: 0.987 Vali Loss: 1.009 Vali Acc: 0.725 Test Loss: 1.009 Test Acc: 0.725
Validation loss decreased (-0.681149 --> -0.724628).  Saving model ...
Epoch: 8 cost time: 0.5930631160736084
Epoch: 8, Steps: 9 | Train Loss: 0.906 Vali Loss: 0.933 Vali Acc: 0.790 Test Loss: 0.933 Test Acc: 0.790
Validation loss decreased (-0.724628 --> -0.789846).  Saving model ...
Epoch: 9 cost time: 0.6558122634887695
Epoch: 9, Steps: 9 | Train Loss: 0.801 Vali Loss: 0.857 Vali Acc: 0.804 Test Loss: 0.857 Test Acc: 0.804
Validation loss decreased (-0.789846 --> -0.804339).  Saving model ...
Epoch: 10 cost time: 0.6351351737976074
Epoch: 10, Steps: 9 | Train Loss: 0.708 Vali Loss: 0.774 Vali Acc: 0.841 Test Loss: 0.774 Test Acc: 0.841
Validation loss decreased (-0.804339 --> -0.840572).  Saving model ...
Epoch: 11 cost time: 0.6348202228546143
Epoch: 11, Steps: 9 | Train Loss: 0.629 Vali Loss: 0.706 Vali Acc: 0.855 Test Loss: 0.706 Test Acc: 0.855
Validation loss decreased (-0.840572 --> -0.855065).  Saving model ...
Epoch: 12 cost time: 0.5724310874938965
Epoch: 12, Steps: 9 | Train Loss: 0.545 Vali Loss: 0.644 Vali Acc: 0.862 Test Loss: 0.644 Test Acc: 0.862
Validation loss decreased (-0.855065 --> -0.862312).  Saving model ...
Epoch: 13 cost time: 0.6716737747192383
Epoch: 13, Steps: 9 | Train Loss: 0.475 Vali Loss: 0.592 Vali Acc: 0.877 Test Loss: 0.592 Test Acc: 0.877
Validation loss decreased (-0.862312 --> -0.876806).  Saving model ...
Epoch: 14 cost time: 0.6063477993011475
Epoch: 14, Steps: 9 | Train Loss: 0.404 Vali Loss: 0.540 Vali Acc: 0.891 Test Loss: 0.540 Test Acc: 0.891
Validation loss decreased (-0.876806 --> -0.891299).  Saving model ...
Epoch: 15 cost time: 0.5668082237243652
Epoch: 15, Steps: 9 | Train Loss: 0.351 Vali Loss: 0.504 Vali Acc: 0.862 Test Loss: 0.504 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6709249019622803
Epoch: 16, Steps: 9 | Train Loss: 0.306 Vali Loss: 0.464 Vali Acc: 0.906 Test Loss: 0.464 Test Acc: 0.906
Validation loss decreased (-0.891299 --> -0.905792).  Saving model ...
Epoch: 17 cost time: 0.5469186305999756
Epoch: 17, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.434 Vali Acc: 0.906 Test Loss: 0.434 Test Acc: 0.906
Validation loss decreased (-0.905792 --> -0.905793).  Saving model ...
Epoch: 18 cost time: 0.6093571186065674
Epoch: 18, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.412 Vali Acc: 0.906 Test Loss: 0.412 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 19 cost time: 0.6047072410583496
Epoch: 19, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.391 Vali Acc: 0.870 Test Loss: 0.391 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7078523635864258
Epoch: 20, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.369 Vali Acc: 0.877 Test Loss: 0.369 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5914676189422607
Epoch: 21, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.357 Vali Acc: 0.891 Test Loss: 0.357 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6367425918579102
Epoch: 22, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.362 Vali Acc: 0.877 Test Loss: 0.362 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6356174945831299
Epoch: 23, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.360 Vali Acc: 0.877 Test Loss: 0.360 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6337130069732666
Epoch: 24, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.350 Vali Acc: 0.891 Test Loss: 0.350 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5679402351379395
Epoch: 25, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.342 Vali Acc: 0.891 Test Loss: 0.342 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5593194961547852
Epoch: 26, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.325 Vali Acc: 0.884 Test Loss: 0.325 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5717413425445557
Epoch: 27, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.323 Vali Acc: 0.891 Test Loss: 0.323 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6209506988525391
Epoch: 28, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.314 Vali Acc: 0.877 Test Loss: 0.314 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 52036
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0749497413635254
Epoch: 1, Steps: 9 | Train Loss: 1.380 Vali Loss: 1.370 Vali Acc: 0.312 Test Loss: 1.370 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 0.5843422412872314
Epoch: 2, Steps: 9 | Train Loss: 1.343 Vali Loss: 1.350 Vali Acc: 0.297 Test Loss: 1.350 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5918564796447754
Epoch: 3, Steps: 9 | Train Loss: 1.289 Vali Loss: 1.315 Vali Acc: 0.333 Test Loss: 1.315 Test Acc: 0.333
Validation loss decreased (-0.311580 --> -0.333320).  Saving model ...
Epoch: 4 cost time: 0.5657012462615967
Epoch: 4, Steps: 9 | Train Loss: 1.244 Vali Loss: 1.274 Vali Acc: 0.377 Test Loss: 1.274 Test Acc: 0.377
Validation loss decreased (-0.333320 --> -0.376799).  Saving model ...
Epoch: 5 cost time: 0.5923426151275635
Epoch: 5, Steps: 9 | Train Loss: 1.200 Vali Loss: 1.223 Vali Acc: 0.457 Test Loss: 1.223 Test Acc: 0.457
Validation loss decreased (-0.376799 --> -0.456510).  Saving model ...
Epoch: 6 cost time: 0.5944592952728271
Epoch: 6, Steps: 9 | Train Loss: 1.136 Vali Loss: 1.170 Vali Acc: 0.522 Test Loss: 1.170 Test Acc: 0.522
Validation loss decreased (-0.456510 --> -0.521727).  Saving model ...
Epoch: 7 cost time: 0.7729647159576416
Epoch: 7, Steps: 9 | Train Loss: 1.065 Vali Loss: 1.116 Vali Acc: 0.616 Test Loss: 1.116 Test Acc: 0.616
Validation loss decreased (-0.521727 --> -0.615931).  Saving model ...
Epoch: 8 cost time: 0.5829792022705078
Epoch: 8, Steps: 9 | Train Loss: 0.984 Vali Loss: 1.056 Vali Acc: 0.667 Test Loss: 1.056 Test Acc: 0.667
Validation loss decreased (-0.615931 --> -0.666656).  Saving model ...
Epoch: 9 cost time: 0.6113088130950928
Epoch: 9, Steps: 9 | Train Loss: 0.947 Vali Loss: 0.984 Vali Acc: 0.717 Test Loss: 0.984 Test Acc: 0.717
Validation loss decreased (-0.666656 --> -0.717381).  Saving model ...
Epoch: 10 cost time: 0.6033921241760254
Epoch: 10, Steps: 9 | Train Loss: 0.866 Vali Loss: 0.915 Vali Acc: 0.746 Test Loss: 0.915 Test Acc: 0.746
Validation loss decreased (-0.717381 --> -0.746368).  Saving model ...
Epoch: 11 cost time: 0.6268103122711182
Epoch: 11, Steps: 9 | Train Loss: 0.779 Vali Loss: 0.853 Vali Acc: 0.768 Test Loss: 0.853 Test Acc: 0.768
Validation loss decreased (-0.746368 --> -0.768107).  Saving model ...
Epoch: 12 cost time: 0.5822093486785889
Epoch: 12, Steps: 9 | Train Loss: 0.699 Vali Loss: 0.794 Vali Acc: 0.783 Test Loss: 0.794 Test Acc: 0.783
Validation loss decreased (-0.768107 --> -0.782601).  Saving model ...
Epoch: 13 cost time: 0.6083946228027344
Epoch: 13, Steps: 9 | Train Loss: 0.639 Vali Loss: 0.740 Vali Acc: 0.783 Test Loss: 0.740 Test Acc: 0.783
Validation loss decreased (-0.782601 --> -0.782601).  Saving model ...
Epoch: 14 cost time: 0.6014385223388672
Epoch: 14, Steps: 9 | Train Loss: 0.588 Vali Loss: 0.683 Vali Acc: 0.804 Test Loss: 0.683 Test Acc: 0.804
Validation loss decreased (-0.782601 --> -0.804341).  Saving model ...
Epoch: 15 cost time: 0.6157464981079102
Epoch: 15, Steps: 9 | Train Loss: 0.506 Vali Loss: 0.629 Vali Acc: 0.804 Test Loss: 0.629 Test Acc: 0.804
Validation loss decreased (-0.804341 --> -0.804342).  Saving model ...
Epoch: 16 cost time: 0.6273841857910156
Epoch: 16, Steps: 9 | Train Loss: 0.471 Vali Loss: 0.583 Vali Acc: 0.826 Test Loss: 0.583 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826081).  Saving model ...
Epoch: 17 cost time: 0.6375844478607178
Epoch: 17, Steps: 9 | Train Loss: 0.400 Vali Loss: 0.535 Vali Acc: 0.826 Test Loss: 0.535 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826082).  Saving model ...
Epoch: 18 cost time: 0.5601327419281006
Epoch: 18, Steps: 9 | Train Loss: 0.364 Vali Loss: 0.506 Vali Acc: 0.833 Test Loss: 0.506 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 19 cost time: 0.5941812992095947
Epoch: 19, Steps: 9 | Train Loss: 0.316 Vali Loss: 0.481 Vali Acc: 0.833 Test Loss: 0.481 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 20 cost time: 0.5545308589935303
Epoch: 20, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.455 Vali Acc: 0.841 Test Loss: 0.455 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 21 cost time: 0.6191897392272949
Epoch: 21, Steps: 9 | Train Loss: 0.257 Vali Loss: 0.432 Vali Acc: 0.848 Test Loss: 0.432 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 22 cost time: 0.6263344287872314
Epoch: 22, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.421 Vali Acc: 0.841 Test Loss: 0.421 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6139488220214844
Epoch: 23, Steps: 9 | Train Loss: 0.198 Vali Loss: 0.404 Vali Acc: 0.855 Test Loss: 0.404 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 24 cost time: 0.570120096206665
Epoch: 24, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.393 Vali Acc: 0.841 Test Loss: 0.393 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.630807638168335
Epoch: 25, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.376 Vali Acc: 0.862 Test Loss: 0.376 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 26 cost time: 0.6365189552307129
Epoch: 26, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.364 Vali Acc: 0.877 Test Loss: 0.364 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 27 cost time: 0.6361932754516602
Epoch: 27, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.361 Vali Acc: 0.877 Test Loss: 0.361 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 28 cost time: 0.6216952800750732
Epoch: 28, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.346 Vali Acc: 0.877 Test Loss: 0.346 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 29 cost time: 0.6036548614501953
Epoch: 29, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.332 Vali Acc: 0.870 Test Loss: 0.332 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6376121044158936
Epoch: 30, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.333 Vali Acc: 0.877 Test Loss: 0.333 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 31 cost time: 0.609344482421875
Epoch: 31, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.338 Vali Acc: 0.877 Test Loss: 0.338 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6086490154266357
Epoch: 32, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.338 Vali Acc: 0.877 Test Loss: 0.338 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6154994964599609
Epoch: 33, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.334 Vali Acc: 0.884 Test Loss: 0.334 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 34 cost time: 0.5959892272949219
Epoch: 34, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.314 Vali Acc: 0.877 Test Loss: 0.314 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6113247871398926
Epoch: 35, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.310 Vali Acc: 0.870 Test Loss: 0.310 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.768197774887085
Epoch: 36, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.307 Vali Acc: 0.877 Test Loss: 0.307 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6215803623199463
Epoch: 37, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.306 Vali Acc: 0.884 Test Loss: 0.306 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 38 cost time: 0.6260128021240234
Epoch: 38, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.309 Vali Acc: 0.884 Test Loss: 0.309 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5844295024871826
Epoch: 39, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.304 Vali Acc: 0.891 Test Loss: 0.304 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 40 cost time: 0.6125259399414062
Epoch: 40, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.304 Vali Acc: 0.891 Test Loss: 0.304 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5943663120269775
Epoch: 41, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.303 Vali Acc: 0.884 Test Loss: 0.303 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5982441902160645
Epoch: 42, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.306 Vali Acc: 0.899 Test Loss: 0.306 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 43 cost time: 0.6378321647644043
Epoch: 43, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 44 cost time: 0.6377873420715332
Epoch: 44, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.293 Vali Acc: 0.899 Test Loss: 0.293 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.647676944732666
Epoch: 45, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.277 Vali Acc: 0.891 Test Loss: 0.277 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6619703769683838
Epoch: 46, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.280 Vali Acc: 0.913 Test Loss: 0.280 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 47 cost time: 0.5979559421539307
Epoch: 47, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.291 Vali Acc: 0.913 Test Loss: 0.291 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5832171440124512
Epoch: 48, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.307 Vali Acc: 0.899 Test Loss: 0.307 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6126348972320557
Epoch: 49, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.313 Vali Acc: 0.899 Test Loss: 0.313 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6521053314208984
Epoch: 50, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.310 Vali Acc: 0.906 Test Loss: 0.310 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 50052
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.963447093963623
Epoch: 1, Steps: 9 | Train Loss: 1.445 Vali Loss: 1.428 Vali Acc: 0.188 Test Loss: 1.428 Test Acc: 0.188
Validation loss decreased (inf --> -0.188392).  Saving model ...
Epoch: 2 cost time: 0.5911843776702881
Epoch: 2, Steps: 9 | Train Loss: 1.413 Vali Loss: 1.412 Vali Acc: 0.210 Test Loss: 1.412 Test Acc: 0.210
Validation loss decreased (-0.188392 --> -0.210131).  Saving model ...
Epoch: 3 cost time: 0.5924911499023438
Epoch: 3, Steps: 9 | Train Loss: 1.391 Vali Loss: 1.381 Vali Acc: 0.268 Test Loss: 1.381 Test Acc: 0.268
Validation loss decreased (-0.210131 --> -0.268102).  Saving model ...
Epoch: 4 cost time: 0.5989727973937988
Epoch: 4, Steps: 9 | Train Loss: 1.338 Vali Loss: 1.337 Vali Acc: 0.304 Test Loss: 1.337 Test Acc: 0.304
Validation loss decreased (-0.268102 --> -0.304334).  Saving model ...
Epoch: 5 cost time: 0.5798790454864502
Epoch: 5, Steps: 9 | Train Loss: 1.274 Vali Loss: 1.290 Vali Acc: 0.413 Test Loss: 1.290 Test Acc: 0.413
Validation loss decreased (-0.304334 --> -0.413031).  Saving model ...
Epoch: 6 cost time: 0.6657979488372803
Epoch: 6, Steps: 9 | Train Loss: 1.214 Vali Loss: 1.235 Vali Acc: 0.464 Test Loss: 1.235 Test Acc: 0.464
Validation loss decreased (-0.413031 --> -0.463756).  Saving model ...
Epoch: 7 cost time: 0.624079704284668
Epoch: 7, Steps: 9 | Train Loss: 1.138 Vali Loss: 1.179 Vali Acc: 0.601 Test Loss: 1.179 Test Acc: 0.601
Validation loss decreased (-0.463756 --> -0.601437).  Saving model ...
Epoch: 8 cost time: 0.6260251998901367
Epoch: 8, Steps: 9 | Train Loss: 1.071 Vali Loss: 1.113 Vali Acc: 0.645 Test Loss: 1.113 Test Acc: 0.645
Validation loss decreased (-0.601437 --> -0.644916).  Saving model ...
Epoch: 9 cost time: 0.594970703125
Epoch: 9, Steps: 9 | Train Loss: 0.990 Vali Loss: 1.047 Vali Acc: 0.681 Test Loss: 1.047 Test Acc: 0.681
Validation loss decreased (-0.644916 --> -0.681149).  Saving model ...
Epoch: 10 cost time: 0.5747792720794678
Epoch: 10, Steps: 9 | Train Loss: 0.922 Vali Loss: 0.974 Vali Acc: 0.710 Test Loss: 0.974 Test Acc: 0.710
Validation loss decreased (-0.681149 --> -0.710135).  Saving model ...
Epoch: 11 cost time: 0.5679004192352295
Epoch: 11, Steps: 9 | Train Loss: 0.862 Vali Loss: 0.913 Vali Acc: 0.732 Test Loss: 0.913 Test Acc: 0.732
Validation loss decreased (-0.710135 --> -0.731875).  Saving model ...
Epoch: 12 cost time: 0.5867099761962891
Epoch: 12, Steps: 9 | Train Loss: 0.777 Vali Loss: 0.853 Vali Acc: 0.717 Test Loss: 0.853 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6257975101470947
Epoch: 13, Steps: 9 | Train Loss: 0.693 Vali Loss: 0.799 Vali Acc: 0.732 Test Loss: 0.799 Test Acc: 0.732
Validation loss decreased (-0.731875 --> -0.731876).  Saving model ...
Epoch: 14 cost time: 0.6012158393859863
Epoch: 14, Steps: 9 | Train Loss: 0.625 Vali Loss: 0.748 Vali Acc: 0.754 Test Loss: 0.748 Test Acc: 0.754
Validation loss decreased (-0.731876 --> -0.753616).  Saving model ...
Epoch: 15 cost time: 0.6152763366699219
Epoch: 15, Steps: 9 | Train Loss: 0.564 Vali Loss: 0.709 Vali Acc: 0.761 Test Loss: 0.709 Test Acc: 0.761
Validation loss decreased (-0.753616 --> -0.760862).  Saving model ...
Epoch: 16 cost time: 0.6160252094268799
Epoch: 16, Steps: 9 | Train Loss: 0.527 Vali Loss: 0.667 Vali Acc: 0.768 Test Loss: 0.667 Test Acc: 0.768
Validation loss decreased (-0.760862 --> -0.768109).  Saving model ...
Epoch: 17 cost time: 0.6436278820037842
Epoch: 17, Steps: 9 | Train Loss: 0.466 Vali Loss: 0.640 Vali Acc: 0.804 Test Loss: 0.640 Test Acc: 0.804
Validation loss decreased (-0.768109 --> -0.804341).  Saving model ...
Epoch: 18 cost time: 0.5999815464019775
Epoch: 18, Steps: 9 | Train Loss: 0.437 Vali Loss: 0.606 Vali Acc: 0.804 Test Loss: 0.606 Test Acc: 0.804
Validation loss decreased (-0.804341 --> -0.804342).  Saving model ...
Epoch: 19 cost time: 0.5756444931030273
Epoch: 19, Steps: 9 | Train Loss: 0.395 Vali Loss: 0.575 Vali Acc: 0.812 Test Loss: 0.575 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811588).  Saving model ...
Epoch: 20 cost time: 0.6241908073425293
Epoch: 20, Steps: 9 | Train Loss: 0.349 Vali Loss: 0.551 Vali Acc: 0.804 Test Loss: 0.551 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6266396045684814
Epoch: 21, Steps: 9 | Train Loss: 0.335 Vali Loss: 0.530 Vali Acc: 0.797 Test Loss: 0.530 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5774803161621094
Epoch: 22, Steps: 9 | Train Loss: 0.320 Vali Loss: 0.506 Vali Acc: 0.812 Test Loss: 0.506 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811589).  Saving model ...
Epoch: 23 cost time: 0.6567032337188721
Epoch: 23, Steps: 9 | Train Loss: 0.263 Vali Loss: 0.482 Vali Acc: 0.862 Test Loss: 0.482 Test Acc: 0.862
Validation loss decreased (-0.811589 --> -0.862314).  Saving model ...
Epoch: 24 cost time: 0.6050126552581787
Epoch: 24, Steps: 9 | Train Loss: 0.239 Vali Loss: 0.469 Vali Acc: 0.862 Test Loss: 0.469 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 25 cost time: 0.6287841796875
Epoch: 25, Steps: 9 | Train Loss: 0.210 Vali Loss: 0.458 Vali Acc: 0.848 Test Loss: 0.458 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6435515880584717
Epoch: 26, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.439 Vali Acc: 0.870 Test Loss: 0.439 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 27 cost time: 0.6235949993133545
Epoch: 27, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.423 Vali Acc: 0.891 Test Loss: 0.423 Test Acc: 0.891
Validation loss decreased (-0.869561 --> -0.891300).  Saving model ...
Epoch: 28 cost time: 0.6020071506500244
Epoch: 28, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.405 Vali Acc: 0.891 Test Loss: 0.405 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 29 cost time: 0.6159846782684326
Epoch: 29, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.389 Vali Acc: 0.877 Test Loss: 0.389 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6127848625183105
Epoch: 30, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.380 Vali Acc: 0.891 Test Loss: 0.380 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891301).  Saving model ...
Epoch: 31 cost time: 0.6222062110900879
Epoch: 31, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.368 Vali Acc: 0.891 Test Loss: 0.368 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 32 cost time: 0.5750143527984619
Epoch: 32, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.363 Vali Acc: 0.899 Test Loss: 0.363 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 33 cost time: 0.6069917678833008
Epoch: 33, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.351 Vali Acc: 0.899 Test Loss: 0.351 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 34 cost time: 0.576115608215332
Epoch: 34, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.348 Vali Acc: 0.899 Test Loss: 0.348 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 35 cost time: 0.5706226825714111
Epoch: 35, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.345 Vali Acc: 0.899 Test Loss: 0.345 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 36 cost time: 0.6253161430358887
Epoch: 36, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.337 Vali Acc: 0.899 Test Loss: 0.337 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 37 cost time: 0.6050691604614258
Epoch: 37, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.337 Vali Acc: 0.906 Test Loss: 0.337 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 38 cost time: 0.5591309070587158
Epoch: 38, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.334 Vali Acc: 0.899 Test Loss: 0.334 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5906174182891846
Epoch: 39, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.330 Vali Acc: 0.906 Test Loss: 0.330 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 40 cost time: 0.6150200366973877
Epoch: 40, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.333 Vali Acc: 0.906 Test Loss: 0.333 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5254113674163818
Epoch: 41, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.335 Vali Acc: 0.899 Test Loss: 0.335 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5714676380157471
Epoch: 42, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.337 Vali Acc: 0.899 Test Loss: 0.337 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5608036518096924
Epoch: 43, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.314 Vali Acc: 0.891 Test Loss: 0.314 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.5767316818237305
Epoch: 44, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.300 Vali Acc: 0.891 Test Loss: 0.300 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.5774595737457275
Epoch: 45, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.303 Vali Acc: 0.899 Test Loss: 0.303 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.5911140441894531
Epoch: 46, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 47 cost time: 0.6184401512145996
Epoch: 47, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.306 Vali Acc: 0.899 Test Loss: 0.306 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6304712295532227
Epoch: 48, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.302 Vali Acc: 0.899 Test Loss: 0.302 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5790963172912598
Epoch: 49, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.304 Vali Acc: 0.906 Test Loss: 0.304 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 50 cost time: 0.5772638320922852
Epoch: 50, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.302 Vali Acc: 0.899 Test Loss: 0.302 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 49636
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8497071266174316
Epoch: 1, Steps: 9 | Train Loss: 1.398 Vali Loss: 1.387 Vali Acc: 0.254 Test Loss: 1.387 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 0.5800895690917969
Epoch: 2, Steps: 9 | Train Loss: 1.373 Vali Loss: 1.367 Vali Acc: 0.304 Test Loss: 1.367 Test Acc: 0.304
Validation loss decreased (-0.253609 --> -0.304334).  Saving model ...
Epoch: 3 cost time: 0.5508804321289062
Epoch: 3, Steps: 9 | Train Loss: 1.326 Vali Loss: 1.339 Vali Acc: 0.362 Test Loss: 1.339 Test Acc: 0.362
Validation loss decreased (-0.304334 --> -0.362305).  Saving model ...
Epoch: 4 cost time: 0.6262533664703369
Epoch: 4, Steps: 9 | Train Loss: 1.296 Vali Loss: 1.306 Vali Acc: 0.406 Test Loss: 1.306 Test Acc: 0.406
Validation loss decreased (-0.362305 --> -0.405784).  Saving model ...
Epoch: 5 cost time: 0.5683281421661377
Epoch: 5, Steps: 9 | Train Loss: 1.262 Vali Loss: 1.267 Vali Acc: 0.449 Test Loss: 1.267 Test Acc: 0.449
Validation loss decreased (-0.405784 --> -0.449263).  Saving model ...
Epoch: 6 cost time: 0.6632411479949951
Epoch: 6, Steps: 9 | Train Loss: 1.201 Vali Loss: 1.220 Vali Acc: 0.478 Test Loss: 1.220 Test Acc: 0.478
Validation loss decreased (-0.449263 --> -0.478249).  Saving model ...
Epoch: 7 cost time: 0.6282575130462646
Epoch: 7, Steps: 9 | Train Loss: 1.139 Vali Loss: 1.173 Vali Acc: 0.572 Test Loss: 1.173 Test Acc: 0.572
Validation loss decreased (-0.478249 --> -0.572452).  Saving model ...
Epoch: 8 cost time: 0.6981034278869629
Epoch: 8, Steps: 9 | Train Loss: 1.078 Vali Loss: 1.127 Vali Acc: 0.594 Test Loss: 1.127 Test Acc: 0.594
Validation loss decreased (-0.572452 --> -0.594192).  Saving model ...
Epoch: 9 cost time: 0.6000022888183594
Epoch: 9, Steps: 9 | Train Loss: 1.006 Vali Loss: 1.069 Vali Acc: 0.638 Test Loss: 1.069 Test Acc: 0.638
Validation loss decreased (-0.594192 --> -0.637670).  Saving model ...
Epoch: 10 cost time: 0.5492136478424072
Epoch: 10, Steps: 9 | Train Loss: 0.952 Vali Loss: 1.008 Vali Acc: 0.659 Test Loss: 1.008 Test Acc: 0.659
Validation loss decreased (-0.637670 --> -0.659410).  Saving model ...
Epoch: 11 cost time: 0.5568668842315674
Epoch: 11, Steps: 9 | Train Loss: 0.872 Vali Loss: 0.958 Vali Acc: 0.696 Test Loss: 0.958 Test Acc: 0.696
Validation loss decreased (-0.659410 --> -0.695643).  Saving model ...
Epoch: 12 cost time: 0.601581335067749
Epoch: 12, Steps: 9 | Train Loss: 0.811 Vali Loss: 0.898 Vali Acc: 0.710 Test Loss: 0.898 Test Acc: 0.710
Validation loss decreased (-0.695643 --> -0.710136).  Saving model ...
Epoch: 13 cost time: 0.5835170745849609
Epoch: 13, Steps: 9 | Train Loss: 0.739 Vali Loss: 0.842 Vali Acc: 0.725 Test Loss: 0.842 Test Acc: 0.725
Validation loss decreased (-0.710136 --> -0.724629).  Saving model ...
Epoch: 14 cost time: 0.6269955635070801
Epoch: 14, Steps: 9 | Train Loss: 0.677 Vali Loss: 0.795 Vali Acc: 0.754 Test Loss: 0.795 Test Acc: 0.754
Validation loss decreased (-0.724629 --> -0.753615).  Saving model ...
Epoch: 15 cost time: 0.6087119579315186
Epoch: 15, Steps: 9 | Train Loss: 0.626 Vali Loss: 0.751 Vali Acc: 0.761 Test Loss: 0.751 Test Acc: 0.761
Validation loss decreased (-0.753615 --> -0.760862).  Saving model ...
Epoch: 16 cost time: 0.6379828453063965
Epoch: 16, Steps: 9 | Train Loss: 0.562 Vali Loss: 0.715 Vali Acc: 0.754 Test Loss: 0.715 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5953991413116455
Epoch: 17, Steps: 9 | Train Loss: 0.501 Vali Loss: 0.687 Vali Acc: 0.761 Test Loss: 0.687 Test Acc: 0.761
Validation loss decreased (-0.760862 --> -0.760863).  Saving model ...
Epoch: 18 cost time: 0.6080024242401123
Epoch: 18, Steps: 9 | Train Loss: 0.472 Vali Loss: 0.660 Vali Acc: 0.739 Test Loss: 0.660 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.567570686340332
Epoch: 19, Steps: 9 | Train Loss: 0.431 Vali Loss: 0.636 Vali Acc: 0.761 Test Loss: 0.636 Test Acc: 0.761
Validation loss decreased (-0.760863 --> -0.760863).  Saving model ...
Epoch: 20 cost time: 0.6265449523925781
Epoch: 20, Steps: 9 | Train Loss: 0.384 Vali Loss: 0.614 Vali Acc: 0.761 Test Loss: 0.614 Test Acc: 0.761
Validation loss decreased (-0.760863 --> -0.760863).  Saving model ...
Epoch: 21 cost time: 0.5997459888458252
Epoch: 21, Steps: 9 | Train Loss: 0.365 Vali Loss: 0.589 Vali Acc: 0.775 Test Loss: 0.589 Test Acc: 0.775
Validation loss decreased (-0.760863 --> -0.775356).  Saving model ...
Epoch: 22 cost time: 0.6011343002319336
Epoch: 22, Steps: 9 | Train Loss: 0.330 Vali Loss: 0.567 Vali Acc: 0.775 Test Loss: 0.567 Test Acc: 0.775
Validation loss decreased (-0.775356 --> -0.775357).  Saving model ...
Epoch: 23 cost time: 0.565392255783081
Epoch: 23, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.550 Vali Acc: 0.768 Test Loss: 0.550 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5644237995147705
Epoch: 24, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
Validation loss decreased (-0.775357 --> -0.782603).  Saving model ...
Epoch: 25 cost time: 0.594684362411499
Epoch: 25, Steps: 9 | Train Loss: 0.252 Vali Loss: 0.522 Vali Acc: 0.804 Test Loss: 0.522 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804343).  Saving model ...
Epoch: 26 cost time: 0.5875270366668701
Epoch: 26, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.513 Vali Acc: 0.819 Test Loss: 0.513 Test Acc: 0.819
Validation loss decreased (-0.804343 --> -0.818835).  Saving model ...
Epoch: 27 cost time: 0.5702149868011475
Epoch: 27, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.501 Vali Acc: 0.833 Test Loss: 0.501 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 28 cost time: 0.6468281745910645
Epoch: 28, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.479 Vali Acc: 0.841 Test Loss: 0.479 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 29 cost time: 0.5907630920410156
Epoch: 29, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.467 Vali Acc: 0.848 Test Loss: 0.467 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 30 cost time: 0.6249203681945801
Epoch: 30, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.462 Vali Acc: 0.848 Test Loss: 0.462 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 31 cost time: 0.5647099018096924
Epoch: 31, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.465 Vali Acc: 0.848 Test Loss: 0.465 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5403146743774414
Epoch: 32, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.463 Vali Acc: 0.841 Test Loss: 0.463 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.57942795753479
Epoch: 33, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.452 Vali Acc: 0.833 Test Loss: 0.452 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5951647758483887
Epoch: 34, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.434 Vali Acc: 0.848 Test Loss: 0.434 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 35 cost time: 0.6039607524871826
Epoch: 35, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.429 Vali Acc: 0.848 Test Loss: 0.429 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 36 cost time: 0.6404991149902344
Epoch: 36, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.422 Vali Acc: 0.848 Test Loss: 0.422 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 37 cost time: 0.632305383682251
Epoch: 37, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.418 Vali Acc: 0.848 Test Loss: 0.418 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 38 cost time: 0.5968093872070312
Epoch: 38, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.420 Vali Acc: 0.855 Test Loss: 0.420 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 39 cost time: 0.6041131019592285
Epoch: 39, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.416 Vali Acc: 0.848 Test Loss: 0.416 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5761041641235352
Epoch: 40, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.422 Vali Acc: 0.855 Test Loss: 0.422 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5795998573303223
Epoch: 41, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.419 Vali Acc: 0.855 Test Loss: 0.419 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 42 cost time: 0.6137433052062988
Epoch: 42, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.428 Vali Acc: 0.848 Test Loss: 0.428 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5677340030670166
Epoch: 43, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.420 Vali Acc: 0.848 Test Loss: 0.420 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6292128562927246
Epoch: 44, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.414 Vali Acc: 0.848 Test Loss: 0.414 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6313421726226807
Epoch: 45, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.408 Vali Acc: 0.848 Test Loss: 0.408 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.629692792892456
Epoch: 46, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.410 Vali Acc: 0.855 Test Loss: 0.410 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 47 cost time: 0.5694515705108643
Epoch: 47, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.408 Vali Acc: 0.848 Test Loss: 0.408 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6083400249481201
Epoch: 48, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.388 Vali Acc: 0.848 Test Loss: 0.388 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6130225658416748
Epoch: 49, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.387 Vali Acc: 0.855 Test Loss: 0.387 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855069).  Saving model ...
Epoch: 50 cost time: 0.651482105255127
Epoch: 50, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.388 Vali Acc: 0.848 Test Loss: 0.388 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 49188
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0804970264434814
Epoch: 1, Steps: 9 | Train Loss: 1.360 Vali Loss: 1.284 Vali Acc: 0.522 Test Loss: 1.284 Test Acc: 0.522
Validation loss decreased (inf --> -0.521726).  Saving model ...
Epoch: 2 cost time: 0.756371021270752
Epoch: 2, Steps: 9 | Train Loss: 1.047 Vali Loss: 0.986 Vali Acc: 0.616 Test Loss: 0.986 Test Acc: 0.616
Validation loss decreased (-0.521726 --> -0.615932).  Saving model ...
Epoch: 3 cost time: 0.7809996604919434
Epoch: 3, Steps: 9 | Train Loss: 0.620 Vali Loss: 0.676 Vali Acc: 0.775 Test Loss: 0.676 Test Acc: 0.775
Validation loss decreased (-0.615932 --> -0.775356).  Saving model ...
Epoch: 4 cost time: 0.7375168800354004
Epoch: 4, Steps: 9 | Train Loss: 0.332 Vali Loss: 0.387 Vali Acc: 0.899 Test Loss: 0.387 Test Acc: 0.899
Validation loss decreased (-0.775356 --> -0.898547).  Saving model ...
Epoch: 5 cost time: 0.7172715663909912
Epoch: 5, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.267 Vali Acc: 0.913 Test Loss: 0.267 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913041).  Saving model ...
Epoch: 6 cost time: 0.718573808670044
Epoch: 6, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.221 Vali Acc: 0.920 Test Loss: 0.221 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920288).  Saving model ...
Epoch: 7 cost time: 0.7421624660491943
Epoch: 7, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
Validation loss decreased (-0.920288 --> -0.927534).  Saving model ...
Epoch: 8 cost time: 0.7577872276306152
Epoch: 8, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.219 Vali Acc: 0.935 Test Loss: 0.219 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 9 cost time: 0.7564079761505127
Epoch: 9, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.267 Vali Acc: 0.906 Test Loss: 0.267 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.750774621963501
Epoch: 10, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.244 Vali Acc: 0.913 Test Loss: 0.244 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8243918418884277
Epoch: 11, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934781).  Saving model ...
Epoch: 12 cost time: 0.7671213150024414
Epoch: 12, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.935 Test Loss: 0.177 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 13 cost time: 0.7369916439056396
Epoch: 13, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.179 Vali Acc: 0.928 Test Loss: 0.179 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8217618465423584
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.266 Vali Acc: 0.920 Test Loss: 0.266 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.807201623916626
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.294 Vali Acc: 0.913 Test Loss: 0.294 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.781548023223877
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.913 Test Loss: 0.284 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7942421436309814
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.913 Test Loss: 0.258 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7419435977935791
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.920 Test Loss: 0.236 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7607529163360596
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.920 Test Loss: 0.234 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8195302486419678
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.920 Test Loss: 0.232 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8746826648712158
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7504730224609375
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 696196
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9787023067474365
Epoch: 1, Steps: 9 | Train Loss: 1.391 Vali Loss: 1.339 Vali Acc: 0.341 Test Loss: 1.339 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 0.7023541927337646
Epoch: 2, Steps: 9 | Train Loss: 1.175 Vali Loss: 1.133 Vali Acc: 0.688 Test Loss: 1.133 Test Acc: 0.688
Validation loss decreased (-0.340566 --> -0.688394).  Saving model ...
Epoch: 3 cost time: 0.6706423759460449
Epoch: 3, Steps: 9 | Train Loss: 0.884 Vali Loss: 0.875 Vali Acc: 0.812 Test Loss: 0.875 Test Acc: 0.812
Validation loss decreased (-0.688394 --> -0.811585).  Saving model ...
Epoch: 4 cost time: 0.6875576972961426
Epoch: 4, Steps: 9 | Train Loss: 0.581 Vali Loss: 0.643 Vali Acc: 0.848 Test Loss: 0.643 Test Acc: 0.848
Validation loss decreased (-0.811585 --> -0.847820).  Saving model ...
Epoch: 5 cost time: 0.6863834857940674
Epoch: 5, Steps: 9 | Train Loss: 0.363 Vali Loss: 0.441 Vali Acc: 0.891 Test Loss: 0.441 Test Acc: 0.891
Validation loss decreased (-0.847820 --> -0.891300).  Saving model ...
Epoch: 6 cost time: 0.6630911827087402
Epoch: 6, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.310 Vali Acc: 0.920 Test Loss: 0.310 Test Acc: 0.920
Validation loss decreased (-0.891300 --> -0.920287).  Saving model ...
Epoch: 7 cost time: 0.7306928634643555
Epoch: 7, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.246 Vali Acc: 0.942 Test Loss: 0.246 Test Acc: 0.942
Validation loss decreased (-0.920287 --> -0.942027).  Saving model ...
Epoch: 8 cost time: 0.731914758682251
Epoch: 8, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.241 Vali Acc: 0.920 Test Loss: 0.241 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7585029602050781
Epoch: 9, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.226 Vali Acc: 0.942 Test Loss: 0.226 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 10 cost time: 0.7226319313049316
Epoch: 10, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.212 Vali Acc: 0.935 Test Loss: 0.212 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7204320430755615
Epoch: 11, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6274247169494629
Epoch: 12, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.228 Vali Acc: 0.935 Test Loss: 0.228 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6662395000457764
Epoch: 13, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.234 Vali Acc: 0.928 Test Loss: 0.234 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6858367919921875
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.228 Vali Acc: 0.928 Test Loss: 0.228 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6461610794067383
Epoch: 15, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7078351974487305
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.672621488571167
Epoch: 17, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6600039005279541
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.192 Vali Acc: 0.928 Test Loss: 0.192 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7423996925354004
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 644612
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1143157482147217
Epoch: 1, Steps: 9 | Train Loss: 1.379 Vali Loss: 1.333 Vali Acc: 0.326 Test Loss: 1.333 Test Acc: 0.326
Validation loss decreased (inf --> -0.326074).  Saving model ...
Epoch: 2 cost time: 0.663576602935791
Epoch: 2, Steps: 9 | Train Loss: 1.193 Vali Loss: 1.158 Vali Acc: 0.594 Test Loss: 1.158 Test Acc: 0.594
Validation loss decreased (-0.326074 --> -0.594191).  Saving model ...
Epoch: 3 cost time: 0.6985752582550049
Epoch: 3, Steps: 9 | Train Loss: 0.941 Vali Loss: 0.961 Vali Acc: 0.703 Test Loss: 0.961 Test Acc: 0.703
Validation loss decreased (-0.594191 --> -0.702889).  Saving model ...
Epoch: 4 cost time: 0.7070193290710449
Epoch: 4, Steps: 9 | Train Loss: 0.678 Vali Loss: 0.734 Vali Acc: 0.746 Test Loss: 0.734 Test Acc: 0.746
Validation loss decreased (-0.702889 --> -0.746369).  Saving model ...
Epoch: 5 cost time: 0.7148458957672119
Epoch: 5, Steps: 9 | Train Loss: 0.449 Vali Loss: 0.540 Vali Acc: 0.884 Test Loss: 0.540 Test Acc: 0.884
Validation loss decreased (-0.746369 --> -0.884053).  Saving model ...
Epoch: 6 cost time: 0.6752297878265381
Epoch: 6, Steps: 9 | Train Loss: 0.292 Vali Loss: 0.409 Vali Acc: 0.920 Test Loss: 0.409 Test Acc: 0.920
Validation loss decreased (-0.884053 --> -0.920286).  Saving model ...
Epoch: 7 cost time: 0.6962478160858154
Epoch: 7, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.330 Vali Acc: 0.920 Test Loss: 0.330 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920287).  Saving model ...
Epoch: 8 cost time: 0.6490554809570312
Epoch: 8, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.290 Vali Acc: 0.906 Test Loss: 0.290 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6144473552703857
Epoch: 9, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.257 Vali Acc: 0.920 Test Loss: 0.257 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 10 cost time: 0.6354236602783203
Epoch: 10, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.281 Vali Acc: 0.906 Test Loss: 0.281 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6357271671295166
Epoch: 11, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.267 Vali Acc: 0.906 Test Loss: 0.267 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6851577758789062
Epoch: 12, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.277 Vali Acc: 0.899 Test Loss: 0.277 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7154316902160645
Epoch: 13, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.260 Vali Acc: 0.899 Test Loss: 0.260 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6390910148620605
Epoch: 14, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.264 Vali Acc: 0.920 Test Loss: 0.264 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6958189010620117
Epoch: 15, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.261 Vali Acc: 0.899 Test Loss: 0.261 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6548326015472412
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.288 Vali Acc: 0.891 Test Loss: 0.288 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6850218772888184
Epoch: 17, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.271 Vali Acc: 0.899 Test Loss: 0.271 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7419047355651855
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.268 Vali Acc: 0.906 Test Loss: 0.268 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7121238708496094
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.262 Vali Acc: 0.913 Test Loss: 0.262 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 632964
model size : 2.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8981928825378418
Epoch: 1, Steps: 9 | Train Loss: 1.376 Vali Loss: 1.341 Vali Acc: 0.297 Test Loss: 1.341 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 0.6892590522766113
Epoch: 2, Steps: 9 | Train Loss: 1.234 Vali Loss: 1.215 Vali Acc: 0.572 Test Loss: 1.215 Test Acc: 0.572
Validation loss decreased (-0.297088 --> -0.572452).  Saving model ...
Epoch: 3 cost time: 0.7001936435699463
Epoch: 3, Steps: 9 | Train Loss: 1.029 Vali Loss: 1.033 Vali Acc: 0.681 Test Loss: 1.033 Test Acc: 0.681
Validation loss decreased (-0.572452 --> -0.681149).  Saving model ...
Epoch: 4 cost time: 0.701430082321167
Epoch: 4, Steps: 9 | Train Loss: 0.811 Vali Loss: 0.849 Vali Acc: 0.790 Test Loss: 0.849 Test Acc: 0.790
Validation loss decreased (-0.681149 --> -0.789847).  Saving model ...
Epoch: 5 cost time: 0.7240393161773682
Epoch: 5, Steps: 9 | Train Loss: 0.607 Vali Loss: 0.673 Vali Acc: 0.826 Test Loss: 0.673 Test Acc: 0.826
Validation loss decreased (-0.789847 --> -0.826080).  Saving model ...
Epoch: 6 cost time: 0.6772050857543945
Epoch: 6, Steps: 9 | Train Loss: 0.422 Vali Loss: 0.514 Vali Acc: 0.884 Test Loss: 0.514 Test Acc: 0.884
Validation loss decreased (-0.826080 --> -0.884053).  Saving model ...
Epoch: 7 cost time: 0.7608113288879395
Epoch: 7, Steps: 9 | Train Loss: 0.293 Vali Loss: 0.408 Vali Acc: 0.899 Test Loss: 0.408 Test Acc: 0.899
Validation loss decreased (-0.884053 --> -0.898547).  Saving model ...
Epoch: 8 cost time: 0.726313591003418
Epoch: 8, Steps: 9 | Train Loss: 0.189 Vali Loss: 0.350 Vali Acc: 0.891 Test Loss: 0.350 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7120647430419922
Epoch: 9, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.290 Vali Acc: 0.913 Test Loss: 0.290 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913041).  Saving model ...
Epoch: 10 cost time: 0.7529556751251221
Epoch: 10, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.288 Vali Acc: 0.913 Test Loss: 0.288 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 11 cost time: 0.7118334770202637
Epoch: 11, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.299 Vali Acc: 0.899 Test Loss: 0.299 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7485437393188477
Epoch: 12, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.303 Vali Acc: 0.906 Test Loss: 0.303 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7843894958496094
Epoch: 13, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.291 Vali Acc: 0.906 Test Loss: 0.291 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7409672737121582
Epoch: 14, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.261 Vali Acc: 0.906 Test Loss: 0.261 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7302112579345703
Epoch: 15, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7523751258850098
Epoch: 16, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.248 Vali Acc: 0.913 Test Loss: 0.248 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 17 cost time: 0.6678063869476318
Epoch: 17, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.263 Vali Acc: 0.906 Test Loss: 0.263 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6842441558837891
Epoch: 18, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.272 Vali Acc: 0.906 Test Loss: 0.272 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7201461791992188
Epoch: 19, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.271 Vali Acc: 0.899 Test Loss: 0.271 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7183890342712402
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.279 Vali Acc: 0.899 Test Loss: 0.279 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8194484710693359
Epoch: 21, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.289 Vali Acc: 0.899 Test Loss: 0.289 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7301404476165771
Epoch: 22, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.286 Vali Acc: 0.906 Test Loss: 0.286 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7437324523925781
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.264 Vali Acc: 0.906 Test Loss: 0.264 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7855348587036133
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.257 Vali Acc: 0.913 Test Loss: 0.257 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6976864337921143
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.255 Vali Acc: 0.913 Test Loss: 0.255 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7221715450286865
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.271 Vali Acc: 0.906 Test Loss: 0.271 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 621316
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0059974193573
Epoch: 1, Steps: 9 | Train Loss: 1.372 Vali Loss: 1.322 Vali Acc: 0.370 Test Loss: 1.322 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 0.651583194732666
Epoch: 2, Steps: 9 | Train Loss: 1.256 Vali Loss: 1.220 Vali Acc: 0.551 Test Loss: 1.220 Test Acc: 0.551
Validation loss decreased (-0.369552 --> -0.550712).  Saving model ...
Epoch: 3 cost time: 0.620222806930542
Epoch: 3, Steps: 9 | Train Loss: 1.092 Vali Loss: 1.074 Vali Acc: 0.703 Test Loss: 1.074 Test Acc: 0.703
Validation loss decreased (-0.550712 --> -0.702888).  Saving model ...
Epoch: 4 cost time: 0.6768441200256348
Epoch: 4, Steps: 9 | Train Loss: 0.901 Vali Loss: 0.921 Vali Acc: 0.746 Test Loss: 0.921 Test Acc: 0.746
Validation loss decreased (-0.702888 --> -0.746368).  Saving model ...
Epoch: 5 cost time: 0.6580328941345215
Epoch: 5, Steps: 9 | Train Loss: 0.725 Vali Loss: 0.758 Vali Acc: 0.819 Test Loss: 0.758 Test Acc: 0.819
Validation loss decreased (-0.746368 --> -0.818833).  Saving model ...
Epoch: 6 cost time: 0.6755309104919434
Epoch: 6, Steps: 9 | Train Loss: 0.549 Vali Loss: 0.631 Vali Acc: 0.812 Test Loss: 0.631 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6455423831939697
Epoch: 7, Steps: 9 | Train Loss: 0.410 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
Validation loss decreased (-0.818833 --> -0.840574).  Saving model ...
Epoch: 8 cost time: 0.6600995063781738
Epoch: 8, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.464 Vali Acc: 0.870 Test Loss: 0.464 Test Acc: 0.870
Validation loss decreased (-0.840574 --> -0.869561).  Saving model ...
Epoch: 9 cost time: 0.690636396408081
Epoch: 9, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.428 Vali Acc: 0.862 Test Loss: 0.428 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.652437686920166
Epoch: 10, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.402 Vali Acc: 0.855 Test Loss: 0.402 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.719064474105835
Epoch: 11, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.373 Vali Acc: 0.848 Test Loss: 0.373 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.635735273361206
Epoch: 12, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.366 Vali Acc: 0.848 Test Loss: 0.366 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6713864803314209
Epoch: 13, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.347 Vali Acc: 0.848 Test Loss: 0.347 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6552460193634033
Epoch: 14, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.345 Vali Acc: 0.855 Test Loss: 0.345 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6311101913452148
Epoch: 15, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.351 Vali Acc: 0.848 Test Loss: 0.351 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7435710430145264
Epoch: 16, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.362 Vali Acc: 0.877 Test Loss: 0.362 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 17 cost time: 0.6922943592071533
Epoch: 17, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.363 Vali Acc: 0.870 Test Loss: 0.363 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6930785179138184
Epoch: 18, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.361 Vali Acc: 0.870 Test Loss: 0.361 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6757056713104248
Epoch: 19, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.375 Vali Acc: 0.855 Test Loss: 0.375 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6305980682373047
Epoch: 20, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.357 Vali Acc: 0.862 Test Loss: 0.357 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6428179740905762
Epoch: 21, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.344 Vali Acc: 0.877 Test Loss: 0.344 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 22 cost time: 0.6971380710601807
Epoch: 22, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.331 Vali Acc: 0.884 Test Loss: 0.331 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 23 cost time: 0.6856153011322021
Epoch: 23, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.338 Vali Acc: 0.884 Test Loss: 0.338 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6405737400054932
Epoch: 24, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.356 Vali Acc: 0.877 Test Loss: 0.356 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6993231773376465
Epoch: 25, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.369 Vali Acc: 0.870 Test Loss: 0.369 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7034411430358887
Epoch: 26, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.364 Vali Acc: 0.870 Test Loss: 0.364 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6581809520721436
Epoch: 27, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.370 Vali Acc: 0.884 Test Loss: 0.370 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6884579658508301
Epoch: 28, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.357 Vali Acc: 0.884 Test Loss: 0.357 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6107394695281982
Epoch: 29, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.374 Vali Acc: 0.884 Test Loss: 0.374 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6536803245544434
Epoch: 30, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.380 Vali Acc: 0.884 Test Loss: 0.380 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.565051794052124
Epoch: 31, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.375 Vali Acc: 0.884 Test Loss: 0.375 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6652383804321289
Epoch: 32, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.367 Vali Acc: 0.877 Test Loss: 0.367 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 613380
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.881810188293457
Epoch: 1, Steps: 9 | Train Loss: 1.369 Vali Loss: 1.359 Vali Acc: 0.348 Test Loss: 1.359 Test Acc: 0.348
Validation loss decreased (inf --> -0.347812).  Saving model ...
Epoch: 2 cost time: 0.7080910205841064
Epoch: 2, Steps: 9 | Train Loss: 1.284 Vali Loss: 1.274 Vali Acc: 0.507 Test Loss: 1.274 Test Acc: 0.507
Validation loss decreased (-0.347812 --> -0.507234).  Saving model ...
Epoch: 3 cost time: 0.7384006977081299
Epoch: 3, Steps: 9 | Train Loss: 1.141 Vali Loss: 1.147 Vali Acc: 0.638 Test Loss: 1.147 Test Acc: 0.638
Validation loss decreased (-0.507234 --> -0.637670).  Saving model ...
Epoch: 4 cost time: 0.7036659717559814
Epoch: 4, Steps: 9 | Train Loss: 0.987 Vali Loss: 1.003 Vali Acc: 0.746 Test Loss: 1.003 Test Acc: 0.746
Validation loss decreased (-0.637670 --> -0.746367).  Saving model ...
Epoch: 5 cost time: 0.6593546867370605
Epoch: 5, Steps: 9 | Train Loss: 0.817 Vali Loss: 0.868 Vali Acc: 0.768 Test Loss: 0.868 Test Acc: 0.768
Validation loss decreased (-0.746367 --> -0.768107).  Saving model ...
Epoch: 6 cost time: 0.6917705535888672
Epoch: 6, Steps: 9 | Train Loss: 0.638 Vali Loss: 0.753 Vali Acc: 0.783 Test Loss: 0.753 Test Acc: 0.783
Validation loss decreased (-0.768107 --> -0.782601).  Saving model ...
Epoch: 7 cost time: 0.6586587429046631
Epoch: 7, Steps: 9 | Train Loss: 0.509 Vali Loss: 0.653 Vali Acc: 0.804 Test Loss: 0.653 Test Acc: 0.804
Validation loss decreased (-0.782601 --> -0.804341).  Saving model ...
Epoch: 8 cost time: 0.6987473964691162
Epoch: 8, Steps: 9 | Train Loss: 0.364 Vali Loss: 0.564 Vali Acc: 0.841 Test Loss: 0.564 Test Acc: 0.841
Validation loss decreased (-0.804341 --> -0.840574).  Saving model ...
Epoch: 9 cost time: 0.6777811050415039
Epoch: 9, Steps: 9 | Train Loss: 0.266 Vali Loss: 0.513 Vali Acc: 0.833 Test Loss: 0.513 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7616868019104004
Epoch: 10, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.467 Vali Acc: 0.841 Test Loss: 0.467 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 11 cost time: 0.668583869934082
Epoch: 11, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.446 Vali Acc: 0.855 Test Loss: 0.446 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 12 cost time: 0.7004678249359131
Epoch: 12, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.450 Vali Acc: 0.848 Test Loss: 0.450 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6591172218322754
Epoch: 13, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.449 Vali Acc: 0.841 Test Loss: 0.449 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.656665563583374
Epoch: 14, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.429 Vali Acc: 0.848 Test Loss: 0.429 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.651608943939209
Epoch: 15, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.399 Vali Acc: 0.855 Test Loss: 0.399 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 16 cost time: 0.7862393856048584
Epoch: 16, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.399 Vali Acc: 0.862 Test Loss: 0.399 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 17 cost time: 0.713233232498169
Epoch: 17, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.399 Vali Acc: 0.855 Test Loss: 0.399 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7040438652038574
Epoch: 18, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.403 Vali Acc: 0.855 Test Loss: 0.403 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7047998905181885
Epoch: 19, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.402 Vali Acc: 0.848 Test Loss: 0.402 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.678473711013794
Epoch: 20, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.405 Vali Acc: 0.862 Test Loss: 0.405 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6644706726074219
Epoch: 21, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.388 Vali Acc: 0.862 Test Loss: 0.388 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 22 cost time: 0.707697868347168
Epoch: 22, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.401 Vali Acc: 0.862 Test Loss: 0.401 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7412517070770264
Epoch: 23, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.407 Vali Acc: 0.862 Test Loss: 0.407 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7467026710510254
Epoch: 24, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.396 Vali Acc: 0.884 Test Loss: 0.396 Test Acc: 0.884
Validation loss decreased (-0.862315 --> -0.884054).  Saving model ...
Epoch: 25 cost time: 0.6940751075744629
Epoch: 25, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.402 Vali Acc: 0.877 Test Loss: 0.402 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7205398082733154
Epoch: 26, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.396 Vali Acc: 0.884 Test Loss: 0.396 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6945903301239014
Epoch: 27, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.379 Vali Acc: 0.884 Test Loss: 0.379 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 28 cost time: 0.6722674369812012
Epoch: 28, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.384 Vali Acc: 0.884 Test Loss: 0.384 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6690671443939209
Epoch: 29, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6929659843444824
Epoch: 30, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.412 Vali Acc: 0.870 Test Loss: 0.412 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7257943153381348
Epoch: 31, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.423 Vali Acc: 0.862 Test Loss: 0.423 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6905684471130371
Epoch: 32, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.416 Vali Acc: 0.862 Test Loss: 0.416 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.692563533782959
Epoch: 33, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.418 Vali Acc: 0.862 Test Loss: 0.418 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.751305341720581
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.417 Vali Acc: 0.862 Test Loss: 0.417 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7278509140014648
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.448 Vali Acc: 0.855 Test Loss: 0.448 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.6848728656768799
Epoch: 36, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.445 Vali Acc: 0.862 Test Loss: 0.445 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.636422872543335
Epoch: 37, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.425 Vali Acc: 0.870 Test Loss: 0.425 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 611716
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.827901840209961
Epoch: 1, Steps: 9 | Train Loss: 1.412 Vali Loss: 1.383 Vali Acc: 0.290 Test Loss: 1.383 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 0.6245462894439697
Epoch: 2, Steps: 9 | Train Loss: 1.319 Vali Loss: 1.305 Vali Acc: 0.442 Test Loss: 1.305 Test Acc: 0.442
Validation loss decreased (-0.289841 --> -0.442016).  Saving model ...
Epoch: 3 cost time: 0.6955113410949707
Epoch: 3, Steps: 9 | Train Loss: 1.212 Vali Loss: 1.188 Vali Acc: 0.543 Test Loss: 1.188 Test Acc: 0.543
Validation loss decreased (-0.442016 --> -0.543466).  Saving model ...
Epoch: 4 cost time: 0.6582565307617188
Epoch: 4, Steps: 9 | Train Loss: 1.032 Vali Loss: 1.062 Vali Acc: 0.710 Test Loss: 1.062 Test Acc: 0.710
Validation loss decreased (-0.543466 --> -0.710134).  Saving model ...
Epoch: 5 cost time: 0.5563113689422607
Epoch: 5, Steps: 9 | Train Loss: 0.901 Vali Loss: 0.922 Vali Acc: 0.732 Test Loss: 0.922 Test Acc: 0.732
Validation loss decreased (-0.710134 --> -0.731875).  Saving model ...
Epoch: 6 cost time: 0.6670382022857666
Epoch: 6, Steps: 9 | Train Loss: 0.731 Vali Loss: 0.808 Vali Acc: 0.768 Test Loss: 0.808 Test Acc: 0.768
Validation loss decreased (-0.731875 --> -0.768108).  Saving model ...
Epoch: 7 cost time: 0.6247072219848633
Epoch: 7, Steps: 9 | Train Loss: 0.627 Vali Loss: 0.703 Vali Acc: 0.775 Test Loss: 0.703 Test Acc: 0.775
Validation loss decreased (-0.768108 --> -0.775355).  Saving model ...
Epoch: 8 cost time: 0.6527256965637207
Epoch: 8, Steps: 9 | Train Loss: 0.455 Vali Loss: 0.630 Vali Acc: 0.812 Test Loss: 0.630 Test Acc: 0.812
Validation loss decreased (-0.775355 --> -0.811588).  Saving model ...
Epoch: 9 cost time: 0.6858537197113037
Epoch: 9, Steps: 9 | Train Loss: 0.359 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
Validation loss decreased (-0.811588 --> -0.833328).  Saving model ...
Epoch: 10 cost time: 0.61454176902771
Epoch: 10, Steps: 9 | Train Loss: 0.297 Vali Loss: 0.524 Vali Acc: 0.833 Test Loss: 0.524 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 11 cost time: 0.6628663539886475
Epoch: 11, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.485 Vali Acc: 0.841 Test Loss: 0.485 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 12 cost time: 0.6515634059906006
Epoch: 12, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.467 Vali Acc: 0.848 Test Loss: 0.467 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 13 cost time: 0.6764709949493408
Epoch: 13, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.428 Vali Acc: 0.862 Test Loss: 0.428 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862315).  Saving model ...
Epoch: 14 cost time: 0.6691591739654541
Epoch: 14, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.427 Vali Acc: 0.862 Test Loss: 0.427 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 15 cost time: 0.6448154449462891
Epoch: 15, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.427 Vali Acc: 0.862 Test Loss: 0.427 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6499266624450684
Epoch: 16, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.415 Vali Acc: 0.848 Test Loss: 0.415 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6782712936401367
Epoch: 17, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.410 Vali Acc: 0.848 Test Loss: 0.410 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6939370632171631
Epoch: 18, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.409 Vali Acc: 0.841 Test Loss: 0.409 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6394789218902588
Epoch: 19, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.405 Vali Acc: 0.848 Test Loss: 0.405 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6415607929229736
Epoch: 20, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.410 Vali Acc: 0.848 Test Loss: 0.410 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5858602523803711
Epoch: 21, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.412 Vali Acc: 0.870 Test Loss: 0.412 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 22 cost time: 0.6151680946350098
Epoch: 22, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.424 Vali Acc: 0.855 Test Loss: 0.424 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6336872577667236
Epoch: 23, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.426 Vali Acc: 0.855 Test Loss: 0.426 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5899257659912109
Epoch: 24, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.433 Vali Acc: 0.848 Test Loss: 0.433 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6188175678253174
Epoch: 25, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.442 Vali Acc: 0.848 Test Loss: 0.442 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7479236125946045
Epoch: 26, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.419 Vali Acc: 0.848 Test Loss: 0.419 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6988434791564941
Epoch: 27, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.410 Vali Acc: 0.855 Test Loss: 0.410 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6706142425537109
Epoch: 28, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.396 Vali Acc: 0.855 Test Loss: 0.396 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6773645877838135
Epoch: 29, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.404 Vali Acc: 0.848 Test Loss: 0.404 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6362693309783936
Epoch: 30, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.413 Vali Acc: 0.848 Test Loss: 0.413 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7083053588867188
Epoch: 31, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.422 Vali Acc: 0.848 Test Loss: 0.422 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 609924
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.947643756866455
Epoch: 1, Steps: 9 | Train Loss: 1.394 Vali Loss: 1.312 Vali Acc: 0.355 Test Loss: 1.312 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 0.6492679119110107
Epoch: 2, Steps: 9 | Train Loss: 1.201 Vali Loss: 1.135 Vali Acc: 0.746 Test Loss: 1.135 Test Acc: 0.746
Validation loss decreased (-0.355059 --> -0.746365).  Saving model ...
Epoch: 3 cost time: 0.6443948745727539
Epoch: 3, Steps: 9 | Train Loss: 0.925 Vali Loss: 0.890 Vali Acc: 0.819 Test Loss: 0.890 Test Acc: 0.819
Validation loss decreased (-0.746365 --> -0.818832).  Saving model ...
Epoch: 4 cost time: 0.6474146842956543
Epoch: 4, Steps: 9 | Train Loss: 0.657 Vali Loss: 0.653 Vali Acc: 0.862 Test Loss: 0.653 Test Acc: 0.862
Validation loss decreased (-0.818832 --> -0.862312).  Saving model ...
Epoch: 5 cost time: 0.7406435012817383
Epoch: 5, Steps: 9 | Train Loss: 0.416 Vali Loss: 0.471 Vali Acc: 0.877 Test Loss: 0.471 Test Acc: 0.877
Validation loss decreased (-0.862312 --> -0.876807).  Saving model ...
Epoch: 6 cost time: 0.636685848236084
Epoch: 6, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.366 Vali Acc: 0.899 Test Loss: 0.366 Test Acc: 0.899
Validation loss decreased (-0.876807 --> -0.898547).  Saving model ...
Epoch: 7 cost time: 0.6444058418273926
Epoch: 7, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.295 Vali Acc: 0.906 Test Loss: 0.295 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 8 cost time: 0.6190147399902344
Epoch: 8, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.241 Vali Acc: 0.928 Test Loss: 0.241 Test Acc: 0.928
Validation loss decreased (-0.905794 --> -0.927534).  Saving model ...
Epoch: 9 cost time: 0.6312756538391113
Epoch: 9, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.228 Vali Acc: 0.928 Test Loss: 0.228 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 10 cost time: 0.6180720329284668
Epoch: 10, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.243 Vali Acc: 0.928 Test Loss: 0.243 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5319974422454834
Epoch: 11, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.225 Vali Acc: 0.920 Test Loss: 0.225 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7284066677093506
Epoch: 12, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.220 Vali Acc: 0.920 Test Loss: 0.220 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6217911243438721
Epoch: 13, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.225 Vali Acc: 0.920 Test Loss: 0.225 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5982542037963867
Epoch: 14, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.242 Vali Acc: 0.913 Test Loss: 0.242 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6182785034179688
Epoch: 15, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.256 Vali Acc: 0.913 Test Loss: 0.256 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6673336029052734
Epoch: 16, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.228 Vali Acc: 0.920 Test Loss: 0.228 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7018845081329346
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.206 Vali Acc: 0.920 Test Loss: 0.206 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6440017223358154
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.920 Test Loss: 0.199 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.645754337310791
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.920 Test Loss: 0.209 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 208836
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9727826118469238
Epoch: 1, Steps: 9 | Train Loss: 1.388 Vali Loss: 1.339 Vali Acc: 0.406 Test Loss: 1.339 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 0.5904014110565186
Epoch: 2, Steps: 9 | Train Loss: 1.253 Vali Loss: 1.232 Vali Acc: 0.507 Test Loss: 1.232 Test Acc: 0.507
Validation loss decreased (-0.405784 --> -0.507234).  Saving model ...
Epoch: 3 cost time: 0.6201536655426025
Epoch: 3, Steps: 9 | Train Loss: 1.080 Vali Loss: 1.081 Vali Acc: 0.652 Test Loss: 1.081 Test Acc: 0.652
Validation loss decreased (-0.507234 --> -0.652163).  Saving model ...
Epoch: 4 cost time: 0.5973262786865234
Epoch: 4, Steps: 9 | Train Loss: 0.886 Vali Loss: 0.911 Vali Acc: 0.783 Test Loss: 0.911 Test Acc: 0.783
Validation loss decreased (-0.652163 --> -0.782600).  Saving model ...
Epoch: 5 cost time: 0.6131834983825684
Epoch: 5, Steps: 9 | Train Loss: 0.670 Vali Loss: 0.738 Vali Acc: 0.826 Test Loss: 0.738 Test Acc: 0.826
Validation loss decreased (-0.782600 --> -0.826080).  Saving model ...
Epoch: 6 cost time: 0.6828644275665283
Epoch: 6, Steps: 9 | Train Loss: 0.487 Vali Loss: 0.576 Vali Acc: 0.862 Test Loss: 0.576 Test Acc: 0.862
Validation loss decreased (-0.826080 --> -0.862313).  Saving model ...
Epoch: 7 cost time: 0.6334981918334961
Epoch: 7, Steps: 9 | Train Loss: 0.346 Vali Loss: 0.466 Vali Acc: 0.877 Test Loss: 0.466 Test Acc: 0.877
Validation loss decreased (-0.862313 --> -0.876807).  Saving model ...
Epoch: 8 cost time: 0.6297760009765625
Epoch: 8, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.377 Vali Acc: 0.891 Test Loss: 0.377 Test Acc: 0.891
Validation loss decreased (-0.876807 --> -0.891301).  Saving model ...
Epoch: 9 cost time: 0.6760554313659668
Epoch: 9, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.320 Vali Acc: 0.906 Test Loss: 0.320 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 10 cost time: 0.6015119552612305
Epoch: 10, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.293 Vali Acc: 0.913 Test Loss: 0.293 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 11 cost time: 0.5849688053131104
Epoch: 11, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.266 Vali Acc: 0.928 Test Loss: 0.266 Test Acc: 0.928
Validation loss decreased (-0.913041 --> -0.927534).  Saving model ...
Epoch: 12 cost time: 0.7246139049530029
Epoch: 12, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.270 Vali Acc: 0.913 Test Loss: 0.270 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5848760604858398
Epoch: 13, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6609864234924316
Epoch: 14, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.253 Vali Acc: 0.928 Test Loss: 0.253 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 15 cost time: 0.651052713394165
Epoch: 15, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.234 Vali Acc: 0.928 Test Loss: 0.234 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 16 cost time: 0.6280574798583984
Epoch: 16, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.235 Vali Acc: 0.913 Test Loss: 0.235 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.651578426361084
Epoch: 17, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.228 Vali Acc: 0.913 Test Loss: 0.228 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6939880847930908
Epoch: 18, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 19 cost time: 0.634845495223999
Epoch: 19, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.224 Vali Acc: 0.928 Test Loss: 0.224 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6069943904876709
Epoch: 20, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.216 Vali Acc: 0.920 Test Loss: 0.216 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5560662746429443
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.217 Vali Acc: 0.920 Test Loss: 0.217 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6070606708526611
Epoch: 22, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.212 Vali Acc: 0.920 Test Loss: 0.212 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6144812107086182
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.210 Vali Acc: 0.920 Test Loss: 0.210 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6472527980804443
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.211 Vali Acc: 0.920 Test Loss: 0.211 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6696836948394775
Epoch: 25, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.213 Vali Acc: 0.920 Test Loss: 0.213 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6574966907501221
Epoch: 26, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.215 Vali Acc: 0.920 Test Loss: 0.215 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5935499668121338
Epoch: 27, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.239 Vali Acc: 0.920 Test Loss: 0.239 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.650019645690918
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.259 Vali Acc: 0.913 Test Loss: 0.259 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 183044
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9164142608642578
Epoch: 1, Steps: 9 | Train Loss: 1.392 Vali Loss: 1.355 Vali Acc: 0.268 Test Loss: 1.355 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 0.616431713104248
Epoch: 2, Steps: 9 | Train Loss: 1.290 Vali Loss: 1.273 Vali Acc: 0.428 Test Loss: 1.273 Test Acc: 0.428
Validation loss decreased (-0.268102 --> -0.427523).  Saving model ...
Epoch: 3 cost time: 0.6133050918579102
Epoch: 3, Steps: 9 | Train Loss: 1.156 Vali Loss: 1.153 Vali Acc: 0.630 Test Loss: 1.153 Test Acc: 0.630
Validation loss decreased (-0.427523 --> -0.630423).  Saving model ...
Epoch: 4 cost time: 0.6541829109191895
Epoch: 4, Steps: 9 | Train Loss: 0.975 Vali Loss: 1.013 Vali Acc: 0.732 Test Loss: 1.013 Test Acc: 0.732
Validation loss decreased (-0.630423 --> -0.731874).  Saving model ...
Epoch: 5 cost time: 0.6071193218231201
Epoch: 5, Steps: 9 | Train Loss: 0.817 Vali Loss: 0.875 Vali Acc: 0.768 Test Loss: 0.875 Test Acc: 0.768
Validation loss decreased (-0.731874 --> -0.768107).  Saving model ...
Epoch: 6 cost time: 0.5547749996185303
Epoch: 6, Steps: 9 | Train Loss: 0.660 Vali Loss: 0.739 Vali Acc: 0.819 Test Loss: 0.739 Test Acc: 0.819
Validation loss decreased (-0.768107 --> -0.818833).  Saving model ...
Epoch: 7 cost time: 0.5920875072479248
Epoch: 7, Steps: 9 | Train Loss: 0.500 Vali Loss: 0.608 Vali Acc: 0.848 Test Loss: 0.608 Test Acc: 0.848
Validation loss decreased (-0.818833 --> -0.847820).  Saving model ...
Epoch: 8 cost time: 0.6294083595275879
Epoch: 8, Steps: 9 | Train Loss: 0.379 Vali Loss: 0.505 Vali Acc: 0.870 Test Loss: 0.505 Test Acc: 0.870
Validation loss decreased (-0.847820 --> -0.869560).  Saving model ...
Epoch: 9 cost time: 0.6073148250579834
Epoch: 9, Steps: 9 | Train Loss: 0.278 Vali Loss: 0.416 Vali Acc: 0.884 Test Loss: 0.416 Test Acc: 0.884
Validation loss decreased (-0.869560 --> -0.884054).  Saving model ...
Epoch: 10 cost time: 0.6243503093719482
Epoch: 10, Steps: 9 | Train Loss: 0.198 Vali Loss: 0.372 Vali Acc: 0.913 Test Loss: 0.372 Test Acc: 0.913
Validation loss decreased (-0.884054 --> -0.913040).  Saving model ...
Epoch: 11 cost time: 0.6156103610992432
Epoch: 11, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.335 Vali Acc: 0.884 Test Loss: 0.335 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6030740737915039
Epoch: 12, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.316 Vali Acc: 0.884 Test Loss: 0.316 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5709228515625
Epoch: 13, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.302 Vali Acc: 0.899 Test Loss: 0.302 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5879745483398438
Epoch: 14, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.308 Vali Acc: 0.884 Test Loss: 0.308 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5761222839355469
Epoch: 15, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.296 Vali Acc: 0.891 Test Loss: 0.296 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.587273359298706
Epoch: 16, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.299 Vali Acc: 0.891 Test Loss: 0.299 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5865113735198975
Epoch: 17, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.297 Vali Acc: 0.884 Test Loss: 0.297 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.612879753112793
Epoch: 18, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.281 Vali Acc: 0.891 Test Loss: 0.281 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5854392051696777
Epoch: 19, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.279 Vali Acc: 0.891 Test Loss: 0.279 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6119327545166016
Epoch: 20, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.283 Vali Acc: 0.891 Test Loss: 0.283 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 177220
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8324503898620605
Epoch: 1, Steps: 9 | Train Loss: 1.432 Vali Loss: 1.379 Vali Acc: 0.384 Test Loss: 1.379 Test Acc: 0.384
Validation loss decreased (inf --> -0.384044).  Saving model ...
Epoch: 2 cost time: 0.6664483547210693
Epoch: 2, Steps: 9 | Train Loss: 1.348 Vali Loss: 1.308 Vali Acc: 0.536 Test Loss: 1.308 Test Acc: 0.536
Validation loss decreased (-0.384044 --> -0.536219).  Saving model ...
Epoch: 3 cost time: 0.7053482532501221
Epoch: 3, Steps: 9 | Train Loss: 1.228 Vali Loss: 1.210 Vali Acc: 0.623 Test Loss: 1.210 Test Acc: 0.623
Validation loss decreased (-0.536219 --> -0.623176).  Saving model ...
Epoch: 4 cost time: 0.6692953109741211
Epoch: 4, Steps: 9 | Train Loss: 1.082 Vali Loss: 1.092 Vali Acc: 0.732 Test Loss: 1.092 Test Acc: 0.732
Validation loss decreased (-0.623176 --> -0.731873).  Saving model ...
Epoch: 5 cost time: 0.6474580764770508
Epoch: 5, Steps: 9 | Train Loss: 0.954 Vali Loss: 0.968 Vali Acc: 0.783 Test Loss: 0.968 Test Acc: 0.783
Validation loss decreased (-0.731873 --> -0.782599).  Saving model ...
Epoch: 6 cost time: 0.6615695953369141
Epoch: 6, Steps: 9 | Train Loss: 0.796 Vali Loss: 0.830 Vali Acc: 0.812 Test Loss: 0.830 Test Acc: 0.812
Validation loss decreased (-0.782599 --> -0.811586).  Saving model ...
Epoch: 7 cost time: 0.5822107791900635
Epoch: 7, Steps: 9 | Train Loss: 0.647 Vali Loss: 0.717 Vali Acc: 0.819 Test Loss: 0.717 Test Acc: 0.819
Validation loss decreased (-0.811586 --> -0.818833).  Saving model ...
Epoch: 8 cost time: 0.6313216686248779
Epoch: 8, Steps: 9 | Train Loss: 0.514 Vali Loss: 0.608 Vali Acc: 0.884 Test Loss: 0.608 Test Acc: 0.884
Validation loss decreased (-0.818833 --> -0.884052).  Saving model ...
Epoch: 9 cost time: 0.7306861877441406
Epoch: 9, Steps: 9 | Train Loss: 0.405 Vali Loss: 0.518 Vali Acc: 0.877 Test Loss: 0.518 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6005465984344482
Epoch: 10, Steps: 9 | Train Loss: 0.314 Vali Loss: 0.451 Vali Acc: 0.877 Test Loss: 0.451 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7149009704589844
Epoch: 11, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.406 Vali Acc: 0.877 Test Loss: 0.406 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7014093399047852
Epoch: 12, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.369 Vali Acc: 0.884 Test Loss: 0.369 Test Acc: 0.884
Validation loss decreased (-0.884052 --> -0.884054).  Saving model ...
Epoch: 13 cost time: 0.6209256649017334
Epoch: 13, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.345 Vali Acc: 0.884 Test Loss: 0.345 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884055).  Saving model ...
Epoch: 14 cost time: 0.6122794151306152
Epoch: 14, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.311 Vali Acc: 0.891 Test Loss: 0.311 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 15 cost time: 0.6426353454589844
Epoch: 15, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.301 Vali Acc: 0.906 Test Loss: 0.301 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 16 cost time: 0.6560523509979248
Epoch: 16, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.297 Vali Acc: 0.913 Test Loss: 0.297 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 17 cost time: 0.6841702461242676
Epoch: 17, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.312 Vali Acc: 0.884 Test Loss: 0.312 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6261849403381348
Epoch: 18, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.308 Vali Acc: 0.891 Test Loss: 0.308 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6771690845489502
Epoch: 19, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.297 Vali Acc: 0.899 Test Loss: 0.297 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6099379062652588
Epoch: 20, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.282 Vali Acc: 0.913 Test Loss: 0.282 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 21 cost time: 0.6142454147338867
Epoch: 21, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.281 Vali Acc: 0.913 Test Loss: 0.281 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 22 cost time: 0.6837069988250732
Epoch: 22, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.271 Vali Acc: 0.899 Test Loss: 0.271 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6584956645965576
Epoch: 23, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.272 Vali Acc: 0.906 Test Loss: 0.272 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6807687282562256
Epoch: 24, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.298 Vali Acc: 0.913 Test Loss: 0.298 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6725468635559082
Epoch: 25, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.291 Vali Acc: 0.906 Test Loss: 0.291 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6753935813903809
Epoch: 26, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.285 Vali Acc: 0.899 Test Loss: 0.285 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6229221820831299
Epoch: 27, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.292 Vali Acc: 0.899 Test Loss: 0.292 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7211833000183105
Epoch: 28, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.292 Vali Acc: 0.899 Test Loss: 0.292 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6331689357757568
Epoch: 29, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.269 Vali Acc: 0.899 Test Loss: 0.269 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6458766460418701
Epoch: 30, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6510584354400635
Epoch: 31, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.264 Vali Acc: 0.899 Test Loss: 0.264 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 171396
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.911891222000122
Epoch: 1, Steps: 9 | Train Loss: 1.430 Vali Loss: 1.364 Vali Acc: 0.217 Test Loss: 1.364 Test Acc: 0.217
Validation loss decreased (inf --> -0.217378).  Saving model ...
Epoch: 2 cost time: 0.6911818981170654
Epoch: 2, Steps: 9 | Train Loss: 1.369 Vali Loss: 1.318 Vali Acc: 0.355 Test Loss: 1.318 Test Acc: 0.355
Validation loss decreased (-0.217378 --> -0.355059).  Saving model ...
Epoch: 3 cost time: 0.6188583374023438
Epoch: 3, Steps: 9 | Train Loss: 1.280 Vali Loss: 1.247 Vali Acc: 0.471 Test Loss: 1.247 Test Acc: 0.471
Validation loss decreased (-0.355059 --> -0.471002).  Saving model ...
Epoch: 4 cost time: 0.5916931629180908
Epoch: 4, Steps: 9 | Train Loss: 1.189 Vali Loss: 1.156 Vali Acc: 0.601 Test Loss: 1.156 Test Acc: 0.601
Validation loss decreased (-0.471002 --> -0.601438).  Saving model ...
Epoch: 5 cost time: 0.6019787788391113
Epoch: 5, Steps: 9 | Train Loss: 1.068 Vali Loss: 1.064 Vali Acc: 0.681 Test Loss: 1.064 Test Acc: 0.681
Validation loss decreased (-0.601438 --> -0.681149).  Saving model ...
Epoch: 6 cost time: 0.6564042568206787
Epoch: 6, Steps: 9 | Train Loss: 0.948 Vali Loss: 0.965 Vali Acc: 0.696 Test Loss: 0.965 Test Acc: 0.696
Validation loss decreased (-0.681149 --> -0.695643).  Saving model ...
Epoch: 7 cost time: 0.5940291881561279
Epoch: 7, Steps: 9 | Train Loss: 0.845 Vali Loss: 0.865 Vali Acc: 0.710 Test Loss: 0.865 Test Acc: 0.710
Validation loss decreased (-0.695643 --> -0.710136).  Saving model ...
Epoch: 8 cost time: 0.6319444179534912
Epoch: 8, Steps: 9 | Train Loss: 0.709 Vali Loss: 0.768 Vali Acc: 0.783 Test Loss: 0.768 Test Acc: 0.783
Validation loss decreased (-0.710136 --> -0.782601).  Saving model ...
Epoch: 9 cost time: 0.6402161121368408
Epoch: 9, Steps: 9 | Train Loss: 0.613 Vali Loss: 0.679 Vali Acc: 0.804 Test Loss: 0.679 Test Acc: 0.804
Validation loss decreased (-0.782601 --> -0.804341).  Saving model ...
Epoch: 10 cost time: 0.6593356132507324
Epoch: 10, Steps: 9 | Train Loss: 0.477 Vali Loss: 0.603 Vali Acc: 0.826 Test Loss: 0.603 Test Acc: 0.826
Validation loss decreased (-0.804341 --> -0.826081).  Saving model ...
Epoch: 11 cost time: 0.601280689239502
Epoch: 11, Steps: 9 | Train Loss: 0.407 Vali Loss: 0.556 Vali Acc: 0.848 Test Loss: 0.556 Test Acc: 0.848
Validation loss decreased (-0.826081 --> -0.847821).  Saving model ...
Epoch: 12 cost time: 0.6122519969940186
Epoch: 12, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.515 Vali Acc: 0.848 Test Loss: 0.515 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 13 cost time: 0.6410267353057861
Epoch: 13, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.486 Vali Acc: 0.841 Test Loss: 0.486 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5980513095855713
Epoch: 14, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.453 Vali Acc: 0.833 Test Loss: 0.453 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6212100982666016
Epoch: 15, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.427 Vali Acc: 0.848 Test Loss: 0.427 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 16 cost time: 0.5893828868865967
Epoch: 16, Steps: 9 | Train Loss: 0.205 Vali Loss: 0.422 Vali Acc: 0.855 Test Loss: 0.422 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 17 cost time: 0.6882414817810059
Epoch: 17, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.393 Vali Acc: 0.855 Test Loss: 0.393 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855069).  Saving model ...
Epoch: 18 cost time: 0.6144905090332031
Epoch: 18, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.388 Vali Acc: 0.848 Test Loss: 0.388 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7161691188812256
Epoch: 19, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.381 Vali Acc: 0.862 Test Loss: 0.381 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 20 cost time: 0.632138729095459
Epoch: 20, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.365 Vali Acc: 0.855 Test Loss: 0.365 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6210281848907471
Epoch: 21, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.353 Vali Acc: 0.877 Test Loss: 0.353 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 22 cost time: 0.6429407596588135
Epoch: 22, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.365 Vali Acc: 0.862 Test Loss: 0.365 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6021595001220703
Epoch: 23, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.364 Vali Acc: 0.862 Test Loss: 0.364 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5996615886688232
Epoch: 24, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.343 Vali Acc: 0.870 Test Loss: 0.343 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7364096641540527
Epoch: 25, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.343 Vali Acc: 0.877 Test Loss: 0.343 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 26 cost time: 0.6248929500579834
Epoch: 26, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.330 Vali Acc: 0.862 Test Loss: 0.330 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6534678936004639
Epoch: 27, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.331 Vali Acc: 0.862 Test Loss: 0.331 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5927567481994629
Epoch: 28, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.322 Vali Acc: 0.862 Test Loss: 0.322 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6541934013366699
Epoch: 29, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.316 Vali Acc: 0.877 Test Loss: 0.316 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 30 cost time: 0.5999279022216797
Epoch: 30, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.315 Vali Acc: 0.884 Test Loss: 0.315 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 31 cost time: 0.6439697742462158
Epoch: 31, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.337 Vali Acc: 0.870 Test Loss: 0.337 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6005053520202637
Epoch: 32, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.330 Vali Acc: 0.877 Test Loss: 0.330 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.633418083190918
Epoch: 33, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.326 Vali Acc: 0.877 Test Loss: 0.326 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5917520523071289
Epoch: 34, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.313 Vali Acc: 0.884 Test Loss: 0.313 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 35 cost time: 0.62355637550354
Epoch: 35, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.315 Vali Acc: 0.884 Test Loss: 0.315 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6078541278839111
Epoch: 36, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.321 Vali Acc: 0.870 Test Loss: 0.321 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6267328262329102
Epoch: 37, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.338 Vali Acc: 0.884 Test Loss: 0.338 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6669766902923584
Epoch: 38, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.356 Vali Acc: 0.877 Test Loss: 0.356 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5884878635406494
Epoch: 39, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.345 Vali Acc: 0.877 Test Loss: 0.345 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.62615966796875
Epoch: 40, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.351 Vali Acc: 0.877 Test Loss: 0.351 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6044411659240723
Epoch: 41, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.371 Vali Acc: 0.870 Test Loss: 0.371 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.6273844242095947
Epoch: 42, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.357 Vali Acc: 0.877 Test Loss: 0.357 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.616403341293335
Epoch: 43, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.339 Vali Acc: 0.870 Test Loss: 0.339 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.5960686206817627
Epoch: 44, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.307 Vali Acc: 0.891 Test Loss: 0.307 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 45 cost time: 0.6675257682800293
Epoch: 45, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.311 Vali Acc: 0.891 Test Loss: 0.311 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6498656272888184
Epoch: 46, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.325 Vali Acc: 0.884 Test Loss: 0.325 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6029095649719238
Epoch: 47, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.353 Vali Acc: 0.877 Test Loss: 0.353 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5845947265625
Epoch: 48, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.364 Vali Acc: 0.877 Test Loss: 0.364 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.6012639999389648
Epoch: 49, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.367 Vali Acc: 0.862 Test Loss: 0.367 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.6185011863708496
Epoch: 50, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.349 Vali Acc: 0.884 Test Loss: 0.349 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 167428
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9936635494232178
Epoch: 1, Steps: 9 | Train Loss: 1.419 Vali Loss: 1.389 Vali Acc: 0.268 Test Loss: 1.389 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 0.6688125133514404
Epoch: 2, Steps: 9 | Train Loss: 1.368 Vali Loss: 1.342 Vali Acc: 0.362 Test Loss: 1.342 Test Acc: 0.362
Validation loss decreased (-0.268102 --> -0.362305).  Saving model ...
Epoch: 3 cost time: 0.5985901355743408
Epoch: 3, Steps: 9 | Train Loss: 1.294 Vali Loss: 1.268 Vali Acc: 0.471 Test Loss: 1.268 Test Acc: 0.471
Validation loss decreased (-0.362305 --> -0.471002).  Saving model ...
Epoch: 4 cost time: 0.631972074508667
Epoch: 4, Steps: 9 | Train Loss: 1.179 Vali Loss: 1.184 Vali Acc: 0.536 Test Loss: 1.184 Test Acc: 0.536
Validation loss decreased (-0.471002 --> -0.536220).  Saving model ...
Epoch: 5 cost time: 0.6381011009216309
Epoch: 5, Steps: 9 | Train Loss: 1.062 Vali Loss: 1.089 Vali Acc: 0.623 Test Loss: 1.089 Test Acc: 0.623
Validation loss decreased (-0.536220 --> -0.623178).  Saving model ...
Epoch: 6 cost time: 0.5950803756713867
Epoch: 6, Steps: 9 | Train Loss: 0.950 Vali Loss: 0.997 Vali Acc: 0.681 Test Loss: 0.997 Test Acc: 0.681
Validation loss decreased (-0.623178 --> -0.681149).  Saving model ...
Epoch: 7 cost time: 0.633183479309082
Epoch: 7, Steps: 9 | Train Loss: 0.818 Vali Loss: 0.901 Vali Acc: 0.717 Test Loss: 0.901 Test Acc: 0.717
Validation loss decreased (-0.681149 --> -0.717382).  Saving model ...
Epoch: 8 cost time: 0.5898885726928711
Epoch: 8, Steps: 9 | Train Loss: 0.721 Vali Loss: 0.807 Vali Acc: 0.725 Test Loss: 0.807 Test Acc: 0.725
Validation loss decreased (-0.717382 --> -0.724630).  Saving model ...
Epoch: 9 cost time: 0.6623134613037109
Epoch: 9, Steps: 9 | Train Loss: 0.609 Vali Loss: 0.736 Vali Acc: 0.768 Test Loss: 0.736 Test Acc: 0.768
Validation loss decreased (-0.724630 --> -0.768109).  Saving model ...
Epoch: 10 cost time: 0.6622648239135742
Epoch: 10, Steps: 9 | Train Loss: 0.508 Vali Loss: 0.664 Vali Acc: 0.790 Test Loss: 0.664 Test Acc: 0.790
Validation loss decreased (-0.768109 --> -0.789848).  Saving model ...
Epoch: 11 cost time: 0.736821174621582
Epoch: 11, Steps: 9 | Train Loss: 0.428 Vali Loss: 0.606 Vali Acc: 0.790 Test Loss: 0.606 Test Acc: 0.790
Validation loss decreased (-0.789848 --> -0.789849).  Saving model ...
Epoch: 12 cost time: 0.6298227310180664
Epoch: 12, Steps: 9 | Train Loss: 0.359 Vali Loss: 0.563 Vali Acc: 0.826 Test Loss: 0.563 Test Acc: 0.826
Validation loss decreased (-0.789849 --> -0.826081).  Saving model ...
Epoch: 13 cost time: 0.6287364959716797
Epoch: 13, Steps: 9 | Train Loss: 0.298 Vali Loss: 0.517 Vali Acc: 0.819 Test Loss: 0.517 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6624600887298584
Epoch: 14, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.480 Vali Acc: 0.848 Test Loss: 0.480 Test Acc: 0.848
Validation loss decreased (-0.826081 --> -0.847821).  Saving model ...
Epoch: 15 cost time: 0.5941762924194336
Epoch: 15, Steps: 9 | Train Loss: 0.262 Vali Loss: 0.472 Vali Acc: 0.833 Test Loss: 0.472 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6291477680206299
Epoch: 16, Steps: 9 | Train Loss: 0.205 Vali Loss: 0.465 Vali Acc: 0.841 Test Loss: 0.465 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5818009376525879
Epoch: 17, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.450 Vali Acc: 0.833 Test Loss: 0.450 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5746555328369141
Epoch: 18, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.424 Vali Acc: 0.848 Test Loss: 0.424 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 19 cost time: 0.5549554824829102
Epoch: 19, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.415 Vali Acc: 0.848 Test Loss: 0.415 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 20 cost time: 0.5595204830169678
Epoch: 20, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.417 Vali Acc: 0.848 Test Loss: 0.417 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5875818729400635
Epoch: 21, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.410 Vali Acc: 0.848 Test Loss: 0.410 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 22 cost time: 0.6123301982879639
Epoch: 22, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.397 Vali Acc: 0.855 Test Loss: 0.397 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 23 cost time: 0.6602685451507568
Epoch: 23, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.388 Vali Acc: 0.855 Test Loss: 0.388 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855069).  Saving model ...
Epoch: 24 cost time: 0.6217634677886963
Epoch: 24, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.387 Vali Acc: 0.870 Test Loss: 0.387 Test Acc: 0.870
Validation loss decreased (-0.855069 --> -0.869561).  Saving model ...
Epoch: 25 cost time: 0.648475170135498
Epoch: 25, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.386 Vali Acc: 0.862 Test Loss: 0.386 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6474399566650391
Epoch: 26, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.395 Vali Acc: 0.848 Test Loss: 0.395 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6163985729217529
Epoch: 27, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.388 Vali Acc: 0.848 Test Loss: 0.388 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6191563606262207
Epoch: 28, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.376 Vali Acc: 0.848 Test Loss: 0.376 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6339669227600098
Epoch: 29, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.386 Vali Acc: 0.855 Test Loss: 0.386 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6988790035247803
Epoch: 30, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.387 Vali Acc: 0.855 Test Loss: 0.387 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7405242919921875
Epoch: 31, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.384 Vali Acc: 0.862 Test Loss: 0.384 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6677396297454834
Epoch: 32, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.375 Vali Acc: 0.862 Test Loss: 0.375 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6513493061065674
Epoch: 33, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.377 Vali Acc: 0.862 Test Loss: 0.377 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6987566947937012
Epoch: 34, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.390 Vali Acc: 0.848 Test Loss: 0.390 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 166596
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8748583793640137
Epoch: 1, Steps: 9 | Train Loss: 1.387 Vali Loss: 1.398 Vali Acc: 0.239 Test Loss: 1.398 Test Acc: 0.239
Validation loss decreased (inf --> -0.239116).  Saving model ...
Epoch: 2 cost time: 0.6784343719482422
Epoch: 2, Steps: 9 | Train Loss: 1.336 Vali Loss: 1.368 Vali Acc: 0.254 Test Loss: 1.368 Test Acc: 0.254
Validation loss decreased (-0.239116 --> -0.253610).  Saving model ...
Epoch: 3 cost time: 0.6080751419067383
Epoch: 3, Steps: 9 | Train Loss: 1.292 Vali Loss: 1.317 Vali Acc: 0.319 Test Loss: 1.317 Test Acc: 0.319
Validation loss decreased (-0.253610 --> -0.318827).  Saving model ...
Epoch: 4 cost time: 0.5992708206176758
Epoch: 4, Steps: 9 | Train Loss: 1.201 Vali Loss: 1.252 Vali Acc: 0.449 Test Loss: 1.252 Test Acc: 0.449
Validation loss decreased (-0.318827 --> -0.449263).  Saving model ...
Epoch: 5 cost time: 0.6052095890045166
Epoch: 5, Steps: 9 | Train Loss: 1.115 Vali Loss: 1.181 Vali Acc: 0.522 Test Loss: 1.181 Test Acc: 0.522
Validation loss decreased (-0.449263 --> -0.521727).  Saving model ...
Epoch: 6 cost time: 0.6638748645782471
Epoch: 6, Steps: 9 | Train Loss: 1.009 Vali Loss: 1.108 Vali Acc: 0.601 Test Loss: 1.108 Test Acc: 0.601
Validation loss decreased (-0.521727 --> -0.601438).  Saving model ...
Epoch: 7 cost time: 0.6103441715240479
Epoch: 7, Steps: 9 | Train Loss: 0.925 Vali Loss: 1.027 Vali Acc: 0.659 Test Loss: 1.027 Test Acc: 0.659
Validation loss decreased (-0.601438 --> -0.659410).  Saving model ...
Epoch: 8 cost time: 0.5880405902862549
Epoch: 8, Steps: 9 | Train Loss: 0.820 Vali Loss: 0.946 Vali Acc: 0.667 Test Loss: 0.946 Test Acc: 0.667
Validation loss decreased (-0.659410 --> -0.666657).  Saving model ...
Epoch: 9 cost time: 0.6567878723144531
Epoch: 9, Steps: 9 | Train Loss: 0.724 Vali Loss: 0.873 Vali Acc: 0.710 Test Loss: 0.873 Test Acc: 0.710
Validation loss decreased (-0.666657 --> -0.710136).  Saving model ...
Epoch: 10 cost time: 0.5908851623535156
Epoch: 10, Steps: 9 | Train Loss: 0.630 Vali Loss: 0.794 Vali Acc: 0.710 Test Loss: 0.794 Test Acc: 0.710
Validation loss decreased (-0.710136 --> -0.710137).  Saving model ...
Epoch: 11 cost time: 0.6067409515380859
Epoch: 11, Steps: 9 | Train Loss: 0.548 Vali Loss: 0.729 Vali Acc: 0.717 Test Loss: 0.729 Test Acc: 0.717
Validation loss decreased (-0.710137 --> -0.717384).  Saving model ...
Epoch: 12 cost time: 0.6029148101806641
Epoch: 12, Steps: 9 | Train Loss: 0.498 Vali Loss: 0.673 Vali Acc: 0.754 Test Loss: 0.673 Test Acc: 0.754
Validation loss decreased (-0.717384 --> -0.753616).  Saving model ...
Epoch: 13 cost time: 0.6303775310516357
Epoch: 13, Steps: 9 | Train Loss: 0.405 Vali Loss: 0.630 Vali Acc: 0.775 Test Loss: 0.630 Test Acc: 0.775
Validation loss decreased (-0.753616 --> -0.775356).  Saving model ...
Epoch: 14 cost time: 0.616499662399292
Epoch: 14, Steps: 9 | Train Loss: 0.356 Vali Loss: 0.587 Vali Acc: 0.790 Test Loss: 0.587 Test Acc: 0.790
Validation loss decreased (-0.775356 --> -0.789849).  Saving model ...
Epoch: 15 cost time: 0.6674933433532715
Epoch: 15, Steps: 9 | Train Loss: 0.311 Vali Loss: 0.552 Vali Acc: 0.812 Test Loss: 0.552 Test Acc: 0.812
Validation loss decreased (-0.789849 --> -0.811589).  Saving model ...
Epoch: 16 cost time: 0.6578140258789062
Epoch: 16, Steps: 9 | Train Loss: 0.265 Vali Loss: 0.529 Vali Acc: 0.804 Test Loss: 0.529 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6461994647979736
Epoch: 17, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.507 Vali Acc: 0.804 Test Loss: 0.507 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.646594762802124
Epoch: 18, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.491 Vali Acc: 0.826 Test Loss: 0.491 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826082).  Saving model ...
Epoch: 19 cost time: 0.6022984981536865
Epoch: 19, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.491 Vali Acc: 0.819 Test Loss: 0.491 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6290690898895264
Epoch: 20, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.473 Vali Acc: 0.826 Test Loss: 0.473 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 21 cost time: 0.6658117771148682
Epoch: 21, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.447 Vali Acc: 0.841 Test Loss: 0.447 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 22 cost time: 0.6467814445495605
Epoch: 22, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.444 Vali Acc: 0.833 Test Loss: 0.444 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6829617023468018
Epoch: 23, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.441 Vali Acc: 0.841 Test Loss: 0.441 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 24 cost time: 0.6485824584960938
Epoch: 24, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.429 Vali Acc: 0.833 Test Loss: 0.429 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6926443576812744
Epoch: 25, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.438 Vali Acc: 0.833 Test Loss: 0.438 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.659945011138916
Epoch: 26, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.436 Vali Acc: 0.841 Test Loss: 0.436 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 27 cost time: 0.6428477764129639
Epoch: 27, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.432 Vali Acc: 0.848 Test Loss: 0.432 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 28 cost time: 0.6398084163665771
Epoch: 28, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.422 Vali Acc: 0.833 Test Loss: 0.422 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6240439414978027
Epoch: 29, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.410 Vali Acc: 0.848 Test Loss: 0.410 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 30 cost time: 0.5911569595336914
Epoch: 30, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.405 Vali Acc: 0.855 Test Loss: 0.405 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 31 cost time: 0.6151456832885742
Epoch: 31, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.425 Vali Acc: 0.848 Test Loss: 0.425 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7416670322418213
Epoch: 32, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.411 Vali Acc: 0.848 Test Loss: 0.411 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6277947425842285
Epoch: 33, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.427 Vali Acc: 0.841 Test Loss: 0.427 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5805368423461914
Epoch: 34, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.431 Vali Acc: 0.833 Test Loss: 0.431 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6578466892242432
Epoch: 35, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.421 Vali Acc: 0.848 Test Loss: 0.421 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6634821891784668
Epoch: 36, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.423 Vali Acc: 0.848 Test Loss: 0.423 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6231539249420166
Epoch: 37, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.425 Vali Acc: 0.855 Test Loss: 0.425 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6544332504272461
Epoch: 38, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.437 Vali Acc: 0.841 Test Loss: 0.437 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.6472699642181396
Epoch: 39, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.417 Vali Acc: 0.848 Test Loss: 0.417 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.6739635467529297
Epoch: 40, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.405 Vali Acc: 0.841 Test Loss: 0.405 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 165700
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.922734260559082
Epoch: 1, Steps: 9 | Train Loss: 1.363 Vali Loss: 1.329 Vali Acc: 0.362 Test Loss: 1.329 Test Acc: 0.362
Validation loss decreased (inf --> -0.362306).  Saving model ...
Epoch: 2 cost time: 0.5744247436523438
Epoch: 2, Steps: 9 | Train Loss: 1.234 Vali Loss: 1.211 Vali Acc: 0.558 Test Loss: 1.211 Test Acc: 0.558
Validation loss decreased (-0.362306 --> -0.557959).  Saving model ...
Epoch: 3 cost time: 0.6075112819671631
Epoch: 3, Steps: 9 | Train Loss: 1.049 Vali Loss: 1.055 Vali Acc: 0.688 Test Loss: 1.055 Test Acc: 0.688
Validation loss decreased (-0.557959 --> -0.688395).  Saving model ...
Epoch: 4 cost time: 0.5946519374847412
Epoch: 4, Steps: 9 | Train Loss: 0.876 Vali Loss: 0.886 Vali Acc: 0.746 Test Loss: 0.886 Test Acc: 0.746
Validation loss decreased (-0.688395 --> -0.746368).  Saving model ...
Epoch: 5 cost time: 0.582038402557373
Epoch: 5, Steps: 9 | Train Loss: 0.677 Vali Loss: 0.743 Vali Acc: 0.790 Test Loss: 0.743 Test Acc: 0.790
Validation loss decreased (-0.746368 --> -0.789848).  Saving model ...
Epoch: 6 cost time: 0.5857596397399902
Epoch: 6, Steps: 9 | Train Loss: 0.505 Vali Loss: 0.605 Vali Acc: 0.841 Test Loss: 0.605 Test Acc: 0.841
Validation loss decreased (-0.789848 --> -0.840574).  Saving model ...
Epoch: 7 cost time: 0.6088540554046631
Epoch: 7, Steps: 9 | Train Loss: 0.389 Vali Loss: 0.496 Vali Acc: 0.848 Test Loss: 0.496 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 8 cost time: 0.5986459255218506
Epoch: 8, Steps: 9 | Train Loss: 0.266 Vali Loss: 0.419 Vali Acc: 0.877 Test Loss: 0.419 Test Acc: 0.877
Validation loss decreased (-0.847821 --> -0.876807).  Saving model ...
Epoch: 9 cost time: 0.5767920017242432
Epoch: 9, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.363 Vali Acc: 0.884 Test Loss: 0.363 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 10 cost time: 0.5845687389373779
Epoch: 10, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.325 Vali Acc: 0.891 Test Loss: 0.325 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 11 cost time: 0.6407253742218018
Epoch: 11, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.309 Vali Acc: 0.899 Test Loss: 0.309 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 12 cost time: 0.6229729652404785
Epoch: 12, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.284 Vali Acc: 0.913 Test Loss: 0.284 Test Acc: 0.913
Validation loss decreased (-0.898548 --> -0.913041).  Saving model ...
Epoch: 13 cost time: 0.610774040222168
Epoch: 13, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.250 Vali Acc: 0.920 Test Loss: 0.250 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 14 cost time: 0.592742919921875
Epoch: 14, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.241 Vali Acc: 0.928 Test Loss: 0.241 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 15 cost time: 0.6685473918914795
Epoch: 15, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.246 Vali Acc: 0.920 Test Loss: 0.246 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6300134658813477
Epoch: 16, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 17 cost time: 0.6954154968261719
Epoch: 17, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 18 cost time: 0.576397180557251
Epoch: 18, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.240 Vali Acc: 0.913 Test Loss: 0.240 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5649502277374268
Epoch: 19, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.241 Vali Acc: 0.920 Test Loss: 0.241 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5809690952301025
Epoch: 20, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.243 Vali Acc: 0.920 Test Loss: 0.243 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6179041862487793
Epoch: 21, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.237 Vali Acc: 0.920 Test Loss: 0.237 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6436300277709961
Epoch: 22, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.231 Vali Acc: 0.920 Test Loss: 0.231 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5858397483825684
Epoch: 23, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.213 Vali Acc: 0.920 Test Loss: 0.213 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.580862283706665
Epoch: 24, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.224 Vali Acc: 0.920 Test Loss: 0.224 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6986963748931885
Epoch: 25, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.230 Vali Acc: 0.920 Test Loss: 0.230 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6511425971984863
Epoch: 26, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.229 Vali Acc: 0.920 Test Loss: 0.229 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.640350341796875
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.227 Vali Acc: 0.920 Test Loss: 0.227 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 69604
model size : 0.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.91554856300354
Epoch: 1, Steps: 9 | Train Loss: 1.351 Vali Loss: 1.345 Vali Acc: 0.362 Test Loss: 1.345 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 0.5470719337463379
Epoch: 2, Steps: 9 | Train Loss: 1.300 Vali Loss: 1.286 Vali Acc: 0.464 Test Loss: 1.286 Test Acc: 0.464
Validation loss decreased (-0.362305 --> -0.463755).  Saving model ...
Epoch: 3 cost time: 0.6315057277679443
Epoch: 3, Steps: 9 | Train Loss: 1.219 Vali Loss: 1.201 Vali Acc: 0.551 Test Loss: 1.201 Test Acc: 0.551
Validation loss decreased (-0.463755 --> -0.550713).  Saving model ...
Epoch: 4 cost time: 0.5675156116485596
Epoch: 4, Steps: 9 | Train Loss: 1.095 Vali Loss: 1.104 Vali Acc: 0.674 Test Loss: 1.104 Test Acc: 0.674
Validation loss decreased (-0.550713 --> -0.673902).  Saving model ...
Epoch: 5 cost time: 0.6117844581604004
Epoch: 5, Steps: 9 | Train Loss: 0.983 Vali Loss: 1.003 Vali Acc: 0.768 Test Loss: 1.003 Test Acc: 0.768
Validation loss decreased (-0.673902 --> -0.768106).  Saving model ...
Epoch: 6 cost time: 0.6151759624481201
Epoch: 6, Steps: 9 | Train Loss: 0.859 Vali Loss: 0.891 Vali Acc: 0.804 Test Loss: 0.891 Test Acc: 0.804
Validation loss decreased (-0.768106 --> -0.804339).  Saving model ...
Epoch: 7 cost time: 0.5618124008178711
Epoch: 7, Steps: 9 | Train Loss: 0.735 Vali Loss: 0.789 Vali Acc: 0.819 Test Loss: 0.789 Test Acc: 0.819
Validation loss decreased (-0.804339 --> -0.818833).  Saving model ...
Epoch: 8 cost time: 0.5488932132720947
Epoch: 8, Steps: 9 | Train Loss: 0.612 Vali Loss: 0.678 Vali Acc: 0.862 Test Loss: 0.678 Test Acc: 0.862
Validation loss decreased (-0.818833 --> -0.862312).  Saving model ...
Epoch: 9 cost time: 0.5719852447509766
Epoch: 9, Steps: 9 | Train Loss: 0.523 Vali Loss: 0.590 Vali Acc: 0.877 Test Loss: 0.590 Test Acc: 0.877
Validation loss decreased (-0.862312 --> -0.876806).  Saving model ...
Epoch: 10 cost time: 0.5654149055480957
Epoch: 10, Steps: 9 | Train Loss: 0.421 Vali Loss: 0.513 Vali Acc: 0.884 Test Loss: 0.513 Test Acc: 0.884
Validation loss decreased (-0.876806 --> -0.884053).  Saving model ...
Epoch: 11 cost time: 0.6029706001281738
Epoch: 11, Steps: 9 | Train Loss: 0.355 Vali Loss: 0.450 Vali Acc: 0.884 Test Loss: 0.450 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 12 cost time: 0.575786828994751
Epoch: 12, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.399 Vali Acc: 0.891 Test Loss: 0.399 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891300).  Saving model ...
Epoch: 13 cost time: 0.5655865669250488
Epoch: 13, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.362 Vali Acc: 0.891 Test Loss: 0.362 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891301).  Saving model ...
Epoch: 14 cost time: 0.6095583438873291
Epoch: 14, Steps: 9 | Train Loss: 0.189 Vali Loss: 0.329 Vali Acc: 0.913 Test Loss: 0.329 Test Acc: 0.913
Validation loss decreased (-0.891301 --> -0.913040).  Saving model ...
Epoch: 15 cost time: 0.5865387916564941
Epoch: 15, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.294 Vali Acc: 0.920 Test Loss: 0.294 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 16 cost time: 0.5459706783294678
Epoch: 16, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.279 Vali Acc: 0.913 Test Loss: 0.279 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5681111812591553
Epoch: 17, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5056679248809814
Epoch: 18, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.256 Vali Acc: 0.935 Test Loss: 0.256 Test Acc: 0.935
Validation loss decreased (-0.920287 --> -0.934780).  Saving model ...
Epoch: 19 cost time: 0.6000044345855713
Epoch: 19, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.246 Vali Acc: 0.935 Test Loss: 0.246 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 20 cost time: 0.6003549098968506
Epoch: 20, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.235 Vali Acc: 0.928 Test Loss: 0.235 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6024999618530273
Epoch: 21, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.232 Vali Acc: 0.928 Test Loss: 0.232 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6116256713867188
Epoch: 22, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.232 Vali Acc: 0.928 Test Loss: 0.232 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6060085296630859
Epoch: 23, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.234 Vali Acc: 0.928 Test Loss: 0.234 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5591599941253662
Epoch: 24, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.228 Vali Acc: 0.928 Test Loss: 0.228 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5805537700653076
Epoch: 25, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5886149406433105
Epoch: 26, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6069381237030029
Epoch: 27, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.216 Vali Acc: 0.928 Test Loss: 0.216 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6173191070556641
Epoch: 28, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.213 Vali Acc: 0.928 Test Loss: 0.213 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5787956714630127
Epoch: 29, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934781).  Saving model ...
Epoch: 30 cost time: 0.5457408428192139
Epoch: 30, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6700136661529541
Epoch: 31, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.215 Vali Acc: 0.928 Test Loss: 0.215 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5463502407073975
Epoch: 32, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.224 Vali Acc: 0.920 Test Loss: 0.224 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6557307243347168
Epoch: 33, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.231 Vali Acc: 0.920 Test Loss: 0.231 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5581076145172119
Epoch: 34, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.227 Vali Acc: 0.920 Test Loss: 0.227 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.639014720916748
Epoch: 35, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.219 Vali Acc: 0.920 Test Loss: 0.219 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.5553555488586426
Epoch: 36, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.217 Vali Acc: 0.920 Test Loss: 0.217 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5494332313537598
Epoch: 37, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.208 Vali Acc: 0.920 Test Loss: 0.208 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5368359088897705
Epoch: 38, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.5600094795227051
Epoch: 39, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 56708
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9679605960845947
Epoch: 1, Steps: 9 | Train Loss: 1.424 Vali Loss: 1.394 Vali Acc: 0.239 Test Loss: 1.394 Test Acc: 0.239
Validation loss decreased (inf --> -0.239116).  Saving model ...
Epoch: 2 cost time: 0.6347179412841797
Epoch: 2, Steps: 9 | Train Loss: 1.371 Vali Loss: 1.351 Vali Acc: 0.290 Test Loss: 1.351 Test Acc: 0.290
Validation loss decreased (-0.239116 --> -0.289842).  Saving model ...
Epoch: 3 cost time: 0.5709011554718018
Epoch: 3, Steps: 9 | Train Loss: 1.302 Vali Loss: 1.286 Vali Acc: 0.449 Test Loss: 1.286 Test Acc: 0.449
Validation loss decreased (-0.289842 --> -0.449263).  Saving model ...
Epoch: 4 cost time: 0.5734577178955078
Epoch: 4, Steps: 9 | Train Loss: 1.196 Vali Loss: 1.211 Vali Acc: 0.522 Test Loss: 1.211 Test Acc: 0.522
Validation loss decreased (-0.449263 --> -0.521727).  Saving model ...
Epoch: 5 cost time: 0.5855586528778076
Epoch: 5, Steps: 9 | Train Loss: 1.092 Vali Loss: 1.127 Vali Acc: 0.652 Test Loss: 1.127 Test Acc: 0.652
Validation loss decreased (-0.521727 --> -0.652163).  Saving model ...
Epoch: 6 cost time: 0.5750470161437988
Epoch: 6, Steps: 9 | Train Loss: 0.990 Vali Loss: 1.030 Vali Acc: 0.732 Test Loss: 1.030 Test Acc: 0.732
Validation loss decreased (-0.652163 --> -0.731874).  Saving model ...
Epoch: 7 cost time: 0.710709810256958
Epoch: 7, Steps: 9 | Train Loss: 0.848 Vali Loss: 0.929 Vali Acc: 0.812 Test Loss: 0.929 Test Acc: 0.812
Validation loss decreased (-0.731874 --> -0.811585).  Saving model ...
Epoch: 8 cost time: 0.6071722507476807
Epoch: 8, Steps: 9 | Train Loss: 0.747 Vali Loss: 0.832 Vali Acc: 0.804 Test Loss: 0.832 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6362190246582031
Epoch: 9, Steps: 9 | Train Loss: 0.626 Vali Loss: 0.739 Vali Acc: 0.833 Test Loss: 0.739 Test Acc: 0.833
Validation loss decreased (-0.811585 --> -0.833326).  Saving model ...
Epoch: 10 cost time: 0.5669305324554443
Epoch: 10, Steps: 9 | Train Loss: 0.548 Vali Loss: 0.653 Vali Acc: 0.855 Test Loss: 0.653 Test Acc: 0.855
Validation loss decreased (-0.833326 --> -0.855066).  Saving model ...
Epoch: 11 cost time: 0.57912278175354
Epoch: 11, Steps: 9 | Train Loss: 0.432 Vali Loss: 0.574 Vali Acc: 0.855 Test Loss: 0.574 Test Acc: 0.855
Validation loss decreased (-0.855066 --> -0.855067).  Saving model ...
Epoch: 12 cost time: 0.6059060096740723
Epoch: 12, Steps: 9 | Train Loss: 0.346 Vali Loss: 0.500 Vali Acc: 0.877 Test Loss: 0.500 Test Acc: 0.877
Validation loss decreased (-0.855067 --> -0.876807).  Saving model ...
Epoch: 13 cost time: 0.6070311069488525
Epoch: 13, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.445 Vali Acc: 0.899 Test Loss: 0.445 Test Acc: 0.899
Validation loss decreased (-0.876807 --> -0.898546).  Saving model ...
Epoch: 14 cost time: 0.6039919853210449
Epoch: 14, Steps: 9 | Train Loss: 0.250 Vali Loss: 0.414 Vali Acc: 0.913 Test Loss: 0.414 Test Acc: 0.913
Validation loss decreased (-0.898546 --> -0.913039).  Saving model ...
Epoch: 15 cost time: 0.6330134868621826
Epoch: 15, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.365 Vali Acc: 0.920 Test Loss: 0.365 Test Acc: 0.920
Validation loss decreased (-0.913039 --> -0.920286).  Saving model ...
Epoch: 16 cost time: 0.6137285232543945
Epoch: 16, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.351 Vali Acc: 0.920 Test Loss: 0.351 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 17 cost time: 0.603909969329834
Epoch: 17, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.339 Vali Acc: 0.913 Test Loss: 0.339 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6474177837371826
Epoch: 18, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.317 Vali Acc: 0.913 Test Loss: 0.317 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5775763988494873
Epoch: 19, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.318 Vali Acc: 0.906 Test Loss: 0.318 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6148223876953125
Epoch: 20, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.298 Vali Acc: 0.906 Test Loss: 0.298 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.56315016746521
Epoch: 21, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.296 Vali Acc: 0.906 Test Loss: 0.296 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5598757266998291
Epoch: 22, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.287 Vali Acc: 0.913 Test Loss: 0.287 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.605248212814331
Epoch: 23, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.279 Vali Acc: 0.920 Test Loss: 0.279 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920287).  Saving model ...
Epoch: 24 cost time: 0.572563886642456
Epoch: 24, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.260 Vali Acc: 0.920 Test Loss: 0.260 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 25 cost time: 0.5924372673034668
Epoch: 25, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.263 Vali Acc: 0.920 Test Loss: 0.263 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.690676212310791
Epoch: 26, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.261 Vali Acc: 0.920 Test Loss: 0.261 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6325914859771729
Epoch: 27, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.265 Vali Acc: 0.920 Test Loss: 0.265 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6750156879425049
Epoch: 28, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.254 Vali Acc: 0.920 Test Loss: 0.254 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 29 cost time: 0.5968108177185059
Epoch: 29, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.251 Vali Acc: 0.920 Test Loss: 0.251 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 30 cost time: 0.5656387805938721
Epoch: 30, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.252 Vali Acc: 0.920 Test Loss: 0.252 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5953760147094727
Epoch: 31, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.253 Vali Acc: 0.928 Test Loss: 0.253 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 32 cost time: 0.5834372043609619
Epoch: 32, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.246 Vali Acc: 0.913 Test Loss: 0.246 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5696229934692383
Epoch: 33, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.239 Vali Acc: 0.928 Test Loss: 0.239 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 34 cost time: 0.579399585723877
Epoch: 34, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.241 Vali Acc: 0.928 Test Loss: 0.241 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5833971500396729
Epoch: 35, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.242 Vali Acc: 0.928 Test Loss: 0.242 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5883181095123291
Epoch: 36, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 37 cost time: 0.6093723773956299
Epoch: 37, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.229 Vali Acc: 0.928 Test Loss: 0.229 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 38 cost time: 0.582831621170044
Epoch: 38, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.229 Vali Acc: 0.928 Test Loss: 0.229 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6488380432128906
Epoch: 39, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 40 cost time: 0.5938024520874023
Epoch: 40, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.234 Vali Acc: 0.928 Test Loss: 0.234 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5561721324920654
Epoch: 41, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.228 Vali Acc: 0.928 Test Loss: 0.228 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6717491149902344
Epoch: 42, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5339081287384033
Epoch: 43, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.232 Vali Acc: 0.928 Test Loss: 0.232 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6015253067016602
Epoch: 44, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.221 Vali Acc: 0.928 Test Loss: 0.221 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 45 cost time: 0.7252795696258545
Epoch: 45, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.221 Vali Acc: 0.928 Test Loss: 0.221 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5865733623504639
Epoch: 46, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7329394817352295
Epoch: 47, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.6168584823608398
Epoch: 48, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.234 Vali Acc: 0.928 Test Loss: 0.234 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.5560874938964844
Epoch: 49, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.231 Vali Acc: 0.928 Test Loss: 0.231 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.5535709857940674
Epoch: 50, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.231 Vali Acc: 0.928 Test Loss: 0.231 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 53796
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9351086616516113
Epoch: 1, Steps: 9 | Train Loss: 1.391 Vali Loss: 1.390 Vali Acc: 0.225 Test Loss: 1.390 Test Acc: 0.225
Validation loss decreased (inf --> -0.224624).  Saving model ...
Epoch: 2 cost time: 0.5870769023895264
Epoch: 2, Steps: 9 | Train Loss: 1.363 Vali Loss: 1.361 Vali Acc: 0.341 Test Loss: 1.361 Test Acc: 0.341
Validation loss decreased (-0.224624 --> -0.340566).  Saving model ...
Epoch: 3 cost time: 0.5305976867675781
Epoch: 3, Steps: 9 | Train Loss: 1.299 Vali Loss: 1.312 Vali Acc: 0.413 Test Loss: 1.312 Test Acc: 0.413
Validation loss decreased (-0.340566 --> -0.413030).  Saving model ...
Epoch: 4 cost time: 0.6047499179840088
Epoch: 4, Steps: 9 | Train Loss: 1.213 Vali Loss: 1.253 Vali Acc: 0.587 Test Loss: 1.253 Test Acc: 0.587
Validation loss decreased (-0.413030 --> -0.586944).  Saving model ...
Epoch: 5 cost time: 0.5831518173217773
Epoch: 5, Steps: 9 | Train Loss: 1.143 Vali Loss: 1.181 Vali Acc: 0.623 Test Loss: 1.181 Test Acc: 0.623
Validation loss decreased (-0.586944 --> -0.623177).  Saving model ...
Epoch: 6 cost time: 0.596343994140625
Epoch: 6, Steps: 9 | Train Loss: 1.060 Vali Loss: 1.110 Vali Acc: 0.667 Test Loss: 1.110 Test Acc: 0.667
Validation loss decreased (-0.623177 --> -0.666656).  Saving model ...
Epoch: 7 cost time: 0.5913207530975342
Epoch: 7, Steps: 9 | Train Loss: 0.983 Vali Loss: 1.027 Vali Acc: 0.710 Test Loss: 1.027 Test Acc: 0.710
Validation loss decreased (-0.666656 --> -0.710135).  Saving model ...
Epoch: 8 cost time: 0.5627892017364502
Epoch: 8, Steps: 9 | Train Loss: 0.885 Vali Loss: 0.949 Vali Acc: 0.732 Test Loss: 0.949 Test Acc: 0.732
Validation loss decreased (-0.710135 --> -0.731875).  Saving model ...
Epoch: 9 cost time: 0.5726065635681152
Epoch: 9, Steps: 9 | Train Loss: 0.794 Vali Loss: 0.868 Vali Acc: 0.768 Test Loss: 0.868 Test Acc: 0.768
Validation loss decreased (-0.731875 --> -0.768107).  Saving model ...
Epoch: 10 cost time: 0.5441393852233887
Epoch: 10, Steps: 9 | Train Loss: 0.700 Vali Loss: 0.791 Vali Acc: 0.775 Test Loss: 0.791 Test Acc: 0.775
Validation loss decreased (-0.768107 --> -0.775354).  Saving model ...
Epoch: 11 cost time: 0.551339864730835
Epoch: 11, Steps: 9 | Train Loss: 0.622 Vali Loss: 0.722 Vali Acc: 0.819 Test Loss: 0.722 Test Acc: 0.819
Validation loss decreased (-0.775354 --> -0.818833).  Saving model ...
Epoch: 12 cost time: 0.5901782512664795
Epoch: 12, Steps: 9 | Train Loss: 0.538 Vali Loss: 0.648 Vali Acc: 0.841 Test Loss: 0.648 Test Acc: 0.841
Validation loss decreased (-0.818833 --> -0.840573).  Saving model ...
Epoch: 13 cost time: 0.5677640438079834
Epoch: 13, Steps: 9 | Train Loss: 0.454 Vali Loss: 0.593 Vali Acc: 0.848 Test Loss: 0.593 Test Acc: 0.848
Validation loss decreased (-0.840573 --> -0.847820).  Saving model ...
Epoch: 14 cost time: 0.5757262706756592
Epoch: 14, Steps: 9 | Train Loss: 0.388 Vali Loss: 0.543 Vali Acc: 0.855 Test Loss: 0.543 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855067).  Saving model ...
Epoch: 15 cost time: 0.5612711906433105
Epoch: 15, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.495 Vali Acc: 0.862 Test Loss: 0.495 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 16 cost time: 0.5768749713897705
Epoch: 16, Steps: 9 | Train Loss: 0.304 Vali Loss: 0.464 Vali Acc: 0.862 Test Loss: 0.464 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 17 cost time: 0.588106632232666
Epoch: 17, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.438 Vali Acc: 0.877 Test Loss: 0.438 Test Acc: 0.877
Validation loss decreased (-0.862314 --> -0.876807).  Saving model ...
Epoch: 18 cost time: 0.5619134902954102
Epoch: 18, Steps: 9 | Train Loss: 0.359 Vali Loss: 0.393 Vali Acc: 0.877 Test Loss: 0.393 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876808).  Saving model ...
Epoch: 19 cost time: 0.5847814083099365
Epoch: 19, Steps: 9 | Train Loss: 0.205 Vali Loss: 0.390 Vali Acc: 0.891 Test Loss: 0.390 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891300).  Saving model ...
Epoch: 20 cost time: 0.580676794052124
Epoch: 20, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.380 Vali Acc: 0.891 Test Loss: 0.380 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891301).  Saving model ...
Epoch: 21 cost time: 0.5542740821838379
Epoch: 21, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.366 Vali Acc: 0.899 Test Loss: 0.366 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 22 cost time: 0.5474655628204346
Epoch: 22, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.350 Vali Acc: 0.891 Test Loss: 0.350 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5927286148071289
Epoch: 23, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.340 Vali Acc: 0.891 Test Loss: 0.340 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5724401473999023
Epoch: 24, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.334 Vali Acc: 0.884 Test Loss: 0.334 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5223593711853027
Epoch: 25, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.324 Vali Acc: 0.891 Test Loss: 0.324 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5721232891082764
Epoch: 26, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.314 Vali Acc: 0.899 Test Loss: 0.314 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898548).  Saving model ...
Epoch: 27 cost time: 0.5882141590118408
Epoch: 27, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.305 Vali Acc: 0.906 Test Loss: 0.305 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 28 cost time: 0.535789966583252
Epoch: 28, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.303 Vali Acc: 0.920 Test Loss: 0.303 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920287).  Saving model ...
Epoch: 29 cost time: 0.5753717422485352
Epoch: 29, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.297 Vali Acc: 0.891 Test Loss: 0.297 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6271157264709473
Epoch: 30, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.292 Vali Acc: 0.899 Test Loss: 0.292 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5532433986663818
Epoch: 31, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.287 Vali Acc: 0.913 Test Loss: 0.287 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5847020149230957
Epoch: 32, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.299 Vali Acc: 0.913 Test Loss: 0.299 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5373992919921875
Epoch: 33, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.307 Vali Acc: 0.899 Test Loss: 0.307 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5556473731994629
Epoch: 34, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.291 Vali Acc: 0.899 Test Loss: 0.291 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.570563793182373
Epoch: 35, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.284 Vali Acc: 0.906 Test Loss: 0.284 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.5765912532806396
Epoch: 36, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.5746703147888184
Epoch: 37, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.5808401107788086
Epoch: 38, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.269 Vali Acc: 0.906 Test Loss: 0.269 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 50884
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0653226375579834
Epoch: 1, Steps: 9 | Train Loss: 1.464 Vali Loss: 1.407 Vali Acc: 0.159 Test Loss: 1.407 Test Acc: 0.159
Validation loss decreased (inf --> -0.159406).  Saving model ...
Epoch: 2 cost time: 0.5998649597167969
Epoch: 2, Steps: 9 | Train Loss: 1.427 Vali Loss: 1.386 Vali Acc: 0.203 Test Loss: 1.386 Test Acc: 0.203
Validation loss decreased (-0.159406 --> -0.202885).  Saving model ...
Epoch: 3 cost time: 0.5552523136138916
Epoch: 3, Steps: 9 | Train Loss: 1.367 Vali Loss: 1.348 Vali Acc: 0.217 Test Loss: 1.348 Test Acc: 0.217
Validation loss decreased (-0.202885 --> -0.217378).  Saving model ...
Epoch: 4 cost time: 0.5271666049957275
Epoch: 4, Steps: 9 | Train Loss: 1.319 Vali Loss: 1.303 Vali Acc: 0.341 Test Loss: 1.303 Test Acc: 0.341
Validation loss decreased (-0.217378 --> -0.340567).  Saving model ...
Epoch: 5 cost time: 0.5293102264404297
Epoch: 5, Steps: 9 | Train Loss: 1.254 Vali Loss: 1.250 Vali Acc: 0.420 Test Loss: 1.250 Test Acc: 0.420
Validation loss decreased (-0.340567 --> -0.420277).  Saving model ...
Epoch: 6 cost time: 0.5283434391021729
Epoch: 6, Steps: 9 | Train Loss: 1.189 Vali Loss: 1.195 Vali Acc: 0.558 Test Loss: 1.195 Test Acc: 0.558
Validation loss decreased (-0.420277 --> -0.557959).  Saving model ...
Epoch: 7 cost time: 0.5246727466583252
Epoch: 7, Steps: 9 | Train Loss: 1.131 Vali Loss: 1.134 Vali Acc: 0.630 Test Loss: 1.134 Test Acc: 0.630
Validation loss decreased (-0.557959 --> -0.630423).  Saving model ...
Epoch: 8 cost time: 0.5853664875030518
Epoch: 8, Steps: 9 | Train Loss: 1.053 Vali Loss: 1.071 Vali Acc: 0.688 Test Loss: 1.071 Test Acc: 0.688
Validation loss decreased (-0.630423 --> -0.688395).  Saving model ...
Epoch: 9 cost time: 0.5579361915588379
Epoch: 9, Steps: 9 | Train Loss: 0.975 Vali Loss: 1.004 Vali Acc: 0.710 Test Loss: 1.004 Test Acc: 0.710
Validation loss decreased (-0.688395 --> -0.710135).  Saving model ...
Epoch: 10 cost time: 0.5997247695922852
Epoch: 10, Steps: 9 | Train Loss: 0.901 Vali Loss: 0.940 Vali Acc: 0.739 Test Loss: 0.940 Test Acc: 0.739
Validation loss decreased (-0.710135 --> -0.739121).  Saving model ...
Epoch: 11 cost time: 0.551222562789917
Epoch: 11, Steps: 9 | Train Loss: 0.808 Vali Loss: 0.874 Vali Acc: 0.746 Test Loss: 0.874 Test Acc: 0.746
Validation loss decreased (-0.739121 --> -0.746368).  Saving model ...
Epoch: 12 cost time: 0.5871663093566895
Epoch: 12, Steps: 9 | Train Loss: 0.748 Vali Loss: 0.810 Vali Acc: 0.804 Test Loss: 0.810 Test Acc: 0.804
Validation loss decreased (-0.746368 --> -0.804340).  Saving model ...
Epoch: 13 cost time: 0.5824944972991943
Epoch: 13, Steps: 9 | Train Loss: 0.643 Vali Loss: 0.745 Vali Acc: 0.812 Test Loss: 0.745 Test Acc: 0.812
Validation loss decreased (-0.804340 --> -0.811587).  Saving model ...
Epoch: 14 cost time: 0.6720967292785645
Epoch: 14, Steps: 9 | Train Loss: 0.582 Vali Loss: 0.686 Vali Acc: 0.797 Test Loss: 0.686 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5490128993988037
Epoch: 15, Steps: 9 | Train Loss: 0.519 Vali Loss: 0.632 Vali Acc: 0.819 Test Loss: 0.632 Test Acc: 0.819
Validation loss decreased (-0.811587 --> -0.818834).  Saving model ...
Epoch: 16 cost time: 0.6590261459350586
Epoch: 16, Steps: 9 | Train Loss: 0.467 Vali Loss: 0.590 Vali Acc: 0.841 Test Loss: 0.590 Test Acc: 0.841
Validation loss decreased (-0.818834 --> -0.840574).  Saving model ...
Epoch: 17 cost time: 0.663010835647583
Epoch: 17, Steps: 9 | Train Loss: 0.405 Vali Loss: 0.558 Vali Acc: 0.855 Test Loss: 0.558 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855067).  Saving model ...
Epoch: 18 cost time: 0.5975160598754883
Epoch: 18, Steps: 9 | Train Loss: 0.372 Vali Loss: 0.529 Vali Acc: 0.855 Test Loss: 0.529 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 19 cost time: 0.5596904754638672
Epoch: 19, Steps: 9 | Train Loss: 0.317 Vali Loss: 0.506 Vali Acc: 0.870 Test Loss: 0.506 Test Acc: 0.870
Validation loss decreased (-0.855067 --> -0.869560).  Saving model ...
Epoch: 20 cost time: 0.6202144622802734
Epoch: 20, Steps: 9 | Train Loss: 0.283 Vali Loss: 0.471 Vali Acc: 0.870 Test Loss: 0.471 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869561).  Saving model ...
Epoch: 21 cost time: 0.4670522212982178
Epoch: 21, Steps: 9 | Train Loss: 0.248 Vali Loss: 0.446 Vali Acc: 0.862 Test Loss: 0.446 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5498166084289551
Epoch: 22, Steps: 9 | Train Loss: 0.228 Vali Loss: 0.425 Vali Acc: 0.870 Test Loss: 0.425 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 23 cost time: 0.5726289749145508
Epoch: 23, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.419 Vali Acc: 0.891 Test Loss: 0.419 Test Acc: 0.891
Validation loss decreased (-0.869561 --> -0.891300).  Saving model ...
Epoch: 24 cost time: 0.5351951122283936
Epoch: 24, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.389 Vali Acc: 0.884 Test Loss: 0.389 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.533592939376831
Epoch: 25, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.378 Vali Acc: 0.899 Test Loss: 0.378 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 26 cost time: 0.5145728588104248
Epoch: 26, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.373 Vali Acc: 0.899 Test Loss: 0.373 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 27 cost time: 0.5792675018310547
Epoch: 27, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.364 Vali Acc: 0.899 Test Loss: 0.364 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 28 cost time: 0.609745979309082
Epoch: 28, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.350 Vali Acc: 0.899 Test Loss: 0.350 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 29 cost time: 0.7410857677459717
Epoch: 29, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.351 Vali Acc: 0.899 Test Loss: 0.351 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6234893798828125
Epoch: 30, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.348 Vali Acc: 0.899 Test Loss: 0.348 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 31 cost time: 0.5839323997497559
Epoch: 31, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.346 Vali Acc: 0.884 Test Loss: 0.346 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6125826835632324
Epoch: 32, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.325 Vali Acc: 0.899 Test Loss: 0.325 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 33 cost time: 0.6321120262145996
Epoch: 33, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.329 Vali Acc: 0.899 Test Loss: 0.329 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5935838222503662
Epoch: 34, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.334 Vali Acc: 0.899 Test Loss: 0.334 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5512092113494873
Epoch: 35, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.320 Vali Acc: 0.899 Test Loss: 0.320 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898548).  Saving model ...
Epoch: 36 cost time: 0.5649478435516357
Epoch: 36, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.320 Vali Acc: 0.899 Test Loss: 0.320 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 37 cost time: 0.5865387916564941
Epoch: 37, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.322 Vali Acc: 0.891 Test Loss: 0.322 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5690503120422363
Epoch: 38, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.318 Vali Acc: 0.891 Test Loss: 0.318 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6092116832733154
Epoch: 39, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.313 Vali Acc: 0.899 Test Loss: 0.313 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 40 cost time: 0.6076879501342773
Epoch: 40, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.307 Vali Acc: 0.899 Test Loss: 0.307 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 41 cost time: 0.5900907516479492
Epoch: 41, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.311 Vali Acc: 0.899 Test Loss: 0.311 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5073778629302979
Epoch: 42, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.305 Vali Acc: 0.899 Test Loss: 0.305 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 43 cost time: 0.5426123142242432
Epoch: 43, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.304 Vali Acc: 0.891 Test Loss: 0.304 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5798873901367188
Epoch: 44, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.314 Vali Acc: 0.891 Test Loss: 0.314 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6052854061126709
Epoch: 45, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.325 Vali Acc: 0.891 Test Loss: 0.325 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6265561580657959
Epoch: 46, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.307 Vali Acc: 0.884 Test Loss: 0.307 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.5296783447265625
Epoch: 47, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.283 Vali Acc: 0.899 Test Loss: 0.283 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 48 cost time: 0.5629599094390869
Epoch: 48, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 49 cost time: 0.5694620609283447
Epoch: 49, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.280 Vali Acc: 0.899 Test Loss: 0.280 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5340855121612549
Epoch: 50, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.282 Vali Acc: 0.899 Test Loss: 0.282 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 48900
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.851193904876709
Epoch: 1, Steps: 9 | Train Loss: 1.416 Vali Loss: 1.409 Vali Acc: 0.232 Test Loss: 1.409 Test Acc: 0.232
Validation loss decreased (inf --> -0.231870).  Saving model ...
Epoch: 2 cost time: 0.5578281879425049
Epoch: 2, Steps: 9 | Train Loss: 1.393 Vali Loss: 1.386 Vali Acc: 0.275 Test Loss: 1.386 Test Acc: 0.275
Validation loss decreased (-0.231870 --> -0.275348).  Saving model ...
Epoch: 3 cost time: 0.5804507732391357
Epoch: 3, Steps: 9 | Train Loss: 1.353 Vali Loss: 1.348 Vali Acc: 0.333 Test Loss: 1.348 Test Acc: 0.333
Validation loss decreased (-0.275348 --> -0.333320).  Saving model ...
Epoch: 4 cost time: 0.5320892333984375
Epoch: 4, Steps: 9 | Train Loss: 1.326 Vali Loss: 1.302 Vali Acc: 0.413 Test Loss: 1.302 Test Acc: 0.413
Validation loss decreased (-0.333320 --> -0.413030).  Saving model ...
Epoch: 5 cost time: 0.5952351093292236
Epoch: 5, Steps: 9 | Train Loss: 1.250 Vali Loss: 1.253 Vali Acc: 0.536 Test Loss: 1.253 Test Acc: 0.536
Validation loss decreased (-0.413030 --> -0.536219).  Saving model ...
Epoch: 6 cost time: 0.6277337074279785
Epoch: 6, Steps: 9 | Train Loss: 1.192 Vali Loss: 1.199 Vali Acc: 0.710 Test Loss: 1.199 Test Acc: 0.710
Validation loss decreased (-0.536219 --> -0.710133).  Saving model ...
Epoch: 7 cost time: 0.5265328884124756
Epoch: 7, Steps: 9 | Train Loss: 1.134 Vali Loss: 1.147 Vali Acc: 0.768 Test Loss: 1.147 Test Acc: 0.768
Validation loss decreased (-0.710133 --> -0.768104).  Saving model ...
Epoch: 8 cost time: 0.5524981021881104
Epoch: 8, Steps: 9 | Train Loss: 1.080 Vali Loss: 1.081 Vali Acc: 0.797 Test Loss: 1.081 Test Acc: 0.797
Validation loss decreased (-0.768104 --> -0.797091).  Saving model ...
Epoch: 9 cost time: 0.5372617244720459
Epoch: 9, Steps: 9 | Train Loss: 1.011 Vali Loss: 1.023 Vali Acc: 0.833 Test Loss: 1.023 Test Acc: 0.833
Validation loss decreased (-0.797091 --> -0.833323).  Saving model ...
Epoch: 10 cost time: 0.5550801753997803
Epoch: 10, Steps: 9 | Train Loss: 0.958 Vali Loss: 0.961 Vali Acc: 0.841 Test Loss: 0.961 Test Acc: 0.841
Validation loss decreased (-0.833323 --> -0.840570).  Saving model ...
Epoch: 11 cost time: 0.5447132587432861
Epoch: 11, Steps: 9 | Train Loss: 0.870 Vali Loss: 0.895 Vali Acc: 0.812 Test Loss: 0.895 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5528457164764404
Epoch: 12, Steps: 9 | Train Loss: 0.796 Vali Loss: 0.841 Vali Acc: 0.812 Test Loss: 0.841 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5374178886413574
Epoch: 13, Steps: 9 | Train Loss: 0.717 Vali Loss: 0.774 Vali Acc: 0.812 Test Loss: 0.774 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5744459629058838
Epoch: 14, Steps: 9 | Train Loss: 0.673 Vali Loss: 0.713 Vali Acc: 0.804 Test Loss: 0.713 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5226364135742188
Epoch: 15, Steps: 9 | Train Loss: 0.583 Vali Loss: 0.667 Vali Acc: 0.819 Test Loss: 0.667 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5347375869750977
Epoch: 16, Steps: 9 | Train Loss: 0.528 Vali Loss: 0.620 Vali Acc: 0.833 Test Loss: 0.620 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5584988594055176
Epoch: 17, Steps: 9 | Train Loss: 0.464 Vali Loss: 0.576 Vali Acc: 0.862 Test Loss: 0.576 Test Acc: 0.862
Validation loss decreased (-0.840570 --> -0.862313).  Saving model ...
Epoch: 18 cost time: 0.5098192691802979
Epoch: 18, Steps: 9 | Train Loss: 0.432 Vali Loss: 0.546 Vali Acc: 0.870 Test Loss: 0.546 Test Acc: 0.870
Validation loss decreased (-0.862313 --> -0.869560).  Saving model ...
Epoch: 19 cost time: 0.5679271221160889
Epoch: 19, Steps: 9 | Train Loss: 0.380 Vali Loss: 0.515 Vali Acc: 0.870 Test Loss: 0.515 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 20 cost time: 0.5498902797698975
Epoch: 20, Steps: 9 | Train Loss: 0.341 Vali Loss: 0.484 Vali Acc: 0.877 Test Loss: 0.484 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876807).  Saving model ...
Epoch: 21 cost time: 0.549436092376709
Epoch: 21, Steps: 9 | Train Loss: 0.298 Vali Loss: 0.460 Vali Acc: 0.884 Test Loss: 0.460 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884053).  Saving model ...
Epoch: 22 cost time: 0.632512092590332
Epoch: 22, Steps: 9 | Train Loss: 0.257 Vali Loss: 0.437 Vali Acc: 0.891 Test Loss: 0.437 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891300).  Saving model ...
Epoch: 23 cost time: 0.6239488124847412
Epoch: 23, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.424 Vali Acc: 0.891 Test Loss: 0.424 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 24 cost time: 0.539146900177002
Epoch: 24, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.404 Vali Acc: 0.899 Test Loss: 0.404 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 25 cost time: 0.5743427276611328
Epoch: 25, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.382 Vali Acc: 0.906 Test Loss: 0.382 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 26 cost time: 0.6186375617980957
Epoch: 26, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.370 Vali Acc: 0.906 Test Loss: 0.370 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 27 cost time: 0.5686495304107666
Epoch: 27, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.357 Vali Acc: 0.906 Test Loss: 0.357 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905794).  Saving model ...
Epoch: 28 cost time: 0.5783615112304688
Epoch: 28, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.347 Vali Acc: 0.906 Test Loss: 0.347 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 29 cost time: 0.5323734283447266
Epoch: 29, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.349 Vali Acc: 0.906 Test Loss: 0.349 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5401835441589355
Epoch: 30, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.329 Vali Acc: 0.906 Test Loss: 0.329 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 31 cost time: 0.5939228534698486
Epoch: 31, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.316 Vali Acc: 0.906 Test Loss: 0.316 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 32 cost time: 0.5539510250091553
Epoch: 32, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.312 Vali Acc: 0.906 Test Loss: 0.312 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 33 cost time: 0.5822434425354004
Epoch: 33, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.311 Vali Acc: 0.906 Test Loss: 0.311 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 34 cost time: 0.5237240791320801
Epoch: 34, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.308 Vali Acc: 0.913 Test Loss: 0.308 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 35 cost time: 0.5606050491333008
Epoch: 35, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.309 Vali Acc: 0.913 Test Loss: 0.309 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6071672439575195
Epoch: 36, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.294 Vali Acc: 0.913 Test Loss: 0.294 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913041).  Saving model ...
Epoch: 37 cost time: 0.6196646690368652
Epoch: 37, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.292 Vali Acc: 0.913 Test Loss: 0.292 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 38 cost time: 0.6496713161468506
Epoch: 38, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.287 Vali Acc: 0.913 Test Loss: 0.287 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 39 cost time: 0.5785624980926514
Epoch: 39, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.293 Vali Acc: 0.913 Test Loss: 0.293 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6117153167724609
Epoch: 40, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.283 Vali Acc: 0.913 Test Loss: 0.283 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 41 cost time: 0.5570251941680908
Epoch: 41, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.271 Vali Acc: 0.906 Test Loss: 0.271 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.575300931930542
Epoch: 42, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.271 Vali Acc: 0.906 Test Loss: 0.271 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5650942325592041
Epoch: 43, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.279 Vali Acc: 0.906 Test Loss: 0.279 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5535495281219482
Epoch: 44, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.280 Vali Acc: 0.906 Test Loss: 0.280 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.5494241714477539
Epoch: 45, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.5279529094696045
Epoch: 46, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.540818452835083
Epoch: 47, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.5609838962554932
Epoch: 48, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.278 Vali Acc: 0.906 Test Loss: 0.278 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.5658454895019531
Epoch: 49, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.278 Vali Acc: 0.913 Test Loss: 0.278 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 50 cost time: 0.49318838119506836
Epoch: 50, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.285 Vali Acc: 0.913 Test Loss: 0.285 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 48484
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.737833023071289
Epoch: 1, Steps: 9 | Train Loss: 1.431 Vali Loss: 1.397 Vali Acc: 0.312 Test Loss: 1.397 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 0.642920732498169
Epoch: 2, Steps: 9 | Train Loss: 1.402 Vali Loss: 1.382 Vali Acc: 0.362 Test Loss: 1.382 Test Acc: 0.362
Validation loss decreased (-0.311580 --> -0.362305).  Saving model ...
Epoch: 3 cost time: 0.5765159130096436
Epoch: 3, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.355 Vali Acc: 0.391 Test Loss: 1.355 Test Acc: 0.391
Validation loss decreased (-0.362305 --> -0.391291).  Saving model ...
Epoch: 4 cost time: 0.6018028259277344
Epoch: 4, Steps: 9 | Train Loss: 1.315 Vali Loss: 1.318 Vali Acc: 0.478 Test Loss: 1.318 Test Acc: 0.478
Validation loss decreased (-0.391291 --> -0.478248).  Saving model ...
Epoch: 5 cost time: 0.5731728076934814
Epoch: 5, Steps: 9 | Train Loss: 1.265 Vali Loss: 1.275 Vali Acc: 0.587 Test Loss: 1.275 Test Acc: 0.587
Validation loss decreased (-0.478248 --> -0.586944).  Saving model ...
Epoch: 6 cost time: 0.5424349308013916
Epoch: 6, Steps: 9 | Train Loss: 1.217 Vali Loss: 1.229 Vali Acc: 0.674 Test Loss: 1.229 Test Acc: 0.674
Validation loss decreased (-0.586944 --> -0.673901).  Saving model ...
Epoch: 7 cost time: 0.5358011722564697
Epoch: 7, Steps: 9 | Train Loss: 1.153 Vali Loss: 1.177 Vali Acc: 0.710 Test Loss: 1.177 Test Acc: 0.710
Validation loss decreased (-0.673901 --> -0.710133).  Saving model ...
Epoch: 8 cost time: 0.5541362762451172
Epoch: 8, Steps: 9 | Train Loss: 1.104 Vali Loss: 1.124 Vali Acc: 0.717 Test Loss: 1.124 Test Acc: 0.717
Validation loss decreased (-0.710133 --> -0.717380).  Saving model ...
Epoch: 9 cost time: 0.5923528671264648
Epoch: 9, Steps: 9 | Train Loss: 1.024 Vali Loss: 1.075 Vali Acc: 0.739 Test Loss: 1.075 Test Acc: 0.739
Validation loss decreased (-0.717380 --> -0.739120).  Saving model ...
Epoch: 10 cost time: 0.578993558883667
Epoch: 10, Steps: 9 | Train Loss: 0.948 Vali Loss: 1.016 Vali Acc: 0.754 Test Loss: 1.016 Test Acc: 0.754
Validation loss decreased (-0.739120 --> -0.753613).  Saving model ...
Epoch: 11 cost time: 0.5883281230926514
Epoch: 11, Steps: 9 | Train Loss: 0.895 Vali Loss: 0.957 Vali Acc: 0.761 Test Loss: 0.957 Test Acc: 0.761
Validation loss decreased (-0.753613 --> -0.760860).  Saving model ...
Epoch: 12 cost time: 0.5272855758666992
Epoch: 12, Steps: 9 | Train Loss: 0.811 Vali Loss: 0.898 Vali Acc: 0.768 Test Loss: 0.898 Test Acc: 0.768
Validation loss decreased (-0.760860 --> -0.768107).  Saving model ...
Epoch: 13 cost time: 0.5271797180175781
Epoch: 13, Steps: 9 | Train Loss: 0.750 Vali Loss: 0.842 Vali Acc: 0.783 Test Loss: 0.842 Test Acc: 0.783
Validation loss decreased (-0.768107 --> -0.782600).  Saving model ...
Epoch: 14 cost time: 0.534257173538208
Epoch: 14, Steps: 9 | Train Loss: 0.698 Vali Loss: 0.793 Vali Acc: 0.775 Test Loss: 0.793 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5337095260620117
Epoch: 15, Steps: 9 | Train Loss: 0.636 Vali Loss: 0.747 Vali Acc: 0.775 Test Loss: 0.747 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.602696418762207
Epoch: 16, Steps: 9 | Train Loss: 0.567 Vali Loss: 0.710 Vali Acc: 0.783 Test Loss: 0.710 Test Acc: 0.783
Validation loss decreased (-0.782600 --> -0.782602).  Saving model ...
Epoch: 17 cost time: 0.5571384429931641
Epoch: 17, Steps: 9 | Train Loss: 0.520 Vali Loss: 0.673 Vali Acc: 0.790 Test Loss: 0.673 Test Acc: 0.790
Validation loss decreased (-0.782602 --> -0.789848).  Saving model ...
Epoch: 18 cost time: 0.631756067276001
Epoch: 18, Steps: 9 | Train Loss: 0.481 Vali Loss: 0.645 Vali Acc: 0.797 Test Loss: 0.645 Test Acc: 0.797
Validation loss decreased (-0.789848 --> -0.797095).  Saving model ...
Epoch: 19 cost time: 0.5621862411499023
Epoch: 19, Steps: 9 | Train Loss: 0.434 Vali Loss: 0.610 Vali Acc: 0.790 Test Loss: 0.610 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6194179058074951
Epoch: 20, Steps: 9 | Train Loss: 0.411 Vali Loss: 0.585 Vali Acc: 0.797 Test Loss: 0.585 Test Acc: 0.797
Validation loss decreased (-0.797095 --> -0.797096).  Saving model ...
Epoch: 21 cost time: 0.5731778144836426
Epoch: 21, Steps: 9 | Train Loss: 0.379 Vali Loss: 0.573 Vali Acc: 0.804 Test Loss: 0.573 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 22 cost time: 0.6096961498260498
Epoch: 22, Steps: 9 | Train Loss: 0.353 Vali Loss: 0.545 Vali Acc: 0.819 Test Loss: 0.545 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818835).  Saving model ...
Epoch: 23 cost time: 0.5364029407501221
Epoch: 23, Steps: 9 | Train Loss: 0.298 Vali Loss: 0.531 Vali Acc: 0.819 Test Loss: 0.531 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 24 cost time: 0.5207974910736084
Epoch: 24, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.508 Vali Acc: 0.812 Test Loss: 0.508 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5400383472442627
Epoch: 25, Steps: 9 | Train Loss: 0.286 Vali Loss: 0.497 Vali Acc: 0.812 Test Loss: 0.497 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5352518558502197
Epoch: 26, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.478 Vali Acc: 0.819 Test Loss: 0.478 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818836).  Saving model ...
Epoch: 27 cost time: 0.54170823097229
Epoch: 27, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.466 Vali Acc: 0.819 Test Loss: 0.466 Test Acc: 0.819
Validation loss decreased (-0.818836 --> -0.818836).  Saving model ...
Epoch: 28 cost time: 0.5697455406188965
Epoch: 28, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.454 Vali Acc: 0.833 Test Loss: 0.454 Test Acc: 0.833
Validation loss decreased (-0.818836 --> -0.833329).  Saving model ...
Epoch: 29 cost time: 0.5975747108459473
Epoch: 29, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.436 Vali Acc: 0.841 Test Loss: 0.436 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 30 cost time: 0.6060333251953125
Epoch: 30, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.427 Vali Acc: 0.833 Test Loss: 0.427 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5934603214263916
Epoch: 31, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.421 Vali Acc: 0.833 Test Loss: 0.421 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.574052095413208
Epoch: 32, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.412 Vali Acc: 0.848 Test Loss: 0.412 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 33 cost time: 0.5614199638366699
Epoch: 33, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.411 Vali Acc: 0.848 Test Loss: 0.411 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 34 cost time: 0.5831451416015625
Epoch: 34, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.405 Vali Acc: 0.848 Test Loss: 0.405 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 35 cost time: 0.5806915760040283
Epoch: 35, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.404 Vali Acc: 0.848 Test Loss: 0.404 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 36 cost time: 0.5288252830505371
Epoch: 36, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.406 Vali Acc: 0.848 Test Loss: 0.406 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5423355102539062
Epoch: 37, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.399 Vali Acc: 0.848 Test Loss: 0.399 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 38 cost time: 0.5825827121734619
Epoch: 38, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.396 Vali Acc: 0.855 Test Loss: 0.396 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 39 cost time: 0.6008567810058594
Epoch: 39, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.390 Vali Acc: 0.862 Test Loss: 0.390 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 40 cost time: 0.5838077068328857
Epoch: 40, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.389 Vali Acc: 0.862 Test Loss: 0.389 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 41 cost time: 0.5562150478363037
Epoch: 41, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.388 Vali Acc: 0.855 Test Loss: 0.388 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5327348709106445
Epoch: 42, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.387 Vali Acc: 0.855 Test Loss: 0.387 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.57647705078125
Epoch: 43, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.375 Vali Acc: 0.855 Test Loss: 0.375 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5430822372436523
Epoch: 44, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.373 Vali Acc: 0.855 Test Loss: 0.373 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.5470840930938721
Epoch: 45, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.382 Vali Acc: 0.855 Test Loss: 0.382 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.5625860691070557
Epoch: 46, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.368 Vali Acc: 0.862 Test Loss: 0.368 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 47 cost time: 0.5997390747070312
Epoch: 47, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.372 Vali Acc: 0.862 Test Loss: 0.372 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5230350494384766
Epoch: 48, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.392 Vali Acc: 0.855 Test Loss: 0.392 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5170931816101074
Epoch: 49, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.400 Vali Acc: 0.855 Test Loss: 0.400 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5451657772064209
Epoch: 50, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.399 Vali Acc: 0.862 Test Loss: 0.399 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 48036
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9719059467315674
Epoch: 1, Steps: 9 | Train Loss: 1.285 Vali Loss: 1.023 Vali Acc: 0.565 Test Loss: 1.023 Test Acc: 0.565
Validation loss decreased (inf --> -0.565207).  Saving model ...
Epoch: 2 cost time: 0.6919097900390625
Epoch: 2, Steps: 9 | Train Loss: 0.526 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
Validation loss decreased (-0.565207 --> -0.840574).  Saving model ...
Epoch: 3 cost time: 0.704458475112915
Epoch: 3, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.220 Vali Acc: 0.935 Test Loss: 0.220 Test Acc: 0.935
Validation loss decreased (-0.840574 --> -0.934780).  Saving model ...
Epoch: 4 cost time: 0.6689274311065674
Epoch: 4, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.158 Vali Acc: 0.942 Test Loss: 0.158 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 5 cost time: 0.656761884689331
Epoch: 5, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.200 Vali Acc: 0.942 Test Loss: 0.200 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6731419563293457
Epoch: 6, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7467215061187744
Epoch: 7, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.935 Test Loss: 0.213 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6687717437744141
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6813523769378662
Epoch: 9, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.928 Test Loss: 0.217 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6404447555541992
Epoch: 10, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.199 Vali Acc: 0.935 Test Loss: 0.199 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.4751901626586914
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949274).  Saving model ...
Epoch: 12 cost time: 0.6226551532745361
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.644568681716919
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.942 Test Loss: 0.204 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.602081298828125
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.942 Test Loss: 0.192 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7022359371185303
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.935 Test Loss: 0.191 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6549398899078369
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.935 Test Loss: 0.188 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7051451206207275
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.942 Test Loss: 0.192 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.667616605758667
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.942 Test Loss: 0.206 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6712400913238525
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.942 Test Loss: 0.212 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6970980167388916
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.942 Test Loss: 0.211 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6355898380279541
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.935 Test Loss: 0.187 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 629508
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.7017638683319092
Epoch: 1, Steps: 9 | Train Loss: 1.335 Vali Loss: 1.123 Vali Acc: 0.652 Test Loss: 1.123 Test Acc: 0.652
Validation loss decreased (inf --> -0.652163).  Saving model ...
Epoch: 2 cost time: 0.567617654800415
Epoch: 2, Steps: 9 | Train Loss: 0.786 Vali Loss: 0.649 Vali Acc: 0.826 Test Loss: 0.649 Test Acc: 0.826
Validation loss decreased (-0.652163 --> -0.826080).  Saving model ...
Epoch: 3 cost time: 0.5814929008483887
Epoch: 3, Steps: 9 | Train Loss: 0.350 Vali Loss: 0.388 Vali Acc: 0.906 Test Loss: 0.388 Test Acc: 0.906
Validation loss decreased (-0.826080 --> -0.905793).  Saving model ...
Epoch: 4 cost time: 0.5870361328125
Epoch: 4, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.234 Vali Acc: 0.942 Test Loss: 0.234 Test Acc: 0.942
Validation loss decreased (-0.905793 --> -0.942027).  Saving model ...
Epoch: 5 cost time: 0.60164475440979
Epoch: 5, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.194 Vali Acc: 0.942 Test Loss: 0.194 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 6 cost time: 0.5988752841949463
Epoch: 6, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.186 Vali Acc: 0.942 Test Loss: 0.186 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 7 cost time: 0.543799877166748
Epoch: 7, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.196 Vali Acc: 0.942 Test Loss: 0.196 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6024603843688965
Epoch: 8, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.186 Vali Acc: 0.935 Test Loss: 0.186 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5694398880004883
Epoch: 9, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.183 Vali Acc: 0.935 Test Loss: 0.183 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5851418972015381
Epoch: 10, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.935 Test Loss: 0.183 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5896661281585693
Epoch: 11, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.180 Vali Acc: 0.942 Test Loss: 0.180 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 12 cost time: 0.6132864952087402
Epoch: 12, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.179 Vali Acc: 0.942 Test Loss: 0.179 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 13 cost time: 0.606827974319458
Epoch: 13, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.942 Test Loss: 0.199 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5611486434936523
Epoch: 14, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.942 Test Loss: 0.193 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5794670581817627
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.935 Test Loss: 0.204 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5878684520721436
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.598203182220459
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.935 Test Loss: 0.190 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6129488945007324
Epoch: 18, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.168 Vali Acc: 0.942 Test Loss: 0.168 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 19 cost time: 0.5873825550079346
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949274).  Saving model ...
Epoch: 20 cost time: 0.6400904655456543
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.942 Test Loss: 0.183 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5937862396240234
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.942 Test Loss: 0.192 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6791775226593018
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.942 Test Loss: 0.188 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5832157135009766
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.942 Test Loss: 0.176 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5467402935028076
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.942 Test Loss: 0.181 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5596613883972168
Epoch: 25, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.192 Vali Acc: 0.935 Test Loss: 0.192 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6153919696807861
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.942 Test Loss: 0.223 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6079401969909668
Epoch: 27, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.232 Vali Acc: 0.942 Test Loss: 0.232 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5989785194396973
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5610287189483643
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.899 Test Loss: 0.305 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 526340
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8622376918792725
Epoch: 1, Steps: 9 | Train Loss: 1.396 Vali Loss: 1.195 Vali Acc: 0.514 Test Loss: 1.195 Test Acc: 0.514
Validation loss decreased (inf --> -0.514481).  Saving model ...
Epoch: 2 cost time: 0.5949108600616455
Epoch: 2, Steps: 9 | Train Loss: 0.859 Vali Loss: 0.768 Vali Acc: 0.775 Test Loss: 0.768 Test Acc: 0.775
Validation loss decreased (-0.514481 --> -0.775355).  Saving model ...
Epoch: 3 cost time: 0.5965452194213867
Epoch: 3, Steps: 9 | Train Loss: 0.408 Vali Loss: 0.465 Vali Acc: 0.877 Test Loss: 0.465 Test Acc: 0.877
Validation loss decreased (-0.775355 --> -0.876807).  Saving model ...
Epoch: 4 cost time: 0.5584790706634521
Epoch: 4, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.302 Vali Acc: 0.920 Test Loss: 0.302 Test Acc: 0.920
Validation loss decreased (-0.876807 --> -0.920287).  Saving model ...
Epoch: 5 cost time: 0.5814902782440186
Epoch: 5, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.241 Vali Acc: 0.935 Test Loss: 0.241 Test Acc: 0.935
Validation loss decreased (-0.920287 --> -0.934780).  Saving model ...
Epoch: 6 cost time: 0.6199817657470703
Epoch: 6, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.211 Vali Acc: 0.942 Test Loss: 0.211 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 7 cost time: 0.5673673152923584
Epoch: 7, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.204 Vali Acc: 0.935 Test Loss: 0.204 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5763285160064697
Epoch: 8, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.190 Vali Acc: 0.935 Test Loss: 0.190 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5938997268676758
Epoch: 9, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.182 Vali Acc: 0.935 Test Loss: 0.182 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5926358699798584
Epoch: 10, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.189 Vali Acc: 0.942 Test Loss: 0.189 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 11 cost time: 0.6495625972747803
Epoch: 11, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.197 Vali Acc: 0.942 Test Loss: 0.197 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6010751724243164
Epoch: 12, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.935 Test Loss: 0.201 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6497194766998291
Epoch: 13, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.942 Test Loss: 0.188 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 14 cost time: 0.5835084915161133
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.184 Vali Acc: 0.942 Test Loss: 0.184 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 15 cost time: 0.5946905612945557
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949273).  Saving model ...
Epoch: 16 cost time: 0.5628256797790527
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.942 Test Loss: 0.187 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6154382228851318
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.942 Test Loss: 0.186 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6039795875549316
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.942 Test Loss: 0.193 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.599797248840332
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.648444652557373
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.928 Test Loss: 0.194 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6052227020263672
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5403282642364502
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.242 Vali Acc: 0.913 Test Loss: 0.242 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5775794982910156
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6249988079071045
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.942 Test Loss: 0.180 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6495819091796875
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.949 Test Loss: 0.201 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 499972
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9160237312316895
Epoch: 1, Steps: 9 | Train Loss: 1.386 Vali Loss: 1.243 Vali Acc: 0.420 Test Loss: 1.243 Test Acc: 0.420
Validation loss decreased (inf --> -0.420277).  Saving model ...
Epoch: 2 cost time: 0.5165286064147949
Epoch: 2, Steps: 9 | Train Loss: 0.977 Vali Loss: 0.898 Vali Acc: 0.746 Test Loss: 0.898 Test Acc: 0.746
Validation loss decreased (-0.420277 --> -0.746368).  Saving model ...
Epoch: 3 cost time: 0.5296547412872314
Epoch: 3, Steps: 9 | Train Loss: 0.552 Vali Loss: 0.576 Vali Acc: 0.877 Test Loss: 0.576 Test Acc: 0.877
Validation loss decreased (-0.746368 --> -0.876806).  Saving model ...
Epoch: 4 cost time: 0.5066614151000977
Epoch: 4, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.374 Vali Acc: 0.906 Test Loss: 0.374 Test Acc: 0.906
Validation loss decreased (-0.876806 --> -0.905793).  Saving model ...
Epoch: 5 cost time: 0.5120341777801514
Epoch: 5, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.268 Vali Acc: 0.942 Test Loss: 0.268 Test Acc: 0.942
Validation loss decreased (-0.905793 --> -0.942026).  Saving model ...
Epoch: 6 cost time: 0.5479743480682373
Epoch: 6, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.256 Vali Acc: 0.935 Test Loss: 0.256 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5527384281158447
Epoch: 7, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.214 Vali Acc: 0.942 Test Loss: 0.214 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 8 cost time: 0.5826687812805176
Epoch: 8, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.208 Vali Acc: 0.942 Test Loss: 0.208 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 9 cost time: 0.5851311683654785
Epoch: 9, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.204 Vali Acc: 0.942 Test Loss: 0.204 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 10 cost time: 0.5444495677947998
Epoch: 10, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.180 Vali Acc: 0.935 Test Loss: 0.180 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5166618824005127
Epoch: 11, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.177 Vali Acc: 0.942 Test Loss: 0.177 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 12 cost time: 0.5573759078979492
Epoch: 12, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.180 Vali Acc: 0.942 Test Loss: 0.180 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4859335422515869
Epoch: 13, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.181 Vali Acc: 0.942 Test Loss: 0.181 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5504491329193115
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.190 Vali Acc: 0.942 Test Loss: 0.190 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.532940149307251
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.198 Vali Acc: 0.942 Test Loss: 0.198 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.51371169090271
Epoch: 16, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.194 Vali Acc: 0.942 Test Loss: 0.194 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5760209560394287
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.207 Vali Acc: 0.942 Test Loss: 0.207 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5546700954437256
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.942 Test Loss: 0.199 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5513179302215576
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.190 Vali Acc: 0.942 Test Loss: 0.190 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5153858661651611
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.942 Test Loss: 0.183 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5244884490966797
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.190 Vali Acc: 0.942 Test Loss: 0.190 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 479748
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.777184247970581
Epoch: 1, Steps: 9 | Train Loss: 1.456 Vali Loss: 1.342 Vali Acc: 0.210 Test Loss: 1.342 Test Acc: 0.210
Validation loss decreased (inf --> -0.210132).  Saving model ...
Epoch: 2 cost time: 0.5070929527282715
Epoch: 2, Steps: 9 | Train Loss: 1.149 Vali Loss: 1.053 Vali Acc: 0.594 Test Loss: 1.053 Test Acc: 0.594
Validation loss decreased (-0.210132 --> -0.594192).  Saving model ...
Epoch: 3 cost time: 0.45606470108032227
Epoch: 3, Steps: 9 | Train Loss: 0.785 Vali Loss: 0.774 Vali Acc: 0.754 Test Loss: 0.774 Test Acc: 0.754
Validation loss decreased (-0.594192 --> -0.753615).  Saving model ...
Epoch: 4 cost time: 0.5646026134490967
Epoch: 4, Steps: 9 | Train Loss: 0.516 Vali Loss: 0.542 Vali Acc: 0.899 Test Loss: 0.542 Test Acc: 0.899
Validation loss decreased (-0.753615 --> -0.898545).  Saving model ...
Epoch: 5 cost time: 0.566739559173584
Epoch: 5, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.406 Vali Acc: 0.913 Test Loss: 0.406 Test Acc: 0.913
Validation loss decreased (-0.898545 --> -0.913039).  Saving model ...
Epoch: 6 cost time: 0.5519795417785645
Epoch: 6, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.323 Vali Acc: 0.913 Test Loss: 0.323 Test Acc: 0.913
Validation loss decreased (-0.913039 --> -0.913040).  Saving model ...
Epoch: 7 cost time: 0.5830960273742676
Epoch: 7, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.273 Vali Acc: 0.928 Test Loss: 0.273 Test Acc: 0.928
Validation loss decreased (-0.913040 --> -0.927534).  Saving model ...
Epoch: 8 cost time: 0.6484482288360596
Epoch: 8, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.267 Vali Acc: 0.928 Test Loss: 0.267 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 9 cost time: 0.599578857421875
Epoch: 9, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.253 Vali Acc: 0.935 Test Loss: 0.253 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 10 cost time: 0.5525028705596924
Epoch: 10, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.246 Vali Acc: 0.935 Test Loss: 0.246 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 11 cost time: 0.5968317985534668
Epoch: 11, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.217 Vali Acc: 0.935 Test Loss: 0.217 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 12 cost time: 0.5363502502441406
Epoch: 12, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.204 Vali Acc: 0.935 Test Loss: 0.204 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934781).  Saving model ...
Epoch: 13 cost time: 0.570960283279419
Epoch: 13, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5707705020904541
Epoch: 14, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.558269739151001
Epoch: 15, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5882618427276611
Epoch: 16, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 17 cost time: 0.5952115058898926
Epoch: 17, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5520033836364746
Epoch: 18, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5135016441345215
Epoch: 19, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5357778072357178
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5314724445343018
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5469386577606201
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5522584915161133
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5669882297515869
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.928 Test Loss: 0.194 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6394655704498291
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5719525814056396
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.207 Vali Acc: 0.928 Test Loss: 0.207 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 463876
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.913182258605957
Epoch: 1, Steps: 9 | Train Loss: 1.443 Vali Loss: 1.399 Vali Acc: 0.254 Test Loss: 1.399 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 0.6557283401489258
Epoch: 2, Steps: 9 | Train Loss: 1.214 Vali Loss: 1.160 Vali Acc: 0.536 Test Loss: 1.160 Test Acc: 0.536
Validation loss decreased (-0.253609 --> -0.536220).  Saving model ...
Epoch: 3 cost time: 0.5596981048583984
Epoch: 3, Steps: 9 | Train Loss: 0.904 Vali Loss: 0.896 Vali Acc: 0.768 Test Loss: 0.896 Test Acc: 0.768
Validation loss decreased (-0.536220 --> -0.768107).  Saving model ...
Epoch: 4 cost time: 0.549360990524292
Epoch: 4, Steps: 9 | Train Loss: 0.616 Vali Loss: 0.668 Vali Acc: 0.848 Test Loss: 0.668 Test Acc: 0.848
Validation loss decreased (-0.768107 --> -0.847819).  Saving model ...
Epoch: 5 cost time: 0.5776326656341553
Epoch: 5, Steps: 9 | Train Loss: 0.415 Vali Loss: 0.502 Vali Acc: 0.913 Test Loss: 0.502 Test Acc: 0.913
Validation loss decreased (-0.847819 --> -0.913038).  Saving model ...
Epoch: 6 cost time: 0.6007044315338135
Epoch: 6, Steps: 9 | Train Loss: 0.270 Vali Loss: 0.385 Vali Acc: 0.899 Test Loss: 0.385 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6219742298126221
Epoch: 7, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.326 Vali Acc: 0.942 Test Loss: 0.326 Test Acc: 0.942
Validation loss decreased (-0.913038 --> -0.942026).  Saving model ...
Epoch: 8 cost time: 0.5458292961120605
Epoch: 8, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.281 Vali Acc: 0.942 Test Loss: 0.281 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 9 cost time: 0.5566830635070801
Epoch: 9, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.260 Vali Acc: 0.935 Test Loss: 0.260 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5926852226257324
Epoch: 10, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.243 Vali Acc: 0.928 Test Loss: 0.243 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5943150520324707
Epoch: 11, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.237 Vali Acc: 0.935 Test Loss: 0.237 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5225510597229004
Epoch: 12, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5178408622741699
Epoch: 13, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.215 Vali Acc: 0.942 Test Loss: 0.215 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 14 cost time: 0.5353600978851318
Epoch: 14, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.213 Vali Acc: 0.935 Test Loss: 0.213 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5930342674255371
Epoch: 15, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5456476211547852
Epoch: 16, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.203 Vali Acc: 0.928 Test Loss: 0.203 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5802826881408691
Epoch: 17, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.199 Vali Acc: 0.928 Test Loss: 0.199 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.56575608253479
Epoch: 18, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5987439155578613
Epoch: 19, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.190 Vali Acc: 0.935 Test Loss: 0.190 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5973336696624756
Epoch: 20, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.187 Vali Acc: 0.935 Test Loss: 0.187 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5694270133972168
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.192 Vali Acc: 0.935 Test Loss: 0.192 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5840826034545898
Epoch: 22, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.194 Vali Acc: 0.935 Test Loss: 0.194 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5674278736114502
Epoch: 23, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.192 Vali Acc: 0.928 Test Loss: 0.192 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 457476
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.7619585990905762
Epoch: 1, Steps: 9 | Train Loss: 1.487 Vali Loss: 1.375 Vali Acc: 0.246 Test Loss: 1.375 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 0.5704717636108398
Epoch: 2, Steps: 9 | Train Loss: 1.270 Vali Loss: 1.183 Vali Acc: 0.551 Test Loss: 1.183 Test Acc: 0.551
Validation loss decreased (-0.246363 --> -0.550713).  Saving model ...
Epoch: 3 cost time: 0.5805630683898926
Epoch: 3, Steps: 9 | Train Loss: 1.003 Vali Loss: 0.957 Vali Acc: 0.703 Test Loss: 0.957 Test Acc: 0.703
Validation loss decreased (-0.550713 --> -0.702889).  Saving model ...
Epoch: 4 cost time: 0.5641171932220459
Epoch: 4, Steps: 9 | Train Loss: 0.745 Vali Loss: 0.773 Vali Acc: 0.812 Test Loss: 0.773 Test Acc: 0.812
Validation loss decreased (-0.702889 --> -0.811586).  Saving model ...
Epoch: 5 cost time: 0.5261237621307373
Epoch: 5, Steps: 9 | Train Loss: 0.520 Vali Loss: 0.613 Vali Acc: 0.841 Test Loss: 0.613 Test Acc: 0.841
Validation loss decreased (-0.811586 --> -0.840574).  Saving model ...
Epoch: 6 cost time: 0.548346996307373
Epoch: 6, Steps: 9 | Train Loss: 0.372 Vali Loss: 0.505 Vali Acc: 0.877 Test Loss: 0.505 Test Acc: 0.877
Validation loss decreased (-0.840574 --> -0.876807).  Saving model ...
Epoch: 7 cost time: 0.5668148994445801
Epoch: 7, Steps: 9 | Train Loss: 0.254 Vali Loss: 0.417 Vali Acc: 0.891 Test Loss: 0.417 Test Acc: 0.891
Validation loss decreased (-0.876807 --> -0.891300).  Saving model ...
Epoch: 8 cost time: 0.5762512683868408
Epoch: 8, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.363 Vali Acc: 0.899 Test Loss: 0.363 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 9 cost time: 0.5912117958068848
Epoch: 9, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.341 Vali Acc: 0.899 Test Loss: 0.341 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 10 cost time: 0.583735466003418
Epoch: 10, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.307 Vali Acc: 0.913 Test Loss: 0.307 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913040).  Saving model ...
Epoch: 11 cost time: 0.5701870918273926
Epoch: 11, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.288 Vali Acc: 0.913 Test Loss: 0.288 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913041).  Saving model ...
Epoch: 12 cost time: 0.623032808303833
Epoch: 12, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.283 Vali Acc: 0.920 Test Loss: 0.283 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 13 cost time: 0.5662806034088135
Epoch: 13, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.280 Vali Acc: 0.913 Test Loss: 0.280 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5730657577514648
Epoch: 14, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.270 Vali Acc: 0.913 Test Loss: 0.270 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5986862182617188
Epoch: 15, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.247 Vali Acc: 0.913 Test Loss: 0.247 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5962698459625244
Epoch: 16, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.234 Vali Acc: 0.920 Test Loss: 0.234 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920288).  Saving model ...
Epoch: 17 cost time: 0.5984621047973633
Epoch: 17, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.233 Vali Acc: 0.920 Test Loss: 0.233 Test Acc: 0.920
Validation loss decreased (-0.920288 --> -0.920288).  Saving model ...
Epoch: 18 cost time: 0.5632522106170654
Epoch: 18, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.239 Vali Acc: 0.920 Test Loss: 0.239 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5558249950408936
Epoch: 19, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5588858127593994
Epoch: 20, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5621447563171387
Epoch: 21, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.225 Vali Acc: 0.913 Test Loss: 0.225 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6553804874420166
Epoch: 22, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.217 Vali Acc: 0.920 Test Loss: 0.217 Test Acc: 0.920
Validation loss decreased (-0.920288 --> -0.920288).  Saving model ...
Epoch: 23 cost time: 0.6072070598602295
Epoch: 23, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.221 Vali Acc: 0.920 Test Loss: 0.221 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5568022727966309
Epoch: 24, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.208 Vali Acc: 0.920 Test Loss: 0.208 Test Acc: 0.920
Validation loss decreased (-0.920288 --> -0.920288).  Saving model ...
Epoch: 25 cost time: 0.6086153984069824
Epoch: 25, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.211 Vali Acc: 0.920 Test Loss: 0.211 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5571427345275879
Epoch: 26, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.215 Vali Acc: 0.920 Test Loss: 0.215 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6269717216491699
Epoch: 27, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.217 Vali Acc: 0.920 Test Loss: 0.217 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5843486785888672
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.224 Vali Acc: 0.920 Test Loss: 0.224 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.573218822479248
Epoch: 29, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.920 Test Loss: 0.223 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5640814304351807
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.213 Vali Acc: 0.920 Test Loss: 0.213 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6116724014282227
Epoch: 31, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.920 Test Loss: 0.204 Test Acc: 0.920
Validation loss decreased (-0.920288 --> -0.920288).  Saving model ...
Epoch: 32 cost time: 0.626530647277832
Epoch: 32, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.207 Vali Acc: 0.920 Test Loss: 0.207 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5774335861206055
Epoch: 33, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.214 Vali Acc: 0.920 Test Loss: 0.214 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5594339370727539
Epoch: 34, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.222 Vali Acc: 0.920 Test Loss: 0.222 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5450985431671143
Epoch: 35, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.217 Vali Acc: 0.920 Test Loss: 0.217 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5465819835662842
Epoch: 36, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.920 Test Loss: 0.214 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5489077568054199
Epoch: 37, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.219 Vali Acc: 0.920 Test Loss: 0.219 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.5693120956420898
Epoch: 38, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.219 Vali Acc: 0.920 Test Loss: 0.219 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6096229553222656
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.913 Test Loss: 0.212 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.6923143863677979
Epoch: 40, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.913 Test Loss: 0.208 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6766757965087891
Epoch: 41, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.920 Test Loss: 0.216 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 453892
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.6775436401367188
Epoch: 1, Steps: 9 | Train Loss: 1.352 Vali Loss: 1.168 Vali Acc: 0.442 Test Loss: 1.168 Test Acc: 0.442
Validation loss decreased (inf --> -0.442017).  Saving model ...
Epoch: 2 cost time: 0.5418062210083008
Epoch: 2, Steps: 9 | Train Loss: 0.808 Vali Loss: 0.716 Vali Acc: 0.775 Test Loss: 0.716 Test Acc: 0.775
Validation loss decreased (-0.442017 --> -0.775355).  Saving model ...
Epoch: 3 cost time: 0.557265043258667
Epoch: 3, Steps: 9 | Train Loss: 0.353 Vali Loss: 0.430 Vali Acc: 0.870 Test Loss: 0.430 Test Acc: 0.870
Validation loss decreased (-0.775355 --> -0.869561).  Saving model ...
Epoch: 4 cost time: 0.5424079895019531
Epoch: 4, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.303 Vali Acc: 0.884 Test Loss: 0.303 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884055).  Saving model ...
Epoch: 5 cost time: 0.5961627960205078
Epoch: 5, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
Validation loss decreased (-0.884055 --> -0.934781).  Saving model ...
Epoch: 6 cost time: 0.5693488121032715
Epoch: 6, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.219 Vali Acc: 0.928 Test Loss: 0.219 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5828704833984375
Epoch: 7, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.187 Vali Acc: 0.935 Test Loss: 0.187 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 8 cost time: 0.5308866500854492
Epoch: 8, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.189 Vali Acc: 0.935 Test Loss: 0.189 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5633442401885986
Epoch: 9, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.207 Vali Acc: 0.928 Test Loss: 0.207 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.527310848236084
Epoch: 10, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5415701866149902
Epoch: 11, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5457572937011719
Epoch: 12, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5628161430358887
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.935 Test Loss: 0.191 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5592398643493652
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5895895957946777
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5308456420898438
Epoch: 16, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5826070308685303
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.935 Test Loss: 0.218 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 216452
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.7587618827819824
Epoch: 1, Steps: 9 | Train Loss: 1.315 Vali Loss: 1.242 Vali Acc: 0.435 Test Loss: 1.242 Test Acc: 0.435
Validation loss decreased (inf --> -0.434770).  Saving model ...
Epoch: 2 cost time: 0.5434753894805908
Epoch: 2, Steps: 9 | Train Loss: 0.977 Vali Loss: 0.915 Vali Acc: 0.638 Test Loss: 0.915 Test Acc: 0.638
Validation loss decreased (-0.434770 --> -0.637672).  Saving model ...
Epoch: 3 cost time: 0.4783344268798828
Epoch: 3, Steps: 9 | Train Loss: 0.581 Vali Loss: 0.610 Vali Acc: 0.877 Test Loss: 0.610 Test Acc: 0.877
Validation loss decreased (-0.637672 --> -0.876805).  Saving model ...
Epoch: 4 cost time: 0.5146164894104004
Epoch: 4, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.406 Vali Acc: 0.920 Test Loss: 0.406 Test Acc: 0.920
Validation loss decreased (-0.876805 --> -0.920286).  Saving model ...
Epoch: 5 cost time: 0.48217153549194336
Epoch: 5, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.295 Vali Acc: 0.920 Test Loss: 0.295 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920287).  Saving model ...
Epoch: 6 cost time: 0.4970889091491699
Epoch: 6, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.224 Vali Acc: 0.949 Test Loss: 0.224 Test Acc: 0.949
Validation loss decreased (-0.920287 --> -0.949273).  Saving model ...
Epoch: 7 cost time: 0.5199484825134277
Epoch: 7, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.207 Vali Acc: 0.942 Test Loss: 0.207 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5474832057952881
Epoch: 8, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.202 Vali Acc: 0.942 Test Loss: 0.202 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5319051742553711
Epoch: 9, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.196 Vali Acc: 0.942 Test Loss: 0.196 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4850287437438965
Epoch: 10, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949274).  Saving model ...
Epoch: 11 cost time: 0.48728299140930176
Epoch: 11, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.179 Vali Acc: 0.942 Test Loss: 0.179 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4798452854156494
Epoch: 12, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.194 Vali Acc: 0.942 Test Loss: 0.194 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5763916969299316
Epoch: 13, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.186 Vali Acc: 0.935 Test Loss: 0.186 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.484757661819458
Epoch: 14, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.174 Vali Acc: 0.942 Test Loss: 0.174 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5624456405639648
Epoch: 15, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.168 Vali Acc: 0.942 Test Loss: 0.168 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4956984519958496
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 17 cost time: 0.572559118270874
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5042061805725098
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5562334060668945
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.942 Test Loss: 0.165 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5566599369049072
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.942 Test Loss: 0.164 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.4765453338623047
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 22 cost time: 0.4564082622528076
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 23 cost time: 0.4830789566040039
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4196956157684326
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.45331883430480957
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.182 Vali Acc: 0.942 Test Loss: 0.182 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4700031280517578
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.942 Test Loss: 0.180 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.44719624519348145
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.942 Test Loss: 0.174 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5760631561279297
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.942 Test Loss: 0.175 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5112800598144531
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.942 Test Loss: 0.183 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.49715399742126465
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.949 Test Loss: 0.184 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5480422973632812
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.949 Test Loss: 0.180 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5474426746368408
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 164868
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.7144453525543213
Epoch: 1, Steps: 9 | Train Loss: 1.415 Vali Loss: 1.297 Vali Acc: 0.428 Test Loss: 1.297 Test Acc: 0.428
Validation loss decreased (inf --> -0.427523).  Saving model ...
Epoch: 2 cost time: 0.5438621044158936
Epoch: 2, Steps: 9 | Train Loss: 1.107 Vali Loss: 1.023 Vali Acc: 0.623 Test Loss: 1.023 Test Acc: 0.623
Validation loss decreased (-0.427523 --> -0.623178).  Saving model ...
Epoch: 3 cost time: 0.5084888935089111
Epoch: 3, Steps: 9 | Train Loss: 0.761 Vali Loss: 0.752 Vali Acc: 0.819 Test Loss: 0.752 Test Acc: 0.819
Validation loss decreased (-0.623178 --> -0.818833).  Saving model ...
Epoch: 4 cost time: 0.6037487983703613
Epoch: 4, Steps: 9 | Train Loss: 0.464 Vali Loss: 0.526 Vali Acc: 0.891 Test Loss: 0.526 Test Acc: 0.891
Validation loss decreased (-0.818833 --> -0.891299).  Saving model ...
Epoch: 5 cost time: 0.5451686382293701
Epoch: 5, Steps: 9 | Train Loss: 0.295 Vali Loss: 0.384 Vali Acc: 0.928 Test Loss: 0.384 Test Acc: 0.928
Validation loss decreased (-0.891299 --> -0.927532).  Saving model ...
Epoch: 6 cost time: 0.501943826675415
Epoch: 6, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.311 Vali Acc: 0.928 Test Loss: 0.311 Test Acc: 0.928
Validation loss decreased (-0.927532 --> -0.927533).  Saving model ...
Epoch: 7 cost time: 0.5451171398162842
Epoch: 7, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.282 Vali Acc: 0.928 Test Loss: 0.282 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 8 cost time: 0.49678921699523926
Epoch: 8, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.256 Vali Acc: 0.935 Test Loss: 0.256 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934780).  Saving model ...
Epoch: 9 cost time: 0.46236610412597656
Epoch: 9, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.236 Vali Acc: 0.942 Test Loss: 0.236 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 10 cost time: 0.5530941486358643
Epoch: 10, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.220 Vali Acc: 0.935 Test Loss: 0.220 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.48602962493896484
Epoch: 11, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.213 Vali Acc: 0.935 Test Loss: 0.213 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5502800941467285
Epoch: 12, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.4932851791381836
Epoch: 13, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.216 Vali Acc: 0.935 Test Loss: 0.216 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5652709007263184
Epoch: 14, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.213 Vali Acc: 0.935 Test Loss: 0.213 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5077242851257324
Epoch: 15, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5100119113922119
Epoch: 16, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5063221454620361
Epoch: 17, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.525275707244873
Epoch: 18, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.4907803535461426
Epoch: 19, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.200 Vali Acc: 0.935 Test Loss: 0.200 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 151684
model size : 0.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.7599151134490967
Epoch: 1, Steps: 9 | Train Loss: 1.397 Vali Loss: 1.329 Vali Acc: 0.355 Test Loss: 1.329 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 0.5057094097137451
Epoch: 2, Steps: 9 | Train Loss: 1.177 Vali Loss: 1.114 Vali Acc: 0.638 Test Loss: 1.114 Test Acc: 0.638
Validation loss decreased (-0.355059 --> -0.637670).  Saving model ...
Epoch: 3 cost time: 0.5357649326324463
Epoch: 3, Steps: 9 | Train Loss: 0.892 Vali Loss: 0.865 Vali Acc: 0.819 Test Loss: 0.865 Test Acc: 0.819
Validation loss decreased (-0.637670 --> -0.818832).  Saving model ...
Epoch: 4 cost time: 0.4737701416015625
Epoch: 4, Steps: 9 | Train Loss: 0.624 Vali Loss: 0.640 Vali Acc: 0.877 Test Loss: 0.640 Test Acc: 0.877
Validation loss decreased (-0.818832 --> -0.876805).  Saving model ...
Epoch: 5 cost time: 0.4931313991546631
Epoch: 5, Steps: 9 | Train Loss: 0.437 Vali Loss: 0.493 Vali Acc: 0.891 Test Loss: 0.493 Test Acc: 0.891
Validation loss decreased (-0.876805 --> -0.891299).  Saving model ...
Epoch: 6 cost time: 0.46975255012512207
Epoch: 6, Steps: 9 | Train Loss: 0.284 Vali Loss: 0.381 Vali Acc: 0.906 Test Loss: 0.381 Test Acc: 0.906
Validation loss decreased (-0.891299 --> -0.905793).  Saving model ...
Epoch: 7 cost time: 0.4692988395690918
Epoch: 7, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.311 Vali Acc: 0.920 Test Loss: 0.311 Test Acc: 0.920
Validation loss decreased (-0.905793 --> -0.920287).  Saving model ...
Epoch: 8 cost time: 0.5066542625427246
Epoch: 8, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.270 Vali Acc: 0.928 Test Loss: 0.270 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 9 cost time: 0.520104169845581
Epoch: 9, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.245 Vali Acc: 0.942 Test Loss: 0.245 Test Acc: 0.942
Validation loss decreased (-0.927534 --> -0.942027).  Saving model ...
Epoch: 10 cost time: 0.5581257343292236
Epoch: 10, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.226 Vali Acc: 0.928 Test Loss: 0.226 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5541777610778809
Epoch: 11, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.205 Vali Acc: 0.942 Test Loss: 0.205 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 12 cost time: 0.6685175895690918
Epoch: 12, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.200 Vali Acc: 0.942 Test Loss: 0.200 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 13 cost time: 0.5204706192016602
Epoch: 13, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.198 Vali Acc: 0.942 Test Loss: 0.198 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 14 cost time: 0.5691103935241699
Epoch: 14, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.198 Vali Acc: 0.942 Test Loss: 0.198 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5313601493835449
Epoch: 15, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.190 Vali Acc: 0.935 Test Loss: 0.190 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5488367080688477
Epoch: 16, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.184 Vali Acc: 0.942 Test Loss: 0.184 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 17 cost time: 0.5633974075317383
Epoch: 17, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.180 Vali Acc: 0.949 Test Loss: 0.180 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949274).  Saving model ...
Epoch: 18 cost time: 0.5206375122070312
Epoch: 18, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 19 cost time: 0.5291092395782471
Epoch: 19, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.184 Vali Acc: 0.949 Test Loss: 0.184 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.531386137008667
Epoch: 20, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.180 Vali Acc: 0.949 Test Loss: 0.180 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4907691478729248
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.178 Vali Acc: 0.942 Test Loss: 0.178 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5569887161254883
Epoch: 22, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.177 Vali Acc: 0.942 Test Loss: 0.177 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5271914005279541
Epoch: 23, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 24 cost time: 0.5071775913238525
Epoch: 24, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5217602252960205
Epoch: 25, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 26 cost time: 0.5837306976318359
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 27 cost time: 0.5289433002471924
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.557370662689209
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5608012676239014
Epoch: 29, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5133962631225586
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5120832920074463
Epoch: 31, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.541532039642334
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5763390064239502
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.5696618556976318
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6164171695709229
Epoch: 35, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.942 Test Loss: 0.162 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.5952305793762207
Epoch: 36, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 141572
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.6480305194854736
Epoch: 1, Steps: 9 | Train Loss: 1.465 Vali Loss: 1.344 Vali Acc: 0.319 Test Loss: 1.344 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 0.5092058181762695
Epoch: 2, Steps: 9 | Train Loss: 1.282 Vali Loss: 1.188 Vali Acc: 0.543 Test Loss: 1.188 Test Acc: 0.543
Validation loss decreased (-0.318827 --> -0.543466).  Saving model ...
Epoch: 3 cost time: 0.5600159168243408
Epoch: 3, Steps: 9 | Train Loss: 1.072 Vali Loss: 0.995 Vali Acc: 0.623 Test Loss: 0.995 Test Acc: 0.623
Validation loss decreased (-0.543466 --> -0.623178).  Saving model ...
Epoch: 4 cost time: 0.5486044883728027
Epoch: 4, Steps: 9 | Train Loss: 0.825 Vali Loss: 0.821 Vali Acc: 0.732 Test Loss: 0.821 Test Acc: 0.732
Validation loss decreased (-0.623178 --> -0.731876).  Saving model ...
Epoch: 5 cost time: 0.4922809600830078
Epoch: 5, Steps: 9 | Train Loss: 0.614 Vali Loss: 0.667 Vali Acc: 0.841 Test Loss: 0.667 Test Acc: 0.841
Validation loss decreased (-0.731876 --> -0.840573).  Saving model ...
Epoch: 6 cost time: 0.5044577121734619
Epoch: 6, Steps: 9 | Train Loss: 0.478 Vali Loss: 0.541 Vali Acc: 0.877 Test Loss: 0.541 Test Acc: 0.877
Validation loss decreased (-0.840573 --> -0.876806).  Saving model ...
Epoch: 7 cost time: 0.5083019733428955
Epoch: 7, Steps: 9 | Train Loss: 0.339 Vali Loss: 0.450 Vali Acc: 0.870 Test Loss: 0.450 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5496530532836914
Epoch: 8, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.390 Vali Acc: 0.899 Test Loss: 0.390 Test Acc: 0.899
Validation loss decreased (-0.876806 --> -0.898547).  Saving model ...
Epoch: 9 cost time: 0.5139398574829102
Epoch: 9, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.340 Vali Acc: 0.899 Test Loss: 0.340 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 10 cost time: 0.4802119731903076
Epoch: 10, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.313 Vali Acc: 0.920 Test Loss: 0.313 Test Acc: 0.920
Validation loss decreased (-0.898547 --> -0.920287).  Saving model ...
Epoch: 11 cost time: 0.5233926773071289
Epoch: 11, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.301 Vali Acc: 0.920 Test Loss: 0.301 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 12 cost time: 0.6238498687744141
Epoch: 12, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.282 Vali Acc: 0.935 Test Loss: 0.282 Test Acc: 0.935
Validation loss decreased (-0.920287 --> -0.934780).  Saving model ...
Epoch: 13 cost time: 0.568920373916626
Epoch: 13, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.275 Vali Acc: 0.942 Test Loss: 0.275 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942026).  Saving model ...
Epoch: 14 cost time: 0.5083160400390625
Epoch: 14, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.259 Vali Acc: 0.949 Test Loss: 0.259 Test Acc: 0.949
Validation loss decreased (-0.942026 --> -0.949273).  Saving model ...
Epoch: 15 cost time: 0.5152950286865234
Epoch: 15, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.247 Vali Acc: 0.949 Test Loss: 0.247 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 16 cost time: 0.5249514579772949
Epoch: 16, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.242 Vali Acc: 0.949 Test Loss: 0.242 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 17 cost time: 0.5012283325195312
Epoch: 17, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.238 Vali Acc: 0.949 Test Loss: 0.238 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 18 cost time: 0.4802401065826416
Epoch: 18, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.233 Vali Acc: 0.935 Test Loss: 0.233 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5282268524169922
Epoch: 19, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.228 Vali Acc: 0.942 Test Loss: 0.228 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5232784748077393
Epoch: 20, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.216 Vali Acc: 0.949 Test Loss: 0.216 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 21 cost time: 0.5800120830535889
Epoch: 21, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.211 Vali Acc: 0.949 Test Loss: 0.211 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 22 cost time: 0.5516331195831299
Epoch: 22, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.209 Vali Acc: 0.949 Test Loss: 0.209 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 23 cost time: 0.5328488349914551
Epoch: 23, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.211 Vali Acc: 0.949 Test Loss: 0.211 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5457985401153564
Epoch: 24, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.210 Vali Acc: 0.949 Test Loss: 0.210 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.47519731521606445
Epoch: 25, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.207 Vali Acc: 0.949 Test Loss: 0.207 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 26 cost time: 0.48018765449523926
Epoch: 26, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.209 Vali Acc: 0.949 Test Loss: 0.209 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5443863868713379
Epoch: 27, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.196 Vali Acc: 0.957 Test Loss: 0.196 Test Acc: 0.957
Validation loss decreased (-0.949273 --> -0.956520).  Saving model ...
Epoch: 28 cost time: 0.4962599277496338
Epoch: 28, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.196 Vali Acc: 0.957 Test Loss: 0.196 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4969503879547119
Epoch: 29, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.198 Vali Acc: 0.949 Test Loss: 0.198 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5024585723876953
Epoch: 30, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.197 Vali Acc: 0.942 Test Loss: 0.197 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6009869575500488
Epoch: 31, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.202 Vali Acc: 0.949 Test Loss: 0.202 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.560161828994751
Epoch: 32, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.204 Vali Acc: 0.942 Test Loss: 0.204 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5652511119842529
Epoch: 33, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.949 Test Loss: 0.200 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5843014717102051
Epoch: 34, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.949 Test Loss: 0.198 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6299774646759033
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.196 Vali Acc: 0.949 Test Loss: 0.196 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.6162006855010986
Epoch: 36, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.5833015441894531
Epoch: 37, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.190 Vali Acc: 0.949 Test Loss: 0.190 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9565217391304348
model parameter : 133636
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.5663783550262451
Epoch: 1, Steps: 9 | Train Loss: 1.426 Vali Loss: 1.332 Vali Acc: 0.341 Test Loss: 1.332 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 0.5296354293823242
Epoch: 2, Steps: 9 | Train Loss: 1.267 Vali Loss: 1.200 Vali Acc: 0.536 Test Loss: 1.200 Test Acc: 0.536
Validation loss decreased (-0.340566 --> -0.536220).  Saving model ...
Epoch: 3 cost time: 0.5283703804016113
Epoch: 3, Steps: 9 | Train Loss: 1.093 Vali Loss: 1.039 Vali Acc: 0.645 Test Loss: 1.039 Test Acc: 0.645
Validation loss decreased (-0.536220 --> -0.644917).  Saving model ...
Epoch: 4 cost time: 0.5114932060241699
Epoch: 4, Steps: 9 | Train Loss: 0.883 Vali Loss: 0.890 Vali Acc: 0.725 Test Loss: 0.890 Test Acc: 0.725
Validation loss decreased (-0.644917 --> -0.724629).  Saving model ...
Epoch: 5 cost time: 0.5059435367584229
Epoch: 5, Steps: 9 | Train Loss: 0.701 Vali Loss: 0.754 Vali Acc: 0.790 Test Loss: 0.754 Test Acc: 0.790
Validation loss decreased (-0.724629 --> -0.789848).  Saving model ...
Epoch: 6 cost time: 0.5378003120422363
Epoch: 6, Steps: 9 | Train Loss: 0.581 Vali Loss: 0.630 Vali Acc: 0.855 Test Loss: 0.630 Test Acc: 0.855
Validation loss decreased (-0.789848 --> -0.855066).  Saving model ...
Epoch: 7 cost time: 0.4846949577331543
Epoch: 7, Steps: 9 | Train Loss: 0.438 Vali Loss: 0.539 Vali Acc: 0.884 Test Loss: 0.539 Test Acc: 0.884
Validation loss decreased (-0.855066 --> -0.884053).  Saving model ...
Epoch: 8 cost time: 0.5403518676757812
Epoch: 8, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.487 Vali Acc: 0.877 Test Loss: 0.487 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5253810882568359
Epoch: 9, Steps: 9 | Train Loss: 0.254 Vali Loss: 0.424 Vali Acc: 0.891 Test Loss: 0.424 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891300).  Saving model ...
Epoch: 10 cost time: 0.540565013885498
Epoch: 10, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.382 Vali Acc: 0.899 Test Loss: 0.382 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 11 cost time: 0.5157535076141357
Epoch: 11, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.353 Vali Acc: 0.913 Test Loss: 0.353 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913040).  Saving model ...
Epoch: 12 cost time: 0.5310397148132324
Epoch: 12, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.326 Vali Acc: 0.920 Test Loss: 0.326 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 13 cost time: 0.5337977409362793
Epoch: 13, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.312 Vali Acc: 0.913 Test Loss: 0.312 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5659646987915039
Epoch: 14, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.299 Vali Acc: 0.913 Test Loss: 0.299 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4961986541748047
Epoch: 15, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.284 Vali Acc: 0.928 Test Loss: 0.284 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927533).  Saving model ...
Epoch: 16 cost time: 0.5136280059814453
Epoch: 16, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.278 Vali Acc: 0.920 Test Loss: 0.278 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5395410060882568
Epoch: 17, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.261 Vali Acc: 0.913 Test Loss: 0.261 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5319969654083252
Epoch: 18, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.251 Vali Acc: 0.920 Test Loss: 0.251 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5853402614593506
Epoch: 19, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.260 Vali Acc: 0.920 Test Loss: 0.260 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.525421142578125
Epoch: 20, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.252 Vali Acc: 0.928 Test Loss: 0.252 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927534).  Saving model ...
Epoch: 21 cost time: 0.5591616630554199
Epoch: 21, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.249 Vali Acc: 0.920 Test Loss: 0.249 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5204715728759766
Epoch: 22, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.239 Vali Acc: 0.920 Test Loss: 0.239 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5032825469970703
Epoch: 23, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.245 Vali Acc: 0.928 Test Loss: 0.245 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 24 cost time: 0.5230748653411865
Epoch: 24, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.240 Vali Acc: 0.920 Test Loss: 0.240 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5049898624420166
Epoch: 25, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.242 Vali Acc: 0.920 Test Loss: 0.242 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5515666007995605
Epoch: 26, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.232 Vali Acc: 0.920 Test Loss: 0.232 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5427746772766113
Epoch: 27, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.236 Vali Acc: 0.913 Test Loss: 0.236 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5105812549591064
Epoch: 28, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.229 Vali Acc: 0.920 Test Loss: 0.229 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5140590667724609
Epoch: 29, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.226 Vali Acc: 0.928 Test Loss: 0.226 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 30 cost time: 0.5393402576446533
Epoch: 30, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.230 Vali Acc: 0.920 Test Loss: 0.230 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5335760116577148
Epoch: 31, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.224 Vali Acc: 0.920 Test Loss: 0.224 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5389449596405029
Epoch: 32, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.217 Vali Acc: 0.928 Test Loss: 0.217 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 33 cost time: 0.5199985504150391
Epoch: 33, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.218 Vali Acc: 0.928 Test Loss: 0.218 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5822205543518066
Epoch: 34, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.213 Vali Acc: 0.928 Test Loss: 0.213 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 35 cost time: 0.4977245330810547
Epoch: 35, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 36 cost time: 0.4726095199584961
Epoch: 36, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.920 Test Loss: 0.210 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5269675254821777
Epoch: 37, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 38 cost time: 0.5152251720428467
Epoch: 38, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.207 Vali Acc: 0.928 Test Loss: 0.207 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 39 cost time: 0.5027446746826172
Epoch: 39, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.215 Vali Acc: 0.928 Test Loss: 0.215 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5101685523986816
Epoch: 40, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.218 Vali Acc: 0.920 Test Loss: 0.218 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5195035934448242
Epoch: 41, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.920 Test Loss: 0.217 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5253543853759766
Epoch: 42, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.928 Test Loss: 0.207 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 43 cost time: 0.5041577816009521
Epoch: 43, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.210 Vali Acc: 0.920 Test Loss: 0.210 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.49800682067871094
Epoch: 44, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.216 Vali Acc: 0.920 Test Loss: 0.216 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5255262851715088
Epoch: 45, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.216 Vali Acc: 0.920 Test Loss: 0.216 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5413429737091064
Epoch: 46, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.210 Vali Acc: 0.920 Test Loss: 0.210 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.514845609664917
Epoch: 47, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.213 Vali Acc: 0.920 Test Loss: 0.213 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.5234146118164062
Epoch: 48, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.205 Vali Acc: 0.920 Test Loss: 0.205 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.5425314903259277
Epoch: 49, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.215 Vali Acc: 0.913 Test Loss: 0.215 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.5805943012237549
Epoch: 50, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.215 Vali Acc: 0.906 Test Loss: 0.215 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 130436
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.7738940715789795
Epoch: 1, Steps: 9 | Train Loss: 1.518 Vali Loss: 1.410 Vali Acc: 0.217 Test Loss: 1.410 Test Acc: 0.217
Validation loss decreased (inf --> -0.217377).  Saving model ...
Epoch: 2 cost time: 0.46448612213134766
Epoch: 2, Steps: 9 | Train Loss: 1.404 Vali Loss: 1.313 Vali Acc: 0.312 Test Loss: 1.313 Test Acc: 0.312
Validation loss decreased (-0.217377 --> -0.311581).  Saving model ...
Epoch: 3 cost time: 0.5079751014709473
Epoch: 3, Steps: 9 | Train Loss: 1.231 Vali Loss: 1.177 Vali Acc: 0.449 Test Loss: 1.177 Test Acc: 0.449
Validation loss decreased (-0.311581 --> -0.449264).  Saving model ...
Epoch: 4 cost time: 0.5156385898590088
Epoch: 4, Steps: 9 | Train Loss: 1.048 Vali Loss: 1.027 Vali Acc: 0.630 Test Loss: 1.027 Test Acc: 0.630
Validation loss decreased (-0.449264 --> -0.630425).  Saving model ...
Epoch: 5 cost time: 0.4855318069458008
Epoch: 5, Steps: 9 | Train Loss: 0.889 Vali Loss: 0.897 Vali Acc: 0.746 Test Loss: 0.897 Test Acc: 0.746
Validation loss decreased (-0.630425 --> -0.746368).  Saving model ...
Epoch: 6 cost time: 0.5092799663543701
Epoch: 6, Steps: 9 | Train Loss: 0.734 Vali Loss: 0.780 Vali Acc: 0.819 Test Loss: 0.780 Test Acc: 0.819
Validation loss decreased (-0.746368 --> -0.818833).  Saving model ...
Epoch: 7 cost time: 0.501741886138916
Epoch: 7, Steps: 9 | Train Loss: 0.601 Vali Loss: 0.674 Vali Acc: 0.848 Test Loss: 0.674 Test Acc: 0.848
Validation loss decreased (-0.818833 --> -0.847819).  Saving model ...
Epoch: 8 cost time: 0.5225646495819092
Epoch: 8, Steps: 9 | Train Loss: 0.483 Vali Loss: 0.586 Vali Acc: 0.862 Test Loss: 0.586 Test Acc: 0.862
Validation loss decreased (-0.847819 --> -0.862313).  Saving model ...
Epoch: 9 cost time: 0.48185014724731445
Epoch: 9, Steps: 9 | Train Loss: 0.354 Vali Loss: 0.514 Vali Acc: 0.862 Test Loss: 0.514 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862314).  Saving model ...
Epoch: 10 cost time: 0.5044643878936768
Epoch: 10, Steps: 9 | Train Loss: 0.310 Vali Loss: 0.467 Vali Acc: 0.870 Test Loss: 0.467 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 11 cost time: 0.4714851379394531
Epoch: 11, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.424 Vali Acc: 0.884 Test Loss: 0.424 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 12 cost time: 0.5448658466339111
Epoch: 12, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.385 Vali Acc: 0.906 Test Loss: 0.385 Test Acc: 0.906
Validation loss decreased (-0.884054 --> -0.905793).  Saving model ...
Epoch: 13 cost time: 0.4931800365447998
Epoch: 13, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.362 Vali Acc: 0.906 Test Loss: 0.362 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 14 cost time: 0.5018479824066162
Epoch: 14, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.341 Vali Acc: 0.913 Test Loss: 0.341 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913040).  Saving model ...
Epoch: 15 cost time: 0.48766279220581055
Epoch: 15, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.335 Vali Acc: 0.913 Test Loss: 0.335 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 16 cost time: 0.5331935882568359
Epoch: 16, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.326 Vali Acc: 0.913 Test Loss: 0.326 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 17 cost time: 0.5570831298828125
Epoch: 17, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.307 Vali Acc: 0.928 Test Loss: 0.307 Test Acc: 0.928
Validation loss decreased (-0.913040 --> -0.927533).  Saving model ...
Epoch: 18 cost time: 0.5061018466949463
Epoch: 18, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.302 Vali Acc: 0.928 Test Loss: 0.302 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 19 cost time: 0.5951638221740723
Epoch: 19, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.291 Vali Acc: 0.928 Test Loss: 0.291 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 20 cost time: 0.5465242862701416
Epoch: 20, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.287 Vali Acc: 0.913 Test Loss: 0.287 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4859917163848877
Epoch: 21, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.276 Vali Acc: 0.928 Test Loss: 0.276 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 22 cost time: 0.526787519454956
Epoch: 22, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.271 Vali Acc: 0.935 Test Loss: 0.271 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934780).  Saving model ...
Epoch: 23 cost time: 0.47426629066467285
Epoch: 23, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.269 Vali Acc: 0.935 Test Loss: 0.269 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 24 cost time: 0.5050876140594482
Epoch: 24, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.266 Vali Acc: 0.928 Test Loss: 0.266 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5152719020843506
Epoch: 25, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.264 Vali Acc: 0.935 Test Loss: 0.264 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 26 cost time: 0.48074841499328613
Epoch: 26, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.252 Vali Acc: 0.942 Test Loss: 0.252 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942026).  Saving model ...
Epoch: 27 cost time: 0.5159702301025391
Epoch: 27, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.250 Vali Acc: 0.942 Test Loss: 0.250 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 28 cost time: 0.5331318378448486
Epoch: 28, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.250 Vali Acc: 0.920 Test Loss: 0.250 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.48330163955688477
Epoch: 29, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.247 Vali Acc: 0.942 Test Loss: 0.247 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 30 cost time: 0.5245788097381592
Epoch: 30, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.241 Vali Acc: 0.928 Test Loss: 0.241 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5411720275878906
Epoch: 31, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.235 Vali Acc: 0.928 Test Loss: 0.235 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4970571994781494
Epoch: 32, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.234 Vali Acc: 0.928 Test Loss: 0.234 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5254414081573486
Epoch: 33, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.239 Vali Acc: 0.928 Test Loss: 0.239 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5209598541259766
Epoch: 34, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.246 Vali Acc: 0.920 Test Loss: 0.246 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5298643112182617
Epoch: 35, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.242 Vali Acc: 0.928 Test Loss: 0.242 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.49678826332092285
Epoch: 36, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.237 Vali Acc: 0.928 Test Loss: 0.237 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.49845361709594727
Epoch: 37, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.234 Vali Acc: 0.935 Test Loss: 0.234 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5125365257263184
Epoch: 38, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.235 Vali Acc: 0.928 Test Loss: 0.235 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.5117506980895996
Epoch: 39, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.239 Vali Acc: 0.920 Test Loss: 0.239 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 128644
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.7727925777435303
Epoch: 1, Steps: 9 | Train Loss: 1.348 Vali Loss: 1.257 Vali Acc: 0.493 Test Loss: 1.257 Test Acc: 0.493
Validation loss decreased (inf --> -0.492741).  Saving model ...
Epoch: 2 cost time: 0.47846293449401855
Epoch: 2, Steps: 9 | Train Loss: 0.961 Vali Loss: 0.907 Vali Acc: 0.674 Test Loss: 0.907 Test Acc: 0.674
Validation loss decreased (-0.492741 --> -0.673904).  Saving model ...
Epoch: 3 cost time: 0.5197789669036865
Epoch: 3, Steps: 9 | Train Loss: 0.604 Vali Loss: 0.594 Vali Acc: 0.855 Test Loss: 0.594 Test Acc: 0.855
Validation loss decreased (-0.673904 --> -0.855067).  Saving model ...
Epoch: 4 cost time: 0.5531730651855469
Epoch: 4, Steps: 9 | Train Loss: 0.330 Vali Loss: 0.410 Vali Acc: 0.906 Test Loss: 0.410 Test Acc: 0.906
Validation loss decreased (-0.855067 --> -0.905793).  Saving model ...
Epoch: 5 cost time: 0.5133676528930664
Epoch: 5, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.299 Vali Acc: 0.913 Test Loss: 0.299 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913040).  Saving model ...
Epoch: 6 cost time: 0.45850443840026855
Epoch: 6, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.231 Vali Acc: 0.928 Test Loss: 0.231 Test Acc: 0.928
Validation loss decreased (-0.913040 --> -0.927534).  Saving model ...
Epoch: 7 cost time: 0.5377824306488037
Epoch: 7, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.213 Vali Acc: 0.935 Test Loss: 0.213 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 8 cost time: 0.49851465225219727
Epoch: 8, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934781).  Saving model ...
Epoch: 9 cost time: 0.508540153503418
Epoch: 9, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.194 Vali Acc: 0.928 Test Loss: 0.194 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5708067417144775
Epoch: 10, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.184 Vali Acc: 0.928 Test Loss: 0.184 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5911829471588135
Epoch: 11, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.180 Vali Acc: 0.928 Test Loss: 0.180 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5187180042266846
Epoch: 12, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.182 Vali Acc: 0.935 Test Loss: 0.182 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 13 cost time: 0.473477840423584
Epoch: 13, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.189 Vali Acc: 0.935 Test Loss: 0.189 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5722000598907471
Epoch: 14, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.187 Vali Acc: 0.928 Test Loss: 0.187 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.538424015045166
Epoch: 15, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.179 Vali Acc: 0.928 Test Loss: 0.179 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6280288696289062
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.182 Vali Acc: 0.928 Test Loss: 0.182 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6012511253356934
Epoch: 17, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.928 Test Loss: 0.178 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6315412521362305
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.176 Vali Acc: 0.928 Test Loss: 0.176 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5603322982788086
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.177 Vali Acc: 0.928 Test Loss: 0.177 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.517892599105835
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.928 Test Loss: 0.180 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5343122482299805
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.928 Test Loss: 0.180 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5354576110839844
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.935 Test Loss: 0.170 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 23 cost time: 0.5777003765106201
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.942 Test Loss: 0.165 Test Acc: 0.942
Validation loss decreased (-0.934781 --> -0.942027).  Saving model ...
Epoch: 24 cost time: 0.5040256977081299
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.935 Test Loss: 0.168 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6154868602752686
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.928 Test Loss: 0.170 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6023778915405273
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.928 Test Loss: 0.186 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5888464450836182
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.935 Test Loss: 0.177 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5272784233093262
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.174 Vali Acc: 0.935 Test Loss: 0.174 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5608115196228027
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.935 Test Loss: 0.170 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5743710994720459
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.949 Test Loss: 0.184 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949274).  Saving model ...
Epoch: 31 cost time: 0.5869877338409424
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 32 cost time: 0.5641098022460938
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.935 Test Loss: 0.186 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5014207363128662
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.935 Test Loss: 0.201 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5100219249725342
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5066108703613281
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.49741315841674805
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.935 Test Loss: 0.191 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.49715423583984375
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.935 Test Loss: 0.178 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.4863879680633545
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.942 Test Loss: 0.175 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.4493837356567383
Epoch: 39, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.935 Test Loss: 0.185 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.39664745330810547
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.935 Test Loss: 0.189 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.4457259178161621
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.935 Test Loss: 0.189 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 83652
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.6116762161254883
Epoch: 1, Steps: 9 | Train Loss: 1.515 Vali Loss: 1.427 Vali Acc: 0.225 Test Loss: 1.427 Test Acc: 0.225
Validation loss decreased (inf --> -0.224623).  Saving model ...
Epoch: 2 cost time: 0.4648313522338867
Epoch: 2, Steps: 9 | Train Loss: 1.244 Vali Loss: 1.200 Vali Acc: 0.493 Test Loss: 1.200 Test Acc: 0.493
Validation loss decreased (-0.224623 --> -0.492742).  Saving model ...
Epoch: 3 cost time: 0.4468271732330322
Epoch: 3, Steps: 9 | Train Loss: 0.992 Vali Loss: 0.939 Vali Acc: 0.674 Test Loss: 0.939 Test Acc: 0.674
Validation loss decreased (-0.492742 --> -0.673904).  Saving model ...
Epoch: 4 cost time: 0.4727365970611572
Epoch: 4, Steps: 9 | Train Loss: 0.678 Vali Loss: 0.713 Vali Acc: 0.826 Test Loss: 0.713 Test Acc: 0.826
Validation loss decreased (-0.673904 --> -0.826080).  Saving model ...
Epoch: 5 cost time: 0.5299773216247559
Epoch: 5, Steps: 9 | Train Loss: 0.474 Vali Loss: 0.538 Vali Acc: 0.913 Test Loss: 0.538 Test Acc: 0.913
Validation loss decreased (-0.826080 --> -0.913038).  Saving model ...
Epoch: 6 cost time: 0.5867486000061035
Epoch: 6, Steps: 9 | Train Loss: 0.304 Vali Loss: 0.402 Vali Acc: 0.928 Test Loss: 0.402 Test Acc: 0.928
Validation loss decreased (-0.913038 --> -0.927532).  Saving model ...
Epoch: 7 cost time: 0.541205644607544
Epoch: 7, Steps: 9 | Train Loss: 0.198 Vali Loss: 0.325 Vali Acc: 0.935 Test Loss: 0.325 Test Acc: 0.935
Validation loss decreased (-0.927532 --> -0.934779).  Saving model ...
Epoch: 8 cost time: 0.45746827125549316
Epoch: 8, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.274 Vali Acc: 0.935 Test Loss: 0.274 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934780).  Saving model ...
Epoch: 9 cost time: 0.5821406841278076
Epoch: 9, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.255 Vali Acc: 0.942 Test Loss: 0.255 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942026).  Saving model ...
Epoch: 10 cost time: 0.4109508991241455
Epoch: 10, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.234 Vali Acc: 0.942 Test Loss: 0.234 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 11 cost time: 0.46927499771118164
Epoch: 11, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.218 Vali Acc: 0.942 Test Loss: 0.218 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 12 cost time: 0.4960966110229492
Epoch: 12, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.207 Vali Acc: 0.942 Test Loss: 0.207 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 13 cost time: 0.46820950508117676
Epoch: 13, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.203 Vali Acc: 0.942 Test Loss: 0.203 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 14 cost time: 0.40595579147338867
Epoch: 14, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.200 Vali Acc: 0.935 Test Loss: 0.200 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.44249606132507324
Epoch: 15, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.194 Vali Acc: 0.935 Test Loss: 0.194 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.37356996536254883
Epoch: 16, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.190 Vali Acc: 0.935 Test Loss: 0.190 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.47905397415161133
Epoch: 17, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.188 Vali Acc: 0.942 Test Loss: 0.188 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 18 cost time: 0.3956587314605713
Epoch: 18, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.186 Vali Acc: 0.942 Test Loss: 0.186 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 19 cost time: 0.4043087959289551
Epoch: 19, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.181 Vali Acc: 0.942 Test Loss: 0.181 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 20 cost time: 0.3938415050506592
Epoch: 20, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.175 Vali Acc: 0.935 Test Loss: 0.175 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.44162559509277344
Epoch: 21, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.177 Vali Acc: 0.935 Test Loss: 0.177 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.47599220275878906
Epoch: 22, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.173 Vali Acc: 0.935 Test Loss: 0.173 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4209926128387451
Epoch: 23, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.176 Vali Acc: 0.942 Test Loss: 0.176 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 24 cost time: 0.38920140266418457
Epoch: 24, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.176 Vali Acc: 0.942 Test Loss: 0.176 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4033207893371582
Epoch: 25, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.179 Vali Acc: 0.942 Test Loss: 0.179 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.4936394691467285
Epoch: 26, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.177 Vali Acc: 0.942 Test Loss: 0.177 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5755984783172607
Epoch: 27, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.165 Vali Acc: 0.942 Test Loss: 0.165 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 28 cost time: 0.5056948661804199
Epoch: 28, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.172 Vali Acc: 0.942 Test Loss: 0.172 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5005466938018799
Epoch: 29, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949274).  Saving model ...
Epoch: 30 cost time: 0.46260619163513184
Epoch: 30, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.175 Vali Acc: 0.942 Test Loss: 0.175 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.490938663482666
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.942 Test Loss: 0.158 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.47554993629455566
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.942 Test Loss: 0.160 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.4874730110168457
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.942 Test Loss: 0.158 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5410995483398438
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.157 Vali Acc: 0.942 Test Loss: 0.157 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.467785120010376
Epoch: 35, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.942 Test Loss: 0.160 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.5176260471343994
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.942 Test Loss: 0.160 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5155160427093506
Epoch: 37, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.942 Test Loss: 0.155 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.4513580799102783
Epoch: 38, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.154 Vali Acc: 0.942 Test Loss: 0.154 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.4879586696624756
Epoch: 39, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.942 Test Loss: 0.159 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 57860
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.7805845737457275
Epoch: 1, Steps: 9 | Train Loss: 1.442 Vali Loss: 1.368 Vali Acc: 0.275 Test Loss: 1.368 Test Acc: 0.275
Validation loss decreased (inf --> -0.275349).  Saving model ...
Epoch: 2 cost time: 0.4771392345428467
Epoch: 2, Steps: 9 | Train Loss: 1.276 Vali Loss: 1.225 Vali Acc: 0.399 Test Loss: 1.225 Test Acc: 0.399
Validation loss decreased (-0.275349 --> -0.398538).  Saving model ...
Epoch: 3 cost time: 0.5081658363342285
Epoch: 3, Steps: 9 | Train Loss: 1.071 Vali Loss: 1.041 Vali Acc: 0.572 Test Loss: 1.041 Test Acc: 0.572
Validation loss decreased (-0.398538 --> -0.572453).  Saving model ...
Epoch: 4 cost time: 0.48096656799316406
Epoch: 4, Steps: 9 | Train Loss: 0.817 Vali Loss: 0.869 Vali Acc: 0.717 Test Loss: 0.869 Test Acc: 0.717
Validation loss decreased (-0.572453 --> -0.717383).  Saving model ...
Epoch: 5 cost time: 0.5308377742767334
Epoch: 5, Steps: 9 | Train Loss: 0.635 Vali Loss: 0.702 Vali Acc: 0.833 Test Loss: 0.702 Test Acc: 0.833
Validation loss decreased (-0.717383 --> -0.833326).  Saving model ...
Epoch: 6 cost time: 0.48191142082214355
Epoch: 6, Steps: 9 | Train Loss: 0.473 Vali Loss: 0.577 Vali Acc: 0.848 Test Loss: 0.577 Test Acc: 0.848
Validation loss decreased (-0.833326 --> -0.847820).  Saving model ...
Epoch: 7 cost time: 0.5419778823852539
Epoch: 7, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.482 Vali Acc: 0.891 Test Loss: 0.482 Test Acc: 0.891
Validation loss decreased (-0.847820 --> -0.891300).  Saving model ...
Epoch: 8 cost time: 0.4759559631347656
Epoch: 8, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.413 Vali Acc: 0.913 Test Loss: 0.413 Test Acc: 0.913
Validation loss decreased (-0.891300 --> -0.913039).  Saving model ...
Epoch: 9 cost time: 0.4919447898864746
Epoch: 9, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.353 Vali Acc: 0.928 Test Loss: 0.353 Test Acc: 0.928
Validation loss decreased (-0.913039 --> -0.927533).  Saving model ...
Epoch: 10 cost time: 0.4787914752960205
Epoch: 10, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.315 Vali Acc: 0.920 Test Loss: 0.315 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6060373783111572
Epoch: 11, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.293 Vali Acc: 0.935 Test Loss: 0.293 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934780).  Saving model ...
Epoch: 12 cost time: 0.5262219905853271
Epoch: 12, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.266 Vali Acc: 0.935 Test Loss: 0.266 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 13 cost time: 0.4930412769317627
Epoch: 13, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.263 Vali Acc: 0.920 Test Loss: 0.263 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.503868579864502
Epoch: 14, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.255 Vali Acc: 0.920 Test Loss: 0.255 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4949471950531006
Epoch: 15, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.241 Vali Acc: 0.942 Test Loss: 0.241 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 16 cost time: 0.48456454277038574
Epoch: 16, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.230 Vali Acc: 0.942 Test Loss: 0.230 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 17 cost time: 0.5210666656494141
Epoch: 17, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.232 Vali Acc: 0.942 Test Loss: 0.232 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4602174758911133
Epoch: 18, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4659278392791748
Epoch: 19, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.216 Vali Acc: 0.942 Test Loss: 0.216 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 20 cost time: 0.4718613624572754
Epoch: 20, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.212 Vali Acc: 0.942 Test Loss: 0.212 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 21 cost time: 0.517552375793457
Epoch: 21, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.212 Vali Acc: 0.942 Test Loss: 0.212 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.46884989738464355
Epoch: 22, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.206 Vali Acc: 0.949 Test Loss: 0.206 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949273).  Saving model ...
Epoch: 23 cost time: 0.4769434928894043
Epoch: 23, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.199 Vali Acc: 0.949 Test Loss: 0.199 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 24 cost time: 0.5486741065979004
Epoch: 24, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.194 Vali Acc: 0.949 Test Loss: 0.194 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 25 cost time: 0.46204638481140137
Epoch: 25, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.195 Vali Acc: 0.949 Test Loss: 0.195 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.48273539543151855
Epoch: 26, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.199 Vali Acc: 0.942 Test Loss: 0.199 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5049357414245605
Epoch: 27, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.198 Vali Acc: 0.942 Test Loss: 0.198 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5460176467895508
Epoch: 28, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.193 Vali Acc: 0.942 Test Loss: 0.193 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.46541666984558105
Epoch: 29, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.197 Vali Acc: 0.942 Test Loss: 0.197 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5149760246276855
Epoch: 30, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.190 Vali Acc: 0.935 Test Loss: 0.190 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.4737217426300049
Epoch: 31, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 32 cost time: 0.5026321411132812
Epoch: 32, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.183 Vali Acc: 0.949 Test Loss: 0.183 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949274).  Saving model ...
Epoch: 33 cost time: 0.4571874141693115
Epoch: 33, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 34 cost time: 0.49942469596862793
Epoch: 34, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.181 Vali Acc: 0.949 Test Loss: 0.181 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5636312961578369
Epoch: 35, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.186 Vali Acc: 0.942 Test Loss: 0.186 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.4774003028869629
Epoch: 36, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.182 Vali Acc: 0.942 Test Loss: 0.182 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5500712394714355
Epoch: 37, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.942 Test Loss: 0.184 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5038692951202393
Epoch: 38, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.942 Test Loss: 0.188 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.4530649185180664
Epoch: 39, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.186 Vali Acc: 0.942 Test Loss: 0.186 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.4671645164489746
Epoch: 40, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.4882388114929199
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
Validation loss decreased (-0.949274 --> -0.956520).  Saving model ...
Epoch: 42 cost time: 0.486896276473999
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5359911918640137
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.46827173233032227
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.4964632987976074
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.949 Test Loss: 0.180 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.4872274398803711
Epoch: 46, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.4722583293914795
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.942 Test Loss: 0.182 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.497234582901001
Epoch: 48, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.473696231842041
Epoch: 49, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.4771566390991211
Epoch: 50, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.942 Test Loss: 0.181 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9565217391304348
model parameter : 51268
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8537321090698242
Epoch: 1, Steps: 9 | Train Loss: 1.466 Vali Loss: 1.375 Vali Acc: 0.283 Test Loss: 1.375 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 0.46997833251953125
Epoch: 2, Steps: 9 | Train Loss: 1.330 Vali Loss: 1.259 Vali Acc: 0.442 Test Loss: 1.259 Test Acc: 0.442
Validation loss decreased (-0.282595 --> -0.442016).  Saving model ...
Epoch: 3 cost time: 0.45151543617248535
Epoch: 3, Steps: 9 | Train Loss: 1.139 Vali Loss: 1.100 Vali Acc: 0.551 Test Loss: 1.100 Test Acc: 0.551
Validation loss decreased (-0.442016 --> -0.550714).  Saving model ...
Epoch: 4 cost time: 0.505260705947876
Epoch: 4, Steps: 9 | Train Loss: 0.946 Vali Loss: 0.929 Vali Acc: 0.717 Test Loss: 0.929 Test Acc: 0.717
Validation loss decreased (-0.550714 --> -0.717382).  Saving model ...
Epoch: 5 cost time: 0.4778320789337158
Epoch: 5, Steps: 9 | Train Loss: 0.777 Vali Loss: 0.786 Vali Acc: 0.826 Test Loss: 0.786 Test Acc: 0.826
Validation loss decreased (-0.717382 --> -0.826079).  Saving model ...
Epoch: 6 cost time: 0.5086658000946045
Epoch: 6, Steps: 9 | Train Loss: 0.598 Vali Loss: 0.664 Vali Acc: 0.877 Test Loss: 0.664 Test Acc: 0.877
Validation loss decreased (-0.826079 --> -0.876805).  Saving model ...
Epoch: 7 cost time: 0.511000394821167
Epoch: 7, Steps: 9 | Train Loss: 0.481 Vali Loss: 0.551 Vali Acc: 0.884 Test Loss: 0.551 Test Acc: 0.884
Validation loss decreased (-0.876805 --> -0.884052).  Saving model ...
Epoch: 8 cost time: 0.5069162845611572
Epoch: 8, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.468 Vali Acc: 0.899 Test Loss: 0.468 Test Acc: 0.899
Validation loss decreased (-0.884052 --> -0.898546).  Saving model ...
Epoch: 9 cost time: 0.5265519618988037
Epoch: 9, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.403 Vali Acc: 0.906 Test Loss: 0.403 Test Acc: 0.906
Validation loss decreased (-0.898546 --> -0.905793).  Saving model ...
Epoch: 10 cost time: 0.4929835796356201
Epoch: 10, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.355 Vali Acc: 0.928 Test Loss: 0.355 Test Acc: 0.928
Validation loss decreased (-0.905793 --> -0.927533).  Saving model ...
Epoch: 11 cost time: 0.5158627033233643
Epoch: 11, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.314 Vali Acc: 0.920 Test Loss: 0.314 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5153994560241699
Epoch: 12, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.292 Vali Acc: 0.935 Test Loss: 0.292 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934780).  Saving model ...
Epoch: 13 cost time: 0.5225350856781006
Epoch: 13, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.277 Vali Acc: 0.935 Test Loss: 0.277 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 14 cost time: 0.5301594734191895
Epoch: 14, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.264 Vali Acc: 0.928 Test Loss: 0.264 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4982626438140869
Epoch: 15, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.248 Vali Acc: 0.942 Test Loss: 0.248 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 16 cost time: 0.5075967311859131
Epoch: 16, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.238 Vali Acc: 0.942 Test Loss: 0.238 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 17 cost time: 0.514174222946167
Epoch: 17, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.230 Vali Acc: 0.935 Test Loss: 0.230 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4830968379974365
Epoch: 18, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.218 Vali Acc: 0.928 Test Loss: 0.218 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5037918090820312
Epoch: 19, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.216 Vali Acc: 0.935 Test Loss: 0.216 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.48096227645874023
Epoch: 20, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.500591516494751
Epoch: 21, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.217 Vali Acc: 0.935 Test Loss: 0.217 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.4690268039703369
Epoch: 22, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5368504524230957
Epoch: 23, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.4333610534667969
Epoch: 24, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.198 Vali Acc: 0.935 Test Loss: 0.198 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.534416675567627
Epoch: 25, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5470371246337891
Epoch: 26, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 46212
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.6410677433013916
Epoch: 1, Steps: 9 | Train Loss: 1.408 Vali Loss: 1.408 Vali Acc: 0.312 Test Loss: 1.408 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 0.46789002418518066
Epoch: 2, Steps: 9 | Train Loss: 1.286 Vali Loss: 1.326 Vali Acc: 0.391 Test Loss: 1.326 Test Acc: 0.391
Validation loss decreased (-0.311580 --> -0.391291).  Saving model ...
Epoch: 3 cost time: 0.474259614944458
Epoch: 3, Steps: 9 | Train Loss: 1.167 Vali Loss: 1.201 Vali Acc: 0.471 Test Loss: 1.201 Test Acc: 0.471
Validation loss decreased (-0.391291 --> -0.471002).  Saving model ...
Epoch: 4 cost time: 0.4801449775695801
Epoch: 4, Steps: 9 | Train Loss: 1.048 Vali Loss: 1.060 Vali Acc: 0.594 Test Loss: 1.060 Test Acc: 0.594
Validation loss decreased (-0.471002 --> -0.594192).  Saving model ...
Epoch: 5 cost time: 0.5006513595581055
Epoch: 5, Steps: 9 | Train Loss: 0.866 Vali Loss: 0.933 Vali Acc: 0.681 Test Loss: 0.933 Test Acc: 0.681
Validation loss decreased (-0.594192 --> -0.681150).  Saving model ...
Epoch: 6 cost time: 0.4581601619720459
Epoch: 6, Steps: 9 | Train Loss: 0.745 Vali Loss: 0.812 Vali Acc: 0.754 Test Loss: 0.812 Test Acc: 0.754
Validation loss decreased (-0.681150 --> -0.753615).  Saving model ...
Epoch: 7 cost time: 0.5549306869506836
Epoch: 7, Steps: 9 | Train Loss: 0.604 Vali Loss: 0.710 Vali Acc: 0.812 Test Loss: 0.710 Test Acc: 0.812
Validation loss decreased (-0.753615 --> -0.811587).  Saving model ...
Epoch: 8 cost time: 0.4838130474090576
Epoch: 8, Steps: 9 | Train Loss: 0.507 Vali Loss: 0.627 Vali Acc: 0.841 Test Loss: 0.627 Test Acc: 0.841
Validation loss decreased (-0.811587 --> -0.840573).  Saving model ...
Epoch: 9 cost time: 0.5036792755126953
Epoch: 9, Steps: 9 | Train Loss: 0.402 Vali Loss: 0.547 Vali Acc: 0.877 Test Loss: 0.547 Test Acc: 0.877
Validation loss decreased (-0.840573 --> -0.876806).  Saving model ...
Epoch: 10 cost time: 0.45070910453796387
Epoch: 10, Steps: 9 | Train Loss: 0.332 Vali Loss: 0.480 Vali Acc: 0.899 Test Loss: 0.480 Test Acc: 0.899
Validation loss decreased (-0.876806 --> -0.898546).  Saving model ...
Epoch: 11 cost time: 0.35748887062072754
Epoch: 11, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.440 Vali Acc: 0.913 Test Loss: 0.440 Test Acc: 0.913
Validation loss decreased (-0.898546 --> -0.913039).  Saving model ...
Epoch: 12 cost time: 0.4754185676574707
Epoch: 12, Steps: 9 | Train Loss: 0.227 Vali Loss: 0.399 Vali Acc: 0.906 Test Loss: 0.399 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5526564121246338
Epoch: 13, Steps: 9 | Train Loss: 0.198 Vali Loss: 0.367 Vali Acc: 0.920 Test Loss: 0.367 Test Acc: 0.920
Validation loss decreased (-0.913039 --> -0.920286).  Saving model ...
Epoch: 14 cost time: 0.4671061038970947
Epoch: 14, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.343 Vali Acc: 0.913 Test Loss: 0.343 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.47472238540649414
Epoch: 15, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.325 Vali Acc: 0.913 Test Loss: 0.325 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4789400100708008
Epoch: 16, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.310 Vali Acc: 0.920 Test Loss: 0.310 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920287).  Saving model ...
Epoch: 17 cost time: 0.5468614101409912
Epoch: 17, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.289 Vali Acc: 0.928 Test Loss: 0.289 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927533).  Saving model ...
Epoch: 18 cost time: 0.6091341972351074
Epoch: 18, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.282 Vali Acc: 0.928 Test Loss: 0.282 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 19 cost time: 0.4605600833892822
Epoch: 19, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.270 Vali Acc: 0.935 Test Loss: 0.270 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934780).  Saving model ...
Epoch: 20 cost time: 0.5113749504089355
Epoch: 20, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.260 Vali Acc: 0.935 Test Loss: 0.260 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 21 cost time: 0.4720911979675293
Epoch: 21, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.250 Vali Acc: 0.935 Test Loss: 0.250 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 22 cost time: 0.5338499546051025
Epoch: 22, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.250 Vali Acc: 0.935 Test Loss: 0.250 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4686315059661865
Epoch: 23, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.254 Vali Acc: 0.928 Test Loss: 0.254 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5162668228149414
Epoch: 24, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.244 Vali Acc: 0.928 Test Loss: 0.244 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.46988677978515625
Epoch: 25, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.235 Vali Acc: 0.935 Test Loss: 0.235 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 26 cost time: 0.4469320774078369
Epoch: 26, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.224 Vali Acc: 0.942 Test Loss: 0.224 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 27 cost time: 0.5138776302337646
Epoch: 27, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.214 Vali Acc: 0.942 Test Loss: 0.214 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 28 cost time: 0.4621586799621582
Epoch: 28, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.213 Vali Acc: 0.942 Test Loss: 0.213 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 29 cost time: 0.4658827781677246
Epoch: 29, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.208 Vali Acc: 0.942 Test Loss: 0.208 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 30 cost time: 0.5679080486297607
Epoch: 30, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.209 Vali Acc: 0.942 Test Loss: 0.209 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.4857478141784668
Epoch: 31, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.210 Vali Acc: 0.942 Test Loss: 0.210 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.44770002365112305
Epoch: 32, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.206 Vali Acc: 0.942 Test Loss: 0.206 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 33 cost time: 0.4484548568725586
Epoch: 33, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.207 Vali Acc: 0.942 Test Loss: 0.207 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4967989921569824
Epoch: 34, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.201 Vali Acc: 0.942 Test Loss: 0.201 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 35 cost time: 0.6028568744659424
Epoch: 35, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.205 Vali Acc: 0.949 Test Loss: 0.205 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949273).  Saving model ...
Epoch: 36 cost time: 0.5221691131591797
Epoch: 36, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.202 Vali Acc: 0.942 Test Loss: 0.202 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.533806562423706
Epoch: 37, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.203 Vali Acc: 0.942 Test Loss: 0.203 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.4595985412597656
Epoch: 38, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.207 Vali Acc: 0.942 Test Loss: 0.207 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.48760342597961426
Epoch: 39, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.206 Vali Acc: 0.942 Test Loss: 0.206 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5270853042602539
Epoch: 40, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.197 Vali Acc: 0.942 Test Loss: 0.197 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.5405757427215576
Epoch: 41, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.196 Vali Acc: 0.942 Test Loss: 0.196 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.46557164192199707
Epoch: 42, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.194 Vali Acc: 0.942 Test Loss: 0.194 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.49602627754211426
Epoch: 43, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.200 Vali Acc: 0.949 Test Loss: 0.200 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 44 cost time: 0.4925272464752197
Epoch: 44, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.189 Vali Acc: 0.942 Test Loss: 0.189 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.506199836730957
Epoch: 45, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.184 Vali Acc: 0.942 Test Loss: 0.184 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5145783424377441
Epoch: 46, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.185 Vali Acc: 0.942 Test Loss: 0.185 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.4684867858886719
Epoch: 47, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.185 Vali Acc: 0.942 Test Loss: 0.185 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.4918851852416992
Epoch: 48, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.188 Vali Acc: 0.942 Test Loss: 0.188 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.5023927688598633
Epoch: 49, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.191 Vali Acc: 0.942 Test Loss: 0.191 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.47008371353149414
Epoch: 50, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 42244
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.702897310256958
Epoch: 1, Steps: 9 | Train Loss: 1.407 Vali Loss: 1.367 Vali Acc: 0.304 Test Loss: 1.367 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 0.5095217227935791
Epoch: 2, Steps: 9 | Train Loss: 1.315 Vali Loss: 1.290 Vali Acc: 0.413 Test Loss: 1.290 Test Acc: 0.413
Validation loss decreased (-0.304334 --> -0.413031).  Saving model ...
Epoch: 3 cost time: 0.4865236282348633
Epoch: 3, Steps: 9 | Train Loss: 1.209 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
Validation loss decreased (-0.413031 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.5248410701751709
Epoch: 4, Steps: 9 | Train Loss: 1.082 Vali Loss: 1.075 Vali Acc: 0.580 Test Loss: 1.075 Test Acc: 0.580
Validation loss decreased (-0.499988 --> -0.579699).  Saving model ...
Epoch: 5 cost time: 0.49806880950927734
Epoch: 5, Steps: 9 | Train Loss: 0.946 Vali Loss: 0.967 Vali Acc: 0.659 Test Loss: 0.967 Test Acc: 0.659
Validation loss decreased (-0.579699 --> -0.659411).  Saving model ...
Epoch: 6 cost time: 0.524301290512085
Epoch: 6, Steps: 9 | Train Loss: 0.827 Vali Loss: 0.870 Vali Acc: 0.710 Test Loss: 0.870 Test Acc: 0.710
Validation loss decreased (-0.659411 --> -0.710136).  Saving model ...
Epoch: 7 cost time: 0.4908945560455322
Epoch: 7, Steps: 9 | Train Loss: 0.715 Vali Loss: 0.780 Vali Acc: 0.797 Test Loss: 0.780 Test Acc: 0.797
Validation loss decreased (-0.710136 --> -0.797094).  Saving model ...
Epoch: 8 cost time: 0.44415903091430664
Epoch: 8, Steps: 9 | Train Loss: 0.600 Vali Loss: 0.695 Vali Acc: 0.826 Test Loss: 0.695 Test Acc: 0.826
Validation loss decreased (-0.797094 --> -0.826080).  Saving model ...
Epoch: 9 cost time: 0.5010795593261719
Epoch: 9, Steps: 9 | Train Loss: 0.506 Vali Loss: 0.624 Vali Acc: 0.877 Test Loss: 0.624 Test Acc: 0.877
Validation loss decreased (-0.826080 --> -0.876805).  Saving model ...
Epoch: 10 cost time: 0.48581695556640625
Epoch: 10, Steps: 9 | Train Loss: 0.425 Vali Loss: 0.559 Vali Acc: 0.884 Test Loss: 0.559 Test Acc: 0.884
Validation loss decreased (-0.876805 --> -0.884052).  Saving model ...
Epoch: 11 cost time: 0.46837806701660156
Epoch: 11, Steps: 9 | Train Loss: 0.375 Vali Loss: 0.516 Vali Acc: 0.877 Test Loss: 0.516 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.511258602142334
Epoch: 12, Steps: 9 | Train Loss: 0.313 Vali Loss: 0.478 Vali Acc: 0.884 Test Loss: 0.478 Test Acc: 0.884
Validation loss decreased (-0.884052 --> -0.884053).  Saving model ...
Epoch: 13 cost time: 0.4618394374847412
Epoch: 13, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.445 Vali Acc: 0.884 Test Loss: 0.445 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884054).  Saving model ...
Epoch: 14 cost time: 0.48976683616638184
Epoch: 14, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.417 Vali Acc: 0.891 Test Loss: 0.417 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 15 cost time: 0.47980737686157227
Epoch: 15, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.388 Vali Acc: 0.884 Test Loss: 0.388 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4988749027252197
Epoch: 16, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.376 Vali Acc: 0.891 Test Loss: 0.376 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891301).  Saving model ...
Epoch: 17 cost time: 0.5103192329406738
Epoch: 17, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.355 Vali Acc: 0.884 Test Loss: 0.355 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.46033644676208496
Epoch: 18, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.352 Vali Acc: 0.899 Test Loss: 0.352 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 19 cost time: 0.46257543563842773
Epoch: 19, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.332 Vali Acc: 0.891 Test Loss: 0.332 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.515202522277832
Epoch: 20, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.320 Vali Acc: 0.891 Test Loss: 0.320 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4971930980682373
Epoch: 21, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.304 Vali Acc: 0.906 Test Loss: 0.304 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 22 cost time: 0.4461214542388916
Epoch: 22, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.299 Vali Acc: 0.920 Test Loss: 0.299 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920287).  Saving model ...
Epoch: 23 cost time: 0.48505711555480957
Epoch: 23, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.292 Vali Acc: 0.913 Test Loss: 0.292 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4664590358734131
Epoch: 24, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.283 Vali Acc: 0.913 Test Loss: 0.283 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5006613731384277
Epoch: 25, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.277 Vali Acc: 0.913 Test Loss: 0.277 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4834439754486084
Epoch: 26, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.270 Vali Acc: 0.913 Test Loss: 0.270 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5133764743804932
Epoch: 27, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.260 Vali Acc: 0.920 Test Loss: 0.260 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 28 cost time: 0.4980013370513916
Epoch: 28, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.257 Vali Acc: 0.920 Test Loss: 0.257 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 29 cost time: 0.4488804340362549
Epoch: 29, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.252 Vali Acc: 0.913 Test Loss: 0.252 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.4493227005004883
Epoch: 30, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.254 Vali Acc: 0.920 Test Loss: 0.254 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 31 cost time: 0.5281214714050293
Epoch: 31, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.244 Vali Acc: 0.913 Test Loss: 0.244 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.45583486557006836
Epoch: 32, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.257 Vali Acc: 0.913 Test Loss: 0.257 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.4975278377532959
Epoch: 33, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.266 Vali Acc: 0.913 Test Loss: 0.266 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.49154210090637207
Epoch: 34, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.254 Vali Acc: 0.913 Test Loss: 0.254 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5242464542388916
Epoch: 35, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.237 Vali Acc: 0.920 Test Loss: 0.237 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 36 cost time: 0.5365724563598633
Epoch: 36, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.234 Vali Acc: 0.920 Test Loss: 0.234 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920288).  Saving model ...
Epoch: 37 cost time: 0.4796428680419922
Epoch: 37, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.239 Vali Acc: 0.920 Test Loss: 0.239 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.4653322696685791
Epoch: 38, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.226 Vali Acc: 0.928 Test Loss: 0.226 Test Acc: 0.928
Validation loss decreased (-0.920288 --> -0.927534).  Saving model ...
Epoch: 39 cost time: 0.511491060256958
Epoch: 39, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.228 Vali Acc: 0.920 Test Loss: 0.228 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.48442983627319336
Epoch: 40, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.232 Vali Acc: 0.913 Test Loss: 0.232 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.4943525791168213
Epoch: 41, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.223 Vali Acc: 0.920 Test Loss: 0.223 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.4938671588897705
Epoch: 42, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.222 Vali Acc: 0.913 Test Loss: 0.222 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.4787933826446533
Epoch: 43, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.232 Vali Acc: 0.913 Test Loss: 0.232 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.5027720928192139
Epoch: 44, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.227 Vali Acc: 0.913 Test Loss: 0.227 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.4448544979095459
Epoch: 45, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.227 Vali Acc: 0.913 Test Loss: 0.227 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.48308539390563965
Epoch: 46, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.223 Vali Acc: 0.913 Test Loss: 0.223 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.4738037586212158
Epoch: 47, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.224 Vali Acc: 0.913 Test Loss: 0.224 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.46184754371643066
Epoch: 48, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.221 Vali Acc: 0.920 Test Loss: 0.221 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 40644
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.6653249263763428
Epoch: 1, Steps: 9 | Train Loss: 1.460 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 0.4949674606323242
Epoch: 2, Steps: 9 | Train Loss: 1.349 Vali Loss: 1.328 Vali Acc: 0.355 Test Loss: 1.328 Test Acc: 0.355
Validation loss decreased (-0.282595 --> -0.355059).  Saving model ...
Epoch: 3 cost time: 0.48876404762268066
Epoch: 3, Steps: 9 | Train Loss: 1.259 Vali Loss: 1.238 Vali Acc: 0.486 Test Loss: 1.238 Test Acc: 0.486
Validation loss decreased (-0.355059 --> -0.485495).  Saving model ...
Epoch: 4 cost time: 0.5004823207855225
Epoch: 4, Steps: 9 | Train Loss: 1.167 Vali Loss: 1.141 Vali Acc: 0.551 Test Loss: 1.141 Test Acc: 0.551
Validation loss decreased (-0.485495 --> -0.550713).  Saving model ...
Epoch: 5 cost time: 0.5368499755859375
Epoch: 5, Steps: 9 | Train Loss: 1.037 Vali Loss: 1.041 Vali Acc: 0.630 Test Loss: 1.041 Test Acc: 0.630
Validation loss decreased (-0.550713 --> -0.630424).  Saving model ...
Epoch: 6 cost time: 0.5041539669036865
Epoch: 6, Steps: 9 | Train Loss: 0.939 Vali Loss: 0.944 Vali Acc: 0.674 Test Loss: 0.944 Test Acc: 0.674
Validation loss decreased (-0.630424 --> -0.673904).  Saving model ...
Epoch: 7 cost time: 0.4690089225769043
Epoch: 7, Steps: 9 | Train Loss: 0.801 Vali Loss: 0.862 Vali Acc: 0.717 Test Loss: 0.862 Test Acc: 0.717
Validation loss decreased (-0.673904 --> -0.717383).  Saving model ...
Epoch: 8 cost time: 0.5511233806610107
Epoch: 8, Steps: 9 | Train Loss: 0.697 Vali Loss: 0.770 Vali Acc: 0.797 Test Loss: 0.770 Test Acc: 0.797
Validation loss decreased (-0.717383 --> -0.797094).  Saving model ...
Epoch: 9 cost time: 0.5363337993621826
Epoch: 9, Steps: 9 | Train Loss: 0.605 Vali Loss: 0.700 Vali Acc: 0.812 Test Loss: 0.700 Test Acc: 0.812
Validation loss decreased (-0.797094 --> -0.811587).  Saving model ...
Epoch: 10 cost time: 0.5228321552276611
Epoch: 10, Steps: 9 | Train Loss: 0.516 Vali Loss: 0.654 Vali Acc: 0.826 Test Loss: 0.654 Test Acc: 0.826
Validation loss decreased (-0.811587 --> -0.826080).  Saving model ...
Epoch: 11 cost time: 0.5294227600097656
Epoch: 11, Steps: 9 | Train Loss: 0.475 Vali Loss: 0.605 Vali Acc: 0.848 Test Loss: 0.605 Test Acc: 0.848
Validation loss decreased (-0.826080 --> -0.847820).  Saving model ...
Epoch: 12 cost time: 0.4949033260345459
Epoch: 12, Steps: 9 | Train Loss: 0.396 Vali Loss: 0.565 Vali Acc: 0.848 Test Loss: 0.565 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847820).  Saving model ...
Epoch: 13 cost time: 0.5000834465026855
Epoch: 13, Steps: 9 | Train Loss: 0.355 Vali Loss: 0.525 Vali Acc: 0.870 Test Loss: 0.525 Test Acc: 0.870
Validation loss decreased (-0.847820 --> -0.869560).  Saving model ...
Epoch: 14 cost time: 0.5076572895050049
Epoch: 14, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.495 Vali Acc: 0.877 Test Loss: 0.495 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876807).  Saving model ...
Epoch: 15 cost time: 0.5044999122619629
Epoch: 15, Steps: 9 | Train Loss: 0.286 Vali Loss: 0.468 Vali Acc: 0.884 Test Loss: 0.468 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884053).  Saving model ...
Epoch: 16 cost time: 0.5521557331085205
Epoch: 16, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.445 Vali Acc: 0.884 Test Loss: 0.445 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884054).  Saving model ...
Epoch: 17 cost time: 0.5209736824035645
Epoch: 17, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.427 Vali Acc: 0.891 Test Loss: 0.427 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 18 cost time: 0.5210707187652588
Epoch: 18, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.407 Vali Acc: 0.891 Test Loss: 0.407 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 19 cost time: 0.5416688919067383
Epoch: 19, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.386 Vali Acc: 0.891 Test Loss: 0.386 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 20 cost time: 0.5179834365844727
Epoch: 20, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.382 Vali Acc: 0.891 Test Loss: 0.382 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891301).  Saving model ...
Epoch: 21 cost time: 0.49361681938171387
Epoch: 21, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.367 Vali Acc: 0.891 Test Loss: 0.367 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 22 cost time: 0.46462106704711914
Epoch: 22, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.357 Vali Acc: 0.891 Test Loss: 0.357 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 23 cost time: 0.4865906238555908
Epoch: 23, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.344 Vali Acc: 0.891 Test Loss: 0.344 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 24 cost time: 0.5124022960662842
Epoch: 24, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.337 Vali Acc: 0.920 Test Loss: 0.337 Test Acc: 0.920
Validation loss decreased (-0.891301 --> -0.920286).  Saving model ...
Epoch: 25 cost time: 0.4925053119659424
Epoch: 25, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.325 Vali Acc: 0.913 Test Loss: 0.325 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.478360652923584
Epoch: 26, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.317 Vali Acc: 0.913 Test Loss: 0.317 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5100834369659424
Epoch: 27, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.307 Vali Acc: 0.913 Test Loss: 0.307 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5011157989501953
Epoch: 28, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.306 Vali Acc: 0.920 Test Loss: 0.306 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920287).  Saving model ...
Epoch: 29 cost time: 0.5310766696929932
Epoch: 29, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.300 Vali Acc: 0.920 Test Loss: 0.300 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 30 cost time: 0.4645102024078369
Epoch: 30, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.294 Vali Acc: 0.920 Test Loss: 0.294 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 31 cost time: 0.5340867042541504
Epoch: 31, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.285 Vali Acc: 0.920 Test Loss: 0.285 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 32 cost time: 0.5385019779205322
Epoch: 32, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.285 Vali Acc: 0.913 Test Loss: 0.285 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5624899864196777
Epoch: 33, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.274 Vali Acc: 0.913 Test Loss: 0.274 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.48776793479919434
Epoch: 34, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.267 Vali Acc: 0.913 Test Loss: 0.267 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5609176158905029
Epoch: 35, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.279 Vali Acc: 0.928 Test Loss: 0.279 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927533).  Saving model ...
Epoch: 36 cost time: 0.5490546226501465
Epoch: 36, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.272 Vali Acc: 0.928 Test Loss: 0.272 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927534).  Saving model ...
Epoch: 37 cost time: 0.49169254302978516
Epoch: 37, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.272 Vali Acc: 0.920 Test Loss: 0.272 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.49755382537841797
Epoch: 38, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.263 Vali Acc: 0.920 Test Loss: 0.263 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5505719184875488
Epoch: 39, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.259 Vali Acc: 0.920 Test Loss: 0.259 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.4786391258239746
Epoch: 40, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.256 Vali Acc: 0.920 Test Loss: 0.256 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.49771714210510254
Epoch: 41, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.261 Vali Acc: 0.928 Test Loss: 0.261 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 42 cost time: 0.48322343826293945
Epoch: 42, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.260 Vali Acc: 0.928 Test Loss: 0.260 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 43 cost time: 0.5795979499816895
Epoch: 43, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.251 Vali Acc: 0.920 Test Loss: 0.251 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4944572448730469
Epoch: 44, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.245 Vali Acc: 0.920 Test Loss: 0.245 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.4526522159576416
Epoch: 45, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.251 Vali Acc: 0.928 Test Loss: 0.251 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 46 cost time: 0.5186445713043213
Epoch: 46, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.254 Vali Acc: 0.920 Test Loss: 0.254 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5725076198577881
Epoch: 47, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.245 Vali Acc: 0.913 Test Loss: 0.245 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.4958209991455078
Epoch: 48, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.237 Vali Acc: 0.913 Test Loss: 0.237 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.6014976501464844
Epoch: 49, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.232 Vali Acc: 0.928 Test Loss: 0.232 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 50 cost time: 0.5182254314422607
Epoch: 50, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.232 Vali Acc: 0.928 Test Loss: 0.232 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 39748
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.6108789443969727
Epoch: 1, Steps: 9 | Train Loss: 1.465 Vali Loss: 1.361 Vali Acc: 0.261 Test Loss: 1.361 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 0.4851694107055664
Epoch: 2, Steps: 9 | Train Loss: 1.201 Vali Loss: 1.084 Vali Acc: 0.529 Test Loss: 1.084 Test Acc: 0.529
Validation loss decreased (-0.260856 --> -0.528975).  Saving model ...
Epoch: 3 cost time: 0.46200108528137207
Epoch: 3, Steps: 9 | Train Loss: 0.860 Vali Loss: 0.810 Vali Acc: 0.739 Test Loss: 0.810 Test Acc: 0.739
Validation loss decreased (-0.528975 --> -0.739122).  Saving model ...
Epoch: 4 cost time: 0.4948997497558594
Epoch: 4, Steps: 9 | Train Loss: 0.603 Vali Loss: 0.609 Vali Acc: 0.848 Test Loss: 0.609 Test Acc: 0.848
Validation loss decreased (-0.739122 --> -0.847820).  Saving model ...
Epoch: 5 cost time: 0.4559743404388428
Epoch: 5, Steps: 9 | Train Loss: 0.442 Vali Loss: 0.445 Vali Acc: 0.877 Test Loss: 0.445 Test Acc: 0.877
Validation loss decreased (-0.847820 --> -0.876807).  Saving model ...
Epoch: 6 cost time: 0.4425621032714844
Epoch: 6, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.356 Vali Acc: 0.906 Test Loss: 0.356 Test Acc: 0.906
Validation loss decreased (-0.876807 --> -0.905794).  Saving model ...
Epoch: 7 cost time: 0.5926661491394043
Epoch: 7, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.302 Vali Acc: 0.906 Test Loss: 0.302 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 8 cost time: 0.46930480003356934
Epoch: 8, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.249 Vali Acc: 0.957 Test Loss: 0.249 Test Acc: 0.957
Validation loss decreased (-0.905794 --> -0.956519).  Saving model ...
Epoch: 9 cost time: 0.4189484119415283
Epoch: 9, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.230 Vali Acc: 0.949 Test Loss: 0.230 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6054229736328125
Epoch: 10, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.224 Vali Acc: 0.949 Test Loss: 0.224 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5013008117675781
Epoch: 11, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.215 Vali Acc: 0.949 Test Loss: 0.215 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4623265266418457
Epoch: 12, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.215 Vali Acc: 0.949 Test Loss: 0.215 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4770529270172119
Epoch: 13, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.198 Vali Acc: 0.949 Test Loss: 0.198 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5658514499664307
Epoch: 14, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.186 Vali Acc: 0.957 Test Loss: 0.186 Test Acc: 0.957
Validation loss decreased (-0.956519 --> -0.956520).  Saving model ...
Epoch: 15 cost time: 0.4710052013397217
Epoch: 15, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.187 Vali Acc: 0.957 Test Loss: 0.187 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5024058818817139
Epoch: 16, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.187 Vali Acc: 0.935 Test Loss: 0.187 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5214519500732422
Epoch: 17, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.186 Vali Acc: 0.942 Test Loss: 0.186 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.46552348136901855
Epoch: 18, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
Validation loss decreased (-0.956520 --> -0.956520).  Saving model ...
Epoch: 19 cost time: 0.47148656845092773
Epoch: 19, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5034196376800537
Epoch: 20, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4956798553466797
Epoch: 21, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.175 Vali Acc: 0.942 Test Loss: 0.175 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4865567684173584
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.174 Vali Acc: 0.942 Test Loss: 0.174 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.4956481456756592
Epoch: 23, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.174 Vali Acc: 0.942 Test Loss: 0.174 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.4937288761138916
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.174 Vali Acc: 0.935 Test Loss: 0.174 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.4561166763305664
Epoch: 25, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.182 Vali Acc: 0.935 Test Loss: 0.182 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.4819517135620117
Epoch: 26, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.176 Vali Acc: 0.935 Test Loss: 0.176 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.47119569778442383
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.169 Vali Acc: 0.942 Test Loss: 0.169 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5164949893951416
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.170 Vali Acc: 0.942 Test Loss: 0.170 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9565217391304348
model parameter : 35684
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.667398452758789
Epoch: 1, Steps: 9 | Train Loss: 1.459 Vali Loss: 1.365 Vali Acc: 0.362 Test Loss: 1.365 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 0.47802257537841797
Epoch: 2, Steps: 9 | Train Loss: 1.292 Vali Loss: 1.217 Vali Acc: 0.572 Test Loss: 1.217 Test Acc: 0.572
Validation loss decreased (-0.362305 --> -0.572452).  Saving model ...
Epoch: 3 cost time: 0.460338830947876
Epoch: 3, Steps: 9 | Train Loss: 1.089 Vali Loss: 1.044 Vali Acc: 0.696 Test Loss: 1.044 Test Acc: 0.696
Validation loss decreased (-0.572452 --> -0.695642).  Saving model ...
Epoch: 4 cost time: 0.44129252433776855
Epoch: 4, Steps: 9 | Train Loss: 0.897 Vali Loss: 0.888 Vali Acc: 0.790 Test Loss: 0.888 Test Acc: 0.790
Validation loss decreased (-0.695642 --> -0.789846).  Saving model ...
Epoch: 5 cost time: 0.5069286823272705
Epoch: 5, Steps: 9 | Train Loss: 0.732 Vali Loss: 0.748 Vali Acc: 0.812 Test Loss: 0.748 Test Acc: 0.812
Validation loss decreased (-0.789846 --> -0.811587).  Saving model ...
Epoch: 6 cost time: 0.4415256977081299
Epoch: 6, Steps: 9 | Train Loss: 0.594 Vali Loss: 0.641 Vali Acc: 0.841 Test Loss: 0.641 Test Acc: 0.841
Validation loss decreased (-0.811587 --> -0.840573).  Saving model ...
Epoch: 7 cost time: 0.478501558303833
Epoch: 7, Steps: 9 | Train Loss: 0.463 Vali Loss: 0.557 Vali Acc: 0.877 Test Loss: 0.557 Test Acc: 0.877
Validation loss decreased (-0.840573 --> -0.876806).  Saving model ...
Epoch: 8 cost time: 0.4736294746398926
Epoch: 8, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.463 Vali Acc: 0.891 Test Loss: 0.463 Test Acc: 0.891
Validation loss decreased (-0.876806 --> -0.891300).  Saving model ...
Epoch: 9 cost time: 0.4818904399871826
Epoch: 9, Steps: 9 | Train Loss: 0.275 Vali Loss: 0.400 Vali Acc: 0.913 Test Loss: 0.400 Test Acc: 0.913
Validation loss decreased (-0.891300 --> -0.913039).  Saving model ...
Epoch: 10 cost time: 0.4472029209136963
Epoch: 10, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.363 Vali Acc: 0.920 Test Loss: 0.363 Test Acc: 0.920
Validation loss decreased (-0.913039 --> -0.920286).  Saving model ...
Epoch: 11 cost time: 0.4671306610107422
Epoch: 11, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.334 Vali Acc: 0.920 Test Loss: 0.334 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920287).  Saving model ...
Epoch: 12 cost time: 0.42931389808654785
Epoch: 12, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.308 Vali Acc: 0.928 Test Loss: 0.308 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927533).  Saving model ...
Epoch: 13 cost time: 0.42699766159057617
Epoch: 13, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.285 Vali Acc: 0.935 Test Loss: 0.285 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934780).  Saving model ...
Epoch: 14 cost time: 0.5002486705780029
Epoch: 14, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.280 Vali Acc: 0.942 Test Loss: 0.280 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942026).  Saving model ...
Epoch: 15 cost time: 0.46315526962280273
Epoch: 15, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.272 Vali Acc: 0.935 Test Loss: 0.272 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.43943023681640625
Epoch: 16, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.249 Vali Acc: 0.935 Test Loss: 0.249 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.426271915435791
Epoch: 17, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.232 Vali Acc: 0.942 Test Loss: 0.232 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 18 cost time: 0.4654233455657959
Epoch: 18, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.231 Vali Acc: 0.942 Test Loss: 0.231 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 19 cost time: 0.44053053855895996
Epoch: 19, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.226 Vali Acc: 0.942 Test Loss: 0.226 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 20 cost time: 0.41344285011291504
Epoch: 20, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.221 Vali Acc: 0.942 Test Loss: 0.221 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 21 cost time: 0.46547651290893555
Epoch: 21, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.223 Vali Acc: 0.935 Test Loss: 0.223 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.42726707458496094
Epoch: 22, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.227 Vali Acc: 0.942 Test Loss: 0.227 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4674077033996582
Epoch: 23, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.208 Vali Acc: 0.942 Test Loss: 0.208 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 24 cost time: 0.4274461269378662
Epoch: 24, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.207 Vali Acc: 0.942 Test Loss: 0.207 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 25 cost time: 0.520512580871582
Epoch: 25, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.204 Vali Acc: 0.942 Test Loss: 0.204 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 26 cost time: 0.46024537086486816
Epoch: 26, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.205 Vali Acc: 0.942 Test Loss: 0.205 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.500704288482666
Epoch: 27, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.199 Vali Acc: 0.949 Test Loss: 0.199 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949273).  Saving model ...
Epoch: 28 cost time: 0.42999958992004395
Epoch: 28, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.198 Vali Acc: 0.942 Test Loss: 0.198 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.48632192611694336
Epoch: 29, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.192 Vali Acc: 0.949 Test Loss: 0.192 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 30 cost time: 0.4647791385650635
Epoch: 30, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 31 cost time: 0.47269272804260254
Epoch: 31, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949274).  Saving model ...
Epoch: 32 cost time: 0.4457974433898926
Epoch: 32, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.184 Vali Acc: 0.949 Test Loss: 0.184 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 33 cost time: 0.45223426818847656
Epoch: 33, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.45235753059387207
Epoch: 34, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.190 Vali Acc: 0.949 Test Loss: 0.190 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5055465698242188
Epoch: 35, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.48613667488098145
Epoch: 36, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.188 Vali Acc: 0.949 Test Loss: 0.188 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.46822404861450195
Epoch: 37, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.188 Vali Acc: 0.949 Test Loss: 0.188 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.4859278202056885
Epoch: 38, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 39 cost time: 0.44802045822143555
Epoch: 39, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.183 Vali Acc: 0.949 Test Loss: 0.183 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5030138492584229
Epoch: 40, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.181 Vali Acc: 0.949 Test Loss: 0.181 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.455596923828125
Epoch: 41, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.180 Vali Acc: 0.949 Test Loss: 0.180 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.4466826915740967
Epoch: 42, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.4181694984436035
Epoch: 43, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.4848136901855469
Epoch: 44, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.4530353546142578
Epoch: 45, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 46 cost time: 0.44919776916503906
Epoch: 46, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.172 Vali Acc: 0.949 Test Loss: 0.172 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 47 cost time: 0.44802284240722656
Epoch: 47, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 48 cost time: 0.4362185001373291
Epoch: 48, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.48966217041015625
Epoch: 49, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.180 Vali Acc: 0.949 Test Loss: 0.180 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.43851137161254883
Epoch: 50, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 22788
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8104355335235596
Epoch: 1, Steps: 9 | Train Loss: 1.450 Vali Loss: 1.376 Vali Acc: 0.391 Test Loss: 1.376 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 0.46987366676330566
Epoch: 2, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.291 Vali Acc: 0.464 Test Loss: 1.291 Test Acc: 0.464
Validation loss decreased (-0.391291 --> -0.463755).  Saving model ...
Epoch: 3 cost time: 0.5427563190460205
Epoch: 3, Steps: 9 | Train Loss: 1.195 Vali Loss: 1.171 Vali Acc: 0.551 Test Loss: 1.171 Test Acc: 0.551
Validation loss decreased (-0.463755 --> -0.550713).  Saving model ...
Epoch: 4 cost time: 0.5361440181732178
Epoch: 4, Steps: 9 | Train Loss: 1.040 Vali Loss: 1.054 Vali Acc: 0.667 Test Loss: 1.054 Test Acc: 0.667
Validation loss decreased (-0.550713 --> -0.666656).  Saving model ...
Epoch: 5 cost time: 0.5396409034729004
Epoch: 5, Steps: 9 | Train Loss: 0.887 Vali Loss: 0.942 Vali Acc: 0.717 Test Loss: 0.942 Test Acc: 0.717
Validation loss decreased (-0.666656 --> -0.717382).  Saving model ...
Epoch: 6 cost time: 0.4824554920196533
Epoch: 6, Steps: 9 | Train Loss: 0.755 Vali Loss: 0.840 Vali Acc: 0.761 Test Loss: 0.840 Test Acc: 0.761
Validation loss decreased (-0.717382 --> -0.760861).  Saving model ...
Epoch: 7 cost time: 0.49401426315307617
Epoch: 7, Steps: 9 | Train Loss: 0.628 Vali Loss: 0.739 Vali Acc: 0.819 Test Loss: 0.739 Test Acc: 0.819
Validation loss decreased (-0.760861 --> -0.818833).  Saving model ...
Epoch: 8 cost time: 0.5127294063568115
Epoch: 8, Steps: 9 | Train Loss: 0.507 Vali Loss: 0.644 Vali Acc: 0.855 Test Loss: 0.644 Test Acc: 0.855
Validation loss decreased (-0.818833 --> -0.855066).  Saving model ...
Epoch: 9 cost time: 0.4705939292907715
Epoch: 9, Steps: 9 | Train Loss: 0.429 Vali Loss: 0.570 Vali Acc: 0.884 Test Loss: 0.570 Test Acc: 0.884
Validation loss decreased (-0.855066 --> -0.884052).  Saving model ...
Epoch: 10 cost time: 0.4485297203063965
Epoch: 10, Steps: 9 | Train Loss: 0.338 Vali Loss: 0.512 Vali Acc: 0.891 Test Loss: 0.512 Test Acc: 0.891
Validation loss decreased (-0.884052 --> -0.891299).  Saving model ...
Epoch: 11 cost time: 0.5350124835968018
Epoch: 11, Steps: 9 | Train Loss: 0.278 Vali Loss: 0.465 Vali Acc: 0.891 Test Loss: 0.465 Test Acc: 0.891
Validation loss decreased (-0.891299 --> -0.891300).  Saving model ...
Epoch: 12 cost time: 0.44297289848327637
Epoch: 12, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.420 Vali Acc: 0.891 Test Loss: 0.420 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 13 cost time: 0.5193483829498291
Epoch: 13, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.395 Vali Acc: 0.891 Test Loss: 0.395 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 14 cost time: 0.5036773681640625
Epoch: 14, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.368 Vali Acc: 0.899 Test Loss: 0.368 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 15 cost time: 0.5004258155822754
Epoch: 15, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.353 Vali Acc: 0.899 Test Loss: 0.353 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 16 cost time: 0.5106337070465088
Epoch: 16, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.341 Vali Acc: 0.913 Test Loss: 0.341 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913040).  Saving model ...
Epoch: 17 cost time: 0.5808157920837402
Epoch: 17, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.316 Vali Acc: 0.920 Test Loss: 0.316 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 18 cost time: 0.518714189529419
Epoch: 18, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.308 Vali Acc: 0.920 Test Loss: 0.308 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 19 cost time: 0.49689626693725586
Epoch: 19, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.305 Vali Acc: 0.920 Test Loss: 0.305 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 20 cost time: 0.4670240879058838
Epoch: 20, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.300 Vali Acc: 0.920 Test Loss: 0.300 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 21 cost time: 0.483964204788208
Epoch: 21, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.284 Vali Acc: 0.928 Test Loss: 0.284 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927533).  Saving model ...
Epoch: 22 cost time: 0.5834109783172607
Epoch: 22, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.274 Vali Acc: 0.928 Test Loss: 0.274 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 23 cost time: 0.5260798931121826
Epoch: 23, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.264 Vali Acc: 0.928 Test Loss: 0.264 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927534).  Saving model ...
Epoch: 24 cost time: 0.5096185207366943
Epoch: 24, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.263 Vali Acc: 0.935 Test Loss: 0.263 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 25 cost time: 0.5832874774932861
Epoch: 25, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.255 Vali Acc: 0.928 Test Loss: 0.255 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5496804714202881
Epoch: 26, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.251 Vali Acc: 0.928 Test Loss: 0.251 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4720029830932617
Epoch: 27, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.246 Vali Acc: 0.928 Test Loss: 0.246 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.4686882495880127
Epoch: 28, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.242 Vali Acc: 0.935 Test Loss: 0.242 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 29 cost time: 0.5239443778991699
Epoch: 29, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.234 Vali Acc: 0.928 Test Loss: 0.234 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5450882911682129
Epoch: 30, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.4696834087371826
Epoch: 31, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.233 Vali Acc: 0.928 Test Loss: 0.233 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.4918503761291504
Epoch: 32, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.234 Vali Acc: 0.935 Test Loss: 0.234 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 33 cost time: 0.4692838191986084
Epoch: 33, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.226 Vali Acc: 0.935 Test Loss: 0.226 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 34 cost time: 0.4885365962982178
Epoch: 34, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.234 Vali Acc: 0.935 Test Loss: 0.234 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4852907657623291
Epoch: 35, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.228 Vali Acc: 0.935 Test Loss: 0.228 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5292642116546631
Epoch: 36, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.227 Vali Acc: 0.942 Test Loss: 0.227 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 37 cost time: 0.5150496959686279
Epoch: 37, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.220 Vali Acc: 0.935 Test Loss: 0.220 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.49268507957458496
Epoch: 38, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.218 Vali Acc: 0.935 Test Loss: 0.218 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5467653274536133
Epoch: 39, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5306994915008545
Epoch: 40, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.4999113082885742
Epoch: 41, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.216 Vali Acc: 0.928 Test Loss: 0.216 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.5642030239105225
Epoch: 42, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.223 Vali Acc: 0.928 Test Loss: 0.223 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.5881636142730713
Epoch: 43, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.214 Vali Acc: 0.935 Test Loss: 0.214 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.5234265327453613
Epoch: 44, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.5136013031005859
Epoch: 45, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.5261247158050537
Epoch: 46, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.212 Vali Acc: 0.942 Test Loss: 0.212 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 47 cost time: 0.5168125629425049
Epoch: 47, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.4867527484893799
Epoch: 48, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.204 Vali Acc: 0.935 Test Loss: 0.204 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5048561096191406
Epoch: 49, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.935 Test Loss: 0.200 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5204296112060547
Epoch: 50, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.201 Vali Acc: 0.949 Test Loss: 0.201 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949273).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 19492
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8093390464782715
Epoch: 1, Steps: 9 | Train Loss: 1.403 Vali Loss: 1.368 Vali Acc: 0.261 Test Loss: 1.368 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 0.48494601249694824
Epoch: 2, Steps: 9 | Train Loss: 1.335 Vali Loss: 1.300 Vali Acc: 0.355 Test Loss: 1.300 Test Acc: 0.355
Validation loss decreased (-0.260856 --> -0.355059).  Saving model ...
Epoch: 3 cost time: 0.590836763381958
Epoch: 3, Steps: 9 | Train Loss: 1.261 Vali Loss: 1.209 Vali Acc: 0.442 Test Loss: 1.209 Test Acc: 0.442
Validation loss decreased (-0.355059 --> -0.442017).  Saving model ...
Epoch: 4 cost time: 0.5066118240356445
Epoch: 4, Steps: 9 | Train Loss: 1.145 Vali Loss: 1.115 Vali Acc: 0.551 Test Loss: 1.115 Test Acc: 0.551
Validation loss decreased (-0.442017 --> -0.550713).  Saving model ...
Epoch: 5 cost time: 0.48647618293762207
Epoch: 5, Steps: 9 | Train Loss: 1.014 Vali Loss: 1.017 Vali Acc: 0.638 Test Loss: 1.017 Test Acc: 0.638
Validation loss decreased (-0.550713 --> -0.637671).  Saving model ...
Epoch: 6 cost time: 0.5045175552368164
Epoch: 6, Steps: 9 | Train Loss: 0.916 Vali Loss: 0.924 Vali Acc: 0.739 Test Loss: 0.924 Test Acc: 0.739
Validation loss decreased (-0.637671 --> -0.739121).  Saving model ...
Epoch: 7 cost time: 0.5034956932067871
Epoch: 7, Steps: 9 | Train Loss: 0.823 Vali Loss: 0.837 Vali Acc: 0.812 Test Loss: 0.837 Test Acc: 0.812
Validation loss decreased (-0.739121 --> -0.811586).  Saving model ...
Epoch: 8 cost time: 0.5988306999206543
Epoch: 8, Steps: 9 | Train Loss: 0.702 Vali Loss: 0.758 Vali Acc: 0.848 Test Loss: 0.758 Test Acc: 0.848
Validation loss decreased (-0.811586 --> -0.847819).  Saving model ...
Epoch: 9 cost time: 0.501915693283081
Epoch: 9, Steps: 9 | Train Loss: 0.618 Vali Loss: 0.684 Vali Acc: 0.877 Test Loss: 0.684 Test Acc: 0.877
Validation loss decreased (-0.847819 --> -0.876805).  Saving model ...
Epoch: 10 cost time: 0.49071526527404785
Epoch: 10, Steps: 9 | Train Loss: 0.531 Vali Loss: 0.611 Vali Acc: 0.891 Test Loss: 0.611 Test Acc: 0.891
Validation loss decreased (-0.876805 --> -0.891298).  Saving model ...
Epoch: 11 cost time: 0.4626882076263428
Epoch: 11, Steps: 9 | Train Loss: 0.458 Vali Loss: 0.550 Vali Acc: 0.884 Test Loss: 0.550 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4683210849761963
Epoch: 12, Steps: 9 | Train Loss: 0.400 Vali Loss: 0.512 Vali Acc: 0.899 Test Loss: 0.512 Test Acc: 0.899
Validation loss decreased (-0.891298 --> -0.898546).  Saving model ...
Epoch: 13 cost time: 0.4985072612762451
Epoch: 13, Steps: 9 | Train Loss: 0.337 Vali Loss: 0.468 Vali Acc: 0.899 Test Loss: 0.468 Test Acc: 0.899
Validation loss decreased (-0.898546 --> -0.898546).  Saving model ...
Epoch: 14 cost time: 0.4743340015411377
Epoch: 14, Steps: 9 | Train Loss: 0.283 Vali Loss: 0.436 Vali Acc: 0.899 Test Loss: 0.436 Test Acc: 0.899
Validation loss decreased (-0.898546 --> -0.898546).  Saving model ...
Epoch: 15 cost time: 0.49452710151672363
Epoch: 15, Steps: 9 | Train Loss: 0.248 Vali Loss: 0.404 Vali Acc: 0.906 Test Loss: 0.404 Test Acc: 0.906
Validation loss decreased (-0.898546 --> -0.905793).  Saving model ...
Epoch: 16 cost time: 0.5337250232696533
Epoch: 16, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.384 Vali Acc: 0.906 Test Loss: 0.384 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 17 cost time: 0.5504910945892334
Epoch: 17, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.357 Vali Acc: 0.920 Test Loss: 0.357 Test Acc: 0.920
Validation loss decreased (-0.905793 --> -0.920286).  Saving model ...
Epoch: 18 cost time: 0.4645707607269287
Epoch: 18, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.339 Vali Acc: 0.928 Test Loss: 0.339 Test Acc: 0.928
Validation loss decreased (-0.920286 --> -0.927533).  Saving model ...
Epoch: 19 cost time: 0.48058080673217773
Epoch: 19, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.331 Vali Acc: 0.928 Test Loss: 0.331 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 20 cost time: 0.48708176612854004
Epoch: 20, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.327 Vali Acc: 0.928 Test Loss: 0.327 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 21 cost time: 0.5255825519561768
Epoch: 21, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.313 Vali Acc: 0.920 Test Loss: 0.313 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5007369518280029
Epoch: 22, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.307 Vali Acc: 0.920 Test Loss: 0.307 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5157346725463867
Epoch: 23, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.290 Vali Acc: 0.928 Test Loss: 0.290 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 24 cost time: 0.5441076755523682
Epoch: 24, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.286 Vali Acc: 0.928 Test Loss: 0.286 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 25 cost time: 0.5844955444335938
Epoch: 25, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.279 Vali Acc: 0.920 Test Loss: 0.279 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5215120315551758
Epoch: 26, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.271 Vali Acc: 0.928 Test Loss: 0.271 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927534).  Saving model ...
Epoch: 27 cost time: 0.559279203414917
Epoch: 27, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.262 Vali Acc: 0.928 Test Loss: 0.262 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 28 cost time: 0.5407307147979736
Epoch: 28, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.254 Vali Acc: 0.928 Test Loss: 0.254 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 29 cost time: 0.5605049133300781
Epoch: 29, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.252 Vali Acc: 0.928 Test Loss: 0.252 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 30 cost time: 0.5689997673034668
Epoch: 30, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.244 Vali Acc: 0.928 Test Loss: 0.244 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 31 cost time: 0.5188229084014893
Epoch: 31, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.245 Vali Acc: 0.928 Test Loss: 0.245 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5573086738586426
Epoch: 32, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.240 Vali Acc: 0.928 Test Loss: 0.240 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 33 cost time: 0.5908401012420654
Epoch: 33, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.235 Vali Acc: 0.928 Test Loss: 0.235 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 34 cost time: 0.5992670059204102
Epoch: 34, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 35 cost time: 0.6302359104156494
Epoch: 35, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.222 Vali Acc: 0.928 Test Loss: 0.222 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 36 cost time: 0.5873525142669678
Epoch: 36, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.221 Vali Acc: 0.928 Test Loss: 0.221 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 37 cost time: 0.552985429763794
Epoch: 37, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.222 Vali Acc: 0.920 Test Loss: 0.222 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.565544843673706
Epoch: 38, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.221 Vali Acc: 0.920 Test Loss: 0.221 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5514781475067139
Epoch: 39, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.220 Vali Acc: 0.920 Test Loss: 0.220 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5667119026184082
Epoch: 40, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.218 Vali Acc: 0.920 Test Loss: 0.218 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.592322826385498
Epoch: 41, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.224 Vali Acc: 0.920 Test Loss: 0.224 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6245236396789551
Epoch: 42, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.219 Vali Acc: 0.920 Test Loss: 0.219 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.5984489917755127
Epoch: 43, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.220 Vali Acc: 0.920 Test Loss: 0.220 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.5770320892333984
Epoch: 44, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.216 Vali Acc: 0.920 Test Loss: 0.216 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.560316801071167
Epoch: 45, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.218 Vali Acc: 0.920 Test Loss: 0.218 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.5943002700805664
Epoch: 46, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.214 Vali Acc: 0.920 Test Loss: 0.214 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 16964
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9687590599060059
Epoch: 1, Steps: 9 | Train Loss: 1.360 Vali Loss: 1.309 Vali Acc: 0.333 Test Loss: 1.309 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.48360443115234375
Epoch: 2, Steps: 9 | Train Loss: 1.327 Vali Loss: 1.261 Vali Acc: 0.413 Test Loss: 1.261 Test Acc: 0.413
Validation loss decreased (-0.333320 --> -0.413031).  Saving model ...
Epoch: 3 cost time: 0.5008618831634521
Epoch: 3, Steps: 9 | Train Loss: 1.265 Vali Loss: 1.193 Vali Acc: 0.522 Test Loss: 1.193 Test Acc: 0.522
Validation loss decreased (-0.413031 --> -0.521727).  Saving model ...
Epoch: 4 cost time: 0.4763939380645752
Epoch: 4, Steps: 9 | Train Loss: 1.179 Vali Loss: 1.117 Vali Acc: 0.587 Test Loss: 1.117 Test Acc: 0.587
Validation loss decreased (-0.521727 --> -0.586945).  Saving model ...
Epoch: 5 cost time: 0.4863457679748535
Epoch: 5, Steps: 9 | Train Loss: 1.093 Vali Loss: 1.039 Vali Acc: 0.703 Test Loss: 1.039 Test Acc: 0.703
Validation loss decreased (-0.586945 --> -0.702888).  Saving model ...
Epoch: 6 cost time: 0.4782402515411377
Epoch: 6, Steps: 9 | Train Loss: 0.980 Vali Loss: 0.959 Vali Acc: 0.717 Test Loss: 0.959 Test Acc: 0.717
Validation loss decreased (-0.702888 --> -0.717382).  Saving model ...
Epoch: 7 cost time: 0.45603203773498535
Epoch: 7, Steps: 9 | Train Loss: 0.881 Vali Loss: 0.886 Vali Acc: 0.746 Test Loss: 0.886 Test Acc: 0.746
Validation loss decreased (-0.717382 --> -0.746368).  Saving model ...
Epoch: 8 cost time: 0.48464155197143555
Epoch: 8, Steps: 9 | Train Loss: 0.806 Vali Loss: 0.812 Vali Acc: 0.775 Test Loss: 0.812 Test Acc: 0.775
Validation loss decreased (-0.746368 --> -0.775354).  Saving model ...
Epoch: 9 cost time: 0.5106663703918457
Epoch: 9, Steps: 9 | Train Loss: 0.711 Vali Loss: 0.759 Vali Acc: 0.797 Test Loss: 0.759 Test Acc: 0.797
Validation loss decreased (-0.775354 --> -0.797094).  Saving model ...
Epoch: 10 cost time: 0.47159767150878906
Epoch: 10, Steps: 9 | Train Loss: 0.651 Vali Loss: 0.694 Vali Acc: 0.812 Test Loss: 0.694 Test Acc: 0.812
Validation loss decreased (-0.797094 --> -0.811587).  Saving model ...
Epoch: 11 cost time: 0.4934689998626709
Epoch: 11, Steps: 9 | Train Loss: 0.548 Vali Loss: 0.644 Vali Acc: 0.841 Test Loss: 0.644 Test Acc: 0.841
Validation loss decreased (-0.811587 --> -0.840573).  Saving model ...
Epoch: 12 cost time: 0.48490262031555176
Epoch: 12, Steps: 9 | Train Loss: 0.506 Vali Loss: 0.595 Vali Acc: 0.833 Test Loss: 0.595 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4683380126953125
Epoch: 13, Steps: 9 | Train Loss: 0.449 Vali Loss: 0.558 Vali Acc: 0.855 Test Loss: 0.558 Test Acc: 0.855
Validation loss decreased (-0.840573 --> -0.855067).  Saving model ...
Epoch: 14 cost time: 0.591522216796875
Epoch: 14, Steps: 9 | Train Loss: 0.406 Vali Loss: 0.522 Vali Acc: 0.870 Test Loss: 0.522 Test Acc: 0.870
Validation loss decreased (-0.855067 --> -0.869560).  Saving model ...
Epoch: 15 cost time: 0.5489931106567383
Epoch: 15, Steps: 9 | Train Loss: 0.363 Vali Loss: 0.491 Vali Acc: 0.877 Test Loss: 0.491 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876807).  Saving model ...
Epoch: 16 cost time: 0.5659530162811279
Epoch: 16, Steps: 9 | Train Loss: 0.325 Vali Loss: 0.452 Vali Acc: 0.891 Test Loss: 0.452 Test Acc: 0.891
Validation loss decreased (-0.876807 --> -0.891300).  Saving model ...
Epoch: 17 cost time: 0.4809243679046631
Epoch: 17, Steps: 9 | Train Loss: 0.311 Vali Loss: 0.434 Vali Acc: 0.899 Test Loss: 0.434 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898546).  Saving model ...
Epoch: 18 cost time: 0.4855477809906006
Epoch: 18, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.413 Vali Acc: 0.899 Test Loss: 0.413 Test Acc: 0.899
Validation loss decreased (-0.898546 --> -0.898547).  Saving model ...
Epoch: 19 cost time: 0.5611858367919922
Epoch: 19, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.400 Vali Acc: 0.899 Test Loss: 0.400 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 20 cost time: 0.5185158252716064
Epoch: 20, Steps: 9 | Train Loss: 0.228 Vali Loss: 0.382 Vali Acc: 0.906 Test Loss: 0.382 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 21 cost time: 0.5444505214691162
Epoch: 21, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.360 Vali Acc: 0.906 Test Loss: 0.360 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 22 cost time: 0.47534799575805664
Epoch: 22, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.348 Vali Acc: 0.906 Test Loss: 0.348 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905794).  Saving model ...
Epoch: 23 cost time: 0.4727804660797119
Epoch: 23, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.336 Vali Acc: 0.913 Test Loss: 0.336 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 24 cost time: 0.4505038261413574
Epoch: 24, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.322 Vali Acc: 0.920 Test Loss: 0.322 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 25 cost time: 0.49537038803100586
Epoch: 25, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.307 Vali Acc: 0.935 Test Loss: 0.307 Test Acc: 0.935
Validation loss decreased (-0.920287 --> -0.934780).  Saving model ...
Epoch: 26 cost time: 0.5760753154754639
Epoch: 26, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.302 Vali Acc: 0.920 Test Loss: 0.302 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5326793193817139
Epoch: 27, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.293 Vali Acc: 0.920 Test Loss: 0.293 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5213713645935059
Epoch: 28, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.289 Vali Acc: 0.920 Test Loss: 0.289 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.43384861946105957
Epoch: 29, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.280 Vali Acc: 0.920 Test Loss: 0.280 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5003452301025391
Epoch: 30, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.277 Vali Acc: 0.928 Test Loss: 0.277 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.49638795852661133
Epoch: 31, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.272 Vali Acc: 0.935 Test Loss: 0.272 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 32 cost time: 0.49988365173339844
Epoch: 32, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.269 Vali Acc: 0.942 Test Loss: 0.269 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942026).  Saving model ...
Epoch: 33 cost time: 0.5063025951385498
Epoch: 33, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.260 Vali Acc: 0.942 Test Loss: 0.260 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 34 cost time: 0.5080175399780273
Epoch: 34, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.252 Vali Acc: 0.942 Test Loss: 0.252 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 35 cost time: 0.4738283157348633
Epoch: 35, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.246 Vali Acc: 0.942 Test Loss: 0.246 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 36 cost time: 0.5004260540008545
Epoch: 36, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.240 Vali Acc: 0.942 Test Loss: 0.240 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 37 cost time: 0.49381375312805176
Epoch: 37, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.235 Vali Acc: 0.935 Test Loss: 0.235 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.4823763370513916
Epoch: 38, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.234 Vali Acc: 0.942 Test Loss: 0.234 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 39 cost time: 0.4783751964569092
Epoch: 39, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.236 Vali Acc: 0.942 Test Loss: 0.236 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.48780107498168945
Epoch: 40, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.231 Vali Acc: 0.942 Test Loss: 0.231 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 41 cost time: 0.5777976512908936
Epoch: 41, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.225 Vali Acc: 0.942 Test Loss: 0.225 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 42 cost time: 0.4890315532684326
Epoch: 42, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.221 Vali Acc: 0.942 Test Loss: 0.221 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 43 cost time: 0.5174825191497803
Epoch: 43, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.220 Vali Acc: 0.942 Test Loss: 0.220 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 44 cost time: 0.5369107723236084
Epoch: 44, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.215 Vali Acc: 0.942 Test Loss: 0.215 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 45 cost time: 0.5237629413604736
Epoch: 45, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.215 Vali Acc: 0.942 Test Loss: 0.215 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 46 cost time: 0.4901106357574463
Epoch: 46, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.214 Vali Acc: 0.942 Test Loss: 0.214 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 47 cost time: 0.4770379066467285
Epoch: 47, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.207 Vali Acc: 0.942 Test Loss: 0.207 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 48 cost time: 0.49622225761413574
Epoch: 48, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.209 Vali Acc: 0.942 Test Loss: 0.209 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.47092437744140625
Epoch: 49, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.210 Vali Acc: 0.942 Test Loss: 0.210 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.43078136444091797
Epoch: 50, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.203 Vali Acc: 0.942 Test Loss: 0.203 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 14980
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.722808599472046
Epoch: 1, Steps: 9 | Train Loss: 1.321 Vali Loss: 1.295 Vali Acc: 0.362 Test Loss: 1.295 Test Acc: 0.362
Validation loss decreased (inf --> -0.362306).  Saving model ...
Epoch: 2 cost time: 0.4801955223083496
Epoch: 2, Steps: 9 | Train Loss: 1.293 Vali Loss: 1.252 Vali Acc: 0.391 Test Loss: 1.252 Test Acc: 0.391
Validation loss decreased (-0.362306 --> -0.391292).  Saving model ...
Epoch: 3 cost time: 0.5117485523223877
Epoch: 3, Steps: 9 | Train Loss: 1.243 Vali Loss: 1.200 Vali Acc: 0.420 Test Loss: 1.200 Test Acc: 0.420
Validation loss decreased (-0.391292 --> -0.420278).  Saving model ...
Epoch: 4 cost time: 0.49465012550354004
Epoch: 4, Steps: 9 | Train Loss: 1.159 Vali Loss: 1.144 Vali Acc: 0.486 Test Loss: 1.144 Test Acc: 0.486
Validation loss decreased (-0.420278 --> -0.485496).  Saving model ...
Epoch: 5 cost time: 0.4835844039916992
Epoch: 5, Steps: 9 | Train Loss: 1.106 Vali Loss: 1.085 Vali Acc: 0.543 Test Loss: 1.085 Test Acc: 0.543
Validation loss decreased (-0.485496 --> -0.543467).  Saving model ...
Epoch: 6 cost time: 0.48015403747558594
Epoch: 6, Steps: 9 | Train Loss: 1.027 Vali Loss: 1.025 Vali Acc: 0.616 Test Loss: 1.025 Test Acc: 0.616
Validation loss decreased (-0.543467 --> -0.615932).  Saving model ...
Epoch: 7 cost time: 0.4445221424102783
Epoch: 7, Steps: 9 | Train Loss: 0.961 Vali Loss: 0.969 Vali Acc: 0.659 Test Loss: 0.969 Test Acc: 0.659
Validation loss decreased (-0.615932 --> -0.659411).  Saving model ...
Epoch: 8 cost time: 0.48832178115844727
Epoch: 8, Steps: 9 | Train Loss: 0.878 Vali Loss: 0.910 Vali Acc: 0.696 Test Loss: 0.910 Test Acc: 0.696
Validation loss decreased (-0.659411 --> -0.695643).  Saving model ...
Epoch: 9 cost time: 0.49574923515319824
Epoch: 9, Steps: 9 | Train Loss: 0.780 Vali Loss: 0.853 Vali Acc: 0.725 Test Loss: 0.853 Test Acc: 0.725
Validation loss decreased (-0.695643 --> -0.724629).  Saving model ...
Epoch: 10 cost time: 0.5121026039123535
Epoch: 10, Steps: 9 | Train Loss: 0.728 Vali Loss: 0.796 Vali Acc: 0.746 Test Loss: 0.796 Test Acc: 0.746
Validation loss decreased (-0.724629 --> -0.746369).  Saving model ...
Epoch: 11 cost time: 0.4751548767089844
Epoch: 11, Steps: 9 | Train Loss: 0.676 Vali Loss: 0.745 Vali Acc: 0.761 Test Loss: 0.745 Test Acc: 0.761
Validation loss decreased (-0.746369 --> -0.760862).  Saving model ...
Epoch: 12 cost time: 0.3673679828643799
Epoch: 12, Steps: 9 | Train Loss: 0.605 Vali Loss: 0.695 Vali Acc: 0.797 Test Loss: 0.695 Test Acc: 0.797
Validation loss decreased (-0.760862 --> -0.797094).  Saving model ...
Epoch: 13 cost time: 0.40660524368286133
Epoch: 13, Steps: 9 | Train Loss: 0.555 Vali Loss: 0.658 Vali Acc: 0.848 Test Loss: 0.658 Test Acc: 0.848
Validation loss decreased (-0.797094 --> -0.847820).  Saving model ...
Epoch: 14 cost time: 0.40459394454956055
Epoch: 14, Steps: 9 | Train Loss: 0.515 Vali Loss: 0.615 Vali Acc: 0.848 Test Loss: 0.615 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847820).  Saving model ...
Epoch: 15 cost time: 0.4276299476623535
Epoch: 15, Steps: 9 | Train Loss: 0.453 Vali Loss: 0.585 Vali Acc: 0.870 Test Loss: 0.585 Test Acc: 0.870
Validation loss decreased (-0.847820 --> -0.869559).  Saving model ...
Epoch: 16 cost time: 0.43871140480041504
Epoch: 16, Steps: 9 | Train Loss: 0.413 Vali Loss: 0.554 Vali Acc: 0.877 Test Loss: 0.554 Test Acc: 0.877
Validation loss decreased (-0.869559 --> -0.876806).  Saving model ...
Epoch: 17 cost time: 0.34771299362182617
Epoch: 17, Steps: 9 | Train Loss: 0.388 Vali Loss: 0.532 Vali Acc: 0.884 Test Loss: 0.532 Test Acc: 0.884
Validation loss decreased (-0.876806 --> -0.884053).  Saving model ...
Epoch: 18 cost time: 0.46096062660217285
Epoch: 18, Steps: 9 | Train Loss: 0.370 Vali Loss: 0.497 Vali Acc: 0.899 Test Loss: 0.497 Test Acc: 0.899
Validation loss decreased (-0.884053 --> -0.898546).  Saving model ...
Epoch: 19 cost time: 0.46721315383911133
Epoch: 19, Steps: 9 | Train Loss: 0.334 Vali Loss: 0.479 Vali Acc: 0.899 Test Loss: 0.479 Test Acc: 0.899
Validation loss decreased (-0.898546 --> -0.898546).  Saving model ...
Epoch: 20 cost time: 0.5305118560791016
Epoch: 20, Steps: 9 | Train Loss: 0.310 Vali Loss: 0.459 Vali Acc: 0.891 Test Loss: 0.459 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.47314906120300293
Epoch: 21, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.439 Vali Acc: 0.906 Test Loss: 0.439 Test Acc: 0.906
Validation loss decreased (-0.898546 --> -0.905793).  Saving model ...
Epoch: 22 cost time: 0.49019670486450195
Epoch: 22, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.419 Vali Acc: 0.906 Test Loss: 0.419 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 23 cost time: 0.49185895919799805
Epoch: 23, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.399 Vali Acc: 0.906 Test Loss: 0.399 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 24 cost time: 0.5192875862121582
Epoch: 24, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.390 Vali Acc: 0.906 Test Loss: 0.390 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 25 cost time: 0.4780848026275635
Epoch: 25, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.384 Vali Acc: 0.891 Test Loss: 0.384 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5660161972045898
Epoch: 26, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.375 Vali Acc: 0.891 Test Loss: 0.375 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4859185218811035
Epoch: 27, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.362 Vali Acc: 0.906 Test Loss: 0.362 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 28 cost time: 0.4773380756378174
Epoch: 28, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.353 Vali Acc: 0.906 Test Loss: 0.353 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905794).  Saving model ...
Epoch: 29 cost time: 0.5435030460357666
Epoch: 29, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.335 Vali Acc: 0.906 Test Loss: 0.335 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 30 cost time: 0.4857010841369629
Epoch: 30, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.316 Vali Acc: 0.906 Test Loss: 0.316 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 31 cost time: 0.4918498992919922
Epoch: 31, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.314 Vali Acc: 0.920 Test Loss: 0.314 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920287).  Saving model ...
Epoch: 32 cost time: 0.48931288719177246
Epoch: 32, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.306 Vali Acc: 0.920 Test Loss: 0.306 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 33 cost time: 0.4583854675292969
Epoch: 33, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.298 Vali Acc: 0.928 Test Loss: 0.298 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927533).  Saving model ...
Epoch: 34 cost time: 0.46805691719055176
Epoch: 34, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.297 Vali Acc: 0.920 Test Loss: 0.297 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5220897197723389
Epoch: 35, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.286 Vali Acc: 0.920 Test Loss: 0.286 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5407323837280273
Epoch: 36, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.285 Vali Acc: 0.920 Test Loss: 0.285 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.47188735008239746
Epoch: 37, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.280 Vali Acc: 0.920 Test Loss: 0.280 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5143110752105713
Epoch: 38, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.274 Vali Acc: 0.935 Test Loss: 0.274 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934780).  Saving model ...
Epoch: 39 cost time: 0.4645256996154785
Epoch: 39, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.266 Vali Acc: 0.935 Test Loss: 0.266 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 40 cost time: 0.44893741607666016
Epoch: 40, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.264 Vali Acc: 0.935 Test Loss: 0.264 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 41 cost time: 0.4684031009674072
Epoch: 41, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.258 Vali Acc: 0.935 Test Loss: 0.258 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 42 cost time: 0.49951887130737305
Epoch: 42, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.256 Vali Acc: 0.935 Test Loss: 0.256 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 43 cost time: 0.49932146072387695
Epoch: 43, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.255 Vali Acc: 0.935 Test Loss: 0.255 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 44 cost time: 0.5078973770141602
Epoch: 44, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.253 Vali Acc: 0.935 Test Loss: 0.253 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 45 cost time: 0.5448446273803711
Epoch: 45, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.241 Vali Acc: 0.935 Test Loss: 0.241 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 46 cost time: 0.4676380157470703
Epoch: 46, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.251 Vali Acc: 0.935 Test Loss: 0.251 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4778869152069092
Epoch: 47, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.244 Vali Acc: 0.935 Test Loss: 0.244 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.4866454601287842
Epoch: 48, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.238 Vali Acc: 0.935 Test Loss: 0.238 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 49 cost time: 0.5371289253234863
Epoch: 49, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.240 Vali Acc: 0.935 Test Loss: 0.240 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.4854896068572998
Epoch: 50, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.245 Vali Acc: 0.928 Test Loss: 0.245 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps42_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 14180
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.5859322547912598
Epoch: 1, Steps: 9 | Train Loss: 1.452 Vali Loss: 1.418 Vali Acc: 0.225 Test Loss: 1.418 Test Acc: 0.225
Validation loss decreased (inf --> -0.224623).  Saving model ...
Epoch: 2 cost time: 0.4848661422729492
Epoch: 2, Steps: 9 | Train Loss: 1.421 Vali Loss: 1.401 Vali Acc: 0.217 Test Loss: 1.401 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.47518181800842285
Epoch: 3, Steps: 9 | Train Loss: 1.357 Vali Loss: 1.365 Vali Acc: 0.225 Test Loss: 1.365 Test Acc: 0.225
Validation loss decreased (-0.224623 --> -0.224624).  Saving model ...
Epoch: 4 cost time: 0.4754464626312256
Epoch: 4, Steps: 9 | Train Loss: 1.300 Vali Loss: 1.317 Vali Acc: 0.290 Test Loss: 1.317 Test Acc: 0.290
Validation loss decreased (-0.224624 --> -0.289842).  Saving model ...
Epoch: 5 cost time: 0.5108537673950195
Epoch: 5, Steps: 9 | Train Loss: 1.227 Vali Loss: 1.264 Vali Acc: 0.326 Test Loss: 1.264 Test Acc: 0.326
Validation loss decreased (-0.289842 --> -0.326074).  Saving model ...
Epoch: 6 cost time: 0.52583909034729
Epoch: 6, Steps: 9 | Train Loss: 1.189 Vali Loss: 1.211 Vali Acc: 0.384 Test Loss: 1.211 Test Acc: 0.384
Validation loss decreased (-0.326074 --> -0.384046).  Saving model ...
Epoch: 7 cost time: 0.5406217575073242
Epoch: 7, Steps: 9 | Train Loss: 1.112 Vali Loss: 1.161 Vali Acc: 0.478 Test Loss: 1.161 Test Acc: 0.478
Validation loss decreased (-0.384046 --> -0.478249).  Saving model ...
Epoch: 8 cost time: 0.4804253578186035
Epoch: 8, Steps: 9 | Train Loss: 1.037 Vali Loss: 1.105 Vali Acc: 0.543 Test Loss: 1.105 Test Acc: 0.543
Validation loss decreased (-0.478249 --> -0.543467).  Saving model ...
Epoch: 9 cost time: 0.49614596366882324
Epoch: 9, Steps: 9 | Train Loss: 0.972 Vali Loss: 1.044 Vali Acc: 0.638 Test Loss: 1.044 Test Acc: 0.638
Validation loss decreased (-0.543467 --> -0.637671).  Saving model ...
Epoch: 10 cost time: 0.4949030876159668
Epoch: 10, Steps: 9 | Train Loss: 0.893 Vali Loss: 0.986 Vali Acc: 0.674 Test Loss: 0.986 Test Acc: 0.674
Validation loss decreased (-0.637671 --> -0.673903).  Saving model ...
Epoch: 11 cost time: 0.4781920909881592
Epoch: 11, Steps: 9 | Train Loss: 0.847 Vali Loss: 0.926 Vali Acc: 0.710 Test Loss: 0.926 Test Acc: 0.710
Validation loss decreased (-0.673903 --> -0.710136).  Saving model ...
Epoch: 12 cost time: 0.4882946014404297
Epoch: 12, Steps: 9 | Train Loss: 0.778 Vali Loss: 0.882 Vali Acc: 0.739 Test Loss: 0.882 Test Acc: 0.739
Validation loss decreased (-0.710136 --> -0.739122).  Saving model ...
Epoch: 13 cost time: 0.4543471336364746
Epoch: 13, Steps: 9 | Train Loss: 0.733 Vali Loss: 0.835 Vali Acc: 0.761 Test Loss: 0.835 Test Acc: 0.761
Validation loss decreased (-0.739122 --> -0.760861).  Saving model ...
Epoch: 14 cost time: 0.5475432872772217
Epoch: 14, Steps: 9 | Train Loss: 0.661 Vali Loss: 0.798 Vali Acc: 0.754 Test Loss: 0.798 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.49593520164489746
Epoch: 15, Steps: 9 | Train Loss: 0.600 Vali Loss: 0.759 Vali Acc: 0.797 Test Loss: 0.759 Test Acc: 0.797
Validation loss decreased (-0.760861 --> -0.797094).  Saving model ...
Epoch: 16 cost time: 0.4616708755493164
Epoch: 16, Steps: 9 | Train Loss: 0.575 Vali Loss: 0.725 Vali Acc: 0.833 Test Loss: 0.725 Test Acc: 0.833
Validation loss decreased (-0.797094 --> -0.833326).  Saving model ...
Epoch: 17 cost time: 0.5451335906982422
Epoch: 17, Steps: 9 | Train Loss: 0.537 Vali Loss: 0.704 Vali Acc: 0.841 Test Loss: 0.704 Test Acc: 0.841
Validation loss decreased (-0.833326 --> -0.840573).  Saving model ...
Epoch: 18 cost time: 0.4879574775695801
Epoch: 18, Steps: 9 | Train Loss: 0.508 Vali Loss: 0.666 Vali Acc: 0.855 Test Loss: 0.666 Test Acc: 0.855
Validation loss decreased (-0.840573 --> -0.855066).  Saving model ...
Epoch: 19 cost time: 0.5229578018188477
Epoch: 19, Steps: 9 | Train Loss: 0.446 Vali Loss: 0.632 Vali Acc: 0.855 Test Loss: 0.632 Test Acc: 0.855
Validation loss decreased (-0.855066 --> -0.855066).  Saving model ...
Epoch: 20 cost time: 0.5100228786468506
Epoch: 20, Steps: 9 | Train Loss: 0.400 Vali Loss: 0.602 Vali Acc: 0.870 Test Loss: 0.602 Test Acc: 0.870
Validation loss decreased (-0.855066 --> -0.869559).  Saving model ...
Epoch: 21 cost time: 0.4986996650695801
Epoch: 21, Steps: 9 | Train Loss: 0.407 Vali Loss: 0.576 Vali Acc: 0.870 Test Loss: 0.576 Test Acc: 0.870
Validation loss decreased (-0.869559 --> -0.869559).  Saving model ...
Epoch: 22 cost time: 0.5114109516143799
Epoch: 22, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.567 Vali Acc: 0.891 Test Loss: 0.567 Test Acc: 0.891
Validation loss decreased (-0.869559 --> -0.891299).  Saving model ...
Epoch: 23 cost time: 0.5195596218109131
Epoch: 23, Steps: 9 | Train Loss: 0.335 Vali Loss: 0.551 Vali Acc: 0.891 Test Loss: 0.551 Test Acc: 0.891
Validation loss decreased (-0.891299 --> -0.891299).  Saving model ...
Epoch: 24 cost time: 0.4901883602142334
Epoch: 24, Steps: 9 | Train Loss: 0.322 Vali Loss: 0.521 Vali Acc: 0.884 Test Loss: 0.521 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5252029895782471
Epoch: 25, Steps: 9 | Train Loss: 0.295 Vali Loss: 0.509 Vali Acc: 0.906 Test Loss: 0.509 Test Acc: 0.906
Validation loss decreased (-0.891299 --> -0.905792).  Saving model ...
Epoch: 26 cost time: 0.5341343879699707
Epoch: 26, Steps: 9 | Train Loss: 0.287 Vali Loss: 0.479 Vali Acc: 0.906 Test Loss: 0.479 Test Acc: 0.906
Validation loss decreased (-0.905792 --> -0.905792).  Saving model ...
Epoch: 27 cost time: 0.48820042610168457
Epoch: 27, Steps: 9 | Train Loss: 0.265 Vali Loss: 0.456 Vali Acc: 0.906 Test Loss: 0.456 Test Acc: 0.906
Validation loss decreased (-0.905792 --> -0.905793).  Saving model ...
Epoch: 28 cost time: 0.5285606384277344
Epoch: 28, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.444 Vali Acc: 0.913 Test Loss: 0.444 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913039).  Saving model ...
Epoch: 29 cost time: 0.5214138031005859
Epoch: 29, Steps: 9 | Train Loss: 0.227 Vali Loss: 0.431 Vali Acc: 0.913 Test Loss: 0.431 Test Acc: 0.913
Validation loss decreased (-0.913039 --> -0.913039).  Saving model ...
Epoch: 30 cost time: 0.48340535163879395
Epoch: 30, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.428 Vali Acc: 0.920 Test Loss: 0.428 Test Acc: 0.920
Validation loss decreased (-0.913039 --> -0.920286).  Saving model ...
Epoch: 31 cost time: 0.5039975643157959
Epoch: 31, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.414 Vali Acc: 0.920 Test Loss: 0.414 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 32 cost time: 0.5036125183105469
Epoch: 32, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.406 Vali Acc: 0.928 Test Loss: 0.406 Test Acc: 0.928
Validation loss decreased (-0.920286 --> -0.927532).  Saving model ...
Epoch: 33 cost time: 0.48482823371887207
Epoch: 33, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.391 Vali Acc: 0.920 Test Loss: 0.391 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.45479369163513184
Epoch: 34, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.377 Vali Acc: 0.920 Test Loss: 0.377 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5355501174926758
Epoch: 35, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.373 Vali Acc: 0.928 Test Loss: 0.373 Test Acc: 0.928
Validation loss decreased (-0.927532 --> -0.927532).  Saving model ...
Epoch: 36 cost time: 0.5562264919281006
Epoch: 36, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.369 Vali Acc: 0.935 Test Loss: 0.369 Test Acc: 0.935
Validation loss decreased (-0.927532 --> -0.934779).  Saving model ...
Epoch: 37 cost time: 0.5042934417724609
Epoch: 37, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.364 Vali Acc: 0.935 Test Loss: 0.364 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934779).  Saving model ...
Epoch: 38 cost time: 0.49585771560668945
Epoch: 38, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.350 Vali Acc: 0.935 Test Loss: 0.350 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934779).  Saving model ...
Epoch: 39 cost time: 0.4897308349609375
Epoch: 39, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.349 Vali Acc: 0.935 Test Loss: 0.349 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934779).  Saving model ...
Epoch: 40 cost time: 0.5134148597717285
Epoch: 40, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.346 Vali Acc: 0.928 Test Loss: 0.346 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5311450958251953
Epoch: 41, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.335 Vali Acc: 0.935 Test Loss: 0.335 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934779).  Saving model ...
Epoch: 42 cost time: 0.4969174861907959
Epoch: 42, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.326 Vali Acc: 0.935 Test Loss: 0.326 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934779).  Saving model ...
Epoch: 43 cost time: 0.5123445987701416
Epoch: 43, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.330 Vali Acc: 0.935 Test Loss: 0.330 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5149827003479004
Epoch: 44, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.321 Vali Acc: 0.935 Test Loss: 0.321 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934779).  Saving model ...
Epoch: 45 cost time: 0.5328741073608398
Epoch: 45, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.316 Vali Acc: 0.935 Test Loss: 0.316 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934779).  Saving model ...
Epoch: 46 cost time: 0.5579519271850586
Epoch: 46, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.315 Vali Acc: 0.928 Test Loss: 0.315 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5058228969573975
Epoch: 47, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.297 Vali Acc: 0.935 Test Loss: 0.297 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934780).  Saving model ...
Epoch: 48 cost time: 0.5172469615936279
Epoch: 48, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.283 Vali Acc: 0.928 Test Loss: 0.283 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.47749948501586914
Epoch: 49, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.296 Vali Acc: 0.928 Test Loss: 0.296 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.5565249919891357
Epoch: 50, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.292 Vali Acc: 0.935 Test Loss: 0.292 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_ModernTCN_UEA_ftM_sl206_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps52_str26_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 13732
model size : 0.07MB
