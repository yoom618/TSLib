Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.639974355697632
Epoch: 1, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.691 Vali Acc: 0.550 Test Loss: 0.691 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 3.5423238277435303
Epoch: 2, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.789 Vali Acc: 0.530 Test Loss: 0.789 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.120715141296387
Epoch: 3, Steps: 20 | Train Loss: 0.603 Vali Loss: 1.086 Vali Acc: 0.500 Test Loss: 1.086 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.66193151473999
Epoch: 4, Steps: 20 | Train Loss: 0.661 Vali Loss: 1.035 Vali Acc: 0.500 Test Loss: 1.035 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.998238563537598
Epoch: 5, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.902 Vali Acc: 0.540 Test Loss: 0.902 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.859036922454834
Epoch: 6, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.850 Vali Acc: 0.550 Test Loss: 0.850 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.791682958602905
Epoch: 7, Steps: 20 | Train Loss: 0.399 Vali Loss: 1.028 Vali Acc: 0.540 Test Loss: 1.028 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.638648271560669
Epoch: 8, Steps: 20 | Train Loss: 0.375 Vali Loss: 1.089 Vali Acc: 0.510 Test Loss: 1.089 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.8121116161346436
Epoch: 9, Steps: 20 | Train Loss: 0.276 Vali Loss: 1.351 Vali Acc: 0.520 Test Loss: 1.351 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.808393716812134
Epoch: 10, Steps: 20 | Train Loss: 0.220 Vali Loss: 1.059 Vali Acc: 0.590 Test Loss: 1.059 Test Acc: 0.590
Validation loss decreased (-0.549993 --> -0.589989).  Saving model ...
Epoch: 11 cost time: 4.146905422210693
Epoch: 11, Steps: 20 | Train Loss: 0.148 Vali Loss: 1.423 Vali Acc: 0.510 Test Loss: 1.423 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.317326307296753
Epoch: 12, Steps: 20 | Train Loss: 0.120 Vali Loss: 1.608 Vali Acc: 0.510 Test Loss: 1.608 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.904478311538696
Epoch: 13, Steps: 20 | Train Loss: 0.107 Vali Loss: 1.741 Vali Acc: 0.500 Test Loss: 1.741 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.755984783172607
Epoch: 14, Steps: 20 | Train Loss: 0.071 Vali Loss: 1.921 Vali Acc: 0.550 Test Loss: 1.921 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.974892854690552
Epoch: 15, Steps: 20 | Train Loss: 0.066 Vali Loss: 2.216 Vali Acc: 0.490 Test Loss: 2.216 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.602898836135864
Epoch: 16, Steps: 20 | Train Loss: 0.047 Vali Loss: 1.998 Vali Acc: 0.530 Test Loss: 1.998 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.637738227844238
Epoch: 17, Steps: 20 | Train Loss: 0.049 Vali Loss: 2.686 Vali Acc: 0.530 Test Loss: 2.686 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.3101911544799805
Epoch: 18, Steps: 20 | Train Loss: 0.047 Vali Loss: 2.541 Vali Acc: 0.510 Test Loss: 2.541 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.710956573486328
Epoch: 19, Steps: 20 | Train Loss: 0.013 Vali Loss: 2.855 Vali Acc: 0.510 Test Loss: 2.855 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.870594024658203
Epoch: 20, Steps: 20 | Train Loss: 0.004 Vali Loss: 2.880 Vali Acc: 0.520 Test Loss: 2.880 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 6537186
model size : 25.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.8534910678863525
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 4.11873459815979
Epoch: 2, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.758 Vali Acc: 0.510 Test Loss: 0.758 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 4.021850824356079
Epoch: 3, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.742 Vali Acc: 0.510 Test Loss: 0.742 Test Acc: 0.510
Validation loss decreased (-0.509992 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 4.013189792633057
Epoch: 4, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.802 Vali Acc: 0.460 Test Loss: 0.802 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.095402240753174
Epoch: 5, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.829 Vali Acc: 0.500 Test Loss: 0.829 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.065377473831177
Epoch: 6, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.857 Vali Acc: 0.530 Test Loss: 0.857 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529991).  Saving model ...
Epoch: 7 cost time: 4.130934476852417
Epoch: 7, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.906 Vali Acc: 0.520 Test Loss: 0.906 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.087918281555176
Epoch: 8, Steps: 20 | Train Loss: 0.381 Vali Loss: 0.935 Vali Acc: 0.510 Test Loss: 0.935 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.1652750968933105
Epoch: 9, Steps: 20 | Train Loss: 0.313 Vali Loss: 0.968 Vali Acc: 0.520 Test Loss: 0.968 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.139237403869629
Epoch: 10, Steps: 20 | Train Loss: 0.220 Vali Loss: 1.050 Vali Acc: 0.520 Test Loss: 1.050 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.930900812149048
Epoch: 11, Steps: 20 | Train Loss: 0.196 Vali Loss: 1.178 Vali Acc: 0.490 Test Loss: 1.178 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.659508228302002
Epoch: 12, Steps: 20 | Train Loss: 0.144 Vali Loss: 1.719 Vali Acc: 0.590 Test Loss: 1.719 Test Acc: 0.590
Validation loss decreased (-0.529991 --> -0.589983).  Saving model ...
Epoch: 13 cost time: 3.126591444015503
Epoch: 13, Steps: 20 | Train Loss: 0.120 Vali Loss: 1.349 Vali Acc: 0.590 Test Loss: 1.349 Test Acc: 0.590
Validation loss decreased (-0.589983 --> -0.589987).  Saving model ...
Epoch: 14 cost time: 3.064060688018799
Epoch: 14, Steps: 20 | Train Loss: 0.107 Vali Loss: 1.351 Vali Acc: 0.610 Test Loss: 1.351 Test Acc: 0.610
Validation loss decreased (-0.589987 --> -0.609986).  Saving model ...
Epoch: 15 cost time: 3.898047685623169
Epoch: 15, Steps: 20 | Train Loss: 0.086 Vali Loss: 1.547 Vali Acc: 0.570 Test Loss: 1.547 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.5207276344299316
Epoch: 16, Steps: 20 | Train Loss: 0.077 Vali Loss: 2.096 Vali Acc: 0.520 Test Loss: 2.096 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.9765729904174805
Epoch: 17, Steps: 20 | Train Loss: 0.043 Vali Loss: 2.176 Vali Acc: 0.510 Test Loss: 2.176 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.1200902462005615
Epoch: 18, Steps: 20 | Train Loss: 0.018 Vali Loss: 1.863 Vali Acc: 0.550 Test Loss: 1.863 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.201554775238037
Epoch: 19, Steps: 20 | Train Loss: 0.005 Vali Loss: 1.895 Vali Acc: 0.550 Test Loss: 1.895 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.8751587867736816
Epoch: 20, Steps: 20 | Train Loss: 0.002 Vali Loss: 1.867 Vali Acc: 0.560 Test Loss: 1.867 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.137364149093628
Epoch: 21, Steps: 20 | Train Loss: 0.002 Vali Loss: 1.904 Vali Acc: 0.550 Test Loss: 1.904 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.867433786392212
Epoch: 22, Steps: 20 | Train Loss: 0.001 Vali Loss: 2.016 Vali Acc: 0.540 Test Loss: 2.016 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.178248405456543
Epoch: 23, Steps: 20 | Train Loss: 0.001 Vali Loss: 2.002 Vali Acc: 0.520 Test Loss: 2.002 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.044330358505249
Epoch: 24, Steps: 20 | Train Loss: 0.001 Vali Loss: 1.963 Vali Acc: 0.550 Test Loss: 1.963 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 6494210
model size : 24.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.961270570755005
Epoch: 1, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.738 Vali Acc: 0.440 Test Loss: 0.738 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 3.7908902168273926
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.836 Vali Acc: 0.510 Test Loss: 0.836 Test Acc: 0.510
Validation loss decreased (-0.439993 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 3.9912123680114746
Epoch: 3, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.797 Vali Acc: 0.480 Test Loss: 0.797 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.036570072174072
Epoch: 4, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.870 Vali Acc: 0.460 Test Loss: 0.870 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.943612575531006
Epoch: 5, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.886 Vali Acc: 0.460 Test Loss: 0.886 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.117230176925659
Epoch: 6, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.950 Vali Acc: 0.520 Test Loss: 0.950 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519991).  Saving model ...
Epoch: 7 cost time: 3.7739269733428955
Epoch: 7, Steps: 20 | Train Loss: 0.421 Vali Loss: 0.964 Vali Acc: 0.510 Test Loss: 0.964 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.904911518096924
Epoch: 8, Steps: 20 | Train Loss: 0.354 Vali Loss: 0.986 Vali Acc: 0.530 Test Loss: 0.986 Test Acc: 0.530
Validation loss decreased (-0.519991 --> -0.529990).  Saving model ...
Epoch: 9 cost time: 3.3756155967712402
Epoch: 9, Steps: 20 | Train Loss: 0.261 Vali Loss: 0.904 Vali Acc: 0.550 Test Loss: 0.904 Test Acc: 0.550
Validation loss decreased (-0.529990 --> -0.549991).  Saving model ...
Epoch: 10 cost time: 3.8634395599365234
Epoch: 10, Steps: 20 | Train Loss: 0.225 Vali Loss: 1.021 Vali Acc: 0.530 Test Loss: 1.021 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.762094736099243
Epoch: 11, Steps: 20 | Train Loss: 0.187 Vali Loss: 1.290 Vali Acc: 0.490 Test Loss: 1.290 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.8739535808563232
Epoch: 12, Steps: 20 | Train Loss: 0.106 Vali Loss: 1.364 Vali Acc: 0.500 Test Loss: 1.364 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.7685158252716064
Epoch: 13, Steps: 20 | Train Loss: 0.068 Vali Loss: 1.530 Vali Acc: 0.520 Test Loss: 1.530 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.6828253269195557
Epoch: 14, Steps: 20 | Train Loss: 0.030 Vali Loss: 1.597 Vali Acc: 0.540 Test Loss: 1.597 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.931972026824951
Epoch: 15, Steps: 20 | Train Loss: 0.021 Vali Loss: 1.585 Vali Acc: 0.530 Test Loss: 1.585 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.107626438140869
Epoch: 16, Steps: 20 | Train Loss: 0.015 Vali Loss: 1.732 Vali Acc: 0.550 Test Loss: 1.732 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.9741899967193604
Epoch: 17, Steps: 20 | Train Loss: 0.010 Vali Loss: 1.711 Vali Acc: 0.520 Test Loss: 1.711 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.020830869674683
Epoch: 18, Steps: 20 | Train Loss: 0.005 Vali Loss: 1.711 Vali Acc: 0.520 Test Loss: 1.711 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.123292922973633
Epoch: 19, Steps: 20 | Train Loss: 0.003 Vali Loss: 1.696 Vali Acc: 0.510 Test Loss: 1.696 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 6494242
model size : 24.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.901418209075928
Epoch: 1, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.706 Vali Acc: 0.540 Test Loss: 0.706 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 3.968050479888916
Epoch: 2, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.764 Vali Acc: 0.560 Test Loss: 0.764 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559992).  Saving model ...
Epoch: 3 cost time: 3.801499605178833
Epoch: 3, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.864 Vali Acc: 0.480 Test Loss: 0.864 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.825622320175171
Epoch: 4, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.826 Vali Acc: 0.490 Test Loss: 0.826 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.992091417312622
Epoch: 5, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.937 Vali Acc: 0.490 Test Loss: 0.937 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.828643321990967
Epoch: 6, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.825 Vali Acc: 0.550 Test Loss: 0.825 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.5611324310302734
Epoch: 7, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.776 Vali Acc: 0.610 Test Loss: 0.776 Test Acc: 0.610
Validation loss decreased (-0.559992 --> -0.609992).  Saving model ...
Epoch: 8 cost time: 3.0103025436401367
Epoch: 8, Steps: 20 | Train Loss: 0.403 Vali Loss: 1.051 Vali Acc: 0.550 Test Loss: 1.051 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6250455379486084
Epoch: 9, Steps: 20 | Train Loss: 0.348 Vali Loss: 0.912 Vali Acc: 0.540 Test Loss: 0.912 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.411877155303955
Epoch: 10, Steps: 20 | Train Loss: 0.241 Vali Loss: 1.006 Vali Acc: 0.560 Test Loss: 1.006 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.3453238010406494
Epoch: 11, Steps: 20 | Train Loss: 0.174 Vali Loss: 0.986 Vali Acc: 0.530 Test Loss: 0.986 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.016812801361084
Epoch: 12, Steps: 20 | Train Loss: 0.125 Vali Loss: 1.206 Vali Acc: 0.600 Test Loss: 1.206 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.759848117828369
Epoch: 13, Steps: 20 | Train Loss: 0.074 Vali Loss: 1.247 Vali Acc: 0.530 Test Loss: 1.247 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.6067111492156982
Epoch: 14, Steps: 20 | Train Loss: 0.041 Vali Loss: 1.485 Vali Acc: 0.550 Test Loss: 1.485 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.553272008895874
Epoch: 15, Steps: 20 | Train Loss: 0.019 Vali Loss: 1.578 Vali Acc: 0.530 Test Loss: 1.578 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.341691017150879
Epoch: 16, Steps: 20 | Train Loss: 0.012 Vali Loss: 1.617 Vali Acc: 0.550 Test Loss: 1.617 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.828751802444458
Epoch: 17, Steps: 20 | Train Loss: 0.008 Vali Loss: 1.644 Vali Acc: 0.540 Test Loss: 1.644 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 6472770
model size : 24.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.038936614990234
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 3.733175039291382
Epoch: 2, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.731 Vali Acc: 0.480 Test Loss: 0.731 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8246853351593018
Epoch: 3, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.786 Vali Acc: 0.550 Test Loss: 0.786 Test Acc: 0.550
Validation loss decreased (-0.499993 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 3.5975911617279053
Epoch: 4, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.799 Vali Acc: 0.490 Test Loss: 0.799 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.816326856613159
Epoch: 5, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.803 Vali Acc: 0.520 Test Loss: 0.803 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.59087872505188
Epoch: 6, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.807 Vali Acc: 0.470 Test Loss: 0.807 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.759289503097534
Epoch: 7, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.842 Vali Acc: 0.530 Test Loss: 0.842 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.365307331085205
Epoch: 8, Steps: 20 | Train Loss: 0.397 Vali Loss: 0.887 Vali Acc: 0.540 Test Loss: 0.887 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.5799379348754883
Epoch: 9, Steps: 20 | Train Loss: 0.328 Vali Loss: 0.860 Vali Acc: 0.550 Test Loss: 0.860 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.5663650035858154
Epoch: 10, Steps: 20 | Train Loss: 0.276 Vali Loss: 0.962 Vali Acc: 0.500 Test Loss: 0.962 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.08069372177124
Epoch: 11, Steps: 20 | Train Loss: 0.219 Vali Loss: 1.060 Vali Acc: 0.540 Test Loss: 1.060 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.4451558589935303
Epoch: 12, Steps: 20 | Train Loss: 0.179 Vali Loss: 0.988 Vali Acc: 0.610 Test Loss: 0.988 Test Acc: 0.610
Validation loss decreased (-0.549992 --> -0.609990).  Saving model ...
Epoch: 13 cost time: 3.391538619995117
Epoch: 13, Steps: 20 | Train Loss: 0.099 Vali Loss: 1.232 Vali Acc: 0.560 Test Loss: 1.232 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.610011577606201
Epoch: 14, Steps: 20 | Train Loss: 0.065 Vali Loss: 1.224 Vali Acc: 0.530 Test Loss: 1.224 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.6985368728637695
Epoch: 15, Steps: 20 | Train Loss: 0.027 Vali Loss: 1.448 Vali Acc: 0.570 Test Loss: 1.448 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.9971938133239746
Epoch: 16, Steps: 20 | Train Loss: 0.015 Vali Loss: 1.349 Vali Acc: 0.530 Test Loss: 1.349 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.7987992763519287
Epoch: 17, Steps: 20 | Train Loss: 0.011 Vali Loss: 1.487 Vali Acc: 0.530 Test Loss: 1.487 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.56528639793396
Epoch: 18, Steps: 20 | Train Loss: 0.010 Vali Loss: 1.571 Vali Acc: 0.530 Test Loss: 1.571 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.171201467514038
Epoch: 19, Steps: 20 | Train Loss: 0.008 Vali Loss: 1.597 Vali Acc: 0.580 Test Loss: 1.597 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.2294859886169434
Epoch: 20, Steps: 20 | Train Loss: 0.003 Vali Loss: 1.646 Vali Acc: 0.570 Test Loss: 1.646 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.2634570598602295
Epoch: 21, Steps: 20 | Train Loss: 0.004 Vali Loss: 1.668 Vali Acc: 0.540 Test Loss: 1.668 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.4470534324645996
Epoch: 22, Steps: 20 | Train Loss: 0.002 Vali Loss: 1.715 Vali Acc: 0.570 Test Loss: 1.715 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 6465698
model size : 24.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.505768060684204
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.700 Vali Acc: 0.510 Test Loss: 0.700 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 3.6192102432250977
Epoch: 2, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.750 Vali Acc: 0.500 Test Loss: 0.750 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.679319381713867
Epoch: 3, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.768 Vali Acc: 0.520 Test Loss: 0.768 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 3.6737570762634277
Epoch: 4, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.815 Vali Acc: 0.490 Test Loss: 0.815 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.539597511291504
Epoch: 5, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.801 Vali Acc: 0.480 Test Loss: 0.801 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.659454345703125
Epoch: 6, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.771 Vali Acc: 0.510 Test Loss: 0.771 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.8399465084075928
Epoch: 7, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.855 Vali Acc: 0.550 Test Loss: 0.855 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549991).  Saving model ...
Epoch: 8 cost time: 3.5300190448760986
Epoch: 8, Steps: 20 | Train Loss: 0.410 Vali Loss: 0.761 Vali Acc: 0.580 Test Loss: 0.761 Test Acc: 0.580
Validation loss decreased (-0.549991 --> -0.579992).  Saving model ...
Epoch: 9 cost time: 3.735663890838623
Epoch: 9, Steps: 20 | Train Loss: 0.354 Vali Loss: 0.809 Vali Acc: 0.550 Test Loss: 0.809 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9742305278778076
Epoch: 10, Steps: 20 | Train Loss: 0.285 Vali Loss: 0.890 Vali Acc: 0.540 Test Loss: 0.890 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.979283571243286
Epoch: 11, Steps: 20 | Train Loss: 0.215 Vali Loss: 0.966 Vali Acc: 0.570 Test Loss: 0.966 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.0657596588134766
Epoch: 12, Steps: 20 | Train Loss: 0.183 Vali Loss: 0.996 Vali Acc: 0.570 Test Loss: 0.996 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.1170718669891357
Epoch: 13, Steps: 20 | Train Loss: 0.095 Vali Loss: 1.138 Vali Acc: 0.530 Test Loss: 1.138 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.761704921722412
Epoch: 14, Steps: 20 | Train Loss: 0.060 Vali Loss: 1.206 Vali Acc: 0.530 Test Loss: 1.206 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.5271756649017334
Epoch: 15, Steps: 20 | Train Loss: 0.035 Vali Loss: 1.586 Vali Acc: 0.510 Test Loss: 1.586 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.3614501953125
Epoch: 16, Steps: 20 | Train Loss: 0.027 Vali Loss: 1.337 Vali Acc: 0.510 Test Loss: 1.337 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.6557252407073975
Epoch: 17, Steps: 20 | Train Loss: 0.013 Vali Loss: 1.410 Vali Acc: 0.530 Test Loss: 1.410 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.8301937580108643
Epoch: 18, Steps: 20 | Train Loss: 0.008 Vali Loss: 1.607 Vali Acc: 0.570 Test Loss: 1.607 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 6465762
model size : 24.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.423243284225464
Epoch: 1, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.706 Vali Acc: 0.510 Test Loss: 0.706 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 3.692244291305542
Epoch: 2, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.736 Vali Acc: 0.510 Test Loss: 0.736 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4233295917510986
Epoch: 3, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.740 Vali Acc: 0.510 Test Loss: 0.740 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.3123137950897217
Epoch: 4, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.782 Vali Acc: 0.520 Test Loss: 0.782 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 3.738430976867676
Epoch: 5, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.814 Vali Acc: 0.540 Test Loss: 0.814 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539992).  Saving model ...
Epoch: 6 cost time: 3.2012999057769775
Epoch: 6, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.854 Vali Acc: 0.520 Test Loss: 0.854 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5922608375549316
Epoch: 7, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.761 Vali Acc: 0.530 Test Loss: 0.761 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.6301069259643555
Epoch: 8, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.812 Vali Acc: 0.520 Test Loss: 0.812 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.2774860858917236
Epoch: 9, Steps: 20 | Train Loss: 0.432 Vali Loss: 0.835 Vali Acc: 0.520 Test Loss: 0.835 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.245032787322998
Epoch: 10, Steps: 20 | Train Loss: 0.345 Vali Loss: 0.882 Vali Acc: 0.540 Test Loss: 0.882 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.915158748626709
Epoch: 11, Steps: 20 | Train Loss: 0.297 Vali Loss: 0.886 Vali Acc: 0.510 Test Loss: 0.886 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.2314534187316895
Epoch: 12, Steps: 20 | Train Loss: 0.206 Vali Loss: 0.855 Vali Acc: 0.570 Test Loss: 0.855 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569991).  Saving model ...
Epoch: 13 cost time: 3.2613437175750732
Epoch: 13, Steps: 20 | Train Loss: 0.122 Vali Loss: 1.042 Vali Acc: 0.500 Test Loss: 1.042 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.731454849243164
Epoch: 14, Steps: 20 | Train Loss: 0.068 Vali Loss: 1.234 Vali Acc: 0.510 Test Loss: 1.234 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.627340793609619
Epoch: 15, Steps: 20 | Train Loss: 0.074 Vali Loss: 1.825 Vali Acc: 0.560 Test Loss: 1.825 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.2793991565704346
Epoch: 16, Steps: 20 | Train Loss: 0.042 Vali Loss: 1.648 Vali Acc: 0.560 Test Loss: 1.648 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.6722068786621094
Epoch: 17, Steps: 20 | Train Loss: 0.031 Vali Loss: 1.625 Vali Acc: 0.600 Test Loss: 1.625 Test Acc: 0.600
Validation loss decreased (-0.569991 --> -0.599984).  Saving model ...
Epoch: 18 cost time: 3.3561182022094727
Epoch: 18, Steps: 20 | Train Loss: 0.015 Vali Loss: 1.823 Vali Acc: 0.550 Test Loss: 1.823 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.4018678665161133
Epoch: 19, Steps: 20 | Train Loss: 0.017 Vali Loss: 1.875 Vali Acc: 0.540 Test Loss: 1.875 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.372962236404419
Epoch: 20, Steps: 20 | Train Loss: 0.020 Vali Loss: 2.120 Vali Acc: 0.540 Test Loss: 2.120 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.2148923873901367
Epoch: 21, Steps: 20 | Train Loss: 0.016 Vali Loss: 2.165 Vali Acc: 0.580 Test Loss: 2.165 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.467261791229248
Epoch: 22, Steps: 20 | Train Loss: 0.020 Vali Loss: 1.941 Vali Acc: 0.570 Test Loss: 1.941 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.483811378479004
Epoch: 23, Steps: 20 | Train Loss: 0.024 Vali Loss: 1.874 Vali Acc: 0.570 Test Loss: 1.874 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.9559574127197266
Epoch: 24, Steps: 20 | Train Loss: 0.030 Vali Loss: 2.233 Vali Acc: 0.560 Test Loss: 2.233 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.863685131072998
Epoch: 25, Steps: 20 | Train Loss: 0.080 Vali Loss: 2.126 Vali Acc: 0.530 Test Loss: 2.126 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.662752389907837
Epoch: 26, Steps: 20 | Train Loss: 0.064 Vali Loss: 2.817 Vali Acc: 0.530 Test Loss: 2.817 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.9080581665039062
Epoch: 27, Steps: 20 | Train Loss: 0.086 Vali Loss: 2.478 Vali Acc: 0.530 Test Loss: 2.478 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 6458690
model size : 24.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.9633519649505615
Epoch: 1, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.701 Vali Acc: 0.540 Test Loss: 0.701 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 4.183300018310547
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.852 Vali Acc: 0.520 Test Loss: 0.852 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.969367504119873
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.896 Vali Acc: 0.500 Test Loss: 0.896 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.114591360092163
Epoch: 4, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.821 Vali Acc: 0.510 Test Loss: 0.821 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.937230110168457
Epoch: 5, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.777 Vali Acc: 0.520 Test Loss: 0.777 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.157788038253784
Epoch: 6, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.758 Vali Acc: 0.570 Test Loss: 0.758 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569992).  Saving model ...
Epoch: 7 cost time: 4.440324783325195
Epoch: 7, Steps: 20 | Train Loss: 0.386 Vali Loss: 1.144 Vali Acc: 0.540 Test Loss: 1.144 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.3826000690460205
Epoch: 8, Steps: 20 | Train Loss: 0.380 Vali Loss: 1.010 Vali Acc: 0.560 Test Loss: 1.010 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.414941310882568
Epoch: 9, Steps: 20 | Train Loss: 0.319 Vali Loss: 1.096 Vali Acc: 0.480 Test Loss: 1.096 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.275422811508179
Epoch: 10, Steps: 20 | Train Loss: 0.197 Vali Loss: 1.205 Vali Acc: 0.550 Test Loss: 1.205 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.413466453552246
Epoch: 11, Steps: 20 | Train Loss: 0.189 Vali Loss: 1.399 Vali Acc: 0.560 Test Loss: 1.399 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.9559645652770996
Epoch: 12, Steps: 20 | Train Loss: 0.128 Vali Loss: 1.425 Vali Acc: 0.540 Test Loss: 1.425 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.944460391998291
Epoch: 13, Steps: 20 | Train Loss: 0.069 Vali Loss: 1.754 Vali Acc: 0.570 Test Loss: 1.754 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.6248133182525635
Epoch: 14, Steps: 20 | Train Loss: 0.085 Vali Loss: 2.084 Vali Acc: 0.480 Test Loss: 2.084 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.439557075500488
Epoch: 15, Steps: 20 | Train Loss: 0.066 Vali Loss: 1.723 Vali Acc: 0.580 Test Loss: 1.723 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579983).  Saving model ...
Epoch: 16 cost time: 3.970691680908203
Epoch: 16, Steps: 20 | Train Loss: 0.016 Vali Loss: 1.924 Vali Acc: 0.490 Test Loss: 1.924 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.240679025650024
Epoch: 17, Steps: 20 | Train Loss: 0.024 Vali Loss: 2.240 Vali Acc: 0.530 Test Loss: 2.240 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.40811824798584
Epoch: 18, Steps: 20 | Train Loss: 0.020 Vali Loss: 2.280 Vali Acc: 0.560 Test Loss: 2.280 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.9896419048309326
Epoch: 19, Steps: 20 | Train Loss: 0.016 Vali Loss: 3.387 Vali Acc: 0.520 Test Loss: 3.387 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.548914670944214
Epoch: 20, Steps: 20 | Train Loss: 0.030 Vali Loss: 2.568 Vali Acc: 0.520 Test Loss: 2.568 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.3263731002807617
Epoch: 21, Steps: 20 | Train Loss: 0.032 Vali Loss: 3.401 Vali Acc: 0.510 Test Loss: 3.401 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.697937488555908
Epoch: 22, Steps: 20 | Train Loss: 0.061 Vali Loss: 3.218 Vali Acc: 0.500 Test Loss: 3.218 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.069642782211304
Epoch: 23, Steps: 20 | Train Loss: 0.044 Vali Loss: 2.942 Vali Acc: 0.590 Test Loss: 2.942 Test Acc: 0.590
Validation loss decreased (-0.579983 --> -0.589971).  Saving model ...
Epoch: 24 cost time: 4.127273082733154
Epoch: 24, Steps: 20 | Train Loss: 0.026 Vali Loss: 3.290 Vali Acc: 0.520 Test Loss: 3.290 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.826892137527466
Epoch: 25, Steps: 20 | Train Loss: 0.036 Vali Loss: 3.368 Vali Acc: 0.490 Test Loss: 3.368 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.327509880065918
Epoch: 26, Steps: 20 | Train Loss: 0.054 Vali Loss: 3.362 Vali Acc: 0.570 Test Loss: 3.362 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.1940531730651855
Epoch: 27, Steps: 20 | Train Loss: 0.082 Vali Loss: 4.368 Vali Acc: 0.500 Test Loss: 4.368 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.3420798778533936
Epoch: 28, Steps: 20 | Train Loss: 0.087 Vali Loss: 4.123 Vali Acc: 0.510 Test Loss: 4.123 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.9616801738739014
Epoch: 29, Steps: 20 | Train Loss: 0.135 Vali Loss: 6.410 Vali Acc: 0.480 Test Loss: 6.410 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.958672523498535
Epoch: 30, Steps: 20 | Train Loss: 0.215 Vali Loss: 4.295 Vali Acc: 0.530 Test Loss: 4.295 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.189573049545288
Epoch: 31, Steps: 20 | Train Loss: 0.157 Vali Loss: 4.936 Vali Acc: 0.510 Test Loss: 4.936 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 4.305421590805054
Epoch: 32, Steps: 20 | Train Loss: 0.117 Vali Loss: 4.907 Vali Acc: 0.500 Test Loss: 4.907 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 4.204696416854858
Epoch: 33, Steps: 20 | Train Loss: 0.092 Vali Loss: 4.624 Vali Acc: 0.530 Test Loss: 4.624 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 6512098
model size : 24.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.976181745529175
Epoch: 1, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.731 Vali Acc: 0.460 Test Loss: 0.731 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 3.8227438926696777
Epoch: 2, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.763 Vali Acc: 0.540 Test Loss: 0.763 Test Acc: 0.540
Validation loss decreased (-0.459993 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 3.859931468963623
Epoch: 3, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.771 Vali Acc: 0.480 Test Loss: 0.771 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.5802338123321533
Epoch: 4, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.709 Vali Acc: 0.600 Test Loss: 0.709 Test Acc: 0.600
Validation loss decreased (-0.539992 --> -0.599993).  Saving model ...
Epoch: 5 cost time: 3.5891215801239014
Epoch: 5, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.779 Vali Acc: 0.530 Test Loss: 0.779 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.970010280609131
Epoch: 6, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.873 Vali Acc: 0.510 Test Loss: 0.873 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.3563499450683594
Epoch: 7, Steps: 20 | Train Loss: 0.421 Vali Loss: 1.172 Vali Acc: 0.480 Test Loss: 1.172 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.9811999797821045
Epoch: 8, Steps: 20 | Train Loss: 0.379 Vali Loss: 0.949 Vali Acc: 0.480 Test Loss: 0.949 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.378554344177246
Epoch: 9, Steps: 20 | Train Loss: 0.305 Vali Loss: 0.998 Vali Acc: 0.550 Test Loss: 0.998 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.5792126655578613
Epoch: 10, Steps: 20 | Train Loss: 0.217 Vali Loss: 1.057 Vali Acc: 0.500 Test Loss: 1.057 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.320662260055542
Epoch: 11, Steps: 20 | Train Loss: 0.154 Vali Loss: 1.239 Vali Acc: 0.550 Test Loss: 1.239 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.1708996295928955
Epoch: 12, Steps: 20 | Train Loss: 0.178 Vali Loss: 1.257 Vali Acc: 0.520 Test Loss: 1.257 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.463194847106934
Epoch: 13, Steps: 20 | Train Loss: 0.125 Vali Loss: 1.351 Vali Acc: 0.560 Test Loss: 1.351 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.39816427230835
Epoch: 14, Steps: 20 | Train Loss: 0.050 Vali Loss: 1.707 Vali Acc: 0.550 Test Loss: 1.707 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 6469122
model size : 24.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.907749652862549
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.699 Vali Acc: 0.510 Test Loss: 0.699 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 3.6000494956970215
Epoch: 2, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.781 Vali Acc: 0.500 Test Loss: 0.781 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5386223793029785
Epoch: 3, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.990 Vali Acc: 0.490 Test Loss: 0.990 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.925070285797119
Epoch: 4, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.787 Vali Acc: 0.500 Test Loss: 0.787 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.5656442642211914
Epoch: 5, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.795 Vali Acc: 0.570 Test Loss: 0.795 Test Acc: 0.570
Validation loss decreased (-0.509993 --> -0.569992).  Saving model ...
Epoch: 6 cost time: 4.200366020202637
Epoch: 6, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.851 Vali Acc: 0.560 Test Loss: 0.851 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.229923963546753
Epoch: 7, Steps: 20 | Train Loss: 0.392 Vali Loss: 0.754 Vali Acc: 0.560 Test Loss: 0.754 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.374062538146973
Epoch: 8, Steps: 20 | Train Loss: 0.324 Vali Loss: 0.921 Vali Acc: 0.510 Test Loss: 0.921 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.347525358200073
Epoch: 9, Steps: 20 | Train Loss: 0.279 Vali Loss: 1.080 Vali Acc: 0.590 Test Loss: 1.080 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589989).  Saving model ...
Epoch: 10 cost time: 4.301518440246582
Epoch: 10, Steps: 20 | Train Loss: 0.179 Vali Loss: 1.204 Vali Acc: 0.500 Test Loss: 1.204 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.16704797744751
Epoch: 11, Steps: 20 | Train Loss: 0.143 Vali Loss: 1.271 Vali Acc: 0.570 Test Loss: 1.271 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.386501312255859
Epoch: 12, Steps: 20 | Train Loss: 0.068 Vali Loss: 1.242 Vali Acc: 0.540 Test Loss: 1.242 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.0341174602508545
Epoch: 13, Steps: 20 | Train Loss: 0.081 Vali Loss: 1.523 Vali Acc: 0.510 Test Loss: 1.523 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.8676199913024902
Epoch: 14, Steps: 20 | Train Loss: 0.042 Vali Loss: 1.645 Vali Acc: 0.580 Test Loss: 1.645 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.0923075675964355
Epoch: 15, Steps: 20 | Train Loss: 0.025 Vali Loss: 1.538 Vali Acc: 0.540 Test Loss: 1.538 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.819967269897461
Epoch: 16, Steps: 20 | Train Loss: 0.018 Vali Loss: 1.729 Vali Acc: 0.520 Test Loss: 1.729 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.447220087051392
Epoch: 17, Steps: 20 | Train Loss: 0.013 Vali Loss: 1.999 Vali Acc: 0.560 Test Loss: 1.999 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.216840982437134
Epoch: 18, Steps: 20 | Train Loss: 0.007 Vali Loss: 1.866 Vali Acc: 0.530 Test Loss: 1.866 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.7370638847351074
Epoch: 19, Steps: 20 | Train Loss: 0.008 Vali Loss: 1.989 Vali Acc: 0.530 Test Loss: 1.989 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 6469154
model size : 24.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.229343414306641
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.712 Vali Acc: 0.550 Test Loss: 0.712 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 3.8929624557495117
Epoch: 2, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.762 Vali Acc: 0.440 Test Loss: 0.762 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8576648235321045
Epoch: 3, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.745 Vali Acc: 0.540 Test Loss: 0.745 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.659243106842041
Epoch: 4, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.839 Vali Acc: 0.530 Test Loss: 0.839 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.8965156078338623
Epoch: 5, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.824 Vali Acc: 0.550 Test Loss: 0.824 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.98340106010437
Epoch: 6, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.854 Vali Acc: 0.510 Test Loss: 0.854 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.181636571884155
Epoch: 7, Steps: 20 | Train Loss: 0.422 Vali Loss: 0.791 Vali Acc: 0.590 Test Loss: 0.791 Test Acc: 0.590
Validation loss decreased (-0.549993 --> -0.589992).  Saving model ...
Epoch: 8 cost time: 4.160837411880493
Epoch: 8, Steps: 20 | Train Loss: 0.351 Vali Loss: 0.872 Vali Acc: 0.520 Test Loss: 0.872 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.192025184631348
Epoch: 9, Steps: 20 | Train Loss: 0.298 Vali Loss: 1.020 Vali Acc: 0.490 Test Loss: 1.020 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.716688394546509
Epoch: 10, Steps: 20 | Train Loss: 0.218 Vali Loss: 1.076 Vali Acc: 0.530 Test Loss: 1.076 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.460935354232788
Epoch: 11, Steps: 20 | Train Loss: 0.205 Vali Loss: 1.227 Vali Acc: 0.530 Test Loss: 1.227 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.503967523574829
Epoch: 12, Steps: 20 | Train Loss: 0.123 Vali Loss: 1.152 Vali Acc: 0.540 Test Loss: 1.152 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.089866638183594
Epoch: 13, Steps: 20 | Train Loss: 0.066 Vali Loss: 1.292 Vali Acc: 0.500 Test Loss: 1.292 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.3142731189727783
Epoch: 14, Steps: 20 | Train Loss: 0.033 Vali Loss: 1.286 Vali Acc: 0.510 Test Loss: 1.286 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.8907227516174316
Epoch: 15, Steps: 20 | Train Loss: 0.019 Vali Loss: 1.561 Vali Acc: 0.500 Test Loss: 1.561 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.758162260055542
Epoch: 16, Steps: 20 | Train Loss: 0.010 Vali Loss: 1.600 Vali Acc: 0.490 Test Loss: 1.600 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.3128819465637207
Epoch: 17, Steps: 20 | Train Loss: 0.007 Vali Loss: 1.575 Vali Acc: 0.490 Test Loss: 1.575 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 6447682
model size : 24.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.873210668563843
Epoch: 1, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.728 Vali Acc: 0.470 Test Loss: 0.728 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 4.024716138839722
Epoch: 2, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.705 Vali Acc: 0.540 Test Loss: 0.705 Test Acc: 0.540
Validation loss decreased (-0.469993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 3.5692903995513916
Epoch: 3, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.787 Vali Acc: 0.480 Test Loss: 0.787 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.54803466796875
Epoch: 4, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.752 Vali Acc: 0.480 Test Loss: 0.752 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.472465753555298
Epoch: 5, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.763 Vali Acc: 0.540 Test Loss: 0.763 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.2611818313598633
Epoch: 6, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.766 Vali Acc: 0.520 Test Loss: 0.766 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.7275962829589844
Epoch: 7, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.782 Vali Acc: 0.530 Test Loss: 0.782 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.8088884353637695
Epoch: 8, Steps: 20 | Train Loss: 0.388 Vali Loss: 0.835 Vali Acc: 0.540 Test Loss: 0.835 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.7846078872680664
Epoch: 9, Steps: 20 | Train Loss: 0.340 Vali Loss: 0.892 Vali Acc: 0.520 Test Loss: 0.892 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.6317710876464844
Epoch: 10, Steps: 20 | Train Loss: 0.324 Vali Loss: 0.855 Vali Acc: 0.560 Test Loss: 0.855 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559991).  Saving model ...
Epoch: 11 cost time: 3.841968536376953
Epoch: 11, Steps: 20 | Train Loss: 0.202 Vali Loss: 0.899 Vali Acc: 0.510 Test Loss: 0.899 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.50358247756958
Epoch: 12, Steps: 20 | Train Loss: 0.138 Vali Loss: 1.165 Vali Acc: 0.620 Test Loss: 1.165 Test Acc: 0.620
Validation loss decreased (-0.559991 --> -0.619988).  Saving model ...
Epoch: 13 cost time: 3.8756470680236816
Epoch: 13, Steps: 20 | Train Loss: 0.091 Vali Loss: 1.025 Vali Acc: 0.540 Test Loss: 1.025 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.8099565505981445
Epoch: 14, Steps: 20 | Train Loss: 0.066 Vali Loss: 1.276 Vali Acc: 0.540 Test Loss: 1.276 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.8305983543395996
Epoch: 15, Steps: 20 | Train Loss: 0.074 Vali Loss: 1.202 Vali Acc: 0.600 Test Loss: 1.202 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.7123944759368896
Epoch: 16, Steps: 20 | Train Loss: 0.030 Vali Loss: 1.448 Vali Acc: 0.550 Test Loss: 1.448 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.0243730545043945
Epoch: 17, Steps: 20 | Train Loss: 0.036 Vali Loss: 1.560 Vali Acc: 0.580 Test Loss: 1.560 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.140789270401001
Epoch: 18, Steps: 20 | Train Loss: 0.019 Vali Loss: 1.629 Vali Acc: 0.540 Test Loss: 1.629 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.1661736965179443
Epoch: 19, Steps: 20 | Train Loss: 0.020 Vali Loss: 1.815 Vali Acc: 0.540 Test Loss: 1.815 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.1568472385406494
Epoch: 20, Steps: 20 | Train Loss: 0.016 Vali Loss: 1.665 Vali Acc: 0.580 Test Loss: 1.665 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.972336769104004
Epoch: 21, Steps: 20 | Train Loss: 0.027 Vali Loss: 1.718 Vali Acc: 0.520 Test Loss: 1.718 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.6697843074798584
Epoch: 22, Steps: 20 | Train Loss: 0.029 Vali Loss: 2.353 Vali Acc: 0.530 Test Loss: 2.353 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 6440610
model size : 24.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.219507455825806
Epoch: 1, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 3.9461019039154053
Epoch: 2, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.742 Vali Acc: 0.510 Test Loss: 0.742 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 3.8883581161499023
Epoch: 3, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.777 Vali Acc: 0.520 Test Loss: 0.777 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 3.9277477264404297
Epoch: 4, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.806 Vali Acc: 0.520 Test Loss: 0.806 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.866889238357544
Epoch: 5, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.828 Vali Acc: 0.520 Test Loss: 0.828 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.7897706031799316
Epoch: 6, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.901 Vali Acc: 0.470 Test Loss: 0.901 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.050131320953369
Epoch: 7, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.825 Vali Acc: 0.530 Test Loss: 0.825 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 8 cost time: 3.3390228748321533
Epoch: 8, Steps: 20 | Train Loss: 0.422 Vali Loss: 0.792 Vali Acc: 0.520 Test Loss: 0.792 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.28133225440979
Epoch: 9, Steps: 20 | Train Loss: 0.363 Vali Loss: 0.831 Vali Acc: 0.530 Test Loss: 0.831 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.4541923999786377
Epoch: 10, Steps: 20 | Train Loss: 0.308 Vali Loss: 0.812 Vali Acc: 0.540 Test Loss: 0.812 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 11 cost time: 2.986801862716675
Epoch: 11, Steps: 20 | Train Loss: 0.209 Vali Loss: 1.022 Vali Acc: 0.520 Test Loss: 1.022 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.163801670074463
Epoch: 12, Steps: 20 | Train Loss: 0.128 Vali Loss: 1.033 Vali Acc: 0.550 Test Loss: 1.033 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549990).  Saving model ...
Epoch: 13 cost time: 3.2596399784088135
Epoch: 13, Steps: 20 | Train Loss: 0.091 Vali Loss: 1.344 Vali Acc: 0.480 Test Loss: 1.344 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.9328315258026123
Epoch: 14, Steps: 20 | Train Loss: 0.087 Vali Loss: 1.380 Vali Acc: 0.550 Test Loss: 1.380 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.6769566535949707
Epoch: 15, Steps: 20 | Train Loss: 0.038 Vali Loss: 1.351 Vali Acc: 0.570 Test Loss: 1.351 Test Acc: 0.570
Validation loss decreased (-0.549990 --> -0.569986).  Saving model ...
Epoch: 16 cost time: 3.34173583984375
Epoch: 16, Steps: 20 | Train Loss: 0.025 Vali Loss: 1.434 Vali Acc: 0.520 Test Loss: 1.434 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.2058281898498535
Epoch: 17, Steps: 20 | Train Loss: 0.013 Vali Loss: 1.488 Vali Acc: 0.550 Test Loss: 1.488 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.491225004196167
Epoch: 18, Steps: 20 | Train Loss: 0.008 Vali Loss: 1.511 Vali Acc: 0.530 Test Loss: 1.511 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.374049663543701
Epoch: 19, Steps: 20 | Train Loss: 0.008 Vali Loss: 1.691 Vali Acc: 0.530 Test Loss: 1.691 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.917452812194824
Epoch: 20, Steps: 20 | Train Loss: 0.005 Vali Loss: 1.643 Vali Acc: 0.530 Test Loss: 1.643 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.2922239303588867
Epoch: 21, Steps: 20 | Train Loss: 0.004 Vali Loss: 1.644 Vali Acc: 0.570 Test Loss: 1.644 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.2144293785095215
Epoch: 22, Steps: 20 | Train Loss: 0.008 Vali Loss: 1.770 Vali Acc: 0.590 Test Loss: 1.770 Test Acc: 0.590
Validation loss decreased (-0.569986 --> -0.589982).  Saving model ...
Epoch: 23 cost time: 4.104146957397461
Epoch: 23, Steps: 20 | Train Loss: 0.018 Vali Loss: 2.246 Vali Acc: 0.580 Test Loss: 2.246 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.869152784347534
Epoch: 24, Steps: 20 | Train Loss: 0.070 Vali Loss: 2.099 Vali Acc: 0.600 Test Loss: 2.099 Test Acc: 0.600
Validation loss decreased (-0.589982 --> -0.599979).  Saving model ...
Epoch: 25 cost time: 3.897655963897705
Epoch: 25, Steps: 20 | Train Loss: 0.181 Vali Loss: 2.254 Vali Acc: 0.560 Test Loss: 2.254 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.340254545211792
Epoch: 26, Steps: 20 | Train Loss: 0.149 Vali Loss: 2.218 Vali Acc: 0.510 Test Loss: 2.218 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.231651782989502
Epoch: 27, Steps: 20 | Train Loss: 0.116 Vali Loss: 2.068 Vali Acc: 0.560 Test Loss: 2.068 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.583202838897705
Epoch: 28, Steps: 20 | Train Loss: 0.137 Vali Loss: 2.825 Vali Acc: 0.560 Test Loss: 2.825 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.5794825553894043
Epoch: 29, Steps: 20 | Train Loss: 0.027 Vali Loss: 2.688 Vali Acc: 0.580 Test Loss: 2.688 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.830739736557007
Epoch: 30, Steps: 20 | Train Loss: 0.048 Vali Loss: 2.544 Vali Acc: 0.520 Test Loss: 2.544 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.756117343902588
Epoch: 31, Steps: 20 | Train Loss: 0.034 Vali Loss: 2.454 Vali Acc: 0.500 Test Loss: 2.454 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.9487481117248535
Epoch: 32, Steps: 20 | Train Loss: 0.005 Vali Loss: 2.412 Vali Acc: 0.510 Test Loss: 2.412 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.676112174987793
Epoch: 33, Steps: 20 | Train Loss: 0.016 Vali Loss: 2.439 Vali Acc: 0.490 Test Loss: 2.439 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.8433568477630615
Epoch: 34, Steps: 20 | Train Loss: 0.009 Vali Loss: 2.506 Vali Acc: 0.530 Test Loss: 2.506 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 6440674
model size : 24.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8566181659698486
Epoch: 1, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.709 Vali Acc: 0.480 Test Loss: 0.709 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.767087936401367
Epoch: 2, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.743 Vali Acc: 0.480 Test Loss: 0.743 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8238003253936768
Epoch: 3, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.746 Vali Acc: 0.550 Test Loss: 0.746 Test Acc: 0.550
Validation loss decreased (-0.479993 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 3.4517602920532227
Epoch: 4, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.784 Vali Acc: 0.480 Test Loss: 0.784 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1418497562408447
Epoch: 5, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.796 Vali Acc: 0.560 Test Loss: 0.796 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 6 cost time: 3.145230770111084
Epoch: 6, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.825 Vali Acc: 0.510 Test Loss: 0.825 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.093798875808716
Epoch: 7, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.827 Vali Acc: 0.500 Test Loss: 0.827 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.5272860527038574
Epoch: 8, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.889 Vali Acc: 0.490 Test Loss: 0.889 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.0833940505981445
Epoch: 9, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.788 Vali Acc: 0.500 Test Loss: 0.788 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.7024106979370117
Epoch: 10, Steps: 20 | Train Loss: 0.320 Vali Loss: 0.880 Vali Acc: 0.510 Test Loss: 0.880 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.212543487548828
Epoch: 11, Steps: 20 | Train Loss: 0.264 Vali Loss: 0.902 Vali Acc: 0.550 Test Loss: 0.902 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.317566394805908
Epoch: 12, Steps: 20 | Train Loss: 0.196 Vali Loss: 1.106 Vali Acc: 0.530 Test Loss: 1.106 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.3204259872436523
Epoch: 13, Steps: 20 | Train Loss: 0.121 Vali Loss: 1.152 Vali Acc: 0.530 Test Loss: 1.152 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.464956521987915
Epoch: 14, Steps: 20 | Train Loss: 0.089 Vali Loss: 1.325 Vali Acc: 0.580 Test Loss: 1.325 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579987).  Saving model ...
Epoch: 15 cost time: 3.5734786987304688
Epoch: 15, Steps: 20 | Train Loss: 0.072 Vali Loss: 1.428 Vali Acc: 0.550 Test Loss: 1.428 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7546563148498535
Epoch: 16, Steps: 20 | Train Loss: 0.069 Vali Loss: 1.461 Vali Acc: 0.510 Test Loss: 1.461 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.1932601928710938
Epoch: 17, Steps: 20 | Train Loss: 0.032 Vali Loss: 1.685 Vali Acc: 0.520 Test Loss: 1.685 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.0866737365722656
Epoch: 18, Steps: 20 | Train Loss: 0.031 Vali Loss: 1.943 Vali Acc: 0.530 Test Loss: 1.943 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.172414779663086
Epoch: 19, Steps: 20 | Train Loss: 0.009 Vali Loss: 1.783 Vali Acc: 0.520 Test Loss: 1.783 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.3719232082366943
Epoch: 20, Steps: 20 | Train Loss: 0.004 Vali Loss: 1.818 Vali Acc: 0.520 Test Loss: 1.818 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.021702289581299
Epoch: 21, Steps: 20 | Train Loss: 0.003 Vali Loss: 1.768 Vali Acc: 0.560 Test Loss: 1.768 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.9677441120147705
Epoch: 22, Steps: 20 | Train Loss: 0.004 Vali Loss: 1.791 Vali Acc: 0.560 Test Loss: 1.791 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.0299763679504395
Epoch: 23, Steps: 20 | Train Loss: 0.002 Vali Loss: 1.911 Vali Acc: 0.540 Test Loss: 1.911 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.260349988937378
Epoch: 24, Steps: 20 | Train Loss: 0.001 Vali Loss: 2.057 Vali Acc: 0.530 Test Loss: 2.057 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 6433602
model size : 24.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.338003158569336
Epoch: 1, Steps: 20 | Train Loss: 0.775 Vali Loss: 0.898 Vali Acc: 0.470 Test Loss: 0.898 Test Acc: 0.470
Validation loss decreased (inf --> -0.469991).  Saving model ...
Epoch: 2 cost time: 7.136369466781616
Epoch: 2, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.797 Vali Acc: 0.620 Test Loss: 0.797 Test Acc: 0.620
Validation loss decreased (-0.469991 --> -0.619992).  Saving model ...
Epoch: 3 cost time: 7.157602071762085
Epoch: 3, Steps: 20 | Train Loss: 0.745 Vali Loss: 1.152 Vali Acc: 0.490 Test Loss: 1.152 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.598550796508789
Epoch: 4, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.900 Vali Acc: 0.580 Test Loss: 0.900 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.381746292114258
Epoch: 5, Steps: 20 | Train Loss: 0.641 Vali Loss: 1.027 Vali Acc: 0.520 Test Loss: 1.027 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.071824789047241
Epoch: 6, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.909 Vali Acc: 0.620 Test Loss: 0.909 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.274158716201782
Epoch: 7, Steps: 20 | Train Loss: 0.465 Vali Loss: 1.082 Vali Acc: 0.550 Test Loss: 1.082 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.759296417236328
Epoch: 8, Steps: 20 | Train Loss: 0.517 Vali Loss: 2.034 Vali Acc: 0.510 Test Loss: 2.034 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.732830286026001
Epoch: 9, Steps: 20 | Train Loss: 0.496 Vali Loss: 2.068 Vali Acc: 0.480 Test Loss: 2.068 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 8.074638843536377
Epoch: 10, Steps: 20 | Train Loss: 0.535 Vali Loss: 1.324 Vali Acc: 0.560 Test Loss: 1.324 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.298402547836304
Epoch: 11, Steps: 20 | Train Loss: 0.248 Vali Loss: 1.798 Vali Acc: 0.530 Test Loss: 1.798 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.708456754684448
Epoch: 12, Steps: 20 | Train Loss: 0.363 Vali Loss: 2.446 Vali Acc: 0.560 Test Loss: 2.446 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 21528450
model size : 82.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.789540767669678
Epoch: 1, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.817 Vali Acc: 0.460 Test Loss: 0.817 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 5.649535894393921
Epoch: 2, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.759 Vali Acc: 0.600 Test Loss: 0.759 Test Acc: 0.600
Validation loss decreased (-0.459992 --> -0.599992).  Saving model ...
Epoch: 3 cost time: 5.819450616836548
Epoch: 3, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.947 Vali Acc: 0.490 Test Loss: 0.947 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.464254856109619
Epoch: 4, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.984 Vali Acc: 0.510 Test Loss: 0.984 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.480956077575684
Epoch: 5, Steps: 20 | Train Loss: 0.524 Vali Loss: 1.006 Vali Acc: 0.590 Test Loss: 1.006 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.28611421585083
Epoch: 6, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.959 Vali Acc: 0.540 Test Loss: 0.959 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.998614549636841
Epoch: 7, Steps: 20 | Train Loss: 0.383 Vali Loss: 1.232 Vali Acc: 0.490 Test Loss: 1.232 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.799470663070679
Epoch: 8, Steps: 20 | Train Loss: 0.260 Vali Loss: 1.376 Vali Acc: 0.590 Test Loss: 1.376 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.467161417007446
Epoch: 9, Steps: 20 | Train Loss: 0.269 Vali Loss: 1.502 Vali Acc: 0.560 Test Loss: 1.502 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.23080039024353
Epoch: 10, Steps: 20 | Train Loss: 0.208 Vali Loss: 1.511 Vali Acc: 0.570 Test Loss: 1.511 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.533761978149414
Epoch: 11, Steps: 20 | Train Loss: 0.146 Vali Loss: 2.579 Vali Acc: 0.560 Test Loss: 2.579 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.758516788482666
Epoch: 12, Steps: 20 | Train Loss: 0.210 Vali Loss: 2.074 Vali Acc: 0.600 Test Loss: 2.074 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 21356546
model size : 81.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.52768874168396
Epoch: 1, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.735 Vali Acc: 0.520 Test Loss: 0.735 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 5.353790044784546
Epoch: 2, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.823 Vali Acc: 0.530 Test Loss: 0.823 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 5.4526636600494385
Epoch: 3, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.814 Vali Acc: 0.570 Test Loss: 0.814 Test Acc: 0.570
Validation loss decreased (-0.529992 --> -0.569992).  Saving model ...
Epoch: 4 cost time: 5.842219591140747
Epoch: 4, Steps: 20 | Train Loss: 0.653 Vali Loss: 1.047 Vali Acc: 0.510 Test Loss: 1.047 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.402422666549683
Epoch: 5, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.907 Vali Acc: 0.500 Test Loss: 0.907 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.3723554611206055
Epoch: 6, Steps: 20 | Train Loss: 0.477 Vali Loss: 1.034 Vali Acc: 0.550 Test Loss: 1.034 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.087270736694336
Epoch: 7, Steps: 20 | Train Loss: 0.370 Vali Loss: 1.411 Vali Acc: 0.520 Test Loss: 1.411 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.704222679138184
Epoch: 8, Steps: 20 | Train Loss: 0.329 Vali Loss: 1.312 Vali Acc: 0.530 Test Loss: 1.312 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.868203163146973
Epoch: 9, Steps: 20 | Train Loss: 0.265 Vali Loss: 1.011 Vali Acc: 0.640 Test Loss: 1.011 Test Acc: 0.640
Validation loss decreased (-0.569992 --> -0.639990).  Saving model ...
Epoch: 10 cost time: 5.210739374160767
Epoch: 10, Steps: 20 | Train Loss: 0.246 Vali Loss: 1.743 Vali Acc: 0.520 Test Loss: 1.743 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.482639312744141
Epoch: 11, Steps: 20 | Train Loss: 0.210 Vali Loss: 2.094 Vali Acc: 0.510 Test Loss: 2.094 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.185978651046753
Epoch: 12, Steps: 20 | Train Loss: 0.172 Vali Loss: 2.612 Vali Acc: 0.550 Test Loss: 2.612 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.723254203796387
Epoch: 13, Steps: 20 | Train Loss: 0.306 Vali Loss: 1.850 Vali Acc: 0.550 Test Loss: 1.850 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.778681516647339
Epoch: 14, Steps: 20 | Train Loss: 0.199 Vali Loss: 2.841 Vali Acc: 0.530 Test Loss: 2.841 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.677581071853638
Epoch: 15, Steps: 20 | Train Loss: 0.182 Vali Loss: 3.072 Vali Acc: 0.550 Test Loss: 3.072 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.721655607223511
Epoch: 16, Steps: 20 | Train Loss: 0.173 Vali Loss: 3.627 Vali Acc: 0.550 Test Loss: 3.627 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.87705659866333
Epoch: 17, Steps: 20 | Train Loss: 0.184 Vali Loss: 2.992 Vali Acc: 0.540 Test Loss: 2.992 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.615598440170288
Epoch: 18, Steps: 20 | Train Loss: 0.177 Vali Loss: 3.832 Vali Acc: 0.520 Test Loss: 3.832 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.854230642318726
Epoch: 19, Steps: 20 | Train Loss: 0.165 Vali Loss: 4.005 Vali Acc: 0.560 Test Loss: 4.005 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 21356674
model size : 81.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.20419454574585
Epoch: 1, Steps: 20 | Train Loss: 0.774 Vali Loss: 0.694 Vali Acc: 0.520 Test Loss: 0.694 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 5.1911115646362305
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.826 Vali Acc: 0.560 Test Loss: 0.826 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559992).  Saving model ...
Epoch: 3 cost time: 5.311089754104614
Epoch: 3, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.860 Vali Acc: 0.540 Test Loss: 0.860 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.131977081298828
Epoch: 4, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.854 Vali Acc: 0.490 Test Loss: 0.854 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.785660743713379
Epoch: 5, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.868 Vali Acc: 0.580 Test Loss: 0.868 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579991).  Saving model ...
Epoch: 6 cost time: 4.867361068725586
Epoch: 6, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.952 Vali Acc: 0.600 Test Loss: 0.952 Test Acc: 0.600
Validation loss decreased (-0.579991 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 5.147274494171143
Epoch: 7, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.932 Vali Acc: 0.530 Test Loss: 0.932 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.822386741638184
Epoch: 8, Steps: 20 | Train Loss: 0.281 Vali Loss: 0.936 Vali Acc: 0.590 Test Loss: 0.936 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.328758478164673
Epoch: 9, Steps: 20 | Train Loss: 0.251 Vali Loss: 1.284 Vali Acc: 0.560 Test Loss: 1.284 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.016185998916626
Epoch: 10, Steps: 20 | Train Loss: 0.226 Vali Loss: 1.302 Vali Acc: 0.590 Test Loss: 1.302 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.294245958328247
Epoch: 11, Steps: 20 | Train Loss: 0.160 Vali Loss: 1.503 Vali Acc: 0.540 Test Loss: 1.503 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.6703290939331055
Epoch: 12, Steps: 20 | Train Loss: 0.139 Vali Loss: 1.744 Vali Acc: 0.560 Test Loss: 1.744 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.741667747497559
Epoch: 13, Steps: 20 | Train Loss: 0.071 Vali Loss: 1.879 Vali Acc: 0.550 Test Loss: 1.879 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.549399375915527
Epoch: 14, Steps: 20 | Train Loss: 0.055 Vali Loss: 2.349 Vali Acc: 0.570 Test Loss: 2.349 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.485382556915283
Epoch: 15, Steps: 20 | Train Loss: 0.097 Vali Loss: 1.998 Vali Acc: 0.590 Test Loss: 1.998 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.485217571258545
Epoch: 16, Steps: 20 | Train Loss: 0.047 Vali Loss: 3.012 Vali Acc: 0.520 Test Loss: 3.012 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 21285122
model size : 81.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.359516859054565
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.706 Vali Acc: 0.530 Test Loss: 0.706 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 5.101115703582764
Epoch: 2, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.732 Vali Acc: 0.570 Test Loss: 0.732 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 4.857235670089722
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.787 Vali Acc: 0.620 Test Loss: 0.787 Test Acc: 0.620
Validation loss decreased (-0.569993 --> -0.619992).  Saving model ...
Epoch: 4 cost time: 4.645824193954468
Epoch: 4, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.821 Vali Acc: 0.540 Test Loss: 0.821 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.475484609603882
Epoch: 5, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.856 Vali Acc: 0.540 Test Loss: 0.856 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.2417824268341064
Epoch: 6, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.869 Vali Acc: 0.570 Test Loss: 0.869 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.370786428451538
Epoch: 7, Steps: 20 | Train Loss: 0.391 Vali Loss: 0.891 Vali Acc: 0.520 Test Loss: 0.891 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.017030239105225
Epoch: 8, Steps: 20 | Train Loss: 0.300 Vali Loss: 1.131 Vali Acc: 0.540 Test Loss: 1.131 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.110498428344727
Epoch: 9, Steps: 20 | Train Loss: 0.268 Vali Loss: 1.091 Vali Acc: 0.540 Test Loss: 1.091 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.0875115394592285
Epoch: 10, Steps: 20 | Train Loss: 0.221 Vali Loss: 1.380 Vali Acc: 0.540 Test Loss: 1.380 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.135303735733032
Epoch: 11, Steps: 20 | Train Loss: 0.175 Vali Loss: 1.372 Vali Acc: 0.580 Test Loss: 1.372 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.392687082290649
Epoch: 12, Steps: 20 | Train Loss: 0.144 Vali Loss: 1.441 Vali Acc: 0.590 Test Loss: 1.441 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.482260704040527
Epoch: 13, Steps: 20 | Train Loss: 0.152 Vali Loss: 1.624 Vali Acc: 0.590 Test Loss: 1.624 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 21256834
model size : 81.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.900137186050415
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.769 Vali Acc: 0.470 Test Loss: 0.769 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 4.542989730834961
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.785 Vali Acc: 0.510 Test Loss: 0.785 Test Acc: 0.510
Validation loss decreased (-0.469992 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 5.344778537750244
Epoch: 3, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.758 Vali Acc: 0.500 Test Loss: 0.758 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.8228373527526855
Epoch: 4, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.823 Vali Acc: 0.490 Test Loss: 0.823 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.236700773239136
Epoch: 5, Steps: 20 | Train Loss: 0.593 Vali Loss: 1.007 Vali Acc: 0.530 Test Loss: 1.007 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529990).  Saving model ...
Epoch: 6 cost time: 5.230747222900391
Epoch: 6, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.861 Vali Acc: 0.530 Test Loss: 0.861 Test Acc: 0.530
Validation loss decreased (-0.529990 --> -0.529991).  Saving model ...
Epoch: 7 cost time: 5.10612940788269
Epoch: 7, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.809 Vali Acc: 0.570 Test Loss: 0.809 Test Acc: 0.570
Validation loss decreased (-0.529991 --> -0.569992).  Saving model ...
Epoch: 8 cost time: 5.297004222869873
Epoch: 8, Steps: 20 | Train Loss: 0.340 Vali Loss: 1.058 Vali Acc: 0.520 Test Loss: 1.058 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.189056634902954
Epoch: 9, Steps: 20 | Train Loss: 0.260 Vali Loss: 0.849 Vali Acc: 0.580 Test Loss: 0.849 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579992).  Saving model ...
Epoch: 10 cost time: 5.418067693710327
Epoch: 10, Steps: 20 | Train Loss: 0.175 Vali Loss: 1.013 Vali Acc: 0.520 Test Loss: 1.013 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.165824890136719
Epoch: 11, Steps: 20 | Train Loss: 0.127 Vali Loss: 1.128 Vali Acc: 0.570 Test Loss: 1.128 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.039322853088379
Epoch: 12, Steps: 20 | Train Loss: 0.127 Vali Loss: 1.692 Vali Acc: 0.600 Test Loss: 1.692 Test Acc: 0.600
Validation loss decreased (-0.579992 --> -0.599983).  Saving model ...
Epoch: 13 cost time: 4.789453983306885
Epoch: 13, Steps: 20 | Train Loss: 0.109 Vali Loss: 1.471 Vali Acc: 0.520 Test Loss: 1.471 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.643124103546143
Epoch: 14, Steps: 20 | Train Loss: 0.060 Vali Loss: 1.778 Vali Acc: 0.500 Test Loss: 1.778 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.719810724258423
Epoch: 15, Steps: 20 | Train Loss: 0.057 Vali Loss: 1.817 Vali Acc: 0.590 Test Loss: 1.817 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.885478973388672
Epoch: 16, Steps: 20 | Train Loss: 0.101 Vali Loss: 1.921 Vali Acc: 0.540 Test Loss: 1.921 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.991411209106445
Epoch: 17, Steps: 20 | Train Loss: 0.031 Vali Loss: 2.378 Vali Acc: 0.520 Test Loss: 2.378 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.142406225204468
Epoch: 18, Steps: 20 | Train Loss: 0.031 Vali Loss: 2.536 Vali Acc: 0.530 Test Loss: 2.536 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.183319330215454
Epoch: 19, Steps: 20 | Train Loss: 0.036 Vali Loss: 3.019 Vali Acc: 0.530 Test Loss: 3.019 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.385385751724243
Epoch: 20, Steps: 20 | Train Loss: 0.016 Vali Loss: 2.344 Vali Acc: 0.560 Test Loss: 2.344 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.080445766448975
Epoch: 21, Steps: 20 | Train Loss: 0.042 Vali Loss: 2.699 Vali Acc: 0.510 Test Loss: 2.699 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.86815881729126
Epoch: 22, Steps: 20 | Train Loss: 0.009 Vali Loss: 3.199 Vali Acc: 0.500 Test Loss: 3.199 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 21242754
model size : 81.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.638168811798096
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.706 Vali Acc: 0.520 Test Loss: 0.706 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 5.739143133163452
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.913 Vali Acc: 0.500 Test Loss: 0.913 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.194883823394775
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.777 Vali Acc: 0.500 Test Loss: 0.777 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.2699501514434814
Epoch: 4, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.849 Vali Acc: 0.540 Test Loss: 0.849 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 5.274511814117432
Epoch: 5, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.815 Vali Acc: 0.510 Test Loss: 0.815 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.7721943855285645
Epoch: 6, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.824 Vali Acc: 0.520 Test Loss: 0.824 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.587594509124756
Epoch: 7, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.857 Vali Acc: 0.590 Test Loss: 0.857 Test Acc: 0.590
Validation loss decreased (-0.539992 --> -0.589991).  Saving model ...
Epoch: 8 cost time: 5.757342338562012
Epoch: 8, Steps: 20 | Train Loss: 0.401 Vali Loss: 0.856 Vali Acc: 0.570 Test Loss: 0.856 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.583475828170776
Epoch: 9, Steps: 20 | Train Loss: 0.331 Vali Loss: 0.862 Vali Acc: 0.540 Test Loss: 0.862 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.527376174926758
Epoch: 10, Steps: 20 | Train Loss: 0.237 Vali Loss: 0.958 Vali Acc: 0.570 Test Loss: 0.958 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.997437953948975
Epoch: 11, Steps: 20 | Train Loss: 0.185 Vali Loss: 1.072 Vali Acc: 0.530 Test Loss: 1.072 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.097321271896362
Epoch: 12, Steps: 20 | Train Loss: 0.126 Vali Loss: 1.490 Vali Acc: 0.570 Test Loss: 1.490 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.560741424560547
Epoch: 13, Steps: 20 | Train Loss: 0.099 Vali Loss: 1.731 Vali Acc: 0.540 Test Loss: 1.731 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.3150794506073
Epoch: 14, Steps: 20 | Train Loss: 0.088 Vali Loss: 1.723 Vali Acc: 0.610 Test Loss: 1.723 Test Acc: 0.610
Validation loss decreased (-0.589991 --> -0.609983).  Saving model ...
Epoch: 15 cost time: 5.156725883483887
Epoch: 15, Steps: 20 | Train Loss: 0.232 Vali Loss: 2.745 Vali Acc: 0.480 Test Loss: 2.745 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.324918746948242
Epoch: 16, Steps: 20 | Train Loss: 0.104 Vali Loss: 2.039 Vali Acc: 0.540 Test Loss: 2.039 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.127795219421387
Epoch: 17, Steps: 20 | Train Loss: 0.104 Vali Loss: 2.363 Vali Acc: 0.520 Test Loss: 2.363 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.937614440917969
Epoch: 18, Steps: 20 | Train Loss: 0.065 Vali Loss: 2.258 Vali Acc: 0.540 Test Loss: 2.258 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.27620530128479
Epoch: 19, Steps: 20 | Train Loss: 0.012 Vali Loss: 2.437 Vali Acc: 0.520 Test Loss: 2.437 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.642643690109253
Epoch: 20, Steps: 20 | Train Loss: 0.004 Vali Loss: 2.322 Vali Acc: 0.490 Test Loss: 2.322 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.863703489303589
Epoch: 21, Steps: 20 | Train Loss: 0.003 Vali Loss: 2.363 Vali Acc: 0.510 Test Loss: 2.363 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.369916200637817
Epoch: 22, Steps: 20 | Train Loss: 0.002 Vali Loss: 2.488 Vali Acc: 0.460 Test Loss: 2.488 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.435391187667847
Epoch: 23, Steps: 20 | Train Loss: 0.001 Vali Loss: 2.435 Vali Acc: 0.470 Test Loss: 2.435 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.2955498695373535
Epoch: 24, Steps: 20 | Train Loss: 0.000 Vali Loss: 2.417 Vali Acc: 0.470 Test Loss: 2.417 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 21228802
model size : 81.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.194121837615967
Epoch: 1, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.974 Vali Acc: 0.530 Test Loss: 0.974 Test Acc: 0.530
Validation loss decreased (inf --> -0.529990).  Saving model ...
Epoch: 2 cost time: 4.985348701477051
Epoch: 2, Steps: 20 | Train Loss: 0.775 Vali Loss: 0.737 Vali Acc: 0.490 Test Loss: 0.737 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.830385208129883
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.846 Vali Acc: 0.540 Test Loss: 0.846 Test Acc: 0.540
Validation loss decreased (-0.529990 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 4.8083815574646
Epoch: 4, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.875 Vali Acc: 0.530 Test Loss: 0.875 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.536581993103027
Epoch: 5, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.989 Vali Acc: 0.510 Test Loss: 0.989 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.459925889968872
Epoch: 6, Steps: 20 | Train Loss: 0.559 Vali Loss: 1.067 Vali Acc: 0.570 Test Loss: 1.067 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569989).  Saving model ...
Epoch: 7 cost time: 4.500514984130859
Epoch: 7, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.990 Vali Acc: 0.510 Test Loss: 0.990 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.640421152114868
Epoch: 8, Steps: 20 | Train Loss: 0.544 Vali Loss: 1.039 Vali Acc: 0.540 Test Loss: 1.039 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.720203638076782
Epoch: 9, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.854 Vali Acc: 0.600 Test Loss: 0.854 Test Acc: 0.600
Validation loss decreased (-0.569989 --> -0.599991).  Saving model ...
Epoch: 10 cost time: 4.877408742904663
Epoch: 10, Steps: 20 | Train Loss: 0.363 Vali Loss: 1.062 Vali Acc: 0.560 Test Loss: 1.062 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.259128093719482
Epoch: 11, Steps: 20 | Train Loss: 0.266 Vali Loss: 1.144 Vali Acc: 0.570 Test Loss: 1.144 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.2079713344573975
Epoch: 12, Steps: 20 | Train Loss: 0.209 Vali Loss: 1.308 Vali Acc: 0.580 Test Loss: 1.308 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.501703500747681
Epoch: 13, Steps: 20 | Train Loss: 0.333 Vali Loss: 2.144 Vali Acc: 0.520 Test Loss: 2.144 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.621037721633911
Epoch: 14, Steps: 20 | Train Loss: 0.310 Vali Loss: 1.828 Vali Acc: 0.530 Test Loss: 1.828 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.557415246963501
Epoch: 15, Steps: 20 | Train Loss: 0.121 Vali Loss: 2.373 Vali Acc: 0.490 Test Loss: 2.373 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.802026987075806
Epoch: 16, Steps: 20 | Train Loss: 0.263 Vali Loss: 1.963 Vali Acc: 0.570 Test Loss: 1.963 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.589833736419678
Epoch: 17, Steps: 20 | Train Loss: 0.201 Vali Loss: 2.799 Vali Acc: 0.540 Test Loss: 2.799 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.550232172012329
Epoch: 18, Steps: 20 | Train Loss: 0.131 Vali Loss: 3.080 Vali Acc: 0.480 Test Loss: 3.080 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.082461595535278
Epoch: 19, Steps: 20 | Train Loss: 0.043 Vali Loss: 2.669 Vali Acc: 0.600 Test Loss: 2.669 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 6160322
model size : 23.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.688160419464111
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.709 Vali Acc: 0.520 Test Loss: 0.709 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 4.138348340988159
Epoch: 2, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.777 Vali Acc: 0.560 Test Loss: 0.777 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559992).  Saving model ...
Epoch: 3 cost time: 3.7011513710021973
Epoch: 3, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.712 Vali Acc: 0.570 Test Loss: 0.712 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 3.6282289028167725
Epoch: 4, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.855 Vali Acc: 0.520 Test Loss: 0.855 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.031963586807251
Epoch: 5, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.894 Vali Acc: 0.510 Test Loss: 0.894 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.8207294940948486
Epoch: 6, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.863 Vali Acc: 0.540 Test Loss: 0.863 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.9646408557891846
Epoch: 7, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.844 Vali Acc: 0.590 Test Loss: 0.844 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589992).  Saving model ...
Epoch: 8 cost time: 4.042335748672485
Epoch: 8, Steps: 20 | Train Loss: 0.431 Vali Loss: 1.087 Vali Acc: 0.500 Test Loss: 1.087 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.925112009048462
Epoch: 9, Steps: 20 | Train Loss: 0.351 Vali Loss: 1.030 Vali Acc: 0.560 Test Loss: 1.030 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.929515838623047
Epoch: 10, Steps: 20 | Train Loss: 0.276 Vali Loss: 1.052 Vali Acc: 0.510 Test Loss: 1.052 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.132322311401367
Epoch: 11, Steps: 20 | Train Loss: 0.199 Vali Loss: 1.172 Vali Acc: 0.540 Test Loss: 1.172 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.094480752944946
Epoch: 12, Steps: 20 | Train Loss: 0.146 Vali Loss: 1.210 Vali Acc: 0.610 Test Loss: 1.210 Test Acc: 0.610
Validation loss decreased (-0.589992 --> -0.609988).  Saving model ...
Epoch: 13 cost time: 4.030448913574219
Epoch: 13, Steps: 20 | Train Loss: 0.130 Vali Loss: 1.723 Vali Acc: 0.560 Test Loss: 1.723 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.004255056381226
Epoch: 14, Steps: 20 | Train Loss: 0.131 Vali Loss: 1.881 Vali Acc: 0.520 Test Loss: 1.881 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.864137649536133
Epoch: 15, Steps: 20 | Train Loss: 0.173 Vali Loss: 1.894 Vali Acc: 0.550 Test Loss: 1.894 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.7723214626312256
Epoch: 16, Steps: 20 | Train Loss: 0.115 Vali Loss: 1.804 Vali Acc: 0.540 Test Loss: 1.804 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.678159713745117
Epoch: 17, Steps: 20 | Train Loss: 0.034 Vali Loss: 2.127 Vali Acc: 0.520 Test Loss: 2.127 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.454963445663452
Epoch: 18, Steps: 20 | Train Loss: 0.038 Vali Loss: 2.108 Vali Acc: 0.550 Test Loss: 2.108 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.871567726135254
Epoch: 19, Steps: 20 | Train Loss: 0.027 Vali Loss: 2.243 Vali Acc: 0.560 Test Loss: 2.243 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.6964612007141113
Epoch: 20, Steps: 20 | Train Loss: 0.055 Vali Loss: 2.667 Vali Acc: 0.530 Test Loss: 2.667 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.938400983810425
Epoch: 21, Steps: 20 | Train Loss: 0.014 Vali Loss: 2.728 Vali Acc: 0.530 Test Loss: 2.728 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.9333159923553467
Epoch: 22, Steps: 20 | Train Loss: 0.063 Vali Loss: 2.935 Vali Acc: 0.500 Test Loss: 2.935 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 6074370
model size : 23.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.286875247955322
Epoch: 1, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.722 Vali Acc: 0.480 Test Loss: 0.722 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 3.9630212783813477
Epoch: 2, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.813 Vali Acc: 0.520 Test Loss: 0.813 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 4.030672788619995
Epoch: 3, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.883 Vali Acc: 0.510 Test Loss: 0.883 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.0288307666778564
Epoch: 4, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.752 Vali Acc: 0.540 Test Loss: 0.752 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 3.8153491020202637
Epoch: 5, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.901 Vali Acc: 0.560 Test Loss: 0.901 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559991).  Saving model ...
Epoch: 6 cost time: 3.9627461433410645
Epoch: 6, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.895 Vali Acc: 0.520 Test Loss: 0.895 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7927088737487793
Epoch: 7, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.886 Vali Acc: 0.530 Test Loss: 0.886 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.732156991958618
Epoch: 8, Steps: 20 | Train Loss: 0.399 Vali Loss: 0.970 Vali Acc: 0.570 Test Loss: 0.970 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569990).  Saving model ...
Epoch: 9 cost time: 3.727083206176758
Epoch: 9, Steps: 20 | Train Loss: 0.347 Vali Loss: 1.223 Vali Acc: 0.530 Test Loss: 1.223 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.175194501876831
Epoch: 10, Steps: 20 | Train Loss: 0.282 Vali Loss: 1.260 Vali Acc: 0.530 Test Loss: 1.260 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.447176218032837
Epoch: 11, Steps: 20 | Train Loss: 0.183 Vali Loss: 1.349 Vali Acc: 0.560 Test Loss: 1.349 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.5353147983551025
Epoch: 12, Steps: 20 | Train Loss: 0.144 Vali Loss: 1.384 Vali Acc: 0.560 Test Loss: 1.384 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.037314414978027
Epoch: 13, Steps: 20 | Train Loss: 0.093 Vali Loss: 1.729 Vali Acc: 0.540 Test Loss: 1.729 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.982508420944214
Epoch: 14, Steps: 20 | Train Loss: 0.067 Vali Loss: 1.588 Vali Acc: 0.540 Test Loss: 1.588 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.8268561363220215
Epoch: 15, Steps: 20 | Train Loss: 0.088 Vali Loss: 2.102 Vali Acc: 0.560 Test Loss: 2.102 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.827057361602783
Epoch: 16, Steps: 20 | Train Loss: 0.053 Vali Loss: 1.992 Vali Acc: 0.530 Test Loss: 1.992 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.125059127807617
Epoch: 17, Steps: 20 | Train Loss: 0.023 Vali Loss: 2.134 Vali Acc: 0.510 Test Loss: 2.134 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.144180059432983
Epoch: 18, Steps: 20 | Train Loss: 0.017 Vali Loss: 2.134 Vali Acc: 0.580 Test Loss: 2.134 Test Acc: 0.580
Validation loss decreased (-0.569990 --> -0.579979).  Saving model ...
Epoch: 19 cost time: 3.988330125808716
Epoch: 19, Steps: 20 | Train Loss: 0.018 Vali Loss: 2.544 Vali Acc: 0.540 Test Loss: 2.544 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.8350799083709717
Epoch: 20, Steps: 20 | Train Loss: 0.032 Vali Loss: 2.444 Vali Acc: 0.540 Test Loss: 2.444 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.157686948776245
Epoch: 21, Steps: 20 | Train Loss: 0.020 Vali Loss: 2.330 Vali Acc: 0.560 Test Loss: 2.330 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.996452569961548
Epoch: 22, Steps: 20 | Train Loss: 0.026 Vali Loss: 2.303 Vali Acc: 0.540 Test Loss: 2.303 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.019222974777222
Epoch: 23, Steps: 20 | Train Loss: 0.055 Vali Loss: 2.736 Vali Acc: 0.530 Test Loss: 2.736 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.6759886741638184
Epoch: 24, Steps: 20 | Train Loss: 0.013 Vali Loss: 2.738 Vali Acc: 0.530 Test Loss: 2.738 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.1983907222747803
Epoch: 25, Steps: 20 | Train Loss: 0.003 Vali Loss: 2.683 Vali Acc: 0.580 Test Loss: 2.683 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.3326003551483154
Epoch: 26, Steps: 20 | Train Loss: 0.002 Vali Loss: 3.195 Vali Acc: 0.560 Test Loss: 3.195 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.3402888774871826
Epoch: 27, Steps: 20 | Train Loss: 0.001 Vali Loss: 3.101 Vali Acc: 0.530 Test Loss: 3.101 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.718151092529297
Epoch: 28, Steps: 20 | Train Loss: 0.000 Vali Loss: 3.181 Vali Acc: 0.510 Test Loss: 3.181 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 6074434
model size : 23.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.719804048538208
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 3.3791189193725586
Epoch: 2, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.912 Vali Acc: 0.500 Test Loss: 0.912 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3973944187164307
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.870 Vali Acc: 0.580 Test Loss: 0.870 Test Acc: 0.580
Validation loss decreased (-0.499993 --> -0.579991).  Saving model ...
Epoch: 4 cost time: 3.65592360496521
Epoch: 4, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.800 Vali Acc: 0.620 Test Loss: 0.800 Test Acc: 0.620
Validation loss decreased (-0.579991 --> -0.619992).  Saving model ...
Epoch: 5 cost time: 3.555767059326172
Epoch: 5, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.803 Vali Acc: 0.570 Test Loss: 0.803 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5237061977386475
Epoch: 6, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.818 Vali Acc: 0.550 Test Loss: 0.818 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.5124430656433105
Epoch: 7, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.877 Vali Acc: 0.540 Test Loss: 0.877 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.500093460083008
Epoch: 8, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.981 Vali Acc: 0.560 Test Loss: 0.981 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.2006895542144775
Epoch: 9, Steps: 20 | Train Loss: 0.359 Vali Loss: 0.878 Vali Acc: 0.530 Test Loss: 0.878 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.0778024196624756
Epoch: 10, Steps: 20 | Train Loss: 0.317 Vali Loss: 0.919 Vali Acc: 0.550 Test Loss: 0.919 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.2439277172088623
Epoch: 11, Steps: 20 | Train Loss: 0.235 Vali Loss: 1.134 Vali Acc: 0.520 Test Loss: 1.134 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.2964420318603516
Epoch: 12, Steps: 20 | Train Loss: 0.223 Vali Loss: 1.543 Vali Acc: 0.490 Test Loss: 1.543 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.4135615825653076
Epoch: 13, Steps: 20 | Train Loss: 0.123 Vali Loss: 1.288 Vali Acc: 0.560 Test Loss: 1.288 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.564134120941162
Epoch: 14, Steps: 20 | Train Loss: 0.078 Vali Loss: 1.612 Vali Acc: 0.520 Test Loss: 1.612 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 6038658
model size : 23.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.240462779998779
Epoch: 1, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.729 Vali Acc: 0.490 Test Loss: 0.729 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 3.187843084335327
Epoch: 2, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.799 Vali Acc: 0.480 Test Loss: 0.799 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4137518405914307
Epoch: 3, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.766 Vali Acc: 0.520 Test Loss: 0.766 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 3.4426469802856445
Epoch: 4, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.985501766204834
Epoch: 5, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.773 Vali Acc: 0.550 Test Loss: 0.773 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 3.1347854137420654
Epoch: 6, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.809 Vali Acc: 0.540 Test Loss: 0.809 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2182366847991943
Epoch: 7, Steps: 20 | Train Loss: 0.501 Vali Loss: 1.028 Vali Acc: 0.510 Test Loss: 1.028 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.556955099105835
Epoch: 8, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.859 Vali Acc: 0.540 Test Loss: 0.859 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.3914072513580322
Epoch: 9, Steps: 20 | Train Loss: 0.384 Vali Loss: 0.913 Vali Acc: 0.550 Test Loss: 0.913 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.3255362510681152
Epoch: 10, Steps: 20 | Train Loss: 0.353 Vali Loss: 0.876 Vali Acc: 0.570 Test Loss: 0.876 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569991).  Saving model ...
Epoch: 11 cost time: 3.3142731189727783
Epoch: 11, Steps: 20 | Train Loss: 0.251 Vali Loss: 1.040 Vali Acc: 0.540 Test Loss: 1.040 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.35316801071167
Epoch: 12, Steps: 20 | Train Loss: 0.225 Vali Loss: 0.965 Vali Acc: 0.530 Test Loss: 0.965 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5761613845825195
Epoch: 13, Steps: 20 | Train Loss: 0.167 Vali Loss: 1.097 Vali Acc: 0.550 Test Loss: 1.097 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.59637713432312
Epoch: 14, Steps: 20 | Train Loss: 0.109 Vali Loss: 1.277 Vali Acc: 0.530 Test Loss: 1.277 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.727142572402954
Epoch: 15, Steps: 20 | Train Loss: 0.075 Vali Loss: 1.150 Vali Acc: 0.560 Test Loss: 1.150 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.2294442653656006
Epoch: 16, Steps: 20 | Train Loss: 0.044 Vali Loss: 1.448 Vali Acc: 0.520 Test Loss: 1.448 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.2212047576904297
Epoch: 17, Steps: 20 | Train Loss: 0.027 Vali Loss: 1.673 Vali Acc: 0.490 Test Loss: 1.673 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.04087233543396
Epoch: 18, Steps: 20 | Train Loss: 0.020 Vali Loss: 1.851 Vali Acc: 0.500 Test Loss: 1.851 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.7116312980651855
Epoch: 19, Steps: 20 | Train Loss: 0.012 Vali Loss: 1.887 Vali Acc: 0.520 Test Loss: 1.887 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.581883430480957
Epoch: 20, Steps: 20 | Train Loss: 0.008 Vali Loss: 1.673 Vali Acc: 0.550 Test Loss: 1.673 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 6024514
model size : 23.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.388806343078613
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.703 Vali Acc: 0.570 Test Loss: 0.703 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 2.4528720378875732
Epoch: 2, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.801 Vali Acc: 0.470 Test Loss: 0.801 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.207690715789795
Epoch: 3, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.746 Vali Acc: 0.500 Test Loss: 0.746 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.32174015045166
Epoch: 4, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.799 Vali Acc: 0.600 Test Loss: 0.799 Test Acc: 0.600
Validation loss decreased (-0.569993 --> -0.599992).  Saving model ...
Epoch: 5 cost time: 3.3192646503448486
Epoch: 5, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.805 Vali Acc: 0.590 Test Loss: 0.805 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1411545276641846
Epoch: 6, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.780 Vali Acc: 0.590 Test Loss: 0.780 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.163034200668335
Epoch: 7, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.838 Vali Acc: 0.510 Test Loss: 0.838 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.2111308574676514
Epoch: 8, Steps: 20 | Train Loss: 0.463 Vali Loss: 1.021 Vali Acc: 0.520 Test Loss: 1.021 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.03238844871521
Epoch: 9, Steps: 20 | Train Loss: 0.420 Vali Loss: 0.825 Vali Acc: 0.550 Test Loss: 0.825 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.960864543914795
Epoch: 10, Steps: 20 | Train Loss: 0.354 Vali Loss: 0.852 Vali Acc: 0.560 Test Loss: 0.852 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.9176182746887207
Epoch: 11, Steps: 20 | Train Loss: 0.289 Vali Loss: 0.993 Vali Acc: 0.540 Test Loss: 0.993 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.0270774364471436
Epoch: 12, Steps: 20 | Train Loss: 0.279 Vali Loss: 0.949 Vali Acc: 0.600 Test Loss: 0.949 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.9639999866485596
Epoch: 13, Steps: 20 | Train Loss: 0.199 Vali Loss: 0.988 Vali Acc: 0.520 Test Loss: 0.988 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.8713130950927734
Epoch: 14, Steps: 20 | Train Loss: 0.130 Vali Loss: 1.152 Vali Acc: 0.600 Test Loss: 1.152 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 6017474
model size : 23.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.422355890274048
Epoch: 1, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.720 Vali Acc: 0.470 Test Loss: 0.720 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 3.1190991401672363
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.770 Vali Acc: 0.540 Test Loss: 0.770 Test Acc: 0.540
Validation loss decreased (-0.469993 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 2.9501638412475586
Epoch: 3, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.789 Vali Acc: 0.480 Test Loss: 0.789 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.019042491912842
Epoch: 4, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.757 Vali Acc: 0.570 Test Loss: 0.757 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569992).  Saving model ...
Epoch: 5 cost time: 3.0235772132873535
Epoch: 5, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.736 Vali Acc: 0.480 Test Loss: 0.736 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2407686710357666
Epoch: 6, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.780 Vali Acc: 0.460 Test Loss: 0.780 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.2185800075531006
Epoch: 7, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.783 Vali Acc: 0.610 Test Loss: 0.783 Test Acc: 0.610
Validation loss decreased (-0.569992 --> -0.609992).  Saving model ...
Epoch: 8 cost time: 3.0341079235076904
Epoch: 8, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.972 Vali Acc: 0.550 Test Loss: 0.972 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.107625961303711
Epoch: 9, Steps: 20 | Train Loss: 0.455 Vali Loss: 0.964 Vali Acc: 0.530 Test Loss: 0.964 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1829028129577637
Epoch: 10, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.800 Vali Acc: 0.610 Test Loss: 0.800 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.3099863529205322
Epoch: 11, Steps: 20 | Train Loss: 0.308 Vali Loss: 0.832 Vali Acc: 0.590 Test Loss: 0.832 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.2705535888671875
Epoch: 12, Steps: 20 | Train Loss: 0.293 Vali Loss: 0.963 Vali Acc: 0.570 Test Loss: 0.963 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.8375940322875977
Epoch: 13, Steps: 20 | Train Loss: 0.234 Vali Loss: 0.962 Vali Acc: 0.530 Test Loss: 0.962 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.6109402179718018
Epoch: 14, Steps: 20 | Train Loss: 0.175 Vali Loss: 1.199 Vali Acc: 0.540 Test Loss: 1.199 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.651592254638672
Epoch: 15, Steps: 20 | Train Loss: 0.143 Vali Loss: 1.183 Vali Acc: 0.590 Test Loss: 1.183 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.9543426036834717
Epoch: 16, Steps: 20 | Train Loss: 0.086 Vali Loss: 1.291 Vali Acc: 0.580 Test Loss: 1.291 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.0663840770721436
Epoch: 17, Steps: 20 | Train Loss: 0.057 Vali Loss: 1.387 Vali Acc: 0.560 Test Loss: 1.387 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 6010498
model size : 23.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.378607749938965
Epoch: 1, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.752 Vali Acc: 0.490 Test Loss: 0.752 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 3.10964035987854
Epoch: 2, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.705 Vali Acc: 0.520 Test Loss: 0.705 Test Acc: 0.520
Validation loss decreased (-0.489992 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 3.0656750202178955
Epoch: 3, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.824 Vali Acc: 0.510 Test Loss: 0.824 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2805991172790527
Epoch: 4, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.838 Vali Acc: 0.500 Test Loss: 0.838 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.2055795192718506
Epoch: 5, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.726 Vali Acc: 0.610 Test Loss: 0.726 Test Acc: 0.610
Validation loss decreased (-0.519993 --> -0.609993).  Saving model ...
Epoch: 6 cost time: 3.2700023651123047
Epoch: 6, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.807 Vali Acc: 0.540 Test Loss: 0.807 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0073952674865723
Epoch: 7, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.820 Vali Acc: 0.550 Test Loss: 0.820 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.1381618976593018
Epoch: 8, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.812 Vali Acc: 0.600 Test Loss: 0.812 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.1811442375183105
Epoch: 9, Steps: 20 | Train Loss: 0.399 Vali Loss: 1.084 Vali Acc: 0.560 Test Loss: 1.084 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.139167308807373
Epoch: 10, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.943 Vali Acc: 0.560 Test Loss: 0.943 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.9016733169555664
Epoch: 11, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.946 Vali Acc: 0.570 Test Loss: 0.946 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.7896335124969482
Epoch: 12, Steps: 20 | Train Loss: 0.339 Vali Loss: 1.374 Vali Acc: 0.530 Test Loss: 1.374 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.933527708053589
Epoch: 13, Steps: 20 | Train Loss: 0.323 Vali Loss: 1.008 Vali Acc: 0.530 Test Loss: 1.008 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.532564401626587
Epoch: 14, Steps: 20 | Train Loss: 0.262 Vali Loss: 1.144 Vali Acc: 0.560 Test Loss: 1.144 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.699763059616089
Epoch: 15, Steps: 20 | Train Loss: 0.219 Vali Loss: 1.278 Vali Acc: 0.570 Test Loss: 1.278 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1929186
model size : 7.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.042680263519287
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.7605016231536865
Epoch: 2, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.725 Vali Acc: 0.510 Test Loss: 0.725 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 2.5173351764678955
Epoch: 3, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.765 Vali Acc: 0.510 Test Loss: 0.765 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3677279949188232
Epoch: 4, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.729 Vali Acc: 0.560 Test Loss: 0.729 Test Acc: 0.560
Validation loss decreased (-0.509993 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 2.6273629665374756
Epoch: 5, Steps: 20 | Train Loss: 0.613 Vali Loss: 1.119 Vali Acc: 0.490 Test Loss: 1.119 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6350018978118896
Epoch: 6, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.892 Vali Acc: 0.500 Test Loss: 0.892 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.697284460067749
Epoch: 7, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.869 Vali Acc: 0.500 Test Loss: 0.869 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.777968406677246
Epoch: 8, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.797 Vali Acc: 0.550 Test Loss: 0.797 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.76149845123291
Epoch: 9, Steps: 20 | Train Loss: 0.413 Vali Loss: 0.947 Vali Acc: 0.510 Test Loss: 0.947 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.7493460178375244
Epoch: 10, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.317 Vali Acc: 0.500 Test Loss: 1.317 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.1502108573913574
Epoch: 11, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.988 Vali Acc: 0.520 Test Loss: 0.988 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.048161745071411
Epoch: 12, Steps: 20 | Train Loss: 0.316 Vali Loss: 1.111 Vali Acc: 0.510 Test Loss: 1.111 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9149253368377686
Epoch: 13, Steps: 20 | Train Loss: 0.294 Vali Loss: 0.897 Vali Acc: 0.560 Test Loss: 0.897 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.9280409812927246
Epoch: 14, Steps: 20 | Train Loss: 0.250 Vali Loss: 1.054 Vali Acc: 0.530 Test Loss: 1.054 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1886210
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5580384731292725
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.785 Vali Acc: 0.430 Test Loss: 0.785 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 2.0257697105407715
Epoch: 2, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.775 Vali Acc: 0.490 Test Loss: 0.775 Test Acc: 0.490
Validation loss decreased (-0.429992 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 2.5163776874542236
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.883 Vali Acc: 0.500 Test Loss: 0.883 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499991).  Saving model ...
Epoch: 4 cost time: 2.5250468254089355
Epoch: 4, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.758 Vali Acc: 0.470 Test Loss: 0.758 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4954700469970703
Epoch: 5, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.862 Vali Acc: 0.460 Test Loss: 0.862 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.613301992416382
Epoch: 6, Steps: 20 | Train Loss: 0.534 Vali Loss: 1.370 Vali Acc: 0.510 Test Loss: 1.370 Test Acc: 0.510
Validation loss decreased (-0.499991 --> -0.509986).  Saving model ...
Epoch: 7 cost time: 2.009701728820801
Epoch: 7, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.830 Vali Acc: 0.520 Test Loss: 0.830 Test Acc: 0.520
Validation loss decreased (-0.509986 --> -0.519992).  Saving model ...
Epoch: 8 cost time: 2.5040924549102783
Epoch: 8, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.935 Vali Acc: 0.480 Test Loss: 0.935 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7061169147491455
Epoch: 9, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.911 Vali Acc: 0.520 Test Loss: 0.911 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.564875841140747
Epoch: 10, Steps: 20 | Train Loss: 0.380 Vali Loss: 0.884 Vali Acc: 0.580 Test Loss: 0.884 Test Acc: 0.580
Validation loss decreased (-0.519992 --> -0.579991).  Saving model ...
Epoch: 11 cost time: 2.419234037399292
Epoch: 11, Steps: 20 | Train Loss: 0.386 Vali Loss: 0.947 Vali Acc: 0.550 Test Loss: 0.947 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.539260149002075
Epoch: 12, Steps: 20 | Train Loss: 0.333 Vali Loss: 0.988 Vali Acc: 0.600 Test Loss: 0.988 Test Acc: 0.600
Validation loss decreased (-0.579991 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 2.8377270698547363
Epoch: 13, Steps: 20 | Train Loss: 0.310 Vali Loss: 0.943 Vali Acc: 0.520 Test Loss: 0.943 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.685549020767212
Epoch: 14, Steps: 20 | Train Loss: 0.174 Vali Loss: 1.087 Vali Acc: 0.560 Test Loss: 1.087 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5945026874542236
Epoch: 15, Steps: 20 | Train Loss: 0.161 Vali Loss: 1.486 Vali Acc: 0.510 Test Loss: 1.486 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.518728256225586
Epoch: 16, Steps: 20 | Train Loss: 0.147 Vali Loss: 1.269 Vali Acc: 0.560 Test Loss: 1.269 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.2395026683807373
Epoch: 17, Steps: 20 | Train Loss: 0.126 Vali Loss: 1.255 Vali Acc: 0.530 Test Loss: 1.255 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.333160400390625
Epoch: 18, Steps: 20 | Train Loss: 0.082 Vali Loss: 1.438 Vali Acc: 0.540 Test Loss: 1.438 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.034221649169922
Epoch: 19, Steps: 20 | Train Loss: 0.081 Vali Loss: 1.547 Vali Acc: 0.510 Test Loss: 1.547 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.0568299293518066
Epoch: 20, Steps: 20 | Train Loss: 0.036 Vali Loss: 1.620 Vali Acc: 0.540 Test Loss: 1.620 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.310640811920166
Epoch: 21, Steps: 20 | Train Loss: 0.037 Vali Loss: 1.665 Vali Acc: 0.550 Test Loss: 1.665 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.7969412803649902
Epoch: 22, Steps: 20 | Train Loss: 0.010 Vali Loss: 1.705 Vali Acc: 0.540 Test Loss: 1.705 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1886242
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.542245388031006
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.689 Vali Acc: 0.540 Test Loss: 0.689 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.640881061553955
Epoch: 2, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.741 Vali Acc: 0.490 Test Loss: 0.741 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.53387451171875
Epoch: 3, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.734 Vali Acc: 0.550 Test Loss: 0.734 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 2.4116315841674805
Epoch: 4, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.803 Vali Acc: 0.510 Test Loss: 0.803 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5440328121185303
Epoch: 5, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5327887535095215
Epoch: 6, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.735 Vali Acc: 0.600 Test Loss: 0.735 Test Acc: 0.600
Validation loss decreased (-0.549993 --> -0.599993).  Saving model ...
Epoch: 7 cost time: 2.416548252105713
Epoch: 7, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.802 Vali Acc: 0.520 Test Loss: 0.802 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.444687843322754
Epoch: 8, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.757 Vali Acc: 0.570 Test Loss: 0.757 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.33947491645813
Epoch: 9, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.861 Vali Acc: 0.570 Test Loss: 0.861 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1057491302490234
Epoch: 10, Steps: 20 | Train Loss: 0.408 Vali Loss: 1.083 Vali Acc: 0.560 Test Loss: 1.083 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.418016195297241
Epoch: 11, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.837 Vali Acc: 0.560 Test Loss: 0.837 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2140018939971924
Epoch: 12, Steps: 20 | Train Loss: 0.341 Vali Loss: 0.984 Vali Acc: 0.520 Test Loss: 0.984 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.1414835453033447
Epoch: 13, Steps: 20 | Train Loss: 0.273 Vali Loss: 0.882 Vali Acc: 0.580 Test Loss: 0.882 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.1808815002441406
Epoch: 14, Steps: 20 | Train Loss: 0.235 Vali Loss: 0.951 Vali Acc: 0.540 Test Loss: 0.951 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.2055375576019287
Epoch: 15, Steps: 20 | Train Loss: 0.197 Vali Loss: 1.163 Vali Acc: 0.600 Test Loss: 1.163 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.3958029747009277
Epoch: 16, Steps: 20 | Train Loss: 0.147 Vali Loss: 1.209 Vali Acc: 0.580 Test Loss: 1.209 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1868354
model size : 7.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.77097749710083
Epoch: 1, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.702 Vali Acc: 0.470 Test Loss: 0.702 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 2.354384183883667
Epoch: 2, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.699 Vali Acc: 0.570 Test Loss: 0.699 Test Acc: 0.570
Validation loss decreased (-0.469993 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 2.440124988555908
Epoch: 3, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.845 Vali Acc: 0.510 Test Loss: 0.845 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.497457981109619
Epoch: 4, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.770 Vali Acc: 0.510 Test Loss: 0.770 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5619940757751465
Epoch: 5, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.740 Vali Acc: 0.550 Test Loss: 0.740 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.423145055770874
Epoch: 6, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.839 Vali Acc: 0.480 Test Loss: 0.839 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.516387462615967
Epoch: 7, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.935 Vali Acc: 0.520 Test Loss: 0.935 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.4375863075256348
Epoch: 8, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.826 Vali Acc: 0.480 Test Loss: 0.826 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.2837014198303223
Epoch: 9, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.807 Vali Acc: 0.610 Test Loss: 0.807 Test Acc: 0.610
Validation loss decreased (-0.569993 --> -0.609992).  Saving model ...
Epoch: 10 cost time: 2.50654673576355
Epoch: 10, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.827 Vali Acc: 0.590 Test Loss: 0.827 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3671319484710693
Epoch: 11, Steps: 20 | Train Loss: 0.410 Vali Loss: 0.803 Vali Acc: 0.590 Test Loss: 0.803 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.603517770767212
Epoch: 12, Steps: 20 | Train Loss: 0.351 Vali Loss: 0.848 Vali Acc: 0.560 Test Loss: 0.848 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.4407241344451904
Epoch: 13, Steps: 20 | Train Loss: 0.305 Vali Loss: 0.825 Vali Acc: 0.560 Test Loss: 0.825 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.495863199234009
Epoch: 14, Steps: 20 | Train Loss: 0.297 Vali Loss: 0.940 Vali Acc: 0.560 Test Loss: 0.940 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.3588595390319824
Epoch: 15, Steps: 20 | Train Loss: 0.227 Vali Loss: 0.897 Vali Acc: 0.540 Test Loss: 0.897 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.155669689178467
Epoch: 16, Steps: 20 | Train Loss: 0.175 Vali Loss: 1.070 Vali Acc: 0.540 Test Loss: 1.070 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9855072498321533
Epoch: 17, Steps: 20 | Train Loss: 0.136 Vali Loss: 1.025 Vali Acc: 0.530 Test Loss: 1.025 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.1671433448791504
Epoch: 18, Steps: 20 | Train Loss: 0.099 Vali Loss: 1.373 Vali Acc: 0.480 Test Loss: 1.373 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.3195364475250244
Epoch: 19, Steps: 20 | Train Loss: 0.067 Vali Loss: 1.366 Vali Acc: 0.560 Test Loss: 1.366 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1861282
model size : 7.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6682724952697754
Epoch: 1, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.690 Vali Acc: 0.520 Test Loss: 0.690 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.487917423248291
Epoch: 2, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.740 Vali Acc: 0.470 Test Loss: 0.740 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6530580520629883
Epoch: 3, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.810 Vali Acc: 0.440 Test Loss: 0.810 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2910819053649902
Epoch: 4, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.753 Vali Acc: 0.500 Test Loss: 0.753 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0396316051483154
Epoch: 5, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.787 Vali Acc: 0.460 Test Loss: 0.787 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3301656246185303
Epoch: 6, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.712 Vali Acc: 0.570 Test Loss: 0.712 Test Acc: 0.570
Validation loss decreased (-0.519993 --> -0.569993).  Saving model ...
Epoch: 7 cost time: 1.6251616477966309
Epoch: 7, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6137712001800537
Epoch: 8, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.873 Vali Acc: 0.490 Test Loss: 0.873 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6709716320037842
Epoch: 9, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.831 Vali Acc: 0.510 Test Loss: 0.831 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7444336414337158
Epoch: 10, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.746 Vali Acc: 0.550 Test Loss: 0.746 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1470189094543457
Epoch: 11, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.760 Vali Acc: 0.570 Test Loss: 0.760 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.329784631729126
Epoch: 12, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.772 Vali Acc: 0.540 Test Loss: 0.772 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.551787853240967
Epoch: 13, Steps: 20 | Train Loss: 0.350 Vali Loss: 0.812 Vali Acc: 0.580 Test Loss: 0.812 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579992).  Saving model ...
Epoch: 14 cost time: 2.167314052581787
Epoch: 14, Steps: 20 | Train Loss: 0.305 Vali Loss: 0.888 Vali Acc: 0.520 Test Loss: 0.888 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0235254764556885
Epoch: 15, Steps: 20 | Train Loss: 0.270 Vali Loss: 0.988 Vali Acc: 0.570 Test Loss: 0.988 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2046945095062256
Epoch: 16, Steps: 20 | Train Loss: 0.192 Vali Loss: 0.933 Vali Acc: 0.540 Test Loss: 0.933 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.081918239593506
Epoch: 17, Steps: 20 | Train Loss: 0.182 Vali Loss: 1.057 Vali Acc: 0.560 Test Loss: 1.057 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.183563232421875
Epoch: 18, Steps: 20 | Train Loss: 0.150 Vali Loss: 1.019 Vali Acc: 0.560 Test Loss: 1.019 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7780215740203857
Epoch: 19, Steps: 20 | Train Loss: 0.089 Vali Loss: 1.059 Vali Acc: 0.570 Test Loss: 1.059 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.5619957447052
Epoch: 20, Steps: 20 | Train Loss: 0.054 Vali Loss: 1.508 Vali Acc: 0.530 Test Loss: 1.508 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.522085666656494
Epoch: 21, Steps: 20 | Train Loss: 0.038 Vali Loss: 1.590 Vali Acc: 0.510 Test Loss: 1.590 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.458873987197876
Epoch: 22, Steps: 20 | Train Loss: 0.023 Vali Loss: 1.410 Vali Acc: 0.540 Test Loss: 1.410 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.2515525817871094
Epoch: 23, Steps: 20 | Train Loss: 0.013 Vali Loss: 1.479 Vali Acc: 0.580 Test Loss: 1.479 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1857762
model size : 7.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8413474559783936
Epoch: 1, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.698 Vali Acc: 0.460 Test Loss: 0.698 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 2.1878628730773926
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.736 Vali Acc: 0.490 Test Loss: 0.736 Test Acc: 0.490
Validation loss decreased (-0.459993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 2.092440366744995
Epoch: 3, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.757 Vali Acc: 0.450 Test Loss: 0.757 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3929600715637207
Epoch: 4, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.748 Vali Acc: 0.510 Test Loss: 0.748 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 2.3986799716949463
Epoch: 5, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.744 Vali Acc: 0.550 Test Loss: 0.744 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 2.4010214805603027
Epoch: 6, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.746 Vali Acc: 0.520 Test Loss: 0.746 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5040194988250732
Epoch: 7, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.778 Vali Acc: 0.500 Test Loss: 0.778 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2345657348632812
Epoch: 8, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.754 Vali Acc: 0.490 Test Loss: 0.754 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1246328353881836
Epoch: 9, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.804 Vali Acc: 0.510 Test Loss: 0.804 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1259217262268066
Epoch: 10, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.855 Vali Acc: 0.540 Test Loss: 0.855 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.159487247467041
Epoch: 11, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.777 Vali Acc: 0.570 Test Loss: 0.777 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 12 cost time: 2.507931709289551
Epoch: 12, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.787 Vali Acc: 0.590 Test Loss: 0.787 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589992).  Saving model ...
Epoch: 13 cost time: 2.568575382232666
Epoch: 13, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.824 Vali Acc: 0.550 Test Loss: 0.824 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4427452087402344
Epoch: 14, Steps: 20 | Train Loss: 0.340 Vali Loss: 0.801 Vali Acc: 0.590 Test Loss: 0.801 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6781091690063477
Epoch: 15, Steps: 20 | Train Loss: 0.275 Vali Loss: 0.806 Vali Acc: 0.590 Test Loss: 0.806 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.446291446685791
Epoch: 16, Steps: 20 | Train Loss: 0.226 Vali Loss: 1.042 Vali Acc: 0.550 Test Loss: 1.042 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.7166919708251953
Epoch: 17, Steps: 20 | Train Loss: 0.170 Vali Loss: 0.924 Vali Acc: 0.590 Test Loss: 0.924 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.9151623249053955
Epoch: 18, Steps: 20 | Train Loss: 0.133 Vali Loss: 1.080 Vali Acc: 0.540 Test Loss: 1.080 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.0435092449188232
Epoch: 19, Steps: 20 | Train Loss: 0.082 Vali Loss: 1.130 Vali Acc: 0.560 Test Loss: 1.130 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.15293288230896
Epoch: 20, Steps: 20 | Train Loss: 0.069 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.9851248264312744
Epoch: 21, Steps: 20 | Train Loss: 0.041 Vali Loss: 1.124 Vali Acc: 0.550 Test Loss: 1.124 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.589998722076416
Epoch: 22, Steps: 20 | Train Loss: 0.021 Vali Loss: 1.328 Vali Acc: 0.570 Test Loss: 1.328 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1854274
model size : 7.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 10.613383054733276
Epoch: 1, Steps: 20 | Train Loss: 0.802 Vali Loss: 0.932 Vali Acc: 0.490 Test Loss: 0.932 Test Acc: 0.490
Validation loss decreased (inf --> -0.489991).  Saving model ...
Epoch: 2 cost time: 8.50112771987915
Epoch: 2, Steps: 20 | Train Loss: 0.774 Vali Loss: 0.830 Vali Acc: 0.510 Test Loss: 0.830 Test Acc: 0.510
Validation loss decreased (-0.489991 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 6.655038356781006
Epoch: 3, Steps: 20 | Train Loss: 0.779 Vali Loss: 0.816 Vali Acc: 0.560 Test Loss: 0.816 Test Acc: 0.560
Validation loss decreased (-0.509992 --> -0.559992).  Saving model ...
Epoch: 4 cost time: 7.849298477172852
Epoch: 4, Steps: 20 | Train Loss: 0.644 Vali Loss: 1.119 Vali Acc: 0.490 Test Loss: 1.119 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.93635368347168
Epoch: 5, Steps: 20 | Train Loss: 0.647 Vali Loss: 1.287 Vali Acc: 0.470 Test Loss: 1.287 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.747610569000244
Epoch: 6, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.872 Vali Acc: 0.560 Test Loss: 0.872 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.333705425262451
Epoch: 7, Steps: 20 | Train Loss: 0.549 Vali Loss: 1.183 Vali Acc: 0.580 Test Loss: 1.183 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579988).  Saving model ...
Epoch: 8 cost time: 8.985572338104248
Epoch: 8, Steps: 20 | Train Loss: 0.555 Vali Loss: 1.179 Vali Acc: 0.530 Test Loss: 1.179 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.328878402709961
Epoch: 9, Steps: 20 | Train Loss: 0.441 Vali Loss: 1.194 Vali Acc: 0.580 Test Loss: 1.194 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.573918342590332
Epoch: 10, Steps: 20 | Train Loss: 0.349 Vali Loss: 1.325 Vali Acc: 0.610 Test Loss: 1.325 Test Acc: 0.610
Validation loss decreased (-0.579988 --> -0.609987).  Saving model ...
Epoch: 11 cost time: 8.296320676803589
Epoch: 11, Steps: 20 | Train Loss: 0.329 Vali Loss: 2.074 Vali Acc: 0.550 Test Loss: 2.074 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.910051584243774
Epoch: 12, Steps: 20 | Train Loss: 0.256 Vali Loss: 1.770 Vali Acc: 0.570 Test Loss: 1.770 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.257678508758545
Epoch: 13, Steps: 20 | Train Loss: 0.220 Vali Loss: 2.234 Vali Acc: 0.590 Test Loss: 2.234 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.522630453109741
Epoch: 14, Steps: 20 | Train Loss: 0.384 Vali Loss: 2.703 Vali Acc: 0.490 Test Loss: 2.703 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.822052717208862
Epoch: 15, Steps: 20 | Train Loss: 0.234 Vali Loss: 2.873 Vali Acc: 0.540 Test Loss: 2.873 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 8.198916673660278
Epoch: 16, Steps: 20 | Train Loss: 0.276 Vali Loss: 4.533 Vali Acc: 0.500 Test Loss: 4.533 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 8.502638816833496
Epoch: 17, Steps: 20 | Train Loss: 0.447 Vali Loss: 3.114 Vali Acc: 0.590 Test Loss: 3.114 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 8.559921979904175
Epoch: 18, Steps: 20 | Train Loss: 0.321 Vali Loss: 4.320 Vali Acc: 0.530 Test Loss: 4.320 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 8.784868240356445
Epoch: 19, Steps: 20 | Train Loss: 0.258 Vali Loss: 4.785 Vali Acc: 0.560 Test Loss: 4.785 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 8.306774854660034
Epoch: 20, Steps: 20 | Train Loss: 0.085 Vali Loss: 4.432 Vali Acc: 0.570 Test Loss: 4.432 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 21485442
model size : 82.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.057545185089111
Epoch: 1, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.873 Vali Acc: 0.540 Test Loss: 0.873 Test Acc: 0.540
Validation loss decreased (inf --> -0.539991).  Saving model ...
Epoch: 2 cost time: 4.497046709060669
Epoch: 2, Steps: 20 | Train Loss: 0.768 Vali Loss: 0.710 Vali Acc: 0.580 Test Loss: 0.710 Test Acc: 0.580
Validation loss decreased (-0.539991 --> -0.579993).  Saving model ...
Epoch: 3 cost time: 6.375004053115845
Epoch: 3, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.826 Vali Acc: 0.540 Test Loss: 0.826 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.4943625926971436
Epoch: 4, Steps: 20 | Train Loss: 0.605 Vali Loss: 1.029 Vali Acc: 0.510 Test Loss: 1.029 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.197405576705933
Epoch: 5, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.880 Vali Acc: 0.530 Test Loss: 0.880 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.987772703170776
Epoch: 6, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.894 Vali Acc: 0.520 Test Loss: 0.894 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.271131992340088
Epoch: 7, Steps: 20 | Train Loss: 0.397 Vali Loss: 1.306 Vali Acc: 0.530 Test Loss: 1.306 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.304284334182739
Epoch: 8, Steps: 20 | Train Loss: 0.358 Vali Loss: 1.059 Vali Acc: 0.570 Test Loss: 1.059 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.876716136932373
Epoch: 9, Steps: 20 | Train Loss: 0.280 Vali Loss: 1.422 Vali Acc: 0.520 Test Loss: 1.422 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.6720945835113525
Epoch: 10, Steps: 20 | Train Loss: 0.242 Vali Loss: 1.695 Vali Acc: 0.500 Test Loss: 1.695 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.8625328540802
Epoch: 11, Steps: 20 | Train Loss: 0.157 Vali Loss: 1.727 Vali Acc: 0.500 Test Loss: 1.727 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.877983808517456
Epoch: 12, Steps: 20 | Train Loss: 0.100 Vali Loss: 1.744 Vali Acc: 0.560 Test Loss: 1.744 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 21313538
model size : 81.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.749731063842773
Epoch: 1, Steps: 20 | Train Loss: 0.808 Vali Loss: 0.976 Vali Acc: 0.500 Test Loss: 0.976 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 6.140457630157471
Epoch: 2, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.713 Vali Acc: 0.590 Test Loss: 0.713 Test Acc: 0.590
Validation loss decreased (-0.499990 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 6.294192552566528
Epoch: 3, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.939 Vali Acc: 0.530 Test Loss: 0.939 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.838289976119995
Epoch: 4, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.790 Vali Acc: 0.550 Test Loss: 0.790 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.73033595085144
Epoch: 5, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.922 Vali Acc: 0.530 Test Loss: 0.922 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.4404215812683105
Epoch: 6, Steps: 20 | Train Loss: 0.467 Vali Loss: 1.109 Vali Acc: 0.520 Test Loss: 1.109 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.041016578674316
Epoch: 7, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.921 Vali Acc: 0.580 Test Loss: 0.921 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.978626728057861
Epoch: 8, Steps: 20 | Train Loss: 0.362 Vali Loss: 1.513 Vali Acc: 0.590 Test Loss: 1.513 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.051135540008545
Epoch: 9, Steps: 20 | Train Loss: 0.365 Vali Loss: 1.485 Vali Acc: 0.520 Test Loss: 1.485 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.532350301742554
Epoch: 10, Steps: 20 | Train Loss: 0.218 Vali Loss: 1.577 Vali Acc: 0.590 Test Loss: 1.577 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.248706817626953
Epoch: 11, Steps: 20 | Train Loss: 0.149 Vali Loss: 1.659 Vali Acc: 0.540 Test Loss: 1.659 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.982092380523682
Epoch: 12, Steps: 20 | Train Loss: 0.084 Vali Loss: 2.064 Vali Acc: 0.590 Test Loss: 2.064 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 21313666
model size : 81.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.346792936325073
Epoch: 1, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.766 Vali Acc: 0.520 Test Loss: 0.766 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 5.95888876914978
Epoch: 2, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.778 Vali Acc: 0.540 Test Loss: 0.778 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 6.183087587356567
Epoch: 3, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.891 Vali Acc: 0.570 Test Loss: 0.891 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569991).  Saving model ...
Epoch: 4 cost time: 6.078320741653442
Epoch: 4, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.835 Vali Acc: 0.520 Test Loss: 0.835 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.04052996635437
Epoch: 5, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.775 Vali Acc: 0.600 Test Loss: 0.775 Test Acc: 0.600
Validation loss decreased (-0.569991 --> -0.599992).  Saving model ...
Epoch: 6 cost time: 6.028339147567749
Epoch: 6, Steps: 20 | Train Loss: 0.445 Vali Loss: 1.097 Vali Acc: 0.510 Test Loss: 1.097 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.833001375198364
Epoch: 7, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.971 Vali Acc: 0.560 Test Loss: 0.971 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.8535966873168945
Epoch: 8, Steps: 20 | Train Loss: 0.277 Vali Loss: 1.237 Vali Acc: 0.550 Test Loss: 1.237 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.15912938117981
Epoch: 9, Steps: 20 | Train Loss: 0.249 Vali Loss: 1.216 Vali Acc: 0.530 Test Loss: 1.216 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.6908838748931885
Epoch: 10, Steps: 20 | Train Loss: 0.149 Vali Loss: 1.046 Vali Acc: 0.590 Test Loss: 1.046 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.731024980545044
Epoch: 11, Steps: 20 | Train Loss: 0.105 Vali Loss: 1.648 Vali Acc: 0.540 Test Loss: 1.648 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.830002546310425
Epoch: 12, Steps: 20 | Train Loss: 0.069 Vali Loss: 2.201 Vali Acc: 0.570 Test Loss: 2.201 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.714068174362183
Epoch: 13, Steps: 20 | Train Loss: 0.046 Vali Loss: 1.719 Vali Acc: 0.590 Test Loss: 1.719 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.7519166469573975
Epoch: 14, Steps: 20 | Train Loss: 0.044 Vali Loss: 2.213 Vali Acc: 0.530 Test Loss: 2.213 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.377315044403076
Epoch: 15, Steps: 20 | Train Loss: 0.013 Vali Loss: 2.090 Vali Acc: 0.580 Test Loss: 2.090 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 21242114
model size : 81.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.763423442840576
Epoch: 1, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.784 Vali Acc: 0.490 Test Loss: 0.784 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 5.564451456069946
Epoch: 2, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.758 Vali Acc: 0.510 Test Loss: 0.758 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 5.343890428543091
Epoch: 3, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.710 Vali Acc: 0.600 Test Loss: 0.710 Test Acc: 0.600
Validation loss decreased (-0.509992 --> -0.599993).  Saving model ...
Epoch: 4 cost time: 5.230853080749512
Epoch: 4, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.867 Vali Acc: 0.520 Test Loss: 0.867 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.753284215927124
Epoch: 5, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.891 Vali Acc: 0.550 Test Loss: 0.891 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.46614670753479
Epoch: 6, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.897 Vali Acc: 0.520 Test Loss: 0.897 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.575166940689087
Epoch: 7, Steps: 20 | Train Loss: 0.444 Vali Loss: 1.107 Vali Acc: 0.570 Test Loss: 1.107 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.821284294128418
Epoch: 8, Steps: 20 | Train Loss: 0.417 Vali Loss: 1.007 Vali Acc: 0.560 Test Loss: 1.007 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.3476951122283936
Epoch: 9, Steps: 20 | Train Loss: 0.250 Vali Loss: 1.152 Vali Acc: 0.510 Test Loss: 1.152 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.898792743682861
Epoch: 10, Steps: 20 | Train Loss: 0.248 Vali Loss: 1.133 Vali Acc: 0.560 Test Loss: 1.133 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.5605809688568115
Epoch: 11, Steps: 20 | Train Loss: 0.120 Vali Loss: 1.380 Vali Acc: 0.580 Test Loss: 1.380 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.366092681884766
Epoch: 12, Steps: 20 | Train Loss: 0.156 Vali Loss: 2.109 Vali Acc: 0.510 Test Loss: 2.109 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.5737268924713135
Epoch: 13, Steps: 20 | Train Loss: 0.099 Vali Loss: 1.761 Vali Acc: 0.540 Test Loss: 1.761 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 21213826
model size : 81.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.522955417633057
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.732 Vali Acc: 0.480 Test Loss: 0.732 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 4.96799898147583
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.707 Vali Acc: 0.550 Test Loss: 0.707 Test Acc: 0.550
Validation loss decreased (-0.479993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 5.293845176696777
Epoch: 3, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.878 Vali Acc: 0.470 Test Loss: 0.878 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.283536195755005
Epoch: 4, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.766 Vali Acc: 0.530 Test Loss: 0.766 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.46049690246582
Epoch: 5, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.792 Vali Acc: 0.560 Test Loss: 0.792 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 6 cost time: 5.395390272140503
Epoch: 6, Steps: 20 | Train Loss: 0.428 Vali Loss: 0.869 Vali Acc: 0.520 Test Loss: 0.869 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.939407825469971
Epoch: 7, Steps: 20 | Train Loss: 0.398 Vali Loss: 0.977 Vali Acc: 0.540 Test Loss: 0.977 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.434128999710083
Epoch: 8, Steps: 20 | Train Loss: 0.349 Vali Loss: 1.061 Vali Acc: 0.530 Test Loss: 1.061 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.48516583442688
Epoch: 9, Steps: 20 | Train Loss: 0.229 Vali Loss: 1.295 Vali Acc: 0.570 Test Loss: 1.295 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569987).  Saving model ...
Epoch: 10 cost time: 4.332107782363892
Epoch: 10, Steps: 20 | Train Loss: 0.169 Vali Loss: 1.373 Vali Acc: 0.570 Test Loss: 1.373 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.334591627120972
Epoch: 11, Steps: 20 | Train Loss: 0.160 Vali Loss: 1.273 Vali Acc: 0.580 Test Loss: 1.273 Test Acc: 0.580
Validation loss decreased (-0.569987 --> -0.579987).  Saving model ...
Epoch: 12 cost time: 5.169979095458984
Epoch: 12, Steps: 20 | Train Loss: 0.089 Vali Loss: 1.570 Vali Acc: 0.520 Test Loss: 1.570 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.990743160247803
Epoch: 13, Steps: 20 | Train Loss: 0.149 Vali Loss: 2.404 Vali Acc: 0.480 Test Loss: 2.404 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.424904823303223
Epoch: 14, Steps: 20 | Train Loss: 0.052 Vali Loss: 1.651 Vali Acc: 0.540 Test Loss: 1.651 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.541743040084839
Epoch: 15, Steps: 20 | Train Loss: 0.026 Vali Loss: 1.921 Vali Acc: 0.540 Test Loss: 1.921 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.6707258224487305
Epoch: 16, Steps: 20 | Train Loss: 0.050 Vali Loss: 2.275 Vali Acc: 0.550 Test Loss: 2.275 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.13730263710022
Epoch: 17, Steps: 20 | Train Loss: 0.089 Vali Loss: 2.136 Vali Acc: 0.530 Test Loss: 2.136 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.114009618759155
Epoch: 18, Steps: 20 | Train Loss: 0.042 Vali Loss: 3.086 Vali Acc: 0.540 Test Loss: 3.086 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.236129283905029
Epoch: 19, Steps: 20 | Train Loss: 0.093 Vali Loss: 3.341 Vali Acc: 0.540 Test Loss: 3.341 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.11784291267395
Epoch: 20, Steps: 20 | Train Loss: 0.171 Vali Loss: 2.555 Vali Acc: 0.560 Test Loss: 2.555 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.260751485824585
Epoch: 21, Steps: 20 | Train Loss: 0.101 Vali Loss: 3.361 Vali Acc: 0.550 Test Loss: 3.361 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 21199746
model size : 81.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.496304750442505
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.765 Vali Acc: 0.490 Test Loss: 0.765 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 5.200885057449341
Epoch: 2, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.774 Vali Acc: 0.490 Test Loss: 0.774 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.370331764221191
Epoch: 3, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.780 Vali Acc: 0.530 Test Loss: 0.780 Test Acc: 0.530
Validation loss decreased (-0.489992 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 5.025067329406738
Epoch: 4, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.803 Vali Acc: 0.470 Test Loss: 0.803 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.843839645385742
Epoch: 5, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.829 Vali Acc: 0.550 Test Loss: 0.829 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 4.4678730964660645
Epoch: 6, Steps: 20 | Train Loss: 0.485 Vali Loss: 0.797 Vali Acc: 0.580 Test Loss: 0.797 Test Acc: 0.580
Validation loss decreased (-0.549992 --> -0.579992).  Saving model ...
Epoch: 7 cost time: 4.778609037399292
Epoch: 7, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.867 Vali Acc: 0.570 Test Loss: 0.867 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.452194929122925
Epoch: 8, Steps: 20 | Train Loss: 0.389 Vali Loss: 0.842 Vali Acc: 0.560 Test Loss: 0.842 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.1465489864349365
Epoch: 9, Steps: 20 | Train Loss: 0.294 Vali Loss: 0.863 Vali Acc: 0.620 Test Loss: 0.863 Test Acc: 0.620
Validation loss decreased (-0.579992 --> -0.619991).  Saving model ...
Epoch: 10 cost time: 4.968015670776367
Epoch: 10, Steps: 20 | Train Loss: 0.220 Vali Loss: 0.960 Vali Acc: 0.580 Test Loss: 0.960 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.533726215362549
Epoch: 11, Steps: 20 | Train Loss: 0.147 Vali Loss: 1.376 Vali Acc: 0.510 Test Loss: 1.376 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.231781244277954
Epoch: 12, Steps: 20 | Train Loss: 0.162 Vali Loss: 1.522 Vali Acc: 0.540 Test Loss: 1.522 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.968897819519043
Epoch: 13, Steps: 20 | Train Loss: 0.128 Vali Loss: 1.645 Vali Acc: 0.580 Test Loss: 1.645 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.908817768096924
Epoch: 14, Steps: 20 | Train Loss: 0.114 Vali Loss: 1.338 Vali Acc: 0.580 Test Loss: 1.338 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.930417776107788
Epoch: 15, Steps: 20 | Train Loss: 0.065 Vali Loss: 2.261 Vali Acc: 0.560 Test Loss: 2.261 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.18078875541687
Epoch: 16, Steps: 20 | Train Loss: 0.102 Vali Loss: 1.992 Vali Acc: 0.520 Test Loss: 1.992 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.12480354309082
Epoch: 17, Steps: 20 | Train Loss: 0.069 Vali Loss: 1.871 Vali Acc: 0.560 Test Loss: 1.871 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.543386697769165
Epoch: 18, Steps: 20 | Train Loss: 0.034 Vali Loss: 1.703 Vali Acc: 0.570 Test Loss: 1.703 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.861353158950806
Epoch: 19, Steps: 20 | Train Loss: 0.077 Vali Loss: 2.417 Vali Acc: 0.550 Test Loss: 2.417 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 21185794
model size : 81.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.883385896682739
Epoch: 1, Steps: 20 | Train Loss: 0.768 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 3.9404726028442383
Epoch: 2, Steps: 20 | Train Loss: 0.680 Vali Loss: 1.303 Vali Acc: 0.460 Test Loss: 1.303 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.194373369216919
Epoch: 3, Steps: 20 | Train Loss: 0.778 Vali Loss: 0.838 Vali Acc: 0.580 Test Loss: 0.838 Test Acc: 0.580
Validation loss decreased (-0.499993 --> -0.579992).  Saving model ...
Epoch: 4 cost time: 4.462131977081299
Epoch: 4, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.933 Vali Acc: 0.530 Test Loss: 0.933 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.343473672866821
Epoch: 5, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.856 Vali Acc: 0.550 Test Loss: 0.856 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.528281211853027
Epoch: 6, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.801 Vali Acc: 0.580 Test Loss: 0.801 Test Acc: 0.580
Validation loss decreased (-0.579992 --> -0.579992).  Saving model ...
Epoch: 7 cost time: 4.483632564544678
Epoch: 7, Steps: 20 | Train Loss: 0.515 Vali Loss: 1.474 Vali Acc: 0.530 Test Loss: 1.474 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.378648519515991
Epoch: 8, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.931 Vali Acc: 0.570 Test Loss: 0.931 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.484273433685303
Epoch: 9, Steps: 20 | Train Loss: 0.446 Vali Loss: 1.123 Vali Acc: 0.540 Test Loss: 1.123 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.277961015701294
Epoch: 10, Steps: 20 | Train Loss: 0.416 Vali Loss: 1.121 Vali Acc: 0.570 Test Loss: 1.121 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.976346492767334
Epoch: 11, Steps: 20 | Train Loss: 0.354 Vali Loss: 1.567 Vali Acc: 0.500 Test Loss: 1.567 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.125996828079224
Epoch: 12, Steps: 20 | Train Loss: 0.326 Vali Loss: 1.303 Vali Acc: 0.530 Test Loss: 1.303 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.087365627288818
Epoch: 13, Steps: 20 | Train Loss: 0.305 Vali Loss: 1.713 Vali Acc: 0.480 Test Loss: 1.713 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.117750883102417
Epoch: 14, Steps: 20 | Train Loss: 0.315 Vali Loss: 1.533 Vali Acc: 0.570 Test Loss: 1.533 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.9438416957855225
Epoch: 15, Steps: 20 | Train Loss: 0.169 Vali Loss: 2.170 Vali Acc: 0.480 Test Loss: 2.170 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.723020553588867
Epoch: 16, Steps: 20 | Train Loss: 0.130 Vali Loss: 1.904 Vali Acc: 0.550 Test Loss: 1.904 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 6138818
model size : 23.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.67936110496521
Epoch: 1, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.725 Vali Acc: 0.460 Test Loss: 0.725 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 3.2752974033355713
Epoch: 2, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.897 Vali Acc: 0.430 Test Loss: 0.897 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8632400035858154
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 1.015 Vali Acc: 0.490 Test Loss: 1.015 Test Acc: 0.490
Validation loss decreased (-0.459993 --> -0.489990).  Saving model ...
Epoch: 4 cost time: 3.583427906036377
Epoch: 4, Steps: 20 | Train Loss: 0.684 Vali Loss: 1.142 Vali Acc: 0.530 Test Loss: 1.142 Test Acc: 0.530
Validation loss decreased (-0.489990 --> -0.529989).  Saving model ...
Epoch: 5 cost time: 3.7502686977386475
Epoch: 5, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.749 Vali Acc: 0.580 Test Loss: 0.749 Test Acc: 0.580
Validation loss decreased (-0.529989 --> -0.579993).  Saving model ...
Epoch: 6 cost time: 3.829998731613159
Epoch: 6, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.941 Vali Acc: 0.540 Test Loss: 0.941 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.573937177658081
Epoch: 7, Steps: 20 | Train Loss: 0.473 Vali Loss: 1.074 Vali Acc: 0.520 Test Loss: 1.074 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.464188814163208
Epoch: 8, Steps: 20 | Train Loss: 0.388 Vali Loss: 0.899 Vali Acc: 0.520 Test Loss: 0.899 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.4726390838623047
Epoch: 9, Steps: 20 | Train Loss: 0.364 Vali Loss: 1.168 Vali Acc: 0.530 Test Loss: 1.168 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.5397911071777344
Epoch: 10, Steps: 20 | Train Loss: 0.279 Vali Loss: 1.029 Vali Acc: 0.540 Test Loss: 1.029 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.5582046508789062
Epoch: 11, Steps: 20 | Train Loss: 0.256 Vali Loss: 1.363 Vali Acc: 0.550 Test Loss: 1.363 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.577195405960083
Epoch: 12, Steps: 20 | Train Loss: 0.167 Vali Loss: 1.244 Vali Acc: 0.550 Test Loss: 1.244 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.6622352600097656
Epoch: 13, Steps: 20 | Train Loss: 0.126 Vali Loss: 1.462 Vali Acc: 0.530 Test Loss: 1.462 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.617326021194458
Epoch: 14, Steps: 20 | Train Loss: 0.133 Vali Loss: 1.747 Vali Acc: 0.580 Test Loss: 1.747 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.681107759475708
Epoch: 15, Steps: 20 | Train Loss: 0.065 Vali Loss: 2.107 Vali Acc: 0.520 Test Loss: 2.107 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 6052866
model size : 23.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.933604001998901
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.824 Vali Acc: 0.450 Test Loss: 0.824 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 3.7816474437713623
Epoch: 2, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.824 Vali Acc: 0.470 Test Loss: 0.824 Test Acc: 0.470
Validation loss decreased (-0.449992 --> -0.469992).  Saving model ...
Epoch: 3 cost time: 3.872953176498413
Epoch: 3, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.822 Vali Acc: 0.500 Test Loss: 0.822 Test Acc: 0.500
Validation loss decreased (-0.469992 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 3.6144001483917236
Epoch: 4, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.904 Vali Acc: 0.440 Test Loss: 0.904 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1653904914855957
Epoch: 5, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.835 Vali Acc: 0.500 Test Loss: 0.835 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9683189392089844
Epoch: 6, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.998 Vali Acc: 0.530 Test Loss: 0.998 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529990).  Saving model ...
Epoch: 7 cost time: 2.7539970874786377
Epoch: 7, Steps: 20 | Train Loss: 0.410 Vali Loss: 1.193 Vali Acc: 0.490 Test Loss: 1.193 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1402697563171387
Epoch: 8, Steps: 20 | Train Loss: 0.386 Vali Loss: 0.967 Vali Acc: 0.520 Test Loss: 0.967 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3656179904937744
Epoch: 9, Steps: 20 | Train Loss: 0.330 Vali Loss: 1.088 Vali Acc: 0.520 Test Loss: 1.088 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.2064201831817627
Epoch: 10, Steps: 20 | Train Loss: 0.319 Vali Loss: 1.427 Vali Acc: 0.540 Test Loss: 1.427 Test Acc: 0.540
Validation loss decreased (-0.529990 --> -0.539986).  Saving model ...
Epoch: 11 cost time: 3.314072608947754
Epoch: 11, Steps: 20 | Train Loss: 0.263 Vali Loss: 1.673 Vali Acc: 0.510 Test Loss: 1.673 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.8726212978363037
Epoch: 12, Steps: 20 | Train Loss: 0.276 Vali Loss: 1.407 Vali Acc: 0.540 Test Loss: 1.407 Test Acc: 0.540
Validation loss decreased (-0.539986 --> -0.539986).  Saving model ...
Epoch: 13 cost time: 3.5699007511138916
Epoch: 13, Steps: 20 | Train Loss: 0.187 Vali Loss: 1.536 Vali Acc: 0.560 Test Loss: 1.536 Test Acc: 0.560
Validation loss decreased (-0.539986 --> -0.559985).  Saving model ...
Epoch: 14 cost time: 3.518791913986206
Epoch: 14, Steps: 20 | Train Loss: 0.117 Vali Loss: 1.671 Vali Acc: 0.500 Test Loss: 1.671 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.480797052383423
Epoch: 15, Steps: 20 | Train Loss: 0.145 Vali Loss: 1.550 Vali Acc: 0.570 Test Loss: 1.550 Test Acc: 0.570
Validation loss decreased (-0.559985 --> -0.569984).  Saving model ...
Epoch: 16 cost time: 3.7900664806365967
Epoch: 16, Steps: 20 | Train Loss: 0.076 Vali Loss: 1.937 Vali Acc: 0.550 Test Loss: 1.937 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.3143019676208496
Epoch: 17, Steps: 20 | Train Loss: 0.057 Vali Loss: 1.714 Vali Acc: 0.590 Test Loss: 1.714 Test Acc: 0.590
Validation loss decreased (-0.569984 --> -0.589983).  Saving model ...
Epoch: 18 cost time: 3.3219099044799805
Epoch: 18, Steps: 20 | Train Loss: 0.033 Vali Loss: 1.868 Vali Acc: 0.520 Test Loss: 1.868 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.8865468502044678
Epoch: 19, Steps: 20 | Train Loss: 0.012 Vali Loss: 2.011 Vali Acc: 0.530 Test Loss: 2.011 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.59763503074646
Epoch: 20, Steps: 20 | Train Loss: 0.022 Vali Loss: 2.117 Vali Acc: 0.530 Test Loss: 2.117 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.662722110748291
Epoch: 21, Steps: 20 | Train Loss: 0.006 Vali Loss: 2.122 Vali Acc: 0.510 Test Loss: 2.122 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.5906636714935303
Epoch: 22, Steps: 20 | Train Loss: 0.004 Vali Loss: 2.241 Vali Acc: 0.510 Test Loss: 2.241 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.6056699752807617
Epoch: 23, Steps: 20 | Train Loss: 0.001 Vali Loss: 2.222 Vali Acc: 0.540 Test Loss: 2.222 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.175074815750122
Epoch: 24, Steps: 20 | Train Loss: 0.002 Vali Loss: 2.253 Vali Acc: 0.550 Test Loss: 2.253 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.340346097946167
Epoch: 25, Steps: 20 | Train Loss: 0.001 Vali Loss: 2.251 Vali Acc: 0.520 Test Loss: 2.251 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.441960334777832
Epoch: 26, Steps: 20 | Train Loss: 0.001 Vali Loss: 2.376 Vali Acc: 0.510 Test Loss: 2.376 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.4267914295196533
Epoch: 27, Steps: 20 | Train Loss: 0.001 Vali Loss: 2.416 Vali Acc: 0.520 Test Loss: 2.416 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 6052930
model size : 23.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.2634594440460205
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.724 Vali Acc: 0.520 Test Loss: 0.724 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 3.200984477996826
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.789 Vali Acc: 0.460 Test Loss: 0.789 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.056814432144165
Epoch: 3, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.759 Vali Acc: 0.590 Test Loss: 0.759 Test Acc: 0.590
Validation loss decreased (-0.519993 --> -0.589992).  Saving model ...
Epoch: 4 cost time: 3.415276288986206
Epoch: 4, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.819 Vali Acc: 0.510 Test Loss: 0.819 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1465506553649902
Epoch: 5, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.816 Vali Acc: 0.500 Test Loss: 0.816 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.2792892456054688
Epoch: 6, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.901 Vali Acc: 0.470 Test Loss: 0.901 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.1952295303344727
Epoch: 7, Steps: 20 | Train Loss: 0.500 Vali Loss: 1.016 Vali Acc: 0.520 Test Loss: 1.016 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.254024028778076
Epoch: 8, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.844 Vali Acc: 0.540 Test Loss: 0.844 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.140462875366211
Epoch: 9, Steps: 20 | Train Loss: 0.360 Vali Loss: 1.125 Vali Acc: 0.520 Test Loss: 1.125 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.3817524909973145
Epoch: 10, Steps: 20 | Train Loss: 0.350 Vali Loss: 0.919 Vali Acc: 0.520 Test Loss: 0.919 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.1003646850585938
Epoch: 11, Steps: 20 | Train Loss: 0.265 Vali Loss: 0.966 Vali Acc: 0.550 Test Loss: 0.966 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.947617769241333
Epoch: 12, Steps: 20 | Train Loss: 0.226 Vali Loss: 1.145 Vali Acc: 0.540 Test Loss: 1.145 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.6898155212402344
Epoch: 13, Steps: 20 | Train Loss: 0.167 Vali Loss: 1.146 Vali Acc: 0.540 Test Loss: 1.146 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 6017154
model size : 23.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.179977655410767
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.735 Vali Acc: 0.470 Test Loss: 0.735 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 3.0930428504943848
Epoch: 2, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.719 Vali Acc: 0.560 Test Loss: 0.719 Test Acc: 0.560
Validation loss decreased (-0.469993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 3.0001437664031982
Epoch: 3, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.738 Vali Acc: 0.490 Test Loss: 0.738 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0311734676361084
Epoch: 4, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.769 Vali Acc: 0.500 Test Loss: 0.769 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0489161014556885
Epoch: 5, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.835 Vali Acc: 0.550 Test Loss: 0.835 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.101588010787964
Epoch: 6, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.896 Vali Acc: 0.510 Test Loss: 0.896 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.0653152465820312
Epoch: 7, Steps: 20 | Train Loss: 0.497 Vali Loss: 0.797 Vali Acc: 0.520 Test Loss: 0.797 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.0667059421539307
Epoch: 8, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.773 Vali Acc: 0.600 Test Loss: 0.773 Test Acc: 0.600
Validation loss decreased (-0.559993 --> -0.599992).  Saving model ...
Epoch: 9 cost time: 3.141279935836792
Epoch: 9, Steps: 20 | Train Loss: 0.373 Vali Loss: 0.929 Vali Acc: 0.540 Test Loss: 0.929 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.09604811668396
Epoch: 10, Steps: 20 | Train Loss: 0.324 Vali Loss: 0.973 Vali Acc: 0.500 Test Loss: 0.973 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.0314557552337646
Epoch: 11, Steps: 20 | Train Loss: 0.261 Vali Loss: 0.949 Vali Acc: 0.510 Test Loss: 0.949 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7100579738616943
Epoch: 12, Steps: 20 | Train Loss: 0.202 Vali Loss: 1.108 Vali Acc: 0.520 Test Loss: 1.108 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.888828754425049
Epoch: 13, Steps: 20 | Train Loss: 0.139 Vali Loss: 1.329 Vali Acc: 0.520 Test Loss: 1.329 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.6346817016601562
Epoch: 14, Steps: 20 | Train Loss: 0.095 Vali Loss: 1.337 Vali Acc: 0.530 Test Loss: 1.337 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.749136447906494
Epoch: 15, Steps: 20 | Train Loss: 0.077 Vali Loss: 1.373 Vali Acc: 0.570 Test Loss: 1.373 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.5341882705688477
Epoch: 16, Steps: 20 | Train Loss: 0.069 Vali Loss: 1.479 Vali Acc: 0.570 Test Loss: 1.479 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.851848602294922
Epoch: 17, Steps: 20 | Train Loss: 0.034 Vali Loss: 1.621 Vali Acc: 0.570 Test Loss: 1.621 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.5243163108825684
Epoch: 18, Steps: 20 | Train Loss: 0.035 Vali Loss: 1.789 Vali Acc: 0.580 Test Loss: 1.789 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 6003010
model size : 23.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.06674337387085
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.703 Vali Acc: 0.480 Test Loss: 0.703 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 3.023926019668579
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.795 Vali Acc: 0.470 Test Loss: 0.795 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.798741340637207
Epoch: 3, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.737 Vali Acc: 0.560 Test Loss: 0.737 Test Acc: 0.560
Validation loss decreased (-0.479993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 2.8215396404266357
Epoch: 4, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.802 Vali Acc: 0.540 Test Loss: 0.802 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6415767669677734
Epoch: 5, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.736 Vali Acc: 0.540 Test Loss: 0.736 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.712580680847168
Epoch: 6, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.820 Vali Acc: 0.510 Test Loss: 0.820 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.6190316677093506
Epoch: 7, Steps: 20 | Train Loss: 0.484 Vali Loss: 0.857 Vali Acc: 0.530 Test Loss: 0.857 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.4867610931396484
Epoch: 8, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.932 Vali Acc: 0.470 Test Loss: 0.932 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.0281870365142822
Epoch: 9, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.872 Vali Acc: 0.570 Test Loss: 0.872 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569991).  Saving model ...
Epoch: 10 cost time: 3.0395679473876953
Epoch: 10, Steps: 20 | Train Loss: 0.369 Vali Loss: 0.846 Vali Acc: 0.560 Test Loss: 0.846 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.815180778503418
Epoch: 11, Steps: 20 | Train Loss: 0.282 Vali Loss: 0.926 Vali Acc: 0.580 Test Loss: 0.926 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579991).  Saving model ...
Epoch: 12 cost time: 2.6930675506591797
Epoch: 12, Steps: 20 | Train Loss: 0.209 Vali Loss: 0.957 Vali Acc: 0.530 Test Loss: 0.957 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.802511215209961
Epoch: 13, Steps: 20 | Train Loss: 0.165 Vali Loss: 0.950 Vali Acc: 0.570 Test Loss: 0.950 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.9195587635040283
Epoch: 14, Steps: 20 | Train Loss: 0.115 Vali Loss: 1.218 Vali Acc: 0.520 Test Loss: 1.218 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.059819459915161
Epoch: 15, Steps: 20 | Train Loss: 0.082 Vali Loss: 1.326 Vali Acc: 0.580 Test Loss: 1.326 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.0286104679107666
Epoch: 16, Steps: 20 | Train Loss: 0.084 Vali Loss: 1.494 Vali Acc: 0.550 Test Loss: 1.494 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.0085747241973877
Epoch: 17, Steps: 20 | Train Loss: 0.085 Vali Loss: 1.361 Vali Acc: 0.570 Test Loss: 1.361 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.0335936546325684
Epoch: 18, Steps: 20 | Train Loss: 0.045 Vali Loss: 1.676 Vali Acc: 0.560 Test Loss: 1.676 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.9784059524536133
Epoch: 19, Steps: 20 | Train Loss: 0.036 Vali Loss: 1.974 Vali Acc: 0.520 Test Loss: 1.974 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.9579527378082275
Epoch: 20, Steps: 20 | Train Loss: 0.012 Vali Loss: 1.905 Vali Acc: 0.540 Test Loss: 1.905 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.0110719203948975
Epoch: 21, Steps: 20 | Train Loss: 0.016 Vali Loss: 1.761 Vali Acc: 0.580 Test Loss: 1.761 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 5995970
model size : 22.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.185423374176025
Epoch: 1, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.726 Vali Acc: 0.490 Test Loss: 0.726 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.7589941024780273
Epoch: 2, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.743 Vali Acc: 0.440 Test Loss: 0.743 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6743385791778564
Epoch: 3, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.790 Vali Acc: 0.490 Test Loss: 0.790 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8244831562042236
Epoch: 4, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.731 Vali Acc: 0.540 Test Loss: 0.731 Test Acc: 0.540
Validation loss decreased (-0.489993 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 2.6826863288879395
Epoch: 5, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.711 Vali Acc: 0.590 Test Loss: 0.711 Test Acc: 0.590
Validation loss decreased (-0.539993 --> -0.589993).  Saving model ...
Epoch: 6 cost time: 2.9673290252685547
Epoch: 6, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.931 Vali Acc: 0.490 Test Loss: 0.931 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0403077602386475
Epoch: 7, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.832 Vali Acc: 0.570 Test Loss: 0.832 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8257946968078613
Epoch: 8, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.809 Vali Acc: 0.520 Test Loss: 0.809 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.006333827972412
Epoch: 9, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.790 Vali Acc: 0.560 Test Loss: 0.790 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.940237522125244
Epoch: 10, Steps: 20 | Train Loss: 0.390 Vali Loss: 0.882 Vali Acc: 0.550 Test Loss: 0.882 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.1857693195343018
Epoch: 11, Steps: 20 | Train Loss: 0.309 Vali Loss: 0.813 Vali Acc: 0.600 Test Loss: 0.813 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599992).  Saving model ...
Epoch: 12 cost time: 3.0077321529388428
Epoch: 12, Steps: 20 | Train Loss: 0.244 Vali Loss: 0.945 Vali Acc: 0.540 Test Loss: 0.945 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3595221042633057
Epoch: 13, Steps: 20 | Train Loss: 0.185 Vali Loss: 1.050 Vali Acc: 0.560 Test Loss: 1.050 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.378624439239502
Epoch: 14, Steps: 20 | Train Loss: 0.142 Vali Loss: 1.511 Vali Acc: 0.520 Test Loss: 1.511 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.4198617935180664
Epoch: 15, Steps: 20 | Train Loss: 0.162 Vali Loss: 1.160 Vali Acc: 0.580 Test Loss: 1.160 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.9481093883514404
Epoch: 16, Steps: 20 | Train Loss: 0.061 Vali Loss: 1.338 Vali Acc: 0.510 Test Loss: 1.338 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.1028268337249756
Epoch: 17, Steps: 20 | Train Loss: 0.055 Vali Loss: 1.466 Vali Acc: 0.580 Test Loss: 1.466 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.9696996212005615
Epoch: 18, Steps: 20 | Train Loss: 0.043 Vali Loss: 1.512 Vali Acc: 0.570 Test Loss: 1.512 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.002286911010742
Epoch: 19, Steps: 20 | Train Loss: 0.012 Vali Loss: 1.481 Vali Acc: 0.540 Test Loss: 1.481 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.0405807495117188
Epoch: 20, Steps: 20 | Train Loss: 0.006 Vali Loss: 1.555 Vali Acc: 0.540 Test Loss: 1.555 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.066817045211792
Epoch: 21, Steps: 20 | Train Loss: 0.004 Vali Loss: 1.615 Vali Acc: 0.530 Test Loss: 1.615 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 5988994
model size : 22.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.764228582382202
Epoch: 1, Steps: 20 | Train Loss: 0.754 Vali Loss: 0.706 Vali Acc: 0.550 Test Loss: 0.706 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 3.0495083332061768
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.827192783355713
Epoch: 3, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.710 Vali Acc: 0.570 Test Loss: 0.710 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 3.346618413925171
Epoch: 4, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.833 Vali Acc: 0.550 Test Loss: 0.833 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9272890090942383
Epoch: 5, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.899 Vali Acc: 0.540 Test Loss: 0.899 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1672749519348145
Epoch: 6, Steps: 20 | Train Loss: 0.647 Vali Loss: 1.003 Vali Acc: 0.520 Test Loss: 1.003 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.0379245281219482
Epoch: 7, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.890 Vali Acc: 0.540 Test Loss: 0.890 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.2218353748321533
Epoch: 8, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.868 Vali Acc: 0.580 Test Loss: 0.868 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579991).  Saving model ...
Epoch: 9 cost time: 2.830374240875244
Epoch: 9, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.855 Vali Acc: 0.590 Test Loss: 0.855 Test Acc: 0.590
Validation loss decreased (-0.579991 --> -0.589991).  Saving model ...
Epoch: 10 cost time: 2.875394582748413
Epoch: 10, Steps: 20 | Train Loss: 0.421 Vali Loss: 1.022 Vali Acc: 0.540 Test Loss: 1.022 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.1229419708251953
Epoch: 11, Steps: 20 | Train Loss: 0.371 Vali Loss: 0.935 Vali Acc: 0.570 Test Loss: 0.935 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.709730386734009
Epoch: 12, Steps: 20 | Train Loss: 0.337 Vali Loss: 1.220 Vali Acc: 0.490 Test Loss: 1.220 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1587424278259277
Epoch: 13, Steps: 20 | Train Loss: 0.319 Vali Loss: 1.078 Vali Acc: 0.620 Test Loss: 1.078 Test Acc: 0.620
Validation loss decreased (-0.589991 --> -0.619989).  Saving model ...
Epoch: 14 cost time: 3.067101001739502
Epoch: 14, Steps: 20 | Train Loss: 0.284 Vali Loss: 1.279 Vali Acc: 0.580 Test Loss: 1.279 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.760505437850952
Epoch: 15, Steps: 20 | Train Loss: 0.228 Vali Loss: 1.369 Vali Acc: 0.590 Test Loss: 1.369 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.071531295776367
Epoch: 16, Steps: 20 | Train Loss: 0.222 Vali Loss: 1.177 Vali Acc: 0.560 Test Loss: 1.177 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0533175468444824
Epoch: 17, Steps: 20 | Train Loss: 0.133 Vali Loss: 1.451 Vali Acc: 0.580 Test Loss: 1.451 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0770208835601807
Epoch: 18, Steps: 20 | Train Loss: 0.068 Vali Loss: 1.504 Vali Acc: 0.550 Test Loss: 1.504 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.859157085418701
Epoch: 19, Steps: 20 | Train Loss: 0.099 Vali Loss: 1.905 Vali Acc: 0.560 Test Loss: 1.905 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.1298673152923584
Epoch: 20, Steps: 20 | Train Loss: 0.114 Vali Loss: 1.766 Vali Acc: 0.610 Test Loss: 1.766 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.8261353969573975
Epoch: 21, Steps: 20 | Train Loss: 0.081 Vali Loss: 2.076 Vali Acc: 0.540 Test Loss: 2.076 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.892324924468994
Epoch: 22, Steps: 20 | Train Loss: 0.073 Vali Loss: 2.260 Vali Acc: 0.570 Test Loss: 2.260 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.2972638607025146
Epoch: 23, Steps: 20 | Train Loss: 0.027 Vali Loss: 2.215 Vali Acc: 0.530 Test Loss: 2.215 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1918434
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4853222370147705
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.185408592224121
Epoch: 2, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.749 Vali Acc: 0.520 Test Loss: 0.749 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 2.629864454269409
Epoch: 3, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.711 Vali Acc: 0.610 Test Loss: 0.711 Test Acc: 0.610
Validation loss decreased (-0.519993 --> -0.609993).  Saving model ...
Epoch: 4 cost time: 2.544795036315918
Epoch: 4, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.740 Vali Acc: 0.520 Test Loss: 0.740 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6193201541900635
Epoch: 5, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.916 Vali Acc: 0.530 Test Loss: 0.916 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5816240310668945
Epoch: 6, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.837 Vali Acc: 0.550 Test Loss: 0.837 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0820913314819336
Epoch: 7, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.981 Vali Acc: 0.550 Test Loss: 0.981 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.3451857566833496
Epoch: 8, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.898 Vali Acc: 0.580 Test Loss: 0.898 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.343151807785034
Epoch: 9, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.969 Vali Acc: 0.510 Test Loss: 0.969 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.630295991897583
Epoch: 10, Steps: 20 | Train Loss: 0.399 Vali Loss: 0.864 Vali Acc: 0.520 Test Loss: 0.864 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.510655641555786
Epoch: 11, Steps: 20 | Train Loss: 0.325 Vali Loss: 0.883 Vali Acc: 0.550 Test Loss: 0.883 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.3324849605560303
Epoch: 12, Steps: 20 | Train Loss: 0.295 Vali Loss: 0.957 Vali Acc: 0.540 Test Loss: 0.957 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.717426300048828
Epoch: 13, Steps: 20 | Train Loss: 0.234 Vali Loss: 1.125 Vali Acc: 0.510 Test Loss: 1.125 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1875458
model size : 7.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4309046268463135
Epoch: 1, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.764 Vali Acc: 0.460 Test Loss: 0.764 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 2.187800407409668
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.713 Vali Acc: 0.540 Test Loss: 0.713 Test Acc: 0.540
Validation loss decreased (-0.459992 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 2.3592464923858643
Epoch: 3, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.843 Vali Acc: 0.500 Test Loss: 0.843 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.452047824859619
Epoch: 4, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.849 Vali Acc: 0.520 Test Loss: 0.849 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6484053134918213
Epoch: 5, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.836 Vali Acc: 0.520 Test Loss: 0.836 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3934717178344727
Epoch: 6, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.724 Vali Acc: 0.530 Test Loss: 0.724 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.3145804405212402
Epoch: 7, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.767 Vali Acc: 0.580 Test Loss: 0.767 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579992).  Saving model ...
Epoch: 8 cost time: 2.5594289302825928
Epoch: 8, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.810 Vali Acc: 0.480 Test Loss: 0.810 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2412357330322266
Epoch: 9, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.864 Vali Acc: 0.560 Test Loss: 0.864 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.370195150375366
Epoch: 10, Steps: 20 | Train Loss: 0.422 Vali Loss: 0.960 Vali Acc: 0.510 Test Loss: 0.960 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.07145357131958
Epoch: 11, Steps: 20 | Train Loss: 0.359 Vali Loss: 0.899 Vali Acc: 0.540 Test Loss: 0.899 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.318941831588745
Epoch: 12, Steps: 20 | Train Loss: 0.323 Vali Loss: 0.820 Vali Acc: 0.590 Test Loss: 0.820 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589992).  Saving model ...
Epoch: 13 cost time: 2.3143720626831055
Epoch: 13, Steps: 20 | Train Loss: 0.253 Vali Loss: 1.054 Vali Acc: 0.520 Test Loss: 1.054 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4331228733062744
Epoch: 14, Steps: 20 | Train Loss: 0.199 Vali Loss: 1.161 Vali Acc: 0.570 Test Loss: 1.161 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.4390714168548584
Epoch: 15, Steps: 20 | Train Loss: 0.206 Vali Loss: 1.178 Vali Acc: 0.560 Test Loss: 1.178 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.131329298019409
Epoch: 16, Steps: 20 | Train Loss: 0.146 Vali Loss: 1.393 Vali Acc: 0.520 Test Loss: 1.393 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9461369514465332
Epoch: 17, Steps: 20 | Train Loss: 0.104 Vali Loss: 1.363 Vali Acc: 0.530 Test Loss: 1.363 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8500003814697266
Epoch: 18, Steps: 20 | Train Loss: 0.076 Vali Loss: 1.304 Vali Acc: 0.530 Test Loss: 1.304 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8805773258209229
Epoch: 19, Steps: 20 | Train Loss: 0.058 Vali Loss: 1.602 Vali Acc: 0.480 Test Loss: 1.602 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8052759170532227
Epoch: 20, Steps: 20 | Train Loss: 0.037 Vali Loss: 1.542 Vali Acc: 0.530 Test Loss: 1.542 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.29620623588562
Epoch: 21, Steps: 20 | Train Loss: 0.019 Vali Loss: 1.522 Vali Acc: 0.530 Test Loss: 1.522 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.2877519130706787
Epoch: 22, Steps: 20 | Train Loss: 0.014 Vali Loss: 1.695 Vali Acc: 0.520 Test Loss: 1.695 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1875490
model size : 7.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5913774967193604
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.722 Vali Acc: 0.470 Test Loss: 0.722 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 2.2929928302764893
Epoch: 2, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 2.073152780532837
Epoch: 3, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.692 Vali Acc: 0.540 Test Loss: 0.692 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 2.280428647994995
Epoch: 4, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.701 Vali Acc: 0.580 Test Loss: 0.701 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579993).  Saving model ...
Epoch: 5 cost time: 2.2027697563171387
Epoch: 5, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.786 Vali Acc: 0.480 Test Loss: 0.786 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1774632930755615
Epoch: 6, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.726 Vali Acc: 0.570 Test Loss: 0.726 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6729390621185303
Epoch: 7, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.792 Vali Acc: 0.580 Test Loss: 0.792 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2850074768066406
Epoch: 8, Steps: 20 | Train Loss: 0.497 Vali Loss: 0.842 Vali Acc: 0.540 Test Loss: 0.842 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.367154836654663
Epoch: 9, Steps: 20 | Train Loss: 0.461 Vali Loss: 1.000 Vali Acc: 0.570 Test Loss: 1.000 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.535642623901367
Epoch: 10, Steps: 20 | Train Loss: 0.432 Vali Loss: 0.796 Vali Acc: 0.620 Test Loss: 0.796 Test Acc: 0.620
Validation loss decreased (-0.579993 --> -0.619992).  Saving model ...
Epoch: 11 cost time: 1.967942237854004
Epoch: 11, Steps: 20 | Train Loss: 0.397 Vali Loss: 0.769 Vali Acc: 0.630 Test Loss: 0.769 Test Acc: 0.630
Validation loss decreased (-0.619992 --> -0.629992).  Saving model ...
Epoch: 12 cost time: 2.1361658573150635
Epoch: 12, Steps: 20 | Train Loss: 0.348 Vali Loss: 0.859 Vali Acc: 0.590 Test Loss: 0.859 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.970545768737793
Epoch: 13, Steps: 20 | Train Loss: 0.312 Vali Loss: 0.990 Vali Acc: 0.570 Test Loss: 0.990 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.230165719985962
Epoch: 14, Steps: 20 | Train Loss: 0.243 Vali Loss: 0.980 Vali Acc: 0.570 Test Loss: 0.980 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.396303653717041
Epoch: 15, Steps: 20 | Train Loss: 0.210 Vali Loss: 0.967 Vali Acc: 0.590 Test Loss: 0.967 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.3880348205566406
Epoch: 16, Steps: 20 | Train Loss: 0.151 Vali Loss: 1.040 Vali Acc: 0.630 Test Loss: 1.040 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.339146852493286
Epoch: 17, Steps: 20 | Train Loss: 0.138 Vali Loss: 1.271 Vali Acc: 0.540 Test Loss: 1.271 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.314373254776001
Epoch: 18, Steps: 20 | Train Loss: 0.124 Vali Loss: 1.335 Vali Acc: 0.590 Test Loss: 1.335 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.146413564682007
Epoch: 19, Steps: 20 | Train Loss: 0.081 Vali Loss: 1.900 Vali Acc: 0.530 Test Loss: 1.900 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.016239643096924
Epoch: 20, Steps: 20 | Train Loss: 0.080 Vali Loss: 1.393 Vali Acc: 0.590 Test Loss: 1.393 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.114889621734619
Epoch: 21, Steps: 20 | Train Loss: 0.044 Vali Loss: 1.617 Vali Acc: 0.580 Test Loss: 1.617 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 1857602
model size : 7.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.188887596130371
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.700 Vali Acc: 0.430 Test Loss: 0.700 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 2.359025001525879
Epoch: 2, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.760 Vali Acc: 0.420 Test Loss: 0.760 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.336242198944092
Epoch: 3, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.762 Vali Acc: 0.530 Test Loss: 0.762 Test Acc: 0.530
Validation loss decreased (-0.429993 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 1.9597296714782715
Epoch: 4, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.756 Vali Acc: 0.530 Test Loss: 0.756 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529992).  Saving model ...
Epoch: 5 cost time: 2.1737401485443115
Epoch: 5, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.757 Vali Acc: 0.560 Test Loss: 0.757 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559992).  Saving model ...
Epoch: 6 cost time: 2.3964591026306152
Epoch: 6, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.763 Vali Acc: 0.550 Test Loss: 0.763 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0941152572631836
Epoch: 7, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.790 Vali Acc: 0.520 Test Loss: 0.790 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.18257212638855
Epoch: 8, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.755 Vali Acc: 0.510 Test Loss: 0.755 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.5068814754486084
Epoch: 9, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.774 Vali Acc: 0.550 Test Loss: 0.774 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.378006935119629
Epoch: 10, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.797 Vali Acc: 0.560 Test Loss: 0.797 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.226572036743164
Epoch: 11, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.809 Vali Acc: 0.520 Test Loss: 0.809 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.493494987487793
Epoch: 12, Steps: 20 | Train Loss: 0.391 Vali Loss: 0.781 Vali Acc: 0.580 Test Loss: 0.781 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579992).  Saving model ...
Epoch: 13 cost time: 2.1757752895355225
Epoch: 13, Steps: 20 | Train Loss: 0.343 Vali Loss: 0.912 Vali Acc: 0.540 Test Loss: 0.912 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9514026641845703
Epoch: 14, Steps: 20 | Train Loss: 0.302 Vali Loss: 0.888 Vali Acc: 0.570 Test Loss: 0.888 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3834614753723145
Epoch: 15, Steps: 20 | Train Loss: 0.247 Vali Loss: 0.985 Vali Acc: 0.570 Test Loss: 0.985 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9489538669586182
Epoch: 16, Steps: 20 | Train Loss: 0.177 Vali Loss: 0.976 Vali Acc: 0.520 Test Loss: 0.976 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.987370252609253
Epoch: 17, Steps: 20 | Train Loss: 0.147 Vali Loss: 1.084 Vali Acc: 0.530 Test Loss: 1.084 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.0694000720977783
Epoch: 18, Steps: 20 | Train Loss: 0.104 Vali Loss: 1.227 Vali Acc: 0.540 Test Loss: 1.227 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.042278528213501
Epoch: 19, Steps: 20 | Train Loss: 0.081 Vali Loss: 1.196 Vali Acc: 0.560 Test Loss: 1.196 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9779558181762695
Epoch: 20, Steps: 20 | Train Loss: 0.050 Vali Loss: 1.257 Vali Acc: 0.550 Test Loss: 1.257 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.3145499229431152
Epoch: 21, Steps: 20 | Train Loss: 0.036 Vali Loss: 1.385 Vali Acc: 0.560 Test Loss: 1.385 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.1423449516296387
Epoch: 22, Steps: 20 | Train Loss: 0.022 Vali Loss: 1.484 Vali Acc: 0.570 Test Loss: 1.484 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1850530
model size : 7.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.422319173812866
Epoch: 1, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.700 Vali Acc: 0.540 Test Loss: 0.700 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.343423843383789
Epoch: 2, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.736 Vali Acc: 0.490 Test Loss: 0.736 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.232754707336426
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.737 Vali Acc: 0.510 Test Loss: 0.737 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.290644407272339
Epoch: 4, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.763 Vali Acc: 0.520 Test Loss: 0.763 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3590004444122314
Epoch: 5, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.773 Vali Acc: 0.510 Test Loss: 0.773 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8560264110565186
Epoch: 6, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.746 Vali Acc: 0.510 Test Loss: 0.746 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.974064588546753
Epoch: 7, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.745 Vali Acc: 0.500 Test Loss: 0.745 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.075462579727173
Epoch: 8, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.796 Vali Acc: 0.490 Test Loss: 0.796 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.986337661743164
Epoch: 9, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.777 Vali Acc: 0.520 Test Loss: 0.777 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8991713523864746
Epoch: 10, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.724 Vali Acc: 0.620 Test Loss: 0.724 Test Acc: 0.620
Validation loss decreased (-0.539993 --> -0.619993).  Saving model ...
Epoch: 11 cost time: 2.3705031871795654
Epoch: 11, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.781 Vali Acc: 0.550 Test Loss: 0.781 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.177264928817749
Epoch: 12, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.789 Vali Acc: 0.570 Test Loss: 0.789 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.165588617324829
Epoch: 13, Steps: 20 | Train Loss: 0.341 Vali Loss: 0.777 Vali Acc: 0.580 Test Loss: 0.777 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7325003147125244
Epoch: 14, Steps: 20 | Train Loss: 0.317 Vali Loss: 0.826 Vali Acc: 0.520 Test Loss: 0.826 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0756139755249023
Epoch: 15, Steps: 20 | Train Loss: 0.242 Vali Loss: 0.797 Vali Acc: 0.640 Test Loss: 0.797 Test Acc: 0.640
Validation loss decreased (-0.619993 --> -0.639992).  Saving model ...
Epoch: 16 cost time: 2.2387166023254395
Epoch: 16, Steps: 20 | Train Loss: 0.212 Vali Loss: 0.956 Vali Acc: 0.520 Test Loss: 0.956 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8443281650543213
Epoch: 17, Steps: 20 | Train Loss: 0.155 Vali Loss: 1.170 Vali Acc: 0.510 Test Loss: 1.170 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7251982688903809
Epoch: 18, Steps: 20 | Train Loss: 0.104 Vali Loss: 1.033 Vali Acc: 0.530 Test Loss: 1.033 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8609488010406494
Epoch: 19, Steps: 20 | Train Loss: 0.067 Vali Loss: 1.245 Vali Acc: 0.530 Test Loss: 1.245 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.026961326599121
Epoch: 20, Steps: 20 | Train Loss: 0.052 Vali Loss: 1.207 Vali Acc: 0.560 Test Loss: 1.207 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8829376697540283
Epoch: 21, Steps: 20 | Train Loss: 0.031 Vali Loss: 1.371 Vali Acc: 0.560 Test Loss: 1.371 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.2759838104248047
Epoch: 22, Steps: 20 | Train Loss: 0.020 Vali Loss: 1.333 Vali Acc: 0.540 Test Loss: 1.333 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.005122661590576
Epoch: 23, Steps: 20 | Train Loss: 0.015 Vali Loss: 1.563 Vali Acc: 0.550 Test Loss: 1.563 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.3609237670898438
Epoch: 24, Steps: 20 | Train Loss: 0.009 Vali Loss: 1.464 Vali Acc: 0.570 Test Loss: 1.464 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.323361873626709
Epoch: 25, Steps: 20 | Train Loss: 0.006 Vali Loss: 1.563 Vali Acc: 0.550 Test Loss: 1.563 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 1847010
model size : 7.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.369136095046997
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.695 Vali Acc: 0.460 Test Loss: 0.695 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.971952199935913
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.713 Vali Acc: 0.470 Test Loss: 0.713 Test Acc: 0.470
Validation loss decreased (-0.459993 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 2.008589267730713
Epoch: 3, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.770 Vali Acc: 0.490 Test Loss: 0.770 Test Acc: 0.490
Validation loss decreased (-0.469993 --> -0.489992).  Saving model ...
Epoch: 4 cost time: 1.9249563217163086
Epoch: 4, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.731 Vali Acc: 0.510 Test Loss: 0.731 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 1.8071975708007812
Epoch: 5, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.736 Vali Acc: 0.500 Test Loss: 0.736 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.986631155014038
Epoch: 6, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.767 Vali Acc: 0.530 Test Loss: 0.767 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529992).  Saving model ...
Epoch: 7 cost time: 2.0129873752593994
Epoch: 7, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.740 Vali Acc: 0.540 Test Loss: 0.740 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539993).  Saving model ...
Epoch: 8 cost time: 2.158701181411743
Epoch: 8, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.735 Vali Acc: 0.580 Test Loss: 0.735 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579993).  Saving model ...
Epoch: 9 cost time: 2.1357831954956055
Epoch: 9, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.795 Vali Acc: 0.550 Test Loss: 0.795 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.258049488067627
Epoch: 10, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.842 Vali Acc: 0.540 Test Loss: 0.842 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.202515125274658
Epoch: 11, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.891 Vali Acc: 0.530 Test Loss: 0.891 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.3433148860931396
Epoch: 12, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.781 Vali Acc: 0.530 Test Loss: 0.781 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1812384128570557
Epoch: 13, Steps: 20 | Train Loss: 0.391 Vali Loss: 0.822 Vali Acc: 0.540 Test Loss: 0.822 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.241109848022461
Epoch: 14, Steps: 20 | Train Loss: 0.336 Vali Loss: 0.812 Vali Acc: 0.560 Test Loss: 0.812 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.3199498653411865
Epoch: 15, Steps: 20 | Train Loss: 0.276 Vali Loss: 0.947 Vali Acc: 0.550 Test Loss: 0.947 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.091414451599121
Epoch: 16, Steps: 20 | Train Loss: 0.248 Vali Loss: 0.912 Vali Acc: 0.540 Test Loss: 0.912 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.1268210411071777
Epoch: 17, Steps: 20 | Train Loss: 0.165 Vali Loss: 0.949 Vali Acc: 0.580 Test Loss: 0.949 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.4730947017669678
Epoch: 18, Steps: 20 | Train Loss: 0.110 Vali Loss: 1.070 Vali Acc: 0.550 Test Loss: 1.070 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1843522
model size : 7.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.929073333740234
Epoch: 1, Steps: 20 | Train Loss: 1.402 Vali Loss: 1.119 Vali Acc: 0.550 Test Loss: 1.119 Test Acc: 0.550
Validation loss decreased (inf --> -0.549989).  Saving model ...
Epoch: 2 cost time: 6.495589733123779
Epoch: 2, Steps: 20 | Train Loss: 1.563 Vali Loss: 2.230 Vali Acc: 0.580 Test Loss: 2.230 Test Acc: 0.580
Validation loss decreased (-0.549989 --> -0.579978).  Saving model ...
Epoch: 3 cost time: 7.086538314819336
Epoch: 3, Steps: 20 | Train Loss: 1.872 Vali Loss: 2.569 Vali Acc: 0.540 Test Loss: 2.569 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.946438789367676
Epoch: 4, Steps: 20 | Train Loss: 2.779 Vali Loss: 2.710 Vali Acc: 0.540 Test Loss: 2.710 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.645659685134888
Epoch: 5, Steps: 20 | Train Loss: 2.231 Vali Loss: 6.394 Vali Acc: 0.580 Test Loss: 6.394 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.802687644958496
Epoch: 6, Steps: 20 | Train Loss: 2.953 Vali Loss: 5.288 Vali Acc: 0.540 Test Loss: 5.288 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.082176923751831
Epoch: 7, Steps: 20 | Train Loss: 2.233 Vali Loss: 5.771 Vali Acc: 0.520 Test Loss: 5.771 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.948232889175415
Epoch: 8, Steps: 20 | Train Loss: 3.048 Vali Loss: 2.519 Vali Acc: 0.610 Test Loss: 2.519 Test Acc: 0.610
Validation loss decreased (-0.579978 --> -0.609975).  Saving model ...
Epoch: 9 cost time: 7.1751039028167725
Epoch: 9, Steps: 20 | Train Loss: 1.333 Vali Loss: 3.048 Vali Acc: 0.520 Test Loss: 3.048 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.422550916671753
Epoch: 10, Steps: 20 | Train Loss: 0.927 Vali Loss: 2.750 Vali Acc: 0.600 Test Loss: 2.750 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.153096437454224
Epoch: 11, Steps: 20 | Train Loss: 0.847 Vali Loss: 4.636 Vali Acc: 0.480 Test Loss: 4.636 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.23438835144043
Epoch: 12, Steps: 20 | Train Loss: 0.477 Vali Loss: 2.697 Vali Acc: 0.560 Test Loss: 2.697 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.902105331420898
Epoch: 13, Steps: 20 | Train Loss: 0.350 Vali Loss: 2.922 Vali Acc: 0.590 Test Loss: 2.922 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.6312220096588135
Epoch: 14, Steps: 20 | Train Loss: 0.252 Vali Loss: 2.818 Vali Acc: 0.640 Test Loss: 2.818 Test Acc: 0.640
Validation loss decreased (-0.609975 --> -0.639972).  Saving model ...
Epoch: 15 cost time: 7.048732757568359
Epoch: 15, Steps: 20 | Train Loss: 0.506 Vali Loss: 3.214 Vali Acc: 0.580 Test Loss: 3.214 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.158002138137817
Epoch: 16, Steps: 20 | Train Loss: 0.633 Vali Loss: 2.947 Vali Acc: 0.570 Test Loss: 2.947 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.573265314102173
Epoch: 17, Steps: 20 | Train Loss: 0.524 Vali Loss: 4.160 Vali Acc: 0.520 Test Loss: 4.160 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.218017339706421
Epoch: 18, Steps: 20 | Train Loss: 0.669 Vali Loss: 3.829 Vali Acc: 0.580 Test Loss: 3.829 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.073967695236206
Epoch: 19, Steps: 20 | Train Loss: 0.613 Vali Loss: 3.568 Vali Acc: 0.560 Test Loss: 3.568 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.65561556816101
Epoch: 20, Steps: 20 | Train Loss: 0.100 Vali Loss: 3.956 Vali Acc: 0.560 Test Loss: 3.956 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 9.157594919204712
Epoch: 21, Steps: 20 | Train Loss: 0.230 Vali Loss: 4.318 Vali Acc: 0.570 Test Loss: 4.318 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 8.944636821746826
Epoch: 22, Steps: 20 | Train Loss: 0.176 Vali Loss: 4.497 Vali Acc: 0.530 Test Loss: 4.497 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 8.974255561828613
Epoch: 23, Steps: 20 | Train Loss: 0.185 Vali Loss: 6.015 Vali Acc: 0.500 Test Loss: 6.015 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 8.393765687942505
Epoch: 24, Steps: 20 | Train Loss: 0.389 Vali Loss: 6.494 Vali Acc: 0.580 Test Loss: 6.494 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 17233666
model size : 65.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.40910530090332
Epoch: 1, Steps: 20 | Train Loss: 0.849 Vali Loss: 1.042 Vali Acc: 0.410 Test Loss: 1.042 Test Acc: 0.410
Validation loss decreased (inf --> -0.409990).  Saving model ...
Epoch: 2 cost time: 5.22091817855835
Epoch: 2, Steps: 20 | Train Loss: 1.011 Vali Loss: 0.964 Vali Acc: 0.560 Test Loss: 0.964 Test Acc: 0.560
Validation loss decreased (-0.409990 --> -0.559990).  Saving model ...
Epoch: 3 cost time: 5.268282651901245
Epoch: 3, Steps: 20 | Train Loss: 1.104 Vali Loss: 2.094 Vali Acc: 0.540 Test Loss: 2.094 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.851146936416626
Epoch: 4, Steps: 20 | Train Loss: 0.910 Vali Loss: 1.745 Vali Acc: 0.590 Test Loss: 1.745 Test Acc: 0.590
Validation loss decreased (-0.559990 --> -0.589983).  Saving model ...
Epoch: 5 cost time: 5.085093975067139
Epoch: 5, Steps: 20 | Train Loss: 1.292 Vali Loss: 1.929 Vali Acc: 0.490 Test Loss: 1.929 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.927568435668945
Epoch: 6, Steps: 20 | Train Loss: 0.769 Vali Loss: 3.641 Vali Acc: 0.480 Test Loss: 3.641 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.9321818351745605
Epoch: 7, Steps: 20 | Train Loss: 0.906 Vali Loss: 1.745 Vali Acc: 0.530 Test Loss: 1.745 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.305371284484863
Epoch: 8, Steps: 20 | Train Loss: 0.851 Vali Loss: 2.234 Vali Acc: 0.580 Test Loss: 2.234 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.464136123657227
Epoch: 9, Steps: 20 | Train Loss: 0.833 Vali Loss: 2.931 Vali Acc: 0.580 Test Loss: 2.931 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.311815977096558
Epoch: 10, Steps: 20 | Train Loss: 0.702 Vali Loss: 4.585 Vali Acc: 0.510 Test Loss: 4.585 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.47760534286499
Epoch: 11, Steps: 20 | Train Loss: 0.765 Vali Loss: 2.816 Vali Acc: 0.550 Test Loss: 2.816 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.673285484313965
Epoch: 12, Steps: 20 | Train Loss: 0.690 Vali Loss: 2.900 Vali Acc: 0.570 Test Loss: 2.900 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.3051440715789795
Epoch: 13, Steps: 20 | Train Loss: 0.954 Vali Loss: 4.521 Vali Acc: 0.560 Test Loss: 4.521 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.437589645385742
Epoch: 14, Steps: 20 | Train Loss: 0.794 Vali Loss: 4.835 Vali Acc: 0.530 Test Loss: 4.835 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 16875522
model size : 64.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.794119596481323
Epoch: 1, Steps: 20 | Train Loss: 0.895 Vali Loss: 0.903 Vali Acc: 0.560 Test Loss: 0.903 Test Acc: 0.560
Validation loss decreased (inf --> -0.559991).  Saving model ...
Epoch: 2 cost time: 5.4905712604522705
Epoch: 2, Steps: 20 | Train Loss: 1.064 Vali Loss: 1.548 Vali Acc: 0.530 Test Loss: 1.548 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.252473592758179
Epoch: 3, Steps: 20 | Train Loss: 1.055 Vali Loss: 1.687 Vali Acc: 0.530 Test Loss: 1.687 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.585827112197876
Epoch: 4, Steps: 20 | Train Loss: 0.862 Vali Loss: 2.051 Vali Acc: 0.530 Test Loss: 2.051 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.648664951324463
Epoch: 5, Steps: 20 | Train Loss: 1.436 Vali Loss: 3.140 Vali Acc: 0.560 Test Loss: 3.140 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.547812461853027
Epoch: 6, Steps: 20 | Train Loss: 0.953 Vali Loss: 1.866 Vali Acc: 0.600 Test Loss: 1.866 Test Acc: 0.600
Validation loss decreased (-0.559991 --> -0.599981).  Saving model ...
Epoch: 7 cost time: 5.20853590965271
Epoch: 7, Steps: 20 | Train Loss: 0.794 Vali Loss: 2.105 Vali Acc: 0.530 Test Loss: 2.105 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.383205413818359
Epoch: 8, Steps: 20 | Train Loss: 1.137 Vali Loss: 3.796 Vali Acc: 0.490 Test Loss: 3.796 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.375899314880371
Epoch: 9, Steps: 20 | Train Loss: 1.124 Vali Loss: 3.141 Vali Acc: 0.540 Test Loss: 3.141 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.678195476531982
Epoch: 10, Steps: 20 | Train Loss: 0.893 Vali Loss: 2.586 Vali Acc: 0.640 Test Loss: 2.586 Test Acc: 0.640
Validation loss decreased (-0.599981 --> -0.639974).  Saving model ...
Epoch: 11 cost time: 5.219078779220581
Epoch: 11, Steps: 20 | Train Loss: 1.034 Vali Loss: 3.647 Vali Acc: 0.550 Test Loss: 3.647 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.267260313034058
Epoch: 12, Steps: 20 | Train Loss: 0.925 Vali Loss: 3.207 Vali Acc: 0.560 Test Loss: 3.207 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.58574104309082
Epoch: 13, Steps: 20 | Train Loss: 0.728 Vali Loss: 3.126 Vali Acc: 0.590 Test Loss: 3.126 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.180891752243042
Epoch: 14, Steps: 20 | Train Loss: 0.920 Vali Loss: 3.621 Vali Acc: 0.500 Test Loss: 3.621 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.504798889160156
Epoch: 15, Steps: 20 | Train Loss: 0.430 Vali Loss: 5.165 Vali Acc: 0.540 Test Loss: 5.165 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.167869329452515
Epoch: 16, Steps: 20 | Train Loss: 0.427 Vali Loss: 3.044 Vali Acc: 0.530 Test Loss: 3.044 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.123032093048096
Epoch: 17, Steps: 20 | Train Loss: 0.380 Vali Loss: 3.966 Vali Acc: 0.550 Test Loss: 3.966 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.793212413787842
Epoch: 18, Steps: 20 | Train Loss: 0.177 Vali Loss: 4.530 Vali Acc: 0.530 Test Loss: 4.530 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.311530113220215
Epoch: 19, Steps: 20 | Train Loss: 0.101 Vali Loss: 3.727 Vali Acc: 0.540 Test Loss: 3.727 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.56193995475769
Epoch: 20, Steps: 20 | Train Loss: 0.031 Vali Loss: 3.928 Vali Acc: 0.510 Test Loss: 3.928 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 16875778
model size : 64.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.677937746047974
Epoch: 1, Steps: 20 | Train Loss: 0.818 Vali Loss: 1.261 Vali Acc: 0.540 Test Loss: 1.261 Test Acc: 0.540
Validation loss decreased (inf --> -0.539987).  Saving model ...
Epoch: 2 cost time: 4.580212593078613
Epoch: 2, Steps: 20 | Train Loss: 0.835 Vali Loss: 0.964 Vali Acc: 0.600 Test Loss: 0.964 Test Acc: 0.600
Validation loss decreased (-0.539987 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 4.531182289123535
Epoch: 3, Steps: 20 | Train Loss: 0.618 Vali Loss: 1.482 Vali Acc: 0.530 Test Loss: 1.482 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.257588863372803
Epoch: 4, Steps: 20 | Train Loss: 1.128 Vali Loss: 2.363 Vali Acc: 0.530 Test Loss: 2.363 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.752821207046509
Epoch: 5, Steps: 20 | Train Loss: 1.065 Vali Loss: 1.447 Vali Acc: 0.550 Test Loss: 1.447 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.187420845031738
Epoch: 6, Steps: 20 | Train Loss: 0.670 Vali Loss: 1.750 Vali Acc: 0.570 Test Loss: 1.750 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.24079704284668
Epoch: 7, Steps: 20 | Train Loss: 0.589 Vali Loss: 2.053 Vali Acc: 0.520 Test Loss: 2.053 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.473600625991821
Epoch: 8, Steps: 20 | Train Loss: 0.467 Vali Loss: 1.838 Vali Acc: 0.600 Test Loss: 1.838 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.288742542266846
Epoch: 9, Steps: 20 | Train Loss: 0.482 Vali Loss: 2.770 Vali Acc: 0.550 Test Loss: 2.770 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.307007312774658
Epoch: 10, Steps: 20 | Train Loss: 0.457 Vali Loss: 3.785 Vali Acc: 0.530 Test Loss: 3.785 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.323562145233154
Epoch: 11, Steps: 20 | Train Loss: 0.622 Vali Loss: 3.098 Vali Acc: 0.550 Test Loss: 3.098 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.7944083213806152
Epoch: 12, Steps: 20 | Train Loss: 0.670 Vali Loss: 2.814 Vali Acc: 0.590 Test Loss: 2.814 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 16747010
model size : 64.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.665739059448242
Epoch: 1, Steps: 20 | Train Loss: 0.845 Vali Loss: 0.843 Vali Acc: 0.510 Test Loss: 0.843 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 4.320857524871826
Epoch: 2, Steps: 20 | Train Loss: 0.867 Vali Loss: 1.094 Vali Acc: 0.530 Test Loss: 1.094 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529989).  Saving model ...
Epoch: 3 cost time: 4.563138484954834
Epoch: 3, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.990 Vali Acc: 0.530 Test Loss: 0.990 Test Acc: 0.530
Validation loss decreased (-0.529989 --> -0.529990).  Saving model ...
Epoch: 4 cost time: 4.326504707336426
Epoch: 4, Steps: 20 | Train Loss: 0.807 Vali Loss: 1.487 Vali Acc: 0.480 Test Loss: 1.487 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.128610610961914
Epoch: 5, Steps: 20 | Train Loss: 0.582 Vali Loss: 1.073 Vali Acc: 0.610 Test Loss: 1.073 Test Acc: 0.610
Validation loss decreased (-0.529990 --> -0.609989).  Saving model ...
Epoch: 6 cost time: 4.459166526794434
Epoch: 6, Steps: 20 | Train Loss: 0.721 Vali Loss: 1.469 Vali Acc: 0.560 Test Loss: 1.469 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.240431785583496
Epoch: 7, Steps: 20 | Train Loss: 0.450 Vali Loss: 1.630 Vali Acc: 0.510 Test Loss: 1.630 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.327225923538208
Epoch: 8, Steps: 20 | Train Loss: 0.595 Vali Loss: 1.262 Vali Acc: 0.600 Test Loss: 1.262 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.03668737411499
Epoch: 9, Steps: 20 | Train Loss: 0.365 Vali Loss: 1.287 Vali Acc: 0.610 Test Loss: 1.287 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.143320798873901
Epoch: 10, Steps: 20 | Train Loss: 0.341 Vali Loss: 2.074 Vali Acc: 0.590 Test Loss: 2.074 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.9107413291931152
Epoch: 11, Steps: 20 | Train Loss: 0.502 Vali Loss: 2.960 Vali Acc: 0.510 Test Loss: 2.960 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.888484239578247
Epoch: 12, Steps: 20 | Train Loss: 0.416 Vali Loss: 2.163 Vali Acc: 0.600 Test Loss: 2.163 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.9715988636016846
Epoch: 13, Steps: 20 | Train Loss: 0.263 Vali Loss: 2.245 Vali Acc: 0.600 Test Loss: 2.245 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.388277292251587
Epoch: 14, Steps: 20 | Train Loss: 0.382 Vali Loss: 3.063 Vali Acc: 0.550 Test Loss: 3.063 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.47376823425293
Epoch: 15, Steps: 20 | Train Loss: 0.349 Vali Loss: 2.593 Vali Acc: 0.610 Test Loss: 2.593 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 16690434
model size : 63.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.30307149887085
Epoch: 1, Steps: 20 | Train Loss: 0.787 Vali Loss: 1.014 Vali Acc: 0.520 Test Loss: 1.014 Test Acc: 0.520
Validation loss decreased (inf --> -0.519990).  Saving model ...
Epoch: 2 cost time: 4.4920430183410645
Epoch: 2, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.775 Vali Acc: 0.620 Test Loss: 0.775 Test Acc: 0.620
Validation loss decreased (-0.519990 --> -0.619992).  Saving model ...
Epoch: 3 cost time: 4.380608081817627
Epoch: 3, Steps: 20 | Train Loss: 0.772 Vali Loss: 1.971 Vali Acc: 0.510 Test Loss: 1.971 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.348707675933838
Epoch: 4, Steps: 20 | Train Loss: 0.679 Vali Loss: 1.322 Vali Acc: 0.550 Test Loss: 1.322 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.149334192276001
Epoch: 5, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.938 Vali Acc: 0.540 Test Loss: 0.938 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.059195518493652
Epoch: 6, Steps: 20 | Train Loss: 0.429 Vali Loss: 0.928 Vali Acc: 0.630 Test Loss: 0.928 Test Acc: 0.630
Validation loss decreased (-0.619992 --> -0.629991).  Saving model ...
Epoch: 7 cost time: 3.7460520267486572
Epoch: 7, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.951 Vali Acc: 0.600 Test Loss: 0.951 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.937072277069092
Epoch: 8, Steps: 20 | Train Loss: 0.436 Vali Loss: 1.035 Vali Acc: 0.590 Test Loss: 1.035 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.432825565338135
Epoch: 9, Steps: 20 | Train Loss: 0.322 Vali Loss: 1.682 Vali Acc: 0.580 Test Loss: 1.682 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.268214225769043
Epoch: 10, Steps: 20 | Train Loss: 0.289 Vali Loss: 1.673 Vali Acc: 0.540 Test Loss: 1.673 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.582013368606567
Epoch: 11, Steps: 20 | Train Loss: 0.257 Vali Loss: 1.769 Vali Acc: 0.580 Test Loss: 1.769 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.453874826431274
Epoch: 12, Steps: 20 | Train Loss: 0.274 Vali Loss: 1.658 Vali Acc: 0.600 Test Loss: 1.658 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.463509798049927
Epoch: 13, Steps: 20 | Train Loss: 0.127 Vali Loss: 1.587 Vali Acc: 0.540 Test Loss: 1.587 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.475136995315552
Epoch: 14, Steps: 20 | Train Loss: 0.193 Vali Loss: 2.367 Vali Acc: 0.600 Test Loss: 2.367 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.306490182876587
Epoch: 15, Steps: 20 | Train Loss: 0.273 Vali Loss: 2.428 Vali Acc: 0.580 Test Loss: 2.428 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.8422679901123047
Epoch: 16, Steps: 20 | Train Loss: 0.172 Vali Loss: 1.949 Vali Acc: 0.580 Test Loss: 1.949 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 16662274
model size : 63.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.36679744720459
Epoch: 1, Steps: 20 | Train Loss: 0.766 Vali Loss: 0.771 Vali Acc: 0.500 Test Loss: 0.771 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 4.127180814743042
Epoch: 2, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.695 Vali Acc: 0.590 Test Loss: 0.695 Test Acc: 0.590
Validation loss decreased (-0.499992 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 4.181965112686157
Epoch: 3, Steps: 20 | Train Loss: 0.640 Vali Loss: 1.170 Vali Acc: 0.540 Test Loss: 1.170 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.226975440979004
Epoch: 4, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.999 Vali Acc: 0.560 Test Loss: 0.999 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.101778507232666
Epoch: 5, Steps: 20 | Train Loss: 0.559 Vali Loss: 1.025 Vali Acc: 0.530 Test Loss: 1.025 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.260055780410767
Epoch: 6, Steps: 20 | Train Loss: 0.455 Vali Loss: 1.069 Vali Acc: 0.510 Test Loss: 1.069 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.239908218383789
Epoch: 7, Steps: 20 | Train Loss: 0.495 Vali Loss: 1.347 Vali Acc: 0.540 Test Loss: 1.347 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.424196720123291
Epoch: 8, Steps: 20 | Train Loss: 0.413 Vali Loss: 1.352 Vali Acc: 0.600 Test Loss: 1.352 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599986).  Saving model ...
Epoch: 9 cost time: 4.3634350299835205
Epoch: 9, Steps: 20 | Train Loss: 0.534 Vali Loss: 2.163 Vali Acc: 0.520 Test Loss: 2.163 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.206546306610107
Epoch: 10, Steps: 20 | Train Loss: 0.439 Vali Loss: 1.115 Vali Acc: 0.570 Test Loss: 1.115 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.304748296737671
Epoch: 11, Steps: 20 | Train Loss: 0.285 Vali Loss: 1.282 Vali Acc: 0.580 Test Loss: 1.282 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.164153814315796
Epoch: 12, Steps: 20 | Train Loss: 0.246 Vali Loss: 2.406 Vali Acc: 0.510 Test Loss: 2.406 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.010814189910889
Epoch: 13, Steps: 20 | Train Loss: 0.308 Vali Loss: 1.560 Vali Acc: 0.620 Test Loss: 1.560 Test Acc: 0.620
Validation loss decreased (-0.599986 --> -0.619984).  Saving model ...
Epoch: 14 cost time: 3.730360746383667
Epoch: 14, Steps: 20 | Train Loss: 0.449 Vali Loss: 1.670 Vali Acc: 0.570 Test Loss: 1.670 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7297191619873047
Epoch: 15, Steps: 20 | Train Loss: 0.209 Vali Loss: 2.752 Vali Acc: 0.500 Test Loss: 2.752 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.304514408111572
Epoch: 16, Steps: 20 | Train Loss: 0.357 Vali Loss: 3.322 Vali Acc: 0.510 Test Loss: 3.322 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.145856618881226
Epoch: 17, Steps: 20 | Train Loss: 0.202 Vali Loss: 1.854 Vali Acc: 0.550 Test Loss: 1.854 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.0766565799713135
Epoch: 18, Steps: 20 | Train Loss: 0.106 Vali Loss: 2.488 Vali Acc: 0.530 Test Loss: 2.488 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.331772089004517
Epoch: 19, Steps: 20 | Train Loss: 0.057 Vali Loss: 1.844 Vali Acc: 0.560 Test Loss: 1.844 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.216424942016602
Epoch: 20, Steps: 20 | Train Loss: 0.043 Vali Loss: 2.313 Vali Acc: 0.570 Test Loss: 2.313 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.8081283569335938
Epoch: 21, Steps: 20 | Train Loss: 0.039 Vali Loss: 2.655 Vali Acc: 0.560 Test Loss: 2.655 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.6645188331604004
Epoch: 22, Steps: 20 | Train Loss: 0.250 Vali Loss: 2.944 Vali Acc: 0.520 Test Loss: 2.944 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.3415563106536865
Epoch: 23, Steps: 20 | Train Loss: 0.114 Vali Loss: 1.979 Vali Acc: 0.550 Test Loss: 1.979 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 16620034
model size : 63.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.322600603103638
Epoch: 1, Steps: 20 | Train Loss: 0.981 Vali Loss: 1.240 Vali Acc: 0.480 Test Loss: 1.240 Test Acc: 0.480
Validation loss decreased (inf --> -0.479988).  Saving model ...
Epoch: 2 cost time: 4.159184694290161
Epoch: 2, Steps: 20 | Train Loss: 1.211 Vali Loss: 1.201 Vali Acc: 0.490 Test Loss: 1.201 Test Acc: 0.490
Validation loss decreased (-0.479988 --> -0.489988).  Saving model ...
Epoch: 3 cost time: 4.586730241775513
Epoch: 3, Steps: 20 | Train Loss: 1.214 Vali Loss: 2.187 Vali Acc: 0.500 Test Loss: 2.187 Test Acc: 0.500
Validation loss decreased (-0.489988 --> -0.499978).  Saving model ...
Epoch: 4 cost time: 4.531565427780151
Epoch: 4, Steps: 20 | Train Loss: 0.894 Vali Loss: 2.247 Vali Acc: 0.540 Test Loss: 2.247 Test Acc: 0.540
Validation loss decreased (-0.499978 --> -0.539978).  Saving model ...
Epoch: 5 cost time: 4.3048179149627686
Epoch: 5, Steps: 20 | Train Loss: 1.316 Vali Loss: 2.097 Vali Acc: 0.550 Test Loss: 2.097 Test Acc: 0.550
Validation loss decreased (-0.539978 --> -0.549979).  Saving model ...
Epoch: 6 cost time: 4.4400599002838135
Epoch: 6, Steps: 20 | Train Loss: 1.372 Vali Loss: 2.839 Vali Acc: 0.480 Test Loss: 2.839 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.420499324798584
Epoch: 7, Steps: 20 | Train Loss: 1.345 Vali Loss: 3.683 Vali Acc: 0.550 Test Loss: 3.683 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.439971923828125
Epoch: 8, Steps: 20 | Train Loss: 1.625 Vali Loss: 3.193 Vali Acc: 0.620 Test Loss: 3.193 Test Acc: 0.620
Validation loss decreased (-0.549979 --> -0.619968).  Saving model ...
Epoch: 9 cost time: 4.049917936325073
Epoch: 9, Steps: 20 | Train Loss: 1.550 Vali Loss: 3.450 Vali Acc: 0.540 Test Loss: 3.450 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.057443618774414
Epoch: 10, Steps: 20 | Train Loss: 1.114 Vali Loss: 2.459 Vali Acc: 0.550 Test Loss: 2.459 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.5654449462890625
Epoch: 11, Steps: 20 | Train Loss: 0.715 Vali Loss: 2.547 Vali Acc: 0.540 Test Loss: 2.547 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.253949165344238
Epoch: 12, Steps: 20 | Train Loss: 0.446 Vali Loss: 2.258 Vali Acc: 0.570 Test Loss: 2.258 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.829993486404419
Epoch: 13, Steps: 20 | Train Loss: 0.610 Vali Loss: 2.999 Vali Acc: 0.540 Test Loss: 2.999 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.0216333866119385
Epoch: 14, Steps: 20 | Train Loss: 0.362 Vali Loss: 2.542 Vali Acc: 0.580 Test Loss: 2.542 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.240424156188965
Epoch: 15, Steps: 20 | Train Loss: 0.424 Vali Loss: 2.172 Vali Acc: 0.600 Test Loss: 2.172 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.229191303253174
Epoch: 16, Steps: 20 | Train Loss: 0.264 Vali Loss: 2.208 Vali Acc: 0.630 Test Loss: 2.208 Test Acc: 0.630
Validation loss decreased (-0.619968 --> -0.629978).  Saving model ...
Epoch: 17 cost time: 4.594976186752319
Epoch: 17, Steps: 20 | Train Loss: 0.234 Vali Loss: 2.086 Vali Acc: 0.540 Test Loss: 2.086 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.0463573932647705
Epoch: 18, Steps: 20 | Train Loss: 0.107 Vali Loss: 2.464 Vali Acc: 0.630 Test Loss: 2.464 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.251943588256836
Epoch: 19, Steps: 20 | Train Loss: 0.112 Vali Loss: 2.610 Vali Acc: 0.610 Test Loss: 2.610 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.143641948699951
Epoch: 20, Steps: 20 | Train Loss: 0.246 Vali Loss: 3.566 Vali Acc: 0.560 Test Loss: 3.566 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.4988768100738525
Epoch: 21, Steps: 20 | Train Loss: 0.245 Vali Loss: 3.195 Vali Acc: 0.550 Test Loss: 3.195 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.354301452636719
Epoch: 22, Steps: 20 | Train Loss: 0.081 Vali Loss: 3.917 Vali Acc: 0.520 Test Loss: 3.917 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.8240373134613037
Epoch: 23, Steps: 20 | Train Loss: 0.126 Vali Loss: 2.604 Vali Acc: 0.640 Test Loss: 2.604 Test Acc: 0.640
Validation loss decreased (-0.629978 --> -0.639974).  Saving model ...
Epoch: 24 cost time: 4.225475311279297
Epoch: 24, Steps: 20 | Train Loss: 0.091 Vali Loss: 3.270 Vali Acc: 0.550 Test Loss: 3.270 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.117692470550537
Epoch: 25, Steps: 20 | Train Loss: 0.060 Vali Loss: 3.772 Vali Acc: 0.560 Test Loss: 3.772 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.296092987060547
Epoch: 26, Steps: 20 | Train Loss: 0.088 Vali Loss: 3.538 Vali Acc: 0.610 Test Loss: 3.538 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.089979410171509
Epoch: 27, Steps: 20 | Train Loss: 0.049 Vali Loss: 3.239 Vali Acc: 0.570 Test Loss: 3.239 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.9886906147003174
Epoch: 28, Steps: 20 | Train Loss: 0.051 Vali Loss: 4.312 Vali Acc: 0.540 Test Loss: 4.312 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.264150381088257
Epoch: 29, Steps: 20 | Train Loss: 0.081 Vali Loss: 3.709 Vali Acc: 0.600 Test Loss: 3.709 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.302274703979492
Epoch: 30, Steps: 20 | Train Loss: 0.092 Vali Loss: 4.406 Vali Acc: 0.580 Test Loss: 4.406 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.235448598861694
Epoch: 31, Steps: 20 | Train Loss: 0.060 Vali Loss: 4.026 Vali Acc: 0.540 Test Loss: 4.026 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 4.299805164337158
Epoch: 32, Steps: 20 | Train Loss: 0.033 Vali Loss: 4.154 Vali Acc: 0.560 Test Loss: 4.154 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 4.262381315231323
Epoch: 33, Steps: 20 | Train Loss: 0.113 Vali Loss: 3.634 Vali Acc: 0.660 Test Loss: 3.634 Test Acc: 0.660
Validation loss decreased (-0.639974 --> -0.659964).  Saving model ...
Epoch: 34 cost time: 4.313737154006958
Epoch: 34, Steps: 20 | Train Loss: 0.063 Vali Loss: 4.146 Vali Acc: 0.580 Test Loss: 4.146 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 4.318471431732178
Epoch: 35, Steps: 20 | Train Loss: 0.117 Vali Loss: 5.159 Vali Acc: 0.580 Test Loss: 5.159 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 4.287922382354736
Epoch: 36, Steps: 20 | Train Loss: 0.239 Vali Loss: 4.569 Vali Acc: 0.580 Test Loss: 4.569 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.9225709438323975
Epoch: 37, Steps: 20 | Train Loss: 0.138 Vali Loss: 4.034 Vali Acc: 0.560 Test Loss: 4.034 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 4.243690013885498
Epoch: 38, Steps: 20 | Train Loss: 0.053 Vali Loss: 4.340 Vali Acc: 0.610 Test Loss: 4.340 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.7593026161193848
Epoch: 39, Steps: 20 | Train Loss: 0.026 Vali Loss: 4.353 Vali Acc: 0.610 Test Loss: 4.353 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.971998453140259
Epoch: 40, Steps: 20 | Train Loss: 0.144 Vali Loss: 4.094 Vali Acc: 0.600 Test Loss: 4.094 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 4.191378355026245
Epoch: 41, Steps: 20 | Train Loss: 0.087 Vali Loss: 5.108 Vali Acc: 0.580 Test Loss: 5.108 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 4.12786078453064
Epoch: 42, Steps: 20 | Train Loss: 0.064 Vali Loss: 4.783 Vali Acc: 0.540 Test Loss: 4.783 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 4.397954702377319
Epoch: 43, Steps: 20 | Train Loss: 0.017 Vali Loss: 5.100 Vali Acc: 0.610 Test Loss: 5.100 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 4946818
model size : 18.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.9016640186309814
Epoch: 1, Steps: 20 | Train Loss: 0.869 Vali Loss: 0.889 Vali Acc: 0.560 Test Loss: 0.889 Test Acc: 0.560
Validation loss decreased (inf --> -0.559991).  Saving model ...
Epoch: 2 cost time: 2.553504228591919
Epoch: 2, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.929 Vali Acc: 0.640 Test Loss: 0.929 Test Acc: 0.640
Validation loss decreased (-0.559991 --> -0.639991).  Saving model ...
Epoch: 3 cost time: 2.4692351818084717
Epoch: 3, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.830 Vali Acc: 0.570 Test Loss: 0.830 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.427190065383911
Epoch: 4, Steps: 20 | Train Loss: 0.701 Vali Loss: 1.178 Vali Acc: 0.600 Test Loss: 1.178 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.739938735961914
Epoch: 5, Steps: 20 | Train Loss: 0.555 Vali Loss: 1.366 Vali Acc: 0.600 Test Loss: 1.366 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.495927572250366
Epoch: 6, Steps: 20 | Train Loss: 0.498 Vali Loss: 1.668 Vali Acc: 0.520 Test Loss: 1.668 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.4152631759643555
Epoch: 7, Steps: 20 | Train Loss: 0.527 Vali Loss: 1.207 Vali Acc: 0.590 Test Loss: 1.207 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3702290058135986
Epoch: 8, Steps: 20 | Train Loss: 0.759 Vali Loss: 3.354 Vali Acc: 0.440 Test Loss: 3.354 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.486649990081787
Epoch: 9, Steps: 20 | Train Loss: 0.785 Vali Loss: 2.612 Vali Acc: 0.540 Test Loss: 2.612 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.4677278995513916
Epoch: 10, Steps: 20 | Train Loss: 0.863 Vali Loss: 2.768 Vali Acc: 0.540 Test Loss: 2.768 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.506894111633301
Epoch: 11, Steps: 20 | Train Loss: 0.484 Vali Loss: 2.669 Vali Acc: 0.500 Test Loss: 2.669 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.554417133331299
Epoch: 12, Steps: 20 | Train Loss: 0.336 Vali Loss: 2.218 Vali Acc: 0.580 Test Loss: 2.218 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 4767746
model size : 18.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.569492816925049
Epoch: 1, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.811 Vali Acc: 0.570 Test Loss: 0.811 Test Acc: 0.570
Validation loss decreased (inf --> -0.569992).  Saving model ...
Epoch: 2 cost time: 2.561126708984375
Epoch: 2, Steps: 20 | Train Loss: 0.838 Vali Loss: 0.894 Vali Acc: 0.580 Test Loss: 0.894 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579991).  Saving model ...
Epoch: 3 cost time: 2.4972057342529297
Epoch: 3, Steps: 20 | Train Loss: 0.873 Vali Loss: 1.246 Vali Acc: 0.520 Test Loss: 1.246 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.476809501647949
Epoch: 4, Steps: 20 | Train Loss: 0.841 Vali Loss: 1.825 Vali Acc: 0.460 Test Loss: 1.825 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.454136371612549
Epoch: 5, Steps: 20 | Train Loss: 1.162 Vali Loss: 2.418 Vali Acc: 0.520 Test Loss: 2.418 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.485201597213745
Epoch: 6, Steps: 20 | Train Loss: 0.985 Vali Loss: 1.382 Vali Acc: 0.560 Test Loss: 1.382 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.410155773162842
Epoch: 7, Steps: 20 | Train Loss: 0.706 Vali Loss: 2.092 Vali Acc: 0.530 Test Loss: 2.092 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.353215217590332
Epoch: 8, Steps: 20 | Train Loss: 0.642 Vali Loss: 1.918 Vali Acc: 0.520 Test Loss: 1.918 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.428741931915283
Epoch: 9, Steps: 20 | Train Loss: 0.543 Vali Loss: 1.475 Vali Acc: 0.570 Test Loss: 1.475 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.3351948261260986
Epoch: 10, Steps: 20 | Train Loss: 0.511 Vali Loss: 1.557 Vali Acc: 0.590 Test Loss: 1.557 Test Acc: 0.590
Validation loss decreased (-0.579991 --> -0.589984).  Saving model ...
Epoch: 11 cost time: 2.4210989475250244
Epoch: 11, Steps: 20 | Train Loss: 0.387 Vali Loss: 1.877 Vali Acc: 0.550 Test Loss: 1.877 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.386756181716919
Epoch: 12, Steps: 20 | Train Loss: 0.704 Vali Loss: 2.586 Vali Acc: 0.480 Test Loss: 2.586 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.582390546798706
Epoch: 13, Steps: 20 | Train Loss: 0.498 Vali Loss: 2.558 Vali Acc: 0.540 Test Loss: 2.558 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7616419792175293
Epoch: 14, Steps: 20 | Train Loss: 0.699 Vali Loss: 2.271 Vali Acc: 0.640 Test Loss: 2.271 Test Acc: 0.640
Validation loss decreased (-0.589984 --> -0.639977).  Saving model ...
Epoch: 15 cost time: 1.899571180343628
Epoch: 15, Steps: 20 | Train Loss: 0.285 Vali Loss: 2.588 Vali Acc: 0.580 Test Loss: 2.588 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9217827320098877
Epoch: 16, Steps: 20 | Train Loss: 0.169 Vali Loss: 2.708 Vali Acc: 0.580 Test Loss: 2.708 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8293638229370117
Epoch: 17, Steps: 20 | Train Loss: 0.084 Vali Loss: 2.324 Vali Acc: 0.620 Test Loss: 2.324 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.3941099643707275
Epoch: 18, Steps: 20 | Train Loss: 0.155 Vali Loss: 2.611 Vali Acc: 0.560 Test Loss: 2.611 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.5571372509002686
Epoch: 19, Steps: 20 | Train Loss: 0.123 Vali Loss: 3.446 Vali Acc: 0.540 Test Loss: 3.446 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.5295157432556152
Epoch: 20, Steps: 20 | Train Loss: 0.085 Vali Loss: 3.201 Vali Acc: 0.550 Test Loss: 3.201 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.4950454235076904
Epoch: 21, Steps: 20 | Train Loss: 0.072 Vali Loss: 4.081 Vali Acc: 0.530 Test Loss: 4.081 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.4432287216186523
Epoch: 22, Steps: 20 | Train Loss: 0.169 Vali Loss: 4.912 Vali Acc: 0.460 Test Loss: 4.912 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.4684014320373535
Epoch: 23, Steps: 20 | Train Loss: 0.124 Vali Loss: 3.504 Vali Acc: 0.540 Test Loss: 3.504 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.2413580417633057
Epoch: 24, Steps: 20 | Train Loss: 0.065 Vali Loss: 3.727 Vali Acc: 0.540 Test Loss: 3.727 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 4767874
model size : 18.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.102808713912964
Epoch: 1, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.774 Vali Acc: 0.470 Test Loss: 0.774 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 2.1966681480407715
Epoch: 2, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.802 Vali Acc: 0.470 Test Loss: 0.802 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.372708320617676
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.995 Vali Acc: 0.520 Test Loss: 0.995 Test Acc: 0.520
Validation loss decreased (-0.469992 --> -0.519990).  Saving model ...
Epoch: 4 cost time: 2.4232492446899414
Epoch: 4, Steps: 20 | Train Loss: 0.553 Vali Loss: 1.059 Vali Acc: 0.620 Test Loss: 1.059 Test Acc: 0.620
Validation loss decreased (-0.519990 --> -0.619989).  Saving model ...
Epoch: 5 cost time: 2.216207981109619
Epoch: 5, Steps: 20 | Train Loss: 0.571 Vali Loss: 1.021 Vali Acc: 0.500 Test Loss: 1.021 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0923566818237305
Epoch: 6, Steps: 20 | Train Loss: 0.578 Vali Loss: 1.099 Vali Acc: 0.580 Test Loss: 1.099 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.284325122833252
Epoch: 7, Steps: 20 | Train Loss: 0.668 Vali Loss: 1.389 Vali Acc: 0.520 Test Loss: 1.389 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.233818531036377
Epoch: 8, Steps: 20 | Train Loss: 0.462 Vali Loss: 1.178 Vali Acc: 0.550 Test Loss: 1.178 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.443514347076416
Epoch: 9, Steps: 20 | Train Loss: 0.400 Vali Loss: 1.440 Vali Acc: 0.500 Test Loss: 1.440 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.358135938644409
Epoch: 10, Steps: 20 | Train Loss: 0.434 Vali Loss: 1.443 Vali Acc: 0.560 Test Loss: 1.443 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.3419039249420166
Epoch: 11, Steps: 20 | Train Loss: 0.531 Vali Loss: 1.596 Vali Acc: 0.540 Test Loss: 1.596 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.3552308082580566
Epoch: 12, Steps: 20 | Train Loss: 0.227 Vali Loss: 1.691 Vali Acc: 0.580 Test Loss: 1.691 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.120816946029663
Epoch: 13, Steps: 20 | Train Loss: 0.281 Vali Loss: 2.286 Vali Acc: 0.560 Test Loss: 2.286 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.213108539581299
Epoch: 14, Steps: 20 | Train Loss: 0.182 Vali Loss: 1.894 Vali Acc: 0.600 Test Loss: 1.894 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 4703490
model size : 18.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2576022148132324
Epoch: 1, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.778 Vali Acc: 0.570 Test Loss: 0.778 Test Acc: 0.570
Validation loss decreased (inf --> -0.569992).  Saving model ...
Epoch: 2 cost time: 2.0293989181518555
Epoch: 2, Steps: 20 | Train Loss: 0.857 Vali Loss: 0.771 Vali Acc: 0.600 Test Loss: 0.771 Test Acc: 0.600
Validation loss decreased (-0.569992 --> -0.599992).  Saving model ...
Epoch: 3 cost time: 2.0926167964935303
Epoch: 3, Steps: 20 | Train Loss: 0.668 Vali Loss: 1.082 Vali Acc: 0.530 Test Loss: 1.082 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0554492473602295
Epoch: 4, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.917 Vali Acc: 0.530 Test Loss: 0.917 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0940558910369873
Epoch: 5, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.868 Vali Acc: 0.620 Test Loss: 0.868 Test Acc: 0.620
Validation loss decreased (-0.599992 --> -0.619991).  Saving model ...
Epoch: 6 cost time: 2.119359254837036
Epoch: 6, Steps: 20 | Train Loss: 0.439 Vali Loss: 0.787 Vali Acc: 0.630 Test Loss: 0.787 Test Acc: 0.630
Validation loss decreased (-0.619991 --> -0.629992).  Saving model ...
Epoch: 7 cost time: 1.9376449584960938
Epoch: 7, Steps: 20 | Train Loss: 0.436 Vali Loss: 1.734 Vali Acc: 0.560 Test Loss: 1.734 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1035282611846924
Epoch: 8, Steps: 20 | Train Loss: 0.776 Vali Loss: 1.495 Vali Acc: 0.540 Test Loss: 1.495 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1438486576080322
Epoch: 9, Steps: 20 | Train Loss: 0.409 Vali Loss: 1.036 Vali Acc: 0.580 Test Loss: 1.036 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.254821538925171
Epoch: 10, Steps: 20 | Train Loss: 0.377 Vali Loss: 1.888 Vali Acc: 0.510 Test Loss: 1.888 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.089873790740967
Epoch: 11, Steps: 20 | Train Loss: 0.361 Vali Loss: 1.434 Vali Acc: 0.550 Test Loss: 1.434 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.183563232421875
Epoch: 12, Steps: 20 | Train Loss: 0.223 Vali Loss: 1.417 Vali Acc: 0.530 Test Loss: 1.417 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.1389434337615967
Epoch: 13, Steps: 20 | Train Loss: 0.168 Vali Loss: 1.607 Vali Acc: 0.520 Test Loss: 1.607 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.0009255409240723
Epoch: 14, Steps: 20 | Train Loss: 0.118 Vali Loss: 1.327 Vali Acc: 0.550 Test Loss: 1.327 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0063369274139404
Epoch: 15, Steps: 20 | Train Loss: 0.113 Vali Loss: 1.566 Vali Acc: 0.580 Test Loss: 1.566 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.903594970703125
Epoch: 16, Steps: 20 | Train Loss: 0.240 Vali Loss: 2.687 Vali Acc: 0.540 Test Loss: 2.687 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 4675202
model size : 17.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.40541410446167
Epoch: 1, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.719 Vali Acc: 0.580 Test Loss: 0.719 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 1.9565832614898682
Epoch: 2, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.964 Vali Acc: 0.500 Test Loss: 0.964 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.001877546310425
Epoch: 3, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.846 Vali Acc: 0.570 Test Loss: 0.846 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9687654972076416
Epoch: 4, Steps: 20 | Train Loss: 0.792 Vali Loss: 0.751 Vali Acc: 0.530 Test Loss: 0.751 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9839386940002441
Epoch: 5, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.799 Vali Acc: 0.610 Test Loss: 0.799 Test Acc: 0.610
Validation loss decreased (-0.579993 --> -0.609992).  Saving model ...
Epoch: 6 cost time: 2.0281026363372803
Epoch: 6, Steps: 20 | Train Loss: 0.477 Vali Loss: 1.106 Vali Acc: 0.560 Test Loss: 1.106 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0743610858917236
Epoch: 7, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.845 Vali Acc: 0.580 Test Loss: 0.845 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0913596153259277
Epoch: 8, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.957 Vali Acc: 0.590 Test Loss: 0.957 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.057058334350586
Epoch: 9, Steps: 20 | Train Loss: 0.592 Vali Loss: 1.539 Vali Acc: 0.530 Test Loss: 1.539 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9733331203460693
Epoch: 10, Steps: 20 | Train Loss: 0.300 Vali Loss: 1.013 Vali Acc: 0.580 Test Loss: 1.013 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.099240779876709
Epoch: 11, Steps: 20 | Train Loss: 0.313 Vali Loss: 1.045 Vali Acc: 0.590 Test Loss: 1.045 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0275230407714844
Epoch: 12, Steps: 20 | Train Loss: 0.217 Vali Loss: 1.648 Vali Acc: 0.500 Test Loss: 1.648 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.0861141681671143
Epoch: 13, Steps: 20 | Train Loss: 0.274 Vali Loss: 1.661 Vali Acc: 0.590 Test Loss: 1.661 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9630637168884277
Epoch: 14, Steps: 20 | Train Loss: 0.183 Vali Loss: 1.040 Vali Acc: 0.630 Test Loss: 1.040 Test Acc: 0.630
Validation loss decreased (-0.609992 --> -0.629990).  Saving model ...
Epoch: 15 cost time: 1.8475992679595947
Epoch: 15, Steps: 20 | Train Loss: 0.142 Vali Loss: 1.801 Vali Acc: 0.540 Test Loss: 1.801 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.119821310043335
Epoch: 16, Steps: 20 | Train Loss: 0.120 Vali Loss: 1.747 Vali Acc: 0.520 Test Loss: 1.747 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9773902893066406
Epoch: 17, Steps: 20 | Train Loss: 0.061 Vali Loss: 1.432 Vali Acc: 0.540 Test Loss: 1.432 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.071993112564087
Epoch: 18, Steps: 20 | Train Loss: 0.086 Vali Loss: 1.602 Vali Acc: 0.500 Test Loss: 1.602 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.0262045860290527
Epoch: 19, Steps: 20 | Train Loss: 0.086 Vali Loss: 1.669 Vali Acc: 0.540 Test Loss: 1.669 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.300238847732544
Epoch: 20, Steps: 20 | Train Loss: 0.052 Vali Loss: 2.062 Vali Acc: 0.560 Test Loss: 2.062 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.1059060096740723
Epoch: 21, Steps: 20 | Train Loss: 0.034 Vali Loss: 1.814 Vali Acc: 0.560 Test Loss: 1.814 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.9820537567138672
Epoch: 22, Steps: 20 | Train Loss: 0.027 Vali Loss: 1.641 Vali Acc: 0.570 Test Loss: 1.641 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9241535663604736
Epoch: 23, Steps: 20 | Train Loss: 0.013 Vali Loss: 1.840 Vali Acc: 0.590 Test Loss: 1.840 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.9637970924377441
Epoch: 24, Steps: 20 | Train Loss: 0.018 Vali Loss: 1.896 Vali Acc: 0.590 Test Loss: 1.896 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 4661122
model size : 17.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.794814348220825
Epoch: 1, Steps: 20 | Train Loss: 0.784 Vali Loss: 0.897 Vali Acc: 0.500 Test Loss: 0.897 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 1.6741442680358887
Epoch: 2, Steps: 20 | Train Loss: 0.802 Vali Loss: 1.545 Vali Acc: 0.460 Test Loss: 1.545 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0053372383117676
Epoch: 3, Steps: 20 | Train Loss: 0.806 Vali Loss: 1.220 Vali Acc: 0.530 Test Loss: 1.220 Test Acc: 0.530
Validation loss decreased (-0.499991 --> -0.529988).  Saving model ...
Epoch: 4 cost time: 1.897653579711914
Epoch: 4, Steps: 20 | Train Loss: 0.706 Vali Loss: 1.194 Vali Acc: 0.530 Test Loss: 1.194 Test Acc: 0.530
Validation loss decreased (-0.529988 --> -0.529988).  Saving model ...
Epoch: 5 cost time: 1.849168300628662
Epoch: 5, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.739 Vali Acc: 0.610 Test Loss: 0.739 Test Acc: 0.610
Validation loss decreased (-0.529988 --> -0.609993).  Saving model ...
Epoch: 6 cost time: 1.949876308441162
Epoch: 6, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.816 Vali Acc: 0.560 Test Loss: 0.816 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.936208963394165
Epoch: 7, Steps: 20 | Train Loss: 0.452 Vali Loss: 0.884 Vali Acc: 0.610 Test Loss: 0.884 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6525640487670898
Epoch: 8, Steps: 20 | Train Loss: 0.433 Vali Loss: 1.359 Vali Acc: 0.480 Test Loss: 1.359 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9491136074066162
Epoch: 9, Steps: 20 | Train Loss: 0.430 Vali Loss: 1.078 Vali Acc: 0.510 Test Loss: 1.078 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9778189659118652
Epoch: 10, Steps: 20 | Train Loss: 0.366 Vali Loss: 1.046 Vali Acc: 0.540 Test Loss: 1.046 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0249686241149902
Epoch: 11, Steps: 20 | Train Loss: 0.314 Vali Loss: 1.025 Vali Acc: 0.520 Test Loss: 1.025 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9112279415130615
Epoch: 12, Steps: 20 | Train Loss: 0.236 Vali Loss: 1.049 Vali Acc: 0.590 Test Loss: 1.049 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9890048503875732
Epoch: 13, Steps: 20 | Train Loss: 0.200 Vali Loss: 1.210 Vali Acc: 0.490 Test Loss: 1.210 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6465976238250732
Epoch: 14, Steps: 20 | Train Loss: 0.240 Vali Loss: 1.144 Vali Acc: 0.590 Test Loss: 1.144 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.9227545261383057
Epoch: 15, Steps: 20 | Train Loss: 0.191 Vali Loss: 1.632 Vali Acc: 0.490 Test Loss: 1.632 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 4640002
model size : 17.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6213021278381348
Epoch: 1, Steps: 20 | Train Loss: 0.828 Vali Loss: 0.788 Vali Acc: 0.490 Test Loss: 0.788 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.7961153984069824
Epoch: 2, Steps: 20 | Train Loss: 0.999 Vali Loss: 0.802 Vali Acc: 0.520 Test Loss: 0.802 Test Acc: 0.520
Validation loss decreased (-0.489992 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 2.88301420211792
Epoch: 3, Steps: 20 | Train Loss: 0.932 Vali Loss: 1.149 Vali Acc: 0.470 Test Loss: 1.149 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.734746217727661
Epoch: 4, Steps: 20 | Train Loss: 0.731 Vali Loss: 1.060 Vali Acc: 0.570 Test Loss: 1.060 Test Acc: 0.570
Validation loss decreased (-0.519992 --> -0.569989).  Saving model ...
Epoch: 5 cost time: 2.598738193511963
Epoch: 5, Steps: 20 | Train Loss: 0.854 Vali Loss: 1.350 Vali Acc: 0.560 Test Loss: 1.350 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.543039083480835
Epoch: 6, Steps: 20 | Train Loss: 0.928 Vali Loss: 1.532 Vali Acc: 0.590 Test Loss: 1.532 Test Acc: 0.590
Validation loss decreased (-0.569989 --> -0.589985).  Saving model ...
Epoch: 7 cost time: 2.5191595554351807
Epoch: 7, Steps: 20 | Train Loss: 0.898 Vali Loss: 1.635 Vali Acc: 0.570 Test Loss: 1.635 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8270466327667236
Epoch: 8, Steps: 20 | Train Loss: 1.043 Vali Loss: 1.534 Vali Acc: 0.640 Test Loss: 1.534 Test Acc: 0.640
Validation loss decreased (-0.589985 --> -0.639985).  Saving model ...
Epoch: 9 cost time: 2.799924373626709
Epoch: 9, Steps: 20 | Train Loss: 0.436 Vali Loss: 1.168 Vali Acc: 0.590 Test Loss: 1.168 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.78484845161438
Epoch: 10, Steps: 20 | Train Loss: 0.919 Vali Loss: 1.937 Vali Acc: 0.500 Test Loss: 1.937 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.681398391723633
Epoch: 11, Steps: 20 | Train Loss: 0.453 Vali Loss: 1.494 Vali Acc: 0.580 Test Loss: 1.494 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.725862503051758
Epoch: 12, Steps: 20 | Train Loss: 0.393 Vali Loss: 1.976 Vali Acc: 0.510 Test Loss: 1.976 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.552321672439575
Epoch: 13, Steps: 20 | Train Loss: 0.495 Vali Loss: 2.360 Vali Acc: 0.560 Test Loss: 2.360 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.6898467540740967
Epoch: 14, Steps: 20 | Train Loss: 0.500 Vali Loss: 1.796 Vali Acc: 0.610 Test Loss: 1.796 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.879556894302368
Epoch: 15, Steps: 20 | Train Loss: 0.544 Vali Loss: 2.084 Vali Acc: 0.570 Test Loss: 2.084 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.9481616020202637
Epoch: 16, Steps: 20 | Train Loss: 0.494 Vali Loss: 2.264 Vali Acc: 0.550 Test Loss: 2.264 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.6982271671295166
Epoch: 17, Steps: 20 | Train Loss: 0.366 Vali Loss: 1.973 Vali Acc: 0.590 Test Loss: 1.973 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.7795727252960205
Epoch: 18, Steps: 20 | Train Loss: 0.305 Vali Loss: 1.962 Vali Acc: 0.570 Test Loss: 1.962 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 1555906
model size : 5.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2051305770874023
Epoch: 1, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.838 Vali Acc: 0.490 Test Loss: 0.838 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.9229040145874023
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.780 Vali Acc: 0.540 Test Loss: 0.780 Test Acc: 0.540
Validation loss decreased (-0.489992 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 2.09678053855896
Epoch: 3, Steps: 20 | Train Loss: 0.690 Vali Loss: 1.059 Vali Acc: 0.540 Test Loss: 1.059 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.223665237426758
Epoch: 4, Steps: 20 | Train Loss: 0.733 Vali Loss: 1.540 Vali Acc: 0.520 Test Loss: 1.540 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9054844379425049
Epoch: 5, Steps: 20 | Train Loss: 0.777 Vali Loss: 0.909 Vali Acc: 0.620 Test Loss: 0.909 Test Acc: 0.620
Validation loss decreased (-0.539992 --> -0.619991).  Saving model ...
Epoch: 6 cost time: 1.8105502128601074
Epoch: 6, Steps: 20 | Train Loss: 0.635 Vali Loss: 1.123 Vali Acc: 0.540 Test Loss: 1.123 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6444942951202393
Epoch: 7, Steps: 20 | Train Loss: 0.520 Vali Loss: 1.011 Vali Acc: 0.580 Test Loss: 1.011 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9781396389007568
Epoch: 8, Steps: 20 | Train Loss: 0.474 Vali Loss: 1.298 Vali Acc: 0.590 Test Loss: 1.298 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.361006736755371
Epoch: 9, Steps: 20 | Train Loss: 0.477 Vali Loss: 1.169 Vali Acc: 0.590 Test Loss: 1.169 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.2871253490448
Epoch: 10, Steps: 20 | Train Loss: 0.425 Vali Loss: 1.165 Vali Acc: 0.550 Test Loss: 1.165 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.306737184524536
Epoch: 11, Steps: 20 | Train Loss: 0.341 Vali Loss: 1.058 Vali Acc: 0.590 Test Loss: 1.058 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.1947402954101562
Epoch: 12, Steps: 20 | Train Loss: 0.415 Vali Loss: 1.847 Vali Acc: 0.580 Test Loss: 1.847 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.254995584487915
Epoch: 13, Steps: 20 | Train Loss: 0.334 Vali Loss: 1.480 Vali Acc: 0.570 Test Loss: 1.480 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2532010078430176
Epoch: 14, Steps: 20 | Train Loss: 0.335 Vali Loss: 2.113 Vali Acc: 0.550 Test Loss: 2.113 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.1914420127868652
Epoch: 15, Steps: 20 | Train Loss: 0.258 Vali Loss: 1.643 Vali Acc: 0.600 Test Loss: 1.643 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1466370
model size : 5.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.479018211364746
Epoch: 1, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.721 Vali Acc: 0.530 Test Loss: 0.721 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 2.1731460094451904
Epoch: 2, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.695 Vali Acc: 0.550 Test Loss: 0.695 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.9689476490020752
Epoch: 3, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.783 Vali Acc: 0.570 Test Loss: 0.783 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 4 cost time: 2.0196430683135986
Epoch: 4, Steps: 20 | Train Loss: 0.703 Vali Loss: 1.264 Vali Acc: 0.560 Test Loss: 1.264 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.101557731628418
Epoch: 5, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.849 Vali Acc: 0.540 Test Loss: 0.849 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.068398952484131
Epoch: 6, Steps: 20 | Train Loss: 0.588 Vali Loss: 1.848 Vali Acc: 0.550 Test Loss: 1.848 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3051066398620605
Epoch: 7, Steps: 20 | Train Loss: 0.697 Vali Loss: 1.114 Vali Acc: 0.580 Test Loss: 1.114 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579989).  Saving model ...
Epoch: 8 cost time: 2.321413040161133
Epoch: 8, Steps: 20 | Train Loss: 0.632 Vali Loss: 1.517 Vali Acc: 0.530 Test Loss: 1.517 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8970956802368164
Epoch: 9, Steps: 20 | Train Loss: 0.505 Vali Loss: 1.370 Vali Acc: 0.530 Test Loss: 1.370 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7804138660430908
Epoch: 10, Steps: 20 | Train Loss: 0.488 Vali Loss: 1.891 Vali Acc: 0.560 Test Loss: 1.891 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7566373348236084
Epoch: 11, Steps: 20 | Train Loss: 0.597 Vali Loss: 1.267 Vali Acc: 0.580 Test Loss: 1.267 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.740140676498413
Epoch: 12, Steps: 20 | Train Loss: 0.303 Vali Loss: 1.332 Vali Acc: 0.530 Test Loss: 1.332 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.029831647872925
Epoch: 13, Steps: 20 | Train Loss: 0.249 Vali Loss: 1.436 Vali Acc: 0.580 Test Loss: 1.436 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.301210880279541
Epoch: 14, Steps: 20 | Train Loss: 0.248 Vali Loss: 1.340 Vali Acc: 0.600 Test Loss: 1.340 Test Acc: 0.600
Validation loss decreased (-0.579989 --> -0.599987).  Saving model ...
Epoch: 15 cost time: 2.1811838150024414
Epoch: 15, Steps: 20 | Train Loss: 0.218 Vali Loss: 1.595 Vali Acc: 0.560 Test Loss: 1.595 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1514809131622314
Epoch: 16, Steps: 20 | Train Loss: 0.144 Vali Loss: 1.743 Vali Acc: 0.570 Test Loss: 1.743 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.5179147720336914
Epoch: 17, Steps: 20 | Train Loss: 0.105 Vali Loss: 1.841 Vali Acc: 0.560 Test Loss: 1.841 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.6418097019195557
Epoch: 18, Steps: 20 | Train Loss: 0.179 Vali Loss: 1.859 Vali Acc: 0.580 Test Loss: 1.859 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.4119620323181152
Epoch: 19, Steps: 20 | Train Loss: 0.144 Vali Loss: 2.068 Vali Acc: 0.550 Test Loss: 2.068 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.241157054901123
Epoch: 20, Steps: 20 | Train Loss: 0.050 Vali Loss: 2.029 Vali Acc: 0.550 Test Loss: 2.029 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.844088077545166
Epoch: 21, Steps: 20 | Train Loss: 0.065 Vali Loss: 2.246 Vali Acc: 0.550 Test Loss: 2.246 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.4421277046203613
Epoch: 22, Steps: 20 | Train Loss: 0.121 Vali Loss: 2.261 Vali Acc: 0.570 Test Loss: 2.261 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.605882406234741
Epoch: 23, Steps: 20 | Train Loss: 0.070 Vali Loss: 2.103 Vali Acc: 0.530 Test Loss: 2.103 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.5203607082366943
Epoch: 24, Steps: 20 | Train Loss: 0.044 Vali Loss: 2.222 Vali Acc: 0.560 Test Loss: 2.222 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1466434
model size : 5.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6884186267852783
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.755 Vali Acc: 0.520 Test Loss: 0.755 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 2.177509069442749
Epoch: 2, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.779 Vali Acc: 0.520 Test Loss: 0.779 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.224971294403076
Epoch: 3, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.772 Vali Acc: 0.580 Test Loss: 0.772 Test Acc: 0.580
Validation loss decreased (-0.519992 --> -0.579992).  Saving model ...
Epoch: 4 cost time: 2.0663018226623535
Epoch: 4, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.866 Vali Acc: 0.550 Test Loss: 0.866 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0666251182556152
Epoch: 5, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.804 Vali Acc: 0.570 Test Loss: 0.804 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.084965467453003
Epoch: 6, Steps: 20 | Train Loss: 0.586 Vali Loss: 1.208 Vali Acc: 0.550 Test Loss: 1.208 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2261691093444824
Epoch: 7, Steps: 20 | Train Loss: 0.615 Vali Loss: 1.245 Vali Acc: 0.520 Test Loss: 1.245 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.349918842315674
Epoch: 8, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.946 Vali Acc: 0.640 Test Loss: 0.946 Test Acc: 0.640
Validation loss decreased (-0.579992 --> -0.639991).  Saving model ...
Epoch: 9 cost time: 2.276582956314087
Epoch: 9, Steps: 20 | Train Loss: 0.372 Vali Loss: 0.898 Vali Acc: 0.560 Test Loss: 0.898 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.056337594985962
Epoch: 10, Steps: 20 | Train Loss: 0.351 Vali Loss: 1.179 Vali Acc: 0.540 Test Loss: 1.179 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.980774164199829
Epoch: 11, Steps: 20 | Train Loss: 0.306 Vali Loss: 1.141 Vali Acc: 0.540 Test Loss: 1.141 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0710580348968506
Epoch: 12, Steps: 20 | Train Loss: 0.296 Vali Loss: 1.279 Vali Acc: 0.510 Test Loss: 1.279 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1041688919067383
Epoch: 13, Steps: 20 | Train Loss: 0.261 Vali Loss: 1.093 Vali Acc: 0.550 Test Loss: 1.093 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.2784976959228516
Epoch: 14, Steps: 20 | Train Loss: 0.291 Vali Loss: 1.625 Vali Acc: 0.510 Test Loss: 1.625 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.1930954456329346
Epoch: 15, Steps: 20 | Train Loss: 0.286 Vali Loss: 1.083 Vali Acc: 0.620 Test Loss: 1.083 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.1290950775146484
Epoch: 16, Steps: 20 | Train Loss: 0.298 Vali Loss: 1.921 Vali Acc: 0.530 Test Loss: 1.921 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.2797513008117676
Epoch: 17, Steps: 20 | Train Loss: 0.151 Vali Loss: 1.287 Vali Acc: 0.580 Test Loss: 1.287 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.2144381999969482
Epoch: 18, Steps: 20 | Train Loss: 0.120 Vali Loss: 1.509 Vali Acc: 0.520 Test Loss: 1.509 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 1434242
model size : 5.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.010556221008301
Epoch: 1, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.721 Vali Acc: 0.510 Test Loss: 0.721 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.145655632019043
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.860 Vali Acc: 0.510 Test Loss: 0.860 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1987721920013428
Epoch: 3, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.751 Vali Acc: 0.500 Test Loss: 0.751 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1341683864593506
Epoch: 4, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.753 Vali Acc: 0.490 Test Loss: 0.753 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.072092294692993
Epoch: 5, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.761 Vali Acc: 0.610 Test Loss: 0.761 Test Acc: 0.610
Validation loss decreased (-0.509993 --> -0.609992).  Saving model ...
Epoch: 6 cost time: 1.925069808959961
Epoch: 6, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.859 Vali Acc: 0.590 Test Loss: 0.859 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.007996082305908
Epoch: 7, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.798 Vali Acc: 0.550 Test Loss: 0.798 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1610267162323
Epoch: 8, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.907 Vali Acc: 0.530 Test Loss: 0.907 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9913804531097412
Epoch: 9, Steps: 20 | Train Loss: 0.420 Vali Loss: 0.938 Vali Acc: 0.520 Test Loss: 0.938 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.096296787261963
Epoch: 10, Steps: 20 | Train Loss: 0.337 Vali Loss: 1.030 Vali Acc: 0.510 Test Loss: 1.030 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9754846096038818
Epoch: 11, Steps: 20 | Train Loss: 0.402 Vali Loss: 1.177 Vali Acc: 0.530 Test Loss: 1.177 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.1664822101593018
Epoch: 12, Steps: 20 | Train Loss: 0.276 Vali Loss: 0.988 Vali Acc: 0.560 Test Loss: 0.988 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.2356605529785156
Epoch: 13, Steps: 20 | Train Loss: 0.285 Vali Loss: 1.067 Vali Acc: 0.540 Test Loss: 1.067 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.177495002746582
Epoch: 14, Steps: 20 | Train Loss: 0.205 Vali Loss: 1.514 Vali Acc: 0.520 Test Loss: 1.514 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.248593330383301
Epoch: 15, Steps: 20 | Train Loss: 0.308 Vali Loss: 1.248 Vali Acc: 0.500 Test Loss: 1.248 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1420098
model size : 5.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0553290843963623
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.671 Vali Acc: 0.600 Test Loss: 0.671 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 1.884775161743164
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.750 Vali Acc: 0.520 Test Loss: 0.750 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4513208866119385
Epoch: 3, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.717 Vali Acc: 0.590 Test Loss: 0.717 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6403486728668213
Epoch: 4, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.804 Vali Acc: 0.580 Test Loss: 0.804 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6663177013397217
Epoch: 5, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.824 Vali Acc: 0.550 Test Loss: 0.824 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4197652339935303
Epoch: 6, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.741 Vali Acc: 0.570 Test Loss: 0.741 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3771188259124756
Epoch: 7, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.861 Vali Acc: 0.600 Test Loss: 0.861 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.424971103668213
Epoch: 8, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.866 Vali Acc: 0.580 Test Loss: 0.866 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8172392845153809
Epoch: 9, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.863 Vali Acc: 0.550 Test Loss: 0.863 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.045506715774536
Epoch: 10, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.937 Vali Acc: 0.550 Test Loss: 0.937 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.939889669418335
Epoch: 11, Steps: 20 | Train Loss: 0.401 Vali Loss: 1.229 Vali Acc: 0.540 Test Loss: 1.229 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1413058
model size : 5.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0263469219207764
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.735 Vali Acc: 0.420 Test Loss: 0.735 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 1.971034288406372
Epoch: 2, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.761 Vali Acc: 0.570 Test Loss: 0.761 Test Acc: 0.570
Validation loss decreased (-0.419993 --> -0.569992).  Saving model ...
Epoch: 3 cost time: 2.010213851928711
Epoch: 3, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.699 Vali Acc: 0.600 Test Loss: 0.699 Test Acc: 0.600
Validation loss decreased (-0.569992 --> -0.599993).  Saving model ...
Epoch: 4 cost time: 2.0715103149414062
Epoch: 4, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.800 Vali Acc: 0.560 Test Loss: 0.800 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.09322190284729
Epoch: 5, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.706 Vali Acc: 0.610 Test Loss: 0.706 Test Acc: 0.610
Validation loss decreased (-0.599993 --> -0.609993).  Saving model ...
Epoch: 6 cost time: 1.8056645393371582
Epoch: 6, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.757 Vali Acc: 0.590 Test Loss: 0.757 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7786509990692139
Epoch: 7, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.827 Vali Acc: 0.560 Test Loss: 0.827 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7479355335235596
Epoch: 8, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.833 Vali Acc: 0.550 Test Loss: 0.833 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6480755805969238
Epoch: 9, Steps: 20 | Train Loss: 0.434 Vali Loss: 0.931 Vali Acc: 0.540 Test Loss: 0.931 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8519458770751953
Epoch: 10, Steps: 20 | Train Loss: 0.406 Vali Loss: 0.894 Vali Acc: 0.490 Test Loss: 0.894 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7864453792572021
Epoch: 11, Steps: 20 | Train Loss: 0.361 Vali Loss: 0.892 Vali Acc: 0.510 Test Loss: 0.892 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8140943050384521
Epoch: 12, Steps: 20 | Train Loss: 0.314 Vali Loss: 1.045 Vali Acc: 0.520 Test Loss: 1.045 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.694138765335083
Epoch: 13, Steps: 20 | Train Loss: 0.377 Vali Loss: 1.083 Vali Acc: 0.500 Test Loss: 1.083 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8861072063446045
Epoch: 14, Steps: 20 | Train Loss: 0.315 Vali Loss: 0.947 Vali Acc: 0.560 Test Loss: 0.947 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8999879360198975
Epoch: 15, Steps: 20 | Train Loss: 0.289 Vali Loss: 1.007 Vali Acc: 0.610 Test Loss: 1.007 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1402498
model size : 5.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.064671277999878
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.722 Vali Acc: 0.540 Test Loss: 0.722 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.839287281036377
Epoch: 2, Steps: 20 | Train Loss: 0.790 Vali Loss: 0.842 Vali Acc: 0.530 Test Loss: 0.842 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.925588846206665
Epoch: 3, Steps: 20 | Train Loss: 0.766 Vali Loss: 0.795 Vali Acc: 0.550 Test Loss: 0.795 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 1.9495105743408203
Epoch: 4, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.894 Vali Acc: 0.620 Test Loss: 0.894 Test Acc: 0.620
Validation loss decreased (-0.549992 --> -0.619991).  Saving model ...
Epoch: 5 cost time: 1.9089725017547607
Epoch: 5, Steps: 20 | Train Loss: 0.707 Vali Loss: 1.107 Vali Acc: 0.490 Test Loss: 1.107 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.762699842453003
Epoch: 6, Steps: 20 | Train Loss: 0.563 Vali Loss: 1.274 Vali Acc: 0.520 Test Loss: 1.274 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6545372009277344
Epoch: 7, Steps: 20 | Train Loss: 0.564 Vali Loss: 1.105 Vali Acc: 0.550 Test Loss: 1.105 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8077149391174316
Epoch: 8, Steps: 20 | Train Loss: 0.568 Vali Loss: 1.270 Vali Acc: 0.500 Test Loss: 1.270 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7523176670074463
Epoch: 9, Steps: 20 | Train Loss: 0.591 Vali Loss: 1.253 Vali Acc: 0.630 Test Loss: 1.253 Test Acc: 0.630
Validation loss decreased (-0.619991 --> -0.629987).  Saving model ...
Epoch: 10 cost time: 1.621614694595337
Epoch: 10, Steps: 20 | Train Loss: 0.584 Vali Loss: 1.366 Vali Acc: 0.510 Test Loss: 1.366 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4020869731903076
Epoch: 11, Steps: 20 | Train Loss: 0.456 Vali Loss: 1.549 Vali Acc: 0.510 Test Loss: 1.549 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7764384746551514
Epoch: 12, Steps: 20 | Train Loss: 0.412 Vali Loss: 1.431 Vali Acc: 0.550 Test Loss: 1.431 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8054816722869873
Epoch: 13, Steps: 20 | Train Loss: 0.401 Vali Loss: 1.096 Vali Acc: 0.560 Test Loss: 1.096 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.638688087463379
Epoch: 14, Steps: 20 | Train Loss: 0.325 Vali Loss: 1.194 Vali Acc: 0.570 Test Loss: 1.194 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4797344207763672
Epoch: 15, Steps: 20 | Train Loss: 0.329 Vali Loss: 1.602 Vali Acc: 0.540 Test Loss: 1.602 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.0180816650390625
Epoch: 16, Steps: 20 | Train Loss: 0.307 Vali Loss: 1.716 Vali Acc: 0.530 Test Loss: 1.716 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.0937163829803467
Epoch: 17, Steps: 20 | Train Loss: 0.404 Vali Loss: 1.736 Vali Acc: 0.640 Test Loss: 1.736 Test Acc: 0.640
Validation loss decreased (-0.629987 --> -0.639983).  Saving model ...
Epoch: 18 cost time: 1.7924768924713135
Epoch: 18, Steps: 20 | Train Loss: 0.296 Vali Loss: 1.908 Vali Acc: 0.510 Test Loss: 1.908 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.747762680053711
Epoch: 19, Steps: 20 | Train Loss: 0.216 Vali Loss: 1.346 Vali Acc: 0.620 Test Loss: 1.346 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7930564880371094
Epoch: 20, Steps: 20 | Train Loss: 0.198 Vali Loss: 1.306 Vali Acc: 0.590 Test Loss: 1.306 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8785905838012695
Epoch: 21, Steps: 20 | Train Loss: 0.199 Vali Loss: 1.704 Vali Acc: 0.630 Test Loss: 1.704 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.1060404777526855
Epoch: 22, Steps: 20 | Train Loss: 0.171 Vali Loss: 1.549 Vali Acc: 0.570 Test Loss: 1.549 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.141528367996216
Epoch: 23, Steps: 20 | Train Loss: 0.130 Vali Loss: 1.597 Vali Acc: 0.550 Test Loss: 1.597 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.0006885528564453
Epoch: 24, Steps: 20 | Train Loss: 0.212 Vali Loss: 1.759 Vali Acc: 0.580 Test Loss: 1.759 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5255281925201416
Epoch: 25, Steps: 20 | Train Loss: 0.113 Vali Loss: 1.963 Vali Acc: 0.560 Test Loss: 1.963 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5502636432647705
Epoch: 26, Steps: 20 | Train Loss: 0.083 Vali Loss: 1.832 Vali Acc: 0.550 Test Loss: 1.832 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.7045388221740723
Epoch: 27, Steps: 20 | Train Loss: 0.084 Vali Loss: 1.760 Vali Acc: 0.590 Test Loss: 1.760 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 548578
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.4281511306762695
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.730 Vali Acc: 0.490 Test Loss: 0.730 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.389373540878296
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.772 Vali Acc: 0.490 Test Loss: 0.772 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3730051517486572
Epoch: 3, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.803 Vali Acc: 0.460 Test Loss: 0.803 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4916892051696777
Epoch: 4, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.872 Vali Acc: 0.450 Test Loss: 0.872 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3931725025177002
Epoch: 5, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.766 Vali Acc: 0.610 Test Loss: 0.766 Test Acc: 0.610
Validation loss decreased (-0.489993 --> -0.609992).  Saving model ...
Epoch: 6 cost time: 1.8045117855072021
Epoch: 6, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.988 Vali Acc: 0.530 Test Loss: 0.988 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.785264492034912
Epoch: 7, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.821 Vali Acc: 0.590 Test Loss: 0.821 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7125914096832275
Epoch: 8, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.881 Vali Acc: 0.560 Test Loss: 0.881 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6816596984863281
Epoch: 9, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.921 Vali Acc: 0.540 Test Loss: 0.921 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6116111278533936
Epoch: 10, Steps: 20 | Train Loss: 0.448 Vali Loss: 1.550 Vali Acc: 0.490 Test Loss: 1.550 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6364006996154785
Epoch: 11, Steps: 20 | Train Loss: 0.395 Vali Loss: 0.925 Vali Acc: 0.550 Test Loss: 0.925 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4572012424468994
Epoch: 12, Steps: 20 | Train Loss: 0.390 Vali Loss: 1.037 Vali Acc: 0.560 Test Loss: 1.037 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3285613059997559
Epoch: 13, Steps: 20 | Train Loss: 0.331 Vali Loss: 1.241 Vali Acc: 0.560 Test Loss: 1.241 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5544636249542236
Epoch: 14, Steps: 20 | Train Loss: 0.297 Vali Loss: 1.196 Vali Acc: 0.530 Test Loss: 1.196 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4965698719024658
Epoch: 15, Steps: 20 | Train Loss: 0.293 Vali Loss: 1.023 Vali Acc: 0.570 Test Loss: 1.023 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 503810
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7464048862457275
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.4561595916748047
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.736 Vali Acc: 0.530 Test Loss: 0.736 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.446242094039917
Epoch: 3, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.726 Vali Acc: 0.600 Test Loss: 0.726 Test Acc: 0.600
Validation loss decreased (-0.529993 --> -0.599993).  Saving model ...
Epoch: 4 cost time: 1.7235381603240967
Epoch: 4, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.740 Vali Acc: 0.580 Test Loss: 0.740 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.512493371963501
Epoch: 5, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.753 Vali Acc: 0.590 Test Loss: 0.753 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.489499568939209
Epoch: 6, Steps: 20 | Train Loss: 0.581 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4092731475830078
Epoch: 7, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.847 Vali Acc: 0.580 Test Loss: 0.847 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7472336292266846
Epoch: 8, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.869 Vali Acc: 0.520 Test Loss: 0.869 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6617822647094727
Epoch: 9, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.997 Vali Acc: 0.500 Test Loss: 0.997 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.367501974105835
Epoch: 10, Steps: 20 | Train Loss: 0.358 Vali Loss: 1.047 Vali Acc: 0.550 Test Loss: 1.047 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3131377696990967
Epoch: 11, Steps: 20 | Train Loss: 0.379 Vali Loss: 1.037 Vali Acc: 0.510 Test Loss: 1.037 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6107022762298584
Epoch: 12, Steps: 20 | Train Loss: 0.396 Vali Loss: 1.423 Vali Acc: 0.510 Test Loss: 1.423 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4952306747436523
Epoch: 13, Steps: 20 | Train Loss: 0.379 Vali Loss: 1.025 Vali Acc: 0.530 Test Loss: 1.025 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 503842
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.885793447494507
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.717 Vali Acc: 0.490 Test Loss: 0.717 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.6996729373931885
Epoch: 2, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.732 Vali Acc: 0.550 Test Loss: 0.732 Test Acc: 0.550
Validation loss decreased (-0.489993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.3897476196289062
Epoch: 3, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.754 Vali Acc: 0.530 Test Loss: 0.754 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.353618860244751
Epoch: 4, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.745 Vali Acc: 0.570 Test Loss: 0.745 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 5 cost time: 1.2460269927978516
Epoch: 5, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.817 Vali Acc: 0.530 Test Loss: 0.817 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.045074462890625
Epoch: 6, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.738 Vali Acc: 0.560 Test Loss: 0.738 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.482466697692871
Epoch: 7, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.731 Vali Acc: 0.580 Test Loss: 0.731 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 8 cost time: 1.6500627994537354
Epoch: 8, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.756 Vali Acc: 0.570 Test Loss: 0.756 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5049333572387695
Epoch: 9, Steps: 20 | Train Loss: 0.446 Vali Loss: 0.747 Vali Acc: 0.600 Test Loss: 0.747 Test Acc: 0.600
Validation loss decreased (-0.579993 --> -0.599993).  Saving model ...
Epoch: 10 cost time: 1.855398178100586
Epoch: 10, Steps: 20 | Train Loss: 0.411 Vali Loss: 0.852 Vali Acc: 0.580 Test Loss: 0.852 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8635790348052979
Epoch: 11, Steps: 20 | Train Loss: 0.411 Vali Loss: 0.816 Vali Acc: 0.570 Test Loss: 0.816 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.496251106262207
Epoch: 12, Steps: 20 | Train Loss: 0.410 Vali Loss: 1.023 Vali Acc: 0.530 Test Loss: 1.023 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.481241226196289
Epoch: 13, Steps: 20 | Train Loss: 0.415 Vali Loss: 0.888 Vali Acc: 0.610 Test Loss: 0.888 Test Acc: 0.610
Validation loss decreased (-0.599993 --> -0.609991).  Saving model ...
Epoch: 14 cost time: 1.472548007965088
Epoch: 14, Steps: 20 | Train Loss: 0.332 Vali Loss: 0.923 Vali Acc: 0.590 Test Loss: 0.923 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4775300025939941
Epoch: 15, Steps: 20 | Train Loss: 0.316 Vali Loss: 1.112 Vali Acc: 0.570 Test Loss: 1.112 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.545102596282959
Epoch: 16, Steps: 20 | Train Loss: 0.314 Vali Loss: 1.027 Vali Acc: 0.600 Test Loss: 1.027 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6982040405273438
Epoch: 17, Steps: 20 | Train Loss: 0.268 Vali Loss: 1.109 Vali Acc: 0.590 Test Loss: 1.109 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4588966369628906
Epoch: 18, Steps: 20 | Train Loss: 0.229 Vali Loss: 1.021 Vali Acc: 0.630 Test Loss: 1.021 Test Acc: 0.630
Validation loss decreased (-0.609991 --> -0.629990).  Saving model ...
Epoch: 19 cost time: 1.6226603984832764
Epoch: 19, Steps: 20 | Train Loss: 0.182 Vali Loss: 1.114 Vali Acc: 0.610 Test Loss: 1.114 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4595837593078613
Epoch: 20, Steps: 20 | Train Loss: 0.159 Vali Loss: 1.202 Vali Acc: 0.610 Test Loss: 1.202 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4819152355194092
Epoch: 21, Steps: 20 | Train Loss: 0.133 Vali Loss: 1.322 Vali Acc: 0.580 Test Loss: 1.322 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5921266078948975
Epoch: 22, Steps: 20 | Train Loss: 0.112 Vali Loss: 1.271 Vali Acc: 0.580 Test Loss: 1.271 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7279787063598633
Epoch: 23, Steps: 20 | Train Loss: 0.070 Vali Loss: 1.571 Vali Acc: 0.540 Test Loss: 1.571 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.495906114578247
Epoch: 24, Steps: 20 | Train Loss: 0.082 Vali Loss: 1.430 Vali Acc: 0.580 Test Loss: 1.430 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3904407024383545
Epoch: 25, Steps: 20 | Train Loss: 0.074 Vali Loss: 1.484 Vali Acc: 0.570 Test Loss: 1.484 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4470579624176025
Epoch: 26, Steps: 20 | Train Loss: 0.059 Vali Loss: 1.644 Vali Acc: 0.580 Test Loss: 1.644 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.470465898513794
Epoch: 27, Steps: 20 | Train Loss: 0.050 Vali Loss: 1.802 Vali Acc: 0.550 Test Loss: 1.802 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4862444400787354
Epoch: 28, Steps: 20 | Train Loss: 0.032 Vali Loss: 1.614 Vali Acc: 0.570 Test Loss: 1.614 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 487746
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.32719349861145
Epoch: 1, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.754 Vali Acc: 0.440 Test Loss: 0.754 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 1.2601027488708496
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.734 Vali Acc: 0.530 Test Loss: 0.734 Test Acc: 0.530
Validation loss decreased (-0.439992 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.4715487957000732
Epoch: 3, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.737 Vali Acc: 0.560 Test Loss: 0.737 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 1.5465431213378906
Epoch: 4, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.751 Vali Acc: 0.460 Test Loss: 0.751 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6360676288604736
Epoch: 5, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.736 Vali Acc: 0.550 Test Loss: 0.736 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6026287078857422
Epoch: 6, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.925 Vali Acc: 0.500 Test Loss: 0.925 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.617034912109375
Epoch: 7, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.812 Vali Acc: 0.480 Test Loss: 0.812 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4639790058135986
Epoch: 8, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.798 Vali Acc: 0.500 Test Loss: 0.798 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5549535751342773
Epoch: 9, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.805 Vali Acc: 0.530 Test Loss: 0.805 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.559169054031372
Epoch: 10, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.765 Vali Acc: 0.560 Test Loss: 0.765 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5318903923034668
Epoch: 11, Steps: 20 | Train Loss: 0.410 Vali Loss: 0.859 Vali Acc: 0.450 Test Loss: 0.859 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5964207649230957
Epoch: 12, Steps: 20 | Train Loss: 0.421 Vali Loss: 0.830 Vali Acc: 0.550 Test Loss: 0.830 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.297179937362671
Epoch: 13, Steps: 20 | Train Loss: 0.353 Vali Loss: 0.801 Vali Acc: 0.590 Test Loss: 0.801 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589992).  Saving model ...
Epoch: 14 cost time: 1.562086820602417
Epoch: 14, Steps: 20 | Train Loss: 0.370 Vali Loss: 0.874 Vali Acc: 0.550 Test Loss: 0.874 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6969141960144043
Epoch: 15, Steps: 20 | Train Loss: 0.294 Vali Loss: 0.935 Vali Acc: 0.510 Test Loss: 0.935 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6086945533752441
Epoch: 16, Steps: 20 | Train Loss: 0.251 Vali Loss: 1.063 Vali Acc: 0.550 Test Loss: 1.063 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7930045127868652
Epoch: 17, Steps: 20 | Train Loss: 0.249 Vali Loss: 0.922 Vali Acc: 0.610 Test Loss: 0.922 Test Acc: 0.610
Validation loss decreased (-0.589992 --> -0.609991).  Saving model ...
Epoch: 18 cost time: 1.675818920135498
Epoch: 18, Steps: 20 | Train Loss: 0.246 Vali Loss: 0.945 Vali Acc: 0.530 Test Loss: 0.945 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6532604694366455
Epoch: 19, Steps: 20 | Train Loss: 0.211 Vali Loss: 1.206 Vali Acc: 0.480 Test Loss: 1.206 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4704465866088867
Epoch: 20, Steps: 20 | Train Loss: 0.164 Vali Loss: 1.055 Vali Acc: 0.560 Test Loss: 1.055 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3354814052581787
Epoch: 21, Steps: 20 | Train Loss: 0.144 Vali Loss: 1.002 Vali Acc: 0.580 Test Loss: 1.002 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.453944206237793
Epoch: 22, Steps: 20 | Train Loss: 0.129 Vali Loss: 1.055 Vali Acc: 0.590 Test Loss: 1.055 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5995051860809326
Epoch: 23, Steps: 20 | Train Loss: 0.101 Vali Loss: 1.196 Vali Acc: 0.530 Test Loss: 1.196 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6073482036590576
Epoch: 24, Steps: 20 | Train Loss: 0.082 Vali Loss: 1.430 Vali Acc: 0.530 Test Loss: 1.430 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.447425365447998
Epoch: 25, Steps: 20 | Train Loss: 0.083 Vali Loss: 1.373 Vali Acc: 0.550 Test Loss: 1.373 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7625226974487305
Epoch: 26, Steps: 20 | Train Loss: 0.076 Vali Loss: 1.446 Vali Acc: 0.540 Test Loss: 1.446 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.7423622608184814
Epoch: 27, Steps: 20 | Train Loss: 0.047 Vali Loss: 1.312 Vali Acc: 0.500 Test Loss: 1.312 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 480674
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.5682711601257324
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.757 Vali Acc: 0.400 Test Loss: 0.757 Test Acc: 0.400
Validation loss decreased (inf --> -0.399992).  Saving model ...
Epoch: 2 cost time: 1.480358362197876
Epoch: 2, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.748 Vali Acc: 0.520 Test Loss: 0.748 Test Acc: 0.520
Validation loss decreased (-0.399992 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.6256465911865234
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.784 Vali Acc: 0.530 Test Loss: 0.784 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 1.517225980758667
Epoch: 4, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2918658256530762
Epoch: 5, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.727 Vali Acc: 0.550 Test Loss: 0.727 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 1.5471789836883545
Epoch: 6, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.813 Vali Acc: 0.520 Test Loss: 0.813 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3940587043762207
Epoch: 7, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.857 Vali Acc: 0.550 Test Loss: 0.857 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.351513147354126
Epoch: 8, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.731 Vali Acc: 0.530 Test Loss: 0.731 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3076860904693604
Epoch: 9, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.779 Vali Acc: 0.530 Test Loss: 0.779 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4848394393920898
Epoch: 10, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.714 Vali Acc: 0.590 Test Loss: 0.714 Test Acc: 0.590
Validation loss decreased (-0.549993 --> -0.589993).  Saving model ...
Epoch: 11 cost time: 1.2650232315063477
Epoch: 11, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.768 Vali Acc: 0.550 Test Loss: 0.768 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.177462100982666
Epoch: 12, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.745 Vali Acc: 0.570 Test Loss: 0.745 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3578124046325684
Epoch: 13, Steps: 20 | Train Loss: 0.406 Vali Loss: 0.958 Vali Acc: 0.550 Test Loss: 0.958 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7592506408691406
Epoch: 14, Steps: 20 | Train Loss: 0.347 Vali Loss: 0.879 Vali Acc: 0.510 Test Loss: 0.879 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.600520133972168
Epoch: 15, Steps: 20 | Train Loss: 0.328 Vali Loss: 0.810 Vali Acc: 0.580 Test Loss: 0.810 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3885760307312012
Epoch: 16, Steps: 20 | Train Loss: 0.269 Vali Loss: 0.864 Vali Acc: 0.590 Test Loss: 0.864 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3062450885772705
Epoch: 17, Steps: 20 | Train Loss: 0.253 Vali Loss: 0.888 Vali Acc: 0.510 Test Loss: 0.888 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4731087684631348
Epoch: 18, Steps: 20 | Train Loss: 0.222 Vali Loss: 0.954 Vali Acc: 0.540 Test Loss: 0.954 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6946501731872559
Epoch: 19, Steps: 20 | Train Loss: 0.216 Vali Loss: 1.076 Vali Acc: 0.540 Test Loss: 1.076 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3535175323486328
Epoch: 20, Steps: 20 | Train Loss: 0.170 Vali Loss: 0.963 Vali Acc: 0.530 Test Loss: 0.963 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 477154
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.16589093208313
Epoch: 1, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.709 Vali Acc: 0.430 Test Loss: 0.709 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 1.1606719493865967
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.710 Vali Acc: 0.470 Test Loss: 0.710 Test Acc: 0.470
Validation loss decreased (-0.429993 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 1.3332931995391846
Epoch: 3, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.743 Vali Acc: 0.470 Test Loss: 0.743 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3017117977142334
Epoch: 4, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.821 Vali Acc: 0.570 Test Loss: 0.821 Test Acc: 0.570
Validation loss decreased (-0.469993 --> -0.569992).  Saving model ...
Epoch: 5 cost time: 1.374006748199463
Epoch: 5, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.861 Vali Acc: 0.480 Test Loss: 0.861 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.609309434890747
Epoch: 6, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.749 Vali Acc: 0.550 Test Loss: 0.749 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.698585033416748
Epoch: 7, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.826 Vali Acc: 0.530 Test Loss: 0.826 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3211801052093506
Epoch: 8, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.802 Vali Acc: 0.570 Test Loss: 0.802 Test Acc: 0.570
Validation loss decreased (-0.569992 --> -0.569992).  Saving model ...
Epoch: 9 cost time: 1.499168872833252
Epoch: 9, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.758 Vali Acc: 0.570 Test Loss: 0.758 Test Acc: 0.570
Validation loss decreased (-0.569992 --> -0.569992).  Saving model ...
Epoch: 10 cost time: 1.40840744972229
Epoch: 10, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.785 Vali Acc: 0.570 Test Loss: 0.785 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4606399536132812
Epoch: 11, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.814 Vali Acc: 0.530 Test Loss: 0.814 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5938401222229004
Epoch: 12, Steps: 20 | Train Loss: 0.422 Vali Loss: 0.898 Vali Acc: 0.570 Test Loss: 0.898 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4597842693328857
Epoch: 13, Steps: 20 | Train Loss: 0.434 Vali Loss: 0.856 Vali Acc: 0.570 Test Loss: 0.856 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3982212543487549
Epoch: 14, Steps: 20 | Train Loss: 0.370 Vali Loss: 1.056 Vali Acc: 0.510 Test Loss: 1.056 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5712997913360596
Epoch: 15, Steps: 20 | Train Loss: 0.379 Vali Loss: 0.953 Vali Acc: 0.500 Test Loss: 0.953 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4786601066589355
Epoch: 16, Steps: 20 | Train Loss: 0.328 Vali Loss: 0.967 Vali Acc: 0.540 Test Loss: 0.967 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.459670066833496
Epoch: 17, Steps: 20 | Train Loss: 0.291 Vali Loss: 0.928 Vali Acc: 0.530 Test Loss: 0.928 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.448075532913208
Epoch: 18, Steps: 20 | Train Loss: 0.276 Vali Loss: 0.970 Vali Acc: 0.560 Test Loss: 0.970 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2574515342712402
Epoch: 19, Steps: 20 | Train Loss: 0.237 Vali Loss: 1.023 Vali Acc: 0.550 Test Loss: 1.023 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 471874
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.269338130950928
Epoch: 1, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.723 Vali Acc: 0.490 Test Loss: 0.723 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 3.417186975479126
Epoch: 2, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.820 Vali Acc: 0.490 Test Loss: 0.820 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.562135696411133
Epoch: 3, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.800 Vali Acc: 0.510 Test Loss: 0.800 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509992).  Saving model ...
Epoch: 4 cost time: 3.4116365909576416
Epoch: 4, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.799 Vali Acc: 0.510 Test Loss: 0.799 Test Acc: 0.510
Validation loss decreased (-0.509992 --> -0.509992).  Saving model ...
Epoch: 5 cost time: 3.1027889251708984
Epoch: 5, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.809 Vali Acc: 0.540 Test Loss: 0.809 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539992).  Saving model ...
Epoch: 6 cost time: 3.4448909759521484
Epoch: 6, Steps: 20 | Train Loss: 0.476 Vali Loss: 1.097 Vali Acc: 0.470 Test Loss: 1.097 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.417492151260376
Epoch: 7, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.892 Vali Acc: 0.520 Test Loss: 0.892 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.4543263912200928
Epoch: 8, Steps: 20 | Train Loss: 0.341 Vali Loss: 0.929 Vali Acc: 0.590 Test Loss: 0.929 Test Acc: 0.590
Validation loss decreased (-0.539992 --> -0.589991).  Saving model ...
Epoch: 9 cost time: 3.275071620941162
Epoch: 9, Steps: 20 | Train Loss: 0.312 Vali Loss: 0.925 Vali Acc: 0.570 Test Loss: 0.925 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2953243255615234
Epoch: 10, Steps: 20 | Train Loss: 0.262 Vali Loss: 1.109 Vali Acc: 0.600 Test Loss: 1.109 Test Acc: 0.600
Validation loss decreased (-0.589991 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 3.1543948650360107
Epoch: 11, Steps: 20 | Train Loss: 0.226 Vali Loss: 1.515 Vali Acc: 0.600 Test Loss: 1.515 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.970259428024292
Epoch: 12, Steps: 20 | Train Loss: 0.148 Vali Loss: 1.311 Vali Acc: 0.590 Test Loss: 1.311 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.124539613723755
Epoch: 13, Steps: 20 | Train Loss: 0.174 Vali Loss: 1.432 Vali Acc: 0.510 Test Loss: 1.432 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.352741241455078
Epoch: 14, Steps: 20 | Train Loss: 0.122 Vali Loss: 1.474 Vali Acc: 0.530 Test Loss: 1.474 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.1856889724731445
Epoch: 15, Steps: 20 | Train Loss: 0.096 Vali Loss: 2.602 Vali Acc: 0.510 Test Loss: 2.602 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.417667865753174
Epoch: 16, Steps: 20 | Train Loss: 0.096 Vali Loss: 1.899 Vali Acc: 0.540 Test Loss: 1.899 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.2535054683685303
Epoch: 17, Steps: 20 | Train Loss: 0.066 Vali Loss: 2.006 Vali Acc: 0.470 Test Loss: 2.006 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.1666758060455322
Epoch: 18, Steps: 20 | Train Loss: 0.033 Vali Loss: 1.907 Vali Acc: 0.550 Test Loss: 1.907 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.4372007846832275
Epoch: 19, Steps: 20 | Train Loss: 0.054 Vali Loss: 2.616 Vali Acc: 0.510 Test Loss: 2.616 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.481769561767578
Epoch: 20, Steps: 20 | Train Loss: 0.044 Vali Loss: 2.760 Vali Acc: 0.460 Test Loss: 2.760 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 3401186
model size : 13.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.890824317932129
Epoch: 1, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.735 Vali Acc: 0.440 Test Loss: 0.735 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 2.6746418476104736
Epoch: 2, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.846 Vali Acc: 0.480 Test Loss: 0.846 Test Acc: 0.480
Validation loss decreased (-0.439993 --> -0.479992).  Saving model ...
Epoch: 3 cost time: 2.568868398666382
Epoch: 3, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.831 Vali Acc: 0.430 Test Loss: 0.831 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9468393325805664
Epoch: 4, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.855 Vali Acc: 0.520 Test Loss: 0.855 Test Acc: 0.520
Validation loss decreased (-0.479992 --> -0.519991).  Saving model ...
Epoch: 5 cost time: 3.0777416229248047
Epoch: 5, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.789 Vali Acc: 0.490 Test Loss: 0.789 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1185085773468018
Epoch: 6, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.794 Vali Acc: 0.510 Test Loss: 0.794 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0149519443511963
Epoch: 7, Steps: 20 | Train Loss: 0.444 Vali Loss: 0.841 Vali Acc: 0.540 Test Loss: 0.841 Test Acc: 0.540
Validation loss decreased (-0.519991 --> -0.539992).  Saving model ...
Epoch: 8 cost time: 3.2731447219848633
Epoch: 8, Steps: 20 | Train Loss: 0.413 Vali Loss: 0.916 Vali Acc: 0.550 Test Loss: 0.916 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549991).  Saving model ...
Epoch: 9 cost time: 2.9945783615112305
Epoch: 9, Steps: 20 | Train Loss: 0.332 Vali Loss: 0.860 Vali Acc: 0.580 Test Loss: 0.860 Test Acc: 0.580
Validation loss decreased (-0.549991 --> -0.579991).  Saving model ...
Epoch: 10 cost time: 2.197946071624756
Epoch: 10, Steps: 20 | Train Loss: 0.272 Vali Loss: 0.882 Vali Acc: 0.560 Test Loss: 0.882 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2477211952209473
Epoch: 11, Steps: 20 | Train Loss: 0.215 Vali Loss: 1.124 Vali Acc: 0.500 Test Loss: 1.124 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.2312633991241455
Epoch: 12, Steps: 20 | Train Loss: 0.176 Vali Loss: 1.093 Vali Acc: 0.550 Test Loss: 1.093 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.9592678546905518
Epoch: 13, Steps: 20 | Train Loss: 0.138 Vali Loss: 1.315 Vali Acc: 0.540 Test Loss: 1.315 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.7643144130706787
Epoch: 14, Steps: 20 | Train Loss: 0.077 Vali Loss: 1.475 Vali Acc: 0.490 Test Loss: 1.475 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.737015962600708
Epoch: 15, Steps: 20 | Train Loss: 0.064 Vali Loss: 1.419 Vali Acc: 0.550 Test Loss: 1.419 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.8399224281311035
Epoch: 16, Steps: 20 | Train Loss: 0.048 Vali Loss: 1.902 Vali Acc: 0.500 Test Loss: 1.902 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.0250918865203857
Epoch: 17, Steps: 20 | Train Loss: 0.112 Vali Loss: 1.542 Vali Acc: 0.540 Test Loss: 1.542 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.962341070175171
Epoch: 18, Steps: 20 | Train Loss: 0.043 Vali Loss: 1.979 Vali Acc: 0.450 Test Loss: 1.979 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.2784841060638428
Epoch: 19, Steps: 20 | Train Loss: 0.024 Vali Loss: 2.159 Vali Acc: 0.480 Test Loss: 2.159 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 3358210
model size : 12.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5944762229919434
Epoch: 1, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.679 Vali Acc: 0.510 Test Loss: 0.679 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.320148468017578
Epoch: 2, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.479139804840088
Epoch: 3, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.778 Vali Acc: 0.460 Test Loss: 0.778 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7503907680511475
Epoch: 4, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.781 Vali Acc: 0.510 Test Loss: 0.781 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8160459995269775
Epoch: 5, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.821 Vali Acc: 0.560 Test Loss: 0.821 Test Acc: 0.560
Validation loss decreased (-0.509993 --> -0.559992).  Saving model ...
Epoch: 6 cost time: 2.7685160636901855
Epoch: 6, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.822 Vali Acc: 0.520 Test Loss: 0.822 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0253102779388428
Epoch: 7, Steps: 20 | Train Loss: 0.426 Vali Loss: 1.011 Vali Acc: 0.420 Test Loss: 1.011 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9065141677856445
Epoch: 8, Steps: 20 | Train Loss: 0.362 Vali Loss: 0.887 Vali Acc: 0.520 Test Loss: 0.887 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.7312562465667725
Epoch: 9, Steps: 20 | Train Loss: 0.316 Vali Loss: 0.905 Vali Acc: 0.530 Test Loss: 0.905 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.0219614505767822
Epoch: 10, Steps: 20 | Train Loss: 0.214 Vali Loss: 1.208 Vali Acc: 0.470 Test Loss: 1.208 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.089064359664917
Epoch: 11, Steps: 20 | Train Loss: 0.166 Vali Loss: 1.275 Vali Acc: 0.530 Test Loss: 1.275 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.2799601554870605
Epoch: 12, Steps: 20 | Train Loss: 0.178 Vali Loss: 1.655 Vali Acc: 0.540 Test Loss: 1.655 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.2033333778381348
Epoch: 13, Steps: 20 | Train Loss: 0.195 Vali Loss: 1.370 Vali Acc: 0.490 Test Loss: 1.370 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.110841751098633
Epoch: 14, Steps: 20 | Train Loss: 0.110 Vali Loss: 1.495 Vali Acc: 0.550 Test Loss: 1.495 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.1859049797058105
Epoch: 15, Steps: 20 | Train Loss: 0.046 Vali Loss: 1.555 Vali Acc: 0.510 Test Loss: 1.555 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 3358242
model size : 12.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8489837646484375
Epoch: 1, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.716 Vali Acc: 0.440 Test Loss: 0.716 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 2.9549970626831055
Epoch: 2, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.748 Vali Acc: 0.470 Test Loss: 0.748 Test Acc: 0.470
Validation loss decreased (-0.439993 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 2.5756161212921143
Epoch: 3, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.820 Vali Acc: 0.480 Test Loss: 0.820 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479992).  Saving model ...
Epoch: 4 cost time: 2.2369465827941895
Epoch: 4, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.772 Vali Acc: 0.470 Test Loss: 0.772 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8458974361419678
Epoch: 5, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.914 Vali Acc: 0.510 Test Loss: 0.914 Test Acc: 0.510
Validation loss decreased (-0.479992 --> -0.509991).  Saving model ...
Epoch: 6 cost time: 2.826627016067505
Epoch: 6, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.791 Vali Acc: 0.570 Test Loss: 0.791 Test Acc: 0.570
Validation loss decreased (-0.509991 --> -0.569992).  Saving model ...
Epoch: 7 cost time: 2.7221920490264893
Epoch: 7, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.887 Vali Acc: 0.500 Test Loss: 0.887 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9931483268737793
Epoch: 8, Steps: 20 | Train Loss: 0.404 Vali Loss: 0.820 Vali Acc: 0.540 Test Loss: 0.820 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6254217624664307
Epoch: 9, Steps: 20 | Train Loss: 0.361 Vali Loss: 0.911 Vali Acc: 0.530 Test Loss: 0.911 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.695847749710083
Epoch: 10, Steps: 20 | Train Loss: 0.292 Vali Loss: 0.987 Vali Acc: 0.540 Test Loss: 0.987 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5001819133758545
Epoch: 11, Steps: 20 | Train Loss: 0.240 Vali Loss: 0.923 Vali Acc: 0.560 Test Loss: 0.923 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.443608045578003
Epoch: 12, Steps: 20 | Train Loss: 0.179 Vali Loss: 1.197 Vali Acc: 0.520 Test Loss: 1.197 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.691105842590332
Epoch: 13, Steps: 20 | Train Loss: 0.138 Vali Loss: 1.090 Vali Acc: 0.540 Test Loss: 1.090 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.675382137298584
Epoch: 14, Steps: 20 | Train Loss: 0.072 Vali Loss: 1.402 Vali Acc: 0.530 Test Loss: 1.402 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.8871827125549316
Epoch: 15, Steps: 20 | Train Loss: 0.055 Vali Loss: 1.368 Vali Acc: 0.510 Test Loss: 1.368 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.6603569984436035
Epoch: 16, Steps: 20 | Train Loss: 0.035 Vali Loss: 1.527 Vali Acc: 0.530 Test Loss: 1.527 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3336770
model size : 12.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8920743465423584
Epoch: 1, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.695 Vali Acc: 0.520 Test Loss: 0.695 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.631462812423706
Epoch: 2, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.723 Vali Acc: 0.550 Test Loss: 0.723 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 2.5737998485565186
Epoch: 3, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.798 Vali Acc: 0.490 Test Loss: 0.798 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.375337600708008
Epoch: 4, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.806 Vali Acc: 0.510 Test Loss: 0.806 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6351120471954346
Epoch: 5, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.710 Vali Acc: 0.590 Test Loss: 0.710 Test Acc: 0.590
Validation loss decreased (-0.549993 --> -0.589993).  Saving model ...
Epoch: 6 cost time: 2.601016044616699
Epoch: 6, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.736 Vali Acc: 0.550 Test Loss: 0.736 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7391388416290283
Epoch: 7, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.775 Vali Acc: 0.560 Test Loss: 0.775 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7520034313201904
Epoch: 8, Steps: 20 | Train Loss: 0.437 Vali Loss: 0.789 Vali Acc: 0.510 Test Loss: 0.789 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.7035934925079346
Epoch: 9, Steps: 20 | Train Loss: 0.411 Vali Loss: 0.800 Vali Acc: 0.550 Test Loss: 0.800 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.996763229370117
Epoch: 10, Steps: 20 | Train Loss: 0.370 Vali Loss: 0.827 Vali Acc: 0.490 Test Loss: 0.827 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.8077311515808105
Epoch: 11, Steps: 20 | Train Loss: 0.302 Vali Loss: 0.827 Vali Acc: 0.560 Test Loss: 0.827 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.7195277214050293
Epoch: 12, Steps: 20 | Train Loss: 0.255 Vali Loss: 1.038 Vali Acc: 0.520 Test Loss: 1.038 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.230407953262329
Epoch: 13, Steps: 20 | Train Loss: 0.231 Vali Loss: 0.950 Vali Acc: 0.520 Test Loss: 0.950 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.210376501083374
Epoch: 14, Steps: 20 | Train Loss: 0.159 Vali Loss: 0.900 Vali Acc: 0.520 Test Loss: 0.900 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.202005624771118
Epoch: 15, Steps: 20 | Train Loss: 0.103 Vali Loss: 1.151 Vali Acc: 0.530 Test Loss: 1.151 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3329698
model size : 12.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.2391252517700195
Epoch: 1, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.695 Vali Acc: 0.460 Test Loss: 0.695 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 2.8203039169311523
Epoch: 2, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.770 Vali Acc: 0.460 Test Loss: 0.770 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6924872398376465
Epoch: 3, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
Validation loss decreased (-0.459993 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 2.723837375640869
Epoch: 4, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.811 Vali Acc: 0.520 Test Loss: 0.811 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 2.803694248199463
Epoch: 5, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.759 Vali Acc: 0.540 Test Loss: 0.759 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539992).  Saving model ...
Epoch: 6 cost time: 2.780412197113037
Epoch: 6, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.772 Vali Acc: 0.450 Test Loss: 0.772 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.925072193145752
Epoch: 7, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.776 Vali Acc: 0.510 Test Loss: 0.776 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8512697219848633
Epoch: 8, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.843 Vali Acc: 0.530 Test Loss: 0.843 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9041831493377686
Epoch: 9, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.807 Vali Acc: 0.510 Test Loss: 0.807 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.7120909690856934
Epoch: 10, Steps: 20 | Train Loss: 0.358 Vali Loss: 0.773 Vali Acc: 0.580 Test Loss: 0.773 Test Acc: 0.580
Validation loss decreased (-0.539992 --> -0.579992).  Saving model ...
Epoch: 11 cost time: 2.4930410385131836
Epoch: 11, Steps: 20 | Train Loss: 0.282 Vali Loss: 0.834 Vali Acc: 0.530 Test Loss: 0.834 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6478118896484375
Epoch: 12, Steps: 20 | Train Loss: 0.231 Vali Loss: 0.890 Vali Acc: 0.550 Test Loss: 0.890 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.514906644821167
Epoch: 13, Steps: 20 | Train Loss: 0.177 Vali Loss: 0.958 Vali Acc: 0.540 Test Loss: 0.958 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7602086067199707
Epoch: 14, Steps: 20 | Train Loss: 0.151 Vali Loss: 0.967 Vali Acc: 0.590 Test Loss: 0.967 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589990).  Saving model ...
Epoch: 15 cost time: 2.8243048191070557
Epoch: 15, Steps: 20 | Train Loss: 0.107 Vali Loss: 1.067 Vali Acc: 0.540 Test Loss: 1.067 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.875159740447998
Epoch: 16, Steps: 20 | Train Loss: 0.061 Vali Loss: 1.128 Vali Acc: 0.580 Test Loss: 1.128 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7723445892333984
Epoch: 17, Steps: 20 | Train Loss: 0.050 Vali Loss: 1.287 Vali Acc: 0.550 Test Loss: 1.287 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.7697362899780273
Epoch: 18, Steps: 20 | Train Loss: 0.026 Vali Loss: 1.311 Vali Acc: 0.540 Test Loss: 1.311 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.8431241512298584
Epoch: 19, Steps: 20 | Train Loss: 0.016 Vali Loss: 1.349 Vali Acc: 0.560 Test Loss: 1.349 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.529006242752075
Epoch: 20, Steps: 20 | Train Loss: 0.012 Vali Loss: 1.483 Vali Acc: 0.570 Test Loss: 1.483 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.877281904220581
Epoch: 21, Steps: 20 | Train Loss: 0.010 Vali Loss: 1.519 Vali Acc: 0.530 Test Loss: 1.519 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.6541028022766113
Epoch: 22, Steps: 20 | Train Loss: 0.006 Vali Loss: 1.674 Vali Acc: 0.530 Test Loss: 1.674 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.742189884185791
Epoch: 23, Steps: 20 | Train Loss: 0.004 Vali Loss: 1.608 Vali Acc: 0.530 Test Loss: 1.608 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.631643772125244
Epoch: 24, Steps: 20 | Train Loss: 0.003 Vali Loss: 1.640 Vali Acc: 0.530 Test Loss: 1.640 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3329762
model size : 12.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.159916877746582
Epoch: 1, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.700 Vali Acc: 0.440 Test Loss: 0.700 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 2.8105578422546387
Epoch: 2, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.754 Vali Acc: 0.490 Test Loss: 0.754 Test Acc: 0.490
Validation loss decreased (-0.439993 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 2.4379642009735107
Epoch: 3, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.763 Vali Acc: 0.470 Test Loss: 0.763 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6484975814819336
Epoch: 4, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.771 Vali Acc: 0.470 Test Loss: 0.771 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9441263675689697
Epoch: 5, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.796 Vali Acc: 0.510 Test Loss: 0.796 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509992).  Saving model ...
Epoch: 6 cost time: 3.072235345840454
Epoch: 6, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.787 Vali Acc: 0.470 Test Loss: 0.787 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1313974857330322
Epoch: 7, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.771 Vali Acc: 0.560 Test Loss: 0.771 Test Acc: 0.560
Validation loss decreased (-0.509992 --> -0.559992).  Saving model ...
Epoch: 8 cost time: 3.0590133666992188
Epoch: 8, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.790 Vali Acc: 0.580 Test Loss: 0.790 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579992).  Saving model ...
Epoch: 9 cost time: 3.1310579776763916
Epoch: 9, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.889 Vali Acc: 0.540 Test Loss: 0.889 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.008352756500244
Epoch: 10, Steps: 20 | Train Loss: 0.428 Vali Loss: 0.886 Vali Acc: 0.520 Test Loss: 0.886 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.170515298843384
Epoch: 11, Steps: 20 | Train Loss: 0.364 Vali Loss: 0.903 Vali Acc: 0.530 Test Loss: 0.903 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.0646777153015137
Epoch: 12, Steps: 20 | Train Loss: 0.296 Vali Loss: 0.852 Vali Acc: 0.580 Test Loss: 0.852 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.0972931385040283
Epoch: 13, Steps: 20 | Train Loss: 0.238 Vali Loss: 0.984 Vali Acc: 0.560 Test Loss: 0.984 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.0905275344848633
Epoch: 14, Steps: 20 | Train Loss: 0.191 Vali Loss: 1.096 Vali Acc: 0.540 Test Loss: 1.096 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.3440611362457275
Epoch: 15, Steps: 20 | Train Loss: 0.145 Vali Loss: 1.032 Vali Acc: 0.560 Test Loss: 1.032 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.9686899185180664
Epoch: 16, Steps: 20 | Train Loss: 0.097 Vali Loss: 1.237 Vali Acc: 0.570 Test Loss: 1.237 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.261909246444702
Epoch: 17, Steps: 20 | Train Loss: 0.067 Vali Loss: 1.242 Vali Acc: 0.540 Test Loss: 1.242 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.2616677284240723
Epoch: 18, Steps: 20 | Train Loss: 0.039 Vali Loss: 1.341 Vali Acc: 0.580 Test Loss: 1.341 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 3322690
model size : 12.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.578955173492432
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.699 Vali Acc: 0.520 Test Loss: 0.699 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 3.540864944458008
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.811 Vali Acc: 0.500 Test Loss: 0.811 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5168416500091553
Epoch: 3, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.741 Vali Acc: 0.540 Test Loss: 0.741 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 3.4438862800598145
Epoch: 4, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.919 Vali Acc: 0.540 Test Loss: 0.919 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.310901165008545
Epoch: 5, Steps: 20 | Train Loss: 0.550 Vali Loss: 1.056 Vali Acc: 0.520 Test Loss: 1.056 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.2389016151428223
Epoch: 6, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.899 Vali Acc: 0.470 Test Loss: 0.899 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4663636684417725
Epoch: 7, Steps: 20 | Train Loss: 0.477 Vali Loss: 1.041 Vali Acc: 0.560 Test Loss: 1.041 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559990).  Saving model ...
Epoch: 8 cost time: 2.3803653717041016
Epoch: 8, Steps: 20 | Train Loss: 0.374 Vali Loss: 1.015 Vali Acc: 0.580 Test Loss: 1.015 Test Acc: 0.580
Validation loss decreased (-0.559990 --> -0.579990).  Saving model ...
Epoch: 9 cost time: 2.3771824836730957
Epoch: 9, Steps: 20 | Train Loss: 0.297 Vali Loss: 1.127 Vali Acc: 0.500 Test Loss: 1.127 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0169830322265625
Epoch: 10, Steps: 20 | Train Loss: 0.267 Vali Loss: 1.147 Vali Acc: 0.490 Test Loss: 1.147 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.841108798980713
Epoch: 11, Steps: 20 | Train Loss: 0.223 Vali Loss: 1.375 Vali Acc: 0.540 Test Loss: 1.375 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.2142271995544434
Epoch: 12, Steps: 20 | Train Loss: 0.168 Vali Loss: 1.396 Vali Acc: 0.530 Test Loss: 1.396 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.0720646381378174
Epoch: 13, Steps: 20 | Train Loss: 0.139 Vali Loss: 1.722 Vali Acc: 0.540 Test Loss: 1.722 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.4158263206481934
Epoch: 14, Steps: 20 | Train Loss: 0.139 Vali Loss: 1.515 Vali Acc: 0.560 Test Loss: 1.515 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.2722582817077637
Epoch: 15, Steps: 20 | Train Loss: 0.086 Vali Loss: 1.693 Vali Acc: 0.550 Test Loss: 1.693 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.383091926574707
Epoch: 16, Steps: 20 | Train Loss: 0.103 Vali Loss: 2.134 Vali Acc: 0.560 Test Loss: 2.134 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.3824687004089355
Epoch: 17, Steps: 20 | Train Loss: 0.097 Vali Loss: 2.414 Vali Acc: 0.500 Test Loss: 2.414 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.5457160472869873
Epoch: 18, Steps: 20 | Train Loss: 0.069 Vali Loss: 2.344 Vali Acc: 0.510 Test Loss: 2.344 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 3376098
model size : 13.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.044172525405884
Epoch: 1, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 3.017125368118286
Epoch: 2, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.749 Vali Acc: 0.490 Test Loss: 0.749 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4478766918182373
Epoch: 3, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.761 Vali Acc: 0.530 Test Loss: 0.761 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 2.4959611892700195
Epoch: 4, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.741 Vali Acc: 0.570 Test Loss: 0.741 Test Acc: 0.570
Validation loss decreased (-0.529992 --> -0.569993).  Saving model ...
Epoch: 5 cost time: 2.5689382553100586
Epoch: 5, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.794 Vali Acc: 0.550 Test Loss: 0.794 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.336282253265381
Epoch: 6, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.797 Vali Acc: 0.520 Test Loss: 0.797 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.047436475753784
Epoch: 7, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.760 Vali Acc: 0.530 Test Loss: 0.760 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.214176654815674
Epoch: 8, Steps: 20 | Train Loss: 0.364 Vali Loss: 0.879 Vali Acc: 0.540 Test Loss: 0.879 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.1565256118774414
Epoch: 9, Steps: 20 | Train Loss: 0.320 Vali Loss: 0.822 Vali Acc: 0.570 Test Loss: 0.822 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.0820841789245605
Epoch: 10, Steps: 20 | Train Loss: 0.257 Vali Loss: 1.082 Vali Acc: 0.550 Test Loss: 1.082 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.88759708404541
Epoch: 11, Steps: 20 | Train Loss: 0.236 Vali Loss: 0.984 Vali Acc: 0.580 Test Loss: 0.984 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579990).  Saving model ...
Epoch: 12 cost time: 3.1503989696502686
Epoch: 12, Steps: 20 | Train Loss: 0.184 Vali Loss: 1.032 Vali Acc: 0.520 Test Loss: 1.032 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8407962322235107
Epoch: 13, Steps: 20 | Train Loss: 0.119 Vali Loss: 1.150 Vali Acc: 0.540 Test Loss: 1.150 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.214874505996704
Epoch: 14, Steps: 20 | Train Loss: 0.149 Vali Loss: 1.651 Vali Acc: 0.570 Test Loss: 1.651 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.8758747577667236
Epoch: 15, Steps: 20 | Train Loss: 0.161 Vali Loss: 1.403 Vali Acc: 0.480 Test Loss: 1.403 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.769986152648926
Epoch: 16, Steps: 20 | Train Loss: 0.075 Vali Loss: 1.445 Vali Acc: 0.520 Test Loss: 1.445 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.498601198196411
Epoch: 17, Steps: 20 | Train Loss: 0.054 Vali Loss: 1.749 Vali Acc: 0.470 Test Loss: 1.749 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.6955599784851074
Epoch: 18, Steps: 20 | Train Loss: 0.025 Vali Loss: 1.711 Vali Acc: 0.520 Test Loss: 1.711 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.6992762088775635
Epoch: 19, Steps: 20 | Train Loss: 0.008 Vali Loss: 1.724 Vali Acc: 0.540 Test Loss: 1.724 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.527488946914673
Epoch: 20, Steps: 20 | Train Loss: 0.007 Vali Loss: 1.659 Vali Acc: 0.520 Test Loss: 1.659 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.0791869163513184
Epoch: 21, Steps: 20 | Train Loss: 0.005 Vali Loss: 1.728 Vali Acc: 0.520 Test Loss: 1.728 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 3333122
model size : 12.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.17446756362915
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.7172091007232666
Epoch: 2, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.761 Vali Acc: 0.550 Test Loss: 0.761 Test Acc: 0.550
Validation loss decreased (-0.499993 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 2.7855772972106934
Epoch: 3, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.750 Vali Acc: 0.530 Test Loss: 0.750 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8643441200256348
Epoch: 4, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.782 Vali Acc: 0.520 Test Loss: 0.782 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.853161573410034
Epoch: 5, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.866 Vali Acc: 0.520 Test Loss: 0.866 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.018958330154419
Epoch: 6, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.872 Vali Acc: 0.550 Test Loss: 0.872 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.039487600326538
Epoch: 7, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.833 Vali Acc: 0.500 Test Loss: 0.833 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.5556640625
Epoch: 8, Steps: 20 | Train Loss: 0.381 Vali Loss: 0.835 Vali Acc: 0.540 Test Loss: 0.835 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.6851212978363037
Epoch: 9, Steps: 20 | Train Loss: 0.300 Vali Loss: 0.973 Vali Acc: 0.510 Test Loss: 0.973 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.6892354488372803
Epoch: 10, Steps: 20 | Train Loss: 0.242 Vali Loss: 1.196 Vali Acc: 0.540 Test Loss: 1.196 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.94354510307312
Epoch: 11, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.101 Vali Acc: 0.520 Test Loss: 1.101 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.9128177165985107
Epoch: 12, Steps: 20 | Train Loss: 0.137 Vali Loss: 1.264 Vali Acc: 0.520 Test Loss: 1.264 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 3333154
model size : 12.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.138222932815552
Epoch: 1, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.67240047454834
Epoch: 2, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.745 Vali Acc: 0.470 Test Loss: 0.745 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4404654502868652
Epoch: 3, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.797 Vali Acc: 0.520 Test Loss: 0.797 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 2.6805553436279297
Epoch: 4, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.783 Vali Acc: 0.550 Test Loss: 0.783 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549992).  Saving model ...
Epoch: 5 cost time: 2.216501235961914
Epoch: 5, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.721 Vali Acc: 0.600 Test Loss: 0.721 Test Acc: 0.600
Validation loss decreased (-0.549992 --> -0.599993).  Saving model ...
Epoch: 6 cost time: 2.127957344055176
Epoch: 6, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.889 Vali Acc: 0.540 Test Loss: 0.889 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8864943981170654
Epoch: 7, Steps: 20 | Train Loss: 0.484 Vali Loss: 0.863 Vali Acc: 0.550 Test Loss: 0.863 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9600086212158203
Epoch: 8, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.925 Vali Acc: 0.520 Test Loss: 0.925 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8770463466644287
Epoch: 9, Steps: 20 | Train Loss: 0.363 Vali Loss: 1.008 Vali Acc: 0.510 Test Loss: 1.008 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.9934699535369873
Epoch: 10, Steps: 20 | Train Loss: 0.293 Vali Loss: 0.976 Vali Acc: 0.530 Test Loss: 0.976 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.6686224937438965
Epoch: 11, Steps: 20 | Train Loss: 0.235 Vali Loss: 1.029 Vali Acc: 0.570 Test Loss: 1.029 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.851879835128784
Epoch: 12, Steps: 20 | Train Loss: 0.204 Vali Loss: 1.200 Vali Acc: 0.540 Test Loss: 1.200 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.8145954608917236
Epoch: 13, Steps: 20 | Train Loss: 0.141 Vali Loss: 1.060 Vali Acc: 0.550 Test Loss: 1.060 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.7488808631896973
Epoch: 14, Steps: 20 | Train Loss: 0.099 Vali Loss: 1.189 Vali Acc: 0.550 Test Loss: 1.189 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.676846742630005
Epoch: 15, Steps: 20 | Train Loss: 0.075 Vali Loss: 1.378 Vali Acc: 0.520 Test Loss: 1.378 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 3311682
model size : 12.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.1702845096588135
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.711 Vali Acc: 0.440 Test Loss: 0.711 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 2.8193130493164062
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.714 Vali Acc: 0.520 Test Loss: 0.714 Test Acc: 0.520
Validation loss decreased (-0.439993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 2.378100633621216
Epoch: 3, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.763 Vali Acc: 0.490 Test Loss: 0.763 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3611154556274414
Epoch: 4, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.762 Vali Acc: 0.510 Test Loss: 0.762 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4027268886566162
Epoch: 5, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.741 Vali Acc: 0.470 Test Loss: 0.741 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.9828708171844482
Epoch: 6, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.773 Vali Acc: 0.500 Test Loss: 0.773 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5314900875091553
Epoch: 7, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.858 Vali Acc: 0.540 Test Loss: 0.858 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539991).  Saving model ...
Epoch: 8 cost time: 2.800454616546631
Epoch: 8, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.783 Vali Acc: 0.560 Test Loss: 0.783 Test Acc: 0.560
Validation loss decreased (-0.539991 --> -0.559992).  Saving model ...
Epoch: 9 cost time: 2.7425644397735596
Epoch: 9, Steps: 20 | Train Loss: 0.364 Vali Loss: 0.893 Vali Acc: 0.510 Test Loss: 0.893 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5681166648864746
Epoch: 10, Steps: 20 | Train Loss: 0.331 Vali Loss: 0.923 Vali Acc: 0.490 Test Loss: 0.923 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6713993549346924
Epoch: 11, Steps: 20 | Train Loss: 0.259 Vali Loss: 0.928 Vali Acc: 0.530 Test Loss: 0.928 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.64414644241333
Epoch: 12, Steps: 20 | Train Loss: 0.221 Vali Loss: 0.919 Vali Acc: 0.520 Test Loss: 0.919 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.8217899799346924
Epoch: 13, Steps: 20 | Train Loss: 0.205 Vali Loss: 0.969 Vali Acc: 0.610 Test Loss: 0.969 Test Acc: 0.610
Validation loss decreased (-0.559992 --> -0.609990).  Saving model ...
Epoch: 14 cost time: 2.9636058807373047
Epoch: 14, Steps: 20 | Train Loss: 0.183 Vali Loss: 1.110 Vali Acc: 0.490 Test Loss: 1.110 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7261462211608887
Epoch: 15, Steps: 20 | Train Loss: 0.090 Vali Loss: 0.976 Vali Acc: 0.580 Test Loss: 0.976 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9036238193511963
Epoch: 16, Steps: 20 | Train Loss: 0.067 Vali Loss: 1.192 Vali Acc: 0.540 Test Loss: 1.192 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.5032918453216553
Epoch: 17, Steps: 20 | Train Loss: 0.044 Vali Loss: 1.290 Vali Acc: 0.490 Test Loss: 1.290 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9704606533050537
Epoch: 18, Steps: 20 | Train Loss: 0.029 Vali Loss: 1.244 Vali Acc: 0.540 Test Loss: 1.244 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9225108623504639
Epoch: 19, Steps: 20 | Train Loss: 0.014 Vali Loss: 1.349 Vali Acc: 0.530 Test Loss: 1.349 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.12148118019104
Epoch: 20, Steps: 20 | Train Loss: 0.008 Vali Loss: 1.418 Vali Acc: 0.540 Test Loss: 1.418 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.0936076641082764
Epoch: 21, Steps: 20 | Train Loss: 0.007 Vali Loss: 1.484 Vali Acc: 0.540 Test Loss: 1.484 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.8341891765594482
Epoch: 22, Steps: 20 | Train Loss: 0.005 Vali Loss: 1.501 Vali Acc: 0.530 Test Loss: 1.501 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.750620126724243
Epoch: 23, Steps: 20 | Train Loss: 0.004 Vali Loss: 1.517 Vali Acc: 0.530 Test Loss: 1.517 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 3304610
model size : 12.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.916473627090454
Epoch: 1, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.719 Vali Acc: 0.440 Test Loss: 0.719 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 2.607433557510376
Epoch: 2, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.773 Vali Acc: 0.460 Test Loss: 0.773 Test Acc: 0.460
Validation loss decreased (-0.439993 --> -0.459992).  Saving model ...
Epoch: 3 cost time: 2.7761454582214355
Epoch: 3, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.781 Vali Acc: 0.520 Test Loss: 0.781 Test Acc: 0.520
Validation loss decreased (-0.459992 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 2.713433027267456
Epoch: 4, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.764 Vali Acc: 0.490 Test Loss: 0.764 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1473536491394043
Epoch: 5, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.743 Vali Acc: 0.520 Test Loss: 0.743 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519993).  Saving model ...
Epoch: 6 cost time: 2.3415915966033936
Epoch: 6, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.799 Vali Acc: 0.480 Test Loss: 0.799 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1286659240722656
Epoch: 7, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.757 Vali Acc: 0.530 Test Loss: 0.757 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 8 cost time: 2.626033306121826
Epoch: 8, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.812 Vali Acc: 0.500 Test Loss: 0.812 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.786569833755493
Epoch: 9, Steps: 20 | Train Loss: 0.434 Vali Loss: 0.868 Vali Acc: 0.530 Test Loss: 0.868 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.704136371612549
Epoch: 10, Steps: 20 | Train Loss: 0.368 Vali Loss: 0.803 Vali Acc: 0.630 Test Loss: 0.803 Test Acc: 0.630
Validation loss decreased (-0.529992 --> -0.629992).  Saving model ...
Epoch: 11 cost time: 2.732680082321167
Epoch: 11, Steps: 20 | Train Loss: 0.300 Vali Loss: 0.829 Vali Acc: 0.510 Test Loss: 0.829 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6345303058624268
Epoch: 12, Steps: 20 | Train Loss: 0.254 Vali Loss: 0.857 Vali Acc: 0.530 Test Loss: 0.857 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.781209707260132
Epoch: 13, Steps: 20 | Train Loss: 0.198 Vali Loss: 0.953 Vali Acc: 0.550 Test Loss: 0.953 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.6290719509124756
Epoch: 14, Steps: 20 | Train Loss: 0.154 Vali Loss: 1.056 Vali Acc: 0.550 Test Loss: 1.056 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.6952505111694336
Epoch: 15, Steps: 20 | Train Loss: 0.099 Vali Loss: 1.104 Vali Acc: 0.580 Test Loss: 1.104 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.604623556137085
Epoch: 16, Steps: 20 | Train Loss: 0.059 Vali Loss: 1.187 Vali Acc: 0.540 Test Loss: 1.187 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.7463018894195557
Epoch: 17, Steps: 20 | Train Loss: 0.038 Vali Loss: 1.274 Vali Acc: 0.550 Test Loss: 1.274 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.4093425273895264
Epoch: 18, Steps: 20 | Train Loss: 0.023 Vali Loss: 1.397 Vali Acc: 0.550 Test Loss: 1.397 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.1232640743255615
Epoch: 19, Steps: 20 | Train Loss: 0.020 Vali Loss: 1.645 Vali Acc: 0.550 Test Loss: 1.645 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.79915189743042
Epoch: 20, Steps: 20 | Train Loss: 0.013 Vali Loss: 1.481 Vali Acc: 0.550 Test Loss: 1.481 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 3304674
model size : 12.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.239678382873535
Epoch: 1, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.695 Vali Acc: 0.510 Test Loss: 0.695 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.4635751247406006
Epoch: 2, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.720 Vali Acc: 0.510 Test Loss: 0.720 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6166434288024902
Epoch: 3, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.739 Vali Acc: 0.540 Test Loss: 0.739 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 2.51715350151062
Epoch: 4, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.753 Vali Acc: 0.540 Test Loss: 0.753 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.531998634338379
Epoch: 5, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.760 Vali Acc: 0.500 Test Loss: 0.760 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6111109256744385
Epoch: 6, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.777 Vali Acc: 0.540 Test Loss: 0.777 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5616660118103027
Epoch: 7, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.772 Vali Acc: 0.550 Test Loss: 0.772 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 2.793909788131714
Epoch: 8, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.788 Vali Acc: 0.480 Test Loss: 0.788 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6557857990264893
Epoch: 9, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.772 Vali Acc: 0.510 Test Loss: 0.772 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.677482843399048
Epoch: 10, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.897 Vali Acc: 0.470 Test Loss: 0.897 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0539047718048096
Epoch: 11, Steps: 20 | Train Loss: 0.374 Vali Loss: 0.848 Vali Acc: 0.510 Test Loss: 0.848 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9632034301757812
Epoch: 12, Steps: 20 | Train Loss: 0.314 Vali Loss: 0.893 Vali Acc: 0.550 Test Loss: 0.893 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.1647133827209473
Epoch: 13, Steps: 20 | Train Loss: 0.266 Vali Loss: 1.103 Vali Acc: 0.530 Test Loss: 1.103 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.564016103744507
Epoch: 14, Steps: 20 | Train Loss: 0.214 Vali Loss: 0.911 Vali Acc: 0.530 Test Loss: 0.911 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.6392345428466797
Epoch: 15, Steps: 20 | Train Loss: 0.134 Vali Loss: 0.989 Vali Acc: 0.570 Test Loss: 0.989 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569990).  Saving model ...
Epoch: 16 cost time: 2.5982604026794434
Epoch: 16, Steps: 20 | Train Loss: 0.098 Vali Loss: 1.006 Vali Acc: 0.570 Test Loss: 1.006 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.684903383255005
Epoch: 17, Steps: 20 | Train Loss: 0.087 Vali Loss: 1.420 Vali Acc: 0.510 Test Loss: 1.420 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.466094732284546
Epoch: 18, Steps: 20 | Train Loss: 0.057 Vali Loss: 1.325 Vali Acc: 0.530 Test Loss: 1.325 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.6354780197143555
Epoch: 19, Steps: 20 | Train Loss: 0.028 Vali Loss: 1.388 Vali Acc: 0.530 Test Loss: 1.388 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.4231019020080566
Epoch: 20, Steps: 20 | Train Loss: 0.021 Vali Loss: 1.583 Vali Acc: 0.540 Test Loss: 1.583 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.7925705909729004
Epoch: 21, Steps: 20 | Train Loss: 0.026 Vali Loss: 1.694 Vali Acc: 0.530 Test Loss: 1.694 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.42386794090271
Epoch: 22, Steps: 20 | Train Loss: 0.019 Vali Loss: 1.938 Vali Acc: 0.470 Test Loss: 1.938 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.4974205493927
Epoch: 23, Steps: 20 | Train Loss: 0.018 Vali Loss: 1.481 Vali Acc: 0.570 Test Loss: 1.481 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.4287214279174805
Epoch: 24, Steps: 20 | Train Loss: 0.008 Vali Loss: 1.696 Vali Acc: 0.530 Test Loss: 1.696 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.4796695709228516
Epoch: 25, Steps: 20 | Train Loss: 0.005 Vali Loss: 1.747 Vali Acc: 0.540 Test Loss: 1.747 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3297602
model size : 12.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.893707275390625
Epoch: 1, Steps: 20 | Train Loss: 0.827 Vali Loss: 0.895 Vali Acc: 0.530 Test Loss: 0.895 Test Acc: 0.530
Validation loss decreased (inf --> -0.529991).  Saving model ...
Epoch: 2 cost time: 4.831207513809204
Epoch: 2, Steps: 20 | Train Loss: 0.790 Vali Loss: 0.765 Vali Acc: 0.540 Test Loss: 0.765 Test Acc: 0.540
Validation loss decreased (-0.529991 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 3.9968278408050537
Epoch: 3, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.944 Vali Acc: 0.570 Test Loss: 0.944 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569991).  Saving model ...
Epoch: 4 cost time: 3.999737501144409
Epoch: 4, Steps: 20 | Train Loss: 0.901 Vali Loss: 1.120 Vali Acc: 0.550 Test Loss: 1.120 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.815461874008179
Epoch: 5, Steps: 20 | Train Loss: 0.682 Vali Loss: 1.017 Vali Acc: 0.510 Test Loss: 1.017 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.677460432052612
Epoch: 6, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.950 Vali Acc: 0.530 Test Loss: 0.950 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.850425720214844
Epoch: 7, Steps: 20 | Train Loss: 0.454 Vali Loss: 1.037 Vali Acc: 0.550 Test Loss: 1.037 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.5763418674468994
Epoch: 8, Steps: 20 | Train Loss: 0.509 Vali Loss: 1.108 Vali Acc: 0.600 Test Loss: 1.108 Test Acc: 0.600
Validation loss decreased (-0.569991 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 4.504756212234497
Epoch: 9, Steps: 20 | Train Loss: 0.507 Vali Loss: 1.024 Vali Acc: 0.570 Test Loss: 1.024 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.482891082763672
Epoch: 10, Steps: 20 | Train Loss: 0.469 Vali Loss: 1.377 Vali Acc: 0.500 Test Loss: 1.377 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.860642910003662
Epoch: 11, Steps: 20 | Train Loss: 0.265 Vali Loss: 1.405 Vali Acc: 0.570 Test Loss: 1.405 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.820661306381226
Epoch: 12, Steps: 20 | Train Loss: 0.315 Vali Loss: 1.768 Vali Acc: 0.510 Test Loss: 1.768 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.736265420913696
Epoch: 13, Steps: 20 | Train Loss: 0.365 Vali Loss: 3.071 Vali Acc: 0.520 Test Loss: 3.071 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.908518552780151
Epoch: 14, Steps: 20 | Train Loss: 0.417 Vali Loss: 2.179 Vali Acc: 0.520 Test Loss: 2.179 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.884308815002441
Epoch: 15, Steps: 20 | Train Loss: 0.348 Vali Loss: 3.033 Vali Acc: 0.480 Test Loss: 3.033 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.850774526596069
Epoch: 16, Steps: 20 | Train Loss: 0.313 Vali Loss: 2.624 Vali Acc: 0.550 Test Loss: 2.624 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.051711082458496
Epoch: 17, Steps: 20 | Train Loss: 0.326 Vali Loss: 3.545 Vali Acc: 0.490 Test Loss: 3.545 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.841832399368286
Epoch: 18, Steps: 20 | Train Loss: 0.323 Vali Loss: 3.596 Vali Acc: 0.560 Test Loss: 3.596 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 11106178
model size : 42.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.479180812835693
Epoch: 1, Steps: 20 | Train Loss: 0.806 Vali Loss: 0.816 Vali Acc: 0.560 Test Loss: 0.816 Test Acc: 0.560
Validation loss decreased (inf --> -0.559992).  Saving model ...
Epoch: 2 cost time: 3.950465202331543
Epoch: 2, Steps: 20 | Train Loss: 0.793 Vali Loss: 0.729 Vali Acc: 0.530 Test Loss: 0.729 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.027822494506836
Epoch: 3, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.911 Vali Acc: 0.460 Test Loss: 0.911 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.80228853225708
Epoch: 4, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.904 Vali Acc: 0.490 Test Loss: 0.904 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.890864133834839
Epoch: 5, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.877 Vali Acc: 0.500 Test Loss: 0.877 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.5912652015686035
Epoch: 6, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.977 Vali Acc: 0.490 Test Loss: 0.977 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.6428327560424805
Epoch: 7, Steps: 20 | Train Loss: 0.485 Vali Loss: 1.071 Vali Acc: 0.520 Test Loss: 1.071 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.5733020305633545
Epoch: 8, Steps: 20 | Train Loss: 0.357 Vali Loss: 0.890 Vali Acc: 0.610 Test Loss: 0.890 Test Acc: 0.610
Validation loss decreased (-0.559992 --> -0.609991).  Saving model ...
Epoch: 9 cost time: 4.070805311203003
Epoch: 9, Steps: 20 | Train Loss: 0.249 Vali Loss: 1.554 Vali Acc: 0.540 Test Loss: 1.554 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.847789764404297
Epoch: 10, Steps: 20 | Train Loss: 0.303 Vali Loss: 1.212 Vali Acc: 0.570 Test Loss: 1.212 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.9556469917297363
Epoch: 11, Steps: 20 | Train Loss: 0.184 Vali Loss: 2.360 Vali Acc: 0.510 Test Loss: 2.360 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.352767705917358
Epoch: 12, Steps: 20 | Train Loss: 0.172 Vali Loss: 2.022 Vali Acc: 0.540 Test Loss: 2.022 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.4684977531433105
Epoch: 13, Steps: 20 | Train Loss: 0.150 Vali Loss: 2.354 Vali Acc: 0.490 Test Loss: 2.354 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.264559984207153
Epoch: 14, Steps: 20 | Train Loss: 0.094 Vali Loss: 2.067 Vali Acc: 0.520 Test Loss: 2.067 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.9123318195343018
Epoch: 15, Steps: 20 | Train Loss: 0.065 Vali Loss: 2.467 Vali Acc: 0.500 Test Loss: 2.467 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.8009400367736816
Epoch: 16, Steps: 20 | Train Loss: 0.086 Vali Loss: 2.681 Vali Acc: 0.520 Test Loss: 2.681 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.6496617794036865
Epoch: 17, Steps: 20 | Train Loss: 0.127 Vali Loss: 2.735 Vali Acc: 0.510 Test Loss: 2.735 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.7286579608917236
Epoch: 18, Steps: 20 | Train Loss: 0.068 Vali Loss: 3.955 Vali Acc: 0.470 Test Loss: 3.955 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 10934274
model size : 41.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.456325054168701
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.688 Vali Acc: 0.580 Test Loss: 0.688 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 4.166977405548096
Epoch: 2, Steps: 20 | Train Loss: 0.708 Vali Loss: 1.119 Vali Acc: 0.510 Test Loss: 1.119 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.357791900634766
Epoch: 3, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.995 Vali Acc: 0.530 Test Loss: 0.995 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.297588109970093
Epoch: 4, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.968 Vali Acc: 0.490 Test Loss: 0.968 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.209624290466309
Epoch: 5, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.977 Vali Acc: 0.590 Test Loss: 0.977 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589990).  Saving model ...
Epoch: 6 cost time: 4.294265031814575
Epoch: 6, Steps: 20 | Train Loss: 0.566 Vali Loss: 1.143 Vali Acc: 0.540 Test Loss: 1.143 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.464501142501831
Epoch: 7, Steps: 20 | Train Loss: 0.513 Vali Loss: 1.418 Vali Acc: 0.470 Test Loss: 1.418 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.0569844245910645
Epoch: 8, Steps: 20 | Train Loss: 0.451 Vali Loss: 1.188 Vali Acc: 0.530 Test Loss: 1.188 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.4558606147766113
Epoch: 9, Steps: 20 | Train Loss: 0.339 Vali Loss: 1.531 Vali Acc: 0.530 Test Loss: 1.531 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.596160650253296
Epoch: 10, Steps: 20 | Train Loss: 0.241 Vali Loss: 1.543 Vali Acc: 0.530 Test Loss: 1.543 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.7183210849761963
Epoch: 11, Steps: 20 | Train Loss: 0.197 Vali Loss: 1.853 Vali Acc: 0.540 Test Loss: 1.853 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.060624361038208
Epoch: 12, Steps: 20 | Train Loss: 0.241 Vali Loss: 1.540 Vali Acc: 0.540 Test Loss: 1.540 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.031943082809448
Epoch: 13, Steps: 20 | Train Loss: 0.123 Vali Loss: 2.042 Vali Acc: 0.540 Test Loss: 2.042 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.099281072616577
Epoch: 14, Steps: 20 | Train Loss: 0.194 Vali Loss: 2.291 Vali Acc: 0.550 Test Loss: 2.291 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.134315490722656
Epoch: 15, Steps: 20 | Train Loss: 0.056 Vali Loss: 2.227 Vali Acc: 0.510 Test Loss: 2.227 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 10934402
model size : 41.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.795158624649048
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.698 Vali Acc: 0.520 Test Loss: 0.698 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 3.3042051792144775
Epoch: 2, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.839 Vali Acc: 0.540 Test Loss: 0.839 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 3.065323829650879
Epoch: 3, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.811 Vali Acc: 0.550 Test Loss: 0.811 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 3.3597850799560547
Epoch: 4, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.749 Vali Acc: 0.550 Test Loss: 0.749 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 3.5606143474578857
Epoch: 5, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.963 Vali Acc: 0.530 Test Loss: 0.963 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.770824909210205
Epoch: 6, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.866 Vali Acc: 0.560 Test Loss: 0.866 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559991).  Saving model ...
Epoch: 7 cost time: 3.700961112976074
Epoch: 7, Steps: 20 | Train Loss: 0.419 Vali Loss: 1.099 Vali Acc: 0.570 Test Loss: 1.099 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569989).  Saving model ...
Epoch: 8 cost time: 3.288822889328003
Epoch: 8, Steps: 20 | Train Loss: 0.391 Vali Loss: 1.575 Vali Acc: 0.500 Test Loss: 1.575 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.272251844406128
Epoch: 9, Steps: 20 | Train Loss: 0.494 Vali Loss: 1.182 Vali Acc: 0.540 Test Loss: 1.182 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.673325777053833
Epoch: 10, Steps: 20 | Train Loss: 0.267 Vali Loss: 1.043 Vali Acc: 0.580 Test Loss: 1.043 Test Acc: 0.580
Validation loss decreased (-0.569989 --> -0.579990).  Saving model ...
Epoch: 11 cost time: 3.6999597549438477
Epoch: 11, Steps: 20 | Train Loss: 0.234 Vali Loss: 1.537 Vali Acc: 0.520 Test Loss: 1.537 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4438867568969727
Epoch: 12, Steps: 20 | Train Loss: 0.156 Vali Loss: 1.253 Vali Acc: 0.590 Test Loss: 1.253 Test Acc: 0.590
Validation loss decreased (-0.579990 --> -0.589987).  Saving model ...
Epoch: 13 cost time: 3.171017646789551
Epoch: 13, Steps: 20 | Train Loss: 0.100 Vali Loss: 1.578 Vali Acc: 0.560 Test Loss: 1.578 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2999424934387207
Epoch: 14, Steps: 20 | Train Loss: 0.090 Vali Loss: 2.069 Vali Acc: 0.540 Test Loss: 2.069 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.7473294734954834
Epoch: 15, Steps: 20 | Train Loss: 0.071 Vali Loss: 1.918 Vali Acc: 0.520 Test Loss: 1.918 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.8449547290802
Epoch: 16, Steps: 20 | Train Loss: 0.049 Vali Loss: 2.487 Vali Acc: 0.520 Test Loss: 2.487 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.793044328689575
Epoch: 17, Steps: 20 | Train Loss: 0.079 Vali Loss: 2.552 Vali Acc: 0.530 Test Loss: 2.552 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.85433030128479
Epoch: 18, Steps: 20 | Train Loss: 0.077 Vali Loss: 2.673 Vali Acc: 0.530 Test Loss: 2.673 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.8140530586242676
Epoch: 19, Steps: 20 | Train Loss: 0.050 Vali Loss: 2.880 Vali Acc: 0.500 Test Loss: 2.880 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.8377723693847656
Epoch: 20, Steps: 20 | Train Loss: 0.047 Vali Loss: 2.974 Vali Acc: 0.600 Test Loss: 2.974 Test Acc: 0.600
Validation loss decreased (-0.589987 --> -0.599970).  Saving model ...
Epoch: 21 cost time: 3.940608501434326
Epoch: 21, Steps: 20 | Train Loss: 0.031 Vali Loss: 3.582 Vali Acc: 0.520 Test Loss: 3.582 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.992002010345459
Epoch: 22, Steps: 20 | Train Loss: 0.036 Vali Loss: 3.690 Vali Acc: 0.520 Test Loss: 3.690 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.521843433380127
Epoch: 23, Steps: 20 | Train Loss: 0.080 Vali Loss: 3.892 Vali Acc: 0.530 Test Loss: 3.892 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.9265542030334473
Epoch: 24, Steps: 20 | Train Loss: 0.088 Vali Loss: 4.102 Vali Acc: 0.530 Test Loss: 4.102 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.8588037490844727
Epoch: 25, Steps: 20 | Train Loss: 0.129 Vali Loss: 3.604 Vali Acc: 0.560 Test Loss: 3.604 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.1799373626708984
Epoch: 26, Steps: 20 | Train Loss: 0.025 Vali Loss: 3.799 Vali Acc: 0.540 Test Loss: 3.799 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.789523124694824
Epoch: 27, Steps: 20 | Train Loss: 0.013 Vali Loss: 3.740 Vali Acc: 0.480 Test Loss: 3.740 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.7866148948669434
Epoch: 28, Steps: 20 | Train Loss: 0.004 Vali Loss: 3.621 Vali Acc: 0.560 Test Loss: 3.621 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.742687463760376
Epoch: 29, Steps: 20 | Train Loss: 0.026 Vali Loss: 4.522 Vali Acc: 0.530 Test Loss: 4.522 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.6388773918151855
Epoch: 30, Steps: 20 | Train Loss: 0.037 Vali Loss: 5.255 Vali Acc: 0.520 Test Loss: 5.255 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 10862850
model size : 41.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.93262505531311
Epoch: 1, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.701 Vali Acc: 0.520 Test Loss: 0.701 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 3.699226140975952
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.711 Vali Acc: 0.510 Test Loss: 0.711 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0230588912963867
Epoch: 3, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.706 Vali Acc: 0.620 Test Loss: 0.706 Test Acc: 0.620
Validation loss decreased (-0.519993 --> -0.619993).  Saving model ...
Epoch: 4 cost time: 2.909677505493164
Epoch: 4, Steps: 20 | Train Loss: 0.552 Vali Loss: 1.022 Vali Acc: 0.480 Test Loss: 1.022 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.4491255283355713
Epoch: 5, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.790 Vali Acc: 0.560 Test Loss: 0.790 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.603317975997925
Epoch: 6, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.846 Vali Acc: 0.560 Test Loss: 0.846 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.765336751937866
Epoch: 7, Steps: 20 | Train Loss: 0.445 Vali Loss: 1.019 Vali Acc: 0.520 Test Loss: 1.019 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.688779354095459
Epoch: 8, Steps: 20 | Train Loss: 0.374 Vali Loss: 0.797 Vali Acc: 0.600 Test Loss: 0.797 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.761855125427246
Epoch: 9, Steps: 20 | Train Loss: 0.300 Vali Loss: 1.167 Vali Acc: 0.520 Test Loss: 1.167 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.488511085510254
Epoch: 10, Steps: 20 | Train Loss: 0.240 Vali Loss: 1.117 Vali Acc: 0.580 Test Loss: 1.117 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.5440385341644287
Epoch: 11, Steps: 20 | Train Loss: 0.274 Vali Loss: 1.358 Vali Acc: 0.540 Test Loss: 1.358 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.524168014526367
Epoch: 12, Steps: 20 | Train Loss: 0.147 Vali Loss: 1.308 Vali Acc: 0.600 Test Loss: 1.308 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.70357346534729
Epoch: 13, Steps: 20 | Train Loss: 0.106 Vali Loss: 1.456 Vali Acc: 0.550 Test Loss: 1.456 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 10834562
model size : 41.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.625821828842163
Epoch: 1, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.694 Vali Acc: 0.530 Test Loss: 0.694 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 3.384720802307129
Epoch: 2, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.742 Vali Acc: 0.530 Test Loss: 0.742 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2172091007232666
Epoch: 3, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.921 Vali Acc: 0.480 Test Loss: 0.921 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.873351573944092
Epoch: 4, Steps: 20 | Train Loss: 0.599 Vali Loss: 1.124 Vali Acc: 0.500 Test Loss: 1.124 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.260505199432373
Epoch: 5, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.886 Vali Acc: 0.510 Test Loss: 0.886 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.244467258453369
Epoch: 6, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.957 Vali Acc: 0.530 Test Loss: 0.957 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.258193731307983
Epoch: 7, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.871 Vali Acc: 0.560 Test Loss: 0.871 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559991).  Saving model ...
Epoch: 8 cost time: 4.1350414752960205
Epoch: 8, Steps: 20 | Train Loss: 0.354 Vali Loss: 1.030 Vali Acc: 0.470 Test Loss: 1.030 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.4207305908203125
Epoch: 9, Steps: 20 | Train Loss: 0.302 Vali Loss: 1.009 Vali Acc: 0.550 Test Loss: 1.009 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.219525098800659
Epoch: 10, Steps: 20 | Train Loss: 0.265 Vali Loss: 1.229 Vali Acc: 0.510 Test Loss: 1.229 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.6024093627929688
Epoch: 11, Steps: 20 | Train Loss: 0.203 Vali Loss: 1.192 Vali Acc: 0.600 Test Loss: 1.192 Test Acc: 0.600
Validation loss decreased (-0.559991 --> -0.599988).  Saving model ...
Epoch: 12 cost time: 3.77394437789917
Epoch: 12, Steps: 20 | Train Loss: 0.166 Vali Loss: 1.356 Vali Acc: 0.550 Test Loss: 1.356 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.235821962356567
Epoch: 13, Steps: 20 | Train Loss: 0.085 Vali Loss: 1.438 Vali Acc: 0.560 Test Loss: 1.438 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.9309160709381104
Epoch: 14, Steps: 20 | Train Loss: 0.052 Vali Loss: 1.528 Vali Acc: 0.560 Test Loss: 1.528 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.056656837463379
Epoch: 15, Steps: 20 | Train Loss: 0.036 Vali Loss: 2.015 Vali Acc: 0.540 Test Loss: 2.015 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.051670789718628
Epoch: 16, Steps: 20 | Train Loss: 0.034 Vali Loss: 1.580 Vali Acc: 0.560 Test Loss: 1.580 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.131712436676025
Epoch: 17, Steps: 20 | Train Loss: 0.028 Vali Loss: 1.736 Vali Acc: 0.570 Test Loss: 1.736 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.0733771324157715
Epoch: 18, Steps: 20 | Train Loss: 0.009 Vali Loss: 1.648 Vali Acc: 0.580 Test Loss: 1.648 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.153342962265015
Epoch: 19, Steps: 20 | Train Loss: 0.010 Vali Loss: 2.021 Vali Acc: 0.590 Test Loss: 2.021 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.1026527881622314
Epoch: 20, Steps: 20 | Train Loss: 0.013 Vali Loss: 2.106 Vali Acc: 0.550 Test Loss: 2.106 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.238670349121094
Epoch: 21, Steps: 20 | Train Loss: 0.018 Vali Loss: 2.341 Vali Acc: 0.520 Test Loss: 2.341 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 10820482
model size : 41.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.735123157501221
Epoch: 1, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.726 Vali Acc: 0.550 Test Loss: 0.726 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 3.7861225605010986
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.908 Vali Acc: 0.490 Test Loss: 0.908 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8221802711486816
Epoch: 3, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.871 Vali Acc: 0.450 Test Loss: 0.871 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.6246721744537354
Epoch: 4, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.781 Vali Acc: 0.520 Test Loss: 0.781 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.943983316421509
Epoch: 5, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.770 Vali Acc: 0.530 Test Loss: 0.770 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.889669895172119
Epoch: 6, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.857 Vali Acc: 0.600 Test Loss: 0.857 Test Acc: 0.600
Validation loss decreased (-0.549993 --> -0.599991).  Saving model ...
Epoch: 7 cost time: 3.775083303451538
Epoch: 7, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.760 Vali Acc: 0.590 Test Loss: 0.760 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.070889949798584
Epoch: 8, Steps: 20 | Train Loss: 0.432 Vali Loss: 1.022 Vali Acc: 0.520 Test Loss: 1.022 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.8690719604492188
Epoch: 9, Steps: 20 | Train Loss: 0.337 Vali Loss: 1.022 Vali Acc: 0.470 Test Loss: 1.022 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.9686312675476074
Epoch: 10, Steps: 20 | Train Loss: 0.293 Vali Loss: 1.139 Vali Acc: 0.530 Test Loss: 1.139 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.7566044330596924
Epoch: 11, Steps: 20 | Train Loss: 0.214 Vali Loss: 1.099 Vali Acc: 0.520 Test Loss: 1.099 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.6757898330688477
Epoch: 12, Steps: 20 | Train Loss: 0.162 Vali Loss: 1.135 Vali Acc: 0.550 Test Loss: 1.135 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.658160924911499
Epoch: 13, Steps: 20 | Train Loss: 0.141 Vali Loss: 1.325 Vali Acc: 0.560 Test Loss: 1.325 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.7519915103912354
Epoch: 14, Steps: 20 | Train Loss: 0.083 Vali Loss: 1.477 Vali Acc: 0.530 Test Loss: 1.477 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.354884386062622
Epoch: 15, Steps: 20 | Train Loss: 0.046 Vali Loss: 1.614 Vali Acc: 0.510 Test Loss: 1.614 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.3746962547302246
Epoch: 16, Steps: 20 | Train Loss: 0.021 Vali Loss: 1.512 Vali Acc: 0.550 Test Loss: 1.512 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 10806530
model size : 41.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.632541179656982
Epoch: 1, Steps: 20 | Train Loss: 0.751 Vali Loss: 0.772 Vali Acc: 0.500 Test Loss: 0.772 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 3.2058825492858887
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.747 Vali Acc: 0.560 Test Loss: 0.747 Test Acc: 0.560
Validation loss decreased (-0.499992 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 3.327307939529419
Epoch: 3, Steps: 20 | Train Loss: 0.660 Vali Loss: 1.052 Vali Acc: 0.500 Test Loss: 1.052 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.534770965576172
Epoch: 4, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.735 Vali Acc: 0.590 Test Loss: 0.735 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 5 cost time: 3.4820497035980225
Epoch: 5, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.968 Vali Acc: 0.520 Test Loss: 0.968 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.6657845973968506
Epoch: 6, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.865 Vali Acc: 0.600 Test Loss: 0.865 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599991).  Saving model ...
Epoch: 7 cost time: 3.2093605995178223
Epoch: 7, Steps: 20 | Train Loss: 0.481 Vali Loss: 1.197 Vali Acc: 0.590 Test Loss: 1.197 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.374630928039551
Epoch: 8, Steps: 20 | Train Loss: 0.507 Vali Loss: 1.175 Vali Acc: 0.560 Test Loss: 1.175 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2191224098205566
Epoch: 9, Steps: 20 | Train Loss: 0.444 Vali Loss: 1.191 Vali Acc: 0.520 Test Loss: 1.191 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.527979850769043
Epoch: 10, Steps: 20 | Train Loss: 0.449 Vali Loss: 1.605 Vali Acc: 0.570 Test Loss: 1.605 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.639084815979004
Epoch: 11, Steps: 20 | Train Loss: 0.593 Vali Loss: 1.524 Vali Acc: 0.530 Test Loss: 1.524 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.557908535003662
Epoch: 12, Steps: 20 | Train Loss: 0.426 Vali Loss: 1.341 Vali Acc: 0.560 Test Loss: 1.341 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.7060751914978027
Epoch: 13, Steps: 20 | Train Loss: 0.245 Vali Loss: 1.304 Vali Acc: 0.550 Test Loss: 1.304 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.578643798828125
Epoch: 14, Steps: 20 | Train Loss: 0.220 Vali Loss: 1.572 Vali Acc: 0.590 Test Loss: 1.572 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.58361554145813
Epoch: 15, Steps: 20 | Train Loss: 0.292 Vali Loss: 2.029 Vali Acc: 0.570 Test Loss: 2.029 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.252742290496826
Epoch: 16, Steps: 20 | Train Loss: 0.208 Vali Loss: 1.599 Vali Acc: 0.580 Test Loss: 1.599 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 3242946
model size : 12.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.467334508895874
Epoch: 1, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.702 Vali Acc: 0.490 Test Loss: 0.702 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 3.1654348373413086
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.695 Vali Acc: 0.610 Test Loss: 0.695 Test Acc: 0.610
Validation loss decreased (-0.489993 --> -0.609993).  Saving model ...
Epoch: 3 cost time: 3.2091190814971924
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.785 Vali Acc: 0.570 Test Loss: 0.785 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.128185749053955
Epoch: 4, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.848 Vali Acc: 0.520 Test Loss: 0.848 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0982108116149902
Epoch: 5, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.757 Vali Acc: 0.560 Test Loss: 0.757 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.139390230178833
Epoch: 6, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.918 Vali Acc: 0.560 Test Loss: 0.918 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.2357969284057617
Epoch: 7, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.958 Vali Acc: 0.560 Test Loss: 0.958 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.2466323375701904
Epoch: 8, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.823 Vali Acc: 0.580 Test Loss: 0.823 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.8678436279296875
Epoch: 9, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.852 Vali Acc: 0.540 Test Loss: 0.852 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.7949841022491455
Epoch: 10, Steps: 20 | Train Loss: 0.309 Vali Loss: 0.981 Vali Acc: 0.560 Test Loss: 0.981 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.901698589324951
Epoch: 11, Steps: 20 | Train Loss: 0.284 Vali Loss: 1.284 Vali Acc: 0.480 Test Loss: 1.284 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.1190741062164307
Epoch: 12, Steps: 20 | Train Loss: 0.302 Vali Loss: 1.086 Vali Acc: 0.600 Test Loss: 1.086 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 3156994
model size : 12.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.734461545944214
Epoch: 1, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.689 Vali Acc: 0.570 Test Loss: 0.689 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 3.1664254665374756
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.763 Vali Acc: 0.530 Test Loss: 0.763 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.094086170196533
Epoch: 3, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.802 Vali Acc: 0.480 Test Loss: 0.802 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.986959934234619
Epoch: 4, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.778 Vali Acc: 0.540 Test Loss: 0.778 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.943310499191284
Epoch: 5, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.843 Vali Acc: 0.590 Test Loss: 0.843 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589992).  Saving model ...
Epoch: 6 cost time: 2.5260732173919678
Epoch: 6, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.796 Vali Acc: 0.590 Test Loss: 0.796 Test Acc: 0.590
Validation loss decreased (-0.589992 --> -0.589992).  Saving model ...
Epoch: 7 cost time: 2.441991090774536
Epoch: 7, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.962 Vali Acc: 0.510 Test Loss: 0.962 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9745616912841797
Epoch: 8, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.960 Vali Acc: 0.570 Test Loss: 0.960 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.171055555343628
Epoch: 9, Steps: 20 | Train Loss: 0.378 Vali Loss: 1.082 Vali Acc: 0.530 Test Loss: 1.082 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.0285723209381104
Epoch: 10, Steps: 20 | Train Loss: 0.282 Vali Loss: 1.114 Vali Acc: 0.570 Test Loss: 1.114 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.1298134326934814
Epoch: 11, Steps: 20 | Train Loss: 0.192 Vali Loss: 1.118 Vali Acc: 0.530 Test Loss: 1.118 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.0745255947113037
Epoch: 12, Steps: 20 | Train Loss: 0.164 Vali Loss: 1.378 Vali Acc: 0.540 Test Loss: 1.378 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.9160056114196777
Epoch: 13, Steps: 20 | Train Loss: 0.138 Vali Loss: 1.326 Vali Acc: 0.580 Test Loss: 1.326 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.83910870552063
Epoch: 14, Steps: 20 | Train Loss: 0.080 Vali Loss: 1.670 Vali Acc: 0.530 Test Loss: 1.670 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.8232102394104004
Epoch: 15, Steps: 20 | Train Loss: 0.080 Vali Loss: 1.298 Vali Acc: 0.570 Test Loss: 1.298 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.2259819507598877
Epoch: 16, Steps: 20 | Train Loss: 0.080 Vali Loss: 1.844 Vali Acc: 0.510 Test Loss: 1.844 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3157058
model size : 12.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.9690451622009277
Epoch: 1, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.710 Vali Acc: 0.540 Test Loss: 0.710 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 3.002664566040039
Epoch: 2, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.820 Vali Acc: 0.460 Test Loss: 0.820 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4759106636047363
Epoch: 3, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.840 Vali Acc: 0.480 Test Loss: 0.840 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1809115409851074
Epoch: 4, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.904 Vali Acc: 0.490 Test Loss: 0.904 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1660754680633545
Epoch: 5, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.758 Vali Acc: 0.530 Test Loss: 0.758 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3076367378234863
Epoch: 6, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.835 Vali Acc: 0.550 Test Loss: 0.835 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 7 cost time: 2.8394017219543457
Epoch: 7, Steps: 20 | Train Loss: 0.436 Vali Loss: 0.780 Vali Acc: 0.580 Test Loss: 0.780 Test Acc: 0.580
Validation loss decreased (-0.549992 --> -0.579992).  Saving model ...
Epoch: 8 cost time: 2.736100435256958
Epoch: 8, Steps: 20 | Train Loss: 0.408 Vali Loss: 0.987 Vali Acc: 0.570 Test Loss: 0.987 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8039889335632324
Epoch: 9, Steps: 20 | Train Loss: 0.387 Vali Loss: 0.871 Vali Acc: 0.550 Test Loss: 0.871 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6865103244781494
Epoch: 10, Steps: 20 | Train Loss: 0.300 Vali Loss: 0.895 Vali Acc: 0.560 Test Loss: 0.895 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.6601109504699707
Epoch: 11, Steps: 20 | Train Loss: 0.297 Vali Loss: 1.098 Vali Acc: 0.550 Test Loss: 1.098 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.4632203578948975
Epoch: 12, Steps: 20 | Train Loss: 0.255 Vali Loss: 1.066 Vali Acc: 0.550 Test Loss: 1.066 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.921538829803467
Epoch: 13, Steps: 20 | Train Loss: 0.200 Vali Loss: 1.098 Vali Acc: 0.570 Test Loss: 1.098 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.8577721118927
Epoch: 14, Steps: 20 | Train Loss: 0.143 Vali Loss: 1.195 Vali Acc: 0.590 Test Loss: 1.195 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589988).  Saving model ...
Epoch: 15 cost time: 3.0122013092041016
Epoch: 15, Steps: 20 | Train Loss: 0.114 Vali Loss: 1.380 Vali Acc: 0.550 Test Loss: 1.380 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.07528018951416
Epoch: 16, Steps: 20 | Train Loss: 0.105 Vali Loss: 1.554 Vali Acc: 0.570 Test Loss: 1.554 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.0225510597229004
Epoch: 17, Steps: 20 | Train Loss: 0.076 Vali Loss: 1.732 Vali Acc: 0.530 Test Loss: 1.732 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.750795602798462
Epoch: 18, Steps: 20 | Train Loss: 0.053 Vali Loss: 1.789 Vali Acc: 0.580 Test Loss: 1.789 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.789720058441162
Epoch: 19, Steps: 20 | Train Loss: 0.035 Vali Loss: 1.957 Vali Acc: 0.570 Test Loss: 1.957 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.656402587890625
Epoch: 20, Steps: 20 | Train Loss: 0.024 Vali Loss: 1.915 Vali Acc: 0.560 Test Loss: 1.915 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.590085029602051
Epoch: 21, Steps: 20 | Train Loss: 0.015 Vali Loss: 1.878 Vali Acc: 0.590 Test Loss: 1.878 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.8825759887695312
Epoch: 22, Steps: 20 | Train Loss: 0.015 Vali Loss: 1.769 Vali Acc: 0.540 Test Loss: 1.769 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.9444520473480225
Epoch: 23, Steps: 20 | Train Loss: 0.006 Vali Loss: 1.823 Vali Acc: 0.600 Test Loss: 1.823 Test Acc: 0.600
Validation loss decreased (-0.589988 --> -0.599982).  Saving model ...
Epoch: 24 cost time: 2.9624593257904053
Epoch: 24, Steps: 20 | Train Loss: 0.012 Vali Loss: 2.337 Vali Acc: 0.570 Test Loss: 2.337 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.7194862365722656
Epoch: 25, Steps: 20 | Train Loss: 0.012 Vali Loss: 2.514 Vali Acc: 0.560 Test Loss: 2.514 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.893803119659424
Epoch: 26, Steps: 20 | Train Loss: 0.006 Vali Loss: 2.149 Vali Acc: 0.570 Test Loss: 2.149 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.8750252723693848
Epoch: 27, Steps: 20 | Train Loss: 0.011 Vali Loss: 2.336 Vali Acc: 0.570 Test Loss: 2.336 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.976882219314575
Epoch: 28, Steps: 20 | Train Loss: 0.026 Vali Loss: 2.418 Vali Acc: 0.570 Test Loss: 2.418 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.9511117935180664
Epoch: 29, Steps: 20 | Train Loss: 0.052 Vali Loss: 2.724 Vali Acc: 0.540 Test Loss: 2.724 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.367992877960205
Epoch: 30, Steps: 20 | Train Loss: 0.022 Vali Loss: 3.126 Vali Acc: 0.560 Test Loss: 3.126 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.7304346561431885
Epoch: 31, Steps: 20 | Train Loss: 0.005 Vali Loss: 2.779 Vali Acc: 0.500 Test Loss: 2.779 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.9197773933410645
Epoch: 32, Steps: 20 | Train Loss: 0.002 Vali Loss: 2.862 Vali Acc: 0.550 Test Loss: 2.862 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.9025518894195557
Epoch: 33, Steps: 20 | Train Loss: 0.001 Vali Loss: 2.752 Vali Acc: 0.570 Test Loss: 2.752 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 3121282
model size : 12.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.155059576034546
Epoch: 1, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.698 Vali Acc: 0.540 Test Loss: 0.698 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.7623722553253174
Epoch: 2, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.732 Vali Acc: 0.490 Test Loss: 0.732 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7359652519226074
Epoch: 3, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.785 Vali Acc: 0.530 Test Loss: 0.785 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.654000997543335
Epoch: 4, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.725 Vali Acc: 0.500 Test Loss: 0.725 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8274736404418945
Epoch: 5, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.959 Vali Acc: 0.470 Test Loss: 0.959 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.670370101928711
Epoch: 6, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.736 Vali Acc: 0.520 Test Loss: 0.736 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.624976634979248
Epoch: 7, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.851 Vali Acc: 0.620 Test Loss: 0.851 Test Acc: 0.620
Validation loss decreased (-0.539993 --> -0.619991).  Saving model ...
Epoch: 8 cost time: 2.4260478019714355
Epoch: 8, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.814 Vali Acc: 0.540 Test Loss: 0.814 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.035038471221924
Epoch: 9, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.854 Vali Acc: 0.530 Test Loss: 0.854 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.958299398422241
Epoch: 10, Steps: 20 | Train Loss: 0.351 Vali Loss: 0.969 Vali Acc: 0.520 Test Loss: 0.969 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.1656007766723633
Epoch: 11, Steps: 20 | Train Loss: 0.308 Vali Loss: 0.860 Vali Acc: 0.590 Test Loss: 0.860 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.0328614711761475
Epoch: 12, Steps: 20 | Train Loss: 0.245 Vali Loss: 0.943 Vali Acc: 0.550 Test Loss: 0.943 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.9625885486602783
Epoch: 13, Steps: 20 | Train Loss: 0.218 Vali Loss: 0.947 Vali Acc: 0.580 Test Loss: 0.947 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.9910850524902344
Epoch: 14, Steps: 20 | Train Loss: 0.152 Vali Loss: 1.052 Vali Acc: 0.610 Test Loss: 1.052 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.9719185829162598
Epoch: 15, Steps: 20 | Train Loss: 0.154 Vali Loss: 1.450 Vali Acc: 0.520 Test Loss: 1.450 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.730307102203369
Epoch: 16, Steps: 20 | Train Loss: 0.101 Vali Loss: 1.210 Vali Acc: 0.570 Test Loss: 1.210 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.5557668209075928
Epoch: 17, Steps: 20 | Train Loss: 0.078 Vali Loss: 1.404 Vali Acc: 0.500 Test Loss: 1.404 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 3107138
model size : 11.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.0453925132751465
Epoch: 1, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 3.1577091217041016
Epoch: 2, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.811 Vali Acc: 0.530 Test Loss: 0.811 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 3.1174325942993164
Epoch: 3, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.828 Vali Acc: 0.450 Test Loss: 0.828 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.913374662399292
Epoch: 4, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.757 Vali Acc: 0.500 Test Loss: 0.757 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.094048023223877
Epoch: 5, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.770 Vali Acc: 0.530 Test Loss: 0.770 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 3.1415364742279053
Epoch: 6, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.864 Vali Acc: 0.490 Test Loss: 0.864 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0601916313171387
Epoch: 7, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.921 Vali Acc: 0.510 Test Loss: 0.921 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.731248140335083
Epoch: 8, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.973 Vali Acc: 0.500 Test Loss: 0.973 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.7231085300445557
Epoch: 9, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.925 Vali Acc: 0.510 Test Loss: 0.925 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.629197120666504
Epoch: 10, Steps: 20 | Train Loss: 0.409 Vali Loss: 1.080 Vali Acc: 0.500 Test Loss: 1.080 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.978999137878418
Epoch: 11, Steps: 20 | Train Loss: 0.391 Vali Loss: 0.899 Vali Acc: 0.560 Test Loss: 0.899 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559991).  Saving model ...
Epoch: 12 cost time: 3.1190555095672607
Epoch: 12, Steps: 20 | Train Loss: 0.319 Vali Loss: 0.921 Vali Acc: 0.570 Test Loss: 0.921 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569991).  Saving model ...
Epoch: 13 cost time: 2.348790168762207
Epoch: 13, Steps: 20 | Train Loss: 0.239 Vali Loss: 0.921 Vali Acc: 0.520 Test Loss: 0.921 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.334902763366699
Epoch: 14, Steps: 20 | Train Loss: 0.192 Vali Loss: 0.956 Vali Acc: 0.540 Test Loss: 0.956 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.415356159210205
Epoch: 15, Steps: 20 | Train Loss: 0.154 Vali Loss: 1.121 Vali Acc: 0.520 Test Loss: 1.121 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4690845012664795
Epoch: 16, Steps: 20 | Train Loss: 0.097 Vali Loss: 1.262 Vali Acc: 0.570 Test Loss: 1.262 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.109539747238159
Epoch: 17, Steps: 20 | Train Loss: 0.081 Vali Loss: 1.233 Vali Acc: 0.570 Test Loss: 1.233 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.0543997287750244
Epoch: 18, Steps: 20 | Train Loss: 0.045 Vali Loss: 1.254 Vali Acc: 0.580 Test Loss: 1.254 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579987).  Saving model ...
Epoch: 19 cost time: 2.6500070095062256
Epoch: 19, Steps: 20 | Train Loss: 0.027 Vali Loss: 1.538 Vali Acc: 0.560 Test Loss: 1.538 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.799786329269409
Epoch: 20, Steps: 20 | Train Loss: 0.028 Vali Loss: 1.371 Vali Acc: 0.580 Test Loss: 1.371 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.6722891330718994
Epoch: 21, Steps: 20 | Train Loss: 0.015 Vali Loss: 1.435 Vali Acc: 0.560 Test Loss: 1.435 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.9472861289978027
Epoch: 22, Steps: 20 | Train Loss: 0.017 Vali Loss: 1.703 Vali Acc: 0.520 Test Loss: 1.703 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.806610584259033
Epoch: 23, Steps: 20 | Train Loss: 0.020 Vali Loss: 1.814 Vali Acc: 0.550 Test Loss: 1.814 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.870196580886841
Epoch: 24, Steps: 20 | Train Loss: 0.007 Vali Loss: 1.767 Vali Acc: 0.540 Test Loss: 1.767 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.6587913036346436
Epoch: 25, Steps: 20 | Train Loss: 0.003 Vali Loss: 1.796 Vali Acc: 0.540 Test Loss: 1.796 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.58941388130188
Epoch: 26, Steps: 20 | Train Loss: 0.002 Vali Loss: 1.838 Vali Acc: 0.530 Test Loss: 1.838 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.1688268184661865
Epoch: 27, Steps: 20 | Train Loss: 0.002 Vali Loss: 1.863 Vali Acc: 0.530 Test Loss: 1.863 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.1527822017669678
Epoch: 28, Steps: 20 | Train Loss: 0.001 Vali Loss: 1.916 Vali Acc: 0.520 Test Loss: 1.916 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 3100098
model size : 11.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.793509006500244
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.710 Vali Acc: 0.430 Test Loss: 0.710 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 3.018068552017212
Epoch: 2, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.742 Vali Acc: 0.490 Test Loss: 0.742 Test Acc: 0.490
Validation loss decreased (-0.429993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 2.8983592987060547
Epoch: 3, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.742 Vali Acc: 0.500 Test Loss: 0.742 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 2.766275644302368
Epoch: 4, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.862 Vali Acc: 0.540 Test Loss: 0.862 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539991).  Saving model ...
Epoch: 5 cost time: 2.0913779735565186
Epoch: 5, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.791 Vali Acc: 0.530 Test Loss: 0.791 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.850346326828003
Epoch: 6, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.786 Vali Acc: 0.510 Test Loss: 0.786 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.910586357116699
Epoch: 7, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.761 Vali Acc: 0.550 Test Loss: 0.761 Test Acc: 0.550
Validation loss decreased (-0.539991 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 2.450915813446045
Epoch: 8, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.796 Vali Acc: 0.480 Test Loss: 0.796 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4701802730560303
Epoch: 9, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.816 Vali Acc: 0.510 Test Loss: 0.816 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4950919151306152
Epoch: 10, Steps: 20 | Train Loss: 0.408 Vali Loss: 0.874 Vali Acc: 0.530 Test Loss: 0.874 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2800111770629883
Epoch: 11, Steps: 20 | Train Loss: 0.372 Vali Loss: 0.949 Vali Acc: 0.540 Test Loss: 0.949 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.574756145477295
Epoch: 12, Steps: 20 | Train Loss: 0.323 Vali Loss: 0.879 Vali Acc: 0.530 Test Loss: 0.879 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.5735843181610107
Epoch: 13, Steps: 20 | Train Loss: 0.321 Vali Loss: 0.897 Vali Acc: 0.530 Test Loss: 0.897 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.7938125133514404
Epoch: 14, Steps: 20 | Train Loss: 0.219 Vali Loss: 0.877 Vali Acc: 0.570 Test Loss: 0.877 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569991).  Saving model ...
Epoch: 15 cost time: 2.742302179336548
Epoch: 15, Steps: 20 | Train Loss: 0.178 Vali Loss: 1.073 Vali Acc: 0.520 Test Loss: 1.073 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.831352710723877
Epoch: 16, Steps: 20 | Train Loss: 0.151 Vali Loss: 1.125 Vali Acc: 0.540 Test Loss: 1.125 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7126810550689697
Epoch: 17, Steps: 20 | Train Loss: 0.100 Vali Loss: 1.058 Vali Acc: 0.560 Test Loss: 1.058 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.9411115646362305
Epoch: 18, Steps: 20 | Train Loss: 0.069 Vali Loss: 1.339 Vali Acc: 0.540 Test Loss: 1.339 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.6856420040130615
Epoch: 19, Steps: 20 | Train Loss: 0.089 Vali Loss: 1.552 Vali Acc: 0.530 Test Loss: 1.552 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.9447314739227295
Epoch: 20, Steps: 20 | Train Loss: 0.050 Vali Loss: 1.294 Vali Acc: 0.540 Test Loss: 1.294 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.9776430130004883
Epoch: 21, Steps: 20 | Train Loss: 0.029 Vali Loss: 1.477 Vali Acc: 0.560 Test Loss: 1.477 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.2347114086151123
Epoch: 22, Steps: 20 | Train Loss: 0.026 Vali Loss: 1.388 Vali Acc: 0.570 Test Loss: 1.388 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.432058095932007
Epoch: 23, Steps: 20 | Train Loss: 0.014 Vali Loss: 1.523 Vali Acc: 0.570 Test Loss: 1.523 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.6052780151367188
Epoch: 24, Steps: 20 | Train Loss: 0.008 Vali Loss: 1.623 Vali Acc: 0.500 Test Loss: 1.623 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3093122
model size : 11.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.486034631729126
Epoch: 1, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.789 Vali Acc: 0.490 Test Loss: 0.789 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.435511827468872
Epoch: 2, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.721 Vali Acc: 0.480 Test Loss: 0.721 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.445289134979248
Epoch: 3, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.701 Vali Acc: 0.620 Test Loss: 0.701 Test Acc: 0.620
Validation loss decreased (-0.489992 --> -0.619993).  Saving model ...
Epoch: 4 cost time: 2.4283087253570557
Epoch: 4, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.761 Vali Acc: 0.530 Test Loss: 0.761 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.322131633758545
Epoch: 5, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.829 Vali Acc: 0.500 Test Loss: 0.829 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.380679130554199
Epoch: 6, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.747 Vali Acc: 0.610 Test Loss: 0.747 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1997556686401367
Epoch: 7, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.806 Vali Acc: 0.540 Test Loss: 0.806 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.071012496948242
Epoch: 8, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.829 Vali Acc: 0.540 Test Loss: 0.829 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9420702457427979
Epoch: 9, Steps: 20 | Train Loss: 0.469 Vali Loss: 1.146 Vali Acc: 0.490 Test Loss: 1.146 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.3297929763793945
Epoch: 10, Steps: 20 | Train Loss: 0.472 Vali Loss: 1.296 Vali Acc: 0.520 Test Loss: 1.296 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.444274425506592
Epoch: 11, Steps: 20 | Train Loss: 0.484 Vali Loss: 0.922 Vali Acc: 0.590 Test Loss: 0.922 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8636531829833984
Epoch: 12, Steps: 20 | Train Loss: 0.431 Vali Loss: 1.093 Vali Acc: 0.570 Test Loss: 1.093 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.2815029621124268
Epoch: 13, Steps: 20 | Train Loss: 0.373 Vali Loss: 1.028 Vali Acc: 0.550 Test Loss: 1.028 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1043938
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.1388673782348633
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.806 Vali Acc: 0.450 Test Loss: 0.806 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 1.7853477001190186
Epoch: 2, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.760 Vali Acc: 0.440 Test Loss: 0.760 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8597328662872314
Epoch: 3, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
Validation loss decreased (-0.449992 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 1.8757236003875732
Epoch: 4, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.766 Vali Acc: 0.500 Test Loss: 0.766 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0293595790863037
Epoch: 5, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.795 Vali Acc: 0.510 Test Loss: 0.795 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2783424854278564
Epoch: 6, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.748 Vali Acc: 0.610 Test Loss: 0.748 Test Acc: 0.610
Validation loss decreased (-0.519993 --> -0.609993).  Saving model ...
Epoch: 7 cost time: 2.26395320892334
Epoch: 7, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.806 Vali Acc: 0.500 Test Loss: 0.806 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.171907901763916
Epoch: 8, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.807 Vali Acc: 0.500 Test Loss: 0.807 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0426528453826904
Epoch: 9, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.832 Vali Acc: 0.510 Test Loss: 0.832 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1489217281341553
Epoch: 10, Steps: 20 | Train Loss: 0.447 Vali Loss: 0.972 Vali Acc: 0.510 Test Loss: 0.972 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9689030647277832
Epoch: 11, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.846 Vali Acc: 0.600 Test Loss: 0.846 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9980056285858154
Epoch: 12, Steps: 20 | Train Loss: 0.365 Vali Loss: 0.902 Vali Acc: 0.530 Test Loss: 0.902 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.2509782314300537
Epoch: 13, Steps: 20 | Train Loss: 0.296 Vali Loss: 1.110 Vali Acc: 0.530 Test Loss: 1.110 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.2639973163604736
Epoch: 14, Steps: 20 | Train Loss: 0.262 Vali Loss: 1.233 Vali Acc: 0.550 Test Loss: 1.233 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.071986436843872
Epoch: 15, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.017 Vali Acc: 0.580 Test Loss: 1.017 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9648711681365967
Epoch: 16, Steps: 20 | Train Loss: 0.216 Vali Loss: 1.222 Vali Acc: 0.530 Test Loss: 1.222 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1000962
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.236161231994629
Epoch: 1, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.693 Vali Acc: 0.560 Test Loss: 0.693 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 1.9408063888549805
Epoch: 2, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.702 Vali Acc: 0.550 Test Loss: 0.702 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0930140018463135
Epoch: 3, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.860 Vali Acc: 0.500 Test Loss: 0.860 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1275744438171387
Epoch: 4, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.812 Vali Acc: 0.570 Test Loss: 0.812 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569992).  Saving model ...
Epoch: 5 cost time: 2.11063814163208
Epoch: 5, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.797 Vali Acc: 0.490 Test Loss: 0.797 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.128439426422119
Epoch: 6, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.992 Vali Acc: 0.510 Test Loss: 0.992 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.210941791534424
Epoch: 7, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.778 Vali Acc: 0.600 Test Loss: 0.778 Test Acc: 0.600
Validation loss decreased (-0.569992 --> -0.599992).  Saving model ...
Epoch: 8 cost time: 1.8784198760986328
Epoch: 8, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.785 Vali Acc: 0.570 Test Loss: 0.785 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9845659732818604
Epoch: 9, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.839 Vali Acc: 0.520 Test Loss: 0.839 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.947178840637207
Epoch: 10, Steps: 20 | Train Loss: 0.389 Vali Loss: 0.899 Vali Acc: 0.520 Test Loss: 0.899 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7748541831970215
Epoch: 11, Steps: 20 | Train Loss: 0.333 Vali Loss: 0.801 Vali Acc: 0.560 Test Loss: 0.801 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8477632999420166
Epoch: 12, Steps: 20 | Train Loss: 0.309 Vali Loss: 0.907 Vali Acc: 0.540 Test Loss: 0.907 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.1684746742248535
Epoch: 13, Steps: 20 | Train Loss: 0.280 Vali Loss: 1.166 Vali Acc: 0.530 Test Loss: 1.166 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.193209648132324
Epoch: 14, Steps: 20 | Train Loss: 0.248 Vali Loss: 1.067 Vali Acc: 0.550 Test Loss: 1.067 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.119405746459961
Epoch: 15, Steps: 20 | Train Loss: 0.196 Vali Loss: 1.144 Vali Acc: 0.590 Test Loss: 1.144 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.155912399291992
Epoch: 16, Steps: 20 | Train Loss: 0.232 Vali Loss: 1.132 Vali Acc: 0.570 Test Loss: 1.132 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.262739658355713
Epoch: 17, Steps: 20 | Train Loss: 0.148 Vali Loss: 1.398 Vali Acc: 0.540 Test Loss: 1.398 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1000994
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.812633991241455
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.721 Vali Acc: 0.520 Test Loss: 0.721 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.429875373840332
Epoch: 2, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.691 Vali Acc: 0.530 Test Loss: 0.691 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.3923091888427734
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.759 Vali Acc: 0.520 Test Loss: 0.759 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7180840969085693
Epoch: 4, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.708 Vali Acc: 0.550 Test Loss: 0.708 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 2.0110442638397217
Epoch: 5, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.755 Vali Acc: 0.510 Test Loss: 0.755 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7866876125335693
Epoch: 6, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.916 Vali Acc: 0.550 Test Loss: 0.916 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9165751934051514
Epoch: 7, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.775 Vali Acc: 0.480 Test Loss: 0.775 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.602264165878296
Epoch: 8, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.710 Vali Acc: 0.580 Test Loss: 0.710 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579993).  Saving model ...
Epoch: 9 cost time: 1.6243236064910889
Epoch: 9, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.819 Vali Acc: 0.570 Test Loss: 0.819 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8156228065490723
Epoch: 10, Steps: 20 | Train Loss: 0.431 Vali Loss: 1.050 Vali Acc: 0.520 Test Loss: 1.050 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8558120727539062
Epoch: 11, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.866 Vali Acc: 0.580 Test Loss: 0.866 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.080876111984253
Epoch: 12, Steps: 20 | Train Loss: 0.390 Vali Loss: 0.923 Vali Acc: 0.540 Test Loss: 0.923 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.116265058517456
Epoch: 13, Steps: 20 | Train Loss: 0.321 Vali Loss: 0.886 Vali Acc: 0.580 Test Loss: 0.886 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.2165987491607666
Epoch: 14, Steps: 20 | Train Loss: 0.273 Vali Loss: 0.985 Vali Acc: 0.520 Test Loss: 0.985 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.080841064453125
Epoch: 15, Steps: 20 | Train Loss: 0.258 Vali Loss: 0.999 Vali Acc: 0.510 Test Loss: 0.999 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3488919734954834
Epoch: 16, Steps: 20 | Train Loss: 0.199 Vali Loss: 0.949 Vali Acc: 0.590 Test Loss: 0.949 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589991).  Saving model ...
Epoch: 17 cost time: 1.9810192584991455
Epoch: 17, Steps: 20 | Train Loss: 0.172 Vali Loss: 1.188 Vali Acc: 0.580 Test Loss: 1.188 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.026966094970703
Epoch: 18, Steps: 20 | Train Loss: 0.120 Vali Loss: 1.178 Vali Acc: 0.540 Test Loss: 1.178 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.139852523803711
Epoch: 19, Steps: 20 | Train Loss: 0.116 Vali Loss: 1.288 Vali Acc: 0.530 Test Loss: 1.288 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.994095802307129
Epoch: 20, Steps: 20 | Train Loss: 0.113 Vali Loss: 1.360 Vali Acc: 0.560 Test Loss: 1.360 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8604166507720947
Epoch: 21, Steps: 20 | Train Loss: 0.062 Vali Loss: 1.400 Vali Acc: 0.590 Test Loss: 1.400 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8337204456329346
Epoch: 22, Steps: 20 | Train Loss: 0.040 Vali Loss: 1.556 Vali Acc: 0.540 Test Loss: 1.556 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.987030029296875
Epoch: 23, Steps: 20 | Train Loss: 0.029 Vali Loss: 1.540 Vali Acc: 0.540 Test Loss: 1.540 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.2368392944335938
Epoch: 24, Steps: 20 | Train Loss: 0.030 Vali Loss: 1.784 Vali Acc: 0.550 Test Loss: 1.784 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.9256870746612549
Epoch: 25, Steps: 20 | Train Loss: 0.032 Vali Loss: 1.724 Vali Acc: 0.570 Test Loss: 1.724 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.978811264038086
Epoch: 26, Steps: 20 | Train Loss: 0.016 Vali Loss: 2.053 Vali Acc: 0.550 Test Loss: 2.053 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 983106
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4205102920532227
Epoch: 1, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.706 Vali Acc: 0.410 Test Loss: 0.706 Test Acc: 0.410
Validation loss decreased (inf --> -0.409993).  Saving model ...
Epoch: 2 cost time: 2.253077268600464
Epoch: 2, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.757 Vali Acc: 0.480 Test Loss: 0.757 Test Acc: 0.480
Validation loss decreased (-0.409993 --> -0.479992).  Saving model ...
Epoch: 3 cost time: 2.221101999282837
Epoch: 3, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.745 Vali Acc: 0.510 Test Loss: 0.745 Test Acc: 0.510
Validation loss decreased (-0.479992 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 2.09073543548584
Epoch: 4, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.843 Vali Acc: 0.490 Test Loss: 0.843 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0907418727874756
Epoch: 5, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.775 Vali Acc: 0.500 Test Loss: 0.775 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1841158866882324
Epoch: 6, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.774 Vali Acc: 0.610 Test Loss: 0.774 Test Acc: 0.610
Validation loss decreased (-0.509993 --> -0.609992).  Saving model ...
Epoch: 7 cost time: 2.4551758766174316
Epoch: 7, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.236577272415161
Epoch: 8, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.791 Vali Acc: 0.500 Test Loss: 0.791 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.988675832748413
Epoch: 9, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.805 Vali Acc: 0.530 Test Loss: 0.805 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.181293249130249
Epoch: 10, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.754 Vali Acc: 0.580 Test Loss: 0.754 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9745962619781494
Epoch: 11, Steps: 20 | Train Loss: 0.437 Vali Loss: 0.759 Vali Acc: 0.550 Test Loss: 0.759 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.4169278144836426
Epoch: 12, Steps: 20 | Train Loss: 0.372 Vali Loss: 0.800 Vali Acc: 0.550 Test Loss: 0.800 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.204655647277832
Epoch: 13, Steps: 20 | Train Loss: 0.347 Vali Loss: 0.794 Vali Acc: 0.560 Test Loss: 0.794 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.0152299404144287
Epoch: 14, Steps: 20 | Train Loss: 0.300 Vali Loss: 0.819 Vali Acc: 0.550 Test Loss: 0.819 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5956811904907227
Epoch: 15, Steps: 20 | Train Loss: 0.267 Vali Loss: 0.856 Vali Acc: 0.570 Test Loss: 0.856 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.499863624572754
Epoch: 16, Steps: 20 | Train Loss: 0.236 Vali Loss: 0.851 Vali Acc: 0.570 Test Loss: 0.851 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 976034
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6826586723327637
Epoch: 1, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.697 Vali Acc: 0.480 Test Loss: 0.697 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.5511481761932373
Epoch: 2, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.717 Vali Acc: 0.450 Test Loss: 0.717 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.280226469039917
Epoch: 3, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.780 Vali Acc: 0.480 Test Loss: 0.780 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3795344829559326
Epoch: 4, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.735 Vali Acc: 0.500 Test Loss: 0.735 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 5 cost time: 1.972085952758789
Epoch: 5, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.801 Vali Acc: 0.490 Test Loss: 0.801 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5105936527252197
Epoch: 6, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.801 Vali Acc: 0.510 Test Loss: 0.801 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509992).  Saving model ...
Epoch: 7 cost time: 2.4309685230255127
Epoch: 7, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.814 Vali Acc: 0.520 Test Loss: 0.814 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 8 cost time: 2.263577938079834
Epoch: 8, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.725 Vali Acc: 0.570 Test Loss: 0.725 Test Acc: 0.570
Validation loss decreased (-0.519992 --> -0.569993).  Saving model ...
Epoch: 9 cost time: 2.088479518890381
Epoch: 9, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.783 Vali Acc: 0.520 Test Loss: 0.783 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0260696411132812
Epoch: 10, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.853 Vali Acc: 0.550 Test Loss: 0.853 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9711103439331055
Epoch: 11, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.825 Vali Acc: 0.520 Test Loss: 0.825 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.119321584701538
Epoch: 12, Steps: 20 | Train Loss: 0.420 Vali Loss: 0.783 Vali Acc: 0.560 Test Loss: 0.783 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.4868242740631104
Epoch: 13, Steps: 20 | Train Loss: 0.389 Vali Loss: 0.826 Vali Acc: 0.490 Test Loss: 0.826 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.140148878097534
Epoch: 14, Steps: 20 | Train Loss: 0.349 Vali Loss: 0.892 Vali Acc: 0.530 Test Loss: 0.892 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.3702008724212646
Epoch: 15, Steps: 20 | Train Loss: 0.300 Vali Loss: 1.087 Vali Acc: 0.510 Test Loss: 1.087 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3429317474365234
Epoch: 16, Steps: 20 | Train Loss: 0.295 Vali Loss: 0.930 Vali Acc: 0.560 Test Loss: 0.930 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.0229556560516357
Epoch: 17, Steps: 20 | Train Loss: 0.229 Vali Loss: 1.001 Vali Acc: 0.530 Test Loss: 1.001 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.109095335006714
Epoch: 18, Steps: 20 | Train Loss: 0.204 Vali Loss: 0.979 Vali Acc: 0.550 Test Loss: 0.979 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 972514
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.569180727005005
Epoch: 1, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.702 Vali Acc: 0.490 Test Loss: 0.702 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.0583465099334717
Epoch: 2, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.710 Vali Acc: 0.480 Test Loss: 0.710 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.114856004714966
Epoch: 3, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.726 Vali Acc: 0.550 Test Loss: 0.726 Test Acc: 0.550
Validation loss decreased (-0.489993 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 2.1668388843536377
Epoch: 4, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.714 Vali Acc: 0.520 Test Loss: 0.714 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7551417350769043
Epoch: 5, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.769 Vali Acc: 0.510 Test Loss: 0.769 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.199065923690796
Epoch: 6, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.793 Vali Acc: 0.460 Test Loss: 0.793 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0876121520996094
Epoch: 7, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.698 Vali Acc: 0.590 Test Loss: 0.698 Test Acc: 0.590
Validation loss decreased (-0.549993 --> -0.589993).  Saving model ...
Epoch: 8 cost time: 1.9972803592681885
Epoch: 8, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.717 Vali Acc: 0.580 Test Loss: 0.717 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4019012451171875
Epoch: 9, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.766 Vali Acc: 0.580 Test Loss: 0.766 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4948654174804688
Epoch: 10, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.786 Vali Acc: 0.550 Test Loss: 0.786 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0339620113372803
Epoch: 11, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.747 Vali Acc: 0.580 Test Loss: 0.747 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.116856098175049
Epoch: 12, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.806 Vali Acc: 0.540 Test Loss: 0.806 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.1385040283203125
Epoch: 13, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.872 Vali Acc: 0.530 Test Loss: 0.872 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.2858834266662598
Epoch: 14, Steps: 20 | Train Loss: 0.390 Vali Loss: 0.805 Vali Acc: 0.570 Test Loss: 0.805 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.132106304168701
Epoch: 15, Steps: 20 | Train Loss: 0.353 Vali Loss: 0.831 Vali Acc: 0.580 Test Loss: 0.831 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.2381551265716553
Epoch: 16, Steps: 20 | Train Loss: 0.300 Vali Loss: 0.851 Vali Acc: 0.580 Test Loss: 0.851 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9836006164550781
Epoch: 17, Steps: 20 | Train Loss: 0.279 Vali Loss: 0.909 Vali Acc: 0.600 Test Loss: 0.909 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599991).  Saving model ...
Epoch: 18 cost time: 1.6071276664733887
Epoch: 18, Steps: 20 | Train Loss: 0.262 Vali Loss: 0.907 Vali Acc: 0.590 Test Loss: 0.907 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1295087337493896
Epoch: 19, Steps: 20 | Train Loss: 0.212 Vali Loss: 0.966 Vali Acc: 0.530 Test Loss: 0.966 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.1196858882904053
Epoch: 20, Steps: 20 | Train Loss: 0.160 Vali Loss: 0.975 Vali Acc: 0.590 Test Loss: 0.975 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.1940906047821045
Epoch: 21, Steps: 20 | Train Loss: 0.122 Vali Loss: 1.041 Vali Acc: 0.570 Test Loss: 1.041 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.3208367824554443
Epoch: 22, Steps: 20 | Train Loss: 0.092 Vali Loss: 1.007 Vali Acc: 0.590 Test Loss: 1.007 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.2651243209838867
Epoch: 23, Steps: 20 | Train Loss: 0.058 Vali Loss: 1.140 Vali Acc: 0.600 Test Loss: 1.140 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.2959372997283936
Epoch: 24, Steps: 20 | Train Loss: 0.050 Vali Loss: 1.164 Vali Acc: 0.560 Test Loss: 1.164 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.217268466949463
Epoch: 25, Steps: 20 | Train Loss: 0.033 Vali Loss: 1.179 Vali Acc: 0.580 Test Loss: 1.179 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.9988152980804443
Epoch: 26, Steps: 20 | Train Loss: 0.017 Vali Loss: 1.257 Vali Acc: 0.590 Test Loss: 1.257 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.9681849479675293
Epoch: 27, Steps: 20 | Train Loss: 0.016 Vali Loss: 1.282 Vali Acc: 0.570 Test Loss: 1.282 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 969026
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.644738435745239
Epoch: 1, Steps: 20 | Train Loss: 0.760 Vali Loss: 1.372 Vali Acc: 0.440 Test Loss: 1.372 Test Acc: 0.440
Validation loss decreased (inf --> -0.439986).  Saving model ...
Epoch: 2 cost time: 5.762392282485962
Epoch: 2, Steps: 20 | Train Loss: 0.895 Vali Loss: 0.852 Vali Acc: 0.590 Test Loss: 0.852 Test Acc: 0.590
Validation loss decreased (-0.439986 --> -0.589991).  Saving model ...
Epoch: 3 cost time: 5.101994752883911
Epoch: 3, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.916 Vali Acc: 0.440 Test Loss: 0.916 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.155896902084351
Epoch: 4, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.833 Vali Acc: 0.540 Test Loss: 0.833 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.881926536560059
Epoch: 5, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.976 Vali Acc: 0.580 Test Loss: 0.976 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.279810428619385
Epoch: 6, Steps: 20 | Train Loss: 0.748 Vali Loss: 1.085 Vali Acc: 0.550 Test Loss: 1.085 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.204784870147705
Epoch: 7, Steps: 20 | Train Loss: 0.453 Vali Loss: 1.042 Vali Acc: 0.500 Test Loss: 1.042 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.645171165466309
Epoch: 8, Steps: 20 | Train Loss: 0.474 Vali Loss: 1.186 Vali Acc: 0.540 Test Loss: 1.186 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.29175877571106
Epoch: 9, Steps: 20 | Train Loss: 0.375 Vali Loss: 1.200 Vali Acc: 0.590 Test Loss: 1.200 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.581659317016602
Epoch: 10, Steps: 20 | Train Loss: 0.475 Vali Loss: 1.441 Vali Acc: 0.550 Test Loss: 1.441 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.823236465454102
Epoch: 11, Steps: 20 | Train Loss: 0.379 Vali Loss: 1.949 Vali Acc: 0.500 Test Loss: 1.949 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.189757823944092
Epoch: 12, Steps: 20 | Train Loss: 0.302 Vali Loss: 1.899 Vali Acc: 0.560 Test Loss: 1.899 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 11063170
model size : 42.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.033805847167969
Epoch: 1, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.723 Vali Acc: 0.510 Test Loss: 0.723 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 4.952157974243164
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.826 Vali Acc: 0.530 Test Loss: 0.826 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 4.888258934020996
Epoch: 3, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.851 Vali Acc: 0.480 Test Loss: 0.851 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.978179216384888
Epoch: 4, Steps: 20 | Train Loss: 0.554 Vali Loss: 1.027 Vali Acc: 0.500 Test Loss: 1.027 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.592806339263916
Epoch: 5, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.850 Vali Acc: 0.570 Test Loss: 0.850 Test Acc: 0.570
Validation loss decreased (-0.529992 --> -0.569992).  Saving model ...
Epoch: 6 cost time: 4.774662494659424
Epoch: 6, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.837 Vali Acc: 0.560 Test Loss: 0.837 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.022273540496826
Epoch: 7, Steps: 20 | Train Loss: 0.483 Vali Loss: 1.132 Vali Acc: 0.590 Test Loss: 1.132 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589989).  Saving model ...
Epoch: 8 cost time: 4.505908250808716
Epoch: 8, Steps: 20 | Train Loss: 0.496 Vali Loss: 1.253 Vali Acc: 0.560 Test Loss: 1.253 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.50006103515625
Epoch: 9, Steps: 20 | Train Loss: 0.378 Vali Loss: 1.275 Vali Acc: 0.540 Test Loss: 1.275 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.359274625778198
Epoch: 10, Steps: 20 | Train Loss: 0.337 Vali Loss: 1.300 Vali Acc: 0.560 Test Loss: 1.300 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.407394170761108
Epoch: 11, Steps: 20 | Train Loss: 0.338 Vali Loss: 1.263 Vali Acc: 0.520 Test Loss: 1.263 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.809427976608276
Epoch: 12, Steps: 20 | Train Loss: 0.310 Vali Loss: 1.883 Vali Acc: 0.570 Test Loss: 1.883 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.663058280944824
Epoch: 13, Steps: 20 | Train Loss: 0.229 Vali Loss: 2.337 Vali Acc: 0.530 Test Loss: 2.337 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.9035491943359375
Epoch: 14, Steps: 20 | Train Loss: 0.292 Vali Loss: 2.354 Vali Acc: 0.490 Test Loss: 2.354 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.117108583450317
Epoch: 15, Steps: 20 | Train Loss: 0.105 Vali Loss: 2.173 Vali Acc: 0.580 Test Loss: 2.173 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.570306777954102
Epoch: 16, Steps: 20 | Train Loss: 0.104 Vali Loss: 2.197 Vali Acc: 0.560 Test Loss: 2.197 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.835608005523682
Epoch: 17, Steps: 20 | Train Loss: 0.047 Vali Loss: 3.024 Vali Acc: 0.520 Test Loss: 3.024 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 10891266
model size : 41.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.811969041824341
Epoch: 1, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.793 Vali Acc: 0.500 Test Loss: 0.793 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 4.409837007522583
Epoch: 2, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.782 Vali Acc: 0.590 Test Loss: 0.782 Test Acc: 0.590
Validation loss decreased (-0.499992 --> -0.589992).  Saving model ...
Epoch: 3 cost time: 4.236146926879883
Epoch: 3, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.966 Vali Acc: 0.530 Test Loss: 0.966 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.549574851989746
Epoch: 4, Steps: 20 | Train Loss: 0.648 Vali Loss: 1.185 Vali Acc: 0.530 Test Loss: 1.185 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.5322301387786865
Epoch: 5, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.888 Vali Acc: 0.560 Test Loss: 0.888 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.706855535507202
Epoch: 6, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.860 Vali Acc: 0.570 Test Loss: 0.860 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.829678058624268
Epoch: 7, Steps: 20 | Train Loss: 0.366 Vali Loss: 0.979 Vali Acc: 0.620 Test Loss: 0.979 Test Acc: 0.620
Validation loss decreased (-0.589992 --> -0.619990).  Saving model ...
Epoch: 8 cost time: 4.937189817428589
Epoch: 8, Steps: 20 | Train Loss: 0.280 Vali Loss: 1.168 Vali Acc: 0.560 Test Loss: 1.168 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.668524980545044
Epoch: 9, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.494 Vali Acc: 0.580 Test Loss: 1.494 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.711098909378052
Epoch: 10, Steps: 20 | Train Loss: 0.242 Vali Loss: 1.283 Vali Acc: 0.550 Test Loss: 1.283 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.894842624664307
Epoch: 11, Steps: 20 | Train Loss: 0.240 Vali Loss: 1.975 Vali Acc: 0.480 Test Loss: 1.975 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.524734020233154
Epoch: 12, Steps: 20 | Train Loss: 0.187 Vali Loss: 1.563 Vali Acc: 0.550 Test Loss: 1.563 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.465672492980957
Epoch: 13, Steps: 20 | Train Loss: 0.099 Vali Loss: 2.121 Vali Acc: 0.550 Test Loss: 2.121 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.783023834228516
Epoch: 14, Steps: 20 | Train Loss: 0.101 Vali Loss: 1.877 Vali Acc: 0.540 Test Loss: 1.877 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.929832696914673
Epoch: 15, Steps: 20 | Train Loss: 0.198 Vali Loss: 3.700 Vali Acc: 0.540 Test Loss: 3.700 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.995981931686401
Epoch: 16, Steps: 20 | Train Loss: 0.156 Vali Loss: 2.574 Vali Acc: 0.590 Test Loss: 2.574 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.172501802444458
Epoch: 17, Steps: 20 | Train Loss: 0.118 Vali Loss: 2.708 Vali Acc: 0.540 Test Loss: 2.708 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 10891394
model size : 41.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.952005624771118
Epoch: 1, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.722 Vali Acc: 0.550 Test Loss: 0.722 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 4.0541932582855225
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.909 Vali Acc: 0.450 Test Loss: 0.909 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.192335605621338
Epoch: 3, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.769 Vali Acc: 0.570 Test Loss: 0.769 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 4 cost time: 3.966299057006836
Epoch: 4, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.842 Vali Acc: 0.530 Test Loss: 0.842 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.249640464782715
Epoch: 5, Steps: 20 | Train Loss: 0.525 Vali Loss: 1.067 Vali Acc: 0.490 Test Loss: 1.067 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.283088207244873
Epoch: 6, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.967 Vali Acc: 0.570 Test Loss: 0.967 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.436135292053223
Epoch: 7, Steps: 20 | Train Loss: 0.397 Vali Loss: 1.004 Vali Acc: 0.580 Test Loss: 1.004 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579990).  Saving model ...
Epoch: 8 cost time: 4.121984958648682
Epoch: 8, Steps: 20 | Train Loss: 0.370 Vali Loss: 0.958 Vali Acc: 0.590 Test Loss: 0.958 Test Acc: 0.590
Validation loss decreased (-0.579990 --> -0.589990).  Saving model ...
Epoch: 9 cost time: 4.0462095737457275
Epoch: 9, Steps: 20 | Train Loss: 0.291 Vali Loss: 1.163 Vali Acc: 0.550 Test Loss: 1.163 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.25367546081543
Epoch: 10, Steps: 20 | Train Loss: 0.194 Vali Loss: 1.271 Vali Acc: 0.530 Test Loss: 1.271 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.5133750438690186
Epoch: 11, Steps: 20 | Train Loss: 0.208 Vali Loss: 1.244 Vali Acc: 0.580 Test Loss: 1.244 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.0074241161346436
Epoch: 12, Steps: 20 | Train Loss: 0.175 Vali Loss: 1.427 Vali Acc: 0.520 Test Loss: 1.427 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.429970979690552
Epoch: 13, Steps: 20 | Train Loss: 0.142 Vali Loss: 1.652 Vali Acc: 0.590 Test Loss: 1.652 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.303847551345825
Epoch: 14, Steps: 20 | Train Loss: 0.129 Vali Loss: 2.280 Vali Acc: 0.520 Test Loss: 2.280 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.329331398010254
Epoch: 15, Steps: 20 | Train Loss: 0.079 Vali Loss: 2.267 Vali Acc: 0.560 Test Loss: 2.267 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.998722553253174
Epoch: 16, Steps: 20 | Train Loss: 0.257 Vali Loss: 2.402 Vali Acc: 0.590 Test Loss: 2.402 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.982987403869629
Epoch: 17, Steps: 20 | Train Loss: 0.104 Vali Loss: 3.098 Vali Acc: 0.570 Test Loss: 3.098 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.290040016174316
Epoch: 18, Steps: 20 | Train Loss: 0.076 Vali Loss: 2.736 Vali Acc: 0.530 Test Loss: 2.736 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 10819842
model size : 41.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.240461349487305
Epoch: 1, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.706 Vali Acc: 0.540 Test Loss: 0.706 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 4.435287237167358
Epoch: 2, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.917 Vali Acc: 0.470 Test Loss: 0.917 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.010849952697754
Epoch: 3, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.785 Vali Acc: 0.480 Test Loss: 0.785 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.7804691791534424
Epoch: 4, Steps: 20 | Train Loss: 0.653 Vali Loss: 1.012 Vali Acc: 0.490 Test Loss: 1.012 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.122243642807007
Epoch: 5, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.814 Vali Acc: 0.490 Test Loss: 0.814 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.006195306777954
Epoch: 6, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.857 Vali Acc: 0.530 Test Loss: 0.857 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.343127489089966
Epoch: 7, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.898 Vali Acc: 0.520 Test Loss: 0.898 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.384665012359619
Epoch: 8, Steps: 20 | Train Loss: 0.442 Vali Loss: 1.119 Vali Acc: 0.520 Test Loss: 1.119 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.2559144496917725
Epoch: 9, Steps: 20 | Train Loss: 0.337 Vali Loss: 0.898 Vali Acc: 0.550 Test Loss: 0.898 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549991).  Saving model ...
Epoch: 10 cost time: 4.488885879516602
Epoch: 10, Steps: 20 | Train Loss: 0.282 Vali Loss: 1.135 Vali Acc: 0.550 Test Loss: 1.135 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.268401861190796
Epoch: 11, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.289 Vali Acc: 0.480 Test Loss: 1.289 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.384864568710327
Epoch: 12, Steps: 20 | Train Loss: 0.162 Vali Loss: 1.304 Vali Acc: 0.560 Test Loss: 1.304 Test Acc: 0.560
Validation loss decreased (-0.549991 --> -0.559987).  Saving model ...
Epoch: 13 cost time: 3.2641210556030273
Epoch: 13, Steps: 20 | Train Loss: 0.125 Vali Loss: 1.640 Vali Acc: 0.510 Test Loss: 1.640 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.687772274017334
Epoch: 14, Steps: 20 | Train Loss: 0.051 Vali Loss: 1.794 Vali Acc: 0.560 Test Loss: 1.794 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.9921863079071045
Epoch: 15, Steps: 20 | Train Loss: 0.046 Vali Loss: 1.778 Vali Acc: 0.590 Test Loss: 1.778 Test Acc: 0.590
Validation loss decreased (-0.559987 --> -0.589982).  Saving model ...
Epoch: 16 cost time: 4.2413201332092285
Epoch: 16, Steps: 20 | Train Loss: 0.081 Vali Loss: 2.506 Vali Acc: 0.530 Test Loss: 2.506 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.075386047363281
Epoch: 17, Steps: 20 | Train Loss: 0.061 Vali Loss: 2.611 Vali Acc: 0.520 Test Loss: 2.611 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.332257032394409
Epoch: 18, Steps: 20 | Train Loss: 0.045 Vali Loss: 1.930 Vali Acc: 0.600 Test Loss: 1.930 Test Acc: 0.600
Validation loss decreased (-0.589982 --> -0.599981).  Saving model ...
Epoch: 19 cost time: 3.9706757068634033
Epoch: 19, Steps: 20 | Train Loss: 0.050 Vali Loss: 2.614 Vali Acc: 0.500 Test Loss: 2.614 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.158849239349365
Epoch: 20, Steps: 20 | Train Loss: 0.034 Vali Loss: 2.174 Vali Acc: 0.600 Test Loss: 2.174 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.9018452167510986
Epoch: 21, Steps: 20 | Train Loss: 0.036 Vali Loss: 2.503 Vali Acc: 0.530 Test Loss: 2.503 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.6793642044067383
Epoch: 22, Steps: 20 | Train Loss: 0.007 Vali Loss: 2.404 Vali Acc: 0.520 Test Loss: 2.404 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.9036378860473633
Epoch: 23, Steps: 20 | Train Loss: 0.008 Vali Loss: 2.687 Vali Acc: 0.530 Test Loss: 2.687 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.042740106582642
Epoch: 24, Steps: 20 | Train Loss: 0.012 Vali Loss: 2.855 Vali Acc: 0.580 Test Loss: 2.855 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.102203130722046
Epoch: 25, Steps: 20 | Train Loss: 0.004 Vali Loss: 3.197 Vali Acc: 0.560 Test Loss: 3.197 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.181780576705933
Epoch: 26, Steps: 20 | Train Loss: 0.013 Vali Loss: 3.742 Vali Acc: 0.540 Test Loss: 3.742 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.7757914066314697
Epoch: 27, Steps: 20 | Train Loss: 0.070 Vali Loss: 4.446 Vali Acc: 0.530 Test Loss: 4.446 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.9194719791412354
Epoch: 28, Steps: 20 | Train Loss: 0.056 Vali Loss: 3.344 Vali Acc: 0.540 Test Loss: 3.344 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 10791554
model size : 41.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.897970199584961
Epoch: 1, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.720 Vali Acc: 0.520 Test Loss: 0.720 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 4.193243741989136
Epoch: 2, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.811 Vali Acc: 0.500 Test Loss: 0.811 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.968219518661499
Epoch: 3, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.788 Vali Acc: 0.540 Test Loss: 0.788 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 4.160857915878296
Epoch: 4, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.777 Vali Acc: 0.470 Test Loss: 0.777 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.0034565925598145
Epoch: 5, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.799 Vali Acc: 0.540 Test Loss: 0.799 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.9690418243408203
Epoch: 6, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.836 Vali Acc: 0.580 Test Loss: 0.836 Test Acc: 0.580
Validation loss decreased (-0.539992 --> -0.579992).  Saving model ...
Epoch: 7 cost time: 4.195163249969482
Epoch: 7, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.904 Vali Acc: 0.560 Test Loss: 0.904 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.640758991241455
Epoch: 8, Steps: 20 | Train Loss: 0.347 Vali Loss: 1.098 Vali Acc: 0.550 Test Loss: 1.098 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2705442905426025
Epoch: 9, Steps: 20 | Train Loss: 0.313 Vali Loss: 1.128 Vali Acc: 0.520 Test Loss: 1.128 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.757103681564331
Epoch: 10, Steps: 20 | Train Loss: 0.216 Vali Loss: 1.033 Vali Acc: 0.550 Test Loss: 1.033 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.8477752208709717
Epoch: 11, Steps: 20 | Train Loss: 0.199 Vali Loss: 1.397 Vali Acc: 0.520 Test Loss: 1.397 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.0970711708068848
Epoch: 12, Steps: 20 | Train Loss: 0.226 Vali Loss: 1.146 Vali Acc: 0.570 Test Loss: 1.146 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.074889898300171
Epoch: 13, Steps: 20 | Train Loss: 0.136 Vali Loss: 1.627 Vali Acc: 0.570 Test Loss: 1.627 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.0431342124938965
Epoch: 14, Steps: 20 | Train Loss: 0.127 Vali Loss: 1.558 Vali Acc: 0.530 Test Loss: 1.558 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.340662479400635
Epoch: 15, Steps: 20 | Train Loss: 0.118 Vali Loss: 1.753 Vali Acc: 0.600 Test Loss: 1.753 Test Acc: 0.600
Validation loss decreased (-0.579992 --> -0.599982).  Saving model ...
Epoch: 16 cost time: 3.653111457824707
Epoch: 16, Steps: 20 | Train Loss: 0.056 Vali Loss: 1.724 Vali Acc: 0.590 Test Loss: 1.724 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.6920740604400635
Epoch: 17, Steps: 20 | Train Loss: 0.032 Vali Loss: 2.164 Vali Acc: 0.560 Test Loss: 2.164 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.063213586807251
Epoch: 18, Steps: 20 | Train Loss: 0.049 Vali Loss: 1.892 Vali Acc: 0.590 Test Loss: 1.892 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.0419347286224365
Epoch: 19, Steps: 20 | Train Loss: 0.047 Vali Loss: 2.268 Vali Acc: 0.580 Test Loss: 2.268 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.119084119796753
Epoch: 20, Steps: 20 | Train Loss: 0.069 Vali Loss: 2.497 Vali Acc: 0.540 Test Loss: 2.497 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.8531079292297363
Epoch: 21, Steps: 20 | Train Loss: 0.037 Vali Loss: 2.798 Vali Acc: 0.500 Test Loss: 2.798 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.851942300796509
Epoch: 22, Steps: 20 | Train Loss: 0.024 Vali Loss: 2.526 Vali Acc: 0.520 Test Loss: 2.526 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.1243836879730225
Epoch: 23, Steps: 20 | Train Loss: 0.052 Vali Loss: 3.058 Vali Acc: 0.520 Test Loss: 3.058 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.8652544021606445
Epoch: 24, Steps: 20 | Train Loss: 0.053 Vali Loss: 3.201 Vali Acc: 0.510 Test Loss: 3.201 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.5888702869415283
Epoch: 25, Steps: 20 | Train Loss: 0.026 Vali Loss: 3.221 Vali Acc: 0.570 Test Loss: 3.221 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 10777474
model size : 41.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.3536481857299805
Epoch: 1, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.720 Vali Acc: 0.500 Test Loss: 0.720 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 3.41156005859375
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.692 Vali Acc: 0.550 Test Loss: 0.692 Test Acc: 0.550
Validation loss decreased (-0.499993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 3.506115674972534
Epoch: 3, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.746 Vali Acc: 0.520 Test Loss: 0.746 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.73602032661438
Epoch: 4, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.775 Vali Acc: 0.570 Test Loss: 0.775 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 5 cost time: 3.798527479171753
Epoch: 5, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.839 Vali Acc: 0.490 Test Loss: 0.839 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5750937461853027
Epoch: 6, Steps: 20 | Train Loss: 0.526 Vali Loss: 1.028 Vali Acc: 0.510 Test Loss: 1.028 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.6454367637634277
Epoch: 7, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.857 Vali Acc: 0.550 Test Loss: 0.857 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.6229088306427
Epoch: 8, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.848 Vali Acc: 0.530 Test Loss: 0.848 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.3176090717315674
Epoch: 9, Steps: 20 | Train Loss: 0.359 Vali Loss: 0.911 Vali Acc: 0.570 Test Loss: 0.911 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.8854966163635254
Epoch: 10, Steps: 20 | Train Loss: 0.292 Vali Loss: 1.151 Vali Acc: 0.560 Test Loss: 1.151 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.6814424991607666
Epoch: 11, Steps: 20 | Train Loss: 0.207 Vali Loss: 1.264 Vali Acc: 0.540 Test Loss: 1.264 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.423499822616577
Epoch: 12, Steps: 20 | Train Loss: 0.182 Vali Loss: 1.036 Vali Acc: 0.570 Test Loss: 1.036 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.652695417404175
Epoch: 13, Steps: 20 | Train Loss: 0.113 Vali Loss: 1.232 Vali Acc: 0.550 Test Loss: 1.232 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.7664144039154053
Epoch: 14, Steps: 20 | Train Loss: 0.098 Vali Loss: 1.441 Vali Acc: 0.550 Test Loss: 1.441 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 10763522
model size : 41.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.3992760181427
Epoch: 1, Steps: 20 | Train Loss: 0.751 Vali Loss: 0.952 Vali Acc: 0.460 Test Loss: 0.952 Test Acc: 0.460
Validation loss decreased (inf --> -0.459990).  Saving model ...
Epoch: 2 cost time: 3.232581853866577
Epoch: 2, Steps: 20 | Train Loss: 0.761 Vali Loss: 1.096 Vali Acc: 0.480 Test Loss: 1.096 Test Acc: 0.480
Validation loss decreased (-0.459990 --> -0.479989).  Saving model ...
Epoch: 3 cost time: 3.1375248432159424
Epoch: 3, Steps: 20 | Train Loss: 0.800 Vali Loss: 0.965 Vali Acc: 0.560 Test Loss: 0.965 Test Acc: 0.560
Validation loss decreased (-0.479989 --> -0.559990).  Saving model ...
Epoch: 4 cost time: 3.0698769092559814
Epoch: 4, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.769 Vali Acc: 0.570 Test Loss: 0.769 Test Acc: 0.570
Validation loss decreased (-0.559990 --> -0.569992).  Saving model ...
Epoch: 5 cost time: 3.147839307785034
Epoch: 5, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.793 Vali Acc: 0.610 Test Loss: 0.793 Test Acc: 0.610
Validation loss decreased (-0.569992 --> -0.609992).  Saving model ...
Epoch: 6 cost time: 3.101128101348877
Epoch: 6, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.863 Vali Acc: 0.570 Test Loss: 0.863 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7509312629699707
Epoch: 7, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.764 Vali Acc: 0.650 Test Loss: 0.764 Test Acc: 0.650
Validation loss decreased (-0.609992 --> -0.649992).  Saving model ...
Epoch: 8 cost time: 3.087164878845215
Epoch: 8, Steps: 20 | Train Loss: 0.495 Vali Loss: 1.072 Vali Acc: 0.570 Test Loss: 1.072 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.066439628601074
Epoch: 9, Steps: 20 | Train Loss: 0.679 Vali Loss: 1.157 Vali Acc: 0.520 Test Loss: 1.157 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.956342935562134
Epoch: 10, Steps: 20 | Train Loss: 0.425 Vali Loss: 1.139 Vali Acc: 0.560 Test Loss: 1.139 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3937387466430664
Epoch: 11, Steps: 20 | Train Loss: 0.325 Vali Loss: 1.376 Vali Acc: 0.500 Test Loss: 1.376 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.4765233993530273
Epoch: 12, Steps: 20 | Train Loss: 0.257 Vali Loss: 1.212 Vali Acc: 0.500 Test Loss: 1.212 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4108500480651855
Epoch: 13, Steps: 20 | Train Loss: 0.265 Vali Loss: 1.782 Vali Acc: 0.470 Test Loss: 1.782 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.2878928184509277
Epoch: 14, Steps: 20 | Train Loss: 0.306 Vali Loss: 1.673 Vali Acc: 0.480 Test Loss: 1.673 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.423340320587158
Epoch: 15, Steps: 20 | Train Loss: 0.229 Vali Loss: 2.470 Vali Acc: 0.600 Test Loss: 2.470 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.978808879852295
Epoch: 16, Steps: 20 | Train Loss: 0.377 Vali Loss: 1.903 Vali Acc: 0.650 Test Loss: 1.903 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.034313678741455
Epoch: 17, Steps: 20 | Train Loss: 0.334 Vali Loss: 2.521 Vali Acc: 0.520 Test Loss: 2.521 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 3221442
model size : 12.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8246405124664307
Epoch: 1, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.748 Vali Acc: 0.480 Test Loss: 0.748 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.7192113399505615
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.752 Vali Acc: 0.580 Test Loss: 0.752 Test Acc: 0.580
Validation loss decreased (-0.479993 --> -0.579992).  Saving model ...
Epoch: 3 cost time: 2.7184884548187256
Epoch: 3, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.864 Vali Acc: 0.530 Test Loss: 0.864 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.479466438293457
Epoch: 4, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.785 Vali Acc: 0.560 Test Loss: 0.785 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5105063915252686
Epoch: 5, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.839 Vali Acc: 0.590 Test Loss: 0.839 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589992).  Saving model ...
Epoch: 6 cost time: 2.655449151992798
Epoch: 6, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.817 Vali Acc: 0.640 Test Loss: 0.817 Test Acc: 0.640
Validation loss decreased (-0.589992 --> -0.639992).  Saving model ...
Epoch: 7 cost time: 2.735839366912842
Epoch: 7, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.769 Vali Acc: 0.590 Test Loss: 0.769 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.667874574661255
Epoch: 8, Steps: 20 | Train Loss: 0.408 Vali Loss: 1.090 Vali Acc: 0.520 Test Loss: 1.090 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.323148012161255
Epoch: 9, Steps: 20 | Train Loss: 0.384 Vali Loss: 0.988 Vali Acc: 0.600 Test Loss: 0.988 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6919941902160645
Epoch: 10, Steps: 20 | Train Loss: 0.323 Vali Loss: 1.211 Vali Acc: 0.520 Test Loss: 1.211 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5215463638305664
Epoch: 11, Steps: 20 | Train Loss: 0.241 Vali Loss: 1.194 Vali Acc: 0.550 Test Loss: 1.194 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.74233078956604
Epoch: 12, Steps: 20 | Train Loss: 0.170 Vali Loss: 1.254 Vali Acc: 0.550 Test Loss: 1.254 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.3666934967041016
Epoch: 13, Steps: 20 | Train Loss: 0.125 Vali Loss: 1.361 Vali Acc: 0.530 Test Loss: 1.361 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.3265469074249268
Epoch: 14, Steps: 20 | Train Loss: 0.092 Vali Loss: 1.371 Vali Acc: 0.600 Test Loss: 1.371 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.4164798259735107
Epoch: 15, Steps: 20 | Train Loss: 0.067 Vali Loss: 1.663 Vali Acc: 0.560 Test Loss: 1.663 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.4042954444885254
Epoch: 16, Steps: 20 | Train Loss: 0.055 Vali Loss: 2.044 Vali Acc: 0.510 Test Loss: 2.044 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 3135490
model size : 12.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.93003249168396
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.711 Vali Acc: 0.550 Test Loss: 0.711 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.390287399291992
Epoch: 2, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.806 Vali Acc: 0.520 Test Loss: 0.806 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3409605026245117
Epoch: 3, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.971 Vali Acc: 0.520 Test Loss: 0.971 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6721420288085938
Epoch: 4, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.997 Vali Acc: 0.490 Test Loss: 0.997 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.614194869995117
Epoch: 5, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.939 Vali Acc: 0.560 Test Loss: 0.939 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559991).  Saving model ...
Epoch: 6 cost time: 2.8701109886169434
Epoch: 6, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.829 Vali Acc: 0.520 Test Loss: 0.829 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.688079833984375
Epoch: 7, Steps: 20 | Train Loss: 0.441 Vali Loss: 0.813 Vali Acc: 0.560 Test Loss: 0.813 Test Acc: 0.560
Validation loss decreased (-0.559991 --> -0.559992).  Saving model ...
Epoch: 8 cost time: 2.642038583755493
Epoch: 8, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.956 Vali Acc: 0.570 Test Loss: 0.956 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569990).  Saving model ...
Epoch: 9 cost time: 2.9457600116729736
Epoch: 9, Steps: 20 | Train Loss: 0.333 Vali Loss: 0.976 Vali Acc: 0.550 Test Loss: 0.976 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6811327934265137
Epoch: 10, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.307 Vali Acc: 0.550 Test Loss: 1.307 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.577113151550293
Epoch: 11, Steps: 20 | Train Loss: 0.369 Vali Loss: 1.122 Vali Acc: 0.580 Test Loss: 1.122 Test Acc: 0.580
Validation loss decreased (-0.569990 --> -0.579989).  Saving model ...
Epoch: 12 cost time: 2.4156436920166016
Epoch: 12, Steps: 20 | Train Loss: 0.340 Vali Loss: 1.109 Vali Acc: 0.570 Test Loss: 1.109 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5082285404205322
Epoch: 13, Steps: 20 | Train Loss: 0.197 Vali Loss: 1.491 Vali Acc: 0.540 Test Loss: 1.491 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.716510057449341
Epoch: 14, Steps: 20 | Train Loss: 0.160 Vali Loss: 1.711 Vali Acc: 0.510 Test Loss: 1.711 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6050257682800293
Epoch: 15, Steps: 20 | Train Loss: 0.139 Vali Loss: 1.747 Vali Acc: 0.510 Test Loss: 1.747 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.0783541202545166
Epoch: 16, Steps: 20 | Train Loss: 0.088 Vali Loss: 1.831 Vali Acc: 0.500 Test Loss: 1.831 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.535863161087036
Epoch: 17, Steps: 20 | Train Loss: 0.054 Vali Loss: 1.804 Vali Acc: 0.570 Test Loss: 1.804 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.7518022060394287
Epoch: 18, Steps: 20 | Train Loss: 0.048 Vali Loss: 1.968 Vali Acc: 0.530 Test Loss: 1.968 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.697244882583618
Epoch: 19, Steps: 20 | Train Loss: 0.029 Vali Loss: 2.305 Vali Acc: 0.520 Test Loss: 2.305 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.623392343521118
Epoch: 20, Steps: 20 | Train Loss: 0.025 Vali Loss: 2.067 Vali Acc: 0.570 Test Loss: 2.067 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.4180009365081787
Epoch: 21, Steps: 20 | Train Loss: 0.020 Vali Loss: 2.141 Vali Acc: 0.600 Test Loss: 2.141 Test Acc: 0.600
Validation loss decreased (-0.579989 --> -0.599979).  Saving model ...
Epoch: 22 cost time: 1.9648864269256592
Epoch: 22, Steps: 20 | Train Loss: 0.007 Vali Loss: 2.437 Vali Acc: 0.530 Test Loss: 2.437 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.110943555831909
Epoch: 23, Steps: 20 | Train Loss: 0.006 Vali Loss: 2.208 Vali Acc: 0.550 Test Loss: 2.208 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.183068037033081
Epoch: 24, Steps: 20 | Train Loss: 0.003 Vali Loss: 2.172 Vali Acc: 0.560 Test Loss: 2.172 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.5791666507720947
Epoch: 25, Steps: 20 | Train Loss: 0.003 Vali Loss: 2.099 Vali Acc: 0.560 Test Loss: 2.099 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.7736754417419434
Epoch: 26, Steps: 20 | Train Loss: 0.001 Vali Loss: 2.161 Vali Acc: 0.570 Test Loss: 2.161 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.586573362350464
Epoch: 27, Steps: 20 | Train Loss: 0.001 Vali Loss: 2.262 Vali Acc: 0.550 Test Loss: 2.262 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.5512282848358154
Epoch: 28, Steps: 20 | Train Loss: 0.001 Vali Loss: 2.266 Vali Acc: 0.550 Test Loss: 2.266 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.576110363006592
Epoch: 29, Steps: 20 | Train Loss: 0.001 Vali Loss: 2.246 Vali Acc: 0.570 Test Loss: 2.246 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.7141847610473633
Epoch: 30, Steps: 20 | Train Loss: 0.001 Vali Loss: 2.274 Vali Acc: 0.550 Test Loss: 2.274 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.4646964073181152
Epoch: 31, Steps: 20 | Train Loss: 0.001 Vali Loss: 2.301 Vali Acc: 0.550 Test Loss: 2.301 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 3135554
model size : 12.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8274874687194824
Epoch: 1, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.669 Vali Acc: 0.550 Test Loss: 0.669 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.858625888824463
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.753 Vali Acc: 0.490 Test Loss: 0.753 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8190040588378906
Epoch: 3, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.784 Vali Acc: 0.510 Test Loss: 0.784 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7840003967285156
Epoch: 4, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.757 Vali Acc: 0.510 Test Loss: 0.757 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.696012020111084
Epoch: 5, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.838 Vali Acc: 0.490 Test Loss: 0.838 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4029130935668945
Epoch: 6, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.901 Vali Acc: 0.610 Test Loss: 0.901 Test Acc: 0.610
Validation loss decreased (-0.549993 --> -0.609991).  Saving model ...
Epoch: 7 cost time: 2.5791971683502197
Epoch: 7, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.820 Vali Acc: 0.540 Test Loss: 0.820 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.195253849029541
Epoch: 8, Steps: 20 | Train Loss: 0.444 Vali Loss: 0.948 Vali Acc: 0.550 Test Loss: 0.948 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.554018020629883
Epoch: 9, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.919 Vali Acc: 0.590 Test Loss: 0.919 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2604899406433105
Epoch: 10, Steps: 20 | Train Loss: 0.373 Vali Loss: 1.138 Vali Acc: 0.470 Test Loss: 1.138 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9318046569824219
Epoch: 11, Steps: 20 | Train Loss: 0.343 Vali Loss: 1.084 Vali Acc: 0.530 Test Loss: 1.084 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2072441577911377
Epoch: 12, Steps: 20 | Train Loss: 0.297 Vali Loss: 1.097 Vali Acc: 0.560 Test Loss: 1.097 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.377225399017334
Epoch: 13, Steps: 20 | Train Loss: 0.227 Vali Loss: 1.194 Vali Acc: 0.560 Test Loss: 1.194 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.744824171066284
Epoch: 14, Steps: 20 | Train Loss: 0.155 Vali Loss: 1.214 Vali Acc: 0.580 Test Loss: 1.214 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.4406931400299072
Epoch: 15, Steps: 20 | Train Loss: 0.104 Vali Loss: 1.486 Vali Acc: 0.550 Test Loss: 1.486 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.5865628719329834
Epoch: 16, Steps: 20 | Train Loss: 0.064 Vali Loss: 1.563 Vali Acc: 0.500 Test Loss: 1.563 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 3099778
model size : 11.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.843660831451416
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.8358242511749268
Epoch: 2, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.740 Vali Acc: 0.510 Test Loss: 0.740 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 2.7648744583129883
Epoch: 3, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.778 Vali Acc: 0.630 Test Loss: 0.778 Test Acc: 0.630
Validation loss decreased (-0.509993 --> -0.629992).  Saving model ...
Epoch: 4 cost time: 2.641162872314453
Epoch: 4, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.805 Vali Acc: 0.560 Test Loss: 0.805 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3262131214141846
Epoch: 5, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.772 Vali Acc: 0.510 Test Loss: 0.772 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2864017486572266
Epoch: 6, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.849 Vali Acc: 0.520 Test Loss: 0.849 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3321533203125
Epoch: 7, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.951 Vali Acc: 0.530 Test Loss: 0.951 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.3918590545654297
Epoch: 8, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.919 Vali Acc: 0.490 Test Loss: 0.919 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.819181442260742
Epoch: 9, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.804 Vali Acc: 0.530 Test Loss: 0.804 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.560321569442749
Epoch: 10, Steps: 20 | Train Loss: 0.337 Vali Loss: 0.918 Vali Acc: 0.550 Test Loss: 0.918 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.35713529586792
Epoch: 11, Steps: 20 | Train Loss: 0.317 Vali Loss: 0.938 Vali Acc: 0.600 Test Loss: 0.938 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.30216383934021
Epoch: 12, Steps: 20 | Train Loss: 0.293 Vali Loss: 1.003 Vali Acc: 0.570 Test Loss: 1.003 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3398211002349854
Epoch: 13, Steps: 20 | Train Loss: 0.259 Vali Loss: 1.033 Vali Acc: 0.550 Test Loss: 1.033 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 3085634
model size : 11.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.951389789581299
Epoch: 1, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.713 Vali Acc: 0.470 Test Loss: 0.713 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 2.2042596340179443
Epoch: 2, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.807 Vali Acc: 0.460 Test Loss: 0.807 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.486391067504883
Epoch: 3, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.816 Vali Acc: 0.490 Test Loss: 0.816 Test Acc: 0.490
Validation loss decreased (-0.469993 --> -0.489992).  Saving model ...
Epoch: 4 cost time: 2.425212860107422
Epoch: 4, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.768 Vali Acc: 0.470 Test Loss: 0.768 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3518311977386475
Epoch: 5, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.889 Vali Acc: 0.540 Test Loss: 0.889 Test Acc: 0.540
Validation loss decreased (-0.489992 --> -0.539991).  Saving model ...
Epoch: 6 cost time: 2.8958020210266113
Epoch: 6, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.887 Vali Acc: 0.490 Test Loss: 0.887 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.458252191543579
Epoch: 7, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.914 Vali Acc: 0.530 Test Loss: 0.914 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.760653495788574
Epoch: 8, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.801 Vali Acc: 0.560 Test Loss: 0.801 Test Acc: 0.560
Validation loss decreased (-0.539991 --> -0.559992).  Saving model ...
Epoch: 9 cost time: 1.7908165454864502
Epoch: 9, Steps: 20 | Train Loss: 0.418 Vali Loss: 0.859 Vali Acc: 0.570 Test Loss: 0.859 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569991).  Saving model ...
Epoch: 10 cost time: 2.3718996047973633
Epoch: 10, Steps: 20 | Train Loss: 0.387 Vali Loss: 0.876 Vali Acc: 0.570 Test Loss: 0.876 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.687225580215454
Epoch: 11, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.867 Vali Acc: 0.570 Test Loss: 0.867 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4564945697784424
Epoch: 12, Steps: 20 | Train Loss: 0.287 Vali Loss: 0.998 Vali Acc: 0.550 Test Loss: 0.998 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.7690868377685547
Epoch: 13, Steps: 20 | Train Loss: 0.244 Vali Loss: 0.891 Vali Acc: 0.520 Test Loss: 0.891 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.3923606872558594
Epoch: 14, Steps: 20 | Train Loss: 0.202 Vali Loss: 0.999 Vali Acc: 0.480 Test Loss: 0.999 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.859467029571533
Epoch: 15, Steps: 20 | Train Loss: 0.143 Vali Loss: 0.988 Vali Acc: 0.590 Test Loss: 0.988 Test Acc: 0.590
Validation loss decreased (-0.569991 --> -0.589990).  Saving model ...
Epoch: 16 cost time: 2.5686652660369873
Epoch: 16, Steps: 20 | Train Loss: 0.092 Vali Loss: 1.138 Vali Acc: 0.560 Test Loss: 1.138 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.386836528778076
Epoch: 17, Steps: 20 | Train Loss: 0.057 Vali Loss: 1.508 Vali Acc: 0.550 Test Loss: 1.508 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.545488119125366
Epoch: 18, Steps: 20 | Train Loss: 0.052 Vali Loss: 1.360 Vali Acc: 0.520 Test Loss: 1.360 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.1441152095794678
Epoch: 19, Steps: 20 | Train Loss: 0.027 Vali Loss: 1.392 Vali Acc: 0.530 Test Loss: 1.392 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.5896527767181396
Epoch: 20, Steps: 20 | Train Loss: 0.013 Vali Loss: 1.525 Vali Acc: 0.530 Test Loss: 1.525 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.5183615684509277
Epoch: 21, Steps: 20 | Train Loss: 0.012 Vali Loss: 1.462 Vali Acc: 0.570 Test Loss: 1.462 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.7991576194763184
Epoch: 22, Steps: 20 | Train Loss: 0.008 Vali Loss: 1.537 Vali Acc: 0.550 Test Loss: 1.537 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.740227222442627
Epoch: 23, Steps: 20 | Train Loss: 0.006 Vali Loss: 1.823 Vali Acc: 0.530 Test Loss: 1.823 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.0745482444763184
Epoch: 24, Steps: 20 | Train Loss: 0.005 Vali Loss: 1.618 Vali Acc: 0.540 Test Loss: 1.618 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.572127342224121
Epoch: 25, Steps: 20 | Train Loss: 0.004 Vali Loss: 1.666 Vali Acc: 0.540 Test Loss: 1.666 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3078594
model size : 11.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3632822036743164
Epoch: 1, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.804126262664795
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.722 Vali Acc: 0.460 Test Loss: 0.722 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2116003036499023
Epoch: 3, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.767 Vali Acc: 0.490 Test Loss: 0.767 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.324495553970337
Epoch: 4, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1548736095428467
Epoch: 5, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.767 Vali Acc: 0.520 Test Loss: 0.767 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519992).  Saving model ...
Epoch: 6 cost time: 2.5328140258789062
Epoch: 6, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.776 Vali Acc: 0.520 Test Loss: 0.776 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6673974990844727
Epoch: 7, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.758 Vali Acc: 0.520 Test Loss: 0.758 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519992).  Saving model ...
Epoch: 8 cost time: 2.5954582691192627
Epoch: 8, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.743 Vali Acc: 0.580 Test Loss: 0.743 Test Acc: 0.580
Validation loss decreased (-0.519992 --> -0.579993).  Saving model ...
Epoch: 9 cost time: 2.359032154083252
Epoch: 9, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.905 Vali Acc: 0.520 Test Loss: 0.905 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4034225940704346
Epoch: 10, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.907 Vali Acc: 0.510 Test Loss: 0.907 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.459824323654175
Epoch: 11, Steps: 20 | Train Loss: 0.398 Vali Loss: 0.887 Vali Acc: 0.550 Test Loss: 0.887 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1269333362579346
Epoch: 12, Steps: 20 | Train Loss: 0.345 Vali Loss: 1.015 Vali Acc: 0.560 Test Loss: 1.015 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.351425886154175
Epoch: 13, Steps: 20 | Train Loss: 0.293 Vali Loss: 0.891 Vali Acc: 0.530 Test Loss: 0.891 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.427706480026245
Epoch: 14, Steps: 20 | Train Loss: 0.227 Vali Loss: 0.996 Vali Acc: 0.510 Test Loss: 0.996 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.394826889038086
Epoch: 15, Steps: 20 | Train Loss: 0.168 Vali Loss: 1.212 Vali Acc: 0.510 Test Loss: 1.212 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.332479953765869
Epoch: 16, Steps: 20 | Train Loss: 0.137 Vali Loss: 1.196 Vali Acc: 0.520 Test Loss: 1.196 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.6291520595550537
Epoch: 17, Steps: 20 | Train Loss: 0.114 Vali Loss: 1.344 Vali Acc: 0.480 Test Loss: 1.344 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.5822055339813232
Epoch: 18, Steps: 20 | Train Loss: 0.080 Vali Loss: 1.282 Vali Acc: 0.530 Test Loss: 1.282 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 3071618
model size : 11.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2706477642059326
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.759 Vali Acc: 0.470 Test Loss: 0.759 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 2.331369638442993
Epoch: 2, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.814 Vali Acc: 0.550 Test Loss: 0.814 Test Acc: 0.550
Validation loss decreased (-0.469992 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 2.0763039588928223
Epoch: 3, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.803 Vali Acc: 0.490 Test Loss: 0.803 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8658192157745361
Epoch: 4, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.741 Vali Acc: 0.570 Test Loss: 0.741 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569993).  Saving model ...
Epoch: 5 cost time: 1.661503791809082
Epoch: 5, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.836 Vali Acc: 0.520 Test Loss: 0.836 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.725203514099121
Epoch: 6, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.795 Vali Acc: 0.590 Test Loss: 0.795 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589992).  Saving model ...
Epoch: 7 cost time: 1.7745041847229004
Epoch: 7, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.978 Vali Acc: 0.520 Test Loss: 0.978 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5398600101470947
Epoch: 8, Steps: 20 | Train Loss: 0.520 Vali Loss: 1.117 Vali Acc: 0.550 Test Loss: 1.117 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6616132259368896
Epoch: 9, Steps: 20 | Train Loss: 0.530 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0064759254455566
Epoch: 10, Steps: 20 | Train Loss: 0.581 Vali Loss: 1.154 Vali Acc: 0.530 Test Loss: 1.154 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6899323463439941
Epoch: 11, Steps: 20 | Train Loss: 0.422 Vali Loss: 1.033 Vali Acc: 0.530 Test Loss: 1.033 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.38509464263916
Epoch: 12, Steps: 20 | Train Loss: 0.370 Vali Loss: 0.974 Vali Acc: 0.600 Test Loss: 0.974 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 2.2634079456329346
Epoch: 13, Steps: 20 | Train Loss: 0.349 Vali Loss: 1.107 Vali Acc: 0.530 Test Loss: 1.107 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.145453453063965
Epoch: 14, Steps: 20 | Train Loss: 0.330 Vali Loss: 1.308 Vali Acc: 0.590 Test Loss: 1.308 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.334927558898926
Epoch: 15, Steps: 20 | Train Loss: 0.272 Vali Loss: 1.039 Vali Acc: 0.580 Test Loss: 1.039 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.177628755569458
Epoch: 16, Steps: 20 | Train Loss: 0.214 Vali Loss: 1.350 Vali Acc: 0.540 Test Loss: 1.350 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.245417594909668
Epoch: 17, Steps: 20 | Train Loss: 0.162 Vali Loss: 1.290 Vali Acc: 0.570 Test Loss: 1.290 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.4522645473480225
Epoch: 18, Steps: 20 | Train Loss: 0.150 Vali Loss: 1.405 Vali Acc: 0.540 Test Loss: 1.405 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.009953737258911
Epoch: 19, Steps: 20 | Train Loss: 0.146 Vali Loss: 1.932 Vali Acc: 0.600 Test Loss: 1.932 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.051555633544922
Epoch: 20, Steps: 20 | Train Loss: 0.176 Vali Loss: 1.744 Vali Acc: 0.610 Test Loss: 1.744 Test Acc: 0.610
Validation loss decreased (-0.599990 --> -0.609983).  Saving model ...
Epoch: 21 cost time: 1.9690430164337158
Epoch: 21, Steps: 20 | Train Loss: 0.080 Vali Loss: 1.898 Vali Acc: 0.560 Test Loss: 1.898 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9984228610992432
Epoch: 22, Steps: 20 | Train Loss: 0.057 Vali Loss: 2.536 Vali Acc: 0.520 Test Loss: 2.536 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.077568769454956
Epoch: 23, Steps: 20 | Train Loss: 0.076 Vali Loss: 2.625 Vali Acc: 0.490 Test Loss: 2.625 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.0567641258239746
Epoch: 24, Steps: 20 | Train Loss: 0.133 Vali Loss: 2.520 Vali Acc: 0.490 Test Loss: 2.520 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7367603778839111
Epoch: 25, Steps: 20 | Train Loss: 0.094 Vali Loss: 2.328 Vali Acc: 0.540 Test Loss: 2.328 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.205873966217041
Epoch: 26, Steps: 20 | Train Loss: 0.034 Vali Loss: 2.246 Vali Acc: 0.520 Test Loss: 2.246 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7998387813568115
Epoch: 27, Steps: 20 | Train Loss: 0.045 Vali Loss: 2.261 Vali Acc: 0.540 Test Loss: 2.261 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7200396060943604
Epoch: 28, Steps: 20 | Train Loss: 0.065 Vali Loss: 2.719 Vali Acc: 0.540 Test Loss: 2.719 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.7216770648956299
Epoch: 29, Steps: 20 | Train Loss: 0.020 Vali Loss: 2.599 Vali Acc: 0.550 Test Loss: 2.599 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.6362266540527344
Epoch: 30, Steps: 20 | Train Loss: 0.012 Vali Loss: 2.761 Vali Acc: 0.540 Test Loss: 2.761 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1033186
model size : 4.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3255743980407715
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.716 Vali Acc: 0.490 Test Loss: 0.716 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.9397921562194824
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.740 Vali Acc: 0.530 Test Loss: 0.740 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.9298522472381592
Epoch: 3, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.761 Vali Acc: 0.530 Test Loss: 0.761 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8227016925811768
Epoch: 4, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.817 Vali Acc: 0.490 Test Loss: 0.817 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.910456895828247
Epoch: 5, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.702 Vali Acc: 0.580 Test Loss: 0.702 Test Acc: 0.580
Validation loss decreased (-0.529993 --> -0.579993).  Saving model ...
Epoch: 6 cost time: 1.5816607475280762
Epoch: 6, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.799 Vali Acc: 0.580 Test Loss: 0.799 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.607254981994629
Epoch: 7, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.848 Vali Acc: 0.580 Test Loss: 0.848 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8081066608428955
Epoch: 8, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.769 Vali Acc: 0.540 Test Loss: 0.769 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5431947708129883
Epoch: 9, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.814 Vali Acc: 0.540 Test Loss: 0.814 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5624446868896484
Epoch: 10, Steps: 20 | Train Loss: 0.443 Vali Loss: 1.024 Vali Acc: 0.540 Test Loss: 1.024 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9437611103057861
Epoch: 11, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.114 Vali Acc: 0.500 Test Loss: 1.114 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7533938884735107
Epoch: 12, Steps: 20 | Train Loss: 0.371 Vali Loss: 0.946 Vali Acc: 0.590 Test Loss: 0.946 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589991).  Saving model ...
Epoch: 13 cost time: 1.7336177825927734
Epoch: 13, Steps: 20 | Train Loss: 0.320 Vali Loss: 1.246 Vali Acc: 0.540 Test Loss: 1.246 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7336068153381348
Epoch: 14, Steps: 20 | Train Loss: 0.235 Vali Loss: 1.048 Vali Acc: 0.560 Test Loss: 1.048 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5977177619934082
Epoch: 15, Steps: 20 | Train Loss: 0.260 Vali Loss: 1.503 Vali Acc: 0.530 Test Loss: 1.503 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.574979543685913
Epoch: 16, Steps: 20 | Train Loss: 0.349 Vali Loss: 1.409 Vali Acc: 0.570 Test Loss: 1.409 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5918865203857422
Epoch: 17, Steps: 20 | Train Loss: 0.200 Vali Loss: 1.289 Vali Acc: 0.520 Test Loss: 1.289 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5894665718078613
Epoch: 18, Steps: 20 | Train Loss: 0.114 Vali Loss: 1.382 Vali Acc: 0.560 Test Loss: 1.382 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2930607795715332
Epoch: 19, Steps: 20 | Train Loss: 0.102 Vali Loss: 1.460 Vali Acc: 0.560 Test Loss: 1.460 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3742139339447021
Epoch: 20, Steps: 20 | Train Loss: 0.090 Vali Loss: 1.623 Vali Acc: 0.570 Test Loss: 1.623 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6781411170959473
Epoch: 21, Steps: 20 | Train Loss: 0.065 Vali Loss: 1.680 Vali Acc: 0.540 Test Loss: 1.680 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5045738220214844
Epoch: 22, Steps: 20 | Train Loss: 0.051 Vali Loss: 1.730 Vali Acc: 0.550 Test Loss: 1.730 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 990210
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0951037406921387
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.682 Vali Acc: 0.560 Test Loss: 0.682 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 1.871746301651001
Epoch: 2, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.893941879272461
Epoch: 3, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.757 Vali Acc: 0.480 Test Loss: 0.757 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5656144618988037
Epoch: 4, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.782 Vali Acc: 0.490 Test Loss: 0.782 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5174076557159424
Epoch: 5, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.765 Vali Acc: 0.480 Test Loss: 0.765 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6165499687194824
Epoch: 6, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.955 Vali Acc: 0.530 Test Loss: 0.955 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4968297481536865
Epoch: 7, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.975 Vali Acc: 0.490 Test Loss: 0.975 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6207785606384277
Epoch: 8, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.977 Vali Acc: 0.570 Test Loss: 0.977 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569990).  Saving model ...
Epoch: 9 cost time: 1.8076164722442627
Epoch: 9, Steps: 20 | Train Loss: 0.474 Vali Loss: 1.006 Vali Acc: 0.530 Test Loss: 1.006 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8228275775909424
Epoch: 10, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.914 Vali Acc: 0.570 Test Loss: 0.914 Test Acc: 0.570
Validation loss decreased (-0.569990 --> -0.569991).  Saving model ...
Epoch: 11 cost time: 1.6961638927459717
Epoch: 11, Steps: 20 | Train Loss: 0.416 Vali Loss: 1.138 Vali Acc: 0.530 Test Loss: 1.138 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.894735336303711
Epoch: 12, Steps: 20 | Train Loss: 0.429 Vali Loss: 1.052 Vali Acc: 0.570 Test Loss: 1.052 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7739107608795166
Epoch: 13, Steps: 20 | Train Loss: 0.310 Vali Loss: 1.011 Vali Acc: 0.550 Test Loss: 1.011 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8109781742095947
Epoch: 14, Steps: 20 | Train Loss: 0.217 Vali Loss: 1.039 Vali Acc: 0.560 Test Loss: 1.039 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6267468929290771
Epoch: 15, Steps: 20 | Train Loss: 0.189 Vali Loss: 1.092 Vali Acc: 0.570 Test Loss: 1.092 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6481478214263916
Epoch: 16, Steps: 20 | Train Loss: 0.146 Vali Loss: 1.095 Vali Acc: 0.590 Test Loss: 1.095 Test Acc: 0.590
Validation loss decreased (-0.569991 --> -0.589989).  Saving model ...
Epoch: 17 cost time: 1.5697307586669922
Epoch: 17, Steps: 20 | Train Loss: 0.129 Vali Loss: 1.183 Vali Acc: 0.540 Test Loss: 1.183 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7376258373260498
Epoch: 18, Steps: 20 | Train Loss: 0.080 Vali Loss: 1.269 Vali Acc: 0.560 Test Loss: 1.269 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7709150314331055
Epoch: 19, Steps: 20 | Train Loss: 0.078 Vali Loss: 1.403 Vali Acc: 0.560 Test Loss: 1.403 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8002727031707764
Epoch: 20, Steps: 20 | Train Loss: 0.059 Vali Loss: 1.476 Vali Acc: 0.600 Test Loss: 1.476 Test Acc: 0.600
Validation loss decreased (-0.589989 --> -0.599985).  Saving model ...
Epoch: 21 cost time: 1.8832647800445557
Epoch: 21, Steps: 20 | Train Loss: 0.032 Vali Loss: 1.550 Vali Acc: 0.520 Test Loss: 1.550 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9908733367919922
Epoch: 22, Steps: 20 | Train Loss: 0.026 Vali Loss: 1.651 Vali Acc: 0.550 Test Loss: 1.651 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.859621524810791
Epoch: 23, Steps: 20 | Train Loss: 0.021 Vali Loss: 1.699 Vali Acc: 0.540 Test Loss: 1.699 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.626993179321289
Epoch: 24, Steps: 20 | Train Loss: 0.012 Vali Loss: 1.728 Vali Acc: 0.530 Test Loss: 1.728 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6131260395050049
Epoch: 25, Steps: 20 | Train Loss: 0.011 Vali Loss: 1.706 Vali Acc: 0.540 Test Loss: 1.706 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.653198003768921
Epoch: 26, Steps: 20 | Train Loss: 0.008 Vali Loss: 1.790 Vali Acc: 0.520 Test Loss: 1.790 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4519550800323486
Epoch: 27, Steps: 20 | Train Loss: 0.008 Vali Loss: 1.828 Vali Acc: 0.550 Test Loss: 1.828 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.436150312423706
Epoch: 28, Steps: 20 | Train Loss: 0.005 Vali Loss: 1.750 Vali Acc: 0.550 Test Loss: 1.750 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.6648740768432617
Epoch: 29, Steps: 20 | Train Loss: 0.005 Vali Loss: 1.864 Vali Acc: 0.520 Test Loss: 1.864 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.9103829860687256
Epoch: 30, Steps: 20 | Train Loss: 0.004 Vali Loss: 1.934 Vali Acc: 0.530 Test Loss: 1.934 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 990242
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.1124699115753174
Epoch: 1, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.710 Vali Acc: 0.450 Test Loss: 0.710 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.7046403884887695
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.721 Vali Acc: 0.520 Test Loss: 0.721 Test Acc: 0.520
Validation loss decreased (-0.449993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.654470443725586
Epoch: 3, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.748 Vali Acc: 0.520 Test Loss: 0.748 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6585214138031006
Epoch: 4, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.860 Vali Acc: 0.480 Test Loss: 0.860 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5931289196014404
Epoch: 5, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.831 Vali Acc: 0.510 Test Loss: 0.831 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.539128065109253
Epoch: 6, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.793 Vali Acc: 0.520 Test Loss: 0.793 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0165696144104004
Epoch: 7, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.745 Vali Acc: 0.550 Test Loss: 0.745 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549993).  Saving model ...
Epoch: 8 cost time: 1.7482833862304688
Epoch: 8, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.826 Vali Acc: 0.520 Test Loss: 0.826 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.719660758972168
Epoch: 9, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.779 Vali Acc: 0.590 Test Loss: 0.779 Test Acc: 0.590
Validation loss decreased (-0.549993 --> -0.589992).  Saving model ...
Epoch: 10 cost time: 1.9379281997680664
Epoch: 10, Steps: 20 | Train Loss: 0.503 Vali Loss: 1.051 Vali Acc: 0.550 Test Loss: 1.051 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9027128219604492
Epoch: 11, Steps: 20 | Train Loss: 0.398 Vali Loss: 0.781 Vali Acc: 0.590 Test Loss: 0.781 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.611534595489502
Epoch: 12, Steps: 20 | Train Loss: 0.353 Vali Loss: 0.867 Vali Acc: 0.550 Test Loss: 0.867 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5087814331054688
Epoch: 13, Steps: 20 | Train Loss: 0.350 Vali Loss: 0.839 Vali Acc: 0.600 Test Loss: 0.839 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599992).  Saving model ...
Epoch: 14 cost time: 1.5666205883026123
Epoch: 14, Steps: 20 | Train Loss: 0.335 Vali Loss: 0.851 Vali Acc: 0.620 Test Loss: 0.851 Test Acc: 0.620
Validation loss decreased (-0.599992 --> -0.619991).  Saving model ...
Epoch: 15 cost time: 1.3650379180908203
Epoch: 15, Steps: 20 | Train Loss: 0.315 Vali Loss: 1.013 Vali Acc: 0.580 Test Loss: 1.013 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0848252773284912
Epoch: 16, Steps: 20 | Train Loss: 0.278 Vali Loss: 1.031 Vali Acc: 0.590 Test Loss: 1.031 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2127714157104492
Epoch: 17, Steps: 20 | Train Loss: 0.189 Vali Loss: 1.061 Vali Acc: 0.570 Test Loss: 1.061 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3388373851776123
Epoch: 18, Steps: 20 | Train Loss: 0.143 Vali Loss: 1.074 Vali Acc: 0.580 Test Loss: 1.074 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.576359510421753
Epoch: 19, Steps: 20 | Train Loss: 0.107 Vali Loss: 1.267 Vali Acc: 0.540 Test Loss: 1.267 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8852002620697021
Epoch: 20, Steps: 20 | Train Loss: 0.065 Vali Loss: 1.270 Vali Acc: 0.540 Test Loss: 1.270 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7843921184539795
Epoch: 21, Steps: 20 | Train Loss: 0.056 Vali Loss: 1.545 Vali Acc: 0.530 Test Loss: 1.545 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.8041493892669678
Epoch: 22, Steps: 20 | Train Loss: 0.065 Vali Loss: 1.452 Vali Acc: 0.550 Test Loss: 1.452 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7656354904174805
Epoch: 23, Steps: 20 | Train Loss: 0.048 Vali Loss: 1.423 Vali Acc: 0.580 Test Loss: 1.423 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.769946575164795
Epoch: 24, Steps: 20 | Train Loss: 0.029 Vali Loss: 1.585 Vali Acc: 0.550 Test Loss: 1.585 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 972354
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.119115114212036
Epoch: 1, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.696 Vali Acc: 0.470 Test Loss: 0.696 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.6764652729034424
Epoch: 2, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.785 Vali Acc: 0.480 Test Loss: 0.785 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479992).  Saving model ...
Epoch: 3 cost time: 1.6832027435302734
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.725 Vali Acc: 0.510 Test Loss: 0.725 Test Acc: 0.510
Validation loss decreased (-0.479992 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 1.7884860038757324
Epoch: 4, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.777 Vali Acc: 0.550 Test Loss: 0.777 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549992).  Saving model ...
Epoch: 5 cost time: 1.7458951473236084
Epoch: 5, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.768 Vali Acc: 0.490 Test Loss: 0.768 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5896224975585938
Epoch: 6, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.740 Vali Acc: 0.550 Test Loss: 0.740 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549993).  Saving model ...
Epoch: 7 cost time: 1.91782808303833
Epoch: 7, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.743 Vali Acc: 0.520 Test Loss: 0.743 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5698211193084717
Epoch: 8, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.733 Vali Acc: 0.550 Test Loss: 0.733 Test Acc: 0.550
Validation loss decreased (-0.549993 --> -0.549993).  Saving model ...
Epoch: 9 cost time: 1.4705493450164795
Epoch: 9, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.771 Vali Acc: 0.530 Test Loss: 0.771 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5786421298980713
Epoch: 10, Steps: 20 | Train Loss: 0.455 Vali Loss: 0.757 Vali Acc: 0.580 Test Loss: 0.757 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579992).  Saving model ...
Epoch: 11 cost time: 1.7185983657836914
Epoch: 11, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.819 Vali Acc: 0.510 Test Loss: 0.819 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6278114318847656
Epoch: 12, Steps: 20 | Train Loss: 0.398 Vali Loss: 0.844 Vali Acc: 0.540 Test Loss: 0.844 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.678239345550537
Epoch: 13, Steps: 20 | Train Loss: 0.347 Vali Loss: 0.812 Vali Acc: 0.560 Test Loss: 0.812 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7187480926513672
Epoch: 14, Steps: 20 | Train Loss: 0.306 Vali Loss: 0.847 Vali Acc: 0.570 Test Loss: 0.847 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6130895614624023
Epoch: 15, Steps: 20 | Train Loss: 0.264 Vali Loss: 0.906 Vali Acc: 0.520 Test Loss: 0.906 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6357271671295166
Epoch: 16, Steps: 20 | Train Loss: 0.223 Vali Loss: 0.949 Vali Acc: 0.580 Test Loss: 0.949 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9145112037658691
Epoch: 17, Steps: 20 | Train Loss: 0.189 Vali Loss: 0.976 Vali Acc: 0.560 Test Loss: 0.976 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7203564643859863
Epoch: 18, Steps: 20 | Train Loss: 0.157 Vali Loss: 1.006 Vali Acc: 0.540 Test Loss: 1.006 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5973625183105469
Epoch: 19, Steps: 20 | Train Loss: 0.114 Vali Loss: 1.165 Vali Acc: 0.510 Test Loss: 1.165 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4335486888885498
Epoch: 20, Steps: 20 | Train Loss: 0.129 Vali Loss: 1.097 Vali Acc: 0.580 Test Loss: 1.097 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 965282
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.1112844944000244
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.701 Vali Acc: 0.520 Test Loss: 0.701 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.600480079650879
Epoch: 2, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.727 Vali Acc: 0.510 Test Loss: 0.727 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5527915954589844
Epoch: 3, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.764 Vali Acc: 0.450 Test Loss: 0.764 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7606935501098633
Epoch: 4, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.751 Vali Acc: 0.500 Test Loss: 0.751 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6824946403503418
Epoch: 5, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.738 Vali Acc: 0.560 Test Loss: 0.738 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559993).  Saving model ...
Epoch: 6 cost time: 1.6179039478302002
Epoch: 6, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.745 Vali Acc: 0.530 Test Loss: 0.745 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5527255535125732
Epoch: 7, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.759 Vali Acc: 0.480 Test Loss: 0.759 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6121020317077637
Epoch: 8, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.789 Vali Acc: 0.550 Test Loss: 0.789 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.665412187576294
Epoch: 9, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.766 Vali Acc: 0.550 Test Loss: 0.766 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8062705993652344
Epoch: 10, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.788 Vali Acc: 0.550 Test Loss: 0.788 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.51517653465271
Epoch: 11, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.821 Vali Acc: 0.550 Test Loss: 0.821 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5654692649841309
Epoch: 12, Steps: 20 | Train Loss: 0.429 Vali Loss: 0.926 Vali Acc: 0.560 Test Loss: 0.926 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5712311267852783
Epoch: 13, Steps: 20 | Train Loss: 0.393 Vali Loss: 0.830 Vali Acc: 0.520 Test Loss: 0.830 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5203356742858887
Epoch: 14, Steps: 20 | Train Loss: 0.343 Vali Loss: 0.897 Vali Acc: 0.560 Test Loss: 0.897 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6884636878967285
Epoch: 15, Steps: 20 | Train Loss: 0.278 Vali Loss: 0.928 Vali Acc: 0.540 Test Loss: 0.928 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 961762
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7111692428588867
Epoch: 1, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.701 Vali Acc: 0.460 Test Loss: 0.701 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.444948434829712
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.736 Vali Acc: 0.480 Test Loss: 0.736 Test Acc: 0.480
Validation loss decreased (-0.459993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 1.7418489456176758
Epoch: 3, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.766 Vali Acc: 0.430 Test Loss: 0.766 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8245222568511963
Epoch: 4, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.752 Vali Acc: 0.540 Test Loss: 0.752 Test Acc: 0.540
Validation loss decreased (-0.479993 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 1.6084556579589844
Epoch: 5, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.740 Vali Acc: 0.520 Test Loss: 0.740 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6483519077301025
Epoch: 6, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.826 Vali Acc: 0.550 Test Loss: 0.826 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 7 cost time: 1.343963384628296
Epoch: 7, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.738 Vali Acc: 0.520 Test Loss: 0.738 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1772091388702393
Epoch: 8, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.836 Vali Acc: 0.530 Test Loss: 0.836 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5949530601501465
Epoch: 9, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6788973808288574
Epoch: 10, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.784 Vali Acc: 0.520 Test Loss: 0.784 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4596080780029297
Epoch: 11, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.748 Vali Acc: 0.580 Test Loss: 0.748 Test Acc: 0.580
Validation loss decreased (-0.549992 --> -0.579993).  Saving model ...
Epoch: 12 cost time: 1.6541004180908203
Epoch: 12, Steps: 20 | Train Loss: 0.447 Vali Loss: 0.861 Vali Acc: 0.570 Test Loss: 0.861 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4955317974090576
Epoch: 13, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.848 Vali Acc: 0.530 Test Loss: 0.848 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.529266357421875
Epoch: 14, Steps: 20 | Train Loss: 0.382 Vali Loss: 0.808 Vali Acc: 0.570 Test Loss: 0.808 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7616379261016846
Epoch: 15, Steps: 20 | Train Loss: 0.363 Vali Loss: 0.796 Vali Acc: 0.550 Test Loss: 0.796 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7246382236480713
Epoch: 16, Steps: 20 | Train Loss: 0.333 Vali Loss: 0.839 Vali Acc: 0.550 Test Loss: 0.839 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7951443195343018
Epoch: 17, Steps: 20 | Train Loss: 0.286 Vali Loss: 0.875 Vali Acc: 0.540 Test Loss: 0.875 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6930861473083496
Epoch: 18, Steps: 20 | Train Loss: 0.233 Vali Loss: 0.896 Vali Acc: 0.550 Test Loss: 0.896 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3685197830200195
Epoch: 19, Steps: 20 | Train Loss: 0.197 Vali Loss: 0.879 Vali Acc: 0.590 Test Loss: 0.879 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589991).  Saving model ...
Epoch: 20 cost time: 1.4482266902923584
Epoch: 20, Steps: 20 | Train Loss: 0.152 Vali Loss: 0.986 Vali Acc: 0.560 Test Loss: 0.986 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.549584150314331
Epoch: 21, Steps: 20 | Train Loss: 0.117 Vali Loss: 1.106 Vali Acc: 0.570 Test Loss: 1.106 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6297187805175781
Epoch: 22, Steps: 20 | Train Loss: 0.084 Vali Loss: 0.981 Vali Acc: 0.590 Test Loss: 0.981 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4931881427764893
Epoch: 23, Steps: 20 | Train Loss: 0.061 Vali Loss: 1.302 Vali Acc: 0.560 Test Loss: 1.302 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5044331550598145
Epoch: 24, Steps: 20 | Train Loss: 0.057 Vali Loss: 1.254 Vali Acc: 0.580 Test Loss: 1.254 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6379835605621338
Epoch: 25, Steps: 20 | Train Loss: 0.034 Vali Loss: 1.200 Vali Acc: 0.550 Test Loss: 1.200 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.7127306461334229
Epoch: 26, Steps: 20 | Train Loss: 0.027 Vali Loss: 1.369 Vali Acc: 0.540 Test Loss: 1.369 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5880622863769531
Epoch: 27, Steps: 20 | Train Loss: 0.018 Vali Loss: 1.376 Vali Acc: 0.590 Test Loss: 1.376 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.7218050956726074
Epoch: 28, Steps: 20 | Train Loss: 0.012 Vali Loss: 1.420 Vali Acc: 0.530 Test Loss: 1.420 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3103232383728027
Epoch: 29, Steps: 20 | Train Loss: 0.009 Vali Loss: 1.468 Vali Acc: 0.570 Test Loss: 1.468 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 958274
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.146290302276611
Epoch: 1, Steps: 20 | Train Loss: 1.307 Vali Loss: 1.378 Vali Acc: 0.520 Test Loss: 1.378 Test Acc: 0.520
Validation loss decreased (inf --> -0.519986).  Saving model ...
Epoch: 2 cost time: 4.4170989990234375
Epoch: 2, Steps: 20 | Train Loss: 1.046 Vali Loss: 1.466 Vali Acc: 0.510 Test Loss: 1.466 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.785043716430664
Epoch: 3, Steps: 20 | Train Loss: 1.531 Vali Loss: 2.176 Vali Acc: 0.610 Test Loss: 2.176 Test Acc: 0.610
Validation loss decreased (-0.519986 --> -0.609978).  Saving model ...
Epoch: 4 cost time: 4.833983659744263
Epoch: 4, Steps: 20 | Train Loss: 2.359 Vali Loss: 2.560 Vali Acc: 0.570 Test Loss: 2.560 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.922547340393066
Epoch: 5, Steps: 20 | Train Loss: 2.126 Vali Loss: 5.862 Vali Acc: 0.490 Test Loss: 5.862 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.0273730754852295
Epoch: 6, Steps: 20 | Train Loss: 2.448 Vali Loss: 4.221 Vali Acc: 0.480 Test Loss: 4.221 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.069625616073608
Epoch: 7, Steps: 20 | Train Loss: 2.567 Vali Loss: 4.074 Vali Acc: 0.540 Test Loss: 4.074 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.837767839431763
Epoch: 8, Steps: 20 | Train Loss: 3.778 Vali Loss: 3.926 Vali Acc: 0.580 Test Loss: 3.926 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.805405616760254
Epoch: 9, Steps: 20 | Train Loss: 2.031 Vali Loss: 5.214 Vali Acc: 0.490 Test Loss: 5.214 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.813823938369751
Epoch: 10, Steps: 20 | Train Loss: 2.317 Vali Loss: 6.437 Vali Acc: 0.500 Test Loss: 6.437 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.010695695877075
Epoch: 11, Steps: 20 | Train Loss: 2.629 Vali Loss: 7.927 Vali Acc: 0.490 Test Loss: 7.927 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.4772257804870605
Epoch: 12, Steps: 20 | Train Loss: 1.873 Vali Loss: 3.900 Vali Acc: 0.630 Test Loss: 3.900 Test Acc: 0.630
Validation loss decreased (-0.609978 --> -0.629961).  Saving model ...
Epoch: 13 cost time: 4.2771079540252686
Epoch: 13, Steps: 20 | Train Loss: 1.249 Vali Loss: 4.038 Vali Acc: 0.570 Test Loss: 4.038 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.306868314743042
Epoch: 14, Steps: 20 | Train Loss: 1.204 Vali Loss: 4.135 Vali Acc: 0.560 Test Loss: 4.135 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.36464524269104
Epoch: 15, Steps: 20 | Train Loss: 0.773 Vali Loss: 4.212 Vali Acc: 0.580 Test Loss: 4.212 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.750194072723389
Epoch: 16, Steps: 20 | Train Loss: 0.806 Vali Loss: 4.212 Vali Acc: 0.540 Test Loss: 4.212 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.217653512954712
Epoch: 17, Steps: 20 | Train Loss: 0.381 Vali Loss: 3.470 Vali Acc: 0.540 Test Loss: 3.470 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.192917346954346
Epoch: 18, Steps: 20 | Train Loss: 0.426 Vali Loss: 3.888 Vali Acc: 0.580 Test Loss: 3.888 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.748859643936157
Epoch: 19, Steps: 20 | Train Loss: 0.528 Vali Loss: 4.257 Vali Acc: 0.540 Test Loss: 4.257 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.867801189422607
Epoch: 20, Steps: 20 | Train Loss: 0.439 Vali Loss: 4.656 Vali Acc: 0.520 Test Loss: 4.656 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.329355716705322
Epoch: 21, Steps: 20 | Train Loss: 0.136 Vali Loss: 4.034 Vali Acc: 0.590 Test Loss: 4.034 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.4232337474823
Epoch: 22, Steps: 20 | Train Loss: 0.182 Vali Loss: 4.124 Vali Acc: 0.590 Test Loss: 4.124 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 9062146
model size : 34.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.739229917526245
Epoch: 1, Steps: 20 | Train Loss: 0.830 Vali Loss: 1.187 Vali Acc: 0.450 Test Loss: 1.187 Test Acc: 0.450
Validation loss decreased (inf --> -0.449988).  Saving model ...
Epoch: 2 cost time: 2.7131359577178955
Epoch: 2, Steps: 20 | Train Loss: 1.080 Vali Loss: 1.589 Vali Acc: 0.500 Test Loss: 1.589 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499984).  Saving model ...
Epoch: 3 cost time: 2.811232328414917
Epoch: 3, Steps: 20 | Train Loss: 1.509 Vali Loss: 1.189 Vali Acc: 0.620 Test Loss: 1.189 Test Acc: 0.620
Validation loss decreased (-0.499984 --> -0.619988).  Saving model ...
Epoch: 4 cost time: 2.533219814300537
Epoch: 4, Steps: 20 | Train Loss: 1.121 Vali Loss: 1.437 Vali Acc: 0.570 Test Loss: 1.437 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.588134527206421
Epoch: 5, Steps: 20 | Train Loss: 1.102 Vali Loss: 1.728 Vali Acc: 0.510 Test Loss: 1.728 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.781625509262085
Epoch: 6, Steps: 20 | Train Loss: 1.036 Vali Loss: 2.974 Vali Acc: 0.540 Test Loss: 2.974 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8527162075042725
Epoch: 7, Steps: 20 | Train Loss: 1.196 Vali Loss: 2.697 Vali Acc: 0.530 Test Loss: 2.697 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.7844502925872803
Epoch: 8, Steps: 20 | Train Loss: 1.181 Vali Loss: 3.855 Vali Acc: 0.540 Test Loss: 3.855 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.9136762619018555
Epoch: 9, Steps: 20 | Train Loss: 1.428 Vali Loss: 3.154 Vali Acc: 0.550 Test Loss: 3.154 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.6948893070220947
Epoch: 10, Steps: 20 | Train Loss: 1.751 Vali Loss: 4.298 Vali Acc: 0.520 Test Loss: 4.298 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.273887872695923
Epoch: 11, Steps: 20 | Train Loss: 1.719 Vali Loss: 3.423 Vali Acc: 0.560 Test Loss: 3.423 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.3443443775177
Epoch: 12, Steps: 20 | Train Loss: 0.836 Vali Loss: 3.485 Vali Acc: 0.540 Test Loss: 3.485 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.5170464515686035
Epoch: 13, Steps: 20 | Train Loss: 0.631 Vali Loss: 3.868 Vali Acc: 0.530 Test Loss: 3.868 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 8704002
model size : 33.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.971043109893799
Epoch: 1, Steps: 20 | Train Loss: 0.818 Vali Loss: 0.887 Vali Acc: 0.520 Test Loss: 0.887 Test Acc: 0.520
Validation loss decreased (inf --> -0.519991).  Saving model ...
Epoch: 2 cost time: 2.565941572189331
Epoch: 2, Steps: 20 | Train Loss: 0.790 Vali Loss: 1.138 Vali Acc: 0.520 Test Loss: 1.138 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5921218395233154
Epoch: 3, Steps: 20 | Train Loss: 0.831 Vali Loss: 1.463 Vali Acc: 0.550 Test Loss: 1.463 Test Acc: 0.550
Validation loss decreased (-0.519991 --> -0.549985).  Saving model ...
Epoch: 4 cost time: 2.906386375427246
Epoch: 4, Steps: 20 | Train Loss: 1.007 Vali Loss: 2.559 Vali Acc: 0.480 Test Loss: 2.559 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.758113145828247
Epoch: 5, Steps: 20 | Train Loss: 1.168 Vali Loss: 3.813 Vali Acc: 0.500 Test Loss: 3.813 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9947588443756104
Epoch: 6, Steps: 20 | Train Loss: 1.583 Vali Loss: 2.893 Vali Acc: 0.550 Test Loss: 2.893 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.75234055519104
Epoch: 7, Steps: 20 | Train Loss: 1.649 Vali Loss: 2.387 Vali Acc: 0.550 Test Loss: 2.387 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.6919617652893066
Epoch: 8, Steps: 20 | Train Loss: 1.079 Vali Loss: 3.665 Vali Acc: 0.560 Test Loss: 3.665 Test Acc: 0.560
Validation loss decreased (-0.549985 --> -0.559963).  Saving model ...
Epoch: 9 cost time: 2.5535197257995605
Epoch: 9, Steps: 20 | Train Loss: 1.422 Vali Loss: 4.499 Vali Acc: 0.520 Test Loss: 4.499 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.44610333442688
Epoch: 10, Steps: 20 | Train Loss: 0.666 Vali Loss: 2.946 Vali Acc: 0.540 Test Loss: 2.946 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.5735387802124023
Epoch: 11, Steps: 20 | Train Loss: 0.558 Vali Loss: 3.690 Vali Acc: 0.550 Test Loss: 3.690 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.3378636837005615
Epoch: 12, Steps: 20 | Train Loss: 0.579 Vali Loss: 4.082 Vali Acc: 0.540 Test Loss: 4.082 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.4528017044067383
Epoch: 13, Steps: 20 | Train Loss: 0.774 Vali Loss: 3.707 Vali Acc: 0.550 Test Loss: 3.707 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.243713140487671
Epoch: 14, Steps: 20 | Train Loss: 0.739 Vali Loss: 7.006 Vali Acc: 0.560 Test Loss: 7.006 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.331613779067993
Epoch: 15, Steps: 20 | Train Loss: 0.505 Vali Loss: 4.305 Vali Acc: 0.540 Test Loss: 4.305 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.3481175899505615
Epoch: 16, Steps: 20 | Train Loss: 0.305 Vali Loss: 4.819 Vali Acc: 0.610 Test Loss: 4.819 Test Acc: 0.610
Validation loss decreased (-0.559963 --> -0.609952).  Saving model ...
Epoch: 17 cost time: 3.018721580505371
Epoch: 17, Steps: 20 | Train Loss: 0.271 Vali Loss: 5.552 Vali Acc: 0.550 Test Loss: 5.552 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.0573720932006836
Epoch: 18, Steps: 20 | Train Loss: 0.548 Vali Loss: 4.599 Vali Acc: 0.530 Test Loss: 4.599 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.2181291580200195
Epoch: 19, Steps: 20 | Train Loss: 0.218 Vali Loss: 4.840 Vali Acc: 0.550 Test Loss: 4.840 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.3019962310791016
Epoch: 20, Steps: 20 | Train Loss: 0.237 Vali Loss: 4.813 Vali Acc: 0.520 Test Loss: 4.813 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.2567553520202637
Epoch: 21, Steps: 20 | Train Loss: 0.351 Vali Loss: 5.477 Vali Acc: 0.610 Test Loss: 5.477 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.39745831489563
Epoch: 22, Steps: 20 | Train Loss: 0.165 Vali Loss: 5.064 Vali Acc: 0.590 Test Loss: 5.064 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.3040931224823
Epoch: 23, Steps: 20 | Train Loss: 0.245 Vali Loss: 4.944 Vali Acc: 0.580 Test Loss: 4.944 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.204784393310547
Epoch: 24, Steps: 20 | Train Loss: 0.256 Vali Loss: 6.752 Vali Acc: 0.580 Test Loss: 6.752 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.2711570262908936
Epoch: 25, Steps: 20 | Train Loss: 0.294 Vali Loss: 6.212 Vali Acc: 0.550 Test Loss: 6.212 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.0106122493743896
Epoch: 26, Steps: 20 | Train Loss: 0.312 Vali Loss: 5.977 Vali Acc: 0.580 Test Loss: 5.977 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 8704258
model size : 33.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.053305387496948
Epoch: 1, Steps: 20 | Train Loss: 0.887 Vali Loss: 1.437 Vali Acc: 0.410 Test Loss: 1.437 Test Acc: 0.410
Validation loss decreased (inf --> -0.409986).  Saving model ...
Epoch: 2 cost time: 2.9192914962768555
Epoch: 2, Steps: 20 | Train Loss: 0.996 Vali Loss: 1.355 Vali Acc: 0.590 Test Loss: 1.355 Test Acc: 0.590
Validation loss decreased (-0.409986 --> -0.589986).  Saving model ...
Epoch: 3 cost time: 2.370542049407959
Epoch: 3, Steps: 20 | Train Loss: 0.917 Vali Loss: 1.283 Vali Acc: 0.460 Test Loss: 1.283 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.203622341156006
Epoch: 4, Steps: 20 | Train Loss: 0.664 Vali Loss: 1.802 Vali Acc: 0.560 Test Loss: 1.802 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0372536182403564
Epoch: 5, Steps: 20 | Train Loss: 0.859 Vali Loss: 1.314 Vali Acc: 0.600 Test Loss: 1.314 Test Acc: 0.600
Validation loss decreased (-0.589986 --> -0.599987).  Saving model ...
Epoch: 6 cost time: 2.6100430488586426
Epoch: 6, Steps: 20 | Train Loss: 0.687 Vali Loss: 1.613 Vali Acc: 0.610 Test Loss: 1.613 Test Acc: 0.610
Validation loss decreased (-0.599987 --> -0.609984).  Saving model ...
Epoch: 7 cost time: 2.4585423469543457
Epoch: 7, Steps: 20 | Train Loss: 0.984 Vali Loss: 2.268 Vali Acc: 0.490 Test Loss: 2.268 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8572895526885986
Epoch: 8, Steps: 20 | Train Loss: 0.721 Vali Loss: 2.277 Vali Acc: 0.480 Test Loss: 2.277 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.949845552444458
Epoch: 9, Steps: 20 | Train Loss: 0.791 Vali Loss: 3.119 Vali Acc: 0.500 Test Loss: 3.119 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.167468309402466
Epoch: 10, Steps: 20 | Train Loss: 0.573 Vali Loss: 2.563 Vali Acc: 0.510 Test Loss: 2.563 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5281946659088135
Epoch: 11, Steps: 20 | Train Loss: 0.392 Vali Loss: 2.279 Vali Acc: 0.560 Test Loss: 2.279 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.69537353515625
Epoch: 12, Steps: 20 | Train Loss: 0.327 Vali Loss: 3.134 Vali Acc: 0.530 Test Loss: 3.134 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.880714178085327
Epoch: 13, Steps: 20 | Train Loss: 0.406 Vali Loss: 2.516 Vali Acc: 0.640 Test Loss: 2.516 Test Acc: 0.640
Validation loss decreased (-0.609984 --> -0.639975).  Saving model ...
Epoch: 14 cost time: 2.8527467250823975
Epoch: 14, Steps: 20 | Train Loss: 0.390 Vali Loss: 2.762 Vali Acc: 0.590 Test Loss: 2.762 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.720216751098633
Epoch: 15, Steps: 20 | Train Loss: 0.342 Vali Loss: 2.759 Vali Acc: 0.570 Test Loss: 2.759 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.874058723449707
Epoch: 16, Steps: 20 | Train Loss: 0.300 Vali Loss: 3.248 Vali Acc: 0.550 Test Loss: 3.248 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.7538390159606934
Epoch: 17, Steps: 20 | Train Loss: 0.181 Vali Loss: 2.912 Vali Acc: 0.560 Test Loss: 2.912 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.2620315551757812
Epoch: 18, Steps: 20 | Train Loss: 0.194 Vali Loss: 3.691 Vali Acc: 0.530 Test Loss: 3.691 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.156503915786743
Epoch: 19, Steps: 20 | Train Loss: 0.097 Vali Loss: 3.678 Vali Acc: 0.540 Test Loss: 3.678 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.7457895278930664
Epoch: 20, Steps: 20 | Train Loss: 0.387 Vali Loss: 4.493 Vali Acc: 0.520 Test Loss: 4.493 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.1512012481689453
Epoch: 21, Steps: 20 | Train Loss: 0.193 Vali Loss: 3.158 Vali Acc: 0.620 Test Loss: 3.158 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.9377481937408447
Epoch: 22, Steps: 20 | Train Loss: 0.149 Vali Loss: 5.529 Vali Acc: 0.550 Test Loss: 5.529 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.117926836013794
Epoch: 23, Steps: 20 | Train Loss: 0.373 Vali Loss: 3.789 Vali Acc: 0.570 Test Loss: 3.789 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 8575490
model size : 32.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.471664667129517
Epoch: 1, Steps: 20 | Train Loss: 0.790 Vali Loss: 0.709 Vali Acc: 0.550 Test Loss: 0.709 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.036025285720825
Epoch: 2, Steps: 20 | Train Loss: 0.766 Vali Loss: 0.813 Vali Acc: 0.520 Test Loss: 0.813 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8005197048187256
Epoch: 3, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.967 Vali Acc: 0.610 Test Loss: 0.967 Test Acc: 0.610
Validation loss decreased (-0.549993 --> -0.609990).  Saving model ...
Epoch: 4 cost time: 1.9650821685791016
Epoch: 4, Steps: 20 | Train Loss: 0.612 Vali Loss: 1.326 Vali Acc: 0.550 Test Loss: 1.326 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.141059637069702
Epoch: 5, Steps: 20 | Train Loss: 0.652 Vali Loss: 1.207 Vali Acc: 0.610 Test Loss: 1.207 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.420356512069702
Epoch: 6, Steps: 20 | Train Loss: 0.595 Vali Loss: 1.366 Vali Acc: 0.540 Test Loss: 1.366 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.0622379779815674
Epoch: 7, Steps: 20 | Train Loss: 0.437 Vali Loss: 1.446 Vali Acc: 0.530 Test Loss: 1.446 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.9013192653656006
Epoch: 8, Steps: 20 | Train Loss: 0.438 Vali Loss: 1.566 Vali Acc: 0.510 Test Loss: 1.566 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.4717442989349365
Epoch: 9, Steps: 20 | Train Loss: 0.680 Vali Loss: 1.596 Vali Acc: 0.530 Test Loss: 1.596 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.0615925788879395
Epoch: 10, Steps: 20 | Train Loss: 0.320 Vali Loss: 1.711 Vali Acc: 0.590 Test Loss: 1.711 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.685986280441284
Epoch: 11, Steps: 20 | Train Loss: 0.612 Vali Loss: 2.733 Vali Acc: 0.530 Test Loss: 2.733 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.8768999576568604
Epoch: 12, Steps: 20 | Train Loss: 0.352 Vali Loss: 1.961 Vali Acc: 0.650 Test Loss: 1.961 Test Acc: 0.650
Validation loss decreased (-0.609990 --> -0.649980).  Saving model ...
Epoch: 13 cost time: 2.5813374519348145
Epoch: 13, Steps: 20 | Train Loss: 0.402 Vali Loss: 3.589 Vali Acc: 0.540 Test Loss: 3.589 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4193215370178223
Epoch: 14, Steps: 20 | Train Loss: 0.721 Vali Loss: 2.316 Vali Acc: 0.600 Test Loss: 2.316 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.893946409225464
Epoch: 15, Steps: 20 | Train Loss: 0.360 Vali Loss: 2.160 Vali Acc: 0.560 Test Loss: 2.160 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.8636982440948486
Epoch: 16, Steps: 20 | Train Loss: 0.147 Vali Loss: 3.235 Vali Acc: 0.500 Test Loss: 3.235 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.849581003189087
Epoch: 17, Steps: 20 | Train Loss: 0.169 Vali Loss: 2.687 Vali Acc: 0.560 Test Loss: 2.687 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.825798749923706
Epoch: 18, Steps: 20 | Train Loss: 0.120 Vali Loss: 2.226 Vali Acc: 0.610 Test Loss: 2.226 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.6569039821624756
Epoch: 19, Steps: 20 | Train Loss: 0.146 Vali Loss: 2.899 Vali Acc: 0.570 Test Loss: 2.899 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.6804778575897217
Epoch: 20, Steps: 20 | Train Loss: 0.124 Vali Loss: 3.214 Vali Acc: 0.490 Test Loss: 3.214 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.614537477493286
Epoch: 21, Steps: 20 | Train Loss: 0.196 Vali Loss: 3.701 Vali Acc: 0.560 Test Loss: 3.701 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.880319118499756
Epoch: 22, Steps: 20 | Train Loss: 0.088 Vali Loss: 3.522 Vali Acc: 0.570 Test Loss: 3.522 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 8518914
model size : 32.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.005638360977173
Epoch: 1, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.915 Vali Acc: 0.480 Test Loss: 0.915 Test Acc: 0.480
Validation loss decreased (inf --> -0.479991).  Saving model ...
Epoch: 2 cost time: 2.793494939804077
Epoch: 2, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.734 Vali Acc: 0.560 Test Loss: 0.734 Test Acc: 0.560
Validation loss decreased (-0.479991 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 2.3043110370635986
Epoch: 3, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.778 Vali Acc: 0.610 Test Loss: 0.778 Test Acc: 0.610
Validation loss decreased (-0.559993 --> -0.609992).  Saving model ...
Epoch: 4 cost time: 2.01058030128479
Epoch: 4, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.945 Vali Acc: 0.550 Test Loss: 0.945 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4443445205688477
Epoch: 5, Steps: 20 | Train Loss: 0.781 Vali Loss: 1.794 Vali Acc: 0.500 Test Loss: 1.794 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5094845294952393
Epoch: 6, Steps: 20 | Train Loss: 0.590 Vali Loss: 1.242 Vali Acc: 0.600 Test Loss: 1.242 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8857388496398926
Epoch: 7, Steps: 20 | Train Loss: 0.598 Vali Loss: 1.549 Vali Acc: 0.600 Test Loss: 1.549 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.8017020225524902
Epoch: 8, Steps: 20 | Train Loss: 1.217 Vali Loss: 1.821 Vali Acc: 0.540 Test Loss: 1.821 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.972172737121582
Epoch: 9, Steps: 20 | Train Loss: 0.650 Vali Loss: 1.659 Vali Acc: 0.580 Test Loss: 1.659 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.93404483795166
Epoch: 10, Steps: 20 | Train Loss: 0.548 Vali Loss: 1.271 Vali Acc: 0.590 Test Loss: 1.271 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.6806206703186035
Epoch: 11, Steps: 20 | Train Loss: 0.587 Vali Loss: 2.117 Vali Acc: 0.540 Test Loss: 2.117 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.7692785263061523
Epoch: 12, Steps: 20 | Train Loss: 0.376 Vali Loss: 1.657 Vali Acc: 0.550 Test Loss: 1.657 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.635660409927368
Epoch: 13, Steps: 20 | Train Loss: 0.258 Vali Loss: 2.993 Vali Acc: 0.480 Test Loss: 2.993 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 8490754
model size : 32.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.754821538925171
Epoch: 1, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.779 Vali Acc: 0.480 Test Loss: 0.779 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 2.512974977493286
Epoch: 2, Steps: 20 | Train Loss: 0.860 Vali Loss: 0.964 Vali Acc: 0.590 Test Loss: 0.964 Test Acc: 0.590
Validation loss decreased (-0.479992 --> -0.589990).  Saving model ...
Epoch: 3 cost time: 2.586843490600586
Epoch: 3, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.992 Vali Acc: 0.520 Test Loss: 0.992 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4995763301849365
Epoch: 4, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.899 Vali Acc: 0.570 Test Loss: 0.899 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2464003562927246
Epoch: 5, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.809 Vali Acc: 0.610 Test Loss: 0.809 Test Acc: 0.610
Validation loss decreased (-0.589990 --> -0.609992).  Saving model ...
Epoch: 6 cost time: 2.7410647869110107
Epoch: 6, Steps: 20 | Train Loss: 0.494 Vali Loss: 1.311 Vali Acc: 0.500 Test Loss: 1.311 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8219501972198486
Epoch: 7, Steps: 20 | Train Loss: 0.461 Vali Loss: 1.382 Vali Acc: 0.550 Test Loss: 1.382 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.590444803237915
Epoch: 8, Steps: 20 | Train Loss: 0.377 Vali Loss: 1.626 Vali Acc: 0.550 Test Loss: 1.626 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.832350254058838
Epoch: 9, Steps: 20 | Train Loss: 0.391 Vali Loss: 1.736 Vali Acc: 0.500 Test Loss: 1.736 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.698223352432251
Epoch: 10, Steps: 20 | Train Loss: 0.328 Vali Loss: 1.378 Vali Acc: 0.540 Test Loss: 1.378 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.7572929859161377
Epoch: 11, Steps: 20 | Train Loss: 0.376 Vali Loss: 1.367 Vali Acc: 0.610 Test Loss: 1.367 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.504640817642212
Epoch: 12, Steps: 20 | Train Loss: 0.220 Vali Loss: 2.002 Vali Acc: 0.510 Test Loss: 2.002 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9134280681610107
Epoch: 13, Steps: 20 | Train Loss: 0.329 Vali Loss: 1.670 Vali Acc: 0.570 Test Loss: 1.670 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9293947219848633
Epoch: 14, Steps: 20 | Train Loss: 0.182 Vali Loss: 1.949 Vali Acc: 0.550 Test Loss: 1.949 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.2129549980163574
Epoch: 15, Steps: 20 | Train Loss: 0.338 Vali Loss: 1.667 Vali Acc: 0.570 Test Loss: 1.667 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 8448514
model size : 32.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5564565658569336
Epoch: 1, Steps: 20 | Train Loss: 0.981 Vali Loss: 0.746 Vali Acc: 0.550 Test Loss: 0.746 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.3012659549713135
Epoch: 2, Steps: 20 | Train Loss: 1.024 Vali Loss: 0.991 Vali Acc: 0.590 Test Loss: 0.991 Test Acc: 0.590
Validation loss decreased (-0.549993 --> -0.589990).  Saving model ...
Epoch: 3 cost time: 2.3344099521636963
Epoch: 3, Steps: 20 | Train Loss: 1.217 Vali Loss: 1.572 Vali Acc: 0.490 Test Loss: 1.572 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1312079429626465
Epoch: 4, Steps: 20 | Train Loss: 0.932 Vali Loss: 1.200 Vali Acc: 0.600 Test Loss: 1.200 Test Acc: 0.600
Validation loss decreased (-0.589990 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 2.149050712585449
Epoch: 5, Steps: 20 | Train Loss: 1.047 Vali Loss: 2.070 Vali Acc: 0.480 Test Loss: 2.070 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0956408977508545
Epoch: 6, Steps: 20 | Train Loss: 1.384 Vali Loss: 4.248 Vali Acc: 0.510 Test Loss: 4.248 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.432870388031006
Epoch: 7, Steps: 20 | Train Loss: 1.185 Vali Loss: 3.799 Vali Acc: 0.490 Test Loss: 3.799 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2760026454925537
Epoch: 8, Steps: 20 | Train Loss: 1.697 Vali Loss: 3.164 Vali Acc: 0.520 Test Loss: 3.164 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1725032329559326
Epoch: 9, Steps: 20 | Train Loss: 1.502 Vali Loss: 2.754 Vali Acc: 0.570 Test Loss: 2.754 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.1881589889526367
Epoch: 10, Steps: 20 | Train Loss: 0.989 Vali Loss: 2.994 Vali Acc: 0.630 Test Loss: 2.994 Test Acc: 0.630
Validation loss decreased (-0.599988 --> -0.629970).  Saving model ...
Epoch: 11 cost time: 2.3613498210906982
Epoch: 11, Steps: 20 | Train Loss: 0.752 Vali Loss: 6.162 Vali Acc: 0.550 Test Loss: 6.162 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.180330753326416
Epoch: 12, Steps: 20 | Train Loss: 1.498 Vali Loss: 6.263 Vali Acc: 0.470 Test Loss: 6.263 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3625872135162354
Epoch: 13, Steps: 20 | Train Loss: 1.639 Vali Loss: 2.856 Vali Acc: 0.580 Test Loss: 2.856 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1115429401397705
Epoch: 14, Steps: 20 | Train Loss: 0.868 Vali Loss: 4.229 Vali Acc: 0.470 Test Loss: 4.229 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0859546661376953
Epoch: 15, Steps: 20 | Train Loss: 0.826 Vali Loss: 2.612 Vali Acc: 0.620 Test Loss: 2.612 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.080376386642456
Epoch: 16, Steps: 20 | Train Loss: 0.743 Vali Loss: 3.492 Vali Acc: 0.670 Test Loss: 3.492 Test Acc: 0.670
Validation loss decreased (-0.629970 --> -0.669965).  Saving model ...
Epoch: 17 cost time: 2.4322195053100586
Epoch: 17, Steps: 20 | Train Loss: 0.613 Vali Loss: 3.565 Vali Acc: 0.580 Test Loss: 3.565 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3514230251312256
Epoch: 18, Steps: 20 | Train Loss: 0.332 Vali Loss: 3.424 Vali Acc: 0.530 Test Loss: 3.424 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.312037944793701
Epoch: 19, Steps: 20 | Train Loss: 0.333 Vali Loss: 2.778 Vali Acc: 0.650 Test Loss: 2.778 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.2987122535705566
Epoch: 20, Steps: 20 | Train Loss: 0.280 Vali Loss: 2.542 Vali Acc: 0.610 Test Loss: 2.542 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.2659614086151123
Epoch: 21, Steps: 20 | Train Loss: 0.210 Vali Loss: 3.308 Vali Acc: 0.560 Test Loss: 3.308 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.2097771167755127
Epoch: 22, Steps: 20 | Train Loss: 0.256 Vali Loss: 3.003 Vali Acc: 0.560 Test Loss: 3.003 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.020451545715332
Epoch: 23, Steps: 20 | Train Loss: 0.170 Vali Loss: 3.323 Vali Acc: 0.610 Test Loss: 3.323 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3972954750061035
Epoch: 24, Steps: 20 | Train Loss: 0.189 Vali Loss: 3.222 Vali Acc: 0.610 Test Loss: 3.222 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.5276105403900146
Epoch: 25, Steps: 20 | Train Loss: 0.116 Vali Loss: 4.171 Vali Acc: 0.580 Test Loss: 4.171 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6287407875061035
Epoch: 26, Steps: 20 | Train Loss: 0.234 Vali Loss: 3.497 Vali Acc: 0.570 Test Loss: 3.497 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.67
model parameter : 2696066
model size : 10.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.549351692199707
Epoch: 1, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.825 Vali Acc: 0.500 Test Loss: 0.825 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.9772629737854004
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.911 Vali Acc: 0.540 Test Loss: 0.911 Test Acc: 0.540
Validation loss decreased (-0.499992 --> -0.539991).  Saving model ...
Epoch: 3 cost time: 1.730745553970337
Epoch: 3, Steps: 20 | Train Loss: 0.812 Vali Loss: 1.138 Vali Acc: 0.550 Test Loss: 1.138 Test Acc: 0.550
Validation loss decreased (-0.539991 --> -0.549989).  Saving model ...
Epoch: 4 cost time: 2.0487964153289795
Epoch: 4, Steps: 20 | Train Loss: 0.731 Vali Loss: 1.020 Vali Acc: 0.610 Test Loss: 1.020 Test Acc: 0.610
Validation loss decreased (-0.549989 --> -0.609990).  Saving model ...
Epoch: 5 cost time: 1.7346880435943604
Epoch: 5, Steps: 20 | Train Loss: 0.663 Vali Loss: 1.889 Vali Acc: 0.490 Test Loss: 1.889 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8487255573272705
Epoch: 6, Steps: 20 | Train Loss: 0.808 Vali Loss: 1.528 Vali Acc: 0.590 Test Loss: 1.528 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6855764389038086
Epoch: 7, Steps: 20 | Train Loss: 0.697 Vali Loss: 2.071 Vali Acc: 0.620 Test Loss: 2.071 Test Acc: 0.620
Validation loss decreased (-0.609990 --> -0.619979).  Saving model ...
Epoch: 8 cost time: 1.8304922580718994
Epoch: 8, Steps: 20 | Train Loss: 0.573 Vali Loss: 1.760 Vali Acc: 0.530 Test Loss: 1.760 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4260764122009277
Epoch: 9, Steps: 20 | Train Loss: 0.710 Vali Loss: 1.917 Vali Acc: 0.570 Test Loss: 1.917 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8141260147094727
Epoch: 10, Steps: 20 | Train Loss: 0.548 Vali Loss: 1.741 Vali Acc: 0.610 Test Loss: 1.741 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7362241744995117
Epoch: 11, Steps: 20 | Train Loss: 0.535 Vali Loss: 2.446 Vali Acc: 0.560 Test Loss: 2.446 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.816208839416504
Epoch: 12, Steps: 20 | Train Loss: 0.385 Vali Loss: 2.240 Vali Acc: 0.550 Test Loss: 2.240 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7518880367279053
Epoch: 13, Steps: 20 | Train Loss: 0.920 Vali Loss: 5.029 Vali Acc: 0.480 Test Loss: 5.029 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9781849384307861
Epoch: 14, Steps: 20 | Train Loss: 0.941 Vali Loss: 2.677 Vali Acc: 0.560 Test Loss: 2.677 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8134229183197021
Epoch: 15, Steps: 20 | Train Loss: 0.400 Vali Loss: 2.462 Vali Acc: 0.530 Test Loss: 2.462 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9561669826507568
Epoch: 16, Steps: 20 | Train Loss: 0.369 Vali Loss: 2.936 Vali Acc: 0.490 Test Loss: 2.936 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.699733018875122
Epoch: 17, Steps: 20 | Train Loss: 0.406 Vali Loss: 2.438 Vali Acc: 0.570 Test Loss: 2.438 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 2516994
model size : 9.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8231799602508545
Epoch: 1, Steps: 20 | Train Loss: 0.806 Vali Loss: 1.065 Vali Acc: 0.490 Test Loss: 1.065 Test Acc: 0.490
Validation loss decreased (inf --> -0.489989).  Saving model ...
Epoch: 2 cost time: 1.7292962074279785
Epoch: 2, Steps: 20 | Train Loss: 0.865 Vali Loss: 0.786 Vali Acc: 0.560 Test Loss: 0.786 Test Acc: 0.560
Validation loss decreased (-0.489989 --> -0.559992).  Saving model ...
Epoch: 3 cost time: 1.777824878692627
Epoch: 3, Steps: 20 | Train Loss: 0.811 Vali Loss: 1.535 Vali Acc: 0.550 Test Loss: 1.535 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8623244762420654
Epoch: 4, Steps: 20 | Train Loss: 0.835 Vali Loss: 1.210 Vali Acc: 0.610 Test Loss: 1.210 Test Acc: 0.610
Validation loss decreased (-0.559992 --> -0.609988).  Saving model ...
Epoch: 5 cost time: 1.7600634098052979
Epoch: 5, Steps: 20 | Train Loss: 1.000 Vali Loss: 1.311 Vali Acc: 0.580 Test Loss: 1.311 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8084840774536133
Epoch: 6, Steps: 20 | Train Loss: 0.739 Vali Loss: 1.478 Vali Acc: 0.490 Test Loss: 1.478 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8456404209136963
Epoch: 7, Steps: 20 | Train Loss: 0.590 Vali Loss: 1.812 Vali Acc: 0.520 Test Loss: 1.812 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7044498920440674
Epoch: 8, Steps: 20 | Train Loss: 0.473 Vali Loss: 1.489 Vali Acc: 0.570 Test Loss: 1.489 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7600505352020264
Epoch: 9, Steps: 20 | Train Loss: 0.456 Vali Loss: 2.598 Vali Acc: 0.500 Test Loss: 2.598 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7061316967010498
Epoch: 10, Steps: 20 | Train Loss: 0.528 Vali Loss: 1.958 Vali Acc: 0.590 Test Loss: 1.958 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7749106884002686
Epoch: 11, Steps: 20 | Train Loss: 0.492 Vali Loss: 1.913 Vali Acc: 0.530 Test Loss: 1.913 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4826180934906006
Epoch: 12, Steps: 20 | Train Loss: 0.461 Vali Loss: 2.265 Vali Acc: 0.520 Test Loss: 2.265 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.59427809715271
Epoch: 13, Steps: 20 | Train Loss: 0.334 Vali Loss: 2.203 Vali Acc: 0.550 Test Loss: 2.203 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5442111492156982
Epoch: 14, Steps: 20 | Train Loss: 0.420 Vali Loss: 2.221 Vali Acc: 0.600 Test Loss: 2.221 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2517122
model size : 9.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.3930280208587646
Epoch: 1, Steps: 20 | Train Loss: 0.847 Vali Loss: 0.760 Vali Acc: 0.490 Test Loss: 0.760 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.061781644821167
Epoch: 2, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.840 Vali Acc: 0.520 Test Loss: 0.840 Test Acc: 0.520
Validation loss decreased (-0.489992 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 1.1616361141204834
Epoch: 3, Steps: 20 | Train Loss: 0.740 Vali Loss: 1.359 Vali Acc: 0.490 Test Loss: 1.359 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9311909675598145
Epoch: 4, Steps: 20 | Train Loss: 0.904 Vali Loss: 1.366 Vali Acc: 0.520 Test Loss: 1.366 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2961552143096924
Epoch: 5, Steps: 20 | Train Loss: 0.687 Vali Loss: 1.261 Vali Acc: 0.510 Test Loss: 1.261 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5394506454467773
Epoch: 6, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.999 Vali Acc: 0.590 Test Loss: 0.999 Test Acc: 0.590
Validation loss decreased (-0.519992 --> -0.589990).  Saving model ...
Epoch: 7 cost time: 1.640369176864624
Epoch: 7, Steps: 20 | Train Loss: 0.442 Vali Loss: 1.242 Vali Acc: 0.630 Test Loss: 1.242 Test Acc: 0.630
Validation loss decreased (-0.589990 --> -0.629988).  Saving model ...
Epoch: 8 cost time: 1.5691626071929932
Epoch: 8, Steps: 20 | Train Loss: 0.801 Vali Loss: 2.083 Vali Acc: 0.530 Test Loss: 2.083 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6315107345581055
Epoch: 9, Steps: 20 | Train Loss: 0.487 Vali Loss: 2.353 Vali Acc: 0.510 Test Loss: 2.353 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4880125522613525
Epoch: 10, Steps: 20 | Train Loss: 0.437 Vali Loss: 1.492 Vali Acc: 0.540 Test Loss: 1.492 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6859779357910156
Epoch: 11, Steps: 20 | Train Loss: 0.575 Vali Loss: 2.017 Vali Acc: 0.550 Test Loss: 2.017 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.620957612991333
Epoch: 12, Steps: 20 | Train Loss: 0.385 Vali Loss: 1.458 Vali Acc: 0.530 Test Loss: 1.458 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4876863956451416
Epoch: 13, Steps: 20 | Train Loss: 0.234 Vali Loss: 2.118 Vali Acc: 0.470 Test Loss: 2.118 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.473442554473877
Epoch: 14, Steps: 20 | Train Loss: 0.264 Vali Loss: 2.048 Vali Acc: 0.610 Test Loss: 2.048 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3453490734100342
Epoch: 15, Steps: 20 | Train Loss: 0.170 Vali Loss: 1.595 Vali Acc: 0.570 Test Loss: 1.595 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5201919078826904
Epoch: 16, Steps: 20 | Train Loss: 0.194 Vali Loss: 1.763 Vali Acc: 0.600 Test Loss: 1.763 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4556562900543213
Epoch: 17, Steps: 20 | Train Loss: 0.288 Vali Loss: 2.031 Vali Acc: 0.600 Test Loss: 2.031 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 2452738
model size : 9.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.638453483581543
Epoch: 1, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.709 Vali Acc: 0.520 Test Loss: 0.709 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.5714621543884277
Epoch: 2, Steps: 20 | Train Loss: 0.738 Vali Loss: 1.089 Vali Acc: 0.520 Test Loss: 1.089 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.336869716644287
Epoch: 3, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.858 Vali Acc: 0.600 Test Loss: 0.858 Test Acc: 0.600
Validation loss decreased (-0.519993 --> -0.599991).  Saving model ...
Epoch: 4 cost time: 1.4650344848632812
Epoch: 4, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.993 Vali Acc: 0.510 Test Loss: 0.993 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3800535202026367
Epoch: 5, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.846 Vali Acc: 0.570 Test Loss: 0.846 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6412537097930908
Epoch: 6, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.889 Vali Acc: 0.550 Test Loss: 0.889 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5270452499389648
Epoch: 7, Steps: 20 | Train Loss: 0.403 Vali Loss: 1.016 Vali Acc: 0.550 Test Loss: 1.016 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7266716957092285
Epoch: 8, Steps: 20 | Train Loss: 0.344 Vali Loss: 1.200 Vali Acc: 0.510 Test Loss: 1.200 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5586872100830078
Epoch: 9, Steps: 20 | Train Loss: 0.551 Vali Loss: 1.294 Vali Acc: 0.560 Test Loss: 1.294 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6528217792510986
Epoch: 10, Steps: 20 | Train Loss: 0.361 Vali Loss: 1.614 Vali Acc: 0.460 Test Loss: 1.614 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5257678031921387
Epoch: 11, Steps: 20 | Train Loss: 0.619 Vali Loss: 2.284 Vali Acc: 0.500 Test Loss: 2.284 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6622581481933594
Epoch: 12, Steps: 20 | Train Loss: 0.533 Vali Loss: 1.321 Vali Acc: 0.560 Test Loss: 1.321 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.55027174949646
Epoch: 13, Steps: 20 | Train Loss: 0.221 Vali Loss: 1.351 Vali Acc: 0.610 Test Loss: 1.351 Test Acc: 0.610
Validation loss decreased (-0.599991 --> -0.609986).  Saving model ...
Epoch: 14 cost time: 1.6377606391906738
Epoch: 14, Steps: 20 | Train Loss: 0.218 Vali Loss: 2.102 Vali Acc: 0.520 Test Loss: 2.102 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.337944746017456
Epoch: 15, Steps: 20 | Train Loss: 0.245 Vali Loss: 1.422 Vali Acc: 0.570 Test Loss: 1.422 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5375096797943115
Epoch: 16, Steps: 20 | Train Loss: 0.200 Vali Loss: 2.819 Vali Acc: 0.490 Test Loss: 2.819 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.359816551208496
Epoch: 17, Steps: 20 | Train Loss: 0.255 Vali Loss: 2.302 Vali Acc: 0.610 Test Loss: 2.302 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5997505187988281
Epoch: 18, Steps: 20 | Train Loss: 0.201 Vali Loss: 1.809 Vali Acc: 0.560 Test Loss: 1.809 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5478765964508057
Epoch: 19, Steps: 20 | Train Loss: 0.068 Vali Loss: 1.924 Vali Acc: 0.550 Test Loss: 1.924 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4047825336456299
Epoch: 20, Steps: 20 | Train Loss: 0.053 Vali Loss: 1.952 Vali Acc: 0.610 Test Loss: 1.952 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3815293312072754
Epoch: 21, Steps: 20 | Train Loss: 0.124 Vali Loss: 2.375 Vali Acc: 0.500 Test Loss: 2.375 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.292997121810913
Epoch: 22, Steps: 20 | Train Loss: 0.088 Vali Loss: 1.839 Vali Acc: 0.570 Test Loss: 1.839 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3402626514434814
Epoch: 23, Steps: 20 | Train Loss: 0.069 Vali Loss: 2.016 Vali Acc: 0.590 Test Loss: 2.016 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2424450
model size : 9.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.865870475769043
Epoch: 1, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.731 Vali Acc: 0.510 Test Loss: 0.731 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.5955686569213867
Epoch: 2, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.880 Vali Acc: 0.520 Test Loss: 0.880 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519991).  Saving model ...
Epoch: 3 cost time: 1.7738618850708008
Epoch: 3, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.823 Vali Acc: 0.480 Test Loss: 0.823 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7464637756347656
Epoch: 4, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.805 Vali Acc: 0.510 Test Loss: 0.805 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6165435314178467
Epoch: 5, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.928 Vali Acc: 0.580 Test Loss: 0.928 Test Acc: 0.580
Validation loss decreased (-0.519991 --> -0.579991).  Saving model ...
Epoch: 6 cost time: 1.673983097076416
Epoch: 6, Steps: 20 | Train Loss: 0.598 Vali Loss: 1.238 Vali Acc: 0.500 Test Loss: 1.238 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.584390640258789
Epoch: 7, Steps: 20 | Train Loss: 0.591 Vali Loss: 1.048 Vali Acc: 0.570 Test Loss: 1.048 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.475724220275879
Epoch: 8, Steps: 20 | Train Loss: 0.411 Vali Loss: 1.187 Vali Acc: 0.520 Test Loss: 1.187 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4353091716766357
Epoch: 9, Steps: 20 | Train Loss: 0.465 Vali Loss: 1.741 Vali Acc: 0.520 Test Loss: 1.741 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4925198554992676
Epoch: 10, Steps: 20 | Train Loss: 0.652 Vali Loss: 1.533 Vali Acc: 0.540 Test Loss: 1.533 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5978765487670898
Epoch: 11, Steps: 20 | Train Loss: 0.417 Vali Loss: 1.255 Vali Acc: 0.620 Test Loss: 1.255 Test Acc: 0.620
Validation loss decreased (-0.579991 --> -0.619987).  Saving model ...
Epoch: 12 cost time: 1.6708028316497803
Epoch: 12, Steps: 20 | Train Loss: 0.365 Vali Loss: 1.268 Vali Acc: 0.560 Test Loss: 1.268 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.663586139678955
Epoch: 13, Steps: 20 | Train Loss: 0.278 Vali Loss: 1.057 Vali Acc: 0.630 Test Loss: 1.057 Test Acc: 0.630
Validation loss decreased (-0.619987 --> -0.629989).  Saving model ...
Epoch: 14 cost time: 1.7341103553771973
Epoch: 14, Steps: 20 | Train Loss: 0.227 Vali Loss: 1.447 Vali Acc: 0.560 Test Loss: 1.447 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.688413143157959
Epoch: 15, Steps: 20 | Train Loss: 0.132 Vali Loss: 1.671 Vali Acc: 0.500 Test Loss: 1.671 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.567683219909668
Epoch: 16, Steps: 20 | Train Loss: 0.146 Vali Loss: 1.297 Vali Acc: 0.580 Test Loss: 1.297 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7930803298950195
Epoch: 17, Steps: 20 | Train Loss: 0.134 Vali Loss: 2.035 Vali Acc: 0.530 Test Loss: 2.035 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6186137199401855
Epoch: 18, Steps: 20 | Train Loss: 0.128 Vali Loss: 1.919 Vali Acc: 0.530 Test Loss: 1.919 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.575160026550293
Epoch: 19, Steps: 20 | Train Loss: 0.081 Vali Loss: 1.901 Vali Acc: 0.550 Test Loss: 1.901 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.695941686630249
Epoch: 20, Steps: 20 | Train Loss: 0.095 Vali Loss: 1.690 Vali Acc: 0.590 Test Loss: 1.690 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3802876472473145
Epoch: 21, Steps: 20 | Train Loss: 0.065 Vali Loss: 1.876 Vali Acc: 0.520 Test Loss: 1.876 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4340217113494873
Epoch: 22, Steps: 20 | Train Loss: 0.046 Vali Loss: 1.740 Vali Acc: 0.590 Test Loss: 1.740 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4317395687103271
Epoch: 23, Steps: 20 | Train Loss: 0.060 Vali Loss: 2.199 Vali Acc: 0.530 Test Loss: 2.199 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 2410370
model size : 9.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7384893894195557
Epoch: 1, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.706 Vali Acc: 0.560 Test Loss: 0.706 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 1.5637342929840088
Epoch: 2, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.779 Vali Acc: 0.530 Test Loss: 0.779 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.610278844833374
Epoch: 3, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.761 Vali Acc: 0.570 Test Loss: 0.761 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569992).  Saving model ...
Epoch: 4 cost time: 1.1218287944793701
Epoch: 4, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.914 Vali Acc: 0.590 Test Loss: 0.914 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589991).  Saving model ...
Epoch: 5 cost time: 1.0909817218780518
Epoch: 5, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.834 Vali Acc: 0.570 Test Loss: 0.834 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1410341262817383
Epoch: 6, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.965 Vali Acc: 0.570 Test Loss: 0.965 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.264850378036499
Epoch: 7, Steps: 20 | Train Loss: 0.505 Vali Loss: 1.049 Vali Acc: 0.540 Test Loss: 1.049 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2782366275787354
Epoch: 8, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.872 Vali Acc: 0.530 Test Loss: 0.872 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.200000286102295
Epoch: 9, Steps: 20 | Train Loss: 0.398 Vali Loss: 1.167 Vali Acc: 0.520 Test Loss: 1.167 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4828872680664062
Epoch: 10, Steps: 20 | Train Loss: 0.367 Vali Loss: 0.905 Vali Acc: 0.560 Test Loss: 0.905 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3759145736694336
Epoch: 11, Steps: 20 | Train Loss: 0.322 Vali Loss: 0.933 Vali Acc: 0.620 Test Loss: 0.933 Test Acc: 0.620
Validation loss decreased (-0.589991 --> -0.619991).  Saving model ...
Epoch: 12 cost time: 1.5173606872558594
Epoch: 12, Steps: 20 | Train Loss: 0.298 Vali Loss: 0.983 Vali Acc: 0.550 Test Loss: 0.983 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4955272674560547
Epoch: 13, Steps: 20 | Train Loss: 0.263 Vali Loss: 1.168 Vali Acc: 0.540 Test Loss: 1.168 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2170615196228027
Epoch: 14, Steps: 20 | Train Loss: 0.193 Vali Loss: 1.065 Vali Acc: 0.520 Test Loss: 1.065 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3077771663665771
Epoch: 15, Steps: 20 | Train Loss: 0.197 Vali Loss: 1.223 Vali Acc: 0.500 Test Loss: 1.223 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.259878396987915
Epoch: 16, Steps: 20 | Train Loss: 0.137 Vali Loss: 1.572 Vali Acc: 0.510 Test Loss: 1.572 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4669694900512695
Epoch: 17, Steps: 20 | Train Loss: 0.143 Vali Loss: 1.149 Vali Acc: 0.570 Test Loss: 1.149 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4946327209472656
Epoch: 18, Steps: 20 | Train Loss: 0.187 Vali Loss: 1.256 Vali Acc: 0.530 Test Loss: 1.256 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.522564172744751
Epoch: 19, Steps: 20 | Train Loss: 0.131 Vali Loss: 1.718 Vali Acc: 0.490 Test Loss: 1.718 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4662401676177979
Epoch: 20, Steps: 20 | Train Loss: 0.048 Vali Loss: 1.337 Vali Acc: 0.550 Test Loss: 1.337 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.488950490951538
Epoch: 21, Steps: 20 | Train Loss: 0.068 Vali Loss: 1.625 Vali Acc: 0.520 Test Loss: 1.625 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 2389250
model size : 9.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.6747634410858154
Epoch: 1, Steps: 20 | Train Loss: 0.817 Vali Loss: 0.872 Vali Acc: 0.540 Test Loss: 0.872 Test Acc: 0.540
Validation loss decreased (inf --> -0.539991).  Saving model ...
Epoch: 2 cost time: 1.509047508239746
Epoch: 2, Steps: 20 | Train Loss: 0.992 Vali Loss: 1.445 Vali Acc: 0.490 Test Loss: 1.445 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7160074710845947
Epoch: 3, Steps: 20 | Train Loss: 1.089 Vali Loss: 1.276 Vali Acc: 0.550 Test Loss: 1.276 Test Acc: 0.550
Validation loss decreased (-0.539991 --> -0.549987).  Saving model ...
Epoch: 4 cost time: 1.6583523750305176
Epoch: 4, Steps: 20 | Train Loss: 0.710 Vali Loss: 1.243 Vali Acc: 0.530 Test Loss: 1.243 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7255702018737793
Epoch: 5, Steps: 20 | Train Loss: 0.800 Vali Loss: 1.407 Vali Acc: 0.450 Test Loss: 1.407 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5565862655639648
Epoch: 6, Steps: 20 | Train Loss: 0.992 Vali Loss: 2.600 Vali Acc: 0.460 Test Loss: 2.600 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.815725326538086
Epoch: 7, Steps: 20 | Train Loss: 1.058 Vali Loss: 1.472 Vali Acc: 0.580 Test Loss: 1.472 Test Acc: 0.580
Validation loss decreased (-0.549987 --> -0.579985).  Saving model ...
Epoch: 8 cost time: 1.5515079498291016
Epoch: 8, Steps: 20 | Train Loss: 0.784 Vali Loss: 1.945 Vali Acc: 0.510 Test Loss: 1.945 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8505570888519287
Epoch: 9, Steps: 20 | Train Loss: 1.216 Vali Loss: 2.523 Vali Acc: 0.630 Test Loss: 2.523 Test Acc: 0.630
Validation loss decreased (-0.579985 --> -0.629975).  Saving model ...
Epoch: 10 cost time: 1.6693134307861328
Epoch: 10, Steps: 20 | Train Loss: 0.865 Vali Loss: 1.482 Vali Acc: 0.530 Test Loss: 1.482 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.468658685684204
Epoch: 11, Steps: 20 | Train Loss: 0.745 Vali Loss: 1.661 Vali Acc: 0.610 Test Loss: 1.661 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5017976760864258
Epoch: 12, Steps: 20 | Train Loss: 0.720 Vali Loss: 1.565 Vali Acc: 0.650 Test Loss: 1.565 Test Acc: 0.650
Validation loss decreased (-0.629975 --> -0.649984).  Saving model ...
Epoch: 13 cost time: 1.4963061809539795
Epoch: 13, Steps: 20 | Train Loss: 0.542 Vali Loss: 2.127 Vali Acc: 0.540 Test Loss: 2.127 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6724109649658203
Epoch: 14, Steps: 20 | Train Loss: 0.366 Vali Loss: 2.261 Vali Acc: 0.590 Test Loss: 2.261 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.794064998626709
Epoch: 15, Steps: 20 | Train Loss: 0.426 Vali Loss: 1.935 Vali Acc: 0.630 Test Loss: 1.935 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8126945495605469
Epoch: 16, Steps: 20 | Train Loss: 0.666 Vali Loss: 2.414 Vali Acc: 0.550 Test Loss: 2.414 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.596888542175293
Epoch: 17, Steps: 20 | Train Loss: 0.576 Vali Loss: 2.962 Vali Acc: 0.540 Test Loss: 2.962 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8614377975463867
Epoch: 18, Steps: 20 | Train Loss: 0.847 Vali Loss: 3.697 Vali Acc: 0.460 Test Loss: 3.697 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.705599069595337
Epoch: 19, Steps: 20 | Train Loss: 0.423 Vali Loss: 2.396 Vali Acc: 0.530 Test Loss: 2.396 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6716842651367188
Epoch: 20, Steps: 20 | Train Loss: 0.261 Vali Loss: 1.871 Vali Acc: 0.630 Test Loss: 1.871 Test Acc: 0.630
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1968493461608887
Epoch: 21, Steps: 20 | Train Loss: 0.172 Vali Loss: 2.190 Vali Acc: 0.620 Test Loss: 2.190 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1468918323516846
Epoch: 22, Steps: 20 | Train Loss: 0.242 Vali Loss: 2.335 Vali Acc: 0.570 Test Loss: 2.335 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 889282
model size : 3.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7298402786254883
Epoch: 1, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.785 Vali Acc: 0.540 Test Loss: 0.785 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 1.5173015594482422
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.825 Vali Acc: 0.560 Test Loss: 0.825 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559992).  Saving model ...
Epoch: 3 cost time: 1.598463773727417
Epoch: 3, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.791 Vali Acc: 0.580 Test Loss: 0.791 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579992).  Saving model ...
Epoch: 4 cost time: 1.5699245929718018
Epoch: 4, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.865 Vali Acc: 0.550 Test Loss: 0.865 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3592250347137451
Epoch: 5, Steps: 20 | Train Loss: 0.610 Vali Loss: 2.207 Vali Acc: 0.500 Test Loss: 2.207 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0950605869293213
Epoch: 6, Steps: 20 | Train Loss: 0.961 Vali Loss: 1.106 Vali Acc: 0.580 Test Loss: 1.106 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.494753360748291
Epoch: 7, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.892 Vali Acc: 0.540 Test Loss: 0.892 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6712546348571777
Epoch: 8, Steps: 20 | Train Loss: 0.518 Vali Loss: 1.115 Vali Acc: 0.480 Test Loss: 1.115 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8273289203643799
Epoch: 9, Steps: 20 | Train Loss: 0.459 Vali Loss: 1.076 Vali Acc: 0.610 Test Loss: 1.076 Test Acc: 0.610
Validation loss decreased (-0.579992 --> -0.609989).  Saving model ...
Epoch: 10 cost time: 1.4949097633361816
Epoch: 10, Steps: 20 | Train Loss: 0.361 Vali Loss: 1.726 Vali Acc: 0.570 Test Loss: 1.726 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6867046356201172
Epoch: 11, Steps: 20 | Train Loss: 0.363 Vali Loss: 1.161 Vali Acc: 0.590 Test Loss: 1.161 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7210078239440918
Epoch: 12, Steps: 20 | Train Loss: 0.327 Vali Loss: 1.335 Vali Acc: 0.570 Test Loss: 1.335 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4451510906219482
Epoch: 13, Steps: 20 | Train Loss: 0.297 Vali Loss: 1.126 Vali Acc: 0.590 Test Loss: 1.126 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4938719272613525
Epoch: 14, Steps: 20 | Train Loss: 0.292 Vali Loss: 1.722 Vali Acc: 0.530 Test Loss: 1.722 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6279184818267822
Epoch: 15, Steps: 20 | Train Loss: 0.355 Vali Loss: 1.389 Vali Acc: 0.580 Test Loss: 1.389 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5247161388397217
Epoch: 16, Steps: 20 | Train Loss: 0.189 Vali Loss: 1.605 Vali Acc: 0.540 Test Loss: 1.605 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2006514072418213
Epoch: 17, Steps: 20 | Train Loss: 0.410 Vali Loss: 2.142 Vali Acc: 0.570 Test Loss: 2.142 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4682259559631348
Epoch: 18, Steps: 20 | Train Loss: 0.291 Vali Loss: 1.620 Vali Acc: 0.560 Test Loss: 1.620 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5232212543487549
Epoch: 19, Steps: 20 | Train Loss: 0.209 Vali Loss: 1.798 Vali Acc: 0.560 Test Loss: 1.798 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 799746
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.677985429763794
Epoch: 1, Steps: 20 | Train Loss: 0.781 Vali Loss: 1.025 Vali Acc: 0.500 Test Loss: 1.025 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 1.6842598915100098
Epoch: 2, Steps: 20 | Train Loss: 0.907 Vali Loss: 1.315 Vali Acc: 0.510 Test Loss: 1.315 Test Acc: 0.510
Validation loss decreased (-0.499990 --> -0.509987).  Saving model ...
Epoch: 3 cost time: 1.5453665256500244
Epoch: 3, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.774 Vali Acc: 0.540 Test Loss: 0.774 Test Acc: 0.540
Validation loss decreased (-0.509987 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 1.2185006141662598
Epoch: 4, Steps: 20 | Train Loss: 0.619 Vali Loss: 1.013 Vali Acc: 0.510 Test Loss: 1.013 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2168121337890625
Epoch: 5, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.896 Vali Acc: 0.570 Test Loss: 0.896 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569991).  Saving model ...
Epoch: 6 cost time: 1.392984390258789
Epoch: 6, Steps: 20 | Train Loss: 0.486 Vali Loss: 1.213 Vali Acc: 0.520 Test Loss: 1.213 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5344524383544922
Epoch: 7, Steps: 20 | Train Loss: 0.672 Vali Loss: 1.160 Vali Acc: 0.520 Test Loss: 1.160 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.262401819229126
Epoch: 8, Steps: 20 | Train Loss: 0.398 Vali Loss: 1.111 Vali Acc: 0.520 Test Loss: 1.111 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.210190773010254
Epoch: 9, Steps: 20 | Train Loss: 0.448 Vali Loss: 1.203 Vali Acc: 0.570 Test Loss: 1.203 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1727309226989746
Epoch: 10, Steps: 20 | Train Loss: 0.366 Vali Loss: 1.172 Vali Acc: 0.610 Test Loss: 1.172 Test Acc: 0.610
Validation loss decreased (-0.569991 --> -0.609988).  Saving model ...
Epoch: 11 cost time: 1.242725133895874
Epoch: 11, Steps: 20 | Train Loss: 0.381 Vali Loss: 1.901 Vali Acc: 0.590 Test Loss: 1.901 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2703800201416016
Epoch: 12, Steps: 20 | Train Loss: 0.506 Vali Loss: 1.527 Vali Acc: 0.560 Test Loss: 1.527 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.500687837600708
Epoch: 13, Steps: 20 | Train Loss: 0.401 Vali Loss: 1.620 Vali Acc: 0.550 Test Loss: 1.620 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3028786182403564
Epoch: 14, Steps: 20 | Train Loss: 0.237 Vali Loss: 1.460 Vali Acc: 0.590 Test Loss: 1.460 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.328521490097046
Epoch: 15, Steps: 20 | Train Loss: 0.138 Vali Loss: 1.810 Vali Acc: 0.520 Test Loss: 1.810 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5164384841918945
Epoch: 16, Steps: 20 | Train Loss: 0.204 Vali Loss: 1.752 Vali Acc: 0.570 Test Loss: 1.752 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.590837001800537
Epoch: 17, Steps: 20 | Train Loss: 0.203 Vali Loss: 1.833 Vali Acc: 0.540 Test Loss: 1.833 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6598172187805176
Epoch: 18, Steps: 20 | Train Loss: 0.323 Vali Loss: 2.775 Vali Acc: 0.540 Test Loss: 2.775 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5172398090362549
Epoch: 19, Steps: 20 | Train Loss: 0.194 Vali Loss: 1.899 Vali Acc: 0.610 Test Loss: 1.899 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.654026985168457
Epoch: 20, Steps: 20 | Train Loss: 0.103 Vali Loss: 1.877 Vali Acc: 0.560 Test Loss: 1.877 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 799810
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.5966103076934814
Epoch: 1, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.696 Vali Acc: 0.520 Test Loss: 0.696 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.135849952697754
Epoch: 2, Steps: 20 | Train Loss: 0.783 Vali Loss: 0.928 Vali Acc: 0.540 Test Loss: 0.928 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539991).  Saving model ...
Epoch: 3 cost time: 1.2563855648040771
Epoch: 3, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.886 Vali Acc: 0.520 Test Loss: 0.886 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5034868717193604
Epoch: 4, Steps: 20 | Train Loss: 0.695 Vali Loss: 1.043 Vali Acc: 0.510 Test Loss: 1.043 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3807594776153564
Epoch: 5, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.829 Vali Acc: 0.580 Test Loss: 0.829 Test Acc: 0.580
Validation loss decreased (-0.539991 --> -0.579992).  Saving model ...
Epoch: 6 cost time: 1.5429470539093018
Epoch: 6, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.928 Vali Acc: 0.550 Test Loss: 0.928 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5420966148376465
Epoch: 7, Steps: 20 | Train Loss: 0.429 Vali Loss: 0.927 Vali Acc: 0.580 Test Loss: 0.927 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.626546859741211
Epoch: 8, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.882 Vali Acc: 0.580 Test Loss: 0.882 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0786027908325195
Epoch: 9, Steps: 20 | Train Loss: 0.380 Vali Loss: 1.133 Vali Acc: 0.550 Test Loss: 1.133 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6204612255096436
Epoch: 10, Steps: 20 | Train Loss: 0.338 Vali Loss: 1.216 Vali Acc: 0.580 Test Loss: 1.216 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3647000789642334
Epoch: 11, Steps: 20 | Train Loss: 0.298 Vali Loss: 1.043 Vali Acc: 0.590 Test Loss: 1.043 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589990).  Saving model ...
Epoch: 12 cost time: 1.375458002090454
Epoch: 12, Steps: 20 | Train Loss: 0.253 Vali Loss: 1.144 Vali Acc: 0.550 Test Loss: 1.144 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.554495096206665
Epoch: 13, Steps: 20 | Train Loss: 0.255 Vali Loss: 1.120 Vali Acc: 0.540 Test Loss: 1.120 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3800106048583984
Epoch: 14, Steps: 20 | Train Loss: 0.235 Vali Loss: 1.161 Vali Acc: 0.570 Test Loss: 1.161 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8581068515777588
Epoch: 15, Steps: 20 | Train Loss: 0.228 Vali Loss: 1.787 Vali Acc: 0.560 Test Loss: 1.787 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5729436874389648
Epoch: 16, Steps: 20 | Train Loss: 0.168 Vali Loss: 1.245 Vali Acc: 0.560 Test Loss: 1.245 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5685174465179443
Epoch: 17, Steps: 20 | Train Loss: 0.221 Vali Loss: 1.576 Vali Acc: 0.510 Test Loss: 1.576 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5643091201782227
Epoch: 18, Steps: 20 | Train Loss: 0.154 Vali Loss: 1.509 Vali Acc: 0.550 Test Loss: 1.509 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5302183628082275
Epoch: 19, Steps: 20 | Train Loss: 0.105 Vali Loss: 1.640 Vali Acc: 0.530 Test Loss: 1.640 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7786781787872314
Epoch: 20, Steps: 20 | Train Loss: 0.152 Vali Loss: 1.346 Vali Acc: 0.620 Test Loss: 1.346 Test Acc: 0.620
Validation loss decreased (-0.589990 --> -0.619987).  Saving model ...
Epoch: 21 cost time: 1.504450798034668
Epoch: 21, Steps: 20 | Train Loss: 0.106 Vali Loss: 1.496 Vali Acc: 0.530 Test Loss: 1.496 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6800713539123535
Epoch: 22, Steps: 20 | Train Loss: 0.061 Vali Loss: 1.584 Vali Acc: 0.620 Test Loss: 1.584 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3094499111175537
Epoch: 23, Steps: 20 | Train Loss: 0.068 Vali Loss: 2.516 Vali Acc: 0.510 Test Loss: 2.516 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6146516799926758
Epoch: 24, Steps: 20 | Train Loss: 0.048 Vali Loss: 1.970 Vali Acc: 0.530 Test Loss: 1.970 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4122109413146973
Epoch: 25, Steps: 20 | Train Loss: 0.049 Vali Loss: 2.228 Vali Acc: 0.550 Test Loss: 2.228 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6539273262023926
Epoch: 26, Steps: 20 | Train Loss: 0.051 Vali Loss: 2.028 Vali Acc: 0.570 Test Loss: 2.028 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.649606704711914
Epoch: 27, Steps: 20 | Train Loss: 0.090 Vali Loss: 2.708 Vali Acc: 0.560 Test Loss: 2.708 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5341753959655762
Epoch: 28, Steps: 20 | Train Loss: 0.029 Vali Loss: 2.076 Vali Acc: 0.530 Test Loss: 2.076 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.32871675491333
Epoch: 29, Steps: 20 | Train Loss: 0.013 Vali Loss: 2.481 Vali Acc: 0.520 Test Loss: 2.481 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.4224023818969727
Epoch: 30, Steps: 20 | Train Loss: 0.010 Vali Loss: 2.366 Vali Acc: 0.540 Test Loss: 2.366 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 767618
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.5722219944000244
Epoch: 1, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.787 Vali Acc: 0.430 Test Loss: 0.787 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 1.669947862625122
Epoch: 2, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.818 Vali Acc: 0.540 Test Loss: 0.818 Test Acc: 0.540
Validation loss decreased (-0.429992 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 1.5409824848175049
Epoch: 3, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.750 Vali Acc: 0.530 Test Loss: 0.750 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5936284065246582
Epoch: 4, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.804 Vali Acc: 0.520 Test Loss: 0.804 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5070266723632812
Epoch: 5, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.794 Vali Acc: 0.570 Test Loss: 0.794 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569992).  Saving model ...
Epoch: 6 cost time: 1.4423141479492188
Epoch: 6, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.982 Vali Acc: 0.520 Test Loss: 0.982 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6310217380523682
Epoch: 7, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.765 Vali Acc: 0.560 Test Loss: 0.765 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6251108646392822
Epoch: 8, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.813 Vali Acc: 0.580 Test Loss: 0.813 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579992).  Saving model ...
Epoch: 9 cost time: 1.6615447998046875
Epoch: 9, Steps: 20 | Train Loss: 0.392 Vali Loss: 0.861 Vali Acc: 0.580 Test Loss: 0.861 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3217799663543701
Epoch: 10, Steps: 20 | Train Loss: 0.403 Vali Loss: 0.981 Vali Acc: 0.600 Test Loss: 0.981 Test Acc: 0.600
Validation loss decreased (-0.579992 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 1.4168529510498047
Epoch: 11, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.131 Vali Acc: 0.520 Test Loss: 1.131 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3401432037353516
Epoch: 12, Steps: 20 | Train Loss: 0.346 Vali Loss: 1.028 Vali Acc: 0.490 Test Loss: 1.028 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5903620719909668
Epoch: 13, Steps: 20 | Train Loss: 0.270 Vali Loss: 1.102 Vali Acc: 0.570 Test Loss: 1.102 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5125279426574707
Epoch: 14, Steps: 20 | Train Loss: 0.270 Vali Loss: 0.983 Vali Acc: 0.580 Test Loss: 0.983 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5308496952056885
Epoch: 15, Steps: 20 | Train Loss: 0.228 Vali Loss: 1.220 Vali Acc: 0.570 Test Loss: 1.220 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.57242751121521
Epoch: 16, Steps: 20 | Train Loss: 0.225 Vali Loss: 1.126 Vali Acc: 0.580 Test Loss: 1.126 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5551838874816895
Epoch: 17, Steps: 20 | Train Loss: 0.162 Vali Loss: 1.301 Vali Acc: 0.500 Test Loss: 1.301 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8376343250274658
Epoch: 18, Steps: 20 | Train Loss: 0.188 Vali Loss: 1.678 Vali Acc: 0.470 Test Loss: 1.678 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5493996143341064
Epoch: 19, Steps: 20 | Train Loss: 0.138 Vali Loss: 1.198 Vali Acc: 0.600 Test Loss: 1.198 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6101064682006836
Epoch: 20, Steps: 20 | Train Loss: 0.132 Vali Loss: 1.255 Vali Acc: 0.570 Test Loss: 1.255 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 753474
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8406789302825928
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.710 Vali Acc: 0.510 Test Loss: 0.710 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.4869415760040283
Epoch: 2, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.796 Vali Acc: 0.470 Test Loss: 0.796 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1410462856292725
Epoch: 3, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.896 Vali Acc: 0.440 Test Loss: 0.896 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2084009647369385
Epoch: 4, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.768 Vali Acc: 0.580 Test Loss: 0.768 Test Acc: 0.580
Validation loss decreased (-0.509993 --> -0.579992).  Saving model ...
Epoch: 5 cost time: 1.1640005111694336
Epoch: 5, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.823 Vali Acc: 0.540 Test Loss: 0.823 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3579258918762207
Epoch: 6, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.815 Vali Acc: 0.590 Test Loss: 0.815 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589992).  Saving model ...
Epoch: 7 cost time: 1.3779387474060059
Epoch: 7, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.936 Vali Acc: 0.560 Test Loss: 0.936 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5034358501434326
Epoch: 8, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.811 Vali Acc: 0.590 Test Loss: 0.811 Test Acc: 0.590
Validation loss decreased (-0.589992 --> -0.589992).  Saving model ...
Epoch: 9 cost time: 1.3742566108703613
Epoch: 9, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.974 Vali Acc: 0.540 Test Loss: 0.974 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6666719913482666
Epoch: 10, Steps: 20 | Train Loss: 0.482 Vali Loss: 1.168 Vali Acc: 0.490 Test Loss: 1.168 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7164509296417236
Epoch: 11, Steps: 20 | Train Loss: 0.389 Vali Loss: 0.904 Vali Acc: 0.570 Test Loss: 0.904 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3697326183319092
Epoch: 12, Steps: 20 | Train Loss: 0.372 Vali Loss: 0.916 Vali Acc: 0.570 Test Loss: 0.916 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4997472763061523
Epoch: 13, Steps: 20 | Train Loss: 0.310 Vali Loss: 0.908 Vali Acc: 0.530 Test Loss: 0.908 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4793949127197266
Epoch: 14, Steps: 20 | Train Loss: 0.260 Vali Loss: 0.947 Vali Acc: 0.550 Test Loss: 0.947 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.29780912399292
Epoch: 15, Steps: 20 | Train Loss: 0.256 Vali Loss: 1.077 Vali Acc: 0.570 Test Loss: 1.077 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7067067623138428
Epoch: 16, Steps: 20 | Train Loss: 0.232 Vali Loss: 1.097 Vali Acc: 0.570 Test Loss: 1.097 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4585521221160889
Epoch: 17, Steps: 20 | Train Loss: 0.219 Vali Loss: 1.110 Vali Acc: 0.600 Test Loss: 1.110 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599989).  Saving model ...
Epoch: 18 cost time: 1.788893461227417
Epoch: 18, Steps: 20 | Train Loss: 0.203 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.514131784439087
Epoch: 19, Steps: 20 | Train Loss: 0.168 Vali Loss: 1.537 Vali Acc: 0.530 Test Loss: 1.537 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.671295404434204
Epoch: 20, Steps: 20 | Train Loss: 0.130 Vali Loss: 1.270 Vali Acc: 0.570 Test Loss: 1.270 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7262225151062012
Epoch: 21, Steps: 20 | Train Loss: 0.096 Vali Loss: 1.284 Vali Acc: 0.560 Test Loss: 1.284 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5549190044403076
Epoch: 22, Steps: 20 | Train Loss: 0.082 Vali Loss: 1.428 Vali Acc: 0.540 Test Loss: 1.428 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6352181434631348
Epoch: 23, Steps: 20 | Train Loss: 0.073 Vali Loss: 1.628 Vali Acc: 0.560 Test Loss: 1.628 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2732927799224854
Epoch: 24, Steps: 20 | Train Loss: 0.066 Vali Loss: 1.441 Vali Acc: 0.540 Test Loss: 1.441 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4177629947662354
Epoch: 25, Steps: 20 | Train Loss: 0.036 Vali Loss: 1.643 Vali Acc: 0.550 Test Loss: 1.643 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3991563320159912
Epoch: 26, Steps: 20 | Train Loss: 0.031 Vali Loss: 1.627 Vali Acc: 0.520 Test Loss: 1.627 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.4912519454956055
Epoch: 27, Steps: 20 | Train Loss: 0.026 Vali Loss: 1.573 Vali Acc: 0.580 Test Loss: 1.573 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 746434
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3781230449676514
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.698 Vali Acc: 0.550 Test Loss: 0.698 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.1667063236236572
Epoch: 2, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.743 Vali Acc: 0.510 Test Loss: 0.743 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2525596618652344
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.842 Vali Acc: 0.510 Test Loss: 0.842 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3658132553100586
Epoch: 4, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.751 Vali Acc: 0.550 Test Loss: 0.751 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2680435180664062
Epoch: 5, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.728 Vali Acc: 0.570 Test Loss: 0.728 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 6 cost time: 1.3330292701721191
Epoch: 6, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.774 Vali Acc: 0.590 Test Loss: 0.774 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589992).  Saving model ...
Epoch: 7 cost time: 1.2785696983337402
Epoch: 7, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.790 Vali Acc: 0.580 Test Loss: 0.790 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1963698863983154
Epoch: 8, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.807 Vali Acc: 0.570 Test Loss: 0.807 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1530885696411133
Epoch: 9, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.934 Vali Acc: 0.520 Test Loss: 0.934 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4215567111968994
Epoch: 10, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.879 Vali Acc: 0.510 Test Loss: 0.879 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.521111249923706
Epoch: 11, Steps: 20 | Train Loss: 0.390 Vali Loss: 0.871 Vali Acc: 0.520 Test Loss: 0.871 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.506831407546997
Epoch: 12, Steps: 20 | Train Loss: 0.354 Vali Loss: 0.994 Vali Acc: 0.520 Test Loss: 0.994 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5311813354492188
Epoch: 13, Steps: 20 | Train Loss: 0.334 Vali Loss: 1.091 Vali Acc: 0.550 Test Loss: 1.091 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.27646803855896
Epoch: 14, Steps: 20 | Train Loss: 0.295 Vali Loss: 0.915 Vali Acc: 0.560 Test Loss: 0.915 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.375378131866455
Epoch: 15, Steps: 20 | Train Loss: 0.258 Vali Loss: 1.038 Vali Acc: 0.520 Test Loss: 1.038 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6780598163604736
Epoch: 16, Steps: 20 | Train Loss: 0.248 Vali Loss: 1.141 Vali Acc: 0.480 Test Loss: 1.141 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 735874
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2425687313079834
Epoch: 1, Steps: 20 | Train Loss: 0.764 Vali Loss: 0.760 Vali Acc: 0.520 Test Loss: 0.760 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 1.532576560974121
Epoch: 2, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.867 Vali Acc: 0.530 Test Loss: 0.867 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529991).  Saving model ...
Epoch: 3 cost time: 1.318549633026123
Epoch: 3, Steps: 20 | Train Loss: 0.917 Vali Loss: 1.129 Vali Acc: 0.560 Test Loss: 1.129 Test Acc: 0.560
Validation loss decreased (-0.529991 --> -0.559989).  Saving model ...
Epoch: 4 cost time: 1.3307862281799316
Epoch: 4, Steps: 20 | Train Loss: 0.772 Vali Loss: 1.315 Vali Acc: 0.480 Test Loss: 1.315 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2806477546691895
Epoch: 5, Steps: 20 | Train Loss: 0.868 Vali Loss: 0.940 Vali Acc: 0.530 Test Loss: 0.940 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.275836706161499
Epoch: 6, Steps: 20 | Train Loss: 0.856 Vali Loss: 1.493 Vali Acc: 0.530 Test Loss: 1.493 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8076391220092773
Epoch: 7, Steps: 20 | Train Loss: 0.901 Vali Loss: 1.021 Vali Acc: 0.560 Test Loss: 1.021 Test Acc: 0.560
Validation loss decreased (-0.559989 --> -0.559990).  Saving model ...
Epoch: 8 cost time: 1.3416345119476318
Epoch: 8, Steps: 20 | Train Loss: 0.627 Vali Loss: 1.272 Vali Acc: 0.540 Test Loss: 1.272 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5637130737304688
Epoch: 9, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.990 Vali Acc: 0.550 Test Loss: 0.990 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4074573516845703
Epoch: 10, Steps: 20 | Train Loss: 0.661 Vali Loss: 1.186 Vali Acc: 0.590 Test Loss: 1.186 Test Acc: 0.590
Validation loss decreased (-0.559990 --> -0.589988).  Saving model ...
Epoch: 11 cost time: 1.4321677684783936
Epoch: 11, Steps: 20 | Train Loss: 0.529 Vali Loss: 1.149 Vali Acc: 0.520 Test Loss: 1.149 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4063928127288818
Epoch: 12, Steps: 20 | Train Loss: 0.481 Vali Loss: 1.260 Vali Acc: 0.590 Test Loss: 1.260 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3988747596740723
Epoch: 13, Steps: 20 | Train Loss: 0.527 Vali Loss: 1.260 Vali Acc: 0.560 Test Loss: 1.260 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1887822151184082
Epoch: 14, Steps: 20 | Train Loss: 0.418 Vali Loss: 1.763 Vali Acc: 0.500 Test Loss: 1.763 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2725389003753662
Epoch: 15, Steps: 20 | Train Loss: 0.528 Vali Loss: 1.700 Vali Acc: 0.590 Test Loss: 1.700 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3387250900268555
Epoch: 16, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.421 Vali Acc: 0.550 Test Loss: 1.421 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5242681503295898
Epoch: 17, Steps: 20 | Train Loss: 0.253 Vali Loss: 1.445 Vali Acc: 0.570 Test Loss: 1.445 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5128247737884521
Epoch: 18, Steps: 20 | Train Loss: 0.435 Vali Loss: 1.615 Vali Acc: 0.530 Test Loss: 1.615 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5263285636901855
Epoch: 19, Steps: 20 | Train Loss: 0.228 Vali Loss: 1.537 Vali Acc: 0.560 Test Loss: 1.537 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2375295162200928
Epoch: 20, Steps: 20 | Train Loss: 0.238 Vali Loss: 2.006 Vali Acc: 0.540 Test Loss: 2.006 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 329954
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.009866952896118
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.684 Vali Acc: 0.610 Test Loss: 0.684 Test Acc: 0.610
Validation loss decreased (inf --> -0.609993).  Saving model ...
Epoch: 2 cost time: 1.6104846000671387
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.754 Vali Acc: 0.490 Test Loss: 0.754 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5967161655426025
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.755 Vali Acc: 0.530 Test Loss: 0.755 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.58001708984375
Epoch: 4, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.842 Vali Acc: 0.460 Test Loss: 0.842 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7641513347625732
Epoch: 5, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.784 Vali Acc: 0.530 Test Loss: 0.784 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7504394054412842
Epoch: 6, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.757 Vali Acc: 0.590 Test Loss: 0.757 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5625178813934326
Epoch: 7, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.750 Vali Acc: 0.640 Test Loss: 0.750 Test Acc: 0.640
Validation loss decreased (-0.609993 --> -0.639992).  Saving model ...
Epoch: 8 cost time: 1.369767427444458
Epoch: 8, Steps: 20 | Train Loss: 0.391 Vali Loss: 0.821 Vali Acc: 0.590 Test Loss: 0.821 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4279606342315674
Epoch: 9, Steps: 20 | Train Loss: 0.376 Vali Loss: 0.774 Vali Acc: 0.620 Test Loss: 0.774 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.558321237564087
Epoch: 10, Steps: 20 | Train Loss: 0.391 Vali Loss: 0.907 Vali Acc: 0.580 Test Loss: 0.907 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3195562362670898
Epoch: 11, Steps: 20 | Train Loss: 0.429 Vali Loss: 1.017 Vali Acc: 0.520 Test Loss: 1.017 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5196104049682617
Epoch: 12, Steps: 20 | Train Loss: 0.402 Vali Loss: 1.224 Vali Acc: 0.540 Test Loss: 1.224 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.462339162826538
Epoch: 13, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.495 Vali Acc: 0.570 Test Loss: 1.495 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5112245082855225
Epoch: 14, Steps: 20 | Train Loss: 0.417 Vali Loss: 1.059 Vali Acc: 0.560 Test Loss: 1.059 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4701955318450928
Epoch: 15, Steps: 20 | Train Loss: 0.243 Vali Loss: 1.057 Vali Acc: 0.580 Test Loss: 1.057 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.64552640914917
Epoch: 16, Steps: 20 | Train Loss: 0.293 Vali Loss: 1.330 Vali Acc: 0.590 Test Loss: 1.330 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5496540069580078
Epoch: 17, Steps: 20 | Train Loss: 0.214 Vali Loss: 1.101 Vali Acc: 0.610 Test Loss: 1.101 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 285186
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.148678779602051
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.775 Vali Acc: 0.430 Test Loss: 0.775 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 1.5039420127868652
Epoch: 2, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.696 Vali Acc: 0.550 Test Loss: 0.696 Test Acc: 0.550
Validation loss decreased (-0.429992 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.613274335861206
Epoch: 3, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.727 Vali Acc: 0.560 Test Loss: 0.727 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 1.4180781841278076
Epoch: 4, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.720 Vali Acc: 0.590 Test Loss: 0.720 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 5 cost time: 1.3052287101745605
Epoch: 5, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.805 Vali Acc: 0.660 Test Loss: 0.805 Test Acc: 0.660
Validation loss decreased (-0.589993 --> -0.659992).  Saving model ...
Epoch: 6 cost time: 1.4034216403961182
Epoch: 6, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.806 Vali Acc: 0.530 Test Loss: 0.806 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.414844036102295
Epoch: 7, Steps: 20 | Train Loss: 0.613 Vali Loss: 1.104 Vali Acc: 0.530 Test Loss: 1.104 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5993034839630127
Epoch: 8, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.816 Vali Acc: 0.640 Test Loss: 0.816 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.152604341506958
Epoch: 9, Steps: 20 | Train Loss: 0.482 Vali Loss: 1.247 Vali Acc: 0.510 Test Loss: 1.247 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.456357479095459
Epoch: 10, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.934 Vali Acc: 0.580 Test Loss: 0.934 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.485464334487915
Epoch: 11, Steps: 20 | Train Loss: 0.367 Vali Loss: 0.919 Vali Acc: 0.580 Test Loss: 0.919 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4530956745147705
Epoch: 12, Steps: 20 | Train Loss: 0.335 Vali Loss: 1.030 Vali Acc: 0.600 Test Loss: 1.030 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5638890266418457
Epoch: 13, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.293 Vali Acc: 0.530 Test Loss: 1.293 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.137162446975708
Epoch: 14, Steps: 20 | Train Loss: 0.294 Vali Loss: 1.519 Vali Acc: 0.550 Test Loss: 1.519 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5098373889923096
Epoch: 15, Steps: 20 | Train Loss: 0.322 Vali Loss: 1.318 Vali Acc: 0.510 Test Loss: 1.318 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 285218
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.255711078643799
Epoch: 1, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.688 Vali Acc: 0.550 Test Loss: 0.688 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.3819940090179443
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.800 Vali Acc: 0.470 Test Loss: 0.800 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4697668552398682
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.731 Vali Acc: 0.510 Test Loss: 0.731 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4131739139556885
Epoch: 4, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.790 Vali Acc: 0.500 Test Loss: 0.790 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0375595092773438
Epoch: 5, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.724 Vali Acc: 0.570 Test Loss: 0.724 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 6 cost time: 1.0051906108856201
Epoch: 6, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.746 Vali Acc: 0.590 Test Loss: 0.746 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589993).  Saving model ...
Epoch: 7 cost time: 1.2080316543579102
Epoch: 7, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.723 Vali Acc: 0.620 Test Loss: 0.723 Test Acc: 0.620
Validation loss decreased (-0.589993 --> -0.619993).  Saving model ...
Epoch: 8 cost time: 1.3443560600280762
Epoch: 8, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.949 Vali Acc: 0.520 Test Loss: 0.949 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3547680377960205
Epoch: 9, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.886 Vali Acc: 0.490 Test Loss: 0.886 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6228599548339844
Epoch: 10, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.939 Vali Acc: 0.570 Test Loss: 0.939 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5496137142181396
Epoch: 11, Steps: 20 | Train Loss: 0.373 Vali Loss: 0.954 Vali Acc: 0.590 Test Loss: 0.954 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4538688659667969
Epoch: 12, Steps: 20 | Train Loss: 0.426 Vali Loss: 0.855 Vali Acc: 0.590 Test Loss: 0.855 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3982837200164795
Epoch: 13, Steps: 20 | Train Loss: 0.375 Vali Loss: 1.064 Vali Acc: 0.600 Test Loss: 1.064 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4596145153045654
Epoch: 14, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.883 Vali Acc: 0.660 Test Loss: 0.883 Test Acc: 0.660
Validation loss decreased (-0.619993 --> -0.659991).  Saving model ...
Epoch: 15 cost time: 1.4261057376861572
Epoch: 15, Steps: 20 | Train Loss: 0.354 Vali Loss: 0.911 Vali Acc: 0.620 Test Loss: 0.911 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5192599296569824
Epoch: 16, Steps: 20 | Train Loss: 0.311 Vali Loss: 1.120 Vali Acc: 0.560 Test Loss: 1.120 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3049423694610596
Epoch: 17, Steps: 20 | Train Loss: 0.261 Vali Loss: 1.356 Vali Acc: 0.540 Test Loss: 1.356 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3956577777862549
Epoch: 18, Steps: 20 | Train Loss: 0.233 Vali Loss: 1.233 Vali Acc: 0.540 Test Loss: 1.233 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.346498727798462
Epoch: 19, Steps: 20 | Train Loss: 0.205 Vali Loss: 1.401 Vali Acc: 0.560 Test Loss: 1.401 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.463531494140625
Epoch: 20, Steps: 20 | Train Loss: 0.248 Vali Loss: 1.158 Vali Acc: 0.570 Test Loss: 1.158 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4222602844238281
Epoch: 21, Steps: 20 | Train Loss: 0.165 Vali Loss: 1.365 Vali Acc: 0.540 Test Loss: 1.365 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.507096529006958
Epoch: 22, Steps: 20 | Train Loss: 0.179 Vali Loss: 1.042 Vali Acc: 0.560 Test Loss: 1.042 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.381317138671875
Epoch: 23, Steps: 20 | Train Loss: 0.153 Vali Loss: 1.246 Vali Acc: 0.520 Test Loss: 1.246 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4359183311462402
Epoch: 24, Steps: 20 | Train Loss: 0.120 Vali Loss: 1.229 Vali Acc: 0.570 Test Loss: 1.229 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 269122
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.1688010692596436
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.788 Vali Acc: 0.430 Test Loss: 0.788 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 1.3063709735870361
Epoch: 2, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.758 Vali Acc: 0.430 Test Loss: 0.758 Test Acc: 0.430
Validation loss decreased (-0.429992 --> -0.429992).  Saving model ...
Epoch: 3 cost time: 1.4205412864685059
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.849 Vali Acc: 0.480 Test Loss: 0.849 Test Acc: 0.480
Validation loss decreased (-0.429992 --> -0.479992).  Saving model ...
Epoch: 4 cost time: 1.2748148441314697
Epoch: 4, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.822 Vali Acc: 0.500 Test Loss: 0.822 Test Acc: 0.500
Validation loss decreased (-0.479992 --> -0.499992).  Saving model ...
Epoch: 5 cost time: 1.3896288871765137
Epoch: 5, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.756 Vali Acc: 0.450 Test Loss: 0.756 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0767138004302979
Epoch: 6, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.916 Vali Acc: 0.470 Test Loss: 0.916 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.497347354888916
Epoch: 7, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.775 Vali Acc: 0.540 Test Loss: 0.775 Test Acc: 0.540
Validation loss decreased (-0.499992 --> -0.539992).  Saving model ...
Epoch: 8 cost time: 1.3036205768585205
Epoch: 8, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.825 Vali Acc: 0.560 Test Loss: 0.825 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559992).  Saving model ...
Epoch: 9 cost time: 1.424574613571167
Epoch: 9, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.798 Vali Acc: 0.510 Test Loss: 0.798 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4173426628112793
Epoch: 10, Steps: 20 | Train Loss: 0.441 Vali Loss: 0.908 Vali Acc: 0.510 Test Loss: 0.908 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.113349199295044
Epoch: 11, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.870 Vali Acc: 0.540 Test Loss: 0.870 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3837471008300781
Epoch: 12, Steps: 20 | Train Loss: 0.360 Vali Loss: 0.849 Vali Acc: 0.550 Test Loss: 0.849 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1522936820983887
Epoch: 13, Steps: 20 | Train Loss: 0.376 Vali Loss: 0.866 Vali Acc: 0.520 Test Loss: 0.866 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4348454475402832
Epoch: 14, Steps: 20 | Train Loss: 0.320 Vali Loss: 0.876 Vali Acc: 0.540 Test Loss: 0.876 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4926400184631348
Epoch: 15, Steps: 20 | Train Loss: 0.346 Vali Loss: 1.002 Vali Acc: 0.530 Test Loss: 1.002 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1830699443817139
Epoch: 16, Steps: 20 | Train Loss: 0.279 Vali Loss: 0.968 Vali Acc: 0.510 Test Loss: 0.968 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.421931505203247
Epoch: 17, Steps: 20 | Train Loss: 0.264 Vali Loss: 1.029 Vali Acc: 0.510 Test Loss: 1.029 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3072946071624756
Epoch: 18, Steps: 20 | Train Loss: 0.219 Vali Loss: 1.007 Vali Acc: 0.550 Test Loss: 1.007 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 262050
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.078716278076172
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.742 Vali Acc: 0.490 Test Loss: 0.742 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.2401041984558105
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.750 Vali Acc: 0.510 Test Loss: 0.750 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 1.1771697998046875
Epoch: 3, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.729 Vali Acc: 0.580 Test Loss: 0.729 Test Acc: 0.580
Validation loss decreased (-0.509993 --> -0.579993).  Saving model ...
Epoch: 4 cost time: 1.428107738494873
Epoch: 4, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.732 Vali Acc: 0.520 Test Loss: 0.732 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.539945363998413
Epoch: 5, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.763 Vali Acc: 0.560 Test Loss: 0.763 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3599848747253418
Epoch: 6, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.791 Vali Acc: 0.560 Test Loss: 0.791 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3307206630706787
Epoch: 7, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.727 Vali Acc: 0.560 Test Loss: 0.727 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3690321445465088
Epoch: 8, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.790 Vali Acc: 0.550 Test Loss: 0.790 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3456192016601562
Epoch: 9, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.831 Vali Acc: 0.590 Test Loss: 0.831 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589992).  Saving model ...
Epoch: 10 cost time: 1.5881803035736084
Epoch: 10, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.718 Vali Acc: 0.610 Test Loss: 0.718 Test Acc: 0.610
Validation loss decreased (-0.589992 --> -0.609993).  Saving model ...
Epoch: 11 cost time: 1.6509888172149658
Epoch: 11, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.797 Vali Acc: 0.570 Test Loss: 0.797 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4603595733642578
Epoch: 12, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.794 Vali Acc: 0.510 Test Loss: 0.794 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3247883319854736
Epoch: 13, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.831 Vali Acc: 0.600 Test Loss: 0.831 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5841701030731201
Epoch: 14, Steps: 20 | Train Loss: 0.384 Vali Loss: 0.873 Vali Acc: 0.580 Test Loss: 0.873 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4698269367218018
Epoch: 15, Steps: 20 | Train Loss: 0.352 Vali Loss: 0.866 Vali Acc: 0.580 Test Loss: 0.866 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5997192859649658
Epoch: 16, Steps: 20 | Train Loss: 0.314 Vali Loss: 0.886 Vali Acc: 0.520 Test Loss: 0.886 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5241479873657227
Epoch: 17, Steps: 20 | Train Loss: 0.255 Vali Loss: 1.022 Vali Acc: 0.550 Test Loss: 1.022 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1409261226654053
Epoch: 18, Steps: 20 | Train Loss: 0.233 Vali Loss: 0.956 Vali Acc: 0.510 Test Loss: 0.956 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4891741275787354
Epoch: 19, Steps: 20 | Train Loss: 0.207 Vali Loss: 0.997 Vali Acc: 0.540 Test Loss: 0.997 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3364033699035645
Epoch: 20, Steps: 20 | Train Loss: 0.191 Vali Loss: 1.055 Vali Acc: 0.590 Test Loss: 1.055 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 258530
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.1476891040802
Epoch: 1, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.690 Vali Acc: 0.580 Test Loss: 0.690 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 1.322561264038086
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.722 Vali Acc: 0.510 Test Loss: 0.722 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5092341899871826
Epoch: 3, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.712 Vali Acc: 0.510 Test Loss: 0.712 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2873072624206543
Epoch: 4, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.755 Vali Acc: 0.460 Test Loss: 0.755 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6183817386627197
Epoch: 5, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3478779792785645
Epoch: 6, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.791 Vali Acc: 0.510 Test Loss: 0.791 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6176953315734863
Epoch: 7, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.743 Vali Acc: 0.520 Test Loss: 0.743 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.449540138244629
Epoch: 8, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.258744478225708
Epoch: 9, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.747 Vali Acc: 0.580 Test Loss: 0.747 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4058732986450195
Epoch: 10, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.784 Vali Acc: 0.560 Test Loss: 0.784 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1238839626312256
Epoch: 11, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.909 Vali Acc: 0.530 Test Loss: 0.909 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 253250
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.550004482269287
Epoch: 1, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.749 Vali Acc: 0.440 Test Loss: 0.749 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 2.721285343170166
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.865 Vali Acc: 0.450 Test Loss: 0.865 Test Acc: 0.450
Validation loss decreased (-0.439993 --> -0.449991).  Saving model ...
Epoch: 3 cost time: 3.0918829441070557
Epoch: 3, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.762 Vali Acc: 0.540 Test Loss: 0.762 Test Acc: 0.540
Validation loss decreased (-0.449991 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 3.2441089153289795
Epoch: 4, Steps: 20 | Train Loss: 0.631 Vali Loss: 1.063 Vali Acc: 0.540 Test Loss: 1.063 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0529048442840576
Epoch: 5, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.850 Vali Acc: 0.550 Test Loss: 0.850 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549991).  Saving model ...
Epoch: 6 cost time: 3.6085569858551025
Epoch: 6, Steps: 20 | Train Loss: 0.546 Vali Loss: 1.029 Vali Acc: 0.470 Test Loss: 1.029 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2310843467712402
Epoch: 7, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.868 Vali Acc: 0.570 Test Loss: 0.868 Test Acc: 0.570
Validation loss decreased (-0.549991 --> -0.569991).  Saving model ...
Epoch: 8 cost time: 3.28439998626709
Epoch: 8, Steps: 20 | Train Loss: 0.400 Vali Loss: 1.063 Vali Acc: 0.470 Test Loss: 1.063 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4009387493133545
Epoch: 9, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.006 Vali Acc: 0.510 Test Loss: 1.006 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7941083908081055
Epoch: 10, Steps: 20 | Train Loss: 0.297 Vali Loss: 1.348 Vali Acc: 0.530 Test Loss: 1.348 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.1732451915740967
Epoch: 11, Steps: 20 | Train Loss: 0.252 Vali Loss: 1.186 Vali Acc: 0.550 Test Loss: 1.186 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.3878209590911865
Epoch: 12, Steps: 20 | Train Loss: 0.285 Vali Loss: 1.847 Vali Acc: 0.550 Test Loss: 1.847 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.288784980773926
Epoch: 13, Steps: 20 | Train Loss: 0.222 Vali Loss: 1.545 Vali Acc: 0.490 Test Loss: 1.545 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.3054428100585938
Epoch: 14, Steps: 20 | Train Loss: 0.144 Vali Loss: 1.720 Vali Acc: 0.540 Test Loss: 1.720 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.4583511352539062
Epoch: 15, Steps: 20 | Train Loss: 0.189 Vali Loss: 1.825 Vali Acc: 0.540 Test Loss: 1.825 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.1861000061035156
Epoch: 16, Steps: 20 | Train Loss: 0.121 Vali Loss: 1.524 Vali Acc: 0.580 Test Loss: 1.524 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579985).  Saving model ...
Epoch: 17 cost time: 3.265085458755493
Epoch: 17, Steps: 20 | Train Loss: 0.079 Vali Loss: 2.266 Vali Acc: 0.520 Test Loss: 2.266 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.232658863067627
Epoch: 18, Steps: 20 | Train Loss: 0.087 Vali Loss: 1.959 Vali Acc: 0.570 Test Loss: 1.959 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.827158212661743
Epoch: 19, Steps: 20 | Train Loss: 0.076 Vali Loss: 2.033 Vali Acc: 0.540 Test Loss: 2.033 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8798320293426514
Epoch: 20, Steps: 20 | Train Loss: 0.110 Vali Loss: 1.878 Vali Acc: 0.560 Test Loss: 1.878 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.2427854537963867
Epoch: 21, Steps: 20 | Train Loss: 0.028 Vali Loss: 2.309 Vali Acc: 0.570 Test Loss: 2.309 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.4373576641082764
Epoch: 22, Steps: 20 | Train Loss: 0.025 Vali Loss: 2.535 Vali Acc: 0.510 Test Loss: 2.535 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.2750072479248047
Epoch: 23, Steps: 20 | Train Loss: 0.013 Vali Loss: 2.710 Vali Acc: 0.550 Test Loss: 2.710 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.3720645904541016
Epoch: 24, Steps: 20 | Train Loss: 0.014 Vali Loss: 2.728 Vali Acc: 0.560 Test Loss: 2.728 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.1810684204101562
Epoch: 25, Steps: 20 | Train Loss: 0.026 Vali Loss: 2.731 Vali Acc: 0.510 Test Loss: 2.731 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.018697738647461
Epoch: 26, Steps: 20 | Train Loss: 0.015 Vali Loss: 3.546 Vali Acc: 0.550 Test Loss: 3.546 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1833186
model size : 7.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.117230176925659
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.707 Vali Acc: 0.450 Test Loss: 0.707 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 2.4246842861175537
Epoch: 2, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.787 Vali Acc: 0.480 Test Loss: 0.787 Test Acc: 0.480
Validation loss decreased (-0.449993 --> -0.479992).  Saving model ...
Epoch: 3 cost time: 3.2204079627990723
Epoch: 3, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.812 Vali Acc: 0.580 Test Loss: 0.812 Test Acc: 0.580
Validation loss decreased (-0.479992 --> -0.579992).  Saving model ...
Epoch: 4 cost time: 3.070993423461914
Epoch: 4, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.748 Vali Acc: 0.550 Test Loss: 0.748 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5543599128723145
Epoch: 5, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.735 Vali Acc: 0.560 Test Loss: 0.735 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.8946309089660645
Epoch: 6, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.867 Vali Acc: 0.490 Test Loss: 0.867 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.705282688140869
Epoch: 7, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.792 Vali Acc: 0.560 Test Loss: 0.792 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.6819663047790527
Epoch: 8, Steps: 20 | Train Loss: 0.380 Vali Loss: 0.921 Vali Acc: 0.520 Test Loss: 0.921 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.050724744796753
Epoch: 9, Steps: 20 | Train Loss: 0.343 Vali Loss: 0.826 Vali Acc: 0.530 Test Loss: 0.826 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.926398992538452
Epoch: 10, Steps: 20 | Train Loss: 0.311 Vali Loss: 0.904 Vali Acc: 0.570 Test Loss: 0.904 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.8447654247283936
Epoch: 11, Steps: 20 | Train Loss: 0.307 Vali Loss: 0.946 Vali Acc: 0.590 Test Loss: 0.946 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589991).  Saving model ...
Epoch: 12 cost time: 3.0514509677886963
Epoch: 12, Steps: 20 | Train Loss: 0.222 Vali Loss: 1.208 Vali Acc: 0.480 Test Loss: 1.208 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6766884326934814
Epoch: 13, Steps: 20 | Train Loss: 0.149 Vali Loss: 0.983 Vali Acc: 0.570 Test Loss: 0.983 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7590065002441406
Epoch: 14, Steps: 20 | Train Loss: 0.108 Vali Loss: 1.205 Vali Acc: 0.550 Test Loss: 1.205 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3996059894561768
Epoch: 15, Steps: 20 | Train Loss: 0.080 Vali Loss: 1.235 Vali Acc: 0.530 Test Loss: 1.235 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.690425157546997
Epoch: 16, Steps: 20 | Train Loss: 0.070 Vali Loss: 1.350 Vali Acc: 0.560 Test Loss: 1.350 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.914532423019409
Epoch: 17, Steps: 20 | Train Loss: 0.046 Vali Loss: 1.675 Vali Acc: 0.510 Test Loss: 1.675 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.9135096073150635
Epoch: 18, Steps: 20 | Train Loss: 0.063 Vali Loss: 1.548 Vali Acc: 0.580 Test Loss: 1.548 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.9735519886016846
Epoch: 19, Steps: 20 | Train Loss: 0.043 Vali Loss: 1.890 Vali Acc: 0.560 Test Loss: 1.890 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.5965116024017334
Epoch: 20, Steps: 20 | Train Loss: 0.031 Vali Loss: 1.854 Vali Acc: 0.560 Test Loss: 1.854 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.672313928604126
Epoch: 21, Steps: 20 | Train Loss: 0.014 Vali Loss: 1.815 Vali Acc: 0.580 Test Loss: 1.815 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1790210
model size : 6.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.021440267562866
Epoch: 1, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.752854108810425
Epoch: 2, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.839 Vali Acc: 0.490 Test Loss: 0.839 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9743475914001465
Epoch: 3, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.730 Vali Acc: 0.520 Test Loss: 0.730 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.9558043479919434
Epoch: 4, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.801 Vali Acc: 0.500 Test Loss: 0.801 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.916551351547241
Epoch: 5, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.802 Vali Acc: 0.460 Test Loss: 0.802 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.578792095184326
Epoch: 6, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.846 Vali Acc: 0.510 Test Loss: 0.846 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.3144683837890625
Epoch: 7, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.826 Vali Acc: 0.530 Test Loss: 0.826 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 8 cost time: 2.7057082653045654
Epoch: 8, Steps: 20 | Train Loss: 0.398 Vali Loss: 0.933 Vali Acc: 0.460 Test Loss: 0.933 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.407759189605713
Epoch: 9, Steps: 20 | Train Loss: 0.338 Vali Loss: 0.915 Vali Acc: 0.530 Test Loss: 0.915 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.366359233856201
Epoch: 10, Steps: 20 | Train Loss: 0.280 Vali Loss: 0.907 Vali Acc: 0.600 Test Loss: 0.907 Test Acc: 0.600
Validation loss decreased (-0.529992 --> -0.599991).  Saving model ...
Epoch: 11 cost time: 2.3571064472198486
Epoch: 11, Steps: 20 | Train Loss: 0.238 Vali Loss: 1.101 Vali Acc: 0.520 Test Loss: 1.101 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.45125675201416
Epoch: 12, Steps: 20 | Train Loss: 0.146 Vali Loss: 1.055 Vali Acc: 0.550 Test Loss: 1.055 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.06404709815979
Epoch: 13, Steps: 20 | Train Loss: 0.131 Vali Loss: 1.366 Vali Acc: 0.490 Test Loss: 1.366 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7002930641174316
Epoch: 14, Steps: 20 | Train Loss: 0.142 Vali Loss: 1.354 Vali Acc: 0.530 Test Loss: 1.354 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3215065002441406
Epoch: 15, Steps: 20 | Train Loss: 0.084 Vali Loss: 1.437 Vali Acc: 0.510 Test Loss: 1.437 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.555527925491333
Epoch: 16, Steps: 20 | Train Loss: 0.050 Vali Loss: 1.482 Vali Acc: 0.560 Test Loss: 1.482 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.8623573780059814
Epoch: 17, Steps: 20 | Train Loss: 0.038 Vali Loss: 1.627 Vali Acc: 0.510 Test Loss: 1.627 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.452338933944702
Epoch: 18, Steps: 20 | Train Loss: 0.023 Vali Loss: 1.679 Vali Acc: 0.540 Test Loss: 1.679 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.762277364730835
Epoch: 19, Steps: 20 | Train Loss: 0.013 Vali Loss: 1.906 Vali Acc: 0.510 Test Loss: 1.906 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.2427351474761963
Epoch: 20, Steps: 20 | Train Loss: 0.013 Vali Loss: 1.700 Vali Acc: 0.530 Test Loss: 1.700 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1790242
model size : 6.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.433593034744263
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.690 Vali Acc: 0.550 Test Loss: 0.690 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 3.034069061279297
Epoch: 2, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.737 Vali Acc: 0.520 Test Loss: 0.737 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9337990283966064
Epoch: 3, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.788 Vali Acc: 0.490 Test Loss: 0.788 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.919415235519409
Epoch: 4, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.751 Vali Acc: 0.610 Test Loss: 0.751 Test Acc: 0.610
Validation loss decreased (-0.549993 --> -0.609992).  Saving model ...
Epoch: 5 cost time: 2.9083919525146484
Epoch: 5, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.960 Vali Acc: 0.480 Test Loss: 0.960 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.23744797706604
Epoch: 6, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.898 Vali Acc: 0.550 Test Loss: 0.898 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.282949447631836
Epoch: 7, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.878 Vali Acc: 0.490 Test Loss: 0.878 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5505964756011963
Epoch: 8, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.896 Vali Acc: 0.530 Test Loss: 0.896 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.68143630027771
Epoch: 9, Steps: 20 | Train Loss: 0.376 Vali Loss: 0.890 Vali Acc: 0.540 Test Loss: 0.890 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.7527294158935547
Epoch: 10, Steps: 20 | Train Loss: 0.327 Vali Loss: 0.933 Vali Acc: 0.580 Test Loss: 0.933 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.2058663368225098
Epoch: 11, Steps: 20 | Train Loss: 0.289 Vali Loss: 0.946 Vali Acc: 0.590 Test Loss: 0.946 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.947800397872925
Epoch: 12, Steps: 20 | Train Loss: 0.228 Vali Loss: 1.102 Vali Acc: 0.540 Test Loss: 1.102 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.8924975395202637
Epoch: 13, Steps: 20 | Train Loss: 0.212 Vali Loss: 1.122 Vali Acc: 0.510 Test Loss: 1.122 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.8172218799591064
Epoch: 14, Steps: 20 | Train Loss: 0.155 Vali Loss: 1.072 Vali Acc: 0.540 Test Loss: 1.072 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1768770
model size : 6.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.095271110534668
Epoch: 1, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.715 Vali Acc: 0.460 Test Loss: 0.715 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 2.330430507659912
Epoch: 2, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.710 Vali Acc: 0.530 Test Loss: 0.710 Test Acc: 0.530
Validation loss decreased (-0.459993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 2.6138505935668945
Epoch: 3, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.817 Vali Acc: 0.450 Test Loss: 0.817 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.373216152191162
Epoch: 4, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.715 Vali Acc: 0.490 Test Loss: 0.715 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6472883224487305
Epoch: 5, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.742 Vali Acc: 0.530 Test Loss: 0.742 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9670484066009521
Epoch: 6, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.792 Vali Acc: 0.530 Test Loss: 0.792 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.8461191654205322
Epoch: 7, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.825 Vali Acc: 0.510 Test Loss: 0.825 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.8064348697662354
Epoch: 8, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.809 Vali Acc: 0.490 Test Loss: 0.809 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.9650566577911377
Epoch: 9, Steps: 20 | Train Loss: 0.429 Vali Loss: 0.928 Vali Acc: 0.520 Test Loss: 0.928 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.66483998298645
Epoch: 10, Steps: 20 | Train Loss: 0.392 Vali Loss: 0.867 Vali Acc: 0.540 Test Loss: 0.867 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539991).  Saving model ...
Epoch: 11 cost time: 2.865872621536255
Epoch: 11, Steps: 20 | Train Loss: 0.365 Vali Loss: 0.810 Vali Acc: 0.570 Test Loss: 0.810 Test Acc: 0.570
Validation loss decreased (-0.539991 --> -0.569992).  Saving model ...
Epoch: 12 cost time: 2.390510082244873
Epoch: 12, Steps: 20 | Train Loss: 0.310 Vali Loss: 0.896 Vali Acc: 0.490 Test Loss: 0.896 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.010509490966797
Epoch: 13, Steps: 20 | Train Loss: 0.247 Vali Loss: 0.863 Vali Acc: 0.520 Test Loss: 0.863 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.42586350440979
Epoch: 14, Steps: 20 | Train Loss: 0.209 Vali Loss: 0.982 Vali Acc: 0.520 Test Loss: 0.982 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.328345775604248
Epoch: 15, Steps: 20 | Train Loss: 0.164 Vali Loss: 1.047 Vali Acc: 0.490 Test Loss: 1.047 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.395315408706665
Epoch: 16, Steps: 20 | Train Loss: 0.128 Vali Loss: 1.039 Vali Acc: 0.550 Test Loss: 1.039 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.0906999111175537
Epoch: 17, Steps: 20 | Train Loss: 0.089 Vali Loss: 1.090 Vali Acc: 0.540 Test Loss: 1.090 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.0221211910247803
Epoch: 18, Steps: 20 | Train Loss: 0.062 Vali Loss: 1.275 Vali Acc: 0.560 Test Loss: 1.275 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.328707695007324
Epoch: 19, Steps: 20 | Train Loss: 0.040 Vali Loss: 1.211 Vali Acc: 0.510 Test Loss: 1.211 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.2435927391052246
Epoch: 20, Steps: 20 | Train Loss: 0.030 Vali Loss: 1.245 Vali Acc: 0.620 Test Loss: 1.245 Test Acc: 0.620
Validation loss decreased (-0.569992 --> -0.619988).  Saving model ...
Epoch: 21 cost time: 2.2329516410827637
Epoch: 21, Steps: 20 | Train Loss: 0.020 Vali Loss: 1.253 Vali Acc: 0.560 Test Loss: 1.253 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.181586265563965
Epoch: 22, Steps: 20 | Train Loss: 0.014 Vali Loss: 1.381 Vali Acc: 0.570 Test Loss: 1.381 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.814997673034668
Epoch: 23, Steps: 20 | Train Loss: 0.012 Vali Loss: 1.388 Vali Acc: 0.580 Test Loss: 1.388 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.1500611305236816
Epoch: 24, Steps: 20 | Train Loss: 0.008 Vali Loss: 1.358 Vali Acc: 0.580 Test Loss: 1.358 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.8645668029785156
Epoch: 25, Steps: 20 | Train Loss: 0.006 Vali Loss: 1.437 Vali Acc: 0.570 Test Loss: 1.437 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.0664801597595215
Epoch: 26, Steps: 20 | Train Loss: 0.005 Vali Loss: 1.429 Vali Acc: 0.560 Test Loss: 1.429 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.4788198471069336
Epoch: 27, Steps: 20 | Train Loss: 0.004 Vali Loss: 1.472 Vali Acc: 0.560 Test Loss: 1.472 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.750559091567993
Epoch: 28, Steps: 20 | Train Loss: 0.003 Vali Loss: 1.510 Vali Acc: 0.550 Test Loss: 1.510 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.7893600463867188
Epoch: 29, Steps: 20 | Train Loss: 0.003 Vali Loss: 1.548 Vali Acc: 0.560 Test Loss: 1.548 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.9080944061279297
Epoch: 30, Steps: 20 | Train Loss: 0.003 Vali Loss: 1.573 Vali Acc: 0.560 Test Loss: 1.573 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1761698
model size : 6.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.845510721206665
Epoch: 1, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.721 Vali Acc: 0.490 Test Loss: 0.721 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.501385450363159
Epoch: 2, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.731 Vali Acc: 0.550 Test Loss: 0.731 Test Acc: 0.550
Validation loss decreased (-0.489993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 2.8364450931549072
Epoch: 3, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.786 Vali Acc: 0.510 Test Loss: 0.786 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7092647552490234
Epoch: 4, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.779 Vali Acc: 0.450 Test Loss: 0.779 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6709985733032227
Epoch: 5, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.793 Vali Acc: 0.470 Test Loss: 0.793 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.220853567123413
Epoch: 6, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.776 Vali Acc: 0.480 Test Loss: 0.776 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.648200750350952
Epoch: 7, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.917 Vali Acc: 0.520 Test Loss: 0.917 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.109576463699341
Epoch: 8, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.834 Vali Acc: 0.520 Test Loss: 0.834 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.7781786918640137
Epoch: 9, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.784 Vali Acc: 0.560 Test Loss: 0.784 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 10 cost time: 2.825425386428833
Epoch: 10, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.900 Vali Acc: 0.570 Test Loss: 0.900 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569991).  Saving model ...
Epoch: 11 cost time: 2.608252763748169
Epoch: 11, Steps: 20 | Train Loss: 0.354 Vali Loss: 0.846 Vali Acc: 0.530 Test Loss: 0.846 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.84070086479187
Epoch: 12, Steps: 20 | Train Loss: 0.295 Vali Loss: 0.801 Vali Acc: 0.570 Test Loss: 0.801 Test Acc: 0.570
Validation loss decreased (-0.569991 --> -0.569992).  Saving model ...
Epoch: 13 cost time: 2.492873430252075
Epoch: 13, Steps: 20 | Train Loss: 0.247 Vali Loss: 0.928 Vali Acc: 0.530 Test Loss: 0.928 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5369749069213867
Epoch: 14, Steps: 20 | Train Loss: 0.196 Vali Loss: 1.025 Vali Acc: 0.540 Test Loss: 1.025 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.657104969024658
Epoch: 15, Steps: 20 | Train Loss: 0.155 Vali Loss: 1.015 Vali Acc: 0.520 Test Loss: 1.015 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.9128830432891846
Epoch: 16, Steps: 20 | Train Loss: 0.119 Vali Loss: 1.133 Vali Acc: 0.490 Test Loss: 1.133 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.1387763023376465
Epoch: 17, Steps: 20 | Train Loss: 0.083 Vali Loss: 1.140 Vali Acc: 0.580 Test Loss: 1.140 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579989).  Saving model ...
Epoch: 18 cost time: 2.850855588912964
Epoch: 18, Steps: 20 | Train Loss: 0.055 Vali Loss: 1.234 Vali Acc: 0.520 Test Loss: 1.234 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.0954740047454834
Epoch: 19, Steps: 20 | Train Loss: 0.044 Vali Loss: 1.191 Vali Acc: 0.550 Test Loss: 1.191 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.82901930809021
Epoch: 20, Steps: 20 | Train Loss: 0.028 Vali Loss: 1.324 Vali Acc: 0.560 Test Loss: 1.324 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.43306565284729
Epoch: 21, Steps: 20 | Train Loss: 0.019 Vali Loss: 1.385 Vali Acc: 0.540 Test Loss: 1.385 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.173586130142212
Epoch: 22, Steps: 20 | Train Loss: 0.013 Vali Loss: 1.352 Vali Acc: 0.530 Test Loss: 1.352 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.7298834323883057
Epoch: 23, Steps: 20 | Train Loss: 0.013 Vali Loss: 1.304 Vali Acc: 0.550 Test Loss: 1.304 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.0315117835998535
Epoch: 24, Steps: 20 | Train Loss: 0.008 Vali Loss: 1.484 Vali Acc: 0.520 Test Loss: 1.484 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.541027307510376
Epoch: 25, Steps: 20 | Train Loss: 0.007 Vali Loss: 1.515 Vali Acc: 0.530 Test Loss: 1.515 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.3185386657714844
Epoch: 26, Steps: 20 | Train Loss: 0.005 Vali Loss: 1.570 Vali Acc: 0.530 Test Loss: 1.570 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.2211625576019287
Epoch: 27, Steps: 20 | Train Loss: 0.004 Vali Loss: 1.545 Vali Acc: 0.540 Test Loss: 1.545 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1761762
model size : 6.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.780961513519287
Epoch: 1, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.695 Vali Acc: 0.560 Test Loss: 0.695 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.286945104598999
Epoch: 2, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.736 Vali Acc: 0.520 Test Loss: 0.736 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.367755889892578
Epoch: 3, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.728 Vali Acc: 0.530 Test Loss: 0.728 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8778431415557861
Epoch: 4, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.831 Vali Acc: 0.540 Test Loss: 0.831 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6099472045898438
Epoch: 5, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.794 Vali Acc: 0.510 Test Loss: 0.794 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.825382947921753
Epoch: 6, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.779 Vali Acc: 0.540 Test Loss: 0.779 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.4244067668914795
Epoch: 7, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.766 Vali Acc: 0.510 Test Loss: 0.766 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.743185520172119
Epoch: 8, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.829 Vali Acc: 0.510 Test Loss: 0.829 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.6541683673858643
Epoch: 9, Steps: 20 | Train Loss: 0.497 Vali Loss: 0.791 Vali Acc: 0.550 Test Loss: 0.791 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.3524727821350098
Epoch: 10, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.820 Vali Acc: 0.570 Test Loss: 0.820 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569992).  Saving model ...
Epoch: 11 cost time: 2.2702014446258545
Epoch: 11, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.761 Vali Acc: 0.580 Test Loss: 0.761 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579992).  Saving model ...
Epoch: 12 cost time: 2.668375015258789
Epoch: 12, Steps: 20 | Train Loss: 0.392 Vali Loss: 0.833 Vali Acc: 0.570 Test Loss: 0.833 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.042145013809204
Epoch: 13, Steps: 20 | Train Loss: 0.339 Vali Loss: 0.899 Vali Acc: 0.480 Test Loss: 0.899 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.579990863800049
Epoch: 14, Steps: 20 | Train Loss: 0.321 Vali Loss: 0.821 Vali Acc: 0.560 Test Loss: 0.821 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6313607692718506
Epoch: 15, Steps: 20 | Train Loss: 0.250 Vali Loss: 0.957 Vali Acc: 0.550 Test Loss: 0.957 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.6365318298339844
Epoch: 16, Steps: 20 | Train Loss: 0.195 Vali Loss: 1.004 Vali Acc: 0.560 Test Loss: 1.004 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3133387565612793
Epoch: 17, Steps: 20 | Train Loss: 0.146 Vali Loss: 0.972 Vali Acc: 0.580 Test Loss: 0.972 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.4376702308654785
Epoch: 18, Steps: 20 | Train Loss: 0.090 Vali Loss: 0.953 Vali Acc: 0.600 Test Loss: 0.953 Test Acc: 0.600
Validation loss decreased (-0.579992 --> -0.599990).  Saving model ...
Epoch: 19 cost time: 2.283679485321045
Epoch: 19, Steps: 20 | Train Loss: 0.062 Vali Loss: 1.068 Vali Acc: 0.590 Test Loss: 1.068 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.170106887817383
Epoch: 20, Steps: 20 | Train Loss: 0.043 Vali Loss: 1.225 Vali Acc: 0.530 Test Loss: 1.225 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.5482351779937744
Epoch: 21, Steps: 20 | Train Loss: 0.030 Vali Loss: 1.379 Vali Acc: 0.550 Test Loss: 1.379 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.9977080821990967
Epoch: 22, Steps: 20 | Train Loss: 0.020 Vali Loss: 1.310 Vali Acc: 0.540 Test Loss: 1.310 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.480170488357544
Epoch: 23, Steps: 20 | Train Loss: 0.014 Vali Loss: 1.387 Vali Acc: 0.570 Test Loss: 1.387 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.6997151374816895
Epoch: 24, Steps: 20 | Train Loss: 0.013 Vali Loss: 1.460 Vali Acc: 0.570 Test Loss: 1.460 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.2805895805358887
Epoch: 25, Steps: 20 | Train Loss: 0.011 Vali Loss: 1.478 Vali Acc: 0.580 Test Loss: 1.478 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.3156282901763916
Epoch: 26, Steps: 20 | Train Loss: 0.012 Vali Loss: 1.622 Vali Acc: 0.560 Test Loss: 1.622 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.7999212741851807
Epoch: 27, Steps: 20 | Train Loss: 0.006 Vali Loss: 1.669 Vali Acc: 0.550 Test Loss: 1.669 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.5633020401000977
Epoch: 28, Steps: 20 | Train Loss: 0.004 Vali Loss: 1.546 Vali Acc: 0.560 Test Loss: 1.546 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1754690
model size : 6.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.043198823928833
Epoch: 1, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.792 Vali Acc: 0.460 Test Loss: 0.792 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 2.7245266437530518
Epoch: 2, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.810 Vali Acc: 0.540 Test Loss: 0.810 Test Acc: 0.540
Validation loss decreased (-0.459992 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 2.706012010574341
Epoch: 3, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.818 Vali Acc: 0.510 Test Loss: 0.818 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5114381313323975
Epoch: 4, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.818 Vali Acc: 0.530 Test Loss: 0.818 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.940891742706299
Epoch: 5, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.895 Vali Acc: 0.510 Test Loss: 0.895 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.82289981842041
Epoch: 6, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.898 Vali Acc: 0.520 Test Loss: 0.898 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.022535562515259
Epoch: 7, Steps: 20 | Train Loss: 0.436 Vali Loss: 1.182 Vali Acc: 0.500 Test Loss: 1.182 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.193612575531006
Epoch: 8, Steps: 20 | Train Loss: 0.449 Vali Loss: 1.140 Vali Acc: 0.550 Test Loss: 1.140 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549989).  Saving model ...
Epoch: 9 cost time: 2.042452812194824
Epoch: 9, Steps: 20 | Train Loss: 0.363 Vali Loss: 1.133 Vali Acc: 0.560 Test Loss: 1.133 Test Acc: 0.560
Validation loss decreased (-0.549989 --> -0.559989).  Saving model ...
Epoch: 10 cost time: 2.342355728149414
Epoch: 10, Steps: 20 | Train Loss: 0.311 Vali Loss: 1.056 Vali Acc: 0.570 Test Loss: 1.056 Test Acc: 0.570
Validation loss decreased (-0.559989 --> -0.569989).  Saving model ...
Epoch: 11 cost time: 2.3077521324157715
Epoch: 11, Steps: 20 | Train Loss: 0.266 Vali Loss: 1.193 Vali Acc: 0.520 Test Loss: 1.193 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.165496587753296
Epoch: 12, Steps: 20 | Train Loss: 0.224 Vali Loss: 1.642 Vali Acc: 0.510 Test Loss: 1.642 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.166327953338623
Epoch: 13, Steps: 20 | Train Loss: 0.233 Vali Loss: 1.121 Vali Acc: 0.590 Test Loss: 1.121 Test Acc: 0.590
Validation loss decreased (-0.569989 --> -0.589989).  Saving model ...
Epoch: 14 cost time: 2.839724540710449
Epoch: 14, Steps: 20 | Train Loss: 0.141 Vali Loss: 1.564 Vali Acc: 0.490 Test Loss: 1.564 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1786904335021973
Epoch: 15, Steps: 20 | Train Loss: 0.144 Vali Loss: 1.558 Vali Acc: 0.530 Test Loss: 1.558 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8577992916107178
Epoch: 16, Steps: 20 | Train Loss: 0.133 Vali Loss: 2.125 Vali Acc: 0.520 Test Loss: 2.125 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.732192039489746
Epoch: 17, Steps: 20 | Train Loss: 0.090 Vali Loss: 1.881 Vali Acc: 0.570 Test Loss: 1.881 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.0045692920684814
Epoch: 18, Steps: 20 | Train Loss: 0.063 Vali Loss: 2.201 Vali Acc: 0.550 Test Loss: 2.201 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.7738449573516846
Epoch: 19, Steps: 20 | Train Loss: 0.044 Vali Loss: 2.132 Vali Acc: 0.530 Test Loss: 2.132 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.8717617988586426
Epoch: 20, Steps: 20 | Train Loss: 0.035 Vali Loss: 2.455 Vali Acc: 0.550 Test Loss: 2.455 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.5256125926971436
Epoch: 21, Steps: 20 | Train Loss: 0.042 Vali Loss: 2.620 Vali Acc: 0.520 Test Loss: 2.620 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.614713668823242
Epoch: 22, Steps: 20 | Train Loss: 0.032 Vali Loss: 3.087 Vali Acc: 0.570 Test Loss: 3.087 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.5342979431152344
Epoch: 23, Steps: 20 | Train Loss: 0.058 Vali Loss: 3.497 Vali Acc: 0.500 Test Loss: 3.497 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1808098
model size : 7.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.234445571899414
Epoch: 1, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.702 Vali Acc: 0.440 Test Loss: 0.702 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 2.346531629562378
Epoch: 2, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.838 Vali Acc: 0.480 Test Loss: 0.838 Test Acc: 0.480
Validation loss decreased (-0.439993 --> -0.479992).  Saving model ...
Epoch: 3 cost time: 2.6101205348968506
Epoch: 3, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.863 Vali Acc: 0.550 Test Loss: 0.863 Test Acc: 0.550
Validation loss decreased (-0.479992 --> -0.549991).  Saving model ...
Epoch: 4 cost time: 2.638761281967163
Epoch: 4, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.770 Vali Acc: 0.540 Test Loss: 0.770 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7435388565063477
Epoch: 5, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.829 Vali Acc: 0.550 Test Loss: 0.829 Test Acc: 0.550
Validation loss decreased (-0.549991 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 2.0641143321990967
Epoch: 6, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.936 Vali Acc: 0.470 Test Loss: 0.936 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.932265281677246
Epoch: 7, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.924 Vali Acc: 0.450 Test Loss: 0.924 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4875857830047607
Epoch: 8, Steps: 20 | Train Loss: 0.450 Vali Loss: 1.053 Vali Acc: 0.520 Test Loss: 1.053 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.496821880340576
Epoch: 9, Steps: 20 | Train Loss: 0.391 Vali Loss: 0.801 Vali Acc: 0.570 Test Loss: 0.801 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569992).  Saving model ...
Epoch: 10 cost time: 2.9567389488220215
Epoch: 10, Steps: 20 | Train Loss: 0.301 Vali Loss: 0.960 Vali Acc: 0.530 Test Loss: 0.960 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.889634609222412
Epoch: 11, Steps: 20 | Train Loss: 0.257 Vali Loss: 0.949 Vali Acc: 0.530 Test Loss: 0.949 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.9879684448242188
Epoch: 12, Steps: 20 | Train Loss: 0.217 Vali Loss: 1.117 Vali Acc: 0.510 Test Loss: 1.117 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.9418628215789795
Epoch: 13, Steps: 20 | Train Loss: 0.152 Vali Loss: 1.230 Vali Acc: 0.530 Test Loss: 1.230 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.775686264038086
Epoch: 14, Steps: 20 | Train Loss: 0.134 Vali Loss: 1.466 Vali Acc: 0.560 Test Loss: 1.466 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.4665894508361816
Epoch: 15, Steps: 20 | Train Loss: 0.091 Vali Loss: 1.505 Vali Acc: 0.510 Test Loss: 1.505 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.6689116954803467
Epoch: 16, Steps: 20 | Train Loss: 0.109 Vali Loss: 1.659 Vali Acc: 0.560 Test Loss: 1.659 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.2757439613342285
Epoch: 17, Steps: 20 | Train Loss: 0.083 Vali Loss: 1.715 Vali Acc: 0.560 Test Loss: 1.715 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.0190353393554688
Epoch: 18, Steps: 20 | Train Loss: 0.046 Vali Loss: 1.686 Vali Acc: 0.580 Test Loss: 1.686 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579983).  Saving model ...
Epoch: 19 cost time: 2.7371277809143066
Epoch: 19, Steps: 20 | Train Loss: 0.031 Vali Loss: 1.822 Vali Acc: 0.590 Test Loss: 1.822 Test Acc: 0.590
Validation loss decreased (-0.579983 --> -0.589982).  Saving model ...
Epoch: 20 cost time: 3.0468051433563232
Epoch: 20, Steps: 20 | Train Loss: 0.017 Vali Loss: 1.786 Vali Acc: 0.550 Test Loss: 1.786 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.9091930389404297
Epoch: 21, Steps: 20 | Train Loss: 0.010 Vali Loss: 1.850 Vali Acc: 0.550 Test Loss: 1.850 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.846529245376587
Epoch: 22, Steps: 20 | Train Loss: 0.008 Vali Loss: 1.899 Vali Acc: 0.600 Test Loss: 1.899 Test Acc: 0.600
Validation loss decreased (-0.589982 --> -0.599981).  Saving model ...
Epoch: 23 cost time: 2.2957215309143066
Epoch: 23, Steps: 20 | Train Loss: 0.005 Vali Loss: 1.854 Vali Acc: 0.570 Test Loss: 1.854 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.58516526222229
Epoch: 24, Steps: 20 | Train Loss: 0.003 Vali Loss: 1.880 Vali Acc: 0.580 Test Loss: 1.880 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.989952802658081
Epoch: 25, Steps: 20 | Train Loss: 0.003 Vali Loss: 1.877 Vali Acc: 0.600 Test Loss: 1.877 Test Acc: 0.600
Validation loss decreased (-0.599981 --> -0.599981).  Saving model ...
Epoch: 26 cost time: 3.1050617694854736
Epoch: 26, Steps: 20 | Train Loss: 0.002 Vali Loss: 1.906 Vali Acc: 0.600 Test Loss: 1.906 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.876405954360962
Epoch: 27, Steps: 20 | Train Loss: 0.002 Vali Loss: 2.035 Vali Acc: 0.590 Test Loss: 2.035 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.69673752784729
Epoch: 28, Steps: 20 | Train Loss: 0.002 Vali Loss: 1.993 Vali Acc: 0.570 Test Loss: 1.993 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.1093547344207764
Epoch: 29, Steps: 20 | Train Loss: 0.002 Vali Loss: 2.027 Vali Acc: 0.590 Test Loss: 2.027 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.934448003768921
Epoch: 30, Steps: 20 | Train Loss: 0.001 Vali Loss: 2.105 Vali Acc: 0.550 Test Loss: 2.105 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.9303624629974365
Epoch: 31, Steps: 20 | Train Loss: 0.001 Vali Loss: 2.120 Vali Acc: 0.600 Test Loss: 2.120 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.2737607955932617
Epoch: 32, Steps: 20 | Train Loss: 0.001 Vali Loss: 2.094 Vali Acc: 0.570 Test Loss: 2.094 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.8060247898101807
Epoch: 33, Steps: 20 | Train Loss: 0.001 Vali Loss: 2.108 Vali Acc: 0.570 Test Loss: 2.108 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.5541176795959473
Epoch: 34, Steps: 20 | Train Loss: 0.001 Vali Loss: 2.124 Vali Acc: 0.570 Test Loss: 2.124 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.8485209941864014
Epoch: 35, Steps: 20 | Train Loss: 0.001 Vali Loss: 2.134 Vali Acc: 0.600 Test Loss: 2.134 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1765122
model size : 6.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.477356672286987
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.692 Vali Acc: 0.540 Test Loss: 0.692 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.7564384937286377
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.794 Vali Acc: 0.480 Test Loss: 0.794 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.549241542816162
Epoch: 3, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.772 Vali Acc: 0.480 Test Loss: 0.772 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2966325283050537
Epoch: 4, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.893 Vali Acc: 0.550 Test Loss: 0.893 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549991).  Saving model ...
Epoch: 5 cost time: 2.239152193069458
Epoch: 5, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.808 Vali Acc: 0.540 Test Loss: 0.808 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.028040885925293
Epoch: 6, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.857 Vali Acc: 0.500 Test Loss: 0.857 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4615769386291504
Epoch: 7, Steps: 20 | Train Loss: 0.455 Vali Loss: 0.920 Vali Acc: 0.510 Test Loss: 0.920 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.688328742980957
Epoch: 8, Steps: 20 | Train Loss: 0.408 Vali Loss: 0.919 Vali Acc: 0.460 Test Loss: 0.919 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4282336235046387
Epoch: 9, Steps: 20 | Train Loss: 0.338 Vali Loss: 0.990 Vali Acc: 0.460 Test Loss: 0.990 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.479830026626587
Epoch: 10, Steps: 20 | Train Loss: 0.264 Vali Loss: 1.061 Vali Acc: 0.550 Test Loss: 1.061 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.8811724185943604
Epoch: 11, Steps: 20 | Train Loss: 0.261 Vali Loss: 1.039 Vali Acc: 0.510 Test Loss: 1.039 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.4036800861358643
Epoch: 12, Steps: 20 | Train Loss: 0.181 Vali Loss: 1.198 Vali Acc: 0.500 Test Loss: 1.198 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.831932783126831
Epoch: 13, Steps: 20 | Train Loss: 0.155 Vali Loss: 1.222 Vali Acc: 0.510 Test Loss: 1.222 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.139207601547241
Epoch: 14, Steps: 20 | Train Loss: 0.113 Vali Loss: 1.269 Vali Acc: 0.540 Test Loss: 1.269 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1765154
model size : 6.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.205980539321899
Epoch: 1, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.713 Vali Acc: 0.510 Test Loss: 0.713 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.3199164867401123
Epoch: 2, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.716 Vali Acc: 0.510 Test Loss: 0.716 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7986233234405518
Epoch: 3, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.812 Vali Acc: 0.500 Test Loss: 0.812 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4066333770751953
Epoch: 4, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.765 Vali Acc: 0.530 Test Loss: 0.765 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529992).  Saving model ...
Epoch: 5 cost time: 2.4070398807525635
Epoch: 5, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.757 Vali Acc: 0.540 Test Loss: 0.757 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 6 cost time: 2.23407244682312
Epoch: 6, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.782 Vali Acc: 0.510 Test Loss: 0.782 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2604868412017822
Epoch: 7, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.771 Vali Acc: 0.580 Test Loss: 0.771 Test Acc: 0.580
Validation loss decreased (-0.539992 --> -0.579992).  Saving model ...
Epoch: 8 cost time: 2.3015499114990234
Epoch: 8, Steps: 20 | Train Loss: 0.426 Vali Loss: 0.856 Vali Acc: 0.530 Test Loss: 0.856 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7484662532806396
Epoch: 9, Steps: 20 | Train Loss: 0.386 Vali Loss: 0.859 Vali Acc: 0.560 Test Loss: 0.859 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4184083938598633
Epoch: 10, Steps: 20 | Train Loss: 0.369 Vali Loss: 0.918 Vali Acc: 0.540 Test Loss: 0.918 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3426835536956787
Epoch: 11, Steps: 20 | Train Loss: 0.300 Vali Loss: 1.068 Vali Acc: 0.560 Test Loss: 1.068 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.553797721862793
Epoch: 12, Steps: 20 | Train Loss: 0.256 Vali Loss: 1.188 Vali Acc: 0.540 Test Loss: 1.188 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.5772063732147217
Epoch: 13, Steps: 20 | Train Loss: 0.186 Vali Loss: 0.973 Vali Acc: 0.530 Test Loss: 0.973 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3801090717315674
Epoch: 14, Steps: 20 | Train Loss: 0.134 Vali Loss: 1.196 Vali Acc: 0.520 Test Loss: 1.196 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.197735071182251
Epoch: 15, Steps: 20 | Train Loss: 0.104 Vali Loss: 1.180 Vali Acc: 0.540 Test Loss: 1.180 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.4275996685028076
Epoch: 16, Steps: 20 | Train Loss: 0.073 Vali Loss: 1.335 Vali Acc: 0.540 Test Loss: 1.335 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.3755459785461426
Epoch: 17, Steps: 20 | Train Loss: 0.039 Vali Loss: 1.326 Vali Acc: 0.540 Test Loss: 1.326 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1743682
model size : 6.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5420143604278564
Epoch: 1, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.700 Vali Acc: 0.490 Test Loss: 0.700 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.2975449562072754
Epoch: 2, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.737 Vali Acc: 0.470 Test Loss: 0.737 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.325695037841797
Epoch: 3, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.749 Vali Acc: 0.480 Test Loss: 0.749 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.627182722091675
Epoch: 4, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.712 Vali Acc: 0.530 Test Loss: 0.712 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 2.9243061542510986
Epoch: 5, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.760 Vali Acc: 0.470 Test Loss: 0.760 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3787224292755127
Epoch: 6, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.733 Vali Acc: 0.460 Test Loss: 0.733 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2724032402038574
Epoch: 7, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.787 Vali Acc: 0.530 Test Loss: 0.787 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7344472408294678
Epoch: 8, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.856 Vali Acc: 0.520 Test Loss: 0.856 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.59700083732605
Epoch: 9, Steps: 20 | Train Loss: 0.418 Vali Loss: 0.752 Vali Acc: 0.560 Test Loss: 0.752 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559992).  Saving model ...
Epoch: 10 cost time: 2.6773173809051514
Epoch: 10, Steps: 20 | Train Loss: 0.378 Vali Loss: 0.848 Vali Acc: 0.450 Test Loss: 0.848 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.803283214569092
Epoch: 11, Steps: 20 | Train Loss: 0.330 Vali Loss: 0.880 Vali Acc: 0.550 Test Loss: 0.880 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7454001903533936
Epoch: 12, Steps: 20 | Train Loss: 0.289 Vali Loss: 1.027 Vali Acc: 0.500 Test Loss: 1.027 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.743823766708374
Epoch: 13, Steps: 20 | Train Loss: 0.221 Vali Loss: 0.889 Vali Acc: 0.500 Test Loss: 0.889 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.3916008472442627
Epoch: 14, Steps: 20 | Train Loss: 0.166 Vali Loss: 0.930 Vali Acc: 0.540 Test Loss: 0.930 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.4793169498443604
Epoch: 15, Steps: 20 | Train Loss: 0.138 Vali Loss: 0.924 Vali Acc: 0.600 Test Loss: 0.924 Test Acc: 0.600
Validation loss decreased (-0.559992 --> -0.599991).  Saving model ...
Epoch: 16 cost time: 2.693826198577881
Epoch: 16, Steps: 20 | Train Loss: 0.111 Vali Loss: 1.045 Vali Acc: 0.550 Test Loss: 1.045 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.5431013107299805
Epoch: 17, Steps: 20 | Train Loss: 0.076 Vali Loss: 1.216 Vali Acc: 0.500 Test Loss: 1.216 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.694563150405884
Epoch: 18, Steps: 20 | Train Loss: 0.059 Vali Loss: 1.098 Vali Acc: 0.540 Test Loss: 1.098 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.4464216232299805
Epoch: 19, Steps: 20 | Train Loss: 0.040 Vali Loss: 1.096 Vali Acc: 0.570 Test Loss: 1.096 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.0790629386901855
Epoch: 20, Steps: 20 | Train Loss: 0.029 Vali Loss: 1.150 Vali Acc: 0.580 Test Loss: 1.150 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9387049674987793
Epoch: 21, Steps: 20 | Train Loss: 0.022 Vali Loss: 1.271 Vali Acc: 0.530 Test Loss: 1.271 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.891758680343628
Epoch: 22, Steps: 20 | Train Loss: 0.014 Vali Loss: 1.312 Vali Acc: 0.540 Test Loss: 1.312 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.2070353031158447
Epoch: 23, Steps: 20 | Train Loss: 0.010 Vali Loss: 1.361 Vali Acc: 0.560 Test Loss: 1.361 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.117058753967285
Epoch: 24, Steps: 20 | Train Loss: 0.008 Vali Loss: 1.424 Vali Acc: 0.530 Test Loss: 1.424 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.0745108127593994
Epoch: 25, Steps: 20 | Train Loss: 0.006 Vali Loss: 1.406 Vali Acc: 0.540 Test Loss: 1.406 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1736610
model size : 6.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.277066230773926
Epoch: 1, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.712 Vali Acc: 0.460 Test Loss: 0.712 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 2.4589481353759766
Epoch: 2, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.763 Vali Acc: 0.460 Test Loss: 0.763 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.467068910598755
Epoch: 3, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.851 Vali Acc: 0.490 Test Loss: 0.851 Test Acc: 0.490
Validation loss decreased (-0.459993 --> -0.489991).  Saving model ...
Epoch: 4 cost time: 2.2925589084625244
Epoch: 4, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.795 Vali Acc: 0.510 Test Loss: 0.795 Test Acc: 0.510
Validation loss decreased (-0.489991 --> -0.509992).  Saving model ...
Epoch: 5 cost time: 1.6902048587799072
Epoch: 5, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.803 Vali Acc: 0.480 Test Loss: 0.803 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1931514739990234
Epoch: 6, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.750 Vali Acc: 0.540 Test Loss: 0.750 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539993).  Saving model ...
Epoch: 7 cost time: 2.520118474960327
Epoch: 7, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.815 Vali Acc: 0.520 Test Loss: 0.815 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.408792734146118
Epoch: 8, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.788 Vali Acc: 0.500 Test Loss: 0.788 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6330454349517822
Epoch: 9, Steps: 20 | Train Loss: 0.455 Vali Loss: 0.874 Vali Acc: 0.480 Test Loss: 0.874 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.210901975631714
Epoch: 10, Steps: 20 | Train Loss: 0.434 Vali Loss: 0.792 Vali Acc: 0.520 Test Loss: 0.792 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1990606784820557
Epoch: 11, Steps: 20 | Train Loss: 0.402 Vali Loss: 0.811 Vali Acc: 0.540 Test Loss: 0.811 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.515152931213379
Epoch: 12, Steps: 20 | Train Loss: 0.353 Vali Loss: 0.801 Vali Acc: 0.570 Test Loss: 0.801 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569992).  Saving model ...
Epoch: 13 cost time: 2.631742238998413
Epoch: 13, Steps: 20 | Train Loss: 0.302 Vali Loss: 1.038 Vali Acc: 0.520 Test Loss: 1.038 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4380412101745605
Epoch: 14, Steps: 20 | Train Loss: 0.257 Vali Loss: 1.032 Vali Acc: 0.560 Test Loss: 1.032 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.432307481765747
Epoch: 15, Steps: 20 | Train Loss: 0.198 Vali Loss: 0.910 Vali Acc: 0.560 Test Loss: 0.910 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2547779083251953
Epoch: 16, Steps: 20 | Train Loss: 0.140 Vali Loss: 1.070 Vali Acc: 0.550 Test Loss: 1.070 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.034031629562378
Epoch: 17, Steps: 20 | Train Loss: 0.109 Vali Loss: 1.113 Vali Acc: 0.540 Test Loss: 1.113 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.882422924041748
Epoch: 18, Steps: 20 | Train Loss: 0.091 Vali Loss: 1.310 Vali Acc: 0.490 Test Loss: 1.310 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.9485881328582764
Epoch: 19, Steps: 20 | Train Loss: 0.066 Vali Loss: 1.254 Vali Acc: 0.580 Test Loss: 1.254 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579987).  Saving model ...
Epoch: 20 cost time: 2.600614309310913
Epoch: 20, Steps: 20 | Train Loss: 0.057 Vali Loss: 1.307 Vali Acc: 0.560 Test Loss: 1.307 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.484811305999756
Epoch: 21, Steps: 20 | Train Loss: 0.053 Vali Loss: 1.681 Vali Acc: 0.470 Test Loss: 1.681 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.4521217346191406
Epoch: 22, Steps: 20 | Train Loss: 0.030 Vali Loss: 1.458 Vali Acc: 0.510 Test Loss: 1.458 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.5000417232513428
Epoch: 23, Steps: 20 | Train Loss: 0.014 Vali Loss: 1.496 Vali Acc: 0.560 Test Loss: 1.496 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.2670865058898926
Epoch: 24, Steps: 20 | Train Loss: 0.008 Vali Loss: 1.571 Vali Acc: 0.520 Test Loss: 1.571 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.282454252243042
Epoch: 25, Steps: 20 | Train Loss: 0.007 Vali Loss: 1.465 Vali Acc: 0.580 Test Loss: 1.465 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.2487165927886963
Epoch: 26, Steps: 20 | Train Loss: 0.006 Vali Loss: 1.531 Vali Acc: 0.570 Test Loss: 1.531 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.626849889755249
Epoch: 27, Steps: 20 | Train Loss: 0.005 Vali Loss: 1.603 Vali Acc: 0.570 Test Loss: 1.603 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.3896536827087402
Epoch: 28, Steps: 20 | Train Loss: 0.004 Vali Loss: 1.565 Vali Acc: 0.580 Test Loss: 1.565 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.4039430618286133
Epoch: 29, Steps: 20 | Train Loss: 0.004 Vali Loss: 1.657 Vali Acc: 0.530 Test Loss: 1.657 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1736674
model size : 6.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.111632347106934
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.691 Vali Acc: 0.450 Test Loss: 0.691 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 2.6374523639678955
Epoch: 2, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.710 Vali Acc: 0.530 Test Loss: 0.710 Test Acc: 0.530
Validation loss decreased (-0.449993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 2.6254611015319824
Epoch: 3, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.742 Vali Acc: 0.500 Test Loss: 0.742 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.286848306655884
Epoch: 4, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.747 Vali Acc: 0.470 Test Loss: 0.747 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4155867099761963
Epoch: 5, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.721 Vali Acc: 0.530 Test Loss: 0.721 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.118441104888916
Epoch: 6, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.802 Vali Acc: 0.540 Test Loss: 0.802 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 7 cost time: 1.870394229888916
Epoch: 7, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.764 Vali Acc: 0.520 Test Loss: 0.764 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.70393967628479
Epoch: 8, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.746 Vali Acc: 0.540 Test Loss: 0.746 Test Acc: 0.540
Validation loss decreased (-0.539992 --> -0.539993).  Saving model ...
Epoch: 9 cost time: 1.8891575336456299
Epoch: 9, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.739 Vali Acc: 0.560 Test Loss: 0.739 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 10 cost time: 1.8956546783447266
Epoch: 10, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.764 Vali Acc: 0.530 Test Loss: 0.764 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9487245082855225
Epoch: 11, Steps: 20 | Train Loss: 0.394 Vali Loss: 0.843 Vali Acc: 0.530 Test Loss: 0.843 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.450016736984253
Epoch: 12, Steps: 20 | Train Loss: 0.362 Vali Loss: 0.866 Vali Acc: 0.560 Test Loss: 0.866 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.431792974472046
Epoch: 13, Steps: 20 | Train Loss: 0.309 Vali Loss: 0.771 Vali Acc: 0.540 Test Loss: 0.771 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9780323505401611
Epoch: 14, Steps: 20 | Train Loss: 0.263 Vali Loss: 0.834 Vali Acc: 0.590 Test Loss: 0.834 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589992).  Saving model ...
Epoch: 15 cost time: 1.9337997436523438
Epoch: 15, Steps: 20 | Train Loss: 0.233 Vali Loss: 1.010 Vali Acc: 0.550 Test Loss: 1.010 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9627258777618408
Epoch: 16, Steps: 20 | Train Loss: 0.169 Vali Loss: 0.933 Vali Acc: 0.550 Test Loss: 0.933 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1315488815307617
Epoch: 17, Steps: 20 | Train Loss: 0.131 Vali Loss: 0.956 Vali Acc: 0.560 Test Loss: 0.956 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9081053733825684
Epoch: 18, Steps: 20 | Train Loss: 0.106 Vali Loss: 0.992 Vali Acc: 0.570 Test Loss: 0.992 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9305500984191895
Epoch: 19, Steps: 20 | Train Loss: 0.062 Vali Loss: 1.193 Vali Acc: 0.550 Test Loss: 1.193 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9496145248413086
Epoch: 20, Steps: 20 | Train Loss: 0.048 Vali Loss: 1.113 Vali Acc: 0.520 Test Loss: 1.113 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.0244197845458984
Epoch: 21, Steps: 20 | Train Loss: 0.035 Vali Loss: 1.221 Vali Acc: 0.540 Test Loss: 1.221 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.4770395755767822
Epoch: 22, Steps: 20 | Train Loss: 0.019 Vali Loss: 1.286 Vali Acc: 0.560 Test Loss: 1.286 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.2642531394958496
Epoch: 23, Steps: 20 | Train Loss: 0.011 Vali Loss: 1.335 Vali Acc: 0.550 Test Loss: 1.335 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.2141339778900146
Epoch: 24, Steps: 20 | Train Loss: 0.007 Vali Loss: 1.336 Vali Acc: 0.520 Test Loss: 1.336 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1729602
model size : 6.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.708740949630737
Epoch: 1, Steps: 20 | Train Loss: 0.757 Vali Loss: 0.779 Vali Acc: 0.610 Test Loss: 0.779 Test Acc: 0.610
Validation loss decreased (inf --> -0.609992).  Saving model ...
Epoch: 2 cost time: 4.132735013961792
Epoch: 2, Steps: 20 | Train Loss: 0.771 Vali Loss: 0.811 Vali Acc: 0.560 Test Loss: 0.811 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.006768703460693
Epoch: 3, Steps: 20 | Train Loss: 0.781 Vali Loss: 0.949 Vali Acc: 0.590 Test Loss: 0.949 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.592254877090454
Epoch: 4, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.988 Vali Acc: 0.560 Test Loss: 0.988 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.93190860748291
Epoch: 5, Steps: 20 | Train Loss: 0.634 Vali Loss: 1.094 Vali Acc: 0.540 Test Loss: 1.094 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.080179214477539
Epoch: 6, Steps: 20 | Train Loss: 0.652 Vali Loss: 1.089 Vali Acc: 0.560 Test Loss: 1.089 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.982985496520996
Epoch: 7, Steps: 20 | Train Loss: 0.681 Vali Loss: 1.223 Vali Acc: 0.580 Test Loss: 1.223 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.014337062835693
Epoch: 8, Steps: 20 | Train Loss: 0.581 Vali Loss: 1.140 Vali Acc: 0.510 Test Loss: 1.140 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.125769853591919
Epoch: 9, Steps: 20 | Train Loss: 0.524 Vali Loss: 1.155 Vali Acc: 0.580 Test Loss: 1.155 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.3591771125793457
Epoch: 10, Steps: 20 | Train Loss: 0.506 Vali Loss: 1.288 Vali Acc: 0.520 Test Loss: 1.288 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.3907225131988525
Epoch: 11, Steps: 20 | Train Loss: 0.360 Vali Loss: 1.989 Vali Acc: 0.500 Test Loss: 1.989 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 5895042
model size : 22.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.277756214141846
Epoch: 1, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.822 Vali Acc: 0.480 Test Loss: 0.822 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 3.4544267654418945
Epoch: 2, Steps: 20 | Train Loss: 0.764 Vali Loss: 0.855 Vali Acc: 0.470 Test Loss: 0.855 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.943899393081665
Epoch: 3, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.854 Vali Acc: 0.450 Test Loss: 0.854 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.6049177646636963
Epoch: 4, Steps: 20 | Train Loss: 0.680 Vali Loss: 1.379 Vali Acc: 0.500 Test Loss: 1.379 Test Acc: 0.500
Validation loss decreased (-0.479992 --> -0.499986).  Saving model ...
Epoch: 5 cost time: 3.306361436843872
Epoch: 5, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.857 Vali Acc: 0.560 Test Loss: 0.857 Test Acc: 0.560
Validation loss decreased (-0.499986 --> -0.559991).  Saving model ...
Epoch: 6 cost time: 3.552258014678955
Epoch: 6, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.919 Vali Acc: 0.520 Test Loss: 0.919 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4705662727355957
Epoch: 7, Steps: 20 | Train Loss: 0.425 Vali Loss: 1.261 Vali Acc: 0.480 Test Loss: 1.261 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.5522992610931396
Epoch: 8, Steps: 20 | Train Loss: 0.360 Vali Loss: 1.158 Vali Acc: 0.530 Test Loss: 1.158 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.6374261379241943
Epoch: 9, Steps: 20 | Train Loss: 0.347 Vali Loss: 1.373 Vali Acc: 0.490 Test Loss: 1.373 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.910598039627075
Epoch: 10, Steps: 20 | Train Loss: 0.298 Vali Loss: 1.591 Vali Acc: 0.540 Test Loss: 1.591 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.044400215148926
Epoch: 11, Steps: 20 | Train Loss: 0.211 Vali Loss: 1.768 Vali Acc: 0.580 Test Loss: 1.768 Test Acc: 0.580
Validation loss decreased (-0.559991 --> -0.579982).  Saving model ...
Epoch: 12 cost time: 3.1248462200164795
Epoch: 12, Steps: 20 | Train Loss: 0.232 Vali Loss: 1.907 Vali Acc: 0.510 Test Loss: 1.907 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.0553267002105713
Epoch: 13, Steps: 20 | Train Loss: 0.124 Vali Loss: 2.026 Vali Acc: 0.530 Test Loss: 2.026 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.78450870513916
Epoch: 14, Steps: 20 | Train Loss: 0.154 Vali Loss: 2.098 Vali Acc: 0.620 Test Loss: 2.098 Test Acc: 0.620
Validation loss decreased (-0.579982 --> -0.619979).  Saving model ...
Epoch: 15 cost time: 2.5398757457733154
Epoch: 15, Steps: 20 | Train Loss: 0.287 Vali Loss: 3.357 Vali Acc: 0.510 Test Loss: 3.357 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8811347484588623
Epoch: 16, Steps: 20 | Train Loss: 0.174 Vali Loss: 3.266 Vali Acc: 0.520 Test Loss: 3.266 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.6952123641967773
Epoch: 17, Steps: 20 | Train Loss: 0.075 Vali Loss: 1.981 Vali Acc: 0.560 Test Loss: 1.981 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.515913486480713
Epoch: 18, Steps: 20 | Train Loss: 0.108 Vali Loss: 2.942 Vali Acc: 0.540 Test Loss: 2.942 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.1654438972473145
Epoch: 19, Steps: 20 | Train Loss: 0.143 Vali Loss: 2.969 Vali Acc: 0.510 Test Loss: 2.969 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.4398581981658936
Epoch: 20, Steps: 20 | Train Loss: 0.064 Vali Loss: 2.855 Vali Acc: 0.520 Test Loss: 2.855 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.9530792236328125
Epoch: 21, Steps: 20 | Train Loss: 0.088 Vali Loss: 3.939 Vali Acc: 0.510 Test Loss: 3.939 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.8099136352539062
Epoch: 22, Steps: 20 | Train Loss: 0.138 Vali Loss: 5.943 Vali Acc: 0.520 Test Loss: 5.943 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.389885425567627
Epoch: 23, Steps: 20 | Train Loss: 0.176 Vali Loss: 3.774 Vali Acc: 0.500 Test Loss: 3.774 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.620429754257202
Epoch: 24, Steps: 20 | Train Loss: 0.152 Vali Loss: 4.227 Vali Acc: 0.520 Test Loss: 4.227 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 5723138
model size : 22.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.269357204437256
Epoch: 1, Steps: 20 | Train Loss: 0.781 Vali Loss: 0.832 Vali Acc: 0.530 Test Loss: 0.832 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 3.5705718994140625
Epoch: 2, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.791 Vali Acc: 0.520 Test Loss: 0.791 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.521000385284424
Epoch: 3, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.942 Vali Acc: 0.490 Test Loss: 0.942 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.1405370235443115
Epoch: 4, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.865 Vali Acc: 0.560 Test Loss: 0.865 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559991).  Saving model ...
Epoch: 5 cost time: 3.2127037048339844
Epoch: 5, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.965 Vali Acc: 0.550 Test Loss: 0.965 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5394773483276367
Epoch: 6, Steps: 20 | Train Loss: 0.529 Vali Loss: 1.378 Vali Acc: 0.570 Test Loss: 1.378 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569986).  Saving model ...
Epoch: 7 cost time: 3.3146843910217285
Epoch: 7, Steps: 20 | Train Loss: 0.501 Vali Loss: 0.925 Vali Acc: 0.510 Test Loss: 0.925 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2225704193115234
Epoch: 8, Steps: 20 | Train Loss: 0.430 Vali Loss: 1.163 Vali Acc: 0.600 Test Loss: 1.163 Test Acc: 0.600
Validation loss decreased (-0.569986 --> -0.599988).  Saving model ...
Epoch: 9 cost time: 2.6835663318634033
Epoch: 9, Steps: 20 | Train Loss: 0.328 Vali Loss: 1.379 Vali Acc: 0.510 Test Loss: 1.379 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.708979845046997
Epoch: 10, Steps: 20 | Train Loss: 0.279 Vali Loss: 1.476 Vali Acc: 0.540 Test Loss: 1.476 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.915740489959717
Epoch: 11, Steps: 20 | Train Loss: 0.309 Vali Loss: 1.758 Vali Acc: 0.590 Test Loss: 1.758 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.910149097442627
Epoch: 12, Steps: 20 | Train Loss: 0.265 Vali Loss: 1.816 Vali Acc: 0.520 Test Loss: 1.816 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.40606427192688
Epoch: 13, Steps: 20 | Train Loss: 0.182 Vali Loss: 2.026 Vali Acc: 0.530 Test Loss: 2.026 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.4796526432037354
Epoch: 14, Steps: 20 | Train Loss: 0.172 Vali Loss: 2.153 Vali Acc: 0.560 Test Loss: 2.153 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.2131688594818115
Epoch: 15, Steps: 20 | Train Loss: 0.075 Vali Loss: 2.685 Vali Acc: 0.510 Test Loss: 2.685 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.105558395385742
Epoch: 16, Steps: 20 | Train Loss: 0.213 Vali Loss: 2.669 Vali Acc: 0.480 Test Loss: 2.669 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.5450901985168457
Epoch: 17, Steps: 20 | Train Loss: 0.113 Vali Loss: 2.778 Vali Acc: 0.530 Test Loss: 2.778 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.1296026706695557
Epoch: 18, Steps: 20 | Train Loss: 0.138 Vali Loss: 3.584 Vali Acc: 0.550 Test Loss: 3.584 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 5723266
model size : 22.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.001492023468018
Epoch: 1, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.714 Vali Acc: 0.540 Test Loss: 0.714 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 3.2785634994506836
Epoch: 2, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.725 Vali Acc: 0.550 Test Loss: 0.725 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 3.1634414196014404
Epoch: 3, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.719 Vali Acc: 0.600 Test Loss: 0.719 Test Acc: 0.600
Validation loss decreased (-0.549993 --> -0.599993).  Saving model ...
Epoch: 4 cost time: 2.561523199081421
Epoch: 4, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.814 Vali Acc: 0.550 Test Loss: 0.814 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2422099113464355
Epoch: 5, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.850 Vali Acc: 0.590 Test Loss: 0.850 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.734419584274292
Epoch: 6, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.962 Vali Acc: 0.500 Test Loss: 0.962 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.083470106124878
Epoch: 7, Steps: 20 | Train Loss: 0.403 Vali Loss: 0.912 Vali Acc: 0.580 Test Loss: 0.912 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.2883658409118652
Epoch: 8, Steps: 20 | Train Loss: 0.429 Vali Loss: 1.024 Vali Acc: 0.620 Test Loss: 1.024 Test Acc: 0.620
Validation loss decreased (-0.599993 --> -0.619990).  Saving model ...
Epoch: 9 cost time: 2.873744249343872
Epoch: 9, Steps: 20 | Train Loss: 0.351 Vali Loss: 1.106 Vali Acc: 0.540 Test Loss: 1.106 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8138654232025146
Epoch: 10, Steps: 20 | Train Loss: 0.242 Vali Loss: 1.238 Vali Acc: 0.590 Test Loss: 1.238 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3729448318481445
Epoch: 11, Steps: 20 | Train Loss: 0.257 Vali Loss: 1.444 Vali Acc: 0.500 Test Loss: 1.444 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.8521745204925537
Epoch: 12, Steps: 20 | Train Loss: 0.237 Vali Loss: 1.814 Vali Acc: 0.530 Test Loss: 1.814 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.8728883266448975
Epoch: 13, Steps: 20 | Train Loss: 0.178 Vali Loss: 1.603 Vali Acc: 0.560 Test Loss: 1.603 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.8849740028381348
Epoch: 14, Steps: 20 | Train Loss: 0.179 Vali Loss: 2.609 Vali Acc: 0.520 Test Loss: 2.609 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.7555432319641113
Epoch: 15, Steps: 20 | Train Loss: 0.135 Vali Loss: 2.239 Vali Acc: 0.520 Test Loss: 2.239 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.737041473388672
Epoch: 16, Steps: 20 | Train Loss: 0.072 Vali Loss: 2.096 Vali Acc: 0.520 Test Loss: 2.096 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.6187660694122314
Epoch: 17, Steps: 20 | Train Loss: 0.057 Vali Loss: 1.895 Vali Acc: 0.580 Test Loss: 1.895 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.910303831100464
Epoch: 18, Steps: 20 | Train Loss: 0.029 Vali Loss: 2.478 Vali Acc: 0.540 Test Loss: 2.478 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 5651714
model size : 21.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.348050355911255
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.750 Vali Acc: 0.520 Test Loss: 0.750 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.700284004211426
Epoch: 2, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.842 Vali Acc: 0.480 Test Loss: 0.842 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.515907049179077
Epoch: 3, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.795 Vali Acc: 0.480 Test Loss: 0.795 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.620849609375
Epoch: 4, Steps: 20 | Train Loss: 0.637 Vali Loss: 1.056 Vali Acc: 0.500 Test Loss: 1.056 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.2461764812469482
Epoch: 5, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.885 Vali Acc: 0.530 Test Loss: 0.885 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529991).  Saving model ...
Epoch: 6 cost time: 3.18918514251709
Epoch: 6, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.884 Vali Acc: 0.510 Test Loss: 0.884 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2227022647857666
Epoch: 7, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.948 Vali Acc: 0.560 Test Loss: 0.948 Test Acc: 0.560
Validation loss decreased (-0.529991 --> -0.559991).  Saving model ...
Epoch: 8 cost time: 2.731797933578491
Epoch: 8, Steps: 20 | Train Loss: 0.339 Vali Loss: 0.889 Vali Acc: 0.550 Test Loss: 0.889 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.706341505050659
Epoch: 9, Steps: 20 | Train Loss: 0.318 Vali Loss: 1.168 Vali Acc: 0.470 Test Loss: 1.168 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1192636489868164
Epoch: 10, Steps: 20 | Train Loss: 0.256 Vali Loss: 0.980 Vali Acc: 0.590 Test Loss: 0.980 Test Acc: 0.590
Validation loss decreased (-0.559991 --> -0.589990).  Saving model ...
Epoch: 11 cost time: 3.1566483974456787
Epoch: 11, Steps: 20 | Train Loss: 0.162 Vali Loss: 1.175 Vali Acc: 0.530 Test Loss: 1.175 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.130605697631836
Epoch: 12, Steps: 20 | Train Loss: 0.125 Vali Loss: 1.567 Vali Acc: 0.530 Test Loss: 1.567 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.0972559452056885
Epoch: 13, Steps: 20 | Train Loss: 0.147 Vali Loss: 1.416 Vali Acc: 0.530 Test Loss: 1.416 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.768615484237671
Epoch: 14, Steps: 20 | Train Loss: 0.125 Vali Loss: 1.600 Vali Acc: 0.530 Test Loss: 1.600 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.665376663208008
Epoch: 15, Steps: 20 | Train Loss: 0.059 Vali Loss: 1.589 Vali Acc: 0.540 Test Loss: 1.589 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.840332508087158
Epoch: 16, Steps: 20 | Train Loss: 0.058 Vali Loss: 2.412 Vali Acc: 0.500 Test Loss: 2.412 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.685333013534546
Epoch: 17, Steps: 20 | Train Loss: 0.089 Vali Loss: 1.833 Vali Acc: 0.570 Test Loss: 1.833 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.7590692043304443
Epoch: 18, Steps: 20 | Train Loss: 0.044 Vali Loss: 2.378 Vali Acc: 0.510 Test Loss: 2.378 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.5639913082122803
Epoch: 19, Steps: 20 | Train Loss: 0.089 Vali Loss: 2.279 Vali Acc: 0.510 Test Loss: 2.279 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.545658588409424
Epoch: 20, Steps: 20 | Train Loss: 0.069 Vali Loss: 2.524 Vali Acc: 0.560 Test Loss: 2.524 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 5623426
model size : 21.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.524305582046509
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.700 Vali Acc: 0.560 Test Loss: 0.700 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.8262505531311035
Epoch: 2, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.775 Vali Acc: 0.490 Test Loss: 0.775 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.948282241821289
Epoch: 3, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.776 Vali Acc: 0.530 Test Loss: 0.776 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.9160971641540527
Epoch: 4, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.886 Vali Acc: 0.530 Test Loss: 0.886 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.606612205505371
Epoch: 5, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.748 Vali Acc: 0.510 Test Loss: 0.748 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.6283628940582275
Epoch: 6, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.744 Vali Acc: 0.540 Test Loss: 0.744 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.4807629585266113
Epoch: 7, Steps: 20 | Train Loss: 0.435 Vali Loss: 1.027 Vali Acc: 0.550 Test Loss: 1.027 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.926253080368042
Epoch: 8, Steps: 20 | Train Loss: 0.383 Vali Loss: 0.890 Vali Acc: 0.560 Test Loss: 0.890 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.865447521209717
Epoch: 9, Steps: 20 | Train Loss: 0.317 Vali Loss: 1.029 Vali Acc: 0.540 Test Loss: 1.029 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.700575351715088
Epoch: 10, Steps: 20 | Train Loss: 0.278 Vali Loss: 1.016 Vali Acc: 0.580 Test Loss: 1.016 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579990).  Saving model ...
Epoch: 11 cost time: 2.5741968154907227
Epoch: 11, Steps: 20 | Train Loss: 0.260 Vali Loss: 1.242 Vali Acc: 0.480 Test Loss: 1.242 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.652573585510254
Epoch: 12, Steps: 20 | Train Loss: 0.194 Vali Loss: 1.190 Vali Acc: 0.590 Test Loss: 1.190 Test Acc: 0.590
Validation loss decreased (-0.579990 --> -0.589988).  Saving model ...
Epoch: 13 cost time: 2.6248347759246826
Epoch: 13, Steps: 20 | Train Loss: 0.183 Vali Loss: 1.446 Vali Acc: 0.540 Test Loss: 1.446 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5436882972717285
Epoch: 14, Steps: 20 | Train Loss: 0.139 Vali Loss: 1.686 Vali Acc: 0.490 Test Loss: 1.686 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6695339679718018
Epoch: 15, Steps: 20 | Train Loss: 0.106 Vali Loss: 1.496 Vali Acc: 0.550 Test Loss: 1.496 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.5361218452453613
Epoch: 16, Steps: 20 | Train Loss: 0.103 Vali Loss: 1.585 Vali Acc: 0.600 Test Loss: 1.585 Test Acc: 0.600
Validation loss decreased (-0.589988 --> -0.599984).  Saving model ...
Epoch: 17 cost time: 2.6053779125213623
Epoch: 17, Steps: 20 | Train Loss: 0.051 Vali Loss: 1.788 Vali Acc: 0.560 Test Loss: 1.788 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.7356820106506348
Epoch: 18, Steps: 20 | Train Loss: 0.027 Vali Loss: 1.468 Vali Acc: 0.580 Test Loss: 1.468 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.162414312362671
Epoch: 19, Steps: 20 | Train Loss: 0.033 Vali Loss: 1.676 Vali Acc: 0.540 Test Loss: 1.676 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8754539489746094
Epoch: 20, Steps: 20 | Train Loss: 0.014 Vali Loss: 1.735 Vali Acc: 0.550 Test Loss: 1.735 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.7271039485931396
Epoch: 21, Steps: 20 | Train Loss: 0.030 Vali Loss: 1.892 Vali Acc: 0.570 Test Loss: 1.892 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.859611988067627
Epoch: 22, Steps: 20 | Train Loss: 0.017 Vali Loss: 2.170 Vali Acc: 0.490 Test Loss: 2.170 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.9102256298065186
Epoch: 23, Steps: 20 | Train Loss: 0.017 Vali Loss: 2.445 Vali Acc: 0.560 Test Loss: 2.445 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.964478015899658
Epoch: 24, Steps: 20 | Train Loss: 0.015 Vali Loss: 2.487 Vali Acc: 0.600 Test Loss: 2.487 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.7923452854156494
Epoch: 25, Steps: 20 | Train Loss: 0.134 Vali Loss: 2.523 Vali Acc: 0.560 Test Loss: 2.523 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.624398708343506
Epoch: 26, Steps: 20 | Train Loss: 0.062 Vali Loss: 3.534 Vali Acc: 0.540 Test Loss: 3.534 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 5609346
model size : 21.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.276690721511841
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.722 Vali Acc: 0.550 Test Loss: 0.722 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.2785608768463135
Epoch: 2, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.757 Vali Acc: 0.550 Test Loss: 0.757 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.951335906982422
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.828 Vali Acc: 0.540 Test Loss: 0.828 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.795498847961426
Epoch: 4, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.923 Vali Acc: 0.490 Test Loss: 0.923 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8353631496429443
Epoch: 5, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.817 Vali Acc: 0.530 Test Loss: 0.817 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.6477627754211426
Epoch: 6, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.787 Vali Acc: 0.560 Test Loss: 0.787 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 7 cost time: 2.463515281677246
Epoch: 7, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.870 Vali Acc: 0.610 Test Loss: 0.870 Test Acc: 0.610
Validation loss decreased (-0.559992 --> -0.609991).  Saving model ...
Epoch: 8 cost time: 3.420468330383301
Epoch: 8, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.853 Vali Acc: 0.570 Test Loss: 0.853 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.894841432571411
Epoch: 9, Steps: 20 | Train Loss: 0.373 Vali Loss: 0.956 Vali Acc: 0.540 Test Loss: 0.956 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.7263550758361816
Epoch: 10, Steps: 20 | Train Loss: 0.328 Vali Loss: 0.877 Vali Acc: 0.610 Test Loss: 0.877 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.700998544692993
Epoch: 11, Steps: 20 | Train Loss: 0.269 Vali Loss: 0.849 Vali Acc: 0.640 Test Loss: 0.849 Test Acc: 0.640
Validation loss decreased (-0.609991 --> -0.639992).  Saving model ...
Epoch: 12 cost time: 3.369486093521118
Epoch: 12, Steps: 20 | Train Loss: 0.275 Vali Loss: 1.417 Vali Acc: 0.530 Test Loss: 1.417 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.065321922302246
Epoch: 13, Steps: 20 | Train Loss: 0.275 Vali Loss: 1.012 Vali Acc: 0.590 Test Loss: 1.012 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.7754099369049072
Epoch: 14, Steps: 20 | Train Loss: 0.139 Vali Loss: 1.183 Vali Acc: 0.530 Test Loss: 1.183 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.573099374771118
Epoch: 15, Steps: 20 | Train Loss: 0.092 Vali Loss: 1.402 Vali Acc: 0.520 Test Loss: 1.402 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.4218666553497314
Epoch: 16, Steps: 20 | Train Loss: 0.096 Vali Loss: 1.401 Vali Acc: 0.550 Test Loss: 1.401 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.8419811725616455
Epoch: 17, Steps: 20 | Train Loss: 0.065 Vali Loss: 1.797 Vali Acc: 0.600 Test Loss: 1.797 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.859219551086426
Epoch: 18, Steps: 20 | Train Loss: 0.072 Vali Loss: 1.825 Vali Acc: 0.560 Test Loss: 1.825 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.16514253616333
Epoch: 19, Steps: 20 | Train Loss: 0.038 Vali Loss: 1.622 Vali Acc: 0.560 Test Loss: 1.622 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.733506917953491
Epoch: 20, Steps: 20 | Train Loss: 0.054 Vali Loss: 1.741 Vali Acc: 0.570 Test Loss: 1.741 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.6768436431884766
Epoch: 21, Steps: 20 | Train Loss: 0.015 Vali Loss: 2.051 Vali Acc: 0.550 Test Loss: 2.051 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 5595394
model size : 21.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.676008939743042
Epoch: 1, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.754 Vali Acc: 0.530 Test Loss: 0.754 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 3.002390146255493
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.779 Vali Acc: 0.450 Test Loss: 0.779 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7340500354766846
Epoch: 3, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.748 Vali Acc: 0.580 Test Loss: 0.748 Test Acc: 0.580
Validation loss decreased (-0.529992 --> -0.579993).  Saving model ...
Epoch: 4 cost time: 2.785435199737549
Epoch: 4, Steps: 20 | Train Loss: 0.777 Vali Loss: 0.958 Vali Acc: 0.510 Test Loss: 0.958 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6581308841705322
Epoch: 5, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.832 Vali Acc: 0.510 Test Loss: 0.832 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.970783233642578
Epoch: 6, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.865 Vali Acc: 0.590 Test Loss: 0.865 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589991).  Saving model ...
Epoch: 7 cost time: 2.677013874053955
Epoch: 7, Steps: 20 | Train Loss: 0.512 Vali Loss: 1.010 Vali Acc: 0.540 Test Loss: 1.010 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.046721935272217
Epoch: 8, Steps: 20 | Train Loss: 0.553 Vali Loss: 1.050 Vali Acc: 0.580 Test Loss: 1.050 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1455535888671875
Epoch: 9, Steps: 20 | Train Loss: 0.551 Vali Loss: 1.173 Vali Acc: 0.530 Test Loss: 1.173 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2686047554016113
Epoch: 10, Steps: 20 | Train Loss: 0.535 Vali Loss: 1.000 Vali Acc: 0.610 Test Loss: 1.000 Test Acc: 0.610
Validation loss decreased (-0.589991 --> -0.609990).  Saving model ...
Epoch: 11 cost time: 2.93769907951355
Epoch: 11, Steps: 20 | Train Loss: 0.490 Vali Loss: 1.376 Vali Acc: 0.440 Test Loss: 1.376 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8395659923553467
Epoch: 12, Steps: 20 | Train Loss: 0.411 Vali Loss: 1.104 Vali Acc: 0.590 Test Loss: 1.104 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6543185710906982
Epoch: 13, Steps: 20 | Train Loss: 0.359 Vali Loss: 1.391 Vali Acc: 0.560 Test Loss: 1.391 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.1682701110839844
Epoch: 14, Steps: 20 | Train Loss: 0.349 Vali Loss: 1.980 Vali Acc: 0.490 Test Loss: 1.980 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.002825975418091
Epoch: 15, Steps: 20 | Train Loss: 0.283 Vali Loss: 1.479 Vali Acc: 0.550 Test Loss: 1.479 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.9297749996185303
Epoch: 16, Steps: 20 | Train Loss: 0.211 Vali Loss: 1.637 Vali Acc: 0.560 Test Loss: 1.637 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.6277005672454834
Epoch: 17, Steps: 20 | Train Loss: 0.178 Vali Loss: 1.702 Vali Acc: 0.560 Test Loss: 1.702 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.8266513347625732
Epoch: 18, Steps: 20 | Train Loss: 0.134 Vali Loss: 2.133 Vali Acc: 0.580 Test Loss: 2.133 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.126042366027832
Epoch: 19, Steps: 20 | Train Loss: 0.253 Vali Loss: 2.061 Vali Acc: 0.560 Test Loss: 2.061 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.9471354484558105
Epoch: 20, Steps: 20 | Train Loss: 0.152 Vali Loss: 2.070 Vali Acc: 0.540 Test Loss: 2.070 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1784258
model size : 6.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.68933629989624
Epoch: 1, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.714 Vali Acc: 0.510 Test Loss: 0.714 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.928187608718872
Epoch: 2, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.705 Vali Acc: 0.570 Test Loss: 0.705 Test Acc: 0.570
Validation loss decreased (-0.509993 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 2.354566812515259
Epoch: 3, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.755 Vali Acc: 0.610 Test Loss: 0.755 Test Acc: 0.610
Validation loss decreased (-0.569993 --> -0.609992).  Saving model ...
Epoch: 4 cost time: 2.5008039474487305
Epoch: 4, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.884 Vali Acc: 0.520 Test Loss: 0.884 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8892126083374023
Epoch: 5, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.866 Vali Acc: 0.510 Test Loss: 0.866 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.757310390472412
Epoch: 6, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.933 Vali Acc: 0.610 Test Loss: 0.933 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7700319290161133
Epoch: 7, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.961 Vali Acc: 0.540 Test Loss: 0.961 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.173107147216797
Epoch: 8, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.890 Vali Acc: 0.550 Test Loss: 0.890 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.1152291297912598
Epoch: 9, Steps: 20 | Train Loss: 0.386 Vali Loss: 0.817 Vali Acc: 0.560 Test Loss: 0.817 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.805011749267578
Epoch: 10, Steps: 20 | Train Loss: 0.326 Vali Loss: 0.983 Vali Acc: 0.570 Test Loss: 0.983 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.4810383319854736
Epoch: 11, Steps: 20 | Train Loss: 0.293 Vali Loss: 1.122 Vali Acc: 0.530 Test Loss: 1.122 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.4104435443878174
Epoch: 12, Steps: 20 | Train Loss: 0.221 Vali Loss: 1.002 Vali Acc: 0.590 Test Loss: 1.002 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.305788516998291
Epoch: 13, Steps: 20 | Train Loss: 0.216 Vali Loss: 1.474 Vali Acc: 0.540 Test Loss: 1.474 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1698306
model size : 6.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.050684928894043
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.714 Vali Acc: 0.460 Test Loss: 0.714 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 2.5251529216766357
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.740 Vali Acc: 0.550 Test Loss: 0.740 Test Acc: 0.550
Validation loss decreased (-0.459993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 2.207562208175659
Epoch: 3, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.784 Vali Acc: 0.540 Test Loss: 0.784 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.415144681930542
Epoch: 4, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.757 Vali Acc: 0.530 Test Loss: 0.757 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.526217460632324
Epoch: 5, Steps: 20 | Train Loss: 0.510 Vali Loss: 1.042 Vali Acc: 0.530 Test Loss: 1.042 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3367559909820557
Epoch: 6, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.789 Vali Acc: 0.500 Test Loss: 0.789 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.2923314571380615
Epoch: 7, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.965 Vali Acc: 0.500 Test Loss: 0.965 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.5277466773986816
Epoch: 8, Steps: 20 | Train Loss: 0.382 Vali Loss: 0.803 Vali Acc: 0.580 Test Loss: 0.803 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579992).  Saving model ...
Epoch: 9 cost time: 2.1200125217437744
Epoch: 9, Steps: 20 | Train Loss: 0.328 Vali Loss: 1.248 Vali Acc: 0.520 Test Loss: 1.248 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3337066173553467
Epoch: 10, Steps: 20 | Train Loss: 0.290 Vali Loss: 0.979 Vali Acc: 0.540 Test Loss: 0.979 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.50140118598938
Epoch: 11, Steps: 20 | Train Loss: 0.245 Vali Loss: 1.139 Vali Acc: 0.580 Test Loss: 1.139 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4846208095550537
Epoch: 12, Steps: 20 | Train Loss: 0.223 Vali Loss: 1.159 Vali Acc: 0.560 Test Loss: 1.159 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.371011972427368
Epoch: 13, Steps: 20 | Train Loss: 0.177 Vali Loss: 1.243 Vali Acc: 0.530 Test Loss: 1.243 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3288052082061768
Epoch: 14, Steps: 20 | Train Loss: 0.200 Vali Loss: 1.406 Vali Acc: 0.560 Test Loss: 1.406 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.2889564037323
Epoch: 15, Steps: 20 | Train Loss: 0.121 Vali Loss: 1.899 Vali Acc: 0.510 Test Loss: 1.899 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.1942412853240967
Epoch: 16, Steps: 20 | Train Loss: 0.157 Vali Loss: 1.832 Vali Acc: 0.490 Test Loss: 1.832 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.521651029586792
Epoch: 17, Steps: 20 | Train Loss: 0.156 Vali Loss: 2.429 Vali Acc: 0.490 Test Loss: 2.429 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.5685529708862305
Epoch: 18, Steps: 20 | Train Loss: 0.105 Vali Loss: 1.957 Vali Acc: 0.550 Test Loss: 1.957 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1698370
model size : 6.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.514124631881714
Epoch: 1, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.739 Vali Acc: 0.470 Test Loss: 0.739 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 2.6668403148651123
Epoch: 2, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.719 Vali Acc: 0.550 Test Loss: 0.719 Test Acc: 0.550
Validation loss decreased (-0.469993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 2.4563310146331787
Epoch: 3, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.718 Vali Acc: 0.530 Test Loss: 0.718 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7670307159423828
Epoch: 4, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.820 Vali Acc: 0.510 Test Loss: 0.820 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6803672313690186
Epoch: 5, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.973 Vali Acc: 0.480 Test Loss: 0.973 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.770078182220459
Epoch: 6, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.756 Vali Acc: 0.560 Test Loss: 0.756 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 7 cost time: 1.8598744869232178
Epoch: 7, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.885 Vali Acc: 0.540 Test Loss: 0.885 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8363068103790283
Epoch: 8, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.896 Vali Acc: 0.540 Test Loss: 0.896 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.074932098388672
Epoch: 9, Steps: 20 | Train Loss: 0.411 Vali Loss: 1.027 Vali Acc: 0.480 Test Loss: 1.027 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.637160539627075
Epoch: 10, Steps: 20 | Train Loss: 0.398 Vali Loss: 0.996 Vali Acc: 0.520 Test Loss: 0.996 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0288541316986084
Epoch: 11, Steps: 20 | Train Loss: 0.346 Vali Loss: 1.034 Vali Acc: 0.530 Test Loss: 1.034 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.480656623840332
Epoch: 12, Steps: 20 | Train Loss: 0.279 Vali Loss: 1.140 Vali Acc: 0.510 Test Loss: 1.140 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.148902177810669
Epoch: 13, Steps: 20 | Train Loss: 0.211 Vali Loss: 1.192 Vali Acc: 0.530 Test Loss: 1.192 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.427563190460205
Epoch: 14, Steps: 20 | Train Loss: 0.209 Vali Loss: 1.340 Vali Acc: 0.540 Test Loss: 1.340 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.7171483039855957
Epoch: 15, Steps: 20 | Train Loss: 0.146 Vali Loss: 1.437 Vali Acc: 0.540 Test Loss: 1.437 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.5114243030548096
Epoch: 16, Steps: 20 | Train Loss: 0.117 Vali Loss: 1.523 Vali Acc: 0.530 Test Loss: 1.523 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1662594
model size : 6.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.084713459014893
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.697 Vali Acc: 0.520 Test Loss: 0.697 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.086517810821533
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.791 Vali Acc: 0.500 Test Loss: 0.791 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7456021308898926
Epoch: 3, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.882 Vali Acc: 0.460 Test Loss: 0.882 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9351491928100586
Epoch: 4, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.874 Vali Acc: 0.520 Test Loss: 0.874 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9696567058563232
Epoch: 5, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.798 Vali Acc: 0.500 Test Loss: 0.798 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8566267490386963
Epoch: 6, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.823 Vali Acc: 0.550 Test Loss: 0.823 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549992).  Saving model ...
Epoch: 7 cost time: 2.2030417919158936
Epoch: 7, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.961 Vali Acc: 0.550 Test Loss: 0.961 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5564301013946533
Epoch: 8, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.810 Vali Acc: 0.550 Test Loss: 0.810 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549992).  Saving model ...
Epoch: 9 cost time: 2.2284388542175293
Epoch: 9, Steps: 20 | Train Loss: 0.420 Vali Loss: 0.812 Vali Acc: 0.560 Test Loss: 0.812 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 10 cost time: 2.3212478160858154
Epoch: 10, Steps: 20 | Train Loss: 0.420 Vali Loss: 0.860 Vali Acc: 0.590 Test Loss: 0.860 Test Acc: 0.590
Validation loss decreased (-0.559992 --> -0.589991).  Saving model ...
Epoch: 11 cost time: 2.385180711746216
Epoch: 11, Steps: 20 | Train Loss: 0.357 Vali Loss: 0.882 Vali Acc: 0.540 Test Loss: 0.882 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9942429065704346
Epoch: 12, Steps: 20 | Train Loss: 0.280 Vali Loss: 0.926 Vali Acc: 0.530 Test Loss: 0.926 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9731881618499756
Epoch: 13, Steps: 20 | Train Loss: 0.232 Vali Loss: 0.953 Vali Acc: 0.510 Test Loss: 0.953 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.5616683959960938
Epoch: 14, Steps: 20 | Train Loss: 0.177 Vali Loss: 1.043 Vali Acc: 0.530 Test Loss: 1.043 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.2572386264801025
Epoch: 15, Steps: 20 | Train Loss: 0.181 Vali Loss: 1.070 Vali Acc: 0.560 Test Loss: 1.070 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.500201463699341
Epoch: 16, Steps: 20 | Train Loss: 0.110 Vali Loss: 1.069 Vali Acc: 0.540 Test Loss: 1.069 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.1630499362945557
Epoch: 17, Steps: 20 | Train Loss: 0.079 Vali Loss: 1.258 Vali Acc: 0.550 Test Loss: 1.258 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.38594651222229
Epoch: 18, Steps: 20 | Train Loss: 0.125 Vali Loss: 1.679 Vali Acc: 0.530 Test Loss: 1.679 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7347307205200195
Epoch: 19, Steps: 20 | Train Loss: 0.107 Vali Loss: 1.381 Vali Acc: 0.590 Test Loss: 1.381 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7755467891693115
Epoch: 20, Steps: 20 | Train Loss: 0.109 Vali Loss: 1.812 Vali Acc: 0.550 Test Loss: 1.812 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1648450
model size : 6.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.495222806930542
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.7368407249450684
Epoch: 2, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.790 Vali Acc: 0.450 Test Loss: 0.790 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.775148630142212
Epoch: 3, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.708 Vali Acc: 0.510 Test Loss: 0.708 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 1.7969331741333008
Epoch: 4, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.742 Vali Acc: 0.570 Test Loss: 0.742 Test Acc: 0.570
Validation loss decreased (-0.509993 --> -0.569993).  Saving model ...
Epoch: 5 cost time: 1.8468592166900635
Epoch: 5, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.768 Vali Acc: 0.480 Test Loss: 0.768 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1963698863983154
Epoch: 6, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.801 Vali Acc: 0.510 Test Loss: 0.801 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9293243885040283
Epoch: 7, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.945 Vali Acc: 0.500 Test Loss: 0.945 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.162493944168091
Epoch: 8, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.833 Vali Acc: 0.530 Test Loss: 0.833 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.094994068145752
Epoch: 9, Steps: 20 | Train Loss: 0.436 Vali Loss: 0.795 Vali Acc: 0.530 Test Loss: 0.795 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0440402030944824
Epoch: 10, Steps: 20 | Train Loss: 0.397 Vali Loss: 0.796 Vali Acc: 0.540 Test Loss: 0.796 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.5761892795562744
Epoch: 11, Steps: 20 | Train Loss: 0.384 Vali Loss: 0.869 Vali Acc: 0.530 Test Loss: 0.869 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.0976247787475586
Epoch: 12, Steps: 20 | Train Loss: 0.322 Vali Loss: 0.910 Vali Acc: 0.550 Test Loss: 0.910 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.284003496170044
Epoch: 13, Steps: 20 | Train Loss: 0.275 Vali Loss: 0.835 Vali Acc: 0.540 Test Loss: 0.835 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5357229709625244
Epoch: 14, Steps: 20 | Train Loss: 0.222 Vali Loss: 1.003 Vali Acc: 0.540 Test Loss: 1.003 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1641410
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.186050176620483
Epoch: 1, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.721 Vali Acc: 0.520 Test Loss: 0.721 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.2386178970336914
Epoch: 2, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.748 Vali Acc: 0.470 Test Loss: 0.748 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.33821964263916
Epoch: 3, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.719 Vali Acc: 0.580 Test Loss: 0.719 Test Acc: 0.580
Validation loss decreased (-0.519993 --> -0.579993).  Saving model ...
Epoch: 4 cost time: 2.019907236099243
Epoch: 4, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.851 Vali Acc: 0.530 Test Loss: 0.851 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9574201107025146
Epoch: 5, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.777 Vali Acc: 0.460 Test Loss: 0.777 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.404280424118042
Epoch: 6, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.844 Vali Acc: 0.450 Test Loss: 0.844 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1271283626556396
Epoch: 7, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.721 Vali Acc: 0.550 Test Loss: 0.721 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.365973711013794
Epoch: 8, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.789 Vali Acc: 0.520 Test Loss: 0.789 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.281789779663086
Epoch: 9, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.917 Vali Acc: 0.530 Test Loss: 0.917 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.556257724761963
Epoch: 10, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.901 Vali Acc: 0.560 Test Loss: 0.901 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.350304126739502
Epoch: 11, Steps: 20 | Train Loss: 0.395 Vali Loss: 0.878 Vali Acc: 0.540 Test Loss: 0.878 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.1669270992279053
Epoch: 12, Steps: 20 | Train Loss: 0.363 Vali Loss: 0.862 Vali Acc: 0.510 Test Loss: 0.862 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.583660125732422
Epoch: 13, Steps: 20 | Train Loss: 0.301 Vali Loss: 0.885 Vali Acc: 0.540 Test Loss: 0.885 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1634434
model size : 6.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.625352144241333
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.1180355548858643
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.763 Vali Acc: 0.520 Test Loss: 0.763 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 2.0294737815856934
Epoch: 3, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.907 Vali Acc: 0.510 Test Loss: 0.907 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.609238624572754
Epoch: 4, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.736 Vali Acc: 0.550 Test Loss: 0.736 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 1.9527995586395264
Epoch: 5, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.731 Vali Acc: 0.520 Test Loss: 0.731 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5790793895721436
Epoch: 6, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.706 Vali Acc: 0.610 Test Loss: 0.706 Test Acc: 0.610
Validation loss decreased (-0.549993 --> -0.609993).  Saving model ...
Epoch: 7 cost time: 2.1445107460021973
Epoch: 7, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.977 Vali Acc: 0.500 Test Loss: 0.977 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6804721355438232
Epoch: 8, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.769 Vali Acc: 0.580 Test Loss: 0.769 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9821858406066895
Epoch: 9, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.990 Vali Acc: 0.560 Test Loss: 0.990 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0143139362335205
Epoch: 10, Steps: 20 | Train Loss: 0.539 Vali Loss: 1.080 Vali Acc: 0.480 Test Loss: 1.080 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8728275299072266
Epoch: 11, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.869 Vali Acc: 0.620 Test Loss: 0.869 Test Acc: 0.620
Validation loss decreased (-0.609993 --> -0.619991).  Saving model ...
Epoch: 12 cost time: 1.3607048988342285
Epoch: 12, Steps: 20 | Train Loss: 0.436 Vali Loss: 0.981 Vali Acc: 0.610 Test Loss: 0.981 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9106404781341553
Epoch: 13, Steps: 20 | Train Loss: 0.346 Vali Loss: 0.981 Vali Acc: 0.600 Test Loss: 0.981 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8000075817108154
Epoch: 14, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.290 Vali Acc: 0.540 Test Loss: 1.290 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.088702440261841
Epoch: 15, Steps: 20 | Train Loss: 0.274 Vali Loss: 1.013 Vali Acc: 0.590 Test Loss: 1.013 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7913901805877686
Epoch: 16, Steps: 20 | Train Loss: 0.227 Vali Loss: 1.392 Vali Acc: 0.500 Test Loss: 1.392 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.028165340423584
Epoch: 17, Steps: 20 | Train Loss: 0.190 Vali Loss: 1.311 Vali Acc: 0.520 Test Loss: 1.311 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.902757167816162
Epoch: 18, Steps: 20 | Train Loss: 0.204 Vali Loss: 1.512 Vali Acc: 0.510 Test Loss: 1.512 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7813429832458496
Epoch: 19, Steps: 20 | Train Loss: 0.148 Vali Loss: 1.617 Vali Acc: 0.540 Test Loss: 1.617 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6186299324035645
Epoch: 20, Steps: 20 | Train Loss: 0.117 Vali Loss: 1.711 Vali Acc: 0.540 Test Loss: 1.711 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.648557186126709
Epoch: 21, Steps: 20 | Train Loss: 0.110 Vali Loss: 1.977 Vali Acc: 0.620 Test Loss: 1.977 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 601314
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.23459792137146
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.723 Vali Acc: 0.450 Test Loss: 0.723 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.091430425643921
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.770 Vali Acc: 0.440 Test Loss: 0.770 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.338428258895874
Epoch: 3, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.759 Vali Acc: 0.600 Test Loss: 0.759 Test Acc: 0.600
Validation loss decreased (-0.449993 --> -0.599992).  Saving model ...
Epoch: 4 cost time: 1.3291585445404053
Epoch: 4, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.772 Vali Acc: 0.550 Test Loss: 0.772 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.320805549621582
Epoch: 5, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.801 Vali Acc: 0.520 Test Loss: 0.801 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3927009105682373
Epoch: 6, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.874 Vali Acc: 0.480 Test Loss: 0.874 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3061890602111816
Epoch: 7, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.861 Vali Acc: 0.520 Test Loss: 0.861 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.399376630783081
Epoch: 8, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.802 Vali Acc: 0.530 Test Loss: 0.802 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4253003597259521
Epoch: 9, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.994 Vali Acc: 0.500 Test Loss: 0.994 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3115675449371338
Epoch: 10, Steps: 20 | Train Loss: 0.446 Vali Loss: 0.995 Vali Acc: 0.550 Test Loss: 0.995 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4302349090576172
Epoch: 11, Steps: 20 | Train Loss: 0.428 Vali Loss: 0.871 Vali Acc: 0.580 Test Loss: 0.871 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3926870822906494
Epoch: 12, Steps: 20 | Train Loss: 0.335 Vali Loss: 0.930 Vali Acc: 0.540 Test Loss: 0.930 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3488705158233643
Epoch: 13, Steps: 20 | Train Loss: 0.331 Vali Loss: 0.978 Vali Acc: 0.540 Test Loss: 0.978 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 558338
model size : 2.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.501579761505127
Epoch: 1, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.754 Vali Acc: 0.470 Test Loss: 0.754 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 1.8454761505126953
Epoch: 2, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.869 Vali Acc: 0.480 Test Loss: 0.869 Test Acc: 0.480
Validation loss decreased (-0.469992 --> -0.479991).  Saving model ...
Epoch: 3 cost time: 1.636063814163208
Epoch: 3, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.837 Vali Acc: 0.500 Test Loss: 0.837 Test Acc: 0.500
Validation loss decreased (-0.479991 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 1.501361608505249
Epoch: 4, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.774 Vali Acc: 0.440 Test Loss: 0.774 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.818941593170166
Epoch: 5, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.895 Vali Acc: 0.460 Test Loss: 0.895 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8772051334381104
Epoch: 6, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.919 Vali Acc: 0.510 Test Loss: 0.919 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509991).  Saving model ...
Epoch: 7 cost time: 1.574012279510498
Epoch: 7, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.796 Vali Acc: 0.570 Test Loss: 0.796 Test Acc: 0.570
Validation loss decreased (-0.509991 --> -0.569992).  Saving model ...
Epoch: 8 cost time: 1.8106656074523926
Epoch: 8, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.868 Vali Acc: 0.580 Test Loss: 0.868 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579991).  Saving model ...
Epoch: 9 cost time: 1.580376386642456
Epoch: 9, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.808 Vali Acc: 0.580 Test Loss: 0.808 Test Acc: 0.580
Validation loss decreased (-0.579991 --> -0.579992).  Saving model ...
Epoch: 10 cost time: 1.5967035293579102
Epoch: 10, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.897 Vali Acc: 0.550 Test Loss: 0.897 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4043514728546143
Epoch: 11, Steps: 20 | Train Loss: 0.371 Vali Loss: 0.910 Vali Acc: 0.550 Test Loss: 0.910 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7065489292144775
Epoch: 12, Steps: 20 | Train Loss: 0.331 Vali Loss: 1.026 Vali Acc: 0.540 Test Loss: 1.026 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8187618255615234
Epoch: 13, Steps: 20 | Train Loss: 0.301 Vali Loss: 0.971 Vali Acc: 0.540 Test Loss: 0.971 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7539637088775635
Epoch: 14, Steps: 20 | Train Loss: 0.240 Vali Loss: 1.046 Vali Acc: 0.560 Test Loss: 1.046 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5308284759521484
Epoch: 15, Steps: 20 | Train Loss: 0.244 Vali Loss: 1.176 Vali Acc: 0.550 Test Loss: 1.176 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8837332725524902
Epoch: 16, Steps: 20 | Train Loss: 0.169 Vali Loss: 1.086 Vali Acc: 0.580 Test Loss: 1.086 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5079164505004883
Epoch: 17, Steps: 20 | Train Loss: 0.139 Vali Loss: 1.125 Vali Acc: 0.590 Test Loss: 1.125 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589989).  Saving model ...
Epoch: 18 cost time: 1.8415358066558838
Epoch: 18, Steps: 20 | Train Loss: 0.102 Vali Loss: 1.527 Vali Acc: 0.540 Test Loss: 1.527 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4662892818450928
Epoch: 19, Steps: 20 | Train Loss: 0.105 Vali Loss: 1.433 Vali Acc: 0.520 Test Loss: 1.433 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6994774341583252
Epoch: 20, Steps: 20 | Train Loss: 0.061 Vali Loss: 1.500 Vali Acc: 0.510 Test Loss: 1.500 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8922743797302246
Epoch: 21, Steps: 20 | Train Loss: 0.065 Vali Loss: 1.574 Vali Acc: 0.540 Test Loss: 1.574 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.512195348739624
Epoch: 22, Steps: 20 | Train Loss: 0.039 Vali Loss: 1.534 Vali Acc: 0.550 Test Loss: 1.534 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.737565279006958
Epoch: 23, Steps: 20 | Train Loss: 0.046 Vali Loss: 1.736 Vali Acc: 0.550 Test Loss: 1.736 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4616963863372803
Epoch: 24, Steps: 20 | Train Loss: 0.028 Vali Loss: 1.716 Vali Acc: 0.570 Test Loss: 1.716 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7921814918518066
Epoch: 25, Steps: 20 | Train Loss: 0.023 Vali Loss: 1.742 Vali Acc: 0.560 Test Loss: 1.742 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.632436990737915
Epoch: 26, Steps: 20 | Train Loss: 0.021 Vali Loss: 1.971 Vali Acc: 0.560 Test Loss: 1.971 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.4613654613494873
Epoch: 27, Steps: 20 | Train Loss: 0.024 Vali Loss: 2.028 Vali Acc: 0.560 Test Loss: 2.028 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 558370
model size : 2.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.302868366241455
Epoch: 1, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.6137714385986328
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.742 Vali Acc: 0.480 Test Loss: 0.742 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4455063343048096
Epoch: 3, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.780 Vali Acc: 0.510 Test Loss: 0.780 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509992).  Saving model ...
Epoch: 4 cost time: 1.4900805950164795
Epoch: 4, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.715 Vali Acc: 0.540 Test Loss: 0.715 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 1.4509360790252686
Epoch: 5, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7471809387207031
Epoch: 6, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.772 Vali Acc: 0.560 Test Loss: 0.772 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559992).  Saving model ...
Epoch: 7 cost time: 1.5530281066894531
Epoch: 7, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.926 Vali Acc: 0.540 Test Loss: 0.926 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7539222240447998
Epoch: 8, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.860 Vali Acc: 0.540 Test Loss: 0.860 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2538583278656006
Epoch: 9, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.930 Vali Acc: 0.500 Test Loss: 0.930 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.370849609375
Epoch: 10, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.784 Vali Acc: 0.580 Test Loss: 0.784 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579992).  Saving model ...
Epoch: 11 cost time: 1.5709030628204346
Epoch: 11, Steps: 20 | Train Loss: 0.441 Vali Loss: 0.787 Vali Acc: 0.600 Test Loss: 0.787 Test Acc: 0.600
Validation loss decreased (-0.579992 --> -0.599992).  Saving model ...
Epoch: 12 cost time: 1.759462833404541
Epoch: 12, Steps: 20 | Train Loss: 0.388 Vali Loss: 0.880 Vali Acc: 0.560 Test Loss: 0.880 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.009766101837158
Epoch: 13, Steps: 20 | Train Loss: 0.347 Vali Loss: 0.839 Vali Acc: 0.600 Test Loss: 0.839 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7358088493347168
Epoch: 14, Steps: 20 | Train Loss: 0.285 Vali Loss: 0.886 Vali Acc: 0.570 Test Loss: 0.886 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7555451393127441
Epoch: 15, Steps: 20 | Train Loss: 0.261 Vali Loss: 0.911 Vali Acc: 0.600 Test Loss: 0.911 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7683100700378418
Epoch: 16, Steps: 20 | Train Loss: 0.251 Vali Loss: 1.136 Vali Acc: 0.580 Test Loss: 1.136 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7916781902313232
Epoch: 17, Steps: 20 | Train Loss: 0.189 Vali Loss: 0.974 Vali Acc: 0.540 Test Loss: 0.974 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.803337574005127
Epoch: 18, Steps: 20 | Train Loss: 0.200 Vali Loss: 1.207 Vali Acc: 0.600 Test Loss: 1.207 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8096485137939453
Epoch: 19, Steps: 20 | Train Loss: 0.161 Vali Loss: 1.325 Vali Acc: 0.540 Test Loss: 1.325 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5501327514648438
Epoch: 20, Steps: 20 | Train Loss: 0.113 Vali Loss: 1.299 Vali Acc: 0.560 Test Loss: 1.299 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8706355094909668
Epoch: 21, Steps: 20 | Train Loss: 0.085 Vali Loss: 1.209 Vali Acc: 0.580 Test Loss: 1.209 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 540482
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2075579166412354
Epoch: 1, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.697 Vali Acc: 0.470 Test Loss: 0.697 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.599984884262085
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.740 Vali Acc: 0.440 Test Loss: 0.740 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.496150016784668
Epoch: 3, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.738 Vali Acc: 0.490 Test Loss: 0.738 Test Acc: 0.490
Validation loss decreased (-0.469993 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 1.6025598049163818
Epoch: 4, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.734 Vali Acc: 0.510 Test Loss: 0.734 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 1.477168321609497
Epoch: 5, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.744 Vali Acc: 0.550 Test Loss: 0.744 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 1.5692088603973389
Epoch: 6, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.801 Vali Acc: 0.550 Test Loss: 0.801 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5662684440612793
Epoch: 7, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.745 Vali Acc: 0.510 Test Loss: 0.745 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5194382667541504
Epoch: 8, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.782 Vali Acc: 0.530 Test Loss: 0.782 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5015153884887695
Epoch: 9, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.723 Vali Acc: 0.600 Test Loss: 0.723 Test Acc: 0.600
Validation loss decreased (-0.549993 --> -0.599993).  Saving model ...
Epoch: 10 cost time: 1.4545035362243652
Epoch: 10, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.767 Vali Acc: 0.540 Test Loss: 0.767 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3820977210998535
Epoch: 11, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.807 Vali Acc: 0.540 Test Loss: 0.807 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4277939796447754
Epoch: 12, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.792 Vali Acc: 0.560 Test Loss: 0.792 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6087665557861328
Epoch: 13, Steps: 20 | Train Loss: 0.368 Vali Loss: 0.837 Vali Acc: 0.540 Test Loss: 0.837 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7325637340545654
Epoch: 14, Steps: 20 | Train Loss: 0.313 Vali Loss: 0.817 Vali Acc: 0.560 Test Loss: 0.817 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.690927267074585
Epoch: 15, Steps: 20 | Train Loss: 0.276 Vali Loss: 0.924 Vali Acc: 0.520 Test Loss: 0.924 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8326828479766846
Epoch: 16, Steps: 20 | Train Loss: 0.281 Vali Loss: 1.091 Vali Acc: 0.620 Test Loss: 1.091 Test Acc: 0.620
Validation loss decreased (-0.599993 --> -0.619989).  Saving model ...
Epoch: 17 cost time: 1.3571810722351074
Epoch: 17, Steps: 20 | Train Loss: 0.283 Vali Loss: 0.987 Vali Acc: 0.570 Test Loss: 0.987 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7354552745819092
Epoch: 18, Steps: 20 | Train Loss: 0.222 Vali Loss: 0.942 Vali Acc: 0.520 Test Loss: 0.942 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.463620901107788
Epoch: 19, Steps: 20 | Train Loss: 0.189 Vali Loss: 1.117 Vali Acc: 0.540 Test Loss: 1.117 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7899754047393799
Epoch: 20, Steps: 20 | Train Loss: 0.167 Vali Loss: 1.097 Vali Acc: 0.540 Test Loss: 1.097 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4533326625823975
Epoch: 21, Steps: 20 | Train Loss: 0.141 Vali Loss: 1.193 Vali Acc: 0.510 Test Loss: 1.193 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9934141635894775
Epoch: 22, Steps: 20 | Train Loss: 0.154 Vali Loss: 1.131 Vali Acc: 0.540 Test Loss: 1.131 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.485778570175171
Epoch: 23, Steps: 20 | Train Loss: 0.105 Vali Loss: 1.230 Vali Acc: 0.540 Test Loss: 1.230 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.017824172973633
Epoch: 24, Steps: 20 | Train Loss: 0.070 Vali Loss: 1.308 Vali Acc: 0.540 Test Loss: 1.308 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.592895269393921
Epoch: 25, Steps: 20 | Train Loss: 0.060 Vali Loss: 1.458 Vali Acc: 0.480 Test Loss: 1.458 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.63779616355896
Epoch: 26, Steps: 20 | Train Loss: 0.049 Vali Loss: 1.230 Vali Acc: 0.600 Test Loss: 1.230 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 533410
model size : 2.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.518777370452881
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.713 Vali Acc: 0.430 Test Loss: 0.713 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 1.5251986980438232
Epoch: 2, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.767 Vali Acc: 0.460 Test Loss: 0.767 Test Acc: 0.460
Validation loss decreased (-0.429993 --> -0.459992).  Saving model ...
Epoch: 3 cost time: 1.0252087116241455
Epoch: 3, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.717 Vali Acc: 0.510 Test Loss: 0.717 Test Acc: 0.510
Validation loss decreased (-0.459992 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 1.3656442165374756
Epoch: 4, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.771 Vali Acc: 0.520 Test Loss: 0.771 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 1.4247758388519287
Epoch: 5, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.770 Vali Acc: 0.520 Test Loss: 0.770 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519992).  Saving model ...
Epoch: 6 cost time: 1.4984800815582275
Epoch: 6, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.775 Vali Acc: 0.510 Test Loss: 0.775 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5785651206970215
Epoch: 7, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.820 Vali Acc: 0.470 Test Loss: 0.820 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7037944793701172
Epoch: 8, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.770 Vali Acc: 0.480 Test Loss: 0.770 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.623950719833374
Epoch: 9, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.780 Vali Acc: 0.480 Test Loss: 0.780 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6291389465332031
Epoch: 10, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.855 Vali Acc: 0.510 Test Loss: 0.855 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4651851654052734
Epoch: 11, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.770 Vali Acc: 0.570 Test Loss: 0.770 Test Acc: 0.570
Validation loss decreased (-0.519992 --> -0.569992).  Saving model ...
Epoch: 12 cost time: 1.7458629608154297
Epoch: 12, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.788 Vali Acc: 0.580 Test Loss: 0.788 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579992).  Saving model ...
Epoch: 13 cost time: 1.6328108310699463
Epoch: 13, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.903 Vali Acc: 0.520 Test Loss: 0.903 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2673513889312744
Epoch: 14, Steps: 20 | Train Loss: 0.384 Vali Loss: 0.862 Vali Acc: 0.510 Test Loss: 0.862 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4593567848205566
Epoch: 15, Steps: 20 | Train Loss: 0.346 Vali Loss: 0.909 Vali Acc: 0.540 Test Loss: 0.909 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.365565299987793
Epoch: 16, Steps: 20 | Train Loss: 0.320 Vali Loss: 0.950 Vali Acc: 0.530 Test Loss: 0.950 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3403360843658447
Epoch: 17, Steps: 20 | Train Loss: 0.269 Vali Loss: 0.917 Vali Acc: 0.560 Test Loss: 0.917 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2440414428710938
Epoch: 18, Steps: 20 | Train Loss: 0.237 Vali Loss: 0.946 Vali Acc: 0.530 Test Loss: 0.946 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2512414455413818
Epoch: 19, Steps: 20 | Train Loss: 0.210 Vali Loss: 0.978 Vali Acc: 0.540 Test Loss: 0.978 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4789018630981445
Epoch: 20, Steps: 20 | Train Loss: 0.182 Vali Loss: 0.935 Vali Acc: 0.590 Test Loss: 0.935 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589991).  Saving model ...
Epoch: 21 cost time: 1.682737112045288
Epoch: 21, Steps: 20 | Train Loss: 0.166 Vali Loss: 1.063 Vali Acc: 0.550 Test Loss: 1.063 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7332463264465332
Epoch: 22, Steps: 20 | Train Loss: 0.119 Vali Loss: 1.062 Vali Acc: 0.590 Test Loss: 1.062 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.372049331665039
Epoch: 23, Steps: 20 | Train Loss: 0.090 Vali Loss: 1.194 Vali Acc: 0.540 Test Loss: 1.194 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.239814043045044
Epoch: 24, Steps: 20 | Train Loss: 0.069 Vali Loss: 1.272 Vali Acc: 0.550 Test Loss: 1.272 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.744809627532959
Epoch: 25, Steps: 20 | Train Loss: 0.062 Vali Loss: 1.197 Vali Acc: 0.540 Test Loss: 1.197 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7607746124267578
Epoch: 26, Steps: 20 | Train Loss: 0.043 Vali Loss: 1.357 Vali Acc: 0.550 Test Loss: 1.357 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4101452827453613
Epoch: 27, Steps: 20 | Train Loss: 0.038 Vali Loss: 1.460 Vali Acc: 0.570 Test Loss: 1.460 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.8792271614074707
Epoch: 28, Steps: 20 | Train Loss: 0.028 Vali Loss: 1.450 Vali Acc: 0.580 Test Loss: 1.450 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8075644969940186
Epoch: 29, Steps: 20 | Train Loss: 0.023 Vali Loss: 1.519 Vali Acc: 0.530 Test Loss: 1.519 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7117562294006348
Epoch: 30, Steps: 20 | Train Loss: 0.017 Vali Loss: 1.549 Vali Acc: 0.560 Test Loss: 1.549 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 529890
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.345353364944458
Epoch: 1, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.686 Vali Acc: 0.520 Test Loss: 0.686 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.6200947761535645
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.709 Vali Acc: 0.540 Test Loss: 0.709 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 1.578829050064087
Epoch: 3, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.750 Vali Acc: 0.520 Test Loss: 0.750 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0024642944335938
Epoch: 4, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6195991039276123
Epoch: 5, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.749 Vali Acc: 0.510 Test Loss: 0.749 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4624366760253906
Epoch: 6, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.717 Vali Acc: 0.530 Test Loss: 0.717 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4069576263427734
Epoch: 7, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.778 Vali Acc: 0.540 Test Loss: 0.778 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5698659420013428
Epoch: 8, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.761 Vali Acc: 0.620 Test Loss: 0.761 Test Acc: 0.620
Validation loss decreased (-0.539993 --> -0.619992).  Saving model ...
Epoch: 9 cost time: 1.7426512241363525
Epoch: 9, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.818 Vali Acc: 0.530 Test Loss: 0.818 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.92405104637146
Epoch: 10, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.753 Vali Acc: 0.540 Test Loss: 0.753 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7836415767669678
Epoch: 11, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.754 Vali Acc: 0.560 Test Loss: 0.754 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5381288528442383
Epoch: 12, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.807 Vali Acc: 0.540 Test Loss: 0.807 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3723394870758057
Epoch: 13, Steps: 20 | Train Loss: 0.439 Vali Loss: 0.856 Vali Acc: 0.550 Test Loss: 0.856 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9140870571136475
Epoch: 14, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.874 Vali Acc: 0.520 Test Loss: 0.874 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7467765808105469
Epoch: 15, Steps: 20 | Train Loss: 0.386 Vali Loss: 0.921 Vali Acc: 0.520 Test Loss: 0.921 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6259102821350098
Epoch: 16, Steps: 20 | Train Loss: 0.349 Vali Loss: 0.846 Vali Acc: 0.570 Test Loss: 0.846 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6081037521362305
Epoch: 17, Steps: 20 | Train Loss: 0.312 Vali Loss: 0.892 Vali Acc: 0.560 Test Loss: 0.892 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.8334224224090576
Epoch: 18, Steps: 20 | Train Loss: 0.266 Vali Loss: 0.868 Vali Acc: 0.570 Test Loss: 0.868 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 526402
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.591586351394653
Epoch: 1, Steps: 20 | Train Loss: 0.832 Vali Loss: 0.938 Vali Acc: 0.540 Test Loss: 0.938 Test Acc: 0.540
Validation loss decreased (inf --> -0.539991).  Saving model ...
Epoch: 2 cost time: 3.833765745162964
Epoch: 2, Steps: 20 | Train Loss: 0.904 Vali Loss: 0.836 Vali Acc: 0.540 Test Loss: 0.836 Test Acc: 0.540
Validation loss decreased (-0.539991 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 3.556583881378174
Epoch: 3, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.874 Vali Acc: 0.550 Test Loss: 0.874 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549991).  Saving model ...
Epoch: 4 cost time: 3.1140360832214355
Epoch: 4, Steps: 20 | Train Loss: 0.635 Vali Loss: 1.000 Vali Acc: 0.510 Test Loss: 1.000 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2766358852386475
Epoch: 5, Steps: 20 | Train Loss: 0.700 Vali Loss: 1.010 Vali Acc: 0.580 Test Loss: 1.010 Test Acc: 0.580
Validation loss decreased (-0.549991 --> -0.579990).  Saving model ...
Epoch: 6 cost time: 3.0636003017425537
Epoch: 6, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.988 Vali Acc: 0.590 Test Loss: 0.988 Test Acc: 0.590
Validation loss decreased (-0.579990 --> -0.589990).  Saving model ...
Epoch: 7 cost time: 3.630427598953247
Epoch: 7, Steps: 20 | Train Loss: 0.690 Vali Loss: 1.360 Vali Acc: 0.470 Test Loss: 1.360 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.736734390258789
Epoch: 8, Steps: 20 | Train Loss: 0.758 Vali Loss: 1.394 Vali Acc: 0.590 Test Loss: 1.394 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6687731742858887
Epoch: 9, Steps: 20 | Train Loss: 0.625 Vali Loss: 1.103 Vali Acc: 0.570 Test Loss: 1.103 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.930725574493408
Epoch: 10, Steps: 20 | Train Loss: 0.529 Vali Loss: 1.753 Vali Acc: 0.490 Test Loss: 1.753 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.572321653366089
Epoch: 11, Steps: 20 | Train Loss: 0.696 Vali Loss: 1.727 Vali Acc: 0.550 Test Loss: 1.727 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.574772357940674
Epoch: 12, Steps: 20 | Train Loss: 0.508 Vali Loss: 1.752 Vali Acc: 0.550 Test Loss: 1.752 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.0115082263946533
Epoch: 13, Steps: 20 | Train Loss: 0.386 Vali Loss: 1.776 Vali Acc: 0.620 Test Loss: 1.776 Test Acc: 0.620
Validation loss decreased (-0.589990 --> -0.619982).  Saving model ...
Epoch: 14 cost time: 3.3582632541656494
Epoch: 14, Steps: 20 | Train Loss: 0.460 Vali Loss: 2.184 Vali Acc: 0.540 Test Loss: 2.184 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.382176637649536
Epoch: 15, Steps: 20 | Train Loss: 0.328 Vali Loss: 2.498 Vali Acc: 0.580 Test Loss: 2.498 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.554069757461548
Epoch: 16, Steps: 20 | Train Loss: 0.346 Vali Loss: 2.802 Vali Acc: 0.480 Test Loss: 2.802 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.54549241065979
Epoch: 17, Steps: 20 | Train Loss: 0.487 Vali Loss: 2.623 Vali Acc: 0.520 Test Loss: 2.623 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.324540615081787
Epoch: 18, Steps: 20 | Train Loss: 0.212 Vali Loss: 2.450 Vali Acc: 0.560 Test Loss: 2.450 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.1422882080078125
Epoch: 19, Steps: 20 | Train Loss: 0.268 Vali Loss: 3.152 Vali Acc: 0.520 Test Loss: 3.152 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.5516090393066406
Epoch: 20, Steps: 20 | Train Loss: 0.242 Vali Loss: 3.588 Vali Acc: 0.560 Test Loss: 3.588 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.8712403774261475
Epoch: 21, Steps: 20 | Train Loss: 0.314 Vali Loss: 4.563 Vali Acc: 0.500 Test Loss: 4.563 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.6438851356506348
Epoch: 22, Steps: 20 | Train Loss: 0.306 Vali Loss: 5.347 Vali Acc: 0.480 Test Loss: 5.347 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.679333209991455
Epoch: 23, Steps: 20 | Train Loss: 0.130 Vali Loss: 3.401 Vali Acc: 0.530 Test Loss: 3.401 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 5852034
model size : 22.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.073165655136108
Epoch: 1, Steps: 20 | Train Loss: 0.746 Vali Loss: 1.008 Vali Acc: 0.440 Test Loss: 1.008 Test Acc: 0.440
Validation loss decreased (inf --> -0.439990).  Saving model ...
Epoch: 2 cost time: 3.1978158950805664
Epoch: 2, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.805 Vali Acc: 0.490 Test Loss: 0.805 Test Acc: 0.490
Validation loss decreased (-0.439990 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 3.2213921546936035
Epoch: 3, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.788 Vali Acc: 0.520 Test Loss: 0.788 Test Acc: 0.520
Validation loss decreased (-0.489992 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 3.6105432510375977
Epoch: 4, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.916 Vali Acc: 0.560 Test Loss: 0.916 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559991).  Saving model ...
Epoch: 5 cost time: 3.3269197940826416
Epoch: 5, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.875 Vali Acc: 0.560 Test Loss: 0.875 Test Acc: 0.560
Validation loss decreased (-0.559991 --> -0.559991).  Saving model ...
Epoch: 6 cost time: 3.1692545413970947
Epoch: 6, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.956 Vali Acc: 0.520 Test Loss: 0.956 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.025465965270996
Epoch: 7, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.854 Vali Acc: 0.560 Test Loss: 0.854 Test Acc: 0.560
Validation loss decreased (-0.559991 --> -0.559991).  Saving model ...
Epoch: 8 cost time: 2.8989996910095215
Epoch: 8, Steps: 20 | Train Loss: 0.333 Vali Loss: 1.533 Vali Acc: 0.540 Test Loss: 1.533 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.996009111404419
Epoch: 9, Steps: 20 | Train Loss: 0.381 Vali Loss: 1.399 Vali Acc: 0.560 Test Loss: 1.399 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8368611335754395
Epoch: 10, Steps: 20 | Train Loss: 0.292 Vali Loss: 1.682 Vali Acc: 0.550 Test Loss: 1.682 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.002934455871582
Epoch: 11, Steps: 20 | Train Loss: 0.451 Vali Loss: 1.985 Vali Acc: 0.510 Test Loss: 1.985 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.3793375492095947
Epoch: 12, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.584 Vali Acc: 0.600 Test Loss: 1.584 Test Acc: 0.600
Validation loss decreased (-0.559991 --> -0.599984).  Saving model ...
Epoch: 13 cost time: 3.2013349533081055
Epoch: 13, Steps: 20 | Train Loss: 0.182 Vali Loss: 2.398 Vali Acc: 0.480 Test Loss: 2.398 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2556116580963135
Epoch: 14, Steps: 20 | Train Loss: 0.092 Vali Loss: 2.419 Vali Acc: 0.550 Test Loss: 2.419 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.946763515472412
Epoch: 15, Steps: 20 | Train Loss: 0.127 Vali Loss: 2.280 Vali Acc: 0.510 Test Loss: 2.280 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.1252245903015137
Epoch: 16, Steps: 20 | Train Loss: 0.124 Vali Loss: 2.487 Vali Acc: 0.520 Test Loss: 2.487 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.0059661865234375
Epoch: 17, Steps: 20 | Train Loss: 0.209 Vali Loss: 2.937 Vali Acc: 0.560 Test Loss: 2.937 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.1192243099212646
Epoch: 18, Steps: 20 | Train Loss: 0.145 Vali Loss: 2.591 Vali Acc: 0.470 Test Loss: 2.591 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.240266799926758
Epoch: 19, Steps: 20 | Train Loss: 0.190 Vali Loss: 2.994 Vali Acc: 0.540 Test Loss: 2.994 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.6077959537506104
Epoch: 20, Steps: 20 | Train Loss: 0.127 Vali Loss: 4.268 Vali Acc: 0.580 Test Loss: 4.268 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.227508544921875
Epoch: 21, Steps: 20 | Train Loss: 0.384 Vali Loss: 3.633 Vali Acc: 0.530 Test Loss: 3.633 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.944216251373291
Epoch: 22, Steps: 20 | Train Loss: 0.156 Vali Loss: 3.736 Vali Acc: 0.550 Test Loss: 3.736 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 5680130
model size : 21.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.106563091278076
Epoch: 1, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.777 Vali Acc: 0.600 Test Loss: 0.777 Test Acc: 0.600
Validation loss decreased (inf --> -0.599992).  Saving model ...
Epoch: 2 cost time: 2.0738561153411865
Epoch: 2, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.846 Vali Acc: 0.500 Test Loss: 0.846 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2724554538726807
Epoch: 3, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.838 Vali Acc: 0.560 Test Loss: 0.838 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5686614513397217
Epoch: 4, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.972 Vali Acc: 0.530 Test Loss: 0.972 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.1023919582366943
Epoch: 5, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.924 Vali Acc: 0.560 Test Loss: 0.924 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.7604639530181885
Epoch: 6, Steps: 20 | Train Loss: 0.440 Vali Loss: 1.083 Vali Acc: 0.540 Test Loss: 1.083 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.8365612030029297
Epoch: 7, Steps: 20 | Train Loss: 0.403 Vali Loss: 1.280 Vali Acc: 0.550 Test Loss: 1.280 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0617334842681885
Epoch: 8, Steps: 20 | Train Loss: 0.349 Vali Loss: 1.183 Vali Acc: 0.550 Test Loss: 1.183 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.9422237873077393
Epoch: 9, Steps: 20 | Train Loss: 0.260 Vali Loss: 1.456 Vali Acc: 0.530 Test Loss: 1.456 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.325239896774292
Epoch: 10, Steps: 20 | Train Loss: 0.258 Vali Loss: 1.362 Vali Acc: 0.570 Test Loss: 1.362 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.233388662338257
Epoch: 11, Steps: 20 | Train Loss: 0.297 Vali Loss: 2.359 Vali Acc: 0.550 Test Loss: 2.359 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 5680258
model size : 21.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.880443334579468
Epoch: 1, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.775 Vali Acc: 0.490 Test Loss: 0.775 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.837897777557373
Epoch: 2, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.829 Vali Acc: 0.510 Test Loss: 0.829 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 2.868349552154541
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 1.107 Vali Acc: 0.510 Test Loss: 1.107 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7985639572143555
Epoch: 4, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.862 Vali Acc: 0.500 Test Loss: 0.862 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.406507730484009
Epoch: 5, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.801 Vali Acc: 0.580 Test Loss: 0.801 Test Acc: 0.580
Validation loss decreased (-0.509992 --> -0.579992).  Saving model ...
Epoch: 6 cost time: 2.7764623165130615
Epoch: 6, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.934 Vali Acc: 0.550 Test Loss: 0.934 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.742918014526367
Epoch: 7, Steps: 20 | Train Loss: 0.423 Vali Loss: 1.147 Vali Acc: 0.540 Test Loss: 1.147 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5142877101898193
Epoch: 8, Steps: 20 | Train Loss: 0.351 Vali Loss: 0.947 Vali Acc: 0.530 Test Loss: 0.947 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4468507766723633
Epoch: 9, Steps: 20 | Train Loss: 0.305 Vali Loss: 1.039 Vali Acc: 0.560 Test Loss: 1.039 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.40898060798645
Epoch: 10, Steps: 20 | Train Loss: 0.332 Vali Loss: 1.235 Vali Acc: 0.540 Test Loss: 1.235 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.8894619941711426
Epoch: 11, Steps: 20 | Train Loss: 0.195 Vali Loss: 1.268 Vali Acc: 0.550 Test Loss: 1.268 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.762293815612793
Epoch: 12, Steps: 20 | Train Loss: 0.117 Vali Loss: 1.891 Vali Acc: 0.480 Test Loss: 1.891 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.077742099761963
Epoch: 13, Steps: 20 | Train Loss: 0.146 Vali Loss: 1.688 Vali Acc: 0.520 Test Loss: 1.688 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.8247368335723877
Epoch: 14, Steps: 20 | Train Loss: 0.081 Vali Loss: 1.960 Vali Acc: 0.530 Test Loss: 1.960 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.599426507949829
Epoch: 15, Steps: 20 | Train Loss: 0.082 Vali Loss: 2.477 Vali Acc: 0.520 Test Loss: 2.477 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 5608706
model size : 21.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.702362060546875
Epoch: 1, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.691 Vali Acc: 0.530 Test Loss: 0.691 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 2.950305461883545
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.733 Vali Acc: 0.640 Test Loss: 0.733 Test Acc: 0.640
Validation loss decreased (-0.529993 --> -0.639993).  Saving model ...
Epoch: 3 cost time: 2.8243048191070557
Epoch: 3, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.792 Vali Acc: 0.560 Test Loss: 0.792 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8355722427368164
Epoch: 4, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.824 Vali Acc: 0.530 Test Loss: 0.824 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6402695178985596
Epoch: 5, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.800 Vali Acc: 0.500 Test Loss: 0.800 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.471461534500122
Epoch: 6, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.824 Vali Acc: 0.530 Test Loss: 0.824 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.7413547039031982
Epoch: 7, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.919 Vali Acc: 0.530 Test Loss: 0.919 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.644634962081909
Epoch: 8, Steps: 20 | Train Loss: 0.399 Vali Loss: 1.352 Vali Acc: 0.530 Test Loss: 1.352 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.576188564300537
Epoch: 9, Steps: 20 | Train Loss: 0.307 Vali Loss: 0.904 Vali Acc: 0.560 Test Loss: 0.904 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.3053977489471436
Epoch: 10, Steps: 20 | Train Loss: 0.252 Vali Loss: 1.113 Vali Acc: 0.560 Test Loss: 1.113 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.317551851272583
Epoch: 11, Steps: 20 | Train Loss: 0.223 Vali Loss: 1.235 Vali Acc: 0.520 Test Loss: 1.235 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.6812219619750977
Epoch: 12, Steps: 20 | Train Loss: 0.187 Vali Loss: 1.110 Vali Acc: 0.550 Test Loss: 1.110 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 5580418
model size : 21.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.722852945327759
Epoch: 1, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.850 Vali Acc: 0.470 Test Loss: 0.850 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 3.177205801010132
Epoch: 2, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.825 Vali Acc: 0.480 Test Loss: 0.825 Test Acc: 0.480
Validation loss decreased (-0.469992 --> -0.479992).  Saving model ...
Epoch: 3 cost time: 2.9460699558258057
Epoch: 3, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.792 Vali Acc: 0.610 Test Loss: 0.792 Test Acc: 0.610
Validation loss decreased (-0.479992 --> -0.609992).  Saving model ...
Epoch: 4 cost time: 2.9294137954711914
Epoch: 4, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.900 Vali Acc: 0.530 Test Loss: 0.900 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8812968730926514
Epoch: 5, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.814 Vali Acc: 0.550 Test Loss: 0.814 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5941028594970703
Epoch: 6, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.899 Vali Acc: 0.560 Test Loss: 0.899 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.9324371814727783
Epoch: 7, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.826 Vali Acc: 0.520 Test Loss: 0.826 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.8291501998901367
Epoch: 8, Steps: 20 | Train Loss: 0.377 Vali Loss: 0.982 Vali Acc: 0.580 Test Loss: 0.982 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.003119945526123
Epoch: 9, Steps: 20 | Train Loss: 0.384 Vali Loss: 0.997 Vali Acc: 0.610 Test Loss: 0.997 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.9375431537628174
Epoch: 10, Steps: 20 | Train Loss: 0.288 Vali Loss: 0.986 Vali Acc: 0.580 Test Loss: 0.986 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.502988576889038
Epoch: 11, Steps: 20 | Train Loss: 0.232 Vali Loss: 1.180 Vali Acc: 0.540 Test Loss: 1.180 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.4778425693511963
Epoch: 12, Steps: 20 | Train Loss: 0.216 Vali Loss: 1.054 Vali Acc: 0.620 Test Loss: 1.054 Test Acc: 0.620
Validation loss decreased (-0.609992 --> -0.619989).  Saving model ...
Epoch: 13 cost time: 2.5517518520355225
Epoch: 13, Steps: 20 | Train Loss: 0.175 Vali Loss: 1.331 Vali Acc: 0.520 Test Loss: 1.331 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.573745012283325
Epoch: 14, Steps: 20 | Train Loss: 0.119 Vali Loss: 1.229 Vali Acc: 0.570 Test Loss: 1.229 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.679431915283203
Epoch: 15, Steps: 20 | Train Loss: 0.089 Vali Loss: 1.348 Vali Acc: 0.610 Test Loss: 1.348 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.566875457763672
Epoch: 16, Steps: 20 | Train Loss: 0.074 Vali Loss: 1.555 Vali Acc: 0.600 Test Loss: 1.555 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.713064670562744
Epoch: 17, Steps: 20 | Train Loss: 0.087 Vali Loss: 1.682 Vali Acc: 0.490 Test Loss: 1.682 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.8222262859344482
Epoch: 18, Steps: 20 | Train Loss: 0.055 Vali Loss: 1.650 Vali Acc: 0.590 Test Loss: 1.650 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.1670329570770264
Epoch: 19, Steps: 20 | Train Loss: 0.071 Vali Loss: 1.635 Vali Acc: 0.620 Test Loss: 1.635 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.004946708679199
Epoch: 20, Steps: 20 | Train Loss: 0.068 Vali Loss: 1.768 Vali Acc: 0.600 Test Loss: 1.768 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.733534336090088
Epoch: 21, Steps: 20 | Train Loss: 0.110 Vali Loss: 1.844 Vali Acc: 0.550 Test Loss: 1.844 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.7809557914733887
Epoch: 22, Steps: 20 | Train Loss: 0.021 Vali Loss: 1.913 Vali Acc: 0.610 Test Loss: 1.913 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 5566338
model size : 21.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.097687482833862
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.729 Vali Acc: 0.530 Test Loss: 0.729 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 2.8332064151763916
Epoch: 2, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.699 Vali Acc: 0.560 Test Loss: 0.699 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 2.0985512733459473
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.762 Vali Acc: 0.620 Test Loss: 0.762 Test Acc: 0.620
Validation loss decreased (-0.559993 --> -0.619992).  Saving model ...
Epoch: 4 cost time: 2.625241756439209
Epoch: 4, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.754 Vali Acc: 0.620 Test Loss: 0.754 Test Acc: 0.620
Validation loss decreased (-0.619992 --> -0.619992).  Saving model ...
Epoch: 5 cost time: 2.3398735523223877
Epoch: 5, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.853 Vali Acc: 0.530 Test Loss: 0.853 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0516180992126465
Epoch: 6, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.860 Vali Acc: 0.500 Test Loss: 0.860 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1009466648101807
Epoch: 7, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.904 Vali Acc: 0.500 Test Loss: 0.904 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3312125205993652
Epoch: 8, Steps: 20 | Train Loss: 0.436 Vali Loss: 1.139 Vali Acc: 0.530 Test Loss: 1.139 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.411672830581665
Epoch: 9, Steps: 20 | Train Loss: 0.386 Vali Loss: 0.877 Vali Acc: 0.530 Test Loss: 0.877 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.5025556087493896
Epoch: 10, Steps: 20 | Train Loss: 0.375 Vali Loss: 1.293 Vali Acc: 0.480 Test Loss: 1.293 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.233044147491455
Epoch: 11, Steps: 20 | Train Loss: 0.272 Vali Loss: 0.975 Vali Acc: 0.610 Test Loss: 0.975 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.5121850967407227
Epoch: 12, Steps: 20 | Train Loss: 0.267 Vali Loss: 1.505 Vali Acc: 0.500 Test Loss: 1.505 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.4778409004211426
Epoch: 13, Steps: 20 | Train Loss: 0.265 Vali Loss: 1.017 Vali Acc: 0.550 Test Loss: 1.017 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.6284518241882324
Epoch: 14, Steps: 20 | Train Loss: 0.113 Vali Loss: 1.274 Vali Acc: 0.530 Test Loss: 1.274 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 5552386
model size : 21.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.828568696975708
Epoch: 1, Steps: 20 | Train Loss: 0.791 Vali Loss: 0.837 Vali Acc: 0.480 Test Loss: 0.837 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 2.190727949142456
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.787 Vali Acc: 0.570 Test Loss: 0.787 Test Acc: 0.570
Validation loss decreased (-0.479992 --> -0.569992).  Saving model ...
Epoch: 3 cost time: 2.2044639587402344
Epoch: 3, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.798 Vali Acc: 0.580 Test Loss: 0.798 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579992).  Saving model ...
Epoch: 4 cost time: 1.9970858097076416
Epoch: 4, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.836 Vali Acc: 0.570 Test Loss: 0.836 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.317690372467041
Epoch: 5, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.989 Vali Acc: 0.520 Test Loss: 0.989 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.579798460006714
Epoch: 6, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.899 Vali Acc: 0.550 Test Loss: 0.899 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.423130512237549
Epoch: 7, Steps: 20 | Train Loss: 0.569 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2569873332977295
Epoch: 8, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.947 Vali Acc: 0.590 Test Loss: 0.947 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589991).  Saving model ...
Epoch: 9 cost time: 2.2356247901916504
Epoch: 9, Steps: 20 | Train Loss: 0.457 Vali Loss: 1.088 Vali Acc: 0.540 Test Loss: 1.088 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.998713731765747
Epoch: 10, Steps: 20 | Train Loss: 0.428 Vali Loss: 1.137 Vali Acc: 0.540 Test Loss: 1.137 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7042648792266846
Epoch: 11, Steps: 20 | Train Loss: 0.326 Vali Loss: 1.473 Vali Acc: 0.510 Test Loss: 1.473 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.128976583480835
Epoch: 12, Steps: 20 | Train Loss: 0.287 Vali Loss: 1.518 Vali Acc: 0.560 Test Loss: 1.518 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1988697052001953
Epoch: 13, Steps: 20 | Train Loss: 0.330 Vali Loss: 1.298 Vali Acc: 0.610 Test Loss: 1.298 Test Acc: 0.610
Validation loss decreased (-0.589991 --> -0.609987).  Saving model ...
Epoch: 14 cost time: 2.000190258026123
Epoch: 14, Steps: 20 | Train Loss: 0.253 Vali Loss: 1.947 Vali Acc: 0.570 Test Loss: 1.947 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5168113708496094
Epoch: 15, Steps: 20 | Train Loss: 0.285 Vali Loss: 1.467 Vali Acc: 0.570 Test Loss: 1.467 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1144356727600098
Epoch: 16, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.627 Vali Acc: 0.620 Test Loss: 1.627 Test Acc: 0.620
Validation loss decreased (-0.609987 --> -0.619984).  Saving model ...
Epoch: 17 cost time: 2.1751489639282227
Epoch: 17, Steps: 20 | Train Loss: 0.197 Vali Loss: 2.411 Vali Acc: 0.560 Test Loss: 2.411 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1930768489837646
Epoch: 18, Steps: 20 | Train Loss: 0.140 Vali Loss: 2.246 Vali Acc: 0.560 Test Loss: 2.246 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.239839553833008
Epoch: 19, Steps: 20 | Train Loss: 0.276 Vali Loss: 2.352 Vali Acc: 0.570 Test Loss: 2.352 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.2902045249938965
Epoch: 20, Steps: 20 | Train Loss: 0.206 Vali Loss: 2.204 Vali Acc: 0.630 Test Loss: 2.204 Test Acc: 0.630
Validation loss decreased (-0.619984 --> -0.629978).  Saving model ...
Epoch: 21 cost time: 2.2315428256988525
Epoch: 21, Steps: 20 | Train Loss: 0.139 Vali Loss: 2.685 Vali Acc: 0.600 Test Loss: 2.685 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0980353355407715
Epoch: 22, Steps: 20 | Train Loss: 0.319 Vali Loss: 2.862 Vali Acc: 0.590 Test Loss: 2.862 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.0335066318511963
Epoch: 23, Steps: 20 | Train Loss: 0.104 Vali Loss: 3.095 Vali Acc: 0.590 Test Loss: 3.095 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.227231740951538
Epoch: 24, Steps: 20 | Train Loss: 0.183 Vali Loss: 3.619 Vali Acc: 0.540 Test Loss: 3.619 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.399049758911133
Epoch: 25, Steps: 20 | Train Loss: 0.094 Vali Loss: 3.382 Vali Acc: 0.610 Test Loss: 3.382 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.455878734588623
Epoch: 26, Steps: 20 | Train Loss: 0.096 Vali Loss: 3.928 Vali Acc: 0.500 Test Loss: 3.928 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.289759635925293
Epoch: 27, Steps: 20 | Train Loss: 0.168 Vali Loss: 3.099 Vali Acc: 0.590 Test Loss: 3.099 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.9332454204559326
Epoch: 28, Steps: 20 | Train Loss: 0.016 Vali Loss: 3.712 Vali Acc: 0.550 Test Loss: 3.712 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8232901096343994
Epoch: 29, Steps: 20 | Train Loss: 0.016 Vali Loss: 3.538 Vali Acc: 0.550 Test Loss: 3.538 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.997908115386963
Epoch: 30, Steps: 20 | Train Loss: 0.057 Vali Loss: 4.073 Vali Acc: 0.510 Test Loss: 4.073 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 1762754
model size : 6.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4897496700286865
Epoch: 1, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.781 Vali Acc: 0.420 Test Loss: 0.781 Test Acc: 0.420
Validation loss decreased (inf --> -0.419992).  Saving model ...
Epoch: 2 cost time: 1.852086067199707
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.743 Vali Acc: 0.480 Test Loss: 0.743 Test Acc: 0.480
Validation loss decreased (-0.419992 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 2.000601291656494
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.830 Vali Acc: 0.540 Test Loss: 0.830 Test Acc: 0.540
Validation loss decreased (-0.479993 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 1.9875380992889404
Epoch: 4, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.741 Vali Acc: 0.540 Test Loss: 0.741 Test Acc: 0.540
Validation loss decreased (-0.539992 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 1.8174219131469727
Epoch: 5, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.801 Vali Acc: 0.550 Test Loss: 0.801 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 1.7473652362823486
Epoch: 6, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.795 Vali Acc: 0.550 Test Loss: 0.795 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549992).  Saving model ...
Epoch: 7 cost time: 1.6649138927459717
Epoch: 7, Steps: 20 | Train Loss: 0.479 Vali Loss: 1.068 Vali Acc: 0.540 Test Loss: 1.068 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7827863693237305
Epoch: 8, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.757 Vali Acc: 0.610 Test Loss: 0.757 Test Acc: 0.610
Validation loss decreased (-0.549992 --> -0.609992).  Saving model ...
Epoch: 9 cost time: 2.0172274112701416
Epoch: 9, Steps: 20 | Train Loss: 0.382 Vali Loss: 0.933 Vali Acc: 0.580 Test Loss: 0.933 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0472004413604736
Epoch: 10, Steps: 20 | Train Loss: 0.339 Vali Loss: 1.044 Vali Acc: 0.570 Test Loss: 1.044 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8135993480682373
Epoch: 11, Steps: 20 | Train Loss: 0.287 Vali Loss: 1.033 Vali Acc: 0.550 Test Loss: 1.033 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7261784076690674
Epoch: 12, Steps: 20 | Train Loss: 0.229 Vali Loss: 1.084 Vali Acc: 0.550 Test Loss: 1.084 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.770033836364746
Epoch: 13, Steps: 20 | Train Loss: 0.193 Vali Loss: 1.359 Vali Acc: 0.540 Test Loss: 1.359 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5331542491912842
Epoch: 14, Steps: 20 | Train Loss: 0.208 Vali Loss: 1.480 Vali Acc: 0.590 Test Loss: 1.480 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.2649924755096436
Epoch: 15, Steps: 20 | Train Loss: 0.153 Vali Loss: 1.450 Vali Acc: 0.580 Test Loss: 1.450 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8473865985870361
Epoch: 16, Steps: 20 | Train Loss: 0.125 Vali Loss: 1.760 Vali Acc: 0.530 Test Loss: 1.760 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.8294281959533691
Epoch: 17, Steps: 20 | Train Loss: 0.146 Vali Loss: 1.893 Vali Acc: 0.510 Test Loss: 1.893 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.954467535018921
Epoch: 18, Steps: 20 | Train Loss: 0.136 Vali Loss: 2.296 Vali Acc: 0.530 Test Loss: 2.296 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1676802
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.357868194580078
Epoch: 1, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.752 Vali Acc: 0.520 Test Loss: 0.752 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 1.704028606414795
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.820 Vali Acc: 0.530 Test Loss: 0.820 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 1.7836332321166992
Epoch: 3, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.834 Vali Acc: 0.500 Test Loss: 0.834 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3636162281036377
Epoch: 4, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.896 Vali Acc: 0.540 Test Loss: 0.896 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539991).  Saving model ...
Epoch: 5 cost time: 1.8486409187316895
Epoch: 5, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.973 Vali Acc: 0.490 Test Loss: 0.973 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9114060401916504
Epoch: 6, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.935 Vali Acc: 0.520 Test Loss: 0.935 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.821340799331665
Epoch: 7, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.875 Vali Acc: 0.520 Test Loss: 0.875 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7715511322021484
Epoch: 8, Steps: 20 | Train Loss: 0.417 Vali Loss: 1.038 Vali Acc: 0.550 Test Loss: 1.038 Test Acc: 0.550
Validation loss decreased (-0.539991 --> -0.549990).  Saving model ...
Epoch: 9 cost time: 2.068293571472168
Epoch: 9, Steps: 20 | Train Loss: 0.371 Vali Loss: 1.019 Vali Acc: 0.550 Test Loss: 1.019 Test Acc: 0.550
Validation loss decreased (-0.549990 --> -0.549990).  Saving model ...
Epoch: 10 cost time: 1.853665828704834
Epoch: 10, Steps: 20 | Train Loss: 0.308 Vali Loss: 1.280 Vali Acc: 0.500 Test Loss: 1.280 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8875267505645752
Epoch: 11, Steps: 20 | Train Loss: 0.281 Vali Loss: 1.308 Vali Acc: 0.540 Test Loss: 1.308 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.857520580291748
Epoch: 12, Steps: 20 | Train Loss: 0.249 Vali Loss: 1.262 Vali Acc: 0.600 Test Loss: 1.262 Test Acc: 0.600
Validation loss decreased (-0.549990 --> -0.599987).  Saving model ...
Epoch: 13 cost time: 1.940500020980835
Epoch: 13, Steps: 20 | Train Loss: 0.203 Vali Loss: 1.575 Vali Acc: 0.560 Test Loss: 1.575 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0469424724578857
Epoch: 14, Steps: 20 | Train Loss: 0.153 Vali Loss: 1.453 Vali Acc: 0.530 Test Loss: 1.453 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6876370906829834
Epoch: 15, Steps: 20 | Train Loss: 0.122 Vali Loss: 1.632 Vali Acc: 0.500 Test Loss: 1.632 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7350857257843018
Epoch: 16, Steps: 20 | Train Loss: 0.075 Vali Loss: 1.625 Vali Acc: 0.540 Test Loss: 1.625 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.0524730682373047
Epoch: 17, Steps: 20 | Train Loss: 0.069 Vali Loss: 1.673 Vali Acc: 0.530 Test Loss: 1.673 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7768230438232422
Epoch: 18, Steps: 20 | Train Loss: 0.070 Vali Loss: 2.042 Vali Acc: 0.470 Test Loss: 2.042 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7806851863861084
Epoch: 19, Steps: 20 | Train Loss: 0.037 Vali Loss: 1.794 Vali Acc: 0.530 Test Loss: 1.794 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.809098720550537
Epoch: 20, Steps: 20 | Train Loss: 0.041 Vali Loss: 2.670 Vali Acc: 0.510 Test Loss: 2.670 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9072091579437256
Epoch: 21, Steps: 20 | Train Loss: 0.017 Vali Loss: 2.656 Vali Acc: 0.480 Test Loss: 2.656 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4549148082733154
Epoch: 22, Steps: 20 | Train Loss: 0.023 Vali Loss: 2.479 Vali Acc: 0.520 Test Loss: 2.479 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1676866
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.624171495437622
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.725 Vali Acc: 0.480 Test Loss: 0.725 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.7478525638580322
Epoch: 2, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.761 Vali Acc: 0.500 Test Loss: 0.761 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 1.799109697341919
Epoch: 3, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.746 Vali Acc: 0.480 Test Loss: 0.746 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9133636951446533
Epoch: 4, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.737 Vali Acc: 0.570 Test Loss: 0.737 Test Acc: 0.570
Validation loss decreased (-0.499992 --> -0.569993).  Saving model ...
Epoch: 5 cost time: 1.7023844718933105
Epoch: 5, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.779 Vali Acc: 0.600 Test Loss: 0.779 Test Acc: 0.600
Validation loss decreased (-0.569993 --> -0.599992).  Saving model ...
Epoch: 6 cost time: 1.5546228885650635
Epoch: 6, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.772 Vali Acc: 0.600 Test Loss: 0.772 Test Acc: 0.600
Validation loss decreased (-0.599992 --> -0.599992).  Saving model ...
Epoch: 7 cost time: 1.6001760959625244
Epoch: 7, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.861 Vali Acc: 0.560 Test Loss: 0.861 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.608863115310669
Epoch: 8, Steps: 20 | Train Loss: 0.428 Vali Loss: 0.877 Vali Acc: 0.550 Test Loss: 0.877 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8654804229736328
Epoch: 9, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.018 Vali Acc: 0.550 Test Loss: 1.018 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7690720558166504
Epoch: 10, Steps: 20 | Train Loss: 0.374 Vali Loss: 1.056 Vali Acc: 0.500 Test Loss: 1.056 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6926524639129639
Epoch: 11, Steps: 20 | Train Loss: 0.298 Vali Loss: 0.933 Vali Acc: 0.580 Test Loss: 0.933 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.837998390197754
Epoch: 12, Steps: 20 | Train Loss: 0.301 Vali Loss: 0.957 Vali Acc: 0.580 Test Loss: 0.957 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6987383365631104
Epoch: 13, Steps: 20 | Train Loss: 0.239 Vali Loss: 1.077 Vali Acc: 0.570 Test Loss: 1.077 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4981880187988281
Epoch: 14, Steps: 20 | Train Loss: 0.175 Vali Loss: 1.186 Vali Acc: 0.550 Test Loss: 1.186 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5763027667999268
Epoch: 15, Steps: 20 | Train Loss: 0.134 Vali Loss: 1.475 Vali Acc: 0.590 Test Loss: 1.475 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5847666263580322
Epoch: 16, Steps: 20 | Train Loss: 0.163 Vali Loss: 1.371 Vali Acc: 0.570 Test Loss: 1.371 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1641090
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6218106746673584
Epoch: 1, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.705 Vali Acc: 0.530 Test Loss: 0.705 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.9098145961761475
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.836 Vali Acc: 0.480 Test Loss: 0.836 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9434740543365479
Epoch: 3, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.919 Vali Acc: 0.550 Test Loss: 0.919 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549991).  Saving model ...
Epoch: 4 cost time: 1.9223716259002686
Epoch: 4, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.791 Vali Acc: 0.540 Test Loss: 0.791 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.978271484375
Epoch: 5, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.805 Vali Acc: 0.520 Test Loss: 0.805 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.931835651397705
Epoch: 6, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.831 Vali Acc: 0.480 Test Loss: 0.831 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.923889398574829
Epoch: 7, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.860 Vali Acc: 0.510 Test Loss: 0.860 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7988135814666748
Epoch: 8, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.785 Vali Acc: 0.510 Test Loss: 0.785 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9050674438476562
Epoch: 9, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.876 Vali Acc: 0.520 Test Loss: 0.876 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9277055263519287
Epoch: 10, Steps: 20 | Train Loss: 0.407 Vali Loss: 1.008 Vali Acc: 0.550 Test Loss: 1.008 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.013336420059204
Epoch: 11, Steps: 20 | Train Loss: 0.375 Vali Loss: 1.006 Vali Acc: 0.580 Test Loss: 1.006 Test Acc: 0.580
Validation loss decreased (-0.549991 --> -0.579990).  Saving model ...
Epoch: 12 cost time: 1.7743206024169922
Epoch: 12, Steps: 20 | Train Loss: 0.332 Vali Loss: 1.107 Vali Acc: 0.590 Test Loss: 1.107 Test Acc: 0.590
Validation loss decreased (-0.579990 --> -0.589989).  Saving model ...
Epoch: 13 cost time: 1.875058889389038
Epoch: 13, Steps: 20 | Train Loss: 0.268 Vali Loss: 1.133 Vali Acc: 0.500 Test Loss: 1.133 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.821977138519287
Epoch: 14, Steps: 20 | Train Loss: 0.213 Vali Loss: 0.980 Vali Acc: 0.570 Test Loss: 0.980 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9289569854736328
Epoch: 15, Steps: 20 | Train Loss: 0.204 Vali Loss: 1.173 Vali Acc: 0.540 Test Loss: 1.173 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9176173210144043
Epoch: 16, Steps: 20 | Train Loss: 0.152 Vali Loss: 1.167 Vali Acc: 0.550 Test Loss: 1.167 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8923282623291016
Epoch: 17, Steps: 20 | Train Loss: 0.130 Vali Loss: 1.283 Vali Acc: 0.540 Test Loss: 1.283 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7863695621490479
Epoch: 18, Steps: 20 | Train Loss: 0.099 Vali Loss: 1.400 Vali Acc: 0.550 Test Loss: 1.400 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8904128074645996
Epoch: 19, Steps: 20 | Train Loss: 0.056 Vali Loss: 1.342 Vali Acc: 0.560 Test Loss: 1.342 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7591967582702637
Epoch: 20, Steps: 20 | Train Loss: 0.036 Vali Loss: 1.260 Vali Acc: 0.570 Test Loss: 1.260 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9761743545532227
Epoch: 21, Steps: 20 | Train Loss: 0.031 Vali Loss: 1.411 Vali Acc: 0.550 Test Loss: 1.411 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8876376152038574
Epoch: 22, Steps: 20 | Train Loss: 0.021 Vali Loss: 1.401 Vali Acc: 0.560 Test Loss: 1.401 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1626946
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.298194169998169
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.748 Vali Acc: 0.470 Test Loss: 0.748 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.9084348678588867
Epoch: 2, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.729 Vali Acc: 0.530 Test Loss: 0.729 Test Acc: 0.530
Validation loss decreased (-0.469993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.341860294342041
Epoch: 3, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.836 Vali Acc: 0.500 Test Loss: 0.836 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8612256050109863
Epoch: 4, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.751 Vali Acc: 0.540 Test Loss: 0.751 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 1.6523668766021729
Epoch: 5, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.886 Vali Acc: 0.540 Test Loss: 0.886 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7978496551513672
Epoch: 6, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.774 Vali Acc: 0.570 Test Loss: 0.774 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569992).  Saving model ...
Epoch: 7 cost time: 1.9705185890197754
Epoch: 7, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.761 Vali Acc: 0.570 Test Loss: 0.761 Test Acc: 0.570
Validation loss decreased (-0.569992 --> -0.569992).  Saving model ...
Epoch: 8 cost time: 1.8007733821868896
Epoch: 8, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.933 Vali Acc: 0.540 Test Loss: 0.933 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.894120693206787
Epoch: 9, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.825 Vali Acc: 0.550 Test Loss: 0.825 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7508597373962402
Epoch: 10, Steps: 20 | Train Loss: 0.374 Vali Loss: 0.902 Vali Acc: 0.550 Test Loss: 0.902 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4944021701812744
Epoch: 11, Steps: 20 | Train Loss: 0.362 Vali Loss: 1.007 Vali Acc: 0.510 Test Loss: 1.007 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3332703113555908
Epoch: 12, Steps: 20 | Train Loss: 0.296 Vali Loss: 1.158 Vali Acc: 0.540 Test Loss: 1.158 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9243125915527344
Epoch: 13, Steps: 20 | Train Loss: 0.292 Vali Loss: 0.880 Vali Acc: 0.560 Test Loss: 0.880 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8762433528900146
Epoch: 14, Steps: 20 | Train Loss: 0.283 Vali Loss: 0.976 Vali Acc: 0.600 Test Loss: 0.976 Test Acc: 0.600
Validation loss decreased (-0.569992 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 1.8404512405395508
Epoch: 15, Steps: 20 | Train Loss: 0.255 Vali Loss: 1.133 Vali Acc: 0.560 Test Loss: 1.133 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7131288051605225
Epoch: 16, Steps: 20 | Train Loss: 0.226 Vali Loss: 1.134 Vali Acc: 0.510 Test Loss: 1.134 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9787726402282715
Epoch: 17, Steps: 20 | Train Loss: 0.137 Vali Loss: 1.416 Vali Acc: 0.560 Test Loss: 1.416 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7649352550506592
Epoch: 18, Steps: 20 | Train Loss: 0.122 Vali Loss: 1.437 Vali Acc: 0.530 Test Loss: 1.437 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3456158638000488
Epoch: 19, Steps: 20 | Train Loss: 0.093 Vali Loss: 1.560 Vali Acc: 0.530 Test Loss: 1.560 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2101855278015137
Epoch: 20, Steps: 20 | Train Loss: 0.081 Vali Loss: 1.273 Vali Acc: 0.540 Test Loss: 1.273 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.438056230545044
Epoch: 21, Steps: 20 | Train Loss: 0.047 Vali Loss: 1.580 Vali Acc: 0.540 Test Loss: 1.580 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.664236307144165
Epoch: 22, Steps: 20 | Train Loss: 0.036 Vali Loss: 1.562 Vali Acc: 0.510 Test Loss: 1.562 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6050944328308105
Epoch: 23, Steps: 20 | Train Loss: 0.027 Vali Loss: 1.819 Vali Acc: 0.520 Test Loss: 1.819 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.5757906436920166
Epoch: 24, Steps: 20 | Train Loss: 0.013 Vali Loss: 1.803 Vali Acc: 0.520 Test Loss: 1.803 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1619906
model size : 6.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4253122806549072
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.696 Vali Acc: 0.520 Test Loss: 0.696 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.227424144744873
Epoch: 2, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.733 Vali Acc: 0.540 Test Loss: 0.733 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 1.27760910987854
Epoch: 3, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.807 Vali Acc: 0.530 Test Loss: 0.807 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7578325271606445
Epoch: 4, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.802 Vali Acc: 0.500 Test Loss: 0.802 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5684483051300049
Epoch: 5, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.792 Vali Acc: 0.540 Test Loss: 0.792 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6060903072357178
Epoch: 6, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.755 Vali Acc: 0.550 Test Loss: 0.755 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 7 cost time: 1.732351303100586
Epoch: 7, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.756 Vali Acc: 0.560 Test Loss: 0.756 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 8 cost time: 1.6789138317108154
Epoch: 8, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.759 Vali Acc: 0.570 Test Loss: 0.759 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569992).  Saving model ...
Epoch: 9 cost time: 1.6977028846740723
Epoch: 9, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.791 Vali Acc: 0.560 Test Loss: 0.791 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1148767471313477
Epoch: 10, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.798 Vali Acc: 0.590 Test Loss: 0.798 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589992).  Saving model ...
Epoch: 11 cost time: 2.243555784225464
Epoch: 11, Steps: 20 | Train Loss: 0.387 Vali Loss: 0.876 Vali Acc: 0.510 Test Loss: 0.876 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1433825492858887
Epoch: 12, Steps: 20 | Train Loss: 0.344 Vali Loss: 0.808 Vali Acc: 0.620 Test Loss: 0.808 Test Acc: 0.620
Validation loss decreased (-0.589992 --> -0.619992).  Saving model ...
Epoch: 13 cost time: 2.3443732261657715
Epoch: 13, Steps: 20 | Train Loss: 0.325 Vali Loss: 0.892 Vali Acc: 0.560 Test Loss: 0.892 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2077972888946533
Epoch: 14, Steps: 20 | Train Loss: 0.289 Vali Loss: 1.012 Vali Acc: 0.530 Test Loss: 1.012 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0741169452667236
Epoch: 15, Steps: 20 | Train Loss: 0.275 Vali Loss: 1.021 Vali Acc: 0.580 Test Loss: 1.021 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3187122344970703
Epoch: 16, Steps: 20 | Train Loss: 0.236 Vali Loss: 1.148 Vali Acc: 0.510 Test Loss: 1.148 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.187159776687622
Epoch: 17, Steps: 20 | Train Loss: 0.179 Vali Loss: 1.219 Vali Acc: 0.550 Test Loss: 1.219 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.2667598724365234
Epoch: 18, Steps: 20 | Train Loss: 0.151 Vali Loss: 1.107 Vali Acc: 0.520 Test Loss: 1.107 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.144043207168579
Epoch: 19, Steps: 20 | Train Loss: 0.124 Vali Loss: 1.232 Vali Acc: 0.610 Test Loss: 1.232 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.0386087894439697
Epoch: 20, Steps: 20 | Train Loss: 0.092 Vali Loss: 1.460 Vali Acc: 0.510 Test Loss: 1.460 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.3979198932647705
Epoch: 21, Steps: 20 | Train Loss: 0.074 Vali Loss: 1.341 Vali Acc: 0.530 Test Loss: 1.341 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.2628872394561768
Epoch: 22, Steps: 20 | Train Loss: 0.049 Vali Loss: 1.320 Vali Acc: 0.520 Test Loss: 1.320 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1612930
model size : 6.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.728722333908081
Epoch: 1, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.726 Vali Acc: 0.430 Test Loss: 0.726 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 1.9860806465148926
Epoch: 2, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.805 Vali Acc: 0.460 Test Loss: 0.805 Test Acc: 0.460
Validation loss decreased (-0.429993 --> -0.459992).  Saving model ...
Epoch: 3 cost time: 1.600128412246704
Epoch: 3, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.790 Vali Acc: 0.490 Test Loss: 0.790 Test Acc: 0.490
Validation loss decreased (-0.459992 --> -0.489992).  Saving model ...
Epoch: 4 cost time: 1.9245414733886719
Epoch: 4, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.733 Vali Acc: 0.560 Test Loss: 0.733 Test Acc: 0.560
Validation loss decreased (-0.489992 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 1.9760422706604004
Epoch: 5, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.813 Vali Acc: 0.490 Test Loss: 0.813 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8999762535095215
Epoch: 6, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.830 Vali Acc: 0.540 Test Loss: 0.830 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7315974235534668
Epoch: 7, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.793 Vali Acc: 0.550 Test Loss: 0.793 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9596188068389893
Epoch: 8, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.782 Vali Acc: 0.620 Test Loss: 0.782 Test Acc: 0.620
Validation loss decreased (-0.559993 --> -0.619992).  Saving model ...
Epoch: 9 cost time: 1.813800573348999
Epoch: 9, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.927 Vali Acc: 0.550 Test Loss: 0.927 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8992652893066406
Epoch: 10, Steps: 20 | Train Loss: 0.434 Vali Loss: 0.925 Vali Acc: 0.580 Test Loss: 0.925 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.706928014755249
Epoch: 11, Steps: 20 | Train Loss: 0.430 Vali Loss: 1.110 Vali Acc: 0.560 Test Loss: 1.110 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9584660530090332
Epoch: 12, Steps: 20 | Train Loss: 0.457 Vali Loss: 1.002 Vali Acc: 0.570 Test Loss: 1.002 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9780094623565674
Epoch: 13, Steps: 20 | Train Loss: 0.378 Vali Loss: 0.949 Vali Acc: 0.610 Test Loss: 0.949 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8159196376800537
Epoch: 14, Steps: 20 | Train Loss: 0.309 Vali Loss: 1.003 Vali Acc: 0.600 Test Loss: 1.003 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8961901664733887
Epoch: 15, Steps: 20 | Train Loss: 0.279 Vali Loss: 1.122 Vali Acc: 0.590 Test Loss: 1.122 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8665297031402588
Epoch: 16, Steps: 20 | Train Loss: 0.253 Vali Loss: 1.297 Vali Acc: 0.570 Test Loss: 1.297 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.882725715637207
Epoch: 17, Steps: 20 | Train Loss: 0.300 Vali Loss: 1.750 Vali Acc: 0.490 Test Loss: 1.750 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.9175443649291992
Epoch: 18, Steps: 20 | Train Loss: 0.288 Vali Loss: 1.665 Vali Acc: 0.520 Test Loss: 1.665 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 590562
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.49672794342041
Epoch: 1, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.732 Vali Acc: 0.460 Test Loss: 0.732 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.2853484153747559
Epoch: 2, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.712 Vali Acc: 0.450 Test Loss: 0.712 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2593624591827393
Epoch: 3, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.793 Vali Acc: 0.530 Test Loss: 0.793 Test Acc: 0.530
Validation loss decreased (-0.459993 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 1.3788588047027588
Epoch: 4, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.829 Vali Acc: 0.530 Test Loss: 0.829 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.175703525543213
Epoch: 5, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.779 Vali Acc: 0.470 Test Loss: 0.779 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4681727886199951
Epoch: 6, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.769 Vali Acc: 0.610 Test Loss: 0.769 Test Acc: 0.610
Validation loss decreased (-0.529992 --> -0.609992).  Saving model ...
Epoch: 7 cost time: 1.2918472290039062
Epoch: 7, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.749 Vali Acc: 0.580 Test Loss: 0.749 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.461986780166626
Epoch: 8, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.817 Vali Acc: 0.550 Test Loss: 0.817 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7135508060455322
Epoch: 9, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.897 Vali Acc: 0.470 Test Loss: 0.897 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6246511936187744
Epoch: 10, Steps: 20 | Train Loss: 0.492 Vali Loss: 1.022 Vali Acc: 0.530 Test Loss: 1.022 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.505359172821045
Epoch: 11, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.883 Vali Acc: 0.550 Test Loss: 0.883 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2862353324890137
Epoch: 12, Steps: 20 | Train Loss: 0.357 Vali Loss: 0.996 Vali Acc: 0.550 Test Loss: 0.996 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6290786266326904
Epoch: 13, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.940 Vali Acc: 0.550 Test Loss: 0.940 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4002611637115479
Epoch: 14, Steps: 20 | Train Loss: 0.301 Vali Loss: 1.002 Vali Acc: 0.580 Test Loss: 1.002 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.348839282989502
Epoch: 15, Steps: 20 | Train Loss: 0.292 Vali Loss: 1.153 Vali Acc: 0.550 Test Loss: 1.153 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5880131721496582
Epoch: 16, Steps: 20 | Train Loss: 0.233 Vali Loss: 1.264 Vali Acc: 0.540 Test Loss: 1.264 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 547586
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5988404750823975
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.714 Vali Acc: 0.430 Test Loss: 0.714 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 1.8260860443115234
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.719 Vali Acc: 0.540 Test Loss: 0.719 Test Acc: 0.540
Validation loss decreased (-0.429993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 1.909562110900879
Epoch: 3, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.731 Vali Acc: 0.580 Test Loss: 0.731 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579993).  Saving model ...
Epoch: 4 cost time: 1.7195391654968262
Epoch: 4, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.807 Vali Acc: 0.610 Test Loss: 0.807 Test Acc: 0.610
Validation loss decreased (-0.579993 --> -0.609992).  Saving model ...
Epoch: 5 cost time: 1.6349036693572998
Epoch: 5, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5770454406738281
Epoch: 6, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.868 Vali Acc: 0.560 Test Loss: 0.868 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.516101598739624
Epoch: 7, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.833 Vali Acc: 0.560 Test Loss: 0.833 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7446000576019287
Epoch: 8, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.765 Vali Acc: 0.540 Test Loss: 0.765 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9309499263763428
Epoch: 9, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.786 Vali Acc: 0.590 Test Loss: 0.786 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7941880226135254
Epoch: 10, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.838 Vali Acc: 0.590 Test Loss: 0.838 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.798762559890747
Epoch: 11, Steps: 20 | Train Loss: 0.392 Vali Loss: 0.869 Vali Acc: 0.600 Test Loss: 0.869 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8555572032928467
Epoch: 12, Steps: 20 | Train Loss: 0.328 Vali Loss: 1.033 Vali Acc: 0.580 Test Loss: 1.033 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6935136318206787
Epoch: 13, Steps: 20 | Train Loss: 0.287 Vali Loss: 0.954 Vali Acc: 0.550 Test Loss: 0.954 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6726295948028564
Epoch: 14, Steps: 20 | Train Loss: 0.252 Vali Loss: 1.092 Vali Acc: 0.570 Test Loss: 1.092 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 547618
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.132826328277588
Epoch: 1, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.707 Vali Acc: 0.470 Test Loss: 0.707 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.532555103302002
Epoch: 2, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.683 Vali Acc: 0.560 Test Loss: 0.683 Test Acc: 0.560
Validation loss decreased (-0.469993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 1.657407522201538
Epoch: 3, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.695 Vali Acc: 0.530 Test Loss: 0.695 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6192338466644287
Epoch: 4, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.760 Vali Acc: 0.550 Test Loss: 0.760 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6179118156433105
Epoch: 5, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.779 Vali Acc: 0.540 Test Loss: 0.779 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8601384162902832
Epoch: 6, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.821 Vali Acc: 0.540 Test Loss: 0.821 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.588660717010498
Epoch: 7, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.729 Vali Acc: 0.530 Test Loss: 0.729 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3574140071868896
Epoch: 8, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.897 Vali Acc: 0.460 Test Loss: 0.897 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5443675518035889
Epoch: 9, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.859 Vali Acc: 0.580 Test Loss: 0.859 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579991).  Saving model ...
Epoch: 10 cost time: 1.8275256156921387
Epoch: 10, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.820 Vali Acc: 0.540 Test Loss: 0.820 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7035465240478516
Epoch: 11, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.819 Vali Acc: 0.620 Test Loss: 0.819 Test Acc: 0.620
Validation loss decreased (-0.579991 --> -0.619992).  Saving model ...
Epoch: 12 cost time: 1.6341595649719238
Epoch: 12, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.817 Vali Acc: 0.590 Test Loss: 0.817 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7517015933990479
Epoch: 13, Steps: 20 | Train Loss: 0.346 Vali Loss: 0.880 Vali Acc: 0.560 Test Loss: 0.880 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8457608222961426
Epoch: 14, Steps: 20 | Train Loss: 0.320 Vali Loss: 0.913 Vali Acc: 0.590 Test Loss: 0.913 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9023871421813965
Epoch: 15, Steps: 20 | Train Loss: 0.266 Vali Loss: 1.030 Vali Acc: 0.620 Test Loss: 1.030 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8269171714782715
Epoch: 16, Steps: 20 | Train Loss: 0.301 Vali Loss: 0.977 Vali Acc: 0.600 Test Loss: 0.977 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8707287311553955
Epoch: 17, Steps: 20 | Train Loss: 0.215 Vali Loss: 1.145 Vali Acc: 0.540 Test Loss: 1.145 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.747565507888794
Epoch: 18, Steps: 20 | Train Loss: 0.176 Vali Loss: 1.085 Vali Acc: 0.560 Test Loss: 1.085 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6932764053344727
Epoch: 19, Steps: 20 | Train Loss: 0.172 Vali Loss: 1.350 Vali Acc: 0.540 Test Loss: 1.350 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.675696611404419
Epoch: 20, Steps: 20 | Train Loss: 0.137 Vali Loss: 1.375 Vali Acc: 0.560 Test Loss: 1.375 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8595283031463623
Epoch: 21, Steps: 20 | Train Loss: 0.121 Vali Loss: 1.400 Vali Acc: 0.540 Test Loss: 1.400 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 529730
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.656336545944214
Epoch: 1, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.692 Vali Acc: 0.500 Test Loss: 0.692 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.5260224342346191
Epoch: 2, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.713 Vali Acc: 0.540 Test Loss: 0.713 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 1.760634422302246
Epoch: 3, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.766 Vali Acc: 0.480 Test Loss: 0.766 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7220180034637451
Epoch: 4, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.767 Vali Acc: 0.470 Test Loss: 0.767 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8240838050842285
Epoch: 5, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.741 Vali Acc: 0.440 Test Loss: 0.741 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8015737533569336
Epoch: 6, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.761 Vali Acc: 0.480 Test Loss: 0.761 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.244016170501709
Epoch: 7, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.740 Vali Acc: 0.540 Test Loss: 0.740 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5656840801239014
Epoch: 8, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.721 Vali Acc: 0.550 Test Loss: 0.721 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 9 cost time: 1.8985223770141602
Epoch: 9, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.764 Vali Acc: 0.550 Test Loss: 0.764 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8155510425567627
Epoch: 10, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.792 Vali Acc: 0.560 Test Loss: 0.792 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 11 cost time: 2.060513496398926
Epoch: 11, Steps: 20 | Train Loss: 0.422 Vali Loss: 0.733 Vali Acc: 0.560 Test Loss: 0.733 Test Acc: 0.560
Validation loss decreased (-0.559992 --> -0.559993).  Saving model ...
Epoch: 12 cost time: 2.0893330574035645
Epoch: 12, Steps: 20 | Train Loss: 0.390 Vali Loss: 0.891 Vali Acc: 0.530 Test Loss: 0.891 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6953513622283936
Epoch: 13, Steps: 20 | Train Loss: 0.368 Vali Loss: 0.846 Vali Acc: 0.540 Test Loss: 0.846 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9965119361877441
Epoch: 14, Steps: 20 | Train Loss: 0.325 Vali Loss: 0.950 Vali Acc: 0.560 Test Loss: 0.950 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9468584060668945
Epoch: 15, Steps: 20 | Train Loss: 0.335 Vali Loss: 0.911 Vali Acc: 0.520 Test Loss: 0.911 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.00197172164917
Epoch: 16, Steps: 20 | Train Loss: 0.270 Vali Loss: 0.941 Vali Acc: 0.540 Test Loss: 0.941 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8759536743164062
Epoch: 17, Steps: 20 | Train Loss: 0.243 Vali Loss: 0.986 Vali Acc: 0.480 Test Loss: 0.986 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.918475866317749
Epoch: 18, Steps: 20 | Train Loss: 0.211 Vali Loss: 0.964 Vali Acc: 0.540 Test Loss: 0.964 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.0558645725250244
Epoch: 19, Steps: 20 | Train Loss: 0.201 Vali Loss: 1.185 Vali Acc: 0.520 Test Loss: 1.185 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.532637119293213
Epoch: 20, Steps: 20 | Train Loss: 0.175 Vali Loss: 1.163 Vali Acc: 0.540 Test Loss: 1.163 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6253814697265625
Epoch: 21, Steps: 20 | Train Loss: 0.118 Vali Loss: 1.098 Vali Acc: 0.520 Test Loss: 1.098 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 522658
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.398313999176025
Epoch: 1, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.693 Vali Acc: 0.480 Test Loss: 0.693 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.5735104084014893
Epoch: 2, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.745 Vali Acc: 0.440 Test Loss: 0.745 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0801610946655273
Epoch: 3, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.759 Vali Acc: 0.500 Test Loss: 0.759 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 1.9624204635620117
Epoch: 4, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.712 Vali Acc: 0.570 Test Loss: 0.712 Test Acc: 0.570
Validation loss decreased (-0.499992 --> -0.569993).  Saving model ...
Epoch: 5 cost time: 2.0544052124023438
Epoch: 5, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.732 Vali Acc: 0.490 Test Loss: 0.732 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1670455932617188
Epoch: 6, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.774 Vali Acc: 0.490 Test Loss: 0.774 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8448448181152344
Epoch: 7, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.818 Vali Acc: 0.470 Test Loss: 0.818 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5213358402252197
Epoch: 8, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.745 Vali Acc: 0.480 Test Loss: 0.745 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5359833240509033
Epoch: 9, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.762 Vali Acc: 0.560 Test Loss: 0.762 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.717952013015747
Epoch: 10, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.733 Vali Acc: 0.590 Test Loss: 0.733 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589993).  Saving model ...
Epoch: 11 cost time: 1.4641242027282715
Epoch: 11, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.760 Vali Acc: 0.530 Test Loss: 0.760 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5621767044067383
Epoch: 12, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.766 Vali Acc: 0.530 Test Loss: 0.766 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.620197057723999
Epoch: 13, Steps: 20 | Train Loss: 0.415 Vali Loss: 0.770 Vali Acc: 0.540 Test Loss: 0.770 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6117947101593018
Epoch: 14, Steps: 20 | Train Loss: 0.393 Vali Loss: 0.786 Vali Acc: 0.580 Test Loss: 0.786 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9341351985931396
Epoch: 15, Steps: 20 | Train Loss: 0.323 Vali Loss: 0.845 Vali Acc: 0.520 Test Loss: 0.845 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5438907146453857
Epoch: 16, Steps: 20 | Train Loss: 0.294 Vali Loss: 0.942 Vali Acc: 0.580 Test Loss: 0.942 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.7789669036865234
Epoch: 17, Steps: 20 | Train Loss: 0.294 Vali Loss: 0.948 Vali Acc: 0.530 Test Loss: 0.948 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9893205165863037
Epoch: 18, Steps: 20 | Train Loss: 0.263 Vali Loss: 0.878 Vali Acc: 0.560 Test Loss: 0.878 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7592778205871582
Epoch: 19, Steps: 20 | Train Loss: 0.216 Vali Loss: 0.986 Vali Acc: 0.530 Test Loss: 0.986 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6082937717437744
Epoch: 20, Steps: 20 | Train Loss: 0.179 Vali Loss: 1.083 Vali Acc: 0.520 Test Loss: 1.083 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 519138
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.232494831085205
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.710 Vali Acc: 0.530 Test Loss: 0.710 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 2.2645440101623535
Epoch: 2, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.740 Vali Acc: 0.460 Test Loss: 0.740 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8675682544708252
Epoch: 3, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.723 Vali Acc: 0.510 Test Loss: 0.723 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.044621229171753
Epoch: 4, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.023052453994751
Epoch: 5, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.788 Vali Acc: 0.500 Test Loss: 0.788 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1159520149230957
Epoch: 6, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.768 Vali Acc: 0.560 Test Loss: 0.768 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559992).  Saving model ...
Epoch: 7 cost time: 2.053208589553833
Epoch: 7, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.755 Vali Acc: 0.530 Test Loss: 0.755 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.208911180496216
Epoch: 8, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.777 Vali Acc: 0.520 Test Loss: 0.777 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3909120559692383
Epoch: 9, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.766 Vali Acc: 0.480 Test Loss: 0.766 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.063605546951294
Epoch: 10, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.744 Vali Acc: 0.540 Test Loss: 0.744 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1656386852264404
Epoch: 11, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.762 Vali Acc: 0.550 Test Loss: 0.762 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.100410223007202
Epoch: 12, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.777 Vali Acc: 0.530 Test Loss: 0.777 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7894890308380127
Epoch: 13, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.783 Vali Acc: 0.560 Test Loss: 0.783 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9780480861663818
Epoch: 14, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.877 Vali Acc: 0.510 Test Loss: 0.877 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8459808826446533
Epoch: 15, Steps: 20 | Train Loss: 0.379 Vali Loss: 0.792 Vali Acc: 0.590 Test Loss: 0.792 Test Acc: 0.590
Validation loss decreased (-0.559992 --> -0.589992).  Saving model ...
Epoch: 16 cost time: 1.9637763500213623
Epoch: 16, Steps: 20 | Train Loss: 0.348 Vali Loss: 0.834 Vali Acc: 0.590 Test Loss: 0.834 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6795880794525146
Epoch: 17, Steps: 20 | Train Loss: 0.310 Vali Loss: 0.825 Vali Acc: 0.610 Test Loss: 0.825 Test Acc: 0.610
Validation loss decreased (-0.589992 --> -0.609992).  Saving model ...
Epoch: 18 cost time: 1.9363410472869873
Epoch: 18, Steps: 20 | Train Loss: 0.303 Vali Loss: 0.834 Vali Acc: 0.540 Test Loss: 0.834 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7646260261535645
Epoch: 19, Steps: 20 | Train Loss: 0.262 Vali Loss: 0.921 Vali Acc: 0.550 Test Loss: 0.921 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.252592086791992
Epoch: 20, Steps: 20 | Train Loss: 0.245 Vali Loss: 0.959 Vali Acc: 0.560 Test Loss: 0.959 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9182746410369873
Epoch: 21, Steps: 20 | Train Loss: 0.193 Vali Loss: 1.049 Vali Acc: 0.530 Test Loss: 1.049 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8178355693817139
Epoch: 22, Steps: 20 | Train Loss: 0.164 Vali Loss: 1.041 Vali Acc: 0.570 Test Loss: 1.041 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.1354191303253174
Epoch: 23, Steps: 20 | Train Loss: 0.140 Vali Loss: 1.002 Vali Acc: 0.560 Test Loss: 1.002 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.804621934890747
Epoch: 24, Steps: 20 | Train Loss: 0.113 Vali Loss: 1.339 Vali Acc: 0.520 Test Loss: 1.339 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.941544771194458
Epoch: 25, Steps: 20 | Train Loss: 0.097 Vali Loss: 1.202 Vali Acc: 0.550 Test Loss: 1.202 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7110614776611328
Epoch: 26, Steps: 20 | Train Loss: 0.073 Vali Loss: 1.276 Vali Acc: 0.530 Test Loss: 1.276 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.7833828926086426
Epoch: 27, Steps: 20 | Train Loss: 0.058 Vali Loss: 1.135 Vali Acc: 0.590 Test Loss: 1.135 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 515650
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.506469964981079
Epoch: 1, Steps: 20 | Train Loss: 1.542 Vali Loss: 1.514 Vali Acc: 0.510 Test Loss: 1.514 Test Acc: 0.510
Validation loss decreased (inf --> -0.509985).  Saving model ...
Epoch: 2 cost time: 3.43866229057312
Epoch: 2, Steps: 20 | Train Loss: 1.888 Vali Loss: 2.478 Vali Acc: 0.550 Test Loss: 2.478 Test Acc: 0.550
Validation loss decreased (-0.509985 --> -0.549975).  Saving model ...
Epoch: 3 cost time: 3.2905635833740234
Epoch: 3, Steps: 20 | Train Loss: 2.771 Vali Loss: 4.860 Vali Acc: 0.620 Test Loss: 4.860 Test Acc: 0.620
Validation loss decreased (-0.549975 --> -0.619951).  Saving model ...
Epoch: 4 cost time: 3.126439094543457
Epoch: 4, Steps: 20 | Train Loss: 4.064 Vali Loss: 5.450 Vali Acc: 0.450 Test Loss: 5.450 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7345588207244873
Epoch: 5, Steps: 20 | Train Loss: 2.939 Vali Loss: 4.757 Vali Acc: 0.550 Test Loss: 4.757 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.772535800933838
Epoch: 6, Steps: 20 | Train Loss: 1.837 Vali Loss: 3.729 Vali Acc: 0.560 Test Loss: 3.729 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.846181631088257
Epoch: 7, Steps: 20 | Train Loss: 1.524 Vali Loss: 2.956 Vali Acc: 0.620 Test Loss: 2.956 Test Acc: 0.620
Validation loss decreased (-0.619951 --> -0.619970).  Saving model ...
Epoch: 8 cost time: 2.6159586906433105
Epoch: 8, Steps: 20 | Train Loss: 1.604 Vali Loss: 5.666 Vali Acc: 0.550 Test Loss: 5.666 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3663980960845947
Epoch: 9, Steps: 20 | Train Loss: 2.808 Vali Loss: 4.449 Vali Acc: 0.580 Test Loss: 4.449 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.471344232559204
Epoch: 10, Steps: 20 | Train Loss: 1.147 Vali Loss: 6.353 Vali Acc: 0.530 Test Loss: 6.353 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.8554837703704834
Epoch: 11, Steps: 20 | Train Loss: 1.993 Vali Loss: 4.190 Vali Acc: 0.580 Test Loss: 4.190 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.900252342224121
Epoch: 12, Steps: 20 | Train Loss: 2.126 Vali Loss: 10.665 Vali Acc: 0.540 Test Loss: 10.665 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.8936407566070557
Epoch: 13, Steps: 20 | Train Loss: 3.554 Vali Loss: 8.402 Vali Acc: 0.560 Test Loss: 8.402 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.9152097702026367
Epoch: 14, Steps: 20 | Train Loss: 1.734 Vali Loss: 6.123 Vali Acc: 0.580 Test Loss: 6.123 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.2960329055786133
Epoch: 15, Steps: 20 | Train Loss: 0.971 Vali Loss: 7.581 Vali Acc: 0.590 Test Loss: 7.581 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.8194892406463623
Epoch: 16, Steps: 20 | Train Loss: 1.418 Vali Loss: 9.111 Vali Acc: 0.620 Test Loss: 9.111 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.2356925010681152
Epoch: 17, Steps: 20 | Train Loss: 2.515 Vali Loss: 7.184 Vali Acc: 0.590 Test Loss: 7.184 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 4976386
model size : 19.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.692320346832275
Epoch: 1, Steps: 20 | Train Loss: 0.962 Vali Loss: 1.352 Vali Acc: 0.490 Test Loss: 1.352 Test Acc: 0.490
Validation loss decreased (inf --> -0.489986).  Saving model ...
Epoch: 2 cost time: 2.282391309738159
Epoch: 2, Steps: 20 | Train Loss: 1.100 Vali Loss: 3.314 Vali Acc: 0.460 Test Loss: 3.314 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.118356704711914
Epoch: 3, Steps: 20 | Train Loss: 1.434 Vali Loss: 2.443 Vali Acc: 0.490 Test Loss: 2.443 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.174226999282837
Epoch: 4, Steps: 20 | Train Loss: 2.059 Vali Loss: 2.228 Vali Acc: 0.550 Test Loss: 2.228 Test Acc: 0.550
Validation loss decreased (-0.489986 --> -0.549978).  Saving model ...
Epoch: 5 cost time: 2.1867496967315674
Epoch: 5, Steps: 20 | Train Loss: 1.606 Vali Loss: 3.548 Vali Acc: 0.460 Test Loss: 3.548 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6066861152648926
Epoch: 6, Steps: 20 | Train Loss: 2.320 Vali Loss: 4.194 Vali Acc: 0.520 Test Loss: 4.194 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3394787311553955
Epoch: 7, Steps: 20 | Train Loss: 1.418 Vali Loss: 2.171 Vali Acc: 0.600 Test Loss: 2.171 Test Acc: 0.600
Validation loss decreased (-0.549978 --> -0.599978).  Saving model ...
Epoch: 8 cost time: 1.9772589206695557
Epoch: 8, Steps: 20 | Train Loss: 1.028 Vali Loss: 3.491 Vali Acc: 0.540 Test Loss: 3.491 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1910901069641113
Epoch: 9, Steps: 20 | Train Loss: 1.511 Vali Loss: 4.506 Vali Acc: 0.510 Test Loss: 4.506 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1543025970458984
Epoch: 10, Steps: 20 | Train Loss: 1.036 Vali Loss: 3.931 Vali Acc: 0.610 Test Loss: 3.931 Test Acc: 0.610
Validation loss decreased (-0.599978 --> -0.609961).  Saving model ...
Epoch: 11 cost time: 2.197493076324463
Epoch: 11, Steps: 20 | Train Loss: 1.423 Vali Loss: 5.025 Vali Acc: 0.480 Test Loss: 5.025 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.285240411758423
Epoch: 12, Steps: 20 | Train Loss: 1.158 Vali Loss: 5.677 Vali Acc: 0.570 Test Loss: 5.677 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7144861221313477
Epoch: 13, Steps: 20 | Train Loss: 1.775 Vali Loss: 5.001 Vali Acc: 0.590 Test Loss: 5.001 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.948554039001465
Epoch: 14, Steps: 20 | Train Loss: 1.060 Vali Loss: 4.435 Vali Acc: 0.590 Test Loss: 4.435 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.089404582977295
Epoch: 15, Steps: 20 | Train Loss: 0.614 Vali Loss: 5.626 Vali Acc: 0.570 Test Loss: 5.626 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.835228681564331
Epoch: 16, Steps: 20 | Train Loss: 0.824 Vali Loss: 3.582 Vali Acc: 0.600 Test Loss: 3.582 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.9815783500671387
Epoch: 17, Steps: 20 | Train Loss: 0.528 Vali Loss: 4.345 Vali Acc: 0.540 Test Loss: 4.345 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.7415356636047363
Epoch: 18, Steps: 20 | Train Loss: 0.288 Vali Loss: 5.436 Vali Acc: 0.560 Test Loss: 5.436 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.933619737625122
Epoch: 19, Steps: 20 | Train Loss: 1.138 Vali Loss: 6.543 Vali Acc: 0.560 Test Loss: 6.543 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.475037097930908
Epoch: 20, Steps: 20 | Train Loss: 0.896 Vali Loss: 7.538 Vali Acc: 0.550 Test Loss: 7.538 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 4618242
model size : 17.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.389082908630371
Epoch: 1, Steps: 20 | Train Loss: 1.003 Vali Loss: 1.771 Vali Acc: 0.480 Test Loss: 1.771 Test Acc: 0.480
Validation loss decreased (inf --> -0.479982).  Saving model ...
Epoch: 2 cost time: 2.543793201446533
Epoch: 2, Steps: 20 | Train Loss: 1.113 Vali Loss: 1.394 Vali Acc: 0.550 Test Loss: 1.394 Test Acc: 0.550
Validation loss decreased (-0.479982 --> -0.549986).  Saving model ...
Epoch: 3 cost time: 2.0953986644744873
Epoch: 3, Steps: 20 | Train Loss: 1.013 Vali Loss: 2.108 Vali Acc: 0.480 Test Loss: 2.108 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0356364250183105
Epoch: 4, Steps: 20 | Train Loss: 1.413 Vali Loss: 2.391 Vali Acc: 0.550 Test Loss: 2.391 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4211783409118652
Epoch: 5, Steps: 20 | Train Loss: 1.671 Vali Loss: 2.702 Vali Acc: 0.530 Test Loss: 2.702 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.316481828689575
Epoch: 6, Steps: 20 | Train Loss: 1.189 Vali Loss: 2.717 Vali Acc: 0.540 Test Loss: 2.717 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1566174030303955
Epoch: 7, Steps: 20 | Train Loss: 0.889 Vali Loss: 2.951 Vali Acc: 0.520 Test Loss: 2.951 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.0849595069885254
Epoch: 8, Steps: 20 | Train Loss: 1.503 Vali Loss: 5.332 Vali Acc: 0.530 Test Loss: 5.332 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7855637073516846
Epoch: 9, Steps: 20 | Train Loss: 1.900 Vali Loss: 4.194 Vali Acc: 0.560 Test Loss: 4.194 Test Acc: 0.560
Validation loss decreased (-0.549986 --> -0.559958).  Saving model ...
Epoch: 10 cost time: 2.196864366531372
Epoch: 10, Steps: 20 | Train Loss: 2.259 Vali Loss: 4.282 Vali Acc: 0.520 Test Loss: 4.282 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7263808250427246
Epoch: 11, Steps: 20 | Train Loss: 1.380 Vali Loss: 3.797 Vali Acc: 0.570 Test Loss: 3.797 Test Acc: 0.570
Validation loss decreased (-0.559958 --> -0.569962).  Saving model ...
Epoch: 12 cost time: 2.1966140270233154
Epoch: 12, Steps: 20 | Train Loss: 1.278 Vali Loss: 3.898 Vali Acc: 0.550 Test Loss: 3.898 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.054502010345459
Epoch: 13, Steps: 20 | Train Loss: 0.554 Vali Loss: 3.904 Vali Acc: 0.570 Test Loss: 3.904 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.996398687362671
Epoch: 14, Steps: 20 | Train Loss: 0.803 Vali Loss: 4.124 Vali Acc: 0.590 Test Loss: 4.124 Test Acc: 0.590
Validation loss decreased (-0.569962 --> -0.589959).  Saving model ...
Epoch: 15 cost time: 2.1275360584259033
Epoch: 15, Steps: 20 | Train Loss: 0.754 Vali Loss: 5.626 Vali Acc: 0.550 Test Loss: 5.626 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6694750785827637
Epoch: 16, Steps: 20 | Train Loss: 1.421 Vali Loss: 6.803 Vali Acc: 0.550 Test Loss: 6.803 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.57733154296875
Epoch: 17, Steps: 20 | Train Loss: 0.965 Vali Loss: 4.381 Vali Acc: 0.580 Test Loss: 4.381 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.3126609325408936
Epoch: 18, Steps: 20 | Train Loss: 0.601 Vali Loss: 4.192 Vali Acc: 0.590 Test Loss: 4.192 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.5181047916412354
Epoch: 19, Steps: 20 | Train Loss: 0.311 Vali Loss: 5.387 Vali Acc: 0.560 Test Loss: 5.387 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.711432456970215
Epoch: 20, Steps: 20 | Train Loss: 0.767 Vali Loss: 6.331 Vali Acc: 0.580 Test Loss: 6.331 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.8591649532318115
Epoch: 21, Steps: 20 | Train Loss: 0.575 Vali Loss: 5.271 Vali Acc: 0.520 Test Loss: 5.271 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.879497528076172
Epoch: 22, Steps: 20 | Train Loss: 0.294 Vali Loss: 5.232 Vali Acc: 0.510 Test Loss: 5.232 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.9829063415527344
Epoch: 23, Steps: 20 | Train Loss: 0.251 Vali Loss: 5.489 Vali Acc: 0.580 Test Loss: 5.489 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.444868564605713
Epoch: 24, Steps: 20 | Train Loss: 0.106 Vali Loss: 6.519 Vali Acc: 0.540 Test Loss: 6.519 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 4618498
model size : 17.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.392347574234009
Epoch: 1, Steps: 20 | Train Loss: 0.904 Vali Loss: 0.912 Vali Acc: 0.480 Test Loss: 0.912 Test Acc: 0.480
Validation loss decreased (inf --> -0.479991).  Saving model ...
Epoch: 2 cost time: 2.2926414012908936
Epoch: 2, Steps: 20 | Train Loss: 0.909 Vali Loss: 1.491 Vali Acc: 0.480 Test Loss: 1.491 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.295100212097168
Epoch: 3, Steps: 20 | Train Loss: 0.982 Vali Loss: 1.169 Vali Acc: 0.560 Test Loss: 1.169 Test Acc: 0.560
Validation loss decreased (-0.479991 --> -0.559988).  Saving model ...
Epoch: 4 cost time: 2.4753944873809814
Epoch: 4, Steps: 20 | Train Loss: 1.047 Vali Loss: 1.440 Vali Acc: 0.480 Test Loss: 1.440 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2673563957214355
Epoch: 5, Steps: 20 | Train Loss: 0.810 Vali Loss: 2.176 Vali Acc: 0.550 Test Loss: 2.176 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8995978832244873
Epoch: 6, Steps: 20 | Train Loss: 1.096 Vali Loss: 1.567 Vali Acc: 0.570 Test Loss: 1.567 Test Acc: 0.570
Validation loss decreased (-0.559988 --> -0.569984).  Saving model ...
Epoch: 7 cost time: 2.014979600906372
Epoch: 7, Steps: 20 | Train Loss: 0.628 Vali Loss: 2.316 Vali Acc: 0.600 Test Loss: 2.316 Test Acc: 0.600
Validation loss decreased (-0.569984 --> -0.599977).  Saving model ...
Epoch: 8 cost time: 1.9014413356781006
Epoch: 8, Steps: 20 | Train Loss: 0.964 Vali Loss: 2.141 Vali Acc: 0.560 Test Loss: 2.141 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1996753215789795
Epoch: 9, Steps: 20 | Train Loss: 0.646 Vali Loss: 2.413 Vali Acc: 0.600 Test Loss: 2.413 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.101200819015503
Epoch: 10, Steps: 20 | Train Loss: 0.467 Vali Loss: 2.475 Vali Acc: 0.600 Test Loss: 2.475 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3336730003356934
Epoch: 11, Steps: 20 | Train Loss: 1.102 Vali Loss: 4.394 Vali Acc: 0.540 Test Loss: 4.394 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.142890453338623
Epoch: 12, Steps: 20 | Train Loss: 0.892 Vali Loss: 2.840 Vali Acc: 0.470 Test Loss: 2.840 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.289801836013794
Epoch: 13, Steps: 20 | Train Loss: 0.489 Vali Loss: 3.047 Vali Acc: 0.540 Test Loss: 3.047 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.1856672763824463
Epoch: 14, Steps: 20 | Train Loss: 0.499 Vali Loss: 4.035 Vali Acc: 0.510 Test Loss: 4.035 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.17647385597229
Epoch: 15, Steps: 20 | Train Loss: 0.449 Vali Loss: 3.775 Vali Acc: 0.610 Test Loss: 3.775 Test Acc: 0.610
Validation loss decreased (-0.599977 --> -0.609962).  Saving model ...
Epoch: 16 cost time: 2.0444653034210205
Epoch: 16, Steps: 20 | Train Loss: 0.339 Vali Loss: 5.141 Vali Acc: 0.590 Test Loss: 5.141 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6080918312072754
Epoch: 17, Steps: 20 | Train Loss: 0.548 Vali Loss: 2.765 Vali Acc: 0.640 Test Loss: 2.765 Test Acc: 0.640
Validation loss decreased (-0.609962 --> -0.639972).  Saving model ...
Epoch: 18 cost time: 2.5995891094207764
Epoch: 18, Steps: 20 | Train Loss: 0.406 Vali Loss: 3.957 Vali Acc: 0.530 Test Loss: 3.957 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.908039093017578
Epoch: 19, Steps: 20 | Train Loss: 0.327 Vali Loss: 3.986 Vali Acc: 0.550 Test Loss: 3.986 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.637559413909912
Epoch: 20, Steps: 20 | Train Loss: 0.222 Vali Loss: 3.720 Vali Acc: 0.530 Test Loss: 3.720 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.706554889678955
Epoch: 21, Steps: 20 | Train Loss: 0.491 Vali Loss: 5.748 Vali Acc: 0.480 Test Loss: 5.748 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.4238030910491943
Epoch: 22, Steps: 20 | Train Loss: 0.230 Vali Loss: 4.515 Vali Acc: 0.540 Test Loss: 4.515 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.630889892578125
Epoch: 23, Steps: 20 | Train Loss: 0.202 Vali Loss: 4.196 Vali Acc: 0.550 Test Loss: 4.196 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.8178610801696777
Epoch: 24, Steps: 20 | Train Loss: 0.126 Vali Loss: 4.714 Vali Acc: 0.570 Test Loss: 4.714 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.522963047027588
Epoch: 25, Steps: 20 | Train Loss: 0.165 Vali Loss: 4.274 Vali Acc: 0.570 Test Loss: 4.274 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.5996286869049072
Epoch: 26, Steps: 20 | Train Loss: 0.172 Vali Loss: 5.144 Vali Acc: 0.550 Test Loss: 5.144 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.4338066577911377
Epoch: 27, Steps: 20 | Train Loss: 0.196 Vali Loss: 6.272 Vali Acc: 0.470 Test Loss: 6.272 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 4489730
model size : 17.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.420659065246582
Epoch: 1, Steps: 20 | Train Loss: 0.801 Vali Loss: 0.783 Vali Acc: 0.540 Test Loss: 0.783 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 2.6375832557678223
Epoch: 2, Steps: 20 | Train Loss: 0.771 Vali Loss: 0.908 Vali Acc: 0.540 Test Loss: 0.908 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6713602542877197
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 1.065 Vali Acc: 0.530 Test Loss: 1.065 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.89485239982605
Epoch: 4, Steps: 20 | Train Loss: 0.735 Vali Loss: 1.332 Vali Acc: 0.520 Test Loss: 1.332 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6475789546966553
Epoch: 5, Steps: 20 | Train Loss: 0.552 Vali Loss: 1.610 Vali Acc: 0.590 Test Loss: 1.610 Test Acc: 0.590
Validation loss decreased (-0.539992 --> -0.589984).  Saving model ...
Epoch: 6 cost time: 2.398974657058716
Epoch: 6, Steps: 20 | Train Loss: 0.574 Vali Loss: 2.450 Vali Acc: 0.490 Test Loss: 2.450 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.673102855682373
Epoch: 7, Steps: 20 | Train Loss: 0.559 Vali Loss: 1.194 Vali Acc: 0.560 Test Loss: 1.194 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1456170082092285
Epoch: 8, Steps: 20 | Train Loss: 0.483 Vali Loss: 1.218 Vali Acc: 0.640 Test Loss: 1.218 Test Acc: 0.640
Validation loss decreased (-0.589984 --> -0.639988).  Saving model ...
Epoch: 9 cost time: 2.3556811809539795
Epoch: 9, Steps: 20 | Train Loss: 0.313 Vali Loss: 1.686 Vali Acc: 0.580 Test Loss: 1.686 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9044947624206543
Epoch: 10, Steps: 20 | Train Loss: 0.537 Vali Loss: 2.903 Vali Acc: 0.510 Test Loss: 2.903 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0509326457977295
Epoch: 11, Steps: 20 | Train Loss: 0.441 Vali Loss: 1.526 Vali Acc: 0.610 Test Loss: 1.526 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9958906173706055
Epoch: 12, Steps: 20 | Train Loss: 0.320 Vali Loss: 2.275 Vali Acc: 0.530 Test Loss: 2.275 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.751157283782959
Epoch: 13, Steps: 20 | Train Loss: 0.242 Vali Loss: 1.918 Vali Acc: 0.600 Test Loss: 1.918 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.123914957046509
Epoch: 14, Steps: 20 | Train Loss: 0.301 Vali Loss: 2.527 Vali Acc: 0.500 Test Loss: 2.527 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6948254108428955
Epoch: 15, Steps: 20 | Train Loss: 0.304 Vali Loss: 2.534 Vali Acc: 0.520 Test Loss: 2.534 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.0098230838775635
Epoch: 16, Steps: 20 | Train Loss: 0.523 Vali Loss: 2.904 Vali Acc: 0.550 Test Loss: 2.904 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.981151819229126
Epoch: 17, Steps: 20 | Train Loss: 0.250 Vali Loss: 2.961 Vali Acc: 0.570 Test Loss: 2.961 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.5367271900177
Epoch: 18, Steps: 20 | Train Loss: 0.364 Vali Loss: 3.376 Vali Acc: 0.530 Test Loss: 3.376 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 4433154
model size : 17.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.720640659332275
Epoch: 1, Steps: 20 | Train Loss: 0.800 Vali Loss: 0.715 Vali Acc: 0.590 Test Loss: 0.715 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 2.574866771697998
Epoch: 2, Steps: 20 | Train Loss: 0.803 Vali Loss: 0.938 Vali Acc: 0.540 Test Loss: 0.938 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.288893938064575
Epoch: 3, Steps: 20 | Train Loss: 0.746 Vali Loss: 1.440 Vali Acc: 0.560 Test Loss: 1.440 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9081196784973145
Epoch: 4, Steps: 20 | Train Loss: 0.770 Vali Loss: 1.193 Vali Acc: 0.550 Test Loss: 1.193 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.244602918624878
Epoch: 5, Steps: 20 | Train Loss: 0.639 Vali Loss: 1.441 Vali Acc: 0.580 Test Loss: 1.441 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.434725284576416
Epoch: 6, Steps: 20 | Train Loss: 0.572 Vali Loss: 1.140 Vali Acc: 0.560 Test Loss: 1.140 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.474625587463379
Epoch: 7, Steps: 20 | Train Loss: 0.691 Vali Loss: 1.661 Vali Acc: 0.540 Test Loss: 1.661 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.3413922786712646
Epoch: 8, Steps: 20 | Train Loss: 0.462 Vali Loss: 1.251 Vali Acc: 0.570 Test Loss: 1.251 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.5380325317382812
Epoch: 9, Steps: 20 | Train Loss: 0.470 Vali Loss: 1.163 Vali Acc: 0.560 Test Loss: 1.163 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.6418893337249756
Epoch: 10, Steps: 20 | Train Loss: 0.279 Vali Loss: 1.300 Vali Acc: 0.590 Test Loss: 1.300 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.5537145137786865
Epoch: 11, Steps: 20 | Train Loss: 0.375 Vali Loss: 1.452 Vali Acc: 0.600 Test Loss: 1.452 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599985).  Saving model ...
Epoch: 12 cost time: 2.585956335067749
Epoch: 12, Steps: 20 | Train Loss: 0.269 Vali Loss: 2.057 Vali Acc: 0.590 Test Loss: 2.057 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5133438110351562
Epoch: 13, Steps: 20 | Train Loss: 0.270 Vali Loss: 1.740 Vali Acc: 0.580 Test Loss: 1.740 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9388771057128906
Epoch: 14, Steps: 20 | Train Loss: 0.355 Vali Loss: 2.052 Vali Acc: 0.570 Test Loss: 2.052 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2182042598724365
Epoch: 15, Steps: 20 | Train Loss: 0.307 Vali Loss: 2.519 Vali Acc: 0.540 Test Loss: 2.519 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9874510765075684
Epoch: 16, Steps: 20 | Train Loss: 0.294 Vali Loss: 2.057 Vali Acc: 0.610 Test Loss: 2.057 Test Acc: 0.610
Validation loss decreased (-0.599985 --> -0.609979).  Saving model ...
Epoch: 17 cost time: 2.0087993144989014
Epoch: 17, Steps: 20 | Train Loss: 0.225 Vali Loss: 2.137 Vali Acc: 0.610 Test Loss: 2.137 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9329712390899658
Epoch: 18, Steps: 20 | Train Loss: 0.131 Vali Loss: 2.937 Vali Acc: 0.530 Test Loss: 2.937 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.964188814163208
Epoch: 19, Steps: 20 | Train Loss: 0.204 Vali Loss: 2.019 Vali Acc: 0.630 Test Loss: 2.019 Test Acc: 0.630
Validation loss decreased (-0.609979 --> -0.629980).  Saving model ...
Epoch: 20 cost time: 2.2073936462402344
Epoch: 20, Steps: 20 | Train Loss: 0.152 Vali Loss: 3.099 Vali Acc: 0.540 Test Loss: 3.099 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.274348020553589
Epoch: 21, Steps: 20 | Train Loss: 0.061 Vali Loss: 2.486 Vali Acc: 0.560 Test Loss: 2.486 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.096982002258301
Epoch: 22, Steps: 20 | Train Loss: 0.086 Vali Loss: 2.997 Vali Acc: 0.560 Test Loss: 2.997 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.053313970565796
Epoch: 23, Steps: 20 | Train Loss: 0.073 Vali Loss: 3.075 Vali Acc: 0.490 Test Loss: 3.075 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.1022896766662598
Epoch: 24, Steps: 20 | Train Loss: 0.101 Vali Loss: 3.139 Vali Acc: 0.560 Test Loss: 3.139 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.1641080379486084
Epoch: 25, Steps: 20 | Train Loss: 0.111 Vali Loss: 3.779 Vali Acc: 0.530 Test Loss: 3.779 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.4737303256988525
Epoch: 26, Steps: 20 | Train Loss: 0.127 Vali Loss: 2.688 Vali Acc: 0.550 Test Loss: 2.688 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.7884876728057861
Epoch: 27, Steps: 20 | Train Loss: 0.091 Vali Loss: 3.280 Vali Acc: 0.610 Test Loss: 3.280 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8999912738800049
Epoch: 28, Steps: 20 | Train Loss: 0.111 Vali Loss: 3.970 Vali Acc: 0.530 Test Loss: 3.970 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.9122483730316162
Epoch: 29, Steps: 20 | Train Loss: 0.140 Vali Loss: 3.796 Vali Acc: 0.580 Test Loss: 3.796 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 4404994
model size : 16.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.336287975311279
Epoch: 1, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.757 Vali Acc: 0.490 Test Loss: 0.757 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.447699546813965
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.791 Vali Acc: 0.550 Test Loss: 0.791 Test Acc: 0.550
Validation loss decreased (-0.489992 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 2.0256552696228027
Epoch: 3, Steps: 20 | Train Loss: 0.660 Vali Loss: 1.165 Vali Acc: 0.510 Test Loss: 1.165 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5167338848114014
Epoch: 4, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.927 Vali Acc: 0.560 Test Loss: 0.927 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559991).  Saving model ...
Epoch: 5 cost time: 2.2909133434295654
Epoch: 5, Steps: 20 | Train Loss: 0.629 Vali Loss: 1.192 Vali Acc: 0.520 Test Loss: 1.192 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.060878276824951
Epoch: 6, Steps: 20 | Train Loss: 0.798 Vali Loss: 0.997 Vali Acc: 0.540 Test Loss: 0.997 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.186737060546875
Epoch: 7, Steps: 20 | Train Loss: 0.528 Vali Loss: 1.310 Vali Acc: 0.530 Test Loss: 1.310 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.085163116455078
Epoch: 8, Steps: 20 | Train Loss: 0.468 Vali Loss: 1.296 Vali Acc: 0.510 Test Loss: 1.296 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.80039644241333
Epoch: 9, Steps: 20 | Train Loss: 0.410 Vali Loss: 1.646 Vali Acc: 0.460 Test Loss: 1.646 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8351836204528809
Epoch: 10, Steps: 20 | Train Loss: 0.424 Vali Loss: 1.286 Vali Acc: 0.470 Test Loss: 1.286 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.953007698059082
Epoch: 11, Steps: 20 | Train Loss: 0.333 Vali Loss: 1.265 Vali Acc: 0.520 Test Loss: 1.265 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.1729652881622314
Epoch: 12, Steps: 20 | Train Loss: 0.322 Vali Loss: 1.358 Vali Acc: 0.590 Test Loss: 1.358 Test Acc: 0.590
Validation loss decreased (-0.559991 --> -0.589986).  Saving model ...
Epoch: 13 cost time: 2.089517593383789
Epoch: 13, Steps: 20 | Train Loss: 0.248 Vali Loss: 1.379 Vali Acc: 0.560 Test Loss: 1.379 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.776606798171997
Epoch: 14, Steps: 20 | Train Loss: 0.219 Vali Loss: 1.396 Vali Acc: 0.570 Test Loss: 1.396 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0500617027282715
Epoch: 15, Steps: 20 | Train Loss: 0.279 Vali Loss: 2.121 Vali Acc: 0.550 Test Loss: 2.121 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.241116762161255
Epoch: 16, Steps: 20 | Train Loss: 0.234 Vali Loss: 2.272 Vali Acc: 0.460 Test Loss: 2.272 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.4264464378356934
Epoch: 17, Steps: 20 | Train Loss: 0.267 Vali Loss: 1.953 Vali Acc: 0.580 Test Loss: 1.953 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.559229612350464
Epoch: 18, Steps: 20 | Train Loss: 0.276 Vali Loss: 2.829 Vali Acc: 0.510 Test Loss: 2.829 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.447781562805176
Epoch: 19, Steps: 20 | Train Loss: 0.249 Vali Loss: 3.407 Vali Acc: 0.530 Test Loss: 3.407 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.273533344268799
Epoch: 20, Steps: 20 | Train Loss: 0.400 Vali Loss: 2.530 Vali Acc: 0.580 Test Loss: 2.530 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.57633376121521
Epoch: 21, Steps: 20 | Train Loss: 0.219 Vali Loss: 2.715 Vali Acc: 0.470 Test Loss: 2.715 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.3385000228881836
Epoch: 22, Steps: 20 | Train Loss: 0.119 Vali Loss: 2.817 Vali Acc: 0.530 Test Loss: 2.817 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 4362754
model size : 16.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.2262492179870605
Epoch: 1, Steps: 20 | Train Loss: 0.936 Vali Loss: 0.799 Vali Acc: 0.550 Test Loss: 0.799 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 1.776427984237671
Epoch: 2, Steps: 20 | Train Loss: 0.812 Vali Loss: 1.285 Vali Acc: 0.530 Test Loss: 1.285 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9771084785461426
Epoch: 3, Steps: 20 | Train Loss: 1.069 Vali Loss: 1.228 Vali Acc: 0.570 Test Loss: 1.228 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569988).  Saving model ...
Epoch: 4 cost time: 1.837512731552124
Epoch: 4, Steps: 20 | Train Loss: 1.514 Vali Loss: 2.542 Vali Acc: 0.530 Test Loss: 2.542 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.860288381576538
Epoch: 5, Steps: 20 | Train Loss: 1.188 Vali Loss: 1.518 Vali Acc: 0.600 Test Loss: 1.518 Test Acc: 0.600
Validation loss decreased (-0.569988 --> -0.599985).  Saving model ...
Epoch: 6 cost time: 1.5922482013702393
Epoch: 6, Steps: 20 | Train Loss: 1.808 Vali Loss: 4.162 Vali Acc: 0.550 Test Loss: 4.162 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4691696166992188
Epoch: 7, Steps: 20 | Train Loss: 1.397 Vali Loss: 4.318 Vali Acc: 0.520 Test Loss: 4.318 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6303555965423584
Epoch: 8, Steps: 20 | Train Loss: 1.657 Vali Loss: 3.010 Vali Acc: 0.510 Test Loss: 3.010 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7043566703796387
Epoch: 9, Steps: 20 | Train Loss: 1.434 Vali Loss: 2.800 Vali Acc: 0.560 Test Loss: 2.800 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4766931533813477
Epoch: 10, Steps: 20 | Train Loss: 1.190 Vali Loss: 3.671 Vali Acc: 0.500 Test Loss: 3.671 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8101494312286377
Epoch: 11, Steps: 20 | Train Loss: 2.335 Vali Loss: 2.916 Vali Acc: 0.570 Test Loss: 2.916 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.4588539600372314
Epoch: 12, Steps: 20 | Train Loss: 1.363 Vali Loss: 4.331 Vali Acc: 0.520 Test Loss: 4.331 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.0410752296447754
Epoch: 13, Steps: 20 | Train Loss: 1.285 Vali Loss: 5.710 Vali Acc: 0.540 Test Loss: 5.710 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.1699118614196777
Epoch: 14, Steps: 20 | Train Loss: 1.329 Vali Loss: 3.741 Vali Acc: 0.590 Test Loss: 3.741 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.9588682651519775
Epoch: 15, Steps: 20 | Train Loss: 0.837 Vali Loss: 3.104 Vali Acc: 0.590 Test Loss: 3.104 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1570690
model size : 6.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.189971685409546
Epoch: 1, Steps: 20 | Train Loss: 0.890 Vali Loss: 1.045 Vali Acc: 0.430 Test Loss: 1.045 Test Acc: 0.430
Validation loss decreased (inf --> -0.429990).  Saving model ...
Epoch: 2 cost time: 2.1456499099731445
Epoch: 2, Steps: 20 | Train Loss: 1.099 Vali Loss: 2.077 Vali Acc: 0.430 Test Loss: 2.077 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.621201515197754
Epoch: 3, Steps: 20 | Train Loss: 0.961 Vali Loss: 2.026 Vali Acc: 0.510 Test Loss: 2.026 Test Acc: 0.510
Validation loss decreased (-0.429990 --> -0.509980).  Saving model ...
Epoch: 4 cost time: 1.580857753753662
Epoch: 4, Steps: 20 | Train Loss: 0.883 Vali Loss: 0.924 Vali Acc: 0.650 Test Loss: 0.924 Test Acc: 0.650
Validation loss decreased (-0.509980 --> -0.649991).  Saving model ...
Epoch: 5 cost time: 1.9260540008544922
Epoch: 5, Steps: 20 | Train Loss: 0.969 Vali Loss: 1.281 Vali Acc: 0.540 Test Loss: 1.281 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.336287021636963
Epoch: 6, Steps: 20 | Train Loss: 0.805 Vali Loss: 1.345 Vali Acc: 0.580 Test Loss: 1.345 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8390529155731201
Epoch: 7, Steps: 20 | Train Loss: 0.498 Vali Loss: 2.108 Vali Acc: 0.490 Test Loss: 2.108 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.17214298248291
Epoch: 8, Steps: 20 | Train Loss: 0.683 Vali Loss: 2.247 Vali Acc: 0.480 Test Loss: 2.247 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.065563917160034
Epoch: 9, Steps: 20 | Train Loss: 0.530 Vali Loss: 1.705 Vali Acc: 0.500 Test Loss: 1.705 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.774003028869629
Epoch: 10, Steps: 20 | Train Loss: 0.718 Vali Loss: 1.810 Vali Acc: 0.580 Test Loss: 1.810 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7634332180023193
Epoch: 11, Steps: 20 | Train Loss: 0.789 Vali Loss: 2.844 Vali Acc: 0.490 Test Loss: 2.844 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8505408763885498
Epoch: 12, Steps: 20 | Train Loss: 0.821 Vali Loss: 1.856 Vali Acc: 0.520 Test Loss: 1.856 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.2958102226257324
Epoch: 13, Steps: 20 | Train Loss: 1.137 Vali Loss: 2.016 Vali Acc: 0.560 Test Loss: 2.016 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.780547857284546
Epoch: 14, Steps: 20 | Train Loss: 0.520 Vali Loss: 2.127 Vali Acc: 0.570 Test Loss: 2.127 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 1391618
model size : 5.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.138936758041382
Epoch: 1, Steps: 20 | Train Loss: 0.823 Vali Loss: 0.985 Vali Acc: 0.490 Test Loss: 0.985 Test Acc: 0.490
Validation loss decreased (inf --> -0.489990).  Saving model ...
Epoch: 2 cost time: 2.3015825748443604
Epoch: 2, Steps: 20 | Train Loss: 0.775 Vali Loss: 1.350 Vali Acc: 0.560 Test Loss: 1.350 Test Acc: 0.560
Validation loss decreased (-0.489990 --> -0.559987).  Saving model ...
Epoch: 3 cost time: 1.9126710891723633
Epoch: 3, Steps: 20 | Train Loss: 1.125 Vali Loss: 1.144 Vali Acc: 0.570 Test Loss: 1.144 Test Acc: 0.570
Validation loss decreased (-0.559987 --> -0.569989).  Saving model ...
Epoch: 4 cost time: 1.8737919330596924
Epoch: 4, Steps: 20 | Train Loss: 0.825 Vali Loss: 1.097 Vali Acc: 0.600 Test Loss: 1.097 Test Acc: 0.600
Validation loss decreased (-0.569989 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 1.815969705581665
Epoch: 5, Steps: 20 | Train Loss: 0.767 Vali Loss: 1.764 Vali Acc: 0.600 Test Loss: 1.764 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8165309429168701
Epoch: 6, Steps: 20 | Train Loss: 0.713 Vali Loss: 1.441 Vali Acc: 0.540 Test Loss: 1.441 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.233604669570923
Epoch: 7, Steps: 20 | Train Loss: 0.605 Vali Loss: 1.622 Vali Acc: 0.500 Test Loss: 1.622 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.028825521469116
Epoch: 8, Steps: 20 | Train Loss: 0.697 Vali Loss: 1.856 Vali Acc: 0.520 Test Loss: 1.856 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0748133659362793
Epoch: 9, Steps: 20 | Train Loss: 0.377 Vali Loss: 2.317 Vali Acc: 0.560 Test Loss: 2.317 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8637659549713135
Epoch: 10, Steps: 20 | Train Loss: 0.748 Vali Loss: 2.921 Vali Acc: 0.550 Test Loss: 2.921 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.1306958198547363
Epoch: 11, Steps: 20 | Train Loss: 0.947 Vali Loss: 2.172 Vali Acc: 0.610 Test Loss: 2.172 Test Acc: 0.610
Validation loss decreased (-0.599989 --> -0.609978).  Saving model ...
Epoch: 12 cost time: 2.229071617126465
Epoch: 12, Steps: 20 | Train Loss: 0.396 Vali Loss: 2.889 Vali Acc: 0.570 Test Loss: 2.889 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.171372175216675
Epoch: 13, Steps: 20 | Train Loss: 0.391 Vali Loss: 2.442 Vali Acc: 0.590 Test Loss: 2.442 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0550758838653564
Epoch: 14, Steps: 20 | Train Loss: 0.279 Vali Loss: 2.561 Vali Acc: 0.530 Test Loss: 2.561 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.138329267501831
Epoch: 15, Steps: 20 | Train Loss: 0.414 Vali Loss: 3.139 Vali Acc: 0.570 Test Loss: 3.139 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9132130146026611
Epoch: 16, Steps: 20 | Train Loss: 0.572 Vali Loss: 2.917 Vali Acc: 0.540 Test Loss: 2.917 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.945676565170288
Epoch: 17, Steps: 20 | Train Loss: 0.241 Vali Loss: 2.900 Vali Acc: 0.510 Test Loss: 2.900 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.021833896636963
Epoch: 18, Steps: 20 | Train Loss: 0.366 Vali Loss: 2.976 Vali Acc: 0.580 Test Loss: 2.976 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.898226022720337
Epoch: 19, Steps: 20 | Train Loss: 0.297 Vali Loss: 2.979 Vali Acc: 0.610 Test Loss: 2.979 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.1827094554901123
Epoch: 20, Steps: 20 | Train Loss: 0.492 Vali Loss: 5.431 Vali Acc: 0.490 Test Loss: 5.431 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9137294292449951
Epoch: 21, Steps: 20 | Train Loss: 0.263 Vali Loss: 2.720 Vali Acc: 0.580 Test Loss: 2.720 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1391746
model size : 5.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.181058406829834
Epoch: 1, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.802 Vali Acc: 0.480 Test Loss: 0.802 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 1.6996896266937256
Epoch: 2, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.749 Vali Acc: 0.620 Test Loss: 0.749 Test Acc: 0.620
Validation loss decreased (-0.479992 --> -0.619993).  Saving model ...
Epoch: 3 cost time: 1.9766767024993896
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 1.110 Vali Acc: 0.540 Test Loss: 1.110 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6902239322662354
Epoch: 4, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.913 Vali Acc: 0.620 Test Loss: 0.913 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9584341049194336
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 1.034 Vali Acc: 0.620 Test Loss: 1.034 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8369107246398926
Epoch: 6, Steps: 20 | Train Loss: 0.568 Vali Loss: 1.012 Vali Acc: 0.620 Test Loss: 1.012 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.609572172164917
Epoch: 7, Steps: 20 | Train Loss: 0.585 Vali Loss: 1.524 Vali Acc: 0.560 Test Loss: 1.524 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.264708995819092
Epoch: 8, Steps: 20 | Train Loss: 0.457 Vali Loss: 1.196 Vali Acc: 0.620 Test Loss: 1.196 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0164897441864014
Epoch: 9, Steps: 20 | Train Loss: 0.644 Vali Loss: 1.177 Vali Acc: 0.540 Test Loss: 1.177 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7383184432983398
Epoch: 10, Steps: 20 | Train Loss: 0.537 Vali Loss: 1.579 Vali Acc: 0.530 Test Loss: 1.579 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.007812738418579
Epoch: 11, Steps: 20 | Train Loss: 0.313 Vali Loss: 3.008 Vali Acc: 0.520 Test Loss: 3.008 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8518810272216797
Epoch: 12, Steps: 20 | Train Loss: 0.522 Vali Loss: 1.837 Vali Acc: 0.580 Test Loss: 1.837 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1327362
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.119803190231323
Epoch: 1, Steps: 20 | Train Loss: 0.791 Vali Loss: 0.791 Vali Acc: 0.520 Test Loss: 0.791 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 1.9622578620910645
Epoch: 2, Steps: 20 | Train Loss: 0.810 Vali Loss: 0.756 Vali Acc: 0.540 Test Loss: 0.756 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 1.677299976348877
Epoch: 3, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.778 Vali Acc: 0.540 Test Loss: 0.778 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6722054481506348
Epoch: 4, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.863 Vali Acc: 0.530 Test Loss: 0.863 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7272179126739502
Epoch: 5, Steps: 20 | Train Loss: 0.533 Vali Loss: 1.011 Vali Acc: 0.560 Test Loss: 1.011 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559990).  Saving model ...
Epoch: 6 cost time: 1.5988187789916992
Epoch: 6, Steps: 20 | Train Loss: 0.494 Vali Loss: 1.017 Vali Acc: 0.570 Test Loss: 1.017 Test Acc: 0.570
Validation loss decreased (-0.559990 --> -0.569990).  Saving model ...
Epoch: 7 cost time: 2.0763590335845947
Epoch: 7, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.935 Vali Acc: 0.530 Test Loss: 0.935 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7632298469543457
Epoch: 8, Steps: 20 | Train Loss: 0.436 Vali Loss: 1.324 Vali Acc: 0.570 Test Loss: 1.324 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6767446994781494
Epoch: 9, Steps: 20 | Train Loss: 0.410 Vali Loss: 1.059 Vali Acc: 0.590 Test Loss: 1.059 Test Acc: 0.590
Validation loss decreased (-0.569990 --> -0.589989).  Saving model ...
Epoch: 10 cost time: 1.5429553985595703
Epoch: 10, Steps: 20 | Train Loss: 0.305 Vali Loss: 1.213 Vali Acc: 0.520 Test Loss: 1.213 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.780627727508545
Epoch: 11, Steps: 20 | Train Loss: 0.286 Vali Loss: 1.082 Vali Acc: 0.570 Test Loss: 1.082 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8158023357391357
Epoch: 12, Steps: 20 | Train Loss: 0.390 Vali Loss: 1.339 Vali Acc: 0.620 Test Loss: 1.339 Test Acc: 0.620
Validation loss decreased (-0.589989 --> -0.619987).  Saving model ...
Epoch: 13 cost time: 1.7515017986297607
Epoch: 13, Steps: 20 | Train Loss: 0.293 Vali Loss: 1.292 Vali Acc: 0.580 Test Loss: 1.292 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7071943283081055
Epoch: 14, Steps: 20 | Train Loss: 0.219 Vali Loss: 2.051 Vali Acc: 0.540 Test Loss: 2.051 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.722844123840332
Epoch: 15, Steps: 20 | Train Loss: 0.262 Vali Loss: 1.230 Vali Acc: 0.610 Test Loss: 1.230 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6718988418579102
Epoch: 16, Steps: 20 | Train Loss: 0.197 Vali Loss: 1.814 Vali Acc: 0.520 Test Loss: 1.814 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5780420303344727
Epoch: 17, Steps: 20 | Train Loss: 0.328 Vali Loss: 2.070 Vali Acc: 0.510 Test Loss: 2.070 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4080097675323486
Epoch: 18, Steps: 20 | Train Loss: 0.094 Vali Loss: 2.015 Vali Acc: 0.540 Test Loss: 2.015 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.439955234527588
Epoch: 19, Steps: 20 | Train Loss: 0.070 Vali Loss: 1.680 Vali Acc: 0.530 Test Loss: 1.680 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5401091575622559
Epoch: 20, Steps: 20 | Train Loss: 0.092 Vali Loss: 2.029 Vali Acc: 0.560 Test Loss: 2.029 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7443976402282715
Epoch: 21, Steps: 20 | Train Loss: 0.096 Vali Loss: 2.091 Vali Acc: 0.560 Test Loss: 2.091 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.6200041770935059
Epoch: 22, Steps: 20 | Train Loss: 0.110 Vali Loss: 2.579 Vali Acc: 0.520 Test Loss: 2.579 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1299074
model size : 5.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6279635429382324
Epoch: 1, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.917 Vali Acc: 0.440 Test Loss: 0.917 Test Acc: 0.440
Validation loss decreased (inf --> -0.439991).  Saving model ...
Epoch: 2 cost time: 1.4724924564361572
Epoch: 2, Steps: 20 | Train Loss: 0.813 Vali Loss: 0.715 Vali Acc: 0.530 Test Loss: 0.715 Test Acc: 0.530
Validation loss decreased (-0.439991 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.4340450763702393
Epoch: 3, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.823 Vali Acc: 0.480 Test Loss: 0.823 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2310338020324707
Epoch: 4, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.864 Vali Acc: 0.530 Test Loss: 0.864 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7300236225128174
Epoch: 5, Steps: 20 | Train Loss: 0.650 Vali Loss: 1.476 Vali Acc: 0.570 Test Loss: 1.476 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569985).  Saving model ...
Epoch: 6 cost time: 1.4774653911590576
Epoch: 6, Steps: 20 | Train Loss: 0.500 Vali Loss: 1.072 Vali Acc: 0.540 Test Loss: 1.072 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7931489944458008
Epoch: 7, Steps: 20 | Train Loss: 0.505 Vali Loss: 1.128 Vali Acc: 0.560 Test Loss: 1.128 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4732820987701416
Epoch: 8, Steps: 20 | Train Loss: 0.406 Vali Loss: 1.063 Vali Acc: 0.570 Test Loss: 1.063 Test Acc: 0.570
Validation loss decreased (-0.569985 --> -0.569989).  Saving model ...
Epoch: 9 cost time: 1.6788251399993896
Epoch: 9, Steps: 20 | Train Loss: 0.472 Vali Loss: 1.499 Vali Acc: 0.490 Test Loss: 1.499 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8192167282104492
Epoch: 10, Steps: 20 | Train Loss: 0.483 Vali Loss: 1.040 Vali Acc: 0.550 Test Loss: 1.040 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7192161083221436
Epoch: 11, Steps: 20 | Train Loss: 0.329 Vali Loss: 1.124 Vali Acc: 0.600 Test Loss: 1.124 Test Acc: 0.600
Validation loss decreased (-0.569989 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 1.737475872039795
Epoch: 12, Steps: 20 | Train Loss: 0.238 Vali Loss: 1.284 Vali Acc: 0.580 Test Loss: 1.284 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.912950038909912
Epoch: 13, Steps: 20 | Train Loss: 0.192 Vali Loss: 1.276 Vali Acc: 0.580 Test Loss: 1.276 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8573741912841797
Epoch: 14, Steps: 20 | Train Loss: 0.259 Vali Loss: 1.239 Vali Acc: 0.550 Test Loss: 1.239 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7059605121612549
Epoch: 15, Steps: 20 | Train Loss: 0.194 Vali Loss: 1.231 Vali Acc: 0.550 Test Loss: 1.231 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.807361125946045
Epoch: 16, Steps: 20 | Train Loss: 0.191 Vali Loss: 1.659 Vali Acc: 0.540 Test Loss: 1.659 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9411358833312988
Epoch: 17, Steps: 20 | Train Loss: 0.130 Vali Loss: 1.319 Vali Acc: 0.590 Test Loss: 1.319 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6644365787506104
Epoch: 18, Steps: 20 | Train Loss: 0.102 Vali Loss: 1.296 Vali Acc: 0.580 Test Loss: 1.296 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.787074327468872
Epoch: 19, Steps: 20 | Train Loss: 0.139 Vali Loss: 1.631 Vali Acc: 0.570 Test Loss: 1.631 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5737273693084717
Epoch: 20, Steps: 20 | Train Loss: 0.057 Vali Loss: 1.813 Vali Acc: 0.520 Test Loss: 1.813 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8085196018218994
Epoch: 21, Steps: 20 | Train Loss: 0.066 Vali Loss: 1.625 Vali Acc: 0.550 Test Loss: 1.625 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1284994
model size : 4.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.616085529327393
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.679 Vali Acc: 0.560 Test Loss: 0.679 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 1.817781925201416
Epoch: 2, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.848 Vali Acc: 0.530 Test Loss: 0.848 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8408148288726807
Epoch: 3, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.714 Vali Acc: 0.550 Test Loss: 0.714 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6344547271728516
Epoch: 4, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.837 Vali Acc: 0.570 Test Loss: 0.837 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569992).  Saving model ...
Epoch: 5 cost time: 1.6197023391723633
Epoch: 5, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.777 Vali Acc: 0.560 Test Loss: 0.777 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7595486640930176
Epoch: 6, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.994 Vali Acc: 0.550 Test Loss: 0.994 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.682016134262085
Epoch: 7, Steps: 20 | Train Loss: 0.484 Vali Loss: 0.954 Vali Acc: 0.540 Test Loss: 0.954 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6957955360412598
Epoch: 8, Steps: 20 | Train Loss: 0.513 Vali Loss: 1.062 Vali Acc: 0.580 Test Loss: 1.062 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579989).  Saving model ...
Epoch: 9 cost time: 1.6819121837615967
Epoch: 9, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.846 Vali Acc: 0.560 Test Loss: 0.846 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7786877155303955
Epoch: 10, Steps: 20 | Train Loss: 0.379 Vali Loss: 1.012 Vali Acc: 0.580 Test Loss: 1.012 Test Acc: 0.580
Validation loss decreased (-0.579989 --> -0.579990).  Saving model ...
Epoch: 11 cost time: 1.4446709156036377
Epoch: 11, Steps: 20 | Train Loss: 0.334 Vali Loss: 0.890 Vali Acc: 0.550 Test Loss: 0.890 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9543981552124023
Epoch: 12, Steps: 20 | Train Loss: 0.266 Vali Loss: 1.143 Vali Acc: 0.530 Test Loss: 1.143 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7786946296691895
Epoch: 13, Steps: 20 | Train Loss: 0.259 Vali Loss: 1.022 Vali Acc: 0.540 Test Loss: 1.022 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1635632514953613
Epoch: 14, Steps: 20 | Train Loss: 0.212 Vali Loss: 1.141 Vali Acc: 0.480 Test Loss: 1.141 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4969465732574463
Epoch: 15, Steps: 20 | Train Loss: 0.167 Vali Loss: 1.280 Vali Acc: 0.560 Test Loss: 1.280 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7811222076416016
Epoch: 16, Steps: 20 | Train Loss: 0.244 Vali Loss: 1.525 Vali Acc: 0.500 Test Loss: 1.525 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.668680191040039
Epoch: 17, Steps: 20 | Train Loss: 0.183 Vali Loss: 1.184 Vali Acc: 0.620 Test Loss: 1.184 Test Acc: 0.620
Validation loss decreased (-0.579990 --> -0.619988).  Saving model ...
Epoch: 18 cost time: 1.9266846179962158
Epoch: 18, Steps: 20 | Train Loss: 0.134 Vali Loss: 1.364 Vali Acc: 0.540 Test Loss: 1.364 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7853758335113525
Epoch: 19, Steps: 20 | Train Loss: 0.119 Vali Loss: 1.486 Vali Acc: 0.510 Test Loss: 1.486 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7254865169525146
Epoch: 20, Steps: 20 | Train Loss: 0.084 Vali Loss: 1.296 Vali Acc: 0.620 Test Loss: 1.296 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4406843185424805
Epoch: 21, Steps: 20 | Train Loss: 0.049 Vali Loss: 1.632 Vali Acc: 0.550 Test Loss: 1.632 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5227477550506592
Epoch: 22, Steps: 20 | Train Loss: 0.114 Vali Loss: 1.770 Vali Acc: 0.510 Test Loss: 1.770 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8061854839324951
Epoch: 23, Steps: 20 | Train Loss: 0.066 Vali Loss: 1.565 Vali Acc: 0.520 Test Loss: 1.565 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6709017753601074
Epoch: 24, Steps: 20 | Train Loss: 0.061 Vali Loss: 1.743 Vali Acc: 0.510 Test Loss: 1.743 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.893873691558838
Epoch: 25, Steps: 20 | Train Loss: 0.047 Vali Loss: 1.797 Vali Acc: 0.570 Test Loss: 1.797 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8681495189666748
Epoch: 26, Steps: 20 | Train Loss: 0.023 Vali Loss: 1.638 Vali Acc: 0.590 Test Loss: 1.638 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.7121953964233398
Epoch: 27, Steps: 20 | Train Loss: 0.031 Vali Loss: 1.940 Vali Acc: 0.550 Test Loss: 1.940 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1263874
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.041596412658691
Epoch: 1, Steps: 20 | Train Loss: 0.869 Vali Loss: 0.822 Vali Acc: 0.550 Test Loss: 0.822 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 1.5750558376312256
Epoch: 2, Steps: 20 | Train Loss: 0.812 Vali Loss: 0.889 Vali Acc: 0.490 Test Loss: 0.889 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5508008003234863
Epoch: 3, Steps: 20 | Train Loss: 0.813 Vali Loss: 1.255 Vali Acc: 0.530 Test Loss: 1.255 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.389594554901123
Epoch: 4, Steps: 20 | Train Loss: 1.317 Vali Loss: 1.265 Vali Acc: 0.570 Test Loss: 1.265 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569987).  Saving model ...
Epoch: 5 cost time: 1.547776699066162
Epoch: 5, Steps: 20 | Train Loss: 0.840 Vali Loss: 1.590 Vali Acc: 0.520 Test Loss: 1.590 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6590750217437744
Epoch: 6, Steps: 20 | Train Loss: 0.659 Vali Loss: 1.540 Vali Acc: 0.500 Test Loss: 1.540 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4653966426849365
Epoch: 7, Steps: 20 | Train Loss: 0.818 Vali Loss: 2.283 Vali Acc: 0.590 Test Loss: 2.283 Test Acc: 0.590
Validation loss decreased (-0.569987 --> -0.589977).  Saving model ...
Epoch: 8 cost time: 1.2880148887634277
Epoch: 8, Steps: 20 | Train Loss: 0.885 Vali Loss: 1.793 Vali Acc: 0.560 Test Loss: 1.793 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7487497329711914
Epoch: 9, Steps: 20 | Train Loss: 0.704 Vali Loss: 2.007 Vali Acc: 0.520 Test Loss: 2.007 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.590001106262207
Epoch: 10, Steps: 20 | Train Loss: 0.582 Vali Loss: 1.671 Vali Acc: 0.590 Test Loss: 1.671 Test Acc: 0.590
Validation loss decreased (-0.589977 --> -0.589983).  Saving model ...
Epoch: 11 cost time: 1.5074670314788818
Epoch: 11, Steps: 20 | Train Loss: 0.737 Vali Loss: 1.745 Vali Acc: 0.600 Test Loss: 1.745 Test Acc: 0.600
Validation loss decreased (-0.589983 --> -0.599983).  Saving model ...
Epoch: 12 cost time: 1.3083021640777588
Epoch: 12, Steps: 20 | Train Loss: 0.956 Vali Loss: 1.860 Vali Acc: 0.550 Test Loss: 1.860 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5253491401672363
Epoch: 13, Steps: 20 | Train Loss: 0.601 Vali Loss: 3.080 Vali Acc: 0.540 Test Loss: 3.080 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4124610424041748
Epoch: 14, Steps: 20 | Train Loss: 0.755 Vali Loss: 2.570 Vali Acc: 0.570 Test Loss: 2.570 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.464343547821045
Epoch: 15, Steps: 20 | Train Loss: 0.684 Vali Loss: 2.435 Vali Acc: 0.560 Test Loss: 2.435 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6155579090118408
Epoch: 16, Steps: 20 | Train Loss: 0.305 Vali Loss: 2.169 Vali Acc: 0.580 Test Loss: 2.169 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1895520687103271
Epoch: 17, Steps: 20 | Train Loss: 0.429 Vali Loss: 2.574 Vali Acc: 0.570 Test Loss: 2.574 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.396697998046875
Epoch: 18, Steps: 20 | Train Loss: 0.334 Vali Loss: 2.949 Vali Acc: 0.480 Test Loss: 2.949 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5165932178497314
Epoch: 19, Steps: 20 | Train Loss: 0.380 Vali Loss: 2.834 Vali Acc: 0.620 Test Loss: 2.834 Test Acc: 0.620
Validation loss decreased (-0.599983 --> -0.619972).  Saving model ...
Epoch: 20 cost time: 1.4773623943328857
Epoch: 20, Steps: 20 | Train Loss: 0.336 Vali Loss: 2.721 Vali Acc: 0.560 Test Loss: 2.721 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4569666385650635
Epoch: 21, Steps: 20 | Train Loss: 0.362 Vali Loss: 4.834 Vali Acc: 0.550 Test Loss: 4.834 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5751023292541504
Epoch: 22, Steps: 20 | Train Loss: 0.673 Vali Loss: 3.037 Vali Acc: 0.600 Test Loss: 3.037 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7062184810638428
Epoch: 23, Steps: 20 | Train Loss: 0.586 Vali Loss: 2.776 Vali Acc: 0.600 Test Loss: 2.776 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5246272087097168
Epoch: 24, Steps: 20 | Train Loss: 0.316 Vali Loss: 2.833 Vali Acc: 0.600 Test Loss: 2.833 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.540515661239624
Epoch: 25, Steps: 20 | Train Loss: 0.149 Vali Loss: 2.969 Vali Acc: 0.540 Test Loss: 2.969 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3556077480316162
Epoch: 26, Steps: 20 | Train Loss: 0.187 Vali Loss: 3.076 Vali Acc: 0.580 Test Loss: 3.076 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0883874893188477
Epoch: 27, Steps: 20 | Train Loss: 0.136 Vali Loss: 2.901 Vali Acc: 0.570 Test Loss: 2.901 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5427625179290771
Epoch: 28, Steps: 20 | Train Loss: 0.200 Vali Loss: 3.359 Vali Acc: 0.620 Test Loss: 3.359 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.635559320449829
Epoch: 29, Steps: 20 | Train Loss: 0.126 Vali Loss: 3.468 Vali Acc: 0.570 Test Loss: 3.468 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 555970
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.712609052658081
Epoch: 1, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.717 Vali Acc: 0.560 Test Loss: 0.717 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 1.435258388519287
Epoch: 2, Steps: 20 | Train Loss: 0.806 Vali Loss: 0.997 Vali Acc: 0.560 Test Loss: 0.997 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.406282663345337
Epoch: 3, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.748 Vali Acc: 0.580 Test Loss: 0.748 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579993).  Saving model ...
Epoch: 4 cost time: 1.3451259136199951
Epoch: 4, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.888 Vali Acc: 0.520 Test Loss: 0.888 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.469081163406372
Epoch: 5, Steps: 20 | Train Loss: 0.556 Vali Loss: 1.055 Vali Acc: 0.550 Test Loss: 1.055 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6572558879852295
Epoch: 6, Steps: 20 | Train Loss: 0.664 Vali Loss: 1.198 Vali Acc: 0.500 Test Loss: 1.198 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4327728748321533
Epoch: 7, Steps: 20 | Train Loss: 0.561 Vali Loss: 1.143 Vali Acc: 0.520 Test Loss: 1.143 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4235210418701172
Epoch: 8, Steps: 20 | Train Loss: 0.553 Vali Loss: 1.108 Vali Acc: 0.570 Test Loss: 1.108 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.42279052734375
Epoch: 9, Steps: 20 | Train Loss: 0.480 Vali Loss: 1.156 Vali Acc: 0.560 Test Loss: 1.156 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7821531295776367
Epoch: 10, Steps: 20 | Train Loss: 0.469 Vali Loss: 1.127 Vali Acc: 0.580 Test Loss: 1.127 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5386359691619873
Epoch: 11, Steps: 20 | Train Loss: 0.371 Vali Loss: 1.099 Vali Acc: 0.610 Test Loss: 1.099 Test Acc: 0.610
Validation loss decreased (-0.579993 --> -0.609989).  Saving model ...
Epoch: 12 cost time: 1.5095365047454834
Epoch: 12, Steps: 20 | Train Loss: 0.342 Vali Loss: 1.277 Vali Acc: 0.570 Test Loss: 1.277 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3318970203399658
Epoch: 13, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.327 Vali Acc: 0.550 Test Loss: 1.327 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.298898696899414
Epoch: 14, Steps: 20 | Train Loss: 0.227 Vali Loss: 1.973 Vali Acc: 0.540 Test Loss: 1.973 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.197399377822876
Epoch: 15, Steps: 20 | Train Loss: 0.246 Vali Loss: 1.445 Vali Acc: 0.670 Test Loss: 1.445 Test Acc: 0.670
Validation loss decreased (-0.609989 --> -0.669986).  Saving model ...
Epoch: 16 cost time: 1.3656702041625977
Epoch: 16, Steps: 20 | Train Loss: 0.246 Vali Loss: 1.537 Vali Acc: 0.620 Test Loss: 1.537 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4172024726867676
Epoch: 17, Steps: 20 | Train Loss: 0.171 Vali Loss: 1.865 Vali Acc: 0.550 Test Loss: 1.865 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4456391334533691
Epoch: 18, Steps: 20 | Train Loss: 0.168 Vali Loss: 1.680 Vali Acc: 0.590 Test Loss: 1.680 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3416650295257568
Epoch: 19, Steps: 20 | Train Loss: 0.237 Vali Loss: 2.096 Vali Acc: 0.540 Test Loss: 2.096 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2901177406311035
Epoch: 20, Steps: 20 | Train Loss: 0.132 Vali Loss: 1.614 Vali Acc: 0.610 Test Loss: 1.614 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.09684157371521
Epoch: 21, Steps: 20 | Train Loss: 0.180 Vali Loss: 2.248 Vali Acc: 0.580 Test Loss: 2.248 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3987762928009033
Epoch: 22, Steps: 20 | Train Loss: 0.200 Vali Loss: 2.056 Vali Acc: 0.600 Test Loss: 2.056 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.6922733783721924
Epoch: 23, Steps: 20 | Train Loss: 0.153 Vali Loss: 2.503 Vali Acc: 0.530 Test Loss: 2.503 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3993797302246094
Epoch: 24, Steps: 20 | Train Loss: 0.134 Vali Loss: 1.960 Vali Acc: 0.570 Test Loss: 1.960 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.608241081237793
Epoch: 25, Steps: 20 | Train Loss: 0.349 Vali Loss: 3.048 Vali Acc: 0.490 Test Loss: 3.048 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.67
model parameter : 466434
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3542871475219727
Epoch: 1, Steps: 20 | Train Loss: 0.808 Vali Loss: 0.789 Vali Acc: 0.460 Test Loss: 0.789 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 1.3900611400604248
Epoch: 2, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.774 Vali Acc: 0.650 Test Loss: 0.774 Test Acc: 0.650
Validation loss decreased (-0.459992 --> -0.649992).  Saving model ...
Epoch: 3 cost time: 1.2663273811340332
Epoch: 3, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.763 Vali Acc: 0.560 Test Loss: 0.763 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1783661842346191
Epoch: 4, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.909 Vali Acc: 0.540 Test Loss: 0.909 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3036580085754395
Epoch: 5, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.850 Vali Acc: 0.590 Test Loss: 0.850 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5285637378692627
Epoch: 6, Steps: 20 | Train Loss: 0.436 Vali Loss: 1.125 Vali Acc: 0.540 Test Loss: 1.125 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3436346054077148
Epoch: 7, Steps: 20 | Train Loss: 0.523 Vali Loss: 1.346 Vali Acc: 0.530 Test Loss: 1.346 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3018429279327393
Epoch: 8, Steps: 20 | Train Loss: 0.474 Vali Loss: 1.058 Vali Acc: 0.540 Test Loss: 1.058 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1411700248718262
Epoch: 9, Steps: 20 | Train Loss: 0.407 Vali Loss: 1.379 Vali Acc: 0.540 Test Loss: 1.379 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2234928607940674
Epoch: 10, Steps: 20 | Train Loss: 0.284 Vali Loss: 1.276 Vali Acc: 0.520 Test Loss: 1.276 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2575690746307373
Epoch: 11, Steps: 20 | Train Loss: 0.348 Vali Loss: 1.403 Vali Acc: 0.600 Test Loss: 1.403 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.520237922668457
Epoch: 12, Steps: 20 | Train Loss: 0.325 Vali Loss: 1.269 Vali Acc: 0.580 Test Loss: 1.269 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 466498
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.945676565170288
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.269982099533081
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.907 Vali Acc: 0.500 Test Loss: 0.907 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4056079387664795
Epoch: 3, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.790 Vali Acc: 0.560 Test Loss: 0.790 Test Acc: 0.560
Validation loss decreased (-0.499993 --> -0.559992).  Saving model ...
Epoch: 4 cost time: 1.2151665687561035
Epoch: 4, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.807 Vali Acc: 0.580 Test Loss: 0.807 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579992).  Saving model ...
Epoch: 5 cost time: 1.1814217567443848
Epoch: 5, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.915 Vali Acc: 0.560 Test Loss: 0.915 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3465585708618164
Epoch: 6, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.761 Vali Acc: 0.630 Test Loss: 0.761 Test Acc: 0.630
Validation loss decreased (-0.579992 --> -0.629992).  Saving model ...
Epoch: 7 cost time: 1.3982558250427246
Epoch: 7, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.814 Vali Acc: 0.610 Test Loss: 0.814 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.320225477218628
Epoch: 8, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.869 Vali Acc: 0.560 Test Loss: 0.869 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.255263328552246
Epoch: 9, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.985 Vali Acc: 0.520 Test Loss: 0.985 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3766241073608398
Epoch: 10, Steps: 20 | Train Loss: 0.461 Vali Loss: 1.610 Vali Acc: 0.540 Test Loss: 1.610 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2776410579681396
Epoch: 11, Steps: 20 | Train Loss: 0.487 Vali Loss: 1.038 Vali Acc: 0.580 Test Loss: 1.038 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.243901014328003
Epoch: 12, Steps: 20 | Train Loss: 0.274 Vali Loss: 1.392 Vali Acc: 0.550 Test Loss: 1.392 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2416200637817383
Epoch: 13, Steps: 20 | Train Loss: 0.350 Vali Loss: 0.978 Vali Acc: 0.600 Test Loss: 0.978 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5160362720489502
Epoch: 14, Steps: 20 | Train Loss: 0.298 Vali Loss: 1.682 Vali Acc: 0.530 Test Loss: 1.682 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3426713943481445
Epoch: 15, Steps: 20 | Train Loss: 0.382 Vali Loss: 1.308 Vali Acc: 0.560 Test Loss: 1.308 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.474623680114746
Epoch: 16, Steps: 20 | Train Loss: 0.259 Vali Loss: 1.398 Vali Acc: 0.570 Test Loss: 1.398 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 434306
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2688801288604736
Epoch: 1, Steps: 20 | Train Loss: 0.777 Vali Loss: 0.694 Vali Acc: 0.550 Test Loss: 0.694 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.3927929401397705
Epoch: 2, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.878 Vali Acc: 0.470 Test Loss: 0.878 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4751737117767334
Epoch: 3, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.895 Vali Acc: 0.510 Test Loss: 0.895 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5411183834075928
Epoch: 4, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.924 Vali Acc: 0.520 Test Loss: 0.924 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3347101211547852
Epoch: 5, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.871 Vali Acc: 0.530 Test Loss: 0.871 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4598584175109863
Epoch: 6, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.743 Vali Acc: 0.600 Test Loss: 0.743 Test Acc: 0.600
Validation loss decreased (-0.549993 --> -0.599993).  Saving model ...
Epoch: 7 cost time: 1.4085278511047363
Epoch: 7, Steps: 20 | Train Loss: 0.568 Vali Loss: 1.056 Vali Acc: 0.590 Test Loss: 1.056 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4015190601348877
Epoch: 8, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.924 Vali Acc: 0.580 Test Loss: 0.924 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4754407405853271
Epoch: 9, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.938 Vali Acc: 0.510 Test Loss: 0.938 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4158656597137451
Epoch: 10, Steps: 20 | Train Loss: 0.394 Vali Loss: 0.764 Vali Acc: 0.560 Test Loss: 0.764 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5339398384094238
Epoch: 11, Steps: 20 | Train Loss: 0.318 Vali Loss: 0.851 Vali Acc: 0.580 Test Loss: 0.851 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1334779262542725
Epoch: 12, Steps: 20 | Train Loss: 0.342 Vali Loss: 1.357 Vali Acc: 0.630 Test Loss: 1.357 Test Acc: 0.630
Validation loss decreased (-0.599993 --> -0.629986).  Saving model ...
Epoch: 13 cost time: 1.4243690967559814
Epoch: 13, Steps: 20 | Train Loss: 0.576 Vali Loss: 1.027 Vali Acc: 0.570 Test Loss: 1.027 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.225146770477295
Epoch: 14, Steps: 20 | Train Loss: 0.373 Vali Loss: 1.244 Vali Acc: 0.510 Test Loss: 1.244 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4586389064788818
Epoch: 15, Steps: 20 | Train Loss: 0.234 Vali Loss: 1.086 Vali Acc: 0.580 Test Loss: 1.086 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4041330814361572
Epoch: 16, Steps: 20 | Train Loss: 0.215 Vali Loss: 1.121 Vali Acc: 0.540 Test Loss: 1.121 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3240902423858643
Epoch: 17, Steps: 20 | Train Loss: 0.167 Vali Loss: 1.394 Vali Acc: 0.540 Test Loss: 1.394 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3639755249023438
Epoch: 18, Steps: 20 | Train Loss: 0.249 Vali Loss: 1.340 Vali Acc: 0.530 Test Loss: 1.340 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3152101039886475
Epoch: 19, Steps: 20 | Train Loss: 0.154 Vali Loss: 1.153 Vali Acc: 0.560 Test Loss: 1.153 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2717576026916504
Epoch: 20, Steps: 20 | Train Loss: 0.094 Vali Loss: 1.450 Vali Acc: 0.550 Test Loss: 1.450 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3715240955352783
Epoch: 21, Steps: 20 | Train Loss: 0.111 Vali Loss: 1.493 Vali Acc: 0.530 Test Loss: 1.493 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3685791492462158
Epoch: 22, Steps: 20 | Train Loss: 0.083 Vali Loss: 1.392 Vali Acc: 0.550 Test Loss: 1.392 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 420162
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0554580688476562
Epoch: 1, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.712 Vali Acc: 0.530 Test Loss: 0.712 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.1401081085205078
Epoch: 2, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.766 Vali Acc: 0.500 Test Loss: 0.766 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2508785724639893
Epoch: 3, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.718 Vali Acc: 0.560 Test Loss: 0.718 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 1.0982909202575684
Epoch: 4, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.759 Vali Acc: 0.520 Test Loss: 0.759 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8837060928344727
Epoch: 5, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.734 Vali Acc: 0.590 Test Loss: 0.734 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 6 cost time: 1.0157814025878906
Epoch: 6, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.703 Vali Acc: 0.630 Test Loss: 0.703 Test Acc: 0.630
Validation loss decreased (-0.589993 --> -0.629993).  Saving model ...
Epoch: 7 cost time: 1.0476155281066895
Epoch: 7, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.881 Vali Acc: 0.560 Test Loss: 0.881 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2118680477142334
Epoch: 8, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.781 Vali Acc: 0.610 Test Loss: 0.781 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1837306022644043
Epoch: 9, Steps: 20 | Train Loss: 0.399 Vali Loss: 0.865 Vali Acc: 0.520 Test Loss: 0.865 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2550060749053955
Epoch: 10, Steps: 20 | Train Loss: 0.376 Vali Loss: 0.895 Vali Acc: 0.590 Test Loss: 0.895 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.502227783203125
Epoch: 11, Steps: 20 | Train Loss: 0.345 Vali Loss: 0.978 Vali Acc: 0.540 Test Loss: 0.978 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7212300300598145
Epoch: 12, Steps: 20 | Train Loss: 0.348 Vali Loss: 0.885 Vali Acc: 0.620 Test Loss: 0.885 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5725500583648682
Epoch: 13, Steps: 20 | Train Loss: 0.295 Vali Loss: 1.152 Vali Acc: 0.560 Test Loss: 1.152 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.466688871383667
Epoch: 14, Steps: 20 | Train Loss: 0.261 Vali Loss: 1.050 Vali Acc: 0.570 Test Loss: 1.050 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7385034561157227
Epoch: 15, Steps: 20 | Train Loss: 0.269 Vali Loss: 1.068 Vali Acc: 0.570 Test Loss: 1.068 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3543486595153809
Epoch: 16, Steps: 20 | Train Loss: 0.233 Vali Loss: 1.352 Vali Acc: 0.550 Test Loss: 1.352 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 413122
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5922813415527344
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.722 Vali Acc: 0.440 Test Loss: 0.722 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 1.391676425933838
Epoch: 2, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.811 Vali Acc: 0.470 Test Loss: 0.811 Test Acc: 0.470
Validation loss decreased (-0.439993 --> -0.469992).  Saving model ...
Epoch: 3 cost time: 1.3636434078216553
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
Validation loss decreased (-0.469992 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 1.4639465808868408
Epoch: 4, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 5 cost time: 1.3795249462127686
Epoch: 5, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.847 Vali Acc: 0.480 Test Loss: 0.847 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2900416851043701
Epoch: 6, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.784 Vali Acc: 0.540 Test Loss: 0.784 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539992).  Saving model ...
Epoch: 7 cost time: 1.6367015838623047
Epoch: 7, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.981 Vali Acc: 0.470 Test Loss: 0.981 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3552439212799072
Epoch: 8, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.866 Vali Acc: 0.530 Test Loss: 0.866 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2552731037139893
Epoch: 9, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.792 Vali Acc: 0.560 Test Loss: 0.792 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559992).  Saving model ...
Epoch: 10 cost time: 1.4209554195404053
Epoch: 10, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.811 Vali Acc: 0.600 Test Loss: 0.811 Test Acc: 0.600
Validation loss decreased (-0.559992 --> -0.599992).  Saving model ...
Epoch: 11 cost time: 1.0945775508880615
Epoch: 11, Steps: 20 | Train Loss: 0.452 Vali Loss: 0.833 Vali Acc: 0.560 Test Loss: 0.833 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.224374771118164
Epoch: 12, Steps: 20 | Train Loss: 0.375 Vali Loss: 0.882 Vali Acc: 0.520 Test Loss: 0.882 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.049919843673706
Epoch: 13, Steps: 20 | Train Loss: 0.316 Vali Loss: 0.904 Vali Acc: 0.510 Test Loss: 0.904 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0626821517944336
Epoch: 14, Steps: 20 | Train Loss: 0.323 Vali Loss: 1.049 Vali Acc: 0.580 Test Loss: 1.049 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2197411060333252
Epoch: 15, Steps: 20 | Train Loss: 0.269 Vali Loss: 0.909 Vali Acc: 0.550 Test Loss: 0.909 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0915286540985107
Epoch: 16, Steps: 20 | Train Loss: 0.255 Vali Loss: 1.010 Vali Acc: 0.510 Test Loss: 1.010 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.174722671508789
Epoch: 17, Steps: 20 | Train Loss: 0.257 Vali Loss: 1.104 Vali Acc: 0.580 Test Loss: 1.104 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1955201625823975
Epoch: 18, Steps: 20 | Train Loss: 0.221 Vali Loss: 1.000 Vali Acc: 0.610 Test Loss: 1.000 Test Acc: 0.610
Validation loss decreased (-0.599992 --> -0.609990).  Saving model ...
Epoch: 19 cost time: 1.2307941913604736
Epoch: 19, Steps: 20 | Train Loss: 0.194 Vali Loss: 1.053 Vali Acc: 0.570 Test Loss: 1.053 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3781943321228027
Epoch: 20, Steps: 20 | Train Loss: 0.180 Vali Loss: 1.246 Vali Acc: 0.570 Test Loss: 1.246 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.295189380645752
Epoch: 21, Steps: 20 | Train Loss: 0.151 Vali Loss: 1.084 Vali Acc: 0.580 Test Loss: 1.084 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5680885314941406
Epoch: 22, Steps: 20 | Train Loss: 0.170 Vali Loss: 1.274 Vali Acc: 0.560 Test Loss: 1.274 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4052777290344238
Epoch: 23, Steps: 20 | Train Loss: 0.102 Vali Loss: 1.168 Vali Acc: 0.530 Test Loss: 1.168 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5980865955352783
Epoch: 24, Steps: 20 | Train Loss: 0.099 Vali Loss: 1.198 Vali Acc: 0.570 Test Loss: 1.198 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4139161109924316
Epoch: 25, Steps: 20 | Train Loss: 0.086 Vali Loss: 1.250 Vali Acc: 0.590 Test Loss: 1.250 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.351808786392212
Epoch: 26, Steps: 20 | Train Loss: 0.064 Vali Loss: 1.251 Vali Acc: 0.560 Test Loss: 1.251 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3806085586547852
Epoch: 27, Steps: 20 | Train Loss: 0.057 Vali Loss: 1.468 Vali Acc: 0.520 Test Loss: 1.468 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2658255100250244
Epoch: 28, Steps: 20 | Train Loss: 0.062 Vali Loss: 1.375 Vali Acc: 0.560 Test Loss: 1.375 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 402562
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0423619747161865
Epoch: 1, Steps: 20 | Train Loss: 0.754 Vali Loss: 0.886 Vali Acc: 0.470 Test Loss: 0.886 Test Acc: 0.470
Validation loss decreased (inf --> -0.469991).  Saving model ...
Epoch: 2 cost time: 1.2536141872406006
Epoch: 2, Steps: 20 | Train Loss: 0.776 Vali Loss: 0.852 Vali Acc: 0.520 Test Loss: 0.852 Test Acc: 0.520
Validation loss decreased (-0.469991 --> -0.519991).  Saving model ...
Epoch: 3 cost time: 0.9846043586730957
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.932 Vali Acc: 0.540 Test Loss: 0.932 Test Acc: 0.540
Validation loss decreased (-0.519991 --> -0.539991).  Saving model ...
Epoch: 4 cost time: 1.2754380702972412
Epoch: 4, Steps: 20 | Train Loss: 0.654 Vali Loss: 1.020 Vali Acc: 0.550 Test Loss: 1.020 Test Acc: 0.550
Validation loss decreased (-0.539991 --> -0.549990).  Saving model ...
Epoch: 5 cost time: 1.2593567371368408
Epoch: 5, Steps: 20 | Train Loss: 0.726 Vali Loss: 1.062 Vali Acc: 0.550 Test Loss: 1.062 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2320103645324707
Epoch: 6, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.860 Vali Acc: 0.560 Test Loss: 0.860 Test Acc: 0.560
Validation loss decreased (-0.549990 --> -0.559991).  Saving model ...
Epoch: 7 cost time: 1.1747639179229736
Epoch: 7, Steps: 20 | Train Loss: 0.598 Vali Loss: 1.132 Vali Acc: 0.510 Test Loss: 1.132 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1051056385040283
Epoch: 8, Steps: 20 | Train Loss: 0.700 Vali Loss: 1.357 Vali Acc: 0.510 Test Loss: 1.357 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1492984294891357
Epoch: 9, Steps: 20 | Train Loss: 0.534 Vali Loss: 2.318 Vali Acc: 0.520 Test Loss: 2.318 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0771665573120117
Epoch: 10, Steps: 20 | Train Loss: 0.884 Vali Loss: 0.981 Vali Acc: 0.610 Test Loss: 0.981 Test Acc: 0.610
Validation loss decreased (-0.559991 --> -0.609990).  Saving model ...
Epoch: 11 cost time: 1.2386891841888428
Epoch: 11, Steps: 20 | Train Loss: 0.507 Vali Loss: 1.042 Vali Acc: 0.570 Test Loss: 1.042 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.46455717086792
Epoch: 12, Steps: 20 | Train Loss: 0.600 Vali Loss: 1.178 Vali Acc: 0.590 Test Loss: 1.178 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3406093120574951
Epoch: 13, Steps: 20 | Train Loss: 0.420 Vali Loss: 1.239 Vali Acc: 0.580 Test Loss: 1.239 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0691027641296387
Epoch: 14, Steps: 20 | Train Loss: 0.465 Vali Loss: 1.363 Vali Acc: 0.520 Test Loss: 1.363 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1506836414337158
Epoch: 15, Steps: 20 | Train Loss: 0.632 Vali Loss: 1.956 Vali Acc: 0.470 Test Loss: 1.956 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0120155811309814
Epoch: 16, Steps: 20 | Train Loss: 0.539 Vali Loss: 1.921 Vali Acc: 0.550 Test Loss: 1.921 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1601707935333252
Epoch: 17, Steps: 20 | Train Loss: 0.526 Vali Loss: 1.287 Vali Acc: 0.600 Test Loss: 1.287 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1305654048919678
Epoch: 18, Steps: 20 | Train Loss: 0.508 Vali Loss: 1.470 Vali Acc: 0.600 Test Loss: 1.470 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0135838985443115
Epoch: 19, Steps: 20 | Train Loss: 0.227 Vali Loss: 1.705 Vali Acc: 0.560 Test Loss: 1.705 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0951237678527832
Epoch: 20, Steps: 20 | Train Loss: 0.244 Vali Loss: 1.353 Vali Acc: 0.640 Test Loss: 1.353 Test Acc: 0.640
Validation loss decreased (-0.609990 --> -0.639986).  Saving model ...
Epoch: 21 cost time: 0.892388105392456
Epoch: 21, Steps: 20 | Train Loss: 0.232 Vali Loss: 2.113 Vali Acc: 0.540 Test Loss: 2.113 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9614584445953369
Epoch: 22, Steps: 20 | Train Loss: 0.524 Vali Loss: 1.509 Vali Acc: 0.600 Test Loss: 1.509 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2506892681121826
Epoch: 23, Steps: 20 | Train Loss: 0.413 Vali Loss: 2.223 Vali Acc: 0.540 Test Loss: 2.223 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2162857055664062
Epoch: 24, Steps: 20 | Train Loss: 0.578 Vali Loss: 1.804 Vali Acc: 0.590 Test Loss: 1.804 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3151752948760986
Epoch: 25, Steps: 20 | Train Loss: 0.243 Vali Loss: 2.020 Vali Acc: 0.600 Test Loss: 2.020 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.286195993423462
Epoch: 26, Steps: 20 | Train Loss: 0.156 Vali Loss: 1.812 Vali Acc: 0.580 Test Loss: 1.812 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2063722610473633
Epoch: 27, Steps: 20 | Train Loss: 0.151 Vali Loss: 1.801 Vali Acc: 0.550 Test Loss: 1.801 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2487220764160156
Epoch: 28, Steps: 20 | Train Loss: 0.175 Vali Loss: 2.070 Vali Acc: 0.540 Test Loss: 2.070 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9726428985595703
Epoch: 29, Steps: 20 | Train Loss: 0.274 Vali Loss: 2.563 Vali Acc: 0.600 Test Loss: 2.563 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0592854022979736
Epoch: 30, Steps: 20 | Train Loss: 0.207 Vali Loss: 2.106 Vali Acc: 0.560 Test Loss: 2.106 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 220642
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.9523935317993164
Epoch: 1, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.753 Vali Acc: 0.440 Test Loss: 0.753 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 1.6619083881378174
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.717 Vali Acc: 0.580 Test Loss: 0.717 Test Acc: 0.580
Validation loss decreased (-0.439992 --> -0.579993).  Saving model ...
Epoch: 3 cost time: 1.8354361057281494
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.786 Vali Acc: 0.570 Test Loss: 0.786 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6018407344818115
Epoch: 4, Steps: 20 | Train Loss: 0.614 Vali Loss: 1.008 Vali Acc: 0.520 Test Loss: 1.008 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.542564868927002
Epoch: 5, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.852 Vali Acc: 0.530 Test Loss: 0.852 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6722357273101807
Epoch: 6, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.731 Vali Acc: 0.610 Test Loss: 0.731 Test Acc: 0.610
Validation loss decreased (-0.579993 --> -0.609993).  Saving model ...
Epoch: 7 cost time: 1.459594964981079
Epoch: 7, Steps: 20 | Train Loss: 0.485 Vali Loss: 0.921 Vali Acc: 0.550 Test Loss: 0.921 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3323349952697754
Epoch: 8, Steps: 20 | Train Loss: 0.449 Vali Loss: 1.024 Vali Acc: 0.580 Test Loss: 1.024 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4296813011169434
Epoch: 9, Steps: 20 | Train Loss: 0.447 Vali Loss: 1.123 Vali Acc: 0.530 Test Loss: 1.123 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3750636577606201
Epoch: 10, Steps: 20 | Train Loss: 0.382 Vali Loss: 0.858 Vali Acc: 0.580 Test Loss: 0.858 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7730295658111572
Epoch: 11, Steps: 20 | Train Loss: 0.442 Vali Loss: 1.375 Vali Acc: 0.520 Test Loss: 1.375 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.917534351348877
Epoch: 12, Steps: 20 | Train Loss: 0.327 Vali Loss: 1.349 Vali Acc: 0.520 Test Loss: 1.349 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7222576141357422
Epoch: 13, Steps: 20 | Train Loss: 0.334 Vali Loss: 1.191 Vali Acc: 0.550 Test Loss: 1.191 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.916334867477417
Epoch: 14, Steps: 20 | Train Loss: 0.346 Vali Loss: 1.173 Vali Acc: 0.520 Test Loss: 1.173 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6938583850860596
Epoch: 15, Steps: 20 | Train Loss: 0.269 Vali Loss: 1.342 Vali Acc: 0.540 Test Loss: 1.342 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.0466103553771973
Epoch: 16, Steps: 20 | Train Loss: 0.359 Vali Loss: 1.139 Vali Acc: 0.600 Test Loss: 1.139 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 175874
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.897479295730591
Epoch: 1, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.741 Vali Acc: 0.520 Test Loss: 0.741 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.6157684326171875
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.693 Vali Acc: 0.620 Test Loss: 0.693 Test Acc: 0.620
Validation loss decreased (-0.519993 --> -0.619993).  Saving model ...
Epoch: 3 cost time: 1.7450103759765625
Epoch: 3, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.809 Vali Acc: 0.530 Test Loss: 0.809 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2417340278625488
Epoch: 4, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.869 Vali Acc: 0.550 Test Loss: 0.869 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6219813823699951
Epoch: 5, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.825 Vali Acc: 0.540 Test Loss: 0.825 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5171561241149902
Epoch: 6, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.776 Vali Acc: 0.590 Test Loss: 0.776 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4558837413787842
Epoch: 7, Steps: 20 | Train Loss: 0.581 Vali Loss: 1.206 Vali Acc: 0.510 Test Loss: 1.206 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.743065357208252
Epoch: 8, Steps: 20 | Train Loss: 0.415 Vali Loss: 1.013 Vali Acc: 0.510 Test Loss: 1.013 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6642482280731201
Epoch: 9, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.979 Vali Acc: 0.560 Test Loss: 0.979 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.996628761291504
Epoch: 10, Steps: 20 | Train Loss: 0.489 Vali Loss: 1.058 Vali Acc: 0.550 Test Loss: 1.058 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2583751678466797
Epoch: 11, Steps: 20 | Train Loss: 0.397 Vali Loss: 1.083 Vali Acc: 0.550 Test Loss: 1.083 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5668158531188965
Epoch: 12, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.280 Vali Acc: 0.530 Test Loss: 1.280 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 175906
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8018293380737305
Epoch: 1, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.751 Vali Acc: 0.510 Test Loss: 0.751 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 1.4355106353759766
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.719 Vali Acc: 0.520 Test Loss: 0.719 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.6795737743377686
Epoch: 3, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.694 Vali Acc: 0.540 Test Loss: 0.694 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 1.6110806465148926
Epoch: 4, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.758 Vali Acc: 0.640 Test Loss: 0.758 Test Acc: 0.640
Validation loss decreased (-0.539993 --> -0.639992).  Saving model ...
Epoch: 5 cost time: 1.5900347232818604
Epoch: 5, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.777 Vali Acc: 0.630 Test Loss: 0.777 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3297336101531982
Epoch: 6, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.800 Vali Acc: 0.580 Test Loss: 0.800 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3582139015197754
Epoch: 7, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.772 Vali Acc: 0.620 Test Loss: 0.772 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4433295726776123
Epoch: 8, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.758 Vali Acc: 0.580 Test Loss: 0.758 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5294549465179443
Epoch: 9, Steps: 20 | Train Loss: 0.451 Vali Loss: 1.115 Vali Acc: 0.570 Test Loss: 1.115 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5624995231628418
Epoch: 10, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.815 Vali Acc: 0.590 Test Loss: 0.815 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5175964832305908
Epoch: 11, Steps: 20 | Train Loss: 0.383 Vali Loss: 0.951 Vali Acc: 0.550 Test Loss: 0.951 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6014690399169922
Epoch: 12, Steps: 20 | Train Loss: 0.368 Vali Loss: 0.894 Vali Acc: 0.630 Test Loss: 0.894 Test Acc: 0.630
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3668296337127686
Epoch: 13, Steps: 20 | Train Loss: 0.375 Vali Loss: 0.925 Vali Acc: 0.610 Test Loss: 0.925 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.764237403869629
Epoch: 14, Steps: 20 | Train Loss: 0.350 Vali Loss: 0.862 Vali Acc: 0.630 Test Loss: 0.862 Test Acc: 0.630
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 159810
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.228885889053345
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.711 Vali Acc: 0.540 Test Loss: 0.711 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.384800672531128
Epoch: 2, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.731 Vali Acc: 0.510 Test Loss: 0.731 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2860915660858154
Epoch: 3, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.739 Vali Acc: 0.520 Test Loss: 0.739 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6526007652282715
Epoch: 4, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.878 Vali Acc: 0.480 Test Loss: 0.878 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3183882236480713
Epoch: 5, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.781 Vali Acc: 0.480 Test Loss: 0.781 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.551391839981079
Epoch: 6, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.817 Vali Acc: 0.510 Test Loss: 0.817 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3504445552825928
Epoch: 7, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.809 Vali Acc: 0.560 Test Loss: 0.809 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559992).  Saving model ...
Epoch: 8 cost time: 1.3627257347106934
Epoch: 8, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.833 Vali Acc: 0.510 Test Loss: 0.833 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5128979682922363
Epoch: 9, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.803 Vali Acc: 0.560 Test Loss: 0.803 Test Acc: 0.560
Validation loss decreased (-0.559992 --> -0.559992).  Saving model ...
Epoch: 10 cost time: 1.6165401935577393
Epoch: 10, Steps: 20 | Train Loss: 0.447 Vali Loss: 0.779 Vali Acc: 0.540 Test Loss: 0.779 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8044228553771973
Epoch: 11, Steps: 20 | Train Loss: 0.426 Vali Loss: 0.919 Vali Acc: 0.530 Test Loss: 0.919 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7539703845977783
Epoch: 12, Steps: 20 | Train Loss: 0.380 Vali Loss: 0.839 Vali Acc: 0.540 Test Loss: 0.839 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8031001091003418
Epoch: 13, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.762 Vali Acc: 0.560 Test Loss: 0.762 Test Acc: 0.560
Validation loss decreased (-0.559992 --> -0.559992).  Saving model ...
Epoch: 14 cost time: 1.8760795593261719
Epoch: 14, Steps: 20 | Train Loss: 0.354 Vali Loss: 0.916 Vali Acc: 0.500 Test Loss: 0.916 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6783180236816406
Epoch: 15, Steps: 20 | Train Loss: 0.315 Vali Loss: 0.795 Vali Acc: 0.580 Test Loss: 0.795 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579992).  Saving model ...
Epoch: 16 cost time: 1.8393831253051758
Epoch: 16, Steps: 20 | Train Loss: 0.289 Vali Loss: 0.964 Vali Acc: 0.520 Test Loss: 0.964 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.674025535583496
Epoch: 17, Steps: 20 | Train Loss: 0.316 Vali Loss: 0.911 Vali Acc: 0.530 Test Loss: 0.911 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8701438903808594
Epoch: 18, Steps: 20 | Train Loss: 0.265 Vali Loss: 0.895 Vali Acc: 0.570 Test Loss: 0.895 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7987587451934814
Epoch: 19, Steps: 20 | Train Loss: 0.254 Vali Loss: 0.932 Vali Acc: 0.520 Test Loss: 0.932 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5877289772033691
Epoch: 20, Steps: 20 | Train Loss: 0.205 Vali Loss: 1.019 Vali Acc: 0.500 Test Loss: 1.019 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2026524543762207
Epoch: 21, Steps: 20 | Train Loss: 0.210 Vali Loss: 0.999 Vali Acc: 0.490 Test Loss: 0.999 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2685081958770752
Epoch: 22, Steps: 20 | Train Loss: 0.151 Vali Loss: 1.075 Vali Acc: 0.540 Test Loss: 1.075 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2352104187011719
Epoch: 23, Steps: 20 | Train Loss: 0.150 Vali Loss: 0.994 Vali Acc: 0.520 Test Loss: 0.994 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.545691967010498
Epoch: 24, Steps: 20 | Train Loss: 0.134 Vali Loss: 1.103 Vali Acc: 0.550 Test Loss: 1.103 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.7065715789794922
Epoch: 25, Steps: 20 | Train Loss: 0.125 Vali Loss: 1.114 Vali Acc: 0.560 Test Loss: 1.114 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 152738
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.724118947982788
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.686 Vali Acc: 0.550 Test Loss: 0.686 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.70711350440979
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.799 Vali Acc: 0.480 Test Loss: 0.799 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4622957706451416
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.860 Vali Acc: 0.460 Test Loss: 0.860 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.885267972946167
Epoch: 4, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.783 Vali Acc: 0.510 Test Loss: 0.783 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.663207769393921
Epoch: 5, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.764 Vali Acc: 0.510 Test Loss: 0.764 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.607849359512329
Epoch: 6, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.721 Vali Acc: 0.620 Test Loss: 0.721 Test Acc: 0.620
Validation loss decreased (-0.549993 --> -0.619993).  Saving model ...
Epoch: 7 cost time: 1.9210364818572998
Epoch: 7, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.796 Vali Acc: 0.530 Test Loss: 0.796 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6816930770874023
Epoch: 8, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.861 Vali Acc: 0.580 Test Loss: 0.861 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5325376987457275
Epoch: 9, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.906 Vali Acc: 0.530 Test Loss: 0.906 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7731781005859375
Epoch: 10, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.805 Vali Acc: 0.550 Test Loss: 0.805 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.3284144401550293
Epoch: 11, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.744 Vali Acc: 0.590 Test Loss: 0.744 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.4337477684020996
Epoch: 12, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.879 Vali Acc: 0.550 Test Loss: 0.879 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.3411788940429688
Epoch: 13, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.903 Vali Acc: 0.550 Test Loss: 0.903 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.514172077178955
Epoch: 14, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.953 Vali Acc: 0.530 Test Loss: 0.953 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.153543710708618
Epoch: 15, Steps: 20 | Train Loss: 0.372 Vali Loss: 1.037 Vali Acc: 0.600 Test Loss: 1.037 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.5581772327423096
Epoch: 16, Steps: 20 | Train Loss: 0.363 Vali Loss: 0.864 Vali Acc: 0.620 Test Loss: 0.864 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 149218
model size : 0.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.192003011703491
Epoch: 1, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.674 Vali Acc: 0.570 Test Loss: 0.674 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 2.3363871574401855
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.709 Vali Acc: 0.490 Test Loss: 0.709 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.217994213104248
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.762 Vali Acc: 0.540 Test Loss: 0.762 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3400444984436035
Epoch: 4, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.775 Vali Acc: 0.490 Test Loss: 0.775 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2452383041381836
Epoch: 5, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.769 Vali Acc: 0.550 Test Loss: 0.769 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.623032569885254
Epoch: 6, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.735 Vali Acc: 0.550 Test Loss: 0.735 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.88333797454834
Epoch: 7, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.748 Vali Acc: 0.540 Test Loss: 0.748 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.7246758937835693
Epoch: 8, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.738 Vali Acc: 0.540 Test Loss: 0.738 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.659824848175049
Epoch: 9, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.827 Vali Acc: 0.510 Test Loss: 0.827 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.7375757694244385
Epoch: 10, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.823 Vali Acc: 0.560 Test Loss: 0.823 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9593093395233154
Epoch: 11, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.854 Vali Acc: 0.550 Test Loss: 0.854 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ModernTCN_UEA_ftM_sl50_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 143938
model size : 0.58MB
