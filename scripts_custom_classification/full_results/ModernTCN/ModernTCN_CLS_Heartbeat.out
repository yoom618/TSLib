Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.083810091018677
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.574 Vali Acc: 0.722 Test Loss: 0.574 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 9.292924642562866
Epoch: 2, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.563 Vali Acc: 0.717 Test Loss: 0.563 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.159193754196167
Epoch: 3, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.694 Vali Acc: 0.732 Test Loss: 0.694 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731700).  Saving model ...
Epoch: 4 cost time: 9.345616817474365
Epoch: 4, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.637 Vali Acc: 0.717 Test Loss: 0.637 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.103806018829346
Epoch: 5, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.796 Vali Acc: 0.722 Test Loss: 0.796 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.15424919128418
Epoch: 6, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.738 Vali Acc: 0.717 Test Loss: 0.738 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.076222658157349
Epoch: 7, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.698 Vali Acc: 0.683 Test Loss: 0.698 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.243992567062378
Epoch: 8, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.974 Vali Acc: 0.717 Test Loss: 0.974 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.261868715286255
Epoch: 9, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.954 Vali Acc: 0.678 Test Loss: 0.954 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.735780715942383
Epoch: 10, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.135 Vali Acc: 0.722 Test Loss: 1.135 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.904261350631714
Epoch: 11, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.120 Vali Acc: 0.688 Test Loss: 1.120 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 8.71863079071045
Epoch: 12, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.084 Vali Acc: 0.698 Test Loss: 1.084 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 8.743578433990479
Epoch: 13, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.184 Vali Acc: 0.712 Test Loss: 1.184 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 17886466
model size : 68.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.910427570343018
Epoch: 1, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.597 Vali Acc: 0.722 Test Loss: 0.597 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.662307500839233
Epoch: 2, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.597 Vali Acc: 0.727 Test Loss: 0.597 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 6.10888671875
Epoch: 3, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.556 Vali Acc: 0.732 Test Loss: 0.556 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 6.056755542755127
Epoch: 4, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.576 Vali Acc: 0.732 Test Loss: 0.576 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.074828624725342
Epoch: 5, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.711 Vali Acc: 0.712 Test Loss: 0.711 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.167611837387085
Epoch: 6, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.698 Vali Acc: 0.712 Test Loss: 0.698 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.980571269989014
Epoch: 7, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.746 Vali Acc: 0.722 Test Loss: 0.746 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.676662921905518
Epoch: 8, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.755 Vali Acc: 0.702 Test Loss: 0.755 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.1574623584747314
Epoch: 9, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.723 Vali Acc: 0.722 Test Loss: 0.723 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.804217576980591
Epoch: 10, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.800 Vali Acc: 0.727 Test Loss: 0.800 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.609842538833618
Epoch: 11, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.869 Vali Acc: 0.741 Test Loss: 0.869 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741455).  Saving model ...
Epoch: 12 cost time: 5.583482027053833
Epoch: 12, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.801 Vali Acc: 0.688 Test Loss: 0.801 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.382482051849365
Epoch: 13, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.905 Vali Acc: 0.732 Test Loss: 0.905 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.580965042114258
Epoch: 14, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.844 Vali Acc: 0.722 Test Loss: 0.844 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.115931510925293
Epoch: 15, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.978 Vali Acc: 0.732 Test Loss: 0.978 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.019843339920044
Epoch: 16, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.979 Vali Acc: 0.634 Test Loss: 0.979 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.972800254821777
Epoch: 17, Steps: 13 | Train Loss: 0.060 Vali Loss: 1.403 Vali Acc: 0.722 Test Loss: 1.403 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.370081424713135
Epoch: 18, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.287 Vali Acc: 0.688 Test Loss: 1.287 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.1036365032196045
Epoch: 19, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.219 Vali Acc: 0.722 Test Loss: 1.219 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.852136135101318
Epoch: 20, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.312 Vali Acc: 0.698 Test Loss: 1.312 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.132627487182617
Epoch: 21, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.303 Vali Acc: 0.693 Test Loss: 1.303 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 17761858
model size : 68.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.0325610637664795
Epoch: 1, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.591 Vali Acc: 0.722 Test Loss: 0.591 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.436833381652832
Epoch: 2, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.552 Vali Acc: 0.741 Test Loss: 0.552 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 5.059169769287109
Epoch: 3, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.550 Vali Acc: 0.746 Test Loss: 0.550 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 5.316117763519287
Epoch: 4, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.595 Vali Acc: 0.751 Test Loss: 0.595 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 4.724489212036133
Epoch: 5, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.597 Vali Acc: 0.737 Test Loss: 0.597 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.3825342655181885
Epoch: 6, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.613 Vali Acc: 0.712 Test Loss: 0.613 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.36169171333313
Epoch: 7, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.620 Vali Acc: 0.722 Test Loss: 0.620 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.544821500778198
Epoch: 8, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.675 Vali Acc: 0.722 Test Loss: 0.675 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.291259765625
Epoch: 9, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.689 Vali Acc: 0.727 Test Loss: 0.689 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.897399425506592
Epoch: 10, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.694 Vali Acc: 0.717 Test Loss: 0.694 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.651946783065796
Epoch: 11, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.679 Vali Acc: 0.727 Test Loss: 0.679 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.132607698440552
Epoch: 12, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.680 Vali Acc: 0.722 Test Loss: 0.680 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.976390361785889
Epoch: 13, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.706 Vali Acc: 0.712 Test Loss: 0.706 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.61885666847229
Epoch: 14, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.817 Vali Acc: 0.712 Test Loss: 0.817 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 17730946
model size : 67.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.519798517227173
Epoch: 1, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.608 Vali Acc: 0.722 Test Loss: 0.608 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.989576816558838
Epoch: 2, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.610 Vali Acc: 0.717 Test Loss: 0.610 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.306570291519165
Epoch: 3, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.570 Vali Acc: 0.751 Test Loss: 0.570 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 4.972504138946533
Epoch: 4, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.551 Vali Acc: 0.727 Test Loss: 0.551 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.9441468715667725
Epoch: 5, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.563 Vali Acc: 0.727 Test Loss: 0.563 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.886478424072266
Epoch: 6, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.569 Vali Acc: 0.722 Test Loss: 0.569 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.950019598007202
Epoch: 7, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.600 Vali Acc: 0.737 Test Loss: 0.600 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.079087257385254
Epoch: 8, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.9914355278015137
Epoch: 9, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.664 Vali Acc: 0.737 Test Loss: 0.664 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.104404926300049
Epoch: 10, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.669 Vali Acc: 0.732 Test Loss: 0.669 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.951826095581055
Epoch: 11, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.650 Vali Acc: 0.717 Test Loss: 0.650 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.67145848274231
Epoch: 12, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.653 Vali Acc: 0.722 Test Loss: 0.653 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.881368637084961
Epoch: 13, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.709 Vali Acc: 0.732 Test Loss: 0.709 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 17700034
model size : 67.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.8468921184539795
Epoch: 1, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.613 Vali Acc: 0.722 Test Loss: 0.613 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.63750147819519
Epoch: 2, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.599 Vali Acc: 0.717 Test Loss: 0.599 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.725442886352539
Epoch: 3, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.605 Vali Acc: 0.761 Test Loss: 0.605 Test Acc: 0.761
Validation loss decreased (-0.721945 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 4.645998954772949
Epoch: 4, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.568 Vali Acc: 0.732 Test Loss: 0.568 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.558614492416382
Epoch: 5, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.612 Vali Acc: 0.746 Test Loss: 0.612 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.9435384273529053
Epoch: 6, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.584 Vali Acc: 0.737 Test Loss: 0.584 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.224085807800293
Epoch: 7, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.585 Vali Acc: 0.722 Test Loss: 0.585 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.293514728546143
Epoch: 8, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.598 Vali Acc: 0.737 Test Loss: 0.598 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.753137826919556
Epoch: 9, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.585 Vali Acc: 0.737 Test Loss: 0.585 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.591096639633179
Epoch: 10, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.592 Vali Acc: 0.737 Test Loss: 0.592 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.53283166885376
Epoch: 11, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.611 Vali Acc: 0.741 Test Loss: 0.611 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.247901678085327
Epoch: 12, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.655 Vali Acc: 0.698 Test Loss: 0.655 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.43807578086853
Epoch: 13, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.772 Vali Acc: 0.737 Test Loss: 0.772 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 17685058
model size : 67.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.997342824935913
Epoch: 1, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.620 Vali Acc: 0.722 Test Loss: 0.620 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.7421951293945312
Epoch: 2, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.577 Vali Acc: 0.712 Test Loss: 0.577 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.420044898986816
Epoch: 3, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.577 Vali Acc: 0.732 Test Loss: 0.577 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 4.502390384674072
Epoch: 4, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.581 Vali Acc: 0.732 Test Loss: 0.581 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.403959035873413
Epoch: 5, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.537 Vali Acc: 0.737 Test Loss: 0.537 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 4.136047601699829
Epoch: 6, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.556 Vali Acc: 0.737 Test Loss: 0.556 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.476891279220581
Epoch: 7, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.594 Vali Acc: 0.722 Test Loss: 0.594 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.658064365386963
Epoch: 8, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.586 Vali Acc: 0.727 Test Loss: 0.586 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.541503429412842
Epoch: 9, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.590 Vali Acc: 0.712 Test Loss: 0.590 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.509458780288696
Epoch: 10, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.689 Vali Acc: 0.707 Test Loss: 0.689 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.096487522125244
Epoch: 11, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.667 Vali Acc: 0.712 Test Loss: 0.667 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.6475889682769775
Epoch: 12, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.684 Vali Acc: 0.702 Test Loss: 0.684 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.346545457839966
Epoch: 13, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.720 Vali Acc: 0.707 Test Loss: 0.720 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.314014196395874
Epoch: 14, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.859 Vali Acc: 0.698 Test Loss: 0.859 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.467296600341797
Epoch: 15, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.812 Vali Acc: 0.688 Test Loss: 0.812 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 17670082
model size : 67.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.213185787200928
Epoch: 1, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.636 Vali Acc: 0.727 Test Loss: 0.636 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 4.107019662857056
Epoch: 2, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.650686502456665
Epoch: 3, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.603 Vali Acc: 0.722 Test Loss: 0.603 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.117198944091797
Epoch: 4, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.557 Vali Acc: 0.727 Test Loss: 0.557 Test Acc: 0.727
Validation loss decreased (-0.726823 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 4.057469367980957
Epoch: 5, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.561 Vali Acc: 0.732 Test Loss: 0.561 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 6 cost time: 3.771864175796509
Epoch: 6, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.579 Vali Acc: 0.732 Test Loss: 0.579 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.737858533859253
Epoch: 7, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.537 Vali Acc: 0.727 Test Loss: 0.537 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.151196718215942
Epoch: 8, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.554 Vali Acc: 0.737 Test Loss: 0.554 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 9 cost time: 4.2801172733306885
Epoch: 9, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.585 Vali Acc: 0.732 Test Loss: 0.585 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6897504329681396
Epoch: 10, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.590 Vali Acc: 0.727 Test Loss: 0.590 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.3795511722564697
Epoch: 11, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.585 Vali Acc: 0.751 Test Loss: 0.585 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 12 cost time: 4.058434724807739
Epoch: 12, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.657 Vali Acc: 0.756 Test Loss: 0.657 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756091).  Saving model ...
Epoch: 13 cost time: 4.2537102699279785
Epoch: 13, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.636 Vali Acc: 0.702 Test Loss: 0.636 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.025380849838257
Epoch: 14, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.750 Vali Acc: 0.737 Test Loss: 0.750 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.3695151805877686
Epoch: 15, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.685 Vali Acc: 0.737 Test Loss: 0.685 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.7383038997650146
Epoch: 16, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.854 Vali Acc: 0.737 Test Loss: 0.854 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.5279510021209717
Epoch: 17, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.750 Vali Acc: 0.717 Test Loss: 0.750 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.074083089828491
Epoch: 18, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.785 Vali Acc: 0.722 Test Loss: 0.785 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.658276081085205
Epoch: 19, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.833 Vali Acc: 0.756 Test Loss: 0.833 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.66340970993042
Epoch: 20, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.955 Vali Acc: 0.732 Test Loss: 0.955 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.2302281856536865
Epoch: 21, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.012 Vali Acc: 0.717 Test Loss: 1.012 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.055394411087036
Epoch: 22, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.987 Vali Acc: 0.707 Test Loss: 0.987 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 17655138
model size : 67.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.886685371398926
Epoch: 1, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.577 Vali Acc: 0.712 Test Loss: 0.577 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 8.786943674087524
Epoch: 2, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.658 Vali Acc: 0.756 Test Loss: 0.658 Test Acc: 0.756
Validation loss decreased (-0.712189 --> -0.756091).  Saving model ...
Epoch: 3 cost time: 8.907445907592773
Epoch: 3, Steps: 13 | Train Loss: 0.284 Vali Loss: 0.600 Vali Acc: 0.712 Test Loss: 0.600 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.61484694480896
Epoch: 4, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.622 Vali Acc: 0.722 Test Loss: 0.622 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.105520725250244
Epoch: 5, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.887 Vali Acc: 0.722 Test Loss: 0.887 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.759270191192627
Epoch: 6, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.846 Vali Acc: 0.722 Test Loss: 0.846 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.884471893310547
Epoch: 7, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.790 Vali Acc: 0.712 Test Loss: 0.790 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.982882738113403
Epoch: 8, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.902 Vali Acc: 0.717 Test Loss: 0.902 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.982157468795776
Epoch: 9, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.845 Vali Acc: 0.683 Test Loss: 0.845 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 8.301909446716309
Epoch: 10, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.303 Vali Acc: 0.712 Test Loss: 1.303 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 8.65417194366455
Epoch: 11, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.157 Vali Acc: 0.678 Test Loss: 1.157 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.585773229598999
Epoch: 12, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.014 Vali Acc: 0.717 Test Loss: 1.014 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 17831810
model size : 68.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.884133338928223
Epoch: 1, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.591 Vali Acc: 0.722 Test Loss: 0.591 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.353924989700317
Epoch: 2, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.631 Vali Acc: 0.737 Test Loss: 0.631 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 6.069423198699951
Epoch: 3, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.575 Vali Acc: 0.737 Test Loss: 0.575 Test Acc: 0.737
Validation loss decreased (-0.736579 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 5.746382474899292
Epoch: 4, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.499860525131226
Epoch: 5, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.689 Vali Acc: 0.722 Test Loss: 0.689 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.11477518081665
Epoch: 6, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.661 Vali Acc: 0.712 Test Loss: 0.661 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.103818893432617
Epoch: 7, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.664 Vali Acc: 0.717 Test Loss: 0.664 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.79732346534729
Epoch: 8, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.715 Vali Acc: 0.751 Test Loss: 0.715 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751212).  Saving model ...
Epoch: 9 cost time: 6.141025066375732
Epoch: 9, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.812 Vali Acc: 0.712 Test Loss: 0.812 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.9310302734375
Epoch: 10, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.837 Vali Acc: 0.737 Test Loss: 0.837 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.861087799072266
Epoch: 11, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.892 Vali Acc: 0.732 Test Loss: 0.892 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.277312278747559
Epoch: 12, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.898 Vali Acc: 0.707 Test Loss: 0.898 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.381735563278198
Epoch: 13, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.933 Vali Acc: 0.717 Test Loss: 0.933 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.462315797805786
Epoch: 14, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.974 Vali Acc: 0.732 Test Loss: 0.974 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.137595891952515
Epoch: 15, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.973 Vali Acc: 0.737 Test Loss: 0.973 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.31081485748291
Epoch: 16, Steps: 13 | Train Loss: 0.048 Vali Loss: 1.083 Vali Acc: 0.722 Test Loss: 1.083 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.238155841827393
Epoch: 17, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.161 Vali Acc: 0.727 Test Loss: 1.161 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.274009466171265
Epoch: 18, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.192 Vali Acc: 0.702 Test Loss: 1.192 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 17707202
model size : 67.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.517858266830444
Epoch: 1, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.593 Vali Acc: 0.722 Test Loss: 0.593 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.060092449188232
Epoch: 2, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.567 Vali Acc: 0.722 Test Loss: 0.567 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 4.7762908935546875
Epoch: 3, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.577 Vali Acc: 0.741 Test Loss: 0.577 Test Acc: 0.741
Validation loss decreased (-0.721946 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 4.833421468734741
Epoch: 4, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.558 Vali Acc: 0.727 Test Loss: 0.558 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.515494108200073
Epoch: 5, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.570 Vali Acc: 0.722 Test Loss: 0.570 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.3835718631744385
Epoch: 6, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.578 Vali Acc: 0.727 Test Loss: 0.578 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.258613109588623
Epoch: 7, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.663 Vali Acc: 0.712 Test Loss: 0.663 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.757772207260132
Epoch: 8, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.622 Vali Acc: 0.693 Test Loss: 0.622 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.186767101287842
Epoch: 9, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.645 Vali Acc: 0.717 Test Loss: 0.645 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.516807317733765
Epoch: 10, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.655 Vali Acc: 0.727 Test Loss: 0.655 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.471083164215088
Epoch: 11, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.828 Vali Acc: 0.722 Test Loss: 0.828 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.289781093597412
Epoch: 12, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.714 Vali Acc: 0.698 Test Loss: 0.714 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.028157711029053
Epoch: 13, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.831 Vali Acc: 0.717 Test Loss: 0.831 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 17676290
model size : 67.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.491012334823608
Epoch: 1, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.614 Vali Acc: 0.732 Test Loss: 0.614 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 4.270970582962036
Epoch: 2, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.559 Vali Acc: 0.727 Test Loss: 0.559 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.824914455413818
Epoch: 3, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.567 Vali Acc: 0.741 Test Loss: 0.567 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 4.925376892089844
Epoch: 4, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.551 Vali Acc: 0.737 Test Loss: 0.551 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.519644498825073
Epoch: 5, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.550 Vali Acc: 0.727 Test Loss: 0.550 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.672658205032349
Epoch: 6, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.567 Vali Acc: 0.722 Test Loss: 0.567 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.897716283798218
Epoch: 7, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.587 Vali Acc: 0.722 Test Loss: 0.587 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.400295257568359
Epoch: 8, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.595 Vali Acc: 0.722 Test Loss: 0.595 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.19946813583374
Epoch: 9, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.605 Vali Acc: 0.717 Test Loss: 0.605 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.3875203132629395
Epoch: 10, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.619 Vali Acc: 0.717 Test Loss: 0.619 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.192765712738037
Epoch: 11, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.631 Vali Acc: 0.712 Test Loss: 0.631 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.6712915897369385
Epoch: 12, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.691 Vali Acc: 0.722 Test Loss: 0.691 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.058270215988159
Epoch: 13, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.702 Vali Acc: 0.722 Test Loss: 0.702 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 17645378
model size : 67.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.803222894668579
Epoch: 1, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.628 Vali Acc: 0.727 Test Loss: 0.628 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 4.202048063278198
Epoch: 2, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.588 Vali Acc: 0.722 Test Loss: 0.588 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.11998438835144
Epoch: 3, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.591 Vali Acc: 0.751 Test Loss: 0.591 Test Acc: 0.751
Validation loss decreased (-0.726823 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 4.518015623092651
Epoch: 4, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.578 Vali Acc: 0.741 Test Loss: 0.578 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.163861274719238
Epoch: 5, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.591 Vali Acc: 0.737 Test Loss: 0.591 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.774815082550049
Epoch: 6, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.597 Vali Acc: 0.727 Test Loss: 0.597 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.363420009613037
Epoch: 7, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.608 Vali Acc: 0.727 Test Loss: 0.608 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.652043104171753
Epoch: 8, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.613 Vali Acc: 0.722 Test Loss: 0.613 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.572930335998535
Epoch: 9, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.648 Vali Acc: 0.732 Test Loss: 0.648 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.655261039733887
Epoch: 10, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.613 Vali Acc: 0.698 Test Loss: 0.613 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.617297887802124
Epoch: 11, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.617 Vali Acc: 0.727 Test Loss: 0.617 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.882995367050171
Epoch: 12, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.697 Vali Acc: 0.737 Test Loss: 0.697 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.39298939704895
Epoch: 13, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.685 Vali Acc: 0.707 Test Loss: 0.685 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 17630402
model size : 67.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.796431541442871
Epoch: 1, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.636 Vali Acc: 0.717 Test Loss: 0.636 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.740324020385742
Epoch: 2, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.578 Vali Acc: 0.717 Test Loss: 0.578 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 4.488639831542969
Epoch: 3, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.613 Vali Acc: 0.727 Test Loss: 0.613 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 4.360574245452881
Epoch: 4, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.579 Vali Acc: 0.712 Test Loss: 0.579 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.924058675765991
Epoch: 5, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.563 Vali Acc: 0.727 Test Loss: 0.563 Test Acc: 0.727
Validation loss decreased (-0.726823 --> -0.726824).  Saving model ...
Epoch: 6 cost time: 4.287300109863281
Epoch: 6, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.584 Vali Acc: 0.741 Test Loss: 0.584 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 7 cost time: 4.0594494342803955
Epoch: 7, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.565 Vali Acc: 0.727 Test Loss: 0.565 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.101887941360474
Epoch: 8, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.585 Vali Acc: 0.727 Test Loss: 0.585 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.22629189491272
Epoch: 9, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.637 Vali Acc: 0.702 Test Loss: 0.637 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.647186994552612
Epoch: 10, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.679 Vali Acc: 0.732 Test Loss: 0.679 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.7974777221679688
Epoch: 11, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.715 Vali Acc: 0.727 Test Loss: 0.715 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.5989108085632324
Epoch: 12, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.727 Vali Acc: 0.727 Test Loss: 0.727 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.956388235092163
Epoch: 13, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.701 Vali Acc: 0.683 Test Loss: 0.701 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.215683937072754
Epoch: 14, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.814 Vali Acc: 0.722 Test Loss: 0.814 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.273184299468994
Epoch: 15, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.805 Vali Acc: 0.707 Test Loss: 0.805 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.6754536628723145
Epoch: 16, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.822 Vali Acc: 0.698 Test Loss: 0.822 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 17615426
model size : 67.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.598730564117432
Epoch: 1, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.640 Vali Acc: 0.717 Test Loss: 0.640 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.035639762878418
Epoch: 2, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.588 Vali Acc: 0.717 Test Loss: 0.588 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 3.6082043647766113
Epoch: 3, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.594 Vali Acc: 0.727 Test Loss: 0.594 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 4.250919342041016
Epoch: 4, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.569 Vali Acc: 0.737 Test Loss: 0.569 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 4.111097574234009
Epoch: 5, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.552 Vali Acc: 0.741 Test Loss: 0.552 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 4.537935972213745
Epoch: 6, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.568 Vali Acc: 0.737 Test Loss: 0.568 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.500783205032349
Epoch: 7, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.565 Vali Acc: 0.727 Test Loss: 0.565 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.367734909057617
Epoch: 8, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.572 Vali Acc: 0.722 Test Loss: 0.572 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.449878931045532
Epoch: 9, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.594 Vali Acc: 0.741 Test Loss: 0.594 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.222061395645142
Epoch: 10, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.595 Vali Acc: 0.737 Test Loss: 0.595 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.537917137145996
Epoch: 11, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.610 Vali Acc: 0.722 Test Loss: 0.610 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.539957284927368
Epoch: 12, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.613 Vali Acc: 0.751 Test Loss: 0.613 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751213).  Saving model ...
Epoch: 13 cost time: 3.365424871444702
Epoch: 13, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.667 Vali Acc: 0.727 Test Loss: 0.667 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4460365772247314
Epoch: 14, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.720 Vali Acc: 0.732 Test Loss: 0.720 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.9657671451568604
Epoch: 15, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.702 Vali Acc: 0.722 Test Loss: 0.702 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.839778423309326
Epoch: 16, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.747 Vali Acc: 0.732 Test Loss: 0.747 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.8686795234680176
Epoch: 17, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.855 Vali Acc: 0.722 Test Loss: 0.855 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.752446413040161
Epoch: 18, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.925 Vali Acc: 0.712 Test Loss: 0.925 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.2712371349334717
Epoch: 19, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.877 Vali Acc: 0.712 Test Loss: 0.877 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.847146511077881
Epoch: 20, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.070 Vali Acc: 0.717 Test Loss: 1.070 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.9720826148986816
Epoch: 21, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.981 Vali Acc: 0.702 Test Loss: 0.981 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.7130815982818604
Epoch: 22, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.352 Vali Acc: 0.732 Test Loss: 1.352 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 17600482
model size : 67.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 23.616610050201416
Epoch: 1, Steps: 13 | Train Loss: 0.811 Vali Loss: 0.610 Vali Acc: 0.732 Test Loss: 0.610 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 20.529558420181274
Epoch: 2, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.639 Vali Acc: 0.722 Test Loss: 0.639 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 22.540671825408936
Epoch: 3, Steps: 13 | Train Loss: 0.183 Vali Loss: 1.054 Vali Acc: 0.615 Test Loss: 1.054 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 21.99465560913086
Epoch: 4, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.977 Vali Acc: 0.673 Test Loss: 0.977 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 21.46580481529236
Epoch: 5, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.932 Vali Acc: 0.712 Test Loss: 1.932 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 22.637850046157837
Epoch: 6, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.396 Vali Acc: 0.590 Test Loss: 1.396 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 20.43501329421997
Epoch: 7, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.441 Vali Acc: 0.746 Test Loss: 1.441 Test Acc: 0.746
Validation loss decreased (-0.731701 --> -0.746327).  Saving model ...
Epoch: 8 cost time: 21.723716735839844
Epoch: 8, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.614 Vali Acc: 0.732 Test Loss: 1.614 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 23.785096645355225
Epoch: 9, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.553 Vali Acc: 0.702 Test Loss: 1.553 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 23.749786615371704
Epoch: 10, Steps: 13 | Train Loss: 0.006 Vali Loss: 2.200 Vali Acc: 0.727 Test Loss: 2.200 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 23.424593210220337
Epoch: 11, Steps: 13 | Train Loss: 0.013 Vali Loss: 2.290 Vali Acc: 0.649 Test Loss: 2.290 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 23.76238203048706
Epoch: 12, Steps: 13 | Train Loss: 0.006 Vali Loss: 2.377 Vali Acc: 0.683 Test Loss: 2.377 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 23.62126326560974
Epoch: 13, Steps: 13 | Train Loss: 0.005 Vali Loss: 2.366 Vali Acc: 0.732 Test Loss: 2.366 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 22.66769027709961
Epoch: 14, Steps: 13 | Train Loss: 0.006 Vali Loss: 2.687 Vali Acc: 0.678 Test Loss: 2.687 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 23.955666065216064
Epoch: 15, Steps: 13 | Train Loss: 0.008 Vali Loss: 2.879 Vali Acc: 0.698 Test Loss: 2.879 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 22.013909816741943
Epoch: 16, Steps: 13 | Train Loss: 0.009 Vali Loss: 3.147 Vali Acc: 0.707 Test Loss: 3.147 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 23.334970951080322
Epoch: 17, Steps: 13 | Train Loss: 0.013 Vali Loss: 3.392 Vali Acc: 0.717 Test Loss: 3.392 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 53287938
model size : 203.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 13.653114080429077
Epoch: 1, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.554 Vali Acc: 0.727 Test Loss: 0.554 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 13.490094661712646
Epoch: 2, Steps: 13 | Train Loss: 0.349 Vali Loss: 0.709 Vali Acc: 0.561 Test Loss: 0.709 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.757402658462524
Epoch: 3, Steps: 13 | Train Loss: 0.271 Vali Loss: 1.112 Vali Acc: 0.737 Test Loss: 1.112 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736574).  Saving model ...
Epoch: 4 cost time: 12.60770559310913
Epoch: 4, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.965 Vali Acc: 0.722 Test Loss: 0.965 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.660698413848877
Epoch: 5, Steps: 13 | Train Loss: 0.159 Vali Loss: 1.030 Vali Acc: 0.732 Test Loss: 1.030 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.549601316452026
Epoch: 6, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.972 Vali Acc: 0.659 Test Loss: 0.972 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.971707582473755
Epoch: 7, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.364 Vali Acc: 0.722 Test Loss: 1.364 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.310224533081055
Epoch: 8, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.407 Vali Acc: 0.717 Test Loss: 1.407 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 13.438368797302246
Epoch: 9, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.390 Vali Acc: 0.688 Test Loss: 1.390 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 11.845107078552246
Epoch: 10, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.366 Vali Acc: 0.683 Test Loss: 1.366 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 11.903403043746948
Epoch: 11, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.450 Vali Acc: 0.722 Test Loss: 1.450 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 12.62882375717163
Epoch: 12, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.435 Vali Acc: 0.659 Test Loss: 1.435 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 12.578681945800781
Epoch: 13, Steps: 13 | Train Loss: 0.028 Vali Loss: 2.318 Vali Acc: 0.727 Test Loss: 2.318 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 52789506
model size : 201.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 11.66513967514038
Epoch: 1, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.566 Vali Acc: 0.722 Test Loss: 0.566 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 9.650412559509277
Epoch: 2, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.545 Vali Acc: 0.732 Test Loss: 0.545 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 10.774883270263672
Epoch: 3, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.556 Vali Acc: 0.717 Test Loss: 0.556 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.923610925674438
Epoch: 4, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.615 Vali Acc: 0.722 Test Loss: 0.615 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.971744537353516
Epoch: 5, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.708 Vali Acc: 0.746 Test Loss: 0.708 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746334).  Saving model ...
Epoch: 6 cost time: 10.685756921768188
Epoch: 6, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.922 Vali Acc: 0.732 Test Loss: 0.922 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.32924509048462
Epoch: 7, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.786 Vali Acc: 0.717 Test Loss: 0.786 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.202298879623413
Epoch: 8, Steps: 13 | Train Loss: 0.128 Vali Loss: 1.048 Vali Acc: 0.663 Test Loss: 1.048 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.431717872619629
Epoch: 9, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.932 Vali Acc: 0.717 Test Loss: 0.932 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.739119052886963
Epoch: 10, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.082 Vali Acc: 0.693 Test Loss: 1.082 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.90152645111084
Epoch: 11, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.374 Vali Acc: 0.673 Test Loss: 1.374 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.25284719467163
Epoch: 12, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.468 Vali Acc: 0.702 Test Loss: 1.468 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.416718006134033
Epoch: 13, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.560 Vali Acc: 0.702 Test Loss: 1.560 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.277840852737427
Epoch: 14, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.418 Vali Acc: 0.693 Test Loss: 1.418 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.061951398849487
Epoch: 15, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.333 Vali Acc: 0.688 Test Loss: 1.333 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 52634626
model size : 201.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.810274600982666
Epoch: 1, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.571 Vali Acc: 0.722 Test Loss: 0.571 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 8.89958143234253
Epoch: 2, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.566 Vali Acc: 0.737 Test Loss: 0.566 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 9.380725383758545
Epoch: 3, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.588 Vali Acc: 0.727 Test Loss: 0.588 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.32741093635559
Epoch: 4, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.618 Vali Acc: 0.707 Test Loss: 0.618 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.987655401229858
Epoch: 5, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.738 Vali Acc: 0.663 Test Loss: 0.738 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.73620343208313
Epoch: 6, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.769 Vali Acc: 0.751 Test Loss: 0.769 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751212).  Saving model ...
Epoch: 7 cost time: 9.30252194404602
Epoch: 7, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.754 Vali Acc: 0.688 Test Loss: 0.754 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.81550121307373
Epoch: 8, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.940 Vali Acc: 0.746 Test Loss: 0.940 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.630068302154541
Epoch: 9, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.892 Vali Acc: 0.620 Test Loss: 0.892 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.195669412612915
Epoch: 10, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.133 Vali Acc: 0.717 Test Loss: 1.133 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.685349941253662
Epoch: 11, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.318 Vali Acc: 0.639 Test Loss: 1.318 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.018105030059814
Epoch: 12, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.178 Vali Acc: 0.698 Test Loss: 1.178 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.675413370132446
Epoch: 13, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.120 Vali Acc: 0.698 Test Loss: 1.120 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.57836127281189
Epoch: 14, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.223 Vali Acc: 0.693 Test Loss: 1.223 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.432220697402954
Epoch: 15, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.395 Vali Acc: 0.683 Test Loss: 1.395 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 8.989121437072754
Epoch: 16, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.295 Vali Acc: 0.683 Test Loss: 1.295 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 52542210
model size : 200.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.761761665344238
Epoch: 1, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.585 Vali Acc: 0.722 Test Loss: 0.585 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 6.624944448471069
Epoch: 2, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.579 Vali Acc: 0.741 Test Loss: 0.579 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 7.49326491355896
Epoch: 3, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.570 Vali Acc: 0.732 Test Loss: 0.570 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.044170141220093
Epoch: 4, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.728 Vali Acc: 0.732 Test Loss: 0.728 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.877744674682617
Epoch: 5, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.639 Vali Acc: 0.683 Test Loss: 0.639 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.375463485717773
Epoch: 6, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.692 Vali Acc: 0.741 Test Loss: 0.692 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.589135646820068
Epoch: 7, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.813 Vali Acc: 0.678 Test Loss: 0.813 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.4387335777282715
Epoch: 8, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.911 Vali Acc: 0.698 Test Loss: 0.911 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.815955400466919
Epoch: 9, Steps: 13 | Train Loss: 0.048 Vali Loss: 1.010 Vali Acc: 0.712 Test Loss: 1.010 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 9.55073094367981
Epoch: 10, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.001 Vali Acc: 0.678 Test Loss: 1.001 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 8.784209728240967
Epoch: 11, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.395 Vali Acc: 0.722 Test Loss: 1.395 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 10.354904651641846
Epoch: 12, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.037 Vali Acc: 0.678 Test Loss: 1.037 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 52451074
model size : 200.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.162684440612793
Epoch: 1, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.598 Vali Acc: 0.737 Test Loss: 0.598 Test Acc: 0.737
Validation loss decreased (inf --> -0.736579).  Saving model ...
Epoch: 2 cost time: 9.122979879379272
Epoch: 2, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.590 Vali Acc: 0.746 Test Loss: 0.590 Test Acc: 0.746
Validation loss decreased (-0.736579 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 9.218131065368652
Epoch: 3, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.553 Vali Acc: 0.732 Test Loss: 0.553 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.77776837348938
Epoch: 4, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.594 Vali Acc: 0.727 Test Loss: 0.594 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.039727449417114
Epoch: 5, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.642 Vali Acc: 0.654 Test Loss: 0.642 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.192628145217896
Epoch: 6, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.624 Vali Acc: 0.722 Test Loss: 0.624 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.926398754119873
Epoch: 7, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.643 Vali Acc: 0.717 Test Loss: 0.643 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.835346937179565
Epoch: 8, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.669 Vali Acc: 0.712 Test Loss: 0.669 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.927931547164917
Epoch: 9, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.703 Vali Acc: 0.712 Test Loss: 0.703 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 9.25168776512146
Epoch: 10, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.715 Vali Acc: 0.727 Test Loss: 0.715 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 9.453784465789795
Epoch: 11, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.748 Vali Acc: 0.693 Test Loss: 0.748 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 8.078057765960693
Epoch: 12, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.849 Vali Acc: 0.654 Test Loss: 0.849 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 52391170
model size : 200.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.353564739227295
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.596 Vali Acc: 0.727 Test Loss: 0.596 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 8.131352186203003
Epoch: 2, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.576 Vali Acc: 0.751 Test Loss: 0.576 Test Acc: 0.751
Validation loss decreased (-0.726823 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 8.015734434127808
Epoch: 3, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.593 Vali Acc: 0.732 Test Loss: 0.593 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.14096450805664
Epoch: 4, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.551 Vali Acc: 0.727 Test Loss: 0.551 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.413652420043945
Epoch: 5, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.572 Vali Acc: 0.722 Test Loss: 0.572 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.398887634277344
Epoch: 6, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.602 Vali Acc: 0.727 Test Loss: 0.602 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.544287919998169
Epoch: 7, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.592 Vali Acc: 0.737 Test Loss: 0.592 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.663097143173218
Epoch: 8, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.635 Vali Acc: 0.741 Test Loss: 0.635 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.5270607471466064
Epoch: 9, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.632 Vali Acc: 0.756 Test Loss: 0.632 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756091).  Saving model ...
Epoch: 10 cost time: 7.293944835662842
Epoch: 10, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.754 Vali Acc: 0.756 Test Loss: 0.754 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.873040199279785
Epoch: 11, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.698 Vali Acc: 0.673 Test Loss: 0.698 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.891646862030029
Epoch: 12, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.679 Vali Acc: 0.737 Test Loss: 0.679 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.438804626464844
Epoch: 13, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.912 Vali Acc: 0.751 Test Loss: 0.912 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.598611116409302
Epoch: 14, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.967 Vali Acc: 0.634 Test Loss: 0.967 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.292757511138916
Epoch: 15, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.318 Vali Acc: 0.751 Test Loss: 1.318 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.444395542144775
Epoch: 16, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.270 Vali Acc: 0.624 Test Loss: 1.270 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 8.462566614151001
Epoch: 17, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.297 Vali Acc: 0.722 Test Loss: 1.297 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 8.323474407196045
Epoch: 18, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.978 Vali Acc: 0.732 Test Loss: 1.978 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 8.283382654190063
Epoch: 19, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.768 Vali Acc: 0.712 Test Loss: 1.768 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 52362626
model size : 200.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 13.2233726978302
Epoch: 1, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.563 Vali Acc: 0.732 Test Loss: 0.563 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 12.162744760513306
Epoch: 2, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.561 Vali Acc: 0.717 Test Loss: 0.561 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.85080862045288
Epoch: 3, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.602 Vali Acc: 0.712 Test Loss: 0.602 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.262827634811401
Epoch: 4, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.686 Vali Acc: 0.693 Test Loss: 0.686 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.596456050872803
Epoch: 5, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.891 Vali Acc: 0.712 Test Loss: 0.891 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.14109206199646
Epoch: 6, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.983 Vali Acc: 0.610 Test Loss: 0.983 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 12.019888877868652
Epoch: 7, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.906 Vali Acc: 0.702 Test Loss: 0.906 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 11.13324785232544
Epoch: 8, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.436 Vali Acc: 0.727 Test Loss: 1.436 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.867126941680908
Epoch: 9, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.449 Vali Acc: 0.590 Test Loss: 1.449 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 10.849184036254883
Epoch: 10, Steps: 13 | Train Loss: 0.081 Vali Loss: 1.499 Vali Acc: 0.668 Test Loss: 1.499 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 11.313541173934937
Epoch: 11, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.345 Vali Acc: 0.683 Test Loss: 1.345 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 16633346
model size : 63.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.98043704032898
Epoch: 1, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.584 Vali Acc: 0.717 Test Loss: 0.584 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 7.311820983886719
Epoch: 2, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.665 Vali Acc: 0.737 Test Loss: 0.665 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 6.536829948425293
Epoch: 3, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.567 Vali Acc: 0.717 Test Loss: 0.567 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.388323783874512
Epoch: 4, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.605 Vali Acc: 0.732 Test Loss: 0.605 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.884136438369751
Epoch: 5, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.622 Vali Acc: 0.727 Test Loss: 0.622 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.842937707901001
Epoch: 6, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.650 Vali Acc: 0.683 Test Loss: 0.650 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.692004203796387
Epoch: 7, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.804 Vali Acc: 0.722 Test Loss: 0.804 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.750013113021851
Epoch: 8, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.894 Vali Acc: 0.732 Test Loss: 0.894 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.668465614318848
Epoch: 9, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.962 Vali Acc: 0.722 Test Loss: 0.962 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.761394023895264
Epoch: 10, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.996 Vali Acc: 0.717 Test Loss: 0.996 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.210328817367554
Epoch: 11, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.082 Vali Acc: 0.707 Test Loss: 1.082 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.748231649398804
Epoch: 12, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.038 Vali Acc: 0.659 Test Loss: 1.038 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 16384130
model size : 62.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.557370185852051
Epoch: 1, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 6.3162078857421875
Epoch: 2, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.553 Vali Acc: 0.741 Test Loss: 0.553 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 6.194124221801758
Epoch: 3, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.622 Vali Acc: 0.732 Test Loss: 0.622 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.853369951248169
Epoch: 4, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.664 Vali Acc: 0.737 Test Loss: 0.664 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.903761148452759
Epoch: 5, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.655 Vali Acc: 0.702 Test Loss: 0.655 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.1695685386657715
Epoch: 6, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.770 Vali Acc: 0.741 Test Loss: 0.770 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.882403135299683
Epoch: 7, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.833 Vali Acc: 0.717 Test Loss: 0.833 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.20531964302063
Epoch: 8, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.780 Vali Acc: 0.693 Test Loss: 0.780 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.5098488330841064
Epoch: 9, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.894 Vali Acc: 0.712 Test Loss: 0.894 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.217798948287964
Epoch: 10, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.913 Vali Acc: 0.707 Test Loss: 0.913 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.6860926151275635
Epoch: 11, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.043 Vali Acc: 0.727 Test Loss: 1.043 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.926540374755859
Epoch: 12, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.134 Vali Acc: 0.702 Test Loss: 1.134 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 16306690
model size : 62.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.223617076873779
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.583 Vali Acc: 0.717 Test Loss: 0.583 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.91800856590271
Epoch: 2, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.618 Vali Acc: 0.741 Test Loss: 0.618 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 5.635294437408447
Epoch: 3, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.561 Vali Acc: 0.732 Test Loss: 0.561 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.74648642539978
Epoch: 4, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.607 Vali Acc: 0.727 Test Loss: 0.607 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.828042507171631
Epoch: 5, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.628 Vali Acc: 0.732 Test Loss: 0.628 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.056218385696411
Epoch: 6, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.689 Vali Acc: 0.727 Test Loss: 0.689 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.113086462020874
Epoch: 7, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.601 Vali Acc: 0.722 Test Loss: 0.601 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.410157203674316
Epoch: 8, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.748 Vali Acc: 0.732 Test Loss: 0.748 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.530421018600464
Epoch: 9, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.781 Vali Acc: 0.722 Test Loss: 0.781 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.908636808395386
Epoch: 10, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.743 Vali Acc: 0.732 Test Loss: 0.743 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.315569877624512
Epoch: 11, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.751 Vali Acc: 0.688 Test Loss: 0.751 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.82254958152771
Epoch: 12, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.921 Vali Acc: 0.722 Test Loss: 0.921 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 16260482
model size : 62.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.6253502368927
Epoch: 1, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.301079988479614
Epoch: 2, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.641 Vali Acc: 0.727 Test Loss: 0.641 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 5.3406713008880615
Epoch: 3, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.565 Vali Acc: 0.717 Test Loss: 0.565 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.50427770614624
Epoch: 4, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.588 Vali Acc: 0.727 Test Loss: 0.588 Test Acc: 0.727
Validation loss decreased (-0.726823 --> -0.726823).  Saving model ...
Epoch: 5 cost time: 4.995189428329468
Epoch: 5, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.597 Vali Acc: 0.732 Test Loss: 0.597 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731701).  Saving model ...
Epoch: 6 cost time: 4.505530595779419
Epoch: 6, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.715 Vali Acc: 0.727 Test Loss: 0.715 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.063885927200317
Epoch: 7, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.832 Vali Acc: 0.732 Test Loss: 0.832 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.867598295211792
Epoch: 8, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.706 Vali Acc: 0.663 Test Loss: 0.706 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.048605680465698
Epoch: 9, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.722 Vali Acc: 0.751 Test Loss: 0.722 Test Acc: 0.751
Validation loss decreased (-0.731701 --> -0.751212).  Saving model ...
Epoch: 10 cost time: 4.358321189880371
Epoch: 10, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.741 Vali Acc: 0.741 Test Loss: 0.741 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.449900388717651
Epoch: 11, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.749 Vali Acc: 0.678 Test Loss: 0.749 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.1860926151275635
Epoch: 12, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.905 Vali Acc: 0.751 Test Loss: 0.905 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.469583034515381
Epoch: 13, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.863 Vali Acc: 0.737 Test Loss: 0.863 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.709124803543091
Epoch: 14, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.922 Vali Acc: 0.727 Test Loss: 0.922 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.984759330749512
Epoch: 15, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.933 Vali Acc: 0.741 Test Loss: 0.933 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.723578929901123
Epoch: 16, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.856 Vali Acc: 0.741 Test Loss: 0.856 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.993184328079224
Epoch: 17, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.947 Vali Acc: 0.659 Test Loss: 0.947 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.889647483825684
Epoch: 18, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.161 Vali Acc: 0.746 Test Loss: 1.161 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.552925109863281
Epoch: 19, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.164 Vali Acc: 0.683 Test Loss: 1.164 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 16214914
model size : 62.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.937281608581543
Epoch: 1, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.609 Vali Acc: 0.722 Test Loss: 0.609 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.643295764923096
Epoch: 2, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.572 Vali Acc: 0.722 Test Loss: 0.572 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 4.776167392730713
Epoch: 3, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.546 Vali Acc: 0.756 Test Loss: 0.546 Test Acc: 0.756
Validation loss decreased (-0.721946 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 4.481644153594971
Epoch: 4, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.523 Vali Acc: 0.761 Test Loss: 0.523 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 4.670680999755859
Epoch: 5, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.547 Vali Acc: 0.751 Test Loss: 0.547 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.430607318878174
Epoch: 6, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.578 Vali Acc: 0.741 Test Loss: 0.578 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.035610914230347
Epoch: 7, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.619 Vali Acc: 0.751 Test Loss: 0.619 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.0208165645599365
Epoch: 8, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.574 Vali Acc: 0.751 Test Loss: 0.574 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.288376569747925
Epoch: 9, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.642 Vali Acc: 0.756 Test Loss: 0.642 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.4934706687927246
Epoch: 10, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.569 Vali Acc: 0.737 Test Loss: 0.569 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.868588924407959
Epoch: 11, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.557 Vali Acc: 0.746 Test Loss: 0.557 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.7380220890045166
Epoch: 12, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.554 Vali Acc: 0.741 Test Loss: 0.554 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.364176988601685
Epoch: 13, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.701 Vali Acc: 0.761 Test Loss: 0.701 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.7337329387664795
Epoch: 14, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.676 Vali Acc: 0.727 Test Loss: 0.676 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 16184962
model size : 61.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.340660810470581
Epoch: 1, Steps: 13 | Train Loss: 0.642 Vali Loss: 0.605 Vali Acc: 0.727 Test Loss: 0.605 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 3.984539031982422
Epoch: 2, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.559 Vali Acc: 0.717 Test Loss: 0.559 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.779628038406372
Epoch: 3, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.590 Vali Acc: 0.766 Test Loss: 0.590 Test Acc: 0.766
Validation loss decreased (-0.726823 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 4.162384271621704
Epoch: 4, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.533 Vali Acc: 0.737 Test Loss: 0.533 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.120490789413452
Epoch: 5, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.529 Vali Acc: 0.741 Test Loss: 0.529 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.500120401382446
Epoch: 6, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.562 Vali Acc: 0.766 Test Loss: 0.562 Test Acc: 0.766
Validation loss decreased (-0.765848 --> -0.765848).  Saving model ...
Epoch: 7 cost time: 4.0602662563323975
Epoch: 7, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.542 Vali Acc: 0.741 Test Loss: 0.542 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.086646556854248
Epoch: 8, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.560 Vali Acc: 0.727 Test Loss: 0.560 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.6291074752807617
Epoch: 9, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.571 Vali Acc: 0.746 Test Loss: 0.571 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.992413282394409
Epoch: 10, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.631 Vali Acc: 0.746 Test Loss: 0.631 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.8461430072784424
Epoch: 11, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.625 Vali Acc: 0.751 Test Loss: 0.625 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.9056994915008545
Epoch: 12, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.641 Vali Acc: 0.746 Test Loss: 0.641 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.003796577453613
Epoch: 13, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.644 Vali Acc: 0.741 Test Loss: 0.644 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.209782361984253
Epoch: 14, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.787 Vali Acc: 0.737 Test Loss: 0.787 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.250791311264038
Epoch: 15, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.695 Vali Acc: 0.722 Test Loss: 0.695 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.329358339309692
Epoch: 16, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.955 Vali Acc: 0.756 Test Loss: 0.955 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 16170690
model size : 61.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.74224328994751
Epoch: 1, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.574 Vali Acc: 0.717 Test Loss: 0.574 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.714769124984741
Epoch: 2, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.579 Vali Acc: 0.737 Test Loss: 0.579 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 5.016942262649536
Epoch: 3, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.571 Vali Acc: 0.698 Test Loss: 0.571 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.990983486175537
Epoch: 4, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.593 Vali Acc: 0.722 Test Loss: 0.593 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.673107624053955
Epoch: 5, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.639 Vali Acc: 0.712 Test Loss: 0.639 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.760283708572388
Epoch: 6, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.661 Vali Acc: 0.717 Test Loss: 0.661 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.304458856582642
Epoch: 7, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.802 Vali Acc: 0.722 Test Loss: 0.802 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.111774921417236
Epoch: 8, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.780 Vali Acc: 0.722 Test Loss: 0.780 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.44834041595459
Epoch: 9, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.823 Vali Acc: 0.712 Test Loss: 0.823 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.573861360549927
Epoch: 10, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.904 Vali Acc: 0.678 Test Loss: 0.904 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.87283730506897
Epoch: 11, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.934 Vali Acc: 0.717 Test Loss: 0.934 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.171212911605835
Epoch: 12, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.970 Vali Acc: 0.702 Test Loss: 0.970 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 5814018
model size : 22.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.2137181758880615
Epoch: 1, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.5126194953918457
Epoch: 2, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.603 Vali Acc: 0.737 Test Loss: 0.603 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 3.406277656555176
Epoch: 3, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.552 Vali Acc: 0.732 Test Loss: 0.552 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.803215980529785
Epoch: 4, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.591 Vali Acc: 0.727 Test Loss: 0.591 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.89034104347229
Epoch: 5, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.600 Vali Acc: 0.717 Test Loss: 0.600 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.8207995891571045
Epoch: 6, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.678 Vali Acc: 0.732 Test Loss: 0.678 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.159742593765259
Epoch: 7, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.703 Vali Acc: 0.732 Test Loss: 0.703 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.5268003940582275
Epoch: 8, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.716 Vali Acc: 0.712 Test Loss: 0.716 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.5926592350006104
Epoch: 9, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.747 Vali Acc: 0.737 Test Loss: 0.747 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.3926374912261963
Epoch: 10, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.802 Vali Acc: 0.702 Test Loss: 0.802 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.2720680236816406
Epoch: 11, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.953 Vali Acc: 0.741 Test Loss: 0.953 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741454).  Saving model ...
Epoch: 12 cost time: 3.4983136653900146
Epoch: 12, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.837 Vali Acc: 0.688 Test Loss: 0.837 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.347890853881836
Epoch: 13, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.008 Vali Acc: 0.741 Test Loss: 1.008 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.5310773849487305
Epoch: 14, Steps: 13 | Train Loss: 0.048 Vali Loss: 1.001 Vali Acc: 0.644 Test Loss: 1.001 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.0984671115875244
Epoch: 15, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.131 Vali Acc: 0.751 Test Loss: 1.131 Test Acc: 0.751
Validation loss decreased (-0.741454 --> -0.751208).  Saving model ...
Epoch: 16 cost time: 2.964813709259033
Epoch: 16, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.940 Vali Acc: 0.693 Test Loss: 0.940 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.972203254699707
Epoch: 17, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.947 Vali Acc: 0.707 Test Loss: 0.947 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.2269790172576904
Epoch: 18, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.906 Vali Acc: 0.722 Test Loss: 0.906 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.7049009799957275
Epoch: 19, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.897 Vali Acc: 0.722 Test Loss: 0.897 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.3456525802612305
Epoch: 20, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.038 Vali Acc: 0.727 Test Loss: 1.038 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.3465616703033447
Epoch: 21, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.025 Vali Acc: 0.722 Test Loss: 1.025 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.279482364654541
Epoch: 22, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.135 Vali Acc: 0.707 Test Loss: 1.135 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.1861038208007812
Epoch: 23, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.069 Vali Acc: 0.707 Test Loss: 1.069 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.464447021484375
Epoch: 24, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.064 Vali Acc: 0.698 Test Loss: 1.064 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.325195789337158
Epoch: 25, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.171 Vali Acc: 0.688 Test Loss: 1.171 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 5689410
model size : 21.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.212038278579712
Epoch: 1, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.600 Vali Acc: 0.717 Test Loss: 0.600 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.8425352573394775
Epoch: 2, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.607 Vali Acc: 0.732 Test Loss: 0.607 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 2.6760764122009277
Epoch: 3, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.573 Vali Acc: 0.732 Test Loss: 0.573 Test Acc: 0.732
Validation loss decreased (-0.731701 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 3.003267526626587
Epoch: 4, Steps: 13 | Train Loss: 0.303 Vali Loss: 0.570 Vali Acc: 0.751 Test Loss: 0.570 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 2.892793655395508
Epoch: 5, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.573 Vali Acc: 0.732 Test Loss: 0.573 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.774275541305542
Epoch: 6, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.617 Vali Acc: 0.737 Test Loss: 0.617 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.879103899002075
Epoch: 7, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.643 Vali Acc: 0.717 Test Loss: 0.643 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.184384822845459
Epoch: 8, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.667 Vali Acc: 0.737 Test Loss: 0.667 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.013277530670166
Epoch: 9, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.608 Vali Acc: 0.722 Test Loss: 0.608 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.15734601020813
Epoch: 10, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.633 Vali Acc: 0.712 Test Loss: 0.633 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.7471771240234375
Epoch: 11, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.704 Vali Acc: 0.732 Test Loss: 0.704 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.704500436782837
Epoch: 12, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.753 Vali Acc: 0.727 Test Loss: 0.753 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.172029495239258
Epoch: 13, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.707 Vali Acc: 0.688 Test Loss: 0.707 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.789010524749756
Epoch: 14, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.914 Vali Acc: 0.722 Test Loss: 0.914 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 5650690
model size : 21.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8494927883148193
Epoch: 1, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.609 Vali Acc: 0.722 Test Loss: 0.609 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.430040121078491
Epoch: 2, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.569 Vali Acc: 0.722 Test Loss: 0.569 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 2.3142991065979004
Epoch: 3, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.586 Vali Acc: 0.741 Test Loss: 0.586 Test Acc: 0.741
Validation loss decreased (-0.721946 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 2.579890727996826
Epoch: 4, Steps: 13 | Train Loss: 0.349 Vali Loss: 0.557 Vali Acc: 0.737 Test Loss: 0.557 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.914907455444336
Epoch: 5, Steps: 13 | Train Loss: 0.255 Vali Loss: 0.585 Vali Acc: 0.737 Test Loss: 0.585 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5419342517852783
Epoch: 6, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.557 Vali Acc: 0.737 Test Loss: 0.557 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.672370672225952
Epoch: 7, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.598 Vali Acc: 0.727 Test Loss: 0.598 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.207500696182251
Epoch: 8, Steps: 13 | Train Loss: 0.134 Vali Loss: 0.617 Vali Acc: 0.722 Test Loss: 0.617 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.8792173862457275
Epoch: 9, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.658 Vali Acc: 0.732 Test Loss: 0.658 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.866244077682495
Epoch: 10, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.623 Vali Acc: 0.732 Test Loss: 0.623 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.8729472160339355
Epoch: 11, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.641 Vali Acc: 0.732 Test Loss: 0.641 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.4524898529052734
Epoch: 12, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.606 Vali Acc: 0.702 Test Loss: 0.606 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.8036797046661377
Epoch: 13, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.673 Vali Acc: 0.707 Test Loss: 0.673 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 5627586
model size : 21.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6772422790527344
Epoch: 1, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.599 Vali Acc: 0.717 Test Loss: 0.599 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.494257688522339
Epoch: 2, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 2.218681573867798
Epoch: 3, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.590 Vali Acc: 0.732 Test Loss: 0.590 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 4 cost time: 2.1007261276245117
Epoch: 4, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.569 Vali Acc: 0.737 Test Loss: 0.569 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 2.5519421100616455
Epoch: 5, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.567 Vali Acc: 0.741 Test Loss: 0.567 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 2.5977847576141357
Epoch: 6, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.579 Vali Acc: 0.737 Test Loss: 0.579 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.553231716156006
Epoch: 7, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.609 Vali Acc: 0.727 Test Loss: 0.609 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4822022914886475
Epoch: 8, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.592 Vali Acc: 0.727 Test Loss: 0.592 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.2326409816741943
Epoch: 9, Steps: 13 | Train Loss: 0.151 Vali Loss: 0.594 Vali Acc: 0.737 Test Loss: 0.594 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1853842735290527
Epoch: 10, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.581 Vali Acc: 0.722 Test Loss: 0.581 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.433457851409912
Epoch: 11, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.631 Vali Acc: 0.732 Test Loss: 0.631 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.806774377822876
Epoch: 12, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.625 Vali Acc: 0.678 Test Loss: 0.625 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.6796650886535645
Epoch: 13, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.666 Vali Acc: 0.727 Test Loss: 0.666 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.3007774353027344
Epoch: 14, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.651 Vali Acc: 0.707 Test Loss: 0.651 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.633704900741577
Epoch: 15, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.753 Vali Acc: 0.722 Test Loss: 0.753 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 5604802
model size : 21.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9065868854522705
Epoch: 1, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.627 Vali Acc: 0.722 Test Loss: 0.627 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.666717767715454
Epoch: 2, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.576 Vali Acc: 0.717 Test Loss: 0.576 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.509186029434204
Epoch: 3, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.560 Vali Acc: 0.717 Test Loss: 0.560 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1277682781219482
Epoch: 4, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.564 Vali Acc: 0.741 Test Loss: 0.564 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 2.2535059452056885
Epoch: 5, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.547 Vali Acc: 0.727 Test Loss: 0.547 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5573740005493164
Epoch: 6, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.554 Vali Acc: 0.741 Test Loss: 0.554 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 7 cost time: 2.1001083850860596
Epoch: 7, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.545 Vali Acc: 0.746 Test Loss: 0.545 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 8 cost time: 2.3039379119873047
Epoch: 8, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.556 Vali Acc: 0.741 Test Loss: 0.556 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.20405912399292
Epoch: 9, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.547 Vali Acc: 0.751 Test Loss: 0.547 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 10 cost time: 2.5131402015686035
Epoch: 10, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.575 Vali Acc: 0.717 Test Loss: 0.575 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7739529609680176
Epoch: 11, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.607 Vali Acc: 0.727 Test Loss: 0.607 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6387240886688232
Epoch: 12, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.618 Vali Acc: 0.712 Test Loss: 0.618 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.713362455368042
Epoch: 13, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.5084567070007324
Epoch: 14, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.592 Vali Acc: 0.727 Test Loss: 0.592 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.695665121078491
Epoch: 15, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.611 Vali Acc: 0.683 Test Loss: 0.611 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.695690155029297
Epoch: 16, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.657 Vali Acc: 0.717 Test Loss: 0.657 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.94075345993042
Epoch: 17, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.646 Vali Acc: 0.712 Test Loss: 0.646 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.4580516815185547
Epoch: 18, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.675 Vali Acc: 0.712 Test Loss: 0.675 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.447720527648926
Epoch: 19, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.727 Vali Acc: 0.717 Test Loss: 0.727 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 5589826
model size : 21.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.753922700881958
Epoch: 1, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.634 Vali Acc: 0.717 Test Loss: 0.634 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.454963445663452
Epoch: 2, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.644 Vali Acc: 0.707 Test Loss: 0.644 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.170619249343872
Epoch: 3, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.614 Vali Acc: 0.712 Test Loss: 0.614 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5395567417144775
Epoch: 4, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.564 Vali Acc: 0.722 Test Loss: 0.564 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721946).  Saving model ...
Epoch: 5 cost time: 2.3779454231262207
Epoch: 5, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.598 Vali Acc: 0.741 Test Loss: 0.598 Test Acc: 0.741
Validation loss decreased (-0.721946 --> -0.741457).  Saving model ...
Epoch: 6 cost time: 2.558483839035034
Epoch: 6, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.675 Vali Acc: 0.741 Test Loss: 0.675 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3749279975891113
Epoch: 7, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.581 Vali Acc: 0.751 Test Loss: 0.581 Test Acc: 0.751
Validation loss decreased (-0.741457 --> -0.751214).  Saving model ...
Epoch: 8 cost time: 2.7554166316986084
Epoch: 8, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.551 Vali Acc: 0.727 Test Loss: 0.551 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1278090476989746
Epoch: 9, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.565 Vali Acc: 0.746 Test Loss: 0.565 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6730473041534424
Epoch: 10, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.571 Vali Acc: 0.722 Test Loss: 0.571 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9981305599212646
Epoch: 11, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.576 Vali Acc: 0.741 Test Loss: 0.576 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.910933494567871
Epoch: 12, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.633 Vali Acc: 0.732 Test Loss: 0.633 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.120598316192627
Epoch: 13, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.637 Vali Acc: 0.756 Test Loss: 0.637 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756091).  Saving model ...
Epoch: 14 cost time: 2.433133840560913
Epoch: 14, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.628 Vali Acc: 0.727 Test Loss: 0.628 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4402964115142822
Epoch: 15, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.595 Vali Acc: 0.746 Test Loss: 0.595 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.6137313842773438
Epoch: 16, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.661 Vali Acc: 0.746 Test Loss: 0.661 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1972625255584717
Epoch: 17, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.658 Vali Acc: 0.746 Test Loss: 0.658 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.4758172035217285
Epoch: 18, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.688 Vali Acc: 0.751 Test Loss: 0.688 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.1071181297302246
Epoch: 19, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.029 Vali Acc: 0.737 Test Loss: 1.029 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.8597617149353027
Epoch: 20, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.857 Vali Acc: 0.620 Test Loss: 0.857 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.6530699729919434
Epoch: 21, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.984 Vali Acc: 0.722 Test Loss: 0.984 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.695985794067383
Epoch: 22, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.894 Vali Acc: 0.712 Test Loss: 0.894 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.5879454612731934
Epoch: 23, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.097 Vali Acc: 0.741 Test Loss: 1.097 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 5582690
model size : 21.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 24.814117908477783
Epoch: 1, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.552 Vali Acc: 0.741 Test Loss: 0.552 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 25.683063745498657
Epoch: 2, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.623 Vali Acc: 0.702 Test Loss: 0.623 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.872215270996094
Epoch: 3, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.847 Vali Acc: 0.717 Test Loss: 0.847 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 23.13437581062317
Epoch: 4, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.997 Vali Acc: 0.639 Test Loss: 0.997 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 25.328970432281494
Epoch: 5, Steps: 13 | Train Loss: 0.173 Vali Loss: 1.771 Vali Acc: 0.717 Test Loss: 1.771 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 25.32577681541443
Epoch: 6, Steps: 13 | Train Loss: 0.119 Vali Loss: 1.824 Vali Acc: 0.707 Test Loss: 1.824 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 25.01417112350464
Epoch: 7, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.754 Vali Acc: 0.707 Test Loss: 1.754 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 24.813541889190674
Epoch: 8, Steps: 13 | Train Loss: 0.014 Vali Loss: 2.309 Vali Acc: 0.746 Test Loss: 2.309 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746318).  Saving model ...
Epoch: 9 cost time: 22.799416065216064
Epoch: 9, Steps: 13 | Train Loss: 0.128 Vali Loss: 2.043 Vali Acc: 0.668 Test Loss: 2.043 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 22.289426803588867
Epoch: 10, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.636 Vali Acc: 0.673 Test Loss: 1.636 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 18.24613380432129
Epoch: 11, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.690 Vali Acc: 0.659 Test Loss: 1.690 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 24.064231634140015
Epoch: 12, Steps: 13 | Train Loss: 0.012 Vali Loss: 2.099 Vali Acc: 0.698 Test Loss: 2.099 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 22.935335159301758
Epoch: 13, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.815 Vali Acc: 0.702 Test Loss: 1.815 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 22.765384197235107
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.047 Vali Acc: 0.707 Test Loss: 2.047 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 24.405771732330322
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.118 Vali Acc: 0.712 Test Loss: 2.118 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 21.61683940887451
Epoch: 16, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.195 Vali Acc: 0.717 Test Loss: 2.195 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 24.265151500701904
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.388 Vali Acc: 0.722 Test Loss: 2.388 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 23.24427342414856
Epoch: 18, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.294 Vali Acc: 0.702 Test Loss: 2.294 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 53194242
model size : 203.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 14.178243637084961
Epoch: 1, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.603 Vali Acc: 0.717 Test Loss: 0.603 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 13.773632764816284
Epoch: 2, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.662 Vali Acc: 0.702 Test Loss: 0.662 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.225411891937256
Epoch: 3, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.742 Vali Acc: 0.702 Test Loss: 0.742 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.824532747268677
Epoch: 4, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.941 Vali Acc: 0.732 Test Loss: 0.941 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731698).  Saving model ...
Epoch: 5 cost time: 12.875226020812988
Epoch: 5, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.793 Vali Acc: 0.751 Test Loss: 0.793 Test Acc: 0.751
Validation loss decreased (-0.731698 --> -0.751212).  Saving model ...
Epoch: 6 cost time: 12.647756338119507
Epoch: 6, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.874 Vali Acc: 0.732 Test Loss: 0.874 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.049910545349121
Epoch: 7, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.817 Vali Acc: 0.727 Test Loss: 0.817 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.939666509628296
Epoch: 8, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.954 Vali Acc: 0.712 Test Loss: 0.954 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.472945213317871
Epoch: 9, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.262 Vali Acc: 0.727 Test Loss: 1.262 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 12.632834911346436
Epoch: 10, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.094 Vali Acc: 0.654 Test Loss: 1.094 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.40239953994751
Epoch: 11, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.073 Vali Acc: 0.663 Test Loss: 1.073 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 12.091757774353027
Epoch: 12, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.403 Vali Acc: 0.727 Test Loss: 1.403 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 12.309044122695923
Epoch: 13, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.446 Vali Acc: 0.610 Test Loss: 1.446 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 12.238043069839478
Epoch: 14, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.740 Vali Acc: 0.683 Test Loss: 1.740 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 11.550325393676758
Epoch: 15, Steps: 13 | Train Loss: 0.022 Vali Loss: 2.670 Vali Acc: 0.712 Test Loss: 2.670 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 52695810
model size : 201.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 12.288675785064697
Epoch: 1, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.564 Vali Acc: 0.722 Test Loss: 0.564 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 8.58637809753418
Epoch: 2, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.564 Vali Acc: 0.727 Test Loss: 0.564 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 10.653426170349121
Epoch: 3, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.734 Vali Acc: 0.688 Test Loss: 0.734 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.629669904708862
Epoch: 4, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.764 Vali Acc: 0.717 Test Loss: 0.764 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.367594003677368
Epoch: 5, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.868 Vali Acc: 0.707 Test Loss: 0.868 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.831997632980347
Epoch: 6, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.900 Vali Acc: 0.727 Test Loss: 0.900 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.657759666442871
Epoch: 7, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.956 Vali Acc: 0.702 Test Loss: 0.956 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 9.851651906967163
Epoch: 8, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.154 Vali Acc: 0.698 Test Loss: 1.154 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 9.96135401725769
Epoch: 9, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.172 Vali Acc: 0.702 Test Loss: 1.172 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 10.705575227737427
Epoch: 10, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.205 Vali Acc: 0.717 Test Loss: 1.205 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 10.371339559555054
Epoch: 11, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.510 Vali Acc: 0.717 Test Loss: 1.510 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 11.096879243850708
Epoch: 12, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.397 Vali Acc: 0.634 Test Loss: 1.397 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 52540930
model size : 200.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 10.245452642440796
Epoch: 1, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.579 Vali Acc: 0.727 Test Loss: 0.579 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 9.32485580444336
Epoch: 2, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.568 Vali Acc: 0.746 Test Loss: 0.568 Test Acc: 0.746
Validation loss decreased (-0.726823 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 8.731101989746094
Epoch: 3, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.656 Vali Acc: 0.751 Test Loss: 0.656 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751213).  Saving model ...
Epoch: 4 cost time: 9.530529975891113
Epoch: 4, Steps: 13 | Train Loss: 0.170 Vali Loss: 0.805 Vali Acc: 0.717 Test Loss: 0.805 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.936323404312134
Epoch: 5, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.677 Vali Acc: 0.722 Test Loss: 0.677 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.975178241729736
Epoch: 6, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.712 Vali Acc: 0.722 Test Loss: 0.712 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.68338918685913
Epoch: 7, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.840 Vali Acc: 0.727 Test Loss: 0.840 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.908083200454712
Epoch: 8, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.633 Vali Acc: 0.732 Test Loss: 1.633 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.253602266311646
Epoch: 9, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.942 Vali Acc: 0.663 Test Loss: 0.942 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.284807682037354
Epoch: 10, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.438 Vali Acc: 0.737 Test Loss: 1.438 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.645959615707397
Epoch: 11, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.087 Vali Acc: 0.702 Test Loss: 1.087 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 8.367921352386475
Epoch: 12, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.197 Vali Acc: 0.663 Test Loss: 1.197 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.72237491607666
Epoch: 13, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.358 Vali Acc: 0.712 Test Loss: 1.358 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 52448514
model size : 200.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.282795190811157
Epoch: 1, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.572 Vali Acc: 0.722 Test Loss: 0.572 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 8.315748691558838
Epoch: 2, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.599 Vali Acc: 0.756 Test Loss: 0.599 Test Acc: 0.756
Validation loss decreased (-0.721946 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 8.31820011138916
Epoch: 3, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.592 Vali Acc: 0.756 Test Loss: 0.592 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 7.960165977478027
Epoch: 4, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.618 Vali Acc: 0.722 Test Loss: 0.618 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.2491185665130615
Epoch: 5, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.661 Vali Acc: 0.727 Test Loss: 0.661 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.654695749282837
Epoch: 6, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.818 Vali Acc: 0.746 Test Loss: 0.818 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.226705312728882
Epoch: 7, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.940 Vali Acc: 0.732 Test Loss: 0.940 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.939120531082153
Epoch: 8, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.848 Vali Acc: 0.712 Test Loss: 0.848 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.557124137878418
Epoch: 9, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.829 Vali Acc: 0.717 Test Loss: 0.829 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.220264196395874
Epoch: 10, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.896 Vali Acc: 0.688 Test Loss: 0.896 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 7.319698810577393
Epoch: 11, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.018 Vali Acc: 0.717 Test Loss: 1.018 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 8.281748294830322
Epoch: 12, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.089 Vali Acc: 0.712 Test Loss: 1.089 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.690763711929321
Epoch: 13, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.140 Vali Acc: 0.732 Test Loss: 1.140 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 52357378
model size : 200.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.666069507598877
Epoch: 1, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.577 Vali Acc: 0.722 Test Loss: 0.577 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 6.363542556762695
Epoch: 2, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.539 Vali Acc: 0.737 Test Loss: 0.539 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 7.069836616516113
Epoch: 3, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.527 Vali Acc: 0.727 Test Loss: 0.527 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.2149364948272705
Epoch: 4, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.744 Vali Acc: 0.727 Test Loss: 0.744 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.47534441947937
Epoch: 5, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.619 Vali Acc: 0.737 Test Loss: 0.619 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.168700933456421
Epoch: 6, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.591 Vali Acc: 0.702 Test Loss: 0.591 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.714724063873291
Epoch: 7, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.601 Vali Acc: 0.737 Test Loss: 0.601 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.8677978515625
Epoch: 8, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.644 Vali Acc: 0.698 Test Loss: 0.644 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.385067701339722
Epoch: 9, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.808 Vali Acc: 0.712 Test Loss: 0.808 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.036088705062866
Epoch: 10, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.764 Vali Acc: 0.698 Test Loss: 0.764 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.933105707168579
Epoch: 11, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.710 Vali Acc: 0.688 Test Loss: 0.710 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.4629411697387695
Epoch: 12, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.977 Vali Acc: 0.707 Test Loss: 0.977 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 52297474
model size : 199.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.849938869476318
Epoch: 1, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.604 Vali Acc: 0.712 Test Loss: 0.604 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 5.138415813446045
Epoch: 2, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.576 Vali Acc: 0.727 Test Loss: 0.576 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 6.371778249740601
Epoch: 3, Steps: 13 | Train Loss: 0.321 Vali Loss: 0.571 Vali Acc: 0.712 Test Loss: 0.571 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.528395652770996
Epoch: 4, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.056532859802246
Epoch: 5, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.577 Vali Acc: 0.732 Test Loss: 0.577 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 6 cost time: 5.383865594863892
Epoch: 6, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.599 Vali Acc: 0.722 Test Loss: 0.599 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.203383922576904
Epoch: 7, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.675 Vali Acc: 0.732 Test Loss: 0.675 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.238314151763916
Epoch: 8, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.655 Vali Acc: 0.693 Test Loss: 0.655 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.5929388999938965
Epoch: 9, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.817 Vali Acc: 0.727 Test Loss: 0.817 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.82338285446167
Epoch: 10, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.746 Vali Acc: 0.732 Test Loss: 0.746 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.863414525985718
Epoch: 11, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.911 Vali Acc: 0.741 Test Loss: 0.911 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741454).  Saving model ...
Epoch: 12 cost time: 5.7697670459747314
Epoch: 12, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.852 Vali Acc: 0.654 Test Loss: 0.852 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.111934661865234
Epoch: 13, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.949 Vali Acc: 0.732 Test Loss: 0.949 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.83944296836853
Epoch: 14, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.909 Vali Acc: 0.688 Test Loss: 0.909 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.625945091247559
Epoch: 15, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.114 Vali Acc: 0.722 Test Loss: 1.114 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.737948179244995
Epoch: 16, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.134 Vali Acc: 0.722 Test Loss: 1.134 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.4454145431518555
Epoch: 17, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.167 Vali Acc: 0.663 Test Loss: 1.167 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.596930980682373
Epoch: 18, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.269 Vali Acc: 0.741 Test Loss: 1.269 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.873444557189941
Epoch: 19, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.185 Vali Acc: 0.659 Test Loss: 1.185 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.734221696853638
Epoch: 20, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.220 Vali Acc: 0.741 Test Loss: 1.220 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.787700414657593
Epoch: 21, Steps: 13 | Train Loss: 0.075 Vali Loss: 1.269 Vali Acc: 0.766 Test Loss: 1.269 Test Acc: 0.766
Validation loss decreased (-0.741454 --> -0.765841).  Saving model ...
Epoch: 22 cost time: 5.97872519493103
Epoch: 22, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.278 Vali Acc: 0.678 Test Loss: 1.278 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.49942946434021
Epoch: 23, Steps: 13 | Train Loss: 0.098 Vali Loss: 1.553 Vali Acc: 0.727 Test Loss: 1.553 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.514852046966553
Epoch: 24, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.521 Vali Acc: 0.698 Test Loss: 1.521 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.010753631591797
Epoch: 25, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.573 Vali Acc: 0.683 Test Loss: 1.573 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.645461320877075
Epoch: 26, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.601 Vali Acc: 0.688 Test Loss: 1.601 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.740015745162964
Epoch: 27, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.702 Vali Acc: 0.668 Test Loss: 1.702 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.546059846878052
Epoch: 28, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.668 Vali Acc: 0.688 Test Loss: 1.668 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.168385744094849
Epoch: 29, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.682 Vali Acc: 0.707 Test Loss: 1.682 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.931635141372681
Epoch: 30, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.762 Vali Acc: 0.707 Test Loss: 1.762 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.918334245681763
Epoch: 31, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.841 Vali Acc: 0.659 Test Loss: 1.841 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 52268930
model size : 199.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.85320782661438
Epoch: 1, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.647 Vali Acc: 0.712 Test Loss: 0.647 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 8.772960662841797
Epoch: 2, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.604 Vali Acc: 0.663 Test Loss: 0.604 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.681418180465698
Epoch: 3, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.636 Vali Acc: 0.717 Test Loss: 0.636 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 4 cost time: 7.742164850234985
Epoch: 4, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.988 Vali Acc: 0.722 Test Loss: 0.988 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721941).  Saving model ...
Epoch: 5 cost time: 9.782996654510498
Epoch: 5, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.069 Vali Acc: 0.727 Test Loss: 1.069 Test Acc: 0.727
Validation loss decreased (-0.721941 --> -0.726819).  Saving model ...
Epoch: 6 cost time: 9.64833927154541
Epoch: 6, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.220 Vali Acc: 0.732 Test Loss: 1.220 Test Acc: 0.732
Validation loss decreased (-0.726819 --> -0.731695).  Saving model ...
Epoch: 7 cost time: 9.480830192565918
Epoch: 7, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.002 Vali Acc: 0.678 Test Loss: 1.002 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.964744091033936
Epoch: 8, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.124 Vali Acc: 0.702 Test Loss: 1.124 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.486221313476562
Epoch: 9, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.021 Vali Acc: 0.693 Test Loss: 1.021 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.39961838722229
Epoch: 10, Steps: 13 | Train Loss: 0.071 Vali Loss: 1.462 Vali Acc: 0.693 Test Loss: 1.462 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.194343328475952
Epoch: 11, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.353 Vali Acc: 0.693 Test Loss: 1.353 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.169236421585083
Epoch: 12, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.269 Vali Acc: 0.698 Test Loss: 1.269 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.4272620677948
Epoch: 13, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.951 Vali Acc: 0.678 Test Loss: 1.951 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 9.546607732772827
Epoch: 14, Steps: 13 | Train Loss: 0.126 Vali Loss: 1.580 Vali Acc: 0.698 Test Loss: 1.580 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.195608615875244
Epoch: 15, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.655 Vali Acc: 0.683 Test Loss: 1.655 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.244876384735107
Epoch: 16, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.652 Vali Acc: 0.649 Test Loss: 1.652 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 16586498
model size : 63.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.020163059234619
Epoch: 1, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.566 Vali Acc: 0.717 Test Loss: 0.566 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 6.092890501022339
Epoch: 2, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.553 Vali Acc: 0.737 Test Loss: 0.553 Test Acc: 0.737
Validation loss decreased (-0.717068 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 6.41941237449646
Epoch: 3, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.601 Vali Acc: 0.693 Test Loss: 0.601 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.221248626708984
Epoch: 4, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.793 Vali Acc: 0.722 Test Loss: 0.793 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.485601902008057
Epoch: 5, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.742 Vali Acc: 0.698 Test Loss: 0.742 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.9236083030700684
Epoch: 6, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.873 Vali Acc: 0.737 Test Loss: 0.873 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.144329071044922
Epoch: 7, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.027 Vali Acc: 0.683 Test Loss: 1.027 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.29425573348999
Epoch: 8, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.123 Vali Acc: 0.741 Test Loss: 1.123 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741452).  Saving model ...
Epoch: 9 cost time: 6.163934946060181
Epoch: 9, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.900 Vali Acc: 0.688 Test Loss: 0.900 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.496938228607178
Epoch: 10, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.071 Vali Acc: 0.698 Test Loss: 1.071 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.694047451019287
Epoch: 11, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.021 Vali Acc: 0.712 Test Loss: 1.021 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.172389030456543
Epoch: 12, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.068 Vali Acc: 0.737 Test Loss: 1.068 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.175941228866577
Epoch: 13, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.147 Vali Acc: 0.702 Test Loss: 1.147 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.366654872894287
Epoch: 14, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.132 Vali Acc: 0.698 Test Loss: 1.132 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.905919313430786
Epoch: 15, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.230 Vali Acc: 0.707 Test Loss: 1.230 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.644597291946411
Epoch: 16, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.351 Vali Acc: 0.702 Test Loss: 1.351 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.785809278488159
Epoch: 17, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.482 Vali Acc: 0.605 Test Loss: 1.482 Test Acc: 0.605
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.388969898223877
Epoch: 18, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.589 Vali Acc: 0.727 Test Loss: 1.589 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 16337282
model size : 62.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.716749429702759
Epoch: 1, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.575 Vali Acc: 0.717 Test Loss: 0.575 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.100196838378906
Epoch: 2, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.594 Vali Acc: 0.746 Test Loss: 0.594 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 5.329412937164307
Epoch: 3, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.661 Vali Acc: 0.737 Test Loss: 0.661 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.506775617599487
Epoch: 4, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.594 Vali Acc: 0.722 Test Loss: 0.594 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.343028783798218
Epoch: 5, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.727 Vali Acc: 0.722 Test Loss: 0.727 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.35241174697876
Epoch: 6, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.747 Vali Acc: 0.712 Test Loss: 0.747 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.53180718421936
Epoch: 7, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.733 Vali Acc: 0.702 Test Loss: 0.733 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.871045351028442
Epoch: 8, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.830 Vali Acc: 0.717 Test Loss: 0.830 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.168537378311157
Epoch: 9, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.819 Vali Acc: 0.727 Test Loss: 0.819 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.316153049468994
Epoch: 10, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.920 Vali Acc: 0.727 Test Loss: 0.920 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.159344673156738
Epoch: 11, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.074 Vali Acc: 0.737 Test Loss: 1.074 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.075361728668213
Epoch: 12, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.095 Vali Acc: 0.717 Test Loss: 1.095 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 16259842
model size : 62.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.422600746154785
Epoch: 1, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.599096298217773
Epoch: 2, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.646 Vali Acc: 0.746 Test Loss: 0.646 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746335).  Saving model ...
Epoch: 3 cost time: 5.268612861633301
Epoch: 3, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.550 Vali Acc: 0.737 Test Loss: 0.550 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.334262132644653
Epoch: 4, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.607 Vali Acc: 0.737 Test Loss: 0.607 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.30109429359436
Epoch: 5, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.608 Vali Acc: 0.741 Test Loss: 0.608 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.339736700057983
Epoch: 6, Steps: 13 | Train Loss: 0.147 Vali Loss: 0.604 Vali Acc: 0.737 Test Loss: 0.604 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.543774843215942
Epoch: 7, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.716 Vali Acc: 0.746 Test Loss: 0.716 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.81612229347229
Epoch: 8, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.687 Vali Acc: 0.732 Test Loss: 0.687 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.1948444843292236
Epoch: 9, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.770 Vali Acc: 0.741 Test Loss: 0.770 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.482390642166138
Epoch: 10, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.742 Vali Acc: 0.678 Test Loss: 0.742 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.432341814041138
Epoch: 11, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.865 Vali Acc: 0.722 Test Loss: 0.865 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.25204062461853
Epoch: 12, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.812 Vali Acc: 0.707 Test Loss: 0.812 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 16213634
model size : 62.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.288611173629761
Epoch: 1, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.604 Vali Acc: 0.717 Test Loss: 0.604 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.326638698577881
Epoch: 2, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.593 Vali Acc: 0.727 Test Loss: 0.593 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 4.524677276611328
Epoch: 3, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.608 Vali Acc: 0.746 Test Loss: 0.608 Test Acc: 0.746
Validation loss decreased (-0.726823 --> -0.746335).  Saving model ...
Epoch: 4 cost time: 4.58905816078186
Epoch: 4, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.591 Vali Acc: 0.737 Test Loss: 0.591 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.739253759384155
Epoch: 5, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.664 Vali Acc: 0.732 Test Loss: 0.664 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.9159207344055176
Epoch: 6, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.650 Vali Acc: 0.727 Test Loss: 0.650 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.192366361618042
Epoch: 7, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.693 Vali Acc: 0.693 Test Loss: 0.693 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.290732383728027
Epoch: 8, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.689 Vali Acc: 0.746 Test Loss: 0.689 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.6618449687957764
Epoch: 9, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.744 Vali Acc: 0.751 Test Loss: 0.744 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751212).  Saving model ...
Epoch: 10 cost time: 4.65132999420166
Epoch: 10, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.715 Vali Acc: 0.678 Test Loss: 0.715 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.620409965515137
Epoch: 11, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.791 Vali Acc: 0.712 Test Loss: 0.791 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.39777684211731
Epoch: 12, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.024 Vali Acc: 0.737 Test Loss: 1.024 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.460951566696167
Epoch: 13, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.944 Vali Acc: 0.620 Test Loss: 0.944 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.647010087966919
Epoch: 14, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.852 Vali Acc: 0.746 Test Loss: 0.852 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.168313503265381
Epoch: 15, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.878 Vali Acc: 0.620 Test Loss: 0.878 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.949324607849121
Epoch: 16, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.114 Vali Acc: 0.737 Test Loss: 1.114 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.860138177871704
Epoch: 17, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.013 Vali Acc: 0.717 Test Loss: 1.013 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.23893666267395
Epoch: 18, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.041 Vali Acc: 0.707 Test Loss: 1.041 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.9234776496887207
Epoch: 19, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.173 Vali Acc: 0.756 Test Loss: 1.173 Test Acc: 0.756
Validation loss decreased (-0.751212 --> -0.756086).  Saving model ...
Epoch: 20 cost time: 4.490260362625122
Epoch: 20, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.151 Vali Acc: 0.702 Test Loss: 1.151 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.056418418884277
Epoch: 21, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.233 Vali Acc: 0.707 Test Loss: 1.233 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.471179246902466
Epoch: 22, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.279 Vali Acc: 0.717 Test Loss: 1.279 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.53761625289917
Epoch: 23, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.355 Vali Acc: 0.707 Test Loss: 1.355 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.9683008193969727
Epoch: 24, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.406 Vali Acc: 0.678 Test Loss: 1.406 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.290088653564453
Epoch: 25, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.300 Vali Acc: 0.688 Test Loss: 1.300 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.9803617000579834
Epoch: 26, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.287 Vali Acc: 0.693 Test Loss: 1.287 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.635641574859619
Epoch: 27, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.447 Vali Acc: 0.688 Test Loss: 1.447 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.507188320159912
Epoch: 28, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.736 Vali Acc: 0.712 Test Loss: 1.736 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.712601661682129
Epoch: 29, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.793 Vali Acc: 0.707 Test Loss: 1.793 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 16168066
model size : 61.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.206189393997192
Epoch: 1, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.616 Vali Acc: 0.727 Test Loss: 0.616 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 3.7876014709472656
Epoch: 2, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.585 Vali Acc: 0.737 Test Loss: 0.585 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 3.953653335571289
Epoch: 3, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.597 Vali Acc: 0.741 Test Loss: 0.597 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741457).  Saving model ...
Epoch: 4 cost time: 3.161802053451538
Epoch: 4, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.536 Vali Acc: 0.737 Test Loss: 0.536 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9327945709228516
Epoch: 5, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.550 Vali Acc: 0.756 Test Loss: 0.550 Test Acc: 0.756
Validation loss decreased (-0.741457 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 3.8665201663970947
Epoch: 6, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.579 Vali Acc: 0.746 Test Loss: 0.579 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3741681575775146
Epoch: 7, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.588 Vali Acc: 0.746 Test Loss: 0.588 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2228550910949707
Epoch: 8, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.571 Vali Acc: 0.756 Test Loss: 0.571 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.8020124435424805
Epoch: 9, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.595 Vali Acc: 0.746 Test Loss: 0.595 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.8216447830200195
Epoch: 10, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.583 Vali Acc: 0.712 Test Loss: 0.583 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.6715831756591797
Epoch: 11, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.672 Vali Acc: 0.741 Test Loss: 0.672 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.6301960945129395
Epoch: 12, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.588 Vali Acc: 0.741 Test Loss: 0.588 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.788921356201172
Epoch: 13, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.590 Vali Acc: 0.746 Test Loss: 0.590 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.768705368041992
Epoch: 14, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.668 Vali Acc: 0.659 Test Loss: 0.668 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.993912696838379
Epoch: 15, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.801 Vali Acc: 0.751 Test Loss: 0.801 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 16138114
model size : 61.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.909311294555664
Epoch: 1, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.603 Vali Acc: 0.717 Test Loss: 0.603 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.350770950317383
Epoch: 2, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.560 Vali Acc: 0.741 Test Loss: 0.560 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 3.256220579147339
Epoch: 3, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.537 Vali Acc: 0.761 Test Loss: 0.537 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 3.750669002532959
Epoch: 4, Steps: 13 | Train Loss: 0.325 Vali Loss: 0.523 Vali Acc: 0.756 Test Loss: 0.523 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.737438678741455
Epoch: 5, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.528 Vali Acc: 0.746 Test Loss: 0.528 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0726568698883057
Epoch: 6, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.567 Vali Acc: 0.746 Test Loss: 0.567 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.0949409008026123
Epoch: 7, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.571 Vali Acc: 0.756 Test Loss: 0.571 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.408308982849121
Epoch: 8, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.545 Vali Acc: 0.746 Test Loss: 0.545 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.596351146697998
Epoch: 9, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.569 Vali Acc: 0.732 Test Loss: 0.569 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.7488603591918945
Epoch: 10, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.591 Vali Acc: 0.756 Test Loss: 0.591 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.655569076538086
Epoch: 11, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.598 Vali Acc: 0.707 Test Loss: 0.598 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.5983564853668213
Epoch: 12, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.661 Vali Acc: 0.732 Test Loss: 0.661 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.512701988220215
Epoch: 13, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.655 Vali Acc: 0.712 Test Loss: 0.655 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 16123842
model size : 61.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.848625183105469
Epoch: 1, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.581 Vali Acc: 0.722 Test Loss: 0.581 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.540681600570679
Epoch: 2, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.669 Vali Acc: 0.732 Test Loss: 0.669 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 4.198583602905273
Epoch: 3, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.572 Vali Acc: 0.722 Test Loss: 0.572 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.19343113899231
Epoch: 4, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.717 Vali Acc: 0.727 Test Loss: 0.717 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.373796463012695
Epoch: 5, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.746 Vali Acc: 0.732 Test Loss: 0.746 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.2114174365997314
Epoch: 6, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.787 Vali Acc: 0.722 Test Loss: 0.787 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.9778053760528564
Epoch: 7, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.783 Vali Acc: 0.732 Test Loss: 0.783 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.319248914718628
Epoch: 8, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.924 Vali Acc: 0.737 Test Loss: 0.924 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736576).  Saving model ...
Epoch: 9 cost time: 4.071223974227905
Epoch: 9, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.935 Vali Acc: 0.741 Test Loss: 0.935 Test Acc: 0.741
Validation loss decreased (-0.736576 --> -0.741454).  Saving model ...
Epoch: 10 cost time: 4.10986065864563
Epoch: 10, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.867 Vali Acc: 0.722 Test Loss: 0.867 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.161770343780518
Epoch: 11, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.029 Vali Acc: 0.732 Test Loss: 1.029 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.123695611953735
Epoch: 12, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.032 Vali Acc: 0.712 Test Loss: 1.032 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.245285511016846
Epoch: 13, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.236 Vali Acc: 0.712 Test Loss: 1.236 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.9529974460601807
Epoch: 14, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.257 Vali Acc: 0.707 Test Loss: 1.257 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.9062492847442627
Epoch: 15, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.327 Vali Acc: 0.727 Test Loss: 1.327 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.2079391479492188
Epoch: 16, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.263 Vali Acc: 0.717 Test Loss: 1.263 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.0847926139831543
Epoch: 17, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.337 Vali Acc: 0.722 Test Loss: 1.337 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.8928258419036865
Epoch: 18, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.616 Vali Acc: 0.722 Test Loss: 1.616 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.526307106018066
Epoch: 19, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.319 Vali Acc: 0.717 Test Loss: 1.319 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 5790594
model size : 22.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.7903900146484375
Epoch: 1, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.584 Vali Acc: 0.712 Test Loss: 0.584 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 3.332385301589966
Epoch: 2, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.559 Vali Acc: 0.732 Test Loss: 0.559 Test Acc: 0.732
Validation loss decreased (-0.712189 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 3.48368501663208
Epoch: 3, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.574 Vali Acc: 0.732 Test Loss: 0.574 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8791470527648926
Epoch: 4, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.616 Vali Acc: 0.727 Test Loss: 0.616 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6033689975738525
Epoch: 5, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.589 Vali Acc: 0.732 Test Loss: 0.589 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.807405948638916
Epoch: 6, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.665 Vali Acc: 0.746 Test Loss: 0.665 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746335).  Saving model ...
Epoch: 7 cost time: 3.2002596855163574
Epoch: 7, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.720 Vali Acc: 0.722 Test Loss: 0.720 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0500435829162598
Epoch: 8, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.755 Vali Acc: 0.732 Test Loss: 0.755 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1800477504730225
Epoch: 9, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.724 Vali Acc: 0.741 Test Loss: 0.724 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.1260905265808105
Epoch: 10, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.764 Vali Acc: 0.737 Test Loss: 0.764 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.2716073989868164
Epoch: 11, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.841 Vali Acc: 0.722 Test Loss: 0.841 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.4106967449188232
Epoch: 12, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.839 Vali Acc: 0.727 Test Loss: 0.839 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.43857479095459
Epoch: 13, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.900 Vali Acc: 0.693 Test Loss: 0.900 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.8870859146118164
Epoch: 14, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.933 Vali Acc: 0.717 Test Loss: 0.933 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.8446285724639893
Epoch: 15, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.001 Vali Acc: 0.717 Test Loss: 1.001 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.8183295726776123
Epoch: 16, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.115 Vali Acc: 0.727 Test Loss: 1.115 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 5665986
model size : 21.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.20626974105835
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.880192279815674
Epoch: 2, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.618 Vali Acc: 0.727 Test Loss: 0.618 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 2.8706295490264893
Epoch: 3, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.580 Vali Acc: 0.756 Test Loss: 0.580 Test Acc: 0.756
Validation loss decreased (-0.726823 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 2.9361205101013184
Epoch: 4, Steps: 13 | Train Loss: 0.335 Vali Loss: 0.551 Vali Acc: 0.751 Test Loss: 0.551 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7122082710266113
Epoch: 5, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.571 Vali Acc: 0.732 Test Loss: 0.571 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.695582628250122
Epoch: 6, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.590 Vali Acc: 0.737 Test Loss: 0.590 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.769704580307007
Epoch: 7, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.630 Vali Acc: 0.737 Test Loss: 0.630 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0512237548828125
Epoch: 8, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.613 Vali Acc: 0.707 Test Loss: 0.613 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.7851977348327637
Epoch: 9, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.669 Vali Acc: 0.732 Test Loss: 0.669 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.9380857944488525
Epoch: 10, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.697 Vali Acc: 0.717 Test Loss: 0.697 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.2245264053344727
Epoch: 11, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.718 Vali Acc: 0.693 Test Loss: 0.718 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.110344171524048
Epoch: 12, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.786 Vali Acc: 0.722 Test Loss: 0.786 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.932424545288086
Epoch: 13, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.879 Vali Acc: 0.732 Test Loss: 0.879 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 5627266
model size : 21.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.592679500579834
Epoch: 1, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.600 Vali Acc: 0.717 Test Loss: 0.600 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.4892148971557617
Epoch: 2, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.559 Vali Acc: 0.732 Test Loss: 0.559 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 2.239562749862671
Epoch: 3, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.542 Vali Acc: 0.766 Test Loss: 0.542 Test Acc: 0.766
Validation loss decreased (-0.731702 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 2.350269079208374
Epoch: 4, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.536 Vali Acc: 0.732 Test Loss: 0.536 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.621889114379883
Epoch: 5, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.547 Vali Acc: 0.737 Test Loss: 0.547 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.623816728591919
Epoch: 6, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.587 Vali Acc: 0.727 Test Loss: 0.587 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.684232473373413
Epoch: 7, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.589 Vali Acc: 0.727 Test Loss: 0.589 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.815051555633545
Epoch: 8, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.573 Vali Acc: 0.717 Test Loss: 0.573 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.9254491329193115
Epoch: 9, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.567 Vali Acc: 0.732 Test Loss: 0.567 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.7118005752563477
Epoch: 10, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.598 Vali Acc: 0.732 Test Loss: 0.598 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.841952323913574
Epoch: 11, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.685 Vali Acc: 0.722 Test Loss: 0.685 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.0546252727508545
Epoch: 12, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.608 Vali Acc: 0.722 Test Loss: 0.608 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.707780599594116
Epoch: 13, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.641 Vali Acc: 0.722 Test Loss: 0.641 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 5604162
model size : 21.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.616400718688965
Epoch: 1, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.613 Vali Acc: 0.722 Test Loss: 0.613 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.4540860652923584
Epoch: 2, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.569 Vali Acc: 0.727 Test Loss: 0.569 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 2.4243836402893066
Epoch: 3, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.571 Vali Acc: 0.737 Test Loss: 0.571 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 2.3970935344696045
Epoch: 4, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.565 Vali Acc: 0.737 Test Loss: 0.565 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 2.642777442932129
Epoch: 5, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.587 Vali Acc: 0.727 Test Loss: 0.587 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1323084831237793
Epoch: 6, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.582 Vali Acc: 0.712 Test Loss: 0.582 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1307153701782227
Epoch: 7, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.572 Vali Acc: 0.712 Test Loss: 0.572 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1882970333099365
Epoch: 8, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.595 Vali Acc: 0.717 Test Loss: 0.595 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1841318607330322
Epoch: 9, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.579 Vali Acc: 0.737 Test Loss: 0.579 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.031022548675537
Epoch: 10, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.641 Vali Acc: 0.732 Test Loss: 0.641 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9048130512237549
Epoch: 11, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.620 Vali Acc: 0.717 Test Loss: 0.620 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.332660436630249
Epoch: 12, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.670 Vali Acc: 0.727 Test Loss: 0.670 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.526806354522705
Epoch: 13, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.670 Vali Acc: 0.722 Test Loss: 0.670 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.5338969230651855
Epoch: 14, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.678 Vali Acc: 0.732 Test Loss: 0.678 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 5581378
model size : 21.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8350319862365723
Epoch: 1, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.621 Vali Acc: 0.727 Test Loss: 0.621 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 2.0958049297332764
Epoch: 2, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.568 Vali Acc: 0.717 Test Loss: 0.568 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2654526233673096
Epoch: 3, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.544 Vali Acc: 0.737 Test Loss: 0.544 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 1.9579827785491943
Epoch: 4, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.535 Vali Acc: 0.751 Test Loss: 0.535 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 1.6749515533447266
Epoch: 5, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.539 Vali Acc: 0.746 Test Loss: 0.539 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1619250774383545
Epoch: 6, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.538 Vali Acc: 0.741 Test Loss: 0.538 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.513026714324951
Epoch: 7, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.552 Vali Acc: 0.746 Test Loss: 0.552 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.531787157058716
Epoch: 8, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.555 Vali Acc: 0.737 Test Loss: 0.555 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.494983196258545
Epoch: 9, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.563 Vali Acc: 0.727 Test Loss: 0.563 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.5071399211883545
Epoch: 10, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.550 Vali Acc: 0.727 Test Loss: 0.550 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.5764918327331543
Epoch: 11, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.564 Vali Acc: 0.737 Test Loss: 0.564 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.7401461601257324
Epoch: 12, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.569 Vali Acc: 0.737 Test Loss: 0.569 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.655604839324951
Epoch: 13, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.570 Vali Acc: 0.722 Test Loss: 0.570 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.708864450454712
Epoch: 14, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.602 Vali Acc: 0.688 Test Loss: 0.602 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 5566402
model size : 21.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3892974853515625
Epoch: 1, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.655 Vali Acc: 0.707 Test Loss: 0.655 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 2.505747079849243
Epoch: 2, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.597 Vali Acc: 0.717 Test Loss: 0.597 Test Acc: 0.717
Validation loss decreased (-0.707311 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 2.4946930408477783
Epoch: 3, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.594 Vali Acc: 0.717 Test Loss: 0.594 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 4 cost time: 2.298844814300537
Epoch: 4, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.593 Vali Acc: 0.727 Test Loss: 0.593 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 5 cost time: 2.3604609966278076
Epoch: 5, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.575 Vali Acc: 0.727 Test Loss: 0.575 Test Acc: 0.727
Validation loss decreased (-0.726823 --> -0.726824).  Saving model ...
Epoch: 6 cost time: 1.984602689743042
Epoch: 6, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.608 Vali Acc: 0.727 Test Loss: 0.608 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0068600177764893
Epoch: 7, Steps: 13 | Train Loss: 0.284 Vali Loss: 0.619 Vali Acc: 0.727 Test Loss: 0.619 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9303274154663086
Epoch: 8, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.567 Vali Acc: 0.722 Test Loss: 0.567 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9905774593353271
Epoch: 9, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.610 Vali Acc: 0.737 Test Loss: 0.610 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736579).  Saving model ...
Epoch: 10 cost time: 2.466798782348633
Epoch: 10, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.629 Vali Acc: 0.737 Test Loss: 0.629 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3906891345977783
Epoch: 11, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.653 Vali Acc: 0.732 Test Loss: 0.653 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1416280269622803
Epoch: 12, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.675 Vali Acc: 0.732 Test Loss: 0.675 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8248522281646729
Epoch: 13, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.624 Vali Acc: 0.727 Test Loss: 0.624 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5473244190216064
Epoch: 14, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.700 Vali Acc: 0.737 Test Loss: 0.700 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.2808573246002197
Epoch: 15, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.719 Vali Acc: 0.741 Test Loss: 0.719 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741456).  Saving model ...
Epoch: 16 cost time: 2.2447221279144287
Epoch: 16, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.740 Vali Acc: 0.737 Test Loss: 0.740 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4365234375
Epoch: 17, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.664 Vali Acc: 0.727 Test Loss: 0.664 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.4564454555511475
Epoch: 18, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.649 Vali Acc: 0.741 Test Loss: 0.649 Test Acc: 0.741
Validation loss decreased (-0.741456 --> -0.741457).  Saving model ...
Epoch: 19 cost time: 2.2411210536956787
Epoch: 19, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.738 Vali Acc: 0.741 Test Loss: 0.738 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.200625419616699
Epoch: 20, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.731 Vali Acc: 0.732 Test Loss: 0.731 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9095609188079834
Epoch: 21, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.759 Vali Acc: 0.707 Test Loss: 0.759 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.1541969776153564
Epoch: 22, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.866 Vali Acc: 0.741 Test Loss: 0.866 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.378166437149048
Epoch: 23, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.995 Vali Acc: 0.722 Test Loss: 0.995 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.4242005348205566
Epoch: 24, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.967 Vali Acc: 0.717 Test Loss: 0.967 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.0612707138061523
Epoch: 25, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.076 Vali Acc: 0.712 Test Loss: 1.076 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7281649112701416
Epoch: 26, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.176 Vali Acc: 0.722 Test Loss: 1.176 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.7507498264312744
Epoch: 27, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.266 Vali Acc: 0.722 Test Loss: 1.266 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.5967633724212646
Epoch: 28, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.299 Vali Acc: 0.698 Test Loss: 1.299 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 5559266
model size : 21.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 21.399020671844482
Epoch: 1, Steps: 13 | Train Loss: 0.943 Vali Loss: 1.232 Vali Acc: 0.732 Test Loss: 1.232 Test Acc: 0.732
Validation loss decreased (inf --> -0.731695).  Saving model ...
Epoch: 2 cost time: 18.21978735923767
Epoch: 2, Steps: 13 | Train Loss: 0.606 Vali Loss: 1.406 Vali Acc: 0.512 Test Loss: 1.406 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.98019313812256
Epoch: 3, Steps: 13 | Train Loss: 0.454 Vali Loss: 1.365 Vali Acc: 0.673 Test Loss: 1.365 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.153598546981812
Epoch: 4, Steps: 13 | Train Loss: 0.899 Vali Loss: 2.226 Vali Acc: 0.741 Test Loss: 2.226 Test Acc: 0.741
Validation loss decreased (-0.731695 --> -0.741441).  Saving model ...
Epoch: 5 cost time: 19.159034729003906
Epoch: 5, Steps: 13 | Train Loss: 0.254 Vali Loss: 2.926 Vali Acc: 0.732 Test Loss: 2.926 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.769482612609863
Epoch: 6, Steps: 13 | Train Loss: 0.354 Vali Loss: 2.119 Vali Acc: 0.639 Test Loss: 2.119 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 15.576744079589844
Epoch: 7, Steps: 13 | Train Loss: 0.200 Vali Loss: 3.175 Vali Acc: 0.527 Test Loss: 3.175 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 20.313780069351196
Epoch: 8, Steps: 13 | Train Loss: 0.286 Vali Loss: 3.901 Vali Acc: 0.688 Test Loss: 3.901 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 20.73001194000244
Epoch: 9, Steps: 13 | Train Loss: 0.363 Vali Loss: 5.246 Vali Acc: 0.693 Test Loss: 5.246 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 16.98808455467224
Epoch: 10, Steps: 13 | Train Loss: 0.416 Vali Loss: 4.800 Vali Acc: 0.634 Test Loss: 4.800 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 19.680404901504517
Epoch: 11, Steps: 13 | Train Loss: 0.145 Vali Loss: 6.129 Vali Acc: 0.712 Test Loss: 6.129 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 18.093456029891968
Epoch: 12, Steps: 13 | Train Loss: 0.382 Vali Loss: 5.098 Vali Acc: 0.634 Test Loss: 5.098 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 17.77398180961609
Epoch: 13, Steps: 13 | Train Loss: 0.157 Vali Loss: 4.956 Vali Acc: 0.698 Test Loss: 4.956 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 18.361634016036987
Epoch: 14, Steps: 13 | Train Loss: 0.005 Vali Loss: 5.632 Vali Acc: 0.644 Test Loss: 5.632 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 42198530
model size : 161.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 12.554398536682129
Epoch: 1, Steps: 13 | Train Loss: 0.871 Vali Loss: 0.580 Vali Acc: 0.751 Test Loss: 0.580 Test Acc: 0.751
Validation loss decreased (inf --> -0.751214).  Saving model ...
Epoch: 2 cost time: 11.084779024124146
Epoch: 2, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.828 Vali Acc: 0.649 Test Loss: 0.828 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.208545446395874
Epoch: 3, Steps: 13 | Train Loss: 0.315 Vali Loss: 1.007 Vali Acc: 0.688 Test Loss: 1.007 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.50938081741333
Epoch: 4, Steps: 13 | Train Loss: 0.298 Vali Loss: 1.316 Vali Acc: 0.673 Test Loss: 1.316 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.933228969573975
Epoch: 5, Steps: 13 | Train Loss: 0.101 Vali Loss: 1.497 Vali Acc: 0.688 Test Loss: 1.497 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 10.963865518569946
Epoch: 6, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.764 Vali Acc: 0.663 Test Loss: 1.764 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 11.076300382614136
Epoch: 7, Steps: 13 | Train Loss: 0.175 Vali Loss: 1.770 Vali Acc: 0.698 Test Loss: 1.770 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 12.127100706100464
Epoch: 8, Steps: 13 | Train Loss: 0.225 Vali Loss: 3.111 Vali Acc: 0.698 Test Loss: 3.111 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.30459713935852
Epoch: 9, Steps: 13 | Train Loss: 0.073 Vali Loss: 2.242 Vali Acc: 0.649 Test Loss: 2.242 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 11.379135370254517
Epoch: 10, Steps: 13 | Train Loss: 0.088 Vali Loss: 3.422 Vali Acc: 0.751 Test Loss: 3.422 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 11.852064609527588
Epoch: 11, Steps: 13 | Train Loss: 0.119 Vali Loss: 2.779 Vali Acc: 0.654 Test Loss: 2.779 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 41232898
model size : 157.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.965075016021729
Epoch: 1, Steps: 13 | Train Loss: 0.788 Vali Loss: 0.670 Vali Acc: 0.727 Test Loss: 0.670 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 7.02776026725769
Epoch: 2, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.744 Vali Acc: 0.712 Test Loss: 0.744 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.22374153137207
Epoch: 3, Steps: 13 | Train Loss: 0.311 Vali Loss: 1.075 Vali Acc: 0.732 Test Loss: 1.075 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731697).  Saving model ...
Epoch: 4 cost time: 7.83617901802063
Epoch: 4, Steps: 13 | Train Loss: 0.208 Vali Loss: 1.414 Vali Acc: 0.512 Test Loss: 1.414 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.048051118850708
Epoch: 5, Steps: 13 | Train Loss: 0.373 Vali Loss: 1.229 Vali Acc: 0.668 Test Loss: 1.229 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.955545902252197
Epoch: 6, Steps: 13 | Train Loss: 0.177 Vali Loss: 2.023 Vali Acc: 0.751 Test Loss: 2.023 Test Acc: 0.751
Validation loss decreased (-0.731697 --> -0.751199).  Saving model ...
Epoch: 7 cost time: 7.531835317611694
Epoch: 7, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.744 Vali Acc: 0.668 Test Loss: 1.744 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.843684911727905
Epoch: 8, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.577 Vali Acc: 0.654 Test Loss: 1.577 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.465763330459595
Epoch: 9, Steps: 13 | Train Loss: 0.096 Vali Loss: 3.065 Vali Acc: 0.737 Test Loss: 3.065 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.647214889526367
Epoch: 10, Steps: 13 | Train Loss: 0.330 Vali Loss: 2.519 Vali Acc: 0.610 Test Loss: 2.519 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.7096967697143555
Epoch: 11, Steps: 13 | Train Loss: 0.080 Vali Loss: 4.685 Vali Acc: 0.698 Test Loss: 4.685 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.992123603820801
Epoch: 12, Steps: 13 | Train Loss: 0.053 Vali Loss: 2.847 Vali Acc: 0.610 Test Loss: 2.847 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.4255664348602295
Epoch: 13, Steps: 13 | Train Loss: 0.086 Vali Loss: 3.359 Vali Acc: 0.702 Test Loss: 3.359 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.694638967514038
Epoch: 14, Steps: 13 | Train Loss: 0.111 Vali Loss: 3.008 Vali Acc: 0.663 Test Loss: 3.008 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.010469675064087
Epoch: 15, Steps: 13 | Train Loss: 0.135 Vali Loss: 3.409 Vali Acc: 0.654 Test Loss: 3.409 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.783221006393433
Epoch: 16, Steps: 13 | Train Loss: 0.087 Vali Loss: 3.546 Vali Acc: 0.678 Test Loss: 3.546 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 40891906
model size : 156.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.148412466049194
Epoch: 1, Steps: 13 | Train Loss: 0.760 Vali Loss: 0.625 Vali Acc: 0.756 Test Loss: 0.625 Test Acc: 0.756
Validation loss decreased (inf --> -0.756091).  Saving model ...
Epoch: 2 cost time: 6.6077141761779785
Epoch: 2, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.664 Vali Acc: 0.751 Test Loss: 0.664 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.19937801361084
Epoch: 3, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.042 Vali Acc: 0.498 Test Loss: 1.042 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.736907005310059
Epoch: 4, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.841 Vali Acc: 0.698 Test Loss: 0.841 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.686781883239746
Epoch: 5, Steps: 13 | Train Loss: 0.213 Vali Loss: 1.492 Vali Acc: 0.737 Test Loss: 1.492 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.789197206497192
Epoch: 6, Steps: 13 | Train Loss: 0.062 Vali Loss: 1.375 Vali Acc: 0.722 Test Loss: 1.375 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.363178491592407
Epoch: 7, Steps: 13 | Train Loss: 0.148 Vali Loss: 1.593 Vali Acc: 0.571 Test Loss: 1.593 Test Acc: 0.571
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.570194244384766
Epoch: 8, Steps: 13 | Train Loss: 0.132 Vali Loss: 2.976 Vali Acc: 0.712 Test Loss: 2.976 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.532647609710693
Epoch: 9, Steps: 13 | Train Loss: 0.121 Vali Loss: 1.916 Vali Acc: 0.629 Test Loss: 1.916 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.641986608505249
Epoch: 10, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.692 Vali Acc: 0.732 Test Loss: 1.692 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.486571550369263
Epoch: 11, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.594 Vali Acc: 0.620 Test Loss: 1.594 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 40707074
model size : 155.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.760181188583374
Epoch: 1, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.550 Vali Acc: 0.751 Test Loss: 0.550 Test Acc: 0.751
Validation loss decreased (inf --> -0.751214).  Saving model ...
Epoch: 2 cost time: 4.7814319133758545
Epoch: 2, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.669 Vali Acc: 0.654 Test Loss: 0.669 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.8516576290130615
Epoch: 3, Steps: 13 | Train Loss: 0.205 Vali Loss: 1.175 Vali Acc: 0.722 Test Loss: 1.175 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.2233970165252686
Epoch: 4, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.713 Vali Acc: 0.707 Test Loss: 0.713 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.230876684188843
Epoch: 5, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.836 Vali Acc: 0.668 Test Loss: 0.836 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.485297203063965
Epoch: 6, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.996 Vali Acc: 0.688 Test Loss: 0.996 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.738058805465698
Epoch: 7, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.152 Vali Acc: 0.737 Test Loss: 1.152 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.10706353187561
Epoch: 8, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.088 Vali Acc: 0.659 Test Loss: 1.088 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.966670274734497
Epoch: 9, Steps: 13 | Train Loss: 0.048 Vali Loss: 1.181 Vali Acc: 0.678 Test Loss: 1.181 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.154235363006592
Epoch: 10, Steps: 13 | Train Loss: 0.036 Vali Loss: 2.846 Vali Acc: 0.737 Test Loss: 2.846 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.12285041809082
Epoch: 11, Steps: 13 | Train Loss: 0.231 Vali Loss: 1.345 Vali Acc: 0.629 Test Loss: 1.345 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 40524802
model size : 154.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.6256914138793945
Epoch: 1, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.674 Vali Acc: 0.732 Test Loss: 0.674 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 5.9603800773620605
Epoch: 2, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.609 Vali Acc: 0.741 Test Loss: 0.609 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 6.018032550811768
Epoch: 3, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.849 Vali Acc: 0.732 Test Loss: 0.849 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.2312891483306885
Epoch: 4, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.714 Vali Acc: 0.732 Test Loss: 0.714 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.406533718109131
Epoch: 5, Steps: 13 | Train Loss: 0.117 Vali Loss: 2.214 Vali Acc: 0.751 Test Loss: 2.214 Test Acc: 0.751
Validation loss decreased (-0.741457 --> -0.751197).  Saving model ...
Epoch: 6 cost time: 6.10863471031189
Epoch: 6, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.784 Vali Acc: 0.717 Test Loss: 0.784 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.0845537185668945
Epoch: 7, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.869 Vali Acc: 0.722 Test Loss: 0.869 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.512492656707764
Epoch: 8, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.766 Vali Acc: 0.693 Test Loss: 0.766 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.367663621902466
Epoch: 9, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.926 Vali Acc: 0.761 Test Loss: 0.926 Test Acc: 0.761
Validation loss decreased (-0.751197 --> -0.760966).  Saving model ...
Epoch: 10 cost time: 5.749383926391602
Epoch: 10, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.894 Vali Acc: 0.654 Test Loss: 0.894 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.242404460906982
Epoch: 11, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.340 Vali Acc: 0.751 Test Loss: 1.340 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.779253721237183
Epoch: 12, Steps: 13 | Train Loss: 0.092 Vali Loss: 1.099 Vali Acc: 0.683 Test Loss: 1.099 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.2403833866119385
Epoch: 13, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.098 Vali Acc: 0.717 Test Loss: 1.098 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.24255895614624
Epoch: 14, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.234 Vali Acc: 0.712 Test Loss: 1.234 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.7271246910095215
Epoch: 15, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.183 Vali Acc: 0.654 Test Loss: 1.183 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.716372013092041
Epoch: 16, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.491 Vali Acc: 0.688 Test Loss: 1.491 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.0900819301605225
Epoch: 17, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.458 Vali Acc: 0.644 Test Loss: 1.458 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.486905097961426
Epoch: 18, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.637 Vali Acc: 0.693 Test Loss: 1.637 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.9296205043792725
Epoch: 19, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.396 Vali Acc: 0.620 Test Loss: 1.396 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 40404994
model size : 154.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.501592397689819
Epoch: 1, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.595 Vali Acc: 0.727 Test Loss: 0.595 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 5.472200155258179
Epoch: 2, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.588 Vali Acc: 0.732 Test Loss: 0.588 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 5.747803211212158
Epoch: 3, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.864 Vali Acc: 0.668 Test Loss: 0.864 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.9334399700164795
Epoch: 4, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.652 Vali Acc: 0.746 Test Loss: 0.652 Test Acc: 0.746
Validation loss decreased (-0.731701 --> -0.746335).  Saving model ...
Epoch: 5 cost time: 5.410793781280518
Epoch: 5, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.904 Vali Acc: 0.751 Test Loss: 0.904 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751210).  Saving model ...
Epoch: 6 cost time: 3.8800716400146484
Epoch: 6, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.742 Vali Acc: 0.654 Test Loss: 0.742 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.812277793884277
Epoch: 7, Steps: 13 | Train Loss: 0.088 Vali Loss: 1.113 Vali Acc: 0.746 Test Loss: 1.113 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.4222025871276855
Epoch: 8, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.799 Vali Acc: 0.732 Test Loss: 0.799 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.974285840988159
Epoch: 9, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.882 Vali Acc: 0.673 Test Loss: 0.882 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.676781177520752
Epoch: 10, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.962 Vali Acc: 0.766 Test Loss: 0.962 Test Acc: 0.766
Validation loss decreased (-0.751210 --> -0.765844).  Saving model ...
Epoch: 11 cost time: 5.164976119995117
Epoch: 11, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.997 Vali Acc: 0.712 Test Loss: 0.997 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.039548397064209
Epoch: 12, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.088 Vali Acc: 0.717 Test Loss: 1.088 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.040237665176392
Epoch: 13, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.217 Vali Acc: 0.727 Test Loss: 1.217 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.587066888809204
Epoch: 14, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.203 Vali Acc: 0.654 Test Loss: 1.203 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.6466357707977295
Epoch: 15, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.195 Vali Acc: 0.712 Test Loss: 1.195 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.068502187728882
Epoch: 16, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.190 Vali Acc: 0.717 Test Loss: 1.190 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.790651321411133
Epoch: 17, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.262 Vali Acc: 0.698 Test Loss: 1.262 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.803386211395264
Epoch: 18, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.237 Vali Acc: 0.722 Test Loss: 1.237 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.633558750152588
Epoch: 19, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.226 Vali Acc: 0.732 Test Loss: 1.226 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.216125965118408
Epoch: 20, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.325 Vali Acc: 0.732 Test Loss: 1.325 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 40347906
model size : 154.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 13.617128610610962
Epoch: 1, Steps: 13 | Train Loss: 0.793 Vali Loss: 0.574 Vali Acc: 0.751 Test Loss: 0.574 Test Acc: 0.751
Validation loss decreased (inf --> -0.751214).  Saving model ...
Epoch: 2 cost time: 12.31708550453186
Epoch: 2, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.818 Vali Acc: 0.727 Test Loss: 0.818 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.791638374328613
Epoch: 3, Steps: 13 | Train Loss: 0.322 Vali Loss: 1.244 Vali Acc: 0.722 Test Loss: 1.244 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.435381650924683
Epoch: 4, Steps: 13 | Train Loss: 0.100 Vali Loss: 1.232 Vali Acc: 0.717 Test Loss: 1.232 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.48848557472229
Epoch: 5, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.258 Vali Acc: 0.727 Test Loss: 1.258 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.18515419960022
Epoch: 6, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.768 Vali Acc: 0.629 Test Loss: 1.768 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 12.414048671722412
Epoch: 7, Steps: 13 | Train Loss: 0.070 Vali Loss: 1.717 Vali Acc: 0.693 Test Loss: 1.717 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 11.841046571731567
Epoch: 8, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.992 Vali Acc: 0.688 Test Loss: 1.992 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 11.263227939605713
Epoch: 9, Steps: 13 | Train Loss: 0.009 Vali Loss: 2.073 Vali Acc: 0.722 Test Loss: 2.073 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 12.254157066345215
Epoch: 10, Steps: 13 | Train Loss: 0.062 Vali Loss: 2.382 Vali Acc: 0.502 Test Loss: 2.382 Test Acc: 0.502
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 11.933629274368286
Epoch: 11, Steps: 13 | Train Loss: 0.116 Vali Loss: 2.712 Vali Acc: 0.683 Test Loss: 2.712 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 13103874
model size : 50.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.892464637756348
Epoch: 1, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.777 Vali Acc: 0.756 Test Loss: 0.777 Test Acc: 0.756
Validation loss decreased (inf --> -0.756090).  Saving model ...
Epoch: 2 cost time: 6.264140605926514
Epoch: 2, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.756 Vali Acc: 0.634 Test Loss: 0.756 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.3441996574401855
Epoch: 3, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.866 Vali Acc: 0.702 Test Loss: 0.866 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.436713695526123
Epoch: 4, Steps: 13 | Train Loss: 0.072 Vali Loss: 1.043 Vali Acc: 0.732 Test Loss: 1.043 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.980057954788208
Epoch: 5, Steps: 13 | Train Loss: 0.071 Vali Loss: 1.127 Vali Acc: 0.712 Test Loss: 1.127 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.39273476600647
Epoch: 6, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.197 Vali Acc: 0.737 Test Loss: 1.197 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.108153820037842
Epoch: 7, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.345 Vali Acc: 0.693 Test Loss: 1.345 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.8160505294799805
Epoch: 8, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.480 Vali Acc: 0.688 Test Loss: 1.480 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.547499418258667
Epoch: 9, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.376 Vali Acc: 0.678 Test Loss: 1.376 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.550994634628296
Epoch: 10, Steps: 13 | Train Loss: 0.013 Vali Loss: 2.703 Vali Acc: 0.737 Test Loss: 2.703 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.389150381088257
Epoch: 11, Steps: 13 | Train Loss: 0.422 Vali Loss: 1.876 Vali Acc: 0.629 Test Loss: 1.876 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 12621058
model size : 48.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.61318826675415
Epoch: 1, Steps: 13 | Train Loss: 0.754 Vali Loss: 0.579 Vali Acc: 0.732 Test Loss: 0.579 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 5.569052457809448
Epoch: 2, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.672 Vali Acc: 0.732 Test Loss: 0.672 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.799981117248535
Epoch: 3, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.667 Vali Acc: 0.693 Test Loss: 0.667 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.305106163024902
Epoch: 4, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.799 Vali Acc: 0.644 Test Loss: 0.799 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.258269786834717
Epoch: 5, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.978 Vali Acc: 0.615 Test Loss: 0.978 Test Acc: 0.615
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.088412761688232
Epoch: 6, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.878 Vali Acc: 0.644 Test Loss: 0.878 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.689950466156006
Epoch: 7, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.930 Vali Acc: 0.688 Test Loss: 0.930 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.0232203006744385
Epoch: 8, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.040 Vali Acc: 0.732 Test Loss: 1.040 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.92165207862854
Epoch: 9, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.292 Vali Acc: 0.702 Test Loss: 1.292 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.539230585098267
Epoch: 10, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.076 Vali Acc: 0.659 Test Loss: 1.076 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.080538034439087
Epoch: 11, Steps: 13 | Train Loss: 0.080 Vali Loss: 2.537 Vali Acc: 0.741 Test Loss: 2.537 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741438).  Saving model ...
Epoch: 12 cost time: 5.094017505645752
Epoch: 12, Steps: 13 | Train Loss: 0.091 Vali Loss: 1.651 Vali Acc: 0.566 Test Loss: 1.651 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.626258134841919
Epoch: 13, Steps: 13 | Train Loss: 0.141 Vali Loss: 1.551 Vali Acc: 0.698 Test Loss: 1.551 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.041310787200928
Epoch: 14, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.560 Vali Acc: 0.634 Test Loss: 1.560 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.7867817878723145
Epoch: 15, Steps: 13 | Train Loss: 0.018 Vali Loss: 2.219 Vali Acc: 0.712 Test Loss: 2.219 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.916761636734009
Epoch: 16, Steps: 13 | Train Loss: 0.008 Vali Loss: 2.218 Vali Acc: 0.702 Test Loss: 2.218 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.9580085277557373
Epoch: 17, Steps: 13 | Train Loss: 0.007 Vali Loss: 2.161 Vali Acc: 0.663 Test Loss: 2.161 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.828602075576782
Epoch: 18, Steps: 13 | Train Loss: 0.005 Vali Loss: 2.013 Vali Acc: 0.707 Test Loss: 2.013 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.948076963424683
Epoch: 19, Steps: 13 | Train Loss: 0.005 Vali Loss: 2.046 Vali Acc: 0.702 Test Loss: 2.046 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.886638641357422
Epoch: 20, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.063 Vali Acc: 0.712 Test Loss: 2.063 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.561612844467163
Epoch: 21, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.275 Vali Acc: 0.717 Test Loss: 2.275 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 12450562
model size : 47.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.104809045791626
Epoch: 1, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.573 Vali Acc: 0.751 Test Loss: 0.573 Test Acc: 0.751
Validation loss decreased (inf --> -0.751214).  Saving model ...
Epoch: 2 cost time: 3.5131704807281494
Epoch: 2, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.559 Vali Acc: 0.727 Test Loss: 0.559 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5410401821136475
Epoch: 3, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.839 Vali Acc: 0.732 Test Loss: 0.839 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.427360773086548
Epoch: 4, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.766 Vali Acc: 0.610 Test Loss: 0.766 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.744013547897339
Epoch: 5, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.724 Vali Acc: 0.698 Test Loss: 0.724 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.4211668968200684
Epoch: 6, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.788 Vali Acc: 0.693 Test Loss: 0.788 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.3094284534454346
Epoch: 7, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.873 Vali Acc: 0.649 Test Loss: 0.873 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.695998430252075
Epoch: 8, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.948 Vali Acc: 0.732 Test Loss: 0.948 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.742891550064087
Epoch: 9, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.886 Vali Acc: 0.663 Test Loss: 0.886 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.621305465698242
Epoch: 10, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.029 Vali Acc: 0.678 Test Loss: 1.029 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.5719878673553467
Epoch: 11, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.551 Vali Acc: 0.737 Test Loss: 1.551 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 12358146
model size : 47.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.0765159130096436
Epoch: 1, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.596 Vali Acc: 0.727 Test Loss: 0.596 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 3.0050337314605713
Epoch: 2, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.636 Vali Acc: 0.751 Test Loss: 0.636 Test Acc: 0.751
Validation loss decreased (-0.726823 --> -0.751213).  Saving model ...
Epoch: 3 cost time: 3.1668694019317627
Epoch: 3, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.603 Vali Acc: 0.698 Test Loss: 0.603 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.254619836807251
Epoch: 4, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.756 Vali Acc: 0.746 Test Loss: 0.756 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0122017860412598
Epoch: 5, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.742 Vali Acc: 0.673 Test Loss: 0.742 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.373741865158081
Epoch: 6, Steps: 13 | Train Loss: 0.075 Vali Loss: 1.013 Vali Acc: 0.722 Test Loss: 1.013 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.2041573524475098
Epoch: 7, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.850 Vali Acc: 0.722 Test Loss: 0.850 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.030111074447632
Epoch: 8, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.787 Vali Acc: 0.673 Test Loss: 0.787 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.3919694423675537
Epoch: 9, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.926 Vali Acc: 0.737 Test Loss: 0.926 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.446930170059204
Epoch: 10, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.145 Vali Acc: 0.688 Test Loss: 1.145 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.3839657306671143
Epoch: 11, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.965 Vali Acc: 0.659 Test Loss: 0.965 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.3287622928619385
Epoch: 12, Steps: 13 | Train Loss: 0.061 Vali Loss: 2.114 Vali Acc: 0.741 Test Loss: 2.114 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 12267010
model size : 46.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.20889687538147
Epoch: 1, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.578 Vali Acc: 0.727 Test Loss: 0.578 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 3.1745481491088867
Epoch: 2, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.549 Vali Acc: 0.741 Test Loss: 0.549 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 2.846388816833496
Epoch: 3, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.615 Vali Acc: 0.678 Test Loss: 0.615 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9858901500701904
Epoch: 4, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.776 Vali Acc: 0.727 Test Loss: 0.776 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.7217111587524414
Epoch: 5, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.809 Vali Acc: 0.663 Test Loss: 0.809 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.844255208969116
Epoch: 6, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.865 Vali Acc: 0.732 Test Loss: 0.865 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.827454090118408
Epoch: 7, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.846 Vali Acc: 0.698 Test Loss: 0.846 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.6333861351013184
Epoch: 8, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.773 Vali Acc: 0.688 Test Loss: 0.773 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.463243246078491
Epoch: 9, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.946 Vali Acc: 0.741 Test Loss: 0.946 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.0769660472869873
Epoch: 10, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.966 Vali Acc: 0.649 Test Loss: 0.966 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.3117494583129883
Epoch: 11, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.125 Vali Acc: 0.737 Test Loss: 1.125 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.0365898609161377
Epoch: 12, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.088 Vali Acc: 0.688 Test Loss: 1.088 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 12207106
model size : 46.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.884547472000122
Epoch: 1, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.642 Vali Acc: 0.746 Test Loss: 0.642 Test Acc: 0.746
Validation loss decreased (inf --> -0.746335).  Saving model ...
Epoch: 2 cost time: 2.390033483505249
Epoch: 2, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.647 Vali Acc: 0.751 Test Loss: 0.647 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751213).  Saving model ...
Epoch: 3 cost time: 2.2829856872558594
Epoch: 3, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.690 Vali Acc: 0.751 Test Loss: 0.690 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.372783899307251
Epoch: 4, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.712 Vali Acc: 0.732 Test Loss: 0.712 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.556638240814209
Epoch: 5, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.678 Vali Acc: 0.751 Test Loss: 0.678 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.808948278427124
Epoch: 6, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.713 Vali Acc: 0.746 Test Loss: 0.713 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.7943451404571533
Epoch: 7, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.888 Vali Acc: 0.717 Test Loss: 0.888 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.315847635269165
Epoch: 8, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.660 Vali Acc: 0.737 Test Loss: 0.660 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.392258644104004
Epoch: 9, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.735 Vali Acc: 0.741 Test Loss: 0.735 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.6344001293182373
Epoch: 10, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.807 Vali Acc: 0.702 Test Loss: 0.807 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.0371222496032715
Epoch: 11, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.775 Vali Acc: 0.707 Test Loss: 0.775 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.8186352252960205
Epoch: 12, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.772 Vali Acc: 0.737 Test Loss: 0.772 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 12178562
model size : 46.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.744967460632324
Epoch: 1, Steps: 13 | Train Loss: 0.767 Vali Loss: 0.563 Vali Acc: 0.741 Test Loss: 0.563 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 4.305583238601685
Epoch: 2, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.586 Vali Acc: 0.722 Test Loss: 0.586 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8905043601989746
Epoch: 3, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.686 Vali Acc: 0.712 Test Loss: 0.686 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.9404234886169434
Epoch: 4, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.827 Vali Acc: 0.737 Test Loss: 0.827 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.4422760009765625
Epoch: 5, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.891 Vali Acc: 0.732 Test Loss: 0.891 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.414706707000732
Epoch: 6, Steps: 13 | Train Loss: 0.091 Vali Loss: 1.075 Vali Acc: 0.659 Test Loss: 1.075 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.5621089935302734
Epoch: 7, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.943 Vali Acc: 0.668 Test Loss: 0.943 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.539624452590942
Epoch: 8, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.717 Vali Acc: 0.746 Test Loss: 1.717 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746324).  Saving model ...
Epoch: 9 cost time: 4.38115930557251
Epoch: 9, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.969 Vali Acc: 0.683 Test Loss: 0.969 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.60765528678894
Epoch: 10, Steps: 13 | Train Loss: 0.133 Vali Loss: 1.881 Vali Acc: 0.722 Test Loss: 1.881 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.037747859954834
Epoch: 11, Steps: 13 | Train Loss: 0.201 Vali Loss: 1.434 Vali Acc: 0.698 Test Loss: 1.434 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.042487621307373
Epoch: 12, Steps: 13 | Train Loss: 0.213 Vali Loss: 1.679 Vali Acc: 0.698 Test Loss: 1.679 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.983572483062744
Epoch: 13, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.531 Vali Acc: 0.707 Test Loss: 1.531 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.473317384719849
Epoch: 14, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.724 Vali Acc: 0.712 Test Loss: 1.724 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.373625755310059
Epoch: 15, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.539 Vali Acc: 0.688 Test Loss: 1.539 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.6689233779907227
Epoch: 16, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.485 Vali Acc: 0.722 Test Loss: 1.485 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.711911916732788
Epoch: 17, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.663 Vali Acc: 0.702 Test Loss: 1.663 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.7273802757263184
Epoch: 18, Steps: 13 | Train Loss: 0.027 Vali Loss: 2.257 Vali Acc: 0.702 Test Loss: 2.257 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 4553090
model size : 17.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.430253982543945
Epoch: 1, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.612 Vali Acc: 0.732 Test Loss: 0.612 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 3.5381767749786377
Epoch: 2, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.587 Vali Acc: 0.727 Test Loss: 0.587 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.387537956237793
Epoch: 3, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.709 Vali Acc: 0.737 Test Loss: 0.709 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736578).  Saving model ...
Epoch: 4 cost time: 3.1232075691223145
Epoch: 4, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.826 Vali Acc: 0.741 Test Loss: 0.826 Test Acc: 0.741
Validation loss decreased (-0.736578 --> -0.741455).  Saving model ...
Epoch: 5 cost time: 3.1208572387695312
Epoch: 5, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.919 Vali Acc: 0.605 Test Loss: 0.919 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.979678153991699
Epoch: 6, Steps: 13 | Train Loss: 0.107 Vali Loss: 1.091 Vali Acc: 0.741 Test Loss: 1.091 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0797526836395264
Epoch: 7, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.134 Vali Acc: 0.712 Test Loss: 1.134 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.2305212020874023
Epoch: 8, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.194 Vali Acc: 0.698 Test Loss: 1.194 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.3890042304992676
Epoch: 9, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.108 Vali Acc: 0.737 Test Loss: 1.108 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.5301249027252197
Epoch: 10, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.131 Vali Acc: 0.727 Test Loss: 1.131 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.572876214981079
Epoch: 11, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.058 Vali Acc: 0.702 Test Loss: 1.058 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.7629315853118896
Epoch: 12, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.378 Vali Acc: 0.722 Test Loss: 1.378 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.944124698638916
Epoch: 13, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.520 Vali Acc: 0.722 Test Loss: 1.520 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.279942274093628
Epoch: 14, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.430 Vali Acc: 0.698 Test Loss: 1.430 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 4311682
model size : 16.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.500509262084961
Epoch: 1, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.632 Vali Acc: 0.727 Test Loss: 0.632 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 2.558493137359619
Epoch: 2, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.573 Vali Acc: 0.746 Test Loss: 0.573 Test Acc: 0.746
Validation loss decreased (-0.726823 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 2.9891092777252197
Epoch: 3, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.646 Vali Acc: 0.732 Test Loss: 0.646 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.883760690689087
Epoch: 4, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.834 Vali Acc: 0.673 Test Loss: 0.834 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0476365089416504
Epoch: 5, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.657 Vali Acc: 0.722 Test Loss: 0.657 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.954479932785034
Epoch: 6, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.818 Vali Acc: 0.688 Test Loss: 0.818 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.1831746101379395
Epoch: 7, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.836 Vali Acc: 0.722 Test Loss: 0.836 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.686354160308838
Epoch: 8, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.826 Vali Acc: 0.707 Test Loss: 0.826 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.691739559173584
Epoch: 9, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.825 Vali Acc: 0.717 Test Loss: 0.825 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.5923831462860107
Epoch: 10, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.931 Vali Acc: 0.732 Test Loss: 0.931 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.5627002716064453
Epoch: 11, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.963 Vali Acc: 0.688 Test Loss: 0.963 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.6551342010498047
Epoch: 12, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.907 Vali Acc: 0.722 Test Loss: 0.907 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 4226434
model size : 16.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3314645290374756
Epoch: 1, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.597 Vali Acc: 0.756 Test Loss: 0.597 Test Acc: 0.756
Validation loss decreased (inf --> -0.756092).  Saving model ...
Epoch: 2 cost time: 2.4080750942230225
Epoch: 2, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.582 Vali Acc: 0.737 Test Loss: 0.582 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6680939197540283
Epoch: 3, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.670 Vali Acc: 0.741 Test Loss: 0.670 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.675724506378174
Epoch: 4, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.767 Vali Acc: 0.732 Test Loss: 0.767 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5250942707061768
Epoch: 5, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.654 Vali Acc: 0.727 Test Loss: 0.654 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.221139907836914
Epoch: 6, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.751 Vali Acc: 0.693 Test Loss: 0.751 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.4059176445007324
Epoch: 7, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.776 Vali Acc: 0.712 Test Loss: 0.776 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.2947468757629395
Epoch: 8, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.732 Vali Acc: 0.707 Test Loss: 0.732 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.6834990978240967
Epoch: 9, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.766 Vali Acc: 0.712 Test Loss: 0.766 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.2759952545166016
Epoch: 10, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.799 Vali Acc: 0.702 Test Loss: 0.799 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.064530611038208
Epoch: 11, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.807 Vali Acc: 0.727 Test Loss: 0.807 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 4180226
model size : 16.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1731619834899902
Epoch: 1, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.594 Vali Acc: 0.732 Test Loss: 0.594 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 2.0675203800201416
Epoch: 2, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.672 Vali Acc: 0.732 Test Loss: 0.672 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.062990427017212
Epoch: 3, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.574 Vali Acc: 0.741 Test Loss: 0.574 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 2.091177225112915
Epoch: 4, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.561 Vali Acc: 0.741 Test Loss: 0.561 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 2.1704421043395996
Epoch: 5, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.603 Vali Acc: 0.746 Test Loss: 0.603 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746335).  Saving model ...
Epoch: 6 cost time: 2.1274397373199463
Epoch: 6, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.586 Vali Acc: 0.737 Test Loss: 0.586 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7011933326721191
Epoch: 7, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.610 Vali Acc: 0.756 Test Loss: 0.610 Test Acc: 0.756
Validation loss decreased (-0.746335 --> -0.756091).  Saving model ...
Epoch: 8 cost time: 1.9146544933319092
Epoch: 8, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.595 Vali Acc: 0.732 Test Loss: 0.595 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.054764986038208
Epoch: 9, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.592 Vali Acc: 0.761 Test Loss: 0.592 Test Acc: 0.761
Validation loss decreased (-0.756091 --> -0.760970).  Saving model ...
Epoch: 10 cost time: 2.238605260848999
Epoch: 10, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.779 Vali Acc: 0.761 Test Loss: 0.779 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1740105152130127
Epoch: 11, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.775 Vali Acc: 0.668 Test Loss: 0.775 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.280510187149048
Epoch: 12, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.781 Vali Acc: 0.741 Test Loss: 0.781 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.0454483032226562
Epoch: 13, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.709 Vali Acc: 0.688 Test Loss: 0.709 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.128084421157837
Epoch: 14, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.800 Vali Acc: 0.756 Test Loss: 0.800 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.0164620876312256
Epoch: 15, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.832 Vali Acc: 0.756 Test Loss: 0.832 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.136857032775879
Epoch: 16, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.882 Vali Acc: 0.732 Test Loss: 0.882 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.2498133182525635
Epoch: 17, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.934 Vali Acc: 0.732 Test Loss: 0.934 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.388380289077759
Epoch: 18, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.983 Vali Acc: 0.693 Test Loss: 0.983 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.3176846504211426
Epoch: 19, Steps: 13 | Train Loss: 0.017 Vali Loss: 0.985 Vali Acc: 0.737 Test Loss: 0.985 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 4134658
model size : 15.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.901125431060791
Epoch: 1, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.609 Vali Acc: 0.727 Test Loss: 0.609 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 2.2766010761260986
Epoch: 2, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.569 Vali Acc: 0.761 Test Loss: 0.569 Test Acc: 0.761
Validation loss decreased (-0.726823 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 1.895064353942871
Epoch: 3, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.562 Vali Acc: 0.780 Test Loss: 0.562 Test Acc: 0.780
Validation loss decreased (-0.760970 --> -0.780482).  Saving model ...
Epoch: 4 cost time: 1.9795196056365967
Epoch: 4, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.634 Vali Acc: 0.776 Test Loss: 0.634 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9249680042266846
Epoch: 5, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.774 Vali Acc: 0.756 Test Loss: 0.774 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1498591899871826
Epoch: 6, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.646 Vali Acc: 0.761 Test Loss: 0.646 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0418753623962402
Epoch: 7, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.568 Vali Acc: 0.737 Test Loss: 0.568 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9567749500274658
Epoch: 8, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.560 Vali Acc: 0.756 Test Loss: 0.560 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9004323482513428
Epoch: 9, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.557 Vali Acc: 0.766 Test Loss: 0.557 Test Acc: 0.766
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.275273561477661
Epoch: 10, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.586 Vali Acc: 0.746 Test Loss: 0.586 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.053851366043091
Epoch: 11, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.657 Vali Acc: 0.761 Test Loss: 0.657 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.209293842315674
Epoch: 12, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.588 Vali Acc: 0.761 Test Loss: 0.588 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.9446418285369873
Epoch: 13, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.590 Vali Acc: 0.746 Test Loss: 0.590 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 4104706
model size : 15.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7161600589752197
Epoch: 1, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.625 Vali Acc: 0.737 Test Loss: 0.625 Test Acc: 0.737
Validation loss decreased (inf --> -0.736579).  Saving model ...
Epoch: 2 cost time: 2.0599610805511475
Epoch: 2, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.592 Vali Acc: 0.741 Test Loss: 0.592 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 1.8566250801086426
Epoch: 3, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.572 Vali Acc: 0.746 Test Loss: 0.572 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 2.01525616645813
Epoch: 4, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.599 Vali Acc: 0.756 Test Loss: 0.599 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 1.9623134136199951
Epoch: 5, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.575 Vali Acc: 0.746 Test Loss: 0.575 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.625622272491455
Epoch: 6, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.600 Vali Acc: 0.751 Test Loss: 0.600 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.716184377670288
Epoch: 7, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.636 Vali Acc: 0.756 Test Loss: 0.636 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8116357326507568
Epoch: 8, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.669 Vali Acc: 0.756 Test Loss: 0.669 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0756232738494873
Epoch: 9, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.598 Vali Acc: 0.732 Test Loss: 0.598 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.915797233581543
Epoch: 10, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.595 Vali Acc: 0.732 Test Loss: 0.595 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9780771732330322
Epoch: 11, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.577 Vali Acc: 0.746 Test Loss: 0.577 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9222497940063477
Epoch: 12, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.669 Vali Acc: 0.761 Test Loss: 0.669 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760969).  Saving model ...
Epoch: 13 cost time: 2.165842056274414
Epoch: 13, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.689 Vali Acc: 0.746 Test Loss: 0.689 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5930616855621338
Epoch: 14, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.632 Vali Acc: 0.741 Test Loss: 0.632 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7536156177520752
Epoch: 15, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.642 Vali Acc: 0.741 Test Loss: 0.642 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0178027153015137
Epoch: 16, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.646 Vali Acc: 0.717 Test Loss: 0.646 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8765041828155518
Epoch: 17, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.705 Vali Acc: 0.756 Test Loss: 0.705 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9724416732788086
Epoch: 18, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.702 Vali Acc: 0.761 Test Loss: 0.702 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.9894599914550781
Epoch: 19, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.673 Vali Acc: 0.756 Test Loss: 0.673 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.0488791465759277
Epoch: 20, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.774 Vali Acc: 0.702 Test Loss: 0.774 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8449623584747314
Epoch: 21, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.849 Vali Acc: 0.761 Test Loss: 0.849 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0240554809570312
Epoch: 22, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.882 Vali Acc: 0.659 Test Loss: 0.882 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 4090434
model size : 15.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0752508640289307
Epoch: 1, Steps: 13 | Train Loss: 0.756 Vali Loss: 0.587 Vali Acc: 0.717 Test Loss: 0.587 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.8308608531951904
Epoch: 2, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.642 Vali Acc: 0.678 Test Loss: 0.642 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7838342189788818
Epoch: 3, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.837 Vali Acc: 0.737 Test Loss: 0.837 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736577).  Saving model ...
Epoch: 4 cost time: 1.7941679954528809
Epoch: 4, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.739 Vali Acc: 0.717 Test Loss: 0.739 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6761367321014404
Epoch: 5, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.750 Vali Acc: 0.722 Test Loss: 0.750 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.502856731414795
Epoch: 6, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.778 Vali Acc: 0.702 Test Loss: 0.778 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.826993703842163
Epoch: 7, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.960 Vali Acc: 0.727 Test Loss: 0.960 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8578650951385498
Epoch: 8, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.927 Vali Acc: 0.683 Test Loss: 0.927 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5650956630706787
Epoch: 9, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.159 Vali Acc: 0.737 Test Loss: 1.159 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6921720504760742
Epoch: 10, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.884 Vali Acc: 0.722 Test Loss: 0.884 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7007780075073242
Epoch: 11, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.056 Vali Acc: 0.722 Test Loss: 1.056 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7015790939331055
Epoch: 12, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.004 Vali Acc: 0.668 Test Loss: 1.004 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6484591960906982
Epoch: 13, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.704 Vali Acc: 0.746 Test Loss: 1.704 Test Acc: 0.746
Validation loss decreased (-0.736577 --> -0.746324).  Saving model ...
Epoch: 14 cost time: 1.5111916065216064
Epoch: 14, Steps: 13 | Train Loss: 0.113 Vali Loss: 1.361 Vali Acc: 0.688 Test Loss: 1.361 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7046499252319336
Epoch: 15, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.126 Vali Acc: 0.707 Test Loss: 1.126 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8033835887908936
Epoch: 16, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.111 Vali Acc: 0.693 Test Loss: 1.111 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6975998878479004
Epoch: 17, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.160 Vali Acc: 0.673 Test Loss: 1.160 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8052170276641846
Epoch: 18, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.583 Vali Acc: 0.707 Test Loss: 1.583 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.867177963256836
Epoch: 19, Steps: 13 | Train Loss: 0.051 Vali Loss: 2.183 Vali Acc: 0.580 Test Loss: 2.183 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.773141860961914
Epoch: 20, Steps: 13 | Train Loss: 0.020 Vali Loss: 2.051 Vali Acc: 0.659 Test Loss: 2.051 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5281755924224854
Epoch: 21, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.814 Vali Acc: 0.717 Test Loss: 1.814 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4256203174591064
Epoch: 22, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.050 Vali Acc: 0.693 Test Loss: 2.050 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.761460542678833
Epoch: 23, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.624 Vali Acc: 0.663 Test Loss: 1.624 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1776834
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.718975067138672
Epoch: 1, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.619 Vali Acc: 0.707 Test Loss: 0.619 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 1.3769257068634033
Epoch: 2, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.610 Vali Acc: 0.751 Test Loss: 0.610 Test Acc: 0.751
Validation loss decreased (-0.707311 --> -0.751213).  Saving model ...
Epoch: 3 cost time: 1.4488136768341064
Epoch: 3, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.603 Vali Acc: 0.722 Test Loss: 0.603 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2656350135803223
Epoch: 4, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.718 Vali Acc: 0.737 Test Loss: 0.718 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3711388111114502
Epoch: 5, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.787 Vali Acc: 0.751 Test Loss: 0.787 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1517388820648193
Epoch: 6, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.835 Vali Acc: 0.727 Test Loss: 0.835 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2703492641448975
Epoch: 7, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.841 Vali Acc: 0.732 Test Loss: 0.841 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2685532569885254
Epoch: 8, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.930 Vali Acc: 0.737 Test Loss: 0.930 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3038151264190674
Epoch: 9, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.853 Vali Acc: 0.673 Test Loss: 0.853 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4039688110351562
Epoch: 10, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.802 Vali Acc: 0.722 Test Loss: 0.802 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3490324020385742
Epoch: 11, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.772 Vali Acc: 0.741 Test Loss: 0.772 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.333099126815796
Epoch: 12, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.904 Vali Acc: 0.668 Test Loss: 0.904 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1656130
model size : 6.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.093479633331299
Epoch: 1, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.614 Vali Acc: 0.737 Test Loss: 0.614 Test Acc: 0.737
Validation loss decreased (inf --> -0.736579).  Saving model ...
Epoch: 2 cost time: 1.0870871543884277
Epoch: 2, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.668 Vali Acc: 0.737 Test Loss: 0.668 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.320444107055664
Epoch: 3, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.610 Vali Acc: 0.727 Test Loss: 0.610 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2542309761047363
Epoch: 4, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.653 Vali Acc: 0.707 Test Loss: 0.653 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2643535137176514
Epoch: 5, Steps: 13 | Train Loss: 0.151 Vali Loss: 0.744 Vali Acc: 0.722 Test Loss: 0.744 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3791618347167969
Epoch: 6, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.832 Vali Acc: 0.712 Test Loss: 0.832 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.505086898803711
Epoch: 7, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.856 Vali Acc: 0.712 Test Loss: 0.856 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.452925205230713
Epoch: 8, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.882 Vali Acc: 0.683 Test Loss: 0.882 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.577791690826416
Epoch: 9, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.976 Vali Acc: 0.707 Test Loss: 0.976 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4898881912231445
Epoch: 10, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.894 Vali Acc: 0.712 Test Loss: 0.894 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5637528896331787
Epoch: 11, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.840 Vali Acc: 0.717 Test Loss: 0.840 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 1613506
model size : 6.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.3309218883514404
Epoch: 1, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.606 Vali Acc: 0.751 Test Loss: 0.606 Test Acc: 0.751
Validation loss decreased (inf --> -0.751213).  Saving model ...
Epoch: 2 cost time: 1.489215612411499
Epoch: 2, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.551 Vali Acc: 0.780 Test Loss: 0.551 Test Acc: 0.780
Validation loss decreased (-0.751213 --> -0.780482).  Saving model ...
Epoch: 3 cost time: 1.2738289833068848
Epoch: 3, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.569 Vali Acc: 0.746 Test Loss: 0.569 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4080359935760498
Epoch: 4, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.572 Vali Acc: 0.717 Test Loss: 0.572 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3466243743896484
Epoch: 5, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.564 Vali Acc: 0.737 Test Loss: 0.564 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.408679485321045
Epoch: 6, Steps: 13 | Train Loss: 0.151 Vali Loss: 0.587 Vali Acc: 0.732 Test Loss: 0.587 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3327643871307373
Epoch: 7, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.603 Vali Acc: 0.683 Test Loss: 0.603 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3578813076019287
Epoch: 8, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.637 Vali Acc: 0.722 Test Loss: 0.637 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4898681640625
Epoch: 9, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.700 Vali Acc: 0.746 Test Loss: 0.700 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3343346118927002
Epoch: 10, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.669 Vali Acc: 0.722 Test Loss: 0.669 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3661630153656006
Epoch: 11, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.632 Vali Acc: 0.732 Test Loss: 0.632 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1978588104248047
Epoch: 12, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.633 Vali Acc: 0.698 Test Loss: 0.633 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 1590402
model size : 6.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.3909316062927246
Epoch: 1, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.648 Vali Acc: 0.717 Test Loss: 0.648 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.3397414684295654
Epoch: 2, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.629 Vali Acc: 0.717 Test Loss: 0.629 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 1.2057578563690186
Epoch: 3, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.602 Vali Acc: 0.751 Test Loss: 0.602 Test Acc: 0.751
Validation loss decreased (-0.717067 --> -0.751213).  Saving model ...
Epoch: 4 cost time: 1.1522753238677979
Epoch: 4, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.569 Vali Acc: 0.751 Test Loss: 0.569 Test Acc: 0.751
Validation loss decreased (-0.751213 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 1.233506679534912
Epoch: 5, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.564 Vali Acc: 0.761 Test Loss: 0.564 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 6 cost time: 1.2141015529632568
Epoch: 6, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.646 Vali Acc: 0.746 Test Loss: 0.646 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1963353157043457
Epoch: 7, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.675 Vali Acc: 0.722 Test Loss: 0.675 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2469491958618164
Epoch: 8, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.697 Vali Acc: 0.741 Test Loss: 0.697 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.563739538192749
Epoch: 9, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.691 Vali Acc: 0.756 Test Loss: 0.691 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1674489974975586
Epoch: 10, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.704 Vali Acc: 0.732 Test Loss: 0.704 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4302513599395752
Epoch: 11, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.711 Vali Acc: 0.761 Test Loss: 0.711 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.072746992111206
Epoch: 12, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.693 Vali Acc: 0.746 Test Loss: 0.693 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3859341144561768
Epoch: 13, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.666 Vali Acc: 0.732 Test Loss: 0.666 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1841189861297607
Epoch: 14, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.715 Vali Acc: 0.761 Test Loss: 0.715 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3202006816864014
Epoch: 15, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.742 Vali Acc: 0.732 Test Loss: 0.742 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 1567618
model size : 6.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.1383864879608154
Epoch: 1, Steps: 13 | Train Loss: 0.714 Vali Loss: 0.640 Vali Acc: 0.732 Test Loss: 0.640 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 1.1129839420318604
Epoch: 2, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.579 Vali Acc: 0.741 Test Loss: 0.579 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.1222081184387207
Epoch: 3, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.573 Vali Acc: 0.756 Test Loss: 0.573 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.1258971691131592
Epoch: 4, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.590 Vali Acc: 0.761 Test Loss: 0.590 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 1.208268165588379
Epoch: 5, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.557 Vali Acc: 0.761 Test Loss: 0.557 Test Acc: 0.761
Validation loss decreased (-0.760970 --> -0.760970).  Saving model ...
Epoch: 6 cost time: 0.8932714462280273
Epoch: 6, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.573 Vali Acc: 0.776 Test Loss: 0.573 Test Acc: 0.776
Validation loss decreased (-0.760970 --> -0.775604).  Saving model ...
Epoch: 7 cost time: 1.1260478496551514
Epoch: 7, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.556 Vali Acc: 0.737 Test Loss: 0.556 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1086227893829346
Epoch: 8, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.562 Vali Acc: 0.751 Test Loss: 0.562 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6392107009887695
Epoch: 9, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.600 Vali Acc: 0.751 Test Loss: 0.600 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2344634532928467
Epoch: 10, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.678 Vali Acc: 0.746 Test Loss: 0.678 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0082964897155762
Epoch: 11, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.661 Vali Acc: 0.732 Test Loss: 0.661 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2912616729736328
Epoch: 12, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.623 Vali Acc: 0.737 Test Loss: 0.623 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2285513877868652
Epoch: 13, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.613 Vali Acc: 0.751 Test Loss: 0.613 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9373722076416016
Epoch: 14, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.611 Vali Acc: 0.746 Test Loss: 0.611 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2464654445648193
Epoch: 15, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.611 Vali Acc: 0.722 Test Loss: 0.611 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0370938777923584
Epoch: 16, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.650 Vali Acc: 0.717 Test Loss: 0.650 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 1552642
model size : 5.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.2100584506988525
Epoch: 1, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.651 Vali Acc: 0.727 Test Loss: 0.651 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 0.9613420963287354
Epoch: 2, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.604 Vali Acc: 0.717 Test Loss: 0.604 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9658360481262207
Epoch: 3, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.621 Vali Acc: 0.732 Test Loss: 0.621 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731701).  Saving model ...
Epoch: 4 cost time: 0.9496092796325684
Epoch: 4, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.603 Vali Acc: 0.751 Test Loss: 0.603 Test Acc: 0.751
Validation loss decreased (-0.731701 --> -0.751213).  Saving model ...
Epoch: 5 cost time: 0.9769997596740723
Epoch: 5, Steps: 13 | Train Loss: 0.335 Vali Loss: 0.590 Vali Acc: 0.737 Test Loss: 0.590 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.874345064163208
Epoch: 6, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.585 Vali Acc: 0.751 Test Loss: 0.585 Test Acc: 0.751
Validation loss decreased (-0.751213 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 1.1148169040679932
Epoch: 7, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.622 Vali Acc: 0.727 Test Loss: 0.622 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9524781703948975
Epoch: 8, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.628 Vali Acc: 0.732 Test Loss: 0.628 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0655806064605713
Epoch: 9, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.615 Vali Acc: 0.741 Test Loss: 0.615 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1242825984954834
Epoch: 10, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.632 Vali Acc: 0.741 Test Loss: 0.632 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1011333465576172
Epoch: 11, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.638 Vali Acc: 0.737 Test Loss: 0.638 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.188852071762085
Epoch: 12, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.678 Vali Acc: 0.737 Test Loss: 0.678 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0587928295135498
Epoch: 13, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.647 Vali Acc: 0.737 Test Loss: 0.647 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1417036056518555
Epoch: 14, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.650 Vali Acc: 0.737 Test Loss: 0.650 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3139550685882568
Epoch: 15, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.645 Vali Acc: 0.732 Test Loss: 0.645 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0819025039672852
Epoch: 16, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.655 Vali Acc: 0.737 Test Loss: 0.655 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1545506
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.3944244384765625
Epoch: 1, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.577 Vali Acc: 0.722 Test Loss: 0.577 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.151731967926025
Epoch: 2, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.661 Vali Acc: 0.741 Test Loss: 0.661 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 4.179522275924683
Epoch: 3, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.580 Vali Acc: 0.717 Test Loss: 0.580 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.125715255737305
Epoch: 4, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.642 Vali Acc: 0.717 Test Loss: 0.642 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.823150157928467
Epoch: 5, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.663 Vali Acc: 0.727 Test Loss: 0.663 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.00528883934021
Epoch: 6, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.634 Vali Acc: 0.707 Test Loss: 0.634 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.441120862960815
Epoch: 7, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.731 Vali Acc: 0.698 Test Loss: 0.731 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.062132358551025
Epoch: 8, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.859 Vali Acc: 0.737 Test Loss: 0.859 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.005831480026245
Epoch: 9, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.962 Vali Acc: 0.732 Test Loss: 0.962 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.6548476219177246
Epoch: 10, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.793 Vali Acc: 0.707 Test Loss: 0.793 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.6290509700775146
Epoch: 11, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.098 Vali Acc: 0.727 Test Loss: 1.098 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.0701212882995605
Epoch: 12, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.024 Vali Acc: 0.707 Test Loss: 1.024 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 9250818
model size : 35.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.5211310386657715
Epoch: 1, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.293726921081543
Epoch: 2, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.659 Vali Acc: 0.737 Test Loss: 0.659 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 2.905363082885742
Epoch: 3, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.577 Vali Acc: 0.737 Test Loss: 0.577 Test Acc: 0.737
Validation loss decreased (-0.736579 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 3.1965601444244385
Epoch: 4, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.556 Vali Acc: 0.722 Test Loss: 0.556 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0736007690429688
Epoch: 5, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.656 Vali Acc: 0.712 Test Loss: 0.656 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.2361278533935547
Epoch: 6, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.597 Vali Acc: 0.717 Test Loss: 0.597 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.523503541946411
Epoch: 7, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.644 Vali Acc: 0.712 Test Loss: 0.644 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.3674492835998535
Epoch: 8, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.650 Vali Acc: 0.727 Test Loss: 0.650 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.192370653152466
Epoch: 9, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.656 Vali Acc: 0.737 Test Loss: 0.656 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.311034917831421
Epoch: 10, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.682 Vali Acc: 0.727 Test Loss: 0.682 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.18135404586792
Epoch: 11, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.706 Vali Acc: 0.727 Test Loss: 0.706 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.719963550567627
Epoch: 12, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.715 Vali Acc: 0.717 Test Loss: 0.715 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.03674054145813
Epoch: 13, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.741 Vali Acc: 0.717 Test Loss: 0.741 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 9126210
model size : 35.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.634462118148804
Epoch: 1, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.254059076309204
Epoch: 2, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.594 Vali Acc: 0.727 Test Loss: 0.594 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 3.587674617767334
Epoch: 3, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.556 Vali Acc: 0.746 Test Loss: 0.556 Test Acc: 0.746
Validation loss decreased (-0.726823 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 3.358114719390869
Epoch: 4, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.559 Vali Acc: 0.727 Test Loss: 0.559 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.851430892944336
Epoch: 5, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.607 Vali Acc: 0.727 Test Loss: 0.607 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.2418720722198486
Epoch: 6, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.297823429107666
Epoch: 7, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.672 Vali Acc: 0.722 Test Loss: 0.672 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.308972120285034
Epoch: 8, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.592 Vali Acc: 0.717 Test Loss: 0.592 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.0385663509368896
Epoch: 9, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.631 Vali Acc: 0.722 Test Loss: 0.631 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.077108383178711
Epoch: 10, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.653 Vali Acc: 0.717 Test Loss: 0.653 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.864389181137085
Epoch: 11, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.662 Vali Acc: 0.717 Test Loss: 0.662 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.946845769882202
Epoch: 12, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.796 Vali Acc: 0.732 Test Loss: 0.796 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.082627058029175
Epoch: 13, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.746 Vali Acc: 0.712 Test Loss: 0.746 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 9095298
model size : 34.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.470896005630493
Epoch: 1, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.609 Vali Acc: 0.722 Test Loss: 0.609 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.0340538024902344
Epoch: 2, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 3.230095148086548
Epoch: 3, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.567 Vali Acc: 0.737 Test Loss: 0.567 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 2.8501172065734863
Epoch: 4, Steps: 13 | Train Loss: 0.321 Vali Loss: 0.564 Vali Acc: 0.737 Test Loss: 0.564 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 2.9223127365112305
Epoch: 5, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.593 Vali Acc: 0.732 Test Loss: 0.593 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5814263820648193
Epoch: 6, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.620 Vali Acc: 0.727 Test Loss: 0.620 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.522772789001465
Epoch: 7, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.626 Vali Acc: 0.722 Test Loss: 0.626 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8870482444763184
Epoch: 8, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.653 Vali Acc: 0.698 Test Loss: 0.653 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.859415054321289
Epoch: 9, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.698 Vali Acc: 0.717 Test Loss: 0.698 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.7634479999542236
Epoch: 10, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.646 Vali Acc: 0.722 Test Loss: 0.646 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.5918288230895996
Epoch: 11, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.692 Vali Acc: 0.727 Test Loss: 0.692 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.1925745010375977
Epoch: 12, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.649 Vali Acc: 0.722 Test Loss: 0.649 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.047792434692383
Epoch: 13, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.631 Vali Acc: 0.737 Test Loss: 0.631 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.9301981925964355
Epoch: 14, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.680 Vali Acc: 0.732 Test Loss: 0.680 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 9064386
model size : 34.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.589388370513916
Epoch: 1, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.614 Vali Acc: 0.722 Test Loss: 0.614 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.581521511077881
Epoch: 2, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.601 Vali Acc: 0.722 Test Loss: 0.601 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 2.8409602642059326
Epoch: 3, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.599 Vali Acc: 0.741 Test Loss: 0.599 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741457).  Saving model ...
Epoch: 4 cost time: 2.9894025325775146
Epoch: 4, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.562 Vali Acc: 0.737 Test Loss: 0.562 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.675931930541992
Epoch: 5, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.571 Vali Acc: 0.741 Test Loss: 0.571 Test Acc: 0.741
Validation loss decreased (-0.741457 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 2.9009392261505127
Epoch: 6, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.568 Vali Acc: 0.727 Test Loss: 0.568 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8046364784240723
Epoch: 7, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.562 Vali Acc: 0.727 Test Loss: 0.562 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.728142023086548
Epoch: 8, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.568 Vali Acc: 0.722 Test Loss: 0.568 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.886394739151001
Epoch: 9, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.592 Vali Acc: 0.732 Test Loss: 0.592 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.855963945388794
Epoch: 10, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.601 Vali Acc: 0.717 Test Loss: 0.601 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.5506808757781982
Epoch: 11, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.653 Vali Acc: 0.727 Test Loss: 0.653 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.8789925575256348
Epoch: 12, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.648 Vali Acc: 0.673 Test Loss: 0.648 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.9216742515563965
Epoch: 13, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.742 Vali Acc: 0.727 Test Loss: 0.742 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.7546327114105225
Epoch: 14, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.691 Vali Acc: 0.654 Test Loss: 0.691 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.7689802646636963
Epoch: 15, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.691 Vali Acc: 0.717 Test Loss: 0.691 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 9049410
model size : 34.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.289048671722412
Epoch: 1, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.621 Vali Acc: 0.722 Test Loss: 0.621 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.065739154815674
Epoch: 2, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.576 Vali Acc: 0.712 Test Loss: 0.576 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7987170219421387
Epoch: 3, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.590 Vali Acc: 0.741 Test Loss: 0.590 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 2.942913293838501
Epoch: 4, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.585 Vali Acc: 0.737 Test Loss: 0.585 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.652682304382324
Epoch: 5, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.600 Vali Acc: 0.741 Test Loss: 0.600 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7128002643585205
Epoch: 6, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.636 Vali Acc: 0.741 Test Loss: 0.636 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.462369918823242
Epoch: 7, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.597 Vali Acc: 0.737 Test Loss: 0.597 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.7825160026550293
Epoch: 8, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.587 Vali Acc: 0.741 Test Loss: 0.587 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 9 cost time: 2.8014309406280518
Epoch: 9, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.605 Vali Acc: 0.732 Test Loss: 0.605 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8339130878448486
Epoch: 10, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.628 Vali Acc: 0.722 Test Loss: 0.628 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.563474416732788
Epoch: 11, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.624 Vali Acc: 0.693 Test Loss: 0.624 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1845438480377197
Epoch: 12, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.627 Vali Acc: 0.717 Test Loss: 0.627 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.908679485321045
Epoch: 13, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.674 Vali Acc: 0.688 Test Loss: 0.674 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.4858789443969727
Epoch: 14, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.810 Vali Acc: 0.722 Test Loss: 0.810 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.7598414421081543
Epoch: 15, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.701 Vali Acc: 0.688 Test Loss: 0.701 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.5927574634552
Epoch: 16, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.072 Vali Acc: 0.727 Test Loss: 1.072 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.588948965072632
Epoch: 17, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.814 Vali Acc: 0.698 Test Loss: 0.814 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.5534493923187256
Epoch: 18, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.971 Vali Acc: 0.702 Test Loss: 0.971 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 9034434
model size : 34.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.5050768852233887
Epoch: 1, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.647 Vali Acc: 0.722 Test Loss: 0.647 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.4393060207366943
Epoch: 2, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.584 Vali Acc: 0.717 Test Loss: 0.584 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.401832103729248
Epoch: 3, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.618 Vali Acc: 0.722 Test Loss: 0.618 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 1.727522850036621
Epoch: 4, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.608 Vali Acc: 0.717 Test Loss: 0.608 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.711235523223877
Epoch: 5, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.547 Vali Acc: 0.737 Test Loss: 0.547 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 1.6356077194213867
Epoch: 6, Steps: 13 | Train Loss: 0.303 Vali Loss: 0.548 Vali Acc: 0.737 Test Loss: 0.548 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.574167490005493
Epoch: 7, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.543 Vali Acc: 0.732 Test Loss: 0.543 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4985127449035645
Epoch: 8, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.567 Vali Acc: 0.727 Test Loss: 0.567 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.5279734134674072
Epoch: 9, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.577 Vali Acc: 0.732 Test Loss: 0.577 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.549851655960083
Epoch: 10, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.586 Vali Acc: 0.737 Test Loss: 0.586 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.3338067531585693
Epoch: 11, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.578 Vali Acc: 0.741 Test Loss: 0.578 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 12 cost time: 2.426028251647949
Epoch: 12, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.610 Vali Acc: 0.737 Test Loss: 0.610 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2355294227600098
Epoch: 13, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.623 Vali Acc: 0.741 Test Loss: 0.623 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2493197917938232
Epoch: 14, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.619 Vali Acc: 0.766 Test Loss: 0.619 Test Acc: 0.766
Validation loss decreased (-0.741458 --> -0.765847).  Saving model ...
Epoch: 15 cost time: 2.454981565475464
Epoch: 15, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.625 Vali Acc: 0.751 Test Loss: 0.625 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3806731700897217
Epoch: 16, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.651 Vali Acc: 0.741 Test Loss: 0.651 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3374738693237305
Epoch: 17, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.747 Vali Acc: 0.737 Test Loss: 0.747 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.6478078365325928
Epoch: 18, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.745 Vali Acc: 0.737 Test Loss: 0.745 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.567016363143921
Epoch: 19, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.771 Vali Acc: 0.722 Test Loss: 0.771 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.5287864208221436
Epoch: 20, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.820 Vali Acc: 0.712 Test Loss: 0.820 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.615985870361328
Epoch: 21, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.905 Vali Acc: 0.741 Test Loss: 0.905 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.5049147605895996
Epoch: 22, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.863 Vali Acc: 0.712 Test Loss: 0.863 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.2683451175689697
Epoch: 23, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.926 Vali Acc: 0.741 Test Loss: 0.926 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.511497735977173
Epoch: 24, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.990 Vali Acc: 0.727 Test Loss: 0.990 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 9019490
model size : 34.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.035641670227051
Epoch: 1, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.594 Vali Acc: 0.712 Test Loss: 0.594 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.971128463745117
Epoch: 2, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.574 Vali Acc: 0.751 Test Loss: 0.574 Test Acc: 0.751
Validation loss decreased (-0.712189 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 3.7970046997070312
Epoch: 3, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.568 Vali Acc: 0.741 Test Loss: 0.568 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.549241781234741
Epoch: 4, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.809 Vali Acc: 0.712 Test Loss: 0.809 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.2580296993255615
Epoch: 5, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.736 Vali Acc: 0.732 Test Loss: 0.736 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.392019748687744
Epoch: 6, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.710 Vali Acc: 0.722 Test Loss: 0.710 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.707143783569336
Epoch: 7, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.840 Vali Acc: 0.673 Test Loss: 0.840 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.797842264175415
Epoch: 8, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.811 Vali Acc: 0.712 Test Loss: 0.811 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.7465596199035645
Epoch: 9, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.949 Vali Acc: 0.707 Test Loss: 0.949 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.322167158126831
Epoch: 10, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.896 Vali Acc: 0.702 Test Loss: 0.896 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.2060048580169678
Epoch: 11, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.300 Vali Acc: 0.707 Test Loss: 1.300 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.293128490447998
Epoch: 12, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.965 Vali Acc: 0.673 Test Loss: 0.965 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 9196162
model size : 35.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.004021883010864
Epoch: 1, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.578 Vali Acc: 0.717 Test Loss: 0.578 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.4721200466156006
Epoch: 2, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.574 Vali Acc: 0.732 Test Loss: 0.574 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 2.447049379348755
Epoch: 3, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.548 Vali Acc: 0.732 Test Loss: 0.548 Test Acc: 0.732
Validation loss decreased (-0.731702 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 2.6070897579193115
Epoch: 4, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.579 Vali Acc: 0.717 Test Loss: 0.579 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9283382892608643
Epoch: 5, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.614 Vali Acc: 0.737 Test Loss: 0.614 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736579).  Saving model ...
Epoch: 6 cost time: 2.6549456119537354
Epoch: 6, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.655 Vali Acc: 0.741 Test Loss: 0.655 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741457).  Saving model ...
Epoch: 7 cost time: 2.6324710845947266
Epoch: 7, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.640 Vali Acc: 0.732 Test Loss: 0.640 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4830992221832275
Epoch: 8, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.655 Vali Acc: 0.698 Test Loss: 0.655 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6261560916900635
Epoch: 9, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.751 Vali Acc: 0.727 Test Loss: 0.751 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.8730807304382324
Epoch: 10, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.672 Vali Acc: 0.727 Test Loss: 0.672 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.9065423011779785
Epoch: 11, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.721 Vali Acc: 0.712 Test Loss: 0.721 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.0548689365386963
Epoch: 12, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.757 Vali Acc: 0.712 Test Loss: 0.757 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.6712841987609863
Epoch: 13, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.757 Vali Acc: 0.717 Test Loss: 0.757 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.7656657695770264
Epoch: 14, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.800 Vali Acc: 0.737 Test Loss: 0.800 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.983248710632324
Epoch: 15, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.016 Vali Acc: 0.571 Test Loss: 1.016 Test Acc: 0.571
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.9035701751708984
Epoch: 16, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.952 Vali Acc: 0.707 Test Loss: 0.952 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 9071554
model size : 34.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5823497772216797
Epoch: 1, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.587 Vali Acc: 0.722 Test Loss: 0.587 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.788271427154541
Epoch: 2, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.563 Vali Acc: 0.741 Test Loss: 0.563 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 2.771014928817749
Epoch: 3, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.551 Vali Acc: 0.756 Test Loss: 0.551 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 2.6416525840759277
Epoch: 4, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.575 Vali Acc: 0.741 Test Loss: 0.575 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.81310772895813
Epoch: 5, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.581 Vali Acc: 0.707 Test Loss: 0.581 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.883603096008301
Epoch: 6, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.584 Vali Acc: 0.717 Test Loss: 0.584 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.814936876296997
Epoch: 7, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.604 Vali Acc: 0.712 Test Loss: 0.604 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.685086727142334
Epoch: 8, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.629 Vali Acc: 0.722 Test Loss: 0.629 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.8022046089172363
Epoch: 9, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.682 Vali Acc: 0.722 Test Loss: 0.682 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.6449623107910156
Epoch: 10, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.670 Vali Acc: 0.722 Test Loss: 0.670 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.76200270652771
Epoch: 11, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.635 Vali Acc: 0.727 Test Loss: 0.635 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.02235746383667
Epoch: 12, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.637 Vali Acc: 0.727 Test Loss: 0.637 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.5864686965942383
Epoch: 13, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.776 Vali Acc: 0.732 Test Loss: 0.776 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 9040642
model size : 34.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6093637943267822
Epoch: 1, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.594 Vali Acc: 0.722 Test Loss: 0.594 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.4707491397857666
Epoch: 2, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.573 Vali Acc: 0.717 Test Loss: 0.573 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7324368953704834
Epoch: 3, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.561 Vali Acc: 0.722 Test Loss: 0.561 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 4 cost time: 2.6341888904571533
Epoch: 4, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.566 Vali Acc: 0.722 Test Loss: 0.566 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4688875675201416
Epoch: 5, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.594 Vali Acc: 0.727 Test Loss: 0.594 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726823).  Saving model ...
Epoch: 6 cost time: 2.1380677223205566
Epoch: 6, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.606 Vali Acc: 0.717 Test Loss: 0.606 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4276463985443115
Epoch: 7, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.607 Vali Acc: 0.702 Test Loss: 0.607 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5945684909820557
Epoch: 8, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.699 Vali Acc: 0.732 Test Loss: 0.699 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731700).  Saving model ...
Epoch: 9 cost time: 2.5247671604156494
Epoch: 9, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.670 Vali Acc: 0.707 Test Loss: 0.670 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7761051654815674
Epoch: 10, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.782 Vali Acc: 0.712 Test Loss: 0.782 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.311648368835449
Epoch: 11, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.789 Vali Acc: 0.702 Test Loss: 0.789 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5295252799987793
Epoch: 12, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.760 Vali Acc: 0.702 Test Loss: 0.760 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.9187381267547607
Epoch: 13, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.815 Vali Acc: 0.722 Test Loss: 0.815 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.86885404586792
Epoch: 14, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.716 Vali Acc: 0.678 Test Loss: 0.716 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.9333155155181885
Epoch: 15, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.862 Vali Acc: 0.717 Test Loss: 0.862 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.697946071624756
Epoch: 16, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.792 Vali Acc: 0.698 Test Loss: 0.792 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.53184175491333
Epoch: 17, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.888 Vali Acc: 0.712 Test Loss: 0.888 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.5785205364227295
Epoch: 18, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.760 Vali Acc: 0.702 Test Loss: 0.760 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 9009730
model size : 34.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7212789058685303
Epoch: 1, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.951674461364746
Epoch: 2, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.577 Vali Acc: 0.712 Test Loss: 0.577 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9777584075927734
Epoch: 3, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.596 Vali Acc: 0.756 Test Loss: 0.596 Test Acc: 0.756
Validation loss decreased (-0.721945 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 3.0109872817993164
Epoch: 4, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.561 Vali Acc: 0.751 Test Loss: 0.561 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.793069839477539
Epoch: 5, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.566 Vali Acc: 0.746 Test Loss: 0.566 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4973502159118652
Epoch: 6, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.576 Vali Acc: 0.741 Test Loss: 0.576 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.890592336654663
Epoch: 7, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.591 Vali Acc: 0.722 Test Loss: 0.591 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.84466552734375
Epoch: 8, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.634 Vali Acc: 0.727 Test Loss: 0.634 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.019158363342285
Epoch: 9, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.584 Vali Acc: 0.737 Test Loss: 0.584 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.970763921737671
Epoch: 10, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.601 Vali Acc: 0.727 Test Loss: 0.601 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.4724531173706055
Epoch: 11, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.626 Vali Acc: 0.737 Test Loss: 0.626 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.594637870788574
Epoch: 12, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.634 Vali Acc: 0.698 Test Loss: 0.634 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.477377414703369
Epoch: 13, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.611 Vali Acc: 0.732 Test Loss: 0.611 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 8994754
model size : 34.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.168619632720947
Epoch: 1, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.635 Vali Acc: 0.717 Test Loss: 0.635 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.3110463619232178
Epoch: 2, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.585 Vali Acc: 0.717 Test Loss: 0.585 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 2.4547274112701416
Epoch: 3, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.614 Vali Acc: 0.741 Test Loss: 0.614 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741457).  Saving model ...
Epoch: 4 cost time: 2.383000373840332
Epoch: 4, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.597 Vali Acc: 0.717 Test Loss: 0.597 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.544865846633911
Epoch: 5, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.581 Vali Acc: 0.732 Test Loss: 0.581 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.679305076599121
Epoch: 6, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.591 Vali Acc: 0.737 Test Loss: 0.591 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9202229976654053
Epoch: 7, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.596 Vali Acc: 0.737 Test Loss: 0.596 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9722011089324951
Epoch: 8, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.687 Vali Acc: 0.732 Test Loss: 0.687 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.3908722400665283
Epoch: 9, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.638 Vali Acc: 0.702 Test Loss: 0.638 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.343984365463257
Epoch: 10, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.640 Vali Acc: 0.712 Test Loss: 0.640 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.3492789268493652
Epoch: 11, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.729 Vali Acc: 0.717 Test Loss: 0.729 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8843934535980225
Epoch: 12, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.749 Vali Acc: 0.712 Test Loss: 0.749 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8398208618164062
Epoch: 13, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.702 Vali Acc: 0.678 Test Loss: 0.702 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 8979778
model size : 34.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.386110305786133
Epoch: 1, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.644 Vali Acc: 0.732 Test Loss: 0.644 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 2.403198003768921
Epoch: 2, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.577 Vali Acc: 0.727 Test Loss: 0.577 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7467806339263916
Epoch: 3, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.610 Vali Acc: 0.732 Test Loss: 0.610 Test Acc: 0.732
Validation loss decreased (-0.731701 --> -0.731701).  Saving model ...
Epoch: 4 cost time: 2.4412972927093506
Epoch: 4, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.560 Vali Acc: 0.732 Test Loss: 0.560 Test Acc: 0.732
Validation loss decreased (-0.731701 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 2.211500883102417
Epoch: 5, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.549 Vali Acc: 0.732 Test Loss: 0.549 Test Acc: 0.732
Validation loss decreased (-0.731702 --> -0.731702).  Saving model ...
Epoch: 6 cost time: 2.5106234550476074
Epoch: 6, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.547 Vali Acc: 0.737 Test Loss: 0.547 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 7 cost time: 2.496368169784546
Epoch: 7, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.546 Vali Acc: 0.732 Test Loss: 0.546 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.657480001449585
Epoch: 8, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.549 Vali Acc: 0.727 Test Loss: 0.549 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2301714420318604
Epoch: 9, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.548 Vali Acc: 0.727 Test Loss: 0.548 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2124428749084473
Epoch: 10, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.562 Vali Acc: 0.722 Test Loss: 0.562 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.7246999740600586
Epoch: 11, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.563 Vali Acc: 0.727 Test Loss: 0.563 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.6908628940582275
Epoch: 12, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.585 Vali Acc: 0.727 Test Loss: 0.585 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.597783088684082
Epoch: 13, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.590 Vali Acc: 0.737 Test Loss: 0.590 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.46059250831604
Epoch: 14, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.626 Vali Acc: 0.737 Test Loss: 0.626 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.376579761505127
Epoch: 15, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.659 Vali Acc: 0.712 Test Loss: 0.659 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.728930711746216
Epoch: 16, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.819 Vali Acc: 0.732 Test Loss: 0.819 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 8964834
model size : 34.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 10.919958353042603
Epoch: 1, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.552 Vali Acc: 0.737 Test Loss: 0.552 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 8.032652854919434
Epoch: 2, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.613 Vali Acc: 0.727 Test Loss: 0.613 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.590018272399902
Epoch: 3, Steps: 13 | Train Loss: 0.175 Vali Loss: 1.003 Vali Acc: 0.727 Test Loss: 1.003 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.836406707763672
Epoch: 4, Steps: 13 | Train Loss: 0.096 Vali Loss: 1.067 Vali Acc: 0.746 Test Loss: 1.067 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746331).  Saving model ...
Epoch: 5 cost time: 8.121017217636108
Epoch: 5, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.003 Vali Acc: 0.668 Test Loss: 1.003 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.917832374572754
Epoch: 6, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.035 Vali Acc: 0.702 Test Loss: 1.035 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.481242656707764
Epoch: 7, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.348 Vali Acc: 0.722 Test Loss: 1.348 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.692719221115112
Epoch: 8, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.961 Vali Acc: 0.707 Test Loss: 1.961 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.872485637664795
Epoch: 9, Steps: 13 | Train Loss: 0.042 Vali Loss: 2.708 Vali Acc: 0.717 Test Loss: 2.708 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.900553703308105
Epoch: 10, Steps: 13 | Train Loss: 0.037 Vali Loss: 2.799 Vali Acc: 0.717 Test Loss: 2.799 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 9.467967748641968
Epoch: 11, Steps: 13 | Train Loss: 0.036 Vali Loss: 2.079 Vali Acc: 0.727 Test Loss: 2.079 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.964850664138794
Epoch: 12, Steps: 13 | Train Loss: 0.014 Vali Loss: 3.846 Vali Acc: 0.649 Test Loss: 3.846 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.598438501358032
Epoch: 13, Steps: 13 | Train Loss: 0.005 Vali Loss: 2.566 Vali Acc: 0.688 Test Loss: 2.566 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 8.281058311462402
Epoch: 14, Steps: 13 | Train Loss: 0.246 Vali Loss: 3.343 Vali Acc: 0.678 Test Loss: 3.343 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 27490306
model size : 105.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.8686158657073975
Epoch: 1, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.709 Vali Acc: 0.732 Test Loss: 0.709 Test Acc: 0.732
Validation loss decreased (inf --> -0.731700).  Saving model ...
Epoch: 2 cost time: 6.054892539978027
Epoch: 2, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.580 Vali Acc: 0.717 Test Loss: 0.580 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.240413665771484
Epoch: 3, Steps: 13 | Train Loss: 0.276 Vali Loss: 1.072 Vali Acc: 0.737 Test Loss: 1.072 Test Acc: 0.737
Validation loss decreased (-0.731700 --> -0.736575).  Saving model ...
Epoch: 4 cost time: 5.435460567474365
Epoch: 4, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.942 Vali Acc: 0.727 Test Loss: 0.942 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.157663583755493
Epoch: 5, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.766 Vali Acc: 0.702 Test Loss: 0.766 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.597126245498657
Epoch: 6, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.810 Vali Acc: 0.702 Test Loss: 0.810 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.207578897476196
Epoch: 7, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.185 Vali Acc: 0.741 Test Loss: 1.185 Test Acc: 0.741
Validation loss decreased (-0.736575 --> -0.741452).  Saving model ...
Epoch: 8 cost time: 5.663012981414795
Epoch: 8, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.445 Vali Acc: 0.722 Test Loss: 1.445 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.894220352172852
Epoch: 9, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.730 Vali Acc: 0.698 Test Loss: 1.730 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.538725852966309
Epoch: 10, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.855 Vali Acc: 0.702 Test Loss: 1.855 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.2210400104522705
Epoch: 11, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.609 Vali Acc: 0.678 Test Loss: 1.609 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.676398992538452
Epoch: 12, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.576 Vali Acc: 0.673 Test Loss: 1.576 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.039387941360474
Epoch: 13, Steps: 13 | Train Loss: 0.012 Vali Loss: 2.133 Vali Acc: 0.707 Test Loss: 2.133 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.276626110076904
Epoch: 14, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.782 Vali Acc: 0.698 Test Loss: 1.782 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.757031202316284
Epoch: 15, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.908 Vali Acc: 0.707 Test Loss: 1.908 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.933671236038208
Epoch: 16, Steps: 13 | Train Loss: 0.007 Vali Loss: 2.197 Vali Acc: 0.717 Test Loss: 2.197 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.177647829055786
Epoch: 17, Steps: 13 | Train Loss: 0.012 Vali Loss: 2.294 Vali Acc: 0.693 Test Loss: 2.294 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 26991874
model size : 103.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.712787389755249
Epoch: 1, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.555 Vali Acc: 0.737 Test Loss: 0.555 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 5.269567251205444
Epoch: 2, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.542 Vali Acc: 0.751 Test Loss: 0.542 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 5.951864957809448
Epoch: 3, Steps: 13 | Train Loss: 0.284 Vali Loss: 0.694 Vali Acc: 0.712 Test Loss: 0.694 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.156200647354126
Epoch: 4, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.659 Vali Acc: 0.654 Test Loss: 0.659 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.279918670654297
Epoch: 5, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.755 Vali Acc: 0.693 Test Loss: 0.755 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.92322039604187
Epoch: 6, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.765 Vali Acc: 0.727 Test Loss: 0.765 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.473223924636841
Epoch: 7, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.943 Vali Acc: 0.712 Test Loss: 0.943 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.486012697219849
Epoch: 8, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.775 Vali Acc: 0.727 Test Loss: 0.775 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.068544626235962
Epoch: 9, Steps: 13 | Train Loss: 0.125 Vali Loss: 1.452 Vali Acc: 0.722 Test Loss: 1.452 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.119263410568237
Epoch: 10, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.217 Vali Acc: 0.644 Test Loss: 1.217 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.198556661605835
Epoch: 11, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.157 Vali Acc: 0.717 Test Loss: 1.157 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.030918121337891
Epoch: 12, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.152 Vali Acc: 0.688 Test Loss: 1.152 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 26836994
model size : 102.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.052093505859375
Epoch: 1, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.561 Vali Acc: 0.722 Test Loss: 0.561 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 4.257117748260498
Epoch: 2, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.533 Vali Acc: 0.751 Test Loss: 0.533 Test Acc: 0.751
Validation loss decreased (-0.721946 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 5.091094970703125
Epoch: 3, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.554 Vali Acc: 0.746 Test Loss: 0.554 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.192082166671753
Epoch: 4, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.686 Vali Acc: 0.737 Test Loss: 0.686 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.5601487159729
Epoch: 5, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.688 Vali Acc: 0.732 Test Loss: 0.688 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.0591206550598145
Epoch: 6, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.698 Vali Acc: 0.751 Test Loss: 0.698 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.066620111465454
Epoch: 7, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.787 Vali Acc: 0.620 Test Loss: 0.787 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.68759298324585
Epoch: 8, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.845 Vali Acc: 0.659 Test Loss: 0.845 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.934049367904663
Epoch: 9, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.943 Vali Acc: 0.732 Test Loss: 0.943 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.276947021484375
Epoch: 10, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.035 Vali Acc: 0.585 Test Loss: 1.035 Test Acc: 0.585
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.921043395996094
Epoch: 11, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.689 Vali Acc: 0.727 Test Loss: 1.689 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.769806146621704
Epoch: 12, Steps: 13 | Train Loss: 0.127 Vali Loss: 1.103 Vali Acc: 0.663 Test Loss: 1.103 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 26744578
model size : 102.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.457553863525391
Epoch: 1, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.570 Vali Acc: 0.717 Test Loss: 0.570 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.951714038848877
Epoch: 2, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.643 Vali Acc: 0.732 Test Loss: 0.643 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 3.5621044635772705
Epoch: 3, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.575 Vali Acc: 0.727 Test Loss: 0.575 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.233785152435303
Epoch: 4, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.644 Vali Acc: 0.712 Test Loss: 0.644 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.08745813369751
Epoch: 5, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.628 Vali Acc: 0.732 Test Loss: 0.628 Test Acc: 0.732
Validation loss decreased (-0.731701 --> -0.731701).  Saving model ...
Epoch: 6 cost time: 4.229595422744751
Epoch: 6, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.742 Vali Acc: 0.722 Test Loss: 0.742 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5047030448913574
Epoch: 7, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.754 Vali Acc: 0.683 Test Loss: 0.754 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.906525135040283
Epoch: 8, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.793 Vali Acc: 0.663 Test Loss: 0.793 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.1250369548797607
Epoch: 9, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.049 Vali Acc: 0.698 Test Loss: 1.049 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.265730381011963
Epoch: 10, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.048 Vali Acc: 0.683 Test Loss: 1.048 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.518083333969116
Epoch: 11, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.986 Vali Acc: 0.688 Test Loss: 0.986 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.554308176040649
Epoch: 12, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.225 Vali Acc: 0.688 Test Loss: 1.225 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.410611152648926
Epoch: 13, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.424 Vali Acc: 0.712 Test Loss: 1.424 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.8571970462799072
Epoch: 14, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.363 Vali Acc: 0.668 Test Loss: 1.363 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.260623931884766
Epoch: 15, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.650 Vali Acc: 0.659 Test Loss: 1.650 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 26653442
model size : 102.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.6711812019348145
Epoch: 1, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.580 Vali Acc: 0.727 Test Loss: 0.580 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 3.9537715911865234
Epoch: 2, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.613 Vali Acc: 0.737 Test Loss: 0.613 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 3.408125400543213
Epoch: 3, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.549 Vali Acc: 0.746 Test Loss: 0.549 Test Acc: 0.746
Validation loss decreased (-0.736579 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 3.579578161239624
Epoch: 4, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.561 Vali Acc: 0.712 Test Loss: 0.561 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.8167669773101807
Epoch: 5, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.621 Vali Acc: 0.693 Test Loss: 0.621 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.7502968311309814
Epoch: 6, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.612 Vali Acc: 0.717 Test Loss: 0.612 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.632272243499756
Epoch: 7, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.624 Vali Acc: 0.722 Test Loss: 0.624 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.809006452560425
Epoch: 8, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.695 Vali Acc: 0.737 Test Loss: 0.695 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.976562976837158
Epoch: 9, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.671 Vali Acc: 0.688 Test Loss: 0.671 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.132129192352295
Epoch: 10, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.933 Vali Acc: 0.732 Test Loss: 0.933 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.1890738010406494
Epoch: 11, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.769 Vali Acc: 0.693 Test Loss: 0.769 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.9111969470977783
Epoch: 12, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.818 Vali Acc: 0.722 Test Loss: 0.818 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.9006338119506836
Epoch: 13, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.792 Vali Acc: 0.698 Test Loss: 0.792 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 26593538
model size : 101.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.655527830123901
Epoch: 1, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.603 Vali Acc: 0.727 Test Loss: 0.603 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 3.563197612762451
Epoch: 2, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.582 Vali Acc: 0.732 Test Loss: 0.582 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 2.9993929862976074
Epoch: 3, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.543 Vali Acc: 0.732 Test Loss: 0.543 Test Acc: 0.732
Validation loss decreased (-0.731701 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 3.0211758613586426
Epoch: 4, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.539 Vali Acc: 0.722 Test Loss: 0.539 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.542811393737793
Epoch: 5, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.590 Vali Acc: 0.727 Test Loss: 0.590 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.712498903274536
Epoch: 6, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.610 Vali Acc: 0.732 Test Loss: 0.610 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.407160520553589
Epoch: 7, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.595 Vali Acc: 0.732 Test Loss: 0.595 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.5809333324432373
Epoch: 8, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.599 Vali Acc: 0.693 Test Loss: 0.599 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.8949456214904785
Epoch: 9, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.599 Vali Acc: 0.702 Test Loss: 0.599 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.462841510772705
Epoch: 10, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.616 Vali Acc: 0.722 Test Loss: 0.616 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.9222707748413086
Epoch: 11, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.802 Vali Acc: 0.722 Test Loss: 0.802 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.546250104904175
Epoch: 12, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.705 Vali Acc: 0.688 Test Loss: 0.705 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.000821113586426
Epoch: 13, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.898 Vali Acc: 0.751 Test Loss: 0.898 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751211).  Saving model ...
Epoch: 14 cost time: 3.89021635055542
Epoch: 14, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.805 Vali Acc: 0.741 Test Loss: 0.805 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.6600353717803955
Epoch: 15, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.970 Vali Acc: 0.746 Test Loss: 0.970 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.1798667907714844
Epoch: 16, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.929 Vali Acc: 0.707 Test Loss: 0.929 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.067200422286987
Epoch: 17, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.836 Vali Acc: 0.717 Test Loss: 0.836 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.3185505867004395
Epoch: 18, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.870 Vali Acc: 0.732 Test Loss: 0.870 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.4294464588165283
Epoch: 19, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.886 Vali Acc: 0.693 Test Loss: 0.886 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.154449939727783
Epoch: 20, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.123 Vali Acc: 0.737 Test Loss: 1.123 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.555772066116333
Epoch: 21, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.022 Vali Acc: 0.722 Test Loss: 1.022 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.6306190490722656
Epoch: 22, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.124 Vali Acc: 0.702 Test Loss: 1.124 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.8734123706817627
Epoch: 23, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.235 Vali Acc: 0.741 Test Loss: 1.235 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 26564994
model size : 101.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.809143304824829
Epoch: 1, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.7881131172180176
Epoch: 2, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.622 Vali Acc: 0.737 Test Loss: 0.622 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 3.8142898082733154
Epoch: 3, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.593 Vali Acc: 0.727 Test Loss: 0.593 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.101116895675659
Epoch: 4, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.698 Vali Acc: 0.722 Test Loss: 0.698 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.126394271850586
Epoch: 5, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.766 Vali Acc: 0.688 Test Loss: 0.766 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.5285420417785645
Epoch: 6, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.889 Vali Acc: 0.659 Test Loss: 0.889 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.661850690841675
Epoch: 7, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.126 Vali Acc: 0.732 Test Loss: 1.126 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.4737608432769775
Epoch: 8, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.369 Vali Acc: 0.727 Test Loss: 1.369 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.2117061614990234
Epoch: 9, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.001 Vali Acc: 0.644 Test Loss: 1.001 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.3318779468536377
Epoch: 10, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.549 Vali Acc: 0.741 Test Loss: 1.549 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741448).  Saving model ...
Epoch: 11 cost time: 4.000362157821655
Epoch: 11, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.485 Vali Acc: 0.654 Test Loss: 1.485 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.691147804260254
Epoch: 12, Steps: 13 | Train Loss: 0.009 Vali Loss: 2.100 Vali Acc: 0.761 Test Loss: 2.100 Test Acc: 0.761
Validation loss decreased (-0.741448 --> -0.760955).  Saving model ...
Epoch: 13 cost time: 3.5157432556152344
Epoch: 13, Steps: 13 | Train Loss: 0.014 Vali Loss: 2.435 Vali Acc: 0.634 Test Loss: 2.435 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.327470064163208
Epoch: 14, Steps: 13 | Train Loss: 0.018 Vali Loss: 2.173 Vali Acc: 0.707 Test Loss: 2.173 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.275860071182251
Epoch: 15, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.871 Vali Acc: 0.737 Test Loss: 1.871 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.9698078632354736
Epoch: 16, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.038 Vali Acc: 0.717 Test Loss: 2.038 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.4892468452453613
Epoch: 17, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.130 Vali Acc: 0.698 Test Loss: 2.130 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.094287157058716
Epoch: 18, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.251 Vali Acc: 0.702 Test Loss: 2.251 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.098803520202637
Epoch: 19, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.406 Vali Acc: 0.698 Test Loss: 2.406 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.89778208732605
Epoch: 20, Steps: 13 | Train Loss: 0.008 Vali Loss: 2.183 Vali Acc: 0.659 Test Loss: 2.183 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.4776041507720947
Epoch: 21, Steps: 13 | Train Loss: 0.016 Vali Loss: 2.375 Vali Acc: 0.712 Test Loss: 2.375 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.220081329345703
Epoch: 22, Steps: 13 | Train Loss: 0.006 Vali Loss: 2.658 Vali Acc: 0.693 Test Loss: 2.658 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 8731650
model size : 33.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.242913007736206
Epoch: 1, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.574 Vali Acc: 0.717 Test Loss: 0.574 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.1519389152526855
Epoch: 2, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.622 Vali Acc: 0.746 Test Loss: 0.622 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746335).  Saving model ...
Epoch: 3 cost time: 2.399454116821289
Epoch: 3, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.599 Vali Acc: 0.741 Test Loss: 0.599 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.581928014755249
Epoch: 4, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.640 Vali Acc: 0.712 Test Loss: 0.640 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9214107990264893
Epoch: 5, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.726 Vali Acc: 0.741 Test Loss: 0.726 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.041461944580078
Epoch: 6, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.825 Vali Acc: 0.746 Test Loss: 0.825 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.7922818660736084
Epoch: 7, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.822 Vali Acc: 0.663 Test Loss: 0.822 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.51761531829834
Epoch: 8, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.997 Vali Acc: 0.732 Test Loss: 0.997 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.522243022918701
Epoch: 9, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.956 Vali Acc: 0.707 Test Loss: 0.956 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.0546278953552246
Epoch: 10, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.992 Vali Acc: 0.683 Test Loss: 0.992 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.6885361671447754
Epoch: 11, Steps: 13 | Train Loss: 0.053 Vali Loss: 1.194 Vali Acc: 0.746 Test Loss: 1.194 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.1173927783966064
Epoch: 12, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.206 Vali Acc: 0.717 Test Loss: 1.206 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 8482434
model size : 32.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.956646680831909
Epoch: 1, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.572 Vali Acc: 0.722 Test Loss: 0.572 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 2.854618787765503
Epoch: 2, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.565 Vali Acc: 0.756 Test Loss: 0.565 Test Acc: 0.756
Validation loss decreased (-0.721946 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 2.739315986633301
Epoch: 3, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.566 Vali Acc: 0.732 Test Loss: 0.566 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1385340690612793
Epoch: 4, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.639 Vali Acc: 0.737 Test Loss: 0.639 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.679001808166504
Epoch: 5, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.665 Vali Acc: 0.693 Test Loss: 0.665 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.594797372817993
Epoch: 6, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.710 Vali Acc: 0.727 Test Loss: 0.710 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.132889986038208
Epoch: 7, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.783 Vali Acc: 0.732 Test Loss: 0.783 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.003176212310791
Epoch: 8, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.795 Vali Acc: 0.717 Test Loss: 0.795 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.8854377269744873
Epoch: 9, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.879 Vali Acc: 0.732 Test Loss: 0.879 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.62213134765625
Epoch: 10, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.784 Vali Acc: 0.693 Test Loss: 0.784 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.6341350078582764
Epoch: 11, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.917 Vali Acc: 0.707 Test Loss: 0.917 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.953878164291382
Epoch: 12, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.150 Vali Acc: 0.712 Test Loss: 1.150 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 8404994
model size : 32.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.587850332260132
Epoch: 1, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.586 Vali Acc: 0.727 Test Loss: 0.586 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 3.136090040206909
Epoch: 2, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.557 Vali Acc: 0.751 Test Loss: 0.557 Test Acc: 0.751
Validation loss decreased (-0.726823 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 2.374344825744629
Epoch: 3, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.573 Vali Acc: 0.751 Test Loss: 0.573 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6993730068206787
Epoch: 4, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.646 Vali Acc: 0.741 Test Loss: 0.646 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.801499366760254
Epoch: 5, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.587 Vali Acc: 0.732 Test Loss: 0.587 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.757192611694336
Epoch: 6, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.686 Vali Acc: 0.727 Test Loss: 0.686 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.0503671169281006
Epoch: 7, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.746 Vali Acc: 0.737 Test Loss: 0.746 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.285004138946533
Epoch: 8, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.682 Vali Acc: 0.707 Test Loss: 0.682 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.618593454360962
Epoch: 9, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.785 Vali Acc: 0.737 Test Loss: 0.785 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.501859426498413
Epoch: 10, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.692 Vali Acc: 0.678 Test Loss: 0.692 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.6779403686523438
Epoch: 11, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.053 Vali Acc: 0.717 Test Loss: 1.053 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.7230727672576904
Epoch: 12, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.989 Vali Acc: 0.673 Test Loss: 0.989 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 8358786
model size : 32.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.014647483825684
Epoch: 1, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.581 Vali Acc: 0.727 Test Loss: 0.581 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 2.1227598190307617
Epoch: 2, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.574 Vali Acc: 0.732 Test Loss: 0.574 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 2.4183413982391357
Epoch: 3, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.549 Vali Acc: 0.766 Test Loss: 0.549 Test Acc: 0.766
Validation loss decreased (-0.731702 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 2.6714251041412354
Epoch: 4, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.586 Vali Acc: 0.746 Test Loss: 0.586 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4993083477020264
Epoch: 5, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.584 Vali Acc: 0.741 Test Loss: 0.584 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.142354726791382
Epoch: 6, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.589 Vali Acc: 0.746 Test Loss: 0.589 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7867882251739502
Epoch: 7, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.606 Vali Acc: 0.737 Test Loss: 0.606 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.619020938873291
Epoch: 8, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.633 Vali Acc: 0.722 Test Loss: 0.633 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.680753231048584
Epoch: 9, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.623 Vali Acc: 0.732 Test Loss: 0.623 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.97059965133667
Epoch: 10, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.783 Vali Acc: 0.756 Test Loss: 0.783 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.2681989669799805
Epoch: 11, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.738 Vali Acc: 0.654 Test Loss: 0.738 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.6241703033447266
Epoch: 12, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.753 Vali Acc: 0.741 Test Loss: 0.753 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.4537715911865234
Epoch: 13, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.910 Vali Acc: 0.732 Test Loss: 0.910 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 8313218
model size : 31.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.83282208442688
Epoch: 1, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.446136236190796
Epoch: 2, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.570 Vali Acc: 0.722 Test Loss: 0.570 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 2.4860713481903076
Epoch: 3, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.560 Vali Acc: 0.746 Test Loss: 0.560 Test Acc: 0.746
Validation loss decreased (-0.721946 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 2.080352306365967
Epoch: 4, Steps: 13 | Train Loss: 0.335 Vali Loss: 0.551 Vali Acc: 0.761 Test Loss: 0.551 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 2.2768008708953857
Epoch: 5, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.532 Vali Acc: 0.751 Test Loss: 0.532 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.788749933242798
Epoch: 6, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.583 Vali Acc: 0.751 Test Loss: 0.583 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2921650409698486
Epoch: 7, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.632 Vali Acc: 0.732 Test Loss: 0.632 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3590073585510254
Epoch: 8, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.592 Vali Acc: 0.741 Test Loss: 0.592 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.3176703453063965
Epoch: 9, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.627 Vali Acc: 0.746 Test Loss: 0.627 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.252256155014038
Epoch: 10, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.570 Vali Acc: 0.746 Test Loss: 0.570 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.1631767749786377
Epoch: 11, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.684 Vali Acc: 0.746 Test Loss: 0.684 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.7079827785491943
Epoch: 12, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.709 Vali Acc: 0.751 Test Loss: 0.709 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.6368391513824463
Epoch: 13, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.710 Vali Acc: 0.732 Test Loss: 0.710 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.3650922775268555
Epoch: 14, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.624 Vali Acc: 0.746 Test Loss: 0.624 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 8283266
model size : 31.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8981146812438965
Epoch: 1, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.255411148071289
Epoch: 2, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.622 Vali Acc: 0.712 Test Loss: 0.622 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9895341396331787
Epoch: 3, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.600 Vali Acc: 0.761 Test Loss: 0.600 Test Acc: 0.761
Validation loss decreased (-0.721945 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 1.9127209186553955
Epoch: 4, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.532 Vali Acc: 0.741 Test Loss: 0.532 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0234060287475586
Epoch: 5, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.529 Vali Acc: 0.746 Test Loss: 0.529 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7835557460784912
Epoch: 6, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.544 Vali Acc: 0.737 Test Loss: 0.544 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.761284351348877
Epoch: 7, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.546 Vali Acc: 0.746 Test Loss: 0.546 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.972341537475586
Epoch: 8, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.550 Vali Acc: 0.756 Test Loss: 0.550 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.3819596767425537
Epoch: 9, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.571 Vali Acc: 0.746 Test Loss: 0.571 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.177568197250366
Epoch: 10, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.563 Vali Acc: 0.737 Test Loss: 0.563 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.0506818294525146
Epoch: 11, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.571 Vali Acc: 0.751 Test Loss: 0.571 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.987522840499878
Epoch: 12, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.594 Vali Acc: 0.761 Test Loss: 0.594 Test Acc: 0.761
Validation loss decreased (-0.760970 --> -0.760970).  Saving model ...
Epoch: 13 cost time: 2.145404100418091
Epoch: 13, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.620 Vali Acc: 0.746 Test Loss: 0.620 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.241708993911743
Epoch: 14, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.629 Vali Acc: 0.741 Test Loss: 0.629 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.8408219814300537
Epoch: 15, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.693 Vali Acc: 0.751 Test Loss: 0.693 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.7224252223968506
Epoch: 16, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.706 Vali Acc: 0.722 Test Loss: 0.706 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.5761640071868896
Epoch: 17, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.713 Vali Acc: 0.761 Test Loss: 0.713 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.5936710834503174
Epoch: 18, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.739 Vali Acc: 0.727 Test Loss: 0.739 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.7866756916046143
Epoch: 19, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.692 Vali Acc: 0.732 Test Loss: 0.692 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.6461470127105713
Epoch: 20, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.855 Vali Acc: 0.727 Test Loss: 0.855 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.67612624168396
Epoch: 21, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.807 Vali Acc: 0.727 Test Loss: 0.807 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.8206393718719482
Epoch: 22, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.815 Vali Acc: 0.722 Test Loss: 0.815 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 8268994
model size : 31.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6269114017486572
Epoch: 1, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.586 Vali Acc: 0.722 Test Loss: 0.586 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.300762414932251
Epoch: 2, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.580 Vali Acc: 0.727 Test Loss: 0.580 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 2.2846429347991943
Epoch: 3, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.566 Vali Acc: 0.717 Test Loss: 0.566 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4879212379455566
Epoch: 4, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.653 Vali Acc: 0.707 Test Loss: 0.653 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.339444875717163
Epoch: 5, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.642 Vali Acc: 0.722 Test Loss: 0.642 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0667688846588135
Epoch: 6, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.660 Vali Acc: 0.727 Test Loss: 0.660 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.972425937652588
Epoch: 7, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.804 Vali Acc: 0.722 Test Loss: 0.804 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.073302984237671
Epoch: 8, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.074 Vali Acc: 0.717 Test Loss: 1.074 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.141509532928467
Epoch: 9, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.882 Vali Acc: 0.673 Test Loss: 0.882 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.1842100620269775
Epoch: 10, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.051 Vali Acc: 0.727 Test Loss: 1.051 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7775976657867432
Epoch: 11, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.160 Vali Acc: 0.727 Test Loss: 1.160 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7318873405456543
Epoch: 12, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.130 Vali Acc: 0.698 Test Loss: 1.130 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 3112450
model size : 11.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.470348834991455
Epoch: 1, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.573 Vali Acc: 0.722 Test Loss: 0.573 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.8910138607025146
Epoch: 2, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.571 Vali Acc: 0.737 Test Loss: 0.571 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 2.0720789432525635
Epoch: 3, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.557 Vali Acc: 0.737 Test Loss: 0.557 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 2.0398099422454834
Epoch: 4, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.606 Vali Acc: 0.737 Test Loss: 0.606 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9239919185638428
Epoch: 5, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.685 Vali Acc: 0.727 Test Loss: 0.685 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7431671619415283
Epoch: 6, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.727 Vali Acc: 0.707 Test Loss: 0.727 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6669831275939941
Epoch: 7, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.761 Vali Acc: 0.741 Test Loss: 0.761 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741456).  Saving model ...
Epoch: 8 cost time: 1.792436122894287
Epoch: 8, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.738 Vali Acc: 0.722 Test Loss: 0.738 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9380857944488525
Epoch: 9, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.730 Vali Acc: 0.702 Test Loss: 0.730 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2237977981567383
Epoch: 10, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.829 Vali Acc: 0.732 Test Loss: 0.829 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5570428371429443
Epoch: 11, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.843 Vali Acc: 0.673 Test Loss: 0.843 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.596186637878418
Epoch: 12, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.806 Vali Acc: 0.751 Test Loss: 0.806 Test Acc: 0.751
Validation loss decreased (-0.741456 --> -0.751211).  Saving model ...
Epoch: 13 cost time: 1.5647900104522705
Epoch: 13, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.747 Vali Acc: 0.707 Test Loss: 0.747 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9163668155670166
Epoch: 14, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.850 Vali Acc: 0.698 Test Loss: 0.850 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3327789306640625
Epoch: 15, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.251 Vali Acc: 0.746 Test Loss: 1.251 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2403037548065186
Epoch: 16, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.023 Vali Acc: 0.712 Test Loss: 1.023 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.145206928253174
Epoch: 17, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.011 Vali Acc: 0.722 Test Loss: 1.011 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.958096981048584
Epoch: 18, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.003 Vali Acc: 0.722 Test Loss: 1.003 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0462899208068848
Epoch: 19, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.099 Vali Acc: 0.624 Test Loss: 1.099 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.163942575454712
Epoch: 20, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.391 Vali Acc: 0.751 Test Loss: 1.391 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9592697620391846
Epoch: 21, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.526 Vali Acc: 0.576 Test Loss: 1.526 Test Acc: 0.576
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8362727165222168
Epoch: 22, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.637 Vali Acc: 0.712 Test Loss: 1.637 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 2987842
model size : 11.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.697136640548706
Epoch: 1, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.594 Vali Acc: 0.717 Test Loss: 0.594 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.005890130996704
Epoch: 2, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.569 Vali Acc: 0.737 Test Loss: 0.569 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.6709771156311035
Epoch: 3, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.607 Vali Acc: 0.751 Test Loss: 0.607 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751213).  Saving model ...
Epoch: 4 cost time: 1.7332086563110352
Epoch: 4, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.557 Vali Acc: 0.737 Test Loss: 0.557 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8625760078430176
Epoch: 5, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.592 Vali Acc: 0.712 Test Loss: 0.592 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.794177770614624
Epoch: 6, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.601 Vali Acc: 0.722 Test Loss: 0.601 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6777188777923584
Epoch: 7, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.682 Vali Acc: 0.717 Test Loss: 0.682 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.789299488067627
Epoch: 8, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.700 Vali Acc: 0.712 Test Loss: 0.700 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6363754272460938
Epoch: 9, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.634 Vali Acc: 0.712 Test Loss: 0.634 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4229772090911865
Epoch: 10, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.660 Vali Acc: 0.727 Test Loss: 0.660 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6150660514831543
Epoch: 11, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.636 Vali Acc: 0.698 Test Loss: 0.636 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.3129992485046387
Epoch: 12, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.641 Vali Acc: 0.722 Test Loss: 0.641 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.1553046703338623
Epoch: 13, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.705 Vali Acc: 0.727 Test Loss: 0.705 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 2949122
model size : 11.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6681835651397705
Epoch: 1, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.605 Vali Acc: 0.722 Test Loss: 0.605 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.8655846118927002
Epoch: 2, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.604 Vali Acc: 0.722 Test Loss: 0.604 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.9196815490722656
Epoch: 3, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.547 Vali Acc: 0.751 Test Loss: 0.547 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 1.7655737400054932
Epoch: 4, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.541 Vali Acc: 0.737 Test Loss: 0.541 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.280712604522705
Epoch: 5, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.563 Vali Acc: 0.722 Test Loss: 0.563 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7356534004211426
Epoch: 6, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.581 Vali Acc: 0.727 Test Loss: 0.581 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.579305648803711
Epoch: 7, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.617 Vali Acc: 0.737 Test Loss: 0.617 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5300474166870117
Epoch: 8, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.584 Vali Acc: 0.712 Test Loss: 0.584 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6505236625671387
Epoch: 9, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.593 Vali Acc: 0.722 Test Loss: 0.593 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.449873685836792
Epoch: 10, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.611 Vali Acc: 0.707 Test Loss: 0.611 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5994312763214111
Epoch: 11, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.655 Vali Acc: 0.717 Test Loss: 0.655 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6166553497314453
Epoch: 12, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.693 Vali Acc: 0.717 Test Loss: 0.693 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.739151954650879
Epoch: 13, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.643 Vali Acc: 0.727 Test Loss: 0.643 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 2926018
model size : 11.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3347277641296387
Epoch: 1, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.615 Vali Acc: 0.722 Test Loss: 0.615 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.5298187732696533
Epoch: 2, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.578 Vali Acc: 0.717 Test Loss: 0.578 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5417017936706543
Epoch: 3, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.591 Vali Acc: 0.732 Test Loss: 0.591 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 4 cost time: 1.701434850692749
Epoch: 4, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.605 Vali Acc: 0.746 Test Loss: 0.605 Test Acc: 0.746
Validation loss decreased (-0.731701 --> -0.746335).  Saving model ...
Epoch: 5 cost time: 1.707841157913208
Epoch: 5, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.600 Vali Acc: 0.732 Test Loss: 0.600 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.944643259048462
Epoch: 6, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.566 Vali Acc: 0.737 Test Loss: 0.566 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9672060012817383
Epoch: 7, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.559 Vali Acc: 0.722 Test Loss: 0.559 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.759082317352295
Epoch: 8, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.721024751663208
Epoch: 9, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.609 Vali Acc: 0.717 Test Loss: 0.609 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.955439567565918
Epoch: 10, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.581 Vali Acc: 0.717 Test Loss: 0.581 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.955125331878662
Epoch: 11, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.625 Vali Acc: 0.727 Test Loss: 0.625 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8235087394714355
Epoch: 12, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.600 Vali Acc: 0.727 Test Loss: 0.600 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8217496871948242
Epoch: 13, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.610 Vali Acc: 0.722 Test Loss: 0.610 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7187235355377197
Epoch: 14, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.657 Vali Acc: 0.727 Test Loss: 0.657 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 2903234
model size : 11.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7160699367523193
Epoch: 1, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.625 Vali Acc: 0.727 Test Loss: 0.625 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.5029776096343994
Epoch: 2, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.568 Vali Acc: 0.717 Test Loss: 0.568 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.692946195602417
Epoch: 3, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.623 Vali Acc: 0.727 Test Loss: 0.623 Test Acc: 0.727
Validation loss decreased (-0.726823 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 1.5858135223388672
Epoch: 4, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.546 Vali Acc: 0.741 Test Loss: 0.546 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 1.7215206623077393
Epoch: 5, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.543 Vali Acc: 0.737 Test Loss: 0.543 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7559781074523926
Epoch: 6, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.594 Vali Acc: 0.746 Test Loss: 0.594 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 1.7529101371765137
Epoch: 7, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.576 Vali Acc: 0.732 Test Loss: 0.576 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9415512084960938
Epoch: 8, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.545 Vali Acc: 0.727 Test Loss: 0.545 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7311971187591553
Epoch: 9, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.566 Vali Acc: 0.732 Test Loss: 0.566 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.830676555633545
Epoch: 10, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.582 Vali Acc: 0.727 Test Loss: 0.582 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5518436431884766
Epoch: 11, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.626 Vali Acc: 0.712 Test Loss: 0.626 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9345014095306396
Epoch: 12, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.618 Vali Acc: 0.722 Test Loss: 0.618 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.010831356048584
Epoch: 13, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.638 Vali Acc: 0.712 Test Loss: 0.638 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.895446538925171
Epoch: 14, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.625 Vali Acc: 0.707 Test Loss: 0.625 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7708594799041748
Epoch: 15, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.679 Vali Acc: 0.693 Test Loss: 0.679 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.863765001296997
Epoch: 16, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.719 Vali Acc: 0.707 Test Loss: 0.719 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 2888258
model size : 11.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.465754747390747
Epoch: 1, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.646 Vali Acc: 0.727 Test Loss: 0.646 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.6820919513702393
Epoch: 2, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6981284618377686
Epoch: 3, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.588 Vali Acc: 0.727 Test Loss: 0.588 Test Acc: 0.727
Validation loss decreased (-0.726823 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 1.6158771514892578
Epoch: 4, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.604 Vali Acc: 0.727 Test Loss: 0.604 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4958086013793945
Epoch: 5, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.588 Vali Acc: 0.737 Test Loss: 0.588 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736579).  Saving model ...
Epoch: 6 cost time: 1.5111212730407715
Epoch: 6, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.575 Vali Acc: 0.732 Test Loss: 0.575 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4869184494018555
Epoch: 7, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.586 Vali Acc: 0.737 Test Loss: 0.586 Test Acc: 0.737
Validation loss decreased (-0.736579 --> -0.736580).  Saving model ...
Epoch: 8 cost time: 1.6458089351654053
Epoch: 8, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.586 Vali Acc: 0.746 Test Loss: 0.586 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 9 cost time: 1.55708646774292
Epoch: 9, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.583 Vali Acc: 0.737 Test Loss: 0.583 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6056663990020752
Epoch: 10, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.605 Vali Acc: 0.741 Test Loss: 0.605 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4312739372253418
Epoch: 11, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.582 Vali Acc: 0.732 Test Loss: 0.582 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.461719036102295
Epoch: 12, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.637 Vali Acc: 0.732 Test Loss: 0.637 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5395736694335938
Epoch: 13, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.705 Vali Acc: 0.737 Test Loss: 0.705 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4664058685302734
Epoch: 14, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.680 Vali Acc: 0.732 Test Loss: 0.680 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5355303287506104
Epoch: 15, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.832 Vali Acc: 0.727 Test Loss: 0.832 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4923985004425049
Epoch: 16, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.719 Vali Acc: 0.732 Test Loss: 0.719 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4217751026153564
Epoch: 17, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.669 Vali Acc: 0.727 Test Loss: 0.669 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6928126811981201
Epoch: 18, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.722 Vali Acc: 0.737 Test Loss: 0.722 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 2881122
model size : 11.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 10.707801342010498
Epoch: 1, Steps: 13 | Train Loss: 0.757 Vali Loss: 0.607 Vali Acc: 0.737 Test Loss: 0.607 Test Acc: 0.737
Validation loss decreased (inf --> -0.736579).  Saving model ...
Epoch: 2 cost time: 8.126744985580444
Epoch: 2, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.595 Vali Acc: 0.727 Test Loss: 0.595 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.136330842971802
Epoch: 3, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.758 Vali Acc: 0.649 Test Loss: 0.758 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.161398649215698
Epoch: 4, Steps: 13 | Train Loss: 0.069 Vali Loss: 1.151 Vali Acc: 0.527 Test Loss: 1.151 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.405354261398315
Epoch: 5, Steps: 13 | Train Loss: 0.113 Vali Loss: 1.049 Vali Acc: 0.668 Test Loss: 1.049 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.255661725997925
Epoch: 6, Steps: 13 | Train Loss: 0.133 Vali Loss: 1.183 Vali Acc: 0.712 Test Loss: 1.183 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.056427717208862
Epoch: 7, Steps: 13 | Train Loss: 0.081 Vali Loss: 1.914 Vali Acc: 0.556 Test Loss: 1.914 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.866992712020874
Epoch: 8, Steps: 13 | Train Loss: 0.090 Vali Loss: 2.567 Vali Acc: 0.698 Test Loss: 2.567 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.653942108154297
Epoch: 9, Steps: 13 | Train Loss: 0.079 Vali Loss: 1.510 Vali Acc: 0.663 Test Loss: 1.510 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 8.697762966156006
Epoch: 10, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.925 Vali Acc: 0.702 Test Loss: 1.925 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.143735408782959
Epoch: 11, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.823 Vali Acc: 0.678 Test Loss: 1.823 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 27396610
model size : 104.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.143286228179932
Epoch: 1, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.581 Vali Acc: 0.732 Test Loss: 0.581 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 5.184372186660767
Epoch: 2, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.594 Vali Acc: 0.727 Test Loss: 0.594 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.276496887207031
Epoch: 3, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.770 Vali Acc: 0.707 Test Loss: 0.770 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.382817268371582
Epoch: 4, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.815 Vali Acc: 0.688 Test Loss: 0.815 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.969898462295532
Epoch: 5, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.070 Vali Acc: 0.727 Test Loss: 1.070 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.217540502548218
Epoch: 6, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.028 Vali Acc: 0.678 Test Loss: 1.028 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.8070573806762695
Epoch: 7, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.178 Vali Acc: 0.722 Test Loss: 1.178 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.693806171417236
Epoch: 8, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.273 Vali Acc: 0.717 Test Loss: 1.273 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.68123197555542
Epoch: 9, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.333 Vali Acc: 0.712 Test Loss: 1.333 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.8589746952056885
Epoch: 10, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.472 Vali Acc: 0.571 Test Loss: 1.472 Test Acc: 0.571
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.904838800430298
Epoch: 11, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.551 Vali Acc: 0.649 Test Loss: 1.551 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 26898178
model size : 103.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.7775866985321045
Epoch: 1, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.565 Vali Acc: 0.722 Test Loss: 0.565 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 4.5237181186676025
Epoch: 2, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.556 Vali Acc: 0.707 Test Loss: 0.556 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.016278505325317
Epoch: 3, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.667 Vali Acc: 0.737 Test Loss: 0.667 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 3.846750020980835
Epoch: 4, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.727 Vali Acc: 0.693 Test Loss: 0.727 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.580206871032715
Epoch: 5, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.786 Vali Acc: 0.732 Test Loss: 0.786 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.916849136352539
Epoch: 6, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.961 Vali Acc: 0.722 Test Loss: 0.961 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.342453956604004
Epoch: 7, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.796 Vali Acc: 0.688 Test Loss: 0.796 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.971966981887817
Epoch: 8, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.829 Vali Acc: 0.712 Test Loss: 0.829 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.351186275482178
Epoch: 9, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.206 Vali Acc: 0.702 Test Loss: 1.206 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.864670276641846
Epoch: 10, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.171 Vali Acc: 0.688 Test Loss: 1.171 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.852684736251831
Epoch: 11, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.223 Vali Acc: 0.693 Test Loss: 1.223 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.5773868560791016
Epoch: 12, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.552 Vali Acc: 0.702 Test Loss: 1.552 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.363850831985474
Epoch: 13, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.776 Vali Acc: 0.663 Test Loss: 1.776 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 26743298
model size : 102.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.452530145645142
Epoch: 1, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.568 Vali Acc: 0.717 Test Loss: 0.568 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.979344606399536
Epoch: 2, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.549 Vali Acc: 0.732 Test Loss: 0.549 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 4.167766332626343
Epoch: 3, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.616 Vali Acc: 0.727 Test Loss: 0.616 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.462609052658081
Epoch: 4, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.674 Vali Acc: 0.722 Test Loss: 0.674 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.5613338947296143
Epoch: 5, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.900 Vali Acc: 0.717 Test Loss: 0.900 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.961979866027832
Epoch: 6, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.839 Vali Acc: 0.610 Test Loss: 0.839 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.025002479553223
Epoch: 7, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.699 Vali Acc: 0.722 Test Loss: 0.699 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.161504507064819
Epoch: 8, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.957 Vali Acc: 0.737 Test Loss: 0.957 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736576).  Saving model ...
Epoch: 9 cost time: 4.445978403091431
Epoch: 9, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.824 Vali Acc: 0.698 Test Loss: 0.824 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.135497331619263
Epoch: 10, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.019 Vali Acc: 0.727 Test Loss: 1.019 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.24268913269043
Epoch: 11, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.068 Vali Acc: 0.712 Test Loss: 1.068 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.241787672042847
Epoch: 12, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.066 Vali Acc: 0.673 Test Loss: 1.066 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.652440071105957
Epoch: 13, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.273 Vali Acc: 0.741 Test Loss: 1.273 Test Acc: 0.741
Validation loss decreased (-0.736576 --> -0.741451).  Saving model ...
Epoch: 14 cost time: 3.8937838077545166
Epoch: 14, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.206 Vali Acc: 0.678 Test Loss: 1.206 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.27258563041687
Epoch: 15, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.386 Vali Acc: 0.712 Test Loss: 1.386 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.9118878841400146
Epoch: 16, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.354 Vali Acc: 0.698 Test Loss: 1.354 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.503016471862793
Epoch: 17, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.543 Vali Acc: 0.727 Test Loss: 1.543 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.612037897109985
Epoch: 18, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.539 Vali Acc: 0.702 Test Loss: 1.539 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.004030466079712
Epoch: 19, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.428 Vali Acc: 0.683 Test Loss: 1.428 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.4581286907196045
Epoch: 20, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.399 Vali Acc: 0.707 Test Loss: 1.399 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.7429347038269043
Epoch: 21, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.374 Vali Acc: 0.683 Test Loss: 1.374 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.7725141048431396
Epoch: 22, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.445 Vali Acc: 0.722 Test Loss: 1.445 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.802802801132202
Epoch: 23, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.567 Vali Acc: 0.693 Test Loss: 1.567 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 26650882
model size : 102.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.171360969543457
Epoch: 1, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.9187605381011963
Epoch: 2, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.612 Vali Acc: 0.751 Test Loss: 0.612 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751213).  Saving model ...
Epoch: 3 cost time: 3.818969488143921
Epoch: 3, Steps: 13 | Train Loss: 0.335 Vali Loss: 0.564 Vali Acc: 0.751 Test Loss: 0.564 Test Acc: 0.751
Validation loss decreased (-0.751213 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 4.035008192062378
Epoch: 4, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.663 Vali Acc: 0.717 Test Loss: 0.663 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.1246497631073
Epoch: 5, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.821 Vali Acc: 0.737 Test Loss: 0.821 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.737840175628662
Epoch: 6, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.888 Vali Acc: 0.746 Test Loss: 0.888 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.991255044937134
Epoch: 7, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.803 Vali Acc: 0.600 Test Loss: 0.803 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.978611707687378
Epoch: 8, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.912 Vali Acc: 0.732 Test Loss: 0.912 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.6995797157287598
Epoch: 9, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.912 Vali Acc: 0.649 Test Loss: 0.912 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.5910918712615967
Epoch: 10, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.447 Vali Acc: 0.707 Test Loss: 1.447 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.676358699798584
Epoch: 11, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.141 Vali Acc: 0.615 Test Loss: 1.141 Test Acc: 0.615
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.546064853668213
Epoch: 12, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.214 Vali Acc: 0.722 Test Loss: 1.214 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.600828170776367
Epoch: 13, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.064 Vali Acc: 0.707 Test Loss: 1.064 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 26559746
model size : 101.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.165297985076904
Epoch: 1, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.576 Vali Acc: 0.727 Test Loss: 0.576 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 2.94704270362854
Epoch: 2, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.558 Vali Acc: 0.746 Test Loss: 0.558 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 3.280144214630127
Epoch: 3, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.541 Vali Acc: 0.732 Test Loss: 0.541 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4838411808013916
Epoch: 4, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.589 Vali Acc: 0.746 Test Loss: 0.589 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3298211097717285
Epoch: 5, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.586 Vali Acc: 0.722 Test Loss: 0.586 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.137279748916626
Epoch: 6, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.649 Vali Acc: 0.702 Test Loss: 0.649 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.4248671531677246
Epoch: 7, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.744 Vali Acc: 0.732 Test Loss: 0.744 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.536471128463745
Epoch: 8, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.734 Vali Acc: 0.737 Test Loss: 0.734 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.3407645225524902
Epoch: 9, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.720 Vali Acc: 0.698 Test Loss: 0.720 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.4866740703582764
Epoch: 10, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.736 Vali Acc: 0.663 Test Loss: 0.736 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.5734734535217285
Epoch: 11, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.972 Vali Acc: 0.722 Test Loss: 0.972 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.357135534286499
Epoch: 12, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.981 Vali Acc: 0.634 Test Loss: 0.981 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 26499842
model size : 101.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.819247245788574
Epoch: 1, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.587 Vali Acc: 0.737 Test Loss: 0.587 Test Acc: 0.737
Validation loss decreased (inf --> -0.736579).  Saving model ...
Epoch: 2 cost time: 3.109682559967041
Epoch: 2, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.646 Vali Acc: 0.741 Test Loss: 0.646 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 3.1952016353607178
Epoch: 3, Steps: 13 | Train Loss: 0.346 Vali Loss: 0.616 Vali Acc: 0.741 Test Loss: 0.616 Test Acc: 0.741
Validation loss decreased (-0.741457 --> -0.741457).  Saving model ...
Epoch: 4 cost time: 2.9156429767608643
Epoch: 4, Steps: 13 | Train Loss: 0.247 Vali Loss: 0.555 Vali Acc: 0.717 Test Loss: 0.555 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2487969398498535
Epoch: 5, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.556 Vali Acc: 0.727 Test Loss: 0.556 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.334111213684082
Epoch: 6, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.600 Vali Acc: 0.746 Test Loss: 0.600 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746335).  Saving model ...
Epoch: 7 cost time: 2.884500741958618
Epoch: 7, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.651 Vali Acc: 0.746 Test Loss: 0.651 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5546724796295166
Epoch: 8, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.715 Vali Acc: 0.732 Test Loss: 0.715 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.0108799934387207
Epoch: 9, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.658 Vali Acc: 0.727 Test Loss: 0.658 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.0869839191436768
Epoch: 10, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.657 Vali Acc: 0.717 Test Loss: 0.657 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.691354751586914
Epoch: 11, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.770 Vali Acc: 0.673 Test Loss: 0.770 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.447965145111084
Epoch: 12, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.859 Vali Acc: 0.737 Test Loss: 0.859 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.8362338542938232
Epoch: 13, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.762 Vali Acc: 0.683 Test Loss: 0.762 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.893447160720825
Epoch: 14, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.929 Vali Acc: 0.732 Test Loss: 0.929 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.7789130210876465
Epoch: 15, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.838 Vali Acc: 0.688 Test Loss: 0.838 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.829871892929077
Epoch: 16, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.836 Vali Acc: 0.741 Test Loss: 0.836 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 26471298
model size : 101.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.84803581237793
Epoch: 1, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.646 Vali Acc: 0.717 Test Loss: 0.646 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.846571445465088
Epoch: 2, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.597 Vali Acc: 0.702 Test Loss: 0.597 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.265228509902954
Epoch: 3, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.813 Vali Acc: 0.717 Test Loss: 0.813 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.635767936706543
Epoch: 4, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.780 Vali Acc: 0.707 Test Loss: 0.780 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.3789727687835693
Epoch: 5, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.869 Vali Acc: 0.707 Test Loss: 0.869 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.993286371231079
Epoch: 6, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.114 Vali Acc: 0.737 Test Loss: 1.114 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736574).  Saving model ...
Epoch: 7 cost time: 3.1985161304473877
Epoch: 7, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.105 Vali Acc: 0.732 Test Loss: 1.105 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.562840223312378
Epoch: 8, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.277 Vali Acc: 0.746 Test Loss: 1.277 Test Acc: 0.746
Validation loss decreased (-0.736574 --> -0.746329).  Saving model ...
Epoch: 9 cost time: 3.268888473510742
Epoch: 9, Steps: 13 | Train Loss: 0.048 Vali Loss: 1.237 Vali Acc: 0.668 Test Loss: 1.237 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.249478578567505
Epoch: 10, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.295 Vali Acc: 0.688 Test Loss: 1.295 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.900435209274292
Epoch: 11, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.568 Vali Acc: 0.683 Test Loss: 1.568 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.116811513900757
Epoch: 12, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.427 Vali Acc: 0.673 Test Loss: 1.427 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.6312718391418457
Epoch: 13, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.605 Vali Acc: 0.702 Test Loss: 1.605 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.715216636657715
Epoch: 14, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.569 Vali Acc: 0.702 Test Loss: 1.569 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.2711689472198486
Epoch: 15, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.646 Vali Acc: 0.712 Test Loss: 1.646 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.296844244003296
Epoch: 16, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.559 Vali Acc: 0.683 Test Loss: 1.559 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.2804930210113525
Epoch: 17, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.800 Vali Acc: 0.722 Test Loss: 1.800 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.788181781768799
Epoch: 18, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.802 Vali Acc: 0.693 Test Loss: 1.802 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 8684802
model size : 33.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.5319504737854
Epoch: 1, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.89384388923645
Epoch: 2, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.620 Vali Acc: 0.751 Test Loss: 0.620 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751213).  Saving model ...
Epoch: 3 cost time: 2.2625057697296143
Epoch: 3, Steps: 13 | Train Loss: 0.346 Vali Loss: 0.602 Vali Acc: 0.732 Test Loss: 0.602 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6105639934539795
Epoch: 4, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.646 Vali Acc: 0.693 Test Loss: 0.646 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.7937445640563965
Epoch: 5, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.717 Vali Acc: 0.624 Test Loss: 0.717 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.132408618927002
Epoch: 6, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.671 Vali Acc: 0.722 Test Loss: 0.671 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.757822036743164
Epoch: 7, Steps: 13 | Train Loss: 0.076 Vali Loss: 1.142 Vali Acc: 0.746 Test Loss: 1.142 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.25110125541687
Epoch: 8, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.835 Vali Acc: 0.732 Test Loss: 0.835 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.779019355773926
Epoch: 9, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.883 Vali Acc: 0.756 Test Loss: 0.883 Test Acc: 0.756
Validation loss decreased (-0.751213 --> -0.756089).  Saving model ...
Epoch: 10 cost time: 3.2947592735290527
Epoch: 10, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.780 Vali Acc: 0.746 Test Loss: 0.780 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.099080801010132
Epoch: 11, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.812 Vali Acc: 0.717 Test Loss: 0.812 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.408088207244873
Epoch: 12, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.983 Vali Acc: 0.722 Test Loss: 0.983 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.357771158218384
Epoch: 13, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.106 Vali Acc: 0.688 Test Loss: 1.106 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.571723222732544
Epoch: 14, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.201 Vali Acc: 0.688 Test Loss: 1.201 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.0797500610351562
Epoch: 15, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.303 Vali Acc: 0.702 Test Loss: 1.303 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.7793195247650146
Epoch: 16, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.200 Vali Acc: 0.654 Test Loss: 1.200 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.7670023441314697
Epoch: 17, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.563 Vali Acc: 0.751 Test Loss: 1.563 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.49570894241333
Epoch: 18, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.469 Vali Acc: 0.654 Test Loss: 1.469 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.5458126068115234
Epoch: 19, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.491 Vali Acc: 0.722 Test Loss: 1.491 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 8435586
model size : 32.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.015511751174927
Epoch: 1, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.577 Vali Acc: 0.717 Test Loss: 0.577 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.706076145172119
Epoch: 2, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.606 Vali Acc: 0.761 Test Loss: 0.606 Test Acc: 0.761
Validation loss decreased (-0.717067 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 2.6183114051818848
Epoch: 3, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.551 Vali Acc: 0.741 Test Loss: 0.551 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.266541004180908
Epoch: 4, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.688 Vali Acc: 0.732 Test Loss: 0.688 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.520669937133789
Epoch: 5, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.852 Vali Acc: 0.639 Test Loss: 0.852 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6356022357940674
Epoch: 6, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.745 Vali Acc: 0.712 Test Loss: 0.745 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.614661931991577
Epoch: 7, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.799 Vali Acc: 0.737 Test Loss: 0.799 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9602928161621094
Epoch: 8, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.716 Vali Acc: 0.712 Test Loss: 0.716 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.348466396331787
Epoch: 9, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.808 Vali Acc: 0.707 Test Loss: 0.808 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.356048822402954
Epoch: 10, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.886 Vali Acc: 0.698 Test Loss: 0.886 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.385006904602051
Epoch: 11, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.895 Vali Acc: 0.688 Test Loss: 0.895 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.099454164505005
Epoch: 12, Steps: 13 | Train Loss: 0.099 Vali Loss: 1.063 Vali Acc: 0.722 Test Loss: 1.063 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 8358146
model size : 32.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.537727117538452
Epoch: 1, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.4700229167938232
Epoch: 2, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.569 Vali Acc: 0.741 Test Loss: 0.569 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 2.5543644428253174
Epoch: 3, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.556 Vali Acc: 0.741 Test Loss: 0.556 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 2.0810325145721436
Epoch: 4, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.541 Vali Acc: 0.717 Test Loss: 0.541 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.411846876144409
Epoch: 5, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.581 Vali Acc: 0.717 Test Loss: 0.581 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.753098487854004
Epoch: 6, Steps: 13 | Train Loss: 0.134 Vali Loss: 0.669 Vali Acc: 0.732 Test Loss: 0.669 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5875115394592285
Epoch: 7, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.672 Vali Acc: 0.727 Test Loss: 0.672 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.27833890914917
Epoch: 8, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.625 Vali Acc: 0.698 Test Loss: 0.625 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0122387409210205
Epoch: 9, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.778 Vali Acc: 0.741 Test Loss: 0.778 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.2370176315307617
Epoch: 10, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.718 Vali Acc: 0.717 Test Loss: 0.718 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.821796178817749
Epoch: 11, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.772 Vali Acc: 0.727 Test Loss: 0.772 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.5444769859313965
Epoch: 12, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.706 Vali Acc: 0.707 Test Loss: 0.706 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.2555770874023438
Epoch: 13, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.843 Vali Acc: 0.727 Test Loss: 0.843 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 8311938
model size : 31.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.093181848526001
Epoch: 1, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.589 Vali Acc: 0.727 Test Loss: 0.589 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 2.142922878265381
Epoch: 2, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.585 Vali Acc: 0.737 Test Loss: 0.585 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 2.3865232467651367
Epoch: 3, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.564 Vali Acc: 0.751 Test Loss: 0.564 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 2.186896800994873
Epoch: 4, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.560 Vali Acc: 0.737 Test Loss: 0.560 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1952879428863525
Epoch: 5, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.608 Vali Acc: 0.741 Test Loss: 0.608 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.245884656906128
Epoch: 6, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.632 Vali Acc: 0.751 Test Loss: 0.632 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9112470149993896
Epoch: 7, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.654 Vali Acc: 0.737 Test Loss: 0.654 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.5124504566192627
Epoch: 8, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.678 Vali Acc: 0.654 Test Loss: 0.678 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.431248903274536
Epoch: 9, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.755 Vali Acc: 0.746 Test Loss: 0.755 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.0945091247558594
Epoch: 10, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.785 Vali Acc: 0.673 Test Loss: 0.785 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.2595040798187256
Epoch: 11, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.855 Vali Acc: 0.737 Test Loss: 0.855 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.1524603366851807
Epoch: 12, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.836 Vali Acc: 0.678 Test Loss: 0.836 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.4591500759124756
Epoch: 13, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.891 Vali Acc: 0.737 Test Loss: 0.891 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 8266370
model size : 31.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7909607887268066
Epoch: 1, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.614 Vali Acc: 0.722 Test Loss: 0.614 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.832608699798584
Epoch: 2, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.556 Vali Acc: 0.722 Test Loss: 0.556 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 2.014705181121826
Epoch: 3, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.599 Vali Acc: 0.766 Test Loss: 0.599 Test Acc: 0.766
Validation loss decreased (-0.721946 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 1.6809496879577637
Epoch: 4, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.551 Vali Acc: 0.741 Test Loss: 0.551 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.313056468963623
Epoch: 5, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.534 Vali Acc: 0.741 Test Loss: 0.534 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.44413685798645
Epoch: 6, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.576 Vali Acc: 0.741 Test Loss: 0.576 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3158118724823
Epoch: 7, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.585 Vali Acc: 0.737 Test Loss: 0.585 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.278411865234375
Epoch: 8, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.625 Vali Acc: 0.756 Test Loss: 0.625 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0333752632141113
Epoch: 9, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.633 Vali Acc: 0.756 Test Loss: 0.633 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.034471273422241
Epoch: 10, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.694 Vali Acc: 0.761 Test Loss: 0.694 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.1656007766723633
Epoch: 11, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.663 Vali Acc: 0.751 Test Loss: 0.663 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.1441972255706787
Epoch: 12, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.654 Vali Acc: 0.693 Test Loss: 0.654 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.441671133041382
Epoch: 13, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.666 Vali Acc: 0.746 Test Loss: 0.666 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 8236418
model size : 31.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7705488204956055
Epoch: 1, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.602 Vali Acc: 0.717 Test Loss: 0.602 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.8933870792388916
Epoch: 2, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.563 Vali Acc: 0.732 Test Loss: 0.563 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 2.0902957916259766
Epoch: 3, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.545 Vali Acc: 0.741 Test Loss: 0.545 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 2.239018201828003
Epoch: 4, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.534 Vali Acc: 0.766 Test Loss: 0.534 Test Acc: 0.766
Validation loss decreased (-0.741458 --> -0.765848).  Saving model ...
Epoch: 5 cost time: 2.4084174633026123
Epoch: 5, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.543 Vali Acc: 0.751 Test Loss: 0.543 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.388763666152954
Epoch: 6, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.531 Vali Acc: 0.746 Test Loss: 0.531 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2981858253479004
Epoch: 7, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.548 Vali Acc: 0.737 Test Loss: 0.548 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9132859706878662
Epoch: 8, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.562 Vali Acc: 0.737 Test Loss: 0.562 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.974611520767212
Epoch: 9, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.560 Vali Acc: 0.741 Test Loss: 0.560 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7791879177093506
Epoch: 10, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.597 Vali Acc: 0.732 Test Loss: 0.597 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8803629875183105
Epoch: 11, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.571 Vali Acc: 0.732 Test Loss: 0.571 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.918419599533081
Epoch: 12, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.643 Vali Acc: 0.746 Test Loss: 0.643 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.0519464015960693
Epoch: 13, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.666 Vali Acc: 0.712 Test Loss: 0.666 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.9547011852264404
Epoch: 14, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.680 Vali Acc: 0.737 Test Loss: 0.680 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 8222146
model size : 31.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.436997890472412
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.578 Vali Acc: 0.717 Test Loss: 0.578 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.641983985900879
Epoch: 2, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.625 Vali Acc: 0.717 Test Loss: 0.625 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6122736930847168
Epoch: 3, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.591 Vali Acc: 0.717 Test Loss: 0.591 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6640474796295166
Epoch: 4, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.664 Vali Acc: 0.722 Test Loss: 0.664 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 5 cost time: 1.7721531391143799
Epoch: 5, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.812 Vali Acc: 0.717 Test Loss: 0.812 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8291573524475098
Epoch: 6, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.836 Vali Acc: 0.673 Test Loss: 0.836 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6464037895202637
Epoch: 7, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.831 Vali Acc: 0.737 Test Loss: 0.831 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736577).  Saving model ...
Epoch: 8 cost time: 1.5775728225708008
Epoch: 8, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.884 Vali Acc: 0.722 Test Loss: 0.884 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5352964401245117
Epoch: 9, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.924 Vali Acc: 0.698 Test Loss: 0.924 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3752858638763428
Epoch: 10, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.032 Vali Acc: 0.727 Test Loss: 1.032 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.094832181930542
Epoch: 11, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.077 Vali Acc: 0.717 Test Loss: 1.077 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.0312914848327637
Epoch: 12, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.200 Vali Acc: 0.737 Test Loss: 1.200 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.794698715209961
Epoch: 13, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.947 Vali Acc: 0.654 Test Loss: 0.947 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.241748809814453
Epoch: 14, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.434 Vali Acc: 0.732 Test Loss: 1.434 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.2559008598327637
Epoch: 15, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.332 Vali Acc: 0.688 Test Loss: 1.332 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.1155803203582764
Epoch: 16, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.247 Vali Acc: 0.693 Test Loss: 1.247 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.0013346672058105
Epoch: 17, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.134 Vali Acc: 0.702 Test Loss: 1.134 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 3089026
model size : 11.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6562116146087646
Epoch: 1, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.580 Vali Acc: 0.717 Test Loss: 0.580 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.8147392272949219
Epoch: 2, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.593 Vali Acc: 0.751 Test Loss: 0.593 Test Acc: 0.751
Validation loss decreased (-0.717067 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.557318925857544
Epoch: 3, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.557 Vali Acc: 0.722 Test Loss: 0.557 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7654526233673096
Epoch: 4, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.553 Vali Acc: 0.732 Test Loss: 0.553 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7284247875213623
Epoch: 5, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.658 Vali Acc: 0.746 Test Loss: 0.658 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.599365234375
Epoch: 6, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.694 Vali Acc: 0.722 Test Loss: 0.694 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5430049896240234
Epoch: 7, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.719 Vali Acc: 0.751 Test Loss: 0.719 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.557131052017212
Epoch: 8, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.801 Vali Acc: 0.746 Test Loss: 0.801 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6565220355987549
Epoch: 9, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.747 Vali Acc: 0.737 Test Loss: 0.747 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9434592723846436
Epoch: 10, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.755 Vali Acc: 0.702 Test Loss: 0.755 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.935598373413086
Epoch: 11, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.939 Vali Acc: 0.727 Test Loss: 0.939 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7993531227111816
Epoch: 12, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.881 Vali Acc: 0.698 Test Loss: 0.881 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 2964418
model size : 11.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.247058153152466
Epoch: 1, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.596 Vali Acc: 0.727 Test Loss: 0.596 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.487095832824707
Epoch: 2, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.586 Vali Acc: 0.737 Test Loss: 0.586 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.586211919784546
Epoch: 3, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.559 Vali Acc: 0.737 Test Loss: 0.559 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 1.7528433799743652
Epoch: 4, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.556 Vali Acc: 0.751 Test Loss: 0.556 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 1.7325451374053955
Epoch: 5, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.608 Vali Acc: 0.737 Test Loss: 0.608 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4939775466918945
Epoch: 6, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.599 Vali Acc: 0.722 Test Loss: 0.599 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5287456512451172
Epoch: 7, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.632 Vali Acc: 0.732 Test Loss: 0.632 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5380604267120361
Epoch: 8, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.655 Vali Acc: 0.717 Test Loss: 0.655 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7735381126403809
Epoch: 9, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.652 Vali Acc: 0.702 Test Loss: 0.652 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7588391304016113
Epoch: 10, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.686 Vali Acc: 0.702 Test Loss: 0.686 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5375525951385498
Epoch: 11, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.713 Vali Acc: 0.707 Test Loss: 0.713 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5820517539978027
Epoch: 12, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.870 Vali Acc: 0.727 Test Loss: 0.870 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2394607067108154
Epoch: 13, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.837 Vali Acc: 0.698 Test Loss: 0.837 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.997079610824585
Epoch: 14, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.851 Vali Acc: 0.702 Test Loss: 0.851 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 2925698
model size : 11.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.159918785095215
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.586 Vali Acc: 0.727 Test Loss: 0.586 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.5161941051483154
Epoch: 2, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.550 Vali Acc: 0.741 Test Loss: 0.550 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.3900279998779297
Epoch: 3, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.543 Vali Acc: 0.756 Test Loss: 0.543 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.6096422672271729
Epoch: 4, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.574 Vali Acc: 0.751 Test Loss: 0.574 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9764337539672852
Epoch: 5, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.551 Vali Acc: 0.727 Test Loss: 0.551 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6986451148986816
Epoch: 6, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.635 Vali Acc: 0.737 Test Loss: 0.635 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.690657138824463
Epoch: 7, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.619 Vali Acc: 0.727 Test Loss: 0.619 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5076241493225098
Epoch: 8, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.565 Vali Acc: 0.712 Test Loss: 0.565 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7948276996612549
Epoch: 9, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.619 Vali Acc: 0.727 Test Loss: 0.619 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6778457164764404
Epoch: 10, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.633 Vali Acc: 0.683 Test Loss: 0.633 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5337483882904053
Epoch: 11, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.666 Vali Acc: 0.722 Test Loss: 0.666 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6003563404083252
Epoch: 12, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.612 Vali Acc: 0.727 Test Loss: 0.612 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7537577152252197
Epoch: 13, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.648 Vali Acc: 0.698 Test Loss: 0.648 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 2902594
model size : 11.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2763872146606445
Epoch: 1, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.616 Vali Acc: 0.722 Test Loss: 0.616 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.487982988357544
Epoch: 2, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.5470633506774902
Epoch: 3, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.579 Vali Acc: 0.727 Test Loss: 0.579 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 1.4736201763153076
Epoch: 4, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.564 Vali Acc: 0.732 Test Loss: 0.564 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 1.4801814556121826
Epoch: 5, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.561 Vali Acc: 0.741 Test Loss: 0.561 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 1.3982839584350586
Epoch: 6, Steps: 13 | Train Loss: 0.279 Vali Loss: 0.598 Vali Acc: 0.737 Test Loss: 0.598 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6070435047149658
Epoch: 7, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.567 Vali Acc: 0.712 Test Loss: 0.567 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7550411224365234
Epoch: 8, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.567 Vali Acc: 0.727 Test Loss: 0.567 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7869770526885986
Epoch: 9, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6126642227172852
Epoch: 10, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.615 Vali Acc: 0.707 Test Loss: 0.615 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.487138271331787
Epoch: 11, Steps: 13 | Train Loss: 0.147 Vali Loss: 0.669 Vali Acc: 0.712 Test Loss: 0.669 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5406334400177002
Epoch: 12, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.621 Vali Acc: 0.717 Test Loss: 0.621 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7588376998901367
Epoch: 13, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.629 Vali Acc: 0.732 Test Loss: 0.629 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4687907695770264
Epoch: 14, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.647 Vali Acc: 0.722 Test Loss: 0.647 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5767650604248047
Epoch: 15, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.662 Vali Acc: 0.698 Test Loss: 0.662 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 2879810
model size : 11.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3886349201202393
Epoch: 1, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.632 Vali Acc: 0.727 Test Loss: 0.632 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.4512717723846436
Epoch: 2, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.579 Vali Acc: 0.717 Test Loss: 0.579 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6295793056488037
Epoch: 3, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.585 Vali Acc: 0.727 Test Loss: 0.585 Test Acc: 0.727
Validation loss decreased (-0.726823 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 1.5924625396728516
Epoch: 4, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.555 Vali Acc: 0.751 Test Loss: 0.555 Test Acc: 0.751
Validation loss decreased (-0.726823 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 1.5667121410369873
Epoch: 5, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.545 Vali Acc: 0.761 Test Loss: 0.545 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 6 cost time: 1.7082688808441162
Epoch: 6, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.538 Vali Acc: 0.737 Test Loss: 0.538 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5792269706726074
Epoch: 7, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.540 Vali Acc: 0.737 Test Loss: 0.540 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7494564056396484
Epoch: 8, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.560 Vali Acc: 0.737 Test Loss: 0.560 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5739524364471436
Epoch: 9, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.572 Vali Acc: 0.717 Test Loss: 0.572 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8516993522644043
Epoch: 10, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.607 Vali Acc: 0.727 Test Loss: 0.607 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6965827941894531
Epoch: 11, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.605 Vali Acc: 0.722 Test Loss: 0.605 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.69753098487854
Epoch: 12, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.590 Vali Acc: 0.727 Test Loss: 0.590 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.604823112487793
Epoch: 13, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.579 Vali Acc: 0.712 Test Loss: 0.579 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6100809574127197
Epoch: 14, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.616 Vali Acc: 0.717 Test Loss: 0.616 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6455488204956055
Epoch: 15, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.615 Vali Acc: 0.712 Test Loss: 0.615 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 2864834
model size : 11.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4268007278442383
Epoch: 1, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.663 Vali Acc: 0.741 Test Loss: 0.663 Test Acc: 0.741
Validation loss decreased (inf --> -0.741457).  Saving model ...
Epoch: 2 cost time: 1.3991103172302246
Epoch: 2, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.587 Vali Acc: 0.722 Test Loss: 0.587 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.424525499343872
Epoch: 3, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.660 Vali Acc: 0.722 Test Loss: 0.660 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2861576080322266
Epoch: 4, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.664 Vali Acc: 0.732 Test Loss: 0.664 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4442903995513916
Epoch: 5, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.638 Vali Acc: 0.732 Test Loss: 0.638 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4467744827270508
Epoch: 6, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.591 Vali Acc: 0.732 Test Loss: 0.591 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4967231750488281
Epoch: 7, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.545 Vali Acc: 0.737 Test Loss: 0.545 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5418765544891357
Epoch: 8, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.577 Vali Acc: 0.737 Test Loss: 0.577 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4049439430236816
Epoch: 9, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.558 Vali Acc: 0.741 Test Loss: 0.558 Test Acc: 0.741
Validation loss decreased (-0.741457 --> -0.741458).  Saving model ...
Epoch: 10 cost time: 1.4891767501831055
Epoch: 10, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.556 Vali Acc: 0.727 Test Loss: 0.556 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4019155502319336
Epoch: 11, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.617 Vali Acc: 0.741 Test Loss: 0.617 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5400068759918213
Epoch: 12, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.611 Vali Acc: 0.741 Test Loss: 0.611 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5267796516418457
Epoch: 13, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.621 Vali Acc: 0.737 Test Loss: 0.621 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6037390232086182
Epoch: 14, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.603 Vali Acc: 0.741 Test Loss: 0.603 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4802894592285156
Epoch: 15, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.626 Vali Acc: 0.732 Test Loss: 0.626 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2532589435577393
Epoch: 16, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.596 Vali Acc: 0.741 Test Loss: 0.596 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3650689125061035
Epoch: 17, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.669 Vali Acc: 0.741 Test Loss: 0.669 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5593767166137695
Epoch: 18, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.677 Vali Acc: 0.741 Test Loss: 0.677 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5725829601287842
Epoch: 19, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.700 Vali Acc: 0.741 Test Loss: 0.700 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 2857698
model size : 11.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.099330425262451
Epoch: 1, Steps: 13 | Train Loss: 1.397 Vali Loss: 0.996 Vali Acc: 0.717 Test Loss: 0.996 Test Acc: 0.717
Validation loss decreased (inf --> -0.717063).  Saving model ...
Epoch: 2 cost time: 4.509807348251343
Epoch: 2, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.940 Vali Acc: 0.620 Test Loss: 0.940 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.075679779052734
Epoch: 3, Steps: 13 | Train Loss: 0.172 Vali Loss: 1.475 Vali Acc: 0.722 Test Loss: 1.475 Test Acc: 0.722
Validation loss decreased (-0.717063 --> -0.721936).  Saving model ...
Epoch: 4 cost time: 4.372039318084717
Epoch: 4, Steps: 13 | Train Loss: 0.233 Vali Loss: 1.910 Vali Acc: 0.634 Test Loss: 1.910 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.146500825881958
Epoch: 5, Steps: 13 | Train Loss: 0.085 Vali Loss: 2.208 Vali Acc: 0.693 Test Loss: 2.208 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.043430089950562
Epoch: 6, Steps: 13 | Train Loss: 0.124 Vali Loss: 3.353 Vali Acc: 0.541 Test Loss: 3.353 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.435671091079712
Epoch: 7, Steps: 13 | Train Loss: 0.463 Vali Loss: 3.597 Vali Acc: 0.717 Test Loss: 3.597 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.804626226425171
Epoch: 8, Steps: 13 | Train Loss: 0.317 Vali Loss: 4.159 Vali Acc: 0.722 Test Loss: 4.159 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.122095823287964
Epoch: 9, Steps: 13 | Train Loss: 0.235 Vali Loss: 5.259 Vali Acc: 0.590 Test Loss: 5.259 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.329614877700806
Epoch: 10, Steps: 13 | Train Loss: 0.491 Vali Loss: 4.542 Vali Acc: 0.610 Test Loss: 4.542 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.37941575050354
Epoch: 11, Steps: 13 | Train Loss: 0.373 Vali Loss: 4.858 Vali Acc: 0.659 Test Loss: 4.858 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 8.093402624130249
Epoch: 12, Steps: 13 | Train Loss: 0.366 Vali Loss: 8.151 Vali Acc: 0.707 Test Loss: 8.151 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.655047178268433
Epoch: 13, Steps: 13 | Train Loss: 0.166 Vali Loss: 7.592 Vali Acc: 0.688 Test Loss: 7.592 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 22334978
model size : 85.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.014856338500977
Epoch: 1, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.552 Vali Acc: 0.732 Test Loss: 0.552 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 4.106706857681274
Epoch: 2, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.942 Vali Acc: 0.483 Test Loss: 0.942 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.474177360534668
Epoch: 3, Steps: 13 | Train Loss: 0.183 Vali Loss: 1.171 Vali Acc: 0.654 Test Loss: 1.171 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.507319450378418
Epoch: 4, Steps: 13 | Train Loss: 0.249 Vali Loss: 1.236 Vali Acc: 0.649 Test Loss: 1.236 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.743982791900635
Epoch: 5, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.445 Vali Acc: 0.620 Test Loss: 1.445 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.91418719291687
Epoch: 6, Steps: 13 | Train Loss: 0.057 Vali Loss: 2.562 Vali Acc: 0.717 Test Loss: 2.562 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.397555589675903
Epoch: 7, Steps: 13 | Train Loss: 0.188 Vali Loss: 2.911 Vali Acc: 0.746 Test Loss: 2.911 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746312).  Saving model ...
Epoch: 8 cost time: 4.826465368270874
Epoch: 8, Steps: 13 | Train Loss: 0.120 Vali Loss: 2.280 Vali Acc: 0.620 Test Loss: 2.280 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.254369735717773
Epoch: 9, Steps: 13 | Train Loss: 0.045 Vali Loss: 2.252 Vali Acc: 0.712 Test Loss: 2.252 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.639022588729858
Epoch: 10, Steps: 13 | Train Loss: 0.030 Vali Loss: 2.566 Vali Acc: 0.693 Test Loss: 2.566 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.460867404937744
Epoch: 11, Steps: 13 | Train Loss: 0.028 Vali Loss: 3.194 Vali Acc: 0.556 Test Loss: 3.194 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.96613335609436
Epoch: 12, Steps: 13 | Train Loss: 0.315 Vali Loss: 3.393 Vali Acc: 0.712 Test Loss: 3.393 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.59322714805603
Epoch: 13, Steps: 13 | Train Loss: 0.165 Vali Loss: 4.080 Vali Acc: 0.629 Test Loss: 4.080 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.9075136184692383
Epoch: 14, Steps: 13 | Train Loss: 0.079 Vali Loss: 4.076 Vali Acc: 0.673 Test Loss: 4.076 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.403837442398071
Epoch: 15, Steps: 13 | Train Loss: 0.205 Vali Loss: 4.496 Vali Acc: 0.556 Test Loss: 4.496 Test Acc: 0.556
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.20714545249939
Epoch: 16, Steps: 13 | Train Loss: 0.072 Vali Loss: 3.888 Vali Acc: 0.659 Test Loss: 3.888 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.5931875705718994
Epoch: 17, Steps: 13 | Train Loss: 0.190 Vali Loss: 4.845 Vali Acc: 0.580 Test Loss: 4.845 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 21369346
model size : 81.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.633905410766602
Epoch: 1, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.613 Vali Acc: 0.746 Test Loss: 0.613 Test Acc: 0.746
Validation loss decreased (inf --> -0.746335).  Saving model ...
Epoch: 2 cost time: 3.8451716899871826
Epoch: 2, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.986 Vali Acc: 0.727 Test Loss: 0.986 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5857467651367188
Epoch: 3, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.921 Vali Acc: 0.668 Test Loss: 0.921 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.9658467769622803
Epoch: 4, Steps: 13 | Train Loss: 0.128 Vali Loss: 1.263 Vali Acc: 0.741 Test Loss: 1.263 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.8028438091278076
Epoch: 5, Steps: 13 | Train Loss: 0.183 Vali Loss: 1.154 Vali Acc: 0.629 Test Loss: 1.154 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.6525540351867676
Epoch: 6, Steps: 13 | Train Loss: 0.112 Vali Loss: 1.098 Vali Acc: 0.644 Test Loss: 1.098 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.8263447284698486
Epoch: 7, Steps: 13 | Train Loss: 0.127 Vali Loss: 1.697 Vali Acc: 0.688 Test Loss: 1.697 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.7706754207611084
Epoch: 8, Steps: 13 | Train Loss: 0.122 Vali Loss: 1.925 Vali Acc: 0.693 Test Loss: 1.925 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.5788378715515137
Epoch: 9, Steps: 13 | Train Loss: 0.039 Vali Loss: 2.272 Vali Acc: 0.702 Test Loss: 2.272 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.5620851516723633
Epoch: 10, Steps: 13 | Train Loss: 0.033 Vali Loss: 2.119 Vali Acc: 0.678 Test Loss: 2.119 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.5095667839050293
Epoch: 11, Steps: 13 | Train Loss: 0.050 Vali Loss: 3.084 Vali Acc: 0.654 Test Loss: 3.084 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 21028354
model size : 80.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.425523281097412
Epoch: 1, Steps: 13 | Train Loss: 0.764 Vali Loss: 0.677 Vali Acc: 0.741 Test Loss: 0.677 Test Acc: 0.741
Validation loss decreased (inf --> -0.741457).  Saving model ...
Epoch: 2 cost time: 3.457562208175659
Epoch: 2, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.802 Vali Acc: 0.537 Test Loss: 0.802 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.428792715072632
Epoch: 3, Steps: 13 | Train Loss: 0.205 Vali Loss: 1.500 Vali Acc: 0.673 Test Loss: 1.500 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.7073328495025635
Epoch: 4, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.871 Vali Acc: 0.722 Test Loss: 0.871 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.9180920124053955
Epoch: 5, Steps: 13 | Train Loss: 0.205 Vali Loss: 1.679 Vali Acc: 0.429 Test Loss: 1.679 Test Acc: 0.429
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.4271984100341797
Epoch: 6, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.353 Vali Acc: 0.732 Test Loss: 1.353 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.6919219493865967
Epoch: 7, Steps: 13 | Train Loss: 0.126 Vali Loss: 1.435 Vali Acc: 0.537 Test Loss: 1.435 Test Acc: 0.537
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.39027738571167
Epoch: 8, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.194 Vali Acc: 0.707 Test Loss: 1.194 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.0713305473327637
Epoch: 9, Steps: 13 | Train Loss: 0.199 Vali Loss: 1.718 Vali Acc: 0.746 Test Loss: 1.718 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746324).  Saving model ...
Epoch: 10 cost time: 2.9372808933258057
Epoch: 10, Steps: 13 | Train Loss: 0.130 Vali Loss: 1.655 Vali Acc: 0.673 Test Loss: 1.655 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0153160095214844
Epoch: 11, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.841 Vali Acc: 0.688 Test Loss: 1.841 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.165714979171753
Epoch: 12, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.673 Vali Acc: 0.698 Test Loss: 1.673 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1587741374969482
Epoch: 13, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.835 Vali Acc: 0.693 Test Loss: 1.835 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.1265199184417725
Epoch: 14, Steps: 13 | Train Loss: 0.007 Vali Loss: 2.004 Vali Acc: 0.663 Test Loss: 2.004 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.5670359134674072
Epoch: 15, Steps: 13 | Train Loss: 0.007 Vali Loss: 2.237 Vali Acc: 0.693 Test Loss: 2.237 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.2801265716552734
Epoch: 16, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.933 Vali Acc: 0.663 Test Loss: 1.933 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.56953763961792
Epoch: 17, Steps: 13 | Train Loss: 0.008 Vali Loss: 2.400 Vali Acc: 0.698 Test Loss: 2.400 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.160884618759155
Epoch: 18, Steps: 13 | Train Loss: 0.011 Vali Loss: 2.273 Vali Acc: 0.683 Test Loss: 2.273 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.7928829193115234
Epoch: 19, Steps: 13 | Train Loss: 0.013 Vali Loss: 2.727 Vali Acc: 0.673 Test Loss: 2.727 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 20843522
model size : 79.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.987254619598389
Epoch: 1, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.582 Vali Acc: 0.741 Test Loss: 0.582 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 3.305476665496826
Epoch: 2, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.605 Vali Acc: 0.683 Test Loss: 0.605 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.974600315093994
Epoch: 3, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.719 Vali Acc: 0.688 Test Loss: 0.719 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7021937370300293
Epoch: 4, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.830 Vali Acc: 0.712 Test Loss: 0.830 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5428130626678467
Epoch: 5, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.863 Vali Acc: 0.678 Test Loss: 0.863 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4023091793060303
Epoch: 6, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.913 Vali Acc: 0.678 Test Loss: 0.913 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.6469759941101074
Epoch: 7, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.924 Vali Acc: 0.712 Test Loss: 0.924 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.297968864440918
Epoch: 8, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.950 Vali Acc: 0.654 Test Loss: 0.950 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.9474353790283203
Epoch: 9, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.027 Vali Acc: 0.702 Test Loss: 1.027 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.614316701889038
Epoch: 10, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.250 Vali Acc: 0.717 Test Loss: 1.250 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.3882853984832764
Epoch: 11, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.290 Vali Acc: 0.727 Test Loss: 1.290 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 20661250
model size : 79.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.890111207962036
Epoch: 1, Steps: 13 | Train Loss: 0.695 Vali Loss: 0.589 Vali Acc: 0.756 Test Loss: 0.589 Test Acc: 0.756
Validation loss decreased (inf --> -0.756092).  Saving model ...
Epoch: 2 cost time: 3.1729519367218018
Epoch: 2, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.562 Vali Acc: 0.737 Test Loss: 0.562 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1668403148651123
Epoch: 3, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.760 Vali Acc: 0.693 Test Loss: 0.760 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7960379123687744
Epoch: 4, Steps: 13 | Train Loss: 0.151 Vali Loss: 0.927 Vali Acc: 0.722 Test Loss: 0.927 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.971961259841919
Epoch: 5, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.769 Vali Acc: 0.678 Test Loss: 0.769 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.7151846885681152
Epoch: 6, Steps: 13 | Train Loss: 0.103 Vali Loss: 1.013 Vali Acc: 0.634 Test Loss: 1.013 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.728689193725586
Epoch: 7, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.015 Vali Acc: 0.741 Test Loss: 1.015 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.7448461055755615
Epoch: 8, Steps: 13 | Train Loss: 0.076 Vali Loss: 1.146 Vali Acc: 0.727 Test Loss: 1.146 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.8264124393463135
Epoch: 9, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.197 Vali Acc: 0.668 Test Loss: 1.197 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.366147756576538
Epoch: 10, Steps: 13 | Train Loss: 0.062 Vali Loss: 1.326 Vali Acc: 0.722 Test Loss: 1.326 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.8198773860931396
Epoch: 11, Steps: 13 | Train Loss: 0.076 Vali Loss: 1.014 Vali Acc: 0.663 Test Loss: 1.014 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 20541442
model size : 78.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.668803930282593
Epoch: 1, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.661 Vali Acc: 0.737 Test Loss: 0.661 Test Acc: 0.737
Validation loss decreased (inf --> -0.736579).  Saving model ...
Epoch: 2 cost time: 2.7230637073516846
Epoch: 2, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.566 Vali Acc: 0.727 Test Loss: 0.566 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.752568006515503
Epoch: 3, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.652 Vali Acc: 0.751 Test Loss: 0.652 Test Acc: 0.751
Validation loss decreased (-0.736579 --> -0.751213).  Saving model ...
Epoch: 4 cost time: 2.562993049621582
Epoch: 4, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.614 Vali Acc: 0.717 Test Loss: 0.614 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.223815441131592
Epoch: 5, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.817 Vali Acc: 0.746 Test Loss: 0.817 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1327970027923584
Epoch: 6, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.624 Vali Acc: 0.712 Test Loss: 0.624 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.857739210128784
Epoch: 7, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.709 Vali Acc: 0.712 Test Loss: 0.709 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.287216901779175
Epoch: 8, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.943 Vali Acc: 0.732 Test Loss: 0.943 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.3246660232543945
Epoch: 9, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.791 Vali Acc: 0.683 Test Loss: 0.791 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.6840357780456543
Epoch: 10, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.862 Vali Acc: 0.678 Test Loss: 0.862 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.623192310333252
Epoch: 11, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.799 Vali Acc: 0.741 Test Loss: 0.799 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.615483522415161
Epoch: 12, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.862 Vali Acc: 0.673 Test Loss: 0.862 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.869302749633789
Epoch: 13, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.002 Vali Acc: 0.707 Test Loss: 1.002 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 20484354
model size : 78.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.515047073364258
Epoch: 1, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.630 Vali Acc: 0.746 Test Loss: 0.630 Test Acc: 0.746
Validation loss decreased (inf --> -0.746335).  Saving model ...
Epoch: 2 cost time: 3.820833444595337
Epoch: 2, Steps: 13 | Train Loss: 0.464 Vali Loss: 1.586 Vali Acc: 0.741 Test Loss: 1.586 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.1698174476623535
Epoch: 3, Steps: 13 | Train Loss: 0.390 Vali Loss: 1.267 Vali Acc: 0.737 Test Loss: 1.267 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.8515875339508057
Epoch: 4, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.274 Vali Acc: 0.634 Test Loss: 1.274 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.1092987060546875
Epoch: 5, Steps: 13 | Train Loss: 0.118 Vali Loss: 1.607 Vali Acc: 0.717 Test Loss: 1.607 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.260841608047485
Epoch: 6, Steps: 13 | Train Loss: 0.139 Vali Loss: 2.478 Vali Acc: 0.459 Test Loss: 2.478 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.7654690742492676
Epoch: 7, Steps: 13 | Train Loss: 0.284 Vali Loss: 2.059 Vali Acc: 0.693 Test Loss: 2.059 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.693394184112549
Epoch: 8, Steps: 13 | Train Loss: 0.008 Vali Loss: 3.460 Vali Acc: 0.678 Test Loss: 3.460 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.189929008483887
Epoch: 9, Steps: 13 | Train Loss: 0.085 Vali Loss: 3.203 Vali Acc: 0.668 Test Loss: 3.203 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.9450063705444336
Epoch: 10, Steps: 13 | Train Loss: 0.023 Vali Loss: 3.009 Vali Acc: 0.683 Test Loss: 3.009 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.121604919433594
Epoch: 11, Steps: 13 | Train Loss: 0.056 Vali Loss: 2.761 Vali Acc: 0.649 Test Loss: 2.761 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 7169794
model size : 27.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.858301401138306
Epoch: 1, Steps: 13 | Train Loss: 0.825 Vali Loss: 0.979 Vali Acc: 0.751 Test Loss: 0.979 Test Acc: 0.751
Validation loss decreased (inf --> -0.751210).  Saving model ...
Epoch: 2 cost time: 2.45615816116333
Epoch: 2, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.700 Vali Acc: 0.683 Test Loss: 0.700 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7631912231445312
Epoch: 3, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.900 Vali Acc: 0.712 Test Loss: 0.900 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.3158507347106934
Epoch: 4, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.877 Vali Acc: 0.678 Test Loss: 0.877 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8225765228271484
Epoch: 5, Steps: 13 | Train Loss: 0.094 Vali Loss: 1.141 Vali Acc: 0.546 Test Loss: 1.141 Test Acc: 0.546
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.642300605773926
Epoch: 6, Steps: 13 | Train Loss: 0.108 Vali Loss: 2.185 Vali Acc: 0.746 Test Loss: 2.185 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.217566728591919
Epoch: 7, Steps: 13 | Train Loss: 0.081 Vali Loss: 1.272 Vali Acc: 0.644 Test Loss: 1.272 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.0163919925689697
Epoch: 8, Steps: 13 | Train Loss: 0.080 Vali Loss: 2.045 Vali Acc: 0.732 Test Loss: 2.045 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.909842014312744
Epoch: 9, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.326 Vali Acc: 0.717 Test Loss: 1.326 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.2084975242614746
Epoch: 10, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.516 Vali Acc: 0.717 Test Loss: 1.516 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.662820339202881
Epoch: 11, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.667 Vali Acc: 0.683 Test Loss: 1.667 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 6686978
model size : 25.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.9583094120025635
Epoch: 1, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.547 Vali Acc: 0.746 Test Loss: 0.547 Test Acc: 0.746
Validation loss decreased (inf --> -0.746336).  Saving model ...
Epoch: 2 cost time: 1.9379630088806152
Epoch: 2, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.587 Vali Acc: 0.741 Test Loss: 0.587 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3007633686065674
Epoch: 3, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.723 Vali Acc: 0.688 Test Loss: 0.723 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9011332988739014
Epoch: 4, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.752 Vali Acc: 0.668 Test Loss: 0.752 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.487778902053833
Epoch: 5, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.127 Vali Acc: 0.756 Test Loss: 1.127 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756086).  Saving model ...
Epoch: 6 cost time: 2.2886312007904053
Epoch: 6, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.135 Vali Acc: 0.702 Test Loss: 1.135 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8698091506958008
Epoch: 7, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.480 Vali Acc: 0.541 Test Loss: 1.480 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0164222717285156
Epoch: 8, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.968 Vali Acc: 0.717 Test Loss: 0.968 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9512414932250977
Epoch: 9, Steps: 13 | Train Loss: 0.060 Vali Loss: 1.529 Vali Acc: 0.756 Test Loss: 1.529 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0590507984161377
Epoch: 10, Steps: 13 | Train Loss: 0.153 Vali Loss: 1.125 Vali Acc: 0.663 Test Loss: 1.125 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.198979616165161
Epoch: 11, Steps: 13 | Train Loss: 0.049 Vali Loss: 2.207 Vali Acc: 0.727 Test Loss: 2.207 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3758137226104736
Epoch: 12, Steps: 13 | Train Loss: 0.118 Vali Loss: 1.749 Vali Acc: 0.712 Test Loss: 1.749 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.26348614692688
Epoch: 13, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.474 Vali Acc: 0.722 Test Loss: 1.474 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.5156681537628174
Epoch: 14, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.720 Vali Acc: 0.732 Test Loss: 1.720 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.45121431350708
Epoch: 15, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.963 Vali Acc: 0.698 Test Loss: 1.963 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 6516482
model size : 24.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.55128026008606
Epoch: 1, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.581 Vali Acc: 0.751 Test Loss: 0.581 Test Acc: 0.751
Validation loss decreased (inf --> -0.751214).  Saving model ...
Epoch: 2 cost time: 2.694199800491333
Epoch: 2, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.592 Vali Acc: 0.722 Test Loss: 0.592 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.334383010864258
Epoch: 3, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.857 Vali Acc: 0.751 Test Loss: 0.857 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.286346197128296
Epoch: 4, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.647 Vali Acc: 0.693 Test Loss: 0.647 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.680058717727661
Epoch: 5, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.704 Vali Acc: 0.702 Test Loss: 0.704 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1379969120025635
Epoch: 6, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.771 Vali Acc: 0.751 Test Loss: 0.771 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.985605001449585
Epoch: 7, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.840 Vali Acc: 0.746 Test Loss: 0.840 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0709149837493896
Epoch: 8, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.058 Vali Acc: 0.722 Test Loss: 1.058 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.725691556930542
Epoch: 9, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.967 Vali Acc: 0.688 Test Loss: 0.967 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.015371322631836
Epoch: 10, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.922 Vali Acc: 0.707 Test Loss: 0.922 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.092235565185547
Epoch: 11, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.981 Vali Acc: 0.722 Test Loss: 0.981 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 6424066
model size : 24.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.191122055053711
Epoch: 1, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.567 Vali Acc: 0.727 Test Loss: 0.567 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.851773977279663
Epoch: 2, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.701 Vali Acc: 0.717 Test Loss: 0.701 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5803630352020264
Epoch: 3, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.674 Vali Acc: 0.717 Test Loss: 0.674 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0605249404907227
Epoch: 4, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.662 Vali Acc: 0.698 Test Loss: 0.662 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8773891925811768
Epoch: 5, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.648 Vali Acc: 0.707 Test Loss: 0.648 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.90010666847229
Epoch: 6, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.769 Vali Acc: 0.751 Test Loss: 0.769 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751212).  Saving model ...
Epoch: 7 cost time: 1.8251588344573975
Epoch: 7, Steps: 13 | Train Loss: 0.053 Vali Loss: 1.056 Vali Acc: 0.737 Test Loss: 1.056 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0047364234924316
Epoch: 8, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.839 Vali Acc: 0.688 Test Loss: 0.839 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0802361965179443
Epoch: 9, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.837 Vali Acc: 0.746 Test Loss: 0.837 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.990508794784546
Epoch: 10, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.795 Vali Acc: 0.722 Test Loss: 0.795 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.886256456375122
Epoch: 11, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.070 Vali Acc: 0.751 Test Loss: 1.070 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.125518798828125
Epoch: 12, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.852 Vali Acc: 0.663 Test Loss: 0.852 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.0810670852661133
Epoch: 13, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.038 Vali Acc: 0.746 Test Loss: 1.038 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9967505931854248
Epoch: 14, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.146 Vali Acc: 0.629 Test Loss: 1.146 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0670907497406006
Epoch: 15, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.466 Vali Acc: 0.727 Test Loss: 1.466 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8326783180236816
Epoch: 16, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.103 Vali Acc: 0.702 Test Loss: 1.103 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 6332930
model size : 24.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.505731105804443
Epoch: 1, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.581 Vali Acc: 0.727 Test Loss: 0.581 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.6878902912139893
Epoch: 2, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.577 Vali Acc: 0.746 Test Loss: 0.577 Test Acc: 0.746
Validation loss decreased (-0.726823 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.4996075630187988
Epoch: 3, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.585 Vali Acc: 0.698 Test Loss: 0.585 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.831209421157837
Epoch: 4, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.982 Vali Acc: 0.712 Test Loss: 0.982 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3888556957244873
Epoch: 5, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.695 Vali Acc: 0.683 Test Loss: 0.695 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6508662700653076
Epoch: 6, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.821 Vali Acc: 0.668 Test Loss: 0.821 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3777868747711182
Epoch: 7, Steps: 13 | Train Loss: 0.096 Vali Loss: 1.031 Vali Acc: 0.737 Test Loss: 1.031 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.665689468383789
Epoch: 8, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.824 Vali Acc: 0.668 Test Loss: 0.824 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.750197410583496
Epoch: 9, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.721 Vali Acc: 0.727 Test Loss: 0.721 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6201834678649902
Epoch: 10, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.892 Vali Acc: 0.663 Test Loss: 0.892 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.84373140335083
Epoch: 11, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.039 Vali Acc: 0.737 Test Loss: 1.039 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6173453330993652
Epoch: 12, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.951 Vali Acc: 0.634 Test Loss: 0.951 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 6273026
model size : 24.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.00229811668396
Epoch: 1, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.605 Vali Acc: 0.727 Test Loss: 0.605 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.8729348182678223
Epoch: 2, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.550 Vali Acc: 0.756 Test Loss: 0.550 Test Acc: 0.756
Validation loss decreased (-0.726823 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 2.026578187942505
Epoch: 3, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.707 Vali Acc: 0.732 Test Loss: 0.707 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9651291370391846
Epoch: 4, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.607 Vali Acc: 0.717 Test Loss: 0.607 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1702933311462402
Epoch: 5, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.804 Vali Acc: 0.737 Test Loss: 0.804 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2891266345977783
Epoch: 6, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.642 Vali Acc: 0.732 Test Loss: 0.642 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.97060227394104
Epoch: 7, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.784 Vali Acc: 0.741 Test Loss: 0.784 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.774350881576538
Epoch: 8, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.693 Vali Acc: 0.688 Test Loss: 0.693 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.723541021347046
Epoch: 9, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.767 Vali Acc: 0.722 Test Loss: 0.767 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.805025577545166
Epoch: 10, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.783 Vali Acc: 0.727 Test Loss: 0.783 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8952069282531738
Epoch: 11, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.704 Vali Acc: 0.702 Test Loss: 0.704 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.3486056327819824
Epoch: 12, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.792 Vali Acc: 0.732 Test Loss: 0.792 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 6244482
model size : 23.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.563533306121826
Epoch: 1, Steps: 13 | Train Loss: 0.701 Vali Loss: 1.084 Vali Acc: 0.737 Test Loss: 1.084 Test Acc: 0.737
Validation loss decreased (inf --> -0.736575).  Saving model ...
Epoch: 2 cost time: 1.48606538772583
Epoch: 2, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.645 Vali Acc: 0.722 Test Loss: 0.645 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.590303897857666
Epoch: 3, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.697 Vali Acc: 0.746 Test Loss: 0.697 Test Acc: 0.746
Validation loss decreased (-0.736575 --> -0.746334).  Saving model ...
Epoch: 4 cost time: 1.7477242946624756
Epoch: 4, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.727 Vali Acc: 0.732 Test Loss: 0.727 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8402700424194336
Epoch: 5, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.855 Vali Acc: 0.659 Test Loss: 0.855 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5797407627105713
Epoch: 6, Steps: 13 | Train Loss: 0.048 Vali Loss: 1.014 Vali Acc: 0.624 Test Loss: 1.014 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6016626358032227
Epoch: 7, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.226 Vali Acc: 0.717 Test Loss: 1.226 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8896121978759766
Epoch: 8, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.312 Vali Acc: 0.649 Test Loss: 1.312 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8239901065826416
Epoch: 9, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.388 Vali Acc: 0.737 Test Loss: 1.388 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7378065586090088
Epoch: 10, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.435 Vali Acc: 0.678 Test Loss: 1.435 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7770986557006836
Epoch: 11, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.444 Vali Acc: 0.732 Test Loss: 1.444 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7123467922210693
Epoch: 12, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.396 Vali Acc: 0.673 Test Loss: 1.396 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.9164419174194336
Epoch: 13, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.607 Vali Acc: 0.693 Test Loss: 1.607 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 2585474
model size : 9.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8218722343444824
Epoch: 1, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.574 Vali Acc: 0.737 Test Loss: 0.574 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 1.4739813804626465
Epoch: 2, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.618 Vali Acc: 0.727 Test Loss: 0.618 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5157768726348877
Epoch: 3, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.737 Vali Acc: 0.727 Test Loss: 0.737 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5119729042053223
Epoch: 4, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.801 Vali Acc: 0.746 Test Loss: 0.801 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746333).  Saving model ...
Epoch: 5 cost time: 1.3084356784820557
Epoch: 5, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.874 Vali Acc: 0.663 Test Loss: 0.874 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3455934524536133
Epoch: 6, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.212 Vali Acc: 0.732 Test Loss: 1.212 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4856741428375244
Epoch: 7, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.966 Vali Acc: 0.639 Test Loss: 0.966 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5805799961090088
Epoch: 8, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.166 Vali Acc: 0.707 Test Loss: 1.166 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6176729202270508
Epoch: 9, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.300 Vali Acc: 0.702 Test Loss: 1.300 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4285917282104492
Epoch: 10, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.421 Vali Acc: 0.698 Test Loss: 1.421 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3457555770874023
Epoch: 11, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.550 Vali Acc: 0.698 Test Loss: 1.550 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3742609024047852
Epoch: 12, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.411 Vali Acc: 0.707 Test Loss: 1.411 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8119583129882812
Epoch: 13, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.597 Vali Acc: 0.702 Test Loss: 1.597 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6711177825927734
Epoch: 14, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.572 Vali Acc: 0.683 Test Loss: 1.572 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 2344066
model size : 9.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.102090835571289
Epoch: 1, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.662 Vali Acc: 0.727 Test Loss: 0.662 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.7905571460723877
Epoch: 2, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.599 Vali Acc: 0.712 Test Loss: 0.599 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5609993934631348
Epoch: 3, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.816 Vali Acc: 0.722 Test Loss: 0.816 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.474086046218872
Epoch: 4, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.684 Vali Acc: 0.693 Test Loss: 0.684 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8761167526245117
Epoch: 5, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.866 Vali Acc: 0.712 Test Loss: 0.866 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7151925563812256
Epoch: 6, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.176 Vali Acc: 0.717 Test Loss: 1.176 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5844688415527344
Epoch: 7, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.848 Vali Acc: 0.698 Test Loss: 0.848 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7709152698516846
Epoch: 8, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.856 Vali Acc: 0.702 Test Loss: 0.856 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7211663722991943
Epoch: 9, Steps: 13 | Train Loss: 0.053 Vali Loss: 1.105 Vali Acc: 0.707 Test Loss: 1.105 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6016089916229248
Epoch: 10, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.148 Vali Acc: 0.732 Test Loss: 1.148 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731696).  Saving model ...
Epoch: 11 cost time: 1.4389023780822754
Epoch: 11, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.059 Vali Acc: 0.707 Test Loss: 1.059 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5587458610534668
Epoch: 12, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.109 Vali Acc: 0.722 Test Loss: 1.109 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5260272026062012
Epoch: 13, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.108 Vali Acc: 0.717 Test Loss: 1.108 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4449071884155273
Epoch: 14, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.432 Vali Acc: 0.722 Test Loss: 1.432 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3944365978240967
Epoch: 15, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.162 Vali Acc: 0.654 Test Loss: 1.162 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5290894508361816
Epoch: 16, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.464 Vali Acc: 0.727 Test Loss: 1.464 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5428695678710938
Epoch: 17, Steps: 13 | Train Loss: 0.062 Vali Loss: 1.421 Vali Acc: 0.620 Test Loss: 1.421 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.530092477798462
Epoch: 18, Steps: 13 | Train Loss: 0.068 Vali Loss: 2.255 Vali Acc: 0.722 Test Loss: 2.255 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5332682132720947
Epoch: 19, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.689 Vali Acc: 0.712 Test Loss: 1.689 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5637273788452148
Epoch: 20, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.559 Vali Acc: 0.610 Test Loss: 1.559 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 2258818
model size : 8.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5784318447113037
Epoch: 1, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.595 Vali Acc: 0.741 Test Loss: 0.595 Test Acc: 0.741
Validation loss decreased (inf --> -0.741457).  Saving model ...
Epoch: 2 cost time: 1.657205581665039
Epoch: 2, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.583 Vali Acc: 0.737 Test Loss: 0.583 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5713772773742676
Epoch: 3, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.660 Vali Acc: 0.737 Test Loss: 0.660 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5016663074493408
Epoch: 4, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.654 Vali Acc: 0.746 Test Loss: 0.654 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746335).  Saving model ...
Epoch: 5 cost time: 1.5106689929962158
Epoch: 5, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.643 Vali Acc: 0.707 Test Loss: 0.643 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4568982124328613
Epoch: 6, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.628 Vali Acc: 0.693 Test Loss: 0.628 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8142285346984863
Epoch: 7, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.718 Vali Acc: 0.688 Test Loss: 0.718 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8048646450042725
Epoch: 8, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.745 Vali Acc: 0.712 Test Loss: 0.745 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.505692958831787
Epoch: 9, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.766 Vali Acc: 0.649 Test Loss: 0.766 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6905155181884766
Epoch: 10, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.772 Vali Acc: 0.702 Test Loss: 0.772 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.604994535446167
Epoch: 11, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.793 Vali Acc: 0.678 Test Loss: 0.793 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4017846584320068
Epoch: 12, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.821 Vali Acc: 0.693 Test Loss: 0.821 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8120429515838623
Epoch: 13, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.073 Vali Acc: 0.737 Test Loss: 1.073 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7896265983581543
Epoch: 14, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.946 Vali Acc: 0.629 Test Loss: 0.946 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 2212610
model size : 8.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.992159366607666
Epoch: 1, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.598 Vali Acc: 0.712 Test Loss: 0.598 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.6852624416351318
Epoch: 2, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.587 Vali Acc: 0.756 Test Loss: 0.587 Test Acc: 0.756
Validation loss decreased (-0.712189 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.2985825538635254
Epoch: 3, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.570 Vali Acc: 0.746 Test Loss: 0.570 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0831630229949951
Epoch: 4, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.656 Vali Acc: 0.741 Test Loss: 0.656 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5387046337127686
Epoch: 5, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.688 Vali Acc: 0.741 Test Loss: 0.688 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7338447570800781
Epoch: 6, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.688 Vali Acc: 0.737 Test Loss: 0.688 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7854094505310059
Epoch: 7, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.724 Vali Acc: 0.766 Test Loss: 0.724 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765846).  Saving model ...
Epoch: 8 cost time: 1.8769359588623047
Epoch: 8, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.752 Vali Acc: 0.712 Test Loss: 0.752 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.756399154663086
Epoch: 9, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.625 Vali Acc: 0.751 Test Loss: 0.625 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.532928228378296
Epoch: 10, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.696 Vali Acc: 0.737 Test Loss: 0.696 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8045835494995117
Epoch: 11, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.746 Vali Acc: 0.717 Test Loss: 0.746 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8224005699157715
Epoch: 12, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.775 Vali Acc: 0.707 Test Loss: 0.775 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6309309005737305
Epoch: 13, Steps: 13 | Train Loss: 0.051 Vali Loss: 1.037 Vali Acc: 0.761 Test Loss: 1.037 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6535298824310303
Epoch: 14, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.949 Vali Acc: 0.702 Test Loss: 0.949 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8576490879058838
Epoch: 15, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.850 Vali Acc: 0.737 Test Loss: 0.850 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5391719341278076
Epoch: 16, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.869 Vali Acc: 0.717 Test Loss: 0.869 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7695999145507812
Epoch: 17, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.873 Vali Acc: 0.746 Test Loss: 0.873 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 2167042
model size : 8.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.025039196014404
Epoch: 1, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.611 Vali Acc: 0.727 Test Loss: 0.611 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.4774954319000244
Epoch: 2, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.563 Vali Acc: 0.776 Test Loss: 0.563 Test Acc: 0.776
Validation loss decreased (-0.726823 --> -0.775604).  Saving model ...
Epoch: 3 cost time: 1.2552635669708252
Epoch: 3, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.570 Vali Acc: 0.756 Test Loss: 0.570 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.439394235610962
Epoch: 4, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.659 Vali Acc: 0.741 Test Loss: 0.659 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5723774433135986
Epoch: 5, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.601 Vali Acc: 0.741 Test Loss: 0.601 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5021140575408936
Epoch: 6, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.614 Vali Acc: 0.751 Test Loss: 0.614 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2189531326293945
Epoch: 7, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.650 Vali Acc: 0.717 Test Loss: 0.650 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3716380596160889
Epoch: 8, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.621 Vali Acc: 0.751 Test Loss: 0.621 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.405118465423584
Epoch: 9, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.631 Vali Acc: 0.756 Test Loss: 0.631 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2855076789855957
Epoch: 10, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.679 Vali Acc: 0.698 Test Loss: 0.679 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4491212368011475
Epoch: 11, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.735 Vali Acc: 0.756 Test Loss: 0.735 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4849579334259033
Epoch: 12, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.701 Vali Acc: 0.732 Test Loss: 0.701 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 2137090
model size : 8.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.109175443649292
Epoch: 1, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.615 Vali Acc: 0.722 Test Loss: 0.615 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.525627613067627
Epoch: 2, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.564 Vali Acc: 0.746 Test Loss: 0.564 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.3835549354553223
Epoch: 3, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.592 Vali Acc: 0.746 Test Loss: 0.592 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.635779619216919
Epoch: 4, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.562 Vali Acc: 0.761 Test Loss: 0.562 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 1.5731067657470703
Epoch: 5, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.596 Vali Acc: 0.756 Test Loss: 0.596 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.623030662536621
Epoch: 6, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.572 Vali Acc: 0.737 Test Loss: 0.572 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4376270771026611
Epoch: 7, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.621 Vali Acc: 0.727 Test Loss: 0.621 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6956021785736084
Epoch: 8, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.602 Vali Acc: 0.746 Test Loss: 0.602 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7573585510253906
Epoch: 9, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.614 Vali Acc: 0.737 Test Loss: 0.614 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1339659690856934
Epoch: 10, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.622 Vali Acc: 0.712 Test Loss: 0.622 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2196946144104004
Epoch: 11, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.639 Vali Acc: 0.732 Test Loss: 0.639 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.487091302871704
Epoch: 12, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8149387836456299
Epoch: 13, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.661 Vali Acc: 0.746 Test Loss: 0.661 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2975945472717285
Epoch: 14, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.728 Vali Acc: 0.732 Test Loss: 0.728 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 2122818
model size : 8.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.718301296234131
Epoch: 1, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.595 Vali Acc: 0.722 Test Loss: 0.595 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2712924480438232
Epoch: 2, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.578 Vali Acc: 0.727 Test Loss: 0.578 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 1.2957446575164795
Epoch: 3, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.731 Vali Acc: 0.707 Test Loss: 0.731 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2208178043365479
Epoch: 4, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.696 Vali Acc: 0.727 Test Loss: 0.696 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5431904792785645
Epoch: 5, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.778 Vali Acc: 0.702 Test Loss: 0.778 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5023548603057861
Epoch: 6, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.812 Vali Acc: 0.654 Test Loss: 0.812 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.307398796081543
Epoch: 7, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.907 Vali Acc: 0.732 Test Loss: 0.907 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731698).  Saving model ...
Epoch: 8 cost time: 1.3438940048217773
Epoch: 8, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.852 Vali Acc: 0.683 Test Loss: 0.852 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3660447597503662
Epoch: 9, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.902 Vali Acc: 0.712 Test Loss: 0.902 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2938604354858398
Epoch: 10, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.882 Vali Acc: 0.727 Test Loss: 0.882 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3826580047607422
Epoch: 11, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.040 Vali Acc: 0.639 Test Loss: 1.040 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5226292610168457
Epoch: 12, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.566 Vali Acc: 0.722 Test Loss: 1.566 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.39980149269104
Epoch: 13, Steps: 13 | Train Loss: 0.072 Vali Loss: 1.231 Vali Acc: 0.644 Test Loss: 1.231 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5082166194915771
Epoch: 14, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.095 Vali Acc: 0.717 Test Loss: 1.095 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.193622350692749
Epoch: 15, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.314 Vali Acc: 0.741 Test Loss: 1.314 Test Acc: 0.741
Validation loss decreased (-0.731698 --> -0.741450).  Saving model ...
Epoch: 16 cost time: 1.3121280670166016
Epoch: 16, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.226 Vali Acc: 0.698 Test Loss: 1.226 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3890080451965332
Epoch: 17, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.166 Vali Acc: 0.707 Test Loss: 1.166 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.318803310394287
Epoch: 18, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.580 Vali Acc: 0.741 Test Loss: 1.580 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3761932849884033
Epoch: 19, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.784 Vali Acc: 0.693 Test Loss: 1.784 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.448399305343628
Epoch: 20, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.489 Vali Acc: 0.683 Test Loss: 1.489 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2928218841552734
Epoch: 21, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.368 Vali Acc: 0.712 Test Loss: 1.368 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3467822074890137
Epoch: 22, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.559 Vali Acc: 0.712 Test Loss: 1.559 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3247787952423096
Epoch: 23, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.579 Vali Acc: 0.702 Test Loss: 1.579 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3340153694152832
Epoch: 24, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.526 Vali Acc: 0.688 Test Loss: 1.526 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2665300369262695
Epoch: 25, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.782 Vali Acc: 0.688 Test Loss: 1.782 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1042882
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.556472063064575
Epoch: 1, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.615 Vali Acc: 0.737 Test Loss: 0.615 Test Acc: 0.737
Validation loss decreased (inf --> -0.736579).  Saving model ...
Epoch: 2 cost time: 1.4345812797546387
Epoch: 2, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.570 Vali Acc: 0.756 Test Loss: 0.570 Test Acc: 0.756
Validation loss decreased (-0.736579 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.3305003643035889
Epoch: 3, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.639 Vali Acc: 0.741 Test Loss: 0.639 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3310928344726562
Epoch: 4, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.720 Vali Acc: 0.741 Test Loss: 0.720 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.073026180267334
Epoch: 5, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.712 Vali Acc: 0.756 Test Loss: 0.712 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1695716381072998
Epoch: 6, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.826 Vali Acc: 0.756 Test Loss: 0.826 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3142781257629395
Epoch: 7, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.711 Vali Acc: 0.707 Test Loss: 0.711 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2895121574401855
Epoch: 8, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.835 Vali Acc: 0.766 Test Loss: 0.835 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765845).  Saving model ...
Epoch: 9 cost time: 1.142096996307373
Epoch: 9, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.910 Vali Acc: 0.722 Test Loss: 0.910 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2769017219543457
Epoch: 10, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.024 Vali Acc: 0.741 Test Loss: 1.024 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1520261764526367
Epoch: 11, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.050 Vali Acc: 0.702 Test Loss: 1.050 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2677435874938965
Epoch: 12, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.969 Vali Acc: 0.717 Test Loss: 0.969 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2515926361083984
Epoch: 13, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.010 Vali Acc: 0.717 Test Loss: 1.010 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4547882080078125
Epoch: 14, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.174 Vali Acc: 0.732 Test Loss: 1.174 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2288284301757812
Epoch: 15, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.045 Vali Acc: 0.717 Test Loss: 1.045 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3076448440551758
Epoch: 16, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.070 Vali Acc: 0.702 Test Loss: 1.070 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1784157752990723
Epoch: 17, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.327 Vali Acc: 0.727 Test Loss: 1.327 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3029751777648926
Epoch: 18, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.202 Vali Acc: 0.707 Test Loss: 1.202 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 922178
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7958743572235107
Epoch: 1, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.601 Vali Acc: 0.722 Test Loss: 0.601 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2059097290039062
Epoch: 2, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.576 Vali Acc: 0.741 Test Loss: 0.576 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.2143759727478027
Epoch: 3, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.591 Vali Acc: 0.732 Test Loss: 0.591 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3132519721984863
Epoch: 4, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.624 Vali Acc: 0.741 Test Loss: 0.624 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3599953651428223
Epoch: 5, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.708 Vali Acc: 0.741 Test Loss: 0.708 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2889790534973145
Epoch: 6, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.691 Vali Acc: 0.683 Test Loss: 0.691 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2877006530761719
Epoch: 7, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.717 Vali Acc: 0.717 Test Loss: 0.717 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3105010986328125
Epoch: 8, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.784 Vali Acc: 0.702 Test Loss: 0.784 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.309255838394165
Epoch: 9, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.768 Vali Acc: 0.727 Test Loss: 0.768 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2604639530181885
Epoch: 10, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.842 Vali Acc: 0.707 Test Loss: 0.842 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1263632774353027
Epoch: 11, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.937 Vali Acc: 0.737 Test Loss: 0.937 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.209425449371338
Epoch: 12, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.936 Vali Acc: 0.727 Test Loss: 0.936 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 879554
model size : 3.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9199724197387695
Epoch: 1, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.633 Vali Acc: 0.732 Test Loss: 0.633 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 1.1274528503417969
Epoch: 2, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.604 Vali Acc: 0.737 Test Loss: 0.604 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 1.0549037456512451
Epoch: 3, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.582 Vali Acc: 0.727 Test Loss: 0.582 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.077984094619751
Epoch: 4, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.611 Vali Acc: 0.737 Test Loss: 0.611 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2981457710266113
Epoch: 5, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.650 Vali Acc: 0.732 Test Loss: 0.650 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5195364952087402
Epoch: 6, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.778 Vali Acc: 0.741 Test Loss: 0.778 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741456).  Saving model ...
Epoch: 7 cost time: 1.308337688446045
Epoch: 7, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.733 Vali Acc: 0.707 Test Loss: 0.733 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0431430339813232
Epoch: 8, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.614 Vali Acc: 0.702 Test Loss: 0.614 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0196566581726074
Epoch: 9, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.612 Vali Acc: 0.698 Test Loss: 0.612 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1011402606964111
Epoch: 10, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.738 Vali Acc: 0.741 Test Loss: 0.738 Test Acc: 0.741
Validation loss decreased (-0.741456 --> -0.741456).  Saving model ...
Epoch: 11 cost time: 1.100177526473999
Epoch: 11, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.717 Vali Acc: 0.727 Test Loss: 0.717 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.118328332901001
Epoch: 12, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.691 Vali Acc: 0.722 Test Loss: 0.691 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.235595703125
Epoch: 13, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.682 Vali Acc: 0.702 Test Loss: 0.682 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0966534614562988
Epoch: 14, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.667 Vali Acc: 0.698 Test Loss: 0.667 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0742473602294922
Epoch: 15, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.752 Vali Acc: 0.727 Test Loss: 0.752 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1052613258361816
Epoch: 16, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.754 Vali Acc: 0.722 Test Loss: 0.754 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.530083179473877
Epoch: 17, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.821 Vali Acc: 0.722 Test Loss: 0.821 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3065886497497559
Epoch: 18, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.808 Vali Acc: 0.712 Test Loss: 0.808 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1189544200897217
Epoch: 19, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.906 Vali Acc: 0.722 Test Loss: 0.906 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1668410301208496
Epoch: 20, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.841 Vali Acc: 0.737 Test Loss: 0.841 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 856450
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.9445576667785645
Epoch: 1, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.623 Vali Acc: 0.727 Test Loss: 0.623 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.8562877178192139
Epoch: 2, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.594 Vali Acc: 0.732 Test Loss: 0.594 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.5941064357757568
Epoch: 3, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.598 Vali Acc: 0.746 Test Loss: 0.598 Test Acc: 0.746
Validation loss decreased (-0.731701 --> -0.746335).  Saving model ...
Epoch: 4 cost time: 1.7779955863952637
Epoch: 4, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.575 Vali Acc: 0.746 Test Loss: 0.575 Test Acc: 0.746
Validation loss decreased (-0.746335 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 1.7967472076416016
Epoch: 5, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.577 Vali Acc: 0.756 Test Loss: 0.577 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 1.4944922924041748
Epoch: 6, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.671 Vali Acc: 0.761 Test Loss: 0.671 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760969).  Saving model ...
Epoch: 7 cost time: 1.5702741146087646
Epoch: 7, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.632 Vali Acc: 0.761 Test Loss: 0.632 Test Acc: 0.761
Validation loss decreased (-0.760969 --> -0.760969).  Saving model ...
Epoch: 8 cost time: 1.429741382598877
Epoch: 8, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.614 Vali Acc: 0.737 Test Loss: 0.614 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.471367597579956
Epoch: 9, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.764 Vali Acc: 0.737 Test Loss: 0.764 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.768557071685791
Epoch: 10, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.690 Vali Acc: 0.732 Test Loss: 0.690 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7243092060089111
Epoch: 11, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.634 Vali Acc: 0.722 Test Loss: 0.634 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5627708435058594
Epoch: 12, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.658 Vali Acc: 0.712 Test Loss: 0.658 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5855138301849365
Epoch: 13, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.667 Vali Acc: 0.761 Test Loss: 0.667 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4750144481658936
Epoch: 14, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.706 Vali Acc: 0.707 Test Loss: 0.706 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9407117366790771
Epoch: 15, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.701 Vali Acc: 0.722 Test Loss: 0.701 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6470327377319336
Epoch: 16, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.757 Vali Acc: 0.741 Test Loss: 0.757 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.0174753665924072
Epoch: 17, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.892 Vali Acc: 0.688 Test Loss: 0.892 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 833666
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.397019863128662
Epoch: 1, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.624 Vali Acc: 0.717 Test Loss: 0.624 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.7303247451782227
Epoch: 2, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.569 Vali Acc: 0.741 Test Loss: 0.569 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 2.2107744216918945
Epoch: 3, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.579 Vali Acc: 0.746 Test Loss: 0.579 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 1.5201725959777832
Epoch: 4, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.566 Vali Acc: 0.761 Test Loss: 0.566 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 2.2082505226135254
Epoch: 5, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.642 Vali Acc: 0.761 Test Loss: 0.642 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8674836158752441
Epoch: 6, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.569 Vali Acc: 0.751 Test Loss: 0.569 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5464630126953125
Epoch: 7, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.595 Vali Acc: 0.766 Test Loss: 0.595 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765848).  Saving model ...
Epoch: 8 cost time: 1.5840704441070557
Epoch: 8, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.578 Vali Acc: 0.741 Test Loss: 0.578 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6560356616973877
Epoch: 9, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.578 Vali Acc: 0.746 Test Loss: 0.578 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7787764072418213
Epoch: 10, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.640 Vali Acc: 0.766 Test Loss: 0.640 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.793086051940918
Epoch: 11, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.630 Vali Acc: 0.741 Test Loss: 0.630 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5044915676116943
Epoch: 12, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.592 Vali Acc: 0.737 Test Loss: 0.592 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8781819343566895
Epoch: 13, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.602 Vali Acc: 0.717 Test Loss: 0.602 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7661755084991455
Epoch: 14, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.666 Vali Acc: 0.737 Test Loss: 0.666 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4560668468475342
Epoch: 15, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.667 Vali Acc: 0.741 Test Loss: 0.667 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4491517543792725
Epoch: 16, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.666 Vali Acc: 0.732 Test Loss: 0.666 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9883286952972412
Epoch: 17, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.681 Vali Acc: 0.732 Test Loss: 0.681 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 818690
model size : 3.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.38639497756958
Epoch: 1, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.645 Vali Acc: 0.751 Test Loss: 0.645 Test Acc: 0.751
Validation loss decreased (inf --> -0.751213).  Saving model ...
Epoch: 2 cost time: 1.6593801975250244
Epoch: 2, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.596 Vali Acc: 0.727 Test Loss: 0.596 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5623812675476074
Epoch: 3, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.673 Vali Acc: 0.741 Test Loss: 0.673 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.748065710067749
Epoch: 4, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.637 Vali Acc: 0.727 Test Loss: 0.637 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5809426307678223
Epoch: 5, Steps: 13 | Train Loss: 0.323 Vali Loss: 0.660 Vali Acc: 0.732 Test Loss: 0.660 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3983912467956543
Epoch: 6, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.645 Vali Acc: 0.732 Test Loss: 0.645 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.544567584991455
Epoch: 7, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.672 Vali Acc: 0.737 Test Loss: 0.672 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7325365543365479
Epoch: 8, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.608 Vali Acc: 0.737 Test Loss: 0.608 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6826231479644775
Epoch: 9, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.600 Vali Acc: 0.741 Test Loss: 0.600 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5921299457550049
Epoch: 10, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.700 Vali Acc: 0.732 Test Loss: 0.700 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.579293966293335
Epoch: 11, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.735 Vali Acc: 0.727 Test Loss: 0.735 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 811554
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.320173263549805
Epoch: 1, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.593 Vali Acc: 0.722 Test Loss: 0.593 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.6644606590271
Epoch: 2, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.564 Vali Acc: 0.741 Test Loss: 0.564 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 5.655896902084351
Epoch: 3, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.587 Vali Acc: 0.737 Test Loss: 0.587 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.574527978897095
Epoch: 4, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.745 Vali Acc: 0.727 Test Loss: 0.745 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.840757369995117
Epoch: 5, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.825 Vali Acc: 0.722 Test Loss: 0.825 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.892647981643677
Epoch: 6, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.827 Vali Acc: 0.605 Test Loss: 0.827 Test Acc: 0.605
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.007471323013306
Epoch: 7, Steps: 13 | Train Loss: 0.079 Vali Loss: 1.018 Vali Acc: 0.732 Test Loss: 1.018 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.861428499221802
Epoch: 8, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.784 Vali Acc: 0.683 Test Loss: 0.784 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.245060443878174
Epoch: 9, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.896 Vali Acc: 0.639 Test Loss: 0.896 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.24716854095459
Epoch: 10, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.076 Vali Acc: 0.717 Test Loss: 1.076 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.6943559646606445
Epoch: 11, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.824 Vali Acc: 0.698 Test Loss: 0.824 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.794949293136597
Epoch: 12, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.942 Vali Acc: 0.717 Test Loss: 0.942 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 4932994
model size : 19.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.4543774127960205
Epoch: 1, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.432847261428833
Epoch: 2, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.561 Vali Acc: 0.732 Test Loss: 0.561 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 4.521764755249023
Epoch: 3, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.545 Vali Acc: 0.741 Test Loss: 0.545 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 4.2708539962768555
Epoch: 4, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.575 Vali Acc: 0.732 Test Loss: 0.575 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.59320592880249
Epoch: 5, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.594 Vali Acc: 0.722 Test Loss: 0.594 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.602968215942383
Epoch: 6, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.626 Vali Acc: 0.737 Test Loss: 0.626 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.124558925628662
Epoch: 7, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.706 Vali Acc: 0.707 Test Loss: 0.706 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.546708345413208
Epoch: 8, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.710 Vali Acc: 0.722 Test Loss: 0.710 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.267463684082031
Epoch: 9, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.730 Vali Acc: 0.659 Test Loss: 0.730 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.27374005317688
Epoch: 10, Steps: 13 | Train Loss: 0.090 Vali Loss: 1.111 Vali Acc: 0.727 Test Loss: 1.111 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.516478776931763
Epoch: 11, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.853 Vali Acc: 0.702 Test Loss: 0.853 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.613395690917969
Epoch: 12, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.908 Vali Acc: 0.712 Test Loss: 0.908 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.54129695892334
Epoch: 13, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.952 Vali Acc: 0.707 Test Loss: 0.952 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 4808386
model size : 18.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.071303129196167
Epoch: 1, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.454087257385254
Epoch: 2, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.566 Vali Acc: 0.732 Test Loss: 0.566 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 4.31521201133728
Epoch: 3, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.588 Vali Acc: 0.732 Test Loss: 0.588 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.3460917472839355
Epoch: 4, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.586 Vali Acc: 0.732 Test Loss: 0.586 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.694246053695679
Epoch: 5, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.636 Vali Acc: 0.732 Test Loss: 0.636 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.011997222900391
Epoch: 6, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.599 Vali Acc: 0.732 Test Loss: 0.599 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.366117477416992
Epoch: 7, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.597 Vali Acc: 0.712 Test Loss: 0.597 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.401390075683594
Epoch: 8, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.616 Vali Acc: 0.698 Test Loss: 0.616 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.668826341629028
Epoch: 9, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.659 Vali Acc: 0.722 Test Loss: 0.659 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.040096998214722
Epoch: 10, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.613 Vali Acc: 0.698 Test Loss: 0.613 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.947216987609863
Epoch: 11, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.669 Vali Acc: 0.663 Test Loss: 0.669 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.0201966762542725
Epoch: 12, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.796 Vali Acc: 0.722 Test Loss: 0.796 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 4777474
model size : 18.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.630699396133423
Epoch: 1, Steps: 13 | Train Loss: 0.695 Vali Loss: 0.601 Vali Acc: 0.722 Test Loss: 0.601 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.382937431335449
Epoch: 2, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.572 Vali Acc: 0.732 Test Loss: 0.572 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 3.4730489253997803
Epoch: 3, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.586 Vali Acc: 0.737 Test Loss: 0.586 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 3.4854204654693604
Epoch: 4, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.583 Vali Acc: 0.741 Test Loss: 0.583 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 4.3470458984375
Epoch: 5, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.592 Vali Acc: 0.727 Test Loss: 0.592 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7475922107696533
Epoch: 6, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.608 Vali Acc: 0.717 Test Loss: 0.608 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.838970184326172
Epoch: 7, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.647 Vali Acc: 0.712 Test Loss: 0.647 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.673418045043945
Epoch: 8, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.624 Vali Acc: 0.683 Test Loss: 0.624 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.342723846435547
Epoch: 9, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.623 Vali Acc: 0.712 Test Loss: 0.623 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.787302255630493
Epoch: 10, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.627 Vali Acc: 0.707 Test Loss: 0.627 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.078605890274048
Epoch: 11, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.659 Vali Acc: 0.717 Test Loss: 0.659 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.342247247695923
Epoch: 12, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.663 Vali Acc: 0.712 Test Loss: 0.663 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.391691207885742
Epoch: 13, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.689 Vali Acc: 0.707 Test Loss: 0.689 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.401900291442871
Epoch: 14, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.723 Vali Acc: 0.717 Test Loss: 0.723 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 4746562
model size : 18.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.447696208953857
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.597 Vali Acc: 0.722 Test Loss: 0.597 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.761383771896362
Epoch: 2, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.577 Vali Acc: 0.712 Test Loss: 0.577 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.777417898178101
Epoch: 3, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.584 Vali Acc: 0.751 Test Loss: 0.584 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 3.850602865219116
Epoch: 4, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.571 Vali Acc: 0.741 Test Loss: 0.571 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.062928199768066
Epoch: 5, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.594 Vali Acc: 0.751 Test Loss: 0.594 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.038990020751953
Epoch: 6, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.576 Vali Acc: 0.732 Test Loss: 0.576 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.757002353668213
Epoch: 7, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.572 Vali Acc: 0.712 Test Loss: 0.572 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.7675743103027344
Epoch: 8, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.635 Vali Acc: 0.746 Test Loss: 0.635 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.430266618728638
Epoch: 9, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.589 Vali Acc: 0.732 Test Loss: 0.589 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.324294328689575
Epoch: 10, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.631 Vali Acc: 0.722 Test Loss: 0.631 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.258171081542969
Epoch: 11, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.668 Vali Acc: 0.737 Test Loss: 0.668 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.201767444610596
Epoch: 12, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.628 Vali Acc: 0.717 Test Loss: 0.628 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.018086910247803
Epoch: 13, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.630 Vali Acc: 0.722 Test Loss: 0.630 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 4731586
model size : 18.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.864617109298706
Epoch: 1, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.615 Vali Acc: 0.717 Test Loss: 0.615 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.157727479934692
Epoch: 2, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.583 Vali Acc: 0.712 Test Loss: 0.583 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.480073928833008
Epoch: 3, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.631 Vali Acc: 0.727 Test Loss: 0.631 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 4.645866870880127
Epoch: 4, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.555 Vali Acc: 0.732 Test Loss: 0.555 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 4.515174865722656
Epoch: 5, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.547 Vali Acc: 0.737 Test Loss: 0.547 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 4.475972414016724
Epoch: 6, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.558 Vali Acc: 0.732 Test Loss: 0.558 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.024580478668213
Epoch: 7, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.576 Vali Acc: 0.732 Test Loss: 0.576 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.573086977005005
Epoch: 8, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.611 Vali Acc: 0.727 Test Loss: 0.611 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.340284824371338
Epoch: 9, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.628 Vali Acc: 0.712 Test Loss: 0.628 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.259089708328247
Epoch: 10, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.634 Vali Acc: 0.727 Test Loss: 0.634 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.182805299758911
Epoch: 11, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.601 Vali Acc: 0.698 Test Loss: 0.601 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.195026874542236
Epoch: 12, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.651 Vali Acc: 0.702 Test Loss: 0.651 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.633165597915649
Epoch: 13, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.658 Vali Acc: 0.717 Test Loss: 0.658 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.174178600311279
Epoch: 14, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.722 Vali Acc: 0.712 Test Loss: 0.722 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.247157335281372
Epoch: 15, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.734 Vali Acc: 0.624 Test Loss: 0.734 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 4716610
model size : 18.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.959306716918945
Epoch: 1, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.629 Vali Acc: 0.717 Test Loss: 0.629 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.17523455619812
Epoch: 2, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.584 Vali Acc: 0.712 Test Loss: 0.584 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.701667547225952
Epoch: 3, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.611 Vali Acc: 0.712 Test Loss: 0.611 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.842421770095825
Epoch: 4, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.602 Vali Acc: 0.732 Test Loss: 0.602 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731701).  Saving model ...
Epoch: 5 cost time: 3.833850622177124
Epoch: 5, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.542 Vali Acc: 0.746 Test Loss: 0.542 Test Acc: 0.746
Validation loss decreased (-0.731701 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 3.0144972801208496
Epoch: 6, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.555 Vali Acc: 0.732 Test Loss: 0.555 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.147658109664917
Epoch: 7, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.630 Vali Acc: 0.737 Test Loss: 0.630 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.798339605331421
Epoch: 8, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.577 Vali Acc: 0.737 Test Loss: 0.577 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.346918821334839
Epoch: 9, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.569 Vali Acc: 0.727 Test Loss: 0.569 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.034018278121948
Epoch: 10, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.565 Vali Acc: 0.737 Test Loss: 0.565 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.4862539768218994
Epoch: 11, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.572 Vali Acc: 0.737 Test Loss: 0.572 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.504554510116577
Epoch: 12, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.586 Vali Acc: 0.732 Test Loss: 0.586 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.036949396133423
Epoch: 13, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.625 Vali Acc: 0.732 Test Loss: 0.625 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.242020606994629
Epoch: 14, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.595 Vali Acc: 0.741 Test Loss: 0.595 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.895768880844116
Epoch: 15, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.627 Vali Acc: 0.737 Test Loss: 0.627 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 4701666
model size : 18.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.664567708969116
Epoch: 1, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 6.002871513366699
Epoch: 2, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.570 Vali Acc: 0.746 Test Loss: 0.570 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 5.122764587402344
Epoch: 3, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.581 Vali Acc: 0.741 Test Loss: 0.581 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.4913928508758545
Epoch: 4, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.590 Vali Acc: 0.727 Test Loss: 0.590 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.682557106018066
Epoch: 5, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.656 Vali Acc: 0.737 Test Loss: 0.656 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.113730430603027
Epoch: 6, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.727 Vali Acc: 0.634 Test Loss: 0.727 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.171797752380371
Epoch: 7, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.697 Vali Acc: 0.732 Test Loss: 0.697 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.157636404037476
Epoch: 8, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.757 Vali Acc: 0.707 Test Loss: 0.757 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.600403785705566
Epoch: 9, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.827 Vali Acc: 0.712 Test Loss: 0.827 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.6413733959198
Epoch: 10, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.885 Vali Acc: 0.629 Test Loss: 0.885 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.634690046310425
Epoch: 11, Steps: 13 | Train Loss: 0.060 Vali Loss: 1.813 Vali Acc: 0.722 Test Loss: 1.813 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.812680006027222
Epoch: 12, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.013 Vali Acc: 0.707 Test Loss: 1.013 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 4878338
model size : 18.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.318344831466675
Epoch: 1, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.057422161102295
Epoch: 2, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.569 Vali Acc: 0.751 Test Loss: 0.569 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 4.791221857070923
Epoch: 3, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.689 Vali Acc: 0.737 Test Loss: 0.689 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.110226631164551
Epoch: 4, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.585 Vali Acc: 0.722 Test Loss: 0.585 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.414448261260986
Epoch: 5, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.596 Vali Acc: 0.722 Test Loss: 0.596 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.480695009231567
Epoch: 6, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.609 Vali Acc: 0.727 Test Loss: 0.609 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.702288627624512
Epoch: 7, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.678 Vali Acc: 0.737 Test Loss: 0.678 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.7341437339782715
Epoch: 8, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.666 Vali Acc: 0.717 Test Loss: 0.666 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.86220645904541
Epoch: 9, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.658 Vali Acc: 0.717 Test Loss: 0.658 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.227893114089966
Epoch: 10, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.885 Vali Acc: 0.722 Test Loss: 0.885 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.1389665603637695
Epoch: 11, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.757 Vali Acc: 0.702 Test Loss: 0.757 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.3893749713897705
Epoch: 12, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.969 Vali Acc: 0.712 Test Loss: 0.969 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 4753730
model size : 18.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.530933618545532
Epoch: 1, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.577 Vali Acc: 0.717 Test Loss: 0.577 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.562572002410889
Epoch: 2, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.627 Vali Acc: 0.737 Test Loss: 0.627 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 4.644524097442627
Epoch: 3, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.553 Vali Acc: 0.751 Test Loss: 0.553 Test Acc: 0.751
Validation loss decreased (-0.736579 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 4.117652416229248
Epoch: 4, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.579 Vali Acc: 0.741 Test Loss: 0.579 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.496889591217041
Epoch: 5, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.651 Vali Acc: 0.737 Test Loss: 0.651 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.139540672302246
Epoch: 6, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.677 Vali Acc: 0.737 Test Loss: 0.677 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.748584270477295
Epoch: 7, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.630 Vali Acc: 0.702 Test Loss: 0.630 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.461927175521851
Epoch: 8, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.674 Vali Acc: 0.707 Test Loss: 0.674 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.550929307937622
Epoch: 9, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.691 Vali Acc: 0.722 Test Loss: 0.691 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.249498128890991
Epoch: 10, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.652 Vali Acc: 0.698 Test Loss: 0.652 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.961325168609619
Epoch: 11, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.710 Vali Acc: 0.707 Test Loss: 0.710 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.9735605716705322
Epoch: 12, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.781 Vali Acc: 0.707 Test Loss: 0.781 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.343504190444946
Epoch: 13, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.751 Vali Acc: 0.702 Test Loss: 0.751 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 4722818
model size : 18.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.202139377593994
Epoch: 1, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.592 Vali Acc: 0.722 Test Loss: 0.592 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.912184953689575
Epoch: 2, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 4.2186877727508545
Epoch: 3, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.578 Vali Acc: 0.756 Test Loss: 0.578 Test Acc: 0.756
Validation loss decreased (-0.721945 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 3.466980457305908
Epoch: 4, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.555 Vali Acc: 0.741 Test Loss: 0.555 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2416763305664062
Epoch: 5, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.619 Vali Acc: 0.727 Test Loss: 0.619 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4997806549072266
Epoch: 6, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.625 Vali Acc: 0.732 Test Loss: 0.625 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.985678195953369
Epoch: 7, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.648 Vali Acc: 0.727 Test Loss: 0.648 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.2094509601593018
Epoch: 8, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.655 Vali Acc: 0.732 Test Loss: 0.655 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.463682174682617
Epoch: 9, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.662 Vali Acc: 0.717 Test Loss: 0.662 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.5742247104644775
Epoch: 10, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.668 Vali Acc: 0.678 Test Loss: 0.668 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.848672389984131
Epoch: 11, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.619 Vali Acc: 0.722 Test Loss: 0.619 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.4386003017425537
Epoch: 12, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.867 Vali Acc: 0.707 Test Loss: 0.867 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.7558939456939697
Epoch: 13, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.790 Vali Acc: 0.659 Test Loss: 0.790 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 4691906
model size : 18.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.435554504394531
Epoch: 1, Steps: 13 | Train Loss: 0.695 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.584836721420288
Epoch: 2, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.599 Vali Acc: 0.717 Test Loss: 0.599 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9039289951324463
Epoch: 3, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.599 Vali Acc: 0.737 Test Loss: 0.599 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 3.6854407787323
Epoch: 4, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.563 Vali Acc: 0.741 Test Loss: 0.563 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 3.4761576652526855
Epoch: 5, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.573 Vali Acc: 0.741 Test Loss: 0.573 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.497415781021118
Epoch: 6, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.602 Vali Acc: 0.746 Test Loss: 0.602 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746335).  Saving model ...
Epoch: 7 cost time: 3.378641128540039
Epoch: 7, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.599 Vali Acc: 0.707 Test Loss: 0.599 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.933241605758667
Epoch: 8, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.610 Vali Acc: 0.737 Test Loss: 0.610 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.651536464691162
Epoch: 9, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.622 Vali Acc: 0.668 Test Loss: 0.622 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.63006329536438
Epoch: 10, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.631 Vali Acc: 0.746 Test Loss: 0.631 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.759077548980713
Epoch: 11, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.643 Vali Acc: 0.727 Test Loss: 0.643 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.391662120819092
Epoch: 12, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.644 Vali Acc: 0.722 Test Loss: 0.644 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.219766616821289
Epoch: 13, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.670 Vali Acc: 0.707 Test Loss: 0.670 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.864536762237549
Epoch: 14, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.673 Vali Acc: 0.732 Test Loss: 0.673 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.1392250061035156
Epoch: 15, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.700 Vali Acc: 0.673 Test Loss: 0.700 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.307206153869629
Epoch: 16, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.770 Vali Acc: 0.732 Test Loss: 0.770 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 4676930
model size : 18.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.507943630218506
Epoch: 1, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.599 Vali Acc: 0.722 Test Loss: 0.599 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.506889343261719
Epoch: 2, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.572 Vali Acc: 0.727 Test Loss: 0.572 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 4.417724609375
Epoch: 3, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.577 Vali Acc: 0.741 Test Loss: 0.577 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 4.626694917678833
Epoch: 4, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.559 Vali Acc: 0.732 Test Loss: 0.559 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.484534025192261
Epoch: 5, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.553 Vali Acc: 0.741 Test Loss: 0.553 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 4.026395559310913
Epoch: 6, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.548 Vali Acc: 0.737 Test Loss: 0.548 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.972560167312622
Epoch: 7, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.559 Vali Acc: 0.727 Test Loss: 0.559 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.9696874618530273
Epoch: 8, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.599 Vali Acc: 0.727 Test Loss: 0.599 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.231265306472778
Epoch: 9, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.592 Vali Acc: 0.737 Test Loss: 0.592 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.0704896450042725
Epoch: 10, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.644 Vali Acc: 0.727 Test Loss: 0.644 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.105332136154175
Epoch: 11, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.648 Vali Acc: 0.722 Test Loss: 0.648 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.39109206199646
Epoch: 12, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.673 Vali Acc: 0.732 Test Loss: 0.673 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.9655702114105225
Epoch: 13, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.662 Vali Acc: 0.722 Test Loss: 0.662 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.695538520812988
Epoch: 14, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.658 Vali Acc: 0.693 Test Loss: 0.658 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.705944538116455
Epoch: 15, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.657 Vali Acc: 0.688 Test Loss: 0.657 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 4661954
model size : 18.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.5128114223480225
Epoch: 1, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.622 Vali Acc: 0.717 Test Loss: 0.622 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.6073412895202637
Epoch: 2, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.570 Vali Acc: 0.717 Test Loss: 0.570 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 3.7592482566833496
Epoch: 3, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.563 Vali Acc: 0.712 Test Loss: 0.563 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.44622540473938
Epoch: 4, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.554 Vali Acc: 0.737 Test Loss: 0.554 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 2.977771043777466
Epoch: 5, Steps: 13 | Train Loss: 0.347 Vali Loss: 0.537 Vali Acc: 0.727 Test Loss: 0.537 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.621096611022949
Epoch: 6, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.532 Vali Acc: 0.727 Test Loss: 0.532 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.002281188964844
Epoch: 7, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.538 Vali Acc: 0.727 Test Loss: 0.538 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.322249412536621
Epoch: 8, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.543 Vali Acc: 0.727 Test Loss: 0.543 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.08175802230835
Epoch: 9, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.538 Vali Acc: 0.741 Test Loss: 0.538 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 10 cost time: 3.7467405796051025
Epoch: 10, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.549 Vali Acc: 0.746 Test Loss: 0.549 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 11 cost time: 3.587125778198242
Epoch: 11, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.590 Vali Acc: 0.732 Test Loss: 0.590 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.409940481185913
Epoch: 12, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.539 Vali Acc: 0.751 Test Loss: 0.539 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 13 cost time: 3.9519662857055664
Epoch: 13, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.551 Vali Acc: 0.746 Test Loss: 0.551 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.255783557891846
Epoch: 14, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.590 Vali Acc: 0.741 Test Loss: 0.590 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.935612440109253
Epoch: 15, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.585 Vali Acc: 0.746 Test Loss: 0.585 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.607914447784424
Epoch: 16, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.633 Vali Acc: 0.741 Test Loss: 0.633 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.499890327453613
Epoch: 17, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.635 Vali Acc: 0.756 Test Loss: 0.635 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756091).  Saving model ...
Epoch: 18 cost time: 3.710866689682007
Epoch: 18, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.621 Vali Acc: 0.737 Test Loss: 0.621 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.266231060028076
Epoch: 19, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.688 Vali Acc: 0.751 Test Loss: 0.688 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.038641452789307
Epoch: 20, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.703 Vali Acc: 0.751 Test Loss: 0.703 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.567920207977295
Epoch: 21, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.693 Vali Acc: 0.727 Test Loss: 0.693 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.598053932189941
Epoch: 22, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.753 Vali Acc: 0.732 Test Loss: 0.753 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.302493095397949
Epoch: 23, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.803 Vali Acc: 0.722 Test Loss: 0.803 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.928034543991089
Epoch: 24, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.799 Vali Acc: 0.712 Test Loss: 0.799 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.4658637046813965
Epoch: 25, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.851 Vali Acc: 0.717 Test Loss: 0.851 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.152097940444946
Epoch: 26, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.841 Vali Acc: 0.727 Test Loss: 0.841 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.558859348297119
Epoch: 27, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.943 Vali Acc: 0.698 Test Loss: 0.943 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 4647010
model size : 17.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 13.60789155960083
Epoch: 1, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.561 Vali Acc: 0.737 Test Loss: 0.561 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 11.722663402557373
Epoch: 2, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.730 Vali Acc: 0.717 Test Loss: 0.730 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.211416006088257
Epoch: 3, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.814 Vali Acc: 0.629 Test Loss: 0.814 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.950774431228638
Epoch: 4, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.974 Vali Acc: 0.639 Test Loss: 0.974 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.883917808532715
Epoch: 5, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.124 Vali Acc: 0.620 Test Loss: 1.124 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.748222827911377
Epoch: 6, Steps: 13 | Train Loss: 0.157 Vali Loss: 1.857 Vali Acc: 0.722 Test Loss: 1.857 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.990404605865479
Epoch: 7, Steps: 13 | Train Loss: 0.120 Vali Loss: 1.950 Vali Acc: 0.737 Test Loss: 1.950 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.264247179031372
Epoch: 8, Steps: 13 | Train Loss: 0.457 Vali Loss: 3.115 Vali Acc: 0.683 Test Loss: 3.115 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 11.625858545303345
Epoch: 9, Steps: 13 | Train Loss: 0.134 Vali Loss: 3.229 Vali Acc: 0.702 Test Loss: 3.229 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 9.75766921043396
Epoch: 10, Steps: 13 | Train Loss: 0.042 Vali Loss: 3.150 Vali Acc: 0.507 Test Loss: 3.150 Test Acc: 0.507
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 11.088941097259521
Epoch: 11, Steps: 13 | Train Loss: 0.314 Vali Loss: 8.435 Vali Acc: 0.756 Test Loss: 8.435 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756013).  Saving model ...
Epoch: 12 cost time: 11.082964420318604
Epoch: 12, Steps: 13 | Train Loss: 1.114 Vali Loss: 3.399 Vali Acc: 0.741 Test Loss: 3.399 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.100461483001709
Epoch: 13, Steps: 13 | Train Loss: 0.046 Vali Loss: 3.430 Vali Acc: 0.717 Test Loss: 3.430 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.43008804321289
Epoch: 14, Steps: 13 | Train Loss: 0.103 Vali Loss: 3.882 Vali Acc: 0.644 Test Loss: 3.882 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 11.921632289886475
Epoch: 15, Steps: 13 | Train Loss: 0.021 Vali Loss: 4.834 Vali Acc: 0.722 Test Loss: 4.834 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 9.973493099212646
Epoch: 16, Steps: 13 | Train Loss: 0.055 Vali Loss: 4.263 Vali Acc: 0.678 Test Loss: 4.263 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 10.807379484176636
Epoch: 17, Steps: 13 | Train Loss: 0.047 Vali Loss: 4.700 Vali Acc: 0.717 Test Loss: 4.700 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 11.347590208053589
Epoch: 18, Steps: 13 | Train Loss: 0.048 Vali Loss: 4.947 Vali Acc: 0.693 Test Loss: 4.947 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 9.079941272735596
Epoch: 19, Steps: 13 | Train Loss: 0.009 Vali Loss: 6.535 Vali Acc: 0.727 Test Loss: 6.535 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 10.003646850585938
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 5.942 Vali Acc: 0.751 Test Loss: 5.942 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 10.077039003372192
Epoch: 21, Steps: 13 | Train Loss: 0.005 Vali Loss: 5.891 Vali Acc: 0.717 Test Loss: 5.891 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 14591490
model size : 56.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 11.49335265159607
Epoch: 1, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.605 Vali Acc: 0.732 Test Loss: 0.605 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 8.572725534439087
Epoch: 2, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.858208179473877
Epoch: 3, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.644 Vali Acc: 0.693 Test Loss: 0.644 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.772024154663086
Epoch: 4, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.724 Vali Acc: 0.707 Test Loss: 0.724 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.168343782424927
Epoch: 5, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.808 Vali Acc: 0.659 Test Loss: 0.808 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.300873279571533
Epoch: 6, Steps: 13 | Train Loss: 0.048 Vali Loss: 1.135 Vali Acc: 0.737 Test Loss: 1.135 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736574).  Saving model ...
Epoch: 7 cost time: 8.6266188621521
Epoch: 7, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.989 Vali Acc: 0.737 Test Loss: 0.989 Test Acc: 0.737
Validation loss decreased (-0.736574 --> -0.736575).  Saving model ...
Epoch: 8 cost time: 7.581762313842773
Epoch: 8, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.142 Vali Acc: 0.746 Test Loss: 1.142 Test Acc: 0.746
Validation loss decreased (-0.736575 --> -0.746330).  Saving model ...
Epoch: 9 cost time: 7.749561071395874
Epoch: 9, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.189 Vali Acc: 0.737 Test Loss: 1.189 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.027859687805176
Epoch: 10, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.818 Vali Acc: 0.751 Test Loss: 1.818 Test Acc: 0.751
Validation loss decreased (-0.746330 --> -0.751201).  Saving model ...
Epoch: 11 cost time: 8.638793230056763
Epoch: 11, Steps: 13 | Train Loss: 0.061 Vali Loss: 1.521 Vali Acc: 0.712 Test Loss: 1.521 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.690269708633423
Epoch: 12, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.671 Vali Acc: 0.683 Test Loss: 1.671 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.694875240325928
Epoch: 13, Steps: 13 | Train Loss: 0.025 Vali Loss: 2.026 Vali Acc: 0.678 Test Loss: 2.026 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.39919662475586
Epoch: 14, Steps: 13 | Train Loss: 0.013 Vali Loss: 2.005 Vali Acc: 0.644 Test Loss: 2.005 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.301194429397583
Epoch: 15, Steps: 13 | Train Loss: 0.007 Vali Loss: 2.048 Vali Acc: 0.668 Test Loss: 2.048 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.682939767837524
Epoch: 16, Steps: 13 | Train Loss: 0.005 Vali Loss: 2.507 Vali Acc: 0.673 Test Loss: 2.507 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.614273548126221
Epoch: 17, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.957 Vali Acc: 0.634 Test Loss: 1.957 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.5819501876831055
Epoch: 18, Steps: 13 | Train Loss: 0.026 Vali Loss: 2.152 Vali Acc: 0.673 Test Loss: 2.152 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 7.7485878467559814
Epoch: 19, Steps: 13 | Train Loss: 0.022 Vali Loss: 2.612 Vali Acc: 0.717 Test Loss: 2.612 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 7.331153869628906
Epoch: 20, Steps: 13 | Train Loss: 0.010 Vali Loss: 2.344 Vali Acc: 0.702 Test Loss: 2.344 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 14093058
model size : 54.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 10.632736206054688
Epoch: 1, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.593 Vali Acc: 0.732 Test Loss: 0.593 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 7.634883642196655
Epoch: 2, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.597 Vali Acc: 0.683 Test Loss: 0.597 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.147464513778687
Epoch: 3, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.563 Vali Acc: 0.727 Test Loss: 0.563 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.512923240661621
Epoch: 4, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.641 Vali Acc: 0.732 Test Loss: 0.641 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.260634422302246
Epoch: 5, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.795 Vali Acc: 0.732 Test Loss: 0.795 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.343772411346436
Epoch: 6, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.934 Vali Acc: 0.737 Test Loss: 0.934 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736576).  Saving model ...
Epoch: 7 cost time: 8.154235601425171
Epoch: 7, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.922 Vali Acc: 0.717 Test Loss: 0.922 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.586189031600952
Epoch: 8, Steps: 13 | Train Loss: 0.093 Vali Loss: 1.008 Vali Acc: 0.615 Test Loss: 1.008 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.444690704345703
Epoch: 9, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.120 Vali Acc: 0.722 Test Loss: 1.120 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.042068243026733
Epoch: 10, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.303 Vali Acc: 0.712 Test Loss: 1.303 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.813027858734131
Epoch: 11, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.469 Vali Acc: 0.737 Test Loss: 1.469 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.951835632324219
Epoch: 12, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.576 Vali Acc: 0.580 Test Loss: 1.576 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.232945203781128
Epoch: 13, Steps: 13 | Train Loss: 0.023 Vali Loss: 2.623 Vali Acc: 0.712 Test Loss: 2.623 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.666446685791016
Epoch: 14, Steps: 13 | Train Loss: 0.096 Vali Loss: 1.859 Vali Acc: 0.639 Test Loss: 1.859 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.463961601257324
Epoch: 15, Steps: 13 | Train Loss: 0.121 Vali Loss: 2.350 Vali Acc: 0.717 Test Loss: 2.350 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.6049323081970215
Epoch: 16, Steps: 13 | Train Loss: 0.225 Vali Loss: 2.493 Vali Acc: 0.600 Test Loss: 2.493 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 13938178
model size : 53.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 11.033763408660889
Epoch: 1, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.604 Vali Acc: 0.712 Test Loss: 0.604 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 8.255499839782715
Epoch: 2, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.538 Vali Acc: 0.751 Test Loss: 0.538 Test Acc: 0.751
Validation loss decreased (-0.712189 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 7.394112825393677
Epoch: 3, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.657 Vali Acc: 0.737 Test Loss: 0.657 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.099313735961914
Epoch: 4, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.618 Vali Acc: 0.727 Test Loss: 0.618 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.685290336608887
Epoch: 5, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.671 Vali Acc: 0.722 Test Loss: 0.671 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.876093149185181
Epoch: 6, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.893 Vali Acc: 0.722 Test Loss: 0.893 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.158314943313599
Epoch: 7, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.736 Vali Acc: 0.702 Test Loss: 0.736 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.777133464813232
Epoch: 8, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.825 Vali Acc: 0.673 Test Loss: 0.825 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.79398512840271
Epoch: 9, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.396 Vali Acc: 0.727 Test Loss: 1.396 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 8.058937311172485
Epoch: 10, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.989 Vali Acc: 0.683 Test Loss: 0.989 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.460813045501709
Epoch: 11, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.056 Vali Acc: 0.702 Test Loss: 1.056 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.956188440322876
Epoch: 12, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.945 Vali Acc: 0.688 Test Loss: 0.945 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 13845762
model size : 53.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.378110408782959
Epoch: 1, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 6.1529858112335205
Epoch: 2, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.642 Vali Acc: 0.751 Test Loss: 0.642 Test Acc: 0.751
Validation loss decreased (-0.717067 --> -0.751213).  Saving model ...
Epoch: 3 cost time: 6.783636569976807
Epoch: 3, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.602 Vali Acc: 0.737 Test Loss: 0.602 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.031883239746094
Epoch: 4, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.647 Vali Acc: 0.727 Test Loss: 0.647 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.197644233703613
Epoch: 5, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.993 Vali Acc: 0.741 Test Loss: 0.993 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.052990674972534
Epoch: 6, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.760 Vali Acc: 0.722 Test Loss: 0.760 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.553705215454102
Epoch: 7, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.813 Vali Acc: 0.732 Test Loss: 0.813 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.682683706283569
Epoch: 8, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.952 Vali Acc: 0.737 Test Loss: 0.952 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.9571213722229
Epoch: 9, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.949 Vali Acc: 0.702 Test Loss: 0.949 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.834688186645508
Epoch: 10, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.976 Vali Acc: 0.688 Test Loss: 0.976 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.709969520568848
Epoch: 11, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.232 Vali Acc: 0.722 Test Loss: 1.232 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.046125411987305
Epoch: 12, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.953 Vali Acc: 0.659 Test Loss: 0.953 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 13754626
model size : 52.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.695777654647827
Epoch: 1, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.574 Vali Acc: 0.717 Test Loss: 0.574 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 6.575224161148071
Epoch: 2, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.550 Vali Acc: 0.761 Test Loss: 0.550 Test Acc: 0.761
Validation loss decreased (-0.717067 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 6.000830411911011
Epoch: 3, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.587 Vali Acc: 0.727 Test Loss: 0.587 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.140181303024292
Epoch: 4, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.597 Vali Acc: 0.741 Test Loss: 0.597 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.9677839279174805
Epoch: 5, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.620 Vali Acc: 0.737 Test Loss: 0.620 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.423318862915039
Epoch: 6, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.581 Vali Acc: 0.717 Test Loss: 0.581 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.247458219528198
Epoch: 7, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.619 Vali Acc: 0.698 Test Loss: 0.619 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.954998970031738
Epoch: 8, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.691 Vali Acc: 0.639 Test Loss: 0.691 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.009023904800415
Epoch: 9, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.709 Vali Acc: 0.654 Test Loss: 0.709 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.653800010681152
Epoch: 10, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.800 Vali Acc: 0.717 Test Loss: 0.800 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.000780344009399
Epoch: 11, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.744 Vali Acc: 0.644 Test Loss: 0.744 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.7679643630981445
Epoch: 12, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.852 Vali Acc: 0.722 Test Loss: 0.852 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 13694722
model size : 52.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.215612888336182
Epoch: 1, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 6.103362083435059
Epoch: 2, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.590 Vali Acc: 0.737 Test Loss: 0.590 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 6.055444240570068
Epoch: 3, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.566 Vali Acc: 0.722 Test Loss: 0.566 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.183014392852783
Epoch: 4, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.555 Vali Acc: 0.717 Test Loss: 0.555 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.520639181137085
Epoch: 5, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.581 Vali Acc: 0.707 Test Loss: 0.581 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.237364768981934
Epoch: 6, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.630 Vali Acc: 0.712 Test Loss: 0.630 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.007059097290039
Epoch: 7, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.711 Vali Acc: 0.727 Test Loss: 0.711 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.572789192199707
Epoch: 8, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.653 Vali Acc: 0.673 Test Loss: 0.653 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.229645729064941
Epoch: 9, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.713 Vali Acc: 0.712 Test Loss: 0.713 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.68214225769043
Epoch: 10, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.637 Vali Acc: 0.732 Test Loss: 0.637 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.0523974895477295
Epoch: 11, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.748 Vali Acc: 0.722 Test Loss: 0.748 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.455428600311279
Epoch: 12, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.675 Vali Acc: 0.698 Test Loss: 0.675 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 13666178
model size : 52.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.136706829071045
Epoch: 1, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.652 Vali Acc: 0.712 Test Loss: 0.652 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 6.733747959136963
Epoch: 2, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.789 Vali Acc: 0.737 Test Loss: 0.789 Test Acc: 0.737
Validation loss decreased (-0.712189 --> -0.736577).  Saving model ...
Epoch: 3 cost time: 6.04036283493042
Epoch: 3, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.837 Vali Acc: 0.717 Test Loss: 0.837 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.139034748077393
Epoch: 4, Steps: 13 | Train Loss: 0.159 Vali Loss: 1.142 Vali Acc: 0.727 Test Loss: 1.142 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.312139511108398
Epoch: 5, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.884 Vali Acc: 0.722 Test Loss: 0.884 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.435788154602051
Epoch: 6, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.843 Vali Acc: 0.702 Test Loss: 0.843 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.049801349639893
Epoch: 7, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.063 Vali Acc: 0.722 Test Loss: 1.063 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.880549907684326
Epoch: 8, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.895 Vali Acc: 0.698 Test Loss: 0.895 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.325649976730347
Epoch: 9, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.715 Vali Acc: 0.732 Test Loss: 1.715 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.5285398960113525
Epoch: 10, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.026 Vali Acc: 0.624 Test Loss: 1.026 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.170907258987427
Epoch: 11, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.514 Vali Acc: 0.712 Test Loss: 1.514 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.618436574935913
Epoch: 12, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.099 Vali Acc: 0.702 Test Loss: 1.099 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 4780802
model size : 18.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.170631408691406
Epoch: 1, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.603 Vali Acc: 0.722 Test Loss: 0.603 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.613452434539795
Epoch: 2, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.686 Vali Acc: 0.615 Test Loss: 0.686 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.633274793624878
Epoch: 3, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.601 Vali Acc: 0.712 Test Loss: 0.601 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.455328941345215
Epoch: 4, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.647 Vali Acc: 0.741 Test Loss: 0.647 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741457).  Saving model ...
Epoch: 5 cost time: 4.217313051223755
Epoch: 5, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.651 Vali Acc: 0.727 Test Loss: 0.651 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.488983154296875
Epoch: 6, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.795 Vali Acc: 0.741 Test Loss: 0.795 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.400198698043823
Epoch: 7, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.924 Vali Acc: 0.737 Test Loss: 0.924 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.107433319091797
Epoch: 8, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.845 Vali Acc: 0.707 Test Loss: 0.845 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.484312295913696
Epoch: 9, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.943 Vali Acc: 0.717 Test Loss: 0.943 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.765475749969482
Epoch: 10, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.046 Vali Acc: 0.693 Test Loss: 1.046 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.816485166549683
Epoch: 11, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.021 Vali Acc: 0.659 Test Loss: 1.021 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.71115779876709
Epoch: 12, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.254 Vali Acc: 0.717 Test Loss: 1.254 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.709481239318848
Epoch: 13, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.152 Vali Acc: 0.722 Test Loss: 1.152 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.977771520614624
Epoch: 14, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.251 Vali Acc: 0.654 Test Loss: 1.251 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 4531586
model size : 17.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.304964303970337
Epoch: 1, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.569 Vali Acc: 0.717 Test Loss: 0.569 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.0611724853515625
Epoch: 2, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.572 Vali Acc: 0.737 Test Loss: 0.572 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 4.781863689422607
Epoch: 3, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.591 Vali Acc: 0.727 Test Loss: 0.591 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.446071624755859
Epoch: 4, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.604 Vali Acc: 0.741 Test Loss: 0.604 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741457).  Saving model ...
Epoch: 5 cost time: 4.84604024887085
Epoch: 5, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.651 Vali Acc: 0.702 Test Loss: 0.651 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.986335039138794
Epoch: 6, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.786 Vali Acc: 0.722 Test Loss: 0.786 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.8962790966033936
Epoch: 7, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.688 Vali Acc: 0.727 Test Loss: 0.688 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.319056272506714
Epoch: 8, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.690 Vali Acc: 0.707 Test Loss: 0.690 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.582232713699341
Epoch: 9, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.823 Vali Acc: 0.741 Test Loss: 0.823 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.353560924530029
Epoch: 10, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.753 Vali Acc: 0.717 Test Loss: 0.753 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.830327033996582
Epoch: 11, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.826 Vali Acc: 0.702 Test Loss: 0.826 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.229281902313232
Epoch: 12, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.849 Vali Acc: 0.702 Test Loss: 0.849 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.2094645500183105
Epoch: 13, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.947 Vali Acc: 0.683 Test Loss: 0.947 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.9196460247039795
Epoch: 14, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.142 Vali Acc: 0.712 Test Loss: 1.142 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 4454146
model size : 17.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.074810981750488
Epoch: 1, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.723639249801636
Epoch: 2, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.627 Vali Acc: 0.751 Test Loss: 0.627 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751213).  Saving model ...
Epoch: 3 cost time: 4.75382924079895
Epoch: 3, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.533 Vali Acc: 0.756 Test Loss: 0.533 Test Acc: 0.756
Validation loss decreased (-0.751213 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 3.852576494216919
Epoch: 4, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.604 Vali Acc: 0.737 Test Loss: 0.604 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.319356918334961
Epoch: 5, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.594 Vali Acc: 0.727 Test Loss: 0.594 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.8265902996063232
Epoch: 6, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.603 Vali Acc: 0.732 Test Loss: 0.603 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.146381616592407
Epoch: 7, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.626 Vali Acc: 0.737 Test Loss: 0.626 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.152299642562866
Epoch: 8, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.635 Vali Acc: 0.712 Test Loss: 0.635 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.029156684875488
Epoch: 9, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.738 Vali Acc: 0.678 Test Loss: 0.738 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.778125047683716
Epoch: 10, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.669 Vali Acc: 0.698 Test Loss: 0.669 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.5115714073181152
Epoch: 11, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.702 Vali Acc: 0.693 Test Loss: 0.702 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.8495185375213623
Epoch: 12, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.715 Vali Acc: 0.698 Test Loss: 0.715 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.8308370113372803
Epoch: 13, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.796 Vali Acc: 0.732 Test Loss: 0.796 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 4407938
model size : 17.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.525326728820801
Epoch: 1, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.7543046474456787
Epoch: 2, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.581 Vali Acc: 0.732 Test Loss: 0.581 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 3.734092950820923
Epoch: 3, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.618 Vali Acc: 0.756 Test Loss: 0.618 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756091).  Saving model ...
Epoch: 4 cost time: 3.9654011726379395
Epoch: 4, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.549 Vali Acc: 0.751 Test Loss: 0.549 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.046099424362183
Epoch: 5, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.589 Vali Acc: 0.737 Test Loss: 0.589 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.622316598892212
Epoch: 6, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.630 Vali Acc: 0.756 Test Loss: 0.630 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.9401156902313232
Epoch: 7, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.644 Vali Acc: 0.751 Test Loss: 0.644 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.5664639472961426
Epoch: 8, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.637 Vali Acc: 0.746 Test Loss: 0.637 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.4565038681030273
Epoch: 9, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.718 Vali Acc: 0.737 Test Loss: 0.718 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.223110675811768
Epoch: 10, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.729 Vali Acc: 0.761 Test Loss: 0.729 Test Acc: 0.761
Validation loss decreased (-0.756091 --> -0.760968).  Saving model ...
Epoch: 11 cost time: 3.735208511352539
Epoch: 11, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.797 Vali Acc: 0.717 Test Loss: 0.797 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.166127681732178
Epoch: 12, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.776 Vali Acc: 0.741 Test Loss: 0.776 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.1798388957977295
Epoch: 13, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.804 Vali Acc: 0.712 Test Loss: 0.804 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.1689558029174805
Epoch: 14, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.870 Vali Acc: 0.688 Test Loss: 0.870 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.9063544273376465
Epoch: 15, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.843 Vali Acc: 0.717 Test Loss: 0.843 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.8531363010406494
Epoch: 16, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.979 Vali Acc: 0.620 Test Loss: 0.979 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.216397285461426
Epoch: 17, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.888 Vali Acc: 0.702 Test Loss: 0.888 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.533900737762451
Epoch: 18, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.950 Vali Acc: 0.683 Test Loss: 0.950 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.1030755043029785
Epoch: 19, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.027 Vali Acc: 0.644 Test Loss: 1.027 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.3963582515716553
Epoch: 20, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.201 Vali Acc: 0.702 Test Loss: 1.201 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 4362370
model size : 16.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.720043897628784
Epoch: 1, Steps: 13 | Train Loss: 0.642 Vali Loss: 0.592 Vali Acc: 0.717 Test Loss: 0.592 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.5460352897644043
Epoch: 2, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.580 Vali Acc: 0.722 Test Loss: 0.580 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 2.540098190307617
Epoch: 3, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.596 Vali Acc: 0.732 Test Loss: 0.596 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 4 cost time: 3.079983949661255
Epoch: 4, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.553 Vali Acc: 0.746 Test Loss: 0.553 Test Acc: 0.746
Validation loss decreased (-0.731701 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 3.071537733078003
Epoch: 5, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.577 Vali Acc: 0.751 Test Loss: 0.577 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 3.4615042209625244
Epoch: 6, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.580 Vali Acc: 0.746 Test Loss: 0.580 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.224770784378052
Epoch: 7, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.545 Vali Acc: 0.756 Test Loss: 0.545 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 8 cost time: 4.432244777679443
Epoch: 8, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.581 Vali Acc: 0.771 Test Loss: 0.581 Test Acc: 0.771
Validation loss decreased (-0.756092 --> -0.770726).  Saving model ...
Epoch: 9 cost time: 3.551449775695801
Epoch: 9, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.370500087738037
Epoch: 10, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.618 Vali Acc: 0.737 Test Loss: 0.618 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9295430183410645
Epoch: 11, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.677 Vali Acc: 0.741 Test Loss: 0.677 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.9134764671325684
Epoch: 12, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.708 Vali Acc: 0.629 Test Loss: 0.708 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.2593929767608643
Epoch: 13, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.882 Vali Acc: 0.737 Test Loss: 0.882 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.4680089950561523
Epoch: 14, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.731 Vali Acc: 0.688 Test Loss: 0.731 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.5220787525177
Epoch: 15, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.779 Vali Acc: 0.741 Test Loss: 0.779 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.069465160369873
Epoch: 16, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.738 Vali Acc: 0.698 Test Loss: 0.738 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.822416067123413
Epoch: 17, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.736 Vali Acc: 0.737 Test Loss: 0.736 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.160738945007324
Epoch: 18, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.673 Vali Acc: 0.683 Test Loss: 0.673 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 4332418
model size : 16.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.782403230667114
Epoch: 1, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.594 Vali Acc: 0.727 Test Loss: 0.594 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 3.9833016395568848
Epoch: 2, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.560 Vali Acc: 0.722 Test Loss: 0.560 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.013219833374023
Epoch: 3, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.547 Vali Acc: 0.741 Test Loss: 0.547 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 4.146548509597778
Epoch: 4, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.546 Vali Acc: 0.737 Test Loss: 0.546 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.038018465042114
Epoch: 5, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.558 Vali Acc: 0.751 Test Loss: 0.558 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 3.7496144771575928
Epoch: 6, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.544 Vali Acc: 0.737 Test Loss: 0.544 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5633437633514404
Epoch: 7, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.598 Vali Acc: 0.746 Test Loss: 0.598 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.5279343128204346
Epoch: 8, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.577 Vali Acc: 0.751 Test Loss: 0.577 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.703094005584717
Epoch: 9, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.614 Vali Acc: 0.722 Test Loss: 0.614 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.9115848541259766
Epoch: 10, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.615 Vali Acc: 0.732 Test Loss: 0.615 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.780578136444092
Epoch: 11, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.740 Vali Acc: 0.746 Test Loss: 0.740 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.510185480117798
Epoch: 12, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.618 Vali Acc: 0.727 Test Loss: 0.618 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.946272134780884
Epoch: 13, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.588 Vali Acc: 0.741 Test Loss: 0.588 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.030275106430054
Epoch: 14, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.653 Vali Acc: 0.737 Test Loss: 0.653 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.2945029735565186
Epoch: 15, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.655 Vali Acc: 0.707 Test Loss: 0.655 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 4318146
model size : 16.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.649719953536987
Epoch: 1, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.656 Vali Acc: 0.717 Test Loss: 0.656 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.301560640335083
Epoch: 2, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.612 Vali Acc: 0.737 Test Loss: 0.612 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 3.2850677967071533
Epoch: 3, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.577 Vali Acc: 0.722 Test Loss: 0.577 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.967163562774658
Epoch: 4, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.079275608062744
Epoch: 5, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.700 Vali Acc: 0.712 Test Loss: 0.700 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.052745819091797
Epoch: 6, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.690 Vali Acc: 0.712 Test Loss: 0.690 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.032496452331543
Epoch: 7, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.720 Vali Acc: 0.732 Test Loss: 0.720 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.5048370361328125
Epoch: 8, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.910 Vali Acc: 0.717 Test Loss: 0.910 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.258742332458496
Epoch: 9, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.854 Vali Acc: 0.712 Test Loss: 0.854 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.066469192504883
Epoch: 10, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.006 Vali Acc: 0.746 Test Loss: 1.006 Test Acc: 0.746
Validation loss decreased (-0.736579 --> -0.746331).  Saving model ...
Epoch: 11 cost time: 2.822476863861084
Epoch: 11, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.104 Vali Acc: 0.732 Test Loss: 1.104 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.373615264892578
Epoch: 12, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.050 Vali Acc: 0.698 Test Loss: 1.050 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.1635847091674805
Epoch: 13, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.051 Vali Acc: 0.727 Test Loss: 1.051 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.005206108093262
Epoch: 14, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.427 Vali Acc: 0.712 Test Loss: 1.427 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.365209341049194
Epoch: 15, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.244 Vali Acc: 0.727 Test Loss: 1.244 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.688310146331787
Epoch: 16, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.540 Vali Acc: 0.654 Test Loss: 1.540 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.278445243835449
Epoch: 17, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.693 Vali Acc: 0.717 Test Loss: 1.693 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.6420788764953613
Epoch: 18, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.554 Vali Acc: 0.707 Test Loss: 1.554 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.184079885482788
Epoch: 19, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.802 Vali Acc: 0.717 Test Loss: 1.802 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.425706148147583
Epoch: 20, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.715 Vali Acc: 0.722 Test Loss: 1.715 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1761666
model size : 6.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.662473440170288
Epoch: 1, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.572 Vali Acc: 0.717 Test Loss: 0.572 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.315643548965454
Epoch: 2, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.613 Vali Acc: 0.727 Test Loss: 0.613 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 3.3239712715148926
Epoch: 3, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.606 Vali Acc: 0.727 Test Loss: 0.606 Test Acc: 0.727
Validation loss decreased (-0.726823 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 3.015159845352173
Epoch: 4, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.610 Vali Acc: 0.737 Test Loss: 0.610 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 3.0226290225982666
Epoch: 5, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.710 Vali Acc: 0.732 Test Loss: 0.710 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.02060604095459
Epoch: 6, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.645 Vali Acc: 0.741 Test Loss: 0.645 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741457).  Saving model ...
Epoch: 7 cost time: 3.2960422039031982
Epoch: 7, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.771 Vali Acc: 0.717 Test Loss: 0.771 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.882707118988037
Epoch: 8, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.738 Vali Acc: 0.727 Test Loss: 0.738 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.19114089012146
Epoch: 9, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.851 Vali Acc: 0.741 Test Loss: 0.851 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.086151123046875
Epoch: 10, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.800 Vali Acc: 0.698 Test Loss: 0.800 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.4364843368530273
Epoch: 11, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.821 Vali Acc: 0.712 Test Loss: 0.821 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.484889268875122
Epoch: 12, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.848 Vali Acc: 0.707 Test Loss: 0.848 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.06632399559021
Epoch: 13, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.964 Vali Acc: 0.727 Test Loss: 0.964 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.063241720199585
Epoch: 14, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.967 Vali Acc: 0.654 Test Loss: 0.967 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.452183961868286
Epoch: 15, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.998 Vali Acc: 0.751 Test Loss: 0.998 Test Acc: 0.751
Validation loss decreased (-0.741457 --> -0.751210).  Saving model ...
Epoch: 16 cost time: 3.548771858215332
Epoch: 16, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.951 Vali Acc: 0.732 Test Loss: 0.951 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9490554332733154
Epoch: 17, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.963 Vali Acc: 0.722 Test Loss: 0.963 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.2193186283111572
Epoch: 18, Steps: 13 | Train Loss: 0.048 Vali Loss: 1.036 Vali Acc: 0.741 Test Loss: 1.036 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.1328694820404053
Epoch: 19, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.096 Vali Acc: 0.693 Test Loss: 1.096 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.1612794399261475
Epoch: 20, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.102 Vali Acc: 0.712 Test Loss: 1.102 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.991966724395752
Epoch: 21, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.046 Vali Acc: 0.698 Test Loss: 1.046 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.191526174545288
Epoch: 22, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.218 Vali Acc: 0.717 Test Loss: 1.218 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.6322898864746094
Epoch: 23, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.354 Vali Acc: 0.678 Test Loss: 1.354 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.480175256729126
Epoch: 24, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.666 Vali Acc: 0.741 Test Loss: 1.666 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.554279088973999
Epoch: 25, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.474 Vali Acc: 0.683 Test Loss: 1.474 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1637058
model size : 6.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.929955005645752
Epoch: 1, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.544682502746582
Epoch: 2, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.581 Vali Acc: 0.722 Test Loss: 0.581 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 2.540239095687866
Epoch: 3, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.584 Vali Acc: 0.746 Test Loss: 0.584 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 2.69033145904541
Epoch: 4, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.596 Vali Acc: 0.746 Test Loss: 0.596 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0603854656219482
Epoch: 5, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.601 Vali Acc: 0.717 Test Loss: 0.601 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.5182888507843018
Epoch: 6, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.744 Vali Acc: 0.737 Test Loss: 0.744 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.288708448410034
Epoch: 7, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.660 Vali Acc: 0.707 Test Loss: 0.660 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0014851093292236
Epoch: 8, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.650 Vali Acc: 0.722 Test Loss: 0.650 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.7497305870056152
Epoch: 9, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.693 Vali Acc: 0.644 Test Loss: 0.693 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.930299758911133
Epoch: 10, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.674 Vali Acc: 0.727 Test Loss: 0.674 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.6398372650146484
Epoch: 11, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.738 Vali Acc: 0.722 Test Loss: 0.738 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.08941650390625
Epoch: 12, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.729 Vali Acc: 0.702 Test Loss: 0.729 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.007763147354126
Epoch: 13, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.862 Vali Acc: 0.737 Test Loss: 0.862 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1598338
model size : 6.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.371707439422607
Epoch: 1, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.587 Vali Acc: 0.722 Test Loss: 0.587 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.6122078895568848
Epoch: 2, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.575 Vali Acc: 0.732 Test Loss: 0.575 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 2.5730137825012207
Epoch: 3, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.546 Vali Acc: 0.756 Test Loss: 0.546 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 2.490868091583252
Epoch: 4, Steps: 13 | Train Loss: 0.347 Vali Loss: 0.538 Vali Acc: 0.737 Test Loss: 0.538 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.819319725036621
Epoch: 5, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.600 Vali Acc: 0.741 Test Loss: 0.600 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.089871644973755
Epoch: 6, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.604 Vali Acc: 0.741 Test Loss: 0.604 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.4324209690093994
Epoch: 7, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.576 Vali Acc: 0.732 Test Loss: 0.576 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.033311128616333
Epoch: 8, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.577 Vali Acc: 0.732 Test Loss: 0.577 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.484464406967163
Epoch: 9, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.598 Vali Acc: 0.727 Test Loss: 0.598 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.415238380432129
Epoch: 10, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.634 Vali Acc: 0.737 Test Loss: 0.634 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.5653598308563232
Epoch: 11, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.619 Vali Acc: 0.688 Test Loss: 0.619 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.671476364135742
Epoch: 12, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.657 Vali Acc: 0.717 Test Loss: 0.657 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.7369377613067627
Epoch: 13, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.635 Vali Acc: 0.702 Test Loss: 0.635 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1575234
model size : 6.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.305392265319824
Epoch: 1, Steps: 13 | Train Loss: 0.695 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.7836670875549316
Epoch: 2, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.571 Vali Acc: 0.727 Test Loss: 0.571 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 2.7562952041625977
Epoch: 3, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.580 Vali Acc: 0.737 Test Loss: 0.580 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 2.5191922187805176
Epoch: 4, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.565 Vali Acc: 0.741 Test Loss: 0.565 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 2.661970615386963
Epoch: 5, Steps: 13 | Train Loss: 0.325 Vali Loss: 0.589 Vali Acc: 0.746 Test Loss: 0.589 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 2.4959657192230225
Epoch: 6, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.564 Vali Acc: 0.732 Test Loss: 0.564 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.635019302368164
Epoch: 7, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.613 Vali Acc: 0.741 Test Loss: 0.613 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7867918014526367
Epoch: 8, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.644 Vali Acc: 0.732 Test Loss: 0.644 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.949850559234619
Epoch: 9, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.625 Vali Acc: 0.717 Test Loss: 0.625 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.969492197036743
Epoch: 10, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.611 Vali Acc: 0.727 Test Loss: 0.611 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.302083969116211
Epoch: 11, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.655 Vali Acc: 0.722 Test Loss: 0.655 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.7484865188598633
Epoch: 12, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.605 Vali Acc: 0.722 Test Loss: 0.605 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.741835355758667
Epoch: 13, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.608 Vali Acc: 0.737 Test Loss: 0.608 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.5838377475738525
Epoch: 14, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.611 Vali Acc: 0.732 Test Loss: 0.611 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.8916068077087402
Epoch: 15, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.624 Vali Acc: 0.737 Test Loss: 0.624 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1552450
model size : 6.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.208491086959839
Epoch: 1, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.622 Vali Acc: 0.737 Test Loss: 0.622 Test Acc: 0.737
Validation loss decreased (inf --> -0.736579).  Saving model ...
Epoch: 2 cost time: 2.729065418243408
Epoch: 2, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.617 Vali Acc: 0.727 Test Loss: 0.617 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5741755962371826
Epoch: 3, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.592 Vali Acc: 0.727 Test Loss: 0.592 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8359413146972656
Epoch: 4, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.554 Vali Acc: 0.761 Test Loss: 0.554 Test Acc: 0.761
Validation loss decreased (-0.736579 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 2.8336093425750732
Epoch: 5, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.537 Vali Acc: 0.756 Test Loss: 0.537 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.451429843902588
Epoch: 6, Steps: 13 | Train Loss: 0.303 Vali Loss: 0.550 Vali Acc: 0.746 Test Loss: 0.550 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.563674211502075
Epoch: 7, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.546 Vali Acc: 0.751 Test Loss: 0.546 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.6282453536987305
Epoch: 8, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.547 Vali Acc: 0.737 Test Loss: 0.547 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.559257745742798
Epoch: 9, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.556 Vali Acc: 0.712 Test Loss: 0.556 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.8533949851989746
Epoch: 10, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.595 Vali Acc: 0.727 Test Loss: 0.595 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.4979188442230225
Epoch: 11, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.612 Vali Acc: 0.717 Test Loss: 0.612 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.7548303604125977
Epoch: 12, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.619 Vali Acc: 0.722 Test Loss: 0.619 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.4801559448242188
Epoch: 13, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.600 Vali Acc: 0.712 Test Loss: 0.600 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.693319797515869
Epoch: 14, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.603 Vali Acc: 0.707 Test Loss: 0.603 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 1537474
model size : 5.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.605355978012085
Epoch: 1, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.634 Vali Acc: 0.737 Test Loss: 0.634 Test Acc: 0.737
Validation loss decreased (inf --> -0.736579).  Saving model ...
Epoch: 2 cost time: 2.056452751159668
Epoch: 2, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.569 Vali Acc: 0.722 Test Loss: 0.569 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1747663021087646
Epoch: 3, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.569 Vali Acc: 0.717 Test Loss: 0.569 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.823188066482544
Epoch: 4, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.551 Vali Acc: 0.737 Test Loss: 0.551 Test Acc: 0.737
Validation loss decreased (-0.736579 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 2.120232343673706
Epoch: 5, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.546 Vali Acc: 0.737 Test Loss: 0.546 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 2.057360887527466
Epoch: 6, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.557 Vali Acc: 0.751 Test Loss: 0.557 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 2.210914373397827
Epoch: 7, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.561 Vali Acc: 0.746 Test Loss: 0.561 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1610357761383057
Epoch: 8, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.558 Vali Acc: 0.756 Test Loss: 0.558 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 9 cost time: 2.4763023853302
Epoch: 9, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.578 Vali Acc: 0.737 Test Loss: 0.578 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.498633623123169
Epoch: 10, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.552 Vali Acc: 0.741 Test Loss: 0.552 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4591681957244873
Epoch: 11, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.640 Vali Acc: 0.737 Test Loss: 0.640 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.408395767211914
Epoch: 12, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.704 Vali Acc: 0.737 Test Loss: 0.704 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.525096893310547
Epoch: 13, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.766 Vali Acc: 0.746 Test Loss: 0.766 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3373584747314453
Epoch: 14, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.665 Vali Acc: 0.737 Test Loss: 0.665 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.2533695697784424
Epoch: 15, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.604 Vali Acc: 0.732 Test Loss: 0.604 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.1394057273864746
Epoch: 16, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.627 Vali Acc: 0.737 Test Loss: 0.627 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.3176159858703613
Epoch: 17, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.637 Vali Acc: 0.737 Test Loss: 0.637 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.2211575508117676
Epoch: 18, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.735 Vali Acc: 0.737 Test Loss: 0.735 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1530338
model size : 5.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 13.008339166641235
Epoch: 1, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.784 Vali Acc: 0.741 Test Loss: 0.784 Test Acc: 0.741
Validation loss decreased (inf --> -0.741456).  Saving model ...
Epoch: 2 cost time: 10.89830493927002
Epoch: 2, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.884 Vali Acc: 0.712 Test Loss: 0.884 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.598901510238647
Epoch: 3, Steps: 13 | Train Loss: 0.367 Vali Loss: 1.063 Vali Acc: 0.717 Test Loss: 1.063 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.81908631324768
Epoch: 4, Steps: 13 | Train Loss: 0.318 Vali Loss: 1.507 Vali Acc: 0.717 Test Loss: 1.507 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.900486707687378
Epoch: 5, Steps: 13 | Train Loss: 0.162 Vali Loss: 1.453 Vali Acc: 0.712 Test Loss: 1.453 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.203562021255493
Epoch: 6, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.847 Vali Acc: 0.722 Test Loss: 1.847 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.637714624404907
Epoch: 7, Steps: 13 | Train Loss: 0.198 Vali Loss: 2.429 Vali Acc: 0.434 Test Loss: 2.429 Test Acc: 0.434
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 11.469368934631348
Epoch: 8, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.546 Vali Acc: 0.702 Test Loss: 1.546 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 12.196640491485596
Epoch: 9, Steps: 13 | Train Loss: 0.011 Vali Loss: 2.044 Vali Acc: 0.722 Test Loss: 2.044 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 11.786250352859497
Epoch: 10, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.776 Vali Acc: 0.673 Test Loss: 1.776 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 11.753561973571777
Epoch: 11, Steps: 13 | Train Loss: 0.150 Vali Loss: 2.353 Vali Acc: 0.727 Test Loss: 2.353 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 14497794
model size : 55.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 10.317240238189697
Epoch: 1, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.611 Vali Acc: 0.722 Test Loss: 0.611 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 8.406064510345459
Epoch: 2, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.600 Vali Acc: 0.761 Test Loss: 0.600 Test Acc: 0.761
Validation loss decreased (-0.721945 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 7.870564222335815
Epoch: 3, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.680 Vali Acc: 0.741 Test Loss: 0.680 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.588733196258545
Epoch: 4, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.745 Vali Acc: 0.717 Test Loss: 0.745 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.810282945632935
Epoch: 5, Steps: 13 | Train Loss: 0.107 Vali Loss: 1.080 Vali Acc: 0.727 Test Loss: 1.080 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.807508707046509
Epoch: 6, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.910 Vali Acc: 0.741 Test Loss: 0.910 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.12337064743042
Epoch: 7, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.995 Vali Acc: 0.727 Test Loss: 0.995 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 9.217318296432495
Epoch: 8, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.414 Vali Acc: 0.620 Test Loss: 1.414 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 9.015360116958618
Epoch: 9, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.226 Vali Acc: 0.702 Test Loss: 1.226 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 9.908016443252563
Epoch: 10, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.899 Vali Acc: 0.737 Test Loss: 1.899 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 9.07481575012207
Epoch: 11, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.717 Vali Acc: 0.683 Test Loss: 1.717 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.987715244293213
Epoch: 12, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.660 Vali Acc: 0.727 Test Loss: 1.660 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 13999362
model size : 53.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.659127950668335
Epoch: 1, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.675 Vali Acc: 0.722 Test Loss: 0.675 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 6.544573068618774
Epoch: 2, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.546 Vali Acc: 0.741 Test Loss: 0.546 Test Acc: 0.741
Validation loss decreased (-0.721944 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 7.472992420196533
Epoch: 3, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.596 Vali Acc: 0.702 Test Loss: 0.596 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.928859233856201
Epoch: 4, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.743 Vali Acc: 0.663 Test Loss: 0.743 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.377792119979858
Epoch: 5, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.690 Vali Acc: 0.693 Test Loss: 0.690 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.32970118522644
Epoch: 6, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.724 Vali Acc: 0.741 Test Loss: 0.724 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.440974473953247
Epoch: 7, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.820 Vali Acc: 0.727 Test Loss: 0.820 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.298440933227539
Epoch: 8, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.828 Vali Acc: 0.722 Test Loss: 0.828 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.0520946979522705
Epoch: 9, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.811 Vali Acc: 0.712 Test Loss: 0.811 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.125757932662964
Epoch: 10, Steps: 13 | Train Loss: 0.079 Vali Loss: 1.263 Vali Acc: 0.566 Test Loss: 1.263 Test Acc: 0.566
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.464601755142212
Epoch: 11, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.607 Vali Acc: 0.727 Test Loss: 1.607 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.102109670639038
Epoch: 12, Steps: 13 | Train Loss: 0.076 Vali Loss: 1.508 Vali Acc: 0.722 Test Loss: 1.508 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 13844482
model size : 53.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.055273294448853
Epoch: 1, Steps: 13 | Train Loss: 0.642 Vali Loss: 0.575 Vali Acc: 0.717 Test Loss: 0.575 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 6.905317783355713
Epoch: 2, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.629 Vali Acc: 0.741 Test Loss: 0.629 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 6.254705905914307
Epoch: 3, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.592 Vali Acc: 0.727 Test Loss: 0.592 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.607876777648926
Epoch: 4, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.773 Vali Acc: 0.663 Test Loss: 0.773 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.946180820465088
Epoch: 5, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.801 Vali Acc: 0.746 Test Loss: 0.801 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746333).  Saving model ...
Epoch: 6 cost time: 6.736644268035889
Epoch: 6, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.857 Vali Acc: 0.751 Test Loss: 0.857 Test Acc: 0.751
Validation loss decreased (-0.746333 --> -0.751211).  Saving model ...
Epoch: 7 cost time: 6.686243295669556
Epoch: 7, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.852 Vali Acc: 0.756 Test Loss: 0.852 Test Acc: 0.756
Validation loss decreased (-0.751211 --> -0.756089).  Saving model ...
Epoch: 8 cost time: 6.186273097991943
Epoch: 8, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.879 Vali Acc: 0.688 Test Loss: 0.879 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.424946308135986
Epoch: 9, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.913 Vali Acc: 0.654 Test Loss: 0.913 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.625480651855469
Epoch: 10, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.197 Vali Acc: 0.717 Test Loss: 1.197 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.453167915344238
Epoch: 11, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.151 Vali Acc: 0.712 Test Loss: 1.151 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.207587718963623
Epoch: 12, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.188 Vali Acc: 0.717 Test Loss: 1.188 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.434798002243042
Epoch: 13, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.142 Vali Acc: 0.659 Test Loss: 1.142 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.824859142303467
Epoch: 14, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.095 Vali Acc: 0.717 Test Loss: 1.095 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.386479377746582
Epoch: 15, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.224 Vali Acc: 0.639 Test Loss: 1.224 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.4710164070129395
Epoch: 16, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.461 Vali Acc: 0.741 Test Loss: 1.461 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.0156919956207275
Epoch: 17, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.356 Vali Acc: 0.620 Test Loss: 1.356 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 13752066
model size : 52.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.678741693496704
Epoch: 1, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.556 Vali Acc: 0.722 Test Loss: 0.556 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 4.8546576499938965
Epoch: 2, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.600 Vali Acc: 0.741 Test Loss: 0.600 Test Acc: 0.741
Validation loss decreased (-0.721946 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 5.894689559936523
Epoch: 3, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.600 Vali Acc: 0.741 Test Loss: 0.600 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.1403489112854
Epoch: 4, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.668 Vali Acc: 0.741 Test Loss: 0.668 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.11764669418335
Epoch: 5, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.704 Vali Acc: 0.707 Test Loss: 0.704 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.264910697937012
Epoch: 6, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.757 Vali Acc: 0.737 Test Loss: 0.757 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.470398187637329
Epoch: 7, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.804 Vali Acc: 0.673 Test Loss: 0.804 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.157248497009277
Epoch: 8, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.034 Vali Acc: 0.737 Test Loss: 1.034 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.99576473236084
Epoch: 9, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.806 Vali Acc: 0.683 Test Loss: 0.806 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.839234352111816
Epoch: 10, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.266 Vali Acc: 0.502 Test Loss: 1.266 Test Acc: 0.502
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.214178085327148
Epoch: 11, Steps: 13 | Train Loss: 0.130 Vali Loss: 1.375 Vali Acc: 0.712 Test Loss: 1.375 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.3941099643707275
Epoch: 12, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.076 Vali Acc: 0.639 Test Loss: 1.076 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 13660930
model size : 52.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.409626483917236
Epoch: 1, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.564 Vali Acc: 0.722 Test Loss: 0.564 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 5.48462438583374
Epoch: 2, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.575 Vali Acc: 0.751 Test Loss: 0.575 Test Acc: 0.751
Validation loss decreased (-0.721946 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 5.636832237243652
Epoch: 3, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.568 Vali Acc: 0.727 Test Loss: 0.568 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.478637218475342
Epoch: 4, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.645 Vali Acc: 0.702 Test Loss: 0.645 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.2698211669921875
Epoch: 5, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.583 Vali Acc: 0.741 Test Loss: 0.583 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.780731439590454
Epoch: 6, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.628 Vali Acc: 0.727 Test Loss: 0.628 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.6344218254089355
Epoch: 7, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.651 Vali Acc: 0.693 Test Loss: 0.651 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.941133260726929
Epoch: 8, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.603 Vali Acc: 0.698 Test Loss: 0.603 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.977514266967773
Epoch: 9, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.791 Vali Acc: 0.727 Test Loss: 0.791 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.759678840637207
Epoch: 10, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.780 Vali Acc: 0.678 Test Loss: 0.780 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.305375576019287
Epoch: 11, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.758 Vali Acc: 0.668 Test Loss: 0.758 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.263243675231934
Epoch: 12, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.079 Vali Acc: 0.732 Test Loss: 1.079 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 13601026
model size : 52.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.240342855453491
Epoch: 1, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.578 Vali Acc: 0.717 Test Loss: 0.578 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.415838241577148
Epoch: 2, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.595 Vali Acc: 0.732 Test Loss: 0.595 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 4.491245269775391
Epoch: 3, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.553 Vali Acc: 0.732 Test Loss: 0.553 Test Acc: 0.732
Validation loss decreased (-0.731701 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 4.539504766464233
Epoch: 4, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.557 Vali Acc: 0.722 Test Loss: 0.557 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.328001260757446
Epoch: 5, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.591 Vali Acc: 0.717 Test Loss: 0.591 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.801450490951538
Epoch: 6, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.601 Vali Acc: 0.712 Test Loss: 0.601 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.121906995773315
Epoch: 7, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.613 Vali Acc: 0.737 Test Loss: 0.613 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736579).  Saving model ...
Epoch: 8 cost time: 5.148742437362671
Epoch: 8, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.644 Vali Acc: 0.727 Test Loss: 0.644 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.141437768936157
Epoch: 9, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.791 Vali Acc: 0.678 Test Loss: 0.791 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.2330310344696045
Epoch: 10, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.751 Vali Acc: 0.727 Test Loss: 0.751 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.331104755401611
Epoch: 11, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.778 Vali Acc: 0.732 Test Loss: 0.778 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.344871997833252
Epoch: 12, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.714 Vali Acc: 0.702 Test Loss: 0.714 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.555814027786255
Epoch: 13, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.796 Vali Acc: 0.722 Test Loss: 0.796 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.026394367218018
Epoch: 14, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.784 Vali Acc: 0.717 Test Loss: 0.784 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.761909246444702
Epoch: 15, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.851 Vali Acc: 0.737 Test Loss: 0.851 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.360739469528198
Epoch: 16, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.901 Vali Acc: 0.678 Test Loss: 0.901 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.229469537734985
Epoch: 17, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.901 Vali Acc: 0.727 Test Loss: 0.901 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 13572482
model size : 52.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.70985221862793
Epoch: 1, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.717 Vali Acc: 0.717 Test Loss: 0.717 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 5.373556137084961
Epoch: 2, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.580 Vali Acc: 0.722 Test Loss: 0.580 Test Acc: 0.722
Validation loss decreased (-0.717066 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 5.149786472320557
Epoch: 3, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.646 Vali Acc: 0.722 Test Loss: 0.646 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.319918632507324
Epoch: 4, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.664 Vali Acc: 0.693 Test Loss: 0.664 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.611294984817505
Epoch: 5, Steps: 13 | Train Loss: 0.062 Vali Loss: 1.094 Vali Acc: 0.722 Test Loss: 1.094 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.027062892913818
Epoch: 6, Steps: 13 | Train Loss: 0.107 Vali Loss: 1.043 Vali Acc: 0.727 Test Loss: 1.043 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726819).  Saving model ...
Epoch: 7 cost time: 5.708256006240845
Epoch: 7, Steps: 13 | Train Loss: 0.102 Vali Loss: 1.032 Vali Acc: 0.624 Test Loss: 1.032 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.351729154586792
Epoch: 8, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.335 Vali Acc: 0.722 Test Loss: 1.335 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.773648500442505
Epoch: 9, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.407 Vali Acc: 0.634 Test Loss: 1.407 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.402615547180176
Epoch: 10, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.900 Vali Acc: 0.727 Test Loss: 1.900 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.702770948410034
Epoch: 11, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.673 Vali Acc: 0.688 Test Loss: 1.673 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.308919906616211
Epoch: 12, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.820 Vali Acc: 0.717 Test Loss: 1.820 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.053397178649902
Epoch: 13, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.557 Vali Acc: 0.678 Test Loss: 1.557 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.436773777008057
Epoch: 14, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.765 Vali Acc: 0.693 Test Loss: 1.765 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.624277591705322
Epoch: 15, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.566 Vali Acc: 0.644 Test Loss: 1.566 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.275485277175903
Epoch: 16, Steps: 13 | Train Loss: 0.096 Vali Loss: 2.287 Vali Acc: 0.737 Test Loss: 2.287 Test Acc: 0.737
Validation loss decreased (-0.726819 --> -0.736562).  Saving model ...
Epoch: 17 cost time: 5.259715557098389
Epoch: 17, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.771 Vali Acc: 0.639 Test Loss: 1.771 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.238865375518799
Epoch: 18, Steps: 13 | Train Loss: 0.011 Vali Loss: 2.520 Vali Acc: 0.727 Test Loss: 2.520 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.0358967781066895
Epoch: 19, Steps: 13 | Train Loss: 0.011 Vali Loss: 2.651 Vali Acc: 0.717 Test Loss: 2.651 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.249809980392456
Epoch: 20, Steps: 13 | Train Loss: 0.006 Vali Loss: 2.043 Vali Acc: 0.698 Test Loss: 2.043 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.679931163787842
Epoch: 21, Steps: 13 | Train Loss: 0.024 Vali Loss: 2.542 Vali Acc: 0.717 Test Loss: 2.542 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.739506721496582
Epoch: 22, Steps: 13 | Train Loss: 0.134 Vali Loss: 2.361 Vali Acc: 0.649 Test Loss: 2.361 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.382456302642822
Epoch: 23, Steps: 13 | Train Loss: 0.024 Vali Loss: 2.709 Vali Acc: 0.693 Test Loss: 2.709 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.731414794921875
Epoch: 24, Steps: 13 | Train Loss: 0.007 Vali Loss: 2.848 Vali Acc: 0.644 Test Loss: 2.848 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.282272100448608
Epoch: 25, Steps: 13 | Train Loss: 0.010 Vali Loss: 2.842 Vali Acc: 0.702 Test Loss: 2.842 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.729395866394043
Epoch: 26, Steps: 13 | Train Loss: 0.097 Vali Loss: 3.592 Vali Acc: 0.634 Test Loss: 3.592 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 4733954
model size : 18.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.162988662719727
Epoch: 1, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.592 Vali Acc: 0.717 Test Loss: 0.592 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.28840446472168
Epoch: 2, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.561 Vali Acc: 0.732 Test Loss: 0.561 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 3.7104501724243164
Epoch: 3, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.649 Vali Acc: 0.717 Test Loss: 0.649 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9648847579956055
Epoch: 4, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.708 Vali Acc: 0.727 Test Loss: 0.708 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.90488862991333
Epoch: 5, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.830 Vali Acc: 0.732 Test Loss: 0.830 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.9391562938690186
Epoch: 6, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.903 Vali Acc: 0.659 Test Loss: 0.903 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.39796257019043
Epoch: 7, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.915 Vali Acc: 0.722 Test Loss: 0.915 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.422399997711182
Epoch: 8, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.962 Vali Acc: 0.727 Test Loss: 0.962 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.787855625152588
Epoch: 9, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.966 Vali Acc: 0.683 Test Loss: 0.966 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.58867621421814
Epoch: 10, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.997 Vali Acc: 0.693 Test Loss: 0.997 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.159561634063721
Epoch: 11, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.030 Vali Acc: 0.717 Test Loss: 1.030 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.694126844406128
Epoch: 12, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.303 Vali Acc: 0.712 Test Loss: 1.303 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 4484738
model size : 17.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.123884201049805
Epoch: 1, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.580 Vali Acc: 0.722 Test Loss: 0.580 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.515377759933472
Epoch: 2, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.564 Vali Acc: 0.751 Test Loss: 0.564 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 4.645479202270508
Epoch: 3, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.556 Vali Acc: 0.732 Test Loss: 0.556 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.206951379776001
Epoch: 4, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.632 Vali Acc: 0.732 Test Loss: 0.632 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.289851427078247
Epoch: 5, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.726 Vali Acc: 0.727 Test Loss: 0.726 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.77032208442688
Epoch: 6, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.715 Vali Acc: 0.717 Test Loss: 0.715 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.7317841053009033
Epoch: 7, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.799 Vali Acc: 0.698 Test Loss: 0.799 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.972899913787842
Epoch: 8, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.879 Vali Acc: 0.698 Test Loss: 0.879 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.4703028202056885
Epoch: 9, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.964 Vali Acc: 0.741 Test Loss: 0.964 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.565986156463623
Epoch: 10, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.065 Vali Acc: 0.727 Test Loss: 1.065 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.7284555435180664
Epoch: 11, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.090 Vali Acc: 0.732 Test Loss: 1.090 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.209374189376831
Epoch: 12, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.055 Vali Acc: 0.717 Test Loss: 1.055 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 4407298
model size : 17.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.938973903656006
Epoch: 1, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.571 Vali Acc: 0.722 Test Loss: 0.571 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 3.423928737640381
Epoch: 2, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.545 Vali Acc: 0.751 Test Loss: 0.545 Test Acc: 0.751
Validation loss decreased (-0.721946 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 4.405928373336792
Epoch: 3, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.554 Vali Acc: 0.751 Test Loss: 0.554 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.304713726043701
Epoch: 4, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.592 Vali Acc: 0.737 Test Loss: 0.592 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.277753591537476
Epoch: 5, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.674 Vali Acc: 0.732 Test Loss: 0.674 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.623020887374878
Epoch: 6, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.677 Vali Acc: 0.702 Test Loss: 0.677 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.631290674209595
Epoch: 7, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.3521506786346436
Epoch: 8, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.673 Vali Acc: 0.732 Test Loss: 0.673 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.693685054779053
Epoch: 9, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.674 Vali Acc: 0.712 Test Loss: 0.674 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.165431022644043
Epoch: 10, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.729 Vali Acc: 0.732 Test Loss: 0.729 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.684194564819336
Epoch: 11, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.751 Vali Acc: 0.693 Test Loss: 0.751 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.000070095062256
Epoch: 12, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.832 Vali Acc: 0.698 Test Loss: 0.832 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 4361090
model size : 16.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.402985095977783
Epoch: 1, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.576 Vali Acc: 0.717 Test Loss: 0.576 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.756462335586548
Epoch: 2, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.568 Vali Acc: 0.737 Test Loss: 0.568 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 4.742601633071899
Epoch: 3, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.568 Vali Acc: 0.732 Test Loss: 0.568 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.488993406295776
Epoch: 4, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.570 Vali Acc: 0.722 Test Loss: 0.570 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.713245630264282
Epoch: 5, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.611 Vali Acc: 0.746 Test Loss: 0.611 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746335).  Saving model ...
Epoch: 6 cost time: 4.3053460121154785
Epoch: 6, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.586 Vali Acc: 0.741 Test Loss: 0.586 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.1591455936431885
Epoch: 7, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.707 Vali Acc: 0.683 Test Loss: 0.707 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.219891548156738
Epoch: 8, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.725 Vali Acc: 0.741 Test Loss: 0.725 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.515688896179199
Epoch: 9, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.750 Vali Acc: 0.737 Test Loss: 0.750 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.2640931606292725
Epoch: 10, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.882 Vali Acc: 0.741 Test Loss: 0.882 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.2888407707214355
Epoch: 11, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.778 Vali Acc: 0.673 Test Loss: 0.778 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.8940815925598145
Epoch: 12, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.903 Vali Acc: 0.717 Test Loss: 0.903 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.853276252746582
Epoch: 13, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.965 Vali Acc: 0.649 Test Loss: 0.965 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.735414505004883
Epoch: 14, Steps: 13 | Train Loss: 0.051 Vali Loss: 1.131 Vali Acc: 0.746 Test Loss: 1.131 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.875760316848755
Epoch: 15, Steps: 13 | Train Loss: 0.065 Vali Loss: 1.005 Vali Acc: 0.649 Test Loss: 1.005 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 4315522
model size : 16.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.972458600997925
Epoch: 1, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.603 Vali Acc: 0.722 Test Loss: 0.603 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.549011707305908
Epoch: 2, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.562 Vali Acc: 0.727 Test Loss: 0.562 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 3.6219542026519775
Epoch: 3, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.548 Vali Acc: 0.746 Test Loss: 0.548 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 3.32031512260437
Epoch: 4, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.547 Vali Acc: 0.737 Test Loss: 0.547 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9976508617401123
Epoch: 5, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.525 Vali Acc: 0.751 Test Loss: 0.525 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 3.307419538497925
Epoch: 6, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.545 Vali Acc: 0.756 Test Loss: 0.545 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 2.950099468231201
Epoch: 7, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.625 Vali Acc: 0.741 Test Loss: 0.625 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.848381757736206
Epoch: 8, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.565 Vali Acc: 0.756 Test Loss: 0.565 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.531084060668945
Epoch: 9, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.592 Vali Acc: 0.756 Test Loss: 0.592 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.093667030334473
Epoch: 10, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.553 Vali Acc: 0.756 Test Loss: 0.553 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.324484825134277
Epoch: 11, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.562 Vali Acc: 0.756 Test Loss: 0.562 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.4591116905212402
Epoch: 12, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.544 Vali Acc: 0.727 Test Loss: 0.544 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.049983978271484
Epoch: 13, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.578 Vali Acc: 0.746 Test Loss: 0.578 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.08702826499939
Epoch: 14, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.607 Vali Acc: 0.737 Test Loss: 0.607 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.4635555744171143
Epoch: 15, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.635 Vali Acc: 0.751 Test Loss: 0.635 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.6340982913970947
Epoch: 16, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.628 Vali Acc: 0.732 Test Loss: 0.628 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 4285570
model size : 16.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.080671072006226
Epoch: 1, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.598 Vali Acc: 0.727 Test Loss: 0.598 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 3.3055858612060547
Epoch: 2, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.485140085220337
Epoch: 3, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.545 Vali Acc: 0.737 Test Loss: 0.545 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 3.1455423831939697
Epoch: 4, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.540 Vali Acc: 0.751 Test Loss: 0.540 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 3.4635796546936035
Epoch: 5, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.531 Vali Acc: 0.737 Test Loss: 0.531 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.675670623779297
Epoch: 6, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.544 Vali Acc: 0.741 Test Loss: 0.544 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.091429233551025
Epoch: 7, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.642 Vali Acc: 0.727 Test Loss: 0.642 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.6275455951690674
Epoch: 8, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.695 Vali Acc: 0.751 Test Loss: 0.695 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.7736730575561523
Epoch: 9, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.558 Vali Acc: 0.732 Test Loss: 0.558 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.7966387271881104
Epoch: 10, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.573 Vali Acc: 0.727 Test Loss: 0.573 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.5935492515563965
Epoch: 11, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.728 Vali Acc: 0.751 Test Loss: 0.728 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.7472171783447266
Epoch: 12, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.746 Vali Acc: 0.717 Test Loss: 0.746 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.0403454303741455
Epoch: 13, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.705 Vali Acc: 0.712 Test Loss: 0.705 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.155828237533569
Epoch: 14, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.762 Vali Acc: 0.732 Test Loss: 0.762 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 4271298
model size : 16.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.260655879974365
Epoch: 1, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.592 Vali Acc: 0.722 Test Loss: 0.592 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.3028886318206787
Epoch: 2, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.550 Vali Acc: 0.722 Test Loss: 0.550 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 3.7096762657165527
Epoch: 3, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.561 Vali Acc: 0.727 Test Loss: 0.561 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 3.6745529174804688
Epoch: 4, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.580 Vali Acc: 0.717 Test Loss: 0.580 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.8944761753082275
Epoch: 5, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.667 Vali Acc: 0.717 Test Loss: 0.667 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4874987602233887
Epoch: 6, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.741 Vali Acc: 0.712 Test Loss: 0.741 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.5117194652557373
Epoch: 7, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.781 Vali Acc: 0.727 Test Loss: 0.781 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.869532346725464
Epoch: 8, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.707 Vali Acc: 0.732 Test Loss: 0.707 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731700).  Saving model ...
Epoch: 9 cost time: 3.0495669841766357
Epoch: 9, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.828 Vali Acc: 0.717 Test Loss: 0.828 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6991126537323
Epoch: 10, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.136 Vali Acc: 0.722 Test Loss: 1.136 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.9993321895599365
Epoch: 11, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.047 Vali Acc: 0.595 Test Loss: 1.047 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.133852481842041
Epoch: 12, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.257 Vali Acc: 0.727 Test Loss: 1.257 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.4130640029907227
Epoch: 13, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.012 Vali Acc: 0.732 Test Loss: 1.012 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.7015998363494873
Epoch: 14, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.275 Vali Acc: 0.741 Test Loss: 1.275 Test Acc: 0.741
Validation loss decreased (-0.731700 --> -0.741451).  Saving model ...
Epoch: 15 cost time: 3.575204610824585
Epoch: 15, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.300 Vali Acc: 0.698 Test Loss: 1.300 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.507650852203369
Epoch: 16, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.494 Vali Acc: 0.737 Test Loss: 1.494 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.221080780029297
Epoch: 17, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.285 Vali Acc: 0.698 Test Loss: 1.285 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.1579840183258057
Epoch: 18, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.651 Vali Acc: 0.727 Test Loss: 1.651 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.0567636489868164
Epoch: 19, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.476 Vali Acc: 0.698 Test Loss: 1.476 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.5501046180725098
Epoch: 20, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.882 Vali Acc: 0.732 Test Loss: 1.882 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.2251346111297607
Epoch: 21, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.783 Vali Acc: 0.717 Test Loss: 1.783 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.214299201965332
Epoch: 22, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.887 Vali Acc: 0.727 Test Loss: 1.887 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.3263702392578125
Epoch: 23, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.582 Vali Acc: 0.722 Test Loss: 1.582 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.1606578826904297
Epoch: 24, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.444 Vali Acc: 0.727 Test Loss: 1.444 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1738242
model size : 6.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.950659275054932
Epoch: 1, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.587 Vali Acc: 0.722 Test Loss: 0.587 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.5871543884277344
Epoch: 2, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.614 Vali Acc: 0.746 Test Loss: 0.614 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746335).  Saving model ...
Epoch: 3 cost time: 2.3923330307006836
Epoch: 3, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.603 Vali Acc: 0.741 Test Loss: 0.603 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.278175115585327
Epoch: 4, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.623 Vali Acc: 0.746 Test Loss: 0.623 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.140326499938965
Epoch: 5, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.669 Vali Acc: 0.741 Test Loss: 0.669 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.1969003677368164
Epoch: 6, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.669 Vali Acc: 0.751 Test Loss: 0.669 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751213).  Saving model ...
Epoch: 7 cost time: 3.6119422912597656
Epoch: 7, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.698 Vali Acc: 0.741 Test Loss: 0.698 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3479719161987305
Epoch: 8, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.742 Vali Acc: 0.746 Test Loss: 0.742 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1768929958343506
Epoch: 9, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.802 Vali Acc: 0.741 Test Loss: 0.802 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.018714427947998
Epoch: 10, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.722 Vali Acc: 0.698 Test Loss: 0.722 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.9493846893310547
Epoch: 11, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.790 Vali Acc: 0.751 Test Loss: 0.790 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.829455614089966
Epoch: 12, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.914 Vali Acc: 0.746 Test Loss: 0.914 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7339353561401367
Epoch: 13, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.960 Vali Acc: 0.732 Test Loss: 0.960 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.7987353801727295
Epoch: 14, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.036 Vali Acc: 0.698 Test Loss: 1.036 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.851706027984619
Epoch: 15, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.125 Vali Acc: 0.756 Test Loss: 1.125 Test Acc: 0.756
Validation loss decreased (-0.751213 --> -0.756086).  Saving model ...
Epoch: 16 cost time: 2.573310375213623
Epoch: 16, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.091 Vali Acc: 0.702 Test Loss: 1.091 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.663578987121582
Epoch: 17, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.007 Vali Acc: 0.761 Test Loss: 1.007 Test Acc: 0.761
Validation loss decreased (-0.756086 --> -0.760966).  Saving model ...
Epoch: 18 cost time: 2.57791805267334
Epoch: 18, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.226 Vali Acc: 0.590 Test Loss: 1.226 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.6491341590881348
Epoch: 19, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.271 Vali Acc: 0.746 Test Loss: 1.271 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.689512252807617
Epoch: 20, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.163 Vali Acc: 0.717 Test Loss: 1.163 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.692915201187134
Epoch: 21, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.321 Vali Acc: 0.727 Test Loss: 1.321 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.5475828647613525
Epoch: 22, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.385 Vali Acc: 0.683 Test Loss: 1.385 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.6330771446228027
Epoch: 23, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.581 Vali Acc: 0.732 Test Loss: 1.581 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.569028854370117
Epoch: 24, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.251 Vali Acc: 0.702 Test Loss: 1.251 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.749408721923828
Epoch: 25, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.612 Vali Acc: 0.722 Test Loss: 1.612 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.9529595375061035
Epoch: 26, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.460 Vali Acc: 0.693 Test Loss: 1.460 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.8560879230499268
Epoch: 27, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.482 Vali Acc: 0.717 Test Loss: 1.482 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 1613634
model size : 6.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.693522214889526
Epoch: 1, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.585 Vali Acc: 0.717 Test Loss: 0.585 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.42697811126709
Epoch: 2, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.569 Vali Acc: 0.732 Test Loss: 0.569 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 2.790806531906128
Epoch: 3, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.571 Vali Acc: 0.741 Test Loss: 0.571 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 3.3338961601257324
Epoch: 4, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.583 Vali Acc: 0.741 Test Loss: 0.583 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1767404079437256
Epoch: 5, Steps: 13 | Train Loss: 0.247 Vali Loss: 0.604 Vali Acc: 0.727 Test Loss: 0.604 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0727837085723877
Epoch: 6, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.632 Vali Acc: 0.732 Test Loss: 0.632 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.211451292037964
Epoch: 7, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.643 Vali Acc: 0.722 Test Loss: 0.643 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.653747797012329
Epoch: 8, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.641 Vali Acc: 0.707 Test Loss: 0.641 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.407489776611328
Epoch: 9, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.690 Vali Acc: 0.737 Test Loss: 0.690 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.265994071960449
Epoch: 10, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.688 Vali Acc: 0.702 Test Loss: 0.688 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.113210678100586
Epoch: 11, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.692 Vali Acc: 0.746 Test Loss: 0.692 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746335).  Saving model ...
Epoch: 12 cost time: 2.3326263427734375
Epoch: 12, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.689 Vali Acc: 0.727 Test Loss: 0.689 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4421958923339844
Epoch: 13, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.753 Vali Acc: 0.737 Test Loss: 0.753 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.965672492980957
Epoch: 14, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.827 Vali Acc: 0.722 Test Loss: 0.827 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.1581058502197266
Epoch: 15, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.829 Vali Acc: 0.717 Test Loss: 0.829 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.2774832248687744
Epoch: 16, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.803 Vali Acc: 0.707 Test Loss: 0.803 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.2466049194335938
Epoch: 17, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.842 Vali Acc: 0.702 Test Loss: 0.842 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.0964465141296387
Epoch: 18, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.039 Vali Acc: 0.732 Test Loss: 1.039 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.932847499847412
Epoch: 19, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.913 Vali Acc: 0.673 Test Loss: 0.913 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.830361843109131
Epoch: 20, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.148 Vali Acc: 0.722 Test Loss: 1.148 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.39676570892334
Epoch: 21, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.005 Vali Acc: 0.732 Test Loss: 1.005 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1574914
model size : 6.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.149183750152588
Epoch: 1, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.592 Vali Acc: 0.712 Test Loss: 0.592 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.8485376834869385
Epoch: 2, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.586 Vali Acc: 0.722 Test Loss: 0.586 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 2.897716999053955
Epoch: 3, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.548 Vali Acc: 0.737 Test Loss: 0.548 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 2.710073709487915
Epoch: 4, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.547 Vali Acc: 0.727 Test Loss: 0.547 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8510355949401855
Epoch: 5, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.558 Vali Acc: 0.732 Test Loss: 0.558 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9246621131896973
Epoch: 6, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.597 Vali Acc: 0.722 Test Loss: 0.597 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.0184285640716553
Epoch: 7, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.607 Vali Acc: 0.722 Test Loss: 0.607 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.791804313659668
Epoch: 8, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.603 Vali Acc: 0.702 Test Loss: 0.603 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.364250898361206
Epoch: 9, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.611 Vali Acc: 0.712 Test Loss: 0.611 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.8768742084503174
Epoch: 10, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.621 Vali Acc: 0.717 Test Loss: 0.621 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.335033893585205
Epoch: 11, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.645 Vali Acc: 0.727 Test Loss: 0.645 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.9563441276550293
Epoch: 12, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.644 Vali Acc: 0.707 Test Loss: 0.644 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.920178174972534
Epoch: 13, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.717 Vali Acc: 0.737 Test Loss: 0.717 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 1551810
model size : 6.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.2046191692352295
Epoch: 1, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.592 Vali Acc: 0.722 Test Loss: 0.592 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.2579450607299805
Epoch: 2, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.568 Vali Acc: 0.722 Test Loss: 0.568 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 2.1585514545440674
Epoch: 3, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.571 Vali Acc: 0.722 Test Loss: 0.571 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.278416395187378
Epoch: 4, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.560 Vali Acc: 0.732 Test Loss: 0.560 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 2.177276134490967
Epoch: 5, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.577 Vali Acc: 0.741 Test Loss: 0.577 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 2.6196699142456055
Epoch: 6, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.594 Vali Acc: 0.746 Test Loss: 0.594 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 2.4243035316467285
Epoch: 7, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.600 Vali Acc: 0.741 Test Loss: 0.600 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4317800998687744
Epoch: 8, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.580 Vali Acc: 0.732 Test Loss: 0.580 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.26928448677063
Epoch: 9, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.628 Vali Acc: 0.732 Test Loss: 0.628 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.308183431625366
Epoch: 10, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.633 Vali Acc: 0.727 Test Loss: 0.633 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.3113853931427
Epoch: 11, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.633 Vali Acc: 0.737 Test Loss: 0.633 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.542753219604492
Epoch: 12, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.599 Vali Acc: 0.712 Test Loss: 0.599 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.2092931270599365
Epoch: 13, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.674 Vali Acc: 0.727 Test Loss: 0.674 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.839900016784668
Epoch: 14, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.683 Vali Acc: 0.722 Test Loss: 0.683 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.8808836936950684
Epoch: 15, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.670 Vali Acc: 0.722 Test Loss: 0.670 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.8040966987609863
Epoch: 16, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.638 Vali Acc: 0.712 Test Loss: 0.638 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1529026
model size : 5.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.873343467712402
Epoch: 1, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.623 Vali Acc: 0.722 Test Loss: 0.623 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.6127610206604004
Epoch: 2, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.569 Vali Acc: 0.722 Test Loss: 0.569 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 2.579667329788208
Epoch: 3, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.593 Vali Acc: 0.717 Test Loss: 0.593 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.672621488571167
Epoch: 4, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.553 Vali Acc: 0.751 Test Loss: 0.553 Test Acc: 0.751
Validation loss decreased (-0.721946 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 2.666581630706787
Epoch: 5, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.539 Vali Acc: 0.741 Test Loss: 0.539 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.682910203933716
Epoch: 6, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.535 Vali Acc: 0.732 Test Loss: 0.535 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6461730003356934
Epoch: 7, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.536 Vali Acc: 0.746 Test Loss: 0.536 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.6428158283233643
Epoch: 8, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.530 Vali Acc: 0.732 Test Loss: 0.530 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.3267557621002197
Epoch: 9, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.543 Vali Acc: 0.727 Test Loss: 0.543 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.2462828159332275
Epoch: 10, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.572 Vali Acc: 0.712 Test Loss: 0.572 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.2322964668273926
Epoch: 11, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.568 Vali Acc: 0.712 Test Loss: 0.568 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9337611198425293
Epoch: 12, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.573 Vali Acc: 0.717 Test Loss: 0.573 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9326884746551514
Epoch: 13, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.559 Vali Acc: 0.712 Test Loss: 0.559 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.2020533084869385
Epoch: 14, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.561 Vali Acc: 0.712 Test Loss: 0.561 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1514050
model size : 5.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.288421392440796
Epoch: 1, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.634 Vali Acc: 0.712 Test Loss: 0.634 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.319354295730591
Epoch: 2, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.635 Vali Acc: 0.717 Test Loss: 0.635 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 2.2038166522979736
Epoch: 3, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.648 Vali Acc: 0.717 Test Loss: 0.648 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2367055416107178
Epoch: 4, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.643 Vali Acc: 0.732 Test Loss: 0.643 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731701).  Saving model ...
Epoch: 5 cost time: 2.5356605052948
Epoch: 5, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.653 Vali Acc: 0.737 Test Loss: 0.653 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736579).  Saving model ...
Epoch: 6 cost time: 2.8072550296783447
Epoch: 6, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.598 Vali Acc: 0.751 Test Loss: 0.598 Test Acc: 0.751
Validation loss decreased (-0.736579 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 2.3967864513397217
Epoch: 7, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.572 Vali Acc: 0.737 Test Loss: 0.572 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.314730405807495
Epoch: 8, Steps: 13 | Train Loss: 0.255 Vali Loss: 0.576 Vali Acc: 0.732 Test Loss: 0.576 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.585034132003784
Epoch: 9, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.625 Vali Acc: 0.741 Test Loss: 0.625 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7797367572784424
Epoch: 10, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.653 Vali Acc: 0.737 Test Loss: 0.653 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.255099058151245
Epoch: 11, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.636 Vali Acc: 0.732 Test Loss: 0.636 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2533750534057617
Epoch: 12, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.641 Vali Acc: 0.732 Test Loss: 0.641 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.443089008331299
Epoch: 13, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.669 Vali Acc: 0.737 Test Loss: 0.669 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.08416748046875
Epoch: 14, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.636 Vali Acc: 0.741 Test Loss: 0.636 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0318548679351807
Epoch: 15, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.780 Vali Acc: 0.727 Test Loss: 0.780 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.090561628341675
Epoch: 16, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.766 Vali Acc: 0.741 Test Loss: 0.766 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1506914
model size : 5.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 12.30279278755188
Epoch: 1, Steps: 13 | Train Loss: 0.920 Vali Loss: 1.511 Vali Acc: 0.741 Test Loss: 1.511 Test Acc: 0.741
Validation loss decreased (inf --> -0.741448).  Saving model ...
Epoch: 2 cost time: 8.984327793121338
Epoch: 2, Steps: 13 | Train Loss: 1.416 Vali Loss: 1.206 Vali Acc: 0.698 Test Loss: 1.206 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.097117900848389
Epoch: 3, Steps: 13 | Train Loss: 0.690 Vali Loss: 1.357 Vali Acc: 0.702 Test Loss: 1.357 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.97446060180664
Epoch: 4, Steps: 13 | Train Loss: 0.550 Vali Loss: 1.988 Vali Acc: 0.683 Test Loss: 1.988 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.104675054550171
Epoch: 5, Steps: 13 | Train Loss: 0.186 Vali Loss: 2.003 Vali Acc: 0.702 Test Loss: 2.003 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.578450679779053
Epoch: 6, Steps: 13 | Train Loss: 0.040 Vali Loss: 2.245 Vali Acc: 0.688 Test Loss: 2.245 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 11.009049654006958
Epoch: 7, Steps: 13 | Train Loss: 0.107 Vali Loss: 3.114 Vali Acc: 0.629 Test Loss: 3.114 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.52023959159851
Epoch: 8, Steps: 13 | Train Loss: 0.303 Vali Loss: 3.453 Vali Acc: 0.717 Test Loss: 3.453 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.168832540512085
Epoch: 9, Steps: 13 | Train Loss: 0.087 Vali Loss: 4.085 Vali Acc: 0.629 Test Loss: 4.085 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 9.732612133026123
Epoch: 10, Steps: 13 | Train Loss: 0.254 Vali Loss: 5.809 Vali Acc: 0.717 Test Loss: 5.809 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 10.608094692230225
Epoch: 11, Steps: 13 | Train Loss: 0.186 Vali Loss: 6.682 Vali Acc: 0.702 Test Loss: 6.682 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 12403202
model size : 47.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.991087436676025
Epoch: 1, Steps: 13 | Train Loss: 0.820 Vali Loss: 0.702 Vali Acc: 0.756 Test Loss: 0.702 Test Acc: 0.756
Validation loss decreased (inf --> -0.756091).  Saving model ...
Epoch: 2 cost time: 7.0334792137146
Epoch: 2, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.981 Vali Acc: 0.566 Test Loss: 0.981 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.609216928482056
Epoch: 3, Steps: 13 | Train Loss: 0.546 Vali Loss: 1.257 Vali Acc: 0.580 Test Loss: 1.257 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.128079891204834
Epoch: 4, Steps: 13 | Train Loss: 0.422 Vali Loss: 2.548 Vali Acc: 0.741 Test Loss: 2.548 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.69681715965271
Epoch: 5, Steps: 13 | Train Loss: 0.181 Vali Loss: 2.432 Vali Acc: 0.722 Test Loss: 2.432 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.467732906341553
Epoch: 6, Steps: 13 | Train Loss: 0.077 Vali Loss: 2.169 Vali Acc: 0.722 Test Loss: 2.169 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.482242107391357
Epoch: 7, Steps: 13 | Train Loss: 0.060 Vali Loss: 2.210 Vali Acc: 0.698 Test Loss: 2.210 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.725836992263794
Epoch: 8, Steps: 13 | Train Loss: 0.035 Vali Loss: 2.102 Vali Acc: 0.707 Test Loss: 2.102 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.543955087661743
Epoch: 9, Steps: 13 | Train Loss: 0.076 Vali Loss: 1.789 Vali Acc: 0.663 Test Loss: 1.789 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.010932922363281
Epoch: 10, Steps: 13 | Train Loss: 0.125 Vali Loss: 2.317 Vali Acc: 0.615 Test Loss: 2.317 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.432202577590942
Epoch: 11, Steps: 13 | Train Loss: 0.233 Vali Loss: 3.444 Vali Acc: 0.712 Test Loss: 3.444 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 11437570
model size : 43.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.001086711883545
Epoch: 1, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.769 Vali Acc: 0.746 Test Loss: 0.769 Test Acc: 0.746
Validation loss decreased (inf --> -0.746334).  Saving model ...
Epoch: 2 cost time: 5.707139492034912
Epoch: 2, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.793 Vali Acc: 0.712 Test Loss: 0.793 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.756738662719727
Epoch: 3, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.913 Vali Acc: 0.693 Test Loss: 0.913 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.523823976516724
Epoch: 4, Steps: 13 | Train Loss: 0.204 Vali Loss: 1.001 Vali Acc: 0.737 Test Loss: 1.001 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.0618486404418945
Epoch: 5, Steps: 13 | Train Loss: 0.104 Vali Loss: 1.184 Vali Acc: 0.683 Test Loss: 1.184 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.245131015777588
Epoch: 6, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.559 Vali Acc: 0.605 Test Loss: 1.559 Test Acc: 0.605
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.076025724411011
Epoch: 7, Steps: 13 | Train Loss: 0.116 Vali Loss: 2.772 Vali Acc: 0.551 Test Loss: 2.772 Test Acc: 0.551
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.264629364013672
Epoch: 8, Steps: 13 | Train Loss: 0.092 Vali Loss: 1.914 Vali Acc: 0.693 Test Loss: 1.914 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.846341133117676
Epoch: 9, Steps: 13 | Train Loss: 0.163 Vali Loss: 2.723 Vali Acc: 0.712 Test Loss: 2.723 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.404823541641235
Epoch: 10, Steps: 13 | Train Loss: 0.313 Vali Loss: 3.847 Vali Acc: 0.659 Test Loss: 3.847 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.806608200073242
Epoch: 11, Steps: 13 | Train Loss: 0.081 Vali Loss: 2.895 Vali Acc: 0.717 Test Loss: 2.895 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 11096578
model size : 42.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.324663400650024
Epoch: 1, Steps: 13 | Train Loss: 0.767 Vali Loss: 0.671 Vali Acc: 0.737 Test Loss: 0.671 Test Acc: 0.737
Validation loss decreased (inf --> -0.736579).  Saving model ...
Epoch: 2 cost time: 4.287523031234741
Epoch: 2, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.690 Vali Acc: 0.644 Test Loss: 0.690 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.20509147644043
Epoch: 3, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.836 Vali Acc: 0.717 Test Loss: 0.836 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.989473104476929
Epoch: 4, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.833 Vali Acc: 0.702 Test Loss: 0.833 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.167945146560669
Epoch: 5, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.818 Vali Acc: 0.712 Test Loss: 0.818 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.12837290763855
Epoch: 6, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.988 Vali Acc: 0.683 Test Loss: 0.988 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.185499668121338
Epoch: 7, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.261 Vali Acc: 0.717 Test Loss: 1.261 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.689742803573608
Epoch: 8, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.531 Vali Acc: 0.737 Test Loss: 1.531 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.215095281600952
Epoch: 9, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.198 Vali Acc: 0.673 Test Loss: 1.198 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.376901626586914
Epoch: 10, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.218 Vali Acc: 0.741 Test Loss: 1.218 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741451).  Saving model ...
Epoch: 11 cost time: 4.842879295349121
Epoch: 11, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.883 Vali Acc: 0.561 Test Loss: 1.883 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.987278461456299
Epoch: 12, Steps: 13 | Train Loss: 0.132 Vali Loss: 1.996 Vali Acc: 0.737 Test Loss: 1.996 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.839014530181885
Epoch: 13, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.835 Vali Acc: 0.737 Test Loss: 1.835 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.1322267055511475
Epoch: 14, Steps: 13 | Train Loss: 0.020 Vali Loss: 2.231 Vali Acc: 0.644 Test Loss: 2.231 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.6391761302948
Epoch: 15, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.895 Vali Acc: 0.688 Test Loss: 1.895 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.9542412757873535
Epoch: 16, Steps: 13 | Train Loss: 0.010 Vali Loss: 3.342 Vali Acc: 0.712 Test Loss: 3.342 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.956765174865723
Epoch: 17, Steps: 13 | Train Loss: 0.062 Vali Loss: 2.053 Vali Acc: 0.649 Test Loss: 2.053 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.1562018394470215
Epoch: 18, Steps: 13 | Train Loss: 0.036 Vali Loss: 2.832 Vali Acc: 0.629 Test Loss: 2.832 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.128021955490112
Epoch: 19, Steps: 13 | Train Loss: 0.083 Vali Loss: 3.314 Vali Acc: 0.702 Test Loss: 3.314 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.86920166015625
Epoch: 20, Steps: 13 | Train Loss: 0.121 Vali Loss: 2.672 Vali Acc: 0.654 Test Loss: 2.672 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 10911746
model size : 41.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.077182054519653
Epoch: 1, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.609 Vali Acc: 0.746 Test Loss: 0.609 Test Acc: 0.746
Validation loss decreased (inf --> -0.746335).  Saving model ...
Epoch: 2 cost time: 3.4932425022125244
Epoch: 2, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.614 Vali Acc: 0.751 Test Loss: 0.614 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751213).  Saving model ...
Epoch: 3 cost time: 4.320248126983643
Epoch: 3, Steps: 13 | Train Loss: 0.247 Vali Loss: 0.777 Vali Acc: 0.605 Test Loss: 0.777 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.305410861968994
Epoch: 4, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.966 Vali Acc: 0.663 Test Loss: 0.966 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.963374376296997
Epoch: 5, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.897 Vali Acc: 0.712 Test Loss: 0.897 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.557110786437988
Epoch: 6, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.844 Vali Acc: 0.668 Test Loss: 0.844 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.158000230789185
Epoch: 7, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.002 Vali Acc: 0.688 Test Loss: 1.002 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.343966007232666
Epoch: 8, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.913 Vali Acc: 0.644 Test Loss: 0.913 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.445155382156372
Epoch: 9, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.099 Vali Acc: 0.732 Test Loss: 1.099 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.441824913024902
Epoch: 10, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.094 Vali Acc: 0.678 Test Loss: 1.094 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.25629186630249
Epoch: 11, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.455 Vali Acc: 0.722 Test Loss: 1.455 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.56830906867981
Epoch: 12, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.463 Vali Acc: 0.678 Test Loss: 1.463 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 10729474
model size : 41.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.707583904266357
Epoch: 1, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.643 Vali Acc: 0.741 Test Loss: 0.643 Test Acc: 0.741
Validation loss decreased (inf --> -0.741457).  Saving model ...
Epoch: 2 cost time: 3.9142229557037354
Epoch: 2, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.602 Vali Acc: 0.722 Test Loss: 0.602 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.822413444519043
Epoch: 3, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.909 Vali Acc: 0.654 Test Loss: 0.909 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.248814582824707
Epoch: 4, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.878 Vali Acc: 0.688 Test Loss: 0.878 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.326974630355835
Epoch: 5, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.926 Vali Acc: 0.741 Test Loss: 0.926 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.840721845626831
Epoch: 6, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.075 Vali Acc: 0.659 Test Loss: 1.075 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.9112555980682373
Epoch: 7, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.963 Vali Acc: 0.702 Test Loss: 0.963 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.067795038223267
Epoch: 8, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.904 Vali Acc: 0.717 Test Loss: 0.904 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.204303979873657
Epoch: 9, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.968 Vali Acc: 0.707 Test Loss: 0.968 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.116469383239746
Epoch: 10, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.062 Vali Acc: 0.698 Test Loss: 1.062 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.688983201980591
Epoch: 11, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.214 Vali Acc: 0.659 Test Loss: 1.214 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 10609666
model size : 40.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.405272960662842
Epoch: 1, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.557 Vali Acc: 0.741 Test Loss: 0.557 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 3.79263973236084
Epoch: 2, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.545 Vali Acc: 0.741 Test Loss: 0.545 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 3.758225679397583
Epoch: 3, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.572 Vali Acc: 0.737 Test Loss: 0.572 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.453155040740967
Epoch: 4, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.708 Vali Acc: 0.751 Test Loss: 0.708 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751212).  Saving model ...
Epoch: 5 cost time: 3.4250400066375732
Epoch: 5, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.647 Vali Acc: 0.737 Test Loss: 0.647 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3079941272735596
Epoch: 6, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.748 Vali Acc: 0.737 Test Loss: 0.748 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8913331031799316
Epoch: 7, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.803 Vali Acc: 0.756 Test Loss: 0.803 Test Acc: 0.756
Validation loss decreased (-0.751212 --> -0.756090).  Saving model ...
Epoch: 8 cost time: 3.618671417236328
Epoch: 8, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.044 Vali Acc: 0.761 Test Loss: 1.044 Test Acc: 0.761
Validation loss decreased (-0.756090 --> -0.760965).  Saving model ...
Epoch: 9 cost time: 3.265636682510376
Epoch: 9, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.752 Vali Acc: 0.673 Test Loss: 0.752 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.609923839569092
Epoch: 10, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.264 Vali Acc: 0.751 Test Loss: 1.264 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.6143856048583984
Epoch: 11, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.123 Vali Acc: 0.654 Test Loss: 1.123 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.680408477783203
Epoch: 12, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.054 Vali Acc: 0.722 Test Loss: 1.054 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.686767339706421
Epoch: 13, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.038 Vali Acc: 0.707 Test Loss: 1.038 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.3154706954956055
Epoch: 14, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.015 Vali Acc: 0.707 Test Loss: 1.015 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.20224928855896
Epoch: 15, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.255 Vali Acc: 0.717 Test Loss: 1.255 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.6646385192871094
Epoch: 16, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.992 Vali Acc: 0.693 Test Loss: 0.992 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.3626868724823
Epoch: 17, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.208 Vali Acc: 0.737 Test Loss: 1.208 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.522134304046631
Epoch: 18, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.360 Vali Acc: 0.600 Test Loss: 1.360 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 10552578
model size : 40.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.82112979888916
Epoch: 1, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.583 Vali Acc: 0.761 Test Loss: 0.583 Test Acc: 0.761
Validation loss decreased (inf --> -0.760970).  Saving model ...
Epoch: 2 cost time: 6.071399927139282
Epoch: 2, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.801 Vali Acc: 0.673 Test Loss: 0.801 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.742877244949341
Epoch: 3, Steps: 13 | Train Loss: 0.217 Vali Loss: 1.385 Vali Acc: 0.566 Test Loss: 1.385 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.618111610412598
Epoch: 4, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.288 Vali Acc: 0.600 Test Loss: 1.288 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.032871723175049
Epoch: 5, Steps: 13 | Train Loss: 0.090 Vali Loss: 2.159 Vali Acc: 0.688 Test Loss: 2.159 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.7774271965026855
Epoch: 6, Steps: 13 | Train Loss: 0.019 Vali Loss: 2.008 Vali Acc: 0.683 Test Loss: 2.008 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.669797420501709
Epoch: 7, Steps: 13 | Train Loss: 0.133 Vali Loss: 2.444 Vali Acc: 0.502 Test Loss: 2.444 Test Acc: 0.502
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.687675476074219
Epoch: 8, Steps: 13 | Train Loss: 0.372 Vali Loss: 3.515 Vali Acc: 0.727 Test Loss: 3.515 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.495183944702148
Epoch: 9, Steps: 13 | Train Loss: 0.628 Vali Loss: 2.616 Vali Acc: 0.683 Test Loss: 2.616 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.4801084995269775
Epoch: 10, Steps: 13 | Train Loss: 0.055 Vali Loss: 2.859 Vali Acc: 0.673 Test Loss: 2.859 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.392161130905151
Epoch: 11, Steps: 13 | Train Loss: 0.187 Vali Loss: 3.547 Vali Acc: 0.722 Test Loss: 3.547 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 4202754
model size : 16.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.471644639968872
Epoch: 1, Steps: 13 | Train Loss: 0.732 Vali Loss: 0.675 Vali Acc: 0.741 Test Loss: 0.675 Test Acc: 0.741
Validation loss decreased (inf --> -0.741457).  Saving model ...
Epoch: 2 cost time: 4.135628938674927
Epoch: 2, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.689 Vali Acc: 0.737 Test Loss: 0.689 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.998716115951538
Epoch: 3, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.917 Vali Acc: 0.732 Test Loss: 0.917 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.437366247177124
Epoch: 4, Steps: 13 | Train Loss: 0.283 Vali Loss: 1.037 Vali Acc: 0.639 Test Loss: 1.037 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.180525064468384
Epoch: 5, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.948 Vali Acc: 0.722 Test Loss: 0.948 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.7072064876556396
Epoch: 6, Steps: 13 | Train Loss: 0.091 Vali Loss: 1.194 Vali Acc: 0.693 Test Loss: 1.194 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.410496234893799
Epoch: 7, Steps: 13 | Train Loss: 0.061 Vali Loss: 1.278 Vali Acc: 0.737 Test Loss: 1.278 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.379183292388916
Epoch: 8, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.338 Vali Acc: 0.746 Test Loss: 1.338 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746328).  Saving model ...
Epoch: 9 cost time: 3.7531096935272217
Epoch: 9, Steps: 13 | Train Loss: 0.144 Vali Loss: 1.572 Vali Acc: 0.566 Test Loss: 1.572 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.1951375007629395
Epoch: 10, Steps: 13 | Train Loss: 0.069 Vali Loss: 1.369 Vali Acc: 0.746 Test Loss: 1.369 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.9655895233154297
Epoch: 11, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.430 Vali Acc: 0.610 Test Loss: 1.430 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.213124513626099
Epoch: 12, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.638 Vali Acc: 0.702 Test Loss: 1.638 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.670056343078613
Epoch: 13, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.555 Vali Acc: 0.698 Test Loss: 1.555 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.205343723297119
Epoch: 14, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.445 Vali Acc: 0.712 Test Loss: 1.445 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.124784708023071
Epoch: 15, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.880 Vali Acc: 0.624 Test Loss: 1.880 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.381560802459717
Epoch: 16, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.705 Vali Acc: 0.702 Test Loss: 1.705 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.130631685256958
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.683 Vali Acc: 0.712 Test Loss: 1.683 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.171425819396973
Epoch: 18, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.826 Vali Acc: 0.600 Test Loss: 1.826 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 3719938
model size : 14.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.544036865234375
Epoch: 1, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.597 Vali Acc: 0.727 Test Loss: 0.597 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 3.86173152923584
Epoch: 2, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.586 Vali Acc: 0.722 Test Loss: 0.586 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5113110542297363
Epoch: 3, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.747 Vali Acc: 0.605 Test Loss: 0.747 Test Acc: 0.605
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.9086475372314453
Epoch: 4, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.699 Vali Acc: 0.727 Test Loss: 0.699 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.967460870742798
Epoch: 5, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.772 Vali Acc: 0.722 Test Loss: 0.772 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.7526028156280518
Epoch: 6, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.819 Vali Acc: 0.707 Test Loss: 0.819 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.8644373416900635
Epoch: 7, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.922 Vali Acc: 0.722 Test Loss: 0.922 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.442457675933838
Epoch: 8, Steps: 13 | Train Loss: 0.060 Vali Loss: 1.040 Vali Acc: 0.615 Test Loss: 1.040 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.364387035369873
Epoch: 9, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.348 Vali Acc: 0.683 Test Loss: 1.348 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.8850796222686768
Epoch: 10, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.327 Vali Acc: 0.678 Test Loss: 1.327 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.941141128540039
Epoch: 11, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.313 Vali Acc: 0.668 Test Loss: 1.313 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 3549442
model size : 13.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.647524356842041
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.568 Vali Acc: 0.732 Test Loss: 0.568 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 3.301269292831421
Epoch: 2, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.614 Vali Acc: 0.698 Test Loss: 0.614 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.377586603164673
Epoch: 3, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.831 Vali Acc: 0.683 Test Loss: 0.831 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.593602418899536
Epoch: 4, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.639 Vali Acc: 0.732 Test Loss: 0.639 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.3944413661956787
Epoch: 5, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.703 Vali Acc: 0.663 Test Loss: 0.703 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.1509017944335938
Epoch: 6, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.760 Vali Acc: 0.668 Test Loss: 0.760 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.271775722503662
Epoch: 7, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.779 Vali Acc: 0.688 Test Loss: 0.779 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.541630506515503
Epoch: 8, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.374 Vali Acc: 0.746 Test Loss: 1.374 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746328).  Saving model ...
Epoch: 9 cost time: 3.7648229598999023
Epoch: 9, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.064 Vali Acc: 0.663 Test Loss: 1.064 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3222432136535645
Epoch: 10, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.929 Vali Acc: 0.707 Test Loss: 0.929 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.076113700866699
Epoch: 11, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.950 Vali Acc: 0.702 Test Loss: 0.950 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.1786177158355713
Epoch: 12, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.265 Vali Acc: 0.649 Test Loss: 1.265 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.146364212036133
Epoch: 13, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.303 Vali Acc: 0.712 Test Loss: 1.303 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.4282889366149902
Epoch: 14, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.369 Vali Acc: 0.698 Test Loss: 1.369 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.14996337890625
Epoch: 15, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.768 Vali Acc: 0.615 Test Loss: 1.768 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.3013713359832764
Epoch: 16, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.319 Vali Acc: 0.659 Test Loss: 1.319 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.5553321838378906
Epoch: 17, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.169 Vali Acc: 0.659 Test Loss: 1.169 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.3749771118164062
Epoch: 18, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.086 Vali Acc: 0.688 Test Loss: 1.086 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 3457026
model size : 13.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.833587884902954
Epoch: 1, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.576 Vali Acc: 0.727 Test Loss: 0.576 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 3.159038782119751
Epoch: 2, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.585 Vali Acc: 0.741 Test Loss: 0.585 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 3.2104556560516357
Epoch: 3, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.701 Vali Acc: 0.746 Test Loss: 0.701 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746334).  Saving model ...
Epoch: 4 cost time: 3.2481253147125244
Epoch: 4, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.631 Vali Acc: 0.737 Test Loss: 0.631 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5085837841033936
Epoch: 5, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.672 Vali Acc: 0.668 Test Loss: 0.672 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1757993698120117
Epoch: 6, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.733 Vali Acc: 0.732 Test Loss: 0.733 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6865971088409424
Epoch: 7, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.793 Vali Acc: 0.746 Test Loss: 0.793 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.1892406940460205
Epoch: 8, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.692 Vali Acc: 0.732 Test Loss: 0.692 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.9846713542938232
Epoch: 9, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.953 Vali Acc: 0.727 Test Loss: 0.953 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.6120612621307373
Epoch: 10, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.965 Vali Acc: 0.737 Test Loss: 0.965 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.882450819015503
Epoch: 11, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.881 Vali Acc: 0.639 Test Loss: 0.881 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.446528911590576
Epoch: 12, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.127 Vali Acc: 0.746 Test Loss: 1.127 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.396925210952759
Epoch: 13, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.852 Vali Acc: 0.693 Test Loss: 0.852 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 3365890
model size : 12.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.827235221862793
Epoch: 1, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.576 Vali Acc: 0.741 Test Loss: 0.576 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 2.8549160957336426
Epoch: 2, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.589 Vali Acc: 0.746 Test Loss: 0.589 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 2.963606119155884
Epoch: 3, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.623 Vali Acc: 0.737 Test Loss: 0.623 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.804093599319458
Epoch: 4, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.666 Vali Acc: 0.722 Test Loss: 0.666 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1685423851013184
Epoch: 5, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.651 Vali Acc: 0.727 Test Loss: 0.651 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0550918579101562
Epoch: 6, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.689 Vali Acc: 0.698 Test Loss: 0.689 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.076115608215332
Epoch: 7, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.831 Vali Acc: 0.722 Test Loss: 0.831 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.97991943359375
Epoch: 8, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.807 Vali Acc: 0.707 Test Loss: 0.807 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.9901111125946045
Epoch: 9, Steps: 13 | Train Loss: 0.079 Vali Loss: 1.015 Vali Acc: 0.737 Test Loss: 1.015 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.710469961166382
Epoch: 10, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.848 Vali Acc: 0.722 Test Loss: 0.848 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.6720495223999023
Epoch: 11, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.865 Vali Acc: 0.644 Test Loss: 0.865 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.076530694961548
Epoch: 12, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.947 Vali Acc: 0.737 Test Loss: 0.947 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 3305986
model size : 12.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.424959421157837
Epoch: 1, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.611 Vali Acc: 0.746 Test Loss: 0.611 Test Acc: 0.746
Validation loss decreased (inf --> -0.746335).  Saving model ...
Epoch: 2 cost time: 3.1051242351531982
Epoch: 2, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.613 Vali Acc: 0.746 Test Loss: 0.613 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1427879333496094
Epoch: 3, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.539 Vali Acc: 0.756 Test Loss: 0.539 Test Acc: 0.756
Validation loss decreased (-0.746335 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 2.945693254470825
Epoch: 4, Steps: 13 | Train Loss: 0.247 Vali Loss: 0.567 Vali Acc: 0.722 Test Loss: 0.567 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6940698623657227
Epoch: 5, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.744 Vali Acc: 0.741 Test Loss: 0.744 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0117619037628174
Epoch: 6, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.657 Vali Acc: 0.737 Test Loss: 0.657 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.1331541538238525
Epoch: 7, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.665 Vali Acc: 0.717 Test Loss: 0.665 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.457308292388916
Epoch: 8, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.946 Vali Acc: 0.741 Test Loss: 0.946 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.2416832447052
Epoch: 9, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.671 Vali Acc: 0.732 Test Loss: 0.671 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.8752877712249756
Epoch: 10, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.649 Vali Acc: 0.712 Test Loss: 0.649 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.572058916091919
Epoch: 11, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.813 Vali Acc: 0.717 Test Loss: 0.813 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.1944005489349365
Epoch: 12, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.766 Vali Acc: 0.707 Test Loss: 0.766 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.9566855430603027
Epoch: 13, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.835 Vali Acc: 0.732 Test Loss: 0.835 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 3277442
model size : 12.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.7285685539245605
Epoch: 1, Steps: 13 | Train Loss: 0.804 Vali Loss: 0.618 Vali Acc: 0.727 Test Loss: 0.618 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 2.696613073348999
Epoch: 2, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.615 Vali Acc: 0.732 Test Loss: 0.615 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 2.877723217010498
Epoch: 3, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.724 Vali Acc: 0.732 Test Loss: 0.724 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9553592205047607
Epoch: 4, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.953 Vali Acc: 0.746 Test Loss: 0.953 Test Acc: 0.746
Validation loss decreased (-0.731701 --> -0.746332).  Saving model ...
Epoch: 5 cost time: 3.021618604660034
Epoch: 5, Steps: 13 | Train Loss: 0.053 Vali Loss: 1.023 Vali Acc: 0.732 Test Loss: 1.023 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.787733554840088
Epoch: 6, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.227 Vali Acc: 0.605 Test Loss: 1.227 Test Acc: 0.605
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6719555854797363
Epoch: 7, Steps: 13 | Train Loss: 0.104 Vali Loss: 1.181 Vali Acc: 0.654 Test Loss: 1.181 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8703112602233887
Epoch: 8, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.391 Vali Acc: 0.580 Test Loss: 1.391 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.730076789855957
Epoch: 9, Steps: 13 | Train Loss: 0.282 Vali Loss: 1.784 Vali Acc: 0.727 Test Loss: 1.784 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.65164852142334
Epoch: 10, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.598 Vali Acc: 0.629 Test Loss: 1.598 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.403545618057251
Epoch: 11, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.689 Vali Acc: 0.717 Test Loss: 1.689 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.377711534500122
Epoch: 12, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.475 Vali Acc: 0.717 Test Loss: 1.475 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.3150103092193604
Epoch: 13, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.579 Vali Acc: 0.717 Test Loss: 1.579 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.4798755645751953
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.692 Vali Acc: 0.732 Test Loss: 1.692 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1601666
model size : 6.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8934743404388428
Epoch: 1, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.585 Vali Acc: 0.727 Test Loss: 0.585 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 2.1911752223968506
Epoch: 2, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.588 Vali Acc: 0.702 Test Loss: 0.588 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.183718681335449
Epoch: 3, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.762 Vali Acc: 0.741 Test Loss: 0.762 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741456).  Saving model ...
Epoch: 4 cost time: 1.874837875366211
Epoch: 4, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.856 Vali Acc: 0.727 Test Loss: 0.856 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3227319717407227
Epoch: 5, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.838 Vali Acc: 0.707 Test Loss: 0.838 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1652958393096924
Epoch: 6, Steps: 13 | Train Loss: 0.062 Vali Loss: 1.061 Vali Acc: 0.722 Test Loss: 1.061 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.158332586288452
Epoch: 7, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.972 Vali Acc: 0.722 Test Loss: 0.972 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1350350379943848
Epoch: 8, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.075 Vali Acc: 0.717 Test Loss: 1.075 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0558528900146484
Epoch: 9, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.558 Vali Acc: 0.727 Test Loss: 1.558 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.294050693511963
Epoch: 10, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.409 Vali Acc: 0.644 Test Loss: 1.409 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.2043964862823486
Epoch: 11, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.594 Vali Acc: 0.722 Test Loss: 1.594 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.3316094875335693
Epoch: 12, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.333 Vali Acc: 0.707 Test Loss: 1.333 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.9553554058074951
Epoch: 13, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.338 Vali Acc: 0.668 Test Loss: 1.338 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1360258
model size : 5.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.0587663650512695
Epoch: 1, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.565 Vali Acc: 0.727 Test Loss: 0.565 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 2.563910961151123
Epoch: 2, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.559 Vali Acc: 0.727 Test Loss: 0.559 Test Acc: 0.727
Validation loss decreased (-0.726824 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 2.5829668045043945
Epoch: 3, Steps: 13 | Train Loss: 0.346 Vali Loss: 0.635 Vali Acc: 0.668 Test Loss: 0.635 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1475744247436523
Epoch: 4, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.654 Vali Acc: 0.737 Test Loss: 0.654 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 2.2187957763671875
Epoch: 5, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.903 Vali Acc: 0.615 Test Loss: 0.903 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3384532928466797
Epoch: 6, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.875 Vali Acc: 0.717 Test Loss: 0.875 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.202885389328003
Epoch: 7, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.832 Vali Acc: 0.717 Test Loss: 0.832 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.354556083679199
Epoch: 8, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.891 Vali Acc: 0.722 Test Loss: 0.891 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.6355509757995605
Epoch: 9, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.808 Vali Acc: 0.707 Test Loss: 0.808 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.7710230350494385
Epoch: 10, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.844 Vali Acc: 0.678 Test Loss: 0.844 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.7724835872650146
Epoch: 11, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.799 Vali Acc: 0.722 Test Loss: 0.799 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.797175168991089
Epoch: 12, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.860 Vali Acc: 0.712 Test Loss: 0.860 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.4193944931030273
Epoch: 13, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.933 Vali Acc: 0.717 Test Loss: 0.933 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.4419729709625244
Epoch: 14, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.089 Vali Acc: 0.741 Test Loss: 1.089 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741453).  Saving model ...
Epoch: 15 cost time: 2.0481483936309814
Epoch: 15, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.243 Vali Acc: 0.727 Test Loss: 1.243 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.178184747695923
Epoch: 16, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.152 Vali Acc: 0.712 Test Loss: 1.152 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2461559772491455
Epoch: 17, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.111 Vali Acc: 0.698 Test Loss: 1.111 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.079423666000366
Epoch: 18, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.474 Vali Acc: 0.712 Test Loss: 1.474 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.4053568840026855
Epoch: 19, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.524 Vali Acc: 0.698 Test Loss: 1.524 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.4036941528320312
Epoch: 20, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.445 Vali Acc: 0.698 Test Loss: 1.445 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.6351912021636963
Epoch: 21, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.486 Vali Acc: 0.707 Test Loss: 1.486 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.8372392654418945
Epoch: 22, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.564 Vali Acc: 0.712 Test Loss: 1.564 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.3923842906951904
Epoch: 23, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.530 Vali Acc: 0.693 Test Loss: 1.530 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.2595367431640625
Epoch: 24, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.416 Vali Acc: 0.698 Test Loss: 1.416 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1275010
model size : 4.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.226674795150757
Epoch: 1, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.579 Vali Acc: 0.746 Test Loss: 0.579 Test Acc: 0.746
Validation loss decreased (inf --> -0.746336).  Saving model ...
Epoch: 2 cost time: 2.4165287017822266
Epoch: 2, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.543 Vali Acc: 0.732 Test Loss: 0.543 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3677895069122314
Epoch: 3, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.588 Vali Acc: 0.717 Test Loss: 0.588 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.462599992752075
Epoch: 4, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.663 Vali Acc: 0.702 Test Loss: 0.663 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.458482265472412
Epoch: 5, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.658 Vali Acc: 0.698 Test Loss: 0.658 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5048294067382812
Epoch: 6, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.722 Vali Acc: 0.717 Test Loss: 0.722 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.1939234733581543
Epoch: 7, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.659 Vali Acc: 0.698 Test Loss: 0.659 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.203625440597534
Epoch: 8, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.672 Vali Acc: 0.683 Test Loss: 0.672 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.233829975128174
Epoch: 9, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.823 Vali Acc: 0.732 Test Loss: 0.823 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.3818225860595703
Epoch: 10, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.726 Vali Acc: 0.707 Test Loss: 0.726 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.1920976638793945
Epoch: 11, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.704 Vali Acc: 0.707 Test Loss: 0.704 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1228802
model size : 4.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9255805015563965
Epoch: 1, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.583 Vali Acc: 0.732 Test Loss: 0.583 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 1.993119478225708
Epoch: 2, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.622 Vali Acc: 0.737 Test Loss: 0.622 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 2.20054030418396
Epoch: 3, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.597 Vali Acc: 0.727 Test Loss: 0.597 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5514264106750488
Epoch: 4, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.670 Vali Acc: 0.678 Test Loss: 0.670 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0174834728240967
Epoch: 5, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.706 Vali Acc: 0.741 Test Loss: 0.706 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741456).  Saving model ...
Epoch: 6 cost time: 2.164494514465332
Epoch: 6, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.714 Vali Acc: 0.712 Test Loss: 0.714 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.129382848739624
Epoch: 7, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.705 Vali Acc: 0.702 Test Loss: 0.705 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0544381141662598
Epoch: 8, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.652 Vali Acc: 0.717 Test Loss: 0.652 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.154991626739502
Epoch: 9, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.722 Vali Acc: 0.756 Test Loss: 0.722 Test Acc: 0.756
Validation loss decreased (-0.741456 --> -0.756090).  Saving model ...
Epoch: 10 cost time: 2.428302764892578
Epoch: 10, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.756 Vali Acc: 0.746 Test Loss: 0.756 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.068028450012207
Epoch: 11, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.798 Vali Acc: 0.766 Test Loss: 0.798 Test Acc: 0.766
Validation loss decreased (-0.756090 --> -0.765846).  Saving model ...
Epoch: 12 cost time: 2.172830820083618
Epoch: 12, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.817 Vali Acc: 0.722 Test Loss: 0.817 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.207693338394165
Epoch: 13, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.814 Vali Acc: 0.741 Test Loss: 0.814 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9716424942016602
Epoch: 14, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.902 Vali Acc: 0.756 Test Loss: 0.902 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8075051307678223
Epoch: 15, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.868 Vali Acc: 0.698 Test Loss: 0.868 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7278335094451904
Epoch: 16, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.018 Vali Acc: 0.761 Test Loss: 1.018 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.1170055866241455
Epoch: 17, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.993 Vali Acc: 0.712 Test Loss: 0.993 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8952808380126953
Epoch: 18, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.953 Vali Acc: 0.712 Test Loss: 0.953 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.161337375640869
Epoch: 19, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.886 Vali Acc: 0.707 Test Loss: 0.886 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.3900153636932373
Epoch: 20, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.989 Vali Acc: 0.722 Test Loss: 0.989 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.4454238414764404
Epoch: 21, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.204 Vali Acc: 0.737 Test Loss: 1.204 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 1183234
model size : 4.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.704246997833252
Epoch: 1, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.612 Vali Acc: 0.712 Test Loss: 0.612 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.025385618209839
Epoch: 2, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.590 Vali Acc: 0.761 Test Loss: 0.590 Test Acc: 0.761
Validation loss decreased (-0.712189 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 2.142223358154297
Epoch: 3, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.584 Vali Acc: 0.741 Test Loss: 0.584 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0390625
Epoch: 4, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.576 Vali Acc: 0.702 Test Loss: 0.576 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.989598035812378
Epoch: 5, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.593 Vali Acc: 0.732 Test Loss: 0.593 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2923946380615234
Epoch: 6, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.698 Vali Acc: 0.746 Test Loss: 0.698 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.278524875640869
Epoch: 7, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.649 Vali Acc: 0.707 Test Loss: 0.649 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.119515895843506
Epoch: 8, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.691 Vali Acc: 0.737 Test Loss: 0.691 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.1482291221618652
Epoch: 9, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.655 Vali Acc: 0.712 Test Loss: 0.655 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.1943678855895996
Epoch: 10, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.674 Vali Acc: 0.727 Test Loss: 0.674 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.3393635749816895
Epoch: 11, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.708 Vali Acc: 0.756 Test Loss: 0.708 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.0819406509399414
Epoch: 12, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.680 Vali Acc: 0.722 Test Loss: 0.680 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 1153282
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.1283118724823
Epoch: 1, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.624 Vali Acc: 0.746 Test Loss: 0.624 Test Acc: 0.746
Validation loss decreased (inf --> -0.746335).  Saving model ...
Epoch: 2 cost time: 2.128512382507324
Epoch: 2, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.624 Vali Acc: 0.737 Test Loss: 0.624 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.99861478805542
Epoch: 3, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.555 Vali Acc: 0.746 Test Loss: 0.555 Test Acc: 0.746
Validation loss decreased (-0.746335 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 2.2516908645629883
Epoch: 4, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.543 Vali Acc: 0.746 Test Loss: 0.543 Test Acc: 0.746
Validation loss decreased (-0.746336 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 2.437729597091675
Epoch: 5, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.575 Vali Acc: 0.756 Test Loss: 0.575 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 1.9704899787902832
Epoch: 6, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.611 Vali Acc: 0.741 Test Loss: 0.611 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2454068660736084
Epoch: 7, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.567 Vali Acc: 0.751 Test Loss: 0.567 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8911528587341309
Epoch: 8, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.575 Vali Acc: 0.751 Test Loss: 0.575 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9391546249389648
Epoch: 9, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.574 Vali Acc: 0.751 Test Loss: 0.574 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9414112567901611
Epoch: 10, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.601 Vali Acc: 0.737 Test Loss: 0.601 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9615404605865479
Epoch: 11, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.614 Vali Acc: 0.756 Test Loss: 0.614 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.21272873878479
Epoch: 12, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.666 Vali Acc: 0.737 Test Loss: 0.666 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.2999157905578613
Epoch: 13, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.627 Vali Acc: 0.712 Test Loss: 0.627 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2363438606262207
Epoch: 14, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.640 Vali Acc: 0.727 Test Loss: 0.640 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.0687828063964844
Epoch: 15, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.646 Vali Acc: 0.732 Test Loss: 0.646 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1139010
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4954428672790527
Epoch: 1, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.566 Vali Acc: 0.722 Test Loss: 0.566 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.8125298023223877
Epoch: 2, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.631 Vali Acc: 0.654 Test Loss: 0.631 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7736835479736328
Epoch: 3, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.602 Vali Acc: 0.737 Test Loss: 0.602 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 2.0357666015625
Epoch: 4, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.723 Vali Acc: 0.698 Test Loss: 0.723 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1090452671051025
Epoch: 5, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.802 Vali Acc: 0.624 Test Loss: 0.802 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9038970470428467
Epoch: 6, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.849 Vali Acc: 0.732 Test Loss: 0.849 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.192579746246338
Epoch: 7, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.852 Vali Acc: 0.698 Test Loss: 0.852 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0184006690979004
Epoch: 8, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.964 Vali Acc: 0.727 Test Loss: 0.964 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.141909122467041
Epoch: 9, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.866 Vali Acc: 0.649 Test Loss: 0.866 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8730297088623047
Epoch: 10, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.911 Vali Acc: 0.698 Test Loss: 0.911 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7933216094970703
Epoch: 11, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.196 Vali Acc: 0.717 Test Loss: 1.196 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8010592460632324
Epoch: 12, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.975 Vali Acc: 0.663 Test Loss: 0.975 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6794133186340332
Epoch: 13, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.903 Vali Acc: 0.717 Test Loss: 1.903 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 675906
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4535071849823
Epoch: 1, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.590 Vali Acc: 0.717 Test Loss: 0.590 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.7837707996368408
Epoch: 2, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.564 Vali Acc: 0.751 Test Loss: 0.564 Test Acc: 0.751
Validation loss decreased (-0.717067 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.830472469329834
Epoch: 3, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.601 Vali Acc: 0.722 Test Loss: 0.601 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6514232158660889
Epoch: 4, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.695 Vali Acc: 0.727 Test Loss: 0.695 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5078647136688232
Epoch: 5, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.763 Vali Acc: 0.756 Test Loss: 0.763 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756090).  Saving model ...
Epoch: 6 cost time: 1.6508204936981201
Epoch: 6, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.763 Vali Acc: 0.693 Test Loss: 0.763 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9375495910644531
Epoch: 7, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.876 Vali Acc: 0.732 Test Loss: 0.876 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5725774765014648
Epoch: 8, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.925 Vali Acc: 0.702 Test Loss: 0.925 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7905731201171875
Epoch: 9, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.044 Vali Acc: 0.727 Test Loss: 1.044 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5099766254425049
Epoch: 10, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.024 Vali Acc: 0.751 Test Loss: 1.024 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7699530124664307
Epoch: 11, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.017 Vali Acc: 0.717 Test Loss: 1.017 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5934600830078125
Epoch: 12, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.128 Vali Acc: 0.727 Test Loss: 1.128 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4417030811309814
Epoch: 13, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.156 Vali Acc: 0.722 Test Loss: 1.156 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4970026016235352
Epoch: 14, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.022 Vali Acc: 0.683 Test Loss: 1.022 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4639332294464111
Epoch: 15, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.134 Vali Acc: 0.717 Test Loss: 1.134 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 555202
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.648148536682129
Epoch: 1, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.597 Vali Acc: 0.712 Test Loss: 0.597 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.624608039855957
Epoch: 2, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.574 Vali Acc: 0.722 Test Loss: 0.574 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.6224911212921143
Epoch: 3, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.608 Vali Acc: 0.722 Test Loss: 0.608 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5658907890319824
Epoch: 4, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.634 Vali Acc: 0.737 Test Loss: 0.634 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 1.417001485824585
Epoch: 5, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.793 Vali Acc: 0.707 Test Loss: 0.793 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7576279640197754
Epoch: 6, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.896 Vali Acc: 0.717 Test Loss: 0.896 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.721468210220337
Epoch: 7, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.856 Vali Acc: 0.712 Test Loss: 0.856 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7093088626861572
Epoch: 8, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.825 Vali Acc: 0.712 Test Loss: 0.825 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6184749603271484
Epoch: 9, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.766 Vali Acc: 0.722 Test Loss: 0.766 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5184290409088135
Epoch: 10, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.736 Vali Acc: 0.707 Test Loss: 0.736 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7403171062469482
Epoch: 11, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.909 Vali Acc: 0.727 Test Loss: 0.909 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7148544788360596
Epoch: 12, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.936 Vali Acc: 0.712 Test Loss: 0.936 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5546531677246094
Epoch: 13, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.863 Vali Acc: 0.712 Test Loss: 0.863 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8127427101135254
Epoch: 14, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.922 Vali Acc: 0.722 Test Loss: 0.922 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 512578
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.432102918624878
Epoch: 1, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.613 Vali Acc: 0.717 Test Loss: 0.613 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.1079721450805664
Epoch: 2, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.588 Vali Acc: 0.737 Test Loss: 0.588 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 1.5904183387756348
Epoch: 3, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.572 Vali Acc: 0.746 Test Loss: 0.572 Test Acc: 0.746
Validation loss decreased (-0.736579 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 1.5322082042694092
Epoch: 4, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.563 Vali Acc: 0.737 Test Loss: 0.563 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6692404747009277
Epoch: 5, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.669 Vali Acc: 0.717 Test Loss: 0.669 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4900918006896973
Epoch: 6, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.588 Vali Acc: 0.717 Test Loss: 0.588 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9754040241241455
Epoch: 7, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.608 Vali Acc: 0.722 Test Loss: 0.608 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7999136447906494
Epoch: 8, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.598 Vali Acc: 0.727 Test Loss: 0.598 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5270490646362305
Epoch: 9, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.602 Vali Acc: 0.707 Test Loss: 0.602 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7705464363098145
Epoch: 10, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.612 Vali Acc: 0.707 Test Loss: 0.612 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.625023603439331
Epoch: 11, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.629 Vali Acc: 0.707 Test Loss: 0.629 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.575411081314087
Epoch: 12, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.637 Vali Acc: 0.707 Test Loss: 0.637 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1651525497436523
Epoch: 13, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.683 Vali Acc: 0.722 Test Loss: 0.683 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 489474
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.499073028564453
Epoch: 1, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.616 Vali Acc: 0.756 Test Loss: 0.616 Test Acc: 0.756
Validation loss decreased (inf --> -0.756091).  Saving model ...
Epoch: 2 cost time: 1.6419663429260254
Epoch: 2, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.608 Vali Acc: 0.761 Test Loss: 0.608 Test Acc: 0.761
Validation loss decreased (-0.756091 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 1.4618463516235352
Epoch: 3, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.590 Vali Acc: 0.766 Test Loss: 0.590 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 1.4993550777435303
Epoch: 4, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.582 Vali Acc: 0.751 Test Loss: 0.582 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3226487636566162
Epoch: 5, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.564 Vali Acc: 0.756 Test Loss: 0.564 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2824957370758057
Epoch: 6, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.609 Vali Acc: 0.766 Test Loss: 0.609 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.872955560684204
Epoch: 7, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.646 Vali Acc: 0.766 Test Loss: 0.646 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3449780941009521
Epoch: 8, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.610 Vali Acc: 0.761 Test Loss: 0.610 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4244649410247803
Epoch: 9, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.708 Vali Acc: 0.751 Test Loss: 0.708 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3898484706878662
Epoch: 10, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.650 Vali Acc: 0.737 Test Loss: 0.650 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3189895153045654
Epoch: 11, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.612 Vali Acc: 0.766 Test Loss: 0.612 Test Acc: 0.766
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4750635623931885
Epoch: 12, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.580 Vali Acc: 0.756 Test Loss: 0.580 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2120234966278076
Epoch: 13, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.605 Vali Acc: 0.737 Test Loss: 0.605 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps61_str31_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 466690
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.17021107673645
Epoch: 1, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.619 Vali Acc: 0.766 Test Loss: 0.619 Test Acc: 0.766
Validation loss decreased (inf --> -0.765847).  Saving model ...
Epoch: 2 cost time: 1.674975872039795
Epoch: 2, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.562 Vali Acc: 0.751 Test Loss: 0.562 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.37294602394104
Epoch: 3, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.558 Vali Acc: 0.761 Test Loss: 0.558 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.451894760131836
Epoch: 4, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.541 Vali Acc: 0.771 Test Loss: 0.541 Test Acc: 0.771
Validation loss decreased (-0.765847 --> -0.770726).  Saving model ...
Epoch: 5 cost time: 1.3926851749420166
Epoch: 5, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.537 Vali Acc: 0.761 Test Loss: 0.537 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2345573902130127
Epoch: 6, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.567 Vali Acc: 0.756 Test Loss: 0.567 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.305626392364502
Epoch: 7, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.597 Vali Acc: 0.761 Test Loss: 0.597 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.385887861251831
Epoch: 8, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.636 Vali Acc: 0.766 Test Loss: 0.636 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.217963695526123
Epoch: 9, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.663 Vali Acc: 0.761 Test Loss: 0.663 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5850369930267334
Epoch: 10, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.618 Vali Acc: 0.756 Test Loss: 0.618 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4249076843261719
Epoch: 11, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.659 Vali Acc: 0.761 Test Loss: 0.659 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4670131206512451
Epoch: 12, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.685 Vali Acc: 0.737 Test Loss: 0.685 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.519416093826294
Epoch: 13, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.698 Vali Acc: 0.746 Test Loss: 0.698 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3128721714019775
Epoch: 14, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.706 Vali Acc: 0.722 Test Loss: 0.706 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps81_str41_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 451714
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0588598251342773
Epoch: 1, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.644 Vali Acc: 0.712 Test Loss: 0.644 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.6401703357696533
Epoch: 2, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.622 Vali Acc: 0.707 Test Loss: 0.622 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.438688039779663
Epoch: 3, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.598 Vali Acc: 0.737 Test Loss: 0.598 Test Acc: 0.737
Validation loss decreased (-0.712189 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 1.117760181427002
Epoch: 4, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.584 Vali Acc: 0.732 Test Loss: 0.584 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4816951751708984
Epoch: 5, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.595 Vali Acc: 0.761 Test Loss: 0.595 Test Acc: 0.761
Validation loss decreased (-0.736579 --> -0.760970).  Saving model ...
Epoch: 6 cost time: 1.4295721054077148
Epoch: 6, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.611 Vali Acc: 0.751 Test Loss: 0.611 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5034868717193604
Epoch: 7, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.649 Vali Acc: 0.746 Test Loss: 0.649 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5227842330932617
Epoch: 8, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.774 Vali Acc: 0.746 Test Loss: 0.774 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.366699457168579
Epoch: 9, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.654 Vali Acc: 0.732 Test Loss: 0.654 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.628904104232788
Epoch: 10, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.760 Vali Acc: 0.741 Test Loss: 0.760 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4095008373260498
Epoch: 11, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.701 Vali Acc: 0.756 Test Loss: 0.701 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2760884761810303
Epoch: 12, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.729 Vali Acc: 0.732 Test Loss: 0.729 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.334449052810669
Epoch: 13, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.654 Vali Acc: 0.746 Test Loss: 0.654 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3280611038208008
Epoch: 14, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.662 Vali Acc: 0.732 Test Loss: 0.662 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3534860610961914
Epoch: 15, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.716 Vali Acc: 0.751 Test Loss: 0.716 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ModernTCN_UEA_ftM_sl405_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps102_str51_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 444578
model size : 1.74MB
